'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1494:function(F,K,c){F=c(0);var l=c(16),f=c(42),a=c(6),k=c(118),x=c(165),y=c(798),n=c(221),u=c(598),z=c(2),w=c(364),E=c(22),G=c(55),H=c(242),L=c(1),I=c(1564);class N{constructor(X,W){this.P2j=X;this.qA=W}J(X){return this.P2j.pz(X,this.qA)}}Object(F.a)(N,"PropertyMergeStrategies",null,[]);var Q=c(1637),M=c(1588);class J extends M.a{constructor(){super();this.g_c=this.C4d=this.Mn=null;this.Zae=0}get uga(){return"Property"}xEb(){this.detail.Z("Type",
this.uga);this.detail.Z("ComplexMerger",null!=this.Mn?this.Mn:-1);this.detail.Z("Strategy",null!=this.C4d?this.C4d:-1);this.detail.Z("ClassId",null!=this.g_c?this.g_c:-1);this.detail.Z("PropId",this.Zae);return this.detail}}Object(F.a)(J,"PropertyMergeFailureDetail",M.a,[]);c.d(K,"a",function(){return V});class V{constructor(X=null){this.Tbh=this.Xb=null;this.uXb=X||this.YOc()}get Mn(){return 1}get wlb(){return this.uXb}YOc(){return[Object(G.a)(this,this.DQo,"tryPreProcessFavoredRevision"),Object(G.a)(this,
this.D_k,"cloneObjectAndRemoveNeededProperties"),Object(G.a)(this,this.sQo,"tryMergeNodeInternal")]}get qA(){return 5}get abe(){return this.Tbh||(this.Tbh=new N(this.wk(),this.qA))}dC(X,W){const U=X.Kg.value.wf;x.a.instance.Ta(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",U.id,U.Rc);X.lq.logger.Og(Object.assign(new J,{Mn:this.Mn,g_c:U.Rc,Zae:W}));return!1}klg(X){const W=X.Kg.value;x.a.instance.Ta(4016353,
1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",W.wf.id,W.wf.Rc);for(let U=0;U<this.wlb.length;U++)if(!(0,this.wlb[U])(X))return x.a.instance.Ta(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",W.wf.id,W.wf.Rc,U),X.lq.logger.g3d("GraphNodeComplexMerge.GetMergeFunctions()",U),this.G3m(X),X.Xk=null,!1;x.a.instance.Ta(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",W.wf.id,W.wf.Rc);
return!0}G3m(X){X.hpg||(X.hpg=!0,Q.a(X.Kg.value.lu,"Base",1),Q.a(X.Kg.value.wf,"Favored",1),Q.a(X.un.value.wf,"Conflict",1))}DQo(X){const W=X.Kg.value,U=this.abe;if(!W.aY)return!0;let Y=!0;W.Spa.forEach((ba,aa)=>{if(!aa.aY||X.og.contains(ba))return!0;aa=U.J(ba);if(5===aa){const fa=W.lu.Rc;x.a.instance.Ta(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",fa,ba,aa);X.lq.logger.Og(Object.assign(new J,
{Mn:this.Mn,g_c:fa,Zae:ba,C4d:aa}));return Y=!1}6===aa&&X.i1f.add(ba);return!0});return Y}D_k(X){X.Xk=X.Kg.value.wf.KK();const W=X.i1f,U=X.Xk;W&&W.forEach(Y=>{U.removeProperty(y.a.uX(Y));return!0});return!0}sQo(X){const W=X.un.value,U=W.lu.Rc,Y=this.abe;let ba=!0;W.Spa.forEach((aa,fa)=>{const na=Y.J(aa);ba=this.tQo(X,fa,aa,na);ba||(X.Xk=null,x.a.instance.Ta(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",U,aa,na),X.lq.logger.Og(Object.assign(new J,{Mn:this.Mn,
g_c:U,Zae:aa,C4d:na})));return ba});return ba}tQo(X,W,U,Y){const ba=X.Xk;if(!W.aY&&8!==Y||2===Y||7===Y||X.og.contains(U))return!0;if(5===Y)return!1;if(4===Y||3===Y){let aa;if(({value:aa}=X.Kg.value.Spa.Dc(U)).returnValue&&aa.aY)return 4!==Y;Y=0}8===Y&&(Y=0);if(0===Y){if(!W.isDeleted)return X=y.a.uX(U),(V.S2o(W,U,X)||V.quo())&&ba.fTa(X,W.newValue),!0;Y=6}return 6===Y?(ba.removeProperty(y.a.uX(U)),!0):1===Y?this.dC(X,U):!1}Cdn(X,W,U,Y,ba,aa){X=X||new n.a;W=W||new n.a;U=U||new n.a;var fa=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
X.length,W.length,U.length),na=X.length<=W.length&&X.length<=U.length;this.qzi()&&na&&x.a.instance.Ta(541181455,1,1,fa);if(!na&&this.wxi(aa.runtime.Xb))return null;if(this.qzi())for(fa=0;fa<X.length;fa++){na=X.$f(fa);var oa=W.$f(fa);let ja=U.$f(fa);na=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",na,oa,ja,fa,X.length);x.a.instance.Ta(541181457,1,1,na)}if(this.wxi(aa.runtime.Xb))for(aa=
0;aa<X.length;aa++)if(fa=X.$f(aa),na=W.$f(aa),oa=U.$f(aa),!Y(fa,na)||!Y(fa,oa))return null;X=X.n5();Y=new u.a;aa=X.length;for(fa=aa;fa<W.length;fa++)na=W.$f(fa),X.add(na),Y.add(na);for(;aa<U.length;aa++)W=U.$f(aa),Y.contains(W)?x.a.instance.Ta(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",W):(X.add(W),ba(W));return X}qzi(){return!!z.AFrameworkApplication.K&&z.AFrameworkApplication.K.$("LogMPALErrors")}wxi(X){if(!X)return!1;
X.HTd(1000008);return X.qib(1000008)}rTm(X){if(!X)return!1;X.HTd(1000009);return X.qib(1000009)}IOi(X,W,U,Y){return I.a(X,W,U,Y)}cGa(X,W,U){X=X||new n.a;W=W||new n.a;U=U||new n.a;const Y=X.TG(),ba=W.TG(),aa=U.TG();X=V.filter(X,fa=>ba.contains(fa)&&aa.contains(fa));X.TG();X.PC(X.length,V.filter(W,fa=>!Y.contains(fa)));X.PC(X.length,V.filter(U,fa=>!Y.contains(fa)&&!ba.contains(fa)));return X}vdn(X,W){const U=y.a.uX(W),Y=X.Ud;var ba=Y.getPropertyObjectIds(X.Kg.value.lu,U),aa=Y.getPropertyObjectIds(X.Kg.value.wf,
U);const fa=Y.getPropertyObjectIds(X.un.value.wf,U);ba=this.cGa(ba,aa,fa);aa=X.Xk;0<ba.length?Y.setPropertyObjectIds(aa,U,ba):aa.removeProperty(U);X.og.add(W)}nfb(X,W,U){X.hasProperty(U)?W.fTa(U,X.CX(U)):W.removeProperty(U)}s4n(X,W){var U=W.Hl();for(const Y of U)W.removeProperty(Y);U=X.Hl();for(const Y of U)W.fTa(Y,X.CX(Y))}XHf(X,W,U,Y,ba){W=X.getPropertyInt32(W,ba);U=X.getPropertyInt32(U,ba);U=null!=W&&null!=U?Math.max(W,U):null!=U?U:null!=W?W:null;null!=U?X.setPropertyInt32(Y,ba,U):Y.removeProperty(ba)}p7e(X,
W,U,Y,ba,aa){W=X(W,ba);U=X(U,ba);X=X(Y,ba);Y=W.TG();let fa=!1;aa&&(fa=aa(W,U,X));fa?(aa=!0,Y=!1):(aa=Y.nIh(U),Y=Y.nIh(X));x.a.instance.Ta(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",y.a.yb(ba),W.er(),U.er(),X.er(),aa,Y);return{BHc:X,Q2a:aa,G2a:Y}}tWk(X,W,U,Y,ba){let aa;W=X(W,ba);U=X(U,ba);X=X(Y,ba);Y=this.vCi(W,U);aa=this.vCi(W,X);x.a.instance.Ta(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
y.a.yb(ba),W.er(),U.er(),X.er(),Y,aa);return{BHc:X,Q2a:Y,G2a:aa}}vCi(X,W){if(!X&&!W)return!0;if(!X||!W)return!1;if(!X.count&&!W.count)return!0;let U=!1;W.forEach((Y,ba)=>U=X.mb(Y)&&ba==X.J(Y));return U}wk(){let X;X=this.rTm(this.Xb)?V.iak.value:V.hak.value;const W=new w.a(0);for(let U=0;U<X.length;U++)W.Z(X[U],7);return W}static O7(){return new V}static get instance(){return V._instance.value}static quo(){return E.a.instance.Na("Box4.IFeatureHelper").isFeatureEnabled(77)}static S2o(X,W,U){if(void 0!==
X.newValue&&null!==X.newValue||L.a.$zi(U.type))return!0;V.Y4m(X,W,U);return!1}static Y4m(X,W,U){U=U.type===L.a.string;W=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",W);U||(W+=String.format(" [NewValue: {0}] [OldValue: {1}]",X.newValue,X.oldValue));x.a.instance.Ta(19145822,1,2,W)}static hNf(X,W,U){const Y=y.a.yb(U),ba=X.Ud;var aa=ba.getPropertyObjectIds(X.Kg.value.lu,U);const fa=ba.getPropertyObjectIds(X.Kg.value.wf,U);var na=ba.getPropertyObjectIds(X.un.value.wf,U);na=V.hjm(na,
X.lq.runtime.skc);W=W.cGa(aa,fa,na);aa=X.Xk;0<W.length?ba.setPropertyObjectIds(aa,U,W):aa.removeProperty(U);X.og.add(Y);return!0}static hjm(X,W){const U=new n.a;X.forEach(Y=>{W.contains(Y,(ba,aa)=>ba.equals(aa))||U.add(Y);return!0});return U}static filter(X,W){const U=new n.a;X.forEach(Y=>{W(Y)&&U.add(Y);return!0});return U}static E_l(){return[y.a.yb(l.a.Zhf),y.a.yb(l.a.lastModifiedTime),y.a.yb(l.a.oL),y.a.yb(l.a.V5c),y.a.yb(l.a.E8f),y.a.yb(f.a.e_c),y.a.yb(a.a.tFd),y.a.yb(a.a.bgb),y.a.yb(k.a.Mgj)]}static F_l(){return[y.a.yb(l.a.Zhf),
y.a.yb(l.a.lastModifiedTime),y.a.yb(l.a.oL),y.a.yb(l.a.V5c),y.a.yb(l.a.E8f),y.a.yb(f.a.e_c),y.a.yb(a.a.tFd),y.a.yb(k.a.Mgj)]}}V._instance=new H.a(V.O7);V.hak=new H.a(V.E_l);V.iak=new H.a(V.F_l);Object(F.a)(V,"GraphNodeComplexMerge",null,[2035])},1495:function(F,K,c){c.r(K);F=c(0);var l=c(111),f=c(1515),a=c(1501),k=c(1640),x=c(1641);class y{constructor(u,z){this.Rab=!1;this.Nha=null;if(!u)throw Error.argumentNull("annotations");if(!u.occ(z))throw Error.argument("structTypeID","Invalid struct type ID");
this.ww=u;this.Ddc=this.ww.Oci(z);this.Llk=z}get j1b(){return this.ww}get isReadOnly(){return this.Rab}get FTa(){return this.Llk}Hhb(u){if(0>u||u>=this.Ddc)throw Error.argument("iField","Invalid field index");return this.Nha&&null!=this.Nha[u]?this.Nha[u]:this.ww.shi(this.FTa,u)}Mag(u,z){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>u||u>=this.Ddc)throw Error.argument("iField","Invalid field index");if(!this.ww.hbc(this.ww.vFb(this.FTa,
u),z))throw Error.argument("value","Value is not of the correct type for the specified field");(this.Nha||(this.Nha=Array(this.Ddc)))[u]=z}Pda(){const {Annotations:u}=c(1495);let z="[";if(this.Nha){let w=!0;for(let E=0;E<this.Ddc;++E){if(null==this.Nha[E])continue;const G=this.ww.vFb(this.FTa,E);if(u.Jqb(G,this.Nha[E],this.ww.shi(this.FTa,E)))continue;w?w=!1:z+=", ";z+=this.ww.thi(this.FTa,E);z+="=";const H=this.ww.Pda(G,this.Nha[E]);G===u.i$?(z+='"',z+=f.a.Uif(H),z+='"'):z+=H}}return z+"]"}isEqual(u){const {Annotations:z}=
c(1495);if(this===u)return!0;if(!u||this.ww!==u.j1b||this.FTa!==u.FTa)return!1;for(let w=0;w<this.Ddc;++w)if(!z.Jqb(this.ww.vFb(this.FTa,w),this.Hhb(w),u.Hhb(w)))return!1;return!0}clone(){const u=new y(this.ww,this.FTa);this.Nha&&(u.Nha=Array.clone(this.Nha));return u}kT(){return this.isReadOnly?this.clone():this}rKf(){const {Annotations:u}=c(1495);if(!this.isReadOnly&&(this.Rab=!0,this.Nha))for(let z=0;z<this.Ddc;++z){const w=this.Nha[z];null!=w&&u.pJb(w)}}toString(){return this.Pda()}}Object(F.a)(y,
"StructValue",null,[1343,1338]);c.d(K,"Annotations",function(){return n});class n{constructor(u,z){if(!u)throw Error.argumentNull("initData");if(!z)throw Error.argumentNull("objectFetcher");this.V9m=z.qsl;let w=0;var E=z.shb(u.J(w));++w;this.eMf=new k.a(new x.a(E));this.M2j=u.J(w);++w;this.gMi=Array(this.TKd);this.IYc=Array(this.TKd);this.mlb=Array(this.TKd);for(E=0;E<this.TKd;++E){this.gMi[E]=z.QD(u.J(w));++w;this.IYc[E]=u.J(w);++w;var G=u.J(w);++w;this.mlb[E]=Array(G);for(var H=0;H<G;++H)this.mlb[E][H]=
z.QD(u.J(w)),++w}this.Klk=u.J(w);++w;this.NMi=Array(this.I9c);this.R3d=Array(this.I9c);this.S3d=Array(this.I9c);this.Q3d=Array(this.I9c);for(E=0;E<this.I9c;++E)for(this.NMi[E]=z.QD(u.J(w)),++w,G=u.J(w),++w,this.R3d[E]=Array(G),this.S3d[E]=Array(G),this.Q3d[E]=Array(G),H=0;H<G;++H)this.R3d[E][H]=z.QD(u.J(w)),++w,this.S3d[E][H]=u.J(w),++w,this.Q3d[E][H]=({eha:w}=this.ZNa(this.S3d[E][H],u,w,null,null,null)).returnValue,n.pJb(this.Q3d[E][H]);this.rXj=u.J(w);++w;this.JLf=Array(this.F1b);this.KLf=Array(this.F1b);
this.ILf=Array(this.F1b);for(E=0;E<this.F1b;++E)this.JLf[E]=z.QD(u.J(w)),++w,this.KLf[E]=u.J(w),++w,this.ILf[E]=({eha:w}=this.ZNa(this.KLf[E],u,w,null,null,null)).returnValue,n.pJb(this.ILf[E])}xNc(u){for(let z=0;z<this.F1b;++z)if(this.JLf[z]===u)return z;return-1}T4h(u){if(!this.mcc(u))throw Error.argument("attrID","Invalid attribute ID");return this.JLf[u]}getAttributeType(u){if(!this.mcc(u))throw Error.argument("attrID","Invalid attribute ID");return this.KLf[u]}vFb(u,z){if(!this.occ(u))throw Error.argument("structTypeID",
"Invalid struct type ID");u=this.S3d[n.J9c(u)];if(0>z||z>=u.length)throw Error.argument("iField","Invalid field index");return u[z]}Pda(u,z){if(!this.vHf(u))throw Error.argument("typeID","Invalid type ID");if(!this.hbc(u,z))throw Error.argument("value","Value is not of the correct type");switch(u){case n.i$:return z;case n.bza:return z?"True":"False";case n.EIa:case n.Yqa:return z.toString();case n.mV:return z.Pda();default:if(!n.fI(u)&&n.Uad(u)){u=n.Lif(u);const G=this.mlb[u].length;switch(this.IYc[u]){case 0:return this.mlb[u][z];
case 1:if(z){var w="";for(var E=1;E<G;++E)z&1<<E-1&&(0<w.length&&(w+=" & "),w+=this.mlb[u][E]);return w}return this.mlb[u][0];case 2:w="";for(E=0;E<G;++E)z&1<<E&&(0<w.length&&(w+=" & "),w+=this.mlb[u][E]);return w;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.IYc[u]);}}else return z.Pda()}}vHf(u){switch(u){case n.i$:case n.bza:case n.EIa:case n.Yqa:case n.mV:return!0;default:return n.fI(u)?this.vHf(n.m1a(u)):n.Uad(u)?this.AVm(u):this.occ(u)}}AVm(u){u=n.Lif(u);return 0<=
u&&u<this.gMi.length}occ(u){u=n.J9c(u);return 0<=u&&u<this.NMi.length}mcc(u){return 0<=u&&u<this.F1b}hbc(u,z){if(null==z)return!1;switch(u){case n.i$:return"string"===typeof z;case n.bza:return"boolean"===typeof z;case n.EIa:return"number"===typeof z;case n.Yqa:return"number"===typeof z;case n.mV:return Object(l.a)(1337,z);default:if(n.fI(u))return Object(l.a)(1342,z)&&z.y4===n.m1a(u);if(n.Uad(u)){if("number"!==typeof z)return!1;u=n.Lif(u);const w=this.mlb[u].length;switch(this.IYc[u]){case 0:return 0<=
z&&z<w;case 1:return!(z&-1<<w-1);case 2:return!!z&&!(z&-1<<w);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.IYc[u]);}}else return Object(l.a)(1343,z)&&z.FTa===u}}get F1b(){return this.rXj}get TKd(){return this.M2j}get I9c(){return this.Klk}aOl(u){if(!this.mcc(u))throw Error.argument("attrID","Invalid attribute ID");return this.ILf[u]}Oci(u){if(!this.occ(u))throw Error.argument("structTypeID","Invalid struct type ID");return this.R3d[n.J9c(u)].length}thi(u,z){if(!this.occ(u))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.R3d[n.J9c(u)][z]}shi(u,z){if(!this.occ(u))throw Error.argument("structTypeID","Invalid struct type ID");u=this.Q3d[n.J9c(u)];if(0>z||z>=u.length)throw Error.argument("iField","Invalid field index");return u[z]}ZNa(u,z,w,E,G,H){if(!z)throw Error.argumentNull("initData");if(n.fI(u)){var L=z.J(w);++w;u=n.m1a(u);var I=new a.a(this,u);for(var N=0;N<L;++N)Array.add(I.items,({eha:w}=this.ZNa(u,z,w,E,G,H)).returnValue);return{returnValue:I,eha:w}}switch(u){case n.i$:return{returnValue:(E||
this.eMf).QD(z.J(w++)),eha:w};case n.bza:return{returnValue:1===z.J(w++),eha:w};case n.EIa:return{returnValue:z.J(w++),eha:w};case n.Yqa:return{returnValue:(G||this.V9m)[z.J(w++)],eha:w};case n.mV:u=z.J(w++);L=new f.a(this);for(I=0;I<u;++I)N=z.J(w),++w,H&&(N=H[N]),L.Iy(N,({eha:w}=this.ZNa(this.getAttributeType(N),z,w,E,G,H)).returnValue);return{returnValue:L,eha:w};default:if(n.Uad(u))return{returnValue:z.J(w++),eha:w};if(n.QDj(u)){L=z.J(w++);I=new y(this,u);for(N=0;N<L;++N){const Q=z.J(w);++w;I.Mag(Q,
({eha:w}=this.ZNa(this.vFb(u,Q),z,w,E,G,H)).returnValue)}return{returnValue:I,eha:w}}throw Error.argument("typeID","Invalid type ID");}}static Uad(u){return 16<=(u&16383)&&16384!==(u&16384)&&32768!==(u&32768)}static QDj(u){return 16<=(u&16383)&&16384===(u&16384)&&32768!==(u&32768)}static fI(u){return 32768===(u&32768)}static $2l(u){if(n.fI(u))throw Error.argument("nonListTypeID","Non-list type ID required");return u|32768}static m1a(u){if(!n.fI(u))throw Error.argument("listTypeID","List type ID required");
return u&-32769}static Jqb(u,z,w){switch(u){case n.i$:case n.bza:case n.EIa:case n.Yqa:return z===w;case n.mV:return z.isEqual(w);default:return n.fI(u)?z.isEqual(w):n.Uad(u)?z===w:z.isEqual(w)}}static pJb(u){Object(l.a)(1338,u)&&u.rKf()}static kT(u){return Object(l.a)(1338,u)?u.kT():u}static Lif(u){return u-16}static J9c(u){return(u&-16385)-16}}n.i$=1;n.bza=2;n.EIa=3;n.Yqa=5;n.mV=9;Object(F.a)(n,"Annotations",null,[1344])},1499:function(F,K,c){F=c(0);var l=c(343);class f{constructor(){this.userId=
this.email=this.displayName=null}}Object(F.a)(f,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(F.a)(a,"InsightsParameters",null,[]);var k=c(1731),x=c(1732),y=c(1733),n=c(1734),u=c(2),z=c(1546),w=c(1560),E=c(35),G=c(20),H=c(19),L=c(25);c.d(K,"a",function(){return I});class I{static get aBf(){return"Insights_16x16x32"}static get MDl(){return"Find_16x16x32"}static get x0i(){return"-Parameterized"}static get pfg(){return"Parameterized"}static get jne(){return"bTryQuery"}static get rlg(){return"TellMeSuggestion_"}static get rDj(){return"bTryQueryAlternate"}static get Nig(){return"MenuTellMe"}static get TCn(){const N=
{},Q=[];Array.add(Q,{Term:{PeopleType:"Person"}});N.And=Q;return N}static dcf(N){return N+I.x0i}static getParameter(N){let Q="",M="";if(N)for(let J=0;J<N.KZh;++J)"Type"===N.hqf(J)?Q=N.getValue(J):"Value"===N.hqf(J)&&(M=N.getValue(J));return new l.a(Q,M)}static IBb(N){N=Object.assign(new a,{neighborhood:N,mentionStart:0,mentionLength:N.length});return E.c(N)}static qNh(N,Q,M){N=Object.assign(new f,{displayName:N,email:Q,userId:M});return E.c(N)}static RNa(N,Q,M=null){return E.c(I.Zgi(N,Q,M,null))}static Zgi(N,
Q,M=null,J=null){N=Object.assign(new w.a,{neighborhood:N,mentionStart:0,mentionLength:N?N.length:0});return Object.assign(new z.a,{selection:N,userIntent:J,entryPoint:Q,launchData:M})}static E8n(N,Q){return I.RNa(N,I.Sej(Q))}static Sej(N){switch(N){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static iMm(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static Ybc(){const N=
u.AFrameworkApplication.K?u.AFrameworkApplication.K.jb("SovereignEnvironmentName"):null;return!!N&&0<N.length}static isEnterpriseUser(){const N=u.AFrameworkApplication.K?u.AFrameworkApplication.K.jb("HostAuthType"):null;return!!N&&"aad"===N.toLowerCase()||"external"===N&&I.TCf()}static ndg(N){return N.rJo&&!I.Ybc()}static CSm(){const N=u.AFrameworkApplication.K?u.AFrameworkApplication.K.jb("UiHostIntegrationType"):"";return!!u.AFrameworkApplication.K&&"UnifiedUiHostTeams"===N&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static mdg(N){return N.TTa&&N.NBl&&(N.w$c||N.u$c||N.wkb)&&!I.CSm()&&I.isEnterpriseUser()&&!I.Ybc()}static Moa(){return u.AFrameworkApplication.K?u.AFrameworkApplication.a7a||u.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):u.AFrameworkApplication.a7a}static dR(N){return!N||I.qCi(N.Dg)}static qCi(N){return!N||!N.trim().length}static Ume(N){if(!N)return 0;const Q=Math.pow(10,5);return Math.round(N*Q)/Q}static FLo(){var N=new Date;return N?new Date(N.getUTCFullYear(),N.getUTCMonth(),N.getUTCDate(),
N.getUTCHours(),N.getUTCMinutes(),N.getUTCSeconds(),N.getUTCMilliseconds()):null}static ovf(N){N=new Date(N);return(I.FLo().getTime()-N.getTime())/1E3}static bDi(N){const {InsightsMenuItemFactory:Q}=c(1730);switch(N){case k.a.Vxf:case x.a.x0h:case Q.Wsi:case y.a.BRi:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return N.startsWith(I.jne)||
N.startsWith(I.rlg)||N.startsWith(I.rDj)||N.startsWith("PeopleSuggestion")||N.startsWith("FileSuggestion")||N.startsWith("FindInDocumentSuggestion")||N.startsWith("NotesSuggestion")||N.startsWith("OnenoteNotesSuggestion")||N.startsWith("SmartLookupFromTellMe")||N.startsWith("GetHelpFromTellMe")||N.startsWith("GetHelpWithDescriptionFromTellMe")||N.startsWith("AddinSuggestion")||N.startsWith("OfficeScripts")?!0:!1}static Aqf(N,Q){const M=[];Array.add(M,new n.a(400,N));Array.add(M,new n.a(200,Q));N=
{};N.parts=M;return JSON.stringify(N)}static rhb(N){const Q=N.indexOf("<b0>"),M=N.lastIndexOf("</b0>"),J=[];Array.add(J,new n.a(400,N.substring(0,Q)));Array.add(J,new n.a(600,N.substring(Q+4,M)));Array.add(J,new n.a(400,N.substring(M+5,N.length)));N={};N.parts=J;return JSON.stringify(N)}static Rii(N){const Q=I.ovf(N);return 60>Q?CommonUIStrings.l_TimeSince_SecsAgo:3600>Q?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(Q/60).toString()):86400>Q?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(Q/3600).toString()):172800>Q?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(N)).localeFormat("MMMM dd, yyyy"))}static xRl(N){const Q=Array(N.length);for(let M=0;M<N.length;M++)Q[M]=N[M].commandId;return Q}static TCf(){if("Dev Box"===u.AFrameworkApplication.K.jb("StatusBarEnvironmentNameToUse"))return!0;let N=u.AFrameworkApplication.K.jb("UserPrincipalName");N=L.c(N)?"":H.a.Ug(N);const Q=u.AFrameworkApplication.K.Sw("TellMeIntEnabledForFeatureCrew")?
u.AFrameworkApplication.K.LC("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(Q,N)&&"inner"===u.AFrameworkApplication.K.jb("Microsoft365Ring")}static A_l(N){switch(I.EPd(N)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static Jdm(N){N=I.EPd(N);switch(N){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return N}}static EPd(N){switch(N.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static zoa(){return G.a.k4&&!G.a.Aq}}I.C7a=9E5;Object(F.a)(I,"TellMeUtils",null,[])},1500:function(F,K,c){c.r(K);F=c(0);var l=c(498),f=c(354),a=c(55),k=c(111),x=c(67),y=c(1656),n=c(214);class u{constructor(Ta,Ab,Db,ac,Pa,bb){this.groupType=Ta;this.resultType=Ab;this.chg=Db;this.x8=ac;this.Lff=Pa;this.resultIndex=
bb}}Object(F.a)(u,"ClickLoggingInfo",null,[]);const z=Ta=>{const Ab=[];for(;Ta;)Array.add(Ab,"{ContextId:"+Ta.contextId+", IsGraphNodeContext:"+Ta.hl+"}"),Ta=Ta.gk;Ab.reverse();return"{"+Ab.join(", ")+"}"};class w{constructor(){this.roa=this.sessionId=null}}Object(F.a)(w,"CorrelationRecord",null,[1255]);var E=c(1520);class G{constructor(Ta,Ab){this.provider=Ta;this.Q7a=Ab}}Object(F.a)(G,"ExternalResultProvider",null,[]);class H{constructor(Ta,Ab){this.Id=null;this.TimeStamp=0;this.Id=Ta;this.TimeStamp=
Ab}}Object(F.a)(H,"MRUControl",null,[]);var L=c(1642),I=c(1499),N=c(2),Q=c(1378);class M{constructor(Ta,Ab){this.ybk=10;this.P6=[];this.VAa=[];this.O1g=this.N1g=!1;this.Hxc=this.Gxc="";this.sXb=Ab;this.ic=Ta}ZNc(){!this.N1g&&this.ic&&(this.Gxc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.ic.application,this.P6=this.I5h(),this.N1g=!0);return this.P6}N$l(){!this.O1g&&this.ic&&(this.Hxc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.ic.application,this.VAa=this.I5h(!0),this.O1g=!0);return this.VAa}CUm(Ta){return Ta.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===Ta||"TryOfficeUpsell"===Ta}zCf(Ta){return this.LGm(Ta)||this.CUm(Ta)||I.a.bDi(Ta)?!1:!0}YYa(Ta){Ta=Ta.ControlId;this.zCf(Ta)&&(Ta=this.V5f(Ta),this.F0n(Ta),this.O$m(),Array.insert(this.P6,0,new H(Ta,Date.now())),this.Gxc.length&&(Ta=JSON.stringify(this.P6),Q.a.instance.setItem(this.Gxc,Ta)))}JE(Ta){this.N$m();Array.insert(this.VAa,0,new H(L.a[Ta],Date.now()));this.Hxc.length&&(Ta=JSON.stringify(this.VAa),Q.a.instance.setItem(this.Hxc,Ta))}I5h(Ta=!1){if(!this.P6.length){var Ab=
Ta?Q.a.instance.getItem(this.Hxc):Q.a.instance.getItem(this.Gxc);if(!Ab||""===Ab)return Ta?this.VAa:this.P6;let Db=null;try{Db=JSON.parse(Ab)}catch(ac){this.HYk(Ta),Db=null}if(!Db||!Db.length||10<Db.length)return Ta?this.VAa:this.P6;Ab=0;for(const ac of Db)if(Ta||this.ic.t0d(ac.Id)&&this.zCf(ac.Id))if(Ta?Array.insert(this.VAa,Ab++,ac):Array.insert(this.P6,Ab++,ac),Ab===this.sXb)break}return Ta?this.VAa:this.P6}T9e(Ta){Ta=this.V5f(Ta);for(const Ab of this.P6)if(Ab.Id===Ta)return!0;return!1}HYk(Ta=
!1){Q.a.instance.setItem(Ta?this.Hxc:this.Gxc,"")}$Im(Ta){Ta=this.V5f(Ta.ControlId);return this.zCf(Ta)?this.T9e(Ta):!1}F0n(Ta){if(0<this.P6.length){let Ab=0;for(const Db of this.P6){if(Db.Id===Ta){Array.removeAt(this.P6,Ab);break}Ab++}}}V5f(Ta){return"Excel"===this.ic.application&&Ta.startsWith("m_excelWebRenderer_ewaCtl_")?Ta.substr(26,Ta.length):Ta}O$m(){this.P6.length===this.sXb&&Array.removeAt(this.P6,this.P6.length-1)}N$m(){this.VAa.length===this.ybk&&Array.removeAt(this.VAa,this.VAa.length-
1)}LGm(Ta){Ta=Ta.split("|");let Ab="";if(6<=Ta.length)Ab=Ta[0];else if(3<=Ta.length){if("3"===Ta[0])return!0;Ab=Ta[1]}return Ab.startsWith("WA")}static createInstance(Ta){let Ab=3;N.AFrameworkApplication.K&&(Ab=N.AFrameworkApplication.K.mc("TellMeMaxRecommendedResultsToReturn",3));return new M(Ta,Ab)}}Object(F.a)(M,"MruControlsManager",null,[1254]);class J{constructor(Ta){this.xwb=Ta}bga(Ta,Ab){let Db;return Ta.$C&&(Db=this.xwb[Ta.value])?Db.bga(Ta,Ab):(Db=this.I6h(Ta.value))?Db.bga(Db.vfn,Ab):null}y8l(Ta,
Ab){if(Ta=this.xwb[Ta])for(const Db of Ab)if(Ab=I.a.getParameter(Db),Ab.key===Ta.sYf)return Ab.value;return null}jjn(Ta){(Ta=this.I6h(Ta))&&Ta.gjn()}I6h(Ta){const Ab=Ta.indexOf(I.a.x0i);return 0<Ab?this.xwb[Ta.substring(0,Ab)]:null}}Object(F.a)(J,"ParameterizedCommandManager",null,[1253]);var V=c(1530);class X{constructor(Ta,Ab){this.Dg=Ta;this.snb=Ab}}Object(F.a)(X,"TellMeQuery",null,[]);var W=c(1639);class U{constructor(Ta,Ab){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=Ta;this.TimeElapsedSinceClick=
Ab}}Object(F.a)(U,"CommandClickedEvent",null,[]);var Y=c(25);class ba{constructor(Ta,Ab){this.Tdk=Ta;this.Xsa=Ab}resultsUpdated(Ta){this.Tdk(Y.c(Ta.query)?"":Ta.query.Dg,Ta.ko,Ta.attributes,this.Xsa,Ta.Ebc)}}Object(F.a)(ba,"ResultsUpdatedCallback",null,[1252]);class aa{constructor(Ta,Ab,Db,ac,Pa){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=Ta;this.TimeElapsedSinceClick=Db;this.CommandSurface=ac;this.CommandId=
Ab;this.TerminalParentControlId=Pa}}Object(F.a)(aa,"UserActionEvent",null,[]);var fa=c(74);class na{constructor(Ta,Ab){this.menuModel=Ta;this.Qej=Ab}}Object(F.a)(na,"GeneratedMenuModel",null,[]);class oa{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(F.a)(oa,"MenuModel",null,[]);class ja{constructor(Ta,Ab,Db){this.ic=Ta;this.xwb=Ab;this.ifa=Db}bLl(Ta,Ab,Db){const {TellMeActor:ac}=c(1500);let Pa=0;const bb=new oa,lc=[];let rb=
"";bb.sections=[];let La=new fa.a;const sb=!!this.ic&&this.ic.w3a;var Sb=!!this.ic&&this.ic.Vob||N.AFrameworkApplication.ta.Nb.Vob;for(const Lb of Ta){Ta=0;sb||(La=new fa.a);const Qc=new fa.a;let Dc=Lb.displayName;for(const Fd of Lb.results){if(0<=Fd.value.indexOf(I.a.pfg)){if(Fd.$C){var kc=this.xwb[Fd.value];if(kc&&Fd.value.endsWith(I.a.pfg)){if("FindParameterized"!==Fd.value&&!Sb){const pe=[];pe.push(appChrome.actions.setControlLabel(Fd.value,kc.AQd(Fd)));pe.push(appChrome.actions.setButtonCommandValueId(Fd.value,
kc.Gof(Fd)));appChrome.api.dispatch(pe)}kc=Fd.value.replace(I.a.pfg,"");La.remove(kc)?Ta--:Qc.add(kc);La.add(Fd.value);Ta++}}}else switch(Fd.type){case 5:Qc.contains(Fd.value)||(La.add(Fd.value),Ta++);break;case 7:La.add(Fd.$C);Ta++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:La.add(Fd.value),Ta++}13===Lb.groupType&&(Dc=I.a.Moa()?0<Ab.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,
Ab):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Ab));21===Lb.groupType&&(Dc=CommonUIStrings.l_LearningUILiveText)}Pa+=Ta;""!==Dc&&0<Ta&&(rb+=" , "+Ta.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+Dc+" , ");0<La.count&&!sb&&(Ta=appChrome.api.menuSection(La.toArray(),Lb.displayName,null,V.a[Lb.groupType]),lc.push(Ta))}Sb=null;0<Pa&&(Sb=0<Ab.length?1!==Pa?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,
Pa,Ab):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Ab):1!==Pa?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Pa):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,sb?(Ab=appChrome.api.menuSection(La.toArray(),"",null,null),lc.push(Ab)):Sb+=rb);Db&&(this.ic.$va?ac.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Sb)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Sb)));bb.sections=
lc;return new na(bb,Pa,[])}static get Ihf(){return ja.WTg||(ja.WTg=new na(Object.assign(new oa,{sections:[]}),0,[]))}}ja.WTg=null;Object(F.a)(ja,"TellMeMenuDefintionGenerator",null,[]);var qa;(function(Ta){Ta[Ta.TellMeControlActivated=0]="TellMeControlActivated";Ta[Ta.TellMeQueryExecuted=1]="TellMeQueryExecuted";Ta[Ta.TellMeResultsRendered=2]="TellMeResultsRendered";Ta[Ta.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(qa||(qa={}));Object(F.b)("PerformanceMarker",qa);var Ia;(function(Ta){Ta[Ta.TellMeTimeToRender=
0]="TellMeTimeToRender";Ta[Ta.TellMeSessionLength=1]="TellMeSessionLength";Ta[Ta.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(Ia||(Ia={}));Object(F.b)("PerformanceMeasure",Ia);class Va{mark(Ta){window.performance.mark(qa[Ta])}measure(Ta,Ab,Db){const {TellMeActor:ac}=c(1500);try{window.performance.measure(Ia[Ta],qa[Ab],qa[Db])}catch(Pa){ac.instance.Oe.onError("TellMePerformance:Measure","error measuring "+Ia[Ta])}}RKf(Ta,Ab,Db){const {TellMeActor:ac}=c(1500);ac.instance.Oe.bLf(Ab,Db,Ta,this.J3l(Ta))}iZk(){var Ta=
[0,1,2,3];for(const Ab of Ta)window.performance.clearMarks(qa[Ab])}clearMeasures(Ta){for(const Ab of Ta)window.performance.clearMeasures(Ia[Ab])}J3l(Ta){let Ab=0;(Ta=this.NMl(Ta))&&0<Ta.length&&(Ab=Ta[Ta.length-1].duration);return Ab}NMl(Ta){return window.performance.getEntriesByName(Ia[Ta],"measure")}}Object(F.a)(Va,"TellMePerformance",null,[]);var Na=c(1567),za=c(1566),la=c(35);class va{constructor(Ta){this.Mmk=Ta}aLb(Ta,Ab,Db){const {TellMeActor:ac}=c(1500);ac.instance.Oe.y0(Ab,za.a.Pgc,Ta.data.Qe.toString(),
Math.round(window.performance.now()-Db),za.a.Pgc,!0,Na.a.IPa);Ta=la.b(Ta.data.ve);Ab=-1;Ta.Index&&(Ab=Ta.Index);ac.instance.Oe.o7m(Ab,this.Mmk)}HKb(Ta,Ab,Db){const {TellMeActor:ac}=c(1500);ac.instance.Oe.y0(Ab,za.a.Pgc,Ta.data.Qe.toString(),Math.round(window.performance.now()-Db),za.a.Pgc,!1,Na.a.IPa)}T$l(Ta){if(Ta&&""!==Ta.trim()){const Db=window.performance.now(),ac=N.AFrameworkApplication.Myj;var Ab={};Ab.Text=Ta;Ab.IsFileHash="false";Ab=la.c(Ab);N.AFrameworkApplication.Ne.xj(ac,2,Ab,{"Content-Type":"application/json",
Accept:"application/json"},!1,0,Pa=>{this.aLb(Pa,Ta.length,Db)},Pa=>{this.HKb(Pa,Ta.length,Db)},null,null,!1,4E3,6E3)}}}Object(F.a)(va,"TellMeQueryIndexCallback",null,[]);var ia=c(1502);class pa{constructor(Ta,Ab,Db){this.xml=Ta;this.Qej=Ab;this.Upl=Db}}Object(F.a)(pa,"GeneratedMenuXml",null,[]);var sa=c(1731),Ha=c(19);class ra{constructor(Ta,Ab){this.Dgd=Ta||{};this.qXa=Ab}get wNb(){return 5}bga(Ta,Ab=null){return this.qXa.bga(Ta,Ab)||this.LNk(Ta.value)}LNk(Ta){return ra.h5e(Ta,this.Dgd[Ta]||null)}static h5e(Ta,
Ab=null){Ta=String.format('<ClonedControl Id="{0}" ',Ta);for(let Pa in Ab){var Db=Pa,ac=Ab[Pa];ac=ac?Ha.a.yf(ac.toString()):"";Ta+=String.format('{0}="{1}" ',Db,ac)}return Ta+"/>"}}Object(F.a)(ra,"CommandMenuItemFactory",null,[1248]);var Ma=c(159);class ya{constructor(){this.D3j=CommonUIStrings.l_FindInDocumentText}get wNb(){return 8}bga(Ta){var Ab=Ta.$C;Ta=Ha.a.yf(Ta.value);const Db=Ha.a.yf(Ab);Ab=Ha.a.yf(String.format(this.D3j,Ab));return this.oKl(Ta,Db,Ab)}oKl(Ta,Ab,Db){return Ma.a(Ta,"1540292897",
Db,I.a.MDl,null,Ab,Db,null,null)}}Object(F.a)(ya,"FindInDocumentMenuItemFactory",null,[1248]);var Ga=c(1732),wa=c(1730),hb=c(1733);class eb{get wNb(){return 7}bga(Ta){const Ab=Object(x.a)(W.a,Ta);return this.kLl(Ha.a.yf(Ta.value),Ab.id)}kLl(Ta,Ab){return Ma.a(Ab,"1404166600",Ta,null,null,Ta,Ta,null,null)}}Object(F.a)(eb,"TryQueryMenuItemFactory",null,[1248]);class jb{constructor(Ta){this.q6=[];this.ic=Ta}VWl(Ta){for(const Ab of this.q6)if(Ab.wNb===Ta)return Ab;return null}ha(Ta){this.q6.push(Ta)}OVn(Ta){this.ha(new ra(this.ic.U6k,
Ta));this.ha(new hb.a(this.ic.Xhn));this.ha(new sa.a(this.ic.Hco,this.ic.Gco,this.ic.BJo,this.ic.ctm,this.ic.qto));this.ha(new wa.InsightsMenuItemFactory);this.ha(new ya);this.ha(new Ga.a);this.ha(new eb)}}Object(F.a)(jb,"MenuItemFactoryRegistry",null,[]);var ub=c(1504);class ab{constructor(Ta,Ab){this.ic=Ta;this.P6g=new jb(this.ic);this.P6g.OVn(Ab)}cLl(Ta,Ab){let Db=0;const ac=[],Pa=[];for(const lc of Ta){Ta=I.a.Nig;var bb=[];for(const rb of lc.results){const La=this.P6g.VWl(rb.type).bga(rb,Ab);
Ta=I.a.Nig;bb.push(La);if(13===rb.type||14===rb.type)Ta="Menu32";17===rb.type&&(Ta="MenuTellMeExtended");rb.groupType=lc.groupType;Pa.push(Object(x.a)(ub.a,rb))}Db=Db?Db:bb.length;bb=Ma.d("TellMeDropdownControls",bb);Ta=Ma.g("TellMeDropdownMenuSection",bb,Ta,lc.displayName);ac.push(Ta)}Ab=Ma.h(ac,"LookupDropdownMenu");return new pa(Ab,Db,Pa)}static get lKd(){return ab.XTg||(ab.XTg=new pa(Ma.h([],"LookupDropdownMenu"),0,[]))}}ab.XTg=null;Object(F.a)(ab,"TellMeXmlGenerator",null,[]);class Ea{}Ea.ogn=
"MRU";Ea.test="Test";Object(F.a)(Ea,"ActionType",null,[]);var Wa=c(1549),Bb;(function(Ta){Ta[Ta.Service=0]="Service";Ta[Ta.Local=1]="Local";Ta[Ta.MRU=2]="MRU";Ta[Ta.TestResult=3]="TestResult";Ta[Ta.Unknown=4]="Unknown"})(Bb||(Bb={}));Object(F.b)("SubResultType",Bb);var Mb=c(82);class Fb{constructor(Ta,Ab,Db,ac,Pa=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=Ta;this.IsEnabled=Ab;this.ResultType=L.a[Db];this.SubResultType=Bb[ac];
this.OptionalData=Pa?Mb.a.toJSON(Pa):null}}Object(F.a)(Fb,"ResultInfo",null,[]);var vb=c(112),$a=c(184),kb=c(287);class Ua{constructor(Ta,Ab=null){this.Sld="TellMeWAC.";this.vfk=Ta;this.Pnk=Ab}yHa(Ta,Ab,Db){Ab=vb.a.kz(Ab);Ta=vb.a.$bf(Ta,this.vfk,this.Pnk,Db,Ab);$a.a.yHa(Ta,this.Sld)}xHa(Ta,Ab,Db=0){Ab=vb.a.kz(Ab);$a.a.xHa(Object.assign(new kb.a,{name:Ta,dataFields:Ab,durationMs:Db}),this.Sld)}}Object(F.a)(Ua,"TellMeOtelLogger",null,[1263]);var Sa=c(140);class xb{constructor(Ta,Ab,Db,ac,Pa,bb,lc){this.R6=
this.uaa=this.CPg=null;this.Yda=Ta;this.f$a=Ab;this.XLa=Db;this.Qab=ac;this.EWa=Pa;this.k$j=bb;this.R6=lc?lc:new Ua(this.Qab?n.CuiHelper.ofg:n.CuiHelper.Jle)}get yr(){return this.Qab}get Xpa(){return this.XLa}Fhe(Ta){this.CPg=Ta;switch(Ta){case ia.a.contextMenu:this.uaa=ia.a.contextMenu;break;default:this.uaa=ia.a.tellMe}}FKk(Ta,Ab){this.XLa.roa||(this.XLa.roa=Sa.a.create().toString(),this.FJi(Ta,!0,Ab))}pWh(Ta,Ab=!0){this.XLa.roa&&this.s3m(Ta,Ab);this.Qab&&appChrome.api.updateTellMeCorrelationId("");
this.XLa.roa=null}FJi(Ta,Ab,Db){const {TellMeActor:ac}=c(1500),Pa=this.R7(E.a.y2a);Pa[Wa.a.culture]=this.f$a;Pa[Wa.a.appName]=this.Yda;Pa[Wa.a.context]=Ta;Pa[Wa.a.G_d]=this.EWa;Pa[Wa.a.AUm]=this.k$j;Pa[Wa.a.kTm]=Db;Pa[Wa.a.sNm]=Ab;Pa[Wa.a.contentType]=ac.instance.OHd;this.R6.yHa(E.a.y2a,Pa,this.CPg);this.Qab&&appChrome.api.updateTellMeCorrelationId(this.XLa.roa)}s3m(Ta,Ab){const Db=this.R7(E.a.cHb);Db[Wa.a.atl]=Ta;Db[Wa.a.rNm]=Ab;this.R6.xHa(E.a.cHb,Db)}n7m(Ta,Ab,Db){let ac=0;!Db&&0<Ta.length&&(ac=
Ta.trim().split(" ").length);const Pa=this.R7(E.a.query);Pa[Wa.a.query]="!";Pa[Wa.a.rMb]=Ab;Pa[Wa.a.V5i]=Ta.length;Pa[Wa.a.tEi]=Db;Pa[Wa.a.s8o]=ac;this.R6.yHa(E.a.query,Pa,this.uaa)}f5m(Ta,Ab,Db,ac,Pa,bb,lc,rb=null){const La=this.R7(E.a.latency);La[Wa.a.culture]=this.f$a;La[Wa.a.V5i]=Ta;La[Wa.a.UDj]=Ab;La[Wa.a.statusCode]=Db;La[Wa.a.service]=Pa;La[Wa.a.isSuccess]=bb;La[Wa.a.JYm]=lc;rb&&(La[Wa.a.eMo]=rb);this.R6.xHa(E.a.latency,La,ac)}bLf(Ta,Ab,Db,ac){const Pa=this.R7(E.a.performance);Pa[Wa.a.culture]=
this.f$a;Pa[Wa.a.JKk]=qa[Ta];Pa[Wa.a.vvl]=qa[Ab];Pa[Wa.a.jDn]=Ia[Db];this.R6.xHa(E.a.performance,Pa,ac)}y7m(Ta,Ab){var {TellMeActor:Db}=c(1500);const {CommandResultsUtility:ac}=c(1539);if(Ta.results.length){var Pa=this.R7(E.a.Gcj);Pa[Wa.a.x8]=Ab.toString();Pa[Wa.a.groupType]=V.a[Ta.groupType];16===Ta.groupType&&(Pa[Wa.a.KSm]=Db.instance.Qbd);Ab=[];Db=[];var bb=[];for(const lc of Ta.results)Pa[Wa.a.resultType]||(Pa[Wa.a.resultType]=L.a[lc.type]),Ta={},27===lc.type&&(Ta.AssetId=lc.KI),Db.push(ac.UTc(lc.value)),
Ab.push(lc.value),bb.push(new Fb(lc.value,ac.UTc(lc.value),lc.type,lc.Uwj,Ta));0<Ab.length&&(Pa[Wa.a.G8n]="{"+Ab.join(", ")+"}",Pa[Wa.a.Xul]="{"+Db.join(", ")+"}",Pa[Wa.a.C8n]=la.c(bb));this.R6.yHa(E.a.Gcj,Pa,this.uaa)}}QLl(Ta,Ab){if(4===Ta)return Ea.ogn;switch(Ab){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return L.a[Ab]}O2m(Ta,Ab,Db,ac,Pa){const bb=this.R7(E.a.click);bb[Wa.a.UDj]=Ta;bb[Wa.a.kBn]=Ab;bb[Wa.a.commandId]=
Db;bb[Wa.a.r3]=ac;bb[Wa.a.actionType]=this.QLl(Pa.groupType,Pa.resultType);bb[Wa.a.resultType]=L.a[Pa.resultType];bb[Wa.a.chg]=Bb[Pa.chg];bb[Wa.a.groupType]=V.a[Pa.groupType];bb[Wa.a.x8]=Pa.x8.toString();bb[Wa.a.Lff]=Pa.Lff.toString();bb[Wa.a.resultIndex]=Pa.resultIndex.toString();this.R6.yHa(E.a.click,bb,this.uaa)}U2m(Ta,Ab){this.XLa.roa||(this.XLa.roa=Sa.a.create().toString(),this.FJi("",!1,Ab));Ab=this.R7(E.a.dJh);Ab[Wa.a.rMb]=Ta;this.R6.xHa(E.a.dJh,Ab)}aKi(Ta,Ab,Db){if(Ta){if(Db)for(let ac in Db)Ta[ac]=
Db[ac];this.R6.xHa(E.a.events,Ta,Ab)}}FG(Ta,Ab,Db=null){const ac=this.R7(E.a.events);ac[Wa.a.event]=Ta;this.aKi(ac,Math.round(Ab),Db)}SFa(Ta,Ab,Db=null){const ac=this.R7(E.a.events);ac[Wa.a.event]=E.a.error;ac[Wa.a.module]=Ta;ac[Wa.a.errorMessage]=Ab;ac[Wa.a.message]=Ab;this.aKi(ac,Math.round(window.performance.now()),Db)}M2m(Ta){const Ab=this.R7(E.a.cGh);Ab[Wa.a.value]=Ta;Ab[Wa.a.Pce]=this.Qab;this.R6.yHa(E.a.cGh,Ab,this.uaa)}e2m(Ta){const Ab=this.R7(E.a.Umh);Ab[Wa.a.value]=Ta;Ab[Wa.a.Pce]=this.Qab;
this.R6.yHa(E.a.Umh,Ab,this.uaa)}T3m(Ta){const Ab=this.R7(E.a.h_h);Ab[Wa.a.value]=Ta;Ab[Wa.a.Pce]=this.Qab;this.R6.yHa(E.a.h_h,Ab,this.uaa)}l7m(Ta){const Ab=this.R7(E.a.n5i);Ab[Wa.a.value]=Ta;Ab[Wa.a.Pce]=this.Qab;this.R6.yHa(E.a.n5i,Ab,this.uaa)}t2m(Ta){const Ab=this.R7(E.a.$jj);Ab[Wa.a.value]=Ta;this.R6.yHa(E.a.$jj,Ab,this.uaa)}p7m(Ta,Ab){const Db=this.R7(E.a.Q5i);Db[Wa.a.Pgc]=Ta;Ab&&(Db[Wa.a.roa]=Ab);this.R6.xHa(E.a.Q5i,Db)}R7(Ta){return{["SessionID"]:this.XLa.sessionId,["CorrelationID"]:this.XLa.roa,
["Time"]:(new Date).getTime(),["Event"]:Ta,["Scenario"]:this.uaa}}}Object(F.a)(xb,"UsageLogger",null,[1249]);var Qb=c(66),Ib=c(1681),$b=c(1205),hc=c(1536),pb=c(90),dc=c(27),Ob=c(1204),Vb=c(622),ob=c(20),Xb=c(741),Xa=c(68),Pb=c(13);c.d(K,"TellMeActor",function(){return rc});class rc{constructor(){this.qXa=this.E2=this.Ub=this.Fa=this.IP=this.Qz=this.Gb=this.ga=this.Oe=this.yK=this.vKe=this.imh=this.ila=this.ic=null;this.KWb=!1;this.iwe=[];this.yPg=[];this.Qkh=[];this.D7g=[];this.E7g=[];this.A2g=!1;
this.DTb=this.ifa=null;this.Fvc=this.EWa=!1;this.qpd=!0;this.PZ=this.Cuc=this.KXg=this.LKe=this.p7g=null;this.VY=[];this.h$a=this.eUb=this.eAa=this.psd=this.Egh=null;this.$Vb=!1;this.EKe=0;this.cTb=null;this.Xsa=-1;this.R6g=0;this.Nvc=!1;this.J$a=null;this.Lkh=!1;this.eTb=this.Jp=null}get OHd(){return this.IP?this.IP.contentType:rc.unknown}get actions(){return this.VY}set actions(Ta){this.VY=Ta}TSd(){return this.Oe?this.Oe.Xpa.roa:null}BO(){return this.ic}get afn(){return this.qpd}get m4o(){return this.p7g}performance(){return this.yK}get gfg(){return this.Egh}set gfg(Ta){this.Egh=
Ta}get Qbd(){return this.Lkh}set Qbd(Ta){this.Lkh=Ta}WG(Ta){const Ab=window.performance.now();this.ifa&&!Y.c(Ta)&&(this.ifa(Ta),this.Oe.MA(E.a.WG,window.performance.now()-Ab))}initialize(Ta,Ab=null,Db=null,ac=null,Pa=null,bb=null,lc=null,rb=null,La=null,sb=null,Sb=null){const {InteractionLogger:kc}=c(1971),{GroupsPlacementInfo:Lb}=c(1967),{AggregatorResultsProvider:Qc}=c(1760);this.ic=Ta;this.EWa=!!N.AFrameworkApplication.ta&&N.AFrameworkApplication.ta.Nb.Tbc;this.Oe=ac;if(!ac){ac=new w;ac.sessionId=
N.AFrameworkApplication.userSessionId;const Dc=Xb.a.sg(N.AFrameworkApplication.lcid)||Xb.a.wTc;this.Oe=new kc(new xb(this.ic.application,Dc.name,ac,this.ic.yr,this.EWa,Ta.TTa,null),this.ic.a7k,this.ic)}this.qXa=new J(this.ic.parameterData);this.imh=Db||new ab(this.ic,this.qXa);this.ifa=lc;this.vKe=this.vKe||new ja(this.ic,this.ic.parameterData,lc);this.Ub=Qb.FocusManager.instance();this.E2=M.createInstance(this.ic);this.KXg=new Lb(Ta);this.ga=Pa||N.AFrameworkApplication.va;this.Gb=bb||N.AFrameworkApplication.nc;
this.Qz=La;this.ila=Ab;this.Jp=Sb;this.yK=new Va;this.eTb=new l.a(f.a.Fh());this.psd=[];La?La.execute(Dc=>{Dc.isFeatureEnabled(rc.qJo,!0).then(Fd=>{const {AggregatorResultsProvider:pe}=c(1760);this.Nvc=Fd;this.ila=this.ila||pe.createInstance(this.E2,this.ic,this.qXa,this.Nvc);for(const ye of this.psd)this.ila.JE(ye.provider,ye.Q7a);this.psd=[];return null})}):(this.Nvc=!0,this.ila=this.ila||Qc.createInstance(this.E2,this.ic,this.qXa,this.Nvc));this.Fa=rb;this.eAa=ab.lKd;this.p7g=new Promise(Dc=>{this.LKe=
Dc});sb&&sb.execute(Dc=>{this.IP=Dc})}Tb(){this.fwk()}hXn(Ta){this.Cuc=Ta}fwk(){this.ga.eb(Pb.a.tellMe,Xa.a.frame,Object(a.a)(this,this.tellMe,"tellMe"),96);this.ga.eb(Pb.a.Mig,Xa.a.frame,Object(a.a)(this,this.Fzh,"cacheAsyncMenuRefreshFunction"),96);this.ga.eb(Pb.a.Rig,Xa.a.frame,Object(a.a)(this,this.tKi,"logItemExecuted"),96);this.ga.eb(Pb.a.Uig,Xa.a.frame,Object(a.a)(this,this.PJi,"logControlDeactivation"),96);this.ga.eb(Pb.a.Tig,Xa.a.frame,Object(a.a)(this,this.pKi,"logInputFocus"),96);this.ga.eb(Pb.a.Pig,
Xa.a.frame,Object(a.a)(this,this.y2a,"interactionBegin"),96);this.ga.eb(Pb.a.Wig,Xa.a.frame,Object(a.a)(this,this.y2a,"interactionBegin"),96);this.ga.eb(Pb.a.Sig,Xa.a.frame,Object(a.a)(this,this.oKi,"logInputBlur"),96);this.ga.eb(Pb.a.Vig,Xa.a.frame,Object(a.a)(this,this.OJi,"logControlActivated"),96);this.ga.eb(Pb.a.v$c,Xa.a.frame,Object(a.a)(this,this.o1h,"focusSearchBox"),96);this.ga.eb(Pb.a.Lig,Xa.a.frame,Object(a.a)(this,this.ZHh,"constructLiveNotificationForMenu"),96);this.ga.eb(Pb.a.Xig,Xa.a.frame,
Object(a.a)(this,this.YAf,"insertTryQuery"),96);this.ga.eb(Pb.a.uJf,Xa.a.frame,Object(a.a)(this,this.YAf,"insertTryQuery"),96);this.ga.eb(Pb.a.hkf,Xa.a.frame,Object(a.a)(this,this.MRa,"openOrInsertUrl"),96);this.ga.eb(Pb.a.ikf,Xa.a.frame,Object(a.a)(this,this.MRa,"openOrInsertUrl"),96);this.ga.eb(Pb.a.jkf,Xa.a.frame,Object(a.a)(this,this.MRa,"openOrInsertUrl"),96);this.ga.eb(Pb.a.kkf,Xa.a.frame,Object(a.a)(this,this.MRa,"openOrInsertUrl"),96);this.ga.eb(Pb.a.lkf,Xa.a.frame,Object(a.a)(this,this.MRa,
"openOrInsertUrl"),96);this.ga.eb(Pb.a.TWf,Xa.a.frame,Object(a.a)(this,this.MRa,"openOrInsertUrl"),96);this.ga.eb(Pb.a.UWf,Xa.a.frame,Object(a.a)(this,this.MRa,"openOrInsertUrl"),96);this.ga.eb(Pb.a.VWf,Xa.a.frame,Object(a.a)(this,this.MRa,"openOrInsertUrl"),96);this.ga.eb(Pb.a.YYf,Xa.a.frame,Object(a.a)(this,this.u2a,"insertMention"),96);this.ga.eb(Pb.a.ZYf,Xa.a.frame,Object(a.a)(this,this.u2a,"insertMention"),96);this.ga.eb(Pb.a.$Yf,Xa.a.frame,Object(a.a)(this,this.u2a,"insertMention"),96);this.ga.eb(Pb.a.Oig,
Xa.a.frame,Object(a.a)(this,this.tZi,"openFeedback"),96);this.ga.eb(Pb.a.Yig,Xa.a.frame,Object(a.a)(this,this.MRa,"openOrInsertUrl"),96);this.ga.eb(Pb.a.q0e,Xa.a.frame,Object(a.a)(this,this.c1d,"launchAddin"),96);this.ga.eb(Pb.a.r0e,Xa.a.frame,Object(a.a)(this,this.c1d,"launchAddin"),96);this.ga.eb(Pb.a.s0e,Xa.a.frame,Object(a.a)(this,this.c1d,"launchAddin"),96);this.ga.eb(Pb.a.qPb,Xa.a.frame,Object(a.a)(this,this.qPb,"showTellMeCoachmark"),96);this.ga.eb(Pb.a.QIf,Xa.a.frame,Object(a.a)(this,this.HFi,
"launchAddinStore"),96);this.ga.eb(Pb.a.G2f,Xa.a.frame,Object(a.a)(this,this.q6i,"quickActionOnFileHandler"),96);this.ga.eb(Pb.a.$mf,Xa.a.frame,Object(a.a)(this,this.I3h,"generateSlidesFromFiles"),96)}gVn(Ta){this.qpd=!1;const Ab=window.performance.now();Ta.T3a.isCompleted?(this.qpd=!0,this.LKe(!0)):Ta.VZ(()=>{this.qpd=!0;this.LKe(!0);this.Oe.MA(E.a.xll,window.performance.now()-Ab)});this.SVn(Ta)}SVn(Ta){Vb.a.fde(Object(a.a)(this,this.jJd,"dispatcher"));Vb.a.eLc([new Ob.a(Pb.a.tellMe,Xa.a.frame,96),
new Ob.a(Pb.a.Mig,Xa.a.frame,96),new Ob.a(Pb.a.Rig,Xa.a.frame,96),new Ob.a(Pb.a.Uig,Xa.a.frame,96),new Ob.a(Pb.a.Tig,Xa.a.frame,96),new Ob.a(Pb.a.Pig,Xa.a.frame,96),new Ob.a(Pb.a.Wig,Xa.a.frame,96),new Ob.a(Pb.a.Sig,Xa.a.frame,96),new Ob.a(Pb.a.Vig,Xa.a.frame,96),new Ob.a(Pb.a.v$c,Xa.a.frame,96),new Ob.a(Pb.a.Lig,Xa.a.frame,96),new Ob.a(Pb.a.Xig,Xa.a.frame,96),new Ob.a(Pb.a.uJf,Xa.a.frame,96),new Ob.a(Pb.a.hkf,Xa.a.frame,96),new Ob.a(Pb.a.ikf,Xa.a.frame,96),new Ob.a(Pb.a.jkf,Xa.a.frame,96),new Ob.a(Pb.a.kkf,
Xa.a.frame,96),new Ob.a(Pb.a.lkf,Xa.a.frame,96),new Ob.a(Pb.a.TWf,Xa.a.frame,96),new Ob.a(Pb.a.UWf,Xa.a.frame,96),new Ob.a(Pb.a.VWf,Xa.a.frame,96),new Ob.a(Pb.a.YYf,Xa.a.frame,96),new Ob.a(Pb.a.ZYf,Xa.a.frame,96),new Ob.a(Pb.a.$Yf,Xa.a.frame,96),new Ob.a(Pb.a.Oig,Xa.a.frame,96),new Ob.a(Pb.a.Yig,Xa.a.frame,96),new Ob.a(Pb.a.q0e,Xa.a.frame,96),new Ob.a(Pb.a.r0e,Xa.a.frame,96),new Ob.a(Pb.a.s0e,Xa.a.frame,96),new Ob.a(Pb.a.qPb,Xa.a.frame,96),new Ob.a(Pb.a.QIf,Xa.a.frame,96),new Ob.a(Pb.a.G2f,Xa.a.frame,
96),new Ob.a(Pb.a.$mf,Xa.a.frame,96)],Ta)}jJd(Ta,Ab,Db,ac,Pa){if(Ab.contextId===Xa.a.frame)switch(Ta){case Pb.a.tellMe:return this.tellMe(Ta,Ab,Db,ac,Pa);case Pb.a.Mig:return this.Fzh(Ta,Ab,Db,ac,Pa);case Pb.a.Rig:return this.tKi(Ta,Ab,Db,ac,Pa);case Pb.a.Uig:return this.PJi(Ta,Ab,Db,ac,Pa);case Pb.a.Tig:return this.pKi(Ta,Ab,Db,ac,Pa);case Pb.a.Pig:return this.y2a(Ta,Ab,Db,ac,Pa);case Pb.a.Wig:return this.n8n(Db);case Pb.a.Sig:return this.oKi(Ta,Ab,Db,ac,Pa);case Pb.a.Vig:return this.OJi(Ta,Ab,Db,
ac,Pa);case Pb.a.v$c:return this.o1h(Ta,Ab,Db,ac,Pa);case Pb.a.Lig:return this.ZHh(Ta,Ab,Db,ac,Pa);case Pb.a.Xig:case Pb.a.uJf:return this.YAf(Ta,Ab,Db,ac,Pa);case Pb.a.hkf:case Pb.a.ikf:case Pb.a.jkf:case Pb.a.kkf:case Pb.a.lkf:case Pb.a.TWf:case Pb.a.UWf:case Pb.a.VWf:case Pb.a.Yig:return this.MRa(Ta,Ab,Db,ac,Pa);case Pb.a.YYf:case Pb.a.ZYf:case Pb.a.$Yf:return this.u2a(Ta,Ab,Db,ac,Pa);case Pb.a.Oig:return this.tZi(Ta,Ab,Db,ac,Pa);case Pb.a.q0e:case Pb.a.r0e:case Pb.a.s0e:return this.c1d(Ta,Ab,
Db,ac,Pa);case Pb.a.qPb:return this.qPb(Ta,Ab,Db,ac,Pa);case Pb.a.QIf:return this.HFi(Ta,Ab,Db,ac,Pa);case Pb.a.G2f:return this.q6i(Ta,Ab,Db,ac,Pa);case Pb.a.$mf:return this.I3h(Ta,Ab,Db,ac,Pa)}return 2}o1h(Ta,Ab,Db){if(1===Db)return 32;this.Nnj();Ta=!1;(this.ic.TTa||this.EWa)&&(Ab=document.getElementById("SearchButton"))&&Ab.click();if(!this.ic.TTa&&this.EWa)for(Ab=document.getElementsByClassName("ms-suiteux-search-box"),Db=0;Db<Ab.length;Db++){const ac=Ab[Db].querySelector("input[type=search]");
ac&&(Ta=Qb.FocusManager.YJ(ac))}else Ta=Qb.FocusManager.YJ($get(this.ic.yr?n.CuiHelper.ofg:n.CuiHelper.Jle));this.Fvc=!0;return Ta?32:8}YAf(Ta,Ab,Db,ac,Pa){if(1===Db)return 32;if(Y.c(Pa))return this.Oe.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.Nnj();Ta=Pa.CommandValueId;Ab=this.ic.yr?n.CuiHelper.ofg:n.CuiHelper.Jle;this.ic.yr&&!Y.c(Pa[$b.a.qTa])&&(Pa[$b.a.qTa]=!1);if(Ta){if(this.ic.yr)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Ta)),this.J$a=
[19],32;if(Pa=$get(Ab))Pa.value=Ta}return Qb.FocusManager.YJ($get(Ab))?32:8}Nnj(){this.Ub.pL(this.ic.TTa||this.EWa?this.ic.eGb:this.ic.e6a,!1)}HLl(Ta,Ab){switch(Ta){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,Ab);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,Ab);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,Ab);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
Ab)}return Ab}ZHh(Ta,Ab,Db,ac,Pa){if(1===Db)return 32;if(Y.c(Pa))return this.Oe.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;Ta=this.eAa?this.eAa.Qej:0;Pa.Value=1!==Ta?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Ta):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.eAa)for(const bb of this.eAa.Upl)Pa=Object(k.a)(W.a,bb)?bb.id:Ha.a.replaceAll(bb.value,'"',""),(Pa=$get(Pa+"-"+I.a.Nig))&&dc.a.hr(Pa,dc.a.yfa,Ha.a.yf(this.HLl(bb.groupType,
Pa.innerText)));return 32}Fzh(Ta,Ab,Db,ac,Pa){if(1===Db)return 32;if(Y.c(Pa))return this.Oe.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.cTb=new pb.a(2,1,0,()=>{Pa[Ib.a.Callback]()},97);this.eAa&&this.Gb.Vb(this.cTb);return 32}tKi(Ta,Ab,Db,ac,Pa){if(1===Db)return 32;if(Y.c(Pa))return this.Oe.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;Pa.CloseAllMenus&&(Ta=void 0===Pa.ParentControlId||null===Pa.ParentControlId?"<NA>":Pa.ParentControlId,
Ab=this.DTb?this.DTb[Pa.ControlId]:null,!Ab&&this.DTb&&"<NA>"!==Ta&&(Ab=this.DTb[Ta]),Ab||(Ab=this.KWb&&this.E2.$Im(Pa),Ab=this.Sml(Ab,Pa.ControlId),Ab=new u(Ab,32,4,-1,-1,-1),this.Oe.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+Pa.ControlId+" determined group:"+V.a[Ab.groupType])),this.Oe.hnn(Pa.ControlId,Ta,Pa.CommandId,Pa.CloseAllMenus,Ab),this.qXa.jjn(Pa.ControlId),Pa.Location!==ia.a.contextMenu&&(this.E2.YYa(Pa),this.E2.JE(Ab.resultType),this.ic.Die&&this.ila.Ttk(Pa.CommandId)));
return 32}PJi(Ta,Ab,Db,ac,Pa){if(1===Db)return 32;(new va(this.TSd())).T$l(this.eUb);Ta=this.eUb;Ab=this.Xsa;Db=this.Oe.dhd;if(Y.c(Pa))return this.Oe.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;Pa=Pa.UILocation;Ta&&0<Ta.length&&this.Nvc&&I.a.ndg(this.ic)&&this.ic.d0d&&19!==Pa&&Ab>Db&&!this.ic.rP&&(this.Oe.eLf(Ta),this.Oe.Cag(Ab));this.Oe.$6n();this.ic.Ooe&&19!==Pa&&(this.yK.mark(3),this.yK.measure(1,0,3),this.yK.measure(2,2,3),this.yK.RKf(0,1,2),this.yK.RKf(2,2,3),this.yK.RKf(1,
0,3),this.yK.iZk(),this.yK.clearMeasures([0,2,1]));this.Oe.Onn(window.performance.now()-this.EKe);this.ic.yr&&(this.h$a=null,this.Oe.wxa());this.Fvc=this.$Vb=!1;this.eUb="";return 32}pKi(Ta,Ab,Db){if(1===Db)return 32;this.Oe.omb(z(Ab),this.Fvc);return 32}oKi(Ta,Ab,Db){if(1===Db)return 32;this.Oe.wxa();this.$Vb=!1;return 32}OJi(Ta,Ab,Db,ac,Pa){if(1===Db)return 32;this.PZ=null;Pa&&(this.PZ=Pa);this.ic.Ooe&&(Y.c(this.PZ)||this.PZ.Location!==ia.a.contextMenu)&&this.yK.mark(0);this.Oe.Fhe(Y.c(this.PZ)||
Y.c(this.PZ.Location)?ia.a.unknown:this.PZ.Location);this.Oe.Nnn(this.R6g,this.Fvc);this.$Vb||this.N4a();return 32}CLh(Ta,Ab){const Db=[],ac=Date.now();for(let Pa of Ta)Ta=(ac-Pa.timeStamp)/1E3,Ta=I.a.Ume(Ta),Array.add(Db,new U(Ab?Pa.commandId:Pa.controlId,Ta));return Db}lgl(Ta){const Ab=[],Db=Date.now();for(let ac of Ta)if(ac.controlId||"keyboardShortcut"===ac.commandSurface)Ta=(Db-ac.timeStamp)/1E3,Ta=I.a.Ume(Ta),Array.add(Ab,new aa(ac.controlId,ac.commandId,Ta,ac.commandSurface,ac.Nle));return Ab}mMh(Ta=
!1){var Ab=Ta?this.E2.N$l():this.E2.ZNc();Ta=[];const Db=Date.now();for(const ac of Ab)Ab=(Db-ac.TimeStamp)/1E3,Ab=I.a.Ume(Ab),Array.add(Ta,new U(ac.Id,Ab));return Ta}N4a(){if(!this.$Vb){this.KWb=this.$Vb=!0;""!==this.ic.P9f&&N.AFrameworkApplication.Dn(this.ic.P9f);if(!this.A2g){this.A2g=!0;const Ta={};Ta.IsMLREnabled=this.ic.UOm;Ta.IsReactRibbonEnabled=this.ic.yr;Ta.IsSharedHeaderEnabled=!!N.AFrameworkApplication.ta&&N.AFrameworkApplication.ta.Nb.xJ;Ta.IsSearchUxEnabled=this.EWa;Ta.IsTellMeInHeaderEnabled=
this.ic.TTa;Ta.IsGoLocalEnv=I.a.iMm();Ta.IsSovereignEnvironment=I.a.Ybc();Ta.IsTellMeServiceResultsEnabled=I.a.ndg(this.ic);Ta.IsSubstrateProviderEnabled=I.a.mdg(this.ic);Ta.ShouldFetchTokens=!!N.AFrameworkApplication.ta&&N.AFrameworkApplication.ta.Nb.YOb;Ta.IsSerpletEnabled=I.a.Moa();Ta.FirstOnClickTimeInMS=Math.round(window.performance.now());Ta.IsHeaderHidden=N.AFrameworkApplication.hideHeader||N.AFrameworkApplication.MX;Ta.IsSearchInHeaderHidden=N.AFrameworkApplication.uRc;void 0!==window.performance.timing&&
null!==window.performance.timing&&(Ta.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));Ta.IsFindWithMatchesEnabled=this.ic.nMd;Ta.HelpShowsTopSearchResult=this.ic.o8c;Ta.HelpShowsNumberOfMatches=this.ic.n8c;N.AFrameworkApplication.K&&(Ta.UiHost=N.AFrameworkApplication.K.jb("UiHostIntegrationType"));this.Oe.T7m(JSON.stringify(Ta))}this.iwe=this.CLh(y.a.instance.QNc(),!1);this.yPg=this.CLh(y.a.instance.jhb(),!0);this.Qkh=this.lgl(y.a.instance.jhb());this.D7g=this.mMh();
this.E7g=this.mMh(!0);this.Oe.N4a()}}y2a(Ta,Ab,Db,ac,Pa){if(1===Db)return 32;if(Y.c(Pa))return this.Oe.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(ob.a.PUc)return 32;this.EKe=window.performance.now();this.N4a();Ta=new ba(Object(a.a)(this,this.Cxa,"onRequestCompleted"),0);this.Xsa++;this.Oe.beginQuery("",this.Xsa,this.KWb);this.Cmg(!0,null);this.eAa=ab.lKd;this.h$a=ja.Ihf;if(this.ila)rc.instance.actions=[],this.ila.PH(new X("",this.Xsa),Ta,this.ic.yr);else this.Oe.onError("TellMeActor:ExecuteTellMeQuery",
"Aggregator provider not resolved yet");this.cTb&&this.Gb.Vb(this.cTb);return 32}n8n(Ta){if(1===Ta)return 32;this.Ub.CR(this.ic.TTa||this.EWa?this.ic.eGb:this.ic.e6a,!1);return 32}tellMe(Ta,Ab,Db,ac,Pa){if(1===Db)return 32;if(Y.c(Pa))return this.Oe.onError("TellMeActor:TellMe","actiondata comes null"),16;this.PZ=Pa;this.Oe.Fhe(Y.c(this.PZ.Location)?ia.a.unknown:this.PZ.Location);Ta=this.PZ.Value;this.ic.yr||Ta&&""!==Ta.trim()?(!this.h$a&&this.ic.yr&&(this.Oe.omb(z(Ab),this.Fvc),this.N4a()),this.Xyl(Ta,
this.PZ.Location),this.PZ.PopulationXML=this.eAa.xml):this.KWb?this.PZ.PopulationXML=this.eAa.xml:(this.PZ.PopulationXML=ab.lKd.xml,this.h$a=ja.Ihf,this.eUb="");return 32}Xyl(Ta,Ab){this.EKe=window.performance.now();this.ic.Ooe&&Ab!==ia.a.contextMenu&&this.yK.mark(1);this.ic.yr&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Ta));Ta&&0<Ta.trim().length&&(this.KWb=!1);this.ic.uxl();Ab=Y.c(Ab)?ia.a.tellMe:Ab;if(Ta!==this.eUb||this.ic.yr){this.Xsa++;this.Oe.beginQuery(Ta,this.Xsa,this.KWb);
this.Cmg(!0,null);const Db=new X(Ta,this.Xsa),ac=new ba(Object(a.a)(this,this.Cxa,"onRequestCompleted"),this.Xsa);this.eAa=ab.lKd;this.h$a=ja.Ihf;if(this.ila)rc.instance.actions=[],this.ila.PH(Db,ac,this.ic.yr,Ab,this.J$a),this.J$a=null;else this.Oe.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.R6g=this.Xsa;this.eUb=Ta}}FXo(Ta){if(this.ic.yr){var Ab=appChrome.selectors.getActiveControlStates();if(Ab=Object(x.a)(Object,Ab[Ta.value])){Ta.label=Ab.label;let Db=
null;"description"in Ab&&(Db=Ab.description);Db&&Object.getType(Db)===String?Ta.description=Db:"secondaryText"in Ab?Ta.description=Ab.secondaryText:"fullDescriptionLabel"in Ab&&(Ta.description=Ab.fullDescriptionLabel)}}}TEn(Ta){this.DTb={};let Ab=0,Db=0;for(const ac of Ta){Ta=0;for(const Pa of ac.results)this.DTb[Pa.value]=new u(Pa.groupType,Pa.type,Pa.Uwj,Ab,Ta,Db),Ta++,Db++,Pa.label||5!==Pa.type||this.FXo(Pa);0<Ta&&Ab++}}Afc(Ta,Ab,Db,ac,Pa){if(1===Db)return 32;if(Y.c(Pa))return this.Oe.onError("TellMeActor:OpenUrlInNewTab",
"actiondata comes null"),16;(Ta=Pa.CommandValueId)&&window.open(Ta,"_blank");return 32}VFi(Ta){const Ab={};Ab.token=this.gfg;Ab.files=la.c(Ta);Ab.type="MultiFilesDeckGeneration";if(N.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.ga.Qb(Pb.a.dZm,2,Ab),!0;Ta=I.a.Zgi("",I.a.Sej("GenerateDeckFromFile"),Object.assign(new hc.a,{landingTab:"All",data:Ab}));Ta=this.ga.Qb(Pb.a.F8,2,Ta);return 32!==Ta?(this.Oe.onError("LaunchSmartLookupWithFilesData",
"CommonCommands.InvokeSerplet failed. Response: "+Ta+"."),!1):!0}q6i(Ta,Ab,Db,ac,Pa){if(1===Db)return 32;if(Y.c(Pa))return this.Oe.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Ub.Elf();if(Ta=Pa.TerminalParentControlId){Ta=this.eTb.J(Ta);if(!Ta)return 16;Ab=[];Array.add(Ab,Ta);if(!this.VFi(Ab))return 8}return 32}I3h(){if(!this.eTb.count)return 16;const Ta=[];for(let Ab of this.eTb.values)Array.add(Ta,Ab);return this.VFi(Ta)?32:8}u2a(Ta,Ab,Db,ac,Pa){if(1===Db)return 32;
if(Y.c(Pa))return this.Oe.onError("TellMeActor:InsertMention","actiondata comes null"),16;Ta=Pa.UILocation;let bb;Pa=Pa.CommandValueId;try{bb=la.a(Pa)}catch(lc){return this.Oe.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return Y.c(bb)?(this.Oe.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):Y.c(this.Cuc)?(this.Oe.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==Ta?(this.Oe.onError("TellMeActor:InsertMention",
"location "+Ta+" is unexpected"),16):this.Cuc.u2a(bb.displayName,bb.email,bb.userId)?32:(this.Oe.onError("TellMeActor:InsertMention","mention is not inserted"),16)}MRa(Ta,Ab,Db,ac,Pa){return 1===Db?32:Y.c(Pa)?(this.Oe.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===Pa.UILocation?this.WDm(Db,Pa):this.Afc(Ta,Ab,Db,ac,Pa)}tZi(Ta,Ab,Db,ac,Pa){if(1===Db)return 32;if(Y.c(Pa))return this.Oe.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.Jp&&window.setTimeout(()=>
{this.Jp.execute(bb=>{bb.QHa("TellMeSurvey",null)})},rc.dBl);return 32}WDm(Ta,Ab){if(1===Ta)return 32;if(Y.c(Ab))return this.Oe.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(Y.c(this.Cuc))return this.Oe.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;Ta=Ab.CommandValueId;return Y.c(Ta)?(this.Oe.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.Cuc.insertHtmlText(Ta)?32:(this.Oe.onError("TellMeActor:InsertUrl","url is not inserted"),16)}Cxa(Ta,
Ab,Db,ac,Pa){Db=window.performance.now();this.TEn(Ab);this.Oe.Yko(Ab);this.ic.yr?(this.h$a=this.vKe.bLl(Ab,Ta,Pa),this.ic.$va?(this.VY.push(appChrome.actions.updateTellMeSearchResults(this.h$a.menuModel,Ta,Pa)),appChrome.api.dispatch(this.VY)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.h$a.menuModel,Ta,Pa)),this.ic.Ooe&&this.$Vb&&(Y.c(this.PZ)||this.PZ.Location!==ia.a.contextMenu)&&(this.yK.mark(2),this.yK.measure(0,1,2))):this.eAa=this.imh.cLl(Ab,this.Oe.Xpa);this.cTb&&
this.Gb.Vb(this.cTb);Pa={};Pa.GroupsCount=Ab.length;Pa.QueryID=ac;Pa.QueryLength=Ta.length;this.Oe.MA(E.a.cel,window.performance.now()-Db,Pa)}Sml(Ta,Ab){return Ab.startsWith(this.ic.yr?I.a.rlg:I.a.jne)?5:Ta?4:"bSearchHelp"===Ab||Ab.startsWith("GetHelpFromTellMe")?8:"bInsights"===Ab||Ab.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===Ab?24:Ab===this.ic.Bkf?2:0}JE(Ta,Ab){this.ila?this.ila.JE(Ta,Ab):Array.add(this.psd,new G(Ta,Ab))}HFi(Ta,Ab,Db,ac,Pa){if(1===Db)return 32;if(Y.c(Pa))return this.Oe.onError("TellMeActor:LaunchAddinStore",
"actiondata comes null"),16;if(this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){Ta={};Ta.SourceControlId=Pa.SourceControlId;Ta.Query=Pa.CommandValueId;Pa=this.ga.Qb(Pb.a.uXc,2,Ta);if(32!==Pa)this.Oe.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+Pa+".");return Pa}return this.ga.Qb(Pb.a.uXc,2,Pa)}c1d(Ta,Ab,Db,ac,Pa){({AddinResultsProvider:Ta}=c(1654));if(1===Db)return 32;if(Y.c(Pa))return this.Oe.onError("TellMeActor:LaunchAddin",
"actiondata comes null"),16;Db=Pa.CommandValueId;if(Y.b(Db))return this.Oe.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!Ta.Azb[Db])return this.Oe.onError("TellMeActor:LaunchAddin","Add-in with assetId "+Db+" doesn't not exist in entitlements"),16;Pa=c(1654).AddinResultsProvider.Azb[Db];Ta={};Ta.solutionId=Pa.id;Ta.version=Pa.appVersion;Ta.storeType=Pa.storeType;Ta.storeId=Pa.storeId;Ta.assetId=Pa.assetId;Ta.assetStoreId=Pa.assetStoreId;Ta.displayName=Pa.displayName;Ta.targetType=
Pa.targetType;Ta.height=Pa.height;Ta.width=Pa.width;Pa=this.ga.Qb(Pb.a.LAf,2,Ta);if(32!==Pa)this.Oe.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+Pa+". AssetId: "+Db);return Pa}qPb(){if(!Y.c(this.Jp))for(let Ta of y.a.instance.jhb()){if("ShowContextMenuWithFloatie"===Ta.commandId)return this.Jp.execute(Ab=>{Ab.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(Ta.commandId&&-1===Ta.commandId.indexOf("Tab"))break}return 8}Cmg(Ta,Ab="",Db=null){Ta?
this.eTb=new l.a(f.a.Fh()):Ab&&Db&&this.eTb.add(Ab,Db)}static get instance(){return rc._instance||(rc._instance=new rc)}}rc._instance=null;rc.qJo="mso_tellMeService";rc.unknown="Unknown";rc.dBl=500;Object(F.a)(rc,"TellMeActor",null,[])},1501:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);var l=c(1515);class f{constructor(a,k){this.Rab=!1;const {Annotations:x}=c(1495);if(!a)throw Error.argumentNull("annotations");if(!a.vHf(k))throw Error.argument("memberTypeID","Invalid type ID");if(x.fI(k))throw Error.argument("memberTypeID",
"Lists of lists are not permitted");this.ww=a;this.Hbk=k;this.hp=[]}get j1b(){return this.ww}get isReadOnly(){return this.Rab}get y4(){return this.Hbk}get items(){return this.hp}Pda(){const {Annotations:a}=c(1495);let k="[";for(let x=0,y=this.items.length;x<y;++x){0<x&&(k+=", ");const n=this.ww.Pda(this.y4,this.items[x]);this.y4===a.i$?(k+='"',k+=l.a.Uif(n),k+='"'):k+=n}return k+"]"}isEqual(a){const {Annotations:k}=c(1495);if(this===a)return!0;if(!a||a.j1b!==this.ww||a.y4!==this.y4||a.items.length!==
this.items.length)return!1;for(let x=0;x<this.items.length;++x)if(!k.Jqb(this.y4,this.items[x],a.items[x]))return!1;return!0}clone(){const a=new f(this.ww,this.y4);Array.addRange(a.items,this.items);return a}kT(){return this.isReadOnly?this.clone():this}rKf(){const {Annotations:a}=c(1495);if(!this.isReadOnly){this.Rab=!0;for(const k of this.items)a.pJb(k)}}toString(){return this.Pda()}}Object(F.a)(f,"ListValue",null,[1342,1338])},1502:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}
l.tellMe="TellMe";l.contextMenu="ContextMenu";l.unknown="Unknown";Object(F.a)(l,"TellMeScenario",null,[])},1504:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a,k=null,x=null,y=4,n=-99999,u=0){this.KI="";this.pAd=-1;this.value=f;this.type=a;this.Uwj=y;this.label=this.$C=k;this.groupType=30;this.description=x;this.score=n;this.count=u}}Object(F.a)(l,"ResultBinding",null,[])},1507:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f){this.attributes=
null;this.query=f;this.ko=[]}Yu(f){this.ko.push(f)}Maj(f){const a=[];for(const k of this.ko)k.groupType!==f&&a.push(k);this.ko.length!==a.length&&(this.ko=a)}get Ebc(){return!1}}Object(F.a)(l,"SimpleResultsUpdatedEventArgs",null,[1229])},1508:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f=30,a=""){this.XL=[];this.groupType=f;this.displayName=a}get results(){return this.XL}Ow(f){f.groupType=this.groupType;Array.add(this.results,f)}J5f(f=1){if(this.results.length>=f)for(let a=
0;a<f;a++)Array.removeAt(this.results,this.results.length-1)}}Object(F.a)(l,"SimpleResultGroup",null,[1228])},1515:function(F,K,c){F=c(0);class l{constructor(a,k){this.$db=a;this.value=k}}Object(F.a)(l,"AttrValuePair",null,[]);c.d(K,"a",function(){return f});class f{constructor(a){this.Rab=!1;if(!a)throw Error.argumentNull("annotations");this.ww=a;this.mY=[]}get j1b(){return this.ww}get isReadOnly(){return this.Rab}get ixf(){return 0<this.mY.length}Iq(a){if(!this.ww.mcc(a))throw Error.argument("attributeID",
"Invalid attribute ID");for(const k of this.mY)if(a===k.$db)return a=k.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}Iy(a,k){var {Annotations:x}=c(1495);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.ww.mcc(a))throw Error.argument("attributeID","Invalid attribute ID");if(!this.ww.hbc(this.ww.getAttributeType(a),k))throw Error.argument("value","Value is not of the correct type for the specified attribute");x.pJb(k);
for(x=0;x<this.mY.length;++x){const y=this.mY[x];if(a===y.$db){y.value=k;return}}Array.add(this.mY,new l(a,k))}xSa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.ww.mcc(a))throw Error.argument("attributeID","Invalid attribute ID");for(let k=0;k<this.mY.length;++k)if(a===this.mY[k].$db){Array.removeAt(this.mY,k);break}}lNd(a){if(!a)throw Error.argumentNull("action");for(const k of this.mY)a(k.$db,k.value)}clone(){const a=new f(this.ww);
a.o_a(this);return a}o_a(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.j1b!==this.ww)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.mY);a.lNd((k,x)=>{this.Iy(k,x)})}Pda(){const {Annotations:a}=c(1495);let k="[",x=!0;for(const y of this.mY){x?x=!1:k+=", ";k+=this.ww.T4h(y.$db);k+="=";const n=this.ww.getAttributeType(y.$db),u=this.ww.Pda(n,y.value);n===a.i$?(k+=
'"',k+=f.Uif(u),k+='"'):k+=u}return k+"]"}isEqual(a){const {Annotations:k}=c(1495);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.ww!==a.j1b||this.ixf!==a.ixf)return!1;let x=0,y=null,n=!1;a.lNd((u,z)=>{++x;if(!n){var w=-1;for(let E=0,G=this.mY.length;E<G;++E)if(this.mY[E].$db===u){w=E;break}0>w?n=!0:(y||(y=Array(this.mY.length)),y[w]=z)}});if(this.mY.length!==x||n)return!1;for(let u=0,z=this.mY.length;u<z;++u)if(!k.Jqb(this.ww.getAttributeType(this.mY[u].$db),this.mY[u].value,
y[u]))return!1;return!0}kT(){return this.isReadOnly?this.clone():this}rKf(){const {Annotations:a}=c(1495);if(!this.isReadOnly){this.Rab=!0;for(const k of this.mY)a.pJb(k.value)}}toString(){return this.Pda()}static Uif(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(F.a)(f,"FeatureBundle",null,[1337,1338])},1520:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}l.click="Click";l.y2a="InteractionBegin";l.cHb="InteractionEnd";l.dJh="ControlActivated";
l.query="Query";l.Q5i="QueryIndexRecorded";l.cGh="Clicks";l.Umh="ActionEvents";l.h_h="FilteredActionEvents";l.$jj="SessionContext";l.latency="Latency";l.performance="Performance";l.Gcj="RenderedResults";l.events="Events";l.cel="CreateResultsMenu";l.WG="UpdateRibbonControls";l.F8n="ResultsAggregation";l.PH="IssueQuery";l.L1k="CommandSuggestions";l.error="Error";l.eKf="LoadModelData";l.xll="DepsResolveTime";l.bfn="ModelDataWaitTime";l.timedOut="TimedOut";l.wAk="AddinQueryCommandReady";l.jMl="GetAddinEntitlements";
l.n5i="ProviderMRUEvents";l.Oul="EnableAddinSearchCommands";Object(F.a)(l,"EventNames",null,[])},1522:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.bMf=null;this.Aca=this.dMf=0}ymf(f,a,k){if(!f)throw Error.argumentNull("referenceList");if(0>a||a>f.length)throw Error.argumentOutOfRange("startIndex");if(0>k||k>f.length)throw Error.argumentOutOfRange("length");if(a+k>f.length)throw Error.argument("Invalid start-length range");this.bMf=f;this.dMf=a;this.Aca=k}ehb(f,
a,k){this.ymf(f.bMf,f.dMf+a,k)}J(f){if(0>f||f>=this.Aca)throw Error.argumentOutOfRange("index");return this.bMf[this.dMf+f]}get count(){return this.Aca}static Dbf(f){const a=new l;a.ymf(f,0,f.length);return a}}Object(F.a)(l,"ReadOnlyList",null,[1367])},1530:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);var l;(function(f){f[f.Classifier=0]="Classifier";f[f.AppsForOffice=1]="AppsForOffice";f[f.FindInDocument=2]="FindInDocument";f[f.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";
f[f.RecentlyUsed=4]="RecentlyUsed";f[f.TryQuery=5]="TryQuery";f[f.Empty=6]="Empty";f[f.TryCommand=7]="TryCommand";f[f.Assistance=8]="Assistance";f[f.Answer=9]="Answer";f[f.Definition=10]="Definition";f[f.Entity=11]="Entity";f[f.WolframAnswer=12]="WolframAnswer";f[f.Insights=13]="Insights";f[f.People=14]="People";f[f.Document=15]="Document";f[f.Recommended=16]="Recommended";f[f.ServiceClassifier=17]="ServiceClassifier";f[f.ServiceRecommended=18]="ServiceRecommended";f[f.Image=19]="Image";f[f.Notes=
20]="Notes";f[f.Learning=21]="Learning";f[f.Feedback=22]="Feedback";f[f.Template=23]="Template";f[f.ActionAI=24]="ActionAI";f[f.ActionAICommand=25]="ActionAICommand";f[f.SummarizeDeck=26]="SummarizeDeck";f[f.Addin=27]="Addin";f[f.OfficeScript=28]="OfficeScript";f[f.AddinStoreEntry=29]="AddinStoreEntry";f[f.None=30]="None";f[f.MergedActions=31]="MergedActions";f[f.MergedScopedSearches=32]="MergedScopedSearches";f[f.MergedSuggestedSearches=33]="MergedSuggestedSearches"})(l||(l={}));Object(F.b)("ResultGroupType",
l)},1537:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(1588);class l extends c.a{constructor(){super();this.info=this.rj=this.eventId=null}get uga(){return"Misc"}xEb(){this.detail.Z("Type",this.uga);this.detail.Z("EventId",this.eventId);this.detail.Z("Func",this.rj);this.detail.Z("Info",this.info);return this.detail}}Object(F.a)(l,"BasicMergeFailureDetail",c.a,[])},1538:function(F,K,c){c.d(K,"a",function(){return k});F=c(0);var l=c(598),f=c(798),a=c(1554);class k{constructor(x,y=!0){this.wm=
y&&x?x.KK():x;this.x_b=new l.a}rC(x){this.x_b.add(f.a.yb(x))}qpo(x){this.x_b=x}MOi(x){this.wm&&(new a.a(this.wm,x)).Spa.forEach((y,n)=>{n.aY&&!this.x_b.contains(y)&&(this.x_b.add(y),n.isDeleted?(n=this.wm,n.hasProperty(f.a.uX(y))&&n.removeProperty(f.a.uX(y))):this.wm.fTa(f.a.uX(y),n.newValue));return!0})}}Object(F.a)(k,"PartialMergeResult",null,[])},1539:function(F,K,c){c.r(K);c.d(K,"CommandResultsUtility",function(){return z});F=c(0);var l=c(1549),f=c(1520),a=c(1550),k=c(1504),x=c(1508),y=c(1500),
n=c(1499),u=c(2);class z{static cbd(w,E){if(E&&E.yr){const G={};for(const H of w)E.t0d(H)&&(G[H]=appChrome.selectors.getModelType(H));y.TellMeActor.instance.WG(G)}}static CJo(w){return w.startsWith("btnTellMeOfficeAddIn")}static UTc(w){const E=y.TellMeActor.instance.BO();return!!E&&E.yr&&!appChrome.selectors.isControlDisabled(w)}static Y2d(w,E,G,H){if(y.TellMeActor.instance.Oe&&w){const L=[];for(const I of w)L.push(String.format('{{"Id":"{0}","Score":{1}}}',I.commandId,I.score));w={};w[l.a.suggestions]=
"[{"+L.join(",")+"}]";w[l.a.tEi]=E;w[l.a.groupType]=G;w[l.a.provider]=H;y.TellMeActor.instance.Oe.MA(f.a.L1k,window.performance.now(),w)}}static fTl(w,E){const G=[],H=[];for(const L of E){E=L.commandId;let I=L;L.commandId in w&&(E=w[L.commandId],I=new a.a(E,L.score));Array.contains(H,E)||(G.push(I),H.push(E))}return G}static JPc(w,E,G,H,L,I,N,Q){G.fpf&&(E=z.fTl(G.fpf,E));var M=n.a.xRl(E);z.cbd(M,G);var J=[],V=[];M=[];const X=new x.a(N);N=16===N||18===N||7===N||4===N?u.AFrameworkApplication.K?u.AFrameworkApplication.K.mc("TellMeMaxRecommendedResultsToReturn",
3):3:0===N||17===N||25===N?5:0;for(const W of E)if(!z.YIm(W.commandId)){E=z.CJo(W.commandId);if(G.t0d(W.commandId)&&!E){if(n.a.bDi(W.commandId))continue;E=null;L&&I&&(E=L.y8l(W.commandId,I));z.UTc(W.commandId)?Array.add(J,new k.a(W.commandId,5,E,null,Q,W.score)):Array.add(V,new k.a(W.commandId,5,E,null,Q,W.score))}else G.Izb&&E&&H&&Array.add(M,W.commandId.substr(21));if(J.length+M.length>=N)break}G=0;for(L=0;L<J.length&&G<N;L++,G++)X.Ow(J[L]);for(J=0;J<V.length&&G<N;J++,G++)X.Ow(V[J]);for(V=0;V<M.length&&
G<N;V++,G++)H.bqp(w,M[V],X);return X}static YIm(w){z.Twh||(u.AFrameworkApplication.K&&u.AFrameworkApplication.K.Sw("TellMeControlPredictionBlockList")&&u.AFrameworkApplication.K.LC("TellMeControlPredictionBlockList").forEach(E=>{Array.add(z.Swh,E.toLowerCase())}),z.Twh=!0);return Array.contains(z.Swh,w.toLowerCase())}static nCf(w){return 2<w.length&&";"===w.charAt(0)&&";"===w.charAt(w.length-1)&&!!u.AFrameworkApplication.K&&(u.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",
!1))}static K6h(w){const E=new x.a(0);var G=w.split(";");w=y.TellMeActor.instance.BO();for(const H of G)if(0<H.length){G=H.split(":");const L=2===G.length?G[0]:H;if(!w.t0d(L))break;if(1===G.length)G=new k.a(L,5,null,null,1),E.Ow(G);else if(2===G.length)G=new k.a(L,5,G[1],null,1),E.Ow(G);else break}return E}static vtk(w,E,G){if(!(E&&E.results&&w&&w.results&&w.results.length))return{returnValue:!1,uZe:w,m_e:E};const H=[];for(var L of E.results)Array.add(H,L.value);L=0;const I=0<E.results.length?E.results[0].score:
0;for(const N of w.results)if(N.score>G&&!Array.contains(H,N.value)&&z.UTc(N.value)&&(0<I&&(N.score=I),Array.insert(E.results,L,N),L++),2===L)break;return 0<L?(G=E.results.length-5,0<G&&E.J5f(G),{returnValue:!0,uZe:w,m_e:E}):{returnValue:!1,uZe:w,m_e:E}}}z.Twh=!1;z.Swh=[];Object(F.a)(z,"CommandResultsUtility",null,[])},1548:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{static tLo(f){return f.toString().charCodeAt(0)}static aUm(f){return 55296<=f&&57343>=f}static charAt(f,a){return f.charAt(a)}static Wuh(f,
a){if(f===a)return!0;"\u00a0"===f&&(f=" ");"\u00a0"===a&&(a=" ");return f===a}static Vuh(f,a){if(f===a)return!0;if(!f||!a||f.length!==a.length)return!1;f=l.Qcj(f);a=l.Qcj(a);return f===a}static Qcj(f){return f.replace(l.XYc," ")}static vpb(f,a,k){return f.substring(a,a+k)}}l.XYc=RegExp("\u00a0","g");Object(F.a)(l,"CharUtils",null,[])},1549:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}l.appName="AppName";l.r3="CloseAllMenus";l.commandId="CommandId";l.context="Context";l.culture=
"Culture";l.message="Message";l.errorMessage="ErrorMessage";l.event="Event";l.roa="CorrelationID";l.kBn="ParentUiElement";l.query="Input";l.rMb="QueryID";l.V5i="QueryLength";l.Pgc="QueryIndex";l.G8n="ResultsList";l.suggestions="Suggestions";l.scenario="Scenario";l.sessionId="SessionID";l.source="Source";l.timeStamp="Time";l.UDj="UiElement";l.Pce="ReactUx";l.value="Val";l.statusCode="StatusCode";l.service="Service";l.isSuccess="IsSuccess";l.eMo="TokenAcquired";l.JYm="LatencyType";l.groupName="GroupName";
l.x8="GroupIndex";l.groupType="GroupType";l.C8n="ResultInfoList";l.resultType="ResultType";l.chg="SubResultType";l.rNm="IsInputBlur";l.sNm="IsInputFocus";l.kTm="IsShortCutUsed";l.actionType="ActionType";l.count="Count";l.atl="DwellTime";l.tEi="IsZeroTerm";l.s8o="WordsCount";l.G_d="IsSearchUxEnabled";l.AUm="IsTellMeInHeaderEnabled";l.module="Module";l.resultIndex="ResultIndex";l.Lff="DisplayIndex";l.Xul="EnableList";l.provider="Provider";l.contentType="ContentType";l.KSm="IsSelectionBased";l.JKk="BeginPerformanceMarker";
l.vvl="EndPerformanceMarker";l.jDn="PerformanceMeasure";Object(F.a)(l,"Columns",null,[])},1550:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a){this.commandId=f;this.score=a}}Object(F.a)(l,"CommandSuggestion",null,[])},1554:function(F,K,c){F=c(0);var l=c(364),f=c(798),a=c(242),k=c(55);class x{constructor(n,u,z){this.Igk=n;this.bdk=u;this.tck=z;this.zFe=new a.a(Object(k.a)(this,this.HWk,"checkIfDifferent"))}get pnb(){return this.Igk}get oldValue(){return this.bdk}get newValue(){return this.tck}get xjb(){return!(void 0===
this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get aY(){return this.xjb||this.isDeleted||this.zFe.value}HWk(){return this.xjb||this.isDeleted?!0:!f.a.cvh(this.pnb,this.oldValue,this.newValue)}}Object(F.a)(x,"PropertyDiff",null,[]);c.d(K,"a",function(){return y});class y{constructor(n,u){this.Zck=n;this.qck=u;this.zFe=new a.a(()=>this.eUc());this.Kgk=
new a.a(Object(k.a)(this,this.gyl,"evaluatePropertyDiffs"))}get lu(){return this.Zck}get wf(){return this.qck}get xjb(){return!!this.wf&&!this.lu}get isDeleted(){return!this.wf&&!!this.lu}get aY(){return this.xjb||this.isDeleted||this.zFe.value}get Spa(){return this.Kgk.value}eUc(n=null){let u=!1;this.Spa.forEach((z,w)=>{u=w.aY&&(!n||7!==n.J(z));return!u});return u}gyl(){const n=new l.a;var u=this.wf,z=this.lu;if(this.xjb){z=u.Hl();for(var w=0;w<z.length;w++){var E=z[w];n.Z(f.a.yb(E),new x(E,null,
u.CX(E)))}}else if(this.isDeleted)for(u=z.Hl(),w=0;w<u.length;w++)E=u[w],n.Z(f.a.yb(E),new x(E,z.CX(E),null));else{w=z.Hl();for(E=0;E<w.length;E++){var G=w[E],H=f.a.yb(G),L=z.CX(G);const I=u.hasProperty(G)?u.CX(G):null;n.Z(H,new x(G,L,I))}w=u.Hl();for(E=0;E<w.length;E++)G=w[E],z.hasProperty(G)||(H=f.a.yb(G),L=u.CX(G),n.Z(H,new x(G,null,L)))}return n}}Object(F.a)(y,"MergeableObjectDiff",null,[])},1564:function(F,K,c){c.d(K,"b",function(){return x});c.d(K,"a",function(){return n});var l=c(221),f=c(364),
a=c(598),k=c(1722);const x=(z,w,E)=>{const G=y(z,w,E);let H=0,L=0,I=0,N=new k.a;const Q=new l.a;for(let M=0;M<G.length;M++){const J=G.$f(M+1);N.LAd(z.$f(H));N.NAd(w.$f(L));N.RAd(E.$f(I));H++;L++;for(I++;H<z.length&&(!J||!J.equals(z.$f(H)));)N.LAd(z.$f(H)),H++;for(;L<w.length&&(!J||!J.equals(w.$f(L)));)N.NAd(w.$f(L)),L++;for(;I<E.length&&(!J||!J.equals(E.$f(I)));)N.RAd(E.$f(I)),I++;Q.add(N);N=new k.a}for(;H<z.length;)N.LAd(z.$f(H)),H++;for(;L<w.length;)N.NAd(w.$f(L)),L++;for(;I<E.length;)N.RAd(E.$f(I)),
I++;N.isEmpty||Q.add(N);return Q},y=(z,w,E)=>{const G=new l.a,H=w.TG(),L=E.TG();z.forEach(I=>{H.contains(I)&&L.contains(I)&&G.add(I);return!0});return G},n=(z,w,E)=>{z=z||new l.a;w=w||new l.a;E=E||new l.a;const G=new l.a,H=new f.a(0),L=new a.a;for(var I=0;I<z.length;I++){var N=z.$f(I);H.Z(N,I)}for(z=I=0;I<w.length&&z<E.length;){N=w.$f(I);let Q=E.$f(z),M=H.pz(N,-1),J=H.pz(Q,-1);-1===M?(u(L,G,N),I++):-1===J?(u(L,G,Q),z++):M===J?(u(L,G,N),I++,z++):M<J?I++:z++}for(;I<w.length;I++)N=w.$f(I),-1===H.pz(N,
-1)&&u(L,G,N);for(;z<E.length;z++)w=E.$f(z),-1===H.pz(w,-1)&&u(L,G,w);return G},u=(z,w,E)=>{z.contains(E)||(w.add(E),z.add(E))}},1565:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);var l=c(58);class f{constructor(){this.cp=0;this.id=l.a.create()}}Object(F.a)(f,"LcsUpdateHint",null,[1507,72])},1566:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}l.tellMe="TellMe";l.loki="Loki";l.substrate="Substrate";l.Pgc="QueryIndex";l.Nyj="TellMeRanker";l.Oyj="TellMeRankerLogging";Object(F.a)(l,
"Services",null,[])},1567:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}l.IPa="HttpRequest";l.provider="Provider";Object(F.a)(l,"LatencyTypes",null,[])},1570:function(F,K,c){F=c(0);var l=c(16),f=c(6),a=c(221),k=c(165),x=c(237),y=c(58),n=c(598),u=c(55),z=c(234),w=c(1588);class E extends w.a{constructor(){super();this.QSa=null}get uga(){return"CreateMergeBlock"}xEb(){this.detail.Z("Type",this.uga);this.detail.Z("Revision",this.QSa);return this.detail}}Object(F.a)(E,"CreateMergeBlockFailureDetail",
w.a,[]);var G=c(1635),H=c(1637),L=c(1721),I=c(1589),N=c(1538),Q=c(1782);c.d(K,"a",function(){return M});class M{static dHd(J,V,X,W,U,Y,ba){let aa;aa="";const fa=new a.a;for(let oa=0;oa<X.length;oa++){var na=void 0;let ja;na=G.a.xTl(V,X.J(oa),W,U,Y,ba,J);if(!na)return{returnValue:null,n4a:aa};({gNf:ja,n4a:na}=na.Ybi());if(!ja)return{returnValue:null,n4a:aa};aa+=na;fa.PC(fa.length,ja)}return{returnValue:fa,n4a:aa}}static pMh(J,V,X,W,U,Y,ba,aa){let fa,na,oa,ja,qa,Ia;Ia=qa=ja=oa=na=fa=null;({n4a:ja,returnValue:fa}=
M.dHd(V,Va=>J.runtime.uk.J(Va),X,1,Y,ba,aa));if(!fa)return k.a.instance.Ta(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),J.logger.Og(Object.assign(new E,{QSa:"Base"})),{returnValue:!1,GK:fa,SLc:na,Xad:oa,HBd:ja,QLd:qa,Fne:Ia};({n4a:qa,returnValue:na}=M.dHd(V,Va=>J.runtime.Eu.J(Va)||J.runtime.uk.J(Va),W,2,Y,ba,aa));if(!na)return k.a.instance.Ta(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),
J.logger.Og(Object.assign(new E,{QSa:"Favored"})),{returnValue:!1,GK:fa,SLc:na,Xad:oa,HBd:ja,QLd:qa,Fne:Ia};({n4a:Ia,returnValue:oa}=M.dHd(V,Va=>J.runtime.Jq.J(Va)||J.runtime.uk.J(Va),U,4,Y,ba,aa));return oa?{returnValue:!0,GK:fa,SLc:na,Xad:oa,HBd:ja,QLd:qa,Fne:Ia}:(k.a.instance.Ta(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),J.logger.Og(Object.assign(new E,{QSa:"Unfavored"})),{returnValue:!1,
GK:fa,SLc:na,Xad:oa,HBd:ja,QLd:qa,Fne:Ia})}static aGh(J,V=!1){const X=new a.a;let W=0;for(;W<J.length;){var U=J.J(W);if(1===U.type||4===U.type||2===U.type)X.add(U),W++;else if(3===U.type){let ba="";ba+=U.character;W++;let aa=U.vQa,fa=!1;for(;W<J.length;W++){var Y=J.J(W);3===Y.type?U.runId===Y.runId&&U.jJ.equals(Y.jJ)&&(U.Sba===Y.Sba||U.KEa===Y.KEa)&&U.yF.GA(Y.yF)&&(!V||U.du&&U.du.equals(Y.du))?(ba+=Y.character,Y.vQa&&(aa=!0)):fa=!0:fa=!0;if(fa){U=new Q.a(null,U.source,U.Mj,U.Ag,U.runId,U.jJ,ba,U.Olb,
!0,aa,U.Sba,U.KEa,U.gSa,U.yF,U.du);X.add(U);break}}}}k.a.instance.Ta(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",X.er());return X}static C1k(J,V=!1){const X=new a.a;let W=0;for(;W<J.length;){var U=J.J(W);if(1===U.type||4===U.type||2===U.type)X.add(U),W++;else if(3===U.type){let ba=U.character.toString();W++;let aa=U.vQa;for(;W<J.length;W++){var Y=J.J(W);if(3===Y.type&&M.wto(U,Y,V))ba+=Y.character,Y.vQa&&(aa=!0);else break}U=new Q.a(null,U.source,U.Mj,
U.Ag,U.runId,U.jJ,ba,U.Olb,!0,aa,U.Sba,U.KEa,U.gSa,U.yF,U.du);X.add(U)}}k.a.instance.Ta(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",X.er());return X}static wto(J,V,X){return J.runId===V.runId&&J.jJ.equals(V.jJ)&&(J.Sba===V.Sba||J.KEa===V.KEa)&&J.yF.GA(V.yF)&&(!X||!!J.du&&J.du.equals(V.du))}static cno(J,V,X,W,U,Y,ba,aa,fa,na,oa,ja,qa,Ia,Va,Na){J.setPropertyString(X.wm,l.a.lo,U);J.setPropertyUint32(X.wm,f.a.Lc,W);J.setPropertyUint32s(X.wm,f.a.nq,Y);J.setPropertyUint32s(X.wm,
f.a.ft,ba);J.setPropertyObjectIds(X.wm,l.a.Gn,fa);J.hasProperty(X.wm,f.a.uj)&&J.setPropertyUint32(X.wm,f.a.uj,M.GKl());V&&V(10)&&J.setPropertyObjectIds(X.wm,f.a.Fv,Na);W=!1;for(U=0;U<na.length;U++)if(na.J(U)){W=!0;break}W&&J.setPropertyBools(X.wm,f.a.gRf,na);M.iRk(V,J,X,oa,ja,qa,Ia);M.jRk(J,X,Va);X.rC(l.a.lo);X.rC(f.a.Lc);X.rC(f.a.nq);X.rC(f.a.ft);X.rC(l.a.Gn);X.rC(f.a.gRf);X.rC(l.a.zm);X.rC(l.a.lpb);X.rC(f.a.qPa);X.rC(f.a.QGa);X.rC(l.a.oxa);X.rC(f.a.Fv);J.hasProperty(X.wm,f.a.uj)&&X.rC(f.a.uj);0<
aa.length?J.setPropertyUint32s(X.wm,l.a.zm,aa):X.wm.removeProperty(l.a.zm)}static iRk(J,V,X,W,U,Y,ba){if(J(99)){J=W.contains(!0,(aa,fa)=>fa);M.Jbg(V,X,l.a.oxa,J?W:null);M.Jbg(V,X,l.a.lpb,M.qej(W,U));M.Jbg(V,X,f.a.qPa,M.qej(W,Y));W=!1;for(U=0;U<ba.length;U++)0!==ba.J(U)&&(W=!0);W?V.setPropertyUint32s(X.wm,f.a.QGa,ba):X.wm.removeProperty(f.a.QGa)}}static jRk(J,V,X){const W=ba=>ba;var U=Object(u.a)(J,J.setPropertyBools,"setPropertyBools");M.hNa(V,X.pjb,W,U,f.a.fFa);M.hNa(V,X.Mfb,W,U,f.a.gga);M.hNa(V,
X.n5a,W,U,f.a.PGa);U=ba=>0<ba.length;var Y=Object(u.a)(J,J.setPropertyStrings,"setPropertyStrings");M.hNa(V,X.ojb,U,Y,f.a.gFa);M.hNa(V,X.Lfb,U,Y,f.a.BDa);M.hNa(V,X.knb,U,Y,f.a.uIa);U=ba=>!!ba;Y=Object(u.a)(J,J.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");M.hNa(V,X.qjb,U,Y,f.a.hFa);M.hNa(V,X.N_a,U,Y,f.a.CDa);M.hNa(V,X.mnb,U,Y,f.a.vIa);X.n5a.any(W)?M.hNa(V,X.lnb,()=>!0,Object(u.a)(J,J.setPropertyObjectIds,"setPropertyObjectIds"),f.a.aza):V.wm.removeProperty(f.a.aza)}static qej(J,V){const X=
new a.a;let W=!1;for(let U=0;U<J.length;U++){const Y=V.J(U)&&!J.J(U);X.add(Y);W=Y||W}return W?X:null}static Jbg(J,V,X,W){W?J.setPropertyBools(V.wm,X,W):V.wm.removeProperty(X)}static GKl(){return x.a.uF()}static Uci(J,V){return J.runtime.Eu.pz(V,J.runtime.uk.J(V)||J.runtime.Jq.get(V))}static ZOc(J,V,X,W,U){let Y;Y=new a.a;const ba=!!X&&X(10);if(J.runtime.Xb.isFeatureEnabled(76)){var aa=M.C1k(W,ba);var fa=M.aGh(W,ba);aa.length!==fa.length&&J.runtime.Xb.Az(76)}else aa=M.aGh(W,ba);fa=0;let na="",oa=new a.a,
ja=new a.a,qa=new a.a,Ia=new a.a,Va=new a.a,Na=new a.a,za=new a.a,la=new a.a,va=new a.a;const ia=new L.a;let pa=new a.a;var sa=aa.J(aa.length-1);if(2!==sa.type&&4!==sa.type)return k.a.instance.Ta(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",sa.type),J.logger.Og(Object.assign(new I.a,{rj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",sa.type)})),{returnValue:!1,
j$d:Y};var Ha=0;for(sa=0;sa<aa.length;sa++){var ra=aa.J(sa),Ma=null;if(1===ra.type||3===ra.type)Ma=ra,na+=Ma.text;else if(4===ra.type){ra=M.Uci(J,ra.Mj);ra=new N.a(ra);Y.add(ra);continue}Ma?(oa.add(Ma.runId),ja.add(Ma.Ag),Ha+=Ma.text.length,qa.add(Ha),Ia.add(Ma.jJ),Va.add(Ma.Olb),Na.add(Ma.vQa),za.add(Ma.Sba),la.add(Ma.KEa),va.add(Ma.gSa),ia.pjb.add(Ma.yF.nrm),ia.Mfb.add(Ma.yF.Rqm),ia.n5a.add(Ma.yF.Rrm),ia.ojb.add(Ma.yF.insertion.author),ia.Lfb.add(Ma.yF.deletion.author),ia.knb.add(Ma.yF.OGa.author),
ia.qjb.add(Ma.yF.insertion.xZc),ia.N_a.add(Ma.yF.deletion.xZc),ia.mnb.add(Ma.yF.OGa.xZc),ia.lnb.add(Ma.yF.OGa.T_f),ba&&pa.add(Ma.du)):oa.length||(oa.add(0),ja.add(0),qa.add(0),Ia.add(y.a.nil),Va.add(!1),Na.add(!1),za.add(!1),la.add(!1),va.add(0),ia.pjb.add(!1),ia.Mfb.add(!1),ia.n5a.add(!1),ia.ojb.add(""),ia.Lfb.add(""),ia.knb.add(""),ia.qjb.add(0),ia.N_a.add(0),ia.mnb.add(0),ia.lnb.add(y.a.nil));if(2===ra.type){Ha=ra;ra=Ha.Lc;qa.oG(qa.length-1);Ma=U.J(fa);if(!Ma)return k.a.instance.Ta(17044307,1,
2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",fa,U.length,W.length,sa,aa.length),J.logger.Og(Object.assign(new I.a,{rj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),k.a.instance.vja(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",U.er()),k.a.instance.vja(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",
W.er()),k.a.instance.vja(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",aa.er()),{returnValue:!1,j$d:Y};if(Ma=M.Uci(J,Ma))Ma=new N.a(Ma.KK()),M.cno(V,X,Ma,Ha.Lc,na,oa,ja,qa,Ia,Va,Na,za,la,va,ia,pa),Y.add(Ma);k.a.instance.Ta(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",Ha.Mj,ra,oa.er(),ja.er(),
qa.er(),Na.er(),za.er(),la.er(),Ia.er(),"",va.er());fa++;na="";oa=new a.a;ja=new a.a;qa=new a.a;Ia=new a.a;Va=new a.a;Na=new a.a;za=new a.a;la=new a.a;va=new a.a;ia.reset();Ha=0;pa=new a.a}}return{returnValue:!0,j$d:Y}}static t7n(J,V){const X=J.runtime.en.J(z.a.zL),W=V.getPropertyObjectIds(X.wm,f.a.u1);for(let U=0;U<W.length;U++)J.runtime.en.remove(W.J(U));V.setPropertyObjectIds(X.wm,f.a.u1,new a.a);V.setPropertyString(X.wm,f.a.kUa,y.a.nil.toString());X.rC(f.a.u1);X.rC(f.a.kUa)}static gBm(J,V){if(J.runtime.en.mb(z.a.zL))return null;
const X=new N.a(J.runtime.uk.J(z.a.zL).KK());V.setPropertyString(X.wm,f.a.kUa,J.output.LM.last().id.toString());V.setPropertyObjectIds(X.wm,f.a.u1,new a.a);X.rC(f.a.u1);X.rC(f.a.kUa);J.runtime.en.Z(z.a.zL,X);return X}static $rf(J){const V=new a.a;J.forEach(X=>{V.add(X.id);return!0});return V}static udc(J,V,X,W){let U=0;X.forEach(Y=>{H.a(Y,V+U++,1);393230===Y.Rc&&J.getPropertyObjectIds(Y,l.a.Gn).forEach(ba=>{W.add(ba);return!0});return!0})}static F3m(J,V){const X=new n.a;let W=0;V.forEach(U=>{if(X.contains(U))return!0;
X.add(U);if(({index:W}=M.KKf("BaseFormatting_",W,U,Y=>J.runtime.uk.J(Y))).returnValue||({index:W}=M.KKf("FavoredFormatting_",W,U,Y=>J.runtime.Eu.J(Y))).returnValue||({index:W}=M.KKf("ConflictingFormatting_",W,U,Y=>J.runtime.Jq.J(Y))).returnValue)return!0;W++;return!0})}static KKf(J,V,X,W){if(X=W(X))if(H.a(X,J+V,1),1179649===X.Rc)return V++,{returnValue:!0,index:V};return{returnValue:!1,index:V}}static tgf(J){return!!J.runtime.uk.J(z.a.zL)}static hNa(J,V,X,W,U){V.any(X)?(W(J.wm,U,V),J.rC(U)):J.wm.removeProperty(U)}static qnj(J,
V){const X=new a.a;X.add(0);const W=J?J.length:0;for(let U=0;U<W;U++)X.insert(U+1,J.$f(U));X.insert(X.length,V);return X}}Object(F.a)(M,"ParagraphMergeUtils",null,[])},1586:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);var l=c(221);class f{constructor(a,k,x){this.Bm=null;this.$j=a;this.source=k;this.Mj=x}get type(){return this.$j}get o7a(){return!1}get ZLm(){return 1===(this.source&1)}get $Lm(){return 2===(this.source&2)}get aMm(){return 4===(this.source&4)}t4(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",
this.LOl(),this.u7b())}LOl(){let a="";this.ZLm&&(a+="Base");this.$Lm&&(a+="FavoredUpdate");this.aMm&&(a+="UnfavoredUpdate");return a}u7b(){return""}GA(a){return this.type===a.type}s9c(){const a=new l.a;a.add(this);return a}get length(){return 0}}Object(F.a)(f,"AMergeBlock",null,[99,100])},1587:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(1586);class l extends c.a{constructor(f,a,k){super(2,f,a);this.Lc=k}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),
this.Lc,this.Mj)}u7b(){return"Eop"}clone(){return new l(this.source,this.Mj,this.Lc)}GA(f,a,k,x=!1,y=!0){return super.GA(f,a,k,x)?y?f.Lc===this.Lc:f.Mj===this.Mj&&f.Lc===this.Lc:!1}get length(){return 1}}Object(F.a)(l,"EopMergeBlock",c.a,[])},1588:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);var l=c(364);class f{constructor(){this.detail=new l.a}}Object(F.a)(f,"AMergeFailureDetail",null,[2034])},1589:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(1537);class l extends c.a{constructor(){super()}get uga(){return"ParagraphMerge"}}
Object(F.a)(l,"ParagraphMergeFailureDetail",c.a,[])},1590:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(1537);class l extends c.a{constructor(){super()}get uga(){return"RdOpLcs"}}Object(F.a)(l,"ReducedOpsLcsFailureDetail",c.a,[])},1591:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(1537);class l extends c.a{constructor(){super()}get uga(){return"TableMerge"}}Object(F.a)(l,"TableMergeFailureDetail",c.a,[])},1598:function(F,K,c){F=c(0);class l{constructor(){this.V$c=this.SSc=
null;this.PMf=this.score=this.ZYc=0}yYf(G,H,L){this.score=G.J(H);++H;this.SSc=G.J(H)?L.Cna(G.J(H)):null;++H;this.V$c=G.J(H)?L.Cna(G.J(H)):null;++H;this.ZYc=G.J(H);++H;this.PMf=G.J(H);++H;return H}}Object(F.a)(l,"TokenStringGeneratorInit",null,[]);class f{constructor(G,H,L,I,N){this.Tgb=G;this.count=H;this.GMd=L;this.tO=I;this.depth=N}}Object(F.a)(f,"ErrorTolerantTrieMatch",null,[]);var a=c(1652),k=c(1739);class x{constructor(G=null,H=0,L=0,I=0){this.Onk=G||new k.a;this.vva=H;this.tO=L;this.depth=
I}get H5(){return this.Onk}getKey(){return this.H5.Jx.toString()+":"+this.vva.toString()}}Object(F.a)(x,"TrieBookmark",null,[]);class y{constructor(G,H){this.dRa=G;this.WLf=H}z9m(G){if(null==G)throw Error.argumentNull("prefix");let H={};var L=H[""]=new x;this.XVd(L,H);for(L=0;L<G.length;++L){const I=G.charCodeAt(L),N={};for(let Q in H)this.rBk(I,H[Q],N);H=N}return this.ZNo(H)}XVd(G,H){if(!(G.tO>=this.WLf)&&(G=new x(a.a.l8e(G.H5),G.vva,G.tO+1,G.depth),G.H5.FF&a.a.P8a&&(G.vva+=1),this.dRa.CQb(G.H5))){G.depth+=
1;let L=!0;for(;L;)y.koe(G,H),this.XVd(G,H),G.vva+=this.dRa.H7b(G.H5,!0)+(G.H5.FF&a.a.P8a?1:0),L=this.dRa.vad(G.H5)}}rBk(G,H,L){H.tO+1<=this.WLf&&(H.tO+=1,y.koe(H,L),--H.tO);H.H5.FF&a.a.P8a&&(H.vva+=1);if(this.dRa.CQb(H.H5)){H.depth+=1;let I=!0;for(;I;)H.H5.KRb===G?(y.koe(H,L),this.XVd(H,L)):H.tO+1<=this.WLf&&(H.tO+=1,y.koe(H,L),this.XVd(H,L),--H.tO),H.vva+=this.dRa.H7b(H.H5,!0)+(H.H5.FF&a.a.P8a?1:0),I=this.dRa.vad(H.H5)}}ZNo(G){const H=[];for(var L in G){const I=G[L];if(!I.H5.Jx)continue;const N=
!!(I.H5.FF&a.a.P8a),Q=this.dRa.H7b(I.H5,!1)+(N?1:0);Array.add(H,new f(I.vva,Q,N,I.tO,I.depth))}H.sort((I,N)=>{let Q=I.Tgb-N.Tgb;return Q||(Q=-(I.count-N.count))?Q:Q=I.depth-N.depth});if(2>H.length)return H;G=[];for(L=0;L<H.length;)L+=y.ABj(L,H,G);return G}static koe(G,H){const L=G.getKey();L in H?(H=H[L],H.tO=Math.min(H.tO,G.tO)):H[L]=new x(a.a.l8e(G.H5),G.vva,G.tO,G.depth)}static ABj(G,H,L){const I=H[G];let N=I.Tgb;const Q=N+I.count;let M=1,J=I.GMd;for(;G+M<H.length&&H[G+M].Tgb<Q;){const V=H[G+M];
V.Tgb>N&&(Array.add(L,new f(N,V.Tgb-N,J,I.tO,I.depth)),J=!1);M+=y.ABj(G+M,H,L);N=V.Tgb+V.count}N<Q&&Array.add(L,new f(N,Q-N,J,I.tO,I.depth));return M}}Object(F.a)(y,"ErrorTolerantTrieLookupEngine",null,[1446]);class n extends l{constructor(G,H,L){super();this.rqi=this.jZi=!1;this.MXh=null;if(G){var I=0;try{I=this.yYf(G,I,H);this.jZi=1===G.J(I);++I;this.rqi=1===G.J(I);++I;const N=G.J(I);this.MXh=this.DBn(L,N)}catch(N){throw Error.argument("initData");}}}DBn(G,H){return new y(G,H)}}Object(F.a)(n,"FuzzyMatchTokenStringGeneratorInit",
l,[]);class u extends l{constructor(G,H){super();this.query=this.name=null;if(G){this.annotations=H.annotations;var L=0;try{L=this.yYf(G,L,H),this.name=H.QD(G.J(L)),++L,this.query=H.VK(G.J(L))}catch(I){throw Error.argument("initData");}}}}Object(F.a)(u,"QueryTokenStringGeneratorInit",l,[]);class z extends l{constructor(G,H){super();if(G)try{this.yYf(G,0,H)}catch(L){throw Error.argument("initData");}}}Object(F.a)(z,"SurfaceStringTokenStringGeneratorInit",l,[]);var w=c(1522);c.d(K,"a",function(){return E});
class E{constructor(G){this.MLf=G}get SSc(){return this.MLf.SSc}get V$c(){return this.MLf.V$c}get ZYc(){return this.MLf.ZYc}static create(G,H,L){const {SurfaceStringTokenStringGenerator:I}=c(1880),{QueryTokenStringGenerator:N}=c(1881),{FuzzyMatchTokenStringGenerator:Q}=c(1882);let M=0;try{if(G.J(M)!==E.nAb)throw Error.argument("initData","Input does not represent a token string generator");++M;const J=G.J(M);++M;const V=new w.a;V.ehb(G,M,G.count-M);switch(J){case I.QFc:return new I(new z(V,H));case N.QFc:return new N(new u(V,
H));case Q.QFc:return new Q(new n(V,H,L));default:throw Error.argument("initData");}}catch(J){throw Error.argument("initData");}}static Jph(G,H,L,I,N,Q){G=G.jMo.getId(H,null);if(0>G)return++Q,Q;E.Kph(G,L,I,N);return Q}static Kph(G,H,L,I){Array.add(I.Rgg,G);Array.add(I.Hwj,H);++I.Vlc[L]}}E.nAb=1099767983;Object(F.a)(E,"TokenStringGenerator",null,[1404])},1634:function(F,K,c){c.d(K,"a",function(){return a});F=c(0);var l=c(221);K=c(1586);var f=c(1548);class a extends K.a{constructor(k,x,y){super(k,x,
y)}WBo(k){let x;x=null;if(!this.text||!this.o7a||0>=k||k>=this.length)return{returnValue:!1,bvj:x};x=new l.a;const y=this.clone();y.Z7c(f.a.vpb(this.text,0,k));const n=this.clone();n.Z7c(f.a.vpb(this.text,k,this.length-k));x.add(y);x.add(n);return{returnValue:!0,bvj:x}}t4(){return!0}get length(){return this.text.length}}Object(F.a)(a,"ATextMergeBlock",K.a,[])},1635:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);var l=c(165);class f{A1e(a,k){return a+("[Block: "+k+"] ")}static xTl(a,k,x,y,
n,u,z){const {ParagraphMergeBlockCreator:w}=c(1973),{TableMergeBlockCreator:E}=c(1976);if(393230===k.Rc)return new w(a,k,x,n,u,y(10),z);if(393250===k.Rc)return new E(k,x);l.a.instance.Ta(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",k.Rc);return null}}Object(F.a)(f,"MergeBlockCreator",null,[])},1636:function(F,K,c){c.d(K,"a",function(){return k});F=c(0);var l=c(6),f=c(58);K=c(1634);var a=c(1554);class k extends K.a{constructor(x,y,n,u,z,w,E,G,H,L,I,N,Q,M){super(y,
n,u);this.Ag=z;this.runId=w;this.Olb=G;this.p4j=E;this.ate=x;this.vQa=H;this.Sba=L;this.KEa=I;this.gSa=N;this.yF=Q;this.du=M}get qEc(){return this.ate}get jJ(){return this.p4j}get JDb(){return this.qEc(this.jJ)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",super.toString(),this.Ag,this.runId,this.Olb,this.Mj,this.jJ.toString(),this.du?this.du.toString():"NULL")}GA(x,y,n,u=!1){if(!super.GA(x,y,n,u))return!1;
if(u)return!0;if(!this.yF.GA(x.yF)||this.du&&!this.du.equals(x.du))return!1;if(this.jJ.equals(x.jJ)||this.jJ.equals(f.a.nil)||x.jJ.equals(f.a.nil))return!0;x=new a.a(this.JDb,x.JDb);y=y.RLh(this.JDb,n);return x.eUc(y.abe)?!1:!0}get VGm(){return this.t4()&&"\ufffc"===this.text&&this.JDb?this.JDb.hasProperty(l.a.jt)||1179725!==this.JDb.Rc?!0:!1:!1}}Object(F.a)(k,"AUserRunMergeBlock",K.a,[])},1637:function(F,K,c){c.d(K,"a",function(){return f});var l=c(165);const f=(a,k,x=4)=>{a?l.a.instance.vja(4273285,
x,4,k,a.N$c()):l.a.instance.Ta(4293845,x,1,k,"{0}: Node was null.",k)}},1638:function(F,K,c){c.d(K,"e",function(){return y});c.d(K,"a",function(){return n});c.d(K,"d",function(){return u});c.d(K,"b",function(){return z});c.d(K,"c",function(){return w});var l=c(6),f=c(16),a=c(58),k=c(1037),x=c(1564);const y=(H,L,I)=>{const N=new k.a;let Q=a.a.nil;L=N.getPropertyObjectId(L,l.a.Epb);L.equals(a.a.nil)||(H=H.runtime.uk.J(L),I&&(H=I.pz(L,H)),H&&(Q=N.getPropertyObjectId(H,l.a.Epb)));return Q},n=(H,L,I,N,
Q)=>{const M=new k.a;let J=null;var V=M.getPropertyObjectId(I,l.a.Epb);V!==a.a.nil&&(J=H.runtime.uk.J(V),L&&(J=L.pz(V,J)));if(J){V=M.getPropertyObjectIds(J,f.a.ef);for(Q=0;Q<V.length&&!V.J(Q).equals(I.id);Q++);Q===V.length&&(Q=-1)}I=y(H,I,L);if(!I.equals(a.a.nil)&&(H=H.runtime.uk.J(I),L&&(H=L.pz(I,H)),H)){L=M.getPropertyObjectIds(H,f.a.ef);for(N=0;N<L.length&&!L.J(N).equals(J.id);N++);N===L.length&&(N=-1)}return{rowIndex:N,h3b:Q}},u=(H,L,I,N,Q)=>{var M=new k.a;let J=null;var V=H.runtime.uk.J(I);L&&
(V=L.pz(I,V));if(!V)return null;V=M.getPropertyObjectIds(V,f.a.ef);I=null;N<V.length&&(N=V.J(N),I=H.runtime.uk.J(N),L&&(I=L.pz(N,I)));I&&(M=M.getPropertyObjectIds(I,f.a.ef),Q<M.length&&(Q=M.J(Q),J=H.runtime.uk.J(Q),L&&(J=L.pz(Q,J))));return J},z=(H,L,I)=>{let N,Q;Q=N=-1;const M=(new k.a).getPropertyObjectId(I,l.a.Epb);var J=y(H,I,L);if(J.equals(a.a.nil)||M.equals(a.a.nil))return{rowIndex:N,h3b:Q};L=H.runtime.dig;var V=L.J(J);if(!V){V=E(H,J);if(!V)return{rowIndex:N,h3b:Q};L.Z(J,V)}for(J=0;J<V.length;J++)if(V.J(J).equals(M)){N=
J;break}V=L.J(M);if(!V){V=G(H,M);if(!V)return{rowIndex:N,h3b:Q};L.Z(M,V)}for(H=0;H<V.length;H++)if(V.J(H).equals(I.id)){Q=H;break}return{rowIndex:N,h3b:Q}},w=(H,L,I,N)=>{if(0>I||0>N)return a.a.nil;new k.a;const Q=H.runtime.dig;let M=Q.J(L);if(!M){M=E(H,L);if(!M)return a.a.nil;Q.Z(L,M)}if(I<M.length)L=M.J(I);else return a.a.nil;I=Q.J(L);if(!I){I=G(H,L);if(!I)return a.a.nil;Q.Z(L,I)}if(N<I.length)H=I.J(N);else return a.a.nil;return H},E=(H,L)=>{var I=new k.a;const N=H.runtime.uk.J(L);if(N){var Q=H.runtime.Eu.pz(L,
N);H=H.runtime.Jq.pz(L,N);L=I.getPropertyObjectIds(N,f.a.ef);Q=I.getPropertyObjectIds(Q,f.a.ef);I=I.getPropertyObjectIds(H,f.a.ef);return L.eq(Q,(M,J)=>M.equals(J))?I:L.eq(I,(M,J)=>M.equals(J))?Q:x.a(L,Q,I,(M,J)=>M.equals(J))}return(Q=H.runtime.Eu.J(L))?I.getPropertyObjectIds(Q,f.a.ef):(Q=H.runtime.Jq.J(L))?I.getPropertyObjectIds(Q,f.a.ef):null},G=(H,L)=>{var I=new k.a;const N=H.runtime.uk.J(L);if(N){var Q=H.runtime.Eu.pz(L,N);H=H.runtime.Jq.pz(L,N);L=I.getPropertyObjectIds(N,f.a.ef);Q=I.getPropertyObjectIds(Q,
f.a.ef);I=I.getPropertyObjectIds(H,f.a.ef);return L.eq(Q,(M,J)=>M.equals(J))?I:L.eq(I,(M,J)=>M.equals(J))?Q:null}return(Q=H.runtime.Eu.J(L))?I.getPropertyObjectIds(Q,f.a.ef):(Q=H.runtime.Jq.J(L))?I.getPropertyObjectIds(Q,f.a.ef):null}},1639:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(1504);class l extends c.a{constructor(f,a,k,x,y=null){super(f,a,y,null,k);this.id=x}}Object(F.a)(l,"TryQueryResultBinding",c.a,[])},1640:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f){this.Ab=
f}get C4a(){return this.Ab.C4a}get oGo(){return 4!==this.Ab.style}get qGo(){return!0}get trie(){return this.Ab.trie}getId(f,a){if(!this.oGo)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ab.style){case 0:return this.C_l(f,a);default:throw Error.notImplemented();}}QD(f){if(!this.qGo)throw Error.invalidOperation("String lookup not supported on this string table");if(0>f||f>=this.C4a)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ab.style){case 0:return this.rem(f);
case 4:return this.qem(f);default:throw Error.notImplemented();}}C_l(f,a){f=this.Ab.trie.GLi(f,0,f.length,a);if(!f.succeeded)return-1;if(0>f.imc||f.imc>=this.Ab.C4a)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ab.wad?this.Ab.N3c.Gy(this.Ab.wad+4*f.imc,4):f.imc}rem(f){if(this.Ab.wad){let a=0;for(;a<this.Ab.C4a&&this.Ab.N3c.Gy(this.Ab.wad+4*a,4)!==f;++a);if(a>=this.Ab.C4a)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ab.trie.rhi(a)}return this.Ab.trie.rhi(f)}qem(f){const a=
this.Ab.N3c.Gy(this.Ab.Ewj+4*f,4);f=this.Ab.N3c.Gy(this.Ab.Fwj+4*f,4);if(0>f||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const k=Array(a);for(let x=0;x<a;++x)k[x]=({qvm:f}=this.KQn(f)).returnValue;return String.fromCharCode.apply(null,k)}KQn(f){let a=0;for(let k=0;3>k;++k){const x=this.Ab.N3c.J(this.Ab.CCh+f)^182;++f;a|=(x&127)<<7*k;if(!(x&128))break}return{returnValue:a,qvm:f}}}Object(F.a)(l,"StringTable",null,[1370])},1641:function(F,K,c){c.d(K,"a",function(){return f});
F=c(0);var l=c(1652);class f{constructor(a){this.trie=null;this.CCh=this.Ewj=this.Fwj=this.wad=0;if(a){this.N3c=a;var k=0;if(a.Gy(k,4)!==f.nAb)throw Error.argument("bytes","Input does not represent a string table");k+=4;this.C4a=a.Gy(k,4);k+=4;this.style=a.Gy(k,4);k+=4;switch(this.style){case 0:const x=1===a.Gy(k,4);k+=4;x||(this.wad=k,k+=4*this.C4a);a.Gy(k,4);this.trie=this.cCn(a,k+4);break;case 4:this.Fwj=k;this.Ewj=k+=4*this.C4a;k+=4*this.C4a;a.Gy(k,4);this.CCh=k+4;break;default:throw Error.argument("bytes");
}}}cCn(a,k){return new l.a(a,k)}}f.nAb=1025118440;Object(F.a)(f,"StringTableInit",null,[])},1642:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);var l;(function(f){f[f.Answer=0]="Answer";f[f.Definition=1]="Definition";f[f.Entity=2]="Entity";f[f.WolframAnswer=3]="WolframAnswer";f[f.Assistance=4]="Assistance";f[f.Command=5]="Command";f[f.Document=6]="Document";f[f.TryQuery=7]="TryQuery";f[f.FindInDocument=8]="FindInDocument";f[f.HelpAction=9]="HelpAction";f[f.Insights=10]="Insights";f[f.People=
11]="People";f[f.Image=12]="Image";f[f.FirstRunResult=13]="FirstRunResult";f[f.NoCommandsFoundResult=14]="NoCommandsFoundResult";f[f.TestResult=15]="TestResult";f[f.AppsForOffice_Installed=16]="AppsForOffice_Installed";f[f.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";f[f.AppsForOffice_Query=18]="AppsForOffice_Query";f[f.Notes_Onenote=19]="Notes_Onenote";f[f.Notes_Samsung=20]="Notes_Samsung";f[f.Notes_Sticky=21]="Notes_Sticky";f[f.Learning=22]="Learning";f[f.Feedback=23]="Feedback";
f[f.Template=24]="Template";f[f.ActionAI=25]="ActionAI";f[f.ActionAICommand=26]="ActionAICommand";f[f.Addin=27]="Addin";f[f.OfficeScript=28]="OfficeScript";f[f.AddinStoreEntry=29]="AddinStoreEntry";f[f.GenerateSlides=30]="GenerateSlides";f[f.SummarizeDeck=31]="SummarizeDeck";f[f.Unknown=32]="Unknown"})(l||(l={}));Object(F.b)("ResultType",l)},1649:function(F,K,c){F=c(0);var l=c(6),f=c(598),a=c(165),k=c(221),x=c(58),y=c(364),n=c(67),u;(function($a){$a[$a.none=0]="none";$a[$a.mergeConflict=1]="mergeConflict";
$a[$a.containerBaseIdValidationFailure=2]="containerBaseIdValidationFailure";$a[$a.failedToApplyHints=3]="failedToApplyHints";$a[$a.validateUpdateHintsAreComplete=4]="validateUpdateHintsAreComplete";$a[$a.other=5]="other"})(u||(u={}));Object(F.b)("ParagraphMergeUsingHintsFailureReason",u);var z=c(1037),w=c(234),E=c(894);const G=$a=>{const kb=new k.a;$a.forEach(Ua=>{kb.add(Ua);return!0});return kb};var H=c(1587),L=c(1564),I=c(1590);const N=($a,kb)=>{if($a.length!==kb.length)return!1;for(let Ua=0;Ua<
$a.length;Ua++)$a.J(Ua).Bm=kb.J(Ua),kb.J(Ua).Bm=$a.J(Ua);return!0},Q=($a,kb,Ua)=>{let Sa,xb,Qb;Sa=0;xb=!1;Qb=0;var Ib;if(!({idx:Ib}=W($a,kb)).returnValue)return a.a.instance.Ta(18969440,1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",kb,$a.er()),{returnValue:!1,vQc:Sa,Jlb:xb,UZc:Qb};if(!Ua&&2===$a.J(Ib).type)return{returnValue:!0,vQc:Ib,Jlb:xb,UZc:Qb};if(!$a.J(Ib).t4())return a.a.instance.Ta(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",
Ib,Ua,$a.er()),{returnValue:!1,vQc:Sa,Jlb:xb,UZc:Qb};let $b=!1,hc=0;for(;Ib<$a.length&&$a.J(Ib).Mj.equals(kb);Ib++){if(Ua===hc){$b=!0;break}if(Ua>hc&&Ua<hc+$a.J(Ib).length){xb=$b=!0;Qb=Ua-hc;break}hc+=$a.J(Ib).length}$b||Ua!==hc||($b=!0);$b&&(Sa=Ib);return{returnValue:$b,vQc:Sa,Jlb:xb,UZc:Qb}},M=($a,kb,Ua)=>{let Sa,xb,Qb;Qb=xb=0;Sa=!1;let Ib=0,$b=!1;for(;xb<$a.length;xb++){if(kb===Ib){$b=!0;break}if(kb>Ib&&kb<Ib+$a.J(xb).length){Sa=$b=!0;Qb=kb-Ib;break}Ib+=$a.J(xb).length}$b||kb!==Ib||($b=!0);$b||
($a=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",$a.length,Ib,kb),a.a.instance.Ta(573178201,1,2,$a),Ua.Og(Object.assign(new I.a,{eventId:"8k6fz",info:$a})));return{returnValue:$b,Jlb:Sa,Rwh:xb,Qwh:Qb}},J=($a,kb,Ua)=>{let Sa;if($a.J(kb).t4()&&({bvj:Sa}=$a.J(kb).WBo(Ua)).returnValue)return $a.PC(kb+1,Sa),$a.oG(kb),!0;a.a.instance.Ta(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",kb,Ua,$a.er());
return!1},V=($a,kb,Ua)=>{let Sa,xb;if(!({vQc:Ua,Jlb:xb,UZc:Sa}=Q($a,kb,Ua)).returnValue)return{returnValue:!1,index:0};if(!xb)return{returnValue:!0,index:Ua};if(J($a,Ua,Sa))return{returnValue:!0,index:Ua+1};a.a.instance.Ta(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",kb,Sa,$a.er());return{returnValue:!1,index:0}},X=($a,kb,Ua)=>{let Sa;if(!({Jlb:Sa,Rwh:kb,Qwh:Ua}=M($a,kb,Ua)).returnValue)return{returnValue:!1,index:0};if(!Sa)return{returnValue:!0,
index:kb};if(J($a,kb,Ua))return{returnValue:!0,index:kb+1};a.a.instance.Ta(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",Ua,$a.er());return{returnValue:!1,index:0}},W=($a,kb)=>{let Ua;Ua=0;for(let Sa=0;Sa<$a.length;Sa++)if($a.J(Sa).Mj.equals(kb))return Ua=Sa,{returnValue:!0,idx:Ua};a.a.instance.Ta(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",kb,$a.er());return{returnValue:!1,idx:Ua}},U=($a,
kb)=>{let Ua;Ua=-1;for(let Sa=kb;Sa<$a.length;Sa++)if(2===$a.J(Sa).type)return Ua=Sa,{returnValue:!0,sga:Ua};a.a.instance.Ta(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",kb,$a.er());return{returnValue:!1,sga:Ua}},Y=($a,kb,Ua)=>{let Sa;Sa=-1;for(let xb=Ua;xb<$a.length;xb++)if(2===$a.J(xb).type&&$a.J(xb).Mj.equals(kb))return Sa=xb,{returnValue:!0,sga:Sa};a.a.instance.Ta(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",
kb,Ua,$a.er());return{returnValue:!1,sga:Sa}},ba=($a,kb)=>{let Ua;Ua=0;var Sa;if(!({idx:Sa}=W($a,kb)).returnValue)return a.a.instance.Ta(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",kb,$a),{returnValue:!1,length:Ua};for(;Sa<$a.length;Sa++)if(6!==$a.J(Sa).type){if(2===$a.J(Sa).type)return{returnValue:!0,length:Ua};a.a.instance.shipAssertTag(17342617,1,$a.J(Sa).t4(),"We found something other than text with type "+$a.J(Sa).type);a.a.instance.shipAssertTag(17877021,1,$a.J(Sa).Mj.equals(kb),
"Unexpected GraphNodeId {0} for ParaId {1}",$a.J(Sa).Mj,kb);Ua+=$a.J(Sa).length}a.a.instance.Ta(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",kb,$a);return{returnValue:!1,length:Ua}},aa=$a=>{const kb=new k.a;for(let Ua=0;Ua<$a.length;Ua++)kb.add($a.J(Ua).clone());return kb};var fa=c(1589),na=c(1548);class oa{constructor($a,kb,Ua=null,Sa=null){this.Mj=$a;this.type=kb;this.text=Ua;this.Lc=Sa}isEqual($a){return $a.Mj.equals(this.Mj)&&this.type===$a.type&&this.Lc===$a.Lc&&na.a.Vuh(this.text,
$a.text)}toString(){let $a=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.Mj,this.Lc,this.type);this.text&&($a+=String.format(" [TextLength: {0}]",this.text.length));return $a}}Object(F.a)(oa,"MergeBlockValidationState",null,[]);var ja=c(111),qa=c(939),Ia=c(858),Va=c(530),Na=c(463),za=c(938),la=c(857),va=c(1537),ia=c(1729),pa;(function($a){$a[$a.base=1]="base";$a[$a.favoredUpdate=2]="favoredUpdate";$a[$a.unfavoredUpdate=4]="unfavoredUpdate";$a[$a.min=1]="min";$a[$a.max=
7]="max"})(pa||(pa={}));Object(F.b)("MergeBlockSource",pa);class sa{constructor($a,kb,Ua,Sa){this.Ag=$a;this.cp=kb;this.GBd=Ua;this.Dbd=Sa}}Object(F.a)(sa,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var Ha=c(1586);class ra extends Ha.a{constructor($a,kb){super(6,$a,kb);this.Lc=0}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Mj)}u7b(){return"Selection"}clone(){return new ra(this.source,this.Mj)}GA(){return!1}get length(){return 0}}Object(F.a)(ra,"SelectionMergeBlock",
Ha.a,[]);var Ma;(function($a){$a[$a.success=0]="success";$a[$a.selfSplit=1]="selfSplit";$a[$a.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";$a[$a.unexpected=3]="unexpected"})(Ma||(Ma={}));Object(F.b)("SplitTwinListResult",Ma);var ya=c(1634);class Ga extends ya.a{constructor($a,kb,Ua,Sa){super(5,$a,kb);this._text=null;this.Z7c(Ua);this.qok=Sa}get text(){return this._text}Z7c($a){this._text=$a}get kbd(){return this.qok}clone(){return new Ga(this.source,this.Mj,this.text,this.kbd)}get o7a(){return this.text&&
this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(F.a)(Ga,"UpdateHintTextMergeBlock",ya.a,[]);class wa{constructor($a,kb,Ua,Sa){this.D2=!1;this.kcb=new y.a;this.Zd=$a;this.okh=Sa;this.eOg=Ua;this._base=kb;this.mye=aa(kb);if(!N(this.base,this.Pe))throw a.a.instance.Ta(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),$a.logger.Og(Object.assign(new va.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Pe(){return this.mye}get mergeConflict(){return this.D2}m2e($a,
kb){switch($a.type){case 1:return this.vFk($a,kb);case 2:return this.M1e($a,kb);case 3:return this.uGk($a,kb);case 4:return this.PFk($a);case 5:return this.LEk($a,kb);case 6:return this.K1e($a);default:return!1}}l2e($a,kb){switch($a.type){case 1:return this.Q1e($a,kb);case 2:return this.L1e($a,kb);case 3:return this.tGk($a,kb);case 4:return this.OFk($a);case 5:return this.KEk($a,kb);case 6:return this.J1e($a);default:return{returnValue:!1,su:null}}}vFk($a,kb){let Ua;const Sa=({fha:Ua}=this.WHa($a.Ag,
kb,!1,$a.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==Sa&&1!==Sa)return 3!==Sa&&(a.a.instance.Ta(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",pa[kb],Ma[Sa]),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.D2=!1;kb=new Ga(kb,$a.Ag,$a.text,$a.id);this.zAf($a,Ua,kb);return!0}M1e($a,kb){let Ua,Sa=({fha:Ua}=this.WHa($a.Ag,kb,!1,$a.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;
if(0!==Sa&&1!==Sa)return 3!==Sa&&(a.a.instance.Ta(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",pa[kb],Ma[Sa]),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let xb;({fha:xb,returnValue:Sa}=this.WHa($a.Ag,kb,!1,$a.cp+$a.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==Sa&&1!==Sa)return 3!==Sa&&(a.a.instance.Ta(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",
pa[kb],Ma[Sa]),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.D2=!1;this.Tdf($a,Ua,xb);return!0}uGk($a,kb){let Ua;const Sa=({Tyf:Ua}=this.lai($a,kb,!1)).returnValue;if(0!==Sa&&1!==Sa)return 3!==Sa&&(a.a.instance.Ta(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",pa[kb],Ma[Sa]),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),
!1;this.D2=!1;kb=new H.a(kb,$a.Zt,$a.Dta);this.zAf($a,Ua,kb);return!0}PFk($a){let kb;if(!({cWd:kb}=this.mai($a,this.Pe,"Derived")).returnValue)return!1;this.Tdf($a,kb,kb+1);return!0}LEk($a,kb){let Ua;if(!({fNf:kb,Syf:Ua}=this.Xbi($a,!1,kb)).returnValue)return!1;this.zAf($a,Ua,kb);return!0}K1e($a){let kb;if(!({bWd:kb}=this.dai($a,this.Pe,"Derived")).returnValue)return!1;this.Tdf($a,kb,kb+1);return!0}fuh($a,kb,Ua){const Sa=({fha:kb}=this.WHa($a,Ua,!1,kb,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;
if(0!==Sa&&1!==Sa)return 3!==Sa&&(a.a.instance.Ta(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",pa[Ua],Ma[Sa]),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.D2=!1;$a=new ra(Ua,$a);this.Pe.insert(kb,$a);return!0}Q1e($a,kb){var Ua=null;if(wa.ixi($a.text.length))return{returnValue:!1,su:Ua};let Sa,xb,Qb;var Ib=({fha:Sa,nwa:xb,Zfa:Qb}=this.WHa($a.Ag,kb,!0,$a.cp,
!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==Ib&&2!==Ib)return 3!==Ib&&(a.a.instance.Ta(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",pa[kb],Ma[Ib]),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,su:Ua};this.D2=!1;({sga:Ib}=U(this.Pe,xb));Ib=this.Pe.J(Ib).Mj;Ua=new Ga(kb,$a.Ag,$a.text,$a.id);kb=new Ga(kb,Ib,$a.text,$a.id);Ua.Bm=kb;kb.Bm=
Ua;this.base.insert(Sa,Ua);this.Pe.insert(xb,kb);Ua=new k.a;Ua.add(new Na.a(Ib,Qb,$a.text,$a.id,$a.Iu));return{returnValue:!0,su:Ua}}L1e($a,kb){let Ua;Ua=null;if(wa.ixi($a.text.length))return{returnValue:!1,su:Ua};let Sa;var xb,Qb=({fha:Sa,nwa:Ib,Zfa:xb}=this.WHa($a.Ag,kb,!0,$a.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==Qb){if(2!==Qb)return 3!==Qb&&(a.a.instance.Ta(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",
pa[kb],Ma[Qb]),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,su:Ua};var Ib=0;for({idx:xb}=W(this.base,$a.Ag);xb<this.base.length&&Ib<$a.cp;xb++)Ib+=this.base.J(xb).length;Ib-=this.base.J(xb-1).length;({nwa:Ib,Zfa:xb,returnValue:Qb}=this.WHa($a.Ag,kb,!0,Ib,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Qb)return 3!==Qb&&(a.a.instance.Ta(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",
pa[kb],Ma[Qb]),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,su:Ua};this.D2=!1}var $b,hc;({fha:$b,nwa:hc,Zfa:pb,returnValue:Qb}=this.WHa($a.Ag,kb,!0,$a.cp+$a.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==Qb){if(2!==Qb)return 3!==Qb&&(a.a.instance.Ta(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",pa[kb],Ma[Qb]),this.Zd.logger.Og(Object.assign(new ia.a,
{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,su:Ua};var pb=0;for({idx:hc}=W(this.base,$a.Ag);hc<this.base.length&&pb<$a.cp+$a.text.length;hc++)pb+=this.base.J(hc).length;({nwa:hc,Zfa:pb,returnValue:Qb}=this.WHa($a.Ag,kb,!0,pb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Qb)return 3!==Qb&&(a.a.instance.Ta(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",pa[kb],Ma[Qb]),
this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,su:Ua};this.D2=!1}kb="";Ua=new k.a;for(--hc;hc>=Ib;hc--)if(6!==this.Pe.J(hc).type)if(this.Pe.J(hc).Bm)kb=this.Pe.J(hc).text+kb,this.Pe.oG(hc);else{if(5===this.Pe.J(hc).type)Qb=pb-kb.length;else if(2===this.Pe.J(hc).type){if(Qb=0,!({length:pb}=ba(this.Pe,this.Pe.J(hc).Mj)).returnValue)return a.a.instance.Ta(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),
this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,su:Ua}}else return a.a.instance.Ta(589898051,1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,su:Ua};if(!({sga:dc}=U(this.Pe,hc+1)).returnValue)return a.a.instance.Ta(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),
this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,su:Ua};var dc=this.Pe.J(dc).Mj;Ua.add(new Va.DeleteTextUpdateHint(dc,Qb,kb));kb=""}for(--$b;$b>=Sa;$b--)this.base.oG($b);if(!({sga:dc}=U(this.Pe,Ib)).returnValue)return a.a.instance.Ta(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,su:Ua};dc=
this.Pe.J(dc).Mj;kb&&kb.length&&Ua.add(new Va.DeleteTextUpdateHint(dc,xb,kb,$a.id,$a.Iu));return{returnValue:!0,su:Ua}}tGk($a,kb){var Ua=null;let Sa,xb,Qb;var Ib=({Tyf:Sa,wpi:xb,Zfa:Qb}=this.lai($a,kb,!0)).returnValue;if(0!==Ib)return 3!==Ib&&(a.a.instance.Ta(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",pa[kb],Ma[Ib]),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),
{returnValue:!1,su:Ua};var $b;if(!({sga:$b}=U(this.Pe,xb)).returnValue)return a.a.instance.Ta(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),{returnValue:!1,su:Ua};Ib=this.Pe.J($b).Mj;const hc=this.Pe.J($b).Lc;let pb,dc,Ob;({Zt:$b,y7:pb,Dta:dc,Saa:Ob}=this.g5l($a,$b));this.xCh(this.Pe,$b,pb,Ob,xb);Ua=new H.a(kb,$a.Zt,$a.Dta);kb=new H.a(kb,$b,dc);Ua.Bm=kb;kb.Bm=Ua;this.base.insert(Sa,Ua);this.Pe.insert(xb,kb);Ua=new k.a;Ua.add(new la.a(Ib,hc,
Qb,$b,dc,pb,Ob,$a.id,$a.Iu));return{returnValue:!0,su:Ua}}OFk($a){let kb;kb=null;let Ua,Sa;var xb;if(!({cWd:Ua}=this.mai($a,this.base,"Base")).returnValue)return{returnValue:!1,su:kb};if(!this.base.J(Ua).Bm||!({sga:Sa}=Y(this.Pe,this.base.J(Ua).Bm.Mj,0)).returnValue)return a.a.instance.Ta(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",
eventId:"bckc1"})),this.D2=!0,{returnValue:!1,su:kb};if(!({sga:xb}=U(this.Pe,Sa+1)).returnValue)return a.a.instance.Ta(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.D2=!0,{returnValue:!1,su:kb};let Qb,Ib,$b,hc,pb,dc;({o4a:xb,p4a:$b,ZQf:Qb,Dhn:hc,mhn:Ib,nhn:pb}=this.UTl($a,Sa,xb));if(!({length:dc}=ba(this.Pe,xb)).returnValue)return{returnValue:!1,
su:kb};this.wCh(this.Pe,xb,$b,Sa);this.Pe.oG(Sa);this.base.oG(Ua);kb=new k.a;kb.add(new za.MergeParagraphUpdateHint(Qb,hc,dc,Ib,pb,xb,$b,$a.id,$a.Iu));return{returnValue:!0,su:kb}}KEk($a,kb){var Ua=null;let Sa,xb,Qb;if(!({fNf:Qb,Syf:Sa}=this.Xbi($a,!0,kb)).returnValue)return{returnValue:!1,su:Ua};if(!({Sib:xb}=this.OOc(this.base,this.Pe,Sa,!0)).returnValue)return a.a.instance.Ta(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,
su:Ua};if(0<xb&&2!==this.Pe.J(xb-1).type)return a.a.instance.Ta(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.D2=!0,{returnValue:!1,su:Ua};let Ib;if(!({Zt:Ib}=this.Y3h(xb)).returnValue)return{returnValue:!1,su:Ua};kb=new H.a(kb,$a.Ag,$a.Lc);Ua=Qb;Ua.Bm=kb;kb.Bm=Ua;this.base.insert(Sa,Qb);this.Pe.insert(xb,kb);Ua=new k.a;Ua.add(new qa.AddParagraphUpdateHint($a.Ag,
$a.Lc,Ib,$a.id,$a.Iu));return{returnValue:!0,su:Ua}}J1e($a){let kb;kb=null;let Ua;var Sa;if(!({bWd:Sa}=this.dai($a,this.base,"Base")).returnValue)return{returnValue:!1,su:kb};if(!this.base.J(Sa).Bm||!this.base.J(Sa).Bm.Mj.equals($a.Ag))return a.a.instance.Ta(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.D2=
!0,{returnValue:!1,su:kb};if(!({Sib:Ua}=this.OOc(this.base,this.Pe,Sa,!0)).returnValue)return a.a.instance.Ta(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),{returnValue:!1,su:kb};if(0<Ua&&2!==this.Pe.J(Ua).type)return a.a.instance.Ta(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.D2=!0,{returnValue:!1,su:kb};
const xb=this.Pe.J(Ua).Mj,Qb=this.Pe.J(Ua).Lc;this.Pe.oG(Ua);this.base.oG(Sa);({Zt:Sa}=this.Y3h(Ua));0<Ua&&6===this.Pe.J(Ua-1).type&&this.MFn(Ua-1,Sa);kb=new k.a;kb.add(new Ia.a(xb,Qb,Sa,$a.id,$a.Iu));return{returnValue:!0,su:kb}}euh($a,kb,Ua){let Sa;var xb=({fha:kb,nwa:Sa}=this.WHa($a,Ua,!0,kb,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==xb)return 3!==xb&&(a.a.instance.Ta(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",
pa[Ua],Ma[xb]),this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({sga:xb}=U(this.Pe,Sa));xb=this.Pe.J(xb).Mj;$a=new ra(Ua,$a);Ua=new ra(Ua,xb);$a.Bm=Ua;Ua.Bm=$a;this.base.insert(kb,$a);this.Pe.insert(Sa,Ua);return!0}UTl($a,kb,Ua){let Sa,xb,Qb;Sa=$a.o4a.equals($a.Ag)?this.Pe.J(kb).Mj:this.Pe.J(Ua).Mj;$a=$a.p4a===$a.Lc?this.Pe.J(kb).Lc:this.Pe.J(Ua).Lc;xb=this.Pe.J(kb).Mj;kb=this.Pe.J(kb).Lc;Qb=this.Pe.J(Ua).Mj;Ua=this.Pe.J(Ua).Lc;return{o4a:Sa,
p4a:$a,ZQf:xb,Dhn:kb,mhn:Qb,nhn:Ua}}g5l($a,kb){let Ua;var Sa=$a.Ag.equals($a.Zt)?$a.y7:$a.Zt;const xb=$a.Lc===$a.Dta?$a.Saa:$a.Dta;$a.Ag.equals($a.Zt)?Ua=this.Pe.J(kb).Mj:(Ua=Sa,Sa=this.Pe.J(kb).Mj);$a.Lc===$a.Dta?($a=this.Pe.J(kb).Lc,kb=xb):($a=xb,kb=this.Pe.J(kb).Lc);return{Zt:Ua,y7:Sa,Dta:$a,Saa:kb}}yCh($a,kb,Ua,Sa){for(;Sa<$a.length;Sa++){if(!$a.J(Sa).t4()&&6!==$a.J(Sa).type&&2!==$a.J(Sa).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+$a.J(Sa).type);break}$a.J(Sa).Mj=
kb;if(2===$a.J(Sa).type){$a.J(Sa).Lc=Ua;break}}}xCh($a,kb,Ua,Sa,xb){this.yCh($a,Ua,Sa,xb);wa.zCh($a,kb,xb)}wCh($a,kb,Ua,Sa){this.yCh($a,kb,Ua,Sa+1);wa.zCh($a,kb,Sa)}mai($a,kb,Ua){let Sa,xb=-1;if(!({sga:Sa}=Y(kb,$a.Ag,0)).returnValue)return a.a.instance.Ta(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+Ua+"for GraphNodeId "+$a.Ag),{returnValue:!1,cWd:Sa};if(!({sga:xb}=U(kb,Sa+1)).returnValue||!kb.J(xb).Mj.equals($a.y7))return a.a.instance.Ta(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+
Sa+1+" in "+Ua+" of length "+kb.length),{returnValue:!1,cWd:Sa};this.wCh(kb,$a.o4a,$a.p4a,Sa);return{returnValue:!0,cWd:Sa}}lai($a,kb,Ua){let Sa;const xb=Ua?this.base:this.Pe,Qb=Ua?"Base":"Derived",Ib=({fha:kb,nwa:Ua,Zfa:Sa}=this.WHa($a.Ag,kb,Ua,$a.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===Ib||2===Ib)return a.a.instance.Ta(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+Qb),{returnValue:Ib,Tyf:kb,wpi:Ua,Zfa:Sa};this.xCh(xb,$a.Zt,$a.y7,$a.Saa,kb);return{returnValue:Ib,
Tyf:kb,wpi:Ua,Zfa:Sa}}dai($a,kb,Ua){return({idx:$a}=W(kb,$a.Ag)).returnValue?2!==kb.J($a).type?(a.a.instance.Ta(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+Ua),{returnValue:!1,bWd:-1}):{returnValue:!0,bWd:$a}:(a.a.instance.Ta(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+Ua),{returnValue:!1,bWd:-1})}MFn($a,kb){var Ua=this.Pe.J($a);if(kb){let Sa;({sga:Sa}=Y(this.Pe,kb,0));Ua=Ua.clone();Ua.Mj=kb;this.Pe.oG($a);this.Pe.insert(Sa,
Ua)}else this.Pe.length>$a&&(this.Pe.J($a+1).t4()||2===this.Pe.J($a+1).type)&&(Ua.Mj=this.Pe.J($a+1).Mj)}Xbi($a,kb,Ua){var Sa=kb?this.base:this.Pe;kb=kb?"Base":"Derived";Ua=new H.a(Ua,$a.Ag,$a.Lc);if($a.Zt){if(!({sga:Sa}=Y(Sa,$a.Zt,0)).returnValue)return a.a.instance.Ta(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",$a.Zt,kb),{returnValue:!1,fNf:Ua,Syf:Sa};Sa+=1}else Sa=0;return{returnValue:!0,fNf:Ua,Syf:Sa}}Y3h($a){let kb;kb=null;let Ua=$a-1;if(-1===
Ua)return{returnValue:!0,Zt:kb};6===this.Pe.J(Ua).type&&Ua--;if(2===this.Pe.J(Ua).type||4===this.Pe.J(Ua).type)return kb=this.Pe.J(Ua).Mj,{returnValue:!0,Zt:kb};a.a.instance.Ta(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",this.Pe.J($a-1).type);return{returnValue:!1,Zt:kb}}OOc($a,kb,Ua,Sa){let xb,Qb=!0;xb=-1;if(Ua>$a.length)return a.a.instance.Ta(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,Sib:xb};
if(Ua<$a.length){if(-1<Ua&&Ua<$a.length&&!$a.J(Ua).Bm){Qb=!1;for(var Ib=Ua+1;Ib<$a.length;Ib++)if($a.J(Ib).Bm){Ua=Ib;Qb=!0;break}}if(!Qb)return{returnValue:!1,Sib:xb};Qb=!1;for(Ib=0;$a.J(Ua)&&Ib<kb.length;Ib++)if(kb.J(Ib).Bm===$a.J(Ua)){xb=Ib;Qb=!0;break}if(!Qb)return{returnValue:!1,Sib:xb}}else xb=kb.length;if(0<xb&&Sa&&!kb.J(xb-1).Bm){for($a=xb-1;0<=$a&&!kb.J($a).Bm;$a--);xb=$a+1;6===kb.J(xb).type&&5!==this.Zd.input.source&&xb++}return{returnValue:!0,Sib:xb}}WHa($a,kb,Ua,Sa,xb,Qb){let Ib;var $b;
let hc;var pb=this.base;let dc=this.Pe,Ob=!1;Ua||(pb=this.Pe,dc=this.base);hc=$b=Ib=0;let Vb,ob,Xb=0;if(!({vQc:Sa,Jlb:Vb,UZc:ob}=Q(pb,$a,Sa)).returnValue)return a.a.instance.Ta(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),{returnValue:3,fha:Ib,nwa:$b,Zfa:hc};0<=Sa&&Sa<pb.length&&!pb.J(Sa).Bm&&Vb&&!xb&&(a.a.instance.Ta(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",
Qb),this.D2=!0,Xb=kb===pb.J(Sa).source?1:2,Ob=!0);xb&&!pb.J(Sa)&&Sa--;xb&&Vb&&!pb.J(Sa).Bm&&(Vb=!1,ob=0);if(!Ua&&!({idx:$a}=W(dc,$a)).returnValue&&!Vb)return{returnValue:0,fha:Sa,nwa:$b,Zfa:hc};if(!({Sib:$a}=this.OOc(pb,dc,Sa,Ua&&!Vb)).returnValue&&!Ob&&(kb=!1,1===this.okh&&0<Sa&&!ob&&(Sa--,{Sib:$a,returnValue:kb}=this.OOc(pb,dc,Sa,Ua&&!Vb),kb&&(Sa++,$a<dc.length-1?$a++:kb=!1)),!kb))return a.a.instance.Ta(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),
this.Zd.logger.Og(Object.assign(new ia.a,{rj:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.D2=!0,{returnValue:3,fha:Ib,nwa:$b,Zfa:hc};if(Vb&&(!J(pb,Sa,ob)||!Ob&&!J(dc,$a,ob)))return a.a.instance.shipAssertTag(17044297,1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,fha:Ib,nwa:$b,Zfa:hc};Ib=Sa;$b=$a;Vb&&(Ib=Sa+1,Ob||($b=pb.J(Sa),Ua=dc.J($a),$b.Bm=Ua,Ua.Bm=$b,pb=pb.J(Sa+1),$b=dc.J($a+1),pb.Bm=$b,$b.Bm=
pb,$b=$a+1));if($b>=dc.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+$b+" secondaryList length was "+dc.length),{returnValue:3,fha:Ib,nwa:$b,Zfa:hc};for(pb=0;pb<$b;pb++)dc.J(pb).Mj.equals(dc.J($b).Mj)&&(hc+=dc.J(pb).length);return{returnValue:Xb,fha:Ib,nwa:$b,Zfa:hc}}Tdf($a,kb,Ua){this.eOg.contains($a.id)&&this.kcb.Z($a.id,new k.a);for(--Ua;Ua>=kb;Ua--)this.eOg.contains($a.id)?this.kcb.J($a.id).insert(this.kcb.J($a.id).length,
this.Pe.J(Ua)):this.Pe.J(Ua).Bm&&(this.Pe.J(Ua).Bm.Bm=null),this.Pe.oG(Ua)}zAf($a,kb,Ua){if(this.kcb.mb($a.Iu)){const Sa=this.kcb.J($a.Iu);for(let xb=0;xb<Sa.length;xb++)Sa.J(xb).Mj=Ua.Mj,Object(ja.a)(H.a,Ua)&&Object(ja.a)(H.a,Sa.J(xb))&&(Sa.J(xb).Lc=Ua.Lc);this.Pe.PC(kb,this.kcb.J($a.Iu));this.kcb.remove($a.Iu)}else this.Pe.insert(kb,Ua)}cim($a){let kb,Ua;Ua=kb=-1;if(!$a.Bm)return{returnValue:!1,W4b:kb,oef:Ua};var Sa;let xb=0,Qb=!1;if(!({idx:Sa}=W(this.Pe,$a.Bm.Mj)).returnValue)return{returnValue:!1,
W4b:kb,oef:Ua};for(;Sa<this.Pe.length;Sa++){if($a.Bm===this.Pe.J(Sa)){kb=Sa;Ua=xb;Qb=!0;break}xb+=this.Pe.J(Sa).length}return{returnValue:Qb,W4b:kb,oef:Ua}}Fkf($a){let kb;kb=new k.a;let Ua=0,Sa=0;for(;Ua<$a.length;){if(Sa>=this.base.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,Emc:kb};if($a.J(Ua).length>this.base.J(Sa).length){if(!J($a,Ua,this.base.J(Sa).length))return a.a.instance.Ta(17335389,1,
2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",Ua,this.base.J(Sa).length),{returnValue:!1,Emc:kb}}else if($a.J(Ua).length<this.base.J(Sa).length){var xb=!!this.base.J(Sa).Bm,Qb=0;if(xb&&!({Sib:Qb}=this.OOc(this.base,this.Pe,Sa,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",Sa),
{returnValue:!1,Emc:kb};if(!J(this.base,Sa,$a.J(Ua).length)||xb&&!J(this.Pe,Qb,$a.J(Ua).length))return a.a.instance.Ta(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),{returnValue:!1,Emc:kb};if(xb){xb=this.base.J(Sa);var Ib=this.Pe.J(Qb);xb.Bm=Ib;Ib.Bm=xb;xb=this.base.J(Sa+1);Qb=this.Pe.J(Qb+1);xb.Bm=Qb;Qb.Bm=xb}}if(this.base.J(Sa).Bm&&5!==this.base.J(Sa).type&&this.base.J(Sa).t4()&&(Qb=this.base.J(Sa),xb=$a.J(Ua),!Qb.jJ.equals(xb.jJ)||
!Qb.yF.GA(xb.yF))){let $b;if(!({W4b:Ib,oef:$b}=this.cim(this.base.J(Sa))).returnValue)return{returnValue:!1,Emc:kb};kb.add(new sa(this.Pe.J(Ib).Mj,$b,Qb,xb))}Ua++;Sa++}return{returnValue:!0,Emc:kb}}static zCh($a,kb,Ua){for(--Ua;0<=Ua;Ua--){if(!$a.J(Ua).t4()&&6!==$a.J(Ua).type){a.a.instance.shipAssertTag(17311187,1,2===$a.J(Ua).type||4===$a.J(Ua).type,"Found merge block of type "+$a.J(Ua).type);break}$a.J(Ua).Mj=kb}}static ixi($a){return $a?!1:(a.a.instance.Ta(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),
!0)}}Object(F.a)(wa,"ParagraphMergeUsingHintsTwinList",null,[2041]);var hb=c(1727),eb=c(1728),jb=c(1724),ub=c(1726),ab=c(1725);class Ea{constructor($a,kb,Ua,Sa){this.cp=$a;this.length=kb;this.GBd=Ua;this.Dbd=Sa}}Object(F.a)(Ea,"UpdateFormattingIdsPosInfo",null,[]);class Wa{constructor($a,kb,Ua){this.D2=!1;this.kcb=new y.a;this.W6g=!1;this.Zd=$a;this.okh=Ua;this._base=kb;this.mye=aa(kb);if(!N(this.base,this.Pe))throw a.a.instance.Ta(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),$a.logger.Og(Object.assign(new I.a,
{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");this.Zd.runtime.Xb.qib(1000010)&&(this.W6g=!0)}get base(){return this._base}get Pe(){return this.mye}get mergeConflict(){return this.D2}m2e($a,kb){switch($a.type){case 11:return this.tFk($a,kb);case 8:return this.M1e($a,kb);case 10:return this.K1e($a);default:return!1}}l2e($a,kb){switch($a.type){case 11:return this.sFk($a,kb);case 8:return this.L1e($a,kb);case 10:return this.J1e($a);default:return{returnValue:!1,su:null}}}fuh(){a.a.instance.Ta(574433295,
1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.Zd.logger.Og(Object.assign(new I.a,{rj:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}euh(){a.a.instance.Ta(574433296,1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.Zd.logger.Og(Object.assign(new I.a,{rj:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}Fkf($a){let kb;kb=new k.a;let Ua=0,Sa=0,xb=0;for(;Ua<$a.length;){if(Sa>=this.base.length)return a.a.instance.shipAssertTag(574433297,
1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),{returnValue:!1,Cbd:kb};if($a.J(Ua).length>this.base.J(Sa).length){if(!J($a,Ua,this.base.J(Sa).length))return a.a.instance.Ta(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",
eventId:"8ps6s"})),{returnValue:!1,Cbd:kb}}else if($a.J(Ua).length<this.base.J(Sa).length&&!this.e7a(xb+$a.J(Ua).length,!0).returnValue)return a.a.instance.Ta(574433299,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,Cbd:kb};if(this.base.J(Sa).Bm&&5!==this.base.J(Sa).type&&this.base.J(Sa).t4()){const Qb=this.base.J(Sa),Ib=$a.J(Ua);if(!Qb.jJ.equals(Ib.jJ)||
!Qb.yF.GA(Ib.yF)){let $b,hc;if(({W4b:$b,iRh:hc}=this.dim(this.base.J(Sa))).returnValue)kb.add(new Ea(hc,this.Pe.J($b).length,Qb,Ib));else return a.a.instance.Ta(571757956,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,Cbd:kb}}}xb+=this.base.J(Sa).length;Ua++;Sa++}return{returnValue:!0,Cbd:kb}}tFk($a,kb){let Ua;if(!({DDa:Ua}=
this.e7a($a.cp,!0)).returnValue)return a.a.instance.Ta(574433300,1,2,"ApplyInsertTextHintToDerived"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"ApplyInsertTextHintToDerived",eventId:"8ps6u"})),!1;for(let xb=0;xb<$a.O_.length;xb++)switch($a.O_.J(xb).type){case 7:var Sa=$a.O_.J(xb);this.Pe.insert(Ua,new Ga(kb,null,Sa.text,Sa.id));break;case 9:Sa=$a.O_.J(xb);this.Pe.insert(Ua,new H.a(kb,Sa.Ag,Sa.Lc));break;default:return a.a.instance.Ta(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.Zd.logger.Og(Object.assign(new I.a,
{rj:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}M1e($a,kb){let Ua,Sa;if(!({DDa:Ua}=this.e7a($a.cp,!0)).returnValue||!({DDa:Sa}=this.e7a($a.cp+$a.text.length,!1)).returnValue)return a.a.instance.Ta(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for($a=Sa;$a>=Ua;$a--)this.Pe.J($a).source!==kb&&this.wId(this.Pe,$a);return!0}K1e($a){let kb;if(!({DDa:kb}=this.e7a($a.cp,!0)).returnValue)return a.a.instance.Ta(574433302,
1,2,"ApplyDeleteParaHintToDerived"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),!1;this.Wdf(this.Pe,$a,kb);return!0}sFk($a,kb){let Ua;Ua=null;let Sa,xb;if(!({Tzb:Sa,DDa:xb}=this.e7a($a.cp,!0)).returnValue)return a.a.instance.Ta(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,su:Ua};var Qb=this.hpf(this.Pe,xb-1);
Qb=new ab.a(Qb);for(let Ib=0;Ib<$a.O_.length;Ib++)switch($a.O_.J(Ib).type){case 7:Qb.O_.add(this.Q1e($a.O_.J(Ib),kb,Sa,xb));break;case 9:Qb.O_.add(this.uFk($a.O_.J(Ib),kb,Sa,xb));break;default:return a.a.instance.Ta(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,su:Ua}}Ua=new k.a;Ua.add(Qb);return{returnValue:!0,su:Ua}}Q1e($a,kb,Ua,Sa){const xb=new Ga(kb,$a.Ag,$a.text,$a.id);kb=new Ga(kb,
$a.Ag,$a.text,$a.id);xb.Bm=kb;kb.Bm=xb;this.base.insert(Ua,xb);this.Pe.insert(Sa,kb);Ua=new ub.a($a.Ag,$a.text);Ua.id=$a.id;return Ua}uFk($a,kb,Ua,Sa){const xb=new H.a(kb,$a.Ag,$a.Lc);kb=new H.a(kb,$a.Ag,$a.Lc);xb.Bm=kb;kb.Bm=xb;this.base.insert(Ua,xb);this.Pe.insert(Sa,kb);return new jb.a($a.Ag,$a.Lc)}L1e($a){let kb;kb=new k.a;let Ua;var Sa;let xb;if(!({Tzb:Ua,DDa:Sa}=this.e7a($a.cp,!0)).returnValue||!({Tzb:xb,DDa:Qb}=this.e7a($a.cp+$a.text.length,!1)).returnValue)return a.a.instance.Ta(588001990,
1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),{returnValue:!1,su:kb};this.Zd.runtime.Xb.HTd(1000010);for($a=Qb;$a>=Sa;$a--)if(this.Pe.J($a).Bm){var Qb=$a;const Ib=({UQf:$a}=this.pDl($a,Sa)).returnValue;Ib&&(kb.add(Ib),this.wId(this.Pe,$a,Qb))}for(Sa=xb;Sa>=Ua;Sa--)this.wId(this.base,Sa);return{returnValue:!0,su:kb}}J1e($a){let kb;kb=null;let Ua,Sa;if(!({Tzb:Ua,DDa:Sa}=this.e7a($a.cp,!0)).returnValue)return a.a.instance.Ta(574433305,
1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,su:kb};if(!this.Wdf(this.base,$a,Ua))return a.a.instance.Ta(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,su:kb};this.Wdf(this.Pe,$a,Sa)&&(kb=new k.a,kb.add(new hb.a(this.hpf(this.Pe,Sa-1),$a.Ag,$a.Lc)));
return{returnValue:!0,su:kb}}e7a($a,kb){var Ua;var Sa=Ua=-1;let xb,Qb;if(!({Jlb:Qb,Rwh:$a,Qwh:xb}=M(this.base,$a,this.Zd.logger)).returnValue)return{returnValue:!1,Tzb:Ua,DDa:Sa};const Ib=$a>=this.base.length;Ib&&$a--;if(this.base.J($a).Bm){const $b=this.MEl(this.Pe,this.base.J($a));if(Qb){if(0>$b||!J(this.base,$a,xb)||!J(this.Pe,$b,xb))return a.a.instance.Ta(575706444,1,2,"SplitTwinListAndFindIdx"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,
Tzb:Ua,DDa:Sa};Ua=this.base.J($a);Sa=this.Pe.J($b);Ua.Bm=Sa;Sa.Bm=Ua;Ua=this.base.J($a+1);Sa=this.Pe.J($b+1);Ua.Bm=Sa;Sa.Bm=Ua;Ua=kb?$a+1:$a;Sa=kb?$b+1:$b}else kb?(Ua=Ib?$a+1:$a,Sa=Ib?$b+1:$b):(Ua=Ib?$a:$a-1,Sa=Ib?$b:$b-1)}else if(Qb){if(J(this.base,$a,xb))Ua=kb?$a+1:$a;else return a.a.instance.Ta(575706445,1,2,"SplitTwinListAndFindIdx"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,Tzb:Ua,DDa:Sa};kb?(Sa=({vGb:Sa}=this.E6b(this.base,this.Pe,
$a,!1)).returnValue?Sa+1:0,Sa=Sa>=this.Pe.length?this.Pe.length-1:Sa):(Sa=({vGb:Sa}=this.E6b(this.base,this.Pe,$a,!0)).returnValue?Sa-1:this.Pe.length-1,Sa=0>Sa?0:Sa)}else kb?(({vGb:Sa}=this.E6b(this.base,this.Pe,$a,!0)).returnValue||(({vGb:Sa}=this.E6b(this.base,this.Pe,$a,!1)).returnValue?Sa+=1:(Sa=Ib?this.Pe.length-1:0,Sa=0>Sa?0:Sa)),Ua=Ib?$a+1:$a):(({vGb:Sa}=this.E6b(this.base,this.Pe,$a,!1)).returnValue||(({vGb:Sa}=this.E6b(this.base,this.Pe,$a,!0)).returnValue?--Sa:(Sa=$a?this.Pe.length-1:0,
Sa=0>Sa?0:Sa)),Ua=Ib?$a:$a-1);return{returnValue:!0,Tzb:Ua,DDa:Sa}}E6b($a,kb,Ua,Sa){let xb=null;if(Sa)for(;Ua<$a.length;Ua++){if($a.J(Ua).Bm){xb=$a.J(Ua).Bm;break}}else for(;0<=Ua;Ua--)if($a.J(Ua).Bm){xb=$a.J(Ua).Bm;break}if(xb)for($a=0;$a<kb.length;$a++)if(kb.J($a)===xb)return kb=$a,{returnValue:!0,vGb:kb};return{returnValue:!1,vGb:-1}}MEl($a,kb){for(let Ua=0;Ua<$a.length;Ua++)if($a.J(Ua).Bm===kb)return Ua;return-1}wId($a,kb,Ua=-1){for(Ua=0>Ua?kb:Ua;Ua>=kb;Ua--)$a.J(Ua).Bm&&($a.J(Ua).Bm.Bm=null),
$a.oG(Ua)}hpf($a,kb){let Ua=0;for(;0<=kb;kb--)Ua+=$a.J(kb).length;return Ua}wgm($a){$a=Object(n.a)(ya.a,$a);$a||(a.a.instance.Ta(575706448,1,2,"GetTextBlock"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"GetTextBlock",eventId:"8ujvq"})));return $a}pDl($a,kb){let Ua="",Sa=$a;for(;Sa>=kb&&this.Pe.J(Sa).Bm&&2!==this.Pe.J(Sa).type;)Ua=this.wgm(this.Pe.J(Sa)).text+Ua,Sa--;kb=0>Sa?0:this.hpf(this.Pe,Sa);return!this.W6g||Sa<$a?($a=Sa+1,{returnValue:new eb.a(kb,Ua),UQf:$a}):{returnValue:null,UQf:Sa}}dim($a){let kb,
Ua,Sa=!1;Ua=kb=0;if(!$a.Bm)return{returnValue:!1,W4b:kb,iRh:Ua};for(kb=0;kb<this.Pe.length;kb++){if(this.Pe.J(kb).Bm===$a){Sa=!0;break}Ua+=this.Pe.J(kb).length}return{returnValue:Sa,W4b:kb,iRh:Ua}}Wdf($a,kb,Ua){Ua=Ua===$a.length?--Ua:Ua;Ua>$a.length-1&&(a.a.instance.Ta(571757957,1,2,"DeleteEopInList: Idx out of range"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"DeleteEopInList",eventId:"8ffwf"})));if(2===$a.J(Ua).type){const Sa=$a.J(Ua);if(Sa.Mj!==kb.Ag||Sa.Lc!==kb.Lc)return!1;this.wId($a,Ua);return!0}return!1}}
Object(F.a)(Wa,"ParagraphMergeUsingHintsTwinListLcs",null,[2041]);var Bb=c(1570),Mb=c(1538),Fb=c(1723);c.d(K,"a",function(){return vb});class vb{constructor($a,kb,Ua,Sa,xb,Qb,Ib=null,$b=null,hc=null){this.cQ=this.wta=this.mKa=this.yra=null;this._initialized=!1;this.Zd=$a;this.GF=kb;this.OBa=Sa;this.tAa=Ua;this.asa=xb;this.jue=new f.a;for($a=0;$a<this.GF.length;$a++)this.jue.add(this.GF.J($a).id);this.YUg=new f.a;for($a=0;$a<this.tAa.length;$a++)this.YUg.add(this.tAa.J($a).id);this.bkh=new f.a;for($a=
0;$a<this.OBa.length;$a++)this.bkh.add(this.OBa.J($a).id);this.Ng=Qb;this.VWe=Ib||E.a.instance;this.qI=$b;this.DW=hc;this.Uub=1===(this.qI&&this.DW&&1===this.qI.LIa&&1===this.DW.LIa?1:0);this.$ra=0}get o8f(){return 1!==this.$ra}fBm(){var $a=!0;if(this.qI&&this.DW)return $a;if(this.qI||this.DW)return a.a.instance.Ta(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),
!1;this.Zd.runtime.Eu.mb(w.a.zL)&&($a=this.Zd.runtime.Eu.J(w.a.zL),$a=this.Bog($a,this.Zd.runtime.YCa.id,"favored")&&({updateHints:this.qI}=this.Eri($a,this.jue,this.YUg,this.Zd.runtime.Eu,"favored")).returnValue);$a&&this.Zd.runtime.Jq.mb(w.a.zL)&&($a=this.Zd.runtime.Jq.J(w.a.zL),$a=this.Bog($a,this.Zd.runtime.YCa.id,"unfavored")&&({updateHints:this.DW}=this.Eri($a,this.jue,this.bkh,this.Zd.runtime.Jq,"unfavored")).returnValue);this.qI=this.qI?this.qI:new Fb.a(new k.a,0);this.DW=this.DW?this.DW:
new Fb.a(new k.a,0);$a&&this.Zd.input.xGb&&($a=this.Zd.input.h$.last().n1a(w.a.zL),$a=this.Bog($a,this.Zd.input.h$.last().SW.id,"alreadyMerged"));return $a}nzm(){const $a=new f.a;if(this.Uub)return $a;const kb=this.qI?this.qI.updateHints.n5():new k.a;let Ua=0;for(;Ua<kb.length-1;){const Sa=kb.J(Ua);let xb,Qb=!1;for(xb=Ua+1;xb<kb.length;xb++){const Ib=kb.J(xb);if(Sa.Myi(Ib)){$a.add(Sa.id);kb.oG(xb);kb.oG(Ua);Qb=!0;break}}Qb||Ua++}return $a}Bog($a,kb,Ua){$a=this.Ng.getPropertyString($a,l.a.kUa);$a=
x.a.Ef($a);return kb.equals($a)?!0:(this.x7c(2),a.a.instance.Ta(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.Zd.runtime.YCa.id,$a,Ua),!1)}Eri($a,kb,Ua,Sa,xb){let Qb;Qb=new Fb.a(new k.a,0);$a=this.Ng.getPropertyObjectIds($a,l.a.u1).n5();for(let $b=0;$b<$a.length;$b++){if(!Sa.mb($a.J($b)))return a.a.instance.Ta(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",
$a.J($b),xb),{returnValue:!1,updateHints:Qb};const hc=Sa.J($a.J($b));var Ib=x.a.Ef(this.Ng.getPropertyString(hc,l.a.Cja));if(kb.contains(Ib)||Ua.contains(Ib)){Ib=this.VWe.gQc(hc);if(!Ib)return a.a.instance.Ta(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",hc.id,xb),{returnValue:!1,updateHints:Qb};Qb.updateHints.add(Ib)}}0<$a.length&&a.a.instance.Ta(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",
xb,$a.er(),Qb.updateHints.er());return{returnValue:!0,updateHints:Qb}}qAm(){return({GK:this.yra,SLc:this.mKa,Xad:this.wta}=Bb.a.pMh(this.Zd,this.Ng,this.GF,this.tAa,this.OBa,this.asa,!0,!0)).returnValue?!0:!1}dBm($a){const kb=Bb.a.dHd(this.Ng,Ua=>this.Zd.runtime.uk.J(Ua),this.GF,1,this.asa,!0,!0).returnValue;if(!kb)return a.a.instance.Ta(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.cQ=this.Uub?new Wa(this.Zd,kb,1):new wa(this.Zd,kb,$a,
this.qI?this.qI.LIa:0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;if(!this.fBm()||!this.qAm())return!1;const $a=this.nzm();return this.dBm($a)?!0:!1}Zbi($a){const kb=new k.a;let Ua="";for(let Sa=0;Sa<$a.length;Sa++){const xb=$a.J(Sa);xb.t4()?Ua+=$a.J(Sa).text:2===xb.type?(kb.add(new oa(xb.Mj,xb.type,Ua,xb.Lc)),Ua=""):4===xb.type&&(kb.add(new oa(xb.Mj,xb.type)),Ua="")}return kb}validateUpdateHintsAreComplete($a,kb,Ua){kb=this.Zbi(kb);$a=this.Zbi($a);let Sa=kb.length===
$a.length;if(Sa)for(let xb=0;xb<kb.length;xb++)if(!kb.J(xb).isEqual($a.J(xb))){Sa=!1;break}Sa||(this.x7c(4),a.a.instance.Ta(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",Ua,$a.er(),kb.er()));return Sa}Luh($a,kb,Ua){(kb=({b8a:$a}=this.cHk($a,kb,Ua)).returnValue)||this.x7c(this.cQ.mergeConflict?1:3);return{returnValue:kb,b8a:$a}}cHk($a,kb,Ua){let Sa;Sa=new k.a;let xb=!0;var Qb=
0;let Ib=null,$b=this.qI?this.qI.updateHints.length:0;for(var hc=0;hc<$b&&xb;hc++)Ib=this.qI.updateHints.J(hc),Qb<this.DW.updateHints.length&&Ib.id.equals(this.DW.updateHints.J(Qb).id)&&5!==this.Zd.input.source?({returnValue:xb}=this.cQ.l2e(Ib,2),Qb++):xb=this.cQ.m2e(Ib,2);if(!xb)return a.a.instance.Ta(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",Ib.toString()),{returnValue:!1,b8a:Sa};if(!this.validateUpdateHintsAreComplete(this.cQ.Pe,this.mKa,"Favored"))return{returnValue:!1,
b8a:Sa};if($a&&1===this.Zd.input.Sha&&!this.cQ.fuh(kb,Ua,2))return a.a.instance.Ta(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",kb,Ua),{returnValue:!1,b8a:Sa};xb=!0;hc=new k.a;for($b=this.DW?this.DW.updateHints.length:0;Qb<$b&&xb;Qb++){Ib=this.DW.updateHints.J(Qb);let pb;({su:pb,returnValue:xb}=this.cQ.l2e(Ib,4));xb&&pb&&hc.PC(hc.length,pb)}return xb?this.validateUpdateHintsAreComplete(this.cQ.base,this.wta,"Unfavored")?$a&&2===this.Zd.input.Sha&&!this.cQ.euh(kb,
Ua,4)?(a.a.instance.Ta(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",kb,Ua),{returnValue:!1,b8a:Sa}):{returnValue:!0,b8a:hc}:{returnValue:!1,b8a:Sa}:(a.a.instance.Ta(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",Ib.id,Ib.type),{returnValue:!1,b8a:Sa})}N3l(){let $a,kb=0;let Ua=0,Sa=x.a.nil;for($a=new y.a;Ua<this.cQ.base.length;){const Ib=this.cQ.base.J(Ua);Sa.equals(Ib.Mj)||(kb=0,Sa=Ib.Mj);if(5===Ib.type){var xb=
kb+Ib.length;var Qb=void 0;let $b;const hc=aa(this.wta);if(!({index:Qb}=V(hc,Ib.Mj,kb)).returnValue||!({index:$b}=V(hc,Ib.Mj,xb)).returnValue)return a.a.instance.Ta(17335384,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",Ib.kbd),{returnValue:!1,AOi:$a};for(xb=new k.a;Qb<$b;Qb++)xb.add(hc.J(Qb));$a.Z(Ib.kbd,xb)}kb+=Ib.length;Ua++}return{returnValue:!0,AOi:$a}}O3l(){let $a;$a=new y.a;let kb=0;for(let Sa=
0;Sa<this.cQ.base.length;Sa++){const xb=this.cQ.base.J(Sa);if(5===xb.type){var Ua=void 0;let Qb;const Ib=aa(this.wta);if(!({index:Ua}=X(Ib,kb,this.Zd.logger)).returnValue||!({index:Qb}=X(Ib,kb+xb.length,this.Zd.logger)).returnValue)return a.a.instance.Ta(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,BOi:$a};const $b=new k.a;for(;Ua<Qb;Ua++)$b.add(Ib.J(Ua));$a.Z(xb.kbd,$b)}kb+=xb.length}return{returnValue:!0,BOi:$a}}QFk($a){let kb;kb=
new k.a;let Ua;if(this.Uub){if(!({BOi:Ua}=this.O3l()).returnValue)return{returnValue:!1,uZc:kb}}else if(!({AOi:Ua}=this.N3l()).returnValue)return{returnValue:!1,uZc:kb};let Sa;Sa=this.Uub?new Wa(this.Zd,aa(this.mKa),1):new wa(this.Zd,aa(this.mKa),new f.a,this.qI?this.qI.LIa:0);for(var xb=0;xb<$a.length;xb++)if(!Sa.m2e($a.J(xb),4))return{returnValue:!1,uZc:kb};for($a=Sa.Pe.length-1;0<=$a;$a--)5===Sa.Pe.J($a).type&&(xb=Sa.Pe.J($a).kbd,Sa.Pe.oG($a),Sa.Pe.PC($a,Ua.J(xb)));this.Uub&&(this.uPh(Sa.Pe),this.uPh(this.cQ.Pe));
if(!this.validateUpdateHintsAreComplete(this.cQ.Pe,Sa.Pe,"Merged"))return{returnValue:!1,uZc:kb};kb=Sa.Pe;return{returnValue:!0,uZc:kb}}uPh($a){const kb=new y.a;for(let Ua=$a.length-1;0<=Ua;Ua--){const Sa=Object(n.a)(H.a,$a.J(Ua));Sa&&(kb.mb(Sa.Lc)?kb.J(Sa.Lc).source!==Sa.source&&$a.oG(Ua):kb.add(Sa.Lc,Sa))}}bHk($a){let kb;if(!({Cbd:kb}=this.cQ.Fkf(aa(this.wta))).returnValue)return!1;for(let Sa=0;Sa<kb.length;Sa++){const xb=kb.J(Sa);let Qb,Ib;if(!({index:Qb}=X($a,xb.cp,this.Zd.logger)).returnValue||
!({index:Ib}=X($a,xb.cp+xb.length,this.Zd.logger)).returnValue)return a.a.instance.Ta(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.Zd.logger.Og(Object.assign(new I.a,{rj:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var Ua=!1;for(let $b=Qb;$b<Ib&&!Ua;$b++)Ua=!xb.GBd.jJ.equals($a.J($b).jJ);if(!Ua){for(Ua=Qb;Ua<Ib;Ua++)$a.oG(Qb);$a.insert(Qb,xb.Dbd)}}return!0}aHk($a){let kb;if(!({Emc:kb}=this.cQ.Fkf(aa(this.wta))).returnValue)return!1;for(let xb=0;xb<kb.length;xb++){var Ua=
kb.J(xb);let Qb,Ib;if(({index:Qb}=V($a,Ua.Ag,Ua.cp)).returnValue&&({index:Ib}=V($a,Ua.Ag,Ua.cp+Ua.Dbd.length)).returnValue){var Sa=!1;for(let $b=Qb;$b<Ib&&!Sa;$b++)Sa=!Ua.GBd.jJ.equals($a.J($b).jJ)||!Ua.GBd.yF.GA($a.J($b).yF);if(Sa){if(this.qI&&1===this.qI.LIa||this.DW&&1===this.DW.LIa)return!1}else{for(Sa=Qb;Sa<Ib;Sa++)$a.oG(Qb);$a.insert(Qb,Ua.Dbd)}}else if(Ua=Ua.Dbd.VGm,a.a.instance.Ta(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",
Ua),Ua||this.qI&&1===this.qI.LIa||this.DW&&1===this.DW.LIa)return!1}return!0}N8l($a){let kb,Ua;Ua=new k.a;kb=this.Zd.runtime.en.J(w.a.zL);let Sa;({nNf:Sa}=vb.w4h(this.Zd,this.Ng));const xb=new k.a;for(let Ib=0;Ib<$a.length;Ib++){if(Sa.contains($a.J(Ib).id,(hc,pb)=>hc.equals(pb)))continue;if(this.Zd.runtime.en.mb($a.J(Ib).id))return a.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",$a.J(Ib).id),{returnValue:!1,l$d:kb,k$d:Ua};xb.add($a.J(Ib).id);
var Qb=$a.J(Ib).s1a();const $b=new Mb.a(Qb);Qb=Qb.Hl();for(const hc of Qb)$b.rC(hc);Ua.add($b)}$a=this.Ng.getPropertyObjectIds(kb.wm,l.a.u1);$a.PC($a.length,xb);this.Ng.setPropertyObjectIds(kb.wm,l.a.u1,$a);return{returnValue:!0,l$d:kb,k$d:Ua}}xPd($a){return String.format("Name: {0}, Message: {1}, Stack: {2}",$a.name,$a.message,$a.stack)}x7c($a){0===this.$ra&&(this.$ra=$a)}pmc(){let $a;$a=null;let kb,Ua;var Sa;try{if({en:$a,l$d:kb,k$d:Ua,returnValue:Sa}=this.qPo(),Sa){if(kb&&Ua){this.Zd.runtime.en.Z(kb.wm.id,
kb);for(Sa=0;Sa<Ua.length;Sa++){const $b=Ua.J(Sa);this.Zd.runtime.en.Z($b.wm.id,$b)}const xb=kb.wm,Qb=this.Ng.getPropertyObjectIds(xb,l.a.u1),Ib=this.Ng.getPropertyString(xb,l.a.kUa);a.a.instance.Ta(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",Qb.er(),Ib)}else a.a.instance.Ta(593826831,1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,en:$a}}}catch(xb){a.a.instance.Ta(17162313,
1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.xPd(xb))}this.x7c(5);a.a.instance.Ta(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.$ra,this.o8f);this.Y3a();this.qI&&1===this.qI.LIa&&this.Zd.logger.Og(Object.assign(new fa.a,{eventId:"bc04c",rj:"ParagraphMergeUsingHints.TryDoMerge",info:u[this.$ra]+"/LCS"}));return{returnValue:!1,en:$a}}qPo(){let $a,kb,Ua;Ua=kb=$a=null;let Sa;Sa=this.initialize();
this.Zd.logger.AU("PMUH Initialize");let xb=null;Sa=Sa&&({b8a:xb}=this.Luh(!1,x.a.nil,0)).returnValue;this.Zd.logger.AU("PMUH ApplyUpdateHints");let Qb=new k.a;Sa=Sa&&({uZc:Qb}=this.QFk(xb)).returnValue;this.Zd.logger.AU("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");Sa=this.Uub?Sa&&this.bHk(Qb):Sa&&this.aHk(Qb);this.Zd.logger.AU("PMUH ApplyUnfavoredFormattingChanges");this.Uub&&!this.v9n(Qb)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.Zd.logger.Og(Object.assign(new I.a,
{rj:"ReuseParaIdsIfPossible",eventId:"8ettb"})),Sa=!1);const Ib=this.qRd(Qb);Sa=Sa&&({j$d:$a}=Bb.a.ZOc(this.Zd,this.Ng,this.asa,Qb,Ib)).returnValue;this.Zd.logger.AU("PMUH GetMergeableObjectsFromMergeBlocks");this.qI&&1===this.qI.LIa&&this.DW&&1===this.DW.LIa||(Sa=Sa&&({l$d:kb,k$d:Ua}=this.N8l(G(xb))).returnValue,this.Zd.logger.AU("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:Sa,mergeConflict:!!this.cQ&&this.cQ.mergeConflict,en:$a,l$d:kb,k$d:Ua}}qRd($a){const kb=new k.a;for(let Ua=
0;Ua<$a.length;Ua++)2===$a.J(Ua).type&&kb.add($a.J(Ua).Mj);return kb}$pf($a){const kb=new k.a;for(let Ua=0;Ua<$a.length;Ua++)2===$a.J(Ua).type&&kb.add($a.J(Ua));return kb}v9n($a){var kb=this.$pf(this.yra),Ua=this.$pf(this.mKa),Sa=this.$pf(this.wta),xb=this.qRd(kb),Qb=this.qRd(Ua),Ib=this.qRd(Sa);Qb=L.b(xb,Qb,Ib);xb=new k.a;for(Ib=0;Ib<Qb.length;Ib++)xb.PC(xb.length,Qb.J(Ib).OEl());Qb=this.TEl($a);kb=this.PEl(Qb,xb,kb,Ua,Sa);Ua=0;Sa=new f.a;for(xb=0;xb<$a.length;xb++)if(Qb=$a.J(xb),2===Qb.type)if(Sa.contains(Qb.Mj))if(Ua<
kb.length)$a.oG(xb),$a.insert(xb,kb.J(Ua)),Ua++;else return!1;else Sa.add(Qb.Mj);0<$a.length&&2!==$a.J($a.length-1).type&&Ua<kb.length&&$a.insert($a.length,kb.J(Ua));return!0}TEl($a){const kb=new f.a;for(let Ua=0;Ua<$a.length;Ua++)2===$a.J(Ua).type&&kb.add($a.J(Ua).Mj);return kb}PEl($a,kb,Ua,Sa,xb){const Qb=new k.a;for(let Ib=0;Ib<kb.length;Ib++){const $b=kb.J(Ib);if(!$a.contains($b)){let hc;(({block:hc}=this.xkf(Sa,$b)).returnValue||({block:hc}=this.xkf(xb,$b)).returnValue||({block:hc}=this.xkf(Ua,
$b)).returnValue)&&hc&&Qb.add(hc)}}return Qb}xkf($a,kb){for(let Ua=0;Ua<$a.length;Ua++)if(2===$a.J(Ua).type&&$a.J(Ua).Mj===kb)return $a=$a.J(Ua),{returnValue:!0,block:$a};return{returnValue:!1,block:null}}Y3a(){const $a=new k.a;Bb.a.udc(this.Ng,"BaseObjects_",this.GF,$a);Bb.a.udc(this.Ng,"FavoredObjects_",this.tAa,$a);Bb.a.udc(this.Ng,"ConflictObjects_",this.OBa,$a)}jSk(){let $a,kb;$a=x.a.nil;kb=-1;let Ua=0;for(let Sa=0;Sa<this.cQ.Pe.length;Sa++){const xb=this.cQ.Pe.J(Sa);if(xb.t4())Ua+=xb.length;
else if(6!==xb.type)Ua=0;else return $a=xb.Mj,kb=Ua,{returnValue:!0,objectId:$a,cp:kb}}a.a.instance.Ta(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:$a,cp:kb}}gbd($a,kb){let Ua,Sa;Sa=kb;Ua=$a;try{let xb=this.initialize();if(xb=(xb=xb&&this.Luh(!0,$a,kb).returnValue)&&({objectId:Ua,cp:Sa}=this.jSk()).returnValue)return a.a.instance.Ta(17409924,1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",
Ua,Sa),{returnValue:!0,$5a:Ua,eqa:Sa}}catch(xb){a.a.instance.Ta(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.xPd(xb))}this.x7c(5);a.a.instance.Ta(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.$ra,this.o8f);this.Y3a();return{returnValue:!1,$5a:Ua,eqa:Sa}}static w4h($a,kb){let Ua;Ua=new k.a;if(!$a.input.xGb)return{returnValue:!0,nNf:Ua};$a=$a.input.h$.last().n1a(w.a.zL);
Ua=kb.getPropertyObjectIds($a,l.a.u1);return{returnValue:!0,nNf:Ua}}static uGn($a){if(!Bb.a.tgf($a))return!0;const kb=new z.a;$a.runtime.en.Z(w.a.zL,Bb.a.gBm($a,kb));return!0}static $Fn($a){if(!$a.runtime.en.mb(w.a.zL)||!$a.runtime.Jq.mb(w.a.zL))return!0;const kb=new z.a,Ua=$a.runtime.en.J(w.a.zL);var Sa=kb.getPropertyString(Ua.wm,l.a.kUa);if(x.a.Ef(Sa).equals(x.a.nil))return!0;Sa=kb.getPropertyObjectIds(Ua.wm,l.a.u1);const xb=kb.getPropertyObjectIds($a.runtime.Jq.J(w.a.zL),l.a.u1);let Qb;({nNf:Qb}=
vb.w4h($a,kb));for(let Ib=0;Ib<xb.length;Ib++)Sa.contains(xb.J(Ib),($b,hc)=>$b.equals(hc))||Qb.contains(xb.J(Ib),($b,hc)=>$b.equals(hc))||(Sa.add(xb.J(Ib)),$a.runtime.en.Z(xb.J(Ib),new Mb.a($a.runtime.Jq.J(xb.J(Ib)).KK())));kb.setPropertyObjectIds(Ua.wm,l.a.u1,Sa);return!0}}Object(F.a)(vb,"ParagraphMergeUsingHints",null,[1988])},1652:function(F,K,c){F=c(0);class l{constructor(n){this.nRi=n;this.succeeded=!1;this.imc=n?n.imc:0;this.vUm=!1;this.length=this.CIo=0}}Object(F.a)(l,"TrieResult",null,[]);
class f{constructor(n,u,z){this.olb=new l(null);this.c$m=n;this.KYc=u;this.fMi=u+z-1}get result(){return this.olb}qci(){let n;return this.KYc<=this.fMi?(n=this.c$m.charAt(this.KYc),++this.KYc,{returnValue:!0,ch:n}):{returnValue:!1,ch:"\x00"}}M4f(n,u,z){n&&(this.olb.vUm=!0,this.olb.CIo=u);this.olb.length=this.KYc;this.olb.succeeded=!0;this.olb.imc=z;this.KYc!==this.fMi+1&&(this.olb=new l(this.olb))}}Object(F.a)(f,"LookUpStringVisitor",null,[1403]);var a=c(1739);class k{constructor(){this.dCh=this.Azh=
this.Czh=this.zzh=this.Bzh=this.E5e=this.C5e=this.G5e=this.B5e=0}}Object(F.a)(k,"TRIESTATS",null,[]);class x{constructor(){this.symbol=this.p_c=0}}Object(F.a)(x,"TrieSymbol",null,[]);c.d(K,"a",function(){return y});class y{constructor(n,u){this.w4=null;this.L3d=this.uMi=this.sMi=this.wMi=this.oMi=this.vMi=this.tMi=this.xMi=this.pMi=0;this.FJ=n;if(n.Gy(u,4)!==y.nAb)throw Error.argument("Input does not represent a trie");u+=4;this.hMi=1===n.Gy(u,4);u+=4;this.$9m=1===n.Gy(u,4);u+=4;this.W9m=n.Gy(u,4);
u+=4;if(n.Gy(u,4)){n=u+4;this.w4=this.TQn(n);this.pMi=u=n+y.FQk;this.xMi=u+=y.xCd*(this.w4.B5e+(this.w4.B5e%2?1:0));this.tMi=u+=y.xCd*(this.w4.G5e+(this.w4.G5e%2?1:0));this.vMi=u+=y.xCd*(this.w4.C5e+(this.w4.C5e%2?1:0));this.oMi=u+=y.xCd*(this.w4.E5e+(this.w4.E5e%2?1:0));this.wMi=u+=y.I5e*this.w4.zzh;this.sMi=u+=y.J5e*this.w4.Czh;this.uMi=u+=y.J5e*this.w4.Azh;u+=y.J5e*this.w4.Bzh;if(u!==n+this.w4.dCh)throw Error.argument("Corrupted trie binary");this.L3d=u}else this.w4=null}GLi(n,u,z,w){n=new f(n,
u,z);this.DKj(n,w);return n.result}rhi(n){if(this.hMi)if(n)--n;else return"";if(!this.w4)throw Error.argument("Invalid trieID");const u=new a.a;u.FF=0;this.CQb(u);const z=[];for(;;){if(u.FF&y.P8a)if(n)--n;else return Array.add(z,u.KRb),String.fromCharCode.apply(null,z);const w=!!(u.FF&y.ure),E=this.H7b(u,!0);if(w||n<E){if(Array.add(z,u.KRb),!this.CQb(u))throw Error.argument("Invalid trieID");}else if(n-=E,!this.vad(u))throw Error.argument("Invalid trieID");}}DKj(n,u){let z=0;this.hMi&&(n.M4f(this.$9m,
this.W9m,0),++z);if(this.w4){var w=new a.a;w.FF=0;if(this.CQb(w))for(;;){var E=void 0;if(!({ch:E}=n.qci()).returnValue)break;u&&(E=u(E));E=E.toString().charCodeAt(0);let G=!1;for(;!G;){const H=!!(w.FF&y.P8a);if(w.KRb===E){if(G=!0,H&&n.M4f(!!(w.FF&y.Wug),w.xle,z),!this.CQb(w))return}else if(z+=this.H7b(w,!0),!this.vad(w))return;H&&++z}}}}CQb(n){if(!n.FF)return this.Mkg(n),!0;if(!(n.FF&y.tre))return!1;n.LPa=0;n.Jx=n.Rib;this.Mkg(n);return!0}vad(n){if(n.FF&y.ure)return!1;this.Mkg(n);return!0}H7b(n,u){return n.FF&
y.Vug?n.wCd:n.FF&y.tre?!u&&n.FF&y.ure?this.jTl(n):1:0}jTl(n){n=y.l8e(n);if(!this.CQb(n))return 0;let u=0;do n.FF&y.P8a&&++u,u+=this.H7b(n,!1);while(this.vad(n));return u}Mkg(n){n.FF||(n.LPa=0,n.Jx=this.L3d);var u=this.dId(this.pMi,n.Jx),z=u.symbol;n.Jx+=u.p_c;u=this.FJ.Gy(this.oMi+y.I5e*z,y.I5e);n.KRb=u&65535;n.FF=u>>16;n.FF&y.Vug&&(n.wCd=this.fil(n));n.FF&y.Wug&&(u=this.dId(this.xMi,n.Jx),z=u.symbol,n.Jx+=u.p_c,n.xle=this.FJ.Gy(this.wMi+4*z,4));n.FF&y.bTj?(n.Rib=this.L3d+((this.FJ.J(n.Jx)<<8|this.FJ.J(n.Jx+
1))<<8|this.FJ.J(n.Jx+2)),n.Jx+=3):n.FF&y.cTj?(n.Rib=n.Jx,n.LPa=n.Rib):n.FF&y.dTj?(u=this.dId(this.tMi,n.Jx),z=u.symbol,n.Jx+=u.p_c,n.Rib=this.L3d+this.FJ.Gy(this.sMi+4*z,4)):n.FF&y.tre&&(u=this.dId(this.vMi,n.Jx),z=u.symbol,n.Jx+=u.p_c,n.LPa||(n.LPa=n.Jx),n.LPa+=this.FJ.Gy(this.uMi+4*z,4),n.Rib=n.LPa)}dId(n,u){const z=new x;let w=0;for(;;){w+=this.FJ.J(u);++u;++z.p_c;const E=this.FJ.Gy(n,2);if(w<E)break;z.symbol+=E;w-=E;n+=2;w<<=8}z.symbol+=w;return z}fil(n){let u=this.FJ.J(n.Jx);192<=u?(u=(u&63)<<
15|(this.FJ.J(n.Jx+1)&127)<<8,u|=this.FJ.J(n.Jx+2),n.Jx+=3):128<=u?(u=(u&127)<<8|this.FJ.J(n.Jx+1),n.Jx+=2):n.Jx+=1;return u}TQn(n){const u=new k;u.B5e=this.FJ.Gy(n+12,2);u.G5e=this.FJ.Gy(n+14,2);u.C5e=this.FJ.Gy(n+16,2);u.E5e=this.FJ.Gy(n+18,2);u.Bzh=this.FJ.Gy(n+24,4);u.zzh=this.FJ.Gy(n+28,4);u.Czh=this.FJ.Gy(n+32,4);u.Azh=this.FJ.Gy(n+36,4);u.dCh=this.FJ.Gy(n+40,4);return u}static l8e(n){const u=new a.a;u.KRb=n.KRb;u.FF=n.FF;u.wCd=n.wCd;u.Jx=n.Jx;u.Rib=n.Rib;u.LPa=n.LPa;u.xle=n.xle;return u}}y.nAb=
1654263084;y.FQk=48;y.xCd=2;y.J5e=4;y.I5e=4;y.P8a=1;y.ure=2;y.Vug=4;y.Wug=8;y.tre=16;y.cTj=64;y.dTj=128;y.bTj=256;Object(F.a)(y,"Trie",null,[1385])},1654:function(F,K,c){c.r(K);F=c(0);c(1502);var l=c(1520);class f{}f.marketPlace=0;f.catalog=1;f.privateCatalog=10;Object(F.a)(f,"AppsForOfficeStoreType",null,[]);var a=c(1500),k=c(2),x=c(90),y=c(13);class n{constructor(){this.HTe=0}J1f(I,N){this.HTe=window.performance.now();this.CUa(()=>{const Q=window.performance.now(),M={},J=k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);N.xAk&&(M.callback=V=>{I(V,f.marketPlace,Q)},J&&(M.storeType=f.marketPlace),k.AFrameworkApplication.va.Qb(y.a.pMb,2,M));N.yAk&&(M.callback=V=>{I(V,f.privateCatalog,Q)},J?M.storeType=f.privateCatalog:k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?M.storeType=10:M.storeType=f.privateCatalog,k.AFrameworkApplication.va.Qb(y.a.pMb,2,M))},0,()=>{if(a.TellMeActor.instance.Oe)a.TellMeActor.instance.Oe.onError("AddinEntitlementsQuery:QueryEntitlementAsync",
"Query entitlements timeout after "+(window.performance.now()-this.HTe)+" ms")})}CUa(I,N=0,Q=null){2!==k.AFrameworkApplication.va.processAction(y.a.pMb,1)?(a.TellMeActor.instance.Oe&&a.TellMeActor.instance.Oe.MA(l.a.wAk,window.performance.now()-this.HTe),I()):N<n.ocn?k.AFrameworkApplication.nc.Vb(new x.a(2,1,n.p4o,()=>{this.CUa(I,N+1,Q)})):Q&&Q()}static get instance(){n._instance||(n._instance=new n);return n._instance}}n._instance=null;n.ocn=20;n.p4o=500;Object(F.a)(n,"AddinEntitlementsQuery",null,
[]);class u{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.eIf=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(F.a)(u,"AddinInfo",null,[]);var z=c(1504),w=c(1508),E=c(1507),G=c(1499),H=c(128);c.d(K,"AddinResultsProvider",function(){return L});class L{constructor(I){this.NPe=[];this.ic=I;this.Epn=(N,Q,M)=>{if(N){const J=N.errorCode;if(a.TellMeActor.instance.Oe){const V=
{};V.StoreType=Q;V.ErrorCode=J;V.AddinCount=N.value?N.value.length:0;a.TellMeActor.instance.Oe.MA(l.a.jMl,window.performance.now()-M,V)}if(0===J&&N.value){L.Azb=L.Azb||{};N=N.value;for(const V of N)N=new u,N.displayName=V[0],N.id=V[1],N.description=V[2],N.targetType=V[3],N.appVersion=4<V.length?V[4]:"",N.assetId=5<V.length?V[5]:"",N.assetStoreId=6<V.length?V[6]:"",N.width=7<V.length?V[7]:0,N.height=8<V.length?V[8]:0,N.iconUrl=9<V.length?V[9]:"",N.providerName=10<V.length?V[10]:"",N.storeId=11<V.length?
V[11]:"",N.storeType=12<V.length?V[12]:"",N.eIf=this.o1l(N),L.Azb[N.id]=N,0<N.iconUrl.length&&(Q="AddinIcon_"+N.id,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.H9i(Q,N.iconUrl):appChrome.addInApi.registerAddinIcon(Q,N.iconUrl))}}};n.instance.J1f(this.Epn,this.ic)}cL(){return"Add-ins"}bU(){return 0===this.ic.gv?0:1===this.ic.gv?1:2}PH(I,N,Q,M,J=null){Q=new E.a(I);J&&!Array.contains(J,27)||G.a.dR(I)||(J=new w.a(27),J.displayName=
CommonUIStrings.l_TellMeAddinProviderTitle,this.P0l(I.Dg,J),Q.Yu(J));N.resultsUpdated(Q)}P0l(I,N){if((I=this.Eco(I))&&0<I.length){let Q=0;I.forEach(M=>{if(!(3<++Q)){var J="AddinSuggestion"+Q,V={};if(k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var X="AddinIcon_"+M.id;0>Array.indexOf(this.NPe,X)&&0<M.iconUrl.length&&this.H9i(X,M.iconUrl);V["default"]=0<=Array.indexOf(this.NPe,X)?X:"AppForOfficeLogo_20"}else V["default"]=0<M.iconUrl.length?
"AddinIcon_"+M.id:"AppForOfficeLogo_20";X=[];X.push(appChrome.actions.setControlLabel(J,M.displayName));X.push(appChrome.actions.setControlIconSet(J,V));X.push(appChrome.actions.setCompoundButtonCommandValueId(J,M.id));X.push(appChrome.actions.updateCompoundButtonDescription(J,M.description));k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(V=window.performance.now(),X.push(appChrome.actions.updateControlEnabledDisabledState(J,!1)),
a.TellMeActor.instance.Oe&&a.TellMeActor.instance.Oe.MA(l.a.Oul,window.performance.now()-V));appChrome.api.dispatch(X);J=new z.a(J,27,void 0,void 0,1);J.KI=Telemetry.PrivacyRules.GetPrivacyCompliantId(M.id,M.storeType,M.assetId,null,null,M.storeId);N.Ow(J)}})}}H9i(I,N){H.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(I,N),Array.add(this.NPe,I))}Eco(I){if(!L.Azb)return null;const N=[],Q=L.Azb;for(let J in Q){var M=Q[J];M&&L.pbn(I,M)&&Array.add(N,M)}return N}o1l(I){return L.xCo(I.displayName)}static pbn(I,
N){if(!N.eIf)return!1;for(const Q of I.split(" ")){I=!1;for(const M of N.eIf)if(M.toLowerCase().startsWith(Q.toLowerCase())){I=!0;break}if(!I)return!1}return!0}static xCo(I){const N=[];for(const Q of I.split(" ")){I=0;for(let M=0;M<Q.length;M++){const J=Q.charAt(M);J.toString().toUpperCase()===J.toString()&&M>I&&(Array.add(N,Q.substring(I,M)),I=M)}Array.add(N,Q.substring(I,Q.length));I&&Array.add(N,Q.substring(0,Q.length))}return N}}L.Azb=null;Object(F.a)(L,"AddinResultsProvider",null,[1247])},1721:function(F,
K,c){c.d(K,"a",function(){return f});F=c(0);var l=c(221);class f{constructor(){this.lnb=this.mnb=this.N_a=this.qjb=this.knb=this.Lfb=this.ojb=this.n5a=this.Mfb=this.pjb=null;this.reset()}reset(){this.pjb=new l.a;this.Mfb=new l.a;this.n5a=new l.a;this.ojb=new l.a;this.Lfb=new l.a;this.knb=new l.a;this.qjb=new l.a;this.N_a=new l.a;this.N_a=new l.a;this.mnb=new l.a;this.lnb=new l.a}T2o(a){return this.yPa(this.pjb,a)&&this.yPa(this.Mfb,a)&&this.yPa(this.n5a,a)&&this.yPa(this.ojb,a)&&this.yPa(this.Lfb,
a)&&this.yPa(this.knb,a)&&this.yPa(this.qjb,a)&&this.yPa(this.N_a,a)&&this.yPa(this.mnb,a)&&this.yPa(this.lnb,a)}yPa(a,k){return!a||!a.length||a.length===k}}Object(F.a)(f,"MergeableTrackedChangesProperties",null,[])},1722:function(F,K,c){c.d(K,"a",function(){return a});F=c(0);var l=c(221),f=c(598);class a{constructor(){this.kJa=new l.a;this.lKa=new l.a;this.FMa=new l.a}get Rzb(){return this.kJa}get Sjf(){return this.lKa}get oqb(){return this.FMa}get isEmpty(){return!this.kJa.length&&!this.lKa.length&&
!this.FMa.length}get tlb(){return Math.max(Math.max(this.kJa.length,this.lKa.length),this.FMa.length)}get Oen(){return Math.min(Math.min(this.kJa.length,this.lKa.length),this.FMa.length)}LAd(k){this.kJa.add(k)}NAd(k){this.lKa.add(k)}RAd(k){this.FMa.add(k)}OEl(){const k=new f.a,x=new l.a;let y=0;for(;y<this.kJa.length||y<this.lKa.length||y<this.FMa.length;)y<this.kJa.length&&!k.contains(this.kJa.J(y))&&(x.add(this.kJa.J(y)),k.add(this.kJa.J(y))),y<this.lKa.length&&!k.contains(this.lKa.J(y))&&(x.add(this.lKa.J(y)),
k.add(this.lKa.J(y))),y<this.FMa.length&&!k.contains(this.FMa.J(y))&&(x.add(this.FMa.J(y)),k.add(this.FMa.J(y))),y++;return x}}Object(F.a)(a,"ObjectCollection",null,[])},1723:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a){this.LIa=a;this.updateHints=f}}Object(F.a)(l,"UpdateHintCollection",null,[])},1724:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(1565);class l extends c.a{constructor(f,a){super();this.Ag=f;this.Lc=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",
this.cp,this.type,this.Ag,this.Lc)}}Object(F.a)(l,"LcsInsertParaUpdateHint",c.a,[])},1725:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);var l=c(221);c=c(1565);class f extends c.a{constructor(a){super();this.O_=new l.a;this.cp=a}get type(){return 11}toString(){let a="";for(let k=0;k<this.O_.length;k++)a+=String.format("({0}), ",this.O_.J(k).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(F.a)(f,"LcsInsertUpdateHint",c.a,[])},1726:function(F,K,c){c.d(K,"a",function(){return l});
F=c(0);c=c(1565);class l extends c.a{constructor(f,a){super();this.text=a;this.Ag=f}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",this.cp,this.type,this.Ag,this.text)}}Object(F.a)(l,"LcsInsertTextUpdateHint",c.a,[])},1727:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(1565);class l extends c.a{constructor(f,a,k){super();this.cp=f;this.Ag=a;this.Lc=k}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",
this.cp,this.type,this.Ag,this.Lc)}}Object(F.a)(l,"LcsDeleteParaUpdateHint",c.a,[])},1728:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(1565);class l extends c.a{constructor(f,a){super();this.cp=f;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(F.a)(l,"LcsDeleteTextUpdateHint",c.a,[])},1729:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(1537);class l extends c.a{constructor(){super()}get uga(){return"Conflict"}}
Object(F.a)(l,"ConflictMergeFailureDetail",c.a,[])},1730:function(F,K,c){c.r(K);c.d(K,"InsightsMenuItemFactory",function(){return k});F=c(0);var l=c(1499),f=c(159),a=c(19);class k{constructor(x=null){this.Q7j=x||CommonUIStrings.l_InsightsButtonText}get wNb(){return 10}bga(x){var y=x.$C;x=l.a.Moa()?l.a.RNa(y,1):l.a.IBb(y);y=String.format(this.Q7j,y);return this.yKl(x,y)}yKl(x,y){return f.a(k.Wsi,l.a.Moa()?"1914896509":"3317204163",a.a.yf(y),l.a.aBf,null,a.a.yf(x),a.a.yf(y),null,null)}}k.Wsi="bInsights";
Object(F.a)(k,"InsightsMenuItemFactory",null,[1248])},1731:function(F,K,c){c.d(K,"a",function(){return a});F=c(0);var l=c(159),f=c(19);class a{constructor(k,x,y,n,u){this.yRe=k;this.xRe=x;this.Qmk=y;this.q6j=n;this.zZg=u}get wNb(){return 4}bga(k,x=null){x=x.sessionId+"|"+x.roa+"|"+k.$C;if(this.zZg||this.q6j){let y=this.zZg||f.a.XA(CommonUIStrings.l_HelpTooltip)===f.a.XA(k.$C.trim());if(this.Qmk&&2<k.$C.length){const n=k.$C;";"===n.charAt(0)&&";"===n.charAt(n.length-1)&&n.substring(1,n.length-1)===
a.Vxf&&(y=!0)}k=y?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,k.$C);return this.H3h(x,f.a.yf(k),y)}return this.H3h(x,f.a.yf(String.format(CommonUIStrings.l_TextWithQuotation,k.$C)),!1)}H3h(k,x,y){return l.a(a.Vxf,y?this.xRe:this.yRe,x,"OfficeAssistant_16x16x32","A0",f.a.yf(k),x,null,null)}}a.Vxf="bSearchHelp";Object(F.a)(a,"AssistanceMenuItemFactory",null,[1248])},1732:function(F,K,c){c.d(K,"a",function(){return x});F=c(0);var l=c(2),f=c(159),a=
c(88),k=c(19);class x{get wNb(){return 13}bga(){return x.eOk()}static eOk(){return f.b(x.x0h,"798637440",k.a.yf(CommonUIStrings.l_LookupFirstRunExperienceTitle),l.AFrameworkApplication.Ws,a.getImageClass("Info_32x32x32"),null,null,k.a.yf(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,k.a.yf(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}x.x0h="bTellMeFirstRun";Object(F.a)(x,"FirstRunMenuItemFactory",null,[1248])},1733:function(F,K,c){c.d(K,"a",function(){return k});
F=c(0);var l=c(2),f=c(159),a=c(19);class k{constructor(x=null,y=null){this.h8g=x;this.Cck=y||CommonUIStrings.l_LookupNoResultsDescription}get wNb(){return 14}bga(x){x=String.format(this.Cck,x.$C);return this.TOk(x)}TOk(x){return f.b(k.BRi,"798637440",a.a.yf(CommonUIStrings.l_LookupNoResultsTitle),this.h8g?l.AFrameworkApplication.Ws:null,this.h8g,null,null,a.a.yf(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.yf(x),null,null)}}k.BRi="lookupNoResults";Object(F.a)(k,"NoCommandsFoundMenuItemFactory",
null,[1248])},1734:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a){this.FontWeight=0;this.Text=null;this.FontWeight=f;this.Text=a}}Object(F.a)(l,"LabelFormatted",null,[])},1735:function(F,K,c){c.d(K,"a",function(){return y});F=c(0);c(1502);var l=c(1504),f=c(1508),a=c(1507),k=c(1499),x=c(19);class y{constructor(n){this.ic=n}cL(){return"Assistance"}bU(){return 0===this.ic.gv?0:1===this.ic.gv?1:this.ic.A0c?3:2}PH(n,u,z=!1,w,E=null){w=new a.a(n);if((!E||Array.contains(E,
8))&&!k.a.dR(n)){E=new f.a(8);if(z){z=x.a.XA(CommonUIStrings.l_HelpTooltip)===x.a.XA(n.Dg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,n.Dg);const G=[];this.ic.w3a&&(this.ic.Kie||G.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),z=this.Hci(n.Dg));const H="||"+n.Dg;G.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",z));G.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",H));
appChrome.api.dispatch(G);n=new l.a("GetHelpFromTellMe",4,n.Dg,null,1)}else n=new l.a("bSearchHelp",4,n.Dg,null,1);E.Ow(n);E.displayName=CommonUIStrings.l_HelpButtonTitle;w.Yu(E)}u.resultsUpdated(w)}yib(n,u=null){const z=new f.a(8),w=x.a.XA(CommonUIStrings.l_HelpTooltip)===x.a.XA(n.Dg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,n.Dg);for(let G=0;G<u.length&&2>G;G++){var E=void 0;E=[];let H="GetHelpWithDescriptionFromTellMe"+(G+1).toString(),
L=4;if(this.ic.n8c)E.push(appChrome.actions.setControlLabel(H,w)),E.push(appChrome.actions.setCompoundButtonCommandValueId(H,n.Dg)),E.push(appChrome.actions.updateCompoundButtonDescription(H,this.vvf(u.length)));else if(this.ic.o8c){let I=this.aji(u[G]);H="GetHelpFromTellMe"+(G+1).toString();this.ic.w3a&&(I=this.Hci(I));L=9;E.push(appChrome.actions.setControlLabel(H,I));E.push(appChrome.actions.setButtonCommandValueId(H,this.thm(u[G])))}appChrome.api.dispatch(E);E=new l.a(H,L,null,null,0);E.label=
this.aji(u[G]);E.description=this.shm(u[G]);z.Ow(E);if(this.ic.o8c)break}z.displayName=CommonUIStrings.l_HelpButtonTitle;return z}vvf(n){return 1===n?String.format(CommonUIStrings.l_SearchResultText,n):String.format(CommonUIStrings.l_SearchResultsText,n)}Hci(n){return this.ic.EGf?k.a.Aqf(n,CommonUIStrings.l_HelpScopedButtonText):n+CommonUIStrings.l_HelpScopedButtonText}aji(n){return n.name?n.name:""}shm(n){return n.description?n.description:""}thm(n){return n.id?"AssetID="+n.id:""}}Object(F.a)(y,
"AssistanceResultsProvider",null,[1247])},1736:function(F,K,c){c.d(K,"a",function(){return n});F=c(0);c(1502);var l=c(1504),f=c(1508),a=c(1507),k=c(1500),x=c(1499),y=c(1536);class n{constructor(u){this.ic=u}cL(){return"Image"}bU(){return 0===this.ic.gv?0:1===this.ic.gv?1:3===this.ic.gv?3:2}PH(u,z,w,E,G=null){w=new a.a(u);(!G||Array.contains(G,19))&&x.a.dR(u)&&this.ic.rP&&this.yib(u,w,1);z.resultsUpdated(w)}yib(u,z,w,E=null){var G=[];let H;k.TellMeActor.instance.BO()&&k.TellMeActor.instance.BO().w3a?
(H=this.ic.EGf?x.a.Aqf(u.Dg,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):u.Dg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.ic.Kie||G.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):H=this.ic.rP?x.a.dR(u)?this.ic.Wdb?x.a.rhb(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.ic.Wdb?x.a.rhb(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,
u.Dg)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,u.Dg):this.ic.Njc?CommonUIStrings.l_TellMeImageSuggestionButtonText:u.Dg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.ic.$va?(k.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",H)),G=x.a.RNa(u.Dg,9,Object.assign(new y.a,{landingTab:"Image"})),k.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",G))):(G.push(appChrome.actions.setControlLabel("ImageForSearch",
H)),u=x.a.RNa(u.Dg,9,Object.assign(new y.a,{landingTab:"Image"})),G.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",u)),appChrome.api.dispatch(G));w=new l.a("ImageForSearch",12,null,null,w);E&&(w.score=E.ConfidenceScore);E=new f.a(19,this.ic.Njc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);E.Ow(w);z.Yu(E)}}Object(F.a)(n,"ImageResultsProvider",null,[1247])},1737:function(F,K,c){c.d(K,"a",function(){return y});F=c(0);c(1502);var l=c(1504),f=c(1508),a=c(1507),
k=c(1499),x=c(2);class y{constructor(n){this.ic=n}cL(){return"Template"}bU(){return 0===this.ic.gv?0:1===this.ic.gv?1:3}PH(n,u){n=new a.a(n);u.resultsUpdated(n)}yib(n,u,z){var w=[];let E;E=this.ic.rP?this.ic.Wdb?k.a.rhb(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,n.Dg)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,n.Dg):String.format(CommonUIStrings.l_TellMeTemplateButtonText,n.Dg);w.push(appChrome.actions.setControlLabel("TemplateForSearch",E));w.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(x.AFrameworkApplication.K.jb("TellMeTemplateProviderURL"),x.AFrameworkApplication.uiCulture,n.Dg)));appChrome.api.dispatch(w);n=new f.a(23);n.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;w=new l.a("TemplateForSearch",24,null,null,0);w.label=z[0].Title?z[0].Title:"";w.description=z[0].Description?z[0].Description:"";n.Ow(w);u.Yu(n)}}Object(F.a)(y,"TemplateResultsProvider",null,[1247])},1738:function(F,K,c){c.d(K,"a",function(){return z});F=c(0);c(1502);var l=c(1539),f=c(1504),
a=c(1508),k=c(1507),x=c(1639),y=c(1500),n=c(1499),u=c(19);class z{constructor(w,E,G,H){this.E2=w;this.fdb=E;this.Mjh=H;this.N3j=G;this.ic=y.TellMeActor.instance.BO()}cL(){return"EmptyQuery"}bU(){return 1===this.ic.gv?1:0}PH(w,E,G=!1,H,L=null){H=new k.a(w);if((!L||Array.contains(L,5)||Array.contains(L,6)||Array.contains(L,4))&&n.a.dR(w)){this.E2.ZNc().length||!this.N3j||this.Mjh||(w=new a.a(6),L=new f.a(null,13,void 0,void 0,1),w.Ow(L),H.Yu(w));w=new a.a(4);if(0<this.E2.ZNc().length){w.displayName=
CommonUIStrings.l_TellMeRecentlyUsedTitle;L=this.E2.ZNc();var I=[];for(var N of L)I.push(N.Id);l.CommandResultsUtility.cbd(I,this.ic);for(var Q of L)l.CommandResultsUtility.UTc(Q.Id)&&w.Ow(new f.a(Q.Id,5,null,null,2));H.Yu(w)}if(this.Mjh&&0<this.fdb.length&&this.E2.ZNc().length<z.maxResults){N=new a.a(5);N.displayName=CommonUIStrings.l_TellMeTryQueryTitle;Q=z.maxResults-w.results.length;w=[];for(L=0;L<this.fdb.length&&L<Q;++L){if(G){I=n.a.rlg+(L+1);const M=this.fdb[L].key,J=u.a.replaceAll(M,'"',"");
w.push(appChrome.actions.setControlLabel(I,M));w.push(appChrome.actions.setButtonCommandValueId(I,J));I=new x.a(M,7,0,J,I)}else I=new x.a(this.fdb[L].key,7,0,this.fdb[L].value);N.Ow(I)}0<w.length&&appChrome.api.dispatch(w);H.Yu(N)}}E.resultsUpdated(H)}}z.maxResults=5;Object(F.a)(z,"EmptyQueryResultsProvider",null,[1247])},1739:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.xle=this.LPa=this.Rib=this.Jx=this.wCd=this.FF=this.KRb=0}}Object(F.a)(l,"TRIESCAN",null,[])},
1741:function(F,K,c){c.d(K,"a",function(){return G});F=c(0);var l=c(2),f=c(403),a=c(695),k=c(398),x=c(717);c.n(x);var y=c(735);c.n(y);var n=c(99),u=c(1086),z=c(367),w=c(330),E=c(7);c=c(254);class G extends c.a{constructor(H,L){super("SummaryGenerationCondition");this.ehg=-1;this.Ijj=()=>{if(!G.qhg&&this.Dpe.ny>G.Ren){const I=a.a.getAugLoopRuntimeManager(),N=this.NNd();this.ehg=Date.now();I.submitOperation(Object.assign(new w.a,{operation:N}))}};this.Jjj=()=>{this.Ijj();this.Dpe.Tde(this.Jjj)};this.zmb=
I=>{I=I.items[0];x.TextSummaryAnnotation.typeGuard(I.body)||x.GptSummaryAnnotation.typeGuard(I.body)||y.TextAbstractiveSummaryAnnotation.typeGuard(I.body)?(G.qhg=I.body,"Success"!==G.qhg.status?this.Sg(!1):(this.Sg(!0),this.g5m())):(E.ULS.sendTraceTag(508944770,3047,10,`unexpected annotation: ${n.a.getTypeNameFor(I.body)}`),this.Sg(!1))};this.Dpe=L.getInstance(0);this.Hn=H.Hn}static get summary(){return G.qhg}initialize(){super.initialize();k.a.Mk().then(()=>{const H=a.a.getAugLoopRuntimeManager();
let L;L=this.Xyi()?x.GptSummaryAnnotation.getTypeName():this.ITc()?y.TextAbstractiveSummaryAnnotation.getTypeName():x.TextSummaryAnnotation.getTypeName();H.activateAnnotation(Object.assign(new f.a,{annotationType:L,handler:this.zmb}))});-1===this.Dpe.ny?this.Dpe.vzb(this.Jjj):this.Ijj()}Nd(){super.Nd()}ITc(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AzureTextSummarizationIsEnabled",!1)}Xyi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.KeypointsSummaryEnabled",
!1)}NNd(){return this.Xyi()?Object.assign(new u.l,{parentPath:["Signal",x.GptSummarySignal.getTypeName()],items:[Object.assign(new z.a,{body:new x.GptSummarySignal})]}):this.ITc()?Object.assign(new u.l,{parentPath:["Signal",y.GenerateTextAbstractiveSummarySignal.getTypeName()],items:[Object.assign(new z.a,{body:new y.GenerateTextAbstractiveSummarySignal({clientApplication:"Editor"})})]}):Object.assign(new u.l,{parentPath:["Signal",x.GenerateTextSummarySignal.getTypeName()],items:[Object.assign(new z.a,
{body:new x.GenerateTextSummarySignal})]})}Sg(H){super.Sg(H);E.ULS.sendTraceTag(508944769,3028,50,this.sT(this.Hn,H))}g5m(){if(-1!==this.ehg){var H=Date.now()-this.ehg;E.ULS.sendTraceTag(508925082,3047,50,"[Copilot Chat][Summarization] Latency for summary generation response (ms): {0}",H)}}}G.Ren=300;Object(F.a)(G,"SummaryGenerationCondition",c.a,[])},1760:function(F,K,c){c.r(K);var l=c(0),f=c(1502),a=c(1549),k=c(1520),x=c(1504),y=c(1508),n=c(1507),u=c(1500),z=c(1499),w=c(1536);class E{constructor(cb){this.ic=
cb}cL(){return"ActionAI"}bU(){return 0===this.ic.gv?0:1===this.ic.gv?1:2}PH(cb,Hb,bc=!1,Cc,Kc=null){Cc=new n.a(cb);if(!Kc||Array.contains(Kc,24))if(this.Fuo()||!z.a.dR(cb)){Kc=new y.a(24);var kd=z.a.dR(cb);bc&&(bc=null,z.a.Moa()&&(bc=z.a.RNa(kd?"":cb.Dg,1,Object.assign(new w.a,{landingTab:"ActionAI"}))),this.ic.$va?bc&&u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",bc)):(cb=[],bc&&cb.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",
bc)),appChrome.api.dispatch(cb)));Kc.Ow(new x.a("ActionAIFromTellMe",25,null,null,1));Cc.Yu(Kc)}Hb.resultsUpdated(Cc)}Fuo(){return z.a.Moa()&&this.ic.KBf}}Object(l.a)(E,"ActionAIResultsProvider",null,[1247]);var G=c(1654);class H{constructor(cb,Hb){this.Cza=cb;this.Qk=Hb}resultsUpdated(cb){this.Cza.wno(this.Qk,cb)}}Object(l.a)(H,"AggregatorResultsProviderCallback",null,[1252]);class L{constructor(cb){this.tra=null;this.ic=cb;this.ic.Izb&&(this.tra=null)}cL(){return"AppsForOffice"}bU(){return 0===
this.ic.gv?0:1===this.ic.gv?1:2}PH(cb,Hb,bc,Cc,Kc=null){bc=new n.a(cb);if(!Kc||Array.contains(Kc,1))Kc=new y.a(1),this.tra.Ndp(Kc,cb.Dg),bc.Yu(Kc);Hb.resultsUpdated(bc)}}Object(l.a)(L,"AppsForOfficeRecommendationResultsProvider",null,[1247]);var I=c(1735),N=c(1495),Q=c(1515),M=c(111);class J{constructor(cb,Hb){this.Ab=cb;this.Z9m=Hb}isMatch(cb,Hb){if(!Object(M.a)(1337,cb))throw Error.argument("objToTest","Expected feature bundle");let bc;return({value:bc}=cb.Iq(this.Ab.Xta)).returnValue?this.Ab.Dog.isMatch(bc,
Hb):this.Z9m}}Object(l.a)(J,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1374]);class V{constructor(cb,Hb){this.Ab=cb;this.SLf=Hb}isMatch(cb){if(!Object(M.a)(1337,cb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.SLf^cb.Iq(this.Ab.Xta).returnValue)}}Object(l.a)(V,"AnnotatedWithAnnotationFilter",null,[1374]);class X{constructor(cb){this.Ab=cb}isMatch(cb,Hb){if(!Object(M.a)(1343,cb))throw Error.argument("objToTest","Expected struct value");return this.Ab.Dog.isMatch(cb.Hhb(this.Ab.AOa),
Hb)}}Object(l.a)(X,"FieldValueMatchesStructFilter",null,[1374]);class W{constructor(cb,Hb){cb&&(this.AOa=cb.J(0),this.Dog=Hb.Cna(cb.J(1)))}}Object(l.a)(W,"FieldValueMatchesStructFilterInit",null,[]);class U{constructor(cb){this.SLf=cb}isMatch(cb){if(!Object(M.a)(1337,cb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.SLf^cb.ixf)}}Object(l.a)(U,"HasAnnotationsAnnotationFilter",null,[1374]);class Y{constructor(cb,Hb){this.Ab=cb;this.g9=Hb}isMatch(cb,Hb){if(!Object(M.a)(1342,
cb))throw Error.argument("objToTest","Expected list value");switch(this.g9){case 0:for(const bc of cb.items)if(this.Ab.filter.isMatch(bc,Hb))return!0;return!1;case 1:for(const bc of cb.items)if(!this.Ab.filter.isMatch(bc,Hb))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(Y,"ItemTestListFilter",null,[1374]);class ba{constructor(cb){this.Ab=cb}isMatch(cb,Hb){if(!Object(M.a)(1342,cb))throw Error.argument("objToTest","Expected list value");return this.Ab.filter.isMatch(cb.items.length,
Hb)}}Object(l.a)(ba,"LengthMatchesListFilter",null,[1374]);class aa{constructor(cb,Hb){this.Ab=cb;this.g9=Hb}isMatch(cb,Hb,bc=null){let Cc=0===this.g9;for(const Kc of this.Ab.LDh)if((Cc=Kc.isMatch(cb,Hb,bc))?1===this.g9:0===this.g9)return Cc;2===this.g9&&(Cc=!Cc);return Cc}}Object(l.a)(aa,"NonterminalFilter",null,[1374]);class fa{constructor(cb,Hb){if(cb){var bc=cb.J(0);this.LDh=Array(bc);for(let Cc=0;Cc<bc;++Cc)this.LDh[Cc]=Hb.Cna(cb.J(1+Cc))}}}Object(l.a)(fa,"NonterminalFilterInit",null,[]);class na{constructor(cb,
Hb){this.Ab=cb;this.g9=Hb}isMatch(cb,Hb){if("number"!==typeof cb)throw Error.argument("objToTest","Expected number value");let bc=this.Ab.number;if(this.Ab.query){Hb=this.Ab.query.It(null,Hb);if("number"!==typeof Hb)throw Error.invalidOperation("Query did not return number");bc+=Hb}switch(this.g9){case 0:return cb===bc;case 1:return cb<bc;case 2:return cb<=bc;case 3:return cb>bc;case 4:return cb>=bc;default:throw Error.notImplemented();}}}Object(l.a)(na,"NumberFilter",null,[1374]);class oa{constructor(cb,
Hb){cb&&(this.number=cb.J(0),this.query=cb.J(1)?Hb.VK(cb.J(1)):null)}}Object(l.a)(oa,"NumberFilterInit",null,[]);class ja{constructor(cb,Hb,bc){this.APd=this.aXl;this.e$m=cb;this.lMi=Hb;this.kMi=bc}W6e(cb){this.lMi=cb}aXl(cb){if(!cb)throw Error.argument("name","Invalid named feature bundle reference");const Hb=cb.substr(1);return 1===cb.charCodeAt(0)&&Hb===this.e$m?this.lMi:this.kMi?this.kMi.APd(cb):null}}Object(l.a)(ja,"SimpleNamedFeatureBundleResolver",null,[1393]);class qa{constructor(cb){this.Ab=
cb}isMatch(cb,Hb){if(!Object(M.a)(1337,cb))throw Error.argument("objToTest","Expected feature bundle");cb=this.Ab.query.It(null,new ja(this.Ab.cpe,cb,Hb));if("boolean"!==typeof cb)throw Error.invalidOperation("Query did not return bool");return cb}}Object(l.a)(qa,"PredicateAnnotationFilter",null,[1374]);class Ia{constructor(cb,Hb){cb&&(this.cpe=Hb.QD(cb.J(0)),this.query=Hb.VK(cb.J(1)))}}Object(l.a)(Ia,"PredicateAnnotationFilterInit",null,[]);class Va{constructor(cb){this.Ab=cb}isMatch(cb,Hb){if("boolean"!==
typeof cb)throw Error.argument("objToTest","Expected bool value");Hb=this.Ab.query.It(null,Hb);if("boolean"!==typeof Hb)throw Error.invalidOperation("Query did not return bool");return cb===Hb}}Object(l.a)(Va,"QueryBooleanFilter",null,[1374]);class Na{constructor(cb,Hb){this.Ab=cb;this.g9=Hb}isMatch(cb,Hb){if("number"!==typeof cb)throw Error.argument("objToTest","Expected integer");Hb=this.Ab.query.It(null,Hb);if("number"!==typeof Hb)throw Error.invalidOperation("Query did not return an enum value");
switch(this.g9){case 0:return cb===Hb;case 1:return 0!==(cb&Hb);case 2:return cb===(cb&Hb);case 3:return Hb===(cb&Hb);default:throw Error.notImplemented();}}}Object(l.a)(Na,"QueryEnumFilter",null,[1374]);class za{constructor(cb,Hb){cb&&(this.YZd=1===cb.J(0),this.query=Hb.VK(cb.J(1)))}}Object(l.a)(za,"QueryEnumFilterInit",null,[]);class la{constructor(cb,Hb){this.Ab=cb;this.g9=Hb}isMatch(cb,Hb){if(!Object(M.a)(1342,cb))throw Error.argument("objToTest","Expected list value");Hb=this.Ab.query.It(null,
Hb);if(!Object(M.a)(1342,Hb))throw Error.invalidOperation("Query did not return list value");if(cb.y4!==Hb.y4)return!1;switch(this.g9){case 0:return N.Annotations.Jqb(N.Annotations.$2l(cb.y4),cb,Hb);case 1:for(const bc of cb.items)for(const Cc of Hb.items)if(N.Annotations.Jqb(cb.y4,bc,Cc))return!0;return!1;case 2:for(const bc of cb.items)for(const Cc of Hb.items)if(!N.Annotations.Jqb(cb.y4,bc,Cc))return!1;return!0;case 3:for(const bc of Hb.items)for(const Cc of cb.items)if(!N.Annotations.Jqb(cb.y4,
bc,Cc))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(la,"QueryListFilter",null,[1374]);class va{constructor(cb,Hb){this.Ab=cb;this.g9=Hb}isMatch(cb,Hb){if("string"!==typeof cb)throw Error.argument("objToTest","Expected string");Hb=this.Ab.query.It(null,Hb);if("string"!==typeof Hb)throw Error.invalidOperation("Query did not return string");this.Ab.fCf&&(cb=cb.toUpperCase(),Hb=Hb.toUpperCase());switch(this.g9){case 0:return cb===Hb;case 1:return 0<=cb.indexOf(Hb);case 2:return cb.startsWith(Hb);
case 3:return cb.endsWith(Hb);case 4:return 0<=Hb.indexOf(cb);case 5:return Hb.startsWith(cb);case 6:return Hb.endsWith(cb);default:throw Error.notImplemented();}}}Object(l.a)(va,"QueryStringFilter",null,[1374]);class ia{constructor(cb,Hb){cb&&(this.query=Hb.VK(cb.J(0)),this.fCf=1===cb.J(1))}}Object(l.a)(ia,"QueryStringFilterInit",null,[]);class pa{constructor(cb){this.Ab=cb}isMatch(cb,Hb){if(!Object(M.a)(1343,cb))throw Error.argument("objToTest","Expected struct value");Hb=this.Ab.query.It(null,
Hb);if(!Object(M.a)(1343,Hb))throw Error.invalidOperation("Query did not return struct value");return cb.isEqual(cb)}}Object(l.a)(pa,"QueryStructFilter",null,[1374]);class sa{constructor(cb){this.Ab=cb}isMatch(cb,Hb){cb=this.Ab.query.It(null,Hb);if("boolean"!==typeof cb)throw Error.invalidOperation("Query did not return bool");return cb}}Object(l.a)(sa,"QueryWhereConstraintFilter",null,[1374]);class Ha{constructor(cb){this.Ab=cb}isMatch(cb){if("string"!==typeof cb)throw Error.argument("objToTest",
"Expected string");return this.Ab.c4f.test(cb)}}Object(l.a)(Ha,"RegexStringFilter",null,[1374]);class ra{constructor(cb,Hb){cb&&(this.c4f=Hb.L8b(cb.J(0)))}}Object(l.a)(ra,"RegexStringFilterInit",null,[]);class Ma{constructor(cb,Hb){cb&&(this.filter=Hb.Cna(cb.J(0)))}}Object(l.a)(Ma,"SingleFilterFilterInit",null,[]);class ya{constructor(cb,Hb){cb&&(this.query=Hb.VK(cb.J(0)))}}Object(l.a)(ya,"SingleQueryFilterInit",null,[]);class Ga{constructor(cb){this.Ab=cb}isMatch(cb){if("boolean"!==typeof cb)throw Error.argument("objToTest",
"Expected bool value");return cb===this.Ab.value}}Object(l.a)(Ga,"StoredValueBooleanFilter",null,[1374]);class wa{constructor(cb){cb&&(this.value=1===cb.J(0))}}Object(l.a)(wa,"StoredValueBooleanFilterInit",null,[]);class hb{constructor(cb,Hb){this.Ab=cb;this.g9=Hb}isMatch(cb){if("number"!==typeof cb)throw Error.argument("objToTest","Expected integer");switch(this.g9){case 0:return this.Ab.YZd?this.Ab.value?!!(cb&this.Ab.value):!cb:cb===this.Ab.value;case 1:return this.Ab.YZd?(cb&this.Ab.value)===
this.Ab.value:32>cb&&(1<<cb&this.Ab.value)===this.Ab.value;case 2:return this.Ab.YZd?!!(cb&this.Ab.value):32>cb&&!!(1<<cb&this.Ab.value);default:throw Error.notImplemented();}}}Object(l.a)(hb,"StoredValueEnumFilter",null,[1374]);class eb{constructor(cb){cb&&(this.YZd=1===cb.J(0),this.value=cb.J(1))}}Object(l.a)(eb,"StoredValueEnumFilterInit",null,[]);class jb{constructor(){this.jBn=null;this.H5e=this.uGb=0}}Object(l.a)(jb,"WHEREConstraintData",null,[]);class ub{constructor(cb){this.Ab=cb}isMatch(cb,
Hb){if(!Object(M.a)(jb,cb))throw Error.argument("objToTest","Expected WHERE constraint data");let bc=-1,Cc=-1;const Kc=cb.jBn;switch(this.Ab.E6e){case 4:bc=Kc.zMc;Cc=Kc.Efg;break;case 5:bc=cb.uGb;Cc=Kc.zMc-cb.uGb;break;case 6:bc=Kc.zMc+Kc.Efg;Cc=cb.uGb+cb.H5e-bc;break;case 1:case 2:case 3:let kd=!1;for(let Wd=Kc.Fep;Wd;Wd=Wd.next)if(this.Ab.A1o===Wd.name){kd=!0;1===this.Ab.E6e?(bc=Wd.zMc,Cc=Wd.Efg):2===this.Ab.E6e?(bc=cb.uGb,Cc=Wd.zMc-cb.uGb):(bc=Wd.zMc+Wd.Efg,Cc=cb.uGb+cb.H5e-bc);break}if(!kd)return!1;
break;case 7:bc=cb.uGb;Cc=cb.H5e;break;default:throw Error.notImplemented();}return null!==this.Ab.zCo.Thp(Kc.Mop,bc,Cc,bc,!0,2,Hb)}}Object(l.a)(ub,"SubSreWhereConstraintFilter",null,[1374]);class ab{constructor(cb,Hb){if(cb){var bc=Hb.QD(cb.J(0));this.E6e=bc.charCodeAt(0);this.A1o=bc.substr(1);this.zCo=Hb.Pbm(cb.J(1))}}}Object(l.a)(ab,"SubSreWhereConstraintFilterInit",null,[]);class Ea{constructor(cb){this.Ab=cb}isMatch(cb,Hb,bc=null){if(!Object(M.a)(1337,cb))throw Error.argument("objToTest","Expected feature bundle");
if(null==bc)throw Error.argumentNull("parentTextForSpan");if(this.Ab.wsh&&!this.Ab.wsh.isMatch(cb,Hb))return!1;if(this.Ab.fjg){let Cc;if(({value:Cc}=cb.Iq(this.Ab.rBo)).returnValue){if(!this.Ab.fjg.isMatch(Cc,Hb))return!1}else{let Kc,kd;if(!({value:Kc}=cb.Iq(this.Ab.Duj)).returnValue||!({value:kd}=cb.Iq(this.Ab.Cuj)).returnValue||0>Kc||0>kd||Kc+kd>bc.length||!this.Ab.fjg.isMatch(bc.substr(Kc,kd),Hb))return!1}}if(this.Ab.wvj){let Cc;if(!({value:Cc}=cb.Iq(this.Ab.Duj)).returnValue||!this.Ab.wvj.isMatch(Cc,
Hb))return!1}if(this.Ab.qGi){let Cc;if(!({value:Cc}=cb.Iq(this.Ab.Cuj)).returnValue||!this.Ab.qGi.isMatch(Cc,Hb))return!1}return!0}}Object(l.a)(Ea,"TextSpanFilter",null,[1374]);class Wa{constructor(cb,Hb){cb&&(this.annotations=Hb.annotations,this.Duj=cb.J(0),this.Cuj=cb.J(1),this.rBo=cb.J(2),this.fjg=cb.J(3)?Hb.Cna(cb.J(3)):null,this.wsh=cb.J(4)?Hb.Cna(cb.J(4)):null,this.wvj=cb.J(5)?Hb.Cna(cb.J(5)):null,this.qGi=cb.J(6)?Hb.Cna(cb.J(6)):null)}}Object(l.a)(Wa,"TextSpanFilterInit",null,[]);class Bb{constructor(cb,
Hb){cb&&(this.annotations=Hb.annotations,this.Xta=cb.J(0),this.Dog=cb.J(1)?Hb.Cna(cb.J(1)):null)}}Object(l.a)(Bb,"ValueFilterAnnotationFilterInit",null,[]);var Mb=c(1522);class Fb{Cna(cb,Hb){const bc=cb.J(0),Cc=new Mb.a;Cc.ehb(cb,1,cb.count-1);switch(bc){case 1:return new aa(new fa(Cc,Hb),0);case 2:return new aa(new fa(Cc,Hb),1);case 3:return new aa(new fa(Cc,Hb),2);case 101:return new Ha(new ra(Cc,Hb));case 103:return new va(new ia(Cc,Hb),0);case 104:return new va(new ia(Cc,Hb),1);case 105:return new va(new ia(Cc,
Hb),2);case 106:return new va(new ia(Cc,Hb),3);case 107:return new va(new ia(Cc,Hb),4);case 108:return new va(new ia(Cc,Hb),5);case 109:return new va(new ia(Cc,Hb),6);case 201:return new Ga(new wa(Cc));case 202:return new Va(new ya(Cc,Hb));case 301:return new na(new oa(Cc,Hb),0);case 302:return new na(new oa(Cc,Hb),1);case 303:return new na(new oa(Cc,Hb),2);case 304:return new na(new oa(Cc,Hb),3);case 305:return new na(new oa(Cc,Hb),4);case 401:return new hb(new eb(Cc),0);case 402:return new hb(new eb(Cc),
1);case 403:return new hb(new eb(Cc),2);case 404:return new Na(new za(Cc,Hb),0);case 405:return new Na(new za(Cc,Hb),1);case 406:return new Na(new za(Cc,Hb),2);case 407:return new Na(new za(Cc,Hb),3);case 501:return new X(new W(Cc,Hb));case 502:return new pa(new ya(Cc,Hb));case 601:return new Y(new Ma(Cc,Hb),0);case 602:return new Y(new Ma(Cc,Hb),1);case 603:return new ba(new Ma(Cc,Hb));case 604:return new la(new ya(Cc,Hb),0);case 605:return new la(new ya(Cc,Hb),1);case 606:return new la(new ya(Cc,
Hb),2);case 607:return new la(new ya(Cc,Hb),3);case 701:return new U(!1);case 702:return new U(!0);case 703:return new V(new Bb(Cc,Hb),!1);case 704:return new V(new Bb(Cc,Hb),!0);case 705:return new J(new Bb(Cc,Hb),!1);case 706:return new J(new Bb(Cc,Hb),!0);case 707:return new qa(new Ia(Cc,Hb));case 901:return new Ea(new Wa(Cc,Hb));case 1002:return new sa(new ya(Cc,Hb));case 1001:return new ub(new ab(Cc,Hb));default:throw Error.argument("initData");}}}Object(l.a)(Fb,"FilterFactory",null,[1335]);
var vb=c(1501);class $a{constructor(cb){this.Ab=cb}get UD(){return this.Ab.UD}get c5(){return this.Ab.c5}get Vke(){return this.Ab.Vke}get AYd(){return this.Ab.AYd}load(cb,Hb){return this.It(cb,cb?new ja("root",cb,Hb):Hb)}store(cb,Hb,bc){this.Ikc(cb,Hb,cb?new ja("root",cb,bc):bc,null)}It(cb,Hb){if(!this.AYd&&!this.Ab.annotations.hbc(this.UD,cb))throw Error.argument("input","Input value not of expected type");let bc=this.Ab.D0h;for(;bc;)cb=bc.load(cb,Hb),bc=bc.next;return cb}Ikc(cb,Hb,bc,Cc){if(!this.Vke)throw Error.invalidOperation("Attempt to store into query that supports only loading");
if(!this.AYd&&!this.Ab.annotations.hbc(this.UD,cb))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ab.annotations.hbc(this.c5,Hb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ab.D0h.store(cb,Hb,bc,Cc)}static OFh(cb,Hb,bc,Cc){if(bc===Cc)return Hb;if(N.Annotations.fI(bc)&&N.Annotations.fI(Cc)){bc=N.Annotations.m1a(bc);Cc=N.Annotations.m1a(Cc);const Kc=new vb.a(cb,Cc);for(const kd of Hb.items)Array.add(Kc.items,$a.OFh(cb,kd,bc,Cc));return Kc}if(bc===
N.Annotations.EIa){if(Cc===N.Annotations.Yqa)return Hb;if(Cc===N.Annotations.i$)return Hb.toString()}else if(bc===N.Annotations.Yqa){if(Cc===N.Annotations.EIa)return Math.floor(Hb);if(Cc===N.Annotations.i$)return Hb.toString()}else if(bc===N.Annotations.i$){if(Cc===N.Annotations.EIa)return parseInt(Hb);if(Cc===N.Annotations.Yqa)return parseFloat(Hb)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(l.a)($a,"AnnotationQuery",null,[1378]);class kb{constructor(){this.c5=
this.UD=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}r1a(cb){if(this.next)return{returnValue:this.next,YHa:cb};if(cb){const Hb=cb.bJh;cb=cb.N3i;return{returnValue:Hb,YHa:cb}}return{returnValue:null,YHa:cb}}}Object(l.a)(kb,"AnnotationQueryStep",null,[1409]);class Ua extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){Hb=this.Ab.query.It(cb,Hb);if(N.Annotations.fI(this.UD)){var bc=N.Annotations.m1a(this.UD);let Kc=new vb.a(this.Ab.annotations,bc);if(N.Annotations.fI(this.Ab.query.c5)){if(cb.items.length!==
Hb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let kd=0,Wd=cb.items.length;kd<Wd;++kd)Array.add(Kc.items,this.DCd(cb.items[kd],Hb.items[kd],bc===N.Annotations.Yqa))}else for(var Cc of cb.items)Array.add(Kc.items,this.DCd(Cc,Hb,bc===N.Annotations.Yqa));return Kc}if(N.Annotations.fI(this.Ab.query.c5)){Cc=new vb.a(this.Ab.annotations,this.UD);for(bc of Hb.items)Array.add(Cc.items,this.DCd(cb,bc,this.UD===N.Annotations.Yqa));return Cc}return this.DCd(cb,
Hb,this.UD===N.Annotations.Yqa)}DCd(cb,Hb,bc){cb=this.r2b(cb,Hb);return bc?cb:Math.floor(cb)}}Object(l.a)(Ua,"NumericAnnotationQueryStep",kb,[]);class Sa extends Ua{constructor(cb){super(cb)}r2b(cb,Hb){return cb+Hb}}Object(l.a)(Sa,"AddAnnotationQueryStep",Ua,[]);class xb extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){if(this.UD===N.Annotations.bza&&this.Ab.query.c5===N.Annotations.bza){let Kc;if(({result:Kc}=this.mBh(cb)).returnValue)return Kc}if(N.Annotations.fI(this.UD)){var bc=new vb.a(this.Ab.annotations,
N.Annotations.bza);Hb=this.Ab.query.It(cb,Hb);if(N.Annotations.fI(this.Ab.query.c5)){if(cb.items.length!==Hb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Kc=0,kd=cb.items.length;Kc<kd;++Kc)Array.add(bc.items,this.yHc(Hb.items[Kc],cb.items[Kc]))}else for(var Cc of cb.items)Array.add(bc.items,this.yHc(Hb,Cc));return bc}Cc=this.Ab.query.It(cb,Hb);if(N.Annotations.fI(this.Ab.query.c5)){Hb=new vb.a(this.Ab.annotations,N.Annotations.bza);for(bc of Cc.items)Array.add(Hb.items,
this.yHc(bc,cb));return Hb}return this.yHc(Cc,cb)}}Object(l.a)(xb,"BinaryBooleanAnnotationQueryStep",kb,[]);class Qb extends xb{constructor(cb){super(cb)}mBh(cb){return{returnValue:!cb,result:!1}}yHc(cb,Hb){return cb&&Hb}}Object(l.a)(Qb,"AndAnnotationQueryStep",xb,[]);class Ib{constructor(cb){cb&&(this.annotations=cb)}}Object(l.a)(Ib,"AnnotationsOnlyQueryStepInit",null,[]);class $b extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){Hb=this.Ab.query.It(cb,Hb);cb=cb.clone();N.Annotations.fI(this.Ab.query.c5)?
Array.addRange(cb.items,Hb.items):Array.add(cb.items,Hb);return cb}}Object(l.a)($b,"AppendAnnotationQueryStep",kb,[]);class hc extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){if(this.UD===N.Annotations.mV)return this.DLc(cb,Hb);const bc=new vb.a(this.Ab.annotations,N.Annotations.mV);for(const Cc of cb.items)Array.add(bc.items,this.DLc(Cc,Hb));return bc}DLc(cb,Hb){const bc=new Q.a(this.Ab.annotations);bc.o_a(cb);cb=new Q.a(this.Ab.annotations);this.Ab.script.qOa(null,new ja("Input",bc,new ja("Output",
cb,Hb)));return cb}}Object(l.a)(hc,"ApplyAnnotationQueryStep",kb,[]);class pb extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){if(this.UD===N.Annotations.mV)return Hb=this.DLc(cb,Hb),Hb.Iq(this.Ab.ush).returnValue||new vb.a(this.Ab.annotations,N.Annotations.mV),Hb;const bc=new vb.a(this.Ab.annotations,N.Annotations.mV);for(const Cc of cb.items)if(cb=this.DLc(Cc,Hb),({value:cb}=cb.Iq(this.Ab.ush)).returnValue)for(const Kc of cb.items)Array.add(bc.items,Kc);return bc}DLc(cb,Hb){const bc=new Q.a(this.Ab.annotations);
bc.o_a(cb);cb=new Q.a(this.Ab.annotations);this.Ab.script.qOa(null,new ja("Input",bc,new ja("Output",cb,Hb)));return cb}}Object(l.a)(pb,"ApplyExpandAnnotationQueryStep",kb,[]);class dc{constructor(cb,Hb){cb&&(this.annotations=Hb.annotations,this.script=Hb.WDb(cb.J(0)),this.ush=cb.J(1))}}Object(l.a)(dc,"ApplyExpandQueryStepInit",null,[]);class Ob{constructor(cb,Hb){cb&&(this.annotations=Hb.annotations,this.script=Hb.WDb(cb.J(0)))}}Object(l.a)(Ob,"ApplyQueryStepInit",null,[]);class Vb extends kb{constructor(cb){super();
this.Ab=cb}load(cb){if(this.UD===N.Annotations.mV)return this.I2d(cb);const Hb=new vb.a(this.Ab.annotations,this.Ab.annotations.getAttributeType(this.Ab.Xta));for(const bc of cb.items)Array.add(Hb.items,this.I2d(bc));return Hb}store(cb,Hb,bc,Cc){if(this.UD===N.Annotations.mV){var Kc=Hb,kd=({YHa:Cc}=this.r1a(Cc)).returnValue;kd&&(Kc=kd.store(N.Annotations.kT(this.I2d(cb)),Hb,bc,Cc));cb.Iy(this.Ab.Xta,Kc)}else{var Wd=Hb;if(Kc=({YHa:Cc}=this.r1a(Cc)).returnValue){Wd=new vb.a(this.Ab.annotations,this.Ab.annotations.getAttributeType(this.Ab.Xta));
for(kd of cb.items)Array.add(Wd.items,this.I2d(kd));Wd=Kc.store(Wd,Hb,bc,Cc)}Hb=Wd;if(Hb.items.length!==cb.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let ve=0,Ie=cb.items.length;ve<Ie;++ve)bc=cb.items[ve],bc.isReadOnly&&(bc=bc.clone(),cb.items[ve]=bc),bc.Iy(this.Ab.Xta,Hb.items[ve])}return cb}I2d(cb){({value:cb}=cb.Iq(this.Ab.Xta)).returnValue||(cb=this.Ab.annotations.aOl(this.Ab.Xta));return cb}}Object(l.a)(Vb,"AttrAnnotationQueryStep",kb,
[]);class ob{constructor(cb,Hb){cb&&(this.annotations=Hb,this.Xta=cb.J(0))}}Object(l.a)(ob,"AttrQueryStepInit",null,[]);class Xb extends kb{constructor(cb){super();this.Ab=cb}load(cb){const Hb=new Q.a(this.Ab.annotations);Hb.o_a(cb);return this.Ab.module.execute(Hb)}}Object(l.a)(Xb,"CallModuleAnnotationQueryStep",kb,[]);class Xa{constructor(cb,Hb){cb&&(this.annotations=Hb.annotations,this.module=Hb.esf(cb.J(0)))}}Object(l.a)(Xa,"CallModuleQueryStepInit",null,[]);class Pb extends kb{constructor(cb){super();
this.Ab=cb}load(cb,Hb){if(N.Annotations.fI(this.UD)){var bc=this.Ab.query.It(cb,Hb);Hb=new vb.a(this.Ab.annotations,N.Annotations.i$);let kd="string"===typeof bc;for(var Cc of cb.items)if(kd)Array.add(Hb.items,Cc+bc);else for(var Kc of bc.items)Array.add(Hb.items,Cc+Kc);return Hb}Cc=this.Ab.query.It(cb,Hb);if("string"===typeof Cc)return cb+Cc;Kc=new vb.a(this.Ab.annotations,N.Annotations.i$);for(bc of Cc.items)Array.add(Kc.items,cb+bc);return Kc}}Object(l.a)(Pb,"ConcatAnnotationQueryStep",kb,[]);
class rc extends kb{constructor(cb){super();this.Ab=cb}load(cb){return $a.OFh(this.Ab.annotations,cb,this.UD,this.c5)}}Object(l.a)(rc,"ConvertAnnotationQueryStep",kb,[]);class Ta extends kb{constructor(){super()}load(cb){return cb.items.length}}Object(l.a)(Ta,"CountAnnotationQueryStep",kb,[]);class Ab extends Ua{constructor(cb){super(cb)}r2b(cb,Hb){return cb/Hb}}Object(l.a)(Ab,"DivideAnnotationQueryStep",Ua,[]);class Db extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){Hb=new ja(this.Ab.cpe,
null,Hb);for(const bc of cb.items)if(Hb.W6e(bc),this.Ab.query.It(bc,Hb))return!0;return!1}}Object(l.a)(Db,"ExistsAnnotationQueryStep",kb,[]);class ac extends Ua{constructor(cb){super(cb)}r2b(cb,Hb){return Math.pow(cb,Hb)}}Object(l.a)(ac,"ExpAnnotationQueryStep",Ua,[]);class Pa{constructor(cb,Hb){cb&&(this.yOa=Hb.QD(cb.J(0)))}}Object(l.a)(Pa,"FeatureBundleNameQueryStepInit",null,[]);class bb extends kb{constructor(cb){super();this.Ab=cb}load(cb){if(N.Annotations.fI(this.UD)){const Hb=new vb.a(this.Ab.annotations,
this.Ab.annotations.vFb(N.Annotations.m1a(this.UD),this.Ab.AOa));for(const bc of cb.items)Array.add(Hb.items,bc.Hhb(this.Ab.AOa));return Hb}return cb.Hhb(this.Ab.AOa)}store(cb,Hb,bc,Cc){if(N.Annotations.fI(this.UD)){var Kc=Hb,kd=({YHa:Cc}=this.r1a(Cc)).returnValue;if(kd){Kc=new vb.a(this.Ab.annotations,this.Ab.annotations.vFb(N.Annotations.m1a(this.UD),this.Ab.AOa));for(var Wd of cb.items)Array.add(Kc.items,Wd.Hhb(this.Ab.AOa));Kc=kd.store(Kc,Hb,bc,Cc)}Hb=Kc;if(Hb.items.length!==cb.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let ve=0,Ie=cb.items.length;ve<Ie;++ve)bc=cb.items[ve],bc.isReadOnly&&(bc=bc.clone(),cb.items[ve]=bc),bc.Mag(this.Ab.AOa,Hb.items[ve])}else kd=Hb,(Wd=({YHa:Cc}=this.r1a(Cc)).returnValue)&&(kd=Wd.store(N.Annotations.kT(cb.Hhb(this.Ab.AOa)),Hb,bc,Cc)),cb.Mag(this.Ab.AOa,kd);return cb}}Object(l.a)(bb,"FieldAnnotationQueryStep",kb,[]);class lc{constructor(cb,Hb){cb&&(this.annotations=Hb,this.AOa=cb.J(0))}}Object(l.a)(lc,"FieldQueryStepInit",null,[]);class rb extends kb{constructor(cb){super();this.Ab=
cb}load(cb,Hb){for(const bc of cb.items)if(this.Ab.filter.isMatch(bc,Hb))return bc;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(cb,Hb,bc,Cc){let Kc=Hb,kd=-1;for(let ve=0,Ie=cb.items.length;ve<Ie;ve++)if(this.Ab.filter.isMatch(cb.items[ve],bc)){kd=ve;break}if(0>kd)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const Wd=({YHa:Cc}=this.r1a(Cc)).returnValue;Wd&&(Kc=Wd.store(N.Annotations.kT(cb.items[kd]),Hb,bc,Cc));
cb.items[kd]=Kc;return cb}}Object(l.a)(rb,"FirstItemMatchingAnnotationQueryStep",kb,[]);class La extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){Hb=new ja(this.Ab.cpe,null,Hb);for(const bc of cb.items)if(Hb.W6e(bc),!this.Ab.query.It(bc,Hb))return!1;return!0}}Object(l.a)(La,"ForAllAnnotationQueryStep",kb,[]);class sb extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){cb=Hb?Hb.APd(this.Ab.yOa):null;if(!cb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ab.yOa+
'"');return cb}store(cb,Hb,bc,Cc){cb=bc?bc.APd(this.Ab.yOa):null;if(!cb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ab.yOa+'"');let Kc=Hb;const kd=({YHa:Cc}=this.r1a(Cc)).returnValue;kd&&(Kc=kd.store(cb,Hb,bc,Cc));cb!==Kc&&cb.o_a(Kc);return cb}}Object(l.a)(sb,"GetAnnotationQueryStep",kb,[]);class Sb{constructor(cb,Hb){this.m0j=cb;this.ogk=Hb}get bJh(){return this.m0j}get N3i(){return this.ogk}}Object(l.a)(Sb,"AnnotationQueryStoreContinuation",null,[1424]);class kc extends kb{constructor(cb){super();
this.Ab=cb}load(cb,Hb){return this.Ab.Ple.It(cb,Hb)?this.Ab.rCj.It(cb,Hb):this.Ab.MLd?this.Ab.MLd.It(cb,Hb):cb}store(cb,Hb,bc,Cc){var Kc=this.Ab.Ple.It(cb,bc);this.next&&(Cc=new Sb(this.next,Cc));if(Kc)return this.Ab.rCj.Ikc(cb,Hb,bc,Cc);if(this.Ab.MLd)return this.Ab.MLd.Ikc(cb,Hb,bc,Cc);Kc=Hb;let kd=null;Cc&&(kd=Cc.bJh,Cc=Cc.N3i);kd&&(Kc=kd.store(N.Annotations.kT(cb),Hb,bc,Cc));return Kc}}Object(l.a)(kc,"IfAnnotationQueryStep",kb,[]);class Lb{constructor(cb,Hb){cb&&(this.Ple=Hb.VK(cb.J(0)),this.rCj=
Hb.VK(cb.J(1)),this.MLd=cb.J(2)?Hb.VK(cb.J(2)):null)}}Object(l.a)(Lb,"IfQueryStepInit",null,[]);class Qc{constructor(cb,Hb){cb&&(this.Fxm=Hb.VK(cb.J(0)),this.wEi=Hb.VK(cb.J(1)))}}Object(l.a)(Qc,"IndexAndItemQueryStepInit",null,[]);class Dc extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){const bc=this.Ab.Fxm.It(cb,Hb);Hb=this.Ab.wEi.It(cb,Hb);cb=cb.clone();if(0>bc||bc>cb.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(N.Annotations.fI(this.Ab.wEi.c5))for(let Cc=
0;Cc<Hb.items.length;++Cc)Array.insert(cb.items,bc+Cc,Hb.items[Cc]);else Array.insert(cb.items,bc,Hb);return cb}}Object(l.a)(Dc,"InsertAtAnnotationQueryStep",kb,[]);class Fd extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){return!(!Hb||!Hb.APd(this.Ab.yOa))}}Object(l.a)(Fd,"IsDefinedAnnotationQueryStep",kb,[]);class pe extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){Hb=this.lJ(cb,Hb);return cb.items[Hb]}store(cb,Hb,bc,Cc){const Kc=this.lJ(cb,bc);let kd=Hb;const Wd=({YHa:Cc}=this.r1a(Cc)).returnValue;
Wd&&(kd=Wd.store(N.Annotations.kT(cb.items[Kc]),Hb,bc,Cc));cb.items[Kc]=kd;return cb}lJ(cb,Hb){Hb=this.Ab.query.It(cb,Hb);if(0>Hb||Hb>=cb.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Hb}}Object(l.a)(pe,"ItemAnnotationQueryStep",kb,[]);class ye extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){const bc=new vb.a(this.Ab.annotations,N.Annotations.m1a(this.UD));for(const Cc of cb.items)this.Ab.filter.isMatch(Cc,Hb)&&Array.add(bc.items,Cc);return bc}}
Object(l.a)(ye,"ItemsMatchingAnnotationQueryStep",kb,[]);class pf extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){Hb=this.lJ(cb,Hb);return cb.items[cb.items.length-Hb-1]}store(cb,Hb,bc,Cc){const Kc=this.lJ(cb,bc);let kd=Hb;const Wd=({YHa:Cc}=this.r1a(Cc)).returnValue;Wd&&(kd=Wd.store(N.Annotations.kT(cb.items[cb.items.length-Kc-1]),Hb,bc,Cc));cb.items[cb.items.length-Kc-1]=kd;return cb}lJ(cb,Hb){Hb=this.Ab.query?this.Ab.query.It(cb,Hb):0;if(0>Hb||Hb>=cb.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Hb}}Object(l.a)(pf,"LastItemAnnotationQueryStep",kb,[]);class Yf extends kb{constructor(cb){super();this.Ab=cb}load(cb){if(N.Annotations.fI(this.UD)){const Hb=new vb.a(this.Ab.annotations,N.Annotations.EIa);for(const bc of cb.items)Array.add(Hb.items,bc.length);return Hb}return cb.length}}Object(l.a)(Yf,"LengthAnnotationQueryStep",kb,[]);class Ed extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){if(N.Annotations.fI(this.UD)){const bc=new vb.a(this.Ab.annotations,N.Annotations.bza);
for(const Cc of cb.items)Array.add(bc.items,this.Ab.filter.isMatch(Cc,Hb));return bc}return this.Ab.filter.isMatch(cb,Hb)}}Object(l.a)(Ed,"MatchesAnnotationQueryStep",kb,[]);class Rc extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){return this.Ab.filter.isMatch(cb,Hb)}}Object(l.a)(Rc,"MatchesAsListAnnotationQueryStep",kb,[]);class Yc extends Ua{constructor(cb){super(cb)}r2b(cb,Hb){return cb%Hb}}Object(l.a)(Yc,"ModuloAnnotationQueryStep",Ua,[]);class Mc extends Ua{constructor(cb){super(cb)}r2b(cb,
Hb){return cb*Hb}}Object(l.a)(Mc,"MultiplyAnnotationQueryStep",Ua,[]);class ge extends kb{constructor(cb){super();this.Ab=cb}load(cb){if(N.Annotations.fI(this.UD)){const Hb=new vb.a(this.Ab.annotations,N.Annotations.bza);for(const bc of cb.items)Array.add(Hb.items,!bc);return Hb}return!cb}}Object(l.a)(ge,"NotAnnotationQueryStep",kb,[]);class Ne extends xb{constructor(cb){super(cb)}mBh(cb){return{returnValue:cb,result:!0}}yHc(cb,Hb){return cb||Hb}}Object(l.a)(Ne,"OrAnnotationQueryStep",xb,[]);class Ee extends kb{constructor(cb){super();
this.Ab=cb}load(cb,Hb){const bc=this.Ab.wgg.It(cb,Hb);cb=this.Ab.kIc.It(cb,Hb);Hb=new vb.a(this.Ab.annotations,N.Annotations.EIa);for(let Cc=0;Cc<cb;++Cc)Array.add(Hb.items,bc+Cc);return Hb}}Object(l.a)(Ee,"RangeAnnotationQueryStep",kb,[]);class Ve{constructor(cb,Hb){cb&&(this.annotations=Hb.annotations,this.filter=Hb.Cna(cb.J(0)))}}Object(l.a)(Ve,"SingleFilterQueryStepInit",null,[]);class mc{constructor(cb,Hb){cb&&(this.annotations=Hb.annotations,this.query=cb.J(0)?Hb.VK(cb.J(0)):null)}}Object(l.a)(mc,
"SingleOptionalQueryQueryStepInit",null,[]);class Oc{constructor(cb,Hb){cb&&(this.annotations=Hb.annotations,this.query=Hb.VK(cb.J(0)))}}Object(l.a)(Oc,"SingleQueryQueryStepInit",null,[]);class xd{constructor(cb,Hb){cb&&(this.annotations=Hb.annotations,this.wgg=Hb.VK(cb.J(0)),this.kIc=cb.J(1)?Hb.VK(cb.J(1)):null)}}Object(l.a)(xd,"StartAndCountOrLengthQueryStepInit",null,[]);class Dd extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){let bc;({startIndex:Hb,length:bc}=this.vSd(cb,Hb));const Cc=
new vb.a(this.Ab.annotations,cb.y4);for(let Kc=0;Kc<bc;++Kc)Array.add(Cc.items,cb.items[Hb+Kc]);return Cc}store(cb,Hb,bc,Cc){let Kc,kd;({startIndex:Kc,length:kd}=this.vSd(cb,bc));var Wd=Hb;const ve=({YHa:Cc}=this.r1a(Cc)).returnValue;if(ve){Wd=new vb.a(this.Ab.annotations,cb.y4);for(let Ie=0;Ie<kd;++Ie)Array.add(Wd.items,cb.items[Kc+Ie]);Wd=ve.store(Wd,Hb,bc,Cc)}Hb=Wd;for(bc=0;bc<kd;++bc)Array.removeAt(cb.items,Kc);for(let Ie=0,yf=Hb.items.length;Ie<yf;++Ie)Array.insert(cb.items,Kc+Ie,Hb.items[Ie]);
return cb}vSd(cb,Hb){let bc;bc=this.Ab.wgg.It(cb,Hb);if(0>bc)throw Error.invalidOperation("Invalid start index in Sublist() query step");Hb=this.Ab.kIc?this.Ab.kIc.It(cb,Hb):cb.items.length-bc;if(0>Hb||bc+Hb>cb.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:bc,length:Hb}}}Object(l.a)(Dd,"SublistAnnotationQueryStep",kb,[]);class ud extends kb{constructor(cb){super();this.Ab=cb}load(cb,Hb){if(N.Annotations.fI(this.UD)){const bc=
new vb.a(this.Ab.annotations,N.Annotations.i$);for(let Cc=0,Kc=cb.items.length;Cc<Kc;++Cc)Array.add(bc.items,this.Ehi(cb.items[Cc],Hb));return bc}return this.Ehi(cb,Hb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}Ehi(cb,Hb){let bc;({startIndex:Hb,length:bc}=this.vSd(cb,Hb));return cb.substr(Hb,bc)}vSd(cb,Hb){let bc;bc=this.Ab.wgg.It(cb,Hb);if(0>bc)throw Error.invalidOperation("Invalid start index in Substring() query step");Hb=this.Ab.kIc?this.Ab.kIc.It(cb,
Hb):cb.length-bc;if(0>Hb||bc+Hb>cb.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:bc,length:Hb}}}Object(l.a)(ud,"SubstringAnnotationQueryStep",kb,[]);class He extends Ua{constructor(cb){super(cb)}r2b(cb,Hb){return cb-Hb}}Object(l.a)(He,"SubtractAnnotationQueryStep",Ua,[]);class uf extends kb{constructor(cb){super();this.Ab=cb}load(cb){const Hb=new vb.a(this.Ab.annotations,N.Annotations.i$);for(let bc=0;bc<cb.length;++bc)Array.add(Hb.items,
cb.charAt(bc).toString());return Hb}}Object(l.a)(uf,"ToCharListAnnotationQueryStep",kb,[]);class Lh extends kb{constructor(cb){super();this.Ab=cb}load(cb){const Hb=new vb.a(this.Ab.annotations,this.UD);Array.add(Hb.items,cb);return Hb}}Object(l.a)(Lh,"ToListAnnotationQueryStep",kb,[]);class Sf extends kb{constructor(cb){super();this.Ab=cb}load(){return this.Ab.value}}Object(l.a)(Sf,"ValueAnnotationQueryStep",kb,[]);class fc{constructor(cb,Hb){if(cb){var bc=cb.J(0),Cc=1;this.value=({eha:Cc}=Hb.ZNa(bc,
cb,Cc,null,null,null)).returnValue;N.Annotations.pJb(this.value)}}}Object(l.a)(fc,"ValueQueryStepInit",null,[]);class yc{constructor(cb,Hb){cb&&(this.cpe=Hb.QD(cb.J(0)),this.query=Hb.VK(cb.J(1)))}}Object(l.a)(yc,"VarNameAndQueryQueryStepInit",null,[]);class Uc{constructor(cb,Hb){this.PVg=null;if(cb){this.annotations=Hb.annotations;var bc=0;this.UD=cb.J(bc);++bc;this.c5=cb.J(bc);++bc;this.Vke=1===cb.J(bc);++bc;this.AYd=1===cb.J(bc);++bc;var Cc=cb.J(bc);++bc;if(Cc){var Kc=bc,kd=bc+Cc,Wd=bc+2*Cc;bc+=
3*Cc;var ve=cb.count-bc,Ie=null;for(let gc=0;gc<Cc;++gc){var yf=bc+cb.J(Wd+gc);const ff=(gc===Cc-1?ve:cb.J(Wd+gc+1))-cb.J(Wd+gc),Gk=new Mb.a;Gk.ehb(cb,yf,ff);yf=Uc.i5l(cb.J(kd+gc),Gk,Hb);yf.UD=cb.J(Kc+gc);yf.c5=gc===Cc-1?this.c5:cb.J(Kc+gc+1);Ie?Ie.next=yf:this.PVg=yf;Ie=yf}}}}get D0h(){return this.PVg}static i5l(cb,Hb,bc){switch(cb){case 1:return new sb(new Pa(Hb,bc));case 2:return new Fd(new Pa(Hb,bc));case 3:return new Vb(new ob(Hb,bc.annotations));case 4:return new bb(new lc(Hb,bc.annotations));
case 5:return new kc(new Lb(Hb,bc));case 6:return new Ed(new Ve(Hb,bc));case 43:return new Rc(new Ve(Hb,bc));case 45:return new hc(new Ob(Hb,bc));case 49:return new pb(new dc(Hb,bc));case 46:return new Sf(new fc(Hb,bc.annotations));case 51:return new Xb(new Xa(Hb,bc));case 52:return new Ee(new xd(Hb,bc));case 53:return new rc(new Ib(bc.annotations));case 13:return new pe(new Oc(Hb,bc));case 14:return new pf(new mc(Hb,bc));case 15:return new Ta;case 18:return new rb(new Ve(Hb,bc));case 16:return new La(new yc(Hb,
bc));case 17:return new Db(new yc(Hb,bc));case 22:return new Dc(new Qc(Hb,bc));case 24:return new $b(new Oc(Hb,bc));case 26:return new Dd(new xd(Hb,bc));case 27:return new ye(new Ve(Hb,bc));case 30:return new Lh(new Ib(bc.annotations));case 31:return new ud(new xd(Hb,bc));case 32:return new Pb(new Oc(Hb,bc));case 47:return new Yf(new Ib(bc.annotations));case 48:return new uf(new Ib(bc.annotations));case 34:return new Sa(new Oc(Hb,bc));case 35:return new He(new Oc(Hb,bc));case 36:return new Mc(new Oc(Hb,
bc));case 37:return new Ab(new Oc(Hb,bc));case 38:return new Yc(new Oc(Hb,bc));case 39:return new ac(new Oc(Hb,bc));case 40:return new Qb(new Oc(Hb,bc));case 41:return new Ne(new Oc(Hb,bc));case 42:return new ge(new Ib(bc.annotations));default:throw Error.argument("currStepInitData");}}}Object(l.a)(Uc,"AnnotationQueryInit",null,[]);class zd{constructor(cb){this.Ab=cb}execute(cb,Hb){this.qOa(cb,cb?new ja("root",cb,Hb):Hb)}qOa(cb,Hb){for(const bc of this.Ab.commands)Hb=bc.execute(cb,Hb)}}Object(l.a)(zd,
"AnnotationScript",null,[1377]);class ie{constructor(cb){this.Ab=cb}execute(cb,Hb){const bc=this.Ab.JBm.It(cb,Hb),Cc=this.Ab.fzn.It(cb,Hb);this.Ab.script.qOa(cb,new ja("Input",bc,new ja("Output",Cc,Hb)));return Hb}}Object(l.a)(ie,"ApplyAnnotationScriptCommand",null,[1407]);class Oe{constructor(cb,Hb){cb&&(this.JBm=Hb.VK(cb.J(0)),this.fzn=Hb.VK(cb.J(1)),this.script=Hb.WDb(cb.J(2)))}}Object(l.a)(Oe,"ApplyScriptCommandInit",null,[]);class Ge{constructor(cb){this.Ab=cb}execute(cb,Hb){const bc=this.Ab.e9f.It(cb,
Hb);this.Ab.C3d.Ikc(cb,bc,Hb,null);return Hb}}Object(l.a)(Ge,"AssignAnnotationScriptCommand",null,[1407]);class re{constructor(cb){this.Ab=cb}execute(cb,Hb){const bc=this.Ab.C3d.It(cb,Hb);cb=this.Ab.e9f.It(cb,Hb);bc!==cb&&bc.o_a(cb);return Hb}}Object(l.a)(re,"CopyAnnotationScriptCommand",null,[1407]);class mf{constructor(cb){this.Ab=cb}execute(cb,Hb){let bc=this.Ab.VJf.It(cb,Hb);if(this.Ab.VJf.Vke){bc=N.Annotations.kT(bc);var Cc=new ja(this.Ab.yOa,null,Hb);for(let kd=0,Wd=bc.items.length;kd<Wd;++kd){var Kc=
this.iYh(cb,bc.items[kd],Cc);if(0>this.Ab.Hee)bc.items[kd]=Kc;else if(({value:Kc}=Kc.Iq(this.Ab.Hee)).returnValue)bc.items[kd]=Kc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Ab.VJf.Ikc(cb,bc,Hb,null)}else{Cc=new ja(this.Ab.yOa,null,Hb);for(let kd=0,Wd=bc.items.length;kd<Wd;++kd)this.iYh(cb,bc.items[kd],Cc)}return Hb}iYh(cb,Hb,bc){let Cc;0>this.Ab.Hee?Cc=N.Annotations.kT(Hb):(Cc=new Q.a(this.Ab.annotations),Cc.Iy(this.Ab.Hee,Hb));bc.W6e(Cc);
this.Ab.JLk.qOa(cb,bc);return Cc}}Object(l.a)(mf,"EnumerateAnnotationScriptCommand",null,[1407]);class Xe{constructor(cb,Hb){cb&&(this.annotations=Hb.annotations,this.yOa=Hb.QD(cb.J(0)),this.VJf=Hb.VK(cb.J(1)),this.JLk=Hb.WDb(cb.J(2)),this.Hee=cb.J(3))}}Object(l.a)(Xe,"EnumerateScriptCommandInit",null,[]);class qf{constructor(cb){this.Ab=cb}execute(cb,Hb){this.Ab.Ple.It(cb,Hb)?this.Ab.XOo.qOa(cb,Hb):this.Ab.lZh&&this.Ab.lZh.qOa(cb,Hb);return Hb}}Object(l.a)(qf,"IfAnnotationScriptCommand",null,[1407]);
class kf{constructor(cb,Hb){cb&&(this.Ple=Hb.VK(cb.J(0)),this.XOo=Hb.WDb(cb.J(1)),this.lZh=cb.J(2)?Hb.WDb(cb.J(2)):null)}}Object(l.a)(kf,"IfScriptCommandInit",null,[]);class $f{constructor(cb,Hb){cb&&(this.annotations=Hb.annotations,this.C3d=Hb.VK(cb.J(0)),this.e9f=Hb.VK(cb.J(1)))}}Object(l.a)($f,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class xf{constructor(cb){this.Ab=cb}execute(cb,Hb){const bc=this.Ab.e9f.It(this.Ab.C3d.It(cb,Hb),Hb);this.Ab.C3d.Ikc(cb,bc,Hb,null);return Hb}}Object(l.a)(xf,
"ModifyAnnotationScriptCommand",null,[1407]);class Qg{constructor(cb){this.Ab=cb}execute(cb,Hb){const bc=new Q.a(this.Ab.annotations);this.Ab.query&&bc.o_a(this.Ab.query.It(cb,Hb));return Hb=new ja(this.Ab.yOa,bc,Hb)}}Object(l.a)(Qg,"NewAnnotationScriptCommand",null,[1407]);class zb{constructor(cb,Hb){cb&&(this.annotations=Hb.annotations,this.yOa=Hb.QD(cb.J(0)),this.query=cb.J(1)?Hb.VK(cb.J(1)):null)}}Object(l.a)(zb,"NewScriptCommandInit",null,[]);class Yb{constructor(cb){this.Ab=cb}execute(cb,Hb){cb=
this.Ab.query.It(cb,Hb);if(this.Ab.query.c5===N.Annotations.mV)cb.xSa(this.Ab.Xta);else for(const bc of cb.items)bc.xSa(this.Ab.Xta);return Hb}}Object(l.a)(Yb,"RemoveAnnotationScriptCommand",null,[1407]);class Tc{constructor(cb,Hb){cb&&(this.annotations=Hb.annotations,this.query=Hb.VK(cb.J(0)),this.Xta=cb.J(1))}}Object(l.a)(Tc,"RemoveScriptCommandInit",null,[]);class Id{constructor(cb,Hb){if(cb){var bc=0,Cc=cb.J(bc);++bc;if(Cc){var Kc=bc,kd=bc+Cc;bc+=2*Cc;var Wd=cb.count-bc;this.commands=Array(Cc);
for(let ve=0;ve<Cc;++ve){const Ie=bc+cb.J(kd+ve),yf=(ve===Cc-1?Wd:cb.J(kd+ve+1))-cb.J(kd+ve),gc=new Mb.a;gc.ehb(cb,Ie,yf);this.commands[ve]=Id.Z4l(cb.J(Kc+ve),gc,Hb)}}}}static Z4l(cb,Hb,bc){switch(cb){case 1:return new Ge(new $f(Hb,bc));case 2:return new xf(new $f(Hb,bc));case 3:return new Yb(new Tc(Hb,bc));case 6:return new Qg(new zb(Hb,bc));case 7:return new mf(new Xe(Hb,bc));case 8:return new qf(new kf(Hb,bc));case 9:return new re(new $f(Hb,bc));case 10:return new ie(new Oe(Hb,bc));default:throw Error.argument("initData");
}}}Object(l.a)(Id,"AnnotationScriptInit",null,[]);var Xc=c(1652);class Le{constructor(cb){this.M1=cb;this.Zx=0}F9(){const cb=this.M1.Gy(this.Zx,4);this.Zx+=4;return cb}get Afa(){return this.M1}get offset(){return this.Zx}set offset(cb){this.Zx=cb}}Object(l.a)(Le,"ByteArrayReader",null,[]);class cf{constructor(){this.FJ=null;this.qMi=this.Aca=0}J(cb){if(0>cb||cb>=this.Aca)throw Error.argumentOutOfRange("index");return this.FJ.Gy(this.qMi+4*cb,4)}get count(){return this.Aca}static Lal(cb,Hb,bc){const Cc=
new cf;Cc.FJ=cb;Cc.qMi=Hb;Cc.Aca=bc;return Cc}}Object(l.a)(cf,"ReadOnlyListOverByteArray",null,[1367]);class Ig{constructor(cb,Hb){this.jMi=this.iMi=!1;this.ww=this.dRa=this.HLf=this.mMi=null;try{this.ww=Hb.annotations;const bc=Hb.shb(cb.J(0)),Cc=new Le(bc);if(-914743053!==Cc.F9())throw Error.argument("Input does not represent a flat lexicon");this.iMi=1===Cc.F9();this.jMi=1===Cc.F9();const Kc=Cc.F9();Cc.offset+=Kc;const kd=Cc.F9();this.HLf=Ig.oBn(Cc,kd,this.ww);const Wd=Cc.F9();this.mMi=Ig.EBn(Cc,
Wd);const ve=Cc.F9();this.dRa=new Xc.a(Cc.Afa,Cc.offset);Cc.offset+=ve}catch(bc){throw Error.argument("initData");}}get trie(){return this.dRa}WPl(cb){return"i"===cb&&this.jMi?"\u0130":cb.toUpperCase()}fCf(){return this.iMi}oNl(cb){let Hb;Hb=new vb.a(this.ww,N.Annotations.mV);if(1!==cb)if(0===cb)cb=new Q.a(this.ww),Array.add(Hb.items,cb);else if(cb&1073741824){cb=this.mMi[cb&-1073741825];for(let Cc=0;Cc<cb.length;++Cc){var bc=cb[Cc];bc=0===bc?new Q.a(this.ww):this.HLf[bc-2];Array.add(Hb.items,bc)}}else Array.add(Hb.items,
this.HLf[cb-2]);return{returnValue:!0,p_m:Hb}}static oBn(cb,Hb,bc){if(Hb%4)throw Error.argument("reader");const Cc=cf.Lal(cb.Afa,cb.offset,Hb/4);cb.offset+=Hb;cb=[];for(Hb=0;Hb<Cc.count;){const Kc=({eha:Hb}=bc.ZNa(N.Annotations.mV,Cc,Hb,null,null,null)).returnValue;Array.add(cb,Kc)}return cb}static EBn(cb,Hb){Hb=cb.offset+Hb;const bc=[];for(;cb.offset<Hb;){const Cc=cb.F9(),Kc=Array(Cc);for(let kd=0;kd<Cc;++kd){const Wd=cb.F9();Kc[kd]=Wd}Array.add(bc,Kc)}return bc}}Object(l.a)(Ig,"RawFlatLexicon",
null,[1376]);var Ji=c(1640),Th=c(1641);class Ah{constructor(cb){if(null==cb)throw Error.argumentNull("base64String");const Hb=cb.length;if(Hb%4)throw Error.argument("base64String's length must be a multiple of 4");this.Aca=.75*Hb;this.zJb=Array(Math.ceil(this.Aca/4));cb.endsWith("==")?this.Aca-=2:cb.endsWith("=")&&--this.Aca;let bc=0;for(let Cc=0;Cc<Hb;Cc+=4){const Kc=Ah.wfe[cb.charCodeAt(Cc)-43]<<18|Ah.wfe[cb.charCodeAt(Cc+1)-43]<<12|Ah.wfe[cb.charCodeAt(Cc+2)-43]<<6|Ah.wfe[cb.charCodeAt(Cc+3)-43];
let kd=Kc>>16&255;this.zJb[Math.floor(bc/4)]|=kd<<bc%4*8;++bc;kd=Kc>>8&255;this.zJb[Math.floor(bc/4)]|=kd<<bc%4*8;++bc;kd=Kc&255;this.zJb[Math.floor(bc/4)]|=kd<<bc%4*8;++bc}}get length(){return this.Aca}J(cb){if(0>cb||cb>=this.Aca)throw Error.argumentOutOfRange("i");return this.C5h(cb)}Gy(cb,Hb){if(0>cb||0>Hb||cb+Hb>this.Aca)throw Error.argument("Bad range");let bc=0;for(let Cc=0;Cc<Hb;++Cc)bc|=this.C5h(cb+Cc)<<8*Cc;return bc}WQn(cb,Hb){let bc=0,Cc=0,Kc=Math.floor(cb/8);for(cb%=8;Cc<Hb;){const kd=
8-cb>Hb-Cc?Hb-Cc:8-cb,Wd=this.J(Kc);bc|=(Wd>>cb&~(255<<kd))<<Cc;Cc+=kd;++Kc;cb=0}return bc}C5h(cb){return this.zJb[Math.floor(cb/4)]>>cb%4*8&255}}Ah.wfe=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(l.a)(Ah,"ByteArray",null,[]);class Pm{constructor(cb,Hb,bc){this.YD=cb;this.a$m=Hb;this.d$m=bc;this.yMi=Array(cb.b?cb.b.length:
0);this.eMf=new Ji.a(new Th.a(this.shb(this.YD.s)));this.e9=Array(cb.t.length);this.mD=new N.Annotations(this.qhb(0),this)}get annotations(){return this.mD}get qsl(){return this.YD.d}t4l(){if(!(""in this.YD.m))throw Error.argument("name","Unrecognized module");return this.esf(this.YD.m[""])}shb(cb){if(0>cb||!this.YD.b||cb>=this.YD.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.yMi[cb]||(this.yMi[cb]=new Ah(this.YD.b[cb]))}QD(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not a string");if(null==this.e9[cb]){const Hb=this.qhb(cb).J(0);this.e9[cb]=this.eMf.QD(Hb)}return this.e9[cb]}L8b(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.e9[cb]){var Hb=this.qhb(cb);const bc=this.QD(Hb.J(0));Hb=1===Hb.J(1);this.e9[cb]=new RegExp(bc,Hb?"i":"")}return this.e9[cb]}Pbm(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");
if(3!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}esf(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not an NL module");return this.e9[cb]||(this.e9[cb]=this.d$m.O4l(this.qhb(cb),this))}VK(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not an annotation query");
return this.e9[cb]||(this.e9[cb]=new $a(new Uc(this.qhb(cb),this)))}WDb(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not an annotation script");return this.e9[cb]||(this.e9[cb]=new zd(new Id(this.qhb(cb),this)))}Cna(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not a filter");return this.e9[cb]||(this.e9[cb]=
this.a$m.Cna(this.qhb(cb),this))}Z$l(cb){if(1>cb||cb>=this.YD.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.YD.t[cb])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.e9[cb]||(this.e9[cb]=new Ig(this.qhb(cb),this))}qhb(cb){const Hb=this.YD.n[cb];cb=(cb<this.YD.t.length-1?this.YD.n[cb+1]:this.YD.n.length)-Hb;if(0>Hb||0>cb||Hb+cb>this.YD.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Hb+","+cb+")");const bc=new Mb.a;
bc.ymf(this.YD.n,Hb,cb);return bc}}Object(l.a)(Pm,"ObjectFetcher",null,[1334]);class zf{constructor(cb,Hb,bc){if(!cb)throw Error.argumentNull("prediction");if(!Hb)throw Error.argumentNull("fieldNames");if(!bc)throw Error.argumentNull("values");if(Hb.length!==bc.length)throw Error.argument("values","fieldNames and values do not have same length");this.dgk=cb;this.AJb=Hb;this.OYc=bc}get prediction(){return this.dgk}get KZh(){return this.AJb.length}hqf(cb){return 0<=cb&&cb<this.AJb.length?this.AJb[cb]:
null}getValue(cb){return 0<=cb&&cb<this.OYc.length?this.OYc[cb]:null}}Object(l.a)(zf,"PredictionData",null,[]);class lg{constructor(cb,Hb){if(!cb)throw Error.argumentNull("predictions");if(!Hb)throw Error.argumentNull("tokenAttributes");this.g$m=cb;this.k$m=Hb}ltf(){return this.g$m}u4h(){return this.k$m}}Object(l.a)(lg,"PredictionDataWithTokenAttributes",null,[]);class md{constructor(cb,Hb){this.prediction=null;this.score=0;this.prediction=cb;this.score=Hb}}Object(l.a)(md,"PredictionWithScore",null,
[]);class td{constructor(cb,Hb){if(!cb)throw Error.argumentNull("predictions");if(!Hb)throw Error.argumentNull("attributes");this.egk=cb;this.tXj=Hb}ltf(){return this.egk}u4h(){return this.tXj}}Object(l.a)(td,"PredictionsWithTokenAttributes",null,[]);class Bd{constructor(cb,Hb,bc){if(!cb)throw Error.argumentNull("attributeName");if(!Hb)throw Error.argumentNull("fieldNames");if(!bc)throw Error.argumentNull("values");if(Hb.length!==bc.length)throw Error.argument("values","fieldNames and values do not have same length");
this.sXj=cb;this.AJb=Hb;this.OYc=bc}get attributeName(){return this.sXj}get KZh(){return this.AJb.length}hqf(cb){return 0<=cb&&cb<this.AJb.length?this.AJb[cb]:null}getValue(cb){return 0<=cb&&cb<this.OYc.length?this.OYc[cb]:null}}Object(l.a)(Bd,"TokenAttributes",null,[]);var nl=c(55),ni=c(130);class si{constructor(cb,Hb,bc,Cc,Kc){this.Ncd=0;this.rqg=null;this.Ocd=this.Jnc=0;this.fqe=this.RRb=this.ora=this.Knc=null;this.sqg=0;this.oLe=this.iC=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=
this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.cS=cb;this.CMj=this.GMj=Hb;this.BMj=this.EMj=bc;this.Lcd=this.DMj=Cc;this.Mcd=this.FMj=Kc}HMj(){this.Ocd=0;return this.pqg}pqg(){if(!(this.Ocd<this.Lcd))return this.qqg;this.Knc=this.CMj.items[this.Ocd+this.BMj];this.ora=new Q.a(this.cS.Ab.annotations);1!==this.Lcd&&this.cS.Ab.QTc||this.ora.o_a(this.Knc);if(0<=this.cS.Ab.r5d){({value:this.RRb}=this.ora.Iq(this.cS.Ab.r5d)).returnValue?this.RRb=this.RRb.kT():this.RRb=new vb.a(this.cS.Ab.annotations,
N.Annotations.mV);this.fqe=this.Mcd.items;this.sqg=this.fqe.length;for(this.Ncd=0;this.Ncd<this.sqg;++this.Ncd)this.rqg=this.fqe[this.Ncd],Array.add(this.RRb.items,this.rqg);this.ora.Iy(this.cS.Ab.r5d,this.RRb)}else 0<=this.cS.Ab.qfg?this.ora.Iy(this.cS.Ab.qfg,this.Mcd.items[0]):0<=this.cS.Ab.l4e?this.ora.Iy(this.cS.Ab.l4e,!0):this.cS.Ab.nAi?this.Mcd.items[0].lNd((cb,Hb)=>this.ora.Iy(cb,Hb)):(this.ora.o_a(this.Mcd.items[0]),1!==this.Lcd&&this.cS.Ab.QTc||(({value:this.Jnc}=this.Knc.Iq(this.cS.Ab.l3)).returnValue&&
this.ora.Iy(this.cS.Ab.l3,this.Jnc),({value:this.Jnc}=this.Knc.Iq(this.cS.Ab.v7)).returnValue&&this.ora.Iy(this.cS.Ab.v7,this.Jnc),this.Knc.Iq(this.cS.Ab.aeb).returnValue&&this.ora.Iy(this.cS.Ab.aeb,this.Jnc)));this.iC=this.ora;this._state=2;return this.JMj}qqg(){this._state=3}IMj(){this.Ocd++;return this.pqg}JMj(){return 1<this.Lcd&&this.cS.Ab.QTc?this.qqg:this.IMj}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new si(this.cS,this.GMj,this.EMj,this.DMj,this.FMj)).getEnumerator()}[Symbol.iterator](){return Object(ni.a)(this.getEnumerator())}moveNext(){if(3===
this._state)return!1;this._state?this._state=1:(this._state=1,this.oLe=this.HMj());for(;1===this._state;)this.oLe=this.oLe();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.iC}}Object(l.a)(si,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[10,74,81]);class zi{constructor(cb,Hb,bc){this.LYc=this.rMi=0;this.Edc=null;this.fMf=this.NLf=this.Cdc=this.J3d=this.QLf=
0;this.K3d=!1;this.$Lf=cb;this.hMf=Hb;this.f$m=bc}qci(){null===this.Edc&&({dzj:this.Edc,opi:this.QLf,length:this.J3d,yAl:cb}=this.$Lf.Yii(this.hMf.items[this.LYc],this.f$m),this.K3d=cb||this.K3d);if(this.Cdc<this.J3d){var cb=this.Edc.charAt(this.QLf+this.Cdc);++this.Cdc;return{returnValue:!0,ch:cb}}if(this.LYc===this.hMf.items.length-1)return{returnValue:!1,ch:"\x00"};++this.LYc;this.Cdc=0;this.Edc=null;return{returnValue:!0,ch:" "}}M4f(cb,Hb){this.Cdc===this.J3d&&this.Edc&&(this.fMf=Hb,this.NLf=
this.LYc-this.rMi+1)}n7n(cb){if(0>cb||cb>=this.hMf.items.length)throw Error.argumentOutOfRange("iToken");this.LYc=this.rMi=cb;this.Edc=null;this.NLf=this.Cdc=this.J3d=this.QLf=0;this.fMf=-1;this.K3d=!1}r3l(){return{DQk:this.NLf,FXm:this.fMf,xAl:this.K3d}}}Object(l.a)(zi,"TriePrefixVisitor",null,[1403]);class yl{constructor(cb){this.Ab=cb}execute(cb){if(!({value:bc}=cb.Iq(this.Ab.$Ma)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Hb;({value:Hb}=cb.Iq(this.Ab.uZa)).returnValue||
(Hb=null);var bc=this.tMl(bc,Hb);cb=N.Annotations.kT(cb);cb.Iy(this.Ab.$Ma,bc);return cb}tMl(cb,Hb){let bc=null;const Cc=this.Ab.flatLexicon.trie,Kc=new zi(this,cb,Hb);let kd=null;this.Ab.flatLexicon.fCf()&&(kd=Object(nl.a)(this.Ab.flatLexicon,this.Ab.flatLexicon.WPl,"getCaseInsensitiveForm"));let Wd=0,ve;var Ie;let yf;for(;Wd<cb.items.length;){const gc=cb.items[Wd];Kc.n7n(Wd);Cc.DKj(Kc,kd);({DQk:ve,FXm:Ie,xAl:yf}=Kc.r3l());if(0<ve){({p_m:Ie}=this.Ab.flatLexicon.oNl(Ie));for(let ff of this.Icl(cb,
Wd,ve,Ie)){1<ve&&this.Ab.QTc&&this.Adl(cb,Hb,Wd,gc,ve,yf,ff);if(!bc)for(bc=new vb.a(this.Ab.annotations,N.Annotations.mV),Ie=0;Ie<Wd;++Ie)Array.add(bc.items,cb.items[Ie]);Array.add(bc.items,ff)}Wd+=ve}else bc&&Array.add(bc.items,gc),++Wd}return bc||cb}Adl(cb,Hb,bc,Cc,Kc,kd,Wd){if(kd)kd=!0;else if(this.Ab.Yzi){kd=!1;var ve=-1;for(var Ie=0;Ie<Kc;Ie++){var yf=cb.items[bc+Ie];let Sh;var gc=void 0;if(!({value:Sh}=yf.Iq(this.Ab.l3)).returnValue||!({value:gc}=yf.Iq(this.Ab.v7)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<Ie){if(Sh>ve+1){kd=!0;break}if(0>ve||null===Hb||ve>=Hb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Hb.charAt(ve)){kd=!0;break}}ve=Sh+gc}}else kd=!1;if(kd){gc=new Sys.StringBuilder;for(kd=0;kd<Kc;++kd)({dzj:ve,opi:Ie,length:yf}=this.Yii(cb.items[bc+kd],Hb)),0<kd&&gc.append(" "),gc.append(ve.substr(Ie,yf));Wd.Iy(this.Ab.aeb,gc.toString())}cb=cb.items[bc+Kc-1];let ff,Gk;({value:Cc}=Cc.Iq(this.Ab.l3)).returnValue&&
({value:ff}=cb.Iq(this.Ab.l3)).returnValue&&({value:Gk}=cb.Iq(this.Ab.v7)).returnValue?(Wd.Iy(this.Ab.l3,Cc),Wd.Iy(this.Ab.v7,ff+Gk-Cc)):(Wd.xSa(this.Ab.l3),Wd.xSa(this.Ab.v7))}Icl(cb,Hb,bc,Cc){return new si(this,cb,Hb,bc,Cc)}Yii(cb,Hb){let bc,Cc;if(({value:bc}=cb.Iq(this.Ab.aeb)).returnValue)Cc=!0,Hb=0,cb=bc.length;else{Cc=!1;if(null===Hb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");bc=Hb;if(!({value:Hb}=cb.Iq(this.Ab.l3)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:cb}=cb.Iq(this.Ab.v7)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Hb||0>cb||Hb+cb>bc.length)throw Error.argument("Token start/length values out of range","token");}return{dzj:bc,opi:Hb,length:cb,yAl:Cc}}}Object(l.a)(yl,"FlatLexiconNLModule",null,[1379]);class Dl{constructor(cb,Hb){this.l4e=this.r5d=this.qfg=this.aeb=this.v7=this.l3=this.uZa=this.$Ma=0;this.nAi=this.Yzi=this.QTc=!1;this.flatLexicon=null;this.annotations=Hb.annotations;
let bc=0;try{this.$Ma=cb.J(bc),++bc,this.uZa=cb.J(bc),++bc,this.l3=cb.J(bc),++bc,this.v7=cb.J(bc),++bc,this.aeb=cb.J(bc),++bc,this.qfg=cb.J(bc),++bc,this.r5d=cb.J(bc),++bc,this.l4e=cb.J(bc),++bc,this.QTc=1===cb.J(bc),++bc,this.Yzi=1===cb.J(bc),++bc,this.nAi=1===cb.J(bc),++bc,this.flatLexicon=Hb.Z$l(cb.J(bc))}catch(Cc){throw Error.argument("initData");}}}Object(l.a)(Dl,"FlatLexiconNLModuleInit",null,[]);class ji{constructor(){this.PRc=0;this.skf=null;this.t6c=0}}Object(l.a)(ji,"FeatureGenStackRec",
null,[]);class ej{constructor(cb){this.dkg=Array(cb);this.Vlc=Array(cb);this.Rgg=[];this.Hwj=[]}}Object(l.a)(ej,"TokenStringLattice",null,[]);const fj=(cb,Hb,bc)=>{for(let Cc=0;Cc<cb.length;Cc++)bc=Hb(bc,cb[Cc]);return bc},um=(cb,Hb)=>{const bc=Array(cb.length);for(let Cc=0;Cc<cb.length;Cc++)bc[Cc]=Hb(cb[Cc]);return bc},Gg=(cb,Hb)=>{Hb=Array(Math.min(Hb,cb.length));for(let bc=0;bc<Hb.length;bc++)Hb[bc]=cb[bc];return Hb},dg=(cb,Hb)=>{const bc=[];for(const Cc of cb)Hb(Cc)&&Array.add(bc,Cc);return bc};
class Ri{constructor(cb,Hb){this.key=cb;this.value=Hb}}Object(l.a)(Ri,"KeyValuePair",null,[]);const am=(cb,Hb)=>({returnValue:Hb in cb,value:cb[Hb]}),gj=cb=>{const Hb=[];for(let bc in cb){const Cc=new Ri(bc,cb[bc]);Array.add(Hb,Cc)}return Hb};class Tg{constructor(cb){this.Xii=this.ihm;this.Ab=cb;this.N3d=this.XLf=this.YLf=0;for(const Hb of this.Ab.TLd)this.YLf=Math.max(this.YLf,Hb.q_f),this.XLf=Math.max(this.XLf,Hb.l_f),this.N3d=Math.max(this.N3d,Hb.hpb.length)}get NCl(){return this.Ab.xme.trie}execute(cb){if(!cb)throw Error.argumentNull("input");
let Hb,bc;({tokens:Hb,MYm:bc}=this.jhm(cb));let Cc=null,Kc=null,kd={};if(this.Ab.wUc){Hb=N.Annotations.kT(Hb);for(var Wd=0;Wd<Hb.items.length;++Wd)Hb.items[Wd]=N.Annotations.kT(Hb.items[Wd])}else({tZh:Kc,returnValue:Cc}=this.jdi(cb,kd));Wd=Array(this.N3d);const ve=Array(this.N3d);for(var Ie=0;Ie<ve.length;++Ie)ve[Ie]=new ji;for(Ie=-this.YLf;Ie<Hb.items.length+this.XLf;++Ie){let yf=null;this.Ab.wUc&&(yf=Hb.items[Ie],kd={},{tZh:Kc,returnValue:Cc}=this.jdi(yf,kd));for(const gc of this.Ab.TLd){if(0>Ie&&
-Ie>gc.q_f||Ie>=Hb.items.length&&Ie-Hb.items.length+1>gc.l_f)continue;let ff=!0;for(let Gk=0;Gk<gc.hpb.length;++Gk){const Sh=Ie+gc.hpb[Gk];Wd[Gk]=Sh;if(0>Sh?0>this.Ab.r_f:Sh>=Hb.items.length?0>this.Ab.m_f:!bc.Vlc[Sh]){ff=!1;break}}ff&&({Tgl:Cc,Ugl:Kc}=this.hEm(gc,bc,Cc,Kc,kd,ve,Wd))}this.Ab.wUc&&(yf.Iy(this.Ab.V2a?this.Ab.E1b:this.Ab.C1b,Cc),this.Ab.V2a&&yf.Iy(this.Ab.D1b,Kc))}cb=N.Annotations.kT(cb);this.Ab.wUc?cb.Iy(this.Ab.$Ma,Hb):(cb.Iy(this.Ab.V2a?this.Ab.E1b:this.Ab.C1b,Cc),this.Ab.V2a&&cb.Iy(this.Ab.D1b,
Kc));return cb}jhm(cb){let Hb,bc;if(!cb||!({value:Hb}=cb.Iq(this.Ab.$Ma)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Cc;({value:Cc}=cb.Iq(this.Ab.uZa)).returnValue||(Cc="");bc=new ej(Hb.items.length);const Kc=dg(this.Ab.gkg,kd=>!kd.SSc||kd.SSc.isMatch(cb,null));for(let kd=0;kd<Hb.items.length;++kd){const Wd=Hb.items[kd];let ve=null;bc.dkg[kd]=bc.Rgg.length;let Ie=bc.Vlc[kd]=0;for(const yf of Kc)0<yf.ZYc&&bc.Vlc[kd]+Ie>=yf.ZYc||yf.V$c&&!yf.V$c.isMatch(Wd,
null)||({X$c:ve,PFc:Ie}=yf.apply(this,Wd,kd,bc,Cc,ve,Ie))}return{tokens:Hb,MYm:bc}}hEm(cb,Hb,bc,Cc,Kc,kd,Wd){let ve=0;kd[0].PRc=-1;for(kd[0].skf=cb.Yfj;;){var Ie=Wd[ve],yf=0>Ie||Ie>=Hb.Vlc.length?1:Hb.Vlc[Ie];let Gk=!1;for(;kd[ve].PRc<yf-1;){++kd[ve].PRc;var gc=void 0,ff=void 0;0>Ie?(gc=this.Ab.r_f,ff=1):Ie>=Hb.dkg.length?(gc=this.Ab.m_f,ff=1):(ff=Hb.dkg[Ie]+kd[ve].PRc,gc=Hb.Rgg[ff],ff=Hb.Hwj[ff]);kd[ve].t6c=ff*(ve?kd[ve-1].t6c:cb.score);if(({value:gc}=am(kd[ve].skf,gc.toString())).returnValue){ve===
cb.hpb.length-1?(Ie=gc,kd[ve].t6c&&(({value:yf}=am(Kc,Ie.toString())).returnValue||(yf=-1),0>yf&&(bc=N.Annotations.kT(bc),Array.add(bc.items,Ie)),this.Ab.V2a&&(Cc=N.Annotations.kT(Cc),0>yf?Array.add(Cc.items,kd[ve].t6c):Cc.items[yf]+=kd[ve].t6c),0>yf&&(this.Ab.JDi||this.Ab.V2a)&&(Kc[Ie.toString()]=bc.items.length-1))):(++ve,kd[ve].PRc=-1,kd[ve].skf=gc);Gk=!0;break}}if(!Gk&&(--ve,0>ve))break}return{Tgl:bc,Ugl:Cc}}jdi(cb,Hb){let bc;if(({value:bc}=cb.Iq(this.Ab.V2a?this.Ab.E1b:this.Ab.C1b)).returnValue)for(let Cc=
0;Cc<bc.items.length;++Cc)Hb[bc.items[Cc].toString()]=Cc;else bc=new vb.a(this.Ab.annotations,N.Annotations.EIa);if(this.Ab.V2a){if(({value:Hb}=cb.Iq(this.Ab.D1b)).returnValue||(Hb=new vb.a(this.Ab.annotations,N.Annotations.Yqa)),Hb.items.length!==bc.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ab.annotations.Pda(N.Annotations.mV,cb));}else Hb=null;return{returnValue:bc,tZh:Hb}}get jMo(){return this.Ab.xme}ihm(cb,
Hb){var bc;if(({value:bc}=Hb.Iq(this.Ab.aeb)).returnValue)cb=bc;else{if(!({value:bc}=Hb.Iq(this.Ab.l3)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Hb}=Hb.Iq(this.Ab.v7)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>bc||0>Hb||bc+Hb>cb.length)throw Error.argument("Token indices are out of range");cb=cb.substr(bc,Hb)}return cb}}Object(l.a)(Tg,"NGramNLModule",null,[1379,1380]);class Si{constructor(cb){this.hpb=null;this.score=this.l_f=this.q_f=
0;this.Yfj=null;if(cb){var Hb=0;try{if(cb.J(Hb)!==Si.nAb)throw Error.argument("initData","Input does not represent a feature template");++Hb;const bc=cb.J(Hb);++Hb;this.hpb=Array(bc);for(let Cc=0;Cc<bc;++Cc)this.hpb[Cc]=cb.J(Hb),++Hb;this.q_f=cb.J(Hb);++Hb;this.l_f=cb.J(Hb);++Hb;this.score=cb.J(Hb);++Hb;this.Yfj=({ipi:Hb}=Si.D7i(cb,Hb)).returnValue}catch(bc){throw Error.argument("initData");}}}static D7i(cb,Hb){const bc=cb.J(Hb);++Hb;const Cc={};for(let Kc=0;Kc<bc;++Kc){const kd=cb.J(Hb);++Hb;cb.J(Hb)?
Cc[kd.toString()]=({ipi:Hb}=Si.D7i(cb,Hb)).returnValue:(++Hb,Cc[kd.toString()]=cb.J(Hb),++Hb)}return{returnValue:Cc,ipi:Hb}}}Si.nAb=240803228;Object(l.a)(Si,"FeatureTemplate",null,[1405]);var kj=c(1598);class Mh{constructor(cb,Hb){this.V2a=this.JDi=this.wUc=!1;this.aeb=this.v7=this.l3=this.$Ma=this.uZa=this.D1b=this.E1b=this.C1b=0;this.xme=null;this.m_f=this.r_f=0;this.TLd=this.gkg=null;if(cb){this.annotations=Hb.annotations;var bc=0;try{this.wUc=1===cb.J(bc);++bc;this.JDi=1===cb.J(bc);++bc;this.V2a=
1===cb.J(bc);++bc;this.C1b=cb.J(bc);++bc;this.E1b=cb.J(bc);++bc;this.D1b=cb.J(bc);++bc;this.uZa=cb.J(bc);++bc;this.$Ma=cb.J(bc);++bc;this.l3=cb.J(bc);++bc;this.v7=cb.J(bc);++bc;this.aeb=cb.J(bc);++bc;this.xme=this.YBn(Hb.shb(cb.J(bc)));++bc;this.r_f=cb.J(bc);++bc;this.m_f=cb.J(bc);++bc;const Cc=cb.J(bc);++bc;this.gkg=Array(Cc);for(let kd=0;kd<Cc;++kd){const Wd=cb.J(bc);++bc;const ve=this.xme.trie,Ie=new Mb.a;Ie.ehb(cb,bc,Wd);this.gkg[kd]=this.bCn(Ie,Hb,ve);bc+=Wd}const Kc=cb.J(bc);++bc;this.TLd=Array(Kc);
for(Hb=0;Hb<Kc;++Hb){const kd=cb.J(bc);++bc;const Wd=new Mb.a;Wd.ehb(cb,bc,kd);this.TLd[Hb]=this.FBn(Wd);bc+=kd}}catch(Cc){throw Error.argument("initData");}}}YBn(cb){return new Ji.a(new Th.a(cb))}bCn(cb,Hb,bc){return kj.a.create(cb,Hb,bc)}FBn(cb){return new Si(cb)}}Object(l.a)(Mh,"NGramNLModuleInit",null,[]);class Qh{constructor(cb){this.Ab=cb}execute(cb){if(!cb)throw Error.argumentNull("input");cb=cb.clone();this.Ab.script.execute(cb,null);return cb}}Object(l.a)(Qh,"ScriptNLModule",null,[1379]);
class Qk{constructor(cb,Hb){cb&&(this.script=Hb.WDb(cb.J(0)))}}Object(l.a)(Qk,"ScriptNLModuleInit",null,[]);const Hj=cb=>{cb=um(cb,Hb=>Hb*Hb);return Math.sqrt(fj(cb,(Hb,bc)=>Hb+bc,0))},tl=cb=>fj(cb,(Hb,bc)=>Hb>bc?Hb:bc,cb[0]);class Qj{constructor(cb){this.Ab=cb}execute(cb){if(!cb)throw Error.argumentNull("input");var Hb=[],bc=[];this.Z0k(cb,Hb,bc);this.MAk(Hb,bc);const Cc={};for(let kd=0;kd<Hb.length;++kd){var Kc=Hb[kd];const Wd=this.Ab.yti.J(Kc);Kc=this.Ab.zti.J(Kc);for(let ve=0;ve<Kc;++ve){const Ie=
this.Ab.H7.J(this.Ab.UDh.J(Wd+ve)),yf=this.Ab.VDh.J(Wd+ve);let gc;({value:gc}=am(Cc,Ie)).returnValue||(gc=0);Cc[Ie]=gc+bc[kd]*yf}}bc=gj(Cc);bc.sort((kd,Wd)=>{var ve=kd.value,Ie=Wd.value;(ve=-(ve>Ie?1:ve<Ie?-1:0))||(ve=kd.key.localeCompare(Wd.key));return ve});Hb=new vb.a(this.Ab.annotations,N.Annotations.mV);for(const kd of Gg(bc,this.Ab.Dbn))bc=new Q.a(this.Ab.annotations),bc.Iy(this.Ab.OIk,kd.key),bc.Iy(this.Ab.QIk,kd.value),Array.add(Hb.items,bc);cb.Iy(this.Ab.PIk,Hb);return cb}Z0k(cb,Hb,bc){if(({value:cb}=
cb.Iq(this.Ab.NIk)).returnValue){let Cc;if(({value:Cc}=cb.Iq(this.Ab.E1b)).returnValue){let Kc;if(!({value:Kc}=cb.Iq(this.Ab.D1b)).returnValue||Cc.items.length!==Kc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.FEd(Cc,Kc,Hb,bc)}if(({value:Cc}=cb.Iq(this.Ab.SIk)).returnValue){let Kc;if(!({value:Kc}=cb.Iq(this.Ab.TIk)).returnValue||Cc.items.length!==Kc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.FEd(Cc,Kc,Hb,bc)}({value:Cc}=cb.Iq(this.Ab.C1b)).returnValue&&this.FEd(Cc,null,Hb,bc);({value:Cc}=cb.Iq(this.Ab.RIk)).returnValue&&this.FEd(Cc,null,Hb,bc)}}FEd(cb,Hb,bc,Cc){for(let kd=0;kd<cb.items.length;++kd){var Kc=void 0;cb.y4===N.Annotations.i$?({value:Kc}=am(this.Ab.XUh,cb.items[kd])).returnValue||(Kc=-1):(Kc=cb.items[kd],Kc=Kc>=this.Ab.DNf&&Kc<=this.Ab.icn?this.Ab.wRf?this.Ab.wRf.J(Kc-this.Ab.DNf)-1:Kc-this.Ab.DNf:-1);if(0<=Kc){let Wd;Wd=Hb?Hb.items[kd]:1;0<Wd&&(Array.add(bc,Kc),Array.add(Cc,
Wd))}}}MAk(cb,Hb){if(cb.length){switch(this.Ab.kMn){case 0:break;case 1:for(var bc=0;bc<Hb.length;++bc)Hb[bc]=1+Math.log(Hb[bc]);break;case 2:bc=tl(Hb);for(let Cc=0;Cc<Hb.length;++Cc)Hb[Cc]=.5+Hb[Cc]/bc*.5;break;case 3:for(bc=0;bc<Hb.length;++bc)Hb[bc]=1;break;default:throw Error.notImplemented();}if(this.Ab.vXd)for(bc=0;bc<Hb.length;++bc)Hb[bc]*=this.Ab.vXd.J(cb[bc]);cb=Hj(Hb);for(bc=0;bc<Hb.length;++bc)Hb[bc]/=cb}}}Object(l.a)(Qj,"TfIdfRankerNLModule",null,[1379]);class zl{constructor(cb,Hb=0){if(!cb)throw Error.argumentNull("byteArray");
this.O3d=Hb;if(604662927!==cb.Gy(this.O3d+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.fj=cb.Gy(this.O3d+4,4);this.aMi=cb.Gy(this.O3d+8,4);this.U9m=cb}J(cb){if(0>cb||cb>=this.count)throw Error.argumentOutOfRange("index");return this.U9m.WQn(8*this.O3d+96+cb*this.aMi,this.aMi)}get count(){return this.fj}}Object(l.a)(zl,"CompactIntArray",null,[1367]);const Rh=(cb,Hb)=>{Hb=Array(Hb);for(let kd=0;kd<Hb.length;kd++){var bc=kd,Cc=cb.F9(),Kc=1===(Cc>>31&1)?-1:
1;const Wd=Cc&8388607;Cc=Cc>>23&255;256===Cc+1?Kc=Wd?Number.NaN:1===Kc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Cc?(Cc-=127,Kc=Kc*Dk(Wd,1)*Math.pow(2,Cc)):Kc=Kc*Dk(Wd,0)*Math.pow(2,-126);Hb[bc]=Kc}return Hb},Dk=(cb,Hb)=>{let bc=0;for(let Cc=0;23>Cc;Cc++)bc+=(cb>>22-Cc&1)/Math.pow(2,Cc+1);return Hb+bc};class ok{constructor(cb,Hb){this.wRf=null;this.uSi=0;this.zti=this.yti=this.vXd=null;this.tSi=0;this.VDh=this.UDh=null;this.annotations=Hb.annotations;let bc=0;this.RIk=cb.J(bc);++bc;this.C1b=
cb.J(bc);++bc;this.SIk=cb.J(bc);++bc;this.TIk=cb.J(bc);++bc;this.E1b=cb.J(bc);++bc;this.D1b=cb.J(bc);++bc;this.NIk=cb.J(bc);++bc;this.PIk=cb.J(bc);++bc;this.OIk=cb.J(bc);++bc;this.QIk=cb.J(bc);++bc;var Cc=cb.J(bc);++bc;var Kc=Array(Cc);for(var kd=0;kd<Cc;++kd)Kc[kd]=Hb.QD(cb.J(bc)),++bc;this.H7=Mb.a.Dbf(Kc);this.Dbn=cb.J(bc);++bc;this.kMn=cb.J(bc);++bc;Cc=cb.J(bc);++bc;this.XUh={};for(Kc=0;Kc<Cc;++Kc){kd=Hb.QD(cb.J(bc));++bc;const Wd=cb.J(bc);++bc;this.XUh[kd]=Wd}this.DNf=cb.J(bc);++bc;this.icn=cb.J(bc);
++bc;Cc=cb.J(bc);++bc;0<Cc&&(Cc=Hb.shb(cb.J(bc)),++bc,this.wRf=this.b$d(new Le(Cc)));++bc;cb=Hb.shb(cb.J(bc));this.MBn(cb)}b$d(cb){return new zl(cb.Afa,cb.offset)}MBn(cb){try{const Hb=new Le(cb);this.uSi=Hb.F9();1===Hb.F9()?this.vXd=Mb.a.Dbf(Rh(Hb,this.uSi)):this.vXd=null;const bc=Hb.F9();this.yti=this.b$d(Hb);Hb.offset+=bc;const Cc=Hb.F9();this.zti=this.b$d(Hb);Hb.offset+=Cc;this.tSi=Hb.F9();const Kc=Hb.F9();this.UDh=this.b$d(Hb);Hb.offset+=Kc;this.VDh=Mb.a.Dbf(Rh(Hb,this.tSi))}catch(Hb){throw Error.argument("byteReader");
}}}Object(l.a)(ok,"TfIdfRankerNLModuleInit",null,[]);class Rk{constructor(cb,Hb,bc,Cc){this.wYf=cb;this.o0h=bc;this.tokens=Cc;this.Jma=Hb;this.Qic=-1;this.jge=0}}Object(l.a)(Rk,"TokenizerData",null,[]);class Gm{constructor(cb){this.Ab=cb}execute(cb){if(!cb)throw Error.argumentNull("input");if(!({value:Cc}=cb.Iq(this.Ab.uZa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Hb;({value:Hb}=cb.Iq(this.Ab.l3)).returnValue||(Hb=0);let bc;({value:bc}=
cb.Iq(this.Ab.v7)).returnValue||(bc=Cc.length-Hb);if(0>Hb||Hb>Cc.length)throw Error.argument("input","Start index out of range");if(0>bc||bc>Cc.length)throw Error.argument("input","Length out of range");if(Hb+bc>Cc.length)throw Error.argument("input","Bad start-length range");var Cc=new Rk(Cc,Hb,Hb+bc,new vb.a(this.Ab.annotations,N.Annotations.mV));this.kMo(Cc);cb=cb.isReadOnly?cb.clone():cb;cb.Iy(this.Ab.$Ma,Cc.tokens);return cb}kMo(cb){for(;cb.Jma<cb.o0h;){if(this.Ab.ywf){var Hb=this.Ab.ywf.GLi(cb.wYf,
cb.Jma,cb.o0h-cb.Jma,null);!Hb.succeeded&&Hb.nRi&&(Hb=Hb.nRi);if(Hb.succeeded){this.lWi(cb,Hb.length,this.Ab.lli);cb.Jma+=Hb.length;continue}}Hb=cb.wYf.substr(cb.Jma);let bc=-1,Cc=-1,Kc=-1;for(let kd=0;kd<this.Ab.lfe.length;++kd){const Wd=this.Ab.lfe[kd].exec(Hb);Wd&&0<Wd[1].length&&(0>bc||Wd[0].length>Cc)&&(bc=kd,Cc=Wd[0].length,Kc=Wd[1].length)}0<=bc?(this.lWi(cb,Kc,this.Ab.a9f[bc]),cb.Jma+=Kc):cb.Jma+=1}}lWi(cb,Hb,bc){if(this.Ab.$Bi)bc!==Gm.MQk&&(0>cb.Qic&&(cb.Qic=cb.Jma),cb.jge=cb.Jma+Hb-cb.Qic,
bc===Gm.LQk&&(0<=cb.Qic&&0<cb.jge&&(Hb=new Q.a(this.Ab.annotations),Hb.Iy(this.Ab.l3,cb.Qic),Hb.Iy(this.Ab.v7,cb.jge),Hb.Iy(this.Ab.a3e,Gm.NQk),Hb.Iy(this.Ab.uZa,cb.wYf),Array.add(cb.tokens.items,Hb)),cb.Qic=-1,cb.jge=0));else{let Cc=new Q.a(this.Ab.annotations);Cc.Iy(this.Ab.l3,cb.Jma);Cc.Iy(this.Ab.v7,Hb);Cc.Iy(this.Ab.a3e,bc);Array.add(cb.tokens.items,Cc)}}}Gm.MQk="GAP";Gm.LQk="EOS_CHUNK";Gm.NQk="SENTENCE";Object(l.a)(Gm,"TokenizerNLModule",null,[1379]);class bm{constructor(cb,Hb){this.v7=this.l3=
this.a3e=this.$Ma=this.uZa=0;this.$Bi=!1;this.a9f=this.lfe=this.lli=this.ywf=null;if(cb){this.annotations=Hb.annotations;var bc=0;try{this.uZa=cb.J(bc);++bc;this.$Ma=cb.J(bc);++bc;this.a3e=cb.J(bc);++bc;this.l3=cb.J(bc);++bc;this.v7=cb.J(bc);++bc;this.$Bi=1===cb.J(bc);++bc;var Cc=cb.J(bc);++bc;0<Cc&&(this.ywf=Hb.esf(Cc).NCl);this.lli=cb.J(bc)?Hb.QD(cb.J(bc)):"";++bc;const Kc=cb.J(bc);++bc;this.lfe=Array(Kc);this.a9f=Array(Kc);for(Cc=0;Cc<Kc;++Cc)this.lfe[Cc]=new RegExp(Hb.QD(cb.J(bc))),++bc,this.a9f[Cc]=
Hb.QD(cb.J(bc)),++bc}catch(Kc){throw Error.argument("initData");}}}}Object(l.a)(bm,"TokenizerNLModuleInit",null,[]);class cm{constructor(cb){this.Ab=cb}execute(cb){if(!cb)throw Error.argumentNull("input");let Hb;if(!({value:Hb}=cb.Iq(this.Ab.Uvh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const bc of this.Ab.hgg)Hb=bc.apply(Hb);cb=N.Annotations.kT(cb);cb.Iy(this.Ab.Vvh,Hb);return cb}static k2e(cb,Hb){const bc=new Sys.StringBuilder;for(let Cc=
0;Cc<cb.length;++Cc)bc.append(Hb(cb.substr(Cc,1)));return bc.toString()}}Object(l.a)(cm,"TransliteratorNLModule",null,[1379]);class qg{constructor(cb){cb&&(this.style=cb.J(0))}apply(cb){return cm.k2e(cb,Hb=>qg.kVk(Hb,this.style))}static kVk(cb,Hb){switch(Hb){case 0:return cb.toLowerCase();case 1:return"I"===cb?"\u0131":cb.toLowerCase();case 2:return cb.toUpperCase();case 3:return"i"===cb?"\u0130":cb.toUpperCase();default:throw Error.invalidOperation();}}}qg.oAb=0;Object(l.a)(qg,"ChangeCaseTransliterationStage",
null,[1382]);class Yk{apply(cb){return cm.k2e(cb,Yk.INo)}static INo(cb){const Hb=cb.charCodeAt(0);return 65281<=Hb&&65374>=Hb?String.fromCharCode(Hb-65248):cb}}Yk.oAb=4;Object(l.a)(Yk,"LatinFullWidthToHalfWidthTransliterationStage",null,[1382]);class Wl{constructor(cb,Hb){cb&&(this.c4f=Hb.L8b(cb.J(0)),this.W4n=Hb.QD(cb.J(1)))}apply(cb){return cb.replace(this.c4f,this.W4n)}}Wl.oAb=1;Object(l.a)(Wl,"RegexReplaceTransliterationStage",null,[1382]);class kg{constructor(cb,Hb){if(cb){var bc=cb.J(0),Cc=
Hb.QD(cb.J(1)),Kc=new zl(Hb.shb(cb.J(2)));cb=0>cb.J(3)?null:new zl(Hb.shb(cb.J(3)));this.jhg={};for(Hb=0;Hb<bc;++Hb)this.jhg[Cc.charAt(Hb).toString()]=Cc.substr(Kc.J(Hb),cb?cb.J(Hb):1)}}apply(cb){return cm.k2e(cb,Hb=>Hb in this.jhg?this.jhg[Hb]:Hb)}}kg.oAb=2;Object(l.a)(kg,"SingleCharSubstitutionsTransliterationStage",null,[1382]);class Hd{constructor(cb,Hb){this.Vvh=this.Uvh=0;this.hgg=null;if(cb){this.annotations=Hb.annotations;var bc=0;try{this.Uvh=cb.J(bc);++bc;this.Vvh=cb.J(bc);++bc;const Cc=
cb.J(bc);++bc;this.hgg=Array(Cc);for(let Kc=0;Kc<Cc;++Kc){const kd=cb.J(bc);++bc;const Wd=cb.J(bc);++bc;const ve=new Mb.a;ve.ehb(cb,bc,Wd);bc+=Wd;this.hgg[Kc]=this.XBn(kd,ve,Hb)}}catch(Cc){throw Error.argument("initData");}}}XBn(cb,Hb,bc){switch(cb){case qg.oAb:return new qg(Hb);case Wl.oAb:return new Wl(Hb,bc);case kg.oAb:return new kg(Hb,bc);case Yk.oAb:return new Yk;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(l.a)(Hd,"TransliteratorNLModuleInit",
null,[]);class Ad{O4l(cb,Hb){const bc=cb.J(0),Cc=new Mb.a;Cc.ehb(cb,1,cb.count-1);switch(bc){case 0:return new Qh(new Qk(Cc,Hb));case 2:return new Gm(new bm(Cc,Hb));case 3:return new Tg(new Mh(Cc,Hb));case 5:return new yl(new Dl(Cc,Hb));case 9:return new cm(new Hd(Cc,Hb));case 10:return new Qj(new ok(Cc,Hb));default:throw Error.notImplemented();}}}Object(l.a)(Ad,"NLModuleFactory",null,[1333]);class wf{constructor(cb){this.JQk=";";if(!cb)throw Error.argumentNull("resource");this.Oha=new Pm(cb,new Fb,
new Ad);this.$Lf=this.Oha.t4l();this.$Li=this.Oha.annotations.xNc("Text.Text");this.YLi=this.Oha.annotations.xNc("Classification.Predictions");this.LLf=this.Oha.annotations.xNc("Classification.PredictionString");this.ZLi=this.Oha.annotations.xNc("Classification.Probability");this.T9m=this.Oha.annotations.xNc("NLMod.Tokens");if(0>this.$Li||0>this.YLi||0>this.LLf||0>this.ZLi)throw Error.argument("resourceObj","Resource does not represent a ranker");}wOl(){const cb=[];this.fjf(void 0,this.f5h(cb),null);
return cb}yOl(cb,Hb){const bc=[],Cc=[];this.fjf(cb,this.f5h(bc),(Kc,kd)=>{const Wd=this.Oha.annotations.T4h(Kc),ve=[],Ie=[];Hb&&Hb.length&&-1===Array.indexOf(Hb,Wd)||(Kc=this.Oha.annotations.getAttributeType(Kc),this.G2i(Kc,kd,ve,Ie),kd=new Bd(Wd,ve,Ie),Array.add(Cc,kd))});return new td(bc,Cc)}xOl(cb){const Hb=[];this.fjf(cb,bc=>{let Cc;if(({value:Cc}=bc.Iq(this.LLf)).returnValue){let Kc;({value:Kc}=bc.Iq(this.ZLi)).returnValue&&Array.add(Hb,new md(Cc,Kc))}},null);return Hb}fjf(cb,Hb,bc){var Cc=new Q.a(this.Oha.annotations);
Cc.Iy(this.$Li,cb);cb=this.$Lf.execute(Cc);if(({value:Cc}=cb.Iq(this.YLi)).returnValue)for(const Kc of Cc.items)Hb(Kc);if(bc&&({value:Hb}=cb.Iq(this.T9m)).returnValue)for(const Kc of Hb.items)Kc.lNd(bc)}G2i(cb,Hb,bc,Cc){if(N.Annotations.fI(cb))for(var Kc of Hb.items)this.G2i(Hb.y4,Kc,bc,Cc);else if(N.Annotations.QDj(cb)){Kc=this.Oha.annotations.Oci(cb);for(let kd=0;kd<Kc;kd++)Array.add(bc,this.Oha.annotations.thi(cb,kd)),Array.add(Cc,this.Oha.annotations.Pda(this.Oha.annotations.vFb(cb,kd),Hb.Hhb(kd)))}else Array.add(bc,
"VALUE"),Array.add(Cc,this.Oha.annotations.Pda(cb,Hb))}f5h(cb){return Hb=>{let bc;({value:bc}=Hb.Iq(this.LLf)).returnValue&&Array.add(cb,this.D9l(bc))}}D9l(cb){const Hb=cb.indexOf(this.JQk);return 0>Hb?cb:cb.substring(0,Hb)}}Object(l.a)(wf,"Ranker",null,[]);var eg=c(1539),tg=c(1550),ce=c(2);class jd{constructor(cb,Hb){this.n4g="";this.oPe=null;this.pPe=!1;this.tra=null;this.vXj=["TellMe.TellMeParamCollection"];this.ic=cb;this.qXa=Hb;this.ic.Izb&&(this.tra=null)}get Qbe(){if(!this.oPe&&!this.pPe){let cb=
null;try{cb=window.TellMeModel}catch(Hb){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("QueryRanker","TellMeModel not found. Exception: "+Hb)}if(cb){try{this.oPe=new wf(cb)}catch(Hb){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Hb)}this.pPe=!0}else if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("QueryRanker","Classifier model not found")}return this.oPe}cL(){return"Command"}bU(){return 0===
this.ic.gv?0:1===this.ic.gv?1:2}PH(cb,Hb,bc=!1,Cc=f.a.tellMe,Kc=null){const kd=new n.a(cb);if((!Kc||Array.contains(Kc,0))&&!z.a.dR(cb)){if(!this.Qbe&&this.pPe){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.ic.Izb&&this.tra&&this.tra.initialize();if(eg.CommandResultsUtility.nCf(cb.Dg)&&(Kc=eg.CommandResultsUtility.K6h(cb.Dg),0<Kc.results.length)){Kc.displayName=
"Classifier Debug";kd.Yu(Kc);Hb.resultsUpdated(kd);return}Kc=cb?this.n4g=cb.Dg:this.n4g;if(ce.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){Kc=this.F9l(Kc);var Wd=this.FOd(Kc.ltf());Kc=Kc.u4h()}else Kc=this.E9l(Kc),Wd=this.ARl(Kc),Kc=[];eg.CommandResultsUtility.Y2d(Wd,!1,"Classifier","TFIDF");Wd=eg.CommandResultsUtility.JPc(cb,Wd,this.ic,this.tra,this.qXa,Kc,0,1);0<Wd.results.length&&Cc!==f.a.contextMenu&&(Wd.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);bc||Wd.results.length||
this.ic.U_||this.ic.a7a||(cb=new x.a("lookupNoResults",14,cb.Dg,null,1),Wd.Ow(cb));0<Wd.results.length&&kd.Yu(Wd);kd.attributes=Kc}Hb.resultsUpdated(kd)}ltf(){let cb=[];try{cb=this.Qbe.wOl()}catch(Hb){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("GetPredictions","Exception: "+Hb)}return cb}E9l(cb){let Hb=[];try{Hb=this.Qbe.xOl(cb)}catch(bc){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("GetPredictionsWithScore","Exception: "+bc)}return Hb}F9l(cb){try{return this.Qbe.yOl(cb,
this.vXj)}catch(Hb){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("GetPredictionsWithTokenAttributes","Exception: "+Hb)}return new td([],[])}FOd(cb){const Hb=[];if(cb)for(const bc of cb)Hb.push(new tg.a(bc,-99999));return Hb}ARl(cb){const Hb=[];if(cb)for(const bc of cb)Hb.push(new tg.a(bc.prediction,bc.score));return Hb}}Object(l.a)(jd,"CommandResultsProvider",null,[1247]);var gk=c(1738);class Ch{constructor(cb){this.ic=cb}cL(){return"Feedback"}bU(){return 0===this.ic.gv?0:1===this.ic.gv?
1:2}PH(cb,Hb,bc,Cc,Kc=null){cb=new n.a(cb);if(!Kc||Array.contains(Kc,21))Kc=[],Kc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Kc),Kc=new y.a(22),Kc.displayName="",Kc.Ow(new x.a("TellMeFeedback",23,null,null,1)),cb.Yu(Kc);Hb.resultsUpdated(cb)}}Object(l.a)(Ch,"FeedbackResultsProvider",null,[1247]);class ug{constructor(cb,Hb,bc,Cc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=cb;this.CommandId=
Hb;this.CommandValueId=bc;this.InputText=Cc}}Object(l.a)(ug,"FindInDocumentProp",null,[]);var ul=c(19);class th{constructor(cb){this.hKe=2;this.Kvb=[];this.xbb=[];this.ic=cb;th.XDa=cb.Bkf;th.H_h="FindInDocumentSuggestion";th.U1i="FindInDocumentSuggestion3";this.ZIe=Object.assign(new w.a,{landingTab:"Indoc",data:null});this.Ijk=this.ic.Vob||!!ce.AFrameworkApplication.ta&&ce.AFrameworkApplication.ta.Nb.Vob}cL(){return"FindInDocument"}bU(){return 0===this.ic.gv?0:1===this.ic.gv?1:3===this.ic.gv?this.ic.Ztj?
2:3:2}PH(cb,Hb,bc=!1,Cc,Kc=null){const kd=new n.a(cb);if(Kc&&!Array.contains(Kc,2))Hb.resultsUpdated(kd);else if(Array.clear(this.Kvb),z.a.dR(cb)){if(bc&&this.krj()){bc=new y.a(2);bc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Kc=1;Cc="";if(0<this.xbb.length&&!this.ic.Njc)for(var Wd of this.xbb)if(""!==Wd.Label.toLowerCase()){if(Kc>=this.hKe)break;this.KHj(bc,Wd.Label,Wd.CommandValueId,th.H_h+Kc,Wd.InputText);Kc++}Wd="";this.ic.rP?(kd.Yu(bc),bc=new y.a(3),Wd=this.ic.Wdb?z.a.rhb(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):Wd=CommonUIStrings.l_TellMeOpenFindPaneText;Cc=this.J6h("");this.KHj(bc,Wd,Cc,th.U1i,"");kd.Yu(bc)}Hb.resultsUpdated(kd)}else Wd="",bc&&(bc=this.J6h(cb.Dg),Cc=[],this.ic.w3a?(this.ic.Kie&&Cc.push(appChrome.actions.setControlIconSet(th.XDa,{"default":"FindInDocument_20"})),Wd=this.ic.EGf?z.a.Aqf(cb.Dg,CommonUIStrings.l_FindInDocumentScopedButtonText):cb.Dg+CommonUIStrings.l_FindInDocumentScopedButtonText):this.ic.rP?(Wd=this.ic.Wdb?z.a.rhb(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
cb.Dg)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,cb.Dg),Cc.push(appChrome.actions.setControlIconSet(th.XDa,{"default":"FindInDocument_20"}))):Wd=this.ic.Njc?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,cb.Dg),this.ic.$va?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(th.XDa,Wd)),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(th.XDa,bc))):(Cc.push(appChrome.actions.setControlLabel(th.XDa,
Wd)),Cc.push(appChrome.actions.setButtonCommandValueId(th.XDa,bc)),appChrome.api.dispatch(Cc)),this.Emj(Wd,th.XDa,bc,cb.Dg)),this.ic.Ztj?(Wd=new x.a(th.XDa,8,cb.Dg),bc=new y.a(2),bc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,bc.Ow(Wd),kd.Yu(bc),Hb.resultsUpdated(kd)):this.ic.FPd(cb.Dg).then(ve=>{const Ie=new x.a(th.XDa,8,cb.Dg,null,1);Ie.count=ve;ve=new y.a(2);ve.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;ve.Ow(Ie);kd.Yu(ve);Hb.resultsUpdated(kd)},ve=>{u.TellMeActor.instance.Oe.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+ve);ve=new x.a(th.XDa,8,cb.Dg,null,1);const Ie=new y.a(2);Ie.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Ie.Ow(ve);kd.Yu(Ie);Hb.resultsUpdated(kd)})}krj(){return!!this.ic&&this.ic.Die}KHj(cb,Hb,bc,Cc,Kc=null){const kd=[];Hb&&kd.push(appChrome.actions.setControlLabel(Cc,Hb));this.ic.rP&&kd.push(appChrome.actions.setControlIconSet(Cc,{"default":"FindInDocument_20"}));kd.push(appChrome.actions.setButtonCommandValueId(Cc,bc));appChrome.api.dispatch(kd);
this.Emj(Hb,Cc,bc,"");cb.Ow(new x.a(Cc,8,Kc,null,1,-99999))}J6h(cb){return this.Ijk?z.a.RNa(cb,15,this.ZIe):ul.a.yf(cb)}Emj(cb,Hb,bc,Cc){this.krj()&&this.Kvb.length<this.hKe&&(cb=new ug(cb,Hb,bc,Cc),Array.add(this.Kvb,cb))}Hlo(cb){for(let Hb=0;Hb<this.Kvb.length;Hb++)if(this.Kvb[Hb].CommandId===cb){const bc=this.Kvb[Hb].Label;let Cc=!1;if(0<this.xbb.length){let Kc=0;for(const kd of this.xbb){if(kd.Label===bc){Array.removeAt(this.xbb,Kc);Cc=!0;break}Kc++}}!Cc&&this.xbb.length>=this.hKe-1&&Array.removeAt(this.xbb,
1);Array.insert(this.xbb,0,this.Kvb[Hb])}}}th.XDa=null;th.H_h=null;th.U1i=null;Object(l.a)(th,"FindInDocumentResultsProvider",null,[1247]);var fg=c(1736);class ag{constructor(cb){this.ic=cb}cL(){return"Insights"}bU(){return 0===this.ic.gv?0:1===this.ic.gv?1:2}PH(cb,Hb,bc=!1,Cc,Kc=null){Cc=new n.a(cb);if(!Kc||Array.contains(Kc,13))if(this.Uuo()||!z.a.dR(cb)){Kc=new y.a(13);var kd=""===cb.Dg.trim(),Wd=kd?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",ve=new x.a(Wd,10,cb.Dg,null,1);bc&&(bc=
null,z.a.Moa()?kd?kd=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(kd=this.ic.Njc?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,cb.Dg),bc=z.a.RNa(cb.Dg,1)):(kd=String.format(CommonUIStrings.l_InsightsButtonText,cb.Dg),bc=z.a.IBb(cb.Dg)),this.ic.$va?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Wd,kd)),bc&&u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
bc))):(cb=[],cb.push(appChrome.actions.setControlLabel(Wd,kd)),bc&&cb.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",bc)),appChrome.api.dispatch(cb)),ve.label=kd);Kc.Ow(ve);Cc.Yu(Kc)}Hb.resultsUpdated(Cc)}Uuo(){return z.a.Moa()&&this.ic.pJo&&!this.ic.mga}}Object(l.a)(ag,"InsightsResultsProvider",null,[1247]);var Ek=c(1734);class ze{constructor(cb){this.ic=cb}cL(){return"Learning"}bU(){return 0===this.ic.gv?0:1===this.ic.gv?1:2}PH(cb,Hb,bc,Cc,Kc=null){bc=new n.a(cb);Kc&&!Array.contains(Kc,
21)||!z.a.dR(cb)||(Kc=[],Cc=this.ic.YZm,Kc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Cc)),Cc=ze.OYl(Cc),Kc.push(appChrome.actions.setControlLabel("LearningForSearch",Cc)),appChrome.api.dispatch(Kc),cb=new x.a("LearningForSearch",22,cb.Dg,null,1),Kc=new y.a(21),Kc.Ow(cb),bc.Yu(Kc));Hb.resultsUpdated(bc)}static OYl(cb){const Hb=[];Array.add(Hb,new Ek.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Hb,new Ek.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Hb,new Ek.a(600,cb));Array.add(Hb,new Ek.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));cb={};cb.parts=Hb;return JSON.stringify(cb)}}Object(l.a)(ze,"LearningProvider",null,[1247]);var Kf=c(599);class rj{constructor(cb,Hb){this.NWb=this.I_b=this.Xbb=this.ppd=null;this.vx=!1;this.wXb=cb;this.M0j=Hb;cb&&this.VYh(cb)}fne(){this.wXb.fne()&&this.VYh(this.wXb)}getSuggestions(cb){let Hb=[];var bc=[];cb=rj.Ein(cb);var Cc="";Array.clear(bc);for(let Kc=0;Kc<cb.length;Kc++){const kd=cb.charAt(Kc);
-1!==" ".indexOf(kd)?(Cc.length&&Array.add(bc,Cc),Cc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(kd)?(Cc.length&&Array.add(bc,Cc),Cc=kd,Array.add(bc,Cc),Cc=""):Cc+=kd}Cc.length&&Array.add(bc,Cc);for(cb=0;cb<bc.length;cb++)Cc=this.zRl(bc[cb]),Cc=this.L7k(Cc),Hb=rj.hdn(Hb,Cc);return Hb=this.Suk(Hb)}OEf(){this.vx||this.fne();return this.vx}cId(cb){return this.ppd[cb.toString()]}Suk(cb){for(let Hb=0;Hb<cb.length;Hb++){const bc=this.Xbb[Hb];if(cb[Hb].commandId!==this.cId(bc[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Cc;(Cc=cb[Hb]).score=Cc.score+bc[1]}return cb}L7k(cb){const Hb=[];for(var bc=0;bc<this.Xbb.length;bc++)Hb.push(new tg.a(this.cId(this.Xbb[bc][0]),-5));bc=new Kf.a;for(var Cc=0;Cc<cb.length;Cc++)bc.add(this.cId(cb[Cc][0]));for(Cc=0;Cc<Hb.length;Cc++){const kd=Hb[Cc];for(let Wd=0;Wd<cb.length;Wd++){var Kc=cb[Wd];const ve=this.cId(Kc[0]);Kc=Kc[1];if(ve===kd.commandId){kd.score=Kc;bc.remove(ve);break}}if(!bc.count)break}return Hb}zRl(cb){const Hb=1>cb.length;for(let Wd=0;2>=Wd;Wd++){const ve=this.NWb;
for(let Ie in ve){var bc=ve[Ie],Cc=cb,Kc=Ie;const yf=Kc.length+1,gc=Array((Cc.length+1)*yf);for(var kd=0;kd<=Cc.length;kd++)gc[kd*yf]=kd;for(kd=0;kd<=Kc.length;kd++)gc[kd]=kd;for(kd=0;kd<Kc.length;kd++)for(let ff=0;ff<Cc.length;ff++)gc[(ff+1)*yf+(kd+1)]=Cc.charAt(ff)===Kc.charAt(kd)?gc[ff*yf+kd]:Math.min(Math.min(gc[ff*yf+(kd+1)]+1,gc[(ff+1)*yf+kd]+1),gc[ff*yf+kd]+1);Cc=gc[Cc.length*yf+Kc.length];if((!Cc||!Hb)&&Cc<=Wd)return bc}}return this.I_b}VYh(cb){this.ppd=cb.dsf();this.Xbb=cb.j$l();this.I_b=
cb.qim();this.NWb=cb.q1l();if(this.vx=!!this.ppd&&!!this.Xbb&&!!this.NWb&&!!this.I_b)this.vx=0<this.Xbb.length&&rj.SBf(this.Xbb);this.vx&&(this.vx=0<this.I_b.length&&rj.SBf(this.I_b));this.vx&&(this.NWb=rj.gjm(this.NWb));this.vx||(this.NWb=this.I_b=this.Xbb=this.ppd=null)}uhm(cb){cb=this.getSuggestions(cb);return this.xCl(cb,this.M0j)}xCl(cb,Hb){let bc=[];for(let Cc=0;Cc<cb.length;Cc++)cb[Cc].score>=Hb&&bc.push(cb[Cc]);bc.sort((Cc,Kc)=>Cc.score<Kc.score?1:Cc.score>Kc.score?-1:0);0<bc.length-10&&(bc=
bc.slice(0,10));return bc}static hdn(cb,Hb){if(!cb.length)return Hb;if(cb.length!==Hb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let bc=0;bc<cb.length;bc++){if(cb[bc].commandId!==Hb[bc].commandId)throw Error.create("Incorrect CommandId");let Cc;(Cc=cb[bc]).score=Cc.score+Hb[bc].score}return cb}static Ein(cb){return ul.a.Ug(cb)}static SBf(cb){for(let Hb=0;Hb<cb.length;Hb++)if(2!==cb[Hb].length)return!1;return!0}static gjm(cb){const Hb=
{};for(let Kc in cb){var bc=Kc,Cc=cb[Kc];const kd=Cc;kd.length&&rj.SBf(kd)&&(Hb[bc]=Cc)}return Hb}}Object(l.a)(rj,"NaiveBayesClassifierModel",null,[]);class Ij{constructor(cb,Hb){this.tra=null;this.ic=cb;this.Bxc=new rj(Hb,cb.P4l);this.ic.Izb&&(this.tra=null)}cL(){return"NBCommand"}bU(){return 0===this.ic.gv?0:1===this.ic.gv?1:2}PH(cb,Hb,bc=!1,Cc=f.a.tellMe,Kc=null){const kd=new n.a(cb);if((!Kc||Array.contains(Kc,0))&&!z.a.dR(cb)){if(eg.CommandResultsUtility.nCf(cb.Dg)&&(Kc=eg.CommandResultsUtility.K6h(cb.Dg),
0<Kc.results.length)){Kc.displayName="Classifier Debug";kd.Yu(Kc);Hb.resultsUpdated(kd);return}if(!this.Bxc.OEf()){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.ic.Izb&&this.tra&&this.tra.initialize();Kc=this.Bxc.uhm(cb.Dg);eg.CommandResultsUtility.Y2d(Kc,!1,"Classifier","NaiveBayesian");Kc=eg.CommandResultsUtility.JPc(cb,Kc,this.ic,this.tra,
null,null,0,1);0<Kc.results.length&&Cc!==f.a.contextMenu&&(Kc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);bc||Kc.results.length||this.ic.U_||this.ic.a7a||(cb=new x.a("lookupNoResults",14,cb.Dg,null,1),Kc.Ow(cb));0<Kc.results.length&&kd.Yu(Kc)}Hb.resultsUpdated(kd)}}Object(l.a)(Ij,"NaiveBayesCommandProvider",null,[1247]);class ai{constructor(){this.Hvb=null;this.vx=!1;this.fne()}fne(){this.vx||(this.Hvb=window.NBCRM)&&4===this.Hvb.length&&(this.vx=!0);return this.vx}j$l(){return this.vx?
this.Hvb[1]:null}qim(){return this.vx?this.Hvb[2]:null}q1l(){return this.vx?this.Hvb[3][0]:null}dsf(){return this.vx?this.Hvb[0][0]:null}}Object(l.a)(ai,"NaiveBayesModelAdapter",null,[1268]);var gg=c(191);class ol{constructor(cb){this.ic=cb}cL(){return"OfficeScript"}bU(){return 0===this.ic.gv?0:1===this.ic.gv?1:2}PH(cb,Hb){const bc=new n.a(cb);if(!z.a.dR(cb)){cb=gg.d(cb.Dg);var Cc=new y.a(28);Cc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Cc=this.lph(cb,ol.mSo,"OfficeScriptsUnhideAllRowsCols",
"samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,Cc);Cc=this.lph(cb,ol.zJl,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Cc);bc.Yu(Cc)}Hb.resultsUpdated(bc)}lph(cb,Hb,bc,Cc,Kc,kd){const Wd=[];for(const ve of Hb)if(gg.a(cb,ve)){this.ic.$va?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(bc,Kc)),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(bc,Cc))):(Wd.push(appChrome.actions.setControlLabel(bc,
Kc)),Wd.push(appChrome.actions.setButtonCommandValueId(bc,Cc)),appChrome.api.dispatch(Wd));kd.Ow(new x.a(bc,28,null,null,1));break}return kd}}ol.mSo="unhide row rows col cols column columns".split(" ");ol.zJl=["freeze","selection","pane","panes"];Object(l.a)(ol,"OfficeScriptsSamplesProvider",null,[1247]);var oi=c(74),Hm=c(343),An=c(1567),vg=c(1530),sk=c(1566),Ti=c(35),Tf=c(140),dm=c(25);class je{constructor(cb){this.dQ=null;this.Z1=-1;this.QMf=14;this.SMf=12;this.attributes=this.HWe=this.query=null;
this.Ebc=!1;this.IYb=[];this.Xf=ce.AFrameworkApplication.Ne;ce.AFrameworkApplication.K&&(this.QMf=ce.AFrameworkApplication.K.mc("TellMeMaxTermedResults",this.QMf),this.SMf=ce.AFrameworkApplication.K.mc("TellMeMaxZeroTermResults",this.SMf));this.pR=cb}get ko(){return this.IYb}get Jne(){return this.HWe}Yu(cb){let Hb=!1;for(let bc=0;bc<this.ko.length;bc++)if(30!==this.ko[bc].groupType&&this.ko[bc].groupType===cb.groupType){this.ZZe(this.ko[bc],cb);Hb=!0;break}Hb||this.ko.push(cb)}ZZe(cb,Hb){for(let bc=
0;bc<Hb.results.length;bc++)cb.Ow(Hb.results[bc])}Maj(cb){const Hb=[];for(const bc of this.ko)bc.groupType!==cb&&Hb.push(bc);this.ko.length!==Hb.length&&(this.IYb=Hb)}u0n(cb){let Hb=null,bc=null,Cc=null;for(let Kc=0;Kc<cb.length;Kc++){const kd=cb[Kc];if(kd&&kd.ko&&kd.ko.length)for(const Wd of kd.ko)if(17===Wd.groupType||18===Wd.groupType)Hb=Wd;else if(0===Wd.groupType||16===Wd.groupType)bc=Wd,Cc=kd}Hb&&bc&&0<bc.results.length&&(17===Hb.groupType&&({uZe:bc,m_e:Hb}=eg.CommandResultsUtility.vtk(bc,Hb,
this.pR.BO()?this.pR.BO().UQl:-.6)),Cc.Maj(bc.groupType))}TAo(){this.pR&&(new oi.a,this.k9c(this.pR.FMi))}kWc(cb,Hb){return this.query.Dg.length>this.pR.BO().U$l&&this.XQm(cb,Hb)||this.query.Dg.length>this.pR.BO().V$l&&this.MTm(cb,Hb)?!0:!1}MTm(cb,Hb){return cb&&cb.length&&Hb&&Hb.length?-1===Hb.toLowerCase().indexOf(cb.toLowerCase())?!1:!0:!1}XQm(cb,Hb){return cb&&cb.length&&Hb&&Hb.length?Hb.toLowerCase().startsWith(cb.toLowerCase()):!1}KCl(cb){const Hb=[];for(const bc of this.pR.BO().rP?this.Jne:
this.ko)cb.contains(bc.groupType)||Hb.push(bc);this.pR.BO().rP?this.HWe=Hb:this.IYb=Hb}zZo(cb,Hb){const bc=[];for(const Cc of this.ko){const Kc=Cc;if(13!==Kc.groupType||24!==Kc.groupType){const kd=cb[vg.a[Kc.groupType].toLowerCase()];let Wd="False";kd<Hb&&(Wd="True");Kc.displayName=Kc.displayName+" ("+Wd+": "+kd+")"}bc.push(Kc)}this.IYb=bc}k9c(cb,Hb=!1,bc=null){if(this.pR.BO().rP){if(!Hb)for(this.HWe=Array(this.ko.length),Hb=0;Hb<this.ko.length;Hb++)this.Jne[Hb]=this.ko[Hb];this.pR.LMi.k9c(this.ko,
this.Jne,this.query,cb,bc)}else{for(bc=new oi.a;this.ko.length;){Hb=this.ko.pop();const Cc=vg.a[Hb.groupType].toLowerCase(),Kc=cb[Cc];if(dm.c(Kc))throw Error.create("GroupId "+Cc+" missed from group SortingOrder");bc.add(new Hm.a(Kc,Hb))}bc.Sc((Cc,Kc)=>Cc.key<Kc.key?-1:1);for(cb=0;cb<bc.count;cb++)Hb=bc.J(cb).value,this.ko.push(Hb)}}UAo(){var cb=!1;let Hb=!1,bc=!1;for(let Kc=0;Kc<this.ko.length;Kc++){var Cc=this.ko[Kc];const kd=Cc.groupType;if(8===kd||15===kd||14===kd){Cc=Cc.results;for(let Wd=0;Wd<
Cc.length;Wd++){if(8===kd&&this.kWc(this.query.Dg,Cc[Wd].label)){cb=!0;break}if(15===kd&&this.kWc(this.query.Dg,Cc[Wd].label)){Hb=!0;break}if(14===kd){if(this.kWc(this.query.Dg,Cc[Wd].label)||this.kWc(this.query.Dg,Cc[Wd].description)){bc=!0;break}const ve=Cc[Wd].label.split(" ");for(const Ie of ve)if(this.kWc(this.query.Dg,Ie)){bc=!0;break}}}}}cb=this.pR.Kbm(cb,Hb,bc);this.k9c(cb)}$Kb(cb,Hb,bc,Cc,Kc,kd){if(Kc===this.dQ){var Wd=cb.data.ve;Kc=null;try{Kc=Ti.b(Wd)}catch(Jj){u.TellMeActor.instance.Oe.onError("OnSuccessCallBack",
"Exception occured while deserializing ranker inference response:"+Jj);return}if("RankerResults"in Kc&&Kc.RankerResults){this.QCa();var ve=Kc.RankerResults,Ie=new oi.a,yf=new oi.a;Wd=0;for(var gc of ve){ve=gc.ProviderId;var ff=gc.Score;Wd+=ff;Ie.add(new Hm.a(ve,ff))}Ie.Sc((Yd,ih)=>Yd.value>ih.value?-1:1);ff=kd?kd.Hgi:1E-6;gc={};ve={};let Jj=0;for(var Gk=0;Gk<Ie.count;Gk++){let Yd=parseInt(Ie.J(Gk).key),ih=Ie.J(Gk).value/Wd;1===Yd&&(ve.answer=Jj++,ve.entity=Jj++,ve.definition=Jj++,ve.wolframanswer=
Jj++,ih<ff&&(yf.add(9),yf.add(11),yf.add(10),yf.add(12)),gc.answer=ih,gc.entity=ih,gc.definition=ih,gc.wolframanswer=ih);2===Yd&&(ve.assistance=Jj++,ih<ff&&yf.add(8),gc.assistance=ih);3===Yd&&(ve.classifier=Jj++,ve.serviceclassifier=Jj++,ih<ff&&(yf.add(0),yf.add(17)),gc.classifier=ih,gc.serviceclassifier=ih);4===Yd&&(ve.people=Jj++,ih<ff&&yf.add(14),gc.people=ih);5===Yd&&(ve.document=Jj++,ih<ff&&yf.add(15),gc.document=ih);6===Yd&&(ve.findindocument=Jj++,ih<ff&&yf.add(2),gc.findindocument=ih);7===
Yd&&(ve.notes=Jj++,ih<ff&&yf.add(20),gc.notes=ih);8===Yd&&(ve.image=Jj++,ih<ff&&yf.add(19),gc.image=ih)}Ie=new oi.a;Ie.add("classifier");Ie.add("serviceclassifier");Ie.add("appsforoffice");Ie.add("addin");Ie.add("findindocument");Ie.add("assistance");Ie.add("document");Ie.add("people");Ie.add("answer");Ie.add("wolframanswer");Ie.add("definition");Ie.add("entity");Ie.add("image");Ie.add("template");Ie.add("officescript");for(Gk=0;Gk<Ie.count;Gk++)Ie.J(Gk)in ve||(ve[Ie.J(Gk)]=Jj++);ve.learning=Jj++;
ve.insights=Jj++;ve.actionai=Jj++;ve.actionaicommand=Jj++;ve.feedback=Jj++;kd&&kd.Gzi&&this.zZo(gc,ff);kd&&kd.Hzi&&this.KCl(yf);yf={};for(var Sh in gc)yf[Sh]=gc[Sh]*Wd;this.k9c(ve,!0,yf)}if(kd.N_d&&"Intents"in Kc&&Kc.Intents){Sh=Kc.Intents;for(var jm of Sh)if(this.qHf(jm)&&"Serplet"===jm.GroupType&&jm.ConfidenceScore>jm.ConfidenceThreshold){Sh=!1;Kc=0;if(kd.O_d){Wd=new x.a("",32);for(yf=0;yf<this.ko.length;yf++)if((Ie=this.ko[yf].results)&&0<Ie.length){Kc=yf;Wd=Ie[0];break}2===Wd.groupType&&(Sh=!0)}Wd=
new y.a(13);Sh&&kd.O_d&&(Wd=new y.a(13,CommonUIStrings.l_TellMeWebTitle));yf=new x.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Dg,null,0);Ie=[];gc=null;gc=z.a.Moa()?z.a.RNa(this.query.Dg,1):z.a.IBb(this.query.Dg);Ie.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",gc));gc=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Dg);Ie.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",gc));appChrome.api.dispatch(Ie);
Wd.Ow(yf);yf=[];if(Sh&&kd.O_d)for(yf.push(this.ko[Kc]),yf.push(Wd),Sh=Kc+1;Sh<this.ko.length;Sh++)(Kc=this.ko[Sh].results)&&0<Kc.length&&yf.push(this.ko[Sh]);else for(yf.push(Wd),Sh=0;Sh<this.ko.length;Sh++)(Kc=this.ko[Sh].results)&&0<Kc.length&&yf.push(this.ko[Sh]);this.IYb=yf}}if(kd.vWc&&!kd.rP){jm=Sh=-1;for(Kc=0;Kc<this.ko.length;Kc++)switch(this.ko[Kc].groupType){case 23:Sh=Kc;break;case 0:case 17:case 2:-1===jm&&(jm=Kc)}if(-1!==Sh){jm=-1===jm?0:Sh>jm?jm+1:jm;Sh=this.ko[Sh];Kc=Array(this.ko.length);
Wd=0;for(yf=0;yf<Kc.length;yf++)yf===jm?Kc[yf]=Sh:(23===this.ko[Wd].groupType&&Wd++,Kc[yf]=this.ko[Wd],Wd++);this.IYb=Kc}}Cc.resultsUpdated(this);Cc=u.TellMeActor.instance.Oe;Cc.y0(Hb.length,"RankerInference",cb.data.Qe.toString(),Math.round(window.performance.now()-bc),sk.a.Nyj,!0,An.a.IPa);this.Ebc&&Cc&&(cb=this.query.snb,Hb=Cc.dhd,kd.d0d&&cb>Hb&&!kd.rP&&(Cc.eLf(this.query.Dg),Cc.Cag(cb)))}}qHf(cb){if("GroupType"in cb&&cb.GroupType&&"ConfidenceScore"in cb&&"ConfidenceThreshold"in cb)return!0;u.TellMeActor.instance.Oe.onError("IsValidIntentGroup",
"Invalid intents found");return!1}GKb(cb,Hb,bc,Cc,Kc){Cc===this.dQ&&(this.QCa(),u.TellMeActor.instance.Oe.y0(Hb.length,"RankerInference",cb.data.Qe.toString(),Math.round(window.performance.now()-bc),sk.a.Nyj,!1,An.a.IPa));Kc.resultsUpdated(this)}QCa(){-1!==this.Z1&&(window.clearTimeout(this.Z1),this.Z1=-1)}VAo(cb){let Hb;Hb=this.pR.BO().rP?u.TellMeActor.instance.Oe.Huf(this.Jne,this.query.Dg):u.TellMeActor.instance.Oe.Huf(this.ko,this.query.Dg);var bc=this.pR.BO().Ggi;""!==bc&&(bc="_"+bc);let Cc=
"";this.pR.BO().VZd&&(Cc="RankerInference"+bc+",");this.pR.BO().N_d&&(Cc+="SerpletClassifier");","===Cc.charAt(Cc.length-1)&&(Cc=Cc.substring(0,Cc.length-1));bc=u.TellMeActor.instance.Oe.uii(Cc);const Kc=this.dQ=Tf.a.create().toString();bc["Client-Request-Id"]=Kc;const kd=window.performance.now(),Wd=this.pR.BO()?this.pR.BO().Igi:600;this.QCa();this.Z1=window.setTimeout(()=>{if(Kc===this.dQ){this.dQ="";this.Z1=-1;cb.resultsUpdated(this);const ve={};ve[a.a.provider]="Ranker";ve[a.a.rMb]=this.query.snb;
u.TellMeActor.instance.Oe.MA(k.a.timedOut,Wd,ve)}},Wd);this.Xf.xj(u.TellMeActor.instance.Oe.vii(),2,Hb,bc,!1,0,ve=>{this.$Kb(ve,this.query.Dg,kd,cb,Kc,this.pR.BO())},ve=>{this.GKb(ve,this.query.Dg,kd,Kc,cb)},null,null,!1,4E3,6E3)}LOo(){var cb=0,Hb=new oi.a,bc=this.pR.DMi,Cc=this.pR.EMi;for(var Kc=0;Kc<this.ko.length;Kc++){var kd=this.ko[Kc],Wd=vg.a[kd.groupType].toLowerCase(),ve=bc[Wd];cb+=kd.results.length;kd.results.length>ve&&(Wd=Cc[Wd],dm.c(Wd)||Hb.add(new Hm.a(Wd,kd)))}Cc=!this.query||""===this.query.Dg.trim();
Kc=cb-(Cc?this.SMf:this.QMf);if(!(0>=Kc)){Cc=window.performance.now();cb=cb.toString()+" total,"+Kc.toString()+" to remove.";if(0<Hb.count)for(Hb.Sc((Ie,yf)=>Ie.key>yf.key?-1:1),kd=0;kd<Hb.count&&0<Kc;kd++){Wd=Hb.J(kd).value;ve=vg.a[Wd.groupType].toLowerCase();let Ie=Wd.results.length-bc[ve];Ie>Kc&&(Ie=Kc);0<Ie&&(Wd.J5f(Ie),cb+=ve+": "+Ie.toString()+" results removed.",Kc-=Ie)}if(0<Kc){cb+=Kc.toString()+" results left after trimming.";Hb=new oi.a;bc=this.pR.IMi;for(kd=0;kd<this.ko.length;kd++)Wd=
this.ko[kd],ve=bc[vg.a[Wd.groupType].toLowerCase()],dm.c(ve)||Hb.add(new Hm.a(ve,Wd));Hb.Sc((Ie,yf)=>Ie.key<yf.key?-1:1);for(bc=0;0<Kc;)kd=Hb.J(bc++).value,Kc>=kd.results.length?(Array.remove(this.ko,kd),cb+=vg.a[kd.groupType]+": "+kd.results.length.toString()+" results force removed.",Kc-=kd.results.length):(kd.J5f(Kc),cb+=vg.a[kd.groupType]+": "+Kc.toString()+" results force removed.",Kc=0)}u.TellMeActor.instance.Oe&&(Hb={},Hb[a.a.message]=cb,u.TellMeActor.instance.Oe.MA("ShowOptimal",window.performance.now()-
Cc,Hb))}}}Object(l.a)(je,"CombineResultsUpdatedEventArgs",null,[1229]);class Xi{constructor(cb,Hb,bc,Cc=!1,Kc=""){this.RNe=this.uQe=!1;this.sv=cb;this.oxb=[];this.Xbh=Hb.length;this.ic=u.TellMeActor.instance.BO();this.rnd=Cc;this.hfa=Kc;this.a_b={};for(cb=0;cb<Hb.length;++cb)this.a_b[cb.toString()]=bc?0:Hb[cb].bU()}wno(cb,Hb){Hb&&Hb.query&&Hb.query.snb<u.TellMeActor.instance.Xsa||(this.oxb[cb]=Hb,this.RNe?this.uQe=!0:(!this.ic||3!==this.ic.gv||3!==this.a_b[cb.toString()]||this.iSh())&&this.EXd())}GCn(){this.RNe=
!0}DSo(){this.RNe=!1;this.uQe&&(this.uQe=!1,this.EXd())}iSh(){if(this.oxb.length<this.Xbh)return!1;for(let cb=0;cb<this.Xbh;++cb)if(!this.oxb[cb])return!1;return!0}EXd(){var cb=this.iSh();const Hb=window.performance.now(),bc=new je(u.TellMeActor.instance.KXg);bc.u0n(this.oxb);for(var Cc=0;Cc<this.oxb.length;++Cc){var Kc=this.oxb[Cc];if(Kc&&Kc.ko&&Kc.ko.length&&(bc.query=Kc.query,Kc.attributes&&0<Kc.attributes.length&&(bc.attributes=Kc.attributes),Kc&&Kc.ko&&(cb||this.zXk(Cc,this.oxb))))for(const kd of Kc.ko)bc.Yu(kd)}bc.ko&&
bc.ko.length&&(bc.Ebc=cb,this.ic&&this.ic.Pme&&bc.LOo(),this.ic&&this.ic.nSm&&bc.query.Dg&&0<bc.query.Dg.length?bc.UAo():bc.TAo(),this.ic&&(this.ic.VZd||this.ic.N_d)&&this.rnd&&bc.query.Dg&&0<bc.query.Dg.length&&bc.Ebc&&this.hfa!==f.a.contextMenu?(3===this.ic.gv&&cb||this.sv.resultsUpdated(bc),bc.VAo(this.sv)):this.sv.resultsUpdated(bc),cb=u.TellMeActor.instance.Oe,bc.Ebc&&cb&&(Cc=bc.query.snb,Kc=cb.dhd,bc.query.Dg&&0<bc.query.Dg.length&&this.rnd&&this.ic.d0d&&this.hfa!==f.a.contextMenu&&Cc>Kc&&!this.ic.VZd&&
!this.ic.rP&&(cb.eLf(bc.query.Dg),cb.Cag(Cc)),cb.MA(k.a.F8n,window.performance.now()-Hb)))}zXk(cb,Hb){if(!(this.a_b&&cb.toString()in this.a_b)||Hb.length<=cb||!Hb[cb])return!1;if(!Hb[cb].ko.length)return!0;const bc=this.a_b[cb.toString()];if(0===bc)return!0;const Cc=this.a_b;for(let kd in Cc){var Kc=Cc[kd];const Wd=Number.parseInvariant(kd);if(Wd!==cb&&Kc===bc&&!(Hb.length>Wd&&Hb[Wd]))return!1}return!0}}Object(l.a)(Xi,"ResultsAggregator",null,[]);var Fk=c(1770);class wg{constructor(){this.Nlc=this.Olc=
this.Mlc=this.logCount=this.logRank=this.invertedRank=0}dtk(cb,Hb){switch(cb){case 1:this.invertedRank=Hb;break;case 3:this.logRank=Hb;break;case 2:this.logCount=Hb;break;case 5:this.Mlc=Hb;break;case 4:this.Olc=Hb;break;case 6:this.Nlc=Hb}}}Object(l.a)(wg,"CommandFeatures",null,[]);class bg{constructor(cb){this.cVg=0;this.TAa=cb;this.a_j={}}get modelId(){return this.TAa}get featureIntercept(){return this.cVg}get $Gc(){return this.a_j}bsk(cb,Hb,bc){0===Hb?this.cVg=bc:(this.$Gc[cb]||(this.$Gc[cb]=
new wg),this.$Gc[cb].dtk(Hb,bc))}}Object(l.a)(bg,"CoefficientsModel",null,[]);const vh=(cb,Hb)=>Math.pow(10,-Hb/(60*Math.LN10/Math.LN2*cb));class Ej{constructor(cb,Hb){this.fj=1;this.bjd=new wg;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=cb?1/cb:0;this.features.logRank=2/Math.pow(2,cb);this.features.Mlc=vh(10,Hb);this.features.Olc=vh(2,Hb);this.features.Nlc=vh(1,Hb)}get count(){return this.fj}get features(){return this.bjd}wqi(){this.fj=this.count+1;this.features.logCount=
1+Math.log(this.count)/Math.LN2}nZo(cb){const Hb=2/Math.pow(2,cb);this.features.invertedRank=Math.max(this.features.invertedRank,cb?1/cb:0);this.features.logRank=Math.max(this.features.logRank,Hb)}K_o(cb){const Hb=vh(10,cb),bc=vh(2,cb);cb=vh(1,cb);this.features.Mlc=Math.max(this.features.Mlc,Hb);this.features.Olc=Math.max(this.features.Olc,bc);this.features.Nlc=Math.max(this.features.Nlc,cb)}}Object(l.a)(Ej,"CommandModel",null,[]);class im{constructor(cb){this.oqc=null;if(!cb&&u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("PredictionEngine",
"IModelAdapter can't be null");this.wXb=cb;this.opd=this.eKf()}eKf(){const cb=this.wXb.l4l(),Hb=this.wXb.dsf();if(void 0===cb||null===cb||void 0===Hb||null===Hb)return!1;try{window.performance.now();this.oqc={};for(let bc=0;bc<cb.length;bc++){const Cc=cb[bc],Kc=Hb[Cc[0].toString()].trim(),kd=Cc[1],Wd=0!==kd?Hb[Cc[2].toString()].trim():"",ve=Cc[3];Kc in this.oqc||(this.oqc[Kc]=new bg(Kc));this.oqc[Kc].bsk(Wd,kd,ve)}}catch(bc){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("LoadModelData",
"Error Loading Suggestions Model: "+bc);return!1}return!0}xKl(){const cb=this.wXb.H0l(),Hb={};if(!cb)return Hb;let bc=1;for(let Cc=0;Cc<cb.length;Cc++){const Kc=cb[Cc];Kc.Id in Hb?(Hb[Kc.Id].wqi(),Hb[Kc.Id].nZo(bc),Hb[Kc.Id].K_o(Kc.TimeElapsedSinceClick)):Hb[Kc.Id]=new Ej(bc,Kc.TimeElapsedSinceClick);bc++}return Hb}OEf(){this.opd||(this.opd=this.eKf());return this.opd}C9l(){let cb=[];if(!this.opd){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("GetPredictedCommands","IModelAdapter returned no data");
return cb}const Hb=this.xKl(),bc=this.oqc;for(let Kc in bc){const kd=bc[Kc],Wd=kd.modelId;let ve=0;for(let Ie in Hb){var Cc=Ie;const yf=Hb[Ie].features;(Cc=Cc in kd.$Gc?kd.$Gc[Cc]:null)&&(ve+=yf.invertedRank*Cc.invertedRank+yf.logRank*Cc.logRank+yf.logCount*Cc.logCount+yf.Mlc*Cc.Mlc+yf.Olc*Cc.Olc+yf.Nlc*Cc.Nlc)}ve+=kd.featureIntercept;cb.push(new tg.a(Wd,ve))}cb.sort((Kc,kd)=>Kc.score<kd.score?1:Kc.score>kd.score?-1:0);0<cb.length-10&&(cb=cb.slice(0,10));return cb}}Object(l.a)(im,"PredictionEngine",
null,[]);class Nd{constructor(){this.Zeh={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}FOd(cb,
Hb){return Hb&&"word"===Hb.application.toLowerCase()&&cb in this.Zeh?this.Zeh[cb]:[]}}Object(l.a)(Nd,"SuggestionResultsUtility",null,[]);class Qn{constructor(cb,Hb,bc){this.ic=Hb;this.Bxc=new im(cb);this.E2=bc;this.Phh=new Nd}cL(){return"Suggestion"}bU(){return 0===this.ic.gv?0:1===this.ic.gv?1:2}PH(cb,Hb,bc,Cc=f.a.tellMe,Kc=null){bc=new n.a(cb);u.TellMeActor.instance.Qbd=!1;if((!Kc||Array.contains(Kc,16))&&z.a.dR(cb)){if(!this.Bxc.OEf()){if(u.TellMeActor.instance.Oe)u.TellMeActor.instance.Oe.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.H_d()&&0<this.Phh.FOd(u.TellMeActor.instance.OHd,this.ic).length){const Wd=this.Phh.FOd(u.TellMeActor.instance.OHd,this.ic);Kc=[];for(var kd of Wd)this.ic.Die&&"Find"===kd||Kc.push(new tg.a(kd,0));u.TellMeActor.instance.Qbd=!0}else Kc=this.Bxc.C9l();eg.CommandResultsUtility.Y2d(Kc,!0,"Recommended","LRE");kd=[];for(const Wd of Kc)this.E2&&this.E2.T9e(Wd.commandId)||
kd.push(Wd);cb=eg.CommandResultsUtility.JPc(cb,kd,this.ic,null,null,null,16,1);0<cb.results.length&&Cc!==f.a.contextMenu&&(cb.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<cb.results.length&&bc.Yu(cb)}Hb.resultsUpdated(bc)}H_d(){return!!this.ic&&(this.ic.H_d||this.ic.BWm)}}Object(l.a)(Qn,"SuggestionResultsProvider",null,[1247]);class Cd{H0l(){return u.TellMeActor.instance.iwe}l4l(){return window.TellMeSuggestionModel}dsf(){return window.CoefficientModelIdMap}}Object(l.a)(Cd,"SuggestionsModelAdapter",
null,[1267]);var pl=c(1785),Xf=c(1737);c.d(K,"AggregatorResultsProvider",function(){return yg});class yg{constructor(cb=!1){this.wYb={};this.wYb[f.a.tellMe]=[];this.wYb[f.a.contextMenu]=[];this.rnd=cb}vEi(cb,Hb,bc,Cc,Kc=null){let kd;var Wd=!1;switch(Cc){case f.a.contextMenu:kd=this.wYb[f.a.contextMenu];Wd=!0;break;default:kd=this.wYb[f.a.tellMe]}Hb=new Xi(Hb,kd,Wd,this.rnd,Cc);Hb.GCn();for(let ve=0;ve<kd.length;++ve){const Ie=window.performance.now(),yf=new H(Hb,ve);(Wd=u.TellMeActor.instance.BO())&&
Wd.SMk?window.setTimeout(()=>{kd[ve].PH(cb,yf,bc,Cc,Kc);if(u.TellMeActor.instance.Oe){const gc={};gc[a.a.provider]=kd[ve].cL();gc[a.a.rMb]=cb.snb;u.TellMeActor.instance.Oe.MA(k.a.PH,window.performance.now()-Ie,gc)}},0):(kd[ve].PH(cb,yf,bc,Cc,Kc),u.TellMeActor.instance.Oe&&(Wd={},Wd[a.a.provider]=kd[ve].cL(),Wd[a.a.rMb]=cb.snb,u.TellMeActor.instance.Oe.MA(k.a.PH,window.performance.now()-Ie,Wd)))}Hb.DSo()}cL(){return"Aggregator"}bU(){return 0}PH(cb,Hb,bc=!1,Cc=f.a.tellMe,Kc=null){if(u.TellMeActor.instance.afn)this.vEi(cb,
Hb,bc,Cc,Kc);else{const kd=window.performance.now();u.TellMeActor.instance.m4o.then(()=>{u.TellMeActor.instance.Oe&&u.TellMeActor.instance.Oe.MA(k.a.bfn,window.performance.now()-kd);this.vEi(cb,Hb,bc,Cc,Kc);return!0})}}JE(cb,Hb){this.wYb[Hb].push(cb)}Ttk(cb){switch(cb){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Hb=this.wYb[f.a.tellMe];for(const bc of Hb)if("FindInDocument"===bc.cL()){bc.Hlo(cb);break}}}static createInstance(cb,Hb,bc,Cc){const Kc=
Hb.mga;var kd=Cc&&z.a.ndg(Hb),Wd=kd&&Hb.WWf&&!Kc;const ve=Hb.YGf&&!z.a.Ybc()&&!Kc,Ie=Hb.bFf&&!Kc,yf=new yg(kd);if(Hb.Vuo&&!Kc){var gc=new ze(Hb);yf.JE(gc,f.a.tellMe)}gc=Hb.yr?ce.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):ce.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const ff=!gc&&ce.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");yf.JE(new gk.a(cb,Hb.HQo,ff,!1),f.a.tellMe);gc&&!Kc&&yf.JE(new Qn(new Cd,Hb,cb),f.a.tellMe);cb=ce.AFrameworkApplication.ta.Nb.cDi?
new Ij(Hb,new ai):new jd(Hb,bc);yf.JE(cb,f.a.contextMenu);(kd&&Hb.XWf||Wd)&&yf.JE(pl.a.JNh(Hb,!0),f.a.tellMe);yf.JE(cb,f.a.tellMe);!Hb.D_h||Kc||"Word"===Hb.application&&Hb.nMd||yf.JE(new th(Hb),f.a.tellMe);Hb.Izb&&!Kc&&(Wd=new L(Hb),yf.JE(Wd,f.a.tellMe),yf.JE(Wd,f.a.contextMenu));!Hb.Nzb||Hb.o8c||Hb.n8c||Kc||yf.JE(new I.a(Hb),f.a.tellMe);Cc&&(Hb.U_||z.a.Moa())&&(Wd=new ag(Hb),yf.JE(Wd,f.a.tellMe),yf.JE(Wd,f.a.contextMenu));kd&&yf.JE(pl.a.JNh(Hb,!1),f.a.tellMe);Cc&&!Hb.lhg&&z.a.mdg(Hb)&&!Kc&&(yf.JE(new Fk.a(Hb),
f.a.tellMe),Hb.cxj&&yf.JE(new Fk.a(Hb),f.a.contextMenu));ve&&yf.JE(new Ch(Hb),f.a.tellMe);!Hb.Sjc&&!Hb.rP||Kc||yf.JE(new fg.a(Hb),f.a.tellMe);Hb.vWc&&!Kc&&yf.JE(new Xf.a(Hb),f.a.tellMe);Hb.KBf&&(kd=new E(Hb),yf.JE(kd,f.a.tellMe),yf.JE(kd,f.a.contextMenu));Cc&&Hb.RXd&&!Kc&&yf.JE(new G.AddinResultsProvider(Hb),f.a.tellMe);Ie&&"Excel"===Hb.application&&!Kc&&yf.JE(new ol(Hb),f.a.tellMe);return yf}}Object(l.a)(yg,"AggregatorResultsProvider",null,[1247])},1763:function(F,K,c){F=c(0);var l=c(16),f=c(6),
a=c(165),k=c(221),x=c(364),y=c(58),n=c(67),u=c(939),z=c(858),w=c(530);c(463);var E=c(1727),G=c(1728),H=c(1724),L=c(1726),I=c(1725),N=c(938),Q=c(857);class M{constructor(qa,Ia,Va){this.QJl=qa;this.jKk=Ia;this.CVk=Va}}Object(F.a)(M,"BacktraceAndMakeUpdateHintsInput",null,[]);var J=c(1548),V;(function(qa){qa[qa.EOP=0]="EOP";qa[qa.character=1]="character";qa[qa.embeddedMarker=2]="embeddedMarker"})(V||(V={}));Object(F.b)("LCSBlockType",V);class X{toString(){return String.format("[Type: {0}]",V[this.type])}}
Object(F.a)(X,"ALCSBlock",null,[]);class W extends X{constructor(qa,Ia){super();this.sve=Ia;this.BNe=qa}get type(){return 1}get character(){return this.sve}get Rv(){return this.BNe}GA(qa){return 1===qa.type&&J.a.Wuh(qa.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(F.a)(W,"CharacterLCSBlock",X,[]);class U extends X{constructor(qa,Ia,Va){super();this.BNe=qa;this.aYe=Ia;this.Fwc=Va}get type(){return 0}get Lc(){return this.aYe}get length(){return this.Fwc}get Rv(){return this.BNe}GA(qa){return 0!==
qa.type?!1:qa.Rv===this.Rv&&qa.Lc===this.Lc}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),this.Rv.toString(),this.Lc,this.length)}}Object(F.a)(U,"EOPLCSBlock",X,[]);class Y extends W{constructor(qa,Ia,Va){super(qa,"\ufffc");this.kbk=Ia;this.Ojd=Va}get type(){return 2}get zg(){return this.kbk}get Wj(){return this.Ojd}GA(qa){return 2!==qa.type?!1:qa.zg===this.zg&&this.Wj.equals(qa.Wj)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),
this.zg,this.Wj)}}Object(F.a)(Y,"EmbeddedMarkerLCSBlock",W,[]);class ba{constructor(qa,Ia){this.x=qa;this.y=Ia}equals(qa){return qa.x===this.x&&qa.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(F.a)(ba,"IntPair",null,[895]);var aa=c(1589),fa=c(1570),na=c(1590),oa=c(1723);c.d(K,"a",function(){return ja});class ja{constructor(qa,Ia){this.Ng=qa;this.Zd=Ia}UNh(qa,Ia,Va,Na,za,la,va){return this.Mfl(qa,Ia,Va,Na,za,la,va)}Mfl(qa,Ia,Va,Na,za,la,va){let ia;ia=null;({returnValue:qa}=this.zQd(qa,
Ia));if(!qa)return a.a.instance.Ta(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.Zd.logger.AU("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ia};({returnValue:Va}=this.zQd(Va,Na));if(!Va)return a.a.instance.Ta(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.Zd.logger.AU("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ia};this.Zd.logger.AU("GetLCSBlocksFromObject");ia=this.Lfl(qa,Va,za,la,va);return ia?{returnValue:!0,updateHints:ia}:(a.a.instance.Ta(575706451,
1,2,"Failed to Create UpdateHints"),{returnValue:!1,updateHints:ia})}s_h(qa,Ia,Va,Na){({returnValue:qa}=this.zQd(qa,Ia));if(!qa)return-1;({returnValue:Va}=this.zQd(Va,Na));if(!Va)return-1;({cdf:Va}=this.w_h(qa,Va));return Va}zQd(qa,Ia){let Va;const Na=new k.a;Va=new k.a;if(!qa.length)return a.a.instance.Ta(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.Zd.logger.Og(Object.assign(new aa.a,{rj:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,Mif:Va};for(let va=0;va<
qa.length;va++)if(this.Zd.runtime.SG("GetLCSBlocksFromObject: paraObjs#"+va),393230===qa.J(va).Rc){const ia=this.Ng.getPropertyString(qa.J(va),l.a.lo),pa=this.Ng.getPropertyUint32(qa.J(va),f.a.Lc);if(null==pa)return a.a.instance.Ta(594124835,1,2,"Abandoning LCS due to missing WordId"),this.Zd.logger.Og(Object.assign(new aa.a,{rj:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,Mif:Va};let sa=this.Ng.getPropertyUint32s(qa.J(va),l.a.zm);sa=fa.a.qnj(sa,ia.length);const Ha=this.Ng.getPropertyObjectIds(qa.J(va),
l.a.Gn);let ra;for(ra=0;ra<sa.length-1;ra++){var za=Ia(Ha.$f(ra)),la=void 0;la=za?(la=this.Ng.getPropertyBool(za,l.a.g$))?la:!1:!1;if(la)Na.add(this.ial(qa.J(va).id,za));else for(za=sa.$f(ra);za<sa.$f(ra+1);za++)Na.add(new W(qa.J(va).id,J.a.charAt(ia,za)))}Na.add(new U(qa.J(va).id,pa,sa.J(ra)));Va.add(Na.length-1)}else return a.a.instance.Ta(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",qa.J(va).Rc),this.Zd.logger.Og(Object.assign(new aa.a,{rj:"GetLCSBlocksFromObject",
eventId:"900ba"})),{returnValue:null,Mif:Va};this.Zd.runtime.SG("LCS: GetLCSBlocks for base");return{returnValue:Na,Mif:Va}}ial(qa,Ia){const Va=null==this.Ng.getPropertyInt32(Ia,f.a.jt)?0:this.Ng.getPropertyInt32(Ia,f.a.jt);return new Y(qa,Va,Ia.id)}Lfl(qa,Ia,Va,Na,za){Na=({cdf:Va}=this.w_h(qa,Ia,Va,Na,za)).returnValue;this.Zd.logger.AU("FindFurthestPaths");qa=new M(Na,qa,Ia);qa=new oa.a(this.ZJk(qa,Va),1);this.Zd.logger.AU("BacktraceAndMakeUpdateHints");return qa}w_h(qa,Ia,Va=-1,Na=-1,za=-1){let la;
if(-1===Va||-1===Na||-1===za)za=Na=Va=-1;la=-1;const va=new x.a;va.Z(new ba(-1,1),new ba(0,-1));if(-1!==Va){va.Z(new ba(0,0),new ba(Va,Va));var ia=1}else ia=0,Na=qa.length,za=Ia.length;for(Va=0;ia<=qa.length+Ia.length;ia++){let pa=!1;for(let sa=-ia;sa<=ia;sa+=2){let Ha,ra;sa===-ia?(Ha=va.J(new ba(ia-1,sa+1)).x,ra=va.J(new ba(ia-1,sa+1)).y+1):sa===ia?(Ha=va.J(new ba(ia-1,sa-1)).x+1,ra=va.J(new ba(ia-1,sa-1)).y):va.J(new ba(ia-1,sa-1)).x>=va.J(new ba(ia-1,sa+1)).x?(Ha=va.J(new ba(ia-1,sa-1)).x+1,ra=
va.J(new ba(ia-1,sa-1)).y):(Ha=va.J(new ba(ia-1,sa+1)).x,ra=va.J(new ba(ia-1,sa+1)).y+1);for(;Ha<Na&&ra<za&&qa.J(Ha).GA(Ia.J(ra));)Ha++,ra++;va.Z(new ba(ia,sa),new ba(Ha,ra));if(Ha===Na&&ra===za){pa=!0;la=ia;Va=sa;break}}if(pa)break;this.Zd.runtime.SG("LCS FindFurthestPaths")}if(Va!==Na-za)return{returnValue:null,cdf:la};va.Z(new ba(la,Va),new ba(Na+1,za+1));a.a.instance.Ta(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",qa.length,Ia.length,
la);return{returnValue:va,cdf:la}}ZJk(qa,Ia){const Va=qa.QJl,Na=qa.jKk;qa=qa.CVk;const za=new k.a;let la=Na.length,va=qa.length;for(;0<la||0<va;){var ia=la-1,pa=va-1;if(this.FCn(Va,Ia,la,va)){ia=qa.J(pa);if(1===ia.type||2===ia.type)this.RDm(za,la,ia);else if(0===ia.type)this.pDm(za,la,ia);else return a.a.instance.Ta(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",ia.type),this.Zd.logger.Og(Object.assign(new na.a,{rj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;va--;
Ia--}else if(this.ECn(Va,Ia,la,va)){pa=Na.J(ia);if(1===pa.type||2===pa.type)this.nll(za,ia,pa);else if(0===pa.type)this.Tkl(za,ia,pa);else return a.a.instance.Ta(575706453,1,2,"Abandoning LCS due to unexpected block of type {0}",pa.type),this.Zd.logger.Og(Object.assign(new na.a,{rj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;la--;Ia--}else if(la&&va&&Na.J(ia).GA(qa.J(pa)))la--,va--;else return a.a.instance.Ta(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.Zd.logger.Og(Object.assign(new na.a,
{rj:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.Zd.runtime.SG("LCS: CreateUpdateHintsFromLCSBlocks");return za}ECn(qa,Ia,Va,Na){Ia=new ba(Ia-1,Va-Na-1);return qa.mb(Ia)&&qa.J(Ia).x===Va-1&&qa.J(Ia).y===Na}FCn(qa,Ia,Va,Na){Ia=new ba(Ia-1,Va-Na+1);return qa.mb(Ia)&&qa.J(Ia).x===Va&&qa.J(Ia).y===Na-1}addPara(qa,Ia,Va,Na,za,la){var va=null;Va.block?va=Va.block.Rv:0<=za&&0===qa.J(za).type&&(va=qa.J(za).Rv);Va=qa=la.Rv;if(Na.b1b.contains(qa))for(za=0,qa=y.a.Ef("{00000000-0000-0000-0000-000000000000}{"+
za+"}");Na.b1b.contains(qa);)za++,qa=y.a.Ef("{00000000-0000-0000-0000-000000000000}{"+za+"}");va=new u.AddParagraphUpdateHint(qa,la.Lc,va);va.zyn=Va;Ia.updateHints.add(va);Na.Rv=qa;Na.Lc=la.Lc;Na.b1b.add(qa);Na.SRa=0}pDm(qa,Ia,Va){Va=new H.a(Va.Rv,Va.Lc);let Na=!1;if(0<qa.length&&11===qa.$f(qa.length-1).type){const za=qa.$f(qa.length-1);za.cp===Ia&&(Na=!0,za.O_.add(Va))}Na||(Ia=new I.a(Ia),Ia.O_.add(Va),qa.add(Ia))}splitPara(qa,Ia,Va,Na,za,la,va,ia){qa=this.bEl(la.Rv,qa,Ia,Na);if(!qa)return!1;Ia=
new Q.a(la.Rv,la.Lc,la.SRa,qa.Rv,qa.Lc,va.Rv,va.Lc);Va.updateHints.add(Ia);la.Lc=qa.Lc;qa!==ia?(za.block=qa,za.kfp=la.SRa,za=new u.AddParagraphUpdateHint(ia.Rv,ia.Lc,qa.Rv),Va.updateHints.add(za),la.Rv=ia.Rv,la.Lc=ia.Lc,la.b1b.add(ia.Rv),la.SRa=0):la.b1b.add(va.Rv);return!0}RDm(qa,Ia,Va){var Na=!1;if(0<qa.length&&11===qa.$f(qa.length-1).type){const za=qa.$f(qa.length-1);za.cp===Ia&&((Na=Object(n.a)(L.a,za.O_.J(za.O_.length-1)))?Na.text=Va.character.toString()+Na.text:za.O_.add(new L.a(Va.Rv,Va.character.toString())),
Na=!0)}Na||(Ia=new I.a(Ia),Ia.O_.add(new L.a(Va.Rv,Va.character.toString())),qa.add(Ia))}deletePara(qa,Ia,Va,Na,za,la){let va=-1;for(let ia=0;ia<za.length;ia++)if(za.J(ia)===la){0<ia&&(va=ia-1);break}la=null;0<=va&&(la=Na.J(za.J(va)));Na=new z.a(Va.Rv,Va.Lc,la?la.Rv:null);qa.updateHints.add(Na);la&&Ia.Rv.equals(Va.Rv)&&(Ia.SRa=la.length,Ia.Rv=la.Rv,Ia.Lc=la.Lc);Ia.b1b.remove(Va.Rv)}Tkl(qa,Ia,Va){Ia=new E.a(Ia,Va.Rv,Va.Lc);qa.add(Ia)}mergePara(qa,Ia,Va){qa.updateHints.add(new N.MergeParagraphUpdateHint(Va.Rv,
Va.Lc,Va.length,Ia.Rv,Ia.Lc,Va.Rv,Ia.Lc));Ia.SRa=Va.length;Ia.b1b.remove(Ia.Rv);Ia.Rv=Va.Rv}deleteText(qa,Ia,Va){let Na=!1;if(0<qa.updateHints.length&&2===qa.updateHints.$f(qa.updateHints.length-1).type){const za=qa.updateHints.$f(qa.updateHints.length-1);za.Ag.equals(Ia.Rv)&&za.cp===Ia.SRa&&(za.cp=Ia.SRa-1,za.text=Va.character.toString()+za.text,Na=!0)}Na||qa.updateHints.add(new w.DeleteTextUpdateHint(Ia.Rv,Ia.SRa-1,Va.character.toString()));--Ia.SRa}nll(qa,Ia,Va){let Na=!1;if(0<qa.length&&8===qa.$f(qa.length-
1).type){const za=qa.$f(qa.length-1);za.cp===Ia+1&&(za.text=Va.character.toString()+za.text,--za.cp,Na=!0)}Na||qa.add(new G.a(Ia,Va.character.toString()))}bEl(qa,Ia,Va,Na){for(;0<=Na;){var za=Ia.J(Va.J(Na));if(0!==za.type)break;if(za.Rv.equals(qa))return za;Na--}return null}}Object(F.a)(ja,"LCSUpdateHintGenerator",null,[])},1769:function(F,K,c){c.r(K);F=c(0);var l=c(16),f=c(6),a=c(165),k=c(364),x=c(598),y=c(221),n=c(58),u=c(55),z=c(1537);class w extends z.a{constructor(){super()}get uga(){return"ChildNodeListMerge"}}
Object(F.a)(w,"ChildNodeListMergeFailureDetail",z.a,[]);class E{lqb(ba,aa,fa){return aa.pz(ba,fa.J(ba))}NCj(ba,aa,fa,na){let oa;return({value:oa}=aa.Dc(ba)).returnValue||({value:oa}=fa.Dc(ba)).returnValue?oa:na.J(ba)}}Object(F.a)(E,"ChildNodeListMergeUtils",null,[2040]);var G=c(1564),H=c(1784),L=c(1637);class I{constructor(ba,aa){this.classId=ba;this.hRo=aa}}Object(F.a)(I,"NodeChildrenTransformation",null,[]);var N=c(798),Q=c(1554);class M{constructor(ba,aa,fa){this.NE=ba;this.ara=fa;this.g8=aa}$ae(ba){let aa,
fa;return({i5i:aa}=this.SCj(this.ara,ba)).returnValue&&aa.aY||({i5i:fa}=this.SCj(this.g8,ba)).returnValue&&fa.aY}SCj(ba,aa){let fa;return{returnValue:({value:fa}=(new Q.a(this.NE,ba)).Spa.Dc(N.a.yb(aa))).returnValue,i5i:fa}}}Object(F.a)(M,"NodeTriplet",null,[]);var J=c(1722);class V{constructor(ba,aa,fa){this.Zd=ba;this.Ng=aa;this.e7=fa;this.Khh=!0}get lq(){return this.Zd}get Ud(){return this.Ng}get oza(){return this.e7}get success(){return this.Khh}M8l(){a.a.instance.Ta(4220310,1,5,"Evaluating ParentObjects");
const ba=new k.a;this.n5e(ba,aa=>this.lq.runtime.uk.J(aa));this.n5e(ba,aa=>this.oza.lqb(aa,this.lq.runtime.Eu,this.lq.runtime.uk));this.n5e(ba,aa=>this.oza.lqb(aa,this.lq.runtime.Jq,this.lq.runtime.uk));return ba}n5e(ba,aa){const fa=aa(c(1769).ChildNodeListMerge.D9d);this.Ud.getPropertyObjectIds(fa,l.a.ef).forEach(na=>{this.Ud.getPropertyObjectIds(aa(na),l.a.ef).forEach(oa=>{ba.mb(oa)&&!na.equals(ba.J(oa))&&(this.Khh=!1,a.a.instance.Ta(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",
oa,na,ba.J(oa)));ba.Z(oa,na);return!0});return!0})}}Object(F.a)(V,"OutlineGroupParentFinder",null,[]);var X=c(1538),W=c(1591),U=c(1638);c.d(K,"ChildNodeListMerge",function(){return Y});class Y{constructor(ba,aa=null,fa=null,na=null,oa=null){this.Ng=ba;this.WAn=aa||H.a.nDj;this.Q5d=fa||this.N5l();this.oza=na||new E;this.EOi=oa||this.P3l()}get Ud(){return this.Ng}N5l(){return[new I(393227,Object(u.a)(this,this.Hzn,"pageContentNodeThreewayChildMerge")),new I(1073872968,Object(u.a)(this,this.m8o,"wordSectionNodeThreewayChildMerge")),
new I(393241,Object(u.a)(this,this.u9d,"outlineElementContainerThreewayChildMerge")),new I(393252,Object(u.a)(this,this.EHo,"tableCellThreewayChildMergev2")),new I(1074135125,Object(u.a)(this,this.u9d,"outlineElementContainerThreewayChildMerge")),new I(1074135123,Object(u.a)(this,this.u9d,"outlineElementContainerThreewayChildMerge")),new I(1074135127,Object(u.a)(this,this.u9d,"outlineElementContainerThreewayChildMerge"))]}P3l(){return[Object(u.a)(this,this.hHn,"prepareObjectGroupings"),Object(u.a)(this,
this.mom,"handleInterOutlineGroupMerge"),Object(u.a)(this,this.iDn,"performThreewayChildMerge")]}gdn(ba){let aa=0;for(;aa<this.EOi.length;aa++)if(!(0,this.EOi[aa])(ba))return a.a.instance.Ta(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",aa),ba.logger.g3d("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",aa),!1;return!0}hHn(ba){const aa=new k.a,fa=new k.a,na=new x.a;ba.runtime.Eu.forEach((oa,ja)=>Y.S0i(ja,aa));ba.runtime.Jq.forEach((oa,ja)=>Y.S0i(ja,fa));for(let oa=0;oa<this.Q5d.length;oa++){const ja=
this.Q5d[oa].classId;ba.runtime.Qlb.Z(ja,new k.a);aa.mb(ja)&&aa.J(ja).forEach(qa=>{var Ia=ba.runtime.uk.J(qa.id);Ia&&(Ia=new M(Ia,qa,ba.runtime.Jq.pz(qa.id,Ia)),ba.runtime.Qlb.J(ja).add(qa.id,Ia),na.add(qa.id));return!0});fa.mb(ja)&&fa.J(ja).forEach(qa=>{if(na.contains(qa.id))return!0;const Ia=ba.runtime.uk.J(qa.id);Ia&&ba.runtime.Qlb.J(ja).add(qa.id,new M(Ia,Ia,qa));return!0})}ba.runtime.SG("PrepareObjectGroupings");ba.logger.Lha("PrepareObjectGroupings");return!0}iDn(ba){let aa=!0;for(let fa=0;aa&&
fa<this.Q5d.length;fa++){const na=this.Q5d[fa];ba.runtime.SG("Before function#"+fa);const oa=na.classId;ba.runtime.Qlb.J(oa).forEach((ja,qa)=>{ba.runtime.pNa.contains(qa.NE.id)||(aa=na.hRo(ba,qa)&&aa);aa||(a.a.instance.Ta(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",oa,qa.NE.id),ba.logger.Og(Object.assign(new w,{rj:"PerformThreewayChildMerge",eventId:"aqtsr"})));return aa});ba.runtime.SG("PerformThreewayChildMerge"+fa)}ba.logger.Lha("PerformThreewayChildMerge");
return aa}Hzn(ba,aa){if(aa.$ae(l.a.ef)){var fa=this.Ud.getPropertyObjectIds(aa.NE,l.a.ef);const na=this.Ud.getPropertyObjectIds(aa.g8,l.a.ef);aa=this.Ud.getPropertyObjectIds(aa.ara,l.a.ef);fa=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",fa.length,na.length,aa.length,ba.input.source);a.a.instance.Ta(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",fa);ba.logger.Og(Object.assign(new w,{rj:"PageContentNodeThreewayChildMerge",
eventId:"apybx",info:fa}));return!1}return!0}m8o(ba,aa){if(aa.$ae(l.a.ef)){const Va=new x.a,Na=new x.a,za=new x.a,la=new x.a;var fa=this.Ud.getPropertyObjectIds(aa.NE,l.a.ef),na=fa.TG(),oa,ja=({rKh:oa}=this.nKj(aa.g8,na,Va,"Favored")).returnValue,qa=({rKh:Ia}=this.nKj(aa.ara,na,Na,"Unfavored")).returnValue;if(!ja||!qa)return fa=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",
na.count,Va.count,Na.count,oa,Ia),ba.logger.Og(Object.assign(new w,{rj:"WordSectionNodeThreewayChildMerge",info:fa})),!1;fa.forEach(va=>{Va.contains(va)||za.add(va);Na.contains(va)||la.add(va);return!0});aa=aa.NE.KK();na=new y.a;for(oa=0;oa<fa.length;oa++){var Ia=fa.$f(oa);if(za.contains(Ia)||la.contains(Ia)){if(ba.runtime.pNa.add(Ia),na.length&&(ja=na.$f(na.length-1),ja=ba.runtime.Qlb.J(393241).J(ja),qa=ba.runtime.Qlb.J(393241).J(Ia),ja&&qa))za.contains(Ia)?la.contains(Ia)||(ja.NE=ja.NE.KK(),ja.ara=
ja.ara.KK(),this.MAd(ja.NE,qa.NE),this.MAd(ja.ara,qa.ara)):(ja.NE=ja.NE.KK(),ja.g8=ja.g8.KK(),this.MAd(ja.NE,qa.NE),this.MAd(ja.g8,qa.g8))}else na.add(Ia)}this.Ud.setPropertyObjectIds(aa,l.a.ef,na);fa=new X.a(aa);fa.rC(l.a.ef);ba.runtime.en.Z(aa.id,fa)}return!0}MAd(ba,aa){const fa=this.Ud.getPropertyObjectIds(ba,l.a.ef);aa=this.Ud.getPropertyObjectIds(aa,l.a.ef);const na=fa.n5();aa.forEach(oa=>{na.add(oa);return!0});this.Ud.setPropertyObjectIds(ba,l.a.ef,na)}nKj(ba,aa,fa,na){let oa=0,ja=!0;this.Ud.getPropertyObjectIds(ba,
l.a.ef).forEach(qa=>{aa.contains(qa)?fa.add(qa):(ja=!1,a.a.instance.Ta(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",na,qa),oa++);return!0});return{returnValue:ja,rKh:oa}}mom(ba){let aa=!0;ba.runtime.Qlb.J(393241).forEach((fa,na)=>{if(this.DNm(na)){a.a.instance.Ta(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",na.NE.id);let oa;const ja=new V(ba,this.Ud,this.oza);if(({d_i:fa,ZLj:oa}=this.BPo(ba,ja.M8l(),na)).returnValue)return a.a.instance.Ta(4220303,1,
4,"Merging WordSection {0} as a unit.",oa),aa=ja.success&&this.Ydn(ba,oa,fa)&&aa,aa||(a.a.instance.Ta(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",na.NE.id,ja.success),ba.logger.Og(Object.assign(new w,{rj:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",ja.success)}))),aa}return!0});return aa}DNm(ba){if(!ba.$ae(l.a.ef))return!1;const aa=this.Ud.getPropertyObjectIds(ba.NE,l.a.ef).J(0),
fa=this.Ud.getPropertyObjectIds(ba.g8,l.a.ef);ba=this.Ud.getPropertyObjectIds(ba.ara,l.a.ef);return!fa.contains(aa,(na,oa)=>na.equals(oa))||!ba.contains(aa,(na,oa)=>na.equals(oa))}BPo(ba,aa,fa){aa=aa.J(fa.NE.id);a.a.instance.Ta(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",fa.NE.id,aa);if(ba.runtime.pNa.contains(aa))return a.a.instance.Ta(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",
aa),{returnValue:!1,d_i:null,ZLj:aa};const na=new J.a;fa=ba.runtime.uk.J(aa);this.Ud.getPropertyObjectIds(fa,l.a.ef).forEach(oa=>{na.LAd(oa);return!0});fa=this.oza.lqb(aa,ba.runtime.Eu,ba.runtime.uk);this.Ud.getPropertyObjectIds(fa,l.a.ef).forEach(oa=>{na.NAd(oa);return!0});ba=this.oza.lqb(aa,ba.runtime.Jq,ba.runtime.uk);this.Ud.getPropertyObjectIds(ba,l.a.ef).forEach(oa=>{na.RAd(oa);return!0});return{returnValue:!0,d_i:na,ZLj:aa}}H_f(ba,aa,fa,na,oa){let ja=!0;ba.forEach(qa=>{const Ia=aa(qa);this.Ud.getPropertyObjectIds(Ia,
l.a.ef).forEach(Va=>{fa.add(Va);if(na.mb(Va))return(ja=na.J(Va).equals(qa)&&ja)||a.a.instance.Ta(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",oa,Va,qa,na.J(Va)),ja;na.Z(Va,qa);return!0});return!0});return ja}a7l(ba,aa){let fa,na,oa,ja;fa=new y.a;na=new y.a;oa=new y.a;ja=new k.a;const qa=ba.runtime.uk;return this.H_f(aa.Rzb,Ia=>qa.J(Ia),fa,ja,"Base")&&this.H_f(aa.Sjf,Ia=>this.oza.lqb(Ia,ba.runtime.Eu,qa),na,ja,"Favored")&&
this.H_f(aa.oqb,Ia=>this.oza.lqb(Ia,ba.runtime.Jq,qa),oa,ja,"Unfavored")?{returnValue:!0,ywh:fa,nZh:na,iEj:oa,ISi:ja}:{returnValue:!1,ywh:fa,nZh:na,iEj:oa,ISi:ja}}YEl(ba,aa,fa,na){let oa=!0;const ja=ba.runtime.uk,qa=ba.runtime.Eu,Ia=ba.runtime.Jq,Va=ba.runtime.en,Na=new y.a,za=new k.a;fa.forEach(la=>{const va=na.J(la);if(!va)return a.a.instance.Ta(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",la),ba.logger.Og(Object.assign(new w,{rj:"FinishInterOutlineGroupMerge",
eventId:"aqgws"})),oa=!1;va.equals(Na.last())||(Na.add(va),za.add(va,new y.a));za.J(va).add(la);ba.runtime.pNa.add(la);return!0});if(!oa)return!1;za.forEach((la,va)=>{const ia=this.oza.NCj(la,qa,Ia,ja).KK();this.Ud.setPropertyObjectIds(ia,l.a.ef,va);Va.Z(la,new X.a(ia));Va.J(la).rC(l.a.ef);ba.runtime.pNa.add(la);return oa});fa=this.oza.NCj(aa,qa,Ia,ja).KK();this.Ud.setPropertyObjectIds(fa,l.a.ef,Na);Va.Z(aa,new X.a(fa));Va.J(aa).rC(l.a.ef);ba.runtime.pNa.add(aa);return oa}Ydn(ba,aa,fa){let na,oa;
if(!({ywh:ja,nZh:na,iEj:oa,ISi:fa}=this.a7l(ba,fa)).returnValue)return!1;var ja=G.b(ja,na,oa);ja=this.pXf(ba,ja);return!!ja&&this.YEl(ba,aa,ja,fa)}u9d(ba,aa){return this.$Zi(ba,aa)}$Zi(ba,aa){if(aa.$ae(l.a.ef)){var fa=this.X6l(aa);fa=this.pXf(ba,fa);if(!fa)return a.a.instance.Ta(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",aa.NE.id),ba.logger.Og(Object.assign(new w,
{rj:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),L.a(aa.NE,"OutlineElementContainerThreewayChildMerge_Base",1),L.a(aa.g8,"OutlineElementContainerThreewayChildMerge_Favored",1),L.a(aa.ara,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var na=this.Ud.getPropertyObjectIds(aa.NE,l.a.ef);const oa=fa.TG();na.forEach(ja=>{oa.contains(ja)||(ja=this.Ud.getPropertyObjectIds(aa.NE,l.a.MK),0<ja.length&&ba.runtime.$Xf.add(ja.J(0)));return!0});na=aa.g8.KK();this.Ud.setPropertyObjectIds(na,
l.a.ef,fa);ba.runtime.en.Z(na.id,new X.a(na));ba.runtime.en.J(na.id).rC(l.a.ef)}return!0}pIb(ba){if(!ba)return a.a.instance.Ta(573957964,1,2,"Feature helper is null"),!1;ba.Az(105);return ba.isFeatureEnabled(105)}EHo(ba,aa){if(!this.pIb(ba.runtime.Xb))return this.$hg(ba,aa);var fa=aa.NE.id,na=U.e(ba,aa.NE,null);if(na.equals(n.a.nil))return a.a.instance.Ta(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",fa),ba.logger.Og(Object.assign(new W.a,{info:"Table node ID could not be found for table cell"})),
!1;var oa=ba.runtime.$Ab.J(na);if(oa&&(oa=oa.J(fa)))if(oa.hg)aa=aa.g8.KK(),aa.removeProperty(l.a.ef),this.Ud.setPropertyBool(aa,f.a.ghostCell,!0),null!=oa.colSpan?this.Ud.setPropertyUint32(aa,f.a.colSpan,oa.colSpan):aa.removeProperty(f.a.colSpan),ba.runtime.en.Z(aa.id,new X.a(aa)),ba.runtime.en.J(aa.id).rC(l.a.ef),ba.runtime.en.J(aa.id).rC(f.a.ghostCell),ba.runtime.en.J(aa.id).rC(f.a.colSpan);else{let ja,qa;({EBd:na,OLd:ja,Dne:qa}=this.O2l(ba,aa,oa,na));if(!ja.length&&!qa.length)return a.a.instance.Ta(573957966,
1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",fa),ba.logger.Og(Object.assign(new W.a,{info:"A non-ghost cell does not have OE nodes on either side"})),!1;ja.length?qa.length?(fa=G.b(na,ja,qa),fa=this.pXf(ba,fa)):fa=ja:fa=qa;if(!fa)return a.a.instance.Ta(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",aa.NE.id),ba.logger.Og(Object.assign(new w,
{rj:"TableCellThreewayChildMergev2",eventId:"8n426"})),L.a(aa.NE,"TableCellThreewayChildMergev2_Base",1),L.a(aa.g8,"TableCellThreewayChildMergev2_Favored",1),L.a(aa.ara,"TableCellThreewayChildMergev2_Unfavored",1),!1;aa=aa.g8.KK();this.Ud.setPropertyObjectIds(aa,l.a.ef,fa);aa.removeProperty(f.a.ghostCell);fa=oa.rowSpan;oa=oa.colSpan;null!=fa&&null!=oa&&(1<fa||1<oa)?(this.Ud.setPropertyUint32(aa,f.a.rowSpan,fa),this.Ud.setPropertyUint32(aa,f.a.colSpan,oa)):(aa.removeProperty(f.a.rowSpan),aa.removeProperty(f.a.colSpan));
ba.runtime.en.Z(aa.id,new X.a(aa));ba.runtime.en.J(aa.id).rC(l.a.ef);ba.runtime.en.J(aa.id).rC(f.a.ghostCell);ba.runtime.en.J(aa.id).rC(f.a.rowSpan);ba.runtime.en.J(aa.id).rC(f.a.colSpan)}else return this.$hg(ba,aa);ba.logger.Lha("TableCellThreewayChildMergev2");return!0}O2l(ba,aa,fa,na){let oa,ja;({EBd:aa,OLd:oa,Dne:ja}=this.K8h(aa));aa||(aa=new y.a);oa||(oa=new y.a);ja||(ja=new y.a);var qa=aa.TG(),Ia=oa.TG(),Va=ja.TG(),Na=fa.q6d;if(Na)for(var za=0;za<Na.length;za++){var la=Na.J(za),va=ba.runtime.uk.J(la);
!qa.contains(la)&&va&&(qa.add(la),aa.add(la));!Ia.contains(la)&&ba.runtime.Eu.pz(la,va)&&(Ia.add(la),oa.add(la));!Va.contains(la)&&ba.runtime.Jq.pz(la,va)&&(Va.add(la),ja.add(la))}ba.logger.Lha("OENodesAddedToChildrenList");if(Na=fa.fwf)for(za=0;za<Na.length;za++)if(la=Na.J(za),va=ba.runtime.uk.J(la)){var ia=this.Ud.getPropertyObjectIds(va,l.a.ef);if(ia)for(var pa=0;pa<ia.length;pa++){var sa=ia.J(pa);qa.contains(sa)||(qa.add(sa),aa.add(sa))}ia=ba.runtime.Eu.pz(la,va);if(ia=this.Ud.getPropertyObjectIds(ia,
l.a.ef))for(pa=0;pa<ia.length;pa++)sa=ia.J(pa),Ia.contains(sa)||(Ia.add(sa),oa.add(sa));la=ba.runtime.Jq.pz(la,va);if(la=this.Ud.getPropertyObjectIds(la,l.a.ef))for(va=0;va<la.length;va++)ia=la.J(va),Va.contains(ia)||(Va.add(ia),ja.add(ia))}ba.logger.Lha("GhostCellOENodesAddedToChildrenList");if(fa=fa.xRf)for(qa=0;qa<fa.length;qa++)if(Ia=fa.J(qa),Ia=ba.runtime.$Ab.J(na).J(Ia))if(Ia=Ia.q6d){Ia=Ia.TG();Va=new y.a;for(Na=0;Na<aa.length;Na++)Ia.contains(aa.J(Na))||Va.add(aa.J(Na));aa=Va;Va=new y.a;for(Na=
0;Na<oa.length;Na++)Ia.contains(oa.J(Na))||Va.add(oa.J(Na));oa=Va;Va=new y.a;for(Na=0;Na<ja.length;Na++)Ia.contains(ja.J(Na))||Va.add(ja.J(Na));ja=Va}ba.logger.Lha("NonGhostCellsOENodesRemovedFromChildrenList");return{EBd:aa,OLd:oa,Dne:ja}}$hg(ba,aa){let fa=aa.g8.hasProperty(l.a.ef),na=aa.ara.hasProperty(l.a.ef);fa&&(fa=!!this.Ud.getPropertyObjectIds(aa.g8,l.a.ef).length);na&&(na=!!this.Ud.getPropertyObjectIds(aa.ara,l.a.ef).length);if(fa!==na)if(this.kUm(ba.runtime.Xb))ba.logger.DJi(Object.assign(new W.a,
{info:"TableCell OE missing children, ghost cell likely touched"}));else return ba.logger.Og(Object.assign(new W.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.$Zi(ba,aa)}X6l(ba){let aa,fa;({EBd:ba,OLd:aa,Dne:fa}=this.K8h(ba));return G.b(ba,aa,fa)}pXf(ba,aa){a.a.instance.Ta(4220309,1,5,"Considering {0} OutlineElement collections for merge.",aa.length);const fa=new y.a;let na=!0;aa.forEach(oa=>{if(!oa)return a.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),
ba.logger.Og(Object.assign(new w,{rj:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),na=!1;if(1===oa.Oen&&1===oa.tlb){const ia=oa.Rzb.J(0),pa=oa.Sjf.J(0),sa=oa.oqb.J(0);if(ia&&ia.equals(pa)&&ia.equals(sa))return fa.add(ia),!0;if(1!==aa.length)return a.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",ia,pa,sa,aa.length),
ba.logger.Og(Object.assign(new w,{rj:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),na=!1}const ja=new k.a,qa=new y.a,Ia=new y.a,Va=new y.a,Na=new y.a,za=new y.a,la=new y.a,va=ba.runtime.uk;oa.Rzb.forEach(ia=>na=this.D0f(ba,ia,pa=>va.J(pa),qa,Na,ja,"Base"));if(!na)return a.a.instance.Ta(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),ba.logger.Og(Object.assign(new w,{rj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),
!1;oa.Sjf.forEach(ia=>na=this.D0f(ba,ia,pa=>this.oza.lqb(pa,ba.runtime.Eu,va),Ia,za,ja,"Favored"));if(!na)return a.a.instance.Ta(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),ba.logger.Og(Object.assign(new w,{rj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;oa.oqb.forEach(ia=>na=this.D0f(ba,ia,pa=>this.oza.lqb(pa,ba.runtime.Jq,va),Va,la,ja,"Unfavored"));if(!na)return a.a.instance.Ta(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),
ba.logger.Og(Object.assign(new w,{rj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;ba.runtime.Xb&&ba.runtime.Xb.qib(1000005)&&(za.length&&this.UAl(za,ba.runtime.Eu)?(this.Iph(za,ba,fa,ja),this.Mzd(ba,ja,la)):this.Iph(la,ba,fa,ja));if(qa.length){oa=null;if(!({en:oa}=this.WAn(ba,qa,Ia,Va,oa)).returnValue||!oa)return na=!1;oa.forEach(ia=>{0<ia.x_b.count&&ba.runtime.en.Z(ia.wm.id,ia);fa.add(ja.J(ia.wm.id));return!0})}return!0});return na?fa:null}UAl(ba,aa){for(let fa=0;fa<ba.length;fa++)if(aa.get(ba.$f(fa).id))return!0;
return!1}Mzd(ba,aa,fa){fa.length&&(fa.forEach(na=>{ba.runtime.skc.add(na.id);ba.runtime.skc.add(aa.J(na.id));return!0}),H.a.Mzd(ba,this.Ud,fa.J(0)))}Iph(ba,aa,fa,na){ba.forEach(oa=>{const ja=new X.a(oa.KK());aa.runtime.en.Z(oa.id,ja);fa.add(na.J(oa.id));return!0})}D0f(ba,aa,fa,na,oa,ja,qa){var Ia=fa(aa);if(!Ia)return a.a.instance.Ta(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",qa,aa),ba.logger.Og(Object.assign(new w,{rj:"ProcessOutlineElement",eventId:"aqwkb",
info:String.format("[Revision: {0}] Failed to find OutlineElement",qa)})),!1;const Va=this.Ud.getPropertyObjectIds(Ia,l.a.MK);if(!Va||!Va.length)return a.a.instance.Ta(4285058,1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",qa,aa),ba.logger.Og(Object.assign(new w,{rj:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",qa)})),L.a(Ia,"ProcessOutlineElement_"+qa,1),!1;Ia=Va.$f(0);fa=fa(Ia);if(!fa)return a.a.instance.Ta(4285059,
1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",qa,Ia,aa),ba.logger.Og(Object.assign(new w,{rj:"ProcessOutlineElement",eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",qa)})),!1;if((qa=this.Ud.getPropertyString(fa,f.a.kN))&&""!==qa&&ba.runtime.Xb&&(ba.runtime.Xb.HTd(1000005),ba.runtime.Xb.qib(1000005)))return oa.add(fa),ja.add(Ia,aa),ba.runtime.pNa.add(Ia),!0;na.add(fa);
ja.add(Ia,aa);ba.runtime.pNa.add(Ia);return!0}K8h(ba){let aa,fa;aa=this.Ud.getPropertyObjectIds(ba.NE,l.a.ef);fa=this.Ud.getPropertyObjectIds(ba.g8,l.a.ef);ba=this.Ud.getPropertyObjectIds(ba.ara,l.a.ef);return{EBd:aa,OLd:fa,Dne:ba}}kUm(ba){if(!ba)return a.a.instance.Ta(51422868,1,2,"Feature Helper is null"),!1;ba.Az(104);return ba.isFeatureEnabled(104)}static S0i(ba,aa){aa.mb(ba.Rc)||aa.Z(ba.Rc,new y.a);aa.J(ba.Rc).add(ba);return!0}}Y.D9d=n.a.Ef("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(F.a)(Y,
"ChildNodeListMerge",null,[1992])},1770:function(F,K,c){F=c(0);var l=c(1502),f=c(1631),a=c(1549),k=c(1520),x=c(1713),y=c(1567);class n{constructor(aa,fa){this.DimensionValue=this.DimensionName=null;this.DimensionName=aa;this.DimensionValue=fa}}Object(F.a)(n,"Dimension",null,[]);class u{constructor(aa,fa,na,oa,ja){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=aa;this.Query=fa;this.From=na;this.Size=oa;ja&&(this.Filter=ja)}}Object(F.a)(u,"EntityRequest",null,
[]);class z{constructor(aa){this.QueryString=null;this.QueryString=aa}}Object(F.a)(z,"Query",null,[]);var w=c(1504);class E{constructor(aa,fa){this.Dimensions=this.Name=null;this.Name=aa;this.Dimensions=fa}}Object(F.a)(E,"Scenario",null,[]);var G=c(1508),H=c(1507);class L{constructor(aa,fa,na,oa){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=aa;this.TimeZone=fa;this.Cvid=na;this.Scenario=oa}}Object(F.a)(L,"SubstrateBody",null,[]);var I=c(1566),N=c(1500),Q=c(1499),
M=c(2),J=c(1706),V=c(1705),X=c(1536),W=c(35),U=c(19),Y=c(140);c.d(K,"a",function(){return ba});class ba{constructor(aa){this.xyc=this.vcb=this.Opd=this.ntc=this.izc=0;this.n8g=this.Oah=this.dQ=null;this.QIe=0;this.Z1=-1;this.UBc="";this.aCe=!1;this.Xf=M.AFrameworkApplication.Ne;this.ic=aa;this.Kvd=this.Iuf();this.xxb=new f.a;this.D6g=this.ic.Pme?3:2;this.ZUe=this.ic.Pme&&this.ic.Osj?5:3;this.pYe=this.ic.Die?2:3;this.jmh=1;this.Sod=this.ic.Rci;this.Tgh=this.ic.uTm;this.gAc=aa.Xgi;M.AFrameworkApplication.K&&
(this.Oah=M.AFrameworkApplication.K.jb("AppCatalogUrl")+M.AFrameworkApplication.K.jb("SearchPersonaPhotoBaseUrl"),this.aCe=this.ic.mga||this.ic.oKd);this.ic.mga&&(this.pYe=this.ZUe=5)}cL(){return"Substrate"}bU(){return 0===this.ic.gv?0:1===this.ic.gv?1:3}PH(aa,fa,na,oa=l.a.tellMe,ja=null){const qa=new H.a(aa);if(!ja||Array.contains(ja,14)||Array.contains(ja,15)||Array.contains(ja,20))if(!this.QIe||window.performance.now()-this.QIe>=Q.a.C7a)if(na=this.xxb.Chi())this.QIe=window.performance.now(),na.then(Ia=>
{Ia&&""!==Ia?(this.UBc=Ia,""!==this.dQ&&this.Bhi(aa,oa,this.UBc,fa,ja)):(N.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),fa.resultsUpdated(qa))},Ia=>{N.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+Ia);fa.resultsUpdated(qa)});else{if(N.TellMeActor.instance.Oe)N.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");fa.resultsUpdated(qa)}else this.UBc&&
""!==this.UBc?this.Bhi(aa,oa,this.UBc,fa,ja):(fa.resultsUpdated(qa),N.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else fa.resultsUpdated(qa)}X5a(){this.vcb=this.xyc=this.Opd=this.ntc=this.izc=0}Bhi(aa,fa,na,oa,ja){this.X5a();const qa=new H.a(aa),Ia=this.dQ=Y.a.create().toString();this.QCa();this.Z1=window.setTimeout(()=>{if(Ia===this.dQ){this.dQ="";this.Z1=-1;oa.resultsUpdated(qa);const za={};za[a.a.provider]=this.cL();za[a.a.rMb]=aa.snb;N.TellMeActor.instance.Oe.MA(k.a.timedOut,
this.gAc,za)}},this.gAc);const Va={"Content-Type":"application/json",Accept:"application/json"};Va.Authorization="Bearer "+na;Va["X-Office-Version"]=M.AFrameworkApplication.buildVersion;Va["X-Office-Application"]=M.AFrameworkApplication.K.jb("Application");Va["X-Office-Platform"]="WAC";Va["X-TellMe-SessionId"]=N.TellMeActor.instance.TSd();Va["X-TellMe-Culture"]=M.AFrameworkApplication.uiCulture;Va["X-TellMe-ProcessSessionId"]=M.AFrameworkApplication.userSessionId;Va["Client-Request-Id"]=Ia;const Na=
window.performance.now();this.Xf.xj(this.Mem(),2,this.Nem(aa.Dg,this.ic.application,N.TellMeActor.instance.TSd(),Q.a.dR(aa)),Va,!1,0,za=>{this.$Kb(za,aa,oa,Ia,Na,fa,ja)},za=>{this.GKb(za,aa,oa,Ia,Na)},null,null,!1,4E3,6E3)}QCa(){-1!==this.Z1&&(window.clearTimeout(this.Z1),this.Z1=-1)}$Kb(aa,fa,na,oa,ja,qa,Ia){N.TellMeActor.instance.Oe.y0(fa.Dg.length,this.Kvd.join(","),aa.data.Qe.toString(),Math.round(window.performance.now()-ja),I.a.substrate,!0,y.a.IPa);const Va=Q.a.dR(fa),Na=new H.a(fa);if(oa===
this.dQ){this.QCa();aa=W.b(aa.data.ve);if(aa.Groups){aa=aa.Groups;for(const za of aa)"People"===za.Type&&this.ic.w$c&&(Ia?Array.contains(Ia,14):1)?(aa=this.gei(za.Suggestions,Va,qa),0<aa.results.length&&Na.Yu(aa)):"File"===za.Type&&this.ic.u$c&&(Ia?Array.contains(Ia,15):1)?(aa=this.kqf(za.Suggestions,Va,qa),0<aa.results.length&&(this.jZd()&&(oa=new w.a("GenerateSlidesFromTellMe",30,"",null,1),aa.Ow(oa)),Na.Yu(aa))):"Notes"===za.Type&&this.ic.wkb&&qa!==l.a.contextMenu&&(Ia?Array.contains(Ia,20):1)&&
(aa=this.Nci(za.Suggestions,Va,fa),0<aa.results.length&&Na.Yu(aa))}na.resultsUpdated(Na);N.TellMeActor.instance.Oe.y0(fa.Dg.length,this.Kvd.join(","),"",Math.round(window.performance.now()-ja),"",!0,y.a.provider)}else na.resultsUpdated(Na)}Nci(aa,fa,na){const oa=new G.a(20);oa.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const ja of aa)this.MVm(ja)&&(aa=ja.NotesType,aa=U.a.Ug(aa),aa=this.a6l(aa,ja.LastModifiedTime,ja.BodyPreview,ja.Subject,fa,na,ja))&&(aa.groupType=20,oa.Ow(aa));return oa}gei(aa,
fa,na){const oa=new G.a(14);oa.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const qa of aa)if(this.NVm(qa)){var ja=qa.Id.split("@")[0];aa=qa.EmailAddresses[0];let Ia=qa.Type;if(void 0===Ia||null===Ia)Ia="User";if(ja=this.$8l(Ia,qa.DisplayName,qa.JobTitle,aa,ja,na,fa))ja.description=aa,aa=qa.JobTitle,"Department"in qa&&"CompanyName"in qa&&(aa+="@"+qa.Department+"@"+qa.CompanyName),ja.KI=aa,oa.Ow(ja)}return oa}kqf(aa,fa,na){const oa=new G.a(15);oa.displayName=CommonUIStrings.l_TellMeFileProviderTitle;
for(const za of aa)if(this.CVm(za)){var ja=za.FileName;aa=za.FileExtension;var qa=ja;ja.length>aa.length&&qa.endsWith(aa)&&(qa=ja.substr(0,ja.length-aa.length-1));var Ia=void 0,Va=0;"DateCreated"in za&&za.DateCreated?(Va=Q.a.ovf(za.DateCreated),Ia=Q.a.Rii(za.DateCreated),Ia=String.format(CommonUIStrings.l_CreatedTimeFormatString,za.Author,Ia)):Ia=za.Author;var Na=za.AccessUrl+"?web=1";const la=U.a.a$b(Na);ja=String.format('<a href="{0}">{1}</a>',la,U.a.QX(ja));if(na!==l.a.contextMenu||U.a.uU(Na))if(qa=
this.nXl(qa,na===l.a.contextMenu?ja:Na,Ia,za.FileExtension,za.Text,fa))qa.description=za.Author,qa.pAd=Va,oa.Ow(qa),this.aCe&&(Va=za.AccessUrl,ja=Q.a.EPd(aa),Ia=za.DateModified?za.DateModified:za.DateCreated,Na=za.Size?za.Size:za.FileSize,this.Pto()&&(Va=Va.replace(RegExp("%20","g")," "),ja=Q.a.Jdm(aa)),aa=new x.a(ja,Va,za.SPWebUrl,za.Id,Na,Ia),N.TellMeActor.instance.Cmg(!1,qa.value,aa))}return oa}GKb(aa,fa,na,oa,ja){oa===this.dQ&&(this.QCa(),N.TellMeActor.instance.Oe.y0(fa.Dg.length,this.Kvd.join(","),
aa.data.Qe.toString(),Math.round(window.performance.now()-ja),I.a.substrate,!1,y.a.IPa));aa=new H.a(fa);na.resultsUpdated(aa)}$8l(aa,fa,na,oa,ja,qa,Ia){Ia=Ia?this.jmh:this.D6g;if(!window.LPC&&!Q.a.TCf()||this.izc===Ia)return null;this.izc+=1;Ia="PeopleSuggestion"+this.izc.toString();var Va=this.Oah+"?size=1&accountName="+oa;aa=Object.assign(new J.a,{PersonaType:aa,Smtp:oa,ProfilePictureUrl:Va,AadObjectId:ja});const Na=Object.assign(new V.a,{identifiers:aa,displayName:fa});aa=qa===l.a.contextMenu;
this.ic.$va?(N.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(Ia,Na,fa,na)),qa===l.a.contextMenu&&(na=Q.a.qNh(fa,oa,ja),N.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ia,na))),N.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ia,aa))):(Va=[],Va.push(appChrome.actions.setPersonaButtonCoauthor(Ia,Na,fa,na)),qa===l.a.contextMenu&&(na=Q.a.qNh(fa,oa,ja),Va.push(appChrome.actions.setButtonCommandValueId(Ia,
na))),Va.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ia,aa)),appChrome.api.dispatch(Va));return new w.a(Ia,11,fa,oa,0)}a6l(aa,fa,na,oa,ja,qa,Ia){if(ja&&!this.ic.gDi||this.Opd===this.Sod||this.xyc===this.Sod||this.vcb===this.Sod)return null;var Va=null;this.Opd+=1;ja="";const Na=[],za={};Ia.type="Notes";this.n8g=Object.assign(new X.a,{landingTab:"Notes",data:Ia});qa=Q.a.RNa(qa.Dg,33,this.n8g);if("onenotepagepreviews"===aa){if(!("ClickthroughUrl"in Ia&&Ia.ClickthroughUrl)||""===
Ia.ClickthroughUrl)return null;this.xyc+=1;ja="OnenoteNotesSuggestion"+this.xyc.toString();za["default"]="SaveAsonetoc2_20";Va=Ia.ClickthroughUrl;Na.push(appChrome.actions.setControlIconSet(ja,za));Na.push(appChrome.actions.setCompoundButtonCommandValueId(ja,Va));Va=new w.a(ja,19,null,null,0)}else if("stickynote"===aa){if(!this.Tgh)return null;this.vcb+=1;ja="NotesSuggestion"+this.vcb.toString();za["default"]="ShowAllNotes_20";Na.push(appChrome.actions.setControlIconSet(ja,za));Na.push(appChrome.actions.setCompoundButtonCommandValueId(ja,
qa));Va=new w.a(ja,21,null,null,0)}else if("samsung"===aa){if(!this.Tgh)return null;this.vcb+=1;ja="NotesSuggestion"+this.vcb.toString();za["default"]="CategoryCollapsed_20";Na.push(appChrome.actions.setControlIconSet(ja,za));Na.push(appChrome.actions.setCompoundButtonCommandValueId(ja,qa));Va=new w.a(ja,20,null,null,0)}""!==ja&&(aa=Q.a.Rii(fa),aa=String.format(CommonUIStrings.l_LastModifiedString,aa),Va.label=oa,Va.pAd=Q.a.ovf(fa),Na.push(appChrome.actions.setControlLabel(ja,oa)),Na.push(appChrome.actions.updateCompoundButtonDescription(ja,
aa)),Na.push(appChrome.actions.setControlCustomTooltip(ja,na)),appChrome.api.dispatch(Na));return Va}nXl(aa,fa,na,oa,ja,qa){if(this.ntc===(qa?this.pYe:this.ZUe)||this.aCe&&"Word"!==Q.a.EPd(oa))return null;this.ntc+=1;qa="FileSuggestion"+this.ntc.toString();const Ia=[],Va={};Va["default"]=Q.a.A_l(oa);this.ic.$va?(N.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(qa,aa)),N.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(qa,Va)),N.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(qa,
na)),N.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(qa,fa)),N.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(qa,ja))):(Ia.push(appChrome.actions.setControlLabel(qa,aa)),Ia.push(appChrome.actions.setControlIconSet(qa,Va)),Ia.push(appChrome.actions.updateCompoundButtonDescription(qa,na)),Ia.push(appChrome.actions.setCompoundButtonCommandValueId(qa,fa)),Ia.push(appChrome.actions.setControlCustomTooltip(qa,ja)),appChrome.api.dispatch(Ia));
return new w.a(qa,6,aa,na,0)}Iuf(){const aa=[];this.ic.w$c&&Array.add(aa,"People");this.ic.u$c&&Array.add(aa,"File");this.ic.wkb&&Array.add(aa,"Notes");return aa}Nem(aa,fa,na,oa){var ja=new z(aa);aa=new u("File",ja,0,oa?this.pYe:this.ZUe,null);oa=new u("People",ja,0,oa?this.jmh:this.D6g,Q.a.TCn);ja=new u("Notes",ja,0,this.Sod,null);this.ic.oKd&&"powerpoint"===fa.toLowerCase()&&(fa="word");fa=new n("app",fa.toLowerCase());var qa=[];Array.add(qa,fa);fa=new E("tellmesearch",qa);qa=[];this.ic.u$c&&Array.add(qa,
aa);this.ic.w$c&&Array.add(qa,oa);this.ic.wkb&&Array.add(qa,ja);na=new L(qa,"UTC",na,fa);return W.c(na)}Mem(){let aa=this.ic.LFo;this.ic.wkb&&(aa+="?&setflight=NotesFrom3S");""!==this.ic.Dhi&&(aa=aa+"&"+this.ic.Dhi);return aa}NVm(aa){return"DisplayName"in aa&&"Id"in aa&&"EmailAddresses"in aa&&!!aa.Id&&!!aa.EmailAddresses}CVm(aa){return"FileExtension"in aa&&!!aa.FileExtension&&"FileName"in aa&&!!aa.FileName&&""!==aa.FileName&&"AccessUrl"in aa&&!!aa.AccessUrl&&""!==aa.AccessUrl}MVm(aa){return"Id"in
aa&&!!aa.Id&&"NotesType"in aa&&!!aa.NotesType&&"Subject"in aa&&!!aa.Subject&&""!==aa.Subject}jZd(){return!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Pto(){return!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(F.a)(ba,"SubstrateResultsProvider",null,[1247])},1771:function(F,K,c){F=c(0);var l=c(41),
f=c(6),a=c(16),k=c(165),x=c(83),y=c(181),n=c(221),u=c(598),z=c(58),w=c(364),E=c(2),G=c(1456),H=c(955);class L{constructor(qa,Ia=0){this.Taf=null;this.EYf=0;this.LM=qa;this.Edn=Ia}}Object(F.a)(L,"GraphMergerResponse",null,[]);var I=c(55),N=c(1),Q=c(115),M=c(870),J=c(1537),V=c(1588);class X extends V.a{constructor(){super();this.kvj=null;this.iLj=!1}get uga(){return"Crash"}xEb(){this.detail.Z("Type",this.uga);this.detail.Z("Trace",this.YOo(this.kvj));this.detail.Z("Continue",this.iLj);return this.detail}YOo(qa){qa=
qa.split("\n");const Ia=4<qa.length?4:qa.length,Va=new Sys.StringBuilder;for(let Na=0;Na<Ia;Na++)Na===Ia-1?Va.append(String.format("{0}...",qa[Na])):Va.append(String.format("{0}\n",qa[Na]));return Va.toString()}}Object(F.a)(X,"CrashMergeFailureDetail",V.a,[]);var W=c(1969),U=c(1554),Y=c(1649),ba=c(1538);class aa{constructor(){this.XLk=new w.a;this.J2k=new w.a;this.Z5k=new w.a}}Object(F.a)(aa,"RangeMarkers",null,[]);class fa{constructor(){this.colSpan=this.rowSpan=null;this.hg=!1;this.yCe=new n.a;
this.uLe=new n.a;this.OLe=new n.a}get fwf(){return this.yCe.n5()}set fwf(qa){qa||(this.yCe=new n.a);this.yCe=qa.n5()}get xRf(){return this.uLe.n5()}set xRf(qa){qa||(this.uLe=new n.a);this.uLe=qa.n5()}get q6d(){return this.OLe.n5()}set q6d(qa){qa||(this.OLe=new n.a);this.OLe=qa.n5()}}Object(F.a)(fa,"TableCellStructureInfo",null,[]);var na=c(1591),oa=c(1638);c.d(K,"a",function(){return ja});class ja{constructor(){this.GTd=0;this.CXg=this.fab=this.uXb=this.Ng=this.Mdh=this.KYb=null;this.B6g=0;this.k3g=
50;this.bVg=this.NOg=null}get Uee(){return this.KYb}get G9n(){return this.Mdh}get Ud(){return this.Ng}get wlb(){return this.uXb}get fli(){return this.fab}get Klm(){return this.CXg}get Pdc(){return this.B6g}get MDh(){return this.NOg}get TLc(){return this.bVg}Wdc(qa,Ia,Va,Na,za,la,va){Va=this.ocl(qa,Ia,Na,za,la,va,this.TLc);Na=0;const ia=Va.runtime.Hie;let pa=null;try{this.G5m(ia,Va,va,qa,Ia,za,la);for(qa=1;Na<this.wlb.length;Na++)if(!(0,this.wlb[Na])(Va)){qa=2;Va.logger.g3d("GraphMerger.GetMergeFunctions()",
Na);break}return pa=new L(Va.output.LM,qa)}catch(sa){const Ha=!Va.output.timeout;Va.output.crash=Ha;const ra=this.xPd(sa),Ma=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",Ha?"Crashed":"Timed Out",Va.input.OJb,!!Va.output.LM,ra);Ha?(k.a.instance.Ta(4051608,1,1,"MergeChanges Crash. [Error: {0}]",Ma),Va.logger.Og(Object.assign(new X,{kvj:ra,iLj:!!Va.output.LM}))):k.a.instance.Ta(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",Ma);if(Va.output.LM)return pa=new L(Va.output.LM,
2);throw sa;}finally{Va.output.succeeded?this.D5m(ia,Va,Na):Va.output.timeout?this.F5m(Va,Na):Va.output.crash?Va.output.LM?this.E5m(Va,Na):this.C5m(Va,Na):this.B5m(Va,Na);Va.logger.A5m();k.a.instance.vja(42350232,1,Va.output.succeeded?4:2,"MergeLogger",Va.logger.S3l());Va.logger.WYc.ani()&&k.a.instance.vja(559015903,1,2,"MarkerInfo",Va.logger.WYc.toString());if(Va.runtime.Xb&&Va.runtime.Xb.isFeatureEnabled(73))try{this.i2m(Va)}catch(sa){k.a.instance.Ta(571619421,1,4,"Error logging references: {0}",
sa.toString())}this.m7m(Va);pa.EYf|=(Va.output.succeeded?2:1)<<2*(va-1);if(pa)try{pa.Taf=this.OGn(Va)}catch(sa){k.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",sa)}}}m7m(qa){if(!qa.output.succeeded){qa=qa.output.timeout?"Timeout":qa.logger.s5i?qa.logger.s5i.uga:"Unknown";const Ia=new Q.a;x.Health.instance.recordQosError(qa,["MergeFailure"],!0,!0,!1,!1,Ia)}}i2m(qa){const Ia=za=>{const la=this.kEa()-qa.input.CTa>this.Pdc;if(0<this.Pdc&&la)throw k.a.instance.Ta(571619422,
1,2,"Timed out while calculating added and deleted nodes: {0}",za),y.a.invalidOperation(za);};let Va=qa.runtime.Eu.keys,Na=za=>qa.runtime.Eu.J(za);this.vKf(qa,Ia,Va,Na,"Favored");Va=qa.runtime.Jq.keys;Na=za=>qa.runtime.Jq.J(za);this.vKf(qa,Ia,Va,Na,"Unfavored");Va=qa.runtime.en.keys;Na=za=>{const la=qa.runtime.en.J(za);return la?la.wm:qa.runtime.Eu.J(za)};this.vKf(qa,Ia,Va,Na,"Merged")}vKf(qa,Ia,Va,Na,za){var la=new n.a;const va=new n.a;for(let ia=0;ia<Va.length;ia++){Ia("LogAddedAndDeletedNodes");
const pa=Na(Va.J(ia));if(4325465===pa.Rc)continue;const sa=qa.runtime.uk.J(pa.id);sa&&this.j2m(la,va,pa,sa)}this.FKi(va,ia=>qa.runtime.uk.J(ia),Ia);this.FKi(la,Na,Ia);Ia=new Sys.StringBuilder;for(Va=0;Va<la.length;Va++)Ia.append(la.J(Va).toString()+",");la=new Sys.StringBuilder;for(Va=0;Va<va.length;Va++)la.append(va.J(Va).toString()+",");k.a.instance.vja(571619423,1,4,za+" revision: Added references",Ia.toString());k.a.instance.vja(571619424,1,4,za+" revision: Deleted references",la.toString())}j2m(qa,
Ia,Va,Na){const za=Va.Hl();for(let va=0;va<za.length;va++){const ia=za[va];if(this.Nui(ia)){var la=this.Ud.getPropertyObjectIds(Va,ia);this.s4m(qa,Ia,Na,ia,la)}else this.dAi(ia)&&(la=this.Ud.getPropertyObjectId(Va,ia),this.r4m(qa,Ia,Na,ia,la))}}FKi(qa,Ia,Va){Va("LogNestedReferences");Va=new n.a;const Na=new u.a;for(let za=0;za<qa.length;za++){const la=qa.J(za);this.$Kf(la,Va,Na,Ia)}for(Ia=0;Ia<Va.length;Ia++)qa.add(Va.J(Ia))}$Kf(qa,Ia,Va,Na){const za=Na(qa);if(za){const va=za.Hl();for(let ia=0;ia<
va.length;ia++){var la=va[ia];if(this.Nui(la)){la=this.Ud.getPropertyObjectIds(za,la);for(let pa=0;pa<la.length;pa++)Va.contains(la.J(pa))||(Ia.add(la.J(pa)),Va.add(la.J(pa)),this.$Kf(la.J(pa),Ia,Va,Na))}else this.dAi(la)&&(la=this.Ud.getPropertyObjectId(za,la),Va.contains(la)||(Ia.add(la),Va.add(la),this.$Kf(qa,Ia,Va,Na)))}}}s4m(qa,Ia,Va,Na,za){if(this.Ud.hasProperty(Va,Na)){Va=this.Ud.getPropertyObjectIds(Va,Na);const la=Va.TG();Na=za.TG();for(let va=0;va<za.length;va++)la.contains(za.J(va))||qa.add(za.J(va));
for(qa=0;qa<Va.length;qa++)Na.contains(Va.J(qa))||Ia.add(Va.J(qa))}else for(Ia=0;Ia<za.length;Ia++)qa.add(za.J(Ia))}r4m(qa,Ia,Va,Na,za){za&&(this.Ud.hasProperty(Va,Na)?(Va=this.Ud.getPropertyObjectId(Va,Na),za.equals(Va)||(qa.add(za),Ia.add(Va))):qa.add(za))}z5m(qa){k.a.instance.Ta(4535064,1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",qa.input.OJb,qa.output.crash,qa.output.timeout)}G5m(qa,Ia,Va,Na,za,la,va){if(qa){qa=Na.length?Na.$f(Na.length-1):null;var ia=za.length?za.$f(za.length-
1):null;Va=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",Ia.input.OJb,Na.length,qa?qa.id:z.a.nil,qa?qa.SW?qa.SW.id:z.a.nil:z.a.nil,za.length,ia?ia.id:z.a.nil,ia?ia.SW?ia.SW.id:z.a.nil:z.a.nil,la,va,this.Pdc,Va);switch(Ia.input.source){case 5:k.a.instance.Ta(51663493,1,4,Va);break;default:k.a.instance.Ta(4051606,
1,4,Va)}}}D5m(qa,Ia,Va){if(qa)switch(qa=this.mOc(Ia,Va,"Succeeded"),Ia.input.source){case 5:k.a.instance.Ta(51663494,1,4,qa);break;default:k.a.instance.Ta(4059162,1,4,qa)}}F5m(qa,Ia){Ia=this.mOc(qa,Ia,"Timeout");switch(qa.input.source){case 5:k.a.instance.Ta(51663495,1,4,Ia);break;default:k.a.instance.Ta(4059163,1,2,Ia)}}B5m(qa,Ia){Ia=this.mOc(qa,Ia,"Rejection");switch(qa.input.source){case 5:k.a.instance.Ta(51663496,1,4,Ia);break;default:k.a.instance.Ta(4059164,1,2,Ia)}}E5m(qa,Ia){Ia=this.mOc(qa,
Ia,"Crash - Rejection");switch(qa.input.source){case 5:k.a.instance.Ta(51663497,1,4,Ia);break;default:k.a.instance.Ta(4059165,1,2,Ia)}}C5m(qa,Ia){Ia=this.mOc(qa,Ia,"Crash - Failed");switch(qa.input.source){case 5:k.a.instance.Ta(51663498,1,4,Ia);break;default:k.a.instance.Ta(4059166,1,2,Ia)}}mOc(qa,Ia,Va){const Na=qa.output.LM,za=Na&&Na.length?Na.$f(Na.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",
qa.input.OJb,Va,this.kEa()-qa.input.CTa,Ia,Na?Na.length:0,za?za.id:z.a.nil,za?za.SW?za.SW.id:z.a.nil:z.a.nil,qa.input.source)}ocl(qa,Ia,Va,Na,za,la,va){const ia=new W.a,pa=ia.input;pa.h$=qa;pa.JUa=Ia;pa.nm=Va;pa.Sha=Na;pa.xGb=za;pa.source=la;pa.TLc=va;pa.CTa=this.kEa();ia.logger.Aoo(pa.CTa);qa=ia.runtime;qa.x8c=k.a.instance.Y9(1,5);qa.Hie=k.a.instance.Y9(1,4);let sa="";qa.SG=Ha=>{if(this.Pdc){var ra=this.kEa()-pa.CTa,Ma=ra>this.Pdc;sa+=String.format(" ({0}: {1})",Ha,ra);Ma&&(ia.output.timeout=!0,
Ha=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",pa.OJb,this.Pdc,Ha,ra,sa),k.a.instance.Ta(528061012,1,2,Ha),this.HKo(Ha))}};return ia}YOc(){return[Object(I.a)(this,this.Eyn,"otherAuthorsHaveChangesToMerge"),Object(I.a)(this,this.tNm,"isInputValid"),Object(I.a)(this,this.wAm,"initializeOutputMergeState"),Object(I.a)(this,this.PWd,"initializeRuntimeMergeState"),Y.a.uGn,Object(I.a)(this,this.tGn,"preProcessTableStructure"),
Object(I.a)(this.MDh,this.MDh.gdn,"mergeChildNodeLists"),Object(I.a)(this,this.xQo,"tryObjectMerge"),Y.a.$Fn,Object(I.a)(this,this.SCl,"finalizeObjectMerge"),Object(I.a)(this,this.I2o,"validateMarkers"),Object(I.a)(this,this.Wtk,"addMergeResultsToOutput")]}Eyn(qa){const Ia=qa.input.h$;qa=qa.output;return Ia?Ia.length?!0:(k.a.instance.Ta(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),qa.LM=Ia,qa.succeeded=!0,!1):(k.a.instance.Ta(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),
qa.LM=Ia,qa.succeeded=!0,!1)}tNm(qa){var Ia=qa.input;const Va=Ia.h$,Na=Ia.JUa,za=Ia.nm,la=Ia.Sha;Ia=Ia.xGb;qa=qa.output;if(!Na||!Na.length)return k.a.instance.Ta(42350233,1,5,"IsInputValid: No local changes to merge."),qa.LM=Va,qa.succeeded=!0,!1;let va=!0;if(2!==la&&1!==la)return qa.LM=Va,!1;za&&za!==z.a.nil||(va=!1);Va.length<(Ia?2:1)&&(k.a.instance.Ta(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",
Ia),va=!1);va||(qa.LM=2===la?Va:Na);return va}PWd(qa){var Ia=qa.input,Va=Ia.h$,Na=Ia.JUa,za=Ia.Sha,la;let va;({vjg:la,nqg:va,YCa:Ia}=this.yrf(qa,Va,Na,Ia.xGb));if(!Ia)return k.a.instance.Ta(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",la.id,va.id),qa.logger.Og(Object.assign(new J.a,{rj:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.cLi(la,Va.length,"TheirChanges"),this.cLi(va,Na.length,
"YourChanges"),qa.output.LM=2===za?Va:Na,!1;qa.runtime.YCa=Ia;({gSo:Va,VAl:Na}=this.jnl(za,la,va));({hSo:Ia,WAl:za,mKk:la}=this.p4l(qa,Va,Na,Ia));qa.runtime.uk=la;qa.runtime.Jq=Ia;qa.runtime.Eu=za;qa.runtime.en=new w.a;qa.runtime.PLd=Na.id;qa.runtime.Ene=Va.id;qa.runtime.Qlb=new w.a;qa.runtime.pNa=new u.a;qa.runtime.Ndf=new w.a;qa.runtime.$Ab=new w.a;qa.runtime.dig=new w.a;qa.runtime.Oce=new aa;qa.runtime.E4d=new n.a;qa.runtime.$Xf=new u.a;qa.runtime.skc=new n.a;qa.runtime.Xb=qa.input.TLc(qa);qa.runtime.Xb.$Dc(1000001,
"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",l.a.DJo);qa.runtime.Xb.$Dc(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",l.a.JLo);qa.runtime.Xb.$Dc(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",l.a.EAl);qa.runtime.Xb.$Dc(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",l.a.L_n);qa.runtime.Xb.$Dc(1000010,"Microsoft.Office.WordOnline.MergeLcsInfLoopFix",
"79ee6190;i588c310",l.a.udn);qa.runtime.Hri=!0;E.AFrameworkApplication.K&&(this.k3g=E.AFrameworkApplication.K.mc("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}cLi(qa,Ia,Va){const Na=new n.a;for(;qa;)Na.add(qa),qa=qa.SW;const za=new Sys.StringBuilder;za.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",Va,Ia,Na.length));let la=Na.length,va=0;Na.forEach(ia=>({npi:la,CLi:va}=this.Lvk(za,ia,Na,la,va)).returnValue);k.a.instance.Ta(4273302,1,4,za.toString())}Lvk(qa,
Ia,Va,Na,za){qa.append(String.format(" [{0} {1} {2}]",Na,Ia.Qwa?"S":"B",Ia.id));Na--;za++;return 50<za&&Va.length!==za?(qa.append(" ...Truncated."),{returnValue:!1,npi:Na,CLi:za}):{returnValue:!0,npi:Na,CLi:za}}yrf(qa,Ia,Va,Na){Ia=Ia.$f(Ia.length-1-(Na?1:0));Va=Va.$f(Va.length-1);Na=Ia.R0a(Va);qa.runtime.SG("GetCommonBase");qa.logger.Lha("GetCommonBase");return{vjg:Ia,nqg:Va,YCa:Na}}p4l(qa,Ia,Va,Na){let za,la;({result:za}=Ia.Xdc(Na));qa.runtime.SG("GetUnfavoredChanges");qa.logger.Lha("GetUnfavoredChanges");
({result:la}=Va.Xdc(Na));5===qa.input.source&&(qa.runtime.ZAl=M.a.Cfi(Va),qa.runtime.jSo=M.a.Cfi(Ia));qa.runtime.SG("GetFavoredChanges");qa.logger.Lha("GetFavoredChanges");Ia=new G.a(Object(I.a)(Na,Na.n1a,"getMergeableObject"));qa.runtime.SG("GetModifiedObjects");qa.logger.Lha("GetModifiedObjects");return{hSo:za,WAl:la,mKk:Ia}}jnl(qa,Ia,Va){2===qa?(qa=Ia,Ia=Va):qa=Va;return{gSo:Ia,VAl:qa}}wAm(qa){const Ia=qa.input,Va=Ia.h$,Na=Ia.JUa;qa.output.LM=(2===Ia.Sha?Va:Na).n5();qa.runtime.SG("InitializeOutputMergeState");
qa.logger.Lha("InitializeOutputMergeState");return!0}Wtk(qa){var Ia=qa.input.nm;const Va=qa.runtime.en,Na=qa.output.LM;Ia=this.pcl(qa,Na.$f(Na.length-1),Ia,z.a.create());this.nCl(qa,Ia,Va);Na.add(Ia);return qa.output.succeeded=!0}pcl(qa,Ia,Va,Na){qa.runtime.Hie&&k.a.instance.Ta(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",Va,Na);qa=this.G9n(Na);qa.LKk(Ia,Va);return qa}nCl(qa,Ia,Va){qa.runtime.Hie&&k.a.instance.Ta(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",
Va.count);Va.forEach((Na,za)=>{Ia.nvk(za.wm);return!0})}pIb(qa){if(!qa)return k.a.instance.Ta(573957952,1,2,"Feature helper is null"),!1;qa.Az(105);return qa.isFeatureEnabled(105)}tGn(qa){if(!this.pIb(qa.runtime.Xb))return!0;const Ia=qa.runtime.Eu,Va=qa.runtime.Jq,Na=qa.runtime.uk;let za=!0;Ia.forEach((la,va)=>{393252===va.Rc&&(za=this.c3i(qa,la,va,Na,Ia));return za});if(!za)return!1;Va.forEach((la,va)=>{393252===va.Rc&&(za=this.c3i(qa,la,va,Na,Va));return za});qa.logger.Lha("PreProcessTableStructure");
return za}c3i(qa,Ia,Va,Na,za){const la=null==this.Ud.getPropertyBool(Va,f.a.ghostCell)?!1:this.Ud.getPropertyBool(Va,f.a.ghostCell),va=null==this.Ud.getPropertyUint32(Va,f.a.rowSpan)?1:this.Ud.getPropertyUint32(Va,f.a.rowSpan),ia=null==this.Ud.getPropertyUint32(Va,f.a.colSpan)?1:this.Ud.getPropertyUint32(Va,f.a.colSpan);if(la)return!0;var pa=Na.J(Ia);if(pa){Na=null==this.Ud.getPropertyBool(pa,f.a.ghostCell)?!1:this.Ud.getPropertyBool(pa,f.a.ghostCell);var sa=null==this.Ud.getPropertyUint32(pa,f.a.rowSpan)?
1:this.Ud.getPropertyUint32(pa,f.a.rowSpan);var Ha=null==this.Ud.getPropertyUint32(pa,f.a.colSpan)?1:this.Ud.getPropertyUint32(pa,f.a.colSpan);Na=Na!==la;sa=sa!==va;Ha=Ha!==ia}else Ha=sa=Na=!0;const ra=oa.e(qa,Va,za);if(ra.equals(z.a.nil))return k.a.instance.Ta(573957953,1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",Ia),qa.logger.Og(Object.assign(new na.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let Ma=qa.runtime.$Ab.J(ra);Ma||(qa.runtime.$Ab.Z(ra,
new w.a),Ma=qa.runtime.$Ab.J(ra));let ya=Ma.J(Ia),Ga=new n.a;const wa=new n.a,hb=new n.a;Na&&(ya||(Ga=this.Ud.getPropertyObjectIds(Va,a.a.ef)));if(sa||Ha)if(ya){if(ya.hg)return k.a.instance.Ta(573957961,1,4,"Table cell has conflicting ghostcell properties we are not handling"),qa.logger.Og(Object.assign(new na.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),!1;if(null!=ya.rowSpan&&va!==ya.rowSpan||null!=ya.colSpan&&ia!==ya.colSpan)return k.a.instance.Ta(573957962,1,
4,"Same table cell has different rowSpan/colSpan in conflicting revisions"),qa.logger.Og(Object.assign(new na.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),!1}else{var eb;({rowIndex:Va,h3b:eb}=oa.b(qa,za,Va));if(-1===Va||-1===eb)return k.a.instance.Ta(573957954,1,2,"Table cell location could not be found. Table Cell ID: {0}",Ia),qa.logger.Og(Object.assign(new na.a,{info:"Table cell location could not be found"})),!1;for(var jb=Va;jb<Va+va;jb++)for(var ub=eb;ub<
eb+ia;ub++){var ab=oa.c(qa,ra,jb,ub);if(ab.equals(z.a.nil))return k.a.instance.Ta(573957955,1,4,"Other revision deleted the table cells this revision is trying to merge"),qa.logger.Og(Object.assign(new na.a,{info:"Ghost cell not found in the table bounds"})),!1;var Ea=za.pz(ab,qa.runtime.uk.J(ab));if(!Ea)return k.a.instance.Ta(573957956,1,4,"Other revision has inserted cells in between the cells this revision is trying to merge"),qa.logger.Og(Object.assign(new na.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),
!1;if(!ab.equals(Ia)){if(null==this.Ud.getPropertyBool(Ea,f.a.ghostCell)||!this.Ud.getPropertyBool(Ea,f.a.ghostCell))return k.a.instance.Ta(573957957,1,4,"Other revision deleted some of the cells this revision is trying to merge"),qa.logger.Og(Object.assign(new na.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),!1;var Wa=Ma.J(ab);if(Wa)return k.a.instance.Ta(573957958,1,4,"The ghost cell is already merged with some other cells in the other revision"),qa.logger.Og(Object.assign(new na.a,
{info:"Ghost cell is already merged with some other cell"})),!1;wa.add(ab);Wa=new fa;Wa.hg=!0;Ea=this.Ud.getPropertyUint32(Ea,f.a.colSpan);null!=Ea&&(Wa.colSpan=Ea);Ma.Z(ab,Wa)}}if(pa&&(null==this.Ud.getPropertyBool(pa,f.a.ghostCell)||!this.Ud.getPropertyBool(pa,f.a.ghostCell))&&(za=null==this.Ud.getPropertyUint32(pa,f.a.rowSpan)?1:this.Ud.getPropertyUint32(pa,f.a.rowSpan),Va=null==this.Ud.getPropertyUint32(pa,f.a.colSpan)?1:this.Ud.getPropertyUint32(pa,f.a.colSpan),za>va||Va>ia)){jb=eb=-1;({rowIndex:eb,
h3b:jb}=oa.a(qa,null,pa,eb,jb));if(-1===eb||-1===jb)return k.a.instance.Ta(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",Ia),qa.logger.Og(Object.assign(new na.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;pa=wa.TG();for(ub=eb;ub<eb+za;ub++)for(ab=jb;ab<jb+Va;ab++){Wa=oa.d(qa,null,ra,ub,ab);if(!Wa)return k.a.instance.Ta(573957960,1,2,"Table cell could not be found within table bounds"),qa.logger.Og(Object.assign(new na.a,
{info:"Ghost cell not found in the table bounds"})),!1;Wa.id.equals(Ia)||pa.contains(Wa.id)||hb.add(Wa.id)}}}!ya&&(Na||sa||Ha)&&(k.a.instance.Ta(573957963,1,4,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",Ia),ya=new fa,ya.rowSpan=va,ya.colSpan=ia,ya.hg=la,ya.q6d=Ga,ya.fwf=wa,ya.xRf=hb,Ma.add(Ia,ya));return!0}xQo(qa){return this.iDj(qa,!1)}SCl(qa){return this.iDj(qa,!0)}iDj(qa,Ia){const Va=qa.runtime,Na=Va.uk,za=Va.Eu,la=Ia?Va.Ndf:Va.Jq,va=Va.en;let ia=
!0;const pa=qa.runtime.x8c;let sa=0,Ha=0,ra=0;la.forEach((Ma,ya)=>{pa&&k.a.instance.Ta(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",Ma,ya.Rc,Ia);Ha++;this.k3g===Ha&&(sa++,qa.runtime.SG(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",sa,ra,Ia)),Ha=0);if(qa.runtime.Xb&&qa.runtime.Xb.qib(1000005)&&qa.runtime.skc.contains(ya.id,(hb,eb)=>hb.equals(eb))||this.eAo(ya.Rc))return!0;if(!Ia&&this.Njl(ya.Rc,qa.runtime.Xb))return Va.Ndf.Z(Ma,ya),!0;var Ga=
za.get(Ma);if(!Ga)return va.mb(Ma)?va.J(Ma).MOi(ya):va.Z(Ma,new ba.a(ya,!1)),!0;if(!Na.J(Ma)&&!this.Xdn(Ga.Rc)){var wa=!!qa.input.h$&&!!qa.input.h$.last()&&qa.input.h$.last().o4(Ma);const hb=!!qa.input.JUa&&!!qa.input.JUa.last()&&qa.input.JUa.last().o4(Ma),eb=new U.a(Ga,ya);if(!eb.aY)return va.Z(Ma,new ba.a(Ga,!1)),!0;k.a.instance.Ta(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",
Ma,ya.Rc,Ia,wa,hb,!eb.aY,qa.input.source);qa.logger.Og(Object.assign(new J.a,{rj:"GraphMerger.TryObjectMerge",eventId:"ap3k8"}));return ia=!1}wa=va.pz(Ma,new ba.a(Na.J(Ma)));({Xk:Ga,returnValue:ia}=this.Klm.merge(qa,this.fli,this.Ud,wa,Ga,ya));ra++;ia&&(qa.runtime.SG(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",Ma,ya.Rc,ra,sa,Ia)),Ga&&(va.mb(Ga.wm.id)?va.J(Ga.wm.id).MOi(Ga.wm):va.Z(Ga.wm.id,Ga)));return ia});qa.logger.Lha("ObjectMerge");pa&&
k.a.instance.Ta(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",la.count,ra,Ia);return ia}I2o(qa){try{for(let Ia=0;Ia<qa.runtime.E4d.length;Ia++){const Va=qa.runtime.E4d.J(Ia);if(qa.runtime.en.J(Va)){if(!this.DOm(qa,Va))return!1}else k.a.instance.Ta(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");qa.runtime.SG("Validate markers taking too long")}}catch(Ia){k.a.instance.Ta(559535579,1,2,"ValidateMerge threw an exception: {0}",Ia)}return qa.logger.WYc.ani()?
!1:!0}jvo(qa){return 38===qa||39===qa||40===qa||41===qa||44===qa||45===qa||33===qa||34===qa?!1:!0}D3l(qa){switch(qa){case 38:case 39:case 40:case 41:return f.a.ke;case 44:case 45:return f.a.WBd;case 33:case 34:return f.a.ak}return H.CommonProperties.nil}H2o(qa,Ia){const Va=this.Ud.getPropertyUint32(qa,f.a.jt);if(!Va||this.jvo(Va))return!0;qa=this.Ud.getPropertyObjectId(qa,this.D3l(Va));return ja.W7b(Ia,qa)?!0:(Ia.logger.WYc.xXd=Va,!1)}DOm(qa,Ia){if(qa.runtime.$Xf.contains(Ia))return!1;if(Ia=ja.W7b(qa,
Ia)){Ia=this.Ud.getPropertyObjectIds(Ia,a.a.Gn);for(let Va=0;Va<Ia.length;Va++){const Na=ja.W7b(qa,Ia.$f(Va));if(Na&&!this.H2o(Na,qa))return!1}}return!0}eAo(qa){switch(qa){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}Njl(qa,Ia){let Va=!1;if(1074135145===qa)return!0;Ia&&Ia.Az(123);Ia&&Ia.isFeatureEnabled(123)&&1074135153===qa&&(Va=!0);return Va}Xdn(qa){switch(qa){case 1074135162:return!0}return!1}Fel(qa,Ia){const Va=new n.a,Na=new n.a,za=
new n.a;var la=qa.runtime.YCa;const va=la?la.id:z.a.nil;this.WJf(la).forEach(ia=>{Va.add(Ia(ia));return!0});la=qa.input.h$.$f(qa.input.h$.length-1);this.WJf(la,va).forEach(ia=>{Na.add(Ia(ia));return!0});qa=qa.input.JUa.$f(qa.input.JUa.length-1);this.WJf(qa,va).forEach(ia=>{za.add(Ia(ia));return!0});return{lKk:Va,jKo:Na,V8o:za}}WJf(qa,Ia=null){const Va=new n.a;Ia||(Ia=z.a.nil);for(;qa&&!Ia.equals(qa.id);)Va.add(qa),qa=qa.SW;Va.reverse();return Va}pGo(qa){const Ia=3===this.GTd;let Va=!1;!qa.output.succeeded&&
(2===this.GTd||qa.output.crash&&1===this.GTd)&&(Va=!0);let Na=!1;qa.input.h$&&0<qa.input.h$.length&&(Ia||Va)&&qa.runtime.Eu&&qa.runtime.uk&&qa.runtime.Xb&&(Na=qa.runtime.Xb.isFeatureEnabled(51));return Na}Nui(qa){return 9===N.a.iib(N.a.Bmf(qa))}dAi(qa){return 8===N.a.iib(N.a.Bmf(qa))}static fZl(qa){return qa.output.crash?2:qa.output.succeeded?3:1}static W7b(qa,Ia){if(!Ia||Ia===z.a.nil)return null;const Va=qa.runtime.en.J(Ia);return Va?Va.wm:qa.runtime.uk.J(Ia)}}ja.ETd=z.a.Ef("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");
Object(F.a)(ja,"GraphMergerBase",null,[1561])},1782:function(F,K,c){F=c(0);var l=c(221),f=c(1636),a=c(181),k=c(1548);class x extends f.a{constructor(n,u,z,w,E,G,H,L,I,N,Q,M,J,V){super(n,3,u,z,w,E,G,L,I,N,Q,M,J,V);this.sve=H}get character(){return this.sve}get text(){return this.character.toString()}Z7c(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}u7b(){return"CharRun"}clone(){return new x(this.qEc,this.source,this.Mj,this.Ag,this.runId,this.jJ,this.character,
this.Olb,this.vQa,this.Sba,this.KEa,this.gSa,this.yF,this.du)}GA(n,u,z,w=!1){return super.GA(n,u,z,w)?n.character===this.character?!0:k.a.Wuh(n.character,this.character):!1}}Object(F.a)(x,"CharRunMergeBlock",f.a,[]);c.d(K,"a",function(){return y});class y extends f.a{constructor(n,u,z,w,E,G,H,L,I,N,Q,M,J,V,X){super(n,1,u,z,w,E,G,L,N,Q,M,J,V,X);this._text=H;this.pUe=I}get text(){return this._text}Z7c(n){this._text=n}get o7a(){return this.pUe&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",
super.toString(),this.pUe)}u7b(){return"TextRun"}clone(){return new y(this.qEc,this.source,this.Mj,this.Ag,this.runId,this.jJ,this._text,this.Olb,this.pUe,this.vQa,this.Sba,this.KEa,this.gSa,this.yF,this.du)}GA(n,u,z,w=!1){return super.GA(n,u,z,w)?k.a.Vuh(this._text,n._text):!1}s9c(){const n=new l.a;for(let z=0;z<this.text.length;z++){var u=k.a.charAt(this._text,z);if(k.a.aUm(k.a.tLo(u))){let w="";w+=u;u=k.a.charAt(this._text,++z);w+=u;u=new y(this.qEc,this.source,this.Mj,this.Ag,this.runId,this.jJ,
w,this.Olb,!1,this.vQa,this.Sba,this.KEa,this.gSa,this.yF,this.du);n.add(u)}else u=new x(this.qEc,this.source,this.Mj,this.Ag,this.runId,this.jJ,u,this.Olb,this.vQa,this.Sba,this.KEa,this.gSa,this.yF,this.du),n.add(u)}return n}}Object(F.a)(y,"TextRunMergeBlock",f.a,[])},1783:function(F,K,c){F=c(0);var l=c(1014),f=c(16),a=c(364),k=c(221);c(58);c(798);var x=c(598),y=c(165),n=c(181),u=c(1037),z;(function(L){L[L.none=0]="none";L[L.browser=1]="browser";L[L.serverPutChanges=2]="serverPutChanges";L[L.syncDiff=
3]="syncDiff";L[L.docxMerge=4]="docxMerge";L[L.undo=5]="undo"})(z||(z={}));Object(F.b)("GraphMergeSource",z);var w=c(1769),E=c(1564),G=c(1763);c.d(K,"a",function(){return H});class H{constructor(L){this.fB=new u.a;this.cW=new a.a;this.hjh=new a.a(0);this.ped=new k.a;this.OYg=new k.a;this.L7g=new k.a;this.$4g=new k.a;this.V6g="";this.aWa=null;this.es=this.AIe=0;this.drd=new a.a(0);this.RAe=this.hah=this.Wnd=0;const {MarkerValidation:I}=c(1878);this._state=L;this.lbk=new I}get WYc(){return this.lbk}get s5i(){return this.aWa}Aoo(L){this.AIe=
L}g3d(L,I){this.V6g=String.format("{0}-{1}",L,I)}uhe(L){this.UYk();this.RAe=L}ubg(){this.RAe=0}UYk(){this.aWa&&this.ped.add(this.aWa);this.aWa=null}Og(L){this.aWa||(this.aWa=L);switch(this.RAe){case 1:this.OYg.add(L);break;case 2:this.L7g.add(L);break;case 3:this.$4g.add(L);break;default:this.aWa&&this.ped.add(L)}}DJi(L){this.ped.add(L)}A5m(){this.es=this.kEa();this.Lha("MergeEnd")}Lha(L){const I=this.kEa();this.hjh.Z(L,I-this.AIe);this.AIe=I}Amo(){this.Wnd=this.kEa();this.hah++}AU(L){const I=this.kEa();
let N;({value:N}=this.drd.Dc(L)).returnValue?(N+=I-this.Wnd,this.drd.Z(L,N)):this.drd.Z(L,I-this.Wnd);this.Wnd=I}S3l(){this.cW.Z("Id",this._state.input.OJb.toString());this.cW.Z("Source",z[this._state.input.source]);this.cW.Z("RevSummary",H.HUa(this.cbm()));this.cW.Z("NodesRolledBackIfFailed",H.HUa(this.T5l()));if(!this._state.output.succeeded){let L,I,N,Q,M;({nKk:L,XAl:I,iSo:N,sKk:Q,kSo:M}=this.XCl(this._state.runtime));this.cW.Z("CharactersLost",this.BQl(L,I,N));this.cW.Z("CharactersLostInComments",
this.FRl());this.cW.Z("CharactersLostInTables",this.fNl(M,Q))}this.cW.Z("FuncStep",this.V6g);this.cW.Z("FailureDetail",H.HUa(this.xEb()));this.cW.Z("FailDetailHints",this.zPd(this.OYg));this.cW.Z("FailDetailNaiveMerge",this.zPd(this.L7g));this.cW.Z("FailDetailLcs",this.zPd(this.$4g));this.cW.Z("ExtraDetails",this.zPd(this.ped));this.cW.Z("Timeline",H.HUa(this.hjh));this.cW.Z("ParagraphMergesCount",this.hah);this.cW.Z("ParagraphMergeDurations",H.HUa(this.drd));this.cW.Z("MarkerInfo",H.HUa(this.WYc.m8h()));
this.cW.Z("Result",H.HUa(this.U3l()));return JSON.stringify(H.HUa(this.cW))}kEa(){return(new Date).getTime()}cbm(){const L=new a.a;let I,N,Q;({vjg:I,nqg:N,YCa:Q}=this.yrf(this._state,this._state.input.h$,this._state.input.JUa,this._state.input.xGb));L.Z("hasBase",Q?"true":"false");if(Q){let M=0,J=0;for(;I&&!I.id.equals(Q.id);)M++,I=I.SW;for(;N&&!N.id.equals(Q.id);)J++,N=N.SW;L.Z("lenToBaseTheirs",I?M:-1);L.Z("lenToBaseYours",N?J:-1)}return L}yrf(L,I,N,Q){L=I.$f(I.length-1-(Q?1:0));I=(N=N.$f(N.length-
1))&&L?L.R0a(N):null;return{vjg:L,nqg:N,YCa:I}}T5l(){if(!this._state.runtime.Hri)return null;const L=this._state.runtime.Jq,I=new a.a(0);L.forEach((N,Q)=>{({value:N}=I.Dc(Q.Rc.toString()));I.Z(Q.Rc.toString(),N+1);return!0});return I}BQl(L,I,N){let Q=null,M=null,J=null;const V=this._state.runtime.Jq;let X=0;try{J=new G.a(this.fB,this._state);Q=E.b(L,I,N);M=new x.a;for(L=0;L<Q.length;L++)if(!Q.J(L).Rzb.eq(Q.J(L).oqb,(W,U)=>W.equals(U))){const W=this.lSh(Q.J(L),J);X+=W;M.add(Q.J(L))}Q&&V.forEach((W,
U)=>{if(393230===U.Rc){U=null;for(let Y=0;Y<Q.length;Y++)if(!M.contains(Q.J(Y))&&Q.J(Y).oqb.contains(W,(ba,aa)=>ba===aa)){U=Q.J(Y);break}U&&(W=this.lSh(U,J),M.add(U),X+=W)}return!0});return X}catch(W){return y.a.instance.Ta(579190992,1,2,"Exception in GetCharactersLost: "+W.toString()),-1}}XCl(L){let I,N,Q,M,J;L.SG=X=>{if(750<this.kEa()-this._state.input.CTa)throw y.a.instance.Ta(579190991,1,2,"Timed out while calculating characters lost: {0}",X),n.a.invalidOperation(X);};I=new k.a;N=new k.a;Q=new k.a;
M=new k.a;const V=new k.a;J=new k.a;try{if(L.uk){const X=L.uk.J(w.ChildNodeListMerge.D9d);let W,U;W=L.Eu.J(w.ChildNodeListMerge.D9d)||X;U=L.Jq.J(w.ChildNodeListMerge.D9d)||X;this.vkf(X,Y=>L.uk.J(Y),I,M);this.vkf(W,Y=>L.Eu.J(Y)||L.uk.J(Y),N,V);this.vkf(U,Y=>L.Jq.J(Y)||L.uk.J(Y),Q,J)}}catch(X){y.a.instance.Ta(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+X.toString())}return{nKk:I,XAl:N,iSo:Q,sKk:M,kSo:J}}fNl(L,I){try{let Q=0;const M=this._state.runtime;var N=X=>M.Jq.J(X)||M.uk.J(X);const J=
new x.a,V=this.IEl(L,M,N,J);for(L=0;L<V.count;L++){let X=V.keys.J(L);const W=V.J(X);if(!J.contains(X)){let U=this.Phi(M,N,J,X,W);if(-1!==U)Q+=U;else return y.a.instance.Ta(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(N=0;N<I.length;N++){let X=I.J(0);if(!J.contains(X)){let W=this.WSd(M.uk.J(X));if(-1===W)return y.a.instance.Ta(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;Q+=W}}return Q}catch(Q){return y.a.instance.Ta(573089735,
1,2,"Exception in GetAllTablesCharactersLost: "+Q.toString()),-1}}Phi(L,I,N,Q,M){L.SG("GetTableCharactersLost");let J=0;M=this.fB.getPropertyObjectIds(M,f.a.ef);for(let Y=0;Y<M.length;Y++){var V=I(M.J(Y));V=this.fB.getPropertyObjectIds(V,f.a.ef);for(let ba=0;ba<V.length;ba++){var X=I(V.J(ba));if(L.uk.J(M.J(Y))&&L.uk.J(V.J(ba))){var W=L.uk.J(V.J(ba));if(!W)return y.a.instance.Ta(573089737,1,2,"Base cell unexpectedly null"),-1;X=this.fB.getPropertyObjectIds(W,f.a.ef);var U=L.Eu.J(V.J(ba))||L.uk.J(V.J(ba));
U=this.fB.getPropertyObjectIds(U,f.a.ef);W=this.fB.getPropertyObjectIds(W,f.a.ef);X=E.b(X,U,W);for(W=0;W<X.length;W++){U=X.J(W);const aa=this.Pfm(L,I,N,U);if(-1===aa)return y.a.instance.Ta(573089738,1,2,"Error getting characters lost for parition {0}",U.toString()),-1;J+=aa}}else{W=this.Agm(I,X,N);if(-1===W)return y.a.instance.Ta(573089736,1,2,"Error getting text length of cell {0}",X.id.toString()),-1;J+=W}}}N.add(Q);return J}Pfm(L,I,N,Q){let M=0;var J=new k.a,V=new k.a;const X=new a.a;new a.a;for(var W=
0;W<Q.Rzb.length;W++){var U=L.uk.J(Q.Rzb.J(W));U=this.fB.getPropertyObjectIds(U,f.a.MK);if(1!==U.length)return y.a.instance.Ta(573089739,1,2,"Unexpected number of ContentNodes: {0}",U.length),-1;var Y=L.uk.J(U.J(0));393230===Y.Rc?J.add(Y):393250===Y.Rc&&X.add(U.J(0),Y)}for(W=0;W<Q.oqb.length;W++){U=I(Q.oqb.J(W));U=this.fB.getPropertyObjectIds(U,f.a.MK);if(1!==U.length)return y.a.instance.Ta(573089740,1,2,"Unexpected number of ContentNodes: {0}",U.length),-1;Y=I(U.J(0));if(393230===Y.Rc)V.add(Y);else if(393250===
Y.Rc){Y=this.Phi(L,I,N,U.J(0),Y);if(-1===Y)return y.a.instance.Ta(573089741,1,2,"Error diffing table {0}",U.J(0).toString()),-1;M+=Y}}W=new G.a(this.fB,this._state);if(0<J.length&&0<V.length){J=W.s_h(J,ba=>L.uk.J(ba),V,ba=>I(ba));if(-1===J)return y.a.instance.Ta(573089742,1,2,"Problem diffing parition {0} with LCS",Q.toString()),-1;M+=J}else if(0<J.length)for(Q=0;Q<J.length;Q++)M+=this.fB.getPropertyString(J.J(Q),f.a.lo).length+1;else if(0<V.length)for(Q=0;Q<V.length;Q++)M+=this.fB.getPropertyString(V.J(Q),
f.a.lo).length+1;for(Q=0;Q<X.count;Q++)if(J=X.keys.J(Q),!N.contains(J)){V=this.WSd(X.J(J));if(-1===V)return y.a.instance.Ta(573089743,1,2,"Error getting length of table {0}",J.toString()),-1;M+=V}return M}Agm(L,I,N){let Q=0;I=this.fB.getPropertyObjectIds(I,f.a.ef);for(let V=0;V<I.length;V++){var M=L(I.J(V));M=this.fB.getPropertyObjectIds(M,f.a.MK);if(1!==M.length)return y.a.instance.Ta(573089744,1,2,"Unexpected number of ContentNodes: {0}",M.length),-1;var J=L(M.J(0));if(393230===J.Rc)Q+=this.fB.getPropertyString(J,
f.a.lo).length+1;else if(393250===J.Rc){J=this.WSd(J);if(-1===J)return y.a.instance.Ta(573089745,1,2,"Problem finding text length of table {0}",M.J(0).toString()),-1;Q+=J;N.add(M.J(0))}}return Q}WSd(L){this._state.runtime.SG("GetTextLengthOfTable");let I=0;const N=X=>this._state.runtime.Jq.J(X)||this._state.runtime.uk.J(X);L=this.fB.getPropertyObjectIds(L,f.a.ef);for(let X=0;X<L.length;X++){var Q=N(L.J(X));Q=this.fB.getPropertyObjectIds(Q,f.a.ef);for(let W=0;W<Q.length;W++){var M=N(Q.J(W));M=this.fB.getPropertyObjectIds(M,
f.a.ef);for(let U=0;U<M.length;U++){var J=N(M.J(U));J=this.fB.getPropertyObjectIds(J,f.a.MK);if(1!==J.length)return y.a.instance.Ta(573089746,1,2,"Unexpected number of ContentNodes: {0}",J.length),-1;var V=N(J.J(0));if(393230===V.Rc)I+=this.fB.getPropertyString(V,f.a.lo).length+1;else if(393250===V.Rc){V=this.WSd(V);if(-1===V)return y.a.instance.Ta(573089747,1,2,"Error finding the text length of table {0}",J.J(0)),-1;I+=V}}}}return I}IEl(L,I,N,Q){const M=new a.a;for(let J=0;J<L.length;J++){let V=
!1;I.Jq.J(L.J(J))&&(V=!0);const X=N(L.J(J)),W=this.fB.getPropertyObjectIds(X,f.a.ef);if(!V)for(let U=0;U<W.length;U++)if(I.Jq.J(W.J(U))){V=!0;break}V?M.add(L.J(J),X):Q.add(L.J(J))}return M}lSh(L,I){return this.kSh(L.Rzb,L.oqb,I)}kSh(L,I,N){const Q=new k.a;for(var M=0;M<L.length;M++)Q.add(this._state.runtime.uk.J(L.J(M)));L=new k.a;for(M=0;M<I.length;M++)L.add(this._state.runtime.Jq.J(I.J(M))||this._state.runtime.uk.J(I.J(M)));return N.s_h(Q,J=>this._state.runtime.uk.J(J),L,J=>this._state.runtime.Jq.J(J)||
this._state.runtime.uk.J(J))}vkf(L,I,N,Q){if(393227===L.Rc){L=this.fB.getPropertyObjectIds(L,f.a.ef);for(let M=0;M<L.length;M++){const J=this.fB.getPropertyObjectIds(I(L.J(M)),f.a.ef);for(let V=0;V<J.length;V++){const X=this.fB.getPropertyObjectIds(I(J.J(V)),f.a.ef);for(let W=0;W<X.length;W++){const U=this.fB.getPropertyObjectIds(I(X.J(W)),f.a.MK);if(1!==U.length)return;const Y=I(U.J(0));393230===Y.Rc?N.add(U.J(0)):393250===Y.Rc?Q.add(U.J(0)):y.a.instance.Ta(573089748,1,2,"Unsupported class id in GetCharactersLost: "+
l.a[Y.Rc])}}}}}wkf(L,I){L=this.fB.getPropertyObjectIds(L,f.a.ef);const N=new k.a;for(let Q=0;Q<L.length;Q++){const M=this.fB.getPropertyObjectIds(I(L.J(Q)),f.a.MK);if(1!==M.length)return null;N.add(M.J(0))}return N}FRl(){let L=0;const I=this._state.runtime,N=I.Jq,Q=J=>I.Jq.J(J)||I.uk.J(J);let M=null;I.SG=J=>{if(750<this.kEa()-this._state.input.CTa)throw y.a.instance.Ta(573089749,1,2,"Timed out while calculating comment characters lost: {0}",J),n.a.invalidOperation(J);};try{N.forEach((J,V)=>{if(1074135127===
V.Rc){J=this.wkf(V,Q);var X=I.uk.J(V.id);if(X)X=this.wkf(X,U=>I.uk.J(U)),M||(M=new G.a(this.fB,this._state)),L+=this.kSh(X,J,M);else for(X=0;X<J.length;X++)L+=this.fB.getPropertyString(I.Jq.J(J.J(X)),f.a.lo).length+1}if(1074135126===V.Rc&&(J=this.fB.getPropertyObjectIds(V,f.a.ef).TG(),V=I.uk.J(V.id)))for(V=this.fB.getPropertyObjectIds(V,f.a.ef),X=0;X<V.length;X++)if(!J.contains(V.J(X))){var W=I.uk.J(V.J(X));W=this.wkf(W,U=>I.uk.J(U));for(let U=0;U<W.length;U++)L+=this.fB.getPropertyString(I.uk.J(W.J(U)),
f.a.lo).length+1}return!0})}catch(J){return y.a.instance.Ta(573089750,1,2,"Exception in GetCommentCharactersLost: "+J.toString()),-1}return L}xEb(){return this.aWa?this.aWa.xEb():null}zPd(L){const I=new k.a;L.forEach(N=>{I.add(H.HUa(N.xEb()));return!0});return I.toArray()}U3l(){const L=new a.a;L.Z("Succeeded",this._state.output.succeeded);L.Z("Timeout",this._state.output.timeout);L.Z("Crash",this._state.output.crash);L.Z("MergedRevisions",this._state.output.LM?this._state.output.LM.length:-1);L.Z("Duration",
this.es-this._state.input.CTa);return L}static HUa(L){if(!L)return null;const I={};L.forEach((N,Q)=>{I[N.toString()]=Q;return!0});return I}}Object(F.a)(H,"MergeLogger",null,[])},1784:function(F,K,c){F=c(0);var l=c(242),f=c(16),a=c(6),k=c(118),x=c(798),y=c(165),n=c(221),u=c(364),z=c(1494);class w{constructor(H,L,I){this.position=H;this.leader=L;this.val=I}equals(H){return this.position===H.position&&this.leader===H.leader&&this.val===H.val}toString(){return this.position.toString()}}Object(F.a)(w,
"TabStop",null,[]);var E=c(1879);c.d(K,"a",function(){return G});class G extends z.a{constructor(){super()}get Mn(){return 20}get qA(){return 0}wk(){const H=super.wk();H.Z(x.a.yb(f.a.lo),1);H.Z(x.a.yb(f.a.Gn),1);H.Z(x.a.yb(f.a.zm),1);H.Z(x.a.yb(a.a.ft),1);H.Z(x.a.yb(a.a.nq),1);H.Z(x.a.yb(a.a.Lc),1);H.Z(x.a.yb(f.a.lpb),1);H.Z(x.a.yb(a.a.qPa),1);H.Z(x.a.yb(a.a.QGa),1);H.Z(x.a.yb(f.a.oxa),1);H.Z(x.a.yb(a.a.fFa),1);H.Z(x.a.yb(a.a.gga),1);H.Z(x.a.yb(a.a.gFa),1);H.Z(x.a.yb(a.a.BDa),1);H.Z(x.a.yb(a.a.hFa),
1);H.Z(x.a.yb(a.a.CDa),1);H.Z(x.a.yb(a.a.PGa),1);H.Z(x.a.yb(a.a.uIa),1);H.Z(x.a.yb(a.a.vIa),1);H.Z(x.a.yb(a.a.aza),1);H.Z(x.a.yb(a.a.Fv),1);H.Z(x.a.yb(a.a.Cz),1);H.Z(x.a.yb(a.a.Dz),1);H.Z(x.a.yb(a.a.xw),1);H.Z(x.a.yb(k.a.EJ),6);H.Z(x.a.yb(k.a.DUa),6);H.Z(x.a.yb(a.a.OAb),7);H.Z(x.a.yb(k.a.EJ),6);H.Z(x.a.yb(a.a.euj),2);H.Z(x.a.yb(k.a.C5k),2);H.Z(x.a.yb(k.a.GAn),2);H.Z(x.a.yb(a.a.fmc),2);H.Z(x.a.yb(a.a.pad),2);H.Z(x.a.yb(a.a.BQb),2);H.Z(x.a.yb(a.a.H7a),2);H.Z(x.a.yb(a.a.qad),2);H.Z(x.a.yb(a.a.sad),2);
H.Z(x.a.yb(a.a.lockNotFullySupportedParagraphInBlockContentControl),2);H.Z(x.a.yb(a.a.listID),3);H.Z(x.a.yb(a.a.listLevel),3);return H}dC(H,L){if(L===x.a.yb(f.a.lo)||L===x.a.yb(f.a.Gn)||L===x.a.yb(f.a.zm)||L===x.a.yb(a.a.ft)||L===x.a.yb(a.a.nq)||L===x.a.yb(a.a.Lc)||L===x.a.yb(f.a.lpb)||L===x.a.yb(a.a.qPa)||L===x.a.yb(a.a.QGa)||L===x.a.yb(f.a.oxa)||L===x.a.yb(a.a.fFa)||L===x.a.yb(a.a.gga)||L===x.a.yb(a.a.gFa)||L===x.a.yb(a.a.BDa)||L===x.a.yb(a.a.hFa)||L===x.a.yb(a.a.CDa)||L===x.a.yb(a.a.PGa)||L===
x.a.yb(a.a.uIa)||L===x.a.yb(a.a.vIa)||L===x.a.yb(a.a.aza)||L===x.a.yb(a.a.Fv)||L===x.a.yb(a.a.kN)){var I=H.un.value.lu,N=H.un.value.wf;L=H.Kg.value.wf;if(H.lq.runtime.pNa.contains(I.id))return y.a.instance.Ta(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",I.id),!0;if(H.lq.runtime.Xb.qib(1000005)&&this.mAo(H,L,N))return H.Xk=L.KK(),G.Doh(H),G.Mzd(H.lq,H.Ud,N),!0;const Q=new n.a;Q.add(I);I=new n.a;I.add(N);N=new n.a;
N.add(L);if(!({en:L}=G.nDj(H.lq,Q,N,I)).returnValue)return H.hpg=!0,H.Xk=null,!1;G.Doh(H);H.Xk=L.$f(0).wm;return!0}return L===x.a.yb(a.a.Cz)||L===x.a.yb(a.a.Dz)||L===x.a.yb(a.a.xw)?(this.lPo(H),H.og.add(x.a.yb(a.a.Cz)),H.og.add(x.a.yb(a.a.Dz)),H.og.add(x.a.yb(a.a.xw)),!0):!1}mAo(H,L,I){L=H.Ud.getPropertyString(L,a.a.kN);H=H.Ud.getPropertyString(I,a.a.kN);return L||H?!0:!1}lPo(H){const L=H.Ud,I=H.Xk;var N=H.un.value.wf,Q=H.Kg.value.wf;H=this.wpf(H.un.value.lu,L);Q=this.wpf(Q,L);N=this.wpf(N,L);({$dn:N,
aen:H,ben:Q}=this.W3l(H,Q,N));N.length?(L.setPropertyUint32s(I,a.a.xw,N),L.setPropertyUint32s(I,a.a.Cz,H),L.setPropertyUint32s(I,a.a.Dz,Q)):this.x_n(I)}wpf(H,L){const I=L.getPropertyUint32s(H,a.a.xw),N=L.getPropertyUint32s(H,a.a.Cz);H=L.getPropertyUint32s(H,a.a.Dz);L=new n.a;if(!I)return L;for(let Q=0;Q<I.length;++Q)L.add(new w(I.J(Q),N.J(Q),H.J(Q)));return L}W3l(H,L,I){({VZi:L,WZi:J,XZi:M}=this.W7h(H,L));let N,Q;({VZi:I,WZi:N,XZi:Q}=this.W7h(H,I));H=this.onm(H,J,M,N,Q);var M=this.nnm(H,L,I);H=new n.a;
L=new n.a;var J=new n.a;for(I=0;I<M.length;++I)H.add(M.J(I).position),L.add(M.J(I).leader),J.add(M.J(I).val);return{$dn:H,aen:L,ben:J}}W7h(H,L){let I,N,Q;I=new n.a;N=new u.a;Q=new u.a;let M,J;for(M=J=0;M<H.length&&J<L.length;)H.J(M).position===L.J(J).position?(H.J(M).equals(L.J(J))||Q.Z(H.J(M).position,L.J(J)),++M,++J):H.J(M).position<L.J(J).position?(N.Z(H.J(M).position,H.J(M)),++M):(I.add(L.J(J)),++J);for(;M<H.length;)N.Z(H.J(M).position,H.J(M)),++M;for(;J<L.length;)I.add(L.J(J)),++J;return{VZi:I,
WZi:N,XZi:Q}}onm(H,L,I,N,Q){const M=new n.a;for(let J=0;J<H.length;++J){const V=H.J(J).position;L.mb(V)||(I.mb(V)?M.add(I.J(V)):N.mb(V)||(Q.mb(V)?M.add(Q.J(V)):M.add(H.J(J))))}return M}nnm(H,L,I){L=this.KOi(L,I);return this.KOi(H,L)}KOi(H,L){const I=new n.a;let N,Q;for(N=Q=0;N<H.length&&Q<L.length;)H.J(N).position<=L.J(Q).position?(I.add(H.J(N)),H.J(N).position===L.J(Q).position&&++Q,++N):I.add(L.J(Q++));for(;N<H.length;)I.add(H.J(N++));for(;Q<L.length;)I.add(L.J(Q++));return I}x_n(H){H.removeProperty(a.a.xw);
H.removeProperty(a.a.Cz);H.removeProperty(a.a.Dz)}static kh(){return new G}static get instance(){return G.Mg.value}static Doh(H){H.og.add(x.a.yb(f.a.lo));H.og.add(x.a.yb(f.a.Gn));H.og.add(x.a.yb(f.a.zm));H.og.add(x.a.yb(a.a.ft));H.og.add(x.a.yb(a.a.nq));H.og.add(x.a.yb(a.a.Lc));H.og.add(x.a.yb(f.a.lpb));H.og.add(x.a.yb(a.a.qPa));H.og.add(x.a.yb(a.a.QGa));H.og.add(x.a.yb(f.a.oxa));H.og.add(x.a.yb(a.a.fFa));H.og.add(x.a.yb(a.a.gga));H.og.add(x.a.yb(a.a.gFa));H.og.add(x.a.yb(a.a.BDa));H.og.add(x.a.yb(a.a.hFa));
H.og.add(x.a.yb(a.a.CDa));H.og.add(x.a.yb(a.a.PGa));H.og.add(x.a.yb(a.a.uIa));H.og.add(x.a.yb(a.a.vIa));H.og.add(x.a.yb(a.a.aza));H.og.add(x.a.yb(a.a.Fv));H.og.add(x.a.yb(a.a.kN))}static nDj(H,L,I,N){return(new E.a(H,L,I,N)).pmc()}static Mzd(H,L,I){I=L.getPropertyObjectIds(I,f.a.Gn);for(let Q=0;Q<I.length;Q++){var N=H.runtime.Jq.J(I.$f(Q));if(N&&(N=L.getPropertyObjectId(N,a.a.ke))){H.runtime.skc.add(N);break}}}}G.Mg=new l.a(G.kh);Object(F.a)(G,"ParagraphNodeComplexMerge",z.a,[])},1785:function(F,
K,c){F=c(0);var l=c(74),f=c(1502),a=c(1631),k=c(1549),x=c(1520),y=c(1567),n=c(1504),u=c(1508),z=c(1507),w=c(1500),E=c(1499);class G{constructor(Y){this.ic=Y;this.Kvd=this.Iuf()}cL(){return"Add-ins"}bU(){return 0===this.ic.gv?0:1===this.ic.gv?1:3}PH(Y,ba){Y=new z.a(Y);ba.resultsUpdated(Y)}yib(Y,ba,aa){let fa;fa=this.ic.rP?new u.a(29):new u.a(27);fa.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;aa&&this.Ryo(Y.Dg,ba,fa)}Ryo(Y,ba,aa){const fa=[];let na;na=this.ic.oGm?this.ic.rP&&this.ic.Wdb?
E.a.rhb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,Y):this.ic.pGm?this.ic.rP&&this.ic.Wdb?E.a.rhb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,Y):this.ic.rP&&this.ic.Wdb?E.a.rhb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,
Y);this.ic.$va?(w.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",na)),w.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Y))):(fa.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",na)),fa.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Y)),appChrome.api.dispatch(fa));aa.Ow(new n.a("LaunchAddinDialogFromTellMe",29));ba.Yu(aa)}Iuf(){const Y=[];this.ic.RXd&&
Array.add(Y,"Addin");return Y}}Object(F.a)(G,"AddinStoreResultsProvider",null,[1247]);var H=c(1735),L=c(1539),I=c(1550),N=c(1736),Q=c(1770),M=c(1737),J=c(1566),V=c(2),X=c(35),W=c(140);c.d(K,"a",function(){return U});class U{constructor(Y,ba,aa){this.Kcb=this.nBc=this.oBc=this.Rud=!1;this.dQ=null;this.Z1=-1;this.oYa=this.hCc=this.hfa=this.Zxb=null;this.z4g=this.I4g=0;this.ic=Y;const fa=E.a.Moa();this.J$a=ba||[];this.Xf=V.AFrameworkApplication.Ne;this.pgh=Y.XWf;this.pBc=Y.WWf;this.Pud=fa&&this.cPb();
this.Qud=fa&&this.dPb();this.rgh=fa&&this.ePb();this.Tud=this.gPb();this.DSe=this.Sjc();if((ba=Y.lhg&&E.a.mdg(Y))||Y.mga)this.Zxb=new Q.a(Y),this.Rud=Y.u$c;ba&&(this.oBc=Y.w$c,this.nBc=Y.wkb,this.Kcb=this.Rud&&this.gx("File")||this.oBc&&this.gx("People")||this.nBc&&this.gx("Notes"));this.Oud=this.Huo();this.rBc=Y.A0c;this.Sud=this.avo();this.CSe=this.Guo();this.zZb=this.Cie();this.u$=this.sgm();this.kMg=new H.a(Y);this.j7j=new N.a(Y);this.Omk=new M.a(Y);this.aWj=new G(Y);this.gAc=aa;this.xxb=new a.a;
this.rBc&&(this.kMg=new H.a(Y));Y.mga&&(this.CSe=this.Sud=this.rBc=this.Kcb=this.nBc=this.oBc=this.DSe=this.Tud=this.rgh=this.Qud=this.Pud=this.pBc=!1,V.AFrameworkApplication.K&&this.gx("File")&&this.Brj()||this.zZb)&&(Y=this.xxb.rvf("Search",V.AFrameworkApplication.K.jb("TellMeServiceAuthEndpointForSearch")),this.VLc(Y,"TellMeService",!0),Y=this.xxb.rvf("SmartLookup",V.AFrameworkApplication.K.jb("SmartLookupShredderServiceEndpoint")),this.VLc(Y,"Shredder",!1));V.AFrameworkApplication.K&&this.Kcb&&
this.gx("File")&&this.Brj()&&(Y=this.xxb.rvf("Search",V.AFrameworkApplication.K.jb("TellMeServiceAuthEndpointForSearch")),this.VLc(Y,"TellMeService",!0))}gx(Y){return Array.contains(this.J$a,Y)?!0:!1}cL(){return"TellMeService"}bU(){return 0===this.ic.gv?0:1===this.ic.gv?1:this.gx("Command")||this.gx("Recommended")?2:3}pgm(Y){let ba="";if(!Y&&this.gx("Command")&&this.ic.QEf){ba+="CommandSearch_DLIS,";var aa=this.ic.Ryj;0<aa.length&&(ba+=aa+",")}Y&&this.gx("Recommended")&&this.pBc&&(aa=this.Akm(),0<
aa.length&&(ba+=aa+","));!Y&&this.gx("Help")&&(Y=this.ic.Qyj,0<Y.length&&(ba+=Y+","));this.ic.mga&&this.oYa&&0<this.oYa.length&&(ba+="IsRecallEnabled_true,");(this.ic.oKd||this.ic.mga)&&this.Kcb&&(ba+="IsGenerateSlidesEnabled_true,");0<ba.length&&(ba=ba.substr(0,ba.length-1));return ba}VLc(Y,ba,aa){const fa=aa?this.I4g:this.z4g;if(!fa||window.performance.now()-fa>=E.a.C7a)if(Y)aa?this.I4g=window.performance.now():this.z4g=window.performance.now(),Y.then(na=>{aa?this.hCc=na:(this.oYa=na,w.TellMeActor.instance.gfg=
na)},na=>{w.TellMeActor.instance.Oe.onError("TellMeServiceProvider:FetchTokenForService_"+ba,"tellMeServiceToken promise rejected: "+na)});else if(w.TellMeActor.instance.Oe)w.TellMeActor.instance.Oe.onError("TellMeServiceProvider:FetchTokenForService_"+ba,"undefined token promise")}PH(Y,ba,aa,fa=f.a.tellMe,na=null){const oa=new z.a(Y);aa=E.a.dR(Y);this.gx("File")&&(this.Kcb||this.ic.mga)&&this.VLc(this.xxb.tgm(),"TellMeService",!0);(this.gx("File")&&this.ic.mga||this.gx("ActionAI")&&this.zZb)&&this.VLc(this.xxb.wdm(),
"Shredder",!1);var ja=this.Kcb&&!!this.hCc;const qa=this.ic.mga&&!!this.oYa;var Ia=ja||qa||aa&&this.gx("Recommended")&&this.pBc;ja=ja||qa||!aa&&(this.pgh&&this.gx("Command")||this.Pud&&this.gx("Answer")||this.Qud&&this.gx("Definition")||this.DSe&&this.gx("Image")||this.rBc&&this.gx("Help")||this.Tud&&this.gx("WolframAnswer")||this.Sud&&this.gx("Template")||this.CSe&&this.gx("Addin"));if(Ia||ja)if(this.hfa=fa,fa={"Content-Type":"application/json",Accept:"application/json"},fa["X-Office-Version"]=V.AFrameworkApplication.buildVersion,
fa["X-Office-Application"]=V.AFrameworkApplication.K.jb("Application"),fa["X-Office-Platform"]="WAC",fa["X-TellMe-SqmUserId"]=V.AFrameworkApplication.K.jb("LoggableUserId")||"",fa["X-TellMe-SessionId"]=w.TellMeActor.instance.TSd(),this.hCc&&(fa.Authorization="Bearer "+this.hCc),this.oYa&&0<this.oYa.length&&(fa["X-TellMe-ShredderToken"]="Bearer "+this.oYa),Ia=this.pgm(aa),0<Ia.length&&(fa["X-TellMe-Flights"]=Ia),Ia=[],!aa&&this.gx("Answer")&&this.Pud&&(na?Array.contains(na,9):1)&&Array.add(Ia,"Answer"),
!aa&&this.gx("Command")&&this.pgh&&!L.CommandResultsUtility.nCf(Y.Dg)&&(na?Array.contains(na,17):1)&&Array.add(Ia,"Command"),!aa&&this.gx("Definition")&&this.Qud&&(na?Array.contains(na,10):1)&&Array.add(Ia,"Definition"),!aa&&this.gx("Help")&&this.rBc&&(na?Array.contains(na,8):1)&&Array.add(Ia,"Help"),!aa&&this.gx("WolframAnswer")&&this.Tud&&(na?Array.contains(na,12):1)&&Array.add(Ia,"WolframAnswer"),aa&&this.gx("Recommended")&&this.pBc&&!w.TellMeActor.instance.Qbd&&(na?Array.contains(na,18):1)&&Array.add(Ia,
"Recommended"),!aa&&this.gx("Image")&&this.DSe&&(na?Array.contains(na,19):1)&&Array.add(Ia,"Image"),this.hCc&&this.Kcb&&(na?Array.contains(na,14)||Array.contains(na,15)||Array.contains(na,20):1)&&(this.Zxb.X5a(),this.Rud&&this.gx("File")&&Array.add(Ia,"File"),this.oBc&&this.gx("People")&&Array.add(Ia,"People"),this.nBc&&this.gx("Notes")&&Array.add(Ia,"Notes")),this.oYa&&0<this.oYa.length&&this.ic.mga&&(na?Array.contains(na,15):1)&&(this.Zxb.X5a(),this.gx("File")&&Array.add(Ia,"File")),!aa&&this.gx("Template")&&
this.Sud&&(na?Array.contains(na,23):1)&&Array.add(Ia,"Template"),!aa&&this.gx("Addin")&&this.CSe&&(na?Array.contains(na,27):1)&&Array.add(Ia,"Addin"),!aa&&this.gx("ActionAI")&&this.zZb&&(na?Array.contains(na,25):1)&&Array.add(Ia,"ActionAI"),Ia.length){fa["X-TellMe-SuggestionTypes"]=Ia.join(",");fa["X-TellMe-Culture"]=V.AFrameworkApplication.uiCulture;fa["X-TellMe-ProcessSessionId"]=V.AFrameworkApplication.userSessionId;var Va=this.dQ=W.a.create().toString();fa["Client-Request-Id"]=Va;var Na=window.performance.now();
this.QCa();this.Z1=window.setTimeout(()=>{if(Va===this.dQ){this.dQ="";this.Z1=-1;ba.resultsUpdated(oa);const za={};za[k.a.provider]=this.cL();za[k.a.rMb]=Y.snb;w.TellMeActor.instance.Oe.MA(x.a.timedOut,this.gAc,za)}},this.gAc);this.Xf.xj(this.u$,2,this.rgm(Y.Dg),fa,!1,0,za=>{this.$Kb(za,Y,ba,Va,Na,na)},za=>{this.GKb(za,Y,ba,Va,Na)},null,null,!1,4E3,this.zZb?3E4:6E3)}else w.TellMeActor.instance.Oe.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),ba.resultsUpdated(oa);
else ba.resultsUpdated(oa)}QCa(){-1!==this.Z1&&(window.clearTimeout(this.Z1),this.Z1=-1)}$Kb(Y,ba,aa,fa,na,oa){const ja=new z.a(ba);if(fa===this.dQ){this.QCa();w.TellMeActor.instance.Oe.y0(ba.Dg.length,this.J$a.join(","),Y.data.Qe.toString(),Math.round(window.performance.now()-na),J.a.tellMe,!0,y.a.IPa);fa=Y.data.ve;Y=null;try{Y=X.b(fa)}catch(la){w.TellMeActor.instance.Oe.onError("OnSuccessCallBack","Exception occured while deserializing response:"+la);return}fa=E.a.dR(ba);if("Groups"in Y&&Y.Groups){var qa=
Y.Groups;for(var Ia of qa)if("GroupType"in Ia&&"Suggestions"in Ia&&Ia.Suggestions)if("Commands"===Ia.GroupType&&(oa?Array.contains(oa,17):1)||"Recommended"===Ia.GroupType&&(oa?Array.contains(oa,18):1)){var Va=(qa="Recommended"===Ia.GroupType)?"DLIS":"NaiveBayes";"Source"in Ia&&Ia.Source&&(Va=Ia.Source);var Na=Ia.Suggestions;new l.a;var za=[];for(const la of Na)this.vVm(la)&&(Na=la.Type,("Command"===Na||qa&&"Recommended"===Na)&&za.push(new I.a(la.CommandId,la.Score)));L.CommandResultsUtility.Y2d(za,
!ba.Dg.trim().length,Ia.GroupType,Va);Va=w.TellMeActor.instance.E2;Na=[];for(const la of za)qa&&Va&&Va.T9e(la.commandId)||Na.push(la);za=L.CommandResultsUtility.JPc(ba,Na,this.ic,null,null,null,qa?18:17,0);0<za.results.length&&(this.hfa!==f.a.contextMenu&&(za.displayName=qa?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ja.Yu(za))}else if("Answer"===Ia.GroupType){Na=Ia.Suggestions;qa=null;za=2147483647;Va="";for(const la of Na)if(this.uVm(la))if(Va=la.Type,Na=
this.URd(Va),"Answer"===Va&&this.Pud){qa=this.gNh(Va,la,ba.Dg);break}else Na&&Na<za&&(za=Na,qa=this.gNh(Va,la,ba.Dg));za=E.a.E8n(ba.Dg,Va);qa&&(oa?Array.contains(oa,qa.type):1)&&(Va=[],this.Oud?this.ic.$va?(w.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(qa.value,qa.$C)),w.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(qa.value,qa.description)),w.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(qa.value,
za))):(Va.push(appChrome.actions.setControlLabel(qa.value,qa.$C)),Va.push(appChrome.actions.updateCompoundButtonDescription(qa.value,qa.description)),Va.push(appChrome.actions.setCompoundButtonCommandValueId(qa.value,za)),appChrome.api.dispatch(Va)):this.ic.$va?(w.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(qa.value,qa.$C+" - "+qa.description)),w.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(qa.value,za))):(Va.push(appChrome.actions.setControlLabel(qa.value,
qa.$C+" - "+qa.description)),Va.push(appChrome.actions.setButtonCommandValueId(qa.value,za)),appChrome.api.dispatch(Va)),za=this.Lel(qa.type),za.Ow(qa),ja.Yu(za))}else"Help"===Ia.GroupType&&Ia.Suggestions.length&&(oa?Array.contains(oa,8):1)?this.rBc&&(qa=this.kMg.yib(ba,Ia.Suggestions))&&0<qa.results.length&&ja.Yu(qa):"Template"===Ia.GroupType&&(oa?Array.contains(oa,23):1)?(qa=Ia.Suggestions)&&0<qa.length&&this.Omk.yib(ba,ja,qa):"Addin"===Ia.GroupType&&(oa?Array.contains(oa,27):1)?(qa=Ia.Suggestions)&&
0<qa.length&&this.aWj.yib(ba,ja,qa):"ActionAI"===Ia.GroupType&&(oa?Array.contains(oa,25):1)?(za=Ia.Suggestions,qa=[],new u.a(25),za&&1===za.length&&(Va=za[0])&&Va.CommandId&&(za=Va.CommandId,qa.push(new I.a(za,"Score"in Va?Va.Score:0)),qa=L.CommandResultsUtility.JPc(ba,qa,this.ic,null,null,null,25,0),qa.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,ja.Yu(qa))):"Substrate"===Ia.GroupType&&this.Kcb&&"Type"in Ia?"File"===Ia.Type&&this.Rud&&(oa?Array.contains(oa,15):1)?(qa=this.Zxb.kqf(Ia.Suggestions,
fa,this.hfa))&&0<qa.results.length&&(this.jZd()&&(za=new n.a("GenerateSlidesFromTellMe",30,"",null,1),qa.Ow(za)),ja.Yu(qa)):"People"===Ia.Type&&this.oBc&&(oa?Array.contains(oa,14):1)?(qa=this.Zxb.gei(Ia.Suggestions,fa,this.hfa))&&0<qa.results.length&&ja.Yu(qa):"Notes"===Ia.Type&&this.nBc&&(oa?Array.contains(oa,14):1)&&(qa=this.Zxb.Nci(Ia.Suggestions,fa,ba))&&0<qa.results.length&&ja.Yu(qa):"Recall"===Ia.GroupType&&this.ic.mga&&"Type"in Ia&&"IntentService"===Ia.Type&&(oa?Array.contains(oa,15):1)&&(qa=
this.Zxb.kqf(Ia.Suggestions,fa,this.hfa))&&0<qa.results.length&&(this.jZd()&&(za=new n.a("GenerateSlidesFromTellMe",30,"",null,1),qa.Ow(za)),ja.Yu(qa));else w.TellMeActor.instance.Oe.onError("OnSuccessCallBack","GroupType"in Ia?"Invalid group suggestions found for "+Ia.GroupType:"Invalid group found")}if(Y.Intents){Ia=Y.Intents;for(const la of Ia)this.qHf(la)&&("Image"===la.GroupType&&la.ConfidenceScore>la.ConfidenceThreshold&&(oa?Array.contains(oa,19):1)?this.j7j.yib(ba,ja,0,la):"Commands"===la.GroupType&&
la.ConfidenceScore<la.ConfidenceThreshold&&(oa?Array.contains(oa,17):1)&&(Ia=new u.a(17),ja.Yu(Ia)))}aa.resultsUpdated(ja);w.TellMeActor.instance.Oe.y0(ba.Dg.length,this.J$a.join(","),"",Math.round(window.performance.now()-na),"",!0,y.a.provider)}}GKb(Y,ba,aa,fa,na){const oa=new z.a(ba);fa===this.dQ&&(this.QCa(),w.TellMeActor.instance.Oe.y0(ba.Dg.length,this.J$a.join(","),Y.data.Qe.toString(),Math.round(window.performance.now()-na),J.a.tellMe,!1,y.a.IPa));aa.resultsUpdated(oa)}URd(Y){switch(Y){case "Entity":return this.rgh?
3:0;case "Definition":return this.Qud?5:0;case "WolframAnswer":return this.Tud?2:0;default:return 0}}gNh(Y,ba,aa){switch(Y){case "Answer":return new n.a(this.Oud?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===ba.Title?aa:ba.Title,ba.Description,0);case "Entity":return new n.a(this.Oud?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===ba.Title?aa:ba.Title,ba.Description,0);case "Definition":return new n.a(this.Oud?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ba.Title?aa:ba.Title,ba.Description,
0);case "WolframAnswer":return new n.a("WolframForSearch",3,""===ba.Title?aa:ba.Title,ba.Description,0);default:return null}}Lel(Y){switch(Y){case 0:return new u.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new u.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new u.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new u.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new u.a(19,this.ic.Njc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);
default:return null}}uVm(Y){return"Type"in Y&&!!Y.Type&&""!==Y.Type&&"Description"in Y&&!!Y.Description&&""!==Y.Description}vVm(Y){return"Type"in Y&&!!Y.Type&&""!==Y.Type&&"CommandId"in Y&&!!Y.CommandId&&""!==Y.CommandId&&"Score"in Y&&!!Y.Score}qHf(Y){if("GroupType"in Y&&Y.GroupType&&"ConfidenceScore"in Y&&"ConfidenceThreshold"in Y)return!0;w.TellMeActor.instance.Oe.onError("IsValidIntentGroup","Invalid intents found");return!1}rgm(Y){const ba=E.a.qCi(Y),aa={};aa.Query=Y;ba&&this.pBc&&(this.kPm()?
aa.UserActionEvents=w.TellMeActor.instance.Qkh:(aa.CommandClickedEvents=w.TellMeActor.instance.iwe,aa.CommandActionEvents=w.TellMeActor.instance.yPg),aa.TellMeCommandClickMruEvents=w.TellMeActor.instance.D7g,aa.ContentType=w.TellMeActor.instance.OHd);this.Sud&&(Y={},Y.Application=this.ic.application,aa.TemplateInfo=Y);return X.c(aa)}cPb(){return!!this.ic&&this.ic.cPb||!!V.AFrameworkApplication.ta&&V.AFrameworkApplication.ta.Nb.cPb}dPb(){return!!this.ic&&this.ic.dPb||!!V.AFrameworkApplication.ta&&
V.AFrameworkApplication.ta.Nb.dPb}ePb(){return!!this.ic&&this.ic.ePb||!!V.AFrameworkApplication.ta&&V.AFrameworkApplication.ta.Nb.ePb}gPb(){return!!this.ic&&this.ic.gPb||!!V.AFrameworkApplication.ta&&V.AFrameworkApplication.ta.Nb.gPb}Sjc(){return!!this.ic&&(this.ic.Sjc||this.ic.rP)}Huo(){return!!this.ic&&!this.ic.w3a}avo(){return!!this.ic&&this.ic.vWc}Guo(){return!!this.ic&&this.ic.qGm&&this.ic.nGm}Cie(){return!!this.ic&&this.ic.Cie}dDi(){return!!V.AFrameworkApplication.K&&V.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",
!1)}eDi(){return!!V.AFrameworkApplication.K&&V.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}kPm(){return!!V.AFrameworkApplication.K&&V.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}jZd(){return!!V.AFrameworkApplication.K&&V.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Brj(){return!!V.AFrameworkApplication.K&&
V.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}Akm(){return V.AFrameworkApplication.K?V.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}sgm(){if(!V.AFrameworkApplication.K)return"";if(this.eDi())return V.AFrameworkApplication.K.jb("TellMeServiceProdEndpointForSearch");if(this.dDi())return V.AFrameworkApplication.K.jb("TellMeServiceEdogEndpointForSearch");if(E.a.TCf())return V.AFrameworkApplication.K.jb("TellMeServiceIntEndpointForSearch");
let Y=V.AFrameworkApplication.K.jb("TellMeServiceSearchEndpoint");Y&&""!==Y||(Y=V.AFrameworkApplication.Pyj);return Y}static JNh(Y,ba){if(ba)return new U(Y,["Command","Recommended"],Y.YWl);ba=E.a.Moa()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new U(Y,ba,Y.Xgi)}}Object(F.a)(U,"TellMeServiceProvider",null,[1247])},1878:function(F,K,c){c.r(K);c.d(K,"MarkerValidation",
function(){return a});F=c(0);var l=c(364),f=c(1783);class a{constructor(){this.xXd=this.Lti=this.Kti=this.Jti=0}m8h(){const k=new l.a(0);k.Z("InvalidBookmarks",this.Jti);k.Z("InvalidComments",this.Kti);k.Z("InvalidContentControls",this.Lti);0!==this.xXd&&k.Z("InvalidMarkerType",this.xXd);return k}ani(){return 0<this.Jti||0<this.Kti||0<this.Lti||0!==this.xXd?!0:!1}toString(){return JSON.stringify(f.a.HUa(this.m8h()))}}Object(F.a)(a,"MarkerValidation",null,[])},1879:function(F,K,c){c.d(K,"a",function(){return y});
F=c(0);var l=c(165),f=c(1037),a=c(234),k=c(1649),x=c(1570);class y{constructor(n,u,z,w,E=null,G=null,H=null,L=null){this.Zd=n;this.GF=u;this.tAa=z;this.OBa=w;this.Lbk=E;this.l3j=G;this.fok=H;this.asa=L||this.Caf()}Caf(){return n=>!!this.Zd.runtime.Xb&&this.Zd.runtime.Xb.isFeatureEnabled(n)}xal(){return()=>this.Zd.runtime.Xb}tgf(){return!!this.Zd.runtime.uk.J(a.a.zL)}yuj(){let n;if(1===this.Zd.input.source||2===this.Zd.input.source)n=80;else if(4===this.Zd.input.source||3===this.Zd.input.source)n=
40;else if(5===this.Zd.input.source)n=118;else return!1;return this.tgf()&&this.asa(n)}Dwj(n,...u){return String.format.apply(null,[n].concat(u))}tRd(n){const {ParagraphMerge:u}=c(1970);let z=this.Zd,w=this.tAa,E=this.OBa;n||(z=this.Lbk||this.Zd,w=this.l3j||w,E=this.fok||E);var G=x.a.$rf(this.GF);const H=x.a.$rf(w),L=x.a.$rf(E);G=this.Dwj("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",
z.input.source,z.runtime.YCa.id,z.runtime.PLd,z.runtime.Ene,G.er(),H.er(),L.er());return n?{returnValue:new k.a(z,this.GF,w,E,this.Caf(),new f.a),er:G}:{returnValue:new u(z,this.GF,w,E,this.Caf(),this.xal(),new f.a),er:G}}pmc(){this.Zd.logger.Amo();var n=this.yuj();var u=({er:w}=this.tRd(n)).returnValue;l.a.instance.Ta(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",n,w);this.Zd.logger.AU("ParagraphMergeSelector initialization");n?this.Zd.logger.uhe(1):this.Zd.logger.uhe(2);
let z=({en:u}=u.pmc()).returnValue;this.Zd.logger.ubg();var w=!z;n=!!this.Zd.runtime.uk.J(a.a.zL)&&(n&&!z||!n);w&&({er:w,returnValue:u}=this.tRd(!1),{en:u,returnValue:z}=u.pmc(),l.a.instance.Ta(18994390,1,z?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",z,w));n&&(w=new f.a,x.a.t7n(this.Zd,w));this.Zd.logger.AU("ParagraphMergeSelector finalization");return{returnValue:z,en:u}}gbd(n,u){let z,w,E;const G=this.yuj()&&this.asa(119);let H=({er:E}=this.tRd(G)).returnValue,L=({$5a:z,
eqa:w}=H.gbd(n,u)).returnValue;l.a.instance.Ta(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",G,E);G&&!L&&H.o8f&&({er:E,returnValue:H}=this.tRd(!1),{$5a:z,eqa:w,returnValue:L}=H.gbd(n,u),l.a.instance.Ta(18994392,1,L?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",L,E));return{returnValue:L,$5a:z,eqa:w}}}Object(F.a)(y,"ParagraphMergeSelector",null,[1988])},1880:function(F,K,c){c.r(K);c.d(K,"SurfaceStringTokenStringGenerator",
function(){return f});F=c(0);var l=c(1598);class f extends l.a{constructor(a){super(a);this.Ab=a}apply(a,k,x,y,n,u,z){null==u&&(u=a.Xii(n,k));z=l.a.Jph(a,u,this.Ab.score,x,y,z);return{X$c:u,PFc:z}}}f.QFc=0;Object(F.a)(f,"SurfaceStringTokenStringGenerator",l.a,[])},1881:function(F,K,c){c.r(K);c.d(K,"QueryTokenStringGenerator",function(){return a});F=c(0);var l=c(1598),f=c(1495);class a extends l.a{constructor(k){super(k);this.Ab=k}apply(k,x,y,n,u,z,w){x=this.Ab.query.load(x,null);u=0;let E=null;this.Ab.query.c5===
f.Annotations.bza?x&&(E=this.Ab.name):((E=this.Ab.name)&&(E+="_"),E+=this.Ab.annotations.Pda(this.Ab.query.c5,x));null!=E&&(u=l.a.Jph(k,E,this.Ab.score,y,n,u));return{X$c:z,PFc:w+u}}}a.QFc=1;Object(F.a)(a,"QueryTokenStringGenerator",l.a,[])},1882:function(F,K,c){c.r(K);c.d(K,"FuzzyMatchTokenStringGenerator",function(){return f});F=c(0);var l=c(1598);class f extends l.a{constructor(a){super(a);this.Ab=a}apply(a,k,x,y,n,u,z){null==u&&(u=a.Xii(n,k));a=this.Ab.MXh.z9m(u);if(this.Ab.jZi)for(var w of a)if(!w.tO&&
w.GMd)return{X$c:u,PFc:z};w=0;for(const E of a)if(E.tO&&!({F5e:w}=this.Nuh(E,!0,x,y,w)).returnValue)return{X$c:u,PFc:z};if(this.Ab.rqi)for(const E of a)if(!({F5e:w}=this.Nuh(E,!1,x,y,w)).returnValue)break;return{X$c:u,PFc:z}}Nuh(a,k,x,y,n){let u;k?(k=0,u=a.GMd?1:0):(k=a.GMd?1:0,u=a.count-k);for(let z=0;z<u;++z)if(l.a.Kph(a.Tgb+k+z,this.Ab.score,x,y),++n,0<this.Ab.PMf&&n>=this.Ab.PMf)return{returnValue:!1,F5e:n};return{returnValue:!0,F5e:n}}}f.QFc=2;Object(F.a)(f,"FuzzyMatchTokenStringGenerator",l.a,
[])},1960:function(F,K,c){F=c(0);var l=c(6),f=c(42),a=c(242),k=c(1494);class x extends k.a{constructor(){super()}get Mn(){return 2}get qA(){return 7}static kh(){return new x}static get instance(){return x.Mg.value}}x.Mg=new a.a(x.kh);Object(F.a)(x,"AppBindingNodeComplexMerge",k.a,[]);var y=c(16),n=c(798),u=c(165),z=c(1538);class w extends k.a{constructor(){super()}get Mn(){return 3}get qA(){return 7}wk(){const Pa=super.wk();Pa.Z(n.a.yb(y.a.kR),1);return Pa}dC(Pa,bb){if(bb===n.a.yb(y.a.kR)){const rb=
Pa.Xk;var lc=Pa.Ud;u.a.instance.Ta(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",rb.id,rb.Rc,bb);bb=lc.getPropertyMilliseconds(Pa.Kg.value.wf,y.a.kR);lc=lc.getPropertyMilliseconds(Pa.un.value.wf,y.a.kR);bb<lc&&this.fSl(Pa);Pa.og.add(n.a.yb(y.a.kR));return!0}u.a.instance.Ta(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Pa.Kg.value.wf.id,bb);return!1}fSl(Pa){this.s4n(Pa.un.value.wf,
Pa.Xk);this.Oof(Pa,l.a.u1e);this.Oof(Pa,l.a.Psh);this.Oof(Pa,l.a.Dsh)}Oof(Pa,bb){var lc=Pa.Ud,rb=Pa.Xk;if(lc.hasProperty(rb,bb)&&(bb=lc.getPropertyObjectIds(rb,bb))&&bb.length)for(lc=Pa.lq.runtime.Jq,Pa=Pa.lq.runtime.en,rb=0;rb<bb.length;rb++){const La=bb.J(rb);if(!lc.mb(La))continue;const sb=lc.J(La).KK();Pa.add(La,new z.a(sb,!1))}}static kh(){return new w}static get instance(){return w.Mg.value}}w.Mg=new a.a(w.kh);Object(F.a)(w,"AppNodeComplexMerge",k.a,[]);class E extends k.a{constructor(){super()}get Mn(){return 4}get qA(){return 7}static kh(){return new E}static get instance(){return E.Mg.value}}
E.Mg=new a.a(E.kh);Object(F.a)(E,"AppPropNodeComplexMerge",k.a,[]);class G extends k.a{constructor(){super()}get Mn(){return 5}get qA(){return 7}static kh(){return new G}static get instance(){return G.Mg.value}}G.Mg=new a.a(G.kh);Object(F.a)(G,"AppRefNodeComplexMerge",k.a,[]);var H=c(364),L=c(598),I=c(221),N=c(19);class Q{constructor(Pa,bb){this.id=Pa;this.OCo=bb}}Object(F.a)(Q,"IdAndTime",null,[]);class M extends k.a{constructor(){super()}get Mn(){return 6}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.oZa),
1);return Pa}dC(Pa,bb){if(bb===n.a.yb(l.a.oZa)){const lc=Pa.Xk,rb=Pa.Ud;u.a.instance.Ta(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",lc.id,lc.Rc,bb);bb=rb.getPropertyObjectIds(Pa.Kg.value.lu,l.a.oZa);const La=rb.getPropertyObjectIds(Pa.Kg.value.wf,l.a.oZa),sb=rb.getPropertyObjectIds(Pa.un.value.wf,l.a.oZa);bb=this.Wcn(Pa,bb,La,sb);0<bb.length?rb.setPropertyObjectIds(lc,l.a.oZa,bb):lc.removeProperty(l.a.oZa);Pa.og.add(n.a.yb(l.a.oZa));
return!0}u.a.instance.Ta(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Pa.Kg.value.wf.id,bb);return!1}Wcn(Pa,bb,lc,rb){const La=this.cGa(bb,lc,rb),sb=bb.TG(),Sb=lc.TG(),kc=rb.TG();bb=k.a.filter(La,Dc=>!sb.contains(Dc)&&Sb.contains(Dc));lc=k.a.filter(La,Dc=>!sb.contains(Dc)&&kc.contains(Dc));if(!bb.length||!lc.length)return La;const Lb=new H.a;bb.forEach(Dc=>{const Fd=new Q(Dc,this.Q4h(Pa,Dc,!1));this.M4h(Pa,Dc,!1).forEach(pe=>
{Lb.add(pe,Fd);return!0});return!0});const Qc=new L.a;lc.forEach(Dc=>{const Fd=this.Q4h(Pa,Dc,!0);this.M4h(Pa,Dc,!0).forEach(pe=>Lb.mb(pe)?(Qc.add(Lb.J(pe).OCo>=Fd?Dc:Lb.J(pe).id),!1):!0);return!0});return k.a.filter(La,Dc=>!Qc.contains(Dc))}Q4h(Pa,bb,lc){return(bb=this.Kna(Pa,bb,lc))?Pa.Ud.getPropertyMilliseconds(bb,y.a.kR):0}Kna(Pa,bb,lc){Pa=lc?Pa.lq.runtime.Jq:Pa.lq.runtime.Eu;return Pa.mb(bb)?Pa.J(bb):null}M4h(Pa,bb,lc){const rb=new I.a,La=new L.a,sb=Pa.Ud;bb=this.Kna(Pa,bb,lc);var Sb=this.tfi(sb,
bb);if(Sb)for(rb.add(Sb),La.add(Sb),bb=sb.getPropertyObjectIds(bb,l.a.u1e),Sb=0;bb&&Sb<bb.length;Sb++){const kc=this.tfi(sb,this.Kna(Pa,bb.J(Sb),lc));if(!kc)break;La.contains(kc)||(rb.add(kc),La.add(kc))}return rb}tfi(Pa,bb){if(!Pa.hasProperty(bb,l.a.Qdb)||!Pa.hasProperty(bb,l.a.m1b)||!Pa.hasProperty(bb,l.a.n1b))return null;const lc=Pa.getPropertyString(bb,l.a.Qdb),rb=Pa.getPropertyString(bb,l.a.m1b);Pa=Pa.getPropertyString(bb,l.a.n1b);return N.a.XA(lc+";"+rb+";"+Pa)}static kh(){return new M}static get instance(){return M.Mg.value}}
M.Mg=new a.a(M.kh);Object(F.a)(M,"AppsNodeComplexMerge",k.a,[]);class J extends k.a{constructor(){super()}get Mn(){return 36}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.Bmg),1);Pa.Z(n.a.yb(l.a.Gbg),1);return Pa}dC(Pa,bb){u.a.instance.Ta(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",bb);if(bb===n.a.yb(l.a.Bmg)||bb===n.a.yb(l.a.Gbg)){const sb=n.a.uX(bb);var lc=Pa.Kg.value.wf,rb=Pa.un.value.wf;const Sb=Pa.Xk;var La=Pa.Ud.getPropertyStrings(Pa.Kg.value.lu,sb);lc=Pa.Ud.getPropertyStrings(lc,
sb);rb=Pa.Ud.getPropertyStrings(rb,sb);La=this.cGa(La,lc,rb);Pa.Ud.setPropertyStrings(Sb,sb,La);Pa.og.add(bb);return!0}return!1}static kh(){return new J}static get instance(){return J.Mg.value}}J.Mg=new a.a(J.kh);Object(F.a)(J,"AutoSaveParametersNodeComplexMerge",k.a,[]);class V extends k.a{constructor(){super()}get Mn(){return 44}wk(){const Pa=super.wk();Pa.Z(n.a.yb(y.a.ef),1);return Pa}dC(Pa,bb){const lc=Pa.lq.runtime.Xb;if(bb===n.a.yb(y.a.ef))return u.a.instance.Ta(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Pa.Xk.id,Pa.Xk.Rc,bb),lc.Az(123),lc.isFeatureEnabled(123)?this.Zcn(Pa,bb):this.vdn(Pa,bb),!0;u.a.instance.Ta(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Pa.Kg.value.wf.id,bb);return!1}Zcn(Pa,bb){const lc=n.a.uX(bb),rb=Pa.Ud;var La=rb.getPropertyObjectIds(Pa.Kg.value.lu,lc),sb=rb.getPropertyObjectIds(Pa.Kg.value.wf,lc),Sb=rb.getPropertyObjectIds(Pa.un.value.wf,lc);Sb=V.oim(Pa,sb,Sb);La=this.cGa(La,sb,
Sb);sb=Pa.Xk;0<La.length?rb.setPropertyObjectIds(sb,lc,La):sb.removeProperty(lc);Pa.og.add(bb)}static kh(){return new V}static get instance(){return V.Mg.value}static oim(Pa,bb,lc){const rb=new I.a,La=new H.a;bb.forEach(sb=>{const Sb=Pa.lq.runtime.Eu.J(sb);Sb&&La.add(Sb.CX(l.a.ut).toString(),sb);return!0});lc.forEach(sb=>{var Sb=Pa.lq.runtime.Jq.J(sb);Sb?(Sb=Sb.CX(l.a.ut).toString(),La.mb(Sb)&&La.get(Sb)!==sb?u.a.instance.Ta(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):
rb.add(sb)):rb.add(sb);return!0});return rb}}V.Mg=new a.a(V.kh);Object(F.a)(V,"BookmarkContainerNodeComplexMerge",k.a,[]);class X extends k.a{constructor(){super()}get Mn(){return 41}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.bAb),1);Pa.Z(n.a.yb(l.a.ut),1);return Pa}dC(Pa,bb){return bb===n.a.yb(l.a.bAb)?(Pa.og.add(n.a.yb(l.a.bAb)),!0):bb===n.a.yb(l.a.ut)?(Pa.og.add(n.a.yb(l.a.ut)),!0):!1}jf(Pa){return Pa&&Pa.length?!1:!0}static kh(){return new X}static get instance(){return X.Mg.value}}X.Mg=new a.a(X.kh);
Object(F.a)(X,"BookmarkNodeComplexMerge",k.a,[]);class W extends k.a{constructor(){super();this.pYd=!1}get Mn(){return 7}wk(){const Pa=super.wk();Pa.Z(n.a.yb(y.a.ef),1);return Pa}dC(Pa,bb){if(bb===n.a.yb(y.a.ef)){const La=Pa.Xk,sb=Pa.Ud;var lc=Pa.lq.runtime.Xb;lc&&(this.pYd=lc.isFeatureEnabled(74));u.a.instance.Ta(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",La.id,La.Rc,bb);bb=sb.getPropertyObjectIds(Pa.Kg.value.lu,y.a.ef);
lc=sb.getPropertyObjectIds(Pa.Kg.value.wf,y.a.ef);var rb=sb.getPropertyObjectIds(Pa.un.value.wf,y.a.ef);bb=this.idn(bb,lc,rb);if(this.pYd&&0<bb.length){lc=new Sys.StringBuilder;for(rb=0;rb<bb.length;rb++)lc.append(bb.J(rb).toString()+",");u.a.instance.Ta(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",La.id,lc.toString())}0<bb.length?sb.setPropertyObjectIds(La,y.a.ef,bb):La.removeProperty(y.a.ef);Pa.og.add(n.a.yb(y.a.ef));return!0}u.a.instance.Ta(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Pa.Kg.value.wf.id,bb);return!1}idn(Pa,bb,lc){const rb=new I.a,La=new H.a(0);this.lCl(Pa,lc,rb,La);return this.Zml(bb,La,rb)}lCl(Pa,bb,lc,rb){Pa=Pa||new I.a;bb=bb||new I.a;Pa.forEach(La=>{rb.Z(La,1);return!0});bb.forEach(La=>{rb.Dc(La).returnValue?rb.Z(La,2):(rb.Z(La,0),lc.add(La));return!0})}Zml(Pa,bb,lc){Pa=Pa||new I.a;const rb=new I.a,La=new I.a,sb=new I.a;Pa.forEach(Sb=>{let kc=!0,Lb;({value:Lb}=bb.Dc(Sb)).returnValue&&(0===Lb?bb.Z(Sb,2):1===Lb&&(kc=!1));kc?rb.add(Sb):this.pYd&&La.add(Sb);return!0});
lc.forEach(Sb=>{let kc=!1,Lb;({value:Lb}=bb.Dc(Sb)).returnValue?0===Lb&&(kc=!0,bb.Z(Sb,2)):u.a.instance.Ta(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",Sb);kc?rb.add(Sb):this.pYd&&sb.add(Sb);return!0});this.ZKi(La,"Favored");this.ZKi(sb,"Unfavored");return rb}ZKi(Pa,bb){if(Pa.length){var lc=new Sys.StringBuilder;for(let rb=0;rb<Pa.length;rb++)lc.append(Pa.J(rb).toString()+",");u.a.instance.Ta(561637572,
1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",bb,lc.toString())}}static kh(){return new W}static get instance(){return W.Mg.value}}W.Mg=new a.a(W.kh);Object(F.a)(W,"CommentContentNodeComplexMerge",k.a,[]);var U=c(67),Y=c(35);class ba extends k.a{constructor(){super();this.Whh=[1];this.vPe=new H.a}get Mn(){return 8}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.bba),3);Pa.Z(n.a.yb(l.a.$E),3);Pa.Z(n.a.yb(l.a.mHc),2);Pa.Z(n.a.yb(l.a.commentId),2);Pa.Z(n.a.yb(l.a.OGh),2);Pa.Z(n.a.yb(l.a.VCa),
2);Pa.Z(n.a.yb(l.a.CNa),1);Pa.Z(n.a.yb(l.a.Fib),1);Pa.Z(n.a.yb(l.a.Djb),1);Pa.Z(n.a.yb(l.a.vQ),1);Pa.Z(n.a.yb(l.a.EG),1);Pa.Z(n.a.yb(l.a.lHc),2);Pa.Z(n.a.yb(l.a.OEd),2);Pa.Z(n.a.yb(l.a.k3b),2);Pa.Z(n.a.yb(l.a.$8e),2);Pa.Z(n.a.yb(l.a.iM),1);Pa.Z(n.a.yb(y.a.ef),0);Pa.Z(n.a.yb(l.a.xH),0);return Pa}dC(Pa,bb){if(bb===n.a.yb(l.a.iM)){var lc=Pa.Ud.getPropertyString(Pa.un.value.wf,l.a.iM);this.jf(lc)?Pa.Xk.removeProperty(l.a.iM):Pa.Xk.fTa(l.a.iM,lc);return!0}if(bb!==n.a.yb(l.a.CNa)&&bb!==n.a.yb(l.a.Fib)&&
bb!==n.a.yb(l.a.Djb)&&bb!==n.a.yb(l.a.EG)&&bb!==n.a.yb(l.a.vQ))return!1;var rb=Pa.Kg.value.lu;const La=Pa.Kg.value.wf;var sb=Pa.un.value.wf;lc=Pa.Xk;if(bb===n.a.yb(l.a.CNa)){rb=Pa.Ud.getPropertyString(La,l.a.CNa);sb=Pa.Ud.getPropertyString(sb,l.a.CNa);sb=this.jf(rb)?sb:this.jf(sb)?rb:null;if(this.jf(sb))return!0;Pa.Ud.setPropertyString(lc,l.a.CNa,sb);Pa.og.add(n.a.yb(l.a.CNa));return!0}if(bb===n.a.yb(l.a.Djb))return rb=Pa.Ud.getPropertyBool(La,l.a.Djb),sb=Pa.Ud.getPropertyBool(sb,l.a.Djb),rb=null!=
rb?rb:!1,rb=(null!=sb?sb:!1)||rb,Pa.Ud.setPropertyBool(lc,l.a.Djb,rb),Pa.og.add(n.a.yb(l.a.Djb)),!0;if(bb===n.a.yb(l.a.Fib)){rb=Pa.Ud.getPropertyBool(La,l.a.Fib);sb=Pa.Ud.getPropertyBool(sb,l.a.Fib);if(rb===sb)return!0;rb=null!=rb?rb:!1;rb=(null!=sb?sb:!1)||rb;Pa.Ud.setPropertyBool(lc,l.a.Fib,rb);return!0}if(bb===n.a.yb(l.a.EG)){rb=Pa.Ud.getPropertyBool(La,l.a.EG);sb=Pa.Ud.getPropertyBool(sb,l.a.EG);if(rb===sb)return!0;rb=null!=rb?rb:!1;rb=(null!=sb?sb:!1)||rb;Pa.Ud.setPropertyBool(lc,l.a.EG,rb);
Pa.og.add(n.a.yb(l.a.EG));return!0}if(bb===n.a.yb(l.a.vQ)){bb=Pa.lq.runtime.Xb;bb.Az(14);if(bb.isFeatureEnabled(14))return this.N2k(Pa,rb,La,sb,lc);rb=Pa.Ud.getPropertyString(La,l.a.vQ);sb=Pa.Ud.getPropertyString(sb,l.a.vQ);if(rb===sb)return!0;Pa.Ud.setPropertyString(lc,l.a.vQ,sb||rb);Pa.og.add(n.a.yb(l.a.vQ));return!0}return!1}N2k(Pa,bb,lc,rb,La){lc=Pa.Ud.getPropertyString(lc,l.a.vQ);rb=Pa.Ud.getPropertyString(rb,l.a.vQ);if(lc===rb)return!0;bb=Pa.Ud.getPropertyString(bb,l.a.vQ);const sb={};for(let kc=
0;kc<this.Whh.length;kc++){const Lb=this.Whh[kc];var Sb=this.vtf(bb,Lb,0);const Qc=this.vtf(lc,Lb,1),Dc=this.vtf(rb,Lb,2);Sb=this.Ddn(Sb,Qc,Dc);sb[Lb.toString()]=Sb.toArray()}Pa.Ud.setPropertyString(La,l.a.vQ,this.rgo(sb));Pa.og.add(n.a.yb(l.a.vQ));return!0}Ddn(Pa,bb,lc){const rb=new H.a,La=new H.a(0);for(var sb=0;sb<bb.length;sb++){const kc=bb[sb].UserId;rb.add(kc,bb[sb]);La.add(kc,0)}for(bb=0;bb<lc.length;bb++)sb=lc[bb].UserId,La.mb(sb)?La.Z(sb,2):(rb.add(sb,lc[bb]),La.add(sb,0));for(lc=0;lc<Pa.length;lc++)bb=
Pa[lc].UserId,La.mb(bb)&&2!==La.J(bb)&&La.Z(bb,1);const Sb=new I.a;La.forEach((kc,Lb)=>{if(1===Lb)return!0;Sb.add(rb.J(kc));return!0});return Sb}vtf(Pa,bb,lc){Pa=Object(U.a)(Object,this.eam(Pa,lc));return bb.toString()in Pa?Array.isArray(Pa[bb.toString()])?Pa[bb.toString()]:null:[]}eam(Pa,bb){if(this.vPe.mb(bb))return Object(U.a)(Object,this.vPe.J(bb));Pa=Object(U.a)(Object,this.Lll(Pa));this.vPe.add(bb,Pa);return Pa}Lll(Pa){return Object(U.a)(Object,Y.b(Pa))}rgo(Pa){return Y.c(Pa)}jf(Pa){return Pa&&
Pa.length?!1:!0}static kh(){return new ba}static get instance(){return ba.Mg.value}}ba.Mg=new a.a(ba.kh);Object(F.a)(ba,"CommentNodeComplexMerge",k.a,[]);class aa extends k.a{constructor(){super()}get Mn(){return 46}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.contentControlNode),1);Pa.Z(n.a.yb(y.a.lastModifiedTime),0);Pa.Z(n.a.yb(l.a.MHc),2);return Pa}dC(Pa,bb){if(bb===n.a.yb(l.a.contentControlNode))return u.a.instance.Ta(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Pa.Xk.id,Pa.Xk.Rc,bb),k.a.hNf(Pa,this,l.a.contentControlNode);u.a.instance.Ta(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Pa.Kg.value.wf.id,bb);return!1}static kh(){return new aa}static get instance(){return aa.Mg.value}}aa.Mg=new a.a(aa.kh);Object(F.a)(aa,"ContentControlContainerNodeComplexMerge",k.a,[]);var fa=c(58),na=c(1771);class oa extends k.a{constructor(){super()}get Mn(){return 37}wk(){const Pa=
super.wk();Pa.Z(n.a.yb(l.a.K7),1);Pa.Z(n.a.yb(l.a.aqb),1);Pa.Z(n.a.yb(l.a.PFd),2);Pa.Z(n.a.yb(l.a.fBb),2);Pa.Z(n.a.yb(l.a.contentControlNode),1);Pa.Z(n.a.yb(l.a.J8),1);Pa.Z(n.a.yb(l.a.Ufa),1);Pa.Z(n.a.yb(l.a.I3b),1);Pa.Z(n.a.yb(l.a.hfb),1);Pa.Z(n.a.yb(l.a.ffb),1);Pa.Z(n.a.yb(l.a.efb),1);Pa.Z(n.a.yb(l.a.JNa),2);Pa.Z(n.a.yb(l.a.iBb),1);Pa.Z(n.a.yb(l.a.QFd),1);Pa.Z(n.a.yb(l.a.J7),1);this.Xb.isFeatureEnabled(29)&&(Pa.Z(n.a.yb(l.a.nU),2),Pa.Z(n.a.yb(l.a.Uua),2),Pa.Z(n.a.yb(l.a.Pma),2),Pa.Z(n.a.yb(l.a.j4),
1),Pa.Z(n.a.yb(l.a.poa),1),Pa.Z(n.a.yb(l.a.qoa),1));return Pa}dC(Pa,bb){var lc=Pa.Kg.value.wf,rb=Pa.un.value.wf;const La=Pa.Xk;if(bb===n.a.yb(l.a.contentControlNode))return k.a.hNf(Pa,this,l.a.contentControlNode);if(bb===n.a.yb(l.a.J8)){bb=Pa.Ud.getPropertyBool(lc,l.a.J8);rb=Pa.Ud.getPropertyBool(rb,l.a.J8);if(null!=bb&&bb||null!=rb&&rb)Pa.Ud.setPropertyBool(La,l.a.J8,!0),Pa.og.add(n.a.yb(l.a.J8));return!0}if(bb===n.a.yb(l.a.Ufa))return bb=Pa.Ud.getPropertyBool(lc,l.a.Ufa),rb=Pa.Ud.getPropertyBool(rb,
l.a.Ufa),Pa.Ud.setPropertyBool(La,l.a.Ufa,null!=bb&&!!bb&&null!=rb&&!!rb),Pa.og.add(n.a.yb(l.a.Ufa)),!0;if(bb===n.a.yb(l.a.I3b))return bb=Pa.Ud.getPropertyUint32(rb,l.a.I3b),null!=bb&&(Pa.Ud.setPropertyUint32(La,l.a.I3b,bb),Pa.og.add(n.a.yb(l.a.I3b))),!0;if(bb===n.a.yb(l.a.hfb)||bb===n.a.yb(l.a.ffb)||bb===n.a.yb(l.a.efb))return(rb=Pa.Ud.getPropertyString(rb,n.a.uX(bb)))&&0<rb.length&&(Pa.Ud.setPropertyString(La,n.a.uX(bb),rb),Pa.og.add(bb)),!0;if(bb===n.a.yb(l.a.iBb)||bb===n.a.yb(l.a.QFd)){lc=Pa.Ud.getPropertyObjectId(lc,
n.a.uX(bb));if(na.a.W7b(Pa.lq,lc))return!0;if((rb=Pa.Ud.getPropertyObjectId(rb,n.a.uX(bb)))&&rb!==fa.a.nil)return Pa.Ud.setPropertyObjectId(La,n.a.uX(bb),rb),Pa.og.add(bb),!0;La.removeProperty(n.a.uX(bb));Pa.og.add(bb);return!0}if(bb===n.a.yb(l.a.J7)){lc=Pa.Ud.getPropertyObjectId(lc,l.a.J7);if((lc=na.a.W7b(Pa.lq,lc))&&Pa.Ud.getPropertyObjectIds(lc,l.a.contentControlNode).TG().contains(Pa.Xk.id))return!0;rb=Pa.Ud.getPropertyObjectId(rb,l.a.J7);return(lc=na.a.W7b(Pa.lq,rb))&&Pa.Ud.getPropertyObjectIds(lc,
l.a.contentControlNode).TG().contains(Pa.Xk.id)?(Pa.Ud.setPropertyObjectId(La,l.a.J7,rb),Pa.og.add(bb),!0):!1}if(bb===n.a.yb(l.a.K7))return bb=Pa.Ud.getPropertyBool(rb,l.a.K7),null==bb||bb||(Pa.Ud.setPropertyBool(La,l.a.K7,!1),Pa.og.add(n.a.yb(l.a.K7))),!0;if(bb===n.a.yb(l.a.aqb)){bb=Pa.Ud.getPropertyObjectId(lc,l.a.aqb);rb=Pa.Ud.getPropertyObjectId(rb,l.a.aqb);if(bb&&!bb.equals(rb))return!1;if(bb=bb||rb)Pa.Ud.setPropertyObjectId(La,l.a.aqb,bb),Pa.og.add(n.a.yb(l.a.aqb));return!0}!this.Xb.isFeatureEnabled(29)||
bb!==n.a.yb(l.a.j4)&&bb!==n.a.yb(l.a.poa)&&bb!==n.a.yb(l.a.qoa)||u.a.instance.Ta(512274638,1,1,"ContentControlNodeComplexMerge: Unexpected merge conflict for inserted tracked change property [PropertyId: {1}]",bb);return!1}static kh(){return new oa}static get instance(){return oa.Mg.value}}oa.Mg=new a.a(oa.kh);Object(F.a)(oa,"ContentControlNodeComplexMerge",k.a,[]);class ja extends k.a{constructor(){super()}get Mn(){return 10}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.customXmlPartNode),1);return Pa}dC(Pa,
bb){if(bb===n.a.yb(l.a.customXmlPartNode)){bb=Pa.Xk;const rb=Pa.Ud;var lc=rb.getPropertyObjectIds(Pa.Kg.value.lu,l.a.customXmlPartNode);const La=rb.getPropertyObjectIds(Pa.Kg.value.wf,l.a.customXmlPartNode),sb=rb.getPropertyObjectIds(Pa.un.value.wf,l.a.customXmlPartNode);lc=this.ndn(lc,La,sb);0<lc.length?rb.setPropertyObjectIds(bb,l.a.customXmlPartNode,lc):bb.removeProperty(l.a.customXmlPartNode);Pa.og.add(n.a.yb(l.a.customXmlPartNode));return!0}return!1}ndn(Pa,bb,lc){return this.cGa(Pa,bb,lc)}static kh(){return new ja}static get instance(){return ja.Mg.value}}
ja.Mg=new a.a(ja.kh);Object(F.a)(ja,"CustomXmlPartContainerNodeComplexMerge",k.a,[]);class qa extends k.a{constructor(){super()}get Mn(){return 9}get qA(){return 0}static kh(){return new qa}static get instance(){return qa.Mg.value}}qa.Mg=new a.a(qa.kh);Object(F.a)(qa,"CustomXmlPartNodeComplexMerge",k.a,[]);class Ia extends k.a{constructor(){super()}get Mn(){return 29}get qA(){return 3}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.embeddedFontNode),1);return Pa}dC(Pa,bb){if(bb===n.a.yb(l.a.embeddedFontNode)){bb=
Pa.Ud;var lc=bb.getPropertyObjectIds(Pa.Kg.value.lu,l.a.embeddedFontNode),rb=bb.getPropertyObjectIds(Pa.Kg.value.wf,l.a.embeddedFontNode);const La=bb.getPropertyObjectIds(Pa.un.value.wf,l.a.embeddedFontNode);lc=this.cGa(lc,rb,La);rb=Pa.Xk;0<lc.length?bb.setPropertyObjectIds(rb,l.a.embeddedFontNode,lc):rb.removeProperty(l.a.embeddedFontNode);Pa.og.add(n.a.yb(l.a.embeddedFontNode));return!0}return!1}static kh(){return new Ia}static get instance(){return Ia.Mg.value}}Ia.Mg=new a.a(Ia.kh);Object(F.a)(Ia,
"EmbeddedFontContainerNodeComplexMerge",k.a,[]);class Va extends k.a{constructor(){super()}get Mn(){return 30}get qA(){return 3}static kh(){return new Va}static get instance(){return Va.Mg.value}}Va.Mg=new a.a(Va.kh);Object(F.a)(Va,"EmbeddedFontNodeComplexMerge",k.a,[]);class Na extends k.a{constructor(){super()}get Mn(){return 11}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.N3),4);Pa.Z(n.a.yb(l.a.D0a),1);return Pa}dC(Pa,bb){if(bb===n.a.yb(l.a.D0a)){const lc=Pa.Xk,rb=Pa.Ud;u.a.instance.Ta(4063307,1,4,
"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",lc.id,lc.Rc,bb);bb=rb.getPropertyObjectIds(Pa.Kg.value.lu,l.a.D0a);const La=rb.getPropertyObjectIds(Pa.Kg.value.wf,l.a.D0a),sb=rb.getPropertyObjectIds(Pa.un.value.wf,l.a.D0a);bb=this.IOi(bb,La,sb,(Sb,kc)=>Sb.equals(kc));0<bb.length?rb.setPropertyObjectIds(lc,l.a.D0a,bb):lc.removeProperty(l.a.D0a);Pa.og.add(n.a.yb(l.a.D0a));return!0}u.a.instance.Ta(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Pa.Kg.value.wf.id,bb);return!1}static kh(){return new Na}static get instance(){return Na.Mg.value}}Na.Mg=new a.a(Na.kh);Object(F.a)(Na,"FootnoteEndnoteContainerNodeComplexMerge",k.a,[]);class za extends k.a{constructor(){super()}get Mn(){return 12}get qA(){return 3}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.qna),1);return Pa}dC(Pa,bb){const lc=Pa.Xk,rb=Pa.Ud;if(bb===n.a.yb(l.a.qna)){let La=-1;u.a.instance.Ta(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
lc.id,lc.Rc,bb);const sb=rb.getPropertyInt32(Pa.Kg.value.wf,l.a.qna),Sb=rb.getPropertyInt32(Pa.un.value.wf,l.a.qna);null!=sb&&-1!==sb?La=sb:null!=Sb&&(La=Sb);rb.setPropertyInt32(lc,l.a.qna,La);Pa.og.add(bb);return!0}u.a.instance.Ta(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Pa.Kg.value.lu.id,bb);return!1}static kh(){return new za}static get instance(){u.a.instance.Ta(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");
return za.Mg.value}}za.Mg=new a.a(za.kh);Object(F.a)(za,"FootnoteEndnoteNodeComplexMerge",k.a,[]);class la extends k.a{constructor(){super()}get Mn(){return 47}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.glossaryPageContentNode),1);return Pa}dC(Pa,bb){return bb===n.a.yb(l.a.glossaryPageContentNode)?(u.a.instance.Ta(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Pa.Xk.id,Pa.Xk.Rc,bb),k.a.hNf(Pa,this,l.a.glossaryPageContentNode)):
!1}static kh(){return new la}static get instance(){return la.Mg.value}}la.Mg=new a.a(la.kh);Object(F.a)(la,"GlossaryPageManifestNodeComplexMerge",k.a,[]);class va extends k.a{constructor(){super()}get Mn(){return 13}get qA(){return 3}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.Oia),4);return Pa}static kh(){return new va}static get instance(){return va.Mg.value}}va.Mg=new a.a(va.kh);Object(F.a)(va,"HeaderFooterContainerNodeComplexMerge",k.a,[]);class ia extends k.a{constructor(){super()}get Mn(){return 14}get qA(){return 3}wk(){const Pa=
super.wk();Pa.Z(n.a.yb(l.a.runId),3);Pa.Z(n.a.yb(l.a.Lc),3);Pa.Z(n.a.yb(l.a.Cui),3);Pa.Z(n.a.yb(l.a.iU),1);Pa.Z(n.a.yb(f.a.R_),1);Pa.Z(n.a.yb(y.a.imageAltText),1);Pa.Z(n.a.yb(l.a.RX),1);Pa.Z(n.a.yb(y.a.Tca),1);Pa.Z(n.a.yb(f.a.u8a),1);Pa.Z(n.a.yb(l.a.lZa),1);return Pa}dC(Pa,bb){if(bb===n.a.yb(y.a.imageAltText)||bb===n.a.yb(l.a.RX)||bb===n.a.yb(l.a.iU)||bb===n.a.yb(l.a.UX)||bb===n.a.yb(y.a.Qib)||bb===n.a.yb(y.a.Tca)||bb===n.a.yb(f.a.R_)||bb===n.a.yb(f.a.u8a)||bb===n.a.yb(l.a.lZa)){const rb=Pa.Xk;var lc=
Pa.Ud;u.a.instance.Ta(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",rb.id,rb.Rc,bb);const La=lc.getPropertyInt32(Pa.Kg.value.wf,f.a.R_);lc=lc.getPropertyInt32(Pa.un.value.wf,f.a.R_);if(null!=La&&(0===La||2===La))return!0;if(null!=lc&&(0===lc||2===lc))return bb=Pa.un.value.wf,this.nfb(bb,rb,y.a.imageAltText),this.nfb(bb,rb,l.a.RX),this.nfb(bb,rb,l.a.UX),bb.hasProperty(l.a.iU)&&this.nfb(bb,rb,l.a.iU),this.nfb(bb,rb,y.a.Qib),this.nfb(bb,
rb,y.a.Tca),this.nfb(bb,rb,f.a.R_),this.nfb(bb,rb,f.a.u8a),Pa.og.add(n.a.yb(y.a.imageAltText)),Pa.og.add(n.a.yb(l.a.RX)),Pa.og.add(n.a.yb(l.a.UX)),Pa.og.add(n.a.yb(l.a.iU)),Pa.og.add(n.a.yb(y.a.Qib)),Pa.og.add(n.a.yb(y.a.Tca)),Pa.og.add(n.a.yb(f.a.R_)),Pa.og.add(n.a.yb(f.a.u8a)),Pa.og.add(n.a.yb(l.a.lZa)),!0}u.a.instance.Ta(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Pa.Kg.value.lu.id,bb);return!1}static kh(){return new ia}static get instance(){return ia.Mg.value}}
ia.Mg=new a.a(ia.kh);Object(F.a)(ia,"ImageNodeComplexMerge",k.a,[]);class pa extends k.a{constructor(){super()}get Mn(){return 40}get qA(){return 0}static kh(){return new pa}static get instance(){return pa.Mg.value}}pa.Mg=new a.a(pa.kh);Object(F.a)(pa,"IntelligenceAnnotationNodeComplexMerge",k.a,[]);class sa extends k.a{constructor(){super()}get Mn(){return 32}get qA(){return 0}static kh(){return new sa}static get instance(){return sa.Mg.value}}sa.Mg=new a.a(sa.kh);Object(F.a)(sa,"IntelligenceContentLocatorNodeComplexMerge",
k.a,[]);class Ha extends k.a{constructor(){super()}get Mn(){return 34}get qA(){return 0}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.sjb),1);return Pa}dC(Pa,bb){const lc=Pa.Xk,rb=Pa.Ud;if(bb===n.a.yb(l.a.sjb)){bb=rb.getPropertyObjectIds(Pa.Kg.value.lu,l.a.sjb);const La=rb.getPropertyObjectIds(Pa.Kg.value.wf,l.a.sjb),sb=rb.getPropertyObjectIds(Pa.un.value.wf,l.a.sjb);bb=this.cGa(bb,La,sb);rb.setPropertyObjectIds(lc,l.a.sjb,bb);Pa.og.add(n.a.yb(l.a.sjb));return!0}return!1}static kh(){return new Ha}static get instance(){return Ha.Mg.value}}
Ha.Mg=new a.a(Ha.kh);Object(F.a)(Ha,"IntelligenceRegionNodeComplexMerge",k.a,[]);class ra extends k.a{constructor(){super()}get Mn(){return 35}get qA(){return 0}static kh(){return new ra}static get instance(){return ra.Mg.value}}ra.Mg=new a.a(ra.kh);Object(F.a)(ra,"IntelligenceRejectionNodeComplexMerge",k.a,[]);class Ma extends k.a{constructor(){super()}get Mn(){return 39}get qA(){return 0}static kh(){return new Ma}static get instance(){return Ma.Mg.value}}Ma.Mg=new a.a(Ma.kh);Object(F.a)(Ma,"IntelligenceReviewedNodeComplexMerge",
k.a,[]);class ya extends k.a{constructor(){super()}get Mn(){return 33}get qA(){return 0}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.nTc),1);Pa.Z(n.a.yb(l.a.nXd),1);Pa.Z(n.a.yb(l.a.dBf),1);Pa.Z(n.a.yb(l.a.fBf),1);return Pa}dC(Pa,bb){const lc=Pa.Xk,rb=Pa.Ud;if(bb===n.a.yb(l.a.nTc)||bb===n.a.yb(l.a.nXd)||bb===n.a.yb(l.a.dBf)||bb===n.a.yb(l.a.fBf)){bb=bb===n.a.yb(l.a.nTc)?l.a.nTc:l.a.nXd;var La=rb.getPropertyObjectIds(Pa.Kg.value.lu,bb);const sb=rb.getPropertyObjectIds(Pa.Kg.value.wf,bb),Sb=rb.getPropertyObjectIds(Pa.un.value.wf,
bb);La=this.cGa(La,sb,Sb);rb.setPropertyObjectIds(lc,bb,La);Pa.og.add(n.a.yb(bb));return!0}return!1}static kh(){return new ya}static get instance(){return ya.Mg.value}}ya.Mg=new a.a(ya.kh);Object(F.a)(ya,"IntelligenceRootNodeComplexMerge",k.a,[]);class Ga extends k.a{constructor(){super()}get Mn(){return 42}get qA(){return 0}static kh(){return new Ga}static get instance(){return Ga.Mg.value}}Ga.Mg=new a.a(Ga.kh);Object(F.a)(Ga,"IntelligenceSettingNodeComplexMerge",k.a,[]);class wa extends k.a{constructor(){super()}get Mn(){return 45}get qA(){return 0}static kh(){return new wa}static get instance(){return wa.Mg.value}}
wa.Mg=new a.a(wa.kh);Object(F.a)(wa,"IntelligenceWorkflowNodeComplexMerge",k.a,[]);class hb extends k.a{constructor(){super()}get Mn(){return 15}get qA(){return 3}static kh(){return new hb}static get instance(){return hb.Mg.value}}hb.Mg=new a.a(hb.kh);Object(F.a)(hb,"NumberListNodeComplexMerge",k.a,[]);var eb=c(118);class jb extends k.a{constructor(){super()}get Mn(){return 16}get qA(){return 0}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.Hzb),1);Pa.Z(n.a.yb(eb.a.h9e),7);Pa.Z(n.a.yb(eb.a.f9e),7);return Pa}dC(Pa,
bb){const lc=Pa.Xk,rb=Pa.Ud;if(bb===n.a.yb(l.a.Hzb))return this.XHf(rb,Pa.Kg.value.wf,Pa.un.value.wf,lc,l.a.Hzb),Pa.og.add(bb),!0;u.a.instance.Ta(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Pa.Kg.value.lu.id,bb);return!1}static kh(){return new jb}static get instance(){return jb.Mg.value}}jb.Mg=new a.a(jb.kh);Object(F.a)(jb,"OutlineElementNodeComplexMerge",k.a,[]);class ub extends k.a{constructor(){super()}get Mn(){return 17}wk(){const Pa=
super.wk();Pa.Z(n.a.yb(l.a.Hzb),1);Pa.Z(n.a.yb(l.a.Xma),1);Pa.Z(n.a.yb(eb.a.iJ),1);Pa.Z(n.a.yb(eb.a.Qcc),1);Pa.Z(n.a.yb(eb.a.gia),8);return Pa}dC(Pa,bb){const lc=Pa.Xk,rb=Pa.Ud;if(bb===n.a.yb(l.a.Hzb))return this.XHf(rb,Pa.Kg.value.wf,Pa.un.value.wf,lc,l.a.Hzb),Pa.og.add(bb),!0;if(bb===n.a.yb(l.a.Xma)){var La=rb.getPropertyBool(Pa.Kg.value.wf,l.a.Xma),sb=rb.getPropertyBool(Pa.un.value.wf,l.a.Xma);rb.setPropertyBool(lc,l.a.Xma,null==La?!1:La&&null==sb?!1:sb);Pa.og.add(bb);return!0}if(bb===n.a.yb(eb.a.Qcc))return this.XHf(rb,
Pa.Kg.value.wf,Pa.un.value.wf,lc,eb.a.Qcc),Pa.og.add(bb),!0;if(bb===n.a.yb(eb.a.iJ))return La=rb.getPropertyBool(Pa.Kg.value.wf,eb.a.iJ),sb=rb.getPropertyBool(Pa.un.value.wf,eb.a.iJ),rb.setPropertyBool(lc,eb.a.iJ,null==La?!0:La||null==sb?!0:sb),Pa.og.add(bb),!0;u.a.instance.Ta(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Pa.Kg.value.lu.id,bb);return!1}static kh(){return new ub}static get instance(){return ub.Mg.value}}
ub.Mg=new a.a(ub.kh);Object(F.a)(ub,"OutlineGroupNodeComplexMerge",k.a,[]);var ab=c(41),Ea=c(55);class Wa extends k.a{constructor(){super()}get Mn(){return 18}get qA(){return 2}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.iVd),3);Pa.Z(n.a.yb(y.a.KU),this.qA);Pa.Z(n.a.yb(l.a.ku),1);Pa.Z(n.a.yb(l.a.s9),1);Pa.Z(n.a.yb(l.a.Cq),1);Pa.Z(n.a.yb(ab.a.AJ),1);Pa.Z(n.a.yb(ab.a.B4a),1);return Pa}dC(Pa,bb){const lc=Pa.Ud;if(Pa.lq.runtime.Xb.isFeatureEnabled(71)){if(bb===n.a.yb(l.a.ku)||bb===n.a.yb(l.a.s9)||bb===n.a.yb(ab.a.B4a)||
bb===n.a.yb(l.a.Cq)||bb===n.a.yb(ab.a.AJ))return this.aRo(lc,Pa)}else if(bb===n.a.yb(l.a.ku)||bb===n.a.yb(l.a.Cq)){let rb,La;({BHc:bb,Q2a:rb,G2a:La}=this.p7e(Object(Ea.a)(lc,lc.getPropertyUint32s,"getPropertyUint32s"),Pa.Kg.value.lu,Pa.Kg.value.wf,Pa.un.value.wf,l.a.ku,null));if(!La&&!rb)return u.a.instance.Ta(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Pa.Kg.value.wf.id,n.a.yb(l.a.ku)),!0;let sb,Sb,kc;({BHc:sb,
Q2a:Sb,G2a:kc}=this.p7e(Object(Ea.a)(lc,lc.getPropertyObjectIds,"getPropertyObjectIds"),Pa.Kg.value.lu,Pa.Kg.value.wf,Pa.un.value.wf,l.a.Cq,null));if(!Sb&&!kc)return u.a.instance.Ta(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Pa.Kg.value.wf.id,n.a.yb(l.a.Cq)),!0;const Lb=Sb&&!kc;if((rb&&!La)!==Lb)return u.a.instance.Ta(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Pa.Kg.value.wf.id,n.a.yb(l.a.ku),n.a.yb(l.a.Cq)),!1;Lb&&(lc.setPropertyObjectIds(Pa.Xk,l.a.Cq,sb),lc.setPropertyUint32s(Pa.Xk,l.a.ku,bb));u.a.instance.Ta(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",Pa.Kg.value.wf.id,n.a.yb(l.a.ku),rb,La,n.a.yb(l.a.Cq),Sb,kc);Pa.og.add(n.a.yb(l.a.Cq));Pa.og.add(n.a.yb(l.a.ku));
return!0}u.a.instance.Ta(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Pa.Kg.value.wf.id,bb);return!1}Eni(Pa,bb,lc,rb){let La;({BHc:bb,Q2a:rb,G2a:La}=this.p7e(bb,lc.Kg.value.lu,lc.Kg.value.wf,lc.un.value.wf,Pa,rb));return La||rb?{returnValue:!0,D9e:bb,Q2a:rb,G2a:La}:(u.a.instance.Ta(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
lc.Kg.value.wf.id.toString(),n.a.yb(Pa)),{returnValue:!1,D9e:bb,Q2a:rb,G2a:La})}Gmi(Pa,bb,lc,rb,La){let sb;let Sb,kc,Lb,Qc;({D9e:sb,Q2a:Dc,G2a:Sb,returnValue:Lb}=this.Eni(Pa,Object(Ea.a)(lc,lc.getPropertyUint32s,"getPropertyUint32s"),rb,null));({D9e:lc,Q2a:La,G2a:kc,returnValue:Qc}=this.Eni(bb,Object(Ea.a)(lc,lc.getPropertyObjectIds,"getPropertyObjectIds"),rb,La));var Dc=Dc&&!Sb;return Lb&&Qc?Dc!==(La&&!kc)?(u.a.instance.Ta(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
rb.Kg.value.wf.id.toString(),n.a.yb(Pa),n.a.yb(bb)),{returnValue:2,vFd:sb,uFd:lc,yle:Dc}):{returnValue:0,vFd:sb,uFd:lc,yle:Dc}:{returnValue:1,vFd:sb,uFd:lc,yle:Dc}}lDf(Pa){let bb=!0;Pa.forEach(lc=>lc!==fa.a.nil?bb=!1:!0);return bb}PWl(Pa,bb,lc){return this.lDf(Pa)&&this.lDf(bb)&&this.lDf(lc)?!0:!1}aRo(Pa,bb){let lc,rb,La,sb,Sb,kc;var Lb=({vFd:sb,uFd:Sb,yle:rb}=this.Gmi(ab.a.B4a,l.a.Cq,Pa,bb,null)).returnValue;if(2===Lb||1===Lb)return!0;({vFd:La,uFd:kc,yle:lc,returnValue:Lb}=this.Gmi(l.a.ku,l.a.s9,
Pa,bb,Object(Ea.a)(this,this.PWl,"getExtendedGuidEquivalence")));if(2===Lb||1===Lb)return!0;let Qc;({BHc:Lb,Q2a:Dc,G2a:Qc}=this.tWk(Object(Ea.a)(Pa,Pa.getPropertyDictionary,"getPropertyDictionary"),bb.Kg.value.lu,bb.Kg.value.wf,bb.un.value.wf,ab.a.AJ));if(!Qc&&!Dc)return u.a.instance.Ta(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",bb.Kg.value.wf.id.toString(),n.a.yb(ab.a.AJ)),!0;var Dc=Dc&&!Qc;if(lc!==rb||lc!==
Dc)return u.a.instance.Ta(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",bb.Kg.value.wf.id.toString(),n.a.yb(l.a.ku),n.a.yb(ab.a.B4a),n.a.yb(ab.a.AJ),rb,lc,Dc),!0;lc&&(Pa.setPropertyObjectIds(bb.Xk,l.a.Cq,Sb),Pa.setPropertyUint32s(bb.Xk,ab.a.B4a,sb),Pa.setPropertyObjectIds(bb.Xk,
l.a.s9,kc),Pa.setPropertyUint32s(bb.Xk,l.a.ku,La),Pa.setPropertyDictionary(bb.Xk,ab.a.AJ,Lb));u.a.instance.Ta(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingNSID: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",bb.Kg.value.wf.id.toString(),rb,lc,Dc);bb.og.add(n.a.yb(ab.a.B4a));bb.og.add(n.a.yb(l.a.Cq));bb.og.add(n.a.yb(l.a.ku));bb.og.add(n.a.yb(l.a.s9));bb.og.add(n.a.yb(ab.a.AJ));return!0}static kh(){return new Wa}static get instance(){return Wa.Mg.value}}
Wa.Mg=new a.a(Wa.kh);Object(F.a)(Wa,"PageContentNodeComplexMerge",k.a,[]);class Bb extends k.a{constructor(){super()}get Mn(){return 19}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.HHa),1);Pa.Z(n.a.yb(l.a.appsNode),2);Pa.Z(n.a.yb(l.a.customXmlPartContainerNode),2);Pa.Z(n.a.yb(l.a.intelligenceRootNode),1);return Pa}dC(Pa,bb){const lc=Pa.Ud;if(bb===n.a.yb(l.a.HHa)){var rb=lc.getPropertyObjectIds(Pa.Kg.value.lu,l.a.HHa),La=lc.getPropertyObjectIds(Pa.Kg.value.wf,l.a.HHa),sb=lc.getPropertyObjectIds(Pa.un.value.wf,
l.a.HHa);if((rb=this.Cdn(rb,La,sb,(Sb,kc)=>Sb.equals(kc),Sb=>{let kc;({value:kc}=Pa.lq.runtime.Jq.Dc(Sb)).returnValue?Pa.lq.runtime.en.Z(Sb,new z.a(kc,!1)):u.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},Pa.lq))&&0<rb.length)return lc.setPropertyObjectIds(Pa.Xk,l.a.HHa,rb),Pa.og.add(n.a.yb(l.a.HHa)),!0}if(bb===n.a.yb(l.a.intelligenceRootNode))return rb=lc.getPropertyObjectIds(Pa.Kg.value.lu,l.a.intelligenceRootNode),
La=lc.getPropertyObjectIds(Pa.Kg.value.wf,l.a.intelligenceRootNode),sb=lc.getPropertyObjectIds(Pa.un.value.wf,l.a.intelligenceRootNode),rb=this.cGa(rb,La,sb),lc.setPropertyObjectIds(Pa.Xk,l.a.intelligenceRootNode,rb),Pa.og.add(bb),!0;u.a.instance.Ta(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Pa.Kg.value.wf.id,bb);return!1}static kh(){return new Bb}static get instance(){return Bb.Mg.value}}Bb.Mg=new a.a(Bb.kh);
Object(F.a)(Bb,"PageManifestNodeComplexMerge",k.a,[]);class Mb extends k.a{constructor(){super()}get Mn(){return 43}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.Ula),0);Pa.Z(n.a.yb(l.a.HLb),0);Pa.Z(n.a.yb(l.a.hIb),0);Pa.Z(n.a.yb(l.a.Vna),1);Pa.Z(n.a.yb(l.a.sessionId),3);Pa.Z(n.a.yb(l.a.buildVersion),3);Pa.Z(n.a.yb(l.a.fR),1);Pa.Z(n.a.yb(l.a.Vxi),1);Pa.Z(n.a.yb(l.a.nv),1);return Pa}dC(Pa,bb){if(bb===n.a.yb(l.a.fR)||bb===n.a.yb(l.a.Vxi)||bb===n.a.yb(l.a.nv)){var lc=Pa.un.value.wf,rb=Pa.Kg.value.wf,La=n.a.uX(bb);
rb=Pa.Ud.getPropertyBool(rb,La);lc=Pa.Ud.getPropertyBool(lc,La);Pa.Ud.setPropertyBool(Pa.Xk,La,null==rb?!1:rb&&null==lc?!1:lc);Pa.og.add(bb);return!0}if(bb===n.a.yb(l.a.Vna)){bb=Pa.Ud;lc=Pa.Kg.value.lu;rb=Pa.un.value.wf;La=Pa.Kg.value.wf;lc=lc?bb.getPropertyObjectId(lc,l.a.Vna):null;rb=rb?bb.getPropertyObjectId(rb,l.a.Vna):null;La=La?bb.getPropertyObjectId(La,l.a.Vna):null;u.a.instance.Ta(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",lc?lc.toString():
"NULL",rb?rb.toString():"NULL",La?La.toString():"NULL");if(rb){if(La&&rb.equals(La))return Pa.og.add(n.a.yb(l.a.Vna)),bb.setPropertyObjectId(Pa.Xk,l.a.Vna,rb),!0;if(na.a.ETd.equals(rb))return Pa.og.add(n.a.yb(l.a.Vna)),bb.setPropertyObjectId(Pa.Xk,l.a.Vna,na.a.ETd),!0}if(La&&na.a.ETd.equals(La))return Pa.og.add(n.a.yb(l.a.Vna)),bb.setPropertyObjectId(Pa.Xk,l.a.Vna,na.a.ETd),!0;u.a.instance.Ta(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",lc?lc.toString():
"NULL",rb?rb.toString():"NULL",La?La.toString():"NULL")}return!1}static kh(){return new Mb}static get instance(){return Mb.Mg.value}}Mb.Mg=new a.a(Mb.kh);Object(F.a)(Mb,"PageMetadataNodeComplexMerge",k.a,[]);var Fb=c(1784),vb=c(153);class $a extends k.a{constructor(){super()}get Mn(){return 31}wk(){const Pa=super.wk();Pa.Z(n.a.yb(vb.a.JA),1);Pa.Z(n.a.yb(l.a.listID),3);Pa.Z(n.a.yb(l.a.listLevel),1);Pa.Z(n.a.yb(l.a.He),3);Pa.Z(n.a.yb(l.a.P1b),3);Pa.Z(n.a.yb(l.a.runId),3);Pa.Z(n.a.yb(l.a.WKd),3);Pa.Z(n.a.yb(y.a.fontColor),
3);Pa.Z(n.a.yb(l.a.MHh),3);Pa.Z(n.a.yb(l.a.Lc),1);Pa.Z(n.a.yb(vb.a.kYd),3);Pa.Z(n.a.yb(vb.a.LHf),3);Pa.Z(n.a.yb(vb.a.SUc),3);Pa.Z(n.a.yb(l.a.LHl),3);Pa.Z(n.a.yb(eb.a.NEj),3);for(let bb=0;bb<$a.Q3a.length;bb++)Pa.Z($a.Q3a[bb],1);return Pa}dC(Pa,bb){var lc=Pa.Ud;const rb=Pa.Xk;n.a.uX(bb);if(bb===n.a.yb(l.a.Lc)){lc=Pa.Ud.getPropertyInt32(Pa.un.value.wf,l.a.Lc);if(null==lc||!lc)return!0;Pa.Ud.setPropertyInt32(rb,l.a.Lc,lc);Pa.og.add(bb);return!0}if(bb===n.a.yb(vb.a.JA)){const La=lc.getPropertyUint32(Pa.Kg.value.wf,
vb.a.JA),sb=lc.getPropertyUint32(Pa.un.value.wf,vb.a.JA);if(null!=La&&null!=sb&&La===sb)return lc.setPropertyUint32(rb,vb.a.JA,La),Pa.og.add(bb),!0;if(null==La&&null==sb)return rb.removeProperty(vb.a.JA),Pa.og.add(n.a.yb(vb.a.JA)),!0;if(null!=La&&null==sb)return lc.setPropertyUint32(rb,vb.a.JA,La),Pa.og.add(bb),!0;if(null==La&&null!=sb)return lc.setPropertyUint32(rb,vb.a.JA,sb),Pa.og.add(bb),!0}else{if(bb===n.a.yb(l.a.listLevel))return this.rQo(lc,Pa);if(Array.contains($a.Q3a,bb))return this.qQo(Pa)}return!1}qQo(Pa){let bb=
!0,lc=!0,rb,La;({bLm:bb,yIm:lc,YAl:rb,C4k:La}=this.uWk(Pa));u.a.instance.Ta(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",Pa.Kg.value.wf.id.toString(),bb,lc);return bb&&!lc?(this.xPi(La,Pa),!0):bb?!1:(this.xPi(rb,Pa),!0)}uWk(Pa){let bb,lc,rb,La;const sb=Pa.un.value;let Sb;const kc=Pa.Kg.value;let Lb;lc=bb=!0;rb=new H.a;La=new H.a;for(let Qc=0;Qc<$a.Q3a.length;Qc++){const Dc=$a.Q3a[Qc],Fd=({value:Sb}=
sb.Spa.Dc(Dc)).returnValue;({value:Lb}=kc.Spa.Dc(Dc)).returnValue&&(bb=this.RCj(Pa.Kg,rb,Lb,Dc)&&bb);Fd&&(lc=this.RCj(Pa.un,La,Sb,Dc)&&lc)}return{bLm:bb,yIm:lc,YAl:rb,C4k:La}}RCj(Pa,bb,lc,rb){const La=n.a.uX(rb);Pa=Pa.value.wf;bb.Z(rb,Pa.hasProperty(La)?Pa.CX(La):null);return!lc.aY}xPi(Pa,bb){const lc=bb.Xk;for(let La=0;La<$a.Q3a.length;La++){var rb=$a.Q3a[La];const sb=n.a.uX(rb);(rb=Pa.J(rb))?lc.fTa(sb,rb):lc.removeProperty(sb)}for(Pa=0;Pa<$a.Q3a.length;Pa++)bb.og.add($a.Q3a[Pa]);u.a.instance.Ta(578932994,
1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",bb.Kg.value.wf.id.toString())}rQo(Pa,bb){const lc=bb.Xk,rb=Pa.getPropertyInt32(bb.Kg.value.wf,l.a.listLevel),La=Pa.getPropertyInt32(bb.un.value.wf,l.a.listLevel);return null!=rb&&null!=La&&rb===La?(Pa.setPropertyInt32(lc,l.a.listLevel,rb),bb.og.add(n.a.yb(l.a.listLevel)),!0):null==rb&&null==La?(lc.removeProperty(l.a.listLevel),bb.og.add(n.a.yb(l.a.listLevel)),!0):null!=rb&&null==La?(Pa.setPropertyInt32(lc,l.a.listLevel,
rb),bb.og.add(n.a.yb(l.a.listLevel)),!0):null==rb&&null!=La?(Pa.setPropertyInt32(lc,l.a.listLevel,La),bb.og.add(n.a.yb(l.a.listLevel)),!0):!1}static kh(){return new $a}static get instance(){return $a.Mg.value}}$a.Mg=new a.a($a.kh);$a.Q3a=[n.a.yb(l.a.$d),n.a.yb(l.a.gt),n.a.yb(y.a.C4),n.a.yb(l.a.yca),n.a.yb(l.a.ov),n.a.yb(l.a.Wr),n.a.yb(y.a.k0),n.a.yb(l.a.z3e),n.a.yb(y.a.font),n.a.yb(eb.a.glb),n.a.yb(f.a.paragraphStyle)];Object(F.a)($a,"PersistablePropertySetComplexMerge",k.a,[]);class kb extends k.a{constructor(){super()}get Mn(){return 21}get qA(){return 0}static kh(){return new kb}static get instance(){return kb.Mg.value}}
kb.Mg=new a.a(kb.kh);Object(F.a)(kb,"RevisionMetadataNodeComplexMerge",k.a,[]);class Ua extends k.a{constructor(){super()}get Mn(){return 48}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.T3i),3);return Pa}static kh(){return new Ua}static get instance(){return Ua.Mg.value}}Ua.Mg=new a.a(Ua.kh);Object(F.a)(Ua,"ShadowNumberListNodeComplexMerge",k.a,[]);class Sa extends k.a{constructor(){super()}get Mn(){return 22}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.H3a),7);Pa.Z(n.a.yb(l.a.AVc),2);return Pa}static kh(){return new Sa}static get instance(){return Sa.Mg.value}}
Sa.Mg=new a.a(Sa.kh);Object(F.a)(Sa,"SharedPersistablePropertySetComplexMerge",k.a,[]);class xb extends k.a{constructor(){super()}get Mn(){return 38}get qA(){return 3}static kh(){return new xb}static get instance(){return xb.Mg.value}}xb.Mg=new a.a(xb.kh);Object(F.a)(xb,"StylePropertySetComplexMerge",k.a,[]);var Qb=c(1591),Ib=c(1638);class $b extends k.a{constructor(){super()}get Mn(){return 23}get qA(){return 0}wk(){const Pa=super.wk();Pa.Z(n.a.yb(y.a.ef),4);Pa.Z(n.a.yb(l.a.rowSpan),1);Pa.Z(n.a.yb(l.a.colSpan),
1);Pa.Z(n.a.yb(l.a.ghostCell),1);Pa.Z(n.a.yb(ab.a.vMerge),1);Pa.Z(n.a.yb(ab.a.gridSpan),1);Pa.Z(n.a.yb(l.a.I7a),2);Pa.Z(n.a.yb(l.a.gqb),2);Pa.Z(n.a.yb(l.a.eIa),2);Pa.Z(n.a.yb(l.a.Epb),5);return Pa}pIb(Pa){if(!Pa)return u.a.instance.Ta(573957923,1,2,"Feature helper is null"),!1;Pa.Az(105);return Pa.isFeatureEnabled(105)}Vwa(Pa){if(!Pa)return u.a.instance.Ta(540120285,1,2,"Feature helper is null"),!1;Pa.Az(106);return Pa.isFeatureEnabled(106)}dC(Pa,bb){Pa.lq.runtime.SG("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+
bb);var lc=bb===n.a.yb(l.a.rowSpan)||bb===n.a.yb(l.a.colSpan)||bb===n.a.yb(l.a.ghostCell);this.Vwa(Pa.lq.runtime.Xb)&&(lc=lc||bb===n.a.yb(ab.a.vMerge)||bb===n.a.yb(ab.a.gridSpan));if(!this.pIb(Pa.lq.runtime.Xb))return!lc;var rb=Pa.un.value.lu,La=Ib.e(Pa.lq,rb,null);if(La.equals(fa.a.nil))return u.a.instance.Ta(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",rb.id),Pa.lq.logger.Og(Object.assign(new Qb.a,{info:"Table node ID could not be found for table cell"})),
!1;var sb=Pa.lq.runtime.$Ab.J(La).J(rb.id);if(!sb)return!lc;rb=Pa.Xk;La=Pa.Ud;if(bb===n.a.yb(l.a.ghostCell))return La.setPropertyBool(rb,l.a.ghostCell,sb.hg),Pa.og.add(n.a.yb(l.a.ghostCell)),!0;if(bb===n.a.yb(l.a.rowSpan))return bb=sb.rowSpan,sb=sb.colSpan,null!=bb&&null!=sb&&(1<bb||1<sb)?La.setPropertyUint32(rb,l.a.rowSpan,bb):rb.removeProperty(l.a.rowSpan),Pa.og.add(n.a.yb(l.a.rowSpan)),!0;if(bb===n.a.yb(l.a.colSpan))return bb=sb.rowSpan,lc=sb.colSpan,sb=sb.hg,null!=bb&&null!=lc&&(1<bb||1<lc)?La.setPropertyUint32(rb,
l.a.colSpan,lc):sb&&null!=lc?La.setPropertyUint32(rb,l.a.colSpan,lc):rb.removeProperty(l.a.colSpan),Pa.og.add(n.a.yb(l.a.colSpan)),!0;u.a.instance.Ta(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",bb);Pa.lq.logger.Og(Object.assign(new Qb.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!lc}static kh(){return new $b}static get instance(){return $b.Mg.value}}
$b.Mg=new a.a($b.kh);Object(F.a)($b,"TableCellNodeComplexMerge",k.a,[]);class hc extends k.a{constructor(){super()}get Mn(){return 24}pIb(Pa){if(!Pa)return u.a.instance.Ta(573845782,1,2,"Feature helper is null"),!1;Pa.Az(105);return Pa.isFeatureEnabled(105)}get qA(){return 0}wk(){const Pa=super.wk();Pa.Z(n.a.yb(y.a.ef),1);Pa.Z(n.a.yb(y.a.e1),1);Pa.Z(n.a.yb(y.a.Rya),1);Pa.Z(n.a.yb(l.a.alc),1);Pa.Z(n.a.yb(l.a.f$),1);Pa.Z(n.a.yb(l.a.I7a),2);Pa.Z(n.a.yb(l.a.gqb),2);Pa.Z(n.a.yb(l.a.eIa),2);return Pa}dC(Pa,
bb){Pa.lq.runtime.SG("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+bb);if(bb===n.a.yb(y.a.ef)||bb===n.a.yb(y.a.e1)||bb===n.a.yb(l.a.alc)||bb===n.a.yb(l.a.f$)||bb===n.a.yb(y.a.Rya)){const La=Pa.Xk;var lc=Pa.Ud;u.a.instance.Ta(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",La.id,La.Rc,bb);if(this.rql(Pa))return!1;var rb=lc.getPropertyObjectIds(Pa.Kg.value.lu,y.a.ef);const sb=lc.getPropertyObjectIds(Pa.Kg.value.wf,y.a.ef),
Sb=lc.getPropertyObjectIds(Pa.un.value.wf,y.a.ef);rb=this.IOi(rb,sb,Sb,(kc,Lb)=>kc.equals(Lb));if(0<rb.length)return lc.setPropertyObjectIds(La,y.a.ef,rb),lc.setPropertyInt32(La,y.a.Rya,rb.length),this.pIb(Pa.lq.runtime.Xb)&&({value:bb}=Pa.un.value.Spa.Dc(n.a.yb(y.a.e1)),{value:lc}=Pa.Kg.value.Spa.Dc(n.a.yb(y.a.e1)),bb.aY?La.fTa(y.a.e1,bb.newValue):La.fTa(y.a.e1,lc.newValue)),Pa.og.add(n.a.yb(y.a.ef)),Pa.og.add(n.a.yb(y.a.e1)),Pa.og.add(n.a.yb(y.a.Rya)),Pa.og.add(n.a.yb(l.a.alc)),Pa.og.add(n.a.yb(l.a.f$)),
!0}u.a.instance.Ta(4018189,1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Pa.Kg.value.wf.id,bb);return!1}rql(Pa){const bb=Pa.un.value,lc=Pa.Kg.value;let rb,La;({value:rb}=bb.Spa.Dc(n.a.yb(y.a.e1)));({value:La}=lc.Spa.Dc(n.a.yb(y.a.e1)));return rb.aY||La.aY?rb.aY&&La.aY?(u.a.instance.Ta(4273304,1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",
rb.oldValue,La.newValue,rb.newValue),Pa.lq.logger.Og(Object.assign(new Qb.a,{rj:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):hc.lTh(Pa.lq,rb,lc,"BaseConflict")||hc.lTh(Pa.lq,La,bb,"BaseFavored")?!0:!1:!1}static kh(){return new hc}static get instance(){return hc.Mg.value}static lTh(Pa,bb,lc,rb){return bb.aY&&({value:bb}=lc.Spa.Dc(n.a.yb(y.a.ef)),bb.aY)?(u.a.instance.Ta(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",
rb),Pa.logger.Og(Object.assign(new Qb.a,{rj:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}hc.Mg=new a.a(hc.kh);Object(F.a)(hc,"TableNodeComplexMerge",k.a,[]);class pb extends k.a{constructor(){super()}get Mn(){return 25}get qA(){return 0}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.Lc),3);Pa.Z(n.a.yb(y.a.ef),4);Pa.Z(n.a.yb(l.a.I7a),2);Pa.Z(n.a.yb(l.a.gqb),2);Pa.Z(n.a.yb(l.a.eIa),2);Pa.Z(n.a.yb(ab.a.kig),2);Pa.Z(n.a.yb(ab.a.jig),2);Pa.Z(n.a.yb(l.a.Epb),5);return Pa}static kh(){return new pb}static get instance(){return pb.Mg.value}}
pb.Mg=new a.a(pb.kh);Object(F.a)(pb,"TableRowNodeComplexMerge",k.a,[]);class dc extends k.a{constructor(){super()}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.UIo),2);Pa.Z(n.a.yb(y.a.ef),1);return Pa}dC(Pa,bb){if(bb===n.a.yb(y.a.ef)){const rb=Pa.Xk,La=Pa.Ud;u.a.instance.Ta(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",rb.id,rb.Rc,bb);var lc=La.getPropertyObjectIds(Pa.Kg.value.lu,y.a.ef);const sb=La.getPropertyObjectIds(Pa.Kg.value.wf,
y.a.ef),Sb=La.getPropertyObjectIds(Pa.un.value.wf,y.a.ef);if(lc=this.Odn(lc,sb,Sb))return 0<lc.length?La.setPropertyObjectIds(rb,y.a.ef,lc):rb.removeProperty(y.a.ef),Pa.og.add(n.a.yb(y.a.ef)),!0}u.a.instance.Ta(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Pa.Kg.value.wf.id,bb);return!1}Odn(Pa,bb,lc){const rb=new H.a(0);Pa.forEach(sb=>{rb.Z(sb,0);return!0});bb.forEach(sb=>{rb.mb(sb)?rb.Z(sb,1):rb.Z(sb,3);return!0});
lc.forEach(sb=>{let Sb;({value:Sb}=rb.Dc(sb)).returnValue?1===Sb?rb.Z(sb,5):3===Sb?(u.a.instance.Ta(42754253,1,2,"TaskNode was found added by both sides of merge"),rb.Z(sb,3)):rb.Z(sb,2):rb.Z(sb,4);return!0});const La=new I.a;rb.forEach((sb,Sb)=>{0!==Sb&&2!==Sb&&1!==Sb&&La.add(sb);return!0});return La}static kh(){return new dc}static get instance(){return dc.Mg.value}}dc.Mg=new a.a(dc.kh);Object(F.a)(dc,"TaskContentNodeComplexMerge",k.a,[]);class Ob{equals(Pa,bb){return Pa&&bb?Pa.UserId===bb.UserId&&
Pa.Provider===bb.Provider&&Pa.DisplayName===bb.DisplayName&&Pa.Email===bb.Email:!Pa&&!bb}tM(){return 0}}Object(F.a)(Ob,"CommentTaskPersonComparer",null,[139]);class Vb{equals(Pa,bb){return Pa&&bb?Pa.startDate?Pa.endDate?Pa.startDate.getTime()===bb.startDate.getTime()&&Pa.endDate.getTime()===bb.endDate.getTime():!bb.endDate:!bb.startDate:!Pa&&!bb}tM(){return 0}}Object(F.a)(Vb,"CommentTaskScheduleEqualityComparer",null,[139]);class ob{equals(Pa,bb){if(!Pa||!bb)return!Pa&&!bb;if(!Pa.extensions&&!bb.extensions)return!0;
if(!Pa.extensions||!bb.extensions||Pa.extensions.count!==bb.extensions.count)return!1;let lc=!0;Pa.extensions.forEach((rb,La)=>{let sb;return({value:sb}=bb.extensions.Dc(rb)).returnValue&&La===sb?!0:lc=!1});return lc}tM(){return 0}}Object(F.a)(ob,"ExtensionListEqualityComparer",null,[139]);class Xb{Lxl(Pa,bb){return Pa&&bb?Pa.recordId===bb.recordId&&Xb.KPg.equals(Pa.user,bb.user)&&Xb.KPg.equals(Pa.assignee,bb.assignee)&&Pa.type===bb.type&&Pa.title===bb.title&&Pa.priority===bb.priority&&Pa.isLossy===
bb.isLossy&&Pa.completion===bb.completion&&Pa.commentId===bb.commentId&&Pa.time===bb.time&&Xb.o_j.equals(Pa.schedule,bb.schedule):!Pa&&!bb}equals(Pa,bb){return this.Lxl(Pa,bb)}tM(){return 0}}Xb.KPg=new Ob;Xb.o_j=new Vb;new ob;Object(F.a)(Xb,"HistoryRecordEqualityComparer",null,[139]);var Xa=c(2079),Pb=c(1554);class rc extends k.a{constructor(Pa){super();this.xMa=Pa}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.bQb),5);Pa.Z(n.a.yb(l.a.taskId),2);Pa.Z(n.a.yb(l.a.HIo),2);Pa.Z(n.a.yb(l.a.LIo),2);Pa.Z(n.a.yb(l.a.Tya),
1);return Pa}klg(Pa){if(!Pa.un.value.lu&&!Pa.Kg.value.lu){const bb=Pa.Kg.value.wf.KK();bb.removeProperty(l.a.Tya);const lc=Pa.Kg.value.wf,rb=Pa.un.value.wf;Pa.Kg=new a.a(()=>new Pb.a(bb,lc));Pa.un=new a.a(()=>new Pb.a(bb,rb))}return super.klg(Pa)}dC(Pa,bb){if(bb!==n.a.yb(l.a.Tya))return u.a.instance.Ta(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Pa.Kg.value.wf.id,bb),!1;const lc=Pa.Xk,rb=Pa.Ud;u.a.instance.Ta(42754255,
1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",lc.id,lc.Rc,bb);bb=rb.getPropertyString(Pa.Kg.value.lu,l.a.Tya);const La=rb.getPropertyString(Pa.Kg.value.wf,l.a.Tya),sb=rb.getPropertyString(Pa.un.value.wf,l.a.Tya);bb=this.Ndn(bb,La,sb);if(!bb)return!1;0<bb.length?rb.setPropertyString(lc,l.a.Tya,bb):lc.removeProperty(l.a.Tya);Pa.og.add(n.a.yb(l.a.Tya));return!0}Ndn(Pa,bb,lc){Pa=this.xMa.X4b(Pa);bb=this.xMa.X4b(bb);lc=this.xMa.X4b(lc);if(!rc.RAi(Pa,
bb))return u.a.instance.Ta(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),null;if(!rc.RAi(Pa,lc))return u.a.instance.Ta(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;lc=rc.D1k(Pa.length,bb,lc);return this.xMa.O$f(lc)}static kh(){const Pa=new Xa.a;return new rc(Pa)}static get instance(){return rc.Mg.value}static D1k(Pa,bb,lc){const rb=new I.a;for(let La=0;La<bb.length;La++)rb.add(bb.J(La));for(;Pa<lc.length;Pa++)rb.add(lc.J(Pa));
return rb}static RAi(Pa,bb){const lc=Pa.length;if(lc>bb.length)return!1;for(let rb=0;rb<lc;rb++)if(!rc.w6j.equals(bb.J(rb),Pa.J(rb)))return bb.J(rb).recordId===Pa.J(rb).recordId&&u.a.instance.Ta(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}rc.Mg=new a.a(rc.kh);rc.w6j=new Xb;Object(F.a)(rc,"TaskSingleNodeComplexMerge",k.a,[]);class Ta extends k.a{constructor(){super()}get Mn(){return 26}wk(){const Pa=super.wk();Pa.Z(n.a.yb(y.a.ef),
1);return Pa}dC(Pa,bb){const lc=y.a.ef;if(bb===n.a.yb(lc)){bb=Pa.Xk;const La=Pa.Ud;var rb=La.getPropertyObjectIds(Pa.Kg.value.lu,lc);const sb=La.getPropertyObjectIds(Pa.Kg.value.wf,lc),Sb=La.getPropertyObjectIds(Pa.un.value.wf,lc);rb=this.Udn(rb,sb,Sb);La.setPropertyObjectIds(bb,lc,rb);Pa.og.add(n.a.yb(lc));return!0}return!1}Udn(Pa,bb,lc){return this.cGa(Pa,bb,lc)}static kh(){return new Ta}static get instance(){return Ta.Mg.value}}Ta.Mg=new a.a(Ta.kh);Object(F.a)(Ta,"VectorClockContainerNodeComplexMerge",
k.a,[]);class Ab extends k.a{constructor(){super()}get Mn(){return 27}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.EP),1);return Pa}dC(Pa,bb){const lc=l.a.EP;if(bb===n.a.yb(lc)){bb=Pa.Xk;const rb=Pa.Ud,La=rb.getPropertyUint32(Pa.Kg.value.wf,lc)||0,sb=rb.getPropertyUint32(Pa.un.value.wf,lc)||0;rb.setPropertyUint32(bb,lc,this.I3l(La,sb));Pa.og.add(n.a.yb(lc));return!0}return!1}I3l(Pa,bb){return Pa>bb?Pa:bb}static kh(){return new Ab}static get instance(){return Ab.Mg.value}}Ab.Mg=new a.a(Ab.kh);Object(F.a)(Ab,
"VectorClockNodeComplexMerge",k.a,[]);class Db extends k.a{constructor(){super()}get Mn(){return 28}get qA(){return 0}wk(){const Pa=super.wk();Pa.Z(n.a.yb(l.a.ITh),3);Pa.Z(n.a.yb(l.a.Lc),3);Pa.Z(n.a.yb(l.a.KTh),5);Pa.Z(n.a.yb(l.a.SOi),5);Pa.Z(n.a.yb(l.a.Oia),5);return Pa}static kh(){return new Db}static get instance(){return Db.Mg.value}}Db.Mg=new a.a(Db.kh);Object(F.a)(Db,"WordSectionNodeComplexMerge",k.a,[]);c.d(K,"a",function(){return ac});class ac{RLh(Pa,bb){switch(Pa.Rc){case 131073:return Pa.hasProperty(l.a.imageType)||
Pa.hasProperty(f.a.R_)?this.ep(ia.instance,bb):this.ep($a.instance,bb);case 1074135140:return this.ep(x.instance,bb);case 1074135137:return this.ep(w.instance,bb);case 1074135139:return this.ep(E.instance,bb);case 1074135138:return this.ep(G.instance,bb);case 1074135136:return this.ep(M.instance,bb);case 1074135157:return this.ep(J.instance,bb);case 1074135152:return this.ep(V.instance,bb);case 1074135153:return this.ep(X.instance,bb);case 1074135126:return this.ep(W.instance,bb);case 1074135127:return this.ep(ba.instance,
bb);case 1074135145:return this.ep(oa.instance,bb);case 1074135144:return this.ep(aa.instance,bb);case 1074135142:return this.ep(ja.instance,bb);case 1074135143:return this.ep(qa.instance,bb);case 1074135163:return this.ep(Ia.instance,bb);case 1074135164:return this.ep(Va.instance,bb);case 1074135124:return this.ep(Na.instance,bb);case 1074135125:return this.ep(za.instance,bb);case 1074135122:return this.ep(va.instance,bb);case 393233:return this.ep(ia.instance,bb);case 1073872970:return this.ep(ia.instance,
bb);case 1074135170:return this.ep(pa.instance,bb);case 1074135168:return this.ep(sa.instance,bb);case 1074135166:return this.ep(Ha.instance,bb);case 1074135167:return this.ep(ra.instance,bb);case 1074135169:return this.ep(Ma.instance,bb);case 1074135165:return this.ep(ya.instance,bb);case 393234:return this.ep(hb.instance,bb);case 393229:return this.ep(jb.instance,bb);case 393241:return this.ep(ub.instance,bb);case 393227:return this.ep(Wa.instance,bb);case 131120:return this.ep(Mb.instance,bb);
case 393271:return this.ep(Bb.instance,bb);case 393230:return this.ep(Fb.a.instance,bb);case 131140:return this.ep(kb.instance,bb);case 1179649:return this.ep(Sa.instance,bb);case 1073872969:return this.ep(xb.instance,bb);case 393252:return this.ep($b.instance,bb);case 393250:return this.ep(hc.instance,bb);case 393251:return this.ep(pb.instance,bb);case 1074135154:return this.ep(Ta.instance,bb);case 1074135161:return this.ep(dc.instance,bb);case 1074135162:return this.ep(rc.instance,bb);case 1074135155:return this.ep(Ab.instance,
bb);case 1073872968:return this.ep(Db.instance,bb);case 1074135172:return this.ep(wa.instance,bb);case 1074135171:return this.ep(Ga.instance,bb);case 1074135149:return this.ep(la.instance,bb);case 1074135151:return this.ep(Ua.instance,bb)}return this.ep(k.a.instance,bb)}ep(Pa,bb){Pa.Xb=bb?bb():null;return Pa}}Object(F.a)(ac,"GraphNodeComplexMergeFactory",null,[1991])},1967:function(F,K,c){c.r(K);F=c(0);var l=c(1530),f=c(74),a=c(343),k=c(67),x=c(1508);class y{constructor(I,N,Q,M=0){this.tli=I;this.groupType=
N;this.Bwf=M;this.L5c=Q}}Object(F.a)(y,"SortingGroup",null,[]);class n{constructor(I,N,Q,M){this.order=I;this.x8=N;this.gmm=Q;this.groupType=M}}Object(F.a)(n,"SortingProp",null,[]);var u=c(1500),z=c(1502),w=c(1499),E=c(25);class G{constructor(I,N){this.HMi={};this.GMi={};this.CMi=this.OMi=1;this.Zyh(I,N)}WAo(I,N,Q){var M=w.a.dR(Q)?this.HMi:this.GMi;Q=new f.a;for(var J of N)N=Object(k.a)(n,M[l.a[J.groupType].toLowerCase()]),E.c(N)||Q.add(new a.a(N,J));Q.Sc((X,W)=>X.key.order<W.key.order?-1:1);Array.clear(I);
J=u.TellMeActor.instance.PZ;for(N=0;N<Q.count;){M=Q.J(N).key.x8;var V=Q.J(N).value;const X=new x.a(Q.J(N).key.groupType);E.c(J)||J.Location===z.a.contextMenu||(X.displayName=Q.J(N).key.gmm);for(const W of V.results)X.Ow(W);for(V=++N;V<Q.count&&Q.J(V).key.x8===M;)this.ZZe(X,Q.J(V).value),V=++N;I.push(X)}}ZZo(I,N){this.CMi=this.OMi=1;this.Zyh(I,N)}Zyh(I,N){this.uuj(I);for(var Q=0;Q<I.length;Q++){let M=I[Q];for(const J of M.L5c)this.ttk(J,Q,M.tli,M.groupType)}this.uuj(N);for(I=0;I<N.length;I++){Q=N[I];
for(const M of Q.L5c)this.stk(M,I,Q.tli,Q.groupType)}}uuj(I){I.sort((N,Q)=>Object(k.a)(y,N).Bwf>Object(k.a)(y,Q).Bwf?-1:1)}ttk(I,N,Q,M){this.HMi[l.a[I].toLowerCase()]=new n(this.OMi++,N,Q,M)}stk(I,N,Q,M){this.GMi[l.a[I].toLowerCase()]=new n(this.CMi++,N,Q,M)}ZZe(I,N){for(let Q=0;Q<N.results.length;Q++)I.Ow(N.results[Q])}}Object(F.a)(G,"BaseGroupingSorter",null,[]);class H{constructor(){this.U3d=[new y("",26,[26]),new y("",24,[24]),new y(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,
7,[18,16,7]),new y(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new y("",13,[13]),new y("",22,[22])];this.P3d=[new y("",25,[25]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,31,[17,0,1,8,28]),new y(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new y(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new y("",13,[13]),new y("",22,[22])];this.nMi=new G(this.U3d,this.P3d)}k9c(I,N,Q,M=null,J=null){let V=!1;if(M){for(const X of w.a.dR(Q)?
this.U3d:this.P3d)this.YPn(X,M);V=!0}if(J){for(const X of w.a.dR(Q)?this.U3d:this.P3d)this.$Zo(N,X,J);V=!0}V&&this.nMi.ZZo(this.U3d,this.P3d);this.nMi.WAo(I,N,Q)}YPn(I,N){const Q=new f.a;for(var M of I.L5c){const J=N[l.a[M].toLowerCase()];Q.add(new a.a(E.c(J)?Number.MAX_VALUE:J,M))}if(Q.count){Q.Sc((J,V)=>J.key<V.key?-1:1);N=Array(Q.count);for(M=0;M<Q.count;M++)N[M]=Q.J(M).value;I.L5c=N}}$Zo(I,N,Q){let M=0;for(const J of N.L5c)if(l.a[J].toLowerCase()in Q&&Q[l.a[J].toLowerCase()])for(const V of I)if(V.groupType===
J){M+=Q[l.a[J].toLowerCase()];break}N.Bwf=M}}Object(F.a)(H,"SimplifiedGroupingSorter",null,[]);c.d(K,"GroupsPlacementInfo",function(){return L});class L{constructor(I){this.FMi={};this.DMi={};this.EMi={};this.IMi={};this.cMf={};this.JMi=this.m$m=this.h$m=this.j$m=1;this.LMi=null;this.hx=I;this.DPk();this.sFn();this.pPk();this.tOk();I.rP&&(this.LMi=new H)}GE(I){this.FMi[l.a[I].toLowerCase()]=this.j$m++}tH(I,N){this.DMi[l.a[I].toLowerCase()]=N}MMa(I){this.EMi[l.a[I].toLowerCase()]=this.h$m++}d3(I){this.IMi[l.a[I].toLowerCase()]=
this.m$m++}zD(I){this.cMf[l.a[I].toLowerCase()]=this.JMi++}DPk(){const I=!!this.hx&&this.hx.w3a,N=!!this.hx&&this.hx.A0c,Q=!!this.hx&&this.hx.wkb,M=!!this.hx&&this.hx.YGf&&!w.a.Ybc(),J=!!this.hx&&this.hx.vWc,V=!!this.hx&&this.hx.RXd,X=!!this.hx&&this.hx.bFf,W=!!this.hx&&this.hx.KBf;this.hx&&(this.hx.mga||this.hx.oKd)&&this.GE(26);W&&this.GE(24);this.GE(4);this.GE(18);this.GE(16);this.GE(7);this.GE(17);this.GE(0);this.GE(1);X&&this.GE(28);J&&this.GE(23);I||this.GE(2);I&&!N||this.GE(8);this.GE(15);
Q&&this.GE(20);this.GE(14);this.GE(9);this.GE(12);this.GE(10);this.GE(11);I&&this.GE(2);I&&!N&&this.GE(8);this.GE(19);V&&this.GE(27);this.GE(21);this.GE(13);M&&this.GE(22);this.GE(30)}sFn(){this.tH(21,1);this.tH(4,3);this.tH(18,3);this.tH(16,3);this.tH(7,3);this.tH(17,5);this.tH(0,5);this.tH(1,1);this.tH(28,2);this.tH(2,1);this.tH(8,2);this.tH(15,3);this.tH(14,2);this.tH(27,3);this.tH(9,1);this.tH(12,1);this.tH(10,1);this.tH(11,1);this.tH(19,1);this.tH(23,1);this.tH(13,1);this.tH(24,1);this.tH(25,
1);this.tH(20,2);this.tH(22,1);this.tH(26,1)}pPk(){this.MMa(4);this.MMa(0);this.MMa(17);this.MMa(7);this.MMa(16);this.MMa(18);this.MMa(15);this.MMa(20);this.MMa(8);this.MMa(14)}tOk(){this.d3(14);this.d3(10);this.d3(12);this.d3(9);this.d3(11);this.d3(20);this.d3(15);this.d3(8);this.d3(2);this.d3(1);this.d3(27);this.d3(7);this.d3(18);this.d3(16);this.d3(17);this.d3(0);this.d3(4)}k7n(){this.cMf={};this.JMi=1}Kbm(I,N,Q){this.k7n();const M=!!this.hx&&this.hx.w3a,J=!!this.hx&&this.hx.A0c,V=!!this.hx&&this.hx.wkb,
X=!!this.hx&&this.hx.YGf&&!w.a.Ybc(),W=!!this.hx&&this.hx.vWc,U=!!this.hx&&this.hx.RXd,Y=!!this.hx&&this.hx.bFf,ba=!!this.hx&&this.hx.Cie;I=I&&J;ba&&this.zD(25);this.zD(4);this.zD(18);this.zD(16);this.zD(7);this.zD(17);this.zD(0);this.zD(1);Y&&this.zD(28);W&&this.zD(23);M&&!J||!I||this.zD(8);N&&this.zD(15);M||this.zD(2);U&&this.zD(27);Q&&this.zD(14);M&&!J||I||this.zD(8);N||this.zD(15);V&&this.zD(20);Q||this.zD(14);this.zD(9);this.zD(12);this.zD(10);this.zD(11);M&&this.zD(2);M&&!J&&this.zD(8);this.zD(19);
this.zD(21);this.zD(13);X&&this.zD(22);return this.cMf}BO(){return this.hx}}Object(F.a)(L,"GroupsPlacementInfo",null,[])},1969:function(F,K,c){F=c(0);var l=c(1783),f=c(58);class a{constructor(){this.source=0;this.nm=this.JUa=this.h$=null;this.Sha=0;this.xGb=!1;this.mode=this.CTa=0;this.TLc=null;this.OJb=f.a.create()}}Object(F.a)(a,"InputState",null,[]);class k{constructor(){this.timeout=this.succeeded=this.crash=!1;this.LM=null}}Object(F.a)(k,"OutputState",null,[]);class x{constructor(){this.Hri=
this.Hie=this.x8c=!1;this.Xb=this.E4d=this.$Xf=this.Oce=this.dig=this.$Ab=this.pNa=this.SG=this.Qlb=this.skc=this.jSo=this.ZAl=this.en=this.Ndf=this.Jq=this.Eu=this.uk=this.Ene=this.PLd=this.YCa=null}}Object(F.a)(x,"RuntimeState",null,[]);c.d(K,"a",function(){return y});class y{constructor(){this.input=new a;this.runtime=new x;this.output=new k;this.logger=new l.a(this)}}Object(F.a)(y,"MergeState",null,[])},1970:function(F,K,c){c.r(K);F=c(0);var l=c(598),f=c(221),a=c(165),k=c(111),x=c(1636),y=c(1729),
n=c(1763),u=c(6),z=c(1960);class w{constructor(Q,M){this.start=Q;this.end=M}}Object(F.a)(w,"MergeDiffIdx",null,[]);class E{constructor(Q,M,J,V=!1,X=null,W=null,U=!0){this.Nhd=this.Mhd=this.ESg=this.wxc=0;this.K_b=this.iue=null;this.fab=X||new z.a;this.Ng=J;this.yra=Q.n5();this.xok=M.n5();this.KP=new w(0,0);this.aT=new w(0,0);this.bEe=V;this.Huc=U;this.bsa=W;this.ARk();this.Mlo()}get GK(){return this.yra}get aK(){return this.xok}get Bz(){return this.wxc}get rA(){return this.ESg}get Xua(){return this.Mhd}get Rma(){return this.Nhd}get Ynl(){const Q=
new f.a;for(let M=this.iue.start;M<this.iue.end;M++)Q.add(this.GK.$f(M));return Q}get hff(){const Q=new f.a;for(let M=this.K_b.start;M<this.K_b.end;M++)Q.add(this.aK.$f(M));return Q}sgf(Q){if(this.rA<Q.rA){if(this.rA+this.Xua>Q.rA)return!0}else if(this.rA>Q.rA){if(Q.rA+Q.Xua>this.rA)return!0}else if(2===this.Bz&&3===Q.Bz||3===this.Bz&&2===Q.Bz||2===this.Bz&&2===Q.Bz||3===this.Bz&&3===Q.Bz)return!0;return!1}Ocj(Q,M,J,V){Q.oG(M);Q.PC(M,J);return V+=J.length-1}Quj(Q,M,J,V,X){let W=this.GK.$f(Q),U=this.aK.$f(M);
if(!W||!U||!W.o7a&&!U.o7a)return{returnValue:!1,uCa:V,KIa:X};let Y=new f.a,ba=new f.a;W.o7a&&(Y=W.s9c(),W=Y.$f(J?0:Y.length-1));U.o7a&&(ba=U.s9c(),U=ba.$f(J?0:ba.length-1));if(!W.GA(U,this.fab,this.bsa,this.bEe,this.Huc))return{returnValue:!1,uCa:V,KIa:X};Y.length&&(V=this.Ocj(this.GK,Q,Y,V));ba.length&&(X=this.Ocj(this.aK,M,ba,X));return{returnValue:!0,uCa:V,KIa:X}}EDl(Q,M,J,V,X,W){for(;X<=J&&W<=V;){const U=Q.$f(X),Y=M.$f(W);if(!U.GA(Y,this.fab,this.bsa,this.bEe,this.Huc))break;this.KP.start+=U.length;
this.aT.start+=Y.length;X++;W++}return{y3e:X,tmg:W}}CDl(Q,M,J,V,X,W){for(;X>=J&&W>=V;){const U=Q.$f(X),Y=M.$f(W);if(!U.GA(Y,this.fab,this.bsa,this.bEe,this.Huc))return{returnValue:!0,uCa:X,KIa:W};X--;W--}return{returnValue:!1,uCa:X,KIa:W}}DDl(Q,M,J,V){let X=!1;do({y3e:Q,tmg:M}=this.EDl(this.GK,this.aK,J,V,Q,M)),{uCa:J,KIa:V,returnValue:X}=this.Quj(Q,M,!0,J,V);while(X);return{y3e:Q,tmg:M,uCa:J,KIa:V}}BDl(Q,M,J,V){let X=!1;do{if(!({uCa:J,KIa:V}=this.CDl(this.GK,this.aK,Q,M,J,V)).returnValue)break;({uCa:J,
KIa:V,returnValue:X}=this.Quj(J,V,!1,J,V))}while(X);return{uCa:J,KIa:V}}ARk(){var Q=0,M=0,J=this.GK.length-1,V=this.aK.length-1;0<=J&&this.GK.$f(J);0<=V&&this.aK.$f(V);({y3e:Q,tmg:M,uCa:J,KIa:V}=this.DDl(Q,M,J,V));if(Q<J||M<V)({uCa:J,KIa:V}=this.BDl(Q,M,J,V));J++;V++;this.iue=new w(Q,J);this.K_b=new w(M,V);this.KP.end=this.KP.start;this.aT.end=this.aT.start;for(var X=Q;X<J;X++){var W=this.GK.$f(X);this.KP.end+=W.length}for(X=M;X<V;X++)W=this.aK.$f(X),this.aT.end+=W.length;a.a.instance.Ta(3993809,
1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",Q,J,M,V);a.a.instance.Ta(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.KP.start,this.KP.end,this.aT.start,this.aT.end);this.KP.start<=this.KP.end&&this.aT.start<=this.aT.end&&(Q=this.GK.$f(Q),M=this.aK.$f(M),X=this.GK.$f(J),W=this.aK.$f(V),J=this.GK.$f(J-1),V=this.aK.$f(V-1),a.a.instance.Ta(3993811,
1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",Q,X,M,W,J,V))}Mlo(){this.ESg=this.KP.start;this.Mhd=this.Nhd=0;this.KP.start===this.KP.end&&this.aT.start===this.aT.end?this.wxc=0:this.KP.start===this.KP.end&&this.aT.start<this.aT.end?(this.wxc=1,this.Nhd=this.aT.end-this.aT.start):this.aT.start===this.aT.end&&this.KP.start<this.KP.end?(this.wxc=2,this.Mhd=this.KP.end-this.KP.start):(this.wxc=
3,this.Mhd=this.KP.end-this.KP.start,this.Nhd=this.aT.end-this.aT.start);a.a.instance.Ta(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.Bz,this.rA,this.Xua,this.Rma)}JOm(Q,M){return Q.t4()&&M.t4()?Q.runId===M.runId&&Q.Ag===M.Ag:!1}TTm(Q){if(!Q.t4()||"\ufffc"!==Q.text)return!1;Q=Q.JDb;return Q?Q.hasProperty(u.a.ak)||Q.hasProperty(u.a.WBd)||Q.hasProperty(u.a.Ugf)||Q.hasProperty(u.a.N3)||Q.hasProperty(u.a.imageType)||Q.hasProperty(u.a.EQa)||
Q.hasProperty(u.a.lIb)||Q.hasProperty(u.a.jt)&&(Q=this.Ng.getPropertyInt32(Q,u.a.jt))&&(36===Q||35===Q||24===Q||23===Q||33===Q||34===Q||44===Q||45===Q||42===Q||43===Q)?!0:!1:!1}aVc(Q){return Q.t4()&&!this.TTm(Q)}fTk(){if(2===this.Bz)return!1;var Q=this.K_b.start;if(!Q)return!1;let M=null;for(var J=this.K_b.start;J<this.K_b.end;J++){const V=this.aK.$f(J);if(this.aVc(V)){M=V;break}}if(!M)return!1;--Q;for(J=this.aK.$f(Q);J&&!this.aVc(J);)Q--,J=this.aK.$f(Q);return J&&this.JOm(J,M)?!0:!1}f$h(Q){const M=
new f.a;for(let J=0;J<Q.length;J++)Q.J(J).o7a?M.PC(M.length,Q.J(J).s9c()):M.insert(M.length,Q.J(J));return M}LOm(){if(3!==this.Bz||this.Xua!==this.Rma)return!1;const Q=this.f$h(this.Ynl),M=this.f$h(this.hff);if(Q.length!==M.length)return!1;for(let J=0;J<Q.length;J++)if(!Q.J(J).GA(M.J(J),this.fab,this.bsa,!0,this.Huc))return!1;return!0}KOm(){if(0!==this.Bz&&3!==this.Bz||this.GK.length!==this.aK.length)return!1;let Q=!1;for(let M=0;M<this.GK.length;M++){if(!this.GK.J(M).GA(this.aK.J(M),this.fab,this.bsa,
!0,this.Huc))return!1;if(3===this.GK.J(M).type||1===this.GK.J(M).type){const J=this.GK.J(M),V=this.aK.J(M);Q=J.runId!==V.runId||J.Ag!==V.Ag||Q}}return Q}}Object(F.a)(E,"MergeBlockDiff",null,[]);var G=c(1589);class H{constructor(Q,M){this.id=Q;this.index=M}}Object(F.a)(H,"ParagraphStartIndex",null,[]);var L=c(1649),I=c(1570);c.d(K,"ParagraphMerge",function(){return N});class N{constructor(Q,M,J,V,X,W,U){this.JYb=this.twb=this.Uo=this.qx=null;this.Zh=!1;this.ckh=this.ZUg=this.MMg=this.wta=this.mKa=
this.yra=null;this.Zd=Q;this.GF=M;this.OBa=V;this.tAa=J;this.asa=X;this.bsa=W;this.Ng=U}Bfi(Q){const M=new l.a;Q.GK.forEach(J=>{2===J.type&&M.add(J.Mj);return!0});Q.aK.forEach(J=>{2===J.type&&M.remove(J.Mj);return!0});return M}$bi(Q){const M=new f.a;Q.aK.forEach(J=>{2===J.type&&M.add(J.Mj);return!0});return M}yHh(Q){const M=new f.a;let J=0,V=0;Q.aK.forEach(X=>{2===X.type&&(M.add(new H(X.Mj,J<Q.rA?J:J<Q.rA+Q.Rma?Q.rA:J-Q.Rma+Q.Xua)),J=V);V+=X.length;return!0});return M}c4k(Q,M){var J=this.yHh(Q);const V=
this.yHh(M);Q=this.Bfi(Q);const X=this.Bfi(M);M=new f.a;const W=new l.a;let U=0;for(let Y=0;Y<J.length;Y++){const ba=J.J(Y);if(U<V.length){let aa=V.J(U);for(;U<V.length&&aa.index<=ba.index;){if(aa.id.equals(ba.id)){U++;break}Q.contains(aa.id)||W.contains(aa.id)||(M.add(aa.id),W.add(aa.id));U++;aa=V.J(U)}}X.contains(ba.id)||(M.add(ba.id),W.add(ba.id))}for(;U<V.length;)J=V.J(U),Q.contains(J.id)||W.contains(J.id)||(M.add(J.id),W.add(J.id)),U++;return M}initialize(){if(this.Zh){const Q=!!this.qx&&!!this.Uo;
this.Zd.logger.Og(Object.assign(new G.a,{rj:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return Q}this.Zh=!0;if(!({GK:this.yra,SLc:this.mKa,Xad:this.wta,HBd:this.MMg,QLd:this.ZUg,Fne:this.ckh}=I.a.pMh(this.Zd,this.Ng,this.GF,this.tAa,this.OBa,this.asa,!1,!1)).returnValue)return!1;this.qx=new E(this.yra,this.mKa,this.Ng,void 0,void 0,this.bsa);this.Uo=new E(this.yra,this.wta,this.Ng,void 0,void 0,this.bsa);a.a.instance.Ta(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",
this.qx.Xua,this.qx.Rma,this.Uo.Xua,this.Uo.Rma));return!0}yIa(){a.a.instance.Ta(593826836,1,4,"Attempting to merge with LCS");let Q=!1;const M=new n.a(this.Ng,this.Zd);let J=null,V=null;var X=null;const W=Y=>this.Zd.runtime.uk.J(Y),U=Y=>this.Zd.runtime.Jq.J(Y)||this.Zd.runtime.uk.J(Y);this.qx=new E(this.yra,this.mKa,this.Ng,void 0,void 0,this.bsa,!1);this.Uo=new E(this.yra,this.wta,this.Ng,void 0,void 0,this.bsa,!1);({updateHints:J}=M.UNh(this.GF,W,this.tAa,Y=>this.Zd.runtime.Eu.J(Y)||this.Zd.runtime.uk.J(Y),
this.qx.rA,this.qx.rA+this.qx.Xua,this.qx.rA+this.qx.Rma)).returnValue&&({updateHints:V}=M.UNh(this.GF,W,this.OBa,U,this.Uo.rA,this.Uo.rA+this.Uo.Xua,this.Uo.rA+this.Uo.Rma)).returnValue&&(Q=!0);Q||(a.a.instance.Ta(593826835,1,2,"Failed to create update hints with LCS"),Q=!1);Q&&(X=new L.a(this.Zd,this.GF,this.tAa,this.OBa,Y=>this.Zd.runtime.Xb?this.Zd.runtime.Xb.isFeatureEnabled(Y):!1,this.Ng,null,J,V),({en:X}=X.pmc()).returnValue||(a.a.instance.Ta(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),
this.Zd.logger.Og(Object.assign(new G.a,{rj:"TryLCSMerge",eventId:"9zrqs"})),Q=!1));a.a.instance.Ta(593826833,1,Q?4:2,"TryLCSMerge: [Success: {0}]",Q);return{returnValue:Q,en:X}}pmc(){let Q;Q=null;if(!this.initialize())return this.Zd.logger.AU("ParagraphMerge Initialize"),this.Y3a(),{returnValue:!1,en:Q};this.Zd.logger.AU("ParagraphMerge Initialize");let M;this.Zd.logger.uhe(2);let J=({yIa:M}=this.Kql()).returnValue;J=J&&({en:Q,yIa:M}=this.ZOc(this.Zd,this.Ng,this.asa,this.JYb,this.twb)).returnValue;
this.Zd.logger.ubg();if(!J){this.Zd.logger.AU("ParagraphMerge DoMergeInteral");if(M){this.Zd.logger.uhe(3);({en:Q,returnValue:J}=this.yIa());this.Zd.logger.ubg();if(J)return{returnValue:!0,en:Q};this.Y3a();return{returnValue:!1,en:Q}}this.Y3a();return{returnValue:!1,en:Q}}if(!({en:Q,yIa:M}=this.ZOc(this.Zd,this.Ng,this.asa,this.JYb,this.twb)).returnValue)return this.Zd.logger.AU("ParagraphMerge DoMergeInteral"),this.Y3a(),{returnValue:!1,en:Q};this.Zd.logger.AU("ParagraphMerge DoMergeInteral");return{returnValue:!0,
en:Q}}ZOc(){let Q;if(!({j$d:Q}=I.a.ZOc(this.Zd,this.Ng,this.asa,this.JYb,this.twb)).returnValue)return this.Zd.logger.AU("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),this.Y3a(),{returnValue:!1,en:Q,yIa:!0};this.Zd.logger.AU("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,en:Q,yIa:!1}}Y3a(Q=!1){a.a.instance.vja(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+Q+"] BaseRevisionMergeBlocksList: {0}",this.MMg);a.a.instance.vja(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",
this.ZUg);a.a.instance.vja(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.ckh);Q=new f.a;I.a.udc(this.Ng,"BaseObjects_",this.GF,Q);I.a.udc(this.Ng,"FavoredObjects_",this.tAa,Q);I.a.udc(this.Ng,"ConflictObjects_",this.OBa,Q);I.a.F3m(this.Zd,Q)}uAh(Q){let M,J;J=M=0;if(0===this.qx.Bz)M=this.Uo.rA;else if(1===this.qx.Bz)M=this.Uo.rA<this.qx.rA?this.Uo.rA:this.Uo.rA===this.qx.rA?Q||1!==this.Uo.Bz?this.Uo.rA+this.qx.Rma:this.Uo.rA:this.Uo.rA+this.qx.Rma;else if(2===this.qx.Bz||3===this.qx.Bz)M=
this.Uo.rA<=this.qx.rA?this.Uo.rA:this.Uo.rA+(this.qx.Rma-this.qx.Xua);if(2===this.Uo.Bz||3===this.Uo.Bz)J=M+this.Uo.Xua;return{dli:M,zlm:J}}K_h(Q,M){let J;J=0;if(!M)return{returnValue:!0,k_c:J};let V=0,X=0;for(;V<Q.length;){let W;for(let U=V;U<Q.length;U++){V=U;W=Q.J(U);const Y=W.length;X+=Y;if(!(X<M)){if(X>M)if(W.o7a)Q.oG(V),Q.PC(V,W.s9c()),X-=Y;else return a.a.instance.Ta(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",
M),this.Zd.logger.Og(Object.assign(new G.a,{rj:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,k_c:J};break}}if(X===M)return V++,J=V,{returnValue:!0,k_c:J}}a.a.instance.Ta(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",M);this.Zd.logger.Og(Object.assign(new G.a,{rj:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,k_c:J}}CGk(Q,M,J){let V=0;var X=0,W=!1;const U=this.Uo.hff.n5();
if(this.Uo.fTk())for(--M;0<=M;M--){let Y=Q.J(M);if(this.Uo.aVc(Y)){X=Q.J(M);V=X.runId;X=X.Ag;W=!0;break}}W||((X=Q.J(J))&&this.Uo.aVc(X)?(V=X.runId,X=X.Ag):X=V=0);for(Q=0;Q<U.length;Q++)J=U.J(Q),J.t4()&&(W=J,this.Uo.aVc(J)?(W.runId=V,W.Ag=X):(W.runId=0,W.Ag=0));return U}gAi(Q){if(2===Q.length){const M=1===Q.J(0).type?Q.J(0):null;Q=2===Q.J(1).type;if(M&&Q&&""===M.text)return!0}return!1}Kql(){const Q=this.qx.KOm();if(!Q&&0===this.qx.Bz)return this.JYb=this.Uo.aK.n5(),this.twb=this.$bi(this.Uo),{returnValue:!0,
yIa:!1};if(0===this.Uo.Bz)return this.JYb=this.qx.aK.n5(),this.twb=this.$bi(this.qx),{returnValue:!0,yIa:!1};(this.gAi(this.qx.aK)||this.gAi(this.Uo.aK))&&this.Zd.logger.DJi(Object.assign(new G.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!Q){var M=this.qx.sgf(this.Uo);M&&this.asa(55)&&(a.a.instance.Ta(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.qx=new E(this.yra,this.mKa,this.Ng,!0,void 0,this.bsa),this.Uo=
new E(this.yra,this.wta,this.Ng,!0,void 0,this.bsa),M=this.qx.sgf(this.Uo));if(M)return a.a.instance.Ta(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),this.Zd.logger.Og(Object.assign(new y.a,{rj:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,yIa:!0}}var J;M=0;this.twb=this.c4k(this.qx,this.Uo);({dli:J,zlm:X}=this.uAh(!1));const V=this.qx.aK.n5();if(!({k_c:J}=this.K_h(V,J)).returnValue||(2===this.Uo.Bz||3===this.Uo.Bz)&&!({k_c:M}=
this.K_h(V,X)).returnValue)return{returnValue:!1,yIa:!1};if(2===this.Uo.Bz||3===this.Uo.Bz){this.Xic(V,M);this.Xic(V,J-1);var X=null;for(var W=M-1;W>=J;W--)2===V.J(W).type&&(X=V.J(W)),V.oG(W);0<V.length&&(W=V.J(V.length-1),2!==W.type&&4!==W.type&&X&&(this.Zd.runtime.Xb.Az(76),this.Zd.runtime.Xb.isFeatureEnabled(76)&&(V.add(X),this.twb.add(X.Mj))));a.a.instance.Ta(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",M-J-1,J)}if(1===this.Uo.Bz||3===this.Uo.Bz)X=this.Uo.hff,
Q&&(X=this.CGk(V,J,M)),this.Xic(V,J-1),this.Xic(V,J),this.Xic(X,0),this.Xic(X,X.length-1),V.PC(J,X),a.a.instance.Ta(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",J,Q,X.er());this.JYb=V;return{returnValue:!0,yIa:!1}}Xic(Q,M){0>M||M>=Q.length||(Q=Q.J(M),Object(k.a)(x.a,Q)&&(Q.vQa=!0))}gbd(Q,M){let J;J=M;if(!this.initialize())return{returnValue:!1,$5a:Q,eqa:J};if(this.Uo.sgf(this.qx))return this.Y3a(!0),this.Zd.logger.Og(Object.assign(new y.a,
{rj:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,$5a:Q,eqa:J};if(0===this.Uo.Bz||3===this.Uo.Bz&&this.Uo.LOm())return{returnValue:!0,$5a:Q,eqa:M};let V;({dli:V}=this.uAh(!0));M<V||M===V&&(1!==this.Uo.Bz||1===this.Uo.Bz&&1===this.qx.Bz&&M===this.qx.rA+this.qx.Rma)?J=M:(J=M+this.Uo.Rma-this.Uo.Xua,J<V&&(J=V));return{returnValue:!0,$5a:Q,eqa:J}}}Object(F.a)(N,"ParagraphMerge",null,[1988])},1971:function(F,K,c){c.r(K);F=c(0);var l=c(1656),f=c(1567),a=c(1530),k=c(1785),x=c(1566);class y{constructor(L=
"",I="",N="",Q=-99999,M=-1,J=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=L?L:"";this.Description=I?I:"";this.Type=N?N:"";this.Score=Q;this.Age=M;this.Count=J}}Object(F.a)(y,"Suggestion",null,[]);class n{constructor(L,I){this.GroupType=this.Suggestions=null;this.Suggestions=L;this.GroupType=I}}Object(F.a)(n,"SuggestionGroup",null,[]);class u{}u.help="help";u.answer="answer";u.commands="commands";u.wgo="servicecommands";u.template="template";Object(F.a)(u,
"SuggestionGroupType",null,[]);var z=c(1500),w=c(1499),E=c(2),G=c(35);c.d(K,"InteractionLogger",function(){return H});class H{constructor(L,I,N){this.Hze=0;this.WUe=this.Awc=null;this.ye=L;this.$Se=this.Vwe=this.AEe=!1;this.q0j=I;this.Xf=E.AFrameworkApplication.Ne;this.ic=N;this.dhd=this.HNe=0}get Xpa(){return this.ye.Xpa}Fhe(L){this.ye.Fhe(L)}$Ki(){if(this.Awc){var L=0;for(const I of this.Awc)this.ye.y7m(I,L++);this.Awc=null}}beginQuery(L,I,N){this.ye.n7m(L,I,N)}omb(L,I){this.ye.FKk(L,I);this.AEe=
!0;this.$Se=!1}wxa(){this.AEe=!1;this.Vwe||(this.$Ki(),this.ye.pWh(this.Hze))}o7m(L,I){this.ye.p7m(L,I)}hnn(L,I,N,Q,M){for(const J of this.q0j)if(L.startsWith(J)){this.$Se=!0;break}this.ye.O2m(L,I,N,Q,M)}Onn(L){this.Vwe=!1;this.Hze=L;this.AEe||this.$Se||(this.$Ki(),this.ye.pWh(this.Hze,!1))}Nnn(L,I){this.ye.U2m(L,I);this.Vwe=!0}Rmf(L,I){if(!L.count)return"";let N="";const Q=Date.now();for(let M of L)L=(Q-M.timeStamp)/1E3,L=w.a.Ume(L),0<N.length&&(N+=";"),N+=I?M.commandId:M.controlId,N+=":",N+=L.toString();
return N}N4a(){var L=this.Rmf(l.a.instance.QNc(),!1);0<L.length&&this.ye.M2m(L);L=this.Rmf(l.a.instance.jhb(),!0);0<L.length&&this.ye.e2m(L);L=this.Rmf(l.a.instance.otc,!0);0<L.length&&this.ye.T3m(L);L=z.TellMeActor.instance.E7g;0<L.length&&this.ye.l7m(G.c(L))}T7m(L){this.ye.t2m(L)}y0(L,I,N,Q,M,J,V,X=null){this.ye.f5m(L,I,N,Q,M,J,V,X)}bLf(L,I,N,Q){this.ye.bLf(L,I,N,Q)}MA(L,I,N=null){this.ye.FG(L,I,N)}onError(L,I,N=null){this.ye.SFa(L,I,N)}Yko(L){this.Awc=L}Rem(L){const I=[];if(!L)return I;for(let N=
0;N<L.length;N++){const Q=a.a[L[N].groupType].toLowerCase(),M=[],J=L[N].results;if(J){for(let V=0;V<J.length;V++)"findindocument"===Q?Array.add(M,new y("","",Q,J[V].score,J[V].pAd,J[V].count)):Array.add(M,new y(J[V].label,J[V].description,Q,J[V].score,J[V].pAd,J[V].count));"answer"===Q||"definition"===Q||"wolframanswer"===Q||"entity"===Q?Array.add(I,new n(M,u.answer)):"classifier"===Q||"appsforoffice"===Q?Array.add(I,new n(M,u.commands)):"serviceclassifier"===Q?Array.add(I,new n(M,u.wgo)):"assistance"===
Q?Array.add(I,new n(M,u.help)):("document"===Q||"people"===Q||"findindocument"===Q||"notes"===Q||"image"===Q||"template"===Q)&&Array.add(I,new n(M,Q))}}return I}Huf(L,I){const N={};N.Query=I;N.SuggestionGroups=G.c(this.Rem(L));return G.c(N)}uii(L){const I={"Content-Type":"application/json",Accept:"application/json"};I["X-Office-Version"]=E.AFrameworkApplication.buildVersion;I["X-Office-Application"]=E.AFrameworkApplication.K.jb("Application");I["X-Office-Platform"]="WAC";I["X-TellMe-SqmUserId"]=E.AFrameworkApplication.K.jb("LoggableUserId")||
"";I["X-TellMe-SessionId"]=this.ye.Xpa.roa;I["X-TellMe-SuggestionTypes"]="Ranker";I["X-TellMe-Culture"]=E.AFrameworkApplication.uiCulture;I["X-TellMe-ProcessSessionId"]=E.AFrameworkApplication.userSessionId;I["X-TellMe-Flights"]=L;I["X-TellMe-PartialQueryIndex"]=this.HNe;return I}$Kb(L,I,N){this.y0(I.length,"RankerLogging",L.data.Qe.toString(),Math.round(window.performance.now()-N),x.a.Oyj,!0,f.a.IPa)}GKb(L,I,N){this.y0(I.length,"RankerLogging",L.data.Qe.toString(),Math.round(window.performance.now()-
N),x.a.Oyj,!1,f.a.IPa)}vii(){this.WUe||(this.WUe=new k.a(this.ic,null,6E3));return this.WUe.u$}eLf(L){const I=this.Huf(this.Awc,L),N=this.uii("RankerLogging"),Q=window.performance.now();this.Xf.xj(this.vii(),2,I,N,!1,0,M=>{this.$Kb(M,L,Q)},M=>{this.GKb(M,L,Q)},null,null,!1,4E3,6E3);this.HNe++}$6n(){this.HNe=0}Cag(L){this.dhd=L}}Object(F.a)(H,"InteractionLogger",null,[])},1973:function(F,K,c){c.r(K);F=c(0);var l=c(16),f=c(6),a=c(165),k=c(221),x=c(58),y=c(1721),n=c(1635),u=c(1587),z=c(1570);class w{constructor(L,
I,N=null){this.author=L;this.xZc=I;this.T_f=N||x.a.nil}GA(L){return L?this.author===L.author&&this.xZc===L.xZc&&this.T_f===L.T_f:!1}}Object(F.a)(w,"RunMergeBlockTrackedChangeAttribute",null,[]);class E{constructor(L,I,N){this.insertion=L||E.Fhf;this.deletion=I||E.Fhf;this.OGa=N||E.Fhf}get nrm(){return 0<this.insertion.author.length}get Rqm(){return 0<this.deletion.author.length}get Rrm(){return 0<this.OGa.author.length}GA(L){return L?this.insertion.GA(L.insertion)&&this.deletion.GA(L.deletion)&&this.OGa.GA(L.OGa):
!1}}E.Fhf=new w("",0);Object(F.a)(E,"RunMergeBlockTrackedChangeInfo",null,[]);var G=c(1782);c.d(K,"ParagraphMergeBlockCreator",function(){return H});class H extends n.a{constructor(L,I,N,Q,M,J,V){super();this.maxValue=Number.MAX_VALUE;this.gB=new y.a;this.mTb=null;this.QN=0;this.U0g=!1;this.vxc="";this.ate=L;this.Ls=I;this.vu=N;this.Ykk=Q;this.Jjd=M;this.d0g=J;this.Ng=V;if(this.Ng.hasProperty(this.Ls,l.a.lo))if(this.Ng.hasProperty(this.Ls,f.a.Lc))if(this.Ng.hasProperty(this.Ls,f.a.nq))if(this.Ng.hasProperty(this.Ls,
f.a.ft))if(this.Ng.hasProperty(this.Ls,l.a.Gn))if(this.F2=this.Ng.getPropertyString(this.Ls,l.a.lo),this.aYe=this.Ng.getPropertyUint32(this.Ls,f.a.Lc),this.ks=this.Ng.getPropertyUint32s(this.Ls,f.a.nq),this.Zqd=this.Ng.getPropertyUint32s(this.Ls,f.a.ft),this.KBe=this.Ng.getPropertyObjectIds(this.Ls,l.a.Gn),this.F2||""===this.F2)if(this.F2.length||1!==this.KBe.length||(this.ks.length||(this.ks.add(0),a.a.instance.Ta(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),
this.Zqd.length||(this.Zqd.add(0),a.a.instance.Ta(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),this.uck=this.jOd(this.Ls,f.a.gRf,this.ks.length),this.ezc=this.jOd(this.Ls,l.a.oxa,this.ks.length),this.rla=this.jOd(this.Ls,l.a.lpb,this.ks.length),this.Eka=this.jOd(this.Ls,f.a.qPa,this.ks.length),this.ala=this.him(this.Ls,f.a.QGa,this.ks.length),this.Pym(),L=this.Ng.hasProperty(this.Ls,l.a.zm)?this.Ng.getPropertyUint32s(this.Ls,l.a.zm):new k.a,this.Ntd=
z.a.qnj(L,this.F2.length),this.ks.length!==this.Zqd.length)a.a.instance.Ta(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",I.id);else if(this.ks.length!==this.KBe.length)a.a.instance.Ta(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",I.id);else{this.d0g&&(this.Ng.hasProperty(this.Ls,f.a.Fv)?this.mTb=this.Ng.getPropertyObjectIds(this.Ls,f.a.Fv):(a.a.instance.Ta(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",
I.id),this.mTb=this.m_(this.ks.length,x.a.nil)),this.ks.length!==this.mTb.length&&(a.a.instance.Ta(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",I.id,this.ks.length,this.mTb.length),this.mTb=this.m_(this.ks.length,x.a.nil)));if(this.ks.length!==this.ezc.length||this.ks.length!==this.rla.length||this.ks.length!==this.Eka.length||this.ks.length!==this.ala.length)this.ks.length===this.ezc.length||this.Jjd||a.a.instance.Ta(8266445,
1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",I.id,this.ks.length,this.ezc.length),this.ks.length===this.rla.length||this.Jjd||a.a.instance.Ta(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",I.id,this.ks.length,this.rla.length),this.ks.length===this.Eka.length||this.Jjd||a.a.instance.Ta(20742792,
1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",I.id,this.ks.length,this.Eka.length),this.ks.length===this.ala.length||this.Jjd||a.a.instance.Ta(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",I.id,this.ks.length,this.ala.length),L=this.Ng.getPropertyBool(this.Ls,l.a.Z9e),a.a.instance.Ta(17877020,
1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",I.id,M,null==L?!1:L),this.ezc=this.m_(this.ks.length,!0),this.rla=this.m_(this.ks.length,!1),this.Eka=this.m_(this.ks.length,!1),this.ala=this.m_(this.ks.length,0),this.Ng.setPropertyBool(this.Ls,l.a.Z9e,!1);this.gB.T2o(this.ks.length)?(this.Ntd.length!==this.ks.length+1&&a.a.instance.Ta(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",
I.id,this.ks.length,this.Ntd.length),this.v$j=!0):a.a.instance.Ta(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",I.id)}else a.a.instance.Ta(4322133,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",I.id);else a.a.instance.Ta(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",I.id);else a.a.instance.Ta(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",I.id);else a.a.instance.Ta(3993796,
1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",I.id);else a.a.instance.Ta(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",I.id);else a.a.instance.Ta(3993794,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",I.id)}Pym(){this.Ng.hasProperty(this.Ls,f.a.fFa)?this.gB.pjb=this.Ng.getPropertyBools(this.Ls,f.a.fFa):this.gB.pjb=this.m_(this.ks.length,!1);this.Ng.hasProperty(this.Ls,f.a.gga)?this.gB.Mfb=this.Ng.getPropertyBools(this.Ls,f.a.gga):
this.gB.Mfb=this.m_(this.ks.length,!1);this.Ng.hasProperty(this.Ls,f.a.gFa)?this.gB.ojb=this.Ng.getPropertyStrings(this.Ls,f.a.gFa):this.gB.ojb=this.m_(this.ks.length,"");this.Ng.hasProperty(this.Ls,f.a.BDa)?this.gB.Lfb=this.Ng.getPropertyStrings(this.Ls,f.a.BDa):this.gB.Lfb=this.m_(this.ks.length,"");this.Ng.hasProperty(this.Ls,f.a.hFa)?this.gB.qjb=this.Ng.getPropertyListOfMilliseconds(this.Ls,f.a.hFa):this.gB.qjb=this.m_(this.ks.length,0);this.Ng.hasProperty(this.Ls,f.a.CDa)?this.gB.N_a=this.Ng.getPropertyListOfMilliseconds(this.Ls,
f.a.CDa):this.gB.N_a=this.m_(this.ks.length,0);this.Ng.hasProperty(this.Ls,f.a.PGa)?this.gB.n5a=this.Ng.getPropertyBools(this.Ls,f.a.PGa):this.gB.n5a=this.m_(this.ks.length,!1);this.Ng.hasProperty(this.Ls,f.a.uIa)?this.gB.knb=this.Ng.getPropertyStrings(this.Ls,f.a.uIa):this.gB.knb=this.m_(this.ks.length,"");this.Ng.hasProperty(this.Ls,f.a.vIa)?this.gB.mnb=this.Ng.getPropertyListOfMilliseconds(this.Ls,f.a.vIa):this.gB.mnb=this.m_(this.ks.length,0);this.Ng.hasProperty(this.Ls,f.a.aza)?this.gB.lnb=this.Ng.getPropertyObjectIds(this.Ls,
f.a.aza):this.gB.lnb=this.m_(this.ks.length,x.a.nil)}jOd(L,I,N){return this.Ng.hasProperty(L,I)?this.Ng.getPropertyBools(L,I):this.m_(N,!1)}him(L,I,N){return this.Ng.hasProperty(L,I)?this.Ng.getPropertyUint32s(L,I):this.m_(N,0)}m_(L,I){const N=new k.a;for(let Q=0;Q<L;Q++)N.add(I);return N}zgm(L){const I=this.Ntd.$f(L);L=this.Ntd.$f(L+1);return this.F2.substring(I,L)}oci(){if(this.U0g)return null;var L=this.QN<this.ks.length?this.ks.$f(this.QN):this.maxValue;if(L===this.maxValue||this.Ykk&&!this.F2.length)return this.U0g=
!0,L=new u.a(this.vu,this.Ls.id,this.aYe),this.vxc=this.A1e(this.vxc,L.toString()),L;const I=this.Zqd.$f(this.QN),N=this.KBe.$f(this.QN),Q=this.uck.$f(this.QN),M=this.ezc.$f(this.QN),J=this.rla.$f(this.QN),V=this.Eka.$f(this.QN),X=this.ala.$f(this.QN),W=this.d0g?this.mTb.$f(this.QN):null;var U=null;this.gB.pjb.$f(this.QN)&&(U=new w(this.gB.ojb.$f(this.QN)||"",this.gB.qjb.$f(this.QN)));var Y=null;this.gB.Mfb.$f(this.QN)&&(Y=new w(this.gB.Lfb.$f(this.QN)||"",this.gB.N_a.$f(this.QN)));var ba=null;this.gB.n5a.$f(this.QN)&&
(ba=new w(this.gB.knb.$f(this.QN)||"",this.gB.mnb.$f(this.QN),this.gB.lnb.$f(this.QN)));U=new E(U,Y,ba);Y=this.zgm(this.QN);this.QN++;ba=Y.startsWith("\ufddfHYPERLINK ");L=new G.a(this.ate,this.vu,this.Ls.id,I,L,N,Y,Q,!ba,M,J,V,X,U,W);this.vxc=this.A1e(this.vxc,L.toString());return L}Ybi(){let L;L=null;var I="";if(!this.v$j)return{gNf:L,n4a:I};if(I=this.oci())L=new k.a,L.add(I);for(;I=this.oci();)L.add(I);I=this.vxc;return{gNf:L,n4a:I}}}Object(F.a)(H,"ParagraphMergeBlockCreator",n.a,[])},1976:function(F,
K,c){c.r(K);F=c(0);var l=c(221),f=c(1635),a=c(1586);class k extends a.a{constructor(y,n){super(4,y,n)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Mj)}u7b(){return"Table"}clone(){return new k(this.source,this.Mj)}GA(y,n,u,z=!1){return super.GA(y,n,u,z)?this.Mj.equals(y.Mj):!1}get length(){return 1}}Object(F.a)(k,"TableMergeBlock",a.a,[]);c.d(K,"TableMergeBlockCreator",function(){return x});class x extends f.a{constructor(y,n){super();this.WMg=new k(n,y.id)}Ybi(){let y;
y=new l.a;y.add(this.WMg);return{gNf:y,n4a:this.A1e("",this.WMg.toString())}}}Object(F.a)(x,"TableMergeBlockCreator",f.a,[])},2062:function(F,K,c){c.r(K);var l=c(2),f=c(0),a=c(55),k=c(174);class x extends k.a{constructor(T){super(!1,!1,!0);this.nSb=T}start(){var T={["tooltipPersistenceEnabled"]:this.nSb.Gyf};l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(T.textSelectionChangeEnabled=this.nSb.qjg);T={["id"]:"AccessibilitySettingsDialog",
["bodyControls"]:T};this.Wh("",Object(a.a)(this,this.b8f,"resultHandler"),T)}b8f(T,Aa){1===T&&(this.nSb.Gyf=Aa.tooltipPersistenceEnabled,l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(this.nSb.qjg=Aa.textSelectionChangeEnabled))}}Object(f.a)(x,"AccessibilitySettingsDialog",k.a,[]);var y=c(68),n=c(13);class u{constructor(T,Aa){this.ga=T;this.nSb=Aa}Tb(){this.ga.qa(n.a.gwo,y.a.frame,Object(a.a)(this,this.hwo,"showAccessibilitySettingsDialogHandler"))}hwo(){(new x(this.nSb)).start();
return 32}}Object(f.a)(u,"AccessibilitySettingsDialogActor",null,[1908]);var z=c(457);const w=T=>{const Aa=new z.a;l.AFrameworkApplication.Ne.xj(E(T),1,null,null,!0,2,ib=>{200===ib.data.Qe?Aa.Bg("true"===ib.data.ve.toLowerCase()):Aa.Bg(!1)},()=>{Aa.Bg(!1)},null,void 0,void 0,void 0,void 0,"7");return Aa.task},E=T=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",l.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",T,l.AFrameworkApplication.im);var G=c(128);class H{constructor(){this.hVe=
this.MVb=null}get Gyf(){return!!this.MVb}set Gyf(T){T!==this.MVb&&(this.MVb=T,G.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(T),this.GBi()&&l.AFrameworkApplication.Ne.xj(E("saveHoverableRibbonTooltipIsEnabled"),2,T.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}get qjg(){return!!this.hVe}set qjg(T){T!==this.hVe&&(this.hVe=T)}b1m(){const T=new z.a;if(this.MVb)T.Bg(this.MVb);else if(this.GBi()){const Aa=w("getHoverableRibbonTooltipIsEnabled");
Aa.continueWith(()=>{this.MVb=Aa.result;G.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Aa.result);T.Bg(Aa.result)},8)}else T.Bg(!1)}GBi(){const T=l.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),Aa=l.AFrameworkApplication.K.$("IsAnonymousUser");return T&&!Aa}}Object(f.a)(H,"AccessibilitySettingsInfo",null,[1909]);var L=c(178),I=c(34);class N{constructor(){this.W=null}get name(){return"Common.App.AccessibilitySettings"}xc(T){this.W=T;this.W.register(H,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Rd(()=>
new H).singleInstance();this.W.register(u,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Rd(()=>new u(l.AFrameworkApplication.va,this.W.Na("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).singleInstance()}init(){const T=this.W.Na("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),Aa=this.W.Na("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");T&&Aa?(Aa.Tb(),
T.b1m()):I.b(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){L.a.instance.Fc(new N)}}Object(f.a)(N,"AccessibilitySettingsPackage",null,[1,2]);var Q=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",
attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},M=c(80);class J extends Sys.EventArgs{constructor(T,Aa){super();this.bme=T;this.actualValue=Aa}}Object(f.a)(J,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);class V{constructor(){this.KTb=[];this.IQg=this.jxe=0;this.ri=null;this.ra=new M.a}init(T,Aa,ib){this.ri=T;this.jxe=Aa;this.IQg=ib;this.ri.L_e(Object(a.a)(this,this.Q6d,"onCpuMeterFrameAvailable"));this.jyk(Object(a.a)(this,this.g9k,"cpuPercentThresholdExceeded"))}Q6d(T,
Aa){Aa.ZQi&&(Array.enqueue(this.KTb,Aa.ZQi.CP),this.KTb.length>this.IQg&&(Array.dequeue(this.KTb),this.aWk()))}aWk(){var T=this.KTb.length;let Aa=0;for(let ib=0;ib<T;ib++){const Tb=Array.dequeue(this.KTb);Aa+=Tb;Array.enqueue(this.KTb,Tb)}T=Aa/T;T>this.jxe&&this.ra.raiseEvent("CPTTE",new J(this.jxe,T))}g9k(T,Aa){I.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.SGd(Aa.bme,Aa.actualValue))}jyk(T){this.ra.addHandler("CPTTE",T)}SGd(T,Aa){const ib={};ib.ThresholdValue=T;ib.ActualValue=
Aa;return ib}}Object(f.a)(V,"CpuMeterMonitor",null,[1907]);class X{constructor(){this.S=this.T=this.M=this.C=0}}Object(f.a)(X,"ProfileInformation",null,[]);var W=c(11),U=c(38),Y=c(237),ba=c(82);class aa{constructor(T=0,Aa=0){this.pub=!1;this.Jtb={};this.Iod=T;this.Zod=Aa;this.DWe=0;U.a.addHandler(window.self,W.a.Qrh,()=>{this.pub=!0});U.a.addHandler(window.self,W.a.Rrh,()=>{this.pub=!1})}Trh(T,Aa,ib){const Tb=aa.generateKey(Aa,ib);Tb in this.Jtb?Aa=this.Jtb[Tb]:(Aa=new X,Aa.S=ib?1:0,this.Jtb[Tb]=
Aa,this.DWe++);Aa.C++;Aa.M=T>Aa.M?T:Aa.M;Aa.T+=T}iCa(T,Aa){this.Trh(T,Aa,!1);this.pub&&this.Trh(T,Aa,!0)}getData(){if(0<this.Zod&&this.DWe>this.Zod)return this.ITl();const T=0<this.Iod,Aa={},ib=this.Jtb;for(let xc in ib){var Tb=xc;const ld=ib[xc];this.ggj(ld);T&&ld.T>=this.Iod&&(Aa[Tb]=ld)}return T?ba.a.jf(Aa)?null:Aa:this.Jtb}ITl(){var T=0<this.Iod,Aa=[];const ib=this.Jtb;for(let Tb in ib){const xc={key:Tb,value:ib[Tb]};let ld=xc.value;(!T||ld.T>=this.Iod)&&Array.add(Aa,xc)}if(Aa.length>this.Zod)Aa.sort((Tb,
xc)=>xc.value.T-Tb.value.T),Aa=Aa.slice(0,this.Zod);else if(!Aa.length)return null;T={};for(const Tb of Aa)Aa=Tb.value,this.ggj(Aa),T[Tb.key]=Aa;return T}ggj(T){T.M=Y.a.VU(T.M,0);T.T=Y.a.VU(T.T,0)}reset(){this.Jtb={};this.DWe=0}static generateKey(T,Aa){return Aa?T+" [it]":T}}Object(f.a)(aa,"FunctionCallAggregator",null,[857]);var fa=c(1079);class na{}Object(f.a)(na,"CpuMeterFrame",null,[]);class oa extends Sys.EventArgs{constructor(T){super();this.ZQi=T}}Object(f.a)(oa,"CpuMeterFrameAvailableEventArgs",
Sys.EventArgs,[]);class ja{}Object(f.a)(ja,"MiniTaskItemInfo",null,[]);class qa{}Object(f.a)(qa,"TaskItemInfo",null,[]);var Ia=c(1041),Va=c(1405),Na=c(189);class za{constructor(T,Aa,ib,Tb,xc){this.Wxb=0;this.EZ=null;this.Qtd=this.nhh=0;this.teh=!1;this.aVb=0;this.Bvc=!1;this.Jsa=null;this.Rld=0;this.cMe=new M.a;this.nwd=[];this.Tz=T;this.WJe=Aa;this.QBe=ib;this.j6g=Tb;l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&this.Dcc();this.X2j=xc;this.RBe=new aa(100);
this.fbk=Ia.a.eF(1,5,new Va.a)}L_e(T){this.cMe.addHandler("OnCpuMeterFrameAvailable",T)}Bbj(T){this.cMe.removeHandler("OnCpuMeterFrameAvailable",T)}nnb(T,Aa,ib,Tb=null){ib=Tb?Tb.priority:7;const xc=this.Tz();this.start(Aa,ib);try{T()}finally{this.stop(Aa,Tb),T=this.Tz()-xc,this.j6g.track(T,Aa)}}ie(T,Aa){const ib=this.Tz();try{T()}finally{T=this.Tz()-ib,this.QBe.iCa(T,Aa),0<this.Wxb&&this.RBe.iCa(T,Aa),this.j6g.track(T,Aa)}}mWf(T){const Aa=new qa;Aa.TN=T.xLf;Aa.TP=T.priority;this.Y6i(1,Aa)}Jdc(T){this.Rld|=
T}start(T,Aa){if(!this.Wxb){this.RBe.reset();const ib=this.SDi(T);ib&&this.e4d(1);this.EZ=new qa;this.EZ.TN=T;this.EZ.TP=Aa;this.EZ.ST=(new Date).toISOString();this.EZ.STS=Y.a.VU(this.Tz(),2);ib?this.EZ.UI=1:this.ROm(T)?this.EZ.UI=2:this.EZ.UI=0}this.Wxb++}e4d(T){this.aVb|=T}TDd(T=!0,Aa=0){this.aVb=T?0:this.aVb&~Aa}stop(T,Aa=null){let ib;this.Wxb--;0>=this.Wxb&&this.EZ&&(ib=this.Tz()-this.EZ.STS,this.Qtd+=ib,this.WJe.iCa(ib,T),this.SDi(T)&&this.TDd(!1,1),this.EZ.TRT=Y.a.VU(ib,2),Aa&&(this.EZ.TQT=
Y.a.VU(Aa.bOn,2),this.EZ.TDT=Y.a.VU(Aa.eFi,2)),this.X2j&&(this.Y6i(0,this.EZ),this.y5n()),this.Wxb=0);0<=T.indexOf(fa.a.qRo)&&this.Jdc(2);0<=T.indexOf(fa.a.Ucj)&&this.Jdc(4);1===(this.aVb&1)&&this.Jdc(1);2===(this.aVb&2)&&this.Jdc(8)}y5n(){var T=this.EZ.TRT;if(750<T){let ib=this.RBe.getData();if(ib){const Tb={};for(let xc in ib){var Aa=ib[xc];const ld=xc;ld.startsWith("SiOp_")||ld.endsWith("[it]")||(Tb[ld]=Math.round(100*Aa.T/T))}ib=Tb}T=Object.assign(new ja,{B:this.EZ.STS,T,S:ib});this.fbk.track(T,
this.EZ.TN)}}KAo(){var T=this.Tz()-this.nhh,Aa=Y.a.VU(this.Qtd/T*100,2);T=new na;T.CP=Aa;T.II=this.Rld;Aa=this.WJe.getData();ba.a.count(Aa)&&(T.LRT=Aa);Aa=this.QBe.getData();ba.a.count(Aa)&&(T.FP=Aa);this.cMe.raiseEvent("OnCpuMeterFrameAvailable",new oa(T));this.vvj()}vvj(){this.WJe.reset();this.QBe.reset();this.Qtd=this.Wxb=0;this.nhh=this.Tz();this.Rld=0;this.EZ=null}run(){this.teh?this.KAo():(this.vvj(),this.teh=!0);this.Jsa?this.Jsa(Object(a.a)(this,this.run,"run"),1E3):window.setTimeout(Object(a.a)(this,
this.run,"run"),1E3)}lzd(T,Aa,ib){const Tb=Array(2);Tb[0]=Aa;Tb[1]=ib;this.nwd[T]||(this.nwd[T]=[]);this.nwd[T].push(Tb)}Y6i(T,Aa){T=this.nwd[T];if(!Na.a.jf(T))for(let Tb=0;Tb<T.length;Tb++){var ib=T[Tb];const xc=ib[0];ib=ib[1];xc&&!xc(Aa)||ib(Aa)}}Dcc(){if(!this.Bvc){const T=window.setTimeout;this.Jsa=(Aa,ib)=>T(Aa,ib);this.Bvc=!0}}SDi(T){return T.startsWith("key")||T.startsWith("input")}ROm(T){return T.startsWith("click")||T.startsWith("mouse")||T.startsWith("pointer")}}Object(f.a)(za,"CpuMeter",
null,[134]);class la{constructor(T){this.Uqc=null;this.$p=new z.a;this.Tz=T}initialize(T,Aa,ib,Tb=!1){this.Uqc||(this.Uqc=new za(this.Tz,T,Aa,ib,Tb),this.$p.Bg(this.Uqc));return this.Uqc}}Object(f.a)(la,"CpuMeterProvider",null,[1906]);var va=c(164);class ia{constructor(T=1){this.yD=[];this.Fhd=[];this.fj=T}ODl(){let T=0;for(let Aa=0;Aa<this.yD.length;Aa++)this.yD[Aa]<this.yD[T]&&(T=Aa);return T}iCa(T,Aa){T=Y.a.VU(T,2);if(this.yD.length<this.fj)Array.add(this.yD,T),Array.add(this.Fhd,Aa);else{var ib=
this.ODl();T>this.yD[ib]&&(this.yD[ib]=T,this.Fhd[ib]=Aa)}}getData(){return this.yD.length?{["Vals"]:this.yD,["Desc"]:this.Fhd}:null}reset(){this.yD=[];this.Fhd=[]}}Object(f.a)(ia,"MaxDataAggregator",null,[857]);var pa=c(39),sa=c(22);class Ha{get name(){return"Common.App.CpuMeter"}xc(T){T.register(la,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").singleInstance().Rd(()=>new la(pa.a.af));T.register(V,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").singleInstance().Rd(()=>
new V)}init(){const T=l.AFrameworkApplication.K;if(T.$("CpuMeterIsEnabled")){const Aa=sa.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");va.a.instance.HAd.continueWith(()=>{Ha.Azm(T,Aa)})}}dispose(){}static Azm(T,Aa){const ib=Ia.a.eF(10,5,new aa(T.mc("TaskManagerLoggingThreshold",0),T.mc("CpuMeterMaximumEntriesToLog",0)));Aa=Aa.initialize(new ia(5),new aa,ib,T.$("CPUMeterExposeTaskDetailsIsEnabled"));T.$("WordEditorInteractivePerfDisableCpuMeterFrames")||(Aa.run(),T.$("CpuMeterMonitorIsEnabled")&&
sa.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(Aa,T.UT("CpuMeterAverageCpuPercentThreshold",80),T.mc("CpuMeterRollingAverageFramesCount",15)));I.b(16827671,306,50,"Initializing CpuMeter")}static main(){L.a.instance.Fc(new Ha)}}Object(f.a)(Ha,"CpuMeterPackage",null,[1,2]);var ra=c(7),Ma=c(83),ya=c(1067),Ga=c(1046),wa=c(20),hb=c(1406);class eb{constructor(){this.Psa=this.Qoc=null;this.Z_b=!0;this.Mvc=!1}xc(T){l.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&T.register(1865,
"Common.IEventTimingMeter").singleInstance().Rd(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var T=new Ga.a(l.AFrameworkApplication.K.mc("EventTimingMeterEventSamplingPercent",0)/100);T=new ya.a(Object(a.a)(T,T.SOb,"shouldBeInSample"));const Aa=Ia.a.eF(16,1,T);this.Psa=new hb.a("TypingDuration-SlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.UT("AshaVetoForTypingThresholdInMS",150),l.AFrameworkApplication.K.UT("AshaVetoForTypingThresholdPercentile",
95),this.Z_b);(this.Mvc=!wa.a.p3a)&&l.AFrameworkApplication.cI(()=>{this.u7e()});this.Qoc=ib=>{ib=ib.rawEvent.detail;for(const Tb of ib)Aa.track(Tb,"EventTimingData"),"false"!==Tb.metadata.altPressed.toString()||"false"!==Tb.metadata.ctrlPressed.toString()||"false"!==Tb.metadata.repeat.toString()||"CharacterKey"!==Tb.metadata.key.toString()&&"Space"!==Tb.metadata.key.toString()||!this.Mvc||this.Psa.aya(Tb.timeToRequestAnimationFrameMs)};U.a.addHandler(window.self,W.a.Prh,this.Qoc)}dispose(){this.Qoc&&
(U.a.removeHandler(window.self,W.a.Prh,this.Qoc),this.Qoc=null)}u7e(){this.Psa.oSa();this.Psa.g_i&&(ra.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),Ma.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){L.a.instance.Fc(new eb)}}Object(f.a)(eb,"EventTimingMeterPackage",null,[1,2]);var jb=c(74),ub=c(67),ab=c(35);class Ea{constructor(T,Aa,ib,Tb=null,xc=null){this.RL=T;this.Ttb=Aa;this.Otc=ib;this.cbh=
Tb;this.szc=xc}rLd(T){const Aa=new Sys.StringBuilder(this.RL.Z5c);Aa.append("RoamingServiceHandler.ashx?action=");Aa.append("getFirstRunExperienceSettings");Aa.append("&");Aa.append(this.stf(T));Aa.append("&");Aa.append(l.AFrameworkApplication.im);l.AFrameworkApplication.Ne.xj(Aa.toString(),1,null,null,!0,2,Object(a.a)(this,this.DEa,"getRequestSuccessCallback"),Object(a.a)(this,this.Nba,"getRequestFailureCallback"),null)}m6b(T){var Aa=new Sys.StringBuilder(this.RL.Z5c);Aa.append("RoamingServiceHandler.ashx?action=");
Aa.append("saveFirstRunExperienceSettings");Aa.append("&");Aa.append(l.AFrameworkApplication.im);Aa=Aa.toString();T=ab.c(T);l.AFrameworkApplication.Ne.xj(Aa,2,T,null,!0,4,Object(a.a)(this,this.cGn,"postRequestSuccessCallback"),Object(a.a)(this,this.Vca,"postRequestFailureCallback"),null)}DEa(T){let Aa=!1,ib=null;try{if(0<T.data.ve.length){const Tb=Object(ub.a)(Object,ab.a(T.data.ve)),xc=Tb?Tb[this.RL.r1e]:null;xc&&(ib=Object(ub.a)(Object,ab.a(xc.toString())))}Aa=!0}catch(Tb){this.Nba(null)}Aa&&this.Ttb&&
this.Ttb(T.data,ib)}Nba(T){this.Otc&&this.Otc(T?T.data:null)}cGn(T){this.cbh&&this.cbh(T?T.data:null)}Vca(T){this.szc&&this.szc(T?T.data:null)}stf(T){const Aa=new Sys.StringBuilder("requestedsettings=");for(let ib=0;ib<T.count;ib++)Aa.append(T.J(ib)),ib<T.count-1&&Aa.append(";");return Aa.toString()}}Object(f.a)(Ea,"FirstRunExperienceRequestHandler",null,[]);var Wa=c(261);class Bb{constructor(){this.xtc=this.vjd=this.RL=null}lxo(T){T?(this.RL=T,this.OOm()&&(ra.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),
T=new jb.a,T.add(this.RL.r1e),this.vjd=new Ea(this.RL,Object(a.a)(this,this.DEa,"getRequestSuccessCallback"),Object(a.a)(this,this.Nba,"getRequestFailureCallback"),null,Object(a.a)(this,this.Vca,"postRequestFailureCallback")),this.vjd.rLd(T)),(this.RL.iDi||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.yeg()):ra.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}OOm(){try{if(this.RL.iDi)return!0;if(!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",
!0)||l.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;if(this.RL.BJm||this.RL.icc||l.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const T=l.AFrameworkApplication.K.jb("FlightId");return-1!==(T?T.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(T){ra.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",T?T.toString():null)}return!1}bhj(T){const Aa={},ib={};ib.FREDisplayedDate=(new Date).toUTCString();ib.VersionDisplayed=T;ib.RemindMeLater=!1;Aa[this.RL.r1e]=
ab.c(ib);ra.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.vjd&&this.vjd.m6b(Aa)}DEa(T,Aa){T=T?+T.nT-+T.KH:-1;T>this.RL.Rfj?ra.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",T,this.RL.Rfj):Aa?this.dwo(Aa)?(ra.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.RL.gPi),this.yeg()):(this.Hff(!1),ra.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(ra.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.yeg())}Nba(T){this.Hff(!1);ra.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",T?T.Qe:-1)}Vca(T){ra.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
T?T.Qe:-1)}yeg(){this.Hff(!0);var T=sa.a.instance.Na("Common.ISystemInitiatedFeedback");T?this.jsj(T):(ra.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((T=sa.a.instance.Sa("Common.ISystemInitiatedFeedback"))?T.execute(Aa=>{this.jsj(Aa)}):ra.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}jsj(T){if(T){var Aa=this.RL.sGl;
Aa&&(l.AFrameworkApplication.Dn(Aa),l.AFrameworkApplication.Kha(Aa));ra.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Aa);T.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.xtc=Object(a.a)(this,this.fpn,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.xtc,!0),window.addEventListener("FRELaunchedEvent",this.xtc,!0)):(ra.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.bhj(this.RL.currentVersion))}else ra.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}fpn(T){if(T){var Aa=T.detail;T=T.type;var ib=this.RL&&this.RL.VAh?this.RL.VAh.split("-")[0]:null;if("FRELaunchedEvent"===T||ib&&Aa&&Aa.id&&-1!==Aa.id.indexOf(ib))Aa.success&&(ra.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.bhj(this.RL.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.xtc,
!0),window.removeEventListener("FRELaunchedEvent",this.xtc,!0))}}dwo(T){if("RemindMeLater"in T&&"FREDisplayedDate"in T){if("true"===T.RemindMeLater.toString()&&(+new Date-+new Date(T.FREDisplayedDate.toString()))/36E5>this.RL.gPi)return!0}else if(l.AFrameworkApplication.K.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in T&&T.VersionDisplayed<this.RL.currentVersion)return ra.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}Hff(T){l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
Wa.a.dispatch("FREDecisionEvent",{["show"]:T})}}Object(f.a)(Bb,"FirstRunExperienceLauncher",null,[1861]);class Mb{constructor(){this.W=null}get name(){return"Common.App.FirstRunExperienceLauncher"}xc(T){this.W=T;this.W.register(1861,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").singleInstance().Rd(()=>new Bb)}init(){}dispose(){}static main(){L.a.instance.Fc(new Mb)}}Object(f.a)(Mb,"FirstRunExperienceLauncherPackage",null,[1,2]);class Fb{constructor(){this.y=this.x=0}}Object(f.a)(Fb,
"HammerPoint",null,[]);class vb{constructor(T,Aa,ib,Tb,xc){this.o4g=this.sWa=this.Eld=1;this.zxd=this.MCc=this.JYa=0;this.pLe=this.FJa=null;this.vrb=this.bBe=this.ksd=!1;this.oj=T;this.jMa=Aa;this.wxb=ib;this.ga=Tb;xc&&(this.ksd=xc.$("PromoteLayerPinchToZoomIsEnabled"),this.bBe=xc.$("FinalizeWithInitialPinchScaleIsEnabled"),this.vrb=xc.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get rL(){return this.jMa}eMm(){return!!this.oj.instance}Dpn(T){this.ga&&this.ga.processAction(n.a.Hvj,2);const Aa=this.oj.instance;
this.ksd&&Aa.N6i();this.sWa=Aa.jj;this.Eld=T.gNc.scale;this.o4g=1;this.pLe=this.yAh();this.FJa=this.jMa.getBounds();if(!this.FJa)return ra.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;T=this.qei(T);this.vrb?this.Nmj(this.jMa.scrollWidth,this.FJa.width,T,this.sWa,Aa):this.JYa=this.jMa.scrollWidth>this.FJa.width?this.VFc(this.wxb.scrollLeft,T.x,this.sWa):null;this.zxd=this.jMa.scrollHeight>this.FJa.height?this.VFc(this.wxb.scrollTop,T.y,this.sWa):null;return!0}F7f(){this.JYa=null;this.MCc=
0}Nmj(T,Aa,ib,Tb,xc){T>Aa?this.JYa?(T=xc.yJf,T!==this.MCc&&(this.JYa-=this.MCc-T,this.MCc=T)):(this.JYa=this.VFc(this.wxb.scrollLeft,ib.x,Tb),this.MCc=xc.yJf):this.F7f()}Cpn(T){const Aa=this.qei(T);if(!Aa)return ra.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;T=this.ojo(T.gNc.scale/this.Eld)*this.sWa;this.MZo(Aa,T);this.NZo(Aa,T);return!0}MZo(T,Aa){const ib=this.jMa.scrollWidth,Tb=this.FJa.width;this.vrb?this.Nmj(ib,Tb,T,Aa,this.oj.instance):!this.JYa&&ib>Tb&&(this.JYa=this.VFc(this.wxb.scrollLeft,
T.x,Aa));if(T=this.GAh(T.x,this.JYa,ib,Tb,Aa))this.wxb.scrollLeft=T}NZo(T,Aa){const ib=this.jMa.scrollHeight,Tb=this.FJa.height;!this.zxd&&ib>Tb&&(this.zxd=this.VFc(this.wxb.scrollTop,T.y,Aa));if(T=this.GAh(T.y,this.zxd,ib,Tb,Aa))this.wxb.scrollTop=T}GAh(T,Aa,ib,Tb,xc){return ib<=Tb||!Aa||!Tb?null:Math.max(0,Math.min(Aa*xc-T,ib-Tb))}VFc(T,Aa,ib){return(T+Aa)/ib}Bpn(T){T=T.gNc.scale;this.bBe&&(T/=this.Eld);this.i_h(T);this.ksd&&this.oj.instance.T2f();this.ga&&this.ga.processAction(n.a.Whf,2);this.vrb&&
this.F7f()}Apn(T){T=T.gNc.scale;this.bBe&&(T/=this.Eld);this.i_h(T,!0);this.ksd&&this.oj.instance.T2f();this.ga&&this.ga.processAction(n.a.Whf,2);this.vrb&&this.F7f()}ojo(T){const Aa=this.oj.instance,ib=new Date>=this.pLe;ib&&(this.pLe=this.yAh());Math.abs(T-this.o4g)>=.01*T&&Aa.dqo(T*this.sWa,ib);return Aa.jj/this.sWa}i_h(T,Aa=!1){T*=this.sWa;this.oj.instance.ycg(T,!1);const ib={};ib.initialScale=this.sWa;ib.finalScale=T;ib.cancelled=Aa;ra.ULS.sendTraceTag(42821150,353,50,"Pinch zoom ended: {0}",
ib)}qei(T){return(T=T.gNc.center)&&this.FJa?Object.assign(new Fb,{x:T.x-this.FJa.x,y:T.y-this.FJa.y}):null}yAh(){const T=(new Date).getTime();return new Date(T+1E3)}}Object(f.a)(vb,"PinchZoomAdapter",null,[1929]);class $a{constructor(T){this._element=T}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(f.a)($a,"ScrollContainerElement",null,[1928]);var kb=c(131);class Ua{constructor(T,
Aa,ib,Tb,xc,ld){this.UTe=this.cab=null;this.W=T;this.ge=Aa;this.Qmd=ib;this.i2g=Tb;this.J9j=xc;this.FVb=ld;this.ngd=new jb.a}register(T,Aa){this.Qmd&&(4===l.AFrameworkApplication.ta.Nb.Tl&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?kb.a.get_instance().Ak(8,()=>{this.zej(T,Aa)}):this.zej(T,Aa))}zej(T,Aa){this.W.Sa("Common.IGestureInputManager").execute(ib=>{this.DDo();this.cab=ib;this.ngd.add(T);if(this.i2g){if(this.J9j&&0!==ib.bZl()){this.nwj();
return}var Tb=this.W.Sa("Common.IZoomManager");this.W.resolve("Common.IAppSettingsManager");const xc=new $a(T);Tb=new vb(Tb,xc,Aa,l.AFrameworkApplication.va,l.AFrameworkApplication.K);ib.KWn(T,Tb)}this.nwj()})}unregister(){if(this.cab&&this.ngd){if(this.i2g){for(let T of this.ngd)this.cab.USo(T);this.ngd.clear()}this.cab=null}}DDo(){this.FVb&&(this.ge?this.UTe=this.ge.Zf("Task","Register"):ra.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}nwj(){this.FVb&&(this.UTe?this.UTe.stop():
ra.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(f.a)(Ua,"GestureInputRegistrar",null,[1866]);class Sa{constructor(){this.W=null;this.Zh=!1}get name(){return"Common.App.GestureInput"}init(){this.Zh||(this.W.resolve("Common.IGestureInputRegistrar"),this.Zh=!0)}dispose(){}xc(T){this.W=T;T.register(1866,"Common.IGestureInputRegistrar").singleInstance().Rd(()=>new Ua(T,l.AFrameworkApplication.ta.Hq,l.AFrameworkApplication.fVc(),l.AFrameworkApplication.NAi(),!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){L.a.instance.Fc(new Sa)}}Object(f.a)(Sa,"GestureInputPackage",null,[1,2]);var xb=c(404),Qb=c(77);class Ib{constructor(){this.wnb=this.U3h=null}}Object(f.a)(Ib,"GestureAdapterInfo",null,[]);var $b=c(622),hc=c(288);class pb{constructor(){this.Ksb=null}ZJf(){if(!this.Ksb){var T="hammer.min.js";l.AFrameworkApplication.K.Sw("IsServerFlavorDebug")&&
(T=l.AFrameworkApplication.K.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");T=l.AFrameworkApplication.Hz(String.format("{0}",T),5);T=hc.a.create(T,null,null);$b.a.pX(T);this.Ksb=T.T3a}return this.Ksb}static get instance(){pb._instance||(pb._instance=new pb);return pb._instance}}pb._instance=null;Object(f.a)(pb,"HammerJsDependencyLoader",null,[1924]);const dc=(T,Aa,ib=null)=>{if(void 0===Aa||null===Aa)throw ra.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");
let Tb=null;switch(T){case W.a.pinch:Tb=new Hammer.Pinch(ib);break;case W.a.pan:Tb=new Hammer.Pan(ib)}Tb&&(Tb.manager=Aa);return Tb};var Ob;(function(T){T[T.none=-1]="none";T[T.pinch=0]="pinch";T[T.pan=1]="pan";T[T.swipe=2]="swipe"})(Ob||(Ob={}));Object(f.b)("GestureEvent",Ob);var Vb=c(69);class ob extends Vb.a{constructor(T,Aa,ib,Tb,xc,ld,Sd,df){super(T,ib,Tb,ld);this.jqc=Aa;this.mYa=Sd;this.Lra=df;this.z4j=xc}get shiftKey(){return this.mYa}get ctrlKey(){return this.Lra}get clientPoint(){return this.jqc}get gNc(){return this.z4j}static create(T,
Aa,ib,Tb,xc,ld){if(ib.rawEvent)if(ld){var Sd=ib.rawEvent;Sd=new Sys.UI.Point(Sd.clientX,Sd.clientY)}else Sd=Vb.a.uOd(ib);else Sd=new Sys.UI.Point(ib.clientX,ib.clientY);return new ob(T,Sd,Aa,ib,Tb,xc,ib.shiftKey,ib.ctrlKey,ld)}}Object(f.a)(ob,"GestureEventArgs",Vb.a,[]);class Xb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(f.a)(Xb,"GestureManagerData",null,[]);class Xa{}Xa.pSj=2;Xa.qSj=4;Xa.rSj=8;Xa.sSj=8;Object(f.a)(Xa,"HammerConstants",null,[]);var Pb=c(93),rc=c(113),Ta=c(19),Ab=c(104);class Db extends U.a{constructor(T,Aa){super();this.TKa=xb.a.uLl;this.kOe=!!window.PointerEvent;this.ujh=window.hasOwnProperty("ontouchstart");this.Ntb=this.myc=null;this.FKa=
!1;this.$ka=new Qb.a;this.qzc=new Qb.a;this.VWg=new jb.a;this.j$a=null;this.dTb=this.FVb=this.COg=this.wve=this.JJe=this.odh=this.TOg=this.UCc=!1;this.oxc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.VTe=null;this.ng=Pb.EventHandlerManager.instance;this.kOe?(ra.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.myc=Object(a.a)(this,this.c8d,"onPointerEvent"),this.Ntb=W.a.wLl):this.ujh?(ra.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.myc=Object(a.a)(this,
this.Cmb,"onTouchEvent"),this.Ntb=W.a.touchEvents):(ra.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.myc=Object(a.a)(this,this.P7d,"onMouseEvent"),this.Ntb=W.a.vLl);this.ge=Aa;this.f2=T;l.AFrameworkApplication.K&&(this.UCc=l.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.TOg=l.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),this.odh=l.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.JJe=l.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),
this.wve=l.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.COg=l.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.FVb=l.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.dTb=this.UCc&&l.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&l.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}bZl(){return this.kOe?0:this.ujh?1:2}kv(T){super.kv(T);this.ng.ZEa(this.Ntb,T,0,this.myc)}$u(T){super.$u(T);
this.ng.L_a(T,this.Ntb)}KWn(T,Aa){l.AFrameworkApplication.fVc()?pb.instance.ZJf().continueWith(ib=>{this.CDo();if(ib.Ai||ib.yo)ra.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",ib.status);else{ra.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",ib.status);if(this.COg){ib=window.Hammer;if("undefined"===typeof ib){ra.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.vke();return}if("undefined"===typeof ib.inputHandler){ra.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.vke();return}}if(!T)throw this.vke(),Error.argumentNull("source element can not be null");ib=rc.a.Db(T,this.TKa);if(void 0===ib||null===ib)ib=new Qb.a,rc.a.Kl(T,this.TKa,ib),this.LWn(T);if(!ib.mb(Ob[0])){var Tb=Object.assign(new Ib,{wnb:dc(Ob[0],this,null),U3h:Aa});ib.add(Ob[0],Tb)}}this.vke()}):ra.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}CDo(){this.FVb&&(this.ge?this.VTe=this.ge.Zf("Task",
"RegisterGestureAdapterAfterLoad"):ra.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}vke(){this.FVb&&(this.VTe?this.VTe.stop():ra.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}USo(T){ra.ULS.sendTraceTag(42256223,310,T?100:10,"source element {0} ",T.id);const Aa=rc.a.Db(T,this.TKa);void 0!==Aa&&null!==Aa&&(Aa.remove(Ob[0]),Aa.count||(rc.a.RU(T,this.TKa),this.curRecognizer=null,this.VSo(T)))}LWn(T){this.VWg.add(T);this.ng.ZEa(this.Ntb,T,
0,this.myc)}VSo(T){this.VWg.remove(T);this.ng.L_a(T,this.Ntb)}recognize(T){var Aa=Array(T.pointers.length);for(var ib=0;ib<T.pointers.length;ib++)Aa[ib]=T.pointers[ib].target;ib=null;for(this.j$a=this.t3l(Aa);void 0!==this.j$a&&null!==this.j$a&&(ib=rc.a.Db(this.j$a,this.TKa),void 0===ib||null===ib);this.j$a=this.j$a.parentNode);if(void 0!==ib&&null!==ib){this.curRecognizer&&this.curRecognizer.state===Xa.sSj&&(this.curRecognizer=null);Aa=ib.keys;for(let Tb of Aa){Aa=ib.J(Tb);void 0!==Aa&&null!==Aa&&
void 0!==Aa.wnb&&null!==Aa.wnb&&(void 0===this.curRecognizer||null===this.curRecognizer||Aa.wnb===this.curRecognizer||Aa.wnb.canRecognizeWith(this.curRecognizer))&&Aa.wnb.recognize(T);const xc=Aa.wnb.state;this.curRecognizer||Xa.pSj!==xc&&Xa.qSj!==xc&&Xa.rSj!==xc||(this.curRecognizer=Aa.wnb)}}}emit(T,Aa){if("hammer.input"!==T){this.FKa=!1;Aa=ob.create(T,this.j$a,Aa.srcEvent,Aa,3,this.kOe);var ib=rc.a.Db(this.j$a,this.TKa);if(this.JQm(T))var Tb=0;else if(this.iQm(T))Tb=1;else if(this.dUm(T))Tb=2;else{ra.ULS.sendTraceTag(42256256,
310,15,"Event can not be recognized by current manager");return}({value:ib}=ib.Dc(Ob[Tb]));void 0!==ib&&null!==ib&&((ib=ib.U3h,ib.eMm())?T.endsWith("start")?this.FKa=ib.Dpn(Aa):T.endsWith("end")?(ib.Bpn(Aa),this.FKa=!0):T.endsWith("cancel")?(ib.Apn(Aa),this.FKa=!0):T.endsWith("move")&&(this.FKa=ib.Cpn(Aa)):ra.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",T))}}get(T){return Object(ub.a)(Hammer.Recognizer,T)}t3l(T){if(1>T.length)return null;if(1===T.length)return T[0];
var Aa=T[0],ib=!0;for(let Tb=1;Tb<T.length;Tb++){if(!T[Tb])return null;if(Aa!==T[Tb]){ib=!1;break}}if(ib)return Aa;Aa=this.y4h(T[0]);ib=0;for(const Tb of T){T=this.y4h(Tb);if(Aa.J(Aa.count-1)!==T.J(T.count-1))return null;for(let xc=Aa.count-2,ld=T.count-2;xc>=ib&&0<=ld;xc--,ld--)if(Aa.J(xc)!==T.J(ld)){ib=xc+1;break}}return Aa.J(ib)}y4h(T){const Aa=new jb.a;for(;void 0!==T&&null!==T;T=T.parentNode)Aa.add(T);return Aa}tai(T){switch(T){case W.a.yP:case W.a.fAb:return 1;case W.a.xP:case W.a.$4e:return 2;
case W.a.XJ:case W.a.gAb:return 4;case W.a.Dme:case W.a.Z4e:return 8}return 0}Cmb(T,Aa,ib){T=this.tai(T);Aa=this.G0l(ib);Hammer.inputHandler(this,T,Aa);this.FKa&&ib.preventDefault();return this.FKa}Ami(){return 1<this.$ka.count}UCd(){ra.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.UCc)for(let T of this.$ka)this.Iaj(T.key);else this.$ka=new Qb.a;this.session=null}uuk(T,Aa,ib){ra.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",T);if(!this.qzc.mb(T)){try{Aa.setPointerCapture(T)}catch(Tb){ra.ULS.sendTraceTag(594055958,
310,10,"Exception: {0}",Tb)}this.qzc.add(T,Aa)}this.$ka.Z(T,ib);this.dTb&&1<this.$ka.count&&this.f2&&!this.f2.fGc&&(this.f2.fGc=!0)}Iaj(T){ra.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",T);if(this.qzc.mb(T)){try{this.qzc.J(T).releasePointerCapture(T)}catch(Aa){ra.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",Aa)}this.qzc.remove(T)}else ra.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",T);this.$ka.remove(T);this.dTb&&
1>=this.$ka.count&&this.f2&&this.f2.fGc&&(this.f2.fGc=!1)}c8d(T,Aa,ib){var Tb=ib.rawEvent.pointerType.toString();const xc=ib.rawEvent.pointerId.toString();if("touch"!==Tb)return!1;T=this.tai(T);if(1!==T&&!this.$ka.mb(xc))return!1;this.TOg&&1===T&&ib.rawEvent.isPrimary&&this.$ka.count&&(ra.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.UCd());this.UCc?this.uuk(xc,Aa,ib):this.$ka.Z(xc,ib);this.JJe&&2===T&&(!this.wve||this.wve&&"function"===typeof ib.rawEvent.getCoalescedEvents)&&
(Aa=ib.rawEvent.getCoalescedEvents())&&this.Ami()&&(this.oxc=Math.max(this.oxc,Aa.length));this.odh&&(this.FKa=!1);Tb=this.F0l(this.$ka,ib,Tb);Hammer.inputHandler(this,T,Tb);if(4===T||8===T)this.UCc?this.Iaj(xc):this.$ka.remove(xc),this.$ka.count||(this.session=null,this.JJe&&-1!==this.oxc&&(ra.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.oxc),this.oxc=-1));this.FKa&&ib.preventDefault();return this.FKa}P7d(){return!1}G0l(T){const Aa=new Xb;var ib=T.rawEvent;const Tb=
ib.touches;ib=ib.changedTouches;Aa.pointers=Array.clone(Tb);Aa.pointers=Array.clone(0<Tb.length?Tb:ib);Aa.changedPointers=Array.clone(ib);Aa.srcEvent=T;Aa.pointerType="touch";return Aa}F0l(T,Aa,ib){const Tb=new Xb;Tb.pointers=Ab.toArray(T.values);Tb.changedPointers=[Aa];Tb.pointerType=ib;Tb.srcEvent=Aa;return Tb}JQm(T){return Ta.a.startsWith(T,W.a.pinch)}iQm(T){return Ta.a.startsWith(T,W.a.pan)}dUm(T){return Ta.a.startsWith(T,W.a.swipe)}}Object(f.a)(Db,"GestureInputManager",U.a,[1892,1893]);var ac=
c(295);class Pa{constructor(){this.W=null;this.Zh=!1}get name(){return"Common.App.GestureInputManager"}xc(T){T.register(Db,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").singleInstance().Rd(()=>new Db(ac.a.instance,l.AFrameworkApplication.ta.Hq));this.W=T}init(){this.Zh||(this.W.resolve("Common.App.GestureManager.GestureInputManager"),this.Zh=!0)}dispose(){}static main(){L.a.instance.Fc(new Pa)}}Object(f.a)(Pa,"GestureInputManagerPackage",null,[1,2]);var bb=c(242),
lc=c(57),rb=c(1558);class La{constructor(T,Aa,ib){this.nSe=this.mSe=null;this.wZb=new z.a;this.Xf=T;this.eyc=ib;this.Ila=Aa.appSettings[La.G4o]||""}get Cro(){return this.wZb.task}get tQ(){return this.Xf.value}a6n(){const T={};T[La.tqm]=l.AFrameworkApplication.im;T["Content-Type"]="application/json; charset=utf-8";ra.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const Aa=lc.a.kp(this.Ila+La.Dro,La.zkn,l.AFrameworkApplication.ta.Nb.Tl.toString());
this.tQ.xj(Aa,1,"",T,!0,2,Object(a.a)(this,this.aLb,"onSuccessCallback"),Object(a.a)(this,this.HKb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}R5m(T){try{const Aa={};Aa.FlightName=T.FlightName;Aa.SessionID=T.SessionID;ra.ULS.sendTraceTag(594883776,215,50,ab.c(Aa))}catch(Aa){ra.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}aLb(T){if((T=T.data.ve)&&T.length)try{const Aa=ab.a(T);this.mSe=Aa.NavBarDataJson;ra.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");
this.mSe?({av:this.nSe}=ab.d(Aa.NavBarDataJson)).returnValue?(this.R5m(this.nSe),this.wZb.Bg(this.nSe)):(ra.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:rb.a.Aad(this.mSe)}),this.wZb.jda()):(ra.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.wZb.jda())}catch(Aa){ra.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.wZb.jda()}else ra.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}HKb(){this.wZb.jda();
ra.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return La._instance||(La._instance=La.UDb())}static UDb(){return new La(new bb.a(()=>l.AFrameworkApplication.Ne),l.AFrameworkApplication.K,l.AFrameworkApplication.ta.Nb.Tl)}}La.tqm="X-qs";La.zkn="at";La.Dro="O365ShellServiceProxy.ashx";La._instance=null;La.G4o="ShellWebServiceBase";Object(f.a)(La,"O365ShellActor",null,[1905]);class sb{constructor(){this.W=null}get name(){return"Common.App.O365Shell"}xc(T){this.W=
T;this.W.register(La,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").singleInstance().Rd(()=>new La(new bb.a(()=>l.AFrameworkApplication.Ne),l.AFrameworkApplication.K,l.AFrameworkApplication.ta.Nb.Tl))}init(){l.AFrameworkApplication.K.Po(Object(a.a)(this,this.Px,"onFullAppSettingsReady"))}Px(){l.AFrameworkApplication.Xng&&l.AFrameworkApplication.ta.Nb.xJ&&this.W.resolve("Common.App.O365Shell.O365ShellActor").a6n()}dispose(){}static main(){L.a.instance.Fc(new sb)}}
Object(f.a)(sb,"PackageManager",null,[1,2]);class Sb{WQa(){}init(){}dispose(){}}Object(f.a)(Sb,"NoOpOfflineLogger",null,[1949,10]);var kc=c(779);class Lb{}Lb.GAd=0;Object(f.a)(Lb,"OfflineLoggerConstants",null,[]);var Qc=c(90),Dc=c(243),Fd=c(303);class pe{constructor(T,Aa,ib,Tb,xc,ld,Sd,df){this.MJe=this.exc=null;this.CWa=!1;this.K6=null;this.hrc=this.SWb=this.ysb=0;this.NF=this.lbb=this.Dfd=this.mrd=this.fQ=null;this.am=!1;this.YAa=ib;this.MBa=Tb;this.zBa=xc;this.Xf=Aa;this.Gb=T;this.DVa=ld;this.hvb=
!1;this.BWa=df;Sd?(this.Dfd=new pe(T,Aa,ib,Tb,xc,ld,!1,df),this.Dfd.mrd=this,this.exc="OfflineLoggerManifest|"+this.DVa,this.MJe="OfflineLog|"+this.DVa+"|"):(this.exc="OfflineLoggerManifest",this.MJe="OfflineLog|")}init(){this.Kcg();this.g1m();this.CWa=!1;this.Xf.B0b(this);this.fQ=new Qc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Gb.Vb(this.fQ);this.Dfd&&this.Dfd.init()}IFc(T){return this.MJe+T}g1m(){const T=this.YAa.getItem(this.exc);void 0!==T&&null!==T&&0<T.length&&
(this.K6=pe.Iad(T));this.K6||(this.K6={});if(void 0===this.K6.end||null===this.K6.end)this.K6.end=0;if(void 0===this.K6.offset||null===this.K6.offset)this.K6.offset=0;this.ysb=this.K6.offset;isFinite(this.ysb)||(this.ysb=0);this.SWb=this.K6.end;isFinite(this.SWb)||(this.SWb=0);this.hrc=this.SWb}Kcg(){this.lbb=new Fd.a;this.NF=new Dc.a;this.mrd||(this.MBa.tqh(Object(a.a)(this,this.CWf,"onUlsReadyToBeSent")),this.MBa.Xqh(Object(a.a)(this,this.EWf,"onUlsSentSuccessfully")),this.MBa.Wqh(Object(a.a)(this,
this.DWf,"onUlsSentFailed")));this.MBa.jqh(Object(a.a)(this,this.ISf,"onAfterUlsHostDisposed"))}CWf(T,Aa){if(void 0!==Aa&&null!==Aa&&void 0!==Aa.args&&null!==Aa.args){T=!1;if(!this.lbb.mb(Aa.args.tag)){if(!this.lbb.mb(Lb.GAd))return;T=!0}this.lbb.remove(T?Lb.GAd:Aa.args.tag);this.NF.mb(Aa.uploadId)||this.NF.Z(Aa.uploadId,new jb.a);this.NF.J(Aa.uploadId).add(Aa.args)}}EWf(T,Aa){this.NF.remove(Aa.uploadId);this.BWa&&this.hvb&&(this.hvb=!1,this.mEh())}DWf(T,Aa){this.hvb=!0;if(void 0!==Aa&&null!==Aa&&
this.NF.mb(Aa.uploadId)){T=this.NF.J(Aa.uploadId);for(let Tb=0,xc=T.count;Tb<xc;++Tb){var ib=pe.serialize(T.J(Tb),this.zBa);ib=this.Jad(this.IFc(this.hrc++),ib);this.BWa&&ib&&(1<this.NF.J(Aa.uploadId).count?this.NF.J(Aa.uploadId).remove(T.J(Tb)):this.NF.remove(Aa.uploadId))}}}ISf(){this.dispose()}Jad(T,Aa){try{return this.YAa.setItem(T,Aa),!0}catch(ib){return this.BWa||ra.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",ib.message),!1}}sendOfflineLogs(){if(!this.CWa){for(var T=
this.ysb,Aa=new jb.a,ib=null;T<this.SWb&&5>=Aa.count;++T){var Tb=this.IFc(T);const xc=this.YAa.getItem(Tb);this.YAa.removeItem(Tb);if(void 0===xc||null===xc)continue;const ld=({sessionId:Tb}=pe.deserialize(xc)).returnValue;if(ld){if(!ib)ib=Tb;else if(Tb!==ib)break;Aa.add(ld)}else ra.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",xc)}0<Aa.count&&this.MBa.aej(this,Ab.toArray(Aa),ib);this.ysb=T;T>=this.SWb&&this.VCb()}}mEh(){this.VCb();this.fQ=new Qc.a(3,2,2500,Object(a.a)(this,
this.sendOfflineLogs,"sendOfflineLogs"),104);this.Gb.Vb(this.fQ)}WQa(T,Aa,ib){!this.am&&ra.ULS.Y9(Aa,ib)&&(this.mrd?this.mrd.WQa(T,Aa,ib):this.lbb.Z(T,!0))}dispose(){if(!this.am){this.fQ&&this.Gb.Xe(this.fQ);var T=Ab.toArray(this.NF.keys);T.sort();for(const Aa of T){T=this.NF.J(Aa);for(let ib=0,Tb=T.count;ib<Tb;++ib){const xc=pe.serialize(T.J(ib),this.zBa);this.Jad(this.IFc(this.hrc++),xc)}}this.ysb<this.hrc?(this.K6.end=this.hrc,this.K6.offset=this.ysb,this.Jad(this.exc,JSON.stringify(this.K6))):
this.YAa.removeItem(this.exc)}this.am=!0}uRa(){this.CWa=!0}Klb(){this.CWa=!1;this.BWa&&this.mEh()}VCb(){this.fQ&&(this.Gb.Xe(this.fQ),this.fQ=null)}static serialize(T,Aa){const ib={};ib.t=T.tag;ib.c=T.category;ib.l=T.level;ib.m=T.message;ib.lt=T.logType;ib.s=Aa;ib.ts=T.timestamp;ib.o=T.isMinified;ib.a=T.args;return JSON.stringify(ib)}static deserialize(T){return(T=pe.Iad(T))?{returnValue:new kc.a(T.ts,T.c,T.t,T.l,T.m,T.lt,T.o,T.a),sessionId:T.s}:{returnValue:null,sessionId:null}}static Iad(T){try{return JSON.parse(T)}catch(Aa){ra.ULS.sendTraceTag(18614234,
222,10,"OfflineLogger TryParseString failed with exception: {0}",Aa.message)}return null}}Object(f.a)(pe,"OfflineLoggerImpl",null,[1949,10,200]);class ye{constructor(T,Aa,ib,Tb){this.sessionId=T;this.version=Aa;this.wBd=ib;this.lXf=Tb;this.exa=new jb.a}}Object(f.a)(ye,"CachedLogUpload",null,[]);class pf{constructor(T){T.name&&(this.n=T.name);T.stack&&(this.s=T.stack);T.message&&(this.m=T.message);T.file&&(this.f=T.file);null!=T.line&&(this.l=T.line);null!=T.column&&(this.c=T.column)}}Object(f.a)(pf,
"LoggingExceptionArgsLocalStorage",null,[]);class Yf{constructor(T){this.t=T.tag;this.c=T.category;this.l=T.level;this.m=T.message;this.lt=T.logType;this.ts=T.timestamp;this.o=T.isMinified;this.a=T.args;T.exceptionArgs&&(this.e=new pf(T.exceptionArgs))}}Object(f.a)(Yf,"LoggingArgsLocalStorage",null,[]);var Ed=c(475);class Rc{constructor(T,Aa,ib,Tb,xc,ld,Sd){this.t=T;this.m=Aa;this.s=ib;this.v=Tb;this.i=xc;this.a=ld;this.d=Sd;this.op="Log"}}Object(f.a)(Rc,"LoggingKeyLocalStorage",null,[]);var Yc=c(140);
const Mc=(T,Aa,ib,Tb,xc)=>!(void 0===T||null===T)&&!(void 0===T.i||null===T.i)&&!(void 0===T.t||null===T.t)&&!(void 0===T.s||null===T.s)&&"Log"===T.op&&T.t===Aa&&isFinite(T.t)&&Yc.a.isValid(T.s)&&(void 0===T.m||null===T.m||T.m===ib)&&(!xc||void 0===T.d||null===T.d||T.d===Tb);class ge{constructor(T,Aa,ib,Tb,xc,ld,Sd,df,De,Ff,Wg,Vh,zk,Wi){this.CWa=this.U5g=this.I5g=this.J5g=!1;this.NF=this.lbb=this.K6=this.fQ=null;this.am=!1;this.Xub=[];this.MWb=[];this.YAa=ib;this.MBa=Tb;this.zBa=xc;this.Xf=Aa;this.Gb=
T;this.eyc=ld;this.PLe=Sd;this.ydh=df;this.VWa=De;this.Mak=Ff;this.iHe=Wg;this.DVa=Vh;this.y0g=zk;this.hvb=!1;this.BWa=Wi}get manifest(){return this.K6}get gYc(){return this.lbb}get RFa(){return this.NF}init(){this.Kcg();this.CWa=!1;this.Xf.B0b(this);this.fQ=new Qc.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.Gb.Vb(this.fQ)}determineLogsToSendAtBoot(){this.GRh(!0)}determineLogsToSendOnReconnect(){this.GRh(!1)}GRh(T){this.VCb();this.Xub=[];T&&(this.MWb=
[]);for(var Aa=0;Aa<this.YAa.length;Aa++){const ib=this.YAa.key(Aa),Tb=ge.oDj(ib,!1);Mc(Tb,this.eyc,this.PLe,this.DVa,this.y0g)&&(Tb.s===this.zBa?Array.add(this.Xub,ib):T&&Array.add(this.MWb,ib))}if(this.Xub.length||T&&this.MWb.length)if(Aa=this.iHe?Object(a.a)(this,this.OAo,"sortDescendKeysToUpload"):Object(a.a)(this,this.RAo,"sortKeysToUpload"),this.Xub.sort(Aa),T&&this.MWb.sort(Aa),0<this.Xub.length||0<this.MWb.length)this.fQ=new Qc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),
105),this.Gb.Vb(this.fQ)}RAo(T){return T.s!==T.s?T.s.localeCompare(T.s):T.i-T.i}OAo(T){return T.s!==T.s?T.s.localeCompare(T.s):T.i-T.i}IFc(T,Aa,ib,Tb){T=new Rc(this.eyc,this.PLe,Aa,ib,T,Tb,this.DVa);return JSON.stringify(T)}Kcg(){this.lbb=new Fd.a;this.NF=new Dc.a;this.MBa.tqh(Object(a.a)(this,this.CWf,"onUlsReadyToBeSent"));this.MBa.Xqh(Object(a.a)(this,this.EWf,"onUlsSentSuccessfully"));this.MBa.Wqh(Object(a.a)(this,this.DWf,"onUlsSentFailed"));this.MBa.jqh(Object(a.a)(this,this.ISf,"onAfterUlsHostDisposed"))}CWf(T,
Aa){if(void 0!==Aa&&null!==Aa&&void 0!==Aa.args&&null!==Aa.args){if(this.gYc.mb(Aa.args.tag))this.gYc.remove(Aa.args.tag);else if(this.gYc.mb(Lb.GAd))this.gYc.remove(Lb.GAd);else if(!(this.Mak&&50>Aa.args.level))return;({value:T}=this.RFa.Dc(Aa.uploadId)).returnValue||(T=new ye(Aa.sessionId,Aa.version,Aa.wBd,Aa.lXf),this.RFa.Z(Aa.uploadId,T));this.RFa.J(Aa.uploadId).exa.add(Aa.args)}}EWf(T,Aa){this.RFa.remove(Aa.uploadId);this.BWa&&this.hvb&&(this.hvb=!1,this.nEh())}DWf(T,Aa){this.hvb=!0;void 0!==
Aa&&null!==Aa&&this.RFa.mb(Aa.uploadId)&&this.EPi(Aa.uploadId)&&!this.U5g&&(this.U5g=!0,this.BWa||ra.ULS.sendTraceTag(37290073,222,50,"Added logs to local storage."))}EPi(T){let Aa=!1;if(({value:Tb}=this.RFa.Dc(T)).returnValue&&Tb&&0<Tb.exa.count){if(Tb.wBd>=this.VWa)return this.BWa&&this.RFa.remove(T),!1;var ib=Tb.exa;const xc=Array(ib.count);for(let ld=0,Sd=ib.count;ld<Sd;++ld)xc[ld]=new Yf(ib.J(ld));ib=ge.serialize(xc);var Tb=this.IFc(Tb.lXf,Tb.sessionId,Tb.version,Tb.wBd);this.Jad(Tb,ib)&&(this.RFa.remove(T),
Aa=!0)}return Aa}ISf(){this.dispose()}Jad(T,Aa){try{return this.YAa.setItem(T,Aa),!0}catch(ib){return this.BWa||ra.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",ib.message),!1}}sendOfflineLogs(){if(!this.CWa){var T=0<this.Xub.length?this.Xub:this.MWb,Aa=T.length;if(Aa)for(;0<Aa;){l.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");Aa--;var ib=this.iHe?T.pop():T[0];this.iHe||Array.removeAt(T,0);const ld=
ge.oDj(ib,!0);if(Mc(ld,this.eyc,this.PLe,this.DVa,this.y0g)){var Tb=this.YAa.getItem(ib);this.YAa.removeItem(ib);if(void 0!==Tb&&null!==Tb)if(ld.a>this.VWa)ra.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",ld.a,this.VWa);else if(ib=ge.Iad(Tb,!0),void 0!==ib&&null!==ib&&isFinite(ib.length))if(ib.length){Tb=ib[ib.length-1];var xc=(new Date).getTime()-Tb.ts;if(xc<-ge.Gzj)ra.ULS.sendTraceTag(37290078,222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",
Tb.ts);else if(xc>this.ydh*ge.Gzj)ra.ULS.sendTraceTag(37290079,222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.ydh,Tb.ts);else{ld.s===this.zBa?this.J5g||(this.J5g=!0,ra.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.I5g||(this.I5g=!0,ra.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",ld.s));Aa=Array(ib.length);for(Tb=0;Tb<ib.length;Tb++){T=Tb;a:{xc=ib[Tb];if(void 0===xc||null===
xc){xc=null;break a}let Sd=null;xc.e&&(Sd=new Ed.a(null),Sd.name=xc.e.n,Sd.stack=xc.e.s,Sd.message=xc.e.m,Sd.file=xc.e.f,Sd.line=xc.e.l,Sd.column=xc.e.c);xc=new kc.a(xc.ts,xc.c,xc.t,xc.l,xc.m,xc.lt,xc.o,xc.a,Sd)}Aa[T]=xc}this.MBa.aej(this,Aa,ld.s,ld.v,ld.a+1,ld.i);break}}else ra.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Tb);else ra.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",Tb)}}else this.VCb()}}nEh(){this.VCb();this.fQ=
new Qc.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendOnReconnect,"determineLogsToSendOnReconnect"),102);this.Gb.Vb(this.fQ)}WQa(T,Aa,ib){!this.am&&ra.ULS.Y9(Aa,ib)&&this.gYc.Z(T,!0)}dispose(){if(!this.am){this.fQ&&this.Gb.Xe(this.fQ);var T=Ab.toArray(this.RFa.keys);for(const Aa of T)this.EPi(Aa)}this.am=!0}uRa(){this.CWa=!0;this.VCb()}Klb(){this.CWa=!1;this.nEh()}VCb(){this.fQ&&(this.Gb.Xe(this.fQ),this.fQ=null)}static serialize(T){return JSON.stringify(T)}static oDj(T,Aa){(T=ge.Iad(T,Aa))&&
void 0===T.d&&(T=new Rc(T.t,T.m,T.s,T.v,T.i,T.a,0));return T}static Iad(T,Aa){try{return JSON.parse(T)}catch(ib){Aa&&ra.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",ib.message)}return null}}ge.Gzj=864E5;Object(f.a)(ge,"OfflineLoggerImplV2",null,[1949,10,200]);class Ne{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(T){return this.handleError("Length",T),-1}}key(T){try{return localStorage.key(T)}catch(Aa){return this.handleError("Key",
Aa),null}}getItem(T){try{return localStorage.getItem(T)}catch(Aa){return this.handleError("GetItem",Aa),null}}setItem(T,Aa){try{return localStorage.setItem(T,Aa)}catch(ib){return this.handleError("SetItem",ib),null}}removeItem(T){try{localStorage.removeItem(T)}catch(Aa){this.handleError("RemoveItem",Aa)}}clear(){try{localStorage.clear()}catch(T){this.handleError("Clear",T)}}handleError(T,Aa){ra.ULS.sendTraceTag(19170128,222,10,"Invoking localStorage function[{0}] failed, message: {1}",T,Aa.message)}}
Object(f.a)(Ne,"OfflineStorage",null,[1948]);class Ee{create(T){var Aa=null;try{void 0!==localStorage&&null!==localStorage&&(Aa=new Ne)}catch(Tb){ra.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",Tb.message)}Object.getType(ra.ULS.host).implementsInterface(948)&&Aa||(ra.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",Aa?"supported":"not supported",Object.getType(ra.ULS.host).implementsInterface(948)?"supported":
"not supported"),T=0);const ib=l.AFrameworkApplication.K;1===T?Aa=new pe(l.AFrameworkApplication.nc,l.AFrameworkApplication.Ne,Aa,ra.ULS.host,l.AFrameworkApplication.userSessionId,l.AFrameworkApplication.fPh,ib.$("OfflineLoggerDataBoundarySupportIsEnabled"),ib.$("OfflineLoggerMemoryOptimizationIsEnabled")):2===T?(T=l.AFrameworkApplication.ta.Nb,Aa=new ge(l.AFrameworkApplication.nc,l.AFrameworkApplication.Ne,Aa,ra.ULS.host,l.AFrameworkApplication.userSessionId,T.Tl,T.Wha,ib.mc("OfflineLoggerRetentionInDays",
30),ib.mc("OfflineLoggerMaxAttempts",5),ib.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),ib.$("SendOfflineLogsV2ImprovementIsEnabled"),l.AFrameworkApplication.fPh,ib.$("OfflineLoggerDataBoundarySupportIsEnabled"),ib.$("OfflineLoggerMemoryOptimizationIsEnabled"))):Aa=new Sb;Aa.init();return Aa}}Object(f.a)(Ee,"OfflineLoggerFactory",null,[]);class Ve{xc(){}get name(){return"Common.App.OfflineLogger"}init(){const T=l.AFrameworkApplication.K;let Aa=0;T.$("OneNoteOfflineLoggerIsEnabled")?Aa=1:
T.$("OfflineLoggerV2IsEnabled")&&(Aa=2);0!==Aa&&(l.AFrameworkApplication.ujg=(new Ee).create(Aa))}dispose(){}}Object(f.a)(Ve,"OfflineLoggerPackage",null,[1,2]);var mc=c(44),Oc=c(1378);class xd{constructor(T){this.AMi=null;ra.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.NYc=l.AFrameworkApplication.K.jb("PhoneLinkServiceEndpoint");(this.f9=T)||ra.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.NYc&&this.NYc.length||ra.ULS.sendTraceTag(527574721,
306,10,"PhoneLinkManager - Missing service endpoint")}BBl(T){T&&(this.NYc="https://dcg-df.microsoft.com/",ra.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.ABl()}ABl(){ra.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.AMi)ra.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.AMi=new Date;var T=new Date;this.f9.PY("BayBridge",
this.NYc).then(Aa=>{const ib=+new Date-+T;Aa.IsSuccess?(ra.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",ib),this.rBl(Aa.Token,this.JNl())):ra.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",ib,Aa.ErrorCode,Aa.ErrorMessage)}).catch(Aa=>{ra.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",
Aa,+new Date-+T)})}}rBl(T,Aa){const ib={};ib.Authorization="Bearer "+T;ib["Authorization-Type"]="AAD";ib.Accept="application/json";ib["DCG-SessionId"]=l.AFrameworkApplication.userSessionId;l.AFrameworkApplication.Ne.xj(Aa,1,null,ib,!1,2,Object(a.a)(this,this.nem,"getStatusSucceeded"),Object(a.a)(this,this.lem,"getStatusFailed"),null,void 0,void 0,void 0,void 0,"39");mc.a("FetchAccountLinkedStatus")}LPl(){const T=Oc.a.instance.getItem("AccountLinkedStatusCache");return T&&T.length?"true"===T.toLowerCase()?
!0:!1:!1}JNl(){return this.NYc+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}lem(){ra.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}nem(T){ra.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");T=ab.a(T.data.ve).state+"";Oc.a.instance.setItem("AccountLinkedStatusCache",T)}}Object(f.a)(xd,"PhoneLinkManager",null,[1864]);class Dd{constructor(){this.W=null}get name(){return"Common.App.PhoneLink"}xc(T){this.W=
T;this.W.register(1864,"Common.App.PhoneLink.IPhoneLinkManager").singleInstance().Rd(()=>new xd(this.W.resolve("Common.App.OAuth.IOAuthManager")))}init(){l.AFrameworkApplication.K.Po(()=>{this.l2a()})}l2a(){this.W.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){L.a.instance.Fc(new Dd)}}Object(f.a)(Dd,"PhoneLinkPackage",null,[1,2]);const ud=T=>{try{return ab.a(T)}catch(Aa){}return null};class He{constructor(T,Aa,ib,Tb,xc,ld){this.uZ=!1;this.Cl=null;this.ZNe=!1;this.ga=T;
this.Xf=Aa;this.Pk=ib;this.V4g=Tb;this.Fa=xc;this.qak=ld}init(T,Aa){Aa&&T.Sa("Common.Interface.IRtcBasicProvider").execute(Object(a.a)(this,this.o3e,"awaitRtc"))}o3e(T){const Aa=T.POc();Aa.continueWith(()=>{this.Cl=Aa.result;this.ZNe&&(this.Cl.bN(2,null,!0),this.ZNe=!1);this.Cl.g3((ib,Tb)=>{2===Tb.type&&this.pc.processAction(n.a.fileNameUpdate,2)});this.Cl.Kta((ib,Tb)=>{2===Tb.newState&&this.pc.processAction(n.a.fileNameUpdate,2)});2===this.Cl.connectionState&&this.pc.processAction(n.a.fileNameUpdate,
2)})}rOa(T){this.uYh(T,!0)}uYh(T,Aa){const ib=this.hPk(T.Wtj),Tb={};Tb[He.UIh]=He.VIh;this.Pdj.xj(ib,2,"",Tb,!1,2,Object(a.a)(this,this.gfc,"onRefreshFilenameSuccess"),Aa?Object(a.a)(this,this.Ctn,"onRefreshFilenameFailureRetry"):Object(a.a)(this,this.kXi,"onRefreshFilenameFailureNoRetry"),T)}gfc(T){this.uZ=!1;const Aa=ud(T.data.ve);T.data.state.onSuccess(Aa,this.V4g.value)}Ctn(T){5!==T.data.status||this.uZ?this.kXi(T):(this.uZ=!0,this.uYh(T.data.state,!1))}kXi(T){T.data.state.onFailure(-1)}bDb(T){this.vYh(T,
!0)}vYh(T,Aa){const ib=this.iPk(),Tb={};Tb[He.UIh]=He.VIh;Tb[He.rqm]=Ta.a.Tj(T.Wdj);Tb[He.pqm]=this.qak.value.v0k;this.Pdj.xj(ib,2,"",Tb,!1,2,Object(a.a)(this,this.r0c,"onRenameFileSuccess"),Aa?Object(a.a)(this,this.Itn,"onRenameFileFailureRetry"):Object(a.a)(this,this.mXi,"onRenameFileFailureNoRetry"),T)}iPk(){return this.Yyh()}hPk(T){let Aa=this.Yyh();return Aa=lc.a.kp(Aa,He.vqm,T?"2":"1")}Yyh(){let T=(this.Fa.value.appSettings.RenameWebServiceBase||"")+He.qqm;T=lc.a.kp(T,He.sqm,Ta.a.Tj(l.AFrameworkApplication.im));
this.vn&&this.vn.xDf&&(T=lc.a.kp(T,He.uqm,"1"));return T}r0c(T){this.uZ=!1;const Aa=ud(T.data.ve);T.data.state.onSuccess(Aa,this.V4g.value);this.dSi()}dSi(){this.Cl?this.Cl.bN(2,null,!0):this.ZNe=!0}Itn(T){5!==T.data.status||this.uZ?this.mXi(T):(this.uZ=!0,this.vYh(T.data.state,!1))}mXi(T){T.data.state.onFailure(-1)}get pc(){return this.ga.value}get Pdj(){return this.Xf.value}get vn(){return this.Pk.value}static get instance(){return He._instance||(He._instance=He.UDb())}static UDb(){return new He(new bb.a(()=>
l.AFrameworkApplication.va),new bb.a(()=>l.AFrameworkApplication.Ne),new bb.a(()=>l.AFrameworkApplication.vn),new bb.a(()=>sa.a.instance.resolve("Postmessage.IHostPostmessenger")),new bb.a(()=>l.AFrameworkApplication.K),new bb.a(()=>sa.a.instance.resolve("Common.IRenameProps")))}}He.UIh="Content-Type";He.VIh="application/json; charset=utf-8";He.qqm="renamehandler.ashx";He.sqm="qs";He.rqm="n";He.uqm="sl";He.pqm="X-CoauthLockId";He.vqm="u";He._instance=null;Object(f.a)(He,"ExecuteRenameFileHandler",
null,[]);class uf{constructor(){this.onFailure=this.onSuccess=null;this.Wtj=!1}}Object(f.a)(uf,"ExecuteRefreshFilenameData",null,[]);class Lh{constructor(){this.onFailure=this.onSuccess=this.Wdj=null}}Object(f.a)(Lh,"ExecuteRenameFileData",null,[]);class Sf{constructor(){this.W=null;this.EAe=He.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}xc(T){this.W=T}init(){l.AFrameworkApplication.K.Po(Object(a.a)(this,this.Px,"onFullAppSettingsReady"))}Px(){l.AFrameworkApplication.QVc()&&(He.instance.init(this.W,
l.AFrameworkApplication.V4c),l.AFrameworkApplication.bDb=Object(a.a)(this,this.bDb,"executeRenameFile"),l.AFrameworkApplication.rOa=Object(a.a)(this,this.rOa,"executeRefreshFilename"),l.AFrameworkApplication.P6c=Object(a.a)(this,this.P6c,"sendFileNameAndLocationUpdateNotification"))}bDb(T,Aa,ib){const Tb=new Lh;Tb.Wdj=T;Tb.onSuccess=Aa;Tb.onFailure=ib;this.EAe.bDb(Tb)}rOa(T,Aa,ib){const Tb=new uf;Tb.onSuccess=T;Tb.onFailure=Aa;Tb.Wtj=ib;this.EAe.rOa(Tb)}P6c(){this.EAe.dSi()}dispose(){}}Object(f.a)(Sf,
"PackageManager",null,[1,2]);var fc=c(175);class yc{constructor(T,Aa,ib){this.Keg=this.Leg=this.Meg=!1;this.afg=!T&&!Aa;this.bfg=!T&&!ib;this.afg||this.bfg||(this.Meg=!T,this.Leg=!Aa,this.Keg=!ib)}}Object(f.a)(yc,"RenameDisabledDialogInfo",null,[]);class Uc extends fc.StandardDialog{constructor(T,Aa,ib,Tb,xc){super();this.bjg=[];this.Bea=new yc(T,Aa,ib);this.pdb=Tb;this.Sab=xc;this.wg="RenameDisabledDialog";this.Ad=0;this.Ee(1,CommonUIStrings.l_DialogClose);this.epo();this.I3n()}epo(){this.Bea.afg?
this.R8c(this.pdb?this.Sab?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.Bea.bfg?this.R8c(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Stk();this.KDc(this.bjg)}R8c(T){Array.add(this.bjg,T)}Stk(){const T=[];this.Bea.Meg||Array.add(T,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.Bea.Leg||Array.add(T,CommonUIStrings.l_RenameFileRenameDisabledPermission);
this.Bea.Keg||Array.add(T,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<T.length&&Array.add(this.bjg,T)}}Object(f.a)(Uc,"ReactRenameDisabledDialogBase",fc.StandardDialog,[]);class zd extends Uc{constructor(T,Aa,ib,Tb,xc){super(T,Aa,ib,Tb,xc)}I3n(){this.ylb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(f.a)(zd,"ReactRenameDisabledDialog",Uc,[]);class ie{static get Yg(){return k.a.vA(ie.Km,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,
CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}ie.Km="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(f.a)(ie,"RenameDisabledDialogHtml",null,[]);class Oe extends k.a{constructor(T,Aa,ib,Tb,xc){super();this.Bea=new yc(T,Aa,ib);this.pdb=Tb;this.Sab=xc;this.wg="RenameDisabledDialog";this.Ad=0;this.Ee(1,CommonUIStrings.l_DialogClose);this.Yg=ie.Yg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.h5("RenameRow")}k9(){if(this.Bea.afg){let T;T=this.pdb?this.Sab?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Oe.R8c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),T)}else this.Bea.bfg?Oe.R8c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Htm()}Htm(){this.Bea.Meg&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.Bea.Leg&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.Bea.Keg&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static R8c(T,Aa,ib){T.style.display="none";Aa.innerText=ib}}Object(f.a)(Oe,"RenameDisabledDialog",k.a,[]);class Ge{constructor(T,Aa){this.Dvb=0;this.ga=T;this.YJa=Aa}initialize(T){if(!this.ga||!this.YJa)return!1;this.Dvb=T;this.Tb();return!0}Tb(){this.ga.qa(n.a.i9e,y.a.frame,Object(a.a)(this,this.i9e,"commitNewDocumentTitle"))}i9e(T,Aa,ib,Tb,xc){if(1===ib)return this.ga.processAction(n.a.renameFile,
1);T=Ta.a.kJ(this.YJa.gz);xc=(0,xc.getNewDocumentTitle)();xc.length>this.Dvb&&(xc=xc.substr(0,this.Dvb));if(32!==this.ga.Qb(n.a.renameFile,2,xc))return this.Vmc(T),8;this.Vmc(xc);return 32}Vmc(T){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(T))}static Rl(){return new Ge(l.AFrameworkApplication.va,l.AFrameworkApplication.zs)}}Object(f.a)(Ge,"ReactRenameUIHandler",null,[1951]);var re=c(214),mf=c(1060),Xe=c(525),qf=c(100),kf=c(160),$f=c(27);class xf{constructor(T,Aa,ib,Tb,xc,ld,Sd,df,
De,Ff,Wg,Vh){this._initialized=!1;this._element=null;this.Dvb=0;this.MRe=this.dEe=!1;this.ga=T;this.Wja=Aa;this.ae=ib;this.hs=Tb;this.YJa=xc;this.zeh=ld;this.fud=Sd;this.Qve=df;this.lab=De;this.$1g=Ff;this.ui=Wg;this.JFe=Vh}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(T,Aa,ib){if(!(this.ga&&this.YJa&&this.zeh&&this.fud&&this.Qve&&Aa)||0>=T)return!1;this._element=Aa;this._element.title=ib;this._element.setAttribute($f.a.qh,$f.a.j3);this._element.setAttribute("Unselectable",
"on");this.Dvb=T;this.UB();return this._initialized=!0}UB(){this.Wja&&(this.Wja.nb(W.a.blur,this._element,Object(a.a)(this,this.onBlur,"onBlur")),this.Wja.nb(W.a.paste,this._element,Object(a.a)(this,this.i0c,"onPaste")));this.ae.nb(W.a.ai,this._element,Object(a.a)(this,this.onKeyDown,"onKeyDown"));this.hs.nb(W.a.pointerDown,this._element,Object(a.a)(this,this.ZC,"onPointerDown"));this.hs.nb(W.a.WM,this._element,Object(a.a)(this,this.Axa,"onPointerUp"))}onBlur(){this.isActive&&!this.dEe&&(this.$1g||
this.Qve(this._element),this.YGh(),this.pdf(!1));return this.dEe=!1}i0c(){ra.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(T){return this.isActive?this.Qqn(T):this.Rqn(T)}Qqn(T){let Aa=!1;switch(T.Hb.keyCode){case Sys.UI.Key.enter:this.YGh();this.pdf(this.ui||this.JFe);Aa=!0;break;case Sys.UI.Key.tab:this.$1g&&this.Qve(this._element);break;case Sys.UI.Key.esc:this.X7f(),this.pdf(this.ui||this.JFe),Aa=!0}return Aa}Rqn(T){let Aa=!1;switch(T.Hb.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.sCj(this.JFe),
this.isActive&&this.fud(this._element),Aa=!0}return Aa}ZC(){this.isActive||(this.sCj(!1),this.isActive&&(this._element.focus(),this.fud(this._element),this.MRe=!0));return!1}Axa(){return this.MRe?(this.fud(this._element),this.MRe=!1,!0):!1}Jbc(){return 32===this.ga.processAction(n.a.renameFile,1)}YGh(){const T=Ta.a.kJ(this.YJa.gz);let Aa=this._element.innerText.trim();Aa.length>this.Dvb&&(Aa=Aa.substr(0,this.Dvb));Aa!==T&&""!==Aa?32!==this.ga.Qb(n.a.renameFile,2,Aa)?this.X7f():this.Vmc(Aa):this.X7f()}X7f(){this.Vmc(Ta.a.kJ(this.YJa.gz))}Vmc(T){this._initialized&&
(this._element.innerText=T,this.zeh())}sCj(T){this.Jbc()?this.isActive||(T&&(this.dEe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute($f.a.qh,$f.a.wvh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,re.CuiHelper.eVh),this.lab&&this.lab.execute(Aa=>{Aa.Q6i(!0)}),T&&this._element.focus(),ra.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.processAction(n.a.jkc,
2)}pdf(T){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute($f.a.qh,$f.a.j3);Sys.UI.DomElement.removeCssClass(this._element,re.CuiHelper.eVh);this.lab&&this.lab.execute(Aa=>{Aa.Q6i(!1)});T&&(this._element.blur(),this._element.focus())}static vya(){mf.a.vya(l.AFrameworkApplication.isRtl)}static Rl(){return new xf(l.AFrameworkApplication.va,Xe.a.instance,qf.KeyInputManager.instance,kf.a.instance,l.AFrameworkApplication.zs,xf.vya,
pa.a.fdo,pa.a.NEh,sa.a.instance.Sa("Common.App.Header.HeaderEventSource"),wa.a.n4,wa.a.ti,wa.a.lj)}}Object(f.a)(xf,"RenameUIHandler",null,[1951]);class Qg{static get instance(){return l.AFrameworkApplication.ta.Nb.xJ?Qg._instance||(Qg._instance=Ge.Rl()):Qg._instance||(Qg._instance=xf.Rl())}}Qg._instance=null;Object(f.a)(Qg,"RenameUIHandlerFactory",null,[]);var zb=c(149);class Yb{constructor(){this.QQf=this.rhn=this.Wgl=null}}Object(f.a)(Yb,"RenameMruEntryProperties",null,[]);var Tc=c(161),Id=c(85),
Xc=c(1557),Le;(function(T){T[T.unknown=-1]="unknown";T[T.success=0]="success";T[T.renameInvalidFileName=1]="renameInvalidFileName";T[T.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";T[T.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";T[T.permissionDenied=4]="permissionDenied";T[T.serverCommunicationFailure=5]="serverCommunicationFailure";T[T.fileNameTooLong=6]="fileNameTooLong"})(Le||(Le={}));Object(f.b)("CommonOperationResult",Le);class cf{constructor(T,Aa,ib,Tb,xc,ld,
Sd,df,De,Ff,Wg,Vh){this.s2g=T;this.ga=Aa;this.Pk=ib;this.LL=Tb;this.mvb=xc;this.Lok=ld;this.pdb=Sd;this.tkh=df;this.Ahk=De;this.Sab=Ff;this.Fa=Wg;this.zhk=Vh}Tb(){l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.xJ||this.pc.qa(n.a.D$b,y.a.frame,Object(a.a)(this,this.D$b,"initializeRenameUIHandler"));this.pc.qa(n.a.jkc,y.a.frame,Object(a.a)(this,this.jkc,"showRenameDisabledDialog"));this.pc.qa(n.a.renameFile,y.a.frame,Object(a.a)(this,this.renameFile,"renameFile"));this.pc.eb(n.a.fileNameUpdate,
y.a.frame,Object(a.a)(this,this.RUn,"refreshFilename"),64);this.pc.eb(n.a.j5d,y.a.frame,Object(a.a)(this,this.j5d,"moveToFolderCompleteByHost"),64);this.pc.qa(n.a.VJb,y.a.frame,Object(a.a)(this,this.VJb,"moveToFolder"));(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||l.AFrameworkApplication.ta&&(l.AFrameworkApplication.K.$("PostMessageEmbedded")||l.AFrameworkApplication.K.$("IsJsApi"))&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&l.AFrameworkApplication.MO().execute(T=>{T.Dv(Id.a.aQi);T.TB(Id.a.aQi,cf.kRn);T.Dv(Id.a.ekf);T.TB(Id.a.ekf,cf.iRn)})}Jbc(){return 0===this.zhk.Dfi()?32:8}y1o(){return this.vn?this.pdb?this.vn.fUh:this.vn.ohb:!0}D$b(){return Qg.instance.initialize(l.AFrameworkApplication.bMd,l.AFrameworkApplication.XTh,l.AFrameworkApplication.acj||CommonUIStrings.l_RenameFileTooltip)?32:8}jkc(){const T=this.y1o(),Aa=this.Lok();ra.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.mvb,Aa,T,this.pdb);l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.mF&&l.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new zd(this.mvb,!Aa,!T,this.pdb,this.Sab()):new Oe(this.mvb,!Aa,!T,this.pdb,this.Sab());return 32}renameFile(T,Aa,ib,Tb,xc){if(1===ib)return this.Jbc();if(!l.AFrameworkApplication.bDb)return 8;if(8===this.Jbc())return this.pc.processAction(n.a.jkc,2),8;ra.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");l.AFrameworkApplication.bDb(xc,Object(a.a)(this,
this.r0c,"onRenameFileSuccess"),Object(a.a)(this,this.Htn,"onRenameFileFailure"));l.AFrameworkApplication.$bj=!0;return 32}r0c(T,Aa){T?0!==T.OperationResult?this.Nli(T.OperationResult):(this.Xeo(Aa,T.NewName),this.rUo(T,Object(a.a)(l.AFrameworkApplication.ta.Nb,l.AFrameworkApplication.ta.Nb.cHj,"updateOpenInClientDocumentUrl")),l.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&l.AFrameworkApplication.ta.updateCommandUI(),this.Ahk.SEj()):this.Nli(5)}Xeo(T,Aa){const ib={};ib[Tc.a.dCl]=
Aa;T.sendMessage(Id.a.ekf,ib)}rUo(T,Aa){this.FUo(T);l.AFrameworkApplication.$Id=T.DirectInvokeDavUrl;Aa=Aa(T.EditDocInClientUrl);const ib=new Yb;ib.QQf=this.LL.gz;ib.Wgl=Aa;ib.rhn=T.EditDocInClientUrl;this.pc.Qb(n.a.bcj,2,ib)}Nli(T){switch(T){case 1:T=new fc.StandardDialog,T.Ad=0,T.cV(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.Mej()}}FUo(T){this.LL.gz=cf.eEk(this.LL.gz,T.NewName);T.BreadcrumbFolderName&&(this.LL.breadcrumbFolderName=T.BreadcrumbFolderName);
T.BreadcrumbFolderUrl&&(this.LL.breadcrumbFolderUrl=T.BreadcrumbFolderUrl);this.tkh(T.NewName)}Htn(T){const Aa=new fc.StandardDialog;Aa.Ad=0;switch(T){case 1:ra.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");Aa.eja(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:ra.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");Aa.eja(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:ra.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:T}),Aa.eja(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}l.AFrameworkApplication.MO().execute(ib=>{ib.sendMessage(Id.a.cCl,{["FailureMessage"]:Le[T]})});this.Mej()}RUn(T,Aa,ib){if(1===ib)return this.Jbc();if(!l.AFrameworkApplication.rOa)return 8;l.AFrameworkApplication.rOa(Object(a.a)(this,this.gfc,"onRefreshFilenameSuccess"),Object(a.a)(this,this.g8d,"onRefreshFilenameFailure"),
!1);return 32}VJb(T,Aa,ib,Tb,xc){if(1===ib)return l.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===ib){const ld={};T=l.AFrameworkApplication.ykb;Aa=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");T=(!T||T&&Aa)&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);ld[Tc.a.ZFo]=T;xc&&xc.MoveButtonClickedTime&&(ld[Tc.a.Efn]=xc.MoveButtonClickedTime.getTime());l.AFrameworkApplication.MO().execute(Sd=>{Sd.sendMessage(Id.a.VJb,
ld)});if(xc&&xc.MoveButtonClickedTime){if(T=zb.a.iG())xc=(new Date).getTime()-xc.MoveButtonClickedTime.getTime(),T.set("MovePostDuration",xc.toString());Ma.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",T)}return 32}return 8}j5d(T,Aa,ib,Tb,xc){if(1===ib)return l.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.Jbc():8;if(2===ib){if(!l.AFrameworkApplication.P6c)return Ma.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!xc)return Ma.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(xc[Tc.a.jJm])if(xc[Tc.a.KIj])if(T=xc[Tc.a.KIj].toLowerCase(),Aa=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),ib=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Aa&&l.AFrameworkApplication.ykb&&ib){const ld={};ld[Tc.a.jhc]="1";ld[Tc.a.documentUrl]=T;ld[Tc.a.reason]=Xc.a.k9f;Ma.Health.instance.recordKpiSuccess("MoveToFolder",null);
l.AFrameworkApplication.MO().execute(Sd=>{Sd.sendMessage(Id.a.xCb,ld)})}else if(!l.AFrameworkApplication.ykb&&ib)Ma.Health.instance.recordKpiSuccess("MoveToFolder",null),pa.a.om(T,pa.a.kra(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return Ma.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else Ma.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else l.AFrameworkApplication.rOa(Object(a.a)(this,this.gfc,"onRefreshFilenameSuccess"),
Object(a.a)(this,this.g8d,"onRefreshFilenameFailure"),!1),l.AFrameworkApplication.P6c(),Ma.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}Gvo(T,Aa){return T&&Aa?T!==this.LL.breadcrumbFolderName||Aa!==this.LL.breadcrumbFolderUrl:!1}gfc(T,Aa){T&&(T.NewName!==Ta.a.kJ(this.LL.gz)||this.Gvo(T.BreadcrumbFolderName,T.BreadcrumbFolderUrl))&&this.r0c(T,Aa)}g8d(){}Mej(){this.tkh(Ta.a.kJ(this.LL.gz))}get pc(){return this.ga.value}get vn(){return this.Pk.value}static get instance(){return cf._instance||
(cf._instance=cf.UDb())}static UDb(){return new cf(l.AFrameworkApplication.QVc,new bb.a(()=>l.AFrameworkApplication.va),new bb.a(()=>l.AFrameworkApplication.vn),l.AFrameworkApplication.zs,l.AFrameworkApplication.bpa,()=>l.AFrameworkApplication.gog,l.AFrameworkApplication.V4c,Object(a.a)(Qg.instance,Qg.instance.Vmc,"updateTitle"),sa.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>l.AFrameworkApplication.nv,l.AFrameworkApplication.K,sa.a.instance.resolve("Common.IRenameProps"))}static eEk(T,
Aa){T=Ta.a.Nga(T);return Aa+T}static kRn(T){const Aa=T.Values[Tc.a.TOm];ra.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",Aa);Aa?l.AFrameworkApplication.va.Qb(n.a.j5d,2,T.Values):Ma.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static iRn(T){l.AFrameworkApplication.va.Qb(n.a.renameFile,2,T.Values.NewName)}}cf._instance=null;Object(f.a)(cf,"RenameActor",null,[]);var Ig=c(186),Ji=c(1384),Th=c(564),Ah=c(397);class Pm{constructor(T,
Aa){this.ga=T;this.Trc=Aa}Tb(){this.ga.qa(n.a.Weg,y.a.frame,Object(a.a)(this,this.zyo,"showRenameDialogAction"))}zyo(T,Aa,ib){T=32;if(1===ib)return Ah.SessionStatusManager.instance.Gj||l.AFrameworkApplication.Coa?8:32;2===ib&&(32!==this.ga.processAction(n.a.renameFile,1)?(this.ga.processAction(n.a.jkc,2),Ig.a.instance.Yb(Ji.a.kna,{["Reason"]:Th.a.Z2n}),T=8):32===this.ga.processAction(n.a.kkc,1)?this.ga.processAction(n.a.kkc,2):this.Trc.value.create().tTa());return T}}Object(f.a)(Pm,"RenameDialogActor",
null,[1937]);class zf{constructor(T,Aa,ib){this.dialog=null;this.ga=T;this.LL=Aa;this.U$a=ib}Aam(){const T={};T.nameInputProps={["type"]:"AppInputProps",["id"]:zf.r5b,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Ta.a.kJ(this.LL.gz),["maxLength"]:this.U$a};return T}tTa(){const T={["id"]:"RenameDialog",["bodyControls"]:this.Aam()};this.dialog=new k.a(!1,!1,!0);this.dialog.Ad=1;this.dialog.wg="RenameDialog";this.dialog.Wh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.p6f,"renameDialogHandler"),
T)}p6f(T,Aa){if(Aa&&1===T){if(Aa[zf.r5b]&&(T=Ta.a.kJ(this.LL.gz),Aa=(Aa[zf.r5b]||"").trim(),Aa!==T&&""!==Aa)){this.ga.Qb(n.a.renameFile,2,Aa);return}Ig.a.instance.Yb(Ji.a.m5b,{["Reason"]:Th.a.VZh})}}}zf.r5b="txtDocumentName";Object(f.a)(zf,"ReactRenameDialog",null,[1955]);class lg{static get Yg(){return k.a.vA(lg.Km,CommonUIStrings.l_RenameDialogLabel)}}lg.Km="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(f.a)(lg,"RenameDialogHtml",null,[]);class md extends k.a{constructor(T,Aa,ib){super();this.ga=T;this.LL=Aa;this.U$a=ib;this.wg="RenameDialog";this.Yg=lg.Yg}tTa(){var T={["txtDocumentName"]:Ta.a.kJ(this.LL.gz)};this.Wh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.p6f,"renameDialogHandler"),T);T=document.getElementById(md.r5b);0<this.U$a&&(T.maxLength=this.U$a);T.focus()}p6f(T,Aa){if(1===T&&(T=Ta.a.kJ(this.LL.gz),Aa=(Aa[md.r5b]||"").trim(),Aa!==T&&""!==Aa)){this.ga.Qb(n.a.renameFile,
2,Aa);return}Ig.a.instance.Yb(Ji.a.m5b,{["Reason"]:Th.a.VZh})}}md.r5b="txtDocumentName";Object(f.a)(md,"RenameDialog",k.a,[1955]);class td{constructor(T){this.YJa=null;this.U$a=0;this.ga=T;this._initialized=!1}initialize(T,Aa){this.YJa=T;this.U$a=Aa;this._initialized=!0}create(){return this._initialized?l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.mF&&l.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new zf(this.ga,this.YJa,this.U$a):new md(this.ga,this.YJa,this.U$a):null}}Object(f.a)(td,
"RenameDialogFactory",null,[1936]);var Bd=c(171),nl=c(108);class ni{constructor(T,Aa){this.ga=T;this.Ub=Aa}Tb(){this.ga.qa(n.a.kkc,y.a.frame,Object(a.a)(this,this.Ayo,"showRenameFlyoutAction"))}FTk(){return G.d("setDocumentTitleFlyoutOpened")&&l.AFrameworkApplication.ta.Nb.xJ}Ayo(T,Aa,ib){if(1===ib)return this.FTk()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}Ivk(){ni.lTm&&l.AFrameworkApplication.NH&&nl.a.instance.Vb(new Qc.a(5,1,5E3,()=>{32===this.ga.processAction(n.a.kkc,
1)&&this.Ub&&this.Ub.currentScope.name===Bd.AFrame.Pn&&(mc.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.processAction(n.a.kkc,2))}))}static get lTm(){ni.lnd&&null!=ni.lnd||(l.AFrameworkApplication.ue("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),ni.lnd=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return ni.lnd}}ni.lnd=null;Object(f.a)(ni,"RenameFlyoutActor",
null,[1935]);class si{constructor(T,Aa,ib,Tb,xc){this.v0k=null;this.Pk=xc;this.t2g=ib;this.s2g=Tb;this.Nok=T;this.Sab=Aa}get vn(){return this.Pk.value}Dfi(){if(!this.s2g())return 5;if(this.Sab())return 1;if(this.vn){if(this.t2g&&!this.vn.fUh)return 3;if(!this.t2g&&!this.vn.ohb)return 4}return this.Nok()?0:2}}Object(f.a)(si,"RenameProps",null,[1932]);class zi{constructor(T,Aa,ib,Tb,xc,ld){this.Js=!1;this.HIe=new Qb.a;this.AUb=Aa;this.Tz=ib;this.zTb=Tb;this.Fa=xc;this.vla=ld}enable(){this.Js||(this.SEj(),
this.xgg(),this.Js=!0)}generateKey(T,Aa,ib){return String.format("{0}/{1}/{2}",ib,T,Aa)}l1l(){const T=Ta.a.kJ(this.AUb().gz);return this.generateKey(this.AUb().breadcrumbFolderName,this.AUb().breadcrumbFolderUrl,T)}m1l(T,Aa,ib){return T&&Aa?this.generateKey(T,Aa,ib):ib}Xnl(T,Aa,ib){return T&&T!==this.AUb().breadcrumbFolderName||Aa&&Aa!==this.AUb().breadcrumbFolderUrl?!0:ib!==Ta.a.kJ(this.AUb().gz)}SEj(){const T=this.l1l();this.HIe.Z(T,new Date)}lZf(T){this.Qto(T)&&this.Pmh(T)}Qto(T){const Aa=this.zTb();
return Aa?this.vla&&this.vla.zo||!Aa.xDf||!l.AFrameworkApplication.rOa?(this.qwj(T),this.Js=!1):!0:!1}kYi(T,Aa,ib,Tb){const xc=this.Xnl(T,Aa,ib);T=this.m1l(T,Aa,ib);Aa=this.HIe.Dc(T).returnValue;xc&&!Aa&&(this.Pli(Tb),ra.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.YKf));xc||this.HIe.Z(T,this.Tz())}}Object(f.a)(zi,"ARenamedFileChecker",null,[1891]);class yl extends zi{constructor(T,Aa,ib,Tb,xc,ld,Sd,df){super(T,Aa,ib,Tb,xc,ld);this.zK=xc;this.yhk=Sd;this.GDe=df}get YKf(){return"RenamedFileCheckerUsingSettingsRefresh"}xgg(){this.zK.eEc(Object(a.a)(this,
this.lmi,"handleSettingsRefresh"))}lmi(T,Aa){Aa&&Aa.dKb&&Aa.bTi&&(Aa.CQa("BreadcrumbDocName")||Aa.CQa("BreadcrumbFolderName")||Aa.CQa("BreadcrumbFolderUrl")||Aa.CQa("DirectInvokeDAVUrl")||Aa.CQa("EditDocInClientUrl"))&&(ra.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.YKf),this.lZf(Aa))}qwj(){this.zK.g6f(Object(a.a)(this,this.lmi,"handleSettingsRefresh"))}Pmh(T){if(T&&T.dKb){const Aa=T.dKb;this.kYi(Aa.jb("BreadcrumbFolderName"),Aa.jb("BreadcrumbFolderUrl"),Aa.jb("BreadcrumbDocName"),
T)}}Pli(T){const Aa={OperationResult:0,classId:1};T=T.dKb;Aa.BreadcrumbFolderName=T.jb("BreadcrumbFolderName");Aa.BreadcrumbFolderUrl=T.jb("BreadcrumbFolderUrl");Aa.DirectInvokeDavUrl=T.jb("DirectInvokeDAVUrl");Aa.EditDocInClientUrl=T.jb("EditDocInClientUrl");T=T.jb("BreadcrumbDocName");Aa.NewName=l.AFrameworkApplication.wJd?T:Ta.a.kJ(T);this.GDe.execute(ib=>{this.IFm(Aa,ib)})}IFm(T,Aa){this.yhk().r0c(T,Aa)}}Object(f.a)(yl,"RenamedFileCheckerUsingSettingsRefresh",zi,[]);class Dl extends zi{constructor(T,
Aa,ib,Tb,xc,ld,Sd,df,De,Ff){super(T,ib,Tb,xc,ld,De);this.Yzc=this.kl=null;this.Nfk=Aa;this.ga=Sd;this.Gb=df;Ff&&Ff.execute(Wg=>{this.hZn(Wg)})}get YKf(){return"RenamedFileCheckerUsingTask"}hZn(T){this.kl=T;this.kl.gZa(Object(a.a)(this,this.HX,"handleVisibilityChange"))}HX(T,Aa){!this.Js||0!==Aa.newState&&1!==Aa.newState||this.Yzc||(this.xgg(),this.lZf(this.Yzc))}xgg(){this.Yzc=new Qc.a(3,2,this.Nfk(),Object(a.a)(this,this.lZf,"performRenameFileCheckTick"),89);this.Gb.Vb(this.Yzc)}qwj(T){this.Gb.Xe(T)}Pmh(T){this.kl&&
2===this.kl.sC?this.X_n(T):l.AFrameworkApplication.rOa(Object(a.a)(this,this.gfc,"onRefreshFilenameSuccess"),Object(a.a)(this,this.g8d,"onRefreshFilenameFailure"),!0)}X_n(T){this.Gb.Xe(T);this.Yzc=null}gfc(T){T&&this.kYi(T.BreadcrumbFolderName,T.BreadcrumbFolderUrl,T.NewName,null)}Pli(){this.ga.processAction(n.a.fileNameUpdate,2)}g8d(){}}Object(f.a)(Dl,"RenamedFileCheckerUsingTask",zi,[]);var ji=c(66);class ej{constructor(){this.Fa=this.W=null}get name(){return"Common.App.RenameFile"}xc(T){this.W=
T;this.Fa=l.AFrameworkApplication.K;this.W.register(Pm,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Rd(()=>new Pm(l.AFrameworkApplication.va,this.W.Ue("Common.App.Rename.IRenameDialogFactory"))).singleInstance();this.W.register(td,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Rd(()=>new td(l.AFrameworkApplication.va)).singleInstance();this.W.register(1891,"Common.App.Rename.IRenamedFileChecker").Rd(()=>this.Udl()).singleInstance();
this.W.register(ni,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Rd(()=>new ni(l.AFrameworkApplication.va,ji.FocusManager.instance())).singleInstance()}Udl(){if(this.Fa.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const T=this.W.Na("Common.IRefreshableAppSettings");if(T&&T.tBi)return new yl(()=>T.mc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>l.AFrameworkApplication.zs,()=>new Date,()=>l.AFrameworkApplication.vn,T,this.W.Na("Common.ISessionStatus"),()=>
cf.instance,this.W.Sa("Postmessage.IHostPostmessenger"))}return new Dl(()=>this.Fa.mc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Fa.mc("RenamedFileCheckerPingIntervalInMs",12E4),()=>l.AFrameworkApplication.zs,()=>new Date,()=>l.AFrameworkApplication.vn,l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.nc,this.W.Na("Common.ISessionStatus"),this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Fa.Po(Object(a.a)(this,this.Px,"onFullAppSettingsReady"))}Px(){const T=
l.AFrameworkApplication.ta.Nb.xJ;l.AFrameworkApplication.QVc()&&Qg.instance.initialize(l.AFrameworkApplication.bMd,T?null:l.AFrameworkApplication.XTh,T?null:l.AFrameworkApplication.acj||CommonUIStrings.l_RenameFileTooltip)&&(this.W.register(si,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Rd(()=>new si(()=>l.AFrameworkApplication.gog,()=>l.AFrameworkApplication.nv,l.AFrameworkApplication.V4c,l.AFrameworkApplication.QVc,new bb.a(()=>l.AFrameworkApplication.vn))).singleInstance(),cf.instance.Tb(),
this.Fa.$("RenameDialogIsEnabled")&&(this.W.resolve("Common.App.Rename.RenameDialogFactory").initialize(l.AFrameworkApplication.zs,l.AFrameworkApplication.bMd),this.W.resolve("Common.App.Rename.IRenameDialogActor").Tb()),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Tb(),l.AFrameworkApplication.V4c&&this.W.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Ivk())}dispose(){}}Object(f.a)(ej,"PackageManager",null,[1,2]);class fj{static get Yg(){return k.a.vA(fj.Km,
CommonUIStrings.l_SaveACopyFileName)}}fj.Km="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(f.a)(fj,"FileNameDialogHtml",null,[]);class um extends k.a{constructor(T,Aa,ib,Tb){super();this.Djd=this.uKa=null;
this.ga=T;this.ura=Aa;this.RCc=ib;this.Ee(1,CommonUIStrings.l_SaveButtonLabel);this.Yg=fj.Yg;this.wg="FileNameDialog-SaveACopy";this.Tm=Tb}IDa(T,Aa,ib){this.Djd=T;this.uKa=ib;T={["txtFileName"]:Ta.a.kJ(l.AFrameworkApplication.zs.gz),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,Aa)};this.Wh(CommonUIStrings.l_SaveToOneDrive,Object(a.a)(this,this.aMd,"fileNameDialogHandler"),T);ra.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}aMd(T,
Aa){1!==T?ra.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(T=Aa.txtFileName.trim(),ra.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),Aa=Ta.a.Nga(l.AFrameworkApplication.fileName),T&&""!==T&&""!==Aa&&(T+=Aa),this.RCc.XHa(this.Djd,this.uKa,T,this.Tm))}}Object(f.a)(um,"FileNameDialog",k.a,[1925]);class Gg{constructor(T,Aa,ib){this.ga=T;this.ura=Aa;this.RCc=ib}create(T){return new um(this.ga,this.ura,this.RCc,T)}}Object(f.a)(Gg,
"FileNameDialogFactory",null,[1897]);class dg extends fc.StandardDialog{constructor(T){super();this.Ad=1;this.Ee(1,CommonUIStrings.l_RetryButtonLabel);this.Ee(0,CommonUIStrings.l_DialogClose);this.ga=T}rO(T){ra.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",T);this.nx(T,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(a.a)(this,this.m8f,"retryDialogHandler"))}m8f(T){1===T?(ra.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.processAction(n.a.oic,
2)):ra.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(f.a)(dg,"RetryDialog",fc.StandardDialog,[1896]);var Ri=c(1204);class am{constructor(T,Aa,ib,Tb){this.ptd=null;this.Pik=T;this.Fa=ib;this.c$g=Aa;this.n5g=new z.a;this.ge=Tb}icc(){return this.Fa.$("SaveToCloudStorageUIIsEnabled")}khb(){return n.a.t9f}ECd(){$b.a.fde(Object(a.a)(this,this.nhj,"saveToCloudActionDispatcher"));$b.a.eLc([new Ri.a(n.a.t9f,y.a.frame,0)],this.c$g.t8b())}Tb(){const T=this.c$g.t8b();T?(T.VZ(()=>{this.n5g.Bg(!0)}),
this.ECd()):ra.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}j8i(){ra.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}nhj(T,Aa,ib,Tb,xc){return Aa.contextId!==y.a.frame||T!==this.khb()?2:this.icc()?1===ib?Ah.SessionStatusManager.instance.Gj||l.AFrameworkApplication.Coa?8:32:2===ib?(this.j8i(),xc&&xc.FileDownloadUrl&&ra.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.ge&&
(this.ptd=this.ge.Zf("DialogShown","SaveToOneDriveReponseTime")),this.n5g.task.continueWith(()=>{this.ptd&&(this.ptd.stop(),this.ptd=null);this.Pik.start(xc)}),32):8:8}}Object(f.a)(am,"SaveToCloudStorageActor",null,[1902]);class gj extends am{constructor(T,Aa,ib,Tb){super(T,Aa,ib,Tb);this.qek=Aa}icc(){return this.Fa.$("SaveACopyBrsIsEnabled")}khb(){return n.a.oic}ECd(){$b.a.fde(Object(a.a)(this,this.nhj,"saveToCloudActionDispatcher"));$b.a.eLc([new Ri.a(n.a.oic,y.a.frame,0)],this.qek.t8b())}j8i(){l.AFrameworkApplication.ue("CreateCopy_cf;CreateCopy_tf");
ra.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(f.a)(gj,"SaveACopyActor",am,[]);class Tg{}Tg.default=0;Object(f.a)(Tg,"SaveToCloudErrorCodes",null,[]);class Si{constructor(T,Aa,ib,Tb,xc,ld){this.Tm=null;this.Hkk=T;this.eta=Aa;this.RCc=ib;this.Fa=Tb;this.MSb=xc;this.fH=ld}start(T){this.Tm=T;if("SharePointOnlineConsumer"===this.Fa.jb("FileSource")){const Aa=sa.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(Aa){Aa.start(null,
T);return}}this.eta.FTc?(ra.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.DSk()):(ra.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.Lyo())}Lyo(){this.Hkk.create().IDa()}xp(){this.fH().rO(Tg.default)}DSk(){try{ra.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let T={["client_id"]:this.Fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.MSb||2===this.MSb)T={["client_id"]:this.Fa.appSettings.UploadToSkyDriveClientId};
WL.init(T);ra.ULS.sendTraceTag(6590562,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb&&1===l.AFrameworkApplication.ta.Nb.Tl?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(a.a)(this,this.onSuccess,"onSuccess"),Object(a.a)(this,this.onFailure,"onFailure"))}catch(T){ra.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",T,T.stack),this.xp()}}onSuccess(T){ra.ULS.sendTraceTag(6590592,
216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");T&&T.data&&T.data.folders&&this.RCc.XHa(T.data.folders[0].id,T.data.folders[0].urls.viewInBrowser,null,this.Tm)}onFailure(T){if(T&&T.error){if("user_canceled"===T.error.code){ra.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}ra.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",T.error.code,T.error.message)}else ra.ULS.sendTraceTag(6590595,
216,50,"File Dialog returned with no response");this.xp()}}Object(f.a)(Si,"SaveToCloudManager",null,[1904]);class kj extends Si{constructor(T,Aa,ib,Tb,xc,ld,Sd){super(Aa,ib,Tb,xc,ld,Sd);this.t3j=T}onSuccess(T){T&&T.data&&T.data.folders?(ra.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.t3j.create(this.Tm).IDa(T.data.folders[0].id,T.data.folders[0].name,T.data.folders[0].urls.viewInBrowser)):(ra.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),
this.xp())}onFailure(T){T&&T.error&&"user_canceled"===T.error.code&&ra.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(T)}xp(){ra.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.xp()}}Object(f.a)(kj,"SaveACopyManager",Si,[]);var Mh=c(196);class Qh{constructor(T,Aa,ib,Tb,xc){this.uKa=this.Dk=this.Spc=null;this.uZ=!1;this.Tm=this.MYa=null;this.bXe=T;this.DXa=Aa;this.fH=ib;this.Ri=Tb;this.ge=xc}Y6a(){this.Ri&&1===
this.Ri.state||(this.Dk=this.DXa(),this.Dk.message=CommonUIStrings.l_CommentProgressTooltip,this.Dk.Ad=5,this.Dk.Et=!1,this.Dk.tL(CommonUIStrings.l_DefaultDialogTitle,null,null))}Tma(){this.Dk&&(this.Dk.close(),this.Dk=null)}p5(){1!==l.AFrameworkApplication.ta.state&&this.fH().rO(Tg.default)}QMb(){ra.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");pa.a.om(this.uKa,pa.a.kra(3),void 0,"UploadToCloudManager.RedirectToFolder")}PMb(T){let Aa=!1,ib=!1;l.AFrameworkApplication.K&&(Aa=l.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),
ib=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ra.ULS.sendTraceTag(6654163,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb&&1===l.AFrameworkApplication.ta.Nb.Tl?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",T,Aa);if(Aa&&ib){ra.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Tb={};Tb[Tc.a.jhc]="1";Tb[Tc.a.documentUrl]=T;l.AFrameworkApplication.MO().execute(xc=>{xc.sendMessage(Id.a.xCb,
Tb)})}else pa.a.om(T,pa.a.kra(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}XHa(T,Aa,ib=null,Tb=null){ra.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.ge&&(this.MYa=this.ge.Zf("DialogShown","SaveToOneDriveUploadTime"));this.Y6a();this.uKa=Aa;this.Spc=this.bXe.create(T,ib,Tb);this.Tm=Tb;this.tga()}tga(){ra.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.Spc.execute(Object(a.a)(this,this.Aun,"onSaveToCloudUploadFinished"),Object(a.a)(this,this.zun,"onSaveToCloudUploadFailed"))}Aun(T){this.Tma();
this.uZ=!1;if(T&&T.data&&T.data.ve){var Aa;if(({av:Aa}=ab.d(T.data.ve)).returnValue)if(T=Aa,T.StatusCode!==Mh.a.My&&T.StatusCode!==Mh.a.VIc)ra.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.p5();else{ra.ULS.sendTraceTag(6590603,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb&&1===l.AFrameworkApplication.ta.Nb.Tl?15:50,"UploadToCloudManager upload success.");try{T.NewDocumentUrl&&""!==T.NewDocumentUrl?this.PMb(T.NewDocumentUrl):
this.QMb()}catch(ib){ra.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",ib.toString())}this.I1c()}else ra.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:rb.a.Aad(T.data.ve)}),this.p5()}else ra.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.p5()}zun(T){5!==T.data.status&&12!==T.data.status||this.uZ?(ra.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",T.data.status),
this.Tma(),this.p5(),this.I1c()):(ra.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.uZ=!0,this.tga())}I1c(){this.MYa&&(this.MYa.stop(),this.MYa=null)}}Object(f.a)(Qh,"UploadToCloudManager",null,[1898]);class Qk extends Qh{constructor(T,Aa,ib,Tb,xc,ld){super(Aa,ib,Tb,xc,ld);this.ga=T}gGf(){return!!this.Tm&&!!this.Tm.SaveEntryPoint&&"VersionHistory"===this.Tm.SaveEntryPoint.toString()}p5(){ra.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.gGf()&&
this.ga.Qb(n.a.pee,2,{["FailureReason"]:"Unknown"});super.p5()}QMb(){ra.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.gGf()&&this.ga.processAction(n.a.p5c,2);super.QMb()}PMb(T){ra.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",T);this.gGf()&&this.ga.processAction(n.a.p5c,2);super.PMb(T)}tga(){this.Tm&&"true"===this.Tm.SkipSaveToHost?super.tga():32!==this.ga.processAction(n.a.RNb,1)?(ra.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),
super.tga()):this.ga.Qb(n.a.RNb,2,[()=>{ra.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Qh.prototype.tga.call(this)},()=>{ra.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.p5()}])}}Object(f.a)(Qk,"SaveACopyUploadToCloudManager",Qh,[]);var Hj=c(744),tl=c(1199);class Qj{constructor(){this.W=null}get name(){return"Common.App.SaveACopy"}init(){l.AFrameworkApplication.K.Po(Object(a.a)(this,this.Px,
"onFullAppSettingsReady"))}Px(){l.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&this.W.resolve("Common.App.SaveACopy.SaveACopyActor").Tb()}dispose(){}xc(T){this.W=T;this.W.register(Qk,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Rd(()=>new Qk(l.AFrameworkApplication.va,T.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new tl.a).create(),()=>new dg(l.AFrameworkApplication.va),l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Hq)).singleInstance();this.W.register(Gg,
"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Rd(()=>new Gg(l.AFrameworkApplication.va,l.AFrameworkApplication.ta.Nb,T.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).singleInstance();this.W.register(gj,"Common.App.SaveACopy.SaveACopyActor").Rd(()=>new gj(T.resolve("Common.App.SaveACopy.SaveACopyManager"),T.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.ta.Hq)).singleInstance();
this.W.register(kj,"Common.App.SaveACopy.SaveACopyManager").Rd(()=>new kj(T.resolve("Common.App.SaveACopy.FileNameDialogFactory"),T.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Hj.a.instance,T.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.c8,()=>new dg(l.AFrameworkApplication.va))).singleInstance()}static main(){L.a.instance.Fc(new Qj)}}Object(f.a)(Qj,"PackageManager",null,[1,2]);var zl=c(50);class Rh extends fc.StandardDialog{constructor(T,
Aa){super();this.QXb=!1;this.EN=null;this.ga=T;this.ctc=Aa;this.NHa=!1}rO(T,Aa,ib){this.EN=Aa;this.QXb=ib;ra.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",T,ib);T=this.m7e(T);0===T?(this.Ad=6,this.Ee(0,CommonUIStrings.l_DialogClose)):(this.Ad=0,this.Ee(1,CommonUIStrings.l_DialogClose));0===T&&ra.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.nx(zl.a.Pao,this.bVl(T),this.aVl(T,Aa),Object(a.a)(this,this.m8f,"retryDialogHandler"),!0)}m8f(T){1===
T?(ra.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.EN?this.ga.Qb(n.a.p6c,2,[this.EN,this.QXb]):this.ga.processAction(n.a.p6c,2)):ra.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}m7e(T){return 0>T||6<T?(ra.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",T),0):T}aVl(T,Aa){T=this.m7e(T);return this.ctc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,Aa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][T]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,Aa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][T]}bVl(T){T=this.m7e(T);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,
CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][T]}}Object(f.a)(Rh,"ErrorRetryDialog",fc.StandardDialog,[1931]);class Dk{constructor(T,Aa){this.Fa=T;this.ga=Aa;this.ctc=this.Fa.$("SaveToHostWithExtraCharsInFileName")}create(){return new Rh(this.ga,this.ctc)}}Object(f.a)(Dk,"ErrorRetryDialogFactory",null,[1912]);class ok extends k.a{constructor(T,Aa,ib,Tb,xc,ld,Sd=null){super();
this.r6=null;this.ga=Aa;this.ura=Tb;this.NYa=ld;this.Fa=T;this.fH=xc;this.Ri=ib;this.ctc=this.Fa.$("SaveToHostWithExtraCharsInFileName");this.Tm=Sd;this.Ee(1,CommonUIStrings.l_SaveButtonLabel)}get ta(){return this.Ri}BSh(T,Aa){this.oqa(1,!!T&&T!==Aa);this.r6=document.getElementById(ok.UZh);U.a.addHandler(this.r6,"change",Object(a.a)(this,this.h7d,"onFileNameChange"));U.a.addHandler(this.r6,"input",Object(a.a)(this,this.h7d,"onFileNameChange"));this.r6.focus()}TZh(T){return this.ctc?(new RegExp("["+
this.NXh('\\/:*?"<>|')+"]")).test(T):(new RegExp("["+this.NXh('\\/:*?"<>|#{}%~&')+"]")).test(T)}NXh(T){return T.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}Lwf(){const T=Ta.a.kJ(l.AFrameworkApplication.zs.gz);this.oqa(1,!!this.r6&&""!==this.r6.value&&this.r6.value!==T)}h7d(){this.r6&&window.setTimeout(()=>{this.Lwf()},0)}aMd(T,Aa){if(1!==T)ra.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{T=Aa[ok.UZh];Aa=ok.n_i in Aa?Aa[ok.n_i]:!1;ra.ULS.sendTraceTag(23881883,
216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Ta.a.J8i(T),Aa);const ib=Ta.a.Nga(l.AFrameworkApplication.fileName);(T=T?T.trim():null)&&""!==T&&""!==ib||1===this.ta.state?this.TZh(T)?this.fH.create().rO(1,T,Aa):this.NYa.XHa(T+ib,Aa,this.Tm):this.fH.create().rO(2,T,Aa)}}dispose(){this.r6&&(U.a.removeHandler(this.r6,"change",Object(a.a)(this,this.h7d,"onFileNameChange")),U.a.removeHandler(this.r6,"input",Object(a.a)(this,this.h7d,"onFileNameChange")),this.r6=
null);super.dispose()}}ok.UZh="txtFileName";ok.n_i="chkOverwrite";Object(f.a)(ok,"FileNameDialogBase",k.a,[]);class Rk{static get Yg(){return k.a.vA(Rk.Km,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}Rk.Km="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(f.a)(Rk,"FileNameDialogHtml",null,[]);class Gm extends ok{constructor(T,Aa,ib,Tb,xc,ld){super(T,Aa,ib,Tb,xc,ld);this.Yg=Rk.Yg;this.wg="FileNameDialog-SaveAsToHost"}IDa(T,Aa){const ib=Ta.a.kJ(l.AFrameworkApplication.zs.gz);Aa={["txtFileName"]:T||ib,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:Aa};this.Wh(CommonUIStrings.L_SaveAs,Object(a.a)(this,this.aMd,"fileNameDialogHandler"),Aa);this.BSh(T,ib)}}Object(f.a)(Gm,"FileNameDialog",ok,[1930]);class bm{constructor(T,Aa,
ib,Tb,xc,ld){this.ga=Aa;this.Fa=T;this.ura=Tb;this.NYa=ld;this.fH=xc;this.Ri=ib}create(){return new Gm(this.Fa,this.ga,this.Ri,this.ura,this.fH,this.NYa)}}Object(f.a)(bm,"FileNameDialogFactory",null,[1911]);class cm{constructor(T,Aa,ib){this.NYa=ib;this.$Ae=Aa;this.Fa=T}Tb(){2===l.AFrameworkApplication.ta.Nb.Tl?l.AFrameworkApplication.va.eb(n.a.p6c,y.a.frame,Object(a.a)(this,this.Wgj,"saveAsToHostActionDispatcher"),4):l.AFrameworkApplication.va.qa(n.a.p6c,y.a.frame,Object(a.a)(this,this.Wgj,"saveAsToHostActionDispatcher"))}Wgj(T,
Aa,ib,Tb,xc){return Aa.contextId!==y.a.frame||T!==n.a.p6c?2:this.Fa.$("SaveAsToHostBrsIsEnabled")?1===ib?Ah.SessionStatusManager.instance.Gj||l.AFrameworkApplication.Coa?8:32:2===ib?(ra.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),T=this.$Ae.create(),xc&&Object.getType(xc)===Array&&2===xc.length?T.IDa(xc[0],!!xc[1]):T.IDa(null,!1),32):8:8}}Object(f.a)(cm,"SaveAsToHostActor",null,[]);class qg{constructor(T,Aa,ib,Tb,xc,ld,Sd,df){this.Dk=null;this.QXb=this.uZ=
!1;this.MYa=this.Tm=this.EN=null;this.Fa=Aa;this.Ila=this.Fa.appSettings.SaveAsToHostWebServiceBase;this.X_g=Tb;this.DXa=xc;this.Xf=ib;this.fH=ld;this.ge=df;this.Ri=Sd;this.ga=T;this.lWa=Aa.jb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}Y6a(){1!==this.Ri.state&&(this.Dk=this.DXa(),this.Dk.message=CommonUIStrings.l_CommentProgressTooltip,this.Dk.Ad=5,this.Dk.Et=!1,this.Dk.tL(CommonUIStrings.l_DefaultDialogTitle,null,null))}p5(T=0){1!==this.Ri.state&&this.fH.create().rO(T,Ta.a.kJ(this.EN),
this.QXb)}QMb(){const T=this.Fa.appSettings.BreadcrumbFolderUrl;ra.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");pa.a.om(T,pa.a.kra(3),void 0,"UploadToHostManager.RedirectToFolder")}PMb(T){let Aa=!1,ib=!1;this.Fa&&(Aa=this.Fa.$("SaveACopyIsEnabledForUiHost"),ib=this.Fa.$("UiHostSupportsDocRebootFeatures"));ra.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",T,Aa,ib);if(Aa&&ib){ra.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Tb={};Tb[Tc.a.jhc]="1";Tb[Tc.a.documentUrl]=T;Tb[Tc.a.reason]=Xc.a.k9f;l.AFrameworkApplication.MO().execute(xc=>{xc.sendMessage(Id.a.xCb,Tb)})}else Aa&&!ib&&l.AFrameworkApplication.vU?pa.a.om(T,pa.a.kra(4),void 0,"UploadToHostManager.RedirectToEditUrl"):pa.a.om(T,pa.a.kra(3),void 0,"UploadToHostManager.RedirectToEditUrl")}XHa(T,Aa,ib=null){ra.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.X_g&&
!this.X_g()&&this.Xf&&(this.ge&&(this.MYa=this.ge.Zf("DialogShown","SaveAsToHostUploadTime")),this.Y6a(),this.QXb=Aa,this.EN=T,(this.Tm=ib)&&"true"===this.Tm.SkipSaveToHost?this.mLd():this.tga())}tga(){32!==this.ga.processAction(n.a.RNb,1)?(ra.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.mLd()):this.ga.Qb(n.a.RNb,2,[()=>{ra.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.mLd()},(T,Aa)=>
{ra.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.p5(Aa)}])}Hwn(T){this.Tma();this.uZ=!1;if(T&&T.data&&T.data.ve)if(({av:Aa}=ab.d(T.data.ve)).returnValue)if(T=Aa,T.StatusCode!==Mh.a.My&&T.StatusCode!==Mh.a.VIc){ra.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var Aa={};Aa.FailureReason=T.StatusCode.toString();Aa.ExtraInfo=T.ExtraInfo;this.ESa(Aa);this.p5(parseInt(T.ExtraInfo))}else{ra.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.j7f();try{T.NewDocumentUrl&&""!==T.NewDocumentUrl?this.PMb(T.NewDocumentUrl):this.QMb()}catch(ib){ra.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",ib.toString())}this.I1c()}else ra.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:rb.a.Aad(T.data.ve)}),this.ESa({["FailureReason"]:"Failed to deserialize response"}),this.p5();else ra.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.ESa({["FailureReason"]:"null response"}),this.p5()}Gwn(T){5!==T.data.status&&12!==T.data.status||this.uZ?(ra.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:T.data.status,["HttpStatus"]:T.data.Qe}),this.ESa({["FailureReason"]:T.data.Qe.toString()}),this.Tma(),this.p5(),this.I1c()):(ra.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.uZ=!0,this.Tm&&"true"===this.Tm.SkipSaveToHost?this.mLd():this.tga())}Tma(){this.Dk&&
(this.Dk.close(),this.Dk=null)}I1c(){this.MYa&&(this.MYa.stop(),this.MYa=null)}j7f(){this.Tm&&"VersionHistory"===this.Tm.SaveEntryPoint&&this.ga.processAction(n.a.p5c,2)}ESa(T){this.Tm&&"VersionHistory"===this.Tm.SaveEntryPoint&&this.ga.Qb(n.a.pee,2,T)}mLd(){let T=this.Ila+this.lWa;T=lc.a.kp(T,"qs",Ta.a.Tj(l.AFrameworkApplication.im));T=lc.a.kp(T,"n",Ta.a.Tj((new Date).getTime().toString()));T=lc.a.kp(T,"ov",Ta.a.Tj(this.QXb.toString()));T=lc.a.kp(T,"fn",Ta.a.Tj(this.EN));this.Tm&&this.Tm.FileDownloadUrl&&
(T=lc.a.kp(T,"furl",Ta.a.Tj(this.Tm.FileDownloadUrl)));this.Xf.xj(T,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(a.a)(this,this.Hwn,"onUploadFinished"),Object(a.a)(this,this.Gwn,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(f.a)(qg,"UploadToHostManager",null,[1910]);class Yk{constructor(){this.W=null}get name(){return"Common.App.SaveAsToHost"}init(){l.AFrameworkApplication.K.Po(Object(a.a)(this,this.Px,"onFullAppSettingsReady"))}Px(){l.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&
this.W.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Tb()}xc(T){this.W=T;this.W.register(Dk,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Rd(()=>new Dk(l.AFrameworkApplication.K,l.AFrameworkApplication.va)).singleInstance();this.W.register(qg,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Rd(()=>new qg(l.AFrameworkApplication.va,l.AFrameworkApplication.K,l.AFrameworkApplication.Ne,
()=>l.AFrameworkApplication.Nk,()=>(new tl.a).create(),T.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Hq)).singleInstance();this.W.register(bm,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Rd(()=>new bm(l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Nb,T.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),T.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance();
this.W.register(cm,"Common.App.SaveAsToHost.SaveAsToHostActor").Rd(()=>new cm(l.AFrameworkApplication.K,T.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),T.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance()}dispose(){}static main(){L.a.instance.Fc(new Yk)}}Object(f.a)(Yk,"SaveAsToHostPackage",null,[1,2]);class Wl extends fc.StandardDialog{constructor(){super();this.Ad=0;this.Ee(1,CommonUIStrings.l_DialogClose)}rO(T){this.nx(T,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(f.a)(Wl,"ErrorDialog",fc.StandardDialog,[1896]);var kg=c(200);class Hd extends fc.StandardDialog{constructor(T,Aa,ib){super();this.ga=T;this.eta=Aa;this.ura=ib;this.N$=!1;this.Ad=1;this.$U(1);this.Ee(1,CommonUIStrings.l_SignIn);this.Ee(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}IDa(){this.eta.Vph(Object(a.a)(this,this.hYi,"onSignIn"));this.Ou(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(a.a)(this,this.FBm,"inputHandler"))}FBm(T){0===
T?(ra.ULS.sendTraceTag(6590598,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb&&1===l.AFrameworkApplication.ta.Nb.Tl?15:50,"User dismissed SignIn Dialog."),this.hide()):this.z$d()}UVk(){let T="2";if(this.ura)switch(this.ura.Tl){case 3:T="0";break;case 2:T="3";break;case 1:T="1"}return T}hide(){this.eta.K1n(Object(a.a)(this,this.hYi,"onSignIn"));super.hide()}z$d(){var T=l.AFrameworkApplication.K.$("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";T=new kg.QueryStringBuilder(T);
T.ze("prompt","1");T.ze("cbcxt",this.UVk());l.AFrameworkApplication.nfa(T);pa.a.om(T.toString(),"LoginWindow",void 0,"SignInDialog")}hYi(){this.zha&&this.hide();ra.ULS.sendTraceTag(7143885,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb&&1===l.AFrameworkApplication.ta.Nb.Tl?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ga.processAction(n.a.t9f,2)}}Object(f.a)(Hd,"SignInDialog",fc.StandardDialog,[1927]);class Ad{constructor(T,Aa,ib){this.ga=T;this.eta=
Aa;this.ura=ib}create(){return new Hd(this.ga,this.eta,this.ura)}}Object(f.a)(Ad,"SignInDialogFactory",null,[1903]);class wf{constructor(T,Aa,ib,Tb,xc,ld,Sd){this.Ila=T;this.EN=Aa;this.hVb=ib;this.Djd=Tb;this.iPe=xc;this.lWa=ld;this.Tm=Sd}execute(T,Aa){if(!l.AFrameworkApplication.Nk&&l.AFrameworkApplication.Ne){var ib=this.Ila+this.lWa;ib=lc.a.kp(ib,"fo",Ta.a.Tj(this.Djd));ib=lc.a.kp(ib,"fn",Ta.a.Tj(this.EN));ib=lc.a.kp(ib,"qs",Ta.a.Tj(this.iPe));ib=lc.a.kp(ib,"n",Ta.a.Tj((new Date).getTime().toString()));
this.Tm&&this.Tm.FileDownloadUrl&&(ib=lc.a.kp(ib,"furl",Ta.a.Tj(this.Tm.FileDownloadUrl)));this.hVb&&(ib=lc.a.kp(ib,"fnn",Ta.a.Tj(this.hVb)));l.AFrameworkApplication.Ne.xj(ib,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,T,Aa,null)}}}Object(f.a)(wf,"SkyDriveUploadCaller",null,[1926]);class eg{constructor(T){this.Fa=T;this.Syb=T.appSettings.SkyDriveUploadWebServiceBase;this.EN=T.appSettings.FileName;this.lWa=T.jb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(T,Aa,ib){return new wf(this.Syb,
this.EN,Aa,T,l.AFrameworkApplication.im,this.lWa,ib)}}Object(f.a)(eg,"SkydriveUploadCallerFactory",null,[1899]);class tg{constructor(){this.W=null}get name(){return"Common.App.SaveToCloudStorage"}init(){l.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&this.W.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Tb()}dispose(){}xc(T){this.W=T;this.W.register(Ad,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Rd(()=>
new Ad(l.AFrameworkApplication.va,Hj.a.instance,l.AFrameworkApplication.ta.Nb)).singleInstance();this.W.register(eg,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Rd(()=>new eg(l.AFrameworkApplication.K)).singleInstance();this.W.register(am,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Rd(()=>new am(T.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),T.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
l.AFrameworkApplication.K,l.AFrameworkApplication.ta.Hq)).singleInstance();this.W.register(Qh,"Common.App.SaveToCloudStorage.UploadToCloudManager").Rd(()=>new Qh(T.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new tl.a).create(),()=>new Wl,l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Hq)).singleInstance();this.W.register(Si,"Common.App.SaveToCloudStorage.SaveToCloudManager").Rd(()=>new Si(T.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Hj.a.instance,
T.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.c8,()=>new Wl)).singleInstance()}static main(){L.a.instance.Fc(new tg)}}Object(f.a)(tg,"PackageManager",null,[1,2]);class ce extends fc.StandardDialog{constructor(){super();this.Ad=0;this.Ee(1,CommonUIStrings.l_DialogClose)}rO(T,Aa){this.XSh(T,Aa,zl.a.Rao)}XSh(T,Aa,ib){ra.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",ib);this.nx(ib,T,Aa,null)}Qff(T,Aa){ra.ULS.sendTraceTag(25235986,
216,15,"Show warning dialog of Picker related issue.");this.nx(zl.a.Tao,T,Aa,null,!0)}}Object(f.a)(ce,"ErrorDialog",fc.StandardDialog,[940]);class jd{static get Yg(){return k.a.vA(jd.Km,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}jd.Km="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(f.a)(jd,"FileNameDialogHtml",null,[]);var gk=c(79);class Ch extends ok{constructor(T,Aa,ib,Tb,xc,ld,Sd,df){super(T,Aa,ib,Tb,xc,ld,df);this.yab=this.qRe=this.gQ=null;this.xQk=CommonUIStrings.l_SaveToAnotherFolder;this.Yg=jd.Yg;this.wg="FileNameDialog-SaveToSharePoint";this.HAc=Sd;this.Dek=df}IDa(T){const Aa=Ta.a.kJ(l.AFrameworkApplication.zs.gz),ib=l.AFrameworkApplication.breadcrumbFolderName,Tb=l.AFrameworkApplication.breadcrumbBrandName,xc={["txtFileName"]:T||Aa};let ld=CommonUIStrings.L_SaveAs;
2===l.AFrameworkApplication.ta.Nb.Tl&&(ld=CommonUIStrings.L_SaveACopy);this.Wh(ld,Object(a.a)(this,this.aMd,"fileNameDialogHandler"),xc);this.BSh(T,Aa);this.Hef.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");l.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.gQ=document.getElementById("anotherFolder"),T=document.getElementById("folderLocation"),this.qRe=$f.a.cth(T,this.gQ,"anotherFolderDescribedBy"),this.gQ.className=
"WACButton WACDialogButtonNormal",T=!1,ib&&ib.length?(this.Lnh(this.gQ,this.qRe,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Tb,ib)),T=this.Jrk(Tb,ib)):this.Lnh(this.gQ,this.qRe,CommonUIStrings.l_CurrentOnlineFolder),this.Atk(this.gQ),this.Lrk(this.gQ),T?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.gQ,"SaveToAnotherLocationTwo"),ra.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.gQ,
"SaveToAnotherLocationOne"),U.a.addHandler(this.gQ,W.a.click,Object(a.a)(this,this.ZVf,"onSaveToAnotherLocationClick")),U.a.addHandler(this.gQ,W.a.ai,Object(a.a)(this,this.OXi,"onSaveToAnotherLocationKeyDown")))}Jrk(T,Aa){let ib;ib=!1;const Tb=document.getElementById("currentLocation");Tb.innerText="";const xc=this.jci(Tb,T),ld=this.jci(Tb,Aa);let Sd=255,df=255;255<xc+ld&&(Sd=Math.max(238,408-xc),df=Math.max(170,408-ld),ib=!0);this.Mvk(Tb,T,df,Aa,Sd);return ib}jci(T,Aa){const ib=document.createElement("div");
ib.innerText=Aa;ib.style.visibility="hidden";T.appendChild(ib);Aa=ib.clientWidth;T.removeChild(ib);return Aa}Mvk(T,Aa,ib,Tb,xc){Aa&&(this.Knh(T,Aa,ib),this.Evk(T));Tb&&this.Knh(T,Tb,xc)}Knh(T,Aa,ib){const Tb=document.createElement("div");Tb.innerText=Aa;Tb.title=Aa;Tb.className="SaveToAnotherFolderBreadcrumb";Tb.style.maxWidth=ib.toString()+"px";T.appendChild(Tb)}Evk(T){const Aa=document.createElement("span");Aa.id="FolderSeparator";const ib=document.createElementNS("http://www.w3.org/2000/svg","svg");
ib.setAttribute("class","SeparatorCaret");const Tb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Tb.setAttribute("points","1 4 1 11 5 7.5");ib.appendChild(Tb);Aa.appendChild(ib);T.appendChild(Aa)}Lnh(T,Aa,ib){ib=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,ib);Aa&&(Aa.innerText=ib);T.tabIndex=0;T.setAttribute($f.a.qh,$f.a.j3)}Lrk(T){const Aa=document.createElement("span");Aa.id="anotherFolderText";Aa.innerText=this.xQk;Aa.className="AnotherFolderTextSpan";
T.appendChild(Aa)}Atk(T){const Aa=document.createElement("span");Aa.className="cui-img-cont-float cui-img-16by16 ";this.yab=document.createElementNS("http://www.w3.org/2000/svg","svg");this.yab.setAttribute("class","FolderIconSVG");const ib=document.createElementNS("http://www.w3.org/2000/svg","path");ib.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.yab.appendChild(ib);Aa.appendChild(this.yab);T.appendChild(Aa)}OXi(T){!T||
T.keyCode!==gk.a.Fs&&T.keyCode!==gk.a.Yoe||this.ZVf(T)}ZVf(){if(this.r6){const T=Ta.a.Nga(l.AFrameworkApplication.fileName);let Aa=this.r6.value;this.hide();Aa&&""!==Aa&&""!==T||1===this.ta.state?(""!==T&&(Aa+=T),this.TZh(Aa)?this.fH.create().rO(1,Aa,!1):this.HAc.start(Aa,this.Dek)):this.fH.create().rO(2,Aa,!1)}}zVk(T){this.gQ&&this.yab&&(T?(this.gQ.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.gQ,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.yab,"DisabledFolderIconSVG")):(this.gQ.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.gQ,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.yab,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.gQ,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.yab,"DisabledFolderIconSVG"))))}Lwf(){super.Lwf();this.zVk(!!this.r6&&""!==this.r6.value)}dispose(){this.gQ&&(U.a.removeHandler(this.gQ,W.a.click,Object(a.a)(this,this.ZVf,"onSaveToAnotherLocationClick")),U.a.removeHandler(this.gQ,W.a.ai,Object(a.a)(this,this.OXi,
"onSaveToAnotherLocationKeyDown")),this.gQ=null);super.dispose()}}Object(f.a)(Ch,"FileNameDialog",ok,[1236]);var ug=c(498),ul=c(354),th=c(1553),fg=c(1680);class ag{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(f.a)(ag,"SaveAsDialogInput",null,[]);class Ek{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(f.a)(Ek,"SaveLocation",null,[]);var ze=c(115);class Kf{constructor(T,Aa,ib,Tb,xc,ld,Sd,df,De){this.cJe=
null;this.EN="";this.HAc=T;this.fH=Aa;this.Tm=De;this.NYa=ib;this.Ri=xc;this.LL=Tb;this.Eyb=Sd;this.uZb=df;ld&&(this.cJe=new bb.a(()=>new th.a(ld.value,null)))}TTl(){const T=new ug.a(ul.a.Fh());T.Z("type","currentHost");return Object.assign(new Ek,{folderName:this.LL.breadcrumbFolderName,friendlyPath:this.LL.breadcrumbBrandName,properties:T})}iTm(T){return!!T&&"ClassicMru"===T.type&&!!T.service_info&&!!T.service_info.service_id&&-1!==T.service_info.service_id.indexOf("SHAREPOINT")}pdm(){if(!this.cJe||
!this.Eyb)return null;var T=this.cJe.value.ek("SaveAsToSharePointDialog",!1);if(!T||3!==T.state||!T.iQi)return null;T=T.iQi;const Aa=new jb.a;let ib=0,Tb=0;for(var xc=0;xc<T.length;xc++){var ld=T[xc];if(!this.iTm(ld))continue;ib++;if(!ld.sharepoint_info)continue;const Sd=ld.url,df=ld.sharepoint_info.site_url,De=ld.title;ld=fg.b(ld,l.AFrameworkApplication.isRtl);if(!(Sd&&df&&De&&ld))continue;Tb++;const Ff=new ug.a(ul.a.Fh());Ff.Z("type","SharePoint");Ff.Z("siteUrl",df);Ff.Z("folderUrl",Sd);Tb++;Aa.add(Object.assign(new Ek,
{folderName:De,friendlyPath:ld,properties:Ff}))}xc=new Map;xc.set("NumPlaces",T.length.toString());xc.set("NumSharepointPlaces",ib.toString());xc.set("placesWithMetadata",Tb.toString());Ma.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",xc);0<ib&&(Tb?.5>1*Tb/ib&&Ma.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Ma.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return Aa}$Ul(){const T=
new jb.a;T.add(this.TTl());const Aa=this.pdm();Aa&&T.addRange(Aa);return Object.assign(new ag,{enableMoreLocations:!l.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.EN,extension:Ta.a.Nga(this.LL.gz),saveLocations:T.toArray(),scenario:"SaveToSharePoint"})}Gpf(){const T=Object(a.a)(this,this.$Ul,"getDialogInput"),Aa={};Aa.inputPropsCallback=T;return Aa}IDa(T){this.EN=T;this.EN||(this.EN=String.format(CommonUIStrings.l_SaveACopy_Filename,Ta.a.kJ(this.LL.gz)));T={["id"]:"SaveAsDialog",
["bodyControls"]:this.Gpf()};let Aa=CommonUIStrings.L_SaveAs;2===this.Ri.Nb.Tl&&(Aa=CommonUIStrings.L_SaveACopy);const ib=new k.a(!1,!1,!0);ib.Ad=1;ib.wg="SaveAsDialog";ib.Ee(1,CommonUIStrings.l_SaveButtonLabel);ib.Wh(Aa,Object(a.a)(this,this.Nao,"saveAsDialogHandler"),T)}Wxo(T,Aa){T&&""!==T&&""!==Aa||1===this.Ri.state?this.hTm()?this.s1m(T,Aa):(""!==Aa&&(T+=Aa),this.HAc.start(T,this.Tm)):(ra.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.fH.create().rO(2,
T,!1))}s1m(T,Aa){Ma.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const ib=this.uZb.Saf(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.uZb.DPd(ib).then(Tb=>{if(Tb&&0<Tb.length){const xc=Tb[0][Tc.a.HDn];Tb=Tb[0][Tc.a.IDn];if(""!==xc&&""!==Tb)this.Eyb.XHa(Tb,T+Aa,xc,this.Tm),Ma.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.fH.create().rO(0,T,!1);const ld=zb.a.iG();ld&&(ld.set("SiteUrlAvailable",
""===xc?"false":"true"),ld.set("FolderUrlAvailable",""===Tb?"false":"true"));Ma.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new ze.a,{extendedProperties:ld}))}}else this.fH.create().rO(0,T,!1),Ma.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Tb=>{"Canceled"===Tb?((Tb=zb.a.iG())&&Tb.set("IsCanceled","true"),Ma.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new ze.a,{extendedProperties:Tb}))):
Ma.Health.instance.recordKpiFailure("SaveACopySFP",Tb,!1,!1,null)})}hTm(){return this.uZb?this.uZb.qGf():(ra.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}Nao(T,Aa){if(Aa&&1===T){T=Aa.fileName;var ib=Ta.a.Nga(this.LL.gz);Aa.moreLocationsSelected&&this.Wxo(T,ib);if(Aa.locationCallback){var Tb=Aa.locationCallback();Tb?Tb.properties&&"currentHost"===Tb.properties.J("type")?this.NYa.XHa(T+ib,!1,this.Tm):Tb.properties&&"SharePoint"===Tb.properties.J("type")?(Aa=Tb.properties.J("siteUrl"),
Tb=Tb.properties.J("folderUrl"),this.Eyb.XHa(Tb,T+ib,Aa,this.Tm)):ra.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):ra.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else ra.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(f.a)(Kf,"ReactSaveAsDialog",null,[1236]);class rj{constructor(T,Aa,ib,Tb,xc,ld,Sd,df=null,De=null,Ff=null){this.ga=Aa;this.Fa=T;this.ura=Tb;this.NYa=ld;this.fH=xc;this.Ri=ib;this.xeh=Sd;this.jak=df;this.Eyb=De;this.uZb=
Ff}create(T){return this.Ri&&this.Ri.Nb.mF?new Kf(this.xeh,this.fH,this.NYa,l.AFrameworkApplication.zs,this.Ri,this.jak,this.Eyb,this.uZb,T):new Ch(this.Fa,this.ga,this.Ri,this.ura,this.fH,this.NYa,this.xeh,T)}}Object(f.a)(rj,"FileNameDialogFactory",null,[1209]);class Ij{constructor(T,Aa,ib,Tb){this.Gw=this.vyc=null;this.wtb=T;this.Ri=ib;this.Mfk=Tb;this.jWa=new bb.a(()=>new th.a(Aa.value,Object(a.a)(this,this.WEb,"getMoreInfoEventReceived")))}get fZi(){this.vyc||(this.jWa.value.ek("Save As",!0),
this.Gw&&this.Gw.Sca&&this.Gw.Sca.length&&(this.vyc=this.w6l(this.Gw.Sca)));return this.vyc}start(T){if(!this.fZi)if(l.AFrameworkApplication.breadcrumbFolderUrl&&l.AFrameworkApplication.breadcrumbFolderUrl.length)this.vyc=l.AFrameworkApplication.breadcrumbFolderUrl;else return ra.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Gw),!1;const Aa=this.Mfk();Aa.jyo();const ib=
Aa.g9l();if(!ib)return ra.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.wtb.start((Tb,xc)=>{Aa.hide();T(Tb,xc)},()=>{this.vKb(Aa)},ib,this.vyc);return!0}vKb(T){T.hide();ra.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}w6l(T){T=T.toLowerCase();T.endsWith("/")||(T+="/");const Aa=T.indexOf("/documents/");return-1!==Aa?T.substring(0,Aa+1)+"_layouts/15/onedrive.aspx":""}WEb(T){this.Gw||3!==T.state||(this.Gw=T)}}Object(f.a)(Ij,"OneDriveFilePickerHelper",
null,[1208]);class ai extends k.a{constructor(){super()}jyo(){this.qrc="FilePickerDialog";this.Yg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.wg="PickerDialog-MsoSp";this.showDialog("",null)}g9l(){return document.getElementById("FilePickerDiv")}vL(){}Xca(){}}Object(f.a)(ai,"PickerDialog",k.a,[941]);class gg{constructor(T,Aa,ib,Tb,xc,ld,Sd){this.Fa=T;this.$Ae=ib;this.ga=Aa;this.HAc=Tb;this.wtb=xc;this.uyc=ld;this.jZj=Sd}Tb(){const T=this.wtb.t8b();T?wa.a.zoa||this.Fa.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.eb(n.a.ric,y.a.frame,Object(a.a)(this,this.qhj,"saveToSharePointActionDispatcher"),64):(T.T3a.continueWith(Aa=>{Aa.Ai&&this.wtb.PUf(Aa)}),this.ECd()):ra.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}ECd(){$b.a.fde(Object(a.a)(this,this.qhj,"saveToSharePointActionDispatcher"));$b.a.eLc([new Ri.a(n.a.ric,y.a.frame,0)],this.wtb.t8b())}get icc(){return this.Fa.$("SaveToAnotherFolderBrsIsEnabled")}get qBh(){return this.Fa.$("UserCanWriteRelative")}qhj(T,
Aa,ib,Tb,xc){return Aa.contextId!==y.a.frame||T!==n.a.ric?2:this.icc&&(this.uyc.fZi||this.qBh)?1===ib?Ah.SessionStatusManager.instance.Gj||l.AFrameworkApplication.Coa?8:this.jZj()?32:8:2===ib?(ra.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(xc&&xc.SaveEntryPoint&&"VersionHistory"===xc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.qBh?(ra.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.$Ae.create(xc).IDa(null)):(ra.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.HAc.start(null,xc)),32):8:8}}Object(f.a)(gg,"SaveToSharePointActor",null,[]);class ol{constructor(T,Aa,ib,Tb){this.Tm=this.V7g=null;this.Eyb=T;this.fH=Aa;this.uyc=ib;this.Ri=Tb}start(T,Aa){ra.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.V7g=T;this.Tm=Aa;this.uyc.start((ib,Tb)=>{this.processResponse(ib,Tb)})||this.Reg()}processResponse(T,Aa){if(T)this.onSuccess(Aa);else this.onFailure(Aa)}Reg(){1!==
this.Ri.state&&this.fH().Qff(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(T){ra.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(T&&T.data&&T.data.value&&T.data.value.length&&T.data.value[0].sharePoint){const Aa=T.data.value[0].sharePoint.url;T=T.data.value[0].sharePoint.listUrl;let ib=null;if(Aa&&(ib=T?this.Cdm(T):this.Bdm(Aa))){this.Eyb.XHa(Aa,this.V7g,ib,this.Tm);return}ra.ULS.sendTraceTag(25180164,
216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!Aa,!ib)}ra.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.Reg()}Bdm(T){T.endsWith("/")||(T+="/");let Aa=0;for(let ib=0;ib<T.length;ib++)if("/"===T.charAt(ib)&&5===++Aa)return T.substr(0,ib);return null}Cdm(T){T.endsWith("/")&&(T=T.substring(0,T.length-1));const Aa=T.lastIndexOf("/");return-1!==Aa?T.substring(0,Aa):null}onFailure(T){ra.ULS.sendTraceTag(23881888,216,
10,"Picker failure Callback called.");T&&T.error?ra.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",T.error.errorCode,T.error.message):ra.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.Reg()}}Object(f.a)(ol,"SaveToSharePointManager",null,[1890]);class oi{constructor(T,Aa,ib,Tb,xc,ld,Sd,df){this.Ila=T;this.EN=Aa;this.hVb=Tb;this.iPe=ld;this.uKa=ib;this.Vkk=xc;this.lWa=Sd;this.Tm=df}execute(T,Aa){if(!l.AFrameworkApplication.Nk&&
l.AFrameworkApplication.Ne){var ib=this.Ila+this.lWa;ib=lc.a.kp(ib,"fu",Ta.a.Tj(this.uKa));ib=lc.a.kp(ib,"su",Ta.a.Tj(this.Vkk));ib=lc.a.kp(ib,"fn",Ta.a.Tj(this.EN));ib=lc.a.kp(ib,"n",Ta.a.Tj((new Date).getTime().toString()));this.Tm&&this.Tm.FileDownloadUrl&&(ib=lc.a.kp(ib,"furl",Ta.a.Tj(this.Tm.FileDownloadUrl)));ib=ib+"&"+this.iPe;this.hVb&&this.hVb.length?ib=lc.a.kp(ib,"fnn",Ta.a.Tj(this.hVb)):ra.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");ra.ULS.sendTraceTag(23881920,216,
50,"Trying send SharePointSaveAsHandler.ashx request.");l.AFrameworkApplication.Ne.xj(ib,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,T,Aa,null,void 0,void 0,void 0,void 0,"9")}}}Object(f.a)(oi,"SharePointSaveAsCaller",null,[1922]);class Hm{constructor(T){this.Syb=T.appSettings.SaveAsToHostWebServiceBase;this.EN=T.appSettings.FileName;this.lWa=T.jb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(T,Aa,ib,Tb){return new oi(this.Syb,this.EN,T,Aa,ib,l.AFrameworkApplication.im,
this.lWa,Tb)}}Object(f.a)(Hm,"SharePointUploadCallerFactory",null,[1889]);var An=c(1380);class vg{constructor(T,Aa,ib,Tb,xc){this.Dk=this.Spc=null;this.fte=!1;this.kRe=this.uKa=null;this.bXe=Aa;this.DXa=ib;this.fH=Tb;this.Ri=xc;this.ga=T}XHa(T,Aa,ib,Tb){this.fte=!1;ra.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.Y6a();this.uKa=T;Tb&&Tb.SaveEntryPoint&&(this.kRe=Tb.SaveEntryPoint);this.Spc=this.bXe.create(T,Aa,ib,Tb);Tb&&"true"===Tb.SkipSaveToHost?
this.tga():this.pIl()}pIl(){const T=()=>{ra.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.tga()};32!==this.ga.Qb(n.a.RNb,2,[()=>{ra.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.tga()},T])&&T()}tga(){ra.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.Spc.execute(Object(a.a)(this,this.Cun,"onSaveToSharePointUploadFinished"),Object(a.a)(this,this.Bun,
"onSaveToSharePointUploadFailed"))}Cun(T){if(T&&T.data&&T.data.ve){var Aa;if(({av:Aa}=ab.d(T.data.ve)).returnValue)if(Aa.StatusCode!==Mh.a.My&&Aa.StatusCode!==Mh.a.VIc)ra.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",T.data.status,Aa.StatusCode),Aa.StatusCode!==Mh.a.o7f&&this.FTh(T.data.status)||(this.ESa(Aa.StatusCode.toString()),this.dxo(Aa.StatusCode));else{ra.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");
this.j7f();try{Aa.NewDocumentUrl?this.PMb(Aa.NewDocumentUrl):this.QMb()}catch(ib){ra.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",ib.toString())}}else ra.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:rb.a.Aad(T.data.ve)}),this.rJd()||(this.ESa("Failed to deserialize response"),this.Y8c())}else ra.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.rJd()||(this.ESa("Unknown"),this.Y8c())}Bun(T){T&&T.data?this.FTh(T.data.status)||
(ra.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.ESa(An.a[T.data.status]),this.Y8c()):(ra.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.rJd()||(this.ESa("Unknown"),this.Y8c()))}rJd(){if(!this.fte)return ra.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.fte=!0,this.tga(),!0;ra.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}FTh(T){ra.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",
T);return this.rJd()}QMb(){ra.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");pa.a.om(this.uKa,pa.a.kra(3),void 0,"UploadToSharePointManager.RedirectToFolder")}PMb(T){let Aa=!1,ib=!1;l.AFrameworkApplication.K&&(Aa=l.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),ib=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ra.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",T,Aa);if(Aa&&ib){ra.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const Tb={};Tb[Tc.a.jhc]="1";Tb[Tc.a.documentUrl]=T;Tb[Tc.a.reason]=Xc.a.k9f;l.AFrameworkApplication.MO().execute(xc=>{xc.sendMessage(Id.a.xCb,Tb)})}else pa.a.om(T,pa.a.kra(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}Y6a(){this.Ri&&1===this.Ri.state||(this.Dk=this.DXa(),this.Dk.message=CommonUIStrings.l_CommentProgressTooltip,this.Dk.Ad=5,this.Dk.Et=!1,this.Dk.tL(CommonUIStrings.l_DefaultDialogTitle,null,null))}Tma(){this.Dk&&(this.Dk.close(),this.Dk=null)}Y8c(){this.xp(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)}Xxo(){this.xp(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}jxo(){const T=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.xp(CommonUIStrings.l_SaveAsFileTooLargeTitle,T,zl.a.Oao)}xp(T,Aa,ib=zl.a.Sao){ra.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",T,Aa);this.Tma();1!==this.Ri.state&&this.fH().XSh(T,Aa,ib)}dxo(T){ra.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",
T);switch(T){case Mh.a.xne:this.Xxo();break;case Mh.a.o7f:this.jxo();break;default:this.Y8c()}}j7f(){"VersionHistory"===this.kRe&&this.ga.processAction(n.a.p5c,2)}ESa(T){"VersionHistory"===this.kRe&&this.ga.Qb(n.a.pee,2,{["FailureReason"]:T})}}Object(f.a)(vg,"UploadToSharePointManager",null,[1888]);var sk=c(623),Ti=c(129);class Tf{constructor(){this.Hcb=this.XKe=this.OKe=this.W=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}xc(T){this.W=T;this.OKe=sk.a.zp(T.Sa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));
this.XKe=sk.a.zp(T.Sa("Common.IEventEmitter<Common.IMruResult>"));this.Hcb=sk.a.zp(T.Sa("Common.App.SharedFilePicker.ISharedFilePicker"));Ti.Task.WAA.call(null,this.OKe,this.XKe,this.Hcb).continueWith(()=>{this.lVn()})}lVn(){this.W.register(Hm,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Rd(()=>new Hm(l.AFrameworkApplication.K)).singleInstance();this.W.register(vg,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Rd(()=>
new vg(l.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new tl.a).create(),()=>new ce,l.AFrameworkApplication.ta)).singleInstance();this.W.register(ol,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Rd(()=>new ol(this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new ce,this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),l.AFrameworkApplication.ta)).singleInstance();
this.W.register(Ij,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Rd(()=>new Ij(this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new bb.a(()=>this.OKe.result),l.AFrameworkApplication.ta,()=>new ai)).singleInstance();this.W.register(rj,"Common.App.SaveToSharePoint.FileNameDialogFactory").Rd(()=>new rj(l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Nb,
this.W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.W.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new bb.a(()=>this.XKe.result),this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Hcb?this.Hcb.result:null)).singleInstance();this.W.register(gg,"Common.App.SaveToSharePoint.SaveToSharePointActor").Rd(()=>new gg(l.AFrameworkApplication.K,l.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>l.AFrameworkApplication.ta.RTk)).singleInstance();l.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.W.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Tb()}static main(){L.a.instance.Fc(new Tf)}}Object(f.a)(Tf,"PackageManager",null,[1,2]);class dm{}
Object(f.a)(dm,"StringDifference",null,[1894]);class je{constructor(T,Aa){this.charCode=T;this.description=Aa}}Object(f.a)(je,"UBTableEntry",null,[]);class Xi{}new je(8,"C0 Controls 1");new je(9,"Horizontal tab (HT)");new je(10,"Line feed (LF)");new je(12,"C0 Controls 2");new je(13,"Carriage return (CR)");new je(31,"C0 Controls 3");new je(32,"Space");new je(47,"ASCII Punctuation and Symbols 1");new je(57,"ASCII Digits");new je(64,"ASCII Punctuation and Symbols 2");new je(90,"Uppercase Latin Alphabet");
new je(96,"ASCII Punctuation and Symbols 3");new je(122,"Lowercase Latin Alphabet");new je(127,"U+0000..U+007F Basic Latin");new je(159,"C1 Controls");new je(160,"NB Space");new je(191,"Latin-1 Punctuation and Symbols");new je(255,"U+0080..U+00FF Latin-1 Supplement");new je(383,"U+0100..U+017F Latin Extended-A");new je(591,"U+0180..U+024F Latin Extended-B");new je(687,"U+0250..U+02AF IPA Extensions");new je(767,"U+02B0..U+02FF Spacing Modifier Letters");new je(879,"U+0300..U+036F Combining Diacritical Marks");
new je(1023,"U+0370..U+03FF Greek and Coptic");new je(1279,"U+0400..U+04FF Cyrillic");new je(1327,"U+0500..U+052F Cyrillic Supplement");new je(1423,"U+0530..U+058F Armenian");new je(1535,"U+0590..U+05FF Hebrew");new je(1791,"U+0600..U+06FF Arabic");new je(1871,"U+0700..U+074F Syriac");new je(1919,"U+0750..U+077F Arabic Supplement");new je(1983,"U+0780..U+07BF Thaana");new je(2047,"U+07C0..U+07FF NKo");new je(2111,"U+0800..U+083F Samaritan");new je(2143,"U+0840..U+085F Mandaic");new je(2303,"U+08A0..U+08FF Arabic Extended-A");
new je(2431,"U+0900..U+097F Devanagari");new je(2559,"U+0980..U+09FF Bengali");new je(2687,"U+0A00..U+0A7F Gurmukhi");new je(2815,"U+0A80..U+0AFF Gujarati");new je(2943,"U+0B00..U+0B7F Oriya");new je(3071,"U+0B80..U+0BFF Tamil");new je(3199,"U+0C00..U+0C7F Telugu");new je(3327,"U+0C80..U+0CFF Kannada");new je(3455,"U+0D00..U+0D7F Malayalam");new je(3583,"U+0D80..U+0DFF Sinhala");new je(3711,"U+0E00..U+0E7F Thai");new je(3839,"U+0E80..U+0EFF Lao");new je(4095,"U+0F00..U+0FFF Tibetan");new je(4255,
"U+1000..U+109F Myanmar");new je(4351,"U+10A0..U+10FF Georgian");new je(4607,"U+1100..U+11FF Hangul Jamo");new je(4991,"U+1200..U+137F Ethiopic");new je(5023,"U+1380..U+139F Ethiopic Supplement");new je(5119,"U+13A0..U+13FF Cherokee");new je(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new je(5791,"U+1680..U+169F Ogham");new je(5887,"U+16A0..U+16FF Runic");new je(5919,"U+1700..U+171F Tagalog");new je(5951,"U+1720..U+173F Hanunoo");new je(5983,"U+1740..U+175F Buhid");new je(6015,"U+1760..U+177F Tagbanwa");
new je(6143,"U+1780..U+17FF Khmer");new je(6319,"U+1800..U+18AF Mongolian");new je(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new je(6479,"U+1900..U+194F Limbu");new je(6527,"U+1950..U+197F Tai Le");new je(6623,"U+1980..U+19DF New Tai Lue");new je(6655,"U+19E0..U+19FF Khmer Symbols");new je(6687,"U+1A00..U+1A1F Buginese");new je(6831,"U+1A20..U+1AAF Tai Tham");new je(7039,"U+1B00..U+1B7F Balinese");new je(7103,"U+1B80..U+1BBF Sundanese");new je(7167,"U+1BC0..U+1BFF Batak");
new je(7247,"U+1C00..U+1C4F Lepcha");new je(7295,"U+1C50..U+1C7F Ol Chiki");new je(7375,"U+1CC0..U+1CCF Sundanese Supplement");new je(7423,"U+1CD0..U+1CFF Vedic Extensions");new je(7551,"U+1D00..U+1D7F Phonetic Extensions");new je(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new je(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new je(7935,"U+1E00..U+1EFF Latin Extended Additional");new je(8191,"U+1F00..U+1FFF Greek Extended");new je(8303,"U+2000..U+206F General Punctuation");
new je(8351,"U+2070..U+209F Superscripts and Subscripts");new je(8399,"U+20A0..U+20CF Currency Symbols");new je(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new je(8527,"U+2100..U+214F Letterlike Symbols");new je(8591,"U+2150..U+218F Number Forms");new je(8703,"U+2190..U+21FF Arrows");new je(8959,"U+2200..U+22FF Mathematical Operators");new je(9215,"U+2300..U+23FF Miscellaneous Technical");new je(9279,"U+2400..U+243F Control Pictures");new je(9311,"U+2440..U+245F Optical Character Recognition");
new je(9471,"U+2460..U+24FF Enclosed Alphanumerics");new je(9599,"U+2500..U+257F Box Drawing");new je(9631,"U+2580..U+259F Block Elements");new je(9727,"U+25A0..U+25FF Geometric Shapes");new je(9983,"U+2600..U+26FF Miscellaneous Symbols");new je(10175,"U+2700..U+27BF Dingbats");new je(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new je(10239,"U+27F0..U+27FF Supplemental Arrows-A");new je(10495,"U+2800..U+28FF Braille Patterns");new je(10623,"U+2900..U+297F Supplemental Arrows-B");
new je(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new je(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new je(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new je(11359,"U+2C00..U+2C5F Glagolitic");new je(11391,"U+2C60..U+2C7F Latin Extended-C");new je(11519,"U+2C80..U+2CFF Coptic");new je(11567,"U+2D00..U+2D2F Georgian Supplement");new je(11647,"U+2D30..U+2D7F Tifinagh");new je(11743,"U+2D80..U+2DDF Ethiopic Extended");new je(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new je(11903,"U+2E00..U+2E7F Supplemental Punctuation");new je(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new je(12255,"U+2F00..U+2FDF Kangxi Radicals");new je(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new je(12351,"U+3000..U+303F CJK Symbols and Punctuation");new je(12447,"U+3040..U+309F Hiragana");new je(12543,"U+30A0..U+30FF Katakana");new je(12591,"U+3100..U+312F Bopomofo");new je(12687,"U+3130..U+318F Hangul Compatibility Jamo");new je(12703,"U+3190..U+319F Kanbun");new je(12735,
"U+31A0..U+31BF Bopomofo Extended");new je(12783,"U+31C0..U+31EF CJK Strokes");new je(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new je(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new je(13311,"U+3300..U+33FF CJK Compatibility");new je(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new je(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new je(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new je(42127,"U+A000..U+A48F Yi Syllables");new je(42191,"U+A490..U+A4CF Yi Radicals");
new je(42239,"U+A4D0..U+A4FF Lisu");new je(42559,"U+A500..U+A63F Vai");new je(42655,"U+A640..U+A69F Cyrillic Extended-B");new je(42751,"U+A6A0..U+A6FF Bamum");new je(42783,"U+A700..U+A71F Modifier Tone Letters");new je(43007,"U+A720..U+A7FF Latin Extended-D");new je(43055,"U+A800..U+A82F Syloti Nagri");new je(43071,"U+A830..U+A83F Common Indic Number Forms");new je(43135,"U+A840..U+A87F Phags-pa");new je(43231,"U+A880..U+A8DF Saurashtra");new je(43263,"U+A8E0..U+A8FF Devanagari Extended");new je(43311,
"U+A900..U+A92F Kayah Li");new je(43359,"U+A930..U+A95F Rejang");new je(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new je(43487,"U+A980..U+A9DF Javanese");new je(43615,"U+AA00..U+AA5F Cham");new je(43647,"U+AA60..U+AA7F Myanmar Extended-A");new je(43743,"U+AA80..U+AADF Tai Viet");new je(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new je(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new je(44031,"U+ABC0..U+ABFF Meetei Mayek");new je(55215,"U+AC00..U+D7AF Hangul Syllables");new je(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new je(56191,"U+D800..U+DB7F High Surrogates");new je(56319,"U+DB80..U+DBFF High Private Use Surrogates");new je(57343,"U+DC00..U+DFFF Low Surrogates");new je(63743,"U+E000..U+F8FF Private Use Area");new je(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new je(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new je(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new je(65039,"U+FE00..U+FE0F Variation Selectors");new je(65055,"U+FE10..U+FE1F Vertical Forms");new je(65071,"U+FE20..U+FE2F Combining Half Marks");
new je(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new je(65135,"U+FE50..U+FE6F Small Form Variants");new je(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new je(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new je(65535,"U+FFF0..U+FFFF Specials");new je(65663,"U+10000..U+1007F Linear B Syllabary");new je(65791,"U+10080..U+100FF Linear B Ideograms");new je(65855,"U+10100..U+1013F Aegean Numbers");new je(65935,"U+10140..U+1018F Ancient Greek Numbers");new je(65999,"U+10190..U+101CF Ancient Symbols");
new je(66047,"U+101D0..U+101FF Phaistos Disc");new je(66207,"U+10280..U+1029F Lycian");new je(66271,"U+102A0..U+102DF Carian");new je(66351,"U+10300..U+1032F Old Italic");new je(66383,"U+10330..U+1034F Gothic");new je(66463,"U+10380..U+1039F Ugaritic");new je(66527,"U+103A0..U+103DF Old Persian");new je(66639,"U+10400..U+1044F Deseret");new je(66687,"U+10450..U+1047F Shavian");new je(66735,"U+10480..U+104AF Osmanya");new je(67647,"U+10800..U+1083F Cypriot Syllabary");new je(67679,"U+10840..U+1085F Imperial Aramaic");
new je(67871,"U+10900..U+1091F Phoenician");new je(67903,"U+10920..U+1093F Lydian");new je(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new je(68095,"U+109A0..U+109FF Meoritic Cursive");new je(68191,"U+10A00..U+10A5F Kharoshthi");new je(68223,"U+10A60..U+10A7F Old South Arabian");new je(68415,"U+10B00..U+10B3F Avestan");new je(68447,"U+10B40..U+10B5F Inscriptional Parthian");new je(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new je(68687,"U+10C00..U+10C4F Old Turkic");new je(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new je(69759,"U+11000..U+1107F Brahmi");new je(69839,"U+11080..U+110CF Kaithi");new je(69887,"U+110D0..U+110FF Sora Sompeng");new je(69967,"U+11100..U+1114F Chakma");new je(70111,"U+11180..U+111DF Sharada");new je(71375,"U+11680..U+116CF Takri");new je(74751,"U+12000..U+123FF Cuneiform");new je(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new je(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new je(92735,"U+16800..U+16A3F Bamum Supplement");new je(94111,"U+16F00..U+16F9F Miao");new je(110847,
"U+1B000..U+1B0FF Kana Supplement");new je(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new je(119295,"U+1D100..U+1D1FF Musical Symbols");new je(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new je(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new je(119679,"U+1D360..U+1D37F Counting Rod Numerals");new je(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new je(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new je(127023,"U+1F000..U+1F02F Mahjong Tiles");
new je(127135,"U+1F030..U+1F09F Domino Tiles");new je(127231,"U+1F0A0..U+1F0FF Playing Cards");new je(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new je(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new je(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new je(128591,"U+1F600..U+1F64F Emoticons");new je(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new je(128895,"U+1F700..U+1F77F Alchemical Symbols");new je(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new je(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new je(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new je(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new je(917631,"U+E0000..U+E007F Tags");new je(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new je(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new je(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(f.a)(Xi,"UnicodeBlocks",null,[1895]);class Fk{constructor(){this.W=
null}xc(T){this.W=T;this.W.register(dm,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").singleInstance();this.W.register(Xi,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").singleInstance()}get name(){return"Common.App.SensitiveLogging"}init(){this.W.resolve("Common.App.SensitiveLogging.IStringDifference");this.W.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){L.a.instance.Fc(new Fk)}}
Object(f.a)(Fk,"SensitiveLoggingPackage",null,[1,2]);var wg;(function(T){T[T.myFiles=0]="myFiles";T[T.recent=1]="recent";T[T.currentFolder=2]="currentFolder";T[T.yourPhone=3]="yourPhone"})(wg||(wg={}));Object(f.b)("SharedFilePickerLandingLocation",wg);class bg{constructor(T){this.pGb=this.Hgc=null;this._initialized=!1;this.Ayf=T}wgb(T){this._initialized||(T.Dv(Id.a.K7i),T.TB(Id.a.K7i,Object(a.a)(this,this.xtn,"onReceivedPickerResponse")),this._initialized=!0)}DPd(T){return this.pGb=new Promise((Aa,
ib)=>{const Tb={};Tb[Tc.a.GDn]=T;this.Hgc=(xc,ld)=>{""===ld?(ra.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Aa(xc)):("Canceled"===ld?ra.ULS.sendTraceTag(572548164,306,50,ld):ra.ULS.sendTraceTag(556901065,306,10,ld),ib(ld))};this.Ayf.execute(xc=>{this.wgb(xc);xc.sendMessage(Id.a.fyn,Tb)})})}xtn(T){this.Hgc(T.Values[Tc.a.Ido],void 0===T.Values[Tc.a.pZf]||null===T.Values[Tc.a.pZf]?"":T.Values[Tc.a.pZf])}qGf(){return l.AFrameworkApplication.K.$("UiHostCommonFilePicker")}Saf(T,
Aa,ib,Tb,xc,ld,Sd,df,De=null){const Ff={};Ff[Tc.a.hdo]=T;Ff[Tc.a.titleText]=Aa;Ff[Tc.a.oCk]=ib;Ff[Tc.a.pCk]=Tb;Ff[Tc.a.rCk]=xc;Ff[Tc.a.Kpl]=!0;Ff[Tc.a.hCl]=ld;Ff[Tc.a.KDn]=Sd;Ff[Tc.a.JDn]=wg[df];G.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Ff[Tc.a.LDn]="Dark");De&&(null!=De.d1b&&(Ff[Tc.a.d1b]=De.d1b),null!=De.s$b&&(Ff[Tc.a.s$b]=De.s$b));return Ff}}Object(f.a)(bg,"SharedFilePickerManager",null,[2013]);class vh{constructor(){this.W=null}get name(){return"Common.App.SharedFilePicker"}xc(T){this.W=
T;T.register(bg,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").singleInstance().Rd(()=>new bg(T.Sa("Postmessage.IHostPostmessenger")))}init(){l.AFrameworkApplication.K.Po(()=>{this.l2a()})}l2a(){this.W.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){L.a.instance.Fc(new vh)}}Object(f.a)(vh,"SharedFilePickerPackage",null,[1,2]);class Ej extends Sys.EventArgs{constructor(){super()}}Object(f.a)(Ej,"TypingSpeedMeterChangedEventArgs",
Sys.EventArgs,[]);class im{}Object(f.a)(im,"TypingSpeedMeterWindow",null,[]);class Nd{constructor(T,Aa){new M.a;this.Tz=T;this.ri=Aa;this.ri.L_e(Object(a.a)(this,this.Q6d,"onCpuMeterFrameAvailable"))}Q6d(){}dispose(){this.ri.Bbj(Object(a.a)(this,this.Q6d,"onCpuMeterFrameAvailable"))}}Object(f.a)(Nd,"TypingSpeedMeter",null,[2027]);class Qn{constructor(T){this.rxd=null;this.$p=new z.a;this.Tz=T}initialize(T,Aa,ib,Tb){this.rxd||(this.rxd=new Nd(this.Tz,T,Aa,ib,Tb),this.$p.Bg(this.rxd));return this.rxd}}
Object(f.a)(Qn,"TypingSpeedMeterProvider",null,[2010]);class Cd{constructor(){this.xWe=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(l.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const T=sa.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),Aa=sk.a.zp(sa.a.instance.Sa("Common.ICpuMeterProvider"));Aa.continueWith(()=>{const ib=Aa.result.$p.task;var Tb=new Ga.a(l.AFrameworkApplication.K.mc("TypingSpeedMeterWindowSamplingPercent",0)/100);Tb=new ya.a(Object(a.a)(Tb,
Tb.SOb,"shouldBeInSample"));const xc=Ia.a.eF(12,1,Tb),ld=l.AFrameworkApplication.K.mc("TypingSpeedMeterWindowTimeoutMs",5E3),Sd=l.AFrameworkApplication.K.mc("TypingSpeedMeterMaxKeystrokesPerWindow",5);ib.CWR(()=>this.xWe=T.initialize(ib.result,xc,ld,Sd))})}}dispose(){this.xWe&&this.xWe.dispose()}xc(T){T.register(Qn,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").singleInstance().Rd(()=>new Qn(pa.a.af))}static main(){L.a.instance.Fc(new Cd)}}Object(f.a)(Cd,
"TypingSpeedMeterPackage",null,[1,2]);class pl{constructor(){this.events=[];this.l7f=!1}static dIf(T){return T.ctrlKey&&"Control"!==T.key||T.altKey&&"Alt"!==T.key||!!pl.BXm[T.key]}static KOk(T,Aa){let ib;ib=pl.dIf(T)?T.key:" "===T.key?"Space":"CharacterKey";return null!=Aa?(Aa.altPressed=(!!T.altKey).toString(),Aa.ctrlPressed=(!!T.ctrlKey).toString(),Aa.key=ib,Aa.repeat=(!!T.repeat).toString(),Aa.shiftPressed=(!!T.shiftKey).toString(),Aa):{["altPressed"]:(!!T.altKey).toString(),["ctrlPressed"]:(!!T.ctrlKey).toString(),
["key"]:ib,["repeat"]:(!!T.repeat).toString(),["shiftPressed"]:(!!T.shiftKey).toString()}}static KAi(T){return window.performance&&window.performance.now&&T.timeStamp<performance.now()}static ZXh(T){return!!T&&pl.KAi(T)&&pl.dIf(T)}static $Xh(T){return!!T&&pl.KAi(T)&&!pl.dIf(T)}keyPressedEventHandlerStart(T,Aa){pl.$Xh(T)&&this.Pvj(T,Aa)}keyPressedEventHandlerEnd(T){pl.$Xh(T)&&this.uwj(T)}keyDownEventHandlerStart(T,Aa){pl.ZXh(T)&&this.Pvj(T,Aa)}keyDownEventHandlerEnd(T){pl.ZXh(T)&&this.uwj(T)}Pvj(T,
Aa){T={["metadata"]:pl.KOk(T,Aa),["timeStamp"]:this.omc(T.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.omc(performance.now()-T.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};this.events.push(T);this.rYn()}uwj(T){if(0!==this.events.length){var Aa=this.omc(T.timeStamp);for(let ib=this.events.length-1;0<=ib;--ib){const Tb=this.events[ib];if(Tb.timeStamp===Aa){Tb.timeToHandlerFinishMs=this.omc(performance.now()-T.timeStamp);Tb.eventDurationMs=this.omc(Tb.timeToHandlerFinishMs-
Tb.timeToHandlerStartMs);break}}}}omc(T){return Number(T.toFixed(2))}rYn(){if(!this.l7f){const T=document.createEvent("CustomEvent");T.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(T);requestAnimationFrame(()=>{this.l7f=!1;const Aa=performance.now();this.events.forEach(Tb=>{Tb.timeToRequestAnimationFrameMs=this.omc(Aa-Tb.timeStamp)});var ib=document.createEvent("CustomEvent");ib.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(ib);this.events=
[];ib=document.createEvent("CustomEvent");ib.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(ib)});this.l7f=!0}}}pl.BXm={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class Xf{constructor(){this.qee=this.m4a=this.QQa=this.Odc=null;this.$bc=!1;this.Dhc=null;this.UMc=[];this.nbd=()=>{Xf.hQm()&&null==this.m4a?(this.QQa=null,this.m4a=requestAnimationFrame(this.eZc)):
null!=this.m4a&&(cancelAnimationFrame(this.m4a),this.m4a=null)};this.eZc=T=>{if(null!=this.QQa){const Aa=T-this.QQa;if(null==this.Odc||this.Odc<Aa)this.Odc=Aa;for(let ib=0;ib<Xf.ranges.length;++ib)if(Aa<Xf.ranges[ib]){++this.UMc[ib];break}}this.QQa=T;this.m4a=requestAnimationFrame(this.eZc)};this.ldj=()=>{if(null!=this.Odc){var T={};for(var Aa=0;Aa<Xf.ranges.length;++Aa)T[Xf.ranges[Aa]]=this.UMc[Aa],this.UMc[Aa]=0;Aa=performance.now();T={["intervalStart"]:this.Dhc,["intervalEnd"]:Aa,["maxFrameLengthMs"]:this.Odc,
["frameData"]:T};var ib=document.createEvent("CustomEvent");ib.initCustomEvent("reportframetiming",!1,!1,T);dispatchEvent(ib);this.Odc=null;this.Dhc=Aa}}}static uFf(){return!!window.performance&&!!window.performance.now}start(T){!this.$bc&&Xf.uFf()&&(this.zqo(),this.qee=setInterval(this.ldj,1E3*T),this.Dhc=performance.now(),this.nbd(),document.addEventListener("visibilitychange",this.nbd),this.$bc=!0)}stop(){this.$bc&&(document.removeEventListener("visibilitychange",this.nbd),null!=this.qee&&(clearInterval(this.qee),
this.qee=null),null!=this.m4a&&(cancelAnimationFrame(this.m4a),this.m4a=null),this.ldj(),this.$bc=!1)}get VVc(){return this.$bc}zqo(){this.UMc=[];for(let T=0;T<Xf.ranges.length;++T)this.UMc.push(0)}}Xf.hQm=()=>"visible"===document.visibilityState;Xf.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];class yg{create(T){return new Ga.a(T)}}Object(f.a)(yg,"RandomSamplerFactory",null,[867]);var cb=c(9),Hb=c(1413);class bc{constructor(T,Aa,ib,Tb,xc){T.Mqh(()=>{Tb.i5c()});T.Uqh((ld,
Sd)=>{Tb.g5c(Sd.revisionId,Sd.I4a)});T.Wzd((ld,Sd)=>{Tb.Ywm(Sd.vfj,Sd.I4a,Sd.Qzj)});T.Iyk(()=>{Tb.a7f()});Aa.izk((ld,Sd)=>{Tb.WKo(Sd.Zcj,Sd.bme,Sd.actualValue)});Aa.Uxk((ld,Sd)=>{Tb.VKo(Sd.Zcj,Sd.bme,Sd.actualValue)});xc.dEc(()=>{Tb.Vad()});ib.g3((ld,Sd)=>{6===Sd.type&&Tb.hic(Sd.yL)})}}Object(f.a)(bc,"EventForwarder",null,[]);class Cc{constructor(T,Aa,ib){this.Qck=T;this.wN=ib;this.m_b=Aa}create(T,Aa){return new bc(this.Qck,this.m_b,T,Aa,this.wN)}}Object(f.a)(Cc,"EventForwarderFactory",null,[]);var Kc=
c(438);class kd{}kd.sRo="TypingToOutboundReplicationStart";kd.Nyn="OutboundReplicationStartToOutboundReplicationEnd";kd.qgj="RtcNotificationToInboundReplicationEnd";kd.TDj="TypingToInboundReplicationEnd";Object(f.a)(kd,"PerfTrackerPhases",null,[]);class Wd{constructor(T,Aa,ib,Tb,xc,ld,Sd,df,De=null){this.H5g=!1;this.JLe=5;this.g7g=50;this.kKe=20;this.LIe=this.VJe=this.Cza=null;this.drc=this.Tqc=0;this.GTe=this.PUe=!1;this.mwd=Array(7);this.roc=null;this.$Xg=!1;this.yve=null;this.oia={};this.xld=T;
this.AVa=Aa;this.qbk=ib;this.WZg=Tb.create(kd.qgj,xc,ld,20,!1);this.sxd=Tb.create(kd.TDj,Sd,df,20,!0);if(this.Fa=l.AFrameworkApplication.K)this.H5g=this.Fa.$("LogSteppedInboundFrameIsEnabled"),this.kKe=this.Fa.mc("InboundFrameMaxNumberOfLongRunningTasks",20),this.g7g=this.Fa.mc("InboundFrameMinLengthForLongRunningTasksInMs",50),this.JLe=this.Fa.mc("InboundFrameNumberOfLastShortTasks",5);this.fsb=De}get XWk(){null==this.yve&&(this.yve=!!this.Fa&&this.Fa.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));
return this.yve}initialize(T){this.Cza=T}c5n(T,Aa,ib=null){this.bEh();ra.ULS.shipAssertTag(8229761,324,0<T.length);let Tb=!1;for(const ld of T){const Sd=ld.toString();if(Sd in this.oia){var xc=this.oia[Sd];if(!xc.Tic){xc.Yjj(T,Aa,ib);if(Tb)this.hLi(ld.toString(),xc,null,null,this.mwd,null);else{const df=this.tAl(),De=this.mLl(this.roc);Tb=!0;this.hLi(ld.toString(),xc,df,this.LIe,this.mwd,De)}delete this.oia[Sd]}}else xc=this.xld.create(this.WZg,this.sxd),xc.Yjj(T,Aa),this.oia[Sd]=xc}this.GTe=!1}hic(T){ra.ULS.shipAssertTag(8257930,
304,T.bEi,"Expected data not sent on the wire");if(T.bEi){if(T.Vee in this.oia){var Aa=this.oia[T.Vee];Aa.ife||(Aa.hic(T.revisionId,T.YZi,T.erj,T.I4a),delete this.oia[T.Vee])}else Aa=this.xld.create(this.WZg,this.sxd),Aa.hic(T.revisionId,T.YZi,T.erj,T.I4a),this.oia[T.Vee]=Aa;this.bEh()}}Lym(){this.PUe||(this.VJe=Array(this.kKe),this.LIe=Array(this.JLe),this.drc=this.Tqc=0,this.mwd=[0,0,0,0,0,0,0,0],this.roc=Array(3),this.roc[1]=[0,0],this.roc[2]=[0,0],this.PUe=!0)}wuo(T){return!T.TP&&T.TN===fa.a.Ucj&&
(T=Kc.a(this.oia))&&T[0]?!0:!1}Unn(T){this.PUe=!1;const Aa=Kc.a(this.oia);Aa&&Aa[0]&&(T.TRT>=this.g7g&&this.Tqc<this.kKe?this.VJe[this.Tqc++]=T:(this.LIe[this.drc]=T,this.drc=this.drc<this.JLe-1?this.drc+1:0),this.f8m(T),this.z8m(T))}Tnn(){this.Lym();this.GTe=!0}f8m(T){this.mwd[T.TP]++}z8m(T){if(T&&T.UI){const Aa=this.roc[T.UI];Aa[0]+=1;Aa[1]+=T.TRT}}mLl(T){const Aa={};T&&(T[1]&&(Aa.Typing=T[1]),T[2]&&(Aa.Clicking=T[2]));return Aa}tAl(){return this.Tqc?this.VJe.slice(0,this.Tqc-1):null}bEh(){var T=
Kc.a(this.oia);if(T&&(this.$Xg||this.l9m(T),T.length>this.qbk))for(const Aa of T){T=this.oia[Aa];const ib=T.createdTime,Tb=this.AVa();6E4<Tb-ib&&(I.b(8438528,304,50,"{0}",{["Not Received"]:T.Tic?"RtcNotification":"ServerRevision",["Duration"]:Tb-ib}),T.Tic||I.b(42075798,304,15,"{0}",{["RevisionId"]:Aa,["Duration"]:Tb-ib}),delete this.oia[Aa])}}l9m(T){if(this.XWk&&this.fsb)for(const Aa of T)if(T=this.oia[Aa],T.ife&&!T.Tic&&(T=T.createdTime,2E3<this.AVa()-T)){let ib=null;cb.App.xa&&cb.App.xa.ib&&cb.App.xa.ib.Uc&&
(ib=cb.App.xa.ib.Uc.contentReplicator);this.fsb.execute(Tb=>{Tb.flush(ib,1)});this.$Xg=!0}}hLi(T,Aa,ib,Tb,xc,ld){this.H5g&&(Aa=Aa.VKl())&&(Aa.RevisionId=T,Aa.LRTWR=ib,Aa.LSTWR=Tb,Aa.TSD=xc,Aa.UIWR=ld,this.Cza&&this.Cza.track(Aa))}}Object(f.a)(Wd,"InboundMonitor",null,[2033]);class ve{constructor(T,Aa,ib,Tb){this.qD=Aa;this.xld=ib;this.onk=Tb}create(T,Aa,ib,Tb,xc=null){return new Wd(this.xld,this.qD,50,this.onk,T,Aa,ib,Tb,xc)}}Object(f.a)(ve,"InboundMonitorFactory",null,[2017]);var Ie=c(372);class yf{}
yf.Soe="UserCount";yf.E9n="RevisionChainLength";Object(f.a)(yf,"PerfTrackerPivotNames",null,[]);class gc{}Object(f.a)(gc,"PerfTrackingContext",null,[]);const ff=T=>5>=T?"5AndFewer":10>=T?"6To10":15>=T?"11To15":20>=T?"15To20":25>=T?"21To25":30>=T?"26To30":"31AndAbove";class Gk{}Object(f.a)(Gk,"SteppedInboundFrame",null,[]);class Sh{constructor(T,Aa,ib,Tb,xc){this.Qbb=this.zld=null;this.RZg=500;this.yld=this.ssa=this.qub=this.TVb=this.Qdd=-1;this.ewg=null;this.pfh=this.jeh=!1;this.Odh=null;this.H$g=
this.zLa=0;this.fYb=T;this.createdTime=Aa();this.Mud=!1;this.XMe=0;this.Vvb=ib;this.v7j=Tb;this.sxd=xc;l.AFrameworkApplication.K&&(this.RZg=l.AFrameworkApplication.K.mc("InboundFrameSamplingMinimalTotalTimeMs",500))}get ife(){return this.jeh}get Tic(){return this.pfh}get wfj(){return this.Odh}get I4a(){return this.zLa}get Myn(){return this.H$g}get JCb(){return this.Vvb()}hic(T,Aa,ib,Tb){this.ife||(this.Mud=ib,this.XMe=Aa,this.Qdd=Y.a.VU(pa.a.af(),2),this.ewg=(new Date).toISOString(),this.Qbb=T,this.H$g=
Tb,this.jeh=!0,this.Tic?this.BWh():(this.Qvj(),va.a.instance.ez(T.toString()+"Start"),Ie.a.instance.e4d(2)))}Yjj(T,Aa,ib=null){this.Tic||(this.zLa=Aa,this.pfh=!0,this.Odh=T,this.yld=Y.a.VU(pa.a.af(),2),this.ife&&(va.a.instance.ez(this.Qbb.toString()+"End"),ib&&(this.TVb=ib.j6n,this.qub=ib.U5a,this.ssa=ib.d5n),Ie.a.instance.TDd(),this.BWh()))}VKl(){if(!(0<this.Qdd&&0<this.TVb&&0<this.qub&&0<this.ssa&&0<this.yld))return null;const T=new Gk;T.TT=Y.a.VU(this.yld-this.Qdd,2);if(T.TT<this.RZg)return null;
T.ST=this.ewg;T.UC=this.JCb;T.RS=Y.a.VU(this.TVb-this.Qdd,2);T.SR=Y.a.VU(this.qub-this.TVb,2);T.RRS=Y.a.VU(this.ssa-this.qub,2);T.RP=Y.a.VU(this.yld-this.ssa,2);T.ResponseLanded=Y.a.VU(this.qub,2);0<T.RS?(va.a.instance.oY("RTCToRequestSent",this.Qbb.toString()+"Start","RequestInvoked"+this.TVb),va.a.instance.oY("RequestSentToResponseReceived","RequestInvoked"+this.TVb,"RequestCompleted"+this.qub),va.a.instance.oY("ResponseReceivedToReplicationStart","RequestCompleted"+this.qub,"ReplicationStart"+
this.ssa)):va.a.instance.oY("RTCToReplicationStart",this.Qbb.toString()+"Start","ReplicationStart"+this.ssa);va.a.instance.oY("Replication","ReplicationStart"+this.ssa,this.Qbb.toString()+"End");return T}Qvj(){this.zld=this.fYb.create();this.zld.start(kd.qgj,kd.TDj)}BWh(){this.zld||this.Qvj();const T=this.zld.end(this.Mud,this.xdl());this.v7j.oee(T);this.sxd.oee(T+this.XMe)}xdl(){const T={};T[yf.Soe]=ff(this.JCb);var Aa=this.wfj.length;T[yf.E9n]=9>=Aa?Aa.toString():"10AndAbove";return Object.assign(new gc,
{P:T,FC:this.I4a,CFC:this.Myn+this.I4a,ID:this.Qbb.toString(),CD:this.XMe,UC:this.JCb,RCL:this.wfj.length})}}Object(f.a)(Sh,"InboundOperation",null,[2032]);class jm{constructor(T,Aa,ib){this.kKa=T;this.AVa=Aa;this.Vvb=ib}create(T,Aa){return new Sh(this.kKa,this.AVa,this.Vvb,T,Aa)}}Object(f.a)(jm,"InboundOperationFactory",null,[2016]);class Jj{constructor(T,Aa,ib,Tb,xc,ld,Sd,df,De){this.Nud=!0;this.Fah=this.xrd=null;this.bN=Ff=>{this.hj.bN(6,Ff)};this.VMe=T;this.G2j=Aa;this.Lfk=ib;this.hj=Tb;this.yWe=
xc.create("TypingToOutboundReplicationStart",ld,Sd,20,!1);this.ZPe=xc.create("OutboundReplicationStartToOutboundReplicationEnd",df,De,20,!1)}get WYf(){return this.xrd}get s$d(){return this.Fah}Vad(){!this.WYf&&this.Nud&&(this.Nud=this.G2j())&&(this.xrd=this.VMe.create(this.bN,this.Lfk(),this.yWe,this.ZPe),this.WYf.Vad())}i5c(){this.Nud=!0;this.Fah=this.WYf;this.s$d&&(this.xrd=null,this.s$d.i5c())}a7f(){this.xrd=null}g5c(T,Aa){this.s$d&&this.s$d.g5c(T,Aa)}}Object(f.a)(Jj,"OutboundMonitor",null,[]);
class Yd{constructor(T,Aa){this.VMe=T;this.Hek=Aa}create(T,Aa,ib,Tb,xc,ld,Sd){return new Jj(this.VMe,T,Aa,ib,this.Hek,Tb,xc,ld,Sd)}}Object(f.a)(Yd,"OutboundMonitorFactory",null,[]);var ih=c(58);class mg{constructor(T){this.dcb=T}get cQn(){return this.dcb}mb(T){return!!this.dcb&&T in this.dcb}get bEi(){return this.mb(mg.VJd)&&this.mb(mg.CNb)&&this.mb(mg.Odg)}get revisionId(){if(this.mb(mg.CNb))return ih.a.Ef(this.dcb[mg.CNb]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");
}get Vee(){if(this.mb(mg.CNb))return this.dcb[mg.CNb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get YZi(){if(this.mb(mg.VJd))return Number.parseInvariant(this.dcb[mg.VJd]);throw Error.create("Unable to parse DurationKey key from dictionary into int");}get erj(){if(this.mb(mg.CNb))return Boolean.parse(this.dcb[mg.Odg]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get I4a(){if(this.mb(mg.VRf))return Number.parseInvariant(this.dcb[mg.VRf]);
throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static Nal(T){return new mg(T)}static Sal(T,Aa,ib,Tb){const xc={};xc[mg.VJd]=T.toString();xc[mg.CNb]=Aa.toString();xc[mg.Odg]=ib.toString();xc[mg.VRf]=Tb.toString();return new mg(xc)}}mg.CNb="RevisionID";mg.VJd="Duration";mg.Odg="ShouldSample";mg.VRf="NumSequentialFailures";Object(f.a)(mg,"ReplicationNotificationMessage",null,[2029]);class Do{constructor(T,Aa,ib,Tb,xc,ld,Sd){this.es=this.gi=0;this.iwb=this.JCc=
null;this.Fse=[];this.Gbh=null;this.Tid={};this.zLa=0;this.fYb=T;this.jjk=Aa;this.AVa=ib;this.Vvb=Tb;this.mgh=xc;this.Qbb=null;this.Tid.TypingStartStage=null;this.Tid.ReplicationStartStage="TypingStartStage";this.Tid.ReplicationEndStage="ReplicationStartStage";this.Jkh=1<this.JCb;this.yWe=ld;this.ZPe=Sd}get JCb(){return this.Vvb()}Vad(){this.k7e("TypingStartStage")&&(this.Q3f("TypingStartStage"),ra.ULS.shipAssertTag(8257931,324,!this.iwb&&!this.es,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),
this.gi=this.AVa(),this.JCc=this.fYb.create(),this.Gvj(this.JCc,kd.sRo))}i5c(){if(this.k7e("ReplicationStartStage")){this.Q3f("ReplicationStartStage");ra.ULS.shipAssertTag(8257932,324,!!this.JCc,"TypingStart not called");if(this.JCc){const T=this.wWh(this.JCc,this.Qbb);this.yWe.oee(T)}this.iwb=this.fYb.create();this.Gvj(this.iwb,kd.Nyn)}}g5c(T,Aa){this.k7e("ReplicationEndStage")&&(this.Q3f("ReplicationEndStage"),this.es=this.AVa(),this.zLa=Aa,ra.ULS.shipAssertTag(8257933,324,!!this.iwb,"ReplicationStart not called"),
this.iwb&&(ra.ULS.shipAssertTag(8193425,324,!!this.iwb,"ReplicationStart not called"),Aa=this.wWh(this.iwb,T),this.ZPe.oee(Aa)),ra.ULS.shipAssertTag(8257934,324,!!this.gi,"StartTime not set. No message sent to other editors."),this.gi&&(T=mg.Sal(this.es-this.gi,T,this.mgh,this.zLa),this.jjk(T.cQn)))}k7e(T){if(this.Tid[T]===this.Gbh)return!0;ra.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.erk()});return!1}erk(){const T=new Sys.StringBuilder;T.append("Actual Phase:");for(let Aa=
0;Aa<this.Fse.length;Aa++)T.append(" "+this.Fse[Aa]);return T.toString()}Q3f(T){this.Fse.push(T);this.Gbh=T}Gvj(T,Aa){this.Jkh&&T.start(Aa)}wWh(T,Aa){if(!this.Jkh)return-1;const ib={};ib[yf.Soe]=ff(this.JCb);Aa=Object.assign(new gc,{P:ib,FC:this.zLa,CFC:0,ID:Aa?Aa.toString():"",CD:0,UC:this.JCb,RCL:0});return T.end(this.mgh,Aa)}}Object(f.a)(Do,"OutboundOperation",null,[2031]);class Eo{constructor(T,Aa,ib){this.fYb=T;this.AVa=Aa;this.Vvb=ib}create(T,Aa,ib,Tb){return new Do(this.fYb,T,this.AVa,this.Vvb,
Aa,ib,Tb)}}Object(f.a)(Eo,"OutboundOperationFactory",null,[2015]);class Da{constructor(T,Aa){this.UPg=this._name=this.Q2=null;this.ge=T;this.Cza=Aa}start(T,Aa=null){this.Q2=this.ge.Zf("UserAction",T);this._name=T;this.UPg=Aa}end(T,Aa){let ib=-1;T&&(ib=this.Q2.si,Aa.D=ib,Aa.CN=this.UPg,Aa.CD+=ib,this.Cza.track(Aa,this._name));return ib}}Object(f.a)(Da,"PerfTracker",null,[2030]);class nb{constructor(T,Aa){this.ge=T;this.Cza=Aa}create(){return new Da(this.ge,this.Cza)}}Object(f.a)(nb,"PerfTrackerFactory",
null,[2014]);class nc{constructor(T,Aa,ib){this.Eyc=null;this.Gek=T;this.VZg=Aa;this.dch=ib}init(T,Aa,ib,Tb,xc,ld,Sd){Aa=this.dch.create(Aa/100);ib=this.dch.create(ib/100);this.Eyc=this.Gek.create(Object(a.a)(Aa,Aa.SOb,"shouldBeInSample"),Object(a.a)(ib,ib.SOb,"shouldBeInSample"),T,Tb,xc,ld,Sd)}Vad(){this.Eyc.Vad()}i5c(){this.Eyc.i5c()}a7f(){this.Eyc.a7f()}g5c(T,Aa){this.Eyc.g5c(T,Aa)}Ywm(T,Aa,ib=null){this.VZg.c5n(T,Aa,ib)}hic(T){T=mg.Nal(T);this.VZg.hic(T);va.a.instance.ez(T.revisionId+"Start")}WKo(T,
Aa,ib){I.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.SGd(T,Aa,ib))}VKo(T,Aa,ib){I.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.SGd(T,Aa,ib))}SGd(T,Aa,ib){const Tb={};Tb.PhaseName=T;Tb.ThresholdValue=Aa;Tb.ActualValue=ib;return Tb}}Object(f.a)(nc,"ReplicationTelemetryManager",null,[]);var Hc=c(941);class bd extends Hc.a{constructor(T,Aa){super(T,Aa);this.fj=this.Lvd=0}aya(T){this.Lvd+=T;this.fj++}getValue(){return this.fj?this.Lvd/
this.fj:0}HSa(){this.fj=this.Lvd=0}}Object(f.a)(bd,"AverageMetric",Hc.a,[]);class ee extends Hc.a{constructor(T,Aa){super(T,Aa);this.N6=0}aya(T){T>this.N6&&(this.N6=T)}getValue(){return this.N6}HSa(){this.N6=0}}Object(f.a)(ee,"MaxMetric",Hc.a,[]);var ic=c(1883);class af extends Hc.a{constructor(T,Aa,ib=100){super(T,Aa);this.Uod=this.EXb=this.ZZb=0;this.Btd=ib;this.PQe=new ic.a(this.Btd)}aya(T){if(this.EXb===this.Btd){const Aa=this.PQe.dequeue();this.ZZb-=Aa;this.EXb--}this.PQe.enqueue(T);this.ZZb+=
T;this.EXb++;T=this.ZZb/this.EXb;T>this.Uod&&this.EXb===this.Btd&&(this.Uod=T)}getValue(){return this.Uod}HSa(){this.Uod=0;this.PQe=new ic.a(this.Btd);this.EXb=this.ZZb=0}}Object(f.a)(af,"MaxRollingAverageMetric",Hc.a,[]);class Vc extends Hc.a{constructor(T,Aa){super(T,Aa);this.fj=0}aya(){this.fj++}getValue(){return this.fj}HSa(){this.fj=0}}Object(f.a)(Vc,"CounterMetric",Hc.a,[]);class Mg{constructor(T,Aa){this.Z_b=Aa;this.Xte=new bd(T+"-AverageValue","Milliseconds");this.iKe=new ee(T+"-MaxValue",
"Milliseconds");this.pKe=new af(T+"-MaxRollingAverageValue","Milliseconds");this.hxe=new Vc(T+"-NumberOfEvents","Count");this.Psa=new hb.a(T+"-SlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.UT("CoAuthLatencySlowTargetValue",3E3),l.AFrameworkApplication.K.UT("CoAuthLatencySlowThresholdPercentile",95),this.Z_b);this.cOe=new hb.a(T+"-BrokenSlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.UT("CoAuthLatencyBrokenSlowTargetValue",5E3),l.AFrameworkApplication.K.UT("CoAuthLatencyBrokenSlowThresholdPercentile",
95),this.Z_b)}L0(T){this.Xte.aya(T);this.iKe.aya(T);this.pKe.aya(T);this.hxe.aya(T);this.Psa.aya(T);this.cOe.aya(T)}Tce(){this.Xte.oSa();this.iKe.oSa();this.pKe.oSa();this.hxe.oSa();this.Psa.oSa();this.cOe.oSa();this.Xte.HSa();this.iKe.HSa();this.pKe.HSa();this.hxe.HSa();this.Psa.HSa();this.cOe.HSa()}}Object(f.a)(Mg,"ReplicationLatencyMetrics",null,[]);class We{constructor(){this.YIe=new Qb.a}x8i(T,Aa,ib){if(!(0>Aa)){if(!({value:Tb}=this.YIe.Dc(T,Tb)).returnValue){var Tb=new Mg(T,ib);this.YIe.Z(T,
Tb)}Tb.L0(Aa)}}Tce(){for(const T of this.YIe.values)T.Tce()}}Object(f.a)(We,"ReplicationTelemetryMetricsManager",null,[2012]);class Jh{x8i(){}Tce(){}}Object(f.a)(Jh,"ReplicationTelemetryMetricsManagerStub",null,[2012]);class pi{constructor(T,Aa,ib,Tb,xc,ld,Sd){this.BYa=this.bxd=0;this.Qbk=T;this.fOe=ib;this.Sih=Tb;this.IMg=xc;this.m_b=Aa;this.Rbk=ld;this.Z_b=Sd}oee(T){this.Qbk.x8i(this.fOe,T,this.Z_b);T>this.Sih&&this.m_b.EKo(this.fOe,this.Sih,T);this.bxd+=T;this.BYa++;this.bxd/this.BYa>this.IMg&&
this.BYa>this.Rbk&&this.m_b.OJk(this.fOe,this.IMg,this.bxd/this.BYa)}}Object(f.a)(pi,"TimeSpanVerifier",null,[2028]);class Yj{constructor(T,Aa){this.Qhk=T;this.m_b=Aa}create(T,Aa,ib,Tb,xc){return new pi(this.Qhk,this.m_b,T,Aa,ib,Tb,xc)}}Object(f.a)(Yj,"TimeSpanVerifierFactory",null,[2011]);class Zk extends Sys.EventArgs{constructor(T,Aa,ib){super();this.Zcj=T;this.bme=Aa;this.actualValue=ib}}Object(f.a)(Zk,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class sj{constructor(){this.ra=new M.a}EKo(T,
Aa,ib){this.ra.raiseEvent("TSVTE",new Zk(T,Aa,ib))}OJk(T,Aa,ib){this.ra.raiseEvent("TSVATE",new Zk(T,Aa,ib))}izk(T){this.ra.addHandler("TSVTE",T)}Uxk(T){this.ra.addHandler("TSVATE",T)}}Object(f.a)(sj,"TimeSpanVerifierNotifier",null,[2009]);class tk{constructor(){this.W=this.Fa=null}get name(){return"Box4.ReplicationTelemetry"}xc(T){this.Fa=T.resolve("Common.IAppSettingsManager");this.W=T;if(this.Fa.$("Box4ReplicationTelemetryIsEnabled")){T.ha("ReplicationTelemetry.IPerfTrackerFactory",()=>new nb(cb.App.xa.Hq,
Ia.a.eF(20,1,new Va.a))).singleInstance();T.ha("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new sj).singleInstance();this.Fa.$("Box4ReplicationTelemetryMetricsIsEnabled")?T.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new We).singleInstance():T.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new Jh).singleInstance();T.ha("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new Yj(T.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),T.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).singleInstance();
T.ha("ReplicationTelemetry.OutboundOperationFactory",()=>new Eo(T.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),tk.H8h)).singleInstance();T.ha("ReplicationTelemetry.OutboundMonitorFactory",()=>new Yd(T.resolve("ReplicationTelemetry.OutboundOperationFactory"),T.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).singleInstance();T.ha("ReplicationTelemetry.InboundOperationFactory",()=>new jm(T.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),
tk.H8h)).singleInstance();var Aa=new ve(T.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),T.resolve("ReplicationTelemetry.InboundOperationFactory"),T.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),ib=this.Fa.$("ComponentStateLoggingPackageIsEnabled")?this.W.Sa("Common.IComponentStateLogManager"):null;T.ha("ReplicationTelemetry.IInboundMonitor",()=>Aa.create(this.Fa.mc("Box4ReplicationTelemetryInboundOperationThreshold",0),this.Fa.mc("Box4ReplicationTelemetryInboundOperationAverageThreshold",
0),this.Fa.mc("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.Fa.mc("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),ib)).singleInstance();T.ha("Common.IRandomSamplerFactory",()=>new yg).singleInstance();T.ha("ReplicationTelemetry.ReplicationTelemetryManager",()=>new nc(T.resolve("ReplicationTelemetry.OutboundMonitorFactory"),T.resolve("ReplicationTelemetry.IInboundMonitor"),T.resolve("Common.IRandomSamplerFactory"))).singleInstance();T.ha("ReplicationTelemetry.EventForwarderFactory",
()=>new Cc(Hb.a.instance,T.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),T.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.Fa.$("Box4ReplicationTelemetryIsEnabled")){var T=this.Fa.mc("Box4ReplicationTelemetrySamplePercent",0),Aa=this.Fa.mc("Box4ReplicationTelemetryPhaseSamplePercent",0),ib=this.Fa.mc("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Tb=this.Fa.mc("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),xc=this.Fa.mc("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",
0),ld=this.Fa.mc("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),Sd=this;this.W.Sa("Box4.Presence.IRtcProxyProvider").execute(De=>{De.OD().continueWith(()=>{const Ff=De.OD().result,Wg=Sd.W.resolve("ReplicationTelemetry.ReplicationTelemetryManager");Wg.init(Ff,T,Aa,ib,Tb,xc,ld);Sd.W.resolve("ReplicationTelemetry.EventForwarderFactory").create(Ff,Wg);if(Sd.Fa.$("LogSteppedInboundFrameIsEnabled")){const Vh=sk.a.zp(Sd.W.Sa("Common.ICpuMeterProvider"));Vh.continueWith(()=>
{const zk=Sd.W.resolve("ReplicationTelemetry.IInboundMonitor");var Wi=new ya.a(()=>!0);Wi=Ia.a.eF(19,1,Wi);zk.initialize(Wi);const dk=Vh.result.$p.task;dk.continueWith(()=>{dk.result.lzd(0,()=>zk.GTe,mo=>{zk.Unn(mo)});dk.result.lzd(1,mo=>zk.wuo(mo),()=>{zk.Tnn()})})})}ra.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var df=this;l.AFrameworkApplication.cI(()=>{df.W.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").Tce()})}}dispose(){}static H8h(){const T=cb.App.rd;
return T?T.mVh:0}}Object(f.a)(tk,"ReplicationTelemetryPackage",null,[1,2]);var Qm=c(945),Li=c(12),km=c(127),Kg=c(3),sf=c(84),he=c(61),oe=c(211),$e=c(17),fe=c(23),El=c(8),Im=c(2048);class Yh{static get Yg(){return k.a.vA(Yh.Km,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}Yh.Km="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(f.a)(Yh,"InsertSymbolsDialogHtml",null,[]);class Kk extends Im.a{constructor(T,Aa,ib){super();this.QWb=this.vMa=this.Vcb=null;this.TEe=0;this.EDm=Tb=>{1===Tb?(this.EUf("symbol_d_"+Kk.twc),this.Ub.pL(this.UK,!0),this.Ub.Ts().fk.Ly(this.$G),this.$G.focus()):this.hide()};this.Ixj=Tb=>{if(Tb.target!==this.QWb){const xc=this.Ub.Ts();xc&&xc.fk&&(xc.fk.Ly(Tb.target),this.QWb=Tb.target)}this.Sun(Tb.target.id)};this.WGo=Tb=>{const xc=Tb.xf;if("a"!==xc.tagName.toLowerCase())return!1;Tb.eventName===W.a.pB&&
this.EUf(xc.id);this.Ub.pL(this.UK,!0);this.Ub.Ts().fk.Ly(xc);xc.focus();return!0};this.YGo=Tb=>{var xc=Tb.xf;if("a"!==xc.tagName.toLowerCase())return!1;const ld=parseInt(xc.id.substr(xc.id.lastIndexOf("_")+1));if(Tb.Hb.ctrlKey||Tb.Hb.altKey||Tb.Hb.keyCode>=gk.a.jSb&&Tb.Hb.keyCode<=gk.a.kSb)return!1;if(Tb.eventName===W.a.ai){Tb=Tb.Hb.keyCode;let Sd=-1;Tb===Sys.UI.Key.enter?(this.EUf(xc.id),this.Ub.pL(this.UK,!0),this.Ub.Ts().fk.Ly(xc),xc.focus()):Tb===Sys.UI.Key.up?Sd=ld-15:Tb===Sys.UI.Key.down?Sd=
ld+15:Tb===Sys.UI.Key.left?Sd=l.AFrameworkApplication.isRtl?ld+1:ld-1:Tb===Sys.UI.Key.right&&(Sd=l.AFrameworkApplication.isRtl?ld-1:ld+1);0<=Sd&&(xc=this.Luf("symbol_d_"+Sd))&&xc.focus()}return!0};this.ga=T;this.Ub=Aa;this.Wcb=ib;this.Ee(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ee(0,CommonUIStrings.l_DialogClose);this.N$=!1;this.Yg=Yh.Yg;this.wg="InsertSymbolsDialog"}dispose(){0<Kk.WVe&&ra.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",
this.TEe,Kk.WVe);Kk.lSg++;ra.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",Kk.lSg);this.ga=this.Wcb=null;super.dispose()}tTa(){this.Wh(Box4Intl.Box4Strings.L_SymbolSingle,this.EDm,null);this.TEe=0;Kk.rSg++;ra.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",Kk.rSg);const T=this.Luf("symbol_d_"+Kk.twc);T&&T.focus()}hide(){var T=document.getElementById("symbolsContainer");if(T&&(T=T.getElementsByTagName("a")))for(let Aa=0;Aa<T.length;Aa++)U.a.removeHandler(T[Aa],
W.a.focus,this.Ixj);super.hide()}get Pkb(){return Kk.zwc}set Pkb(T){Kk.zwc=T}get Lkb(){return Kk.lwc}set Lkb(T){Kk.lwc=T}k9(){super.k9();var T=document.getElementById("symbolsContainer");if(T&&(T.innerHTML=this.Wcb.pOk(),T=T.getElementsByTagName("a")))for(let Aa=0;Aa<T.length;Aa++)U.a.addHandler(T[Aa],W.a.focus,this.Ixj)}bma(){const T=document.getElementById("symbolsContainer");T&&(this.Vcb||(this.Vcb=this.WGo,this.Mq.nb(W.a.click,T,this.Vcb),this.Mq.nb(W.a.pB,T,this.Vcb)),this.vMa||(this.vMa=this.YGo,
this.ae.nb(W.a.ai,T,this.vMa),this.ae.nb(W.a.ju,T,this.vMa),this.ae.nb(W.a.uh,T,this.vMa)));super.bma()}Qfb(){const T=document.getElementById("symbolsContainer");T&&(this.Vcb&&(this.Mq.sc(W.a.click,T,this.Vcb),this.Mq.sc(W.a.pB,T,this.Vcb),this.Vcb=null),this.vMa&&(this.ae.sc(W.a.ai,T,this.vMa),this.ae.sc(W.a.ju,T,this.vMa),this.ae.sc(W.a.uh,T,this.vMa),this.vMa=null));super.Qfb()}get Gxf(){return!0}Sun(T){this.Onj("symbol_d_"+Kk.twc,!1);Kk.twc=parseInt(T.substr(T.lastIndexOf("_")+1));this.Onj(T,
!0);if(T=document.getElementById("SymbolNameValueLabel")){const Aa=this.GSd(Kk.twc);T.innerText=Aa.altText}}GSd(T){const Aa=this.Wcb.fle.Mhg.value,ib=Kc.a(Aa);return Aa[ib[T]]}EUf(T){this.TEe++;Kk.WVe++;T=parseInt(T.substr(T.lastIndexOf("_")+1));const Aa=this.GSd(T),ib={};ib.SourceControlId="symbol_"+T+"_"+Aa.cle;this.ga.Qb(Kg.a.njb,2,ib);ra.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",T)}Luf(T){const Aa=document.getElementById("symbolsContainer");return Aa?Aa.querySelector("#"+
T):null}Onj(T,Aa){if(T=this.Luf(T))Aa?(T.setAttribute("selected","true"),T.setAttribute("aria-selected","true"),T.tabIndex=0):(T.removeAttribute("selected"),T.setAttribute("aria-selected","false"),T.tabIndex=-1)}}Kk.twc=0;Kk.zwc=null;Kk.lwc=null;Kk.rSg=0;Kk.lSg=0;Kk.WVe=0;Object(f.a)(Kk,"InsertSymbolsDialog",Im.a,[]);class bf{constructor(T,Aa,ib,Tb,xc,ld,Sd){this.dfm=()=>this.Wcb.gPk();this.$5i=(df,De,Ff,Wg,Vh)=>{if(1===Ff)return 32;df=this.Wcb.N0i(Vh);df=String.format(this.Wcb.XGo,df.character);
Vh[Qm.a.InnerHTML]=df;Vh[Qm.a.On]=!1;return 32};this.UPa=(df,De,Ff,Wg,Vh)=>{if(({he:df,selected:Ff,UPa:dk}=this.pJc(De,Ff)).returnValue)return dk;var zk=$e.SelectionEditor.gf(Ff);let Wi=!0;Ff=8;var dk=this.Ic.Oc(15);dk.Cb(df.Yc);zk||(Ff=this.ga.Mf(De,Kg.a.Oma,2,!0,Wg,null),De=32===Ff,ra.ULS.shipAssertTag(6407387,348,De,"DeleteForReplace did not succeed. Response is {0}",Ff),Wi=De);Wi&&(De=df.lb.tg,zk=$e.SelectionEditor.gf(De),ra.ULS.shipAssertTag(6407388,348,zk,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",
De.contextId),Ff=8,zk&&(Ff=this.ga.Mf(De,Kg.a.njb,2,!1,Wg,Vh),ra.ULS.shipAssertTag(6407389,348,32===Ff,"Insertion at IP context did not succeed. Response is {0}",Ff),32===Ff&&ji.FocusManager.instance().mg(df.hJ)));dk.dispose();return Ff};this.DDm=(df,De,Ff,Wg,Vh)=>{if(1===Ff)return 32;if($e.SelectionEditor.E2a(De))return 2;df=this.Wcb.N0i(Vh);Wg.xs=df.index;Wg=this.Wc.Vf(De.node);Ff=Wg.zb(11);ra.ULS.shipAssertTag(6379466,324,Ff,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",
km.a[De.node.type]);Ff=this.Ic.Oc(15);Ff.Lt(Wg);bf.characterPropertiesEditor.replaceTextRange(De,df.character,!0,!1);De=fe.SelectionFactory.pe(Wg.currentNode,De.cpBegin+1);this.hb.setSelection(De);Ff.dispose();return 32};this.PLb=(df,De,Ff,Wg,Vh)=>{if(1===Ff)return 32;Vh.MenuItems=this.Ylk.value;return 32};this.Jxj=(df,De,Ff)=>{({UPa:df}=this.pJc(De,Ff));return df};this.Bsj=(df,De,Ff)=>{2===Ff&&(new Kk(this.ga,ji.FocusManager.instance(),sa.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).tTa();
return 32};this.X1f=()=>32;this.ga=T;this.Wc=Aa;this.Ylk=new bb.a(this.dfm);this.Ic=ib;this.Wcb=Tb;this.Jk=xc;this.hb=ld;this.Sm=Sd}Tb(){this.ga.eb(Kg.a.X1f,Li.a.application,this.X1f,96);this.ga.qa(Kg.a.PLb,Li.a.view,this.PLb);this.ga.qa(Kg.a.ele,Li.a.view,this.Jxj);this.ga.qa(Kg.a.ace,Li.a.view,this.$5i);this.ga.qa(Kg.a.njb,Li.a.view,this.UPa);this.ga.qa(Kg.a.PLb,Li.a.Tc,this.PLb);this.ga.qa(Kg.a.ele,Li.a.Tc,this.Jxj);this.ga.qa(Kg.a.ace,Li.a.Tc,this.$5i);this.ga.qa(Kg.a.njb,Li.a.Tc,this.DDm);this.ga.Vc(Kg.a.PLb,
1124);this.ga.Vc(Kg.a.ele,1036);this.ga.Vc(Kg.a.ace,1124);this.ga.Vc(Kg.a.njb,1036);l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&(this.ga.qa(Kg.a.bTc,Li.a.view,this.Bsj),this.ga.qa(Kg.a.bTc,Li.a.Tc,this.Bsj),this.ga.Vc(Kg.a.bTc,1124))}pJc(T,Aa){let ib,Tb=null;T.view.te&&(Tb=T.view);ib=null;if(!Tb||!Tb.lb)return I.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",T.toString()),
{returnValue:!0,he:Tb,selected:ib,UPa:8};ib=Tb.lb.tg;if(!ib)return{returnValue:!0,he:Tb,selected:ib,UPa:2};if(this.Jk.k_(ib)||this.Jk.uha(ib))return{returnValue:!0,he:Tb,selected:ib,UPa:8};if(Tb.lb.gb.wJ||this.Sm&&this.Sm.instance&&this.Sm.instance.pU(ib)||$e.SelectionEditor.E2a(T.gk))return{returnValue:!0,he:Tb,selected:ib,UPa:2};if(bf.Xg.sza(El.ParagraphReader.kU,ib))return T=8,bf.Jc.Yb(sf.a.kf,{["Reason"]:he.a.hO}),{returnValue:!0,he:Tb,selected:ib,UPa:T};T=32;return 1===Aa?{returnValue:!0,he:Tb,
selected:ib,UPa:T}:{returnValue:!1,he:Tb,selected:ib,UPa:T}}static get characterPropertiesEditor(){return bf.Kd||(bf.Kd=sa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(T){bf.Kd=T}static get Xg(){return oe.ContextSetEditor.instance}static get Jc(){return Ig.a.instance}}bf.Kd=null;Object(f.a)(bf,"SymbolsActor",null,[1981]);class tf{constructor(T,Aa){this.cle=T;this.altText=Aa}}Object(f.a)(tf,"Symbol",null,[]);class Ep{constructor(){this.xUe=null;this.fih=
new bb.a(Ep.Tbf)}get Mhg(){return this.fih}Sai(T){this.xUe||(this.xUe=Kc.a(this.fih.value));return Array.indexOf(this.xUe,T)}static Tbf(){const T={};T["\u2022"]=new tf("\u2022",Box4Intl.Box4Strings.L_Bullet);T["\u20ac"]=new tf("\u20ac",Box4Intl.Box4Strings.L_EuroSign);T["\u00a3"]=new tf("\u00a3",Box4Intl.Box4Strings.L_PoundSign);T["\u00a5"]=new tf("\u00a5",Box4Intl.Box4Strings.L_YenSign);T["\u00a9"]=new tf("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);T["\u00ae"]=new tf("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);
T["\u2122"]=new tf("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);T["\u00b1"]=new tf("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);T["\u2260"]=new tf("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);T["\u2264"]=new tf("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);T["\u2265"]=new tf("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);T["\u00f7"]=new tf("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);T["\u00d7"]=new tf("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);T["\u221e"]=new tf("\u221e",
Box4Intl.Box4Strings.L_Infinity);T["\u00b5"]=new tf("\u00b5",Box4Intl.Box4Strings.L_MicroSign);T["\u03b1"]=new tf("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);T["\u03b2"]=new tf("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);T["\u03c0"]=new tf("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);T["\u03a9"]=new tf("\u03a9",Box4Intl.Box4Strings.L_OhmSign);T["\u03a3"]=new tf("\u03a3",Box4Intl.Box4Strings.L_NArySummation);T["\u00b0"]=new tf("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);
T["\u0394"]=new tf("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);T["\u263a"]=new tf("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);T["\u2665"]=new tf("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);T["\u20b9"]=new tf("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);T["\u00bf"]=new tf("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);T["\u00a1"]=new tf("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);T["\u2014"]=new tf("\u2014",Box4Intl.Box4Strings.L_EmDash);T["\u2026"]=new tf("\u2026",
Box4Intl.Box4Strings.L_HorizontalEllipsis);T["\u00c0"]=new tf("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);T["\u00c1"]=new tf("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);T["\u00c2"]=new tf("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);T["\u00c3"]=new tf("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);T["\u00c4"]=new tf("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);T["\u00c5"]=new tf("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);
T["\u00c6"]=new tf("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);T["\u00c7"]=new tf("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);T["\u00c8"]=new tf("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);T["\u00c9"]=new tf("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);T["\u00ca"]=new tf("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);T["\u00cb"]=new tf("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);T["\u00cc"]=
new tf("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);T["\u00cd"]=new tf("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);T["\u00ce"]=new tf("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);T["\u00cf"]=new tf("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);T["\u00d1"]=new tf("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);T["\u00d2"]=new tf("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);T["\u00d3"]=new tf("\u00d3",
Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);T["\u00d4"]=new tf("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);T["\u00d5"]=new tf("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);T["\u00d6"]=new tf("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);T["\u00d9"]=new tf("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);T["\u00da"]=new tf("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);T["\u00db"]=new tf("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);
T["\u00dc"]=new tf("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);T["\u00df"]=new tf("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);T["\u00e0"]=new tf("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);T["\u00e1"]=new tf("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);T["\u00e2"]=new tf("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);T["\u00e3"]=new tf("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);T["\u00e4"]=new tf("\u00e4",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);T["\u00e5"]=new tf("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);T["\u00e6"]=new tf("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);T["\u00e7"]=new tf("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);T["\u00e8"]=new tf("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);T["\u00e9"]=new tf("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);T["\u00ea"]=new tf("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);
T["\u00eb"]=new tf("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);T["\u00ec"]=new tf("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);T["\u00ed"]=new tf("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);T["\u00ee"]=new tf("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);T["\u00ef"]=new tf("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);T["\u00f1"]=new tf("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);T["\u00f2"]=new tf("\u00f2",
Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);T["\u00f3"]=new tf("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);T["\u00f4"]=new tf("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);T["\u00f5"]=new tf("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);T["\u00f6"]=new tf("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);T["\u00f9"]=new tf("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);T["\u00fa"]=new tf("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);
T["\u00fb"]=new tf("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);T["\u00fc"]=new tf("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);T["\u00ff"]=new tf("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);T["\u011e"]=new tf("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);T["\u011f"]=new tf("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);T["\u0130"]=new tf("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);T["\u0131"]=
new tf("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);T["\u0152"]=new tf("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);T["\u0153"]=new tf("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);T["\u015e"]=new tf("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);T["\u015f"]=new tf("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);T["\u0178"]=new tf("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return T}}Object(f.a)(Ep,"SymbolsLoader",
null,[1979]);var Lk=c(399),hj=c(335),uk=c(205),eh=c(638),Og=c(1476),Re=c(159),we=c(88);class Gb{constructor(T){this.fle=T}get XGo(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}N0i(T){T=T.SourceControlId.split("_");const Aa={};2===T.length?(Aa.character=T[1],Aa.index=this.fle.Sai(Aa.character)):(Aa.character=T[2],Aa.index=parseInt(T[1]));return Aa}gPk(){return this.Lhi()}build(){return this.efm()}pOk(){const T=new Sys.StringBuilder;T.append('<table class="moreSymbolsTable">');
const Aa=this.fle.Mhg.value,ib=Kc.a(Aa);let Tb=0;for(;Tb<ib.length;){Tb%15||T.append('<tr role="presentation">');const xc=Aa[ib[Tb]];T.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="-1" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',"symbol_d_"+Tb,Ta.a.QX(xc.cle),Ta.a.QX(xc.altText)));Tb++;Tb%15&&Tb!==ib.length||T.append("</tr>")}T.append("</table>");return T.toString()}efm(){const T=
this.Lhi();return Re.o(T)}Lhi(){const T=Object.assign(new Lk.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});T.MenuSectionList.push(this.Yvk());l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&T.MenuSectionList.push(this.duk());return T}duk(){const T=Object.assign(new hj.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),Aa=Object.assign(new uk.a,{Id:"btnMoreSymbols",Command:Kg.a.bTc.toString(),LabelText:Ta.a.yf(Box4Intl.Box4Strings.L_InsertMoreSymbols),
Alt:Ta.a.yf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:l.AFrameworkApplication.Ws,Image16by16Class:we.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});T.ControlList.push(Aa);return T}Yvk(){const T=Object.assign(new hj.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),Aa=Object.assign(new eh.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",
GalleryItems:[]}),ib=this.fle.Mhg.value,Tb=Kc.a(ib),xc=Math.min(25,Tb.length);for(let Sd=0;Sd<xc;Sd++){var ld=ib[Tb[Sd]];ld=Object.assign(new Og.a,{Id:String.format("{0}{1}_{2}","symbol_",Sd,ld.cle),Character:ld.cle,Command:Kg.a.njb.toString(),QueryCommand:Kg.a.ace.toString(),Alt:Ta.a.yf(ld.altText)});Aa.GalleryItems.push(ld)}T.ControlList.push(Aa);return T}}Object(f.a)(Gb,"SymbolsUiBuilder",null,[1978]);var Ui=c(46),dp=c(233),qi=c(536),Fl=c(368);class $k{constructor(){this.W=null}get name(){return"Box4.Symbols"}init(){l.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&
this.W.resolve("Box4.Symbols.ISymbolsActor").Tb()}dispose(){}xc(T){this.W=T;this.W.register(Ep,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").singleInstance();this.W.ha("Box4.Symbols.SymbolsUiBuilder",()=>new Gb(this.W.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").singleInstance();this.W.ha("Box4.Symbols.SymbolsActor",()=>new bf(l.AFrameworkApplication.va,new qi.a,new Fl.a,this.W.resolve("Box4.Symbols.ISymbolsUIBuilder"),dp.a.instance,Ui.a.instance,
this.W.Sa("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").singleInstance()}static main(){L.a.instance.Fc(new $k)}}Object(f.a)($k,"Box4SymbolsPackage",null,[1,2]);var bn=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},
yq=c(1634),zq=c(1586),yr=c(1570),Aq=c(1960),Hn=c(228),Fp=c(400);class In{constructor(){this.cJa=null}xc(T){this.container=T}init(){this.cJa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.cJa&&this.cJa.dispose()}}Object(f.a)(In,"ALiveBooksAccessibilityCheckPackageManager",null,[1,2]);class vk{get q6k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get r6k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get s6k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get Jyn(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get Ofc(){return CommonUIStrings.l_AccCheckerPaneTitle}get gCn(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(f.a)(vk,"AccessibilityCheckStringsProvider",null,[54]);class go{constructor(){this.wgj=this.contentId=null}}Object(f.a)(go,"ResultIds",null,[]);class lj{constructor(T,Aa){this._element=null;this.ig=Aa;this.ae=T}get element(){this._element||(this._element=this.cal(),this.Fz());return this._element}Acg(T){this._element=T}dispose(){this.element&&(this.j$(),this.Acg(null))}Fz(){this.ig&&this.ae?(this.ig.nb(W.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ae.nb(W.a.ai,this.element,
Object(a.a)(this,this.HG,"onKeyPress"))):ra.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}j$(){this.ig&&this.ae&&(this.ig.sc(W.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ae.sc(W.a.ai,this.element,Object(a.a)(this,this.HG,"onKeyPress")))}onClick(){this.DVi();return!0}HG(T){return this.UNm(T.Hb.keyCode)?(this.DVi(),!0):!1}UNm(T){return T===gk.a.Yoe||T===gk.a.Fs}}
Object(f.a)(lj,"AInteractivePaneElement",null,[205,10]);var tj=c(443),fi=c(54);class lb extends lj{constructor(T,Aa,ib){super(T,Aa);this.eMe=ib}hide(){this.element.removeAttribute($f.a.qh);$f.a.hr(this.element,$f.a.mA,$f.a.lp);this.element.style.display="none"}show(){$f.a.hr(this.element,$f.a.mA,$f.a.fM);$f.a.hr(this.element,$f.a.qh,$f.a.A2e);this.element.style.display="block"}cal(){const T=tj.b("div",this.WRi,"AccCheckerNotification");$f.a.hr(T,$f.a.fvh,$f.a.lp);$f.a.hr(T,$f.a.zfa,this.ERf);T.tabIndex=
0;const Aa=tj.b("span",this.VRi,"AccCheckerNotificationIcon");var ib=we.createClusteredImage(16,16,"Info_16x16x32","",!0,"");Aa.appendChild(ib);ib=tj.b("span",this.ERf,"AccCheckerNotificationText");fi.a.Jy(ib,this.XRi);T.appendChild(Aa);T.appendChild(ib);return T}DVi(){this.eMe()}}Object(f.a)(lb,"APopupNotification",lj,[247,205,10]);class vc extends lb{constructor(T,Aa,ib,Tb){super(T,Aa,ib);this.ita=Tb}get WRi(){return"AccCheckerOutOfSyncNotificationId"}get VRi(){return"AccCheckerOutOfSyncNotificationIconId"}get ERf(){return"AccCheckerOutOfSyncNotificationTextId"}get XRi(){return this.ita.Jyn}}
Object(f.a)(vc,"OutOfSyncNotification",lb,[]);class fd extends lb{constructor(T,Aa,ib,Tb){super(T,Aa,ib);this.ita=Tb}get WRi(){return"AccCheckerPartialResultNotificationId"}get VRi(){return"AccCheckerPartialResultNotificationIconId"}get ERf(){return"AccCheckerPartialResultNotificationTextId"}get XRi(){return this.ita.gCn}}Object(f.a)(fd,"PartialResultNotification",lb,[]);var Md=c(184),Wc=c(31),Cf=c(170);class $c{constructor(T,Aa,ib,Tb=null,xc=null,ld=null,Sd=null){this.vdh=this.YL=this.ae=this.cJa=
null;this.e0=Tb;this.ig=T;this.Ub=Aa;this.fp=ib;this.ita=Sd||new vk;this.TMe=xc||new vc(this.e0,this.ig,Object(a.a)(this,this.jol,"dimissOutOfSyncNotification"),this.ita);this.JNe=ld||new fd(this.e0,this.ig,Object(a.a)(this,this.kol,"dimissPartialResultNotification"),this.ita)}show(){}hide(){}get e0(){return this.ae||(this.ae=l.AFrameworkApplication.ta.hD)}set e0(T){this.ae=T}jLh(){}$na(){}dispose(){}V7a(){}CFm(T){var Aa=this.vdh[T];T=Aa.contentId;if((Aa=Aa.wgj+"")&&Aa.length){const ib=[];Array.add(ib,
Object.assign(new Wc.a,{name:"RuleID",string:Aa}));Md.a.sendTelemetryEvent(Object.assign(new Cf.a,{name:String.format("{0}.{1}",$c.Kig,"ViolationSelected"),dataFields:ib}))}this.Sgn(T)}Sgn(T){T&&this.cJa.ujo(T)||(this.Ub.pL(Bd.AFrame.umh,!1),this.Fwo())}jol(){this.J8c(!1)}kol(){this.tsj(!1)}Fwo(){const T=Object.assign(new fc.StandardDialog(!0),{Et:l.AFrameworkApplication.hca,Ad:1,NHa:!1});T.$U(1);T.Ee(1,this.ita.q6k);T.Ee(0,CommonUIStrings.l_DialogCancel);T.cV(this.ita.s6k,this.ita.r6k,Aa=>{1===Aa&&
this.DBf()})}lPk(T){let Aa=null;if(T.Results&&0<T.Results.length){Aa={};let ib=0;for(const Tb of T.Results)Tb.ResultId=$c.eqk+ ++ib,T=new go,T.contentId=Tb.ContentId,T.wgj=Tb.RuleId,Aa[Tb.ResultId]=T}return Aa}X7m(){Md.a.addNamespaceMapping($c.Kig,$c.mJo);Md.a.sendTelemetryEvent(Object.assign(new Cf.a,{name:String.format("{0}.{1}",$c.Kig,"ShowTaskpane")}))}}$c.eqk="AccCheckResult";$c.Kig="Office.UX.AccChecker";$c.mJo="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(f.a)($c,
"BaseAccessibilityCheckPane",null,[56,10]);class fh{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(f.a)(fh,"AccCheckerTaskPaneProps",null,[]);var Df=c(1394),sd=c(1409),Ug=c(1050),Kj=c(176);class nh extends $c{constructor(T,Aa,ib,Tb,xc=null,ld=null,Sd,df=null,De=null){super(Aa,
ib,Tb,ld,void 0,void 0,df);this.PKg=null;this.ich=this.INe=this.Iqd=this.Vtd=this.qtd=!1;this.WWe=null;this.SUe=!!l.AFrameworkApplication.ta&&!!l.AFrameworkApplication.ta.Nb&&l.AFrameworkApplication.ta.Nb.WGf;this.wtc=this.Q5=null;this.huc=0;this.Ekd=null;this.XY=xc;De&&(this.Q5=De.Qyd,this.wtc=De.khp,this.huc=De.vip);this.hB=new sd.a}get isVisible(){return this.ich}pTa(T){this.ich=T}Nff(T){T&&(this.PKg=T,T.IsSuccess&&(this.vdh=this.lPk(T),T.IsPartialResult&&this.tsj(!0)),this.qtd=!0,this.Vtd=!1,
this.Cm())}J8c(T){this.isVisible&&T!==this.Iqd&&(this.Iqd=T,this.Cm())}tsj(T){this.INe=T;this.Cm()}pP(){this.Vtd||Kj.UISurfaces.Gu().then(T=>{va.a.instance.ez(nh.krb+":PaneOpen:Start");T.showTaskPane(nh.krb,this.pA());this.DBf();return null});this.isVisible?Kj.UISurfaces.Gu().then(T=>{T.setSelectedTaskPane(nh.krb);return null}):this.X7m()}Cm(){Kj.UISurfaces.Gu().then(T=>{T.updateTaskPane(nh.krb,this.pA());return null})}pA(){var T=new fh;this.hB.Cob(T);T=Object.assign(new Ug.a,{title:this.ita.Ofc,
hideHeader:!1,width:320,location:2,contentProps:T,onOpen:()=>{this.O9();this.pTa(!0);l.AFrameworkApplication.ta.updateCommandUI()},onClose:()=>{this.mda();this.pTa(!1);this.Vtd=this.qtd=!1;this.Cm();l.AFrameworkApplication.ta.updateCommandUI()},isModernPane:!0});this.SUe&&(T.enableResize=!0,T.minResizeWidth=268,T.maxResizeWidth=920);return T}initialize(T){const Aa=this.Ub.fe(nh.krb);Aa.parent=Bd.AFrame.rp;Aa.RH=!0;this.cJa=T;this.irk()}dispose(){this.V7a();this.TMe&&(this.TMe.dispose(),this.TMe=null);
this.JNe&&(this.JNe.dispose(),this.JNe=null);super.dispose()}irk(){this.hB.qL(this.onRecheckExecute());this.hB.qL(this.FLl());this.hB.qL(this.Sam());this.hB.qL(this.onInvokeNavigateExecute());this.hB.qL(this.b_l());this.hB.qL(this.V6l());this.hB.qL(this.O8l());this.hB.qL(this.updateLastScanTime());this.hB.qL(this.showHelpPane())}onRecheckExecute(){return T=>{T.onRecheckExecute=()=>{this.DBf()}}}FLl(){return T=>{T.accessibilityCheckResultCollection=this.PKg}}Sam(){return T=>{T.resultsReady=this.qtd}}onInvokeNavigateExecute(){return T=>
{T.onInvokeNavigateExecute=Aa=>{this.CFm(Aa)}}}b_l(){return T=>{T.helpLink=this.Tzl}}V6l(){return T=>{T.outOfSync=this.Iqd}}O8l(){return T=>{T.partialResult=this.INe}}updateLastScanTime(){return T=>{T.updateLastScanTime=Aa=>{this.WWe=Aa}}}showHelpPane(){return T=>{T.showHelpPane=()=>{l.AFrameworkApplication.K&&l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?l.AFrameworkApplication.QK||this.Quh()?this.Ekd?this.Ekd():this.Q5.value&&this.wtc&&
this.huc&&this.Q5.value.Qb(this.huc,2,this.wtc):this.stj():this.Quh()?this.Ekd?this.Ekd():this.Q5.value&&this.wtc&&this.huc&&this.Q5.value.Qb(this.huc,2,this.wtc):this.stj()}}}Quh(){return!this.XY||!this.XY.value}stj(){const T=this.XY.value;if(T){var Aa={};Aa.query=nh.Vgk+nh.p6j;Aa=Object.assign(new Df.a,{vR:Aa});T.q5(nh.pDe,Aa)}}DBf(){this.INe=this.Iqd=this.qtd=!1;this.WWe&&this.WWe();this.Cm();this.Vtd=!0;this.cJa.Vmn()}O9(){this.Ub.mg(nh.krb)}mda(){this.v3a()&&this.Ub.mg(this.Ub.vT)}v3a(){return!!this.Ub.currentScope&&
this.Ub.currentScope.name===nh.krb}}nh.krb="AccessibilityCheckerPane";nh.p6j="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";nh.pDe="FA000000012";nh.Vgk="AssetID=";Object(f.a)(nh,"ReactAccessibilityCheckPane",$c,[]);class Hh extends nh{constructor(T,Aa,ib,Tb,xc,ld,Sd,df,De=null){super(T,Aa,ib,Tb,xc,ld,void 0,De);this.$2j=df;this.V2=Sd}get Tzl(){return this.$2j}pP(){this.V2.QNa();super.pP()}}Object(f.a)(Hh,"ReactLiveBooksAccessibilityCheckPane",nh,[]);var Bc=c(1143),Pg=c(139),yh=c(172),bi=c(60),Yi=c(156),ij=
c(500),Vd;(function(T){T[T.error=0]="error";T[T.warning=1]="warning";T[T.tip=2]="tip";T[T.intelligentService=3]="intelligentService"})(Vd||(Vd={}));Object(f.b)("AccessibilityRuleCategory",Vd);class le{constructor(T,Aa,ib=null){this.fse=null;this.B1g=this.k0g=!1;this.LMa=T;this.Xdd=Aa;this.ga=ib;this.pc.qa(n.a.S_k,y.a.frame,Object(a.a)(this,this.s8e,"closePane"))}get pc(){return this.ga||(this.ga=l.AFrameworkApplication.va)}set pc(T){this.ga=T}Yvl(){this.k0g||(this.LMa.initialize(this),this.Xdd.initialize(this),
this.k0g=!0)}Vmn(){I.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.Xdd.R$n()}pP(T,Aa,ib){if(1===ib)return Ah.SessionStatusManager.instance.Gj?8:32;this.LMa.isVisible||this.Yvl();this.iyo();return 32}s8e(T,Aa,ib){1!==ib&&this.LMa.$na();return 32}aun(){this.LMa.J8c(!0)}Nff(T){if(T){if(T.AccessibilityRules&&Object.keys(T.AccessibilityRules).length){const ib=T.AccessibilityRules;for(let Tb in ib){var Aa=Tb;const xc=ib[Tb].RuleId+"";Aa!==xc&&I.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
Aa,xc)}this.fse=ib}else!this.fse&&T.Results&&0<T.Results.length?(I.b(18993251,200,15,"No accessibility rule definitions available"),T.IsSuccess=!1):T.AccessibilityRules=this.fse;T.IsSuccess||I.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.o0n(T);this.I7m(T);this.LMa.Nff(T)}}o0n(T){const Aa=T.AccessibilityRules;if(T=T.Results)for(let ib=T.length-1;0<=ib;ib--){const Tb=T[ib];let xc="";const ld=Tb.RuleId;Tb.ContentName||(xc+="Result does not have content name. ");ld in Aa||(xc+=String.format("No accessibility check rule exists for ID {0}.",
ld));0<xc.length&&(I.b(36214999,200,15,"Omitting invalid accessibility check result: "+xc),Array.removeAt(T,ib))}}Zbm(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):sa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Uz.loadScript("accessibility-checker-pane-strings")}iyo(){this.B1g?this.LMa.pP():this.Zbm().then(()=>{this.B1g=!0;this.LMa.pP()}).catch(T=>ra.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
T))}I7m(T){var Aa={};const ib={};var Tb=T.Results,xc=[];Array.add(xc,Object.assign(new Wc.a,{name:"FinalViolationCount",int64:0}));Array.add(xc,Object.assign(new Wc.a,{name:"FinalErrorCount",string:"0"}));Array.add(xc,Object.assign(new Wc.a,{name:"FinalWarningCount",string:"0"}));Array.add(xc,Object.assign(new Wc.a,{name:"FinalTipCount",string:"0"}));Array.add(xc,Object.assign(new Wc.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Tb){for(const df of Tb)if(T.AccessibilityRules){var ld=T.AccessibilityRules[df.RuleId];
if(ld){if(Aa[Vd[ld.Category]]){let De=Aa[Vd[ld.Category]];Aa[Vd[ld.Category]]=++De}else Aa[Vd[ld.Category]]=1;ib[df.RuleId]?(ld=ib[df.RuleId],ib[df.RuleId]=++ld):ib[df.RuleId]=1}}xc[0].int64=Tb.length;for(var Sd in Aa)switch(T=Aa[Sd],Tb=Sd,Tb="Final"+Tb.charAt(0).toUpperCase()+Tb.substring(1,Tb.length)+"Count",Tb){case "FinalErrorCount":xc[1].string=T.toString();break;case "FinalWarningCount":xc[2].string=T.toString();break;case "FinalTipCount":xc[3].string=T.toString();break;case "FinalIntelligentServiceCount":xc[4].string=
T.toString()}}Md.a.sendTelemetryEvent(Object.assign(new Cf.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:xc}));for(let df in ib)Aa=df,xc=ib[df],Sd=[],Array.add(Sd,Object.assign(new Wc.a,{name:"RuleID",string:Aa})),Array.add(Sd,Object.assign(new Wc.a,{name:"FinalViolationCount",string:xc.toString()})),Md.a.sendTelemetryEvent(Object.assign(new Cf.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Sd}))}dispose(){this.LMa&&
this.LMa.dispose();this.Xdd&&this.Xdd.dispose()}}Object(f.a)(le,"AAccessibilityCheckManager",null,[53,10]);var ci=c(306);const uj=[12,14,22,19,30,43,44];class Gl extends le{constructor(T,Aa,ib,Tb,xc,ld){super(Aa,ib,T);this.pc.qa(n.a.ieg,y.a.frame,this.pP.bind(this));this.pc.eb(n.a.KNn,y.a.frame,this.b6i.bind(this),96);this.graph=xc;this.gck=Tb;this.z9j=ld;this.nfc=()=>{this.aun()};this.PXn()}b6i(T,Aa,ib,Tb,xc){if(1===ib)return 32;xc[ci.a.On]=this.LMa.isVisible;return 32}ujo(T){if(this.z9j)return ra.ULS.sendTraceTag(20713608,
334,15,"ODT file. Disable content navigation."),!0;ra.ULS.shipAssertTag(20272215,334,!!T);return this.gck.Mgn(T)}PXn(){for(const T of uj){const Aa=this.graph.Ze(T);Aa.Go(this.nfc);Aa.$t(this.nfc);Aa.Ax(this.nfc)}}eTo(){for(const T of uj){const Aa=this.graph.Ze(T);Aa.TU(this.nfc);Aa.SU(this.nfc);Aa.bqa(this.nfc)}}dispose(){super.dispose();this.eTo()}}Object(f.a)(Gl,"WordAccessibilityCheckManager",le,[]);var Eh=c(75),Ef=c(28),lf=c(98),Vi=c(18),Bq=c(163),lm=c(6),Yg=c(15),Ye=c(467);class vf{constructor(T,
Aa,ib,Tb,xc,ld,Sd){this.sm=null;this.SBb=0;this.Wc=Aa;this.dA=ib;this.hb=Tb;this.ga=xc;this.fd=ld;this.Yt=T;this.qd=Sd}get WR(){if(!this.sm){const T=this.Wc.Vf(this.Yt.Uc);this.dA.mlg(T);if(T.zb(7)||T.jd(7))this.sm=Eh.a.Rs(T,T.origin)}return this.sm}Mgn(T){if(!T||!T.Ag||0>=T.Ag.length)return ra.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var Aa=Array(T.Ag.length);let ib=7,Tb=null;for(let ld=0;ld<T.Ag.length;ld++)if(Tb=this.ZDl(T.Ag[ld])){if(7===ib)ib=this.SBb;else if(ib!==
this.SBb)return ra.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var xc=this.qd.VRa(Tb.characterData,Tb.pa);const Sd=T.cpBegin?this.qd.sBb(xc,T.cpBegin):-1;xc=T.cpEnd?this.qd.sBb(xc,T.cpEnd):-1;if(-1>Sd||-1>xc)return ra.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;Aa[ld]=Ef.a.mO(Sd,xc,!1,Tb);switch(T.contentType){case 5:if(!lf.a.ZQc(Aa[ld],!1))return!1;break;case 6:if(!Vi.ImageReader.i4(Aa[ld]))return!1;
break;case 7:Aa[ld]=Ef.a.mO(-1,-1,!1,Tb)}}else return!1;Aa=new Bq.Selection(Aa,!1);return this.joo(Tb,Aa,T.contentType)}ZDl(T){if(this.WR)for(this.WR.reset(),this.SBb=7;this.WR.moveNext();){var Aa=this.WR.currentNode.type;if(38===Aa||36===Aa||23===Aa)this.SBb=Aa;else if(12===Aa){Aa=this.WR.currentNode;const ib=Aa.ia(lm.a.Lc,0);if(T===ib)return Aa}}return null}Jhg(T){this.ga.processAction(Yg.a.xT,2);this.ga.processAction(Yg.a.D3,2);let Aa=2;switch(this.SBb){case 23:Aa=32;break;case 38:Aa=this.ga.Qb(Yg.a.R4a,
2,new Ye.a(T));break;case 36:Aa=this.ga.Qb(Yg.a.Qkb,2,new Ye.a(T));break;default:ra.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.SBb)}if(32===Aa)return!0;ra.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.SBb);return!1}joo(T,Aa,ib){if(this.Jhg(T)){T=this.Yt.yu;const Tb=this.hb.gb.kb;Tb&&Tb.equals(Aa)&&this.fd.rda(T,null);this.fd.rda(T,Aa);switch(ib){case 0:case 1:this.ga.processAction(Kg.a.ZNb,2);break;case 2:this.ga.processAction(Kg.a.C6c,
2);break;case 3:this.ga.processAction(Kg.a.zya,2)}return!0}return!1}}Object(f.a)(vf,"WordAccessibilityCheckNavigateManager",null,[2008]);class mm{constructor(T){this.cJa=null;this.aXg=T}get fileId(){return this.aXg?this.aXg():null}initialize(T){this.cJa=T}TTi(T){this.cJa.Nff(T)}}Object(f.a)(mm,"AAccessibilityCheckService",null,[55,10]);class Zn{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(T){T=Sys.Serialization.JavaScriptSerializer.deserialize(T);
const Aa=T.AccessibilityRules,ib={};if(Aa)for(let Tb=0;Tb<Aa.length;++Tb){const xc=Aa[Tb];ib[xc.Key]=xc.Value}T.AccessibilityRules=ib;return T}}Object(f.a)(Zn,"AccessibilityCheckResultCollection",null,[]);class kn extends mm{constructor(T){super(T);this.onFailure=(Aa,ib)=>{ra.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",ib);Aa=Object.assign(new Zn,{IsSuccess:!1});this.TTi(Aa)};this.onSuccess=Aa=>{Aa=kn.Qam(Aa);let ib=null;if(Aa)try{ib=this.Hll(Aa)}catch(Tb){ra.ULS.shipAssertTag(20730843,
334,!1,"AccChecker response data is invalid. [{0}]",Tb.message),ib=Object.assign(new Zn,{IsSuccess:!1})}else ra.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),ib=Object.assign(new Zn,{IsSuccess:!1});this.TTi(ib)}}dispose(){}static Qam(T){let Aa=null;T&&T.Ij&&(Aa=T.Ij[0]);return Aa?Aa.Body:null}}Object(f.a)(kn,"ALiveBooksAccessibilityCheckService",mm,[]);var pk=c(989),ep=c(229);class vm extends ep.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}fl(){return 56}static construct(T,
Aa){const ib=new vm;ib.FileId=T;ib.IsCoauthorable=Aa;return ib}}Object(f.a)(vm,"WordAccessibilityCheckRequest",ep.a,[]);class wm{}Object(f.a)(wm,"AccessibilityCheckRule",null,[]);var oc=c(181);class To{static parse(T){switch(Ta.a.Ug(T)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw T=String.format("Invalid Accessibility result category: {0}",T),oc.a.argument(T);}}}Object(f.a)(To,"AccessibilityRuleCategoryParser",null,[]);class Ic{constructor(){this.Category=
this.Text=this.Id=null}static rLo(T){const Aa=new wm;Aa.RuleId=T.Id;Aa.RuleName=T.Text;Aa.Category=To.parse(T.Category);return Aa}}Object(f.a)(Ic,"WordAccessibilityCheckRule",null,[]);class Uo{}Object(f.a)(Uo,"AccessibilityCheckResult",null,[]);class ek{constructor(){this.cpEnd=this.cpBegin=this.Ag=null;this.contentType=0}}Object(f.a)(ek,"WordAccessibilityCheckContentId",null,[]);const sn=T=>{switch(Ta.a.Ug(T)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;
case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};var ho=c(1601);class sc{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static pLo(T){const Aa=new Uo;Aa.RuleId=T.RuleId;Aa.ContentName=T.Label;const ib=new ek;ib.Ag=T.ParaId;ib.cpBegin=ho.b(T.OS);ib.cpEnd=ho.b(T.OE);ib.contentType=sn(T.ContentType);Aa.ContentId=ib;return Aa}}Object(f.a)(sc,"WordAccessibilityViolation",null,
[]);class hq{constructor(){this.Violations=this.Rules=null}static qLo(T){const Aa=new Zn;try{var ib={};if(T.Rules){for(let Tb=0;Tb<T.Rules.length;++Tb){const xc=Ic.rLo(T.Rules[Tb]);ib[xc.RuleId]=xc}Aa.AccessibilityRules=ib}if(T.Violations){const Tb=Array(T.Violations.length);for(ib=0;ib<T.Violations.length;++ib)Tb[ib]=sc.pLo(T.Violations[ib]);Aa.Results=Tb}Aa.IsPartialResult=!1;Aa.IsSuccess=!0}catch(Tb){ra.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",
Tb.message),Aa.IsSuccess=!1}return Aa}}Object(f.a)(hq,"WordAccessibilityCheckResult",null,[]);class wk extends kn{constructor(T,Aa,ib){super(T);this.Ftb=Aa;this.Iab=ib}R$n(){const T=Object.assign(new pk.a,{Eq:vm.construct(this.fileId,this.Iab),status:1,IG:"AccessibilityCheck"});this.Ftb(12,!1,this.onSuccess,this.onFailure,T,null,T)}Hll(T){T=ab.b(T);return hq.qLo(T)}}Object(f.a)(wk,"WordAccessibilityCheckService",kn,[]);class Sg extends In{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}xc(T){super.xc(T);
T.ha("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new Hh(l.AFrameworkApplication.va,Hn.a.instance,ji.FocusManager.instance(),Fp.a.instance,T.Ue("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),qf.KeyInputManager.instance,Bc.a.instance,l.AFrameworkApplication.K.jb("AccessibilityCheckerHelpUrl"))).singleInstance();T.ha("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new wk(()=>l.AFrameworkApplication.rootQuerySignature,ij.a.NQ,Pg.PageReader.instance.tQd(cb.App.xa.ib.Uc))).singleInstance();
T.ha("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new vf(cb.App.xa.ib,T.resolve("Box4.Graph.IGraphIteratorFactory"),yh.PageNavigator.instance,T.resolve("Box4.ISelectionManager"),l.AFrameworkApplication.va,bi.InteractiveViewManager.instance,T.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).singleInstance();T.ha("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new Gl(l.AFrameworkApplication.va,T.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),
T.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),T.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),cb.App.Xj.zl,Yi.App.kVc)).singleInstance()}init(){this.container.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>{In.prototype.init.call(this)})}}Object(f.a)(Sg,"WordAccCheckerPackageManager",In,[]);class Vo{constructor(T,Aa){this.aih=!1;this.HOo=()=>{this.GOo()};this.Pk=T;this.DI=Aa}M4a(T){T.CM.Xzk(this.HOo)}GOo(){!this.aih&&this.Pk&&(this.Pk.LFa?
this.DI?this.DI.execute(T=>{T.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):ra.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.aih=!0)}}Object(f.a)(Vo,"CoauthSurveyManager",null,[1977]);class tn{constructor(){this.Yt=this.W=null}get name(){return"WordEditor.CoauthSurveys"}init(){cb.App.xa&&(this.Yt=cb.App.xa.ib)&&(this.Yt.xwa?this.hja():this.Yt.sfa(()=>{this.hja()}))}hja(){var T=this.Yt.Uc;T&&(T=T.contentReplicator)&&
this.W.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").M4a(T)}dispose(){}xc(T){this.W=T;T.ha("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new Vo(T.resolve("WordEditor.IWordEditorCoauthManager"),T.Sa("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").singleInstance()}static main(){l.AFrameworkApplication.K.$("CoauthSurveysPackageIsEnabled")&&L.a.instance.Fc(new tn)}}Object(f.a)(tn,"WordEditorCoauthSurveyManagerPackage",null,[1,2]);var hd;(function(T){T[T.graphSpaceReplicatorNotSendingContent=
0]="graphSpaceReplicatorNotSendingContent";T[T.inboundRequestTakesTooLongToSendAfterRTC=1]="inboundRequestTakesTooLongToSendAfterRTC";T[T.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(hd||(hd={}));Object(f.b)("ComponentLoggingScenario",hd);var Rm=c(1457);class Fo{flush(T,Aa){const ib=this.YUl(T);ib.LoggingScenario=hd[Aa];Kc.a(ib).length?ra.ULS.sendTraceTag(594571986,3013,15,"{0}",ib):ra.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",
Rm.a[T.e_a])}YUl(T){const Aa={};if(!T)return Aa;const ib=new ic.a;for(ib.enqueue(T);!ib.isEmpty;){T=ib.dequeue();const Tb=Rm.a[T.e_a];try{Aa[Tb]=T.xA()}catch(xc){ra.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",Tb.toString(),{["Kind"]:"Exception",["Stack"]:xc.stack,["Message"]:xc.message,["FileName"]:xc.fileName,["LineNumber"]:xc.lineNumber})}if((T=T.oFd)&&T.length)for(const xc of T)!xc||Rm.a[xc.e_a]in Aa||ib.enqueue(xc)}return Aa}}
Object(f.a)(Fo,"ComponentStateLogManager",null,[1976]);class Wp{flush(){}}Object(f.a)(Wp,"NoOpComponentStateLogManager",null,[1976]);class Nl{constructor(){this.W=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.W.resolve("Common.IComponentStateLogManager")}dispose(){}xc(T){this.W=T;l.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?T.ha("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new Fo).as("Common.IComponentStateLogManager").singleInstance():
T.ha("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new Wp).as("Common.IComponentStateLogManager").singleInstance()}static main(){L.a.instance.Fc(new Nl)}}Object(f.a)(Nl,"WordEditorComponentStateLoggingPackage",null,[1,2]);var Xp=c(2049);class Sk{constructor(T,Aa,ib){this.Xf=T;this.dvd=Aa;this.gch=ib}xj(T,Aa,ib,Tb,xc,ld,Sd,df,De,Ff=null,Wg=!1,Vh=null,zk=null,Wi=null,dk=null,mo=!1){return this.gch?this.dvd.xj(T,Aa,ib,Tb,xc,ld,Sd,df,De,Ff,Wg,zk,Wi):this.Xf.xj(T,Aa,ib,Tb,xc,ld,Sd,
df,De,Ff,Wg,Vh,zk,Wi,dk,mo)}N8b(T){return this.gch?this.dvd.N8b():this.Xf.N8b(T)}}Object(f.a)(Sk,"ClientRequestAdapter",null,[918]);var Zj=c(227),al=c(250),Hl=c(218),If=c(1404),ik=c(310),vj=c(1415),nf=c(2050),ph=c(51),Cg=c(724),Ci=c(587),nm=c(105),jr=c(566),ka=c(599),db;(function(T){T[T.none=0]="none";T[T.getCells=1]="getCells";T[T.hotStoreStatus=2]="hotStoreStatus";T[T.saveMonitor=3]="saveMonitor";T[T.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";T[T.kickoutExecutor=5]="kickoutExecutor"})(db||
(db={}));Object(f.b)("MostRecentRevisionIdOrigin",db);class yb extends Sys.EventArgs{constructor(T,Aa,ib,Tb){super();this.mXc=T;this.httpStatusCode=ib;this.UH=Tb}}Object(f.a)(yb,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class Zb{constructor(){this.V6=0}get isEmpty(){return!this.V6}ZDc(T){this.V6|=T}RVc(T){return!!(this.V6&T)}clear(){this.V6=0}eGc(){return!1}}Object(f.a)(Zb,"DocxSaveMonitorRetryAttemptOnce",null,[]);class tc{constructor(T,Aa=3){this.V6=0;this.ttd=new Map;this.wbk=T;this.kik=
Aa}get isEmpty(){return!this.V6}ZDc(T){this.V6|=T;let Aa=this.ttd.get(T)||0;this.ttd.set(T,++Aa)}RVc(T){return!!(this.V6&T)}clear(){this.V6=0;this.ttd.clear()}eGc(T){return this.kik&T?(this.ttd.get(T)||0)<this.wbk:!1}}Object(f.a)(tc,"DocxSaveMonitorRetryAttemptMany",null,[]);class Pc{static create(T=!1,Aa=3,ib=0){return T?new tc(Aa,ib):new Zb}}Object(f.a)(Pc,"DocxSaveMonitorRetryAttemptFactory",null,[]);var Od=c(1720),ke;(function(T){T[T.Rkp=-1]="noResultYet";T[T.aqp=0]="upToDate";T[T.Cnp=1]="sessionLost";
T[T.gqp=2]="userSignedOut";T[T.qmp=3]="previousRequestPending";T[T.ree=4]="requestFailed";T[T.Vnp=5]="shuttingDown";T[T.Wkp=6]="nullResponseData";T[T.fjp=7]="invalidResponseData";T[T.ehp=8]="failedRevisionLookup";T[T.hnp=9]="savedWithinThreshold";T[T.Tkp=10]="notSavedWarning";T[T.yjp=11]="kickoutThreshold";T[T.Mpp=12]="unknownRevision";T[T.gfp=13]="contentNotYetLoaded";T[T.sessionExpired=14]="sessionExpired";T[T.canaryError=15]="canaryError";T[T.timeout=16]="timeout";T[T.zjp=17]="kickoutThreshold_Offline";
T[T.hgp=18]="dssSessionDeleted";T[T.igp=19]="dssSessionExpired";T[T.mqp=20]="waitingForSessionTokenRefresh";T[T.jgp=21]="dssSessionNotFound"})(ke||(ke={}));Object(f.b)("SaveMonitorResult",ke);class od{constructor(T,Aa,ib,Tb,xc,ld,Sd,df,De,Ff,Wg,Vh,zk,Wi,dk,mo,Kl,ig,Uk,no,pr,Ba,Qa,Fa,xa,Ya=null,Cb){this.Cxc=0;this.xWb=!1;this.fAc=null;this.kwc=this.MN=-1;this.GOe=null;this.Trd=0;this.Urd=!1;this.Zvb=null;this.jyc=0;this.rRe=this.djh=null;this.mS=this.w4g=this.qsc=0;this.UIe=null;this.E1g=!1;this.kl=
null;this.evd=0;this.Kwd=void 0;this.egh=!1;this.Gdh=0;this.hgh=this.jgh=!1;this.eFl=()=>{var Kb;ra.ULS.sendTraceTag(524871194,od.Pm,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.gR,["AppVisibilityState"]:If.a[null===(Kb=this.kl)||void 0===Kb?void 0:Kb.sC]});try{if(this.egh&&this.Mtc){var Rb=this.Mtc();ra.ULS.sendTraceTag(509367249,od.Pm,50,"Additional Details: {0}",Rb)}}catch(zc){Kb=ab.c({["Kind"]:"Exception",["Stack"]:zc.stack,["Message"]:zc.message,["FileName"]:zc.fileName,["LineNumber"]:zc.lineNumber}),
ra.ULS.sendTraceTag(509367062,od.Pm,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Kb)}Kb=this.gvb;this.gvb=this.Tz();if(this.V$())this.bA.event(5),this.stop("session has shut down");else if(this.Hab===od.hfj&&this.hza(this.ttb),Rb=this.Utc())if(this.jHe()&&l.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),this.gR)this.bA.event(0);else if(this.BWb())this.bA.event(1),this.stop("session is lost"),
l.AFrameworkApplication.ue("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.E1g&&!this.VNm()&&(ra.ULS.sendTraceTag(554726995,od.Pm,10,"DocxSaveMonitor: Session lost but not kicked out"),this.WC(ph.a.cUh));else if(this.jHe())20!==this.bA.currentState?(this.bA.event(20),this.djh=this.Tz(),ra.ULS.sendTraceTag(593510691,od.Pm,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",this.ejh)):this.Tz().getTime()-this.djh.getTime()>this.ejh&&
(this.bA.event(14),this.Q0d(20,ph.a.GJd,"TokenExpired"));else if(this.t$j())if(this.gvb=Kb,this.xWb)this.bA.event(3),this.Tz().getTime()-this.fAc.getTime()>this.dIe&&(Kb=this.Vve.N8b(this.MN),ra.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.MN,An.a[Kb]),this.ftd&&this.ftd.log(),this.stop("stuck on previousRequestPending"),this.WC());else if(Kb=Ci.b(Od.a.construct(Rb)),this.xWb=!0,this.fAc=this.Vhk(),this.MN=this.Vve.xj(od.serviceUrl,
2,Kb,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.oXk,this.nXk,null,void 0,void 0,this.Ygk,this.XRe,void 0,void 0,!0),0>=this.MN)this.xWb=!1,ra.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.MN.toString());else{Kb=this.Vve.N8b(this.MN);Rb=100;if(Kb&&1!==Kb||this.b_g)Rb=50;ra.ULS.sendTraceTag(19161612,od.Pm,Rb,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.MN,["Status"]:An.a[Kb]});this.ftd&&this.ftd.start(this.MN)}else this.bA.event(2);
else this.bA.event(13)};this.nXk=Kb=>{this.mS=this.xFd+1;let Rb=this.xWb=!1,zc=!1;Kb=Kb.data;wa.a.Wk&&l.AFrameworkApplication.Kha("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");Kb?(ra.ULS.sendTraceTag(22552773,od.Pm,15,"Request failed {0}",{["Status"]:Kb.status,["HttpStatus"]:Kb.Qe,["Correlation"]:Kb.Bj?Kb.Bj[ik.a.N7]:"",["Id"]:Kb.id,["ConsecutiveErrors"]:this.xFd,["Request.InvokedTime"]:Kb.KH,["Request.EnqueueTime"]:Kb.lOa,["Request.CompletedTime"]:Kb.nT}),zc=7===Kb.status||
13===Kb.status,this.eGc(2)&&zc?(this.uVa.ZDc(2),Rb=!0,this.kwc=Kb.Qe,this.bA.event(16)):this.eGc(1)&&5===Kb.status?(this.uVa.ZDc(1),Rb=!0,this.kwc=Kb.Qe,this.bA.event(15)):(this.bA.event(4),this.kwc=Kb.Qe)):(this.bA.event(4),ra.ULS.sendTraceTag(23425240,od.Pm,15,"RequestFailed and event data is null"));if(!Rb&&(this.uVa.clear(),zc?this.Q0d(17,ph.a.Xrl,"while offline"):this.Q0d(11,ph.a.rgf,"while online")))return;this.hza(Rb?this.jOl(zc):this.ttb)};this.oXk=Kb=>{this.mS=this.xFd+1;this.xWb=!1;var Rb=
{};this.uVa.clear();if(Kb=Kb.data){var zc=Kb.Bj?Kb.Bj[ik.a.N7]:"";Rb.HttpStatus=Kb.Qe;Rb.Correlation=zc;Rb.Id=Kb.id;ra.ULS.sendTraceTag(23425242,od.Pm,this.b_g?50:100,"Request succeeded at the HTTP level {0}",Rb);this.kwc=Kb.Qe}else ra.ULS.sendTraceTag(23425241,od.Pm,15,"Request succeeded with null response data");if(this.V$()||!this.HJd)this.bA.event(5),this.stop("session has shut down");else if(!this.$Sm())if(Kb&&Kb.ve)if(Kb=this.Vua(Kb.ve))if(this.C2.mUa(Kb),Kb.StatusCode)this.UXm(Kb,Rb)||this.bA.event(8,
Rb);else{this.mS=0;this.gvb=this.Tz();this.xQe.clear();Rb={["LastSavedRevisionId"]:Kb.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:Kb.RevisionSequenceNumber};Kb=nm.b(Kb.LastSavedRevisionId);this.yob(Kb,3);var Jc=this.cpf().store.getRevision(Kb);if(Jc){Kb=null;zc=this.Dhb();Jc=(Jc=Jc.R0a(zc))?Jc.id:ih.a.nil;let cd=zc;for(;cd&&!cd.id.equals(Jc);)Kb=cd,cd=cd.jm;this.epm(Kb,Rb,zc)||this.bA.event(9)}else this.Mnm()||this.bA.event(12,Rb);this.hza(this.YZb)&&ra.ULS.sendTraceTag(22552774,od.Pm,
50,"Received response from server -- going back to normal interval")}else this.bA.event(7),this.iIf("invalid response",Rb);else this.bA.event(6),this.iIf("null response",Rb)};this.D8n=(Kb,Rb)=>{Kb={};Kb.DocxSaveMonitorState=ke[Rb.newState];Kb.PreviousState=ke[Rb.V_f];Kb.PreviousStateHits=Rb.W_f;Kb.PreviousStateTransitionTime=Rb.X_f.toISOString();Kb.LastHttpStatus=this.kwc;Kb.LastSuccessTime=this.gvb.toISOString();this.fAc&&(Kb.LastRequestStartTime=this.fAc.toISOString());Kb.LastSavedRevisionID=this.U4d.toString();
Kb.LastSavedRevisionIdOrigin=this.Cxc;Kb.LastSavedRevisionIdSetTime=this.rRe?this.rRe.toISOString():null;Kb.IsViable=this.$e.Ywa;Kb.IsNetworkConnected=this.$e.MH;Kb.IsExpired=this.$e.kca;Kb.HasEmergencyViewModeBeenDeployed=this.$e.Gj;Kb["Navigator.Online"]=window.navigator.onLine;const zc=Rb.TDo;zc&&od.GOi(Kb,zc);Rb=Rb.newState;switch(Rb){case 13:ra.ULS.sendTraceTag(5830086,od.Pm,50,"{0}",Kb);break;case 1:ra.ULS.sendTraceTag(5884125,od.Pm,50,"{0}",Kb);break;case 0:ra.ULS.sendTraceTag(5830087,od.Pm,
50,"{0}",Kb);break;case 2:ra.ULS.sendTraceTag(5830088,od.Pm,50,"{0}",Kb);break;case 3:ra.ULS.sendTraceTag(5830089,od.Pm,50,"{0}",Kb);break;case 4:ra.ULS.sendTraceTag(5884126,od.Pm,50,"{0}",Kb);break;case 5:ra.ULS.sendTraceTag(5884127,od.Pm,50,"{0}",Kb);break;case 6:ra.ULS.shipAssertTag(5830090,od.Pm,!1,"{0}",Kb);break;case 7:ra.ULS.shipAssertTag(5830091,od.Pm,!1,"{0}",Kb);break;case 8:ra.ULS.sendTraceTag(5830092,od.Pm,15,"{0}",Kb);break;case 10:ra.ULS.sendTraceTag(5830094,od.Pm,15,"{0}",Kb);break;
case 9:ra.ULS.sendTraceTag(5884128,od.Pm,50,"{0}",Kb);break;case 11:ra.ULS.sendTraceTag(5830096,od.Pm,15,"{0}",Kb);break;case 17:ra.ULS.sendTraceTag(37835678,od.Pm,15,"{0}",Kb);break;case 12:ra.ULS.sendTraceTag(5830095,od.Pm,15,"{0}",Kb);break;case 18:ra.ULS.sendTraceTag(38122832,od.Pm,15,"{0}",Kb);break;case 19:ra.ULS.sendTraceTag(38122833,od.Pm,15,"{0}",Kb);break;case 21:ra.ULS.sendTraceTag(0,od.Pm,15,"{0}",Kb);break;case 14:ra.ULS.sendTraceTag(6575508,od.Pm,15,"{0}",Kb);break;case 15:ra.ULS.sendTraceTag(36739287,
od.Pm,50,"{0}",Kb);break;case 16:ra.ULS.sendTraceTag(36767649,od.Pm,15,"{0}",Kb);break;case 20:ra.ULS.sendTraceTag(593510690,od.Pm,15,"{0}",Kb);break;default:ra.ULS.shipAssertTag(5884129,od.Pm,!1,"Bad state:{0} logInfo:{1}",Rb,Kb)}};this.YZb=T;this.ttb=Aa;this.Hab=T;this.zlh=ib;this.fkk=Tb;this.Ygk=ld;this.XRe=Sd;this.GXb=df;this.aTg=De;this.Vve=Ff;this.G6=Wg;this.C2=Vh;this.Utc=zk;this.t$j=Wi;this.BWb=dk;this.jHe=mo;this.V$=Kl;this.Tz=ig;this.Vhk=Uk;this.E1g=xa;this.uVa=Pc.create(Cb.isEnabled,Cb.maxRetries,
Ba.V6);this.xQe=new ka.a;this.Mtc=Qa;this.bA=new vj.a(-1);this.$e=Ya;this.bA.f0e(this.D8n);this.ftd=no;this.gvb=ig();this.b_g=pr;this.tWj=Cb.isEnabled?null:Ba;this.fsb=Fa;this.ejh=this.zlh;this.QKe=ih.a.nil;this.ra=new M.a;sa.a.instance.Sa("Common.App.VisibilityManagement.IVisibilityManager").execute(Kb=>{this.kl=Kb;this.kl.gZa((Rb,zc)=>{this.HX(Rb,zc)});this.ROe=Kb.sC});this.$e&&this.$e.K_e((Kb,Rb)=>{this.rKb(Kb,Rb)});this.dIe=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",
xc):xc;this.Gdh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",this.ttb):this.ttb;this.egh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldLogAdditionalInfoEachTick",!0):!0;this.jgh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldOnlyKickoutWhenVisible",!1):!1;this.hgh=l.AFrameworkApplication.K?
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotKickoutFromDocxSaveMonitor",!1):!1;this.lik=Cb}rKb(T,Aa){ra.ULS.sendTraceTag(528577692,od.Pm,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",nf.a[Aa.uSf],nf.a[Aa.$Zc]);1!==Aa.$Zc&&3!==Aa.$Zc&&(ra.ULS.sendTraceTag(528566343,od.Pm,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.uVa.RVc(1),this.uVa.RVc(2)),this.uVa.clear())}get HJd(){return this.qsc}get U4d(){return this.QKe}get gR(){const T=
!this.Dhb()||this.U4d.equals(this.Dhb().id);T||ra.ULS.sendTraceTag(521413851,od.Pm,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.Dhb().id.toString(),this.U4d.toString());return T}get Yyi(){return this.Tz().getTime()-this.gvb.getTime()>this.dIe}get xFd(){return this.mS}get e_a(){return 3}get oFd(){let T=null;cb.App.xa&&cb.App.xa.ib&&cb.App.xa.ib.Uc&&(T=cb.App.xa.ib.Uc.contentReplicator);return[T,Yi.App.j1]}HX(T,Aa){var ib,Tb,xc;T={["VisibilityState"]:If.a[this.kl.sC],
["IsVisible"]:this.kl.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.xWb,["KickoutIntervalElapsed"]:this.Yyi,["LastSuccessfulIterationTime"]:null!==(ib=this.gvb)&&void 0!==ib?ib:"null",["RequestStartTime"]:null!==(Tb=this.fAc)&&void 0!==Tb?Tb:"null",["SkippedKickouts"]:this.evd,["LastSkippedKickoutAt"]:null!==(xc=this.B4g)&&void 0!==xc?xc:"null"},["IsViable"]:this.$e.Ywa,["IsNetworkConnected"]:this.$e.MH,["IsExpired"]:this.$e.kca,["HasEmergencyViewModeBeenDeployed"]:this.$e.Gj,["Navigator.Online"]:window.navigator.onLine};
ra.ULS.sendTraceTag(539874775,od.Pm,50,ab.c(T));this.ROe!=this.kl.sC&&(0==Aa.oldState||1==Aa.oldState||0!==Aa.newState&&1!==Aa.newState||this.hza(this.Gdh),0===this.kl.sC?(mc.c(Yg.a.dNk,void 0,void 0,void 0,void 0,void 0,T),this.Kwd&&mc.b("AvgTimeSpentOutsideOfWord",Date.now()-this.Kwd,1),this.Kwd=void 0):0===this.ROe&&(mc.c(Yg.a.eNk,void 0,void 0,void 0,void 0,void 0,T),this.Kwd=Date.now()),this.ROe=this.kl.sC)}start(){this.qsc=this.aTg.xfb(this.eFl,this.Hab)}hza(T){if(!this.HJd||this.Hab===T)return!1;
const Aa=this.Hab;this.Hab=T;this.stop("changing save monitor interval from "+Aa+"ms to "+T+"ms");this.start();return!0}yob(T,Aa){if(Aa>=this.Cxc&&T&&!ih.a.nil.equals(T)){var ib=!this.QKe.equals(T);this.Cxc=Aa;this.QKe=T;const Tb=this.Tz();this.rRe=Tb;const xc=this.gR;ib&&(Aa={["Id"]:T.toString(),["IsUpToDate"]:xc,["Origin"]:db[Aa]},this.UIe&&(Aa.LastUpToDateTime=this.UIe.toISOString()),(ib=this.cpf())&&ib.store&&(T=ib.store.getRevision(T))&&(Aa.LastSavedCreationTime=T.creationTime.toISOString()),
ra.ULS.sendTraceTag(557320151,od.Pm,50,"Updating Last Saved Revision: {0}",Aa));xc&&(this.UIe=Tb)}else Aa<this.Cxc?ra.ULS.sendTraceTag(572051800,od.Pm,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.Cxc,Aa):ra.ULS.sendTraceTag(572051801,od.Pm,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',Aa)}stop(T){this.Xe(T)}Xe(T){this.HJd&&(ra.ULS.sendTraceTag(5830084,od.Pm,50,"Stopping DocxSaveMonitor because {0}!",T),this.aTg.Xe(this.HJd),this.qsc=0)}Mnm(){if(0>=this.GXb)return!1;
var T=this.o6l();if(!T)return this.GOe=null,this.Trd=0,this.Urd=!1;this.Zvb=T.CMd;this.Zvb===this.GOe?this.Trd++:(this.GOe=this.Zvb,this.Trd=1,this.Urd=!1);if(this.Trd<od.Jen)return!1;this.jyc=+this.Tz()-+this.Zvb;if(this.jyc<=this.GXb)return!1;if(!this.Urd)return this.Urd=!0,this.R6i(),!1;if(this.fsb)this.fsb.execute(Aa=>{Aa.flush(this,0)});else{T="";try{this.Mtc&&(T=this.Mtc())}catch(Aa){T=ab.c({["Kind"]:"Exception",["Stack"]:Aa.stack,["Message"]:Aa.message,["FileName"]:Aa.fileName,["LineNumber"]:Aa.lineNumber}),
ra.ULS.sendTraceTag(50426817,od.Pm,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",T)}ra.ULS.sendTraceTag(50426818,od.Pm,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.Zvb.toISOString(),this.jyc,this.GXb,T)}this.GXb=-1;this.stop("Exceeded oldest allowed local revision");this.WC(ph.a.Yrl);return!0}o6l(){let T=null,Aa=this.Dhb();for(;Aa&&!Aa.Qwa;)T=Aa,Aa=Aa.jm;return T}$Sm(){return this.BWb()?
(this.bA.event(1),this.stop("session is lost"),!0):this.jHe()?(this.bA.event(14),ra.ULS.sendTraceTag(20029718,od.Pm,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.WC(ph.a.GJd),!0):!1}cpf(){const T=this.Utc();return T?T.Kc:null}Dhb(){const T=this.cpf();return T?T.km:null}eGc(T){return this.lik.isEnabled?this.uVa.eGc(T):this.tWj.RVc(T)&&!this.uVa.RVc(T)}jOl(T){return T?od.iLo:od.hfj}Q0d(T,Aa,ib){if(this.Yyi)if(this.kl&&!this.kl.isVisible)ra.ULS.sendTraceTag(540669727,od.Pm,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),
this.evd+=1,this.B4g=this.Tz();else return this.bA.event(T,{}),this.stop("request failed after kickout interval "+ib),this.fsb&&this.fsb.execute(Tb=>{Tb.flush(this,2)}),this.WC(Aa),!0;return!1}UXm(T,Aa){const ib=T.StatusCode;return 88===ib||89===ib||236===ib?(Aa.KickoutDiagnostics=this.Mtc(),88===ib?(Aa.Result="deleted DSS session",this.bA.event(18,Aa),this.stop("deleted DSS session"),this.WC(ph.a.localCobaltDeletedSessionFault)):89===ib?(Aa.Result="expired DSS session",this.bA.event(19,Aa),this.stop("expired DSS session"),
this.WC(ph.a.localCobaltExpiredSessionFault)):(l.AFrameworkApplication.Dn("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(T=nm.b(T.LastSavedRevisionId),this.yob(T,4)),Aa.Result="DSS session not found",this.bA.event(21,Aa),this.stop("DSS session not found"),this.WC(ph.a.localCobaltSessionNotFound)),!0):14===ib?(this.stop("DSS returned an unspecified failure"),
this.WC(ph.a.K1m),!0):104===ib?(this.stop("this operation is disabled on the server"),!0):this.iIf("unrecognized OperationResult: "+ib,Aa)}iIf(T,Aa){if(!this.xQe.contains(T))this.xQe.add(T);else if(this.Q0d(11,ph.a.rgf,T))return Aa.ConsecutiveErrors=this.xFd,Aa.Reason=T,ra.ULS.sendTraceTag(41997899,od.Pm,15,"DocxSaveMonitor kickout. {0}",Aa),!0;this.hza(this.ttb);return!1}epm(T,Aa,ib){let Tb=!1;if(T){const xc=this.Tz().getTime()-T.creationTime.getTime();xc>=this.zlh&&(Tb=!0,od.GOi(Aa,this.abm(T,xc,
ib)),xc>=this.dIe&&10===this.bA.currentState?(this.bA.event(11,Aa),this.stop("didn't save in time"),this.WC()):(this.bA.event(10,Aa),this.R6i(),this.dmf()))}return Tb}Pyk(T){this.ra.addHandler(od.$2i,T)}pyk(T){this.ra.addHandler(od.kmf,T)}Hbj(T){this.ra.removeHandler(od.kmf,T)}R6i(){this.ra.raiseEvent(od.$2i)}Vua(T){let Aa;return({group:Aa}=jr.a.q1(T)).returnValue?Aa.Responses[0]:null}abm(T,Aa,ib){const Tb={};Tb.FirstUnsavedRevisionId=T.id.toString();Tb.FirstUnsavedRevisionLengthToRoot=T.mR;Tb.UnsavedTimeInMs=
Aa;Tb.CurrentRevisionId=ib.id.toString();Tb.CurrentRevisionLengthToRoot=ib.mR;return Tb}dmf(){ij.a.emf(8)}WC(T=ph.a.rgf){this.fkk?this.hgh?(ra.ULS.sendTraceTag(509146274,od.Pm,15,"DocxSaveMonitor would have kicked out due to: {0}. Diagnostic Log: {1}.",T,this.o8h()),0==this.qsc&&this.start()):this.jgh&&this.kl&&!this.kl.isVisible?(ra.ULS.sendTraceTag(509146273,od.Pm,15,"DocxSaveMonitor did not kick out because the session is not visible. Error code: {0}. Diagnostic Log: {1}",T,this.o8h()),0==this.qsc&&
this.start()):(this.stop(od.VXm),T===ph.a.GJd?this.G6.value.WC(T,Object.assign(new Cg.a,{Ifa:4,WW:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,q3:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.G6.value.WC(T,new Cg.a)):ra.ULS.sendTraceTag(19247383,od.Pm,50,"Kickout disabled")}o8h(){const T={};var Aa=sa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager");T.HasDataloss=!Aa.gR;T.UnSavedRevisionsCount=Aa.R7a;T.OldestUnsavedRevisionCreationTime=Aa.gR?
"":Aa.qEb().toString();T.RevisionsWithOutServerRevisionSequenceNumbers=Aa.R3b();T.RevisionsWithServerRevisionSequenceNumbers=Aa.BGd();T.RSNManager_Diagnostics=Aa.xA();if(Aa=sa.a.instance?sa.a.instance.Na("WordEditor.RunawayDataLossMonitor"):null)T.RunawayDataLossMonitor_Diagnostics=Aa.Lgj;T.DocxSaveMonitor_Diagnostics=this.xA();(Aa=sa.a.instance?sa.a.instance.Na("WordEditor.ILastSavedToHostDetailsManager"):null)&&(T.LastSavedToHostDetailsManager_Diagnostics=Aa.xA());this.kl&&(T.VisibilityState=If.a[this.kl.sC]);
return T}xA(){const T={};this.Zvb&&(T.ORT=this.Zvb.toISOString());0<this.jyc&&(T.AA=this.jyc);0<this.GXb&&(T.MAA=this.GXb);0<this.evd&&(T.LSKO=this.B4g.toISOString());this.bA&&0<=this.bA.currentState&&(T.SMS=ke[this.bA.currentState]);const Aa={};l.AFrameworkApplication.Ooa&&(Aa.S=1);cb.App.lostSession&&(Aa.LS=1);this.$e&&(this.$e.zo&&(Aa.KO=1),this.$e.kca&&(Aa.TE=1));this.kl&&(Aa.VS=If.a[this.kl.sC]);window.navigator&&(Aa.NW=!window.navigator.onLine);T.AMD=Aa;return T}KZl(){const T={"Content-Type":"application/json; charset=utf-8",
"X-Requested-With":"Fetch"};l.AFrameworkApplication.buildVersion&&(T["X-OfficeVersion"]=Ta.a.aR(l.AFrameworkApplication.buildVersion));l.AFrameworkApplication.accessToken&&(T["X-AccessToken"]=Ta.a.aR(l.AFrameworkApplication.accessToken),T["X-AccessTokenTtl"]=l.AFrameworkApplication.KMa.toString());l.AFrameworkApplication.canary&&(T["X-Key"]=Ta.a.aR(l.AFrameworkApplication.canary));l.AFrameworkApplication.userType&&(T["X-UserType"]=Ta.a.aR(l.AFrameworkApplication.userType));const Aa=l.AFrameworkApplication.Ne.SY;
Aa&&(T["X-WacCluster"]=Ta.a.aR(Aa));l.AFrameworkApplication.userSessionId&&(T["X-UserSessionId"]=Ta.a.aR(l.AFrameworkApplication.userSessionId));return T}xIl(){var T=this.$e?this.$e.networkState:null;if(1===T||3===T)ra.ULS.sendTraceTag(558158790,od.Pm,15,"Not sending request because we dont have network.");else if(T=this.Utc()){var Aa=new Sys.Net.WebRequest;Aa.set_httpVerb("POST");Aa.set_url(od.serviceUrl);var ib={};ib.body=Ci.b(Od.a.construct(T));ib.headers=this.KZl();ib.method=Aa.get_httpVerb();
try{"function"===typeof window.fetch?window.fetch(Aa.getResolvedUrl(),ib).then(Tb=>{ra.ULS.sendTraceTag(561551382,od.Pm,50,"Request succeeded at the HTTP level {0}",Tb.statusText);this.w4g=Tb.status;return Tb.json()},Tb=>{ra.ULS.sendTraceTag(561551383,od.Pm,15,"Request failed at the HTTP level {0}",Tb);return null}).then(Tb=>{Tb=JSON.stringify(Tb);this.eXk(Tb,this.w4g);return Tb},()=>{ra.ULS.sendTraceTag(561551385,od.Pm,15,"Request succeeded with null response data");return""}):ra.ULS.sendTraceTag(561002076,
od.Pm,15,"Browser does not support Fetch.")}catch(Tb){ra.ULS.sendTraceTag(561551386,od.Pm,15,String.format("Exception when attempting to get last revision save id : {0}",Tb))}}else ra.ULS.sendTraceTag(540079457,od.Pm,15,"Target node is null, not sending last saved revision request.")}eXk(T,Aa){let ib=ih.a.nil,Tb=!1,xc=-1;Aa===Mh.a.My&&((T=this.Vua(T))?(ib=nm.b(T.LastSavedRevisionId),T.StatusCode||(Tb=!0,xc=T.StatusCode)):ra.ULS.sendTraceTag(561002077,od.Pm,50,"Response is null when attempting to get last revision save id"));
this.ra.raiseEvent(od.kmf,new yb(ib,Tb,Aa,xc))}static GOi(T,Aa){for(const ib in Aa)T[ib]=Aa[ib]}VNm(){return Ah.SessionStatusManager.instance.zo}}od.hfj=0;od.serviceUrl=cb.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";od.VXm="kickout";od.$2i="PS";od.kmf="FLSR";od.Pm=343;od.Jen=5;od.iLo=5E4;Object(f.a)(od,"DocxSaveMonitor",null,[1975,126]);class Pe{xfb(T,Aa){return window.setInterval(T,Aa)}Xe(T){window.clearInterval(T)}}Pe.instance=new Pe;Object(f.a)(Pe,"DocxSaveMonitorTaskManager",
null,[1974]);class Se{constructor(T){this.MN=0;this.hta=T}start(T){this.hta&&(this.MN=T,this.hta.reset())}log(){if(this.hta){var T={};T.RequstId=this.MN;T.InvokeCount=this.hta.xTc;T.InvokeFailedCount=this.hta.yTc;T.NoOpenConnectionCount=this.hta.d_c;T.SynchronousNotificationCount=this.hta.f$c;T.ResponseNotAvailable=this.hta.F5c;ra.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",T)}}}Object(f.a)(Se,"RequestLifeCycleTelemetryManager",null,[1973]);class ng{constructor(){this.W=
this.nRe=null;this.vel=()=>{var T=l.AFrameworkApplication.K;if(!T.$("DocxSaveMonitorEnabled"))return null;var Aa=T.$("DocxSaveMonitorKickoutEnabled");const ib=T.mc("DocxSaveMonitorIntervalMs",6E4),Tb=T.mc("DocxSaveMonitorFailureIntervalMs",5E3),xc=T.mc("DocxSaveMonitorWarningTimeMs",12E4),ld=T.mc("DocxSaveMonitorKickoutTimeMs",36E4),Sd=T.mc("DocxSaveMonitorQueueTimeoutMs",6E4),df=T.mc("DocxSaveMonitorSentTimeoutMs",12E4),De=T.mc("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var Ff=T.$("DocxSaveMonitorTelemetryInfoEnabled");
const Wg=T.$("DocxSaveMonitorInfoRequestLoggingEnabled");var Vh=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),zk=T.$("DocxSaveMonitorRawWebRequestsEnabled")||Vh;Vh=T.$("ComponentStateLoggingPackageIsEnabled");T=T.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);var Wi=l.AFrameworkApplication.Ne,dk=zk?new Xp.a(l.AFrameworkApplication.userSessionId,Wi.SY,Wi.dQh):
null;dk=new Sk(Wi,dk,zk);Ff=Ff&&Wi&&!zk?new Se(Wi.Fda):null;zk=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",!1):!1;Wi=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",3):3;const mo=Pc.create(zk,Wi);mo.ZDc(1);mo.ZDc(2);Vh=Vh?this.W.Sa("Common.IComponentStateLogManager"):null;Aa=new od(ib,Tb,xc,Aa,ld,Sd,df,
De,Pe.instance,dk,sa.a.instance.Ue("Box4.IKickoutExecutor"),al.a.instance,this.d9b,()=>!l.AFrameworkApplication.B5d||Hj.a.instance.FTc,()=>cb.App.lostSession,Object(a.a)(Zj.a.instance,Zj.a.instance.MCa,"checkAndTriggerSessionHasExpired"),()=>l.AFrameworkApplication.Nk,()=>new Date,()=>new Date,Ff,Wg,mo,this.nMl,Vh,T,sa.a.instance.Na("Common.ISessionStatus")||Ah.SessionStatusManager.instance,{isEnabled:zk,maxRetries:Wi});Aa.start();ra.ULS.sendTraceTag(5884131,od.Pm,50,"SaveMonitor initialized");return Aa};
this.d9b=()=>{const T=cb.App.xa.ib.rc;return T?T.Yc:null};this.nMl=()=>{const T={};l.AFrameworkApplication.nc&&(T.TM=l.AFrameworkApplication.nc.xA());Hl.WoncaApp.DF&&(T.RS=Hl.WoncaApp.DF.xA());Yi.App.j1&&(T.CRS=Yi.App.j1.xA());cb.App.xa&&cb.App.xa.ib&&cb.App.xa.ib.Uc&&cb.App.xa.ib.Uc.contentReplicator&&(T.GSR=cb.App.xa.ib.Uc.contentReplicator.xA());l.AFrameworkApplication.Ooa&&(T.S=1);cb.App.lostSession&&(T.LS=1);cb.App.rd&&cb.App.rd.bC.zo&&(T.KO=1);T.RVS=window.document.visibilityState;return Sys.Serialization.JavaScriptSerializer.serialize(T)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(cb.App.us||
cb.App.vm)this.nRe=this.W.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor")}dispose(){this.nRe&&this.nRe.stop("WordEditorDocxSaveMonitorPackage is being disposed")}xc(T){this.W=T;(cb.App.us||cb.App.vm)&&T.ha("WordEditor.DocxSaveMonitor.DocxSaveMonitor",this.vel).as("Wonca.IDocxSaveMonitor").singleInstance()}static main(){L.a.instance.Fc(new ng)}}Object(f.a)(ng,"WordEditorDocxSaveMonitorPackage",null,[1,2]);var Dg=c(850);class gi{constructor(T,Aa){this.nn=T;this.mco=Object(Dg.c)(Aa)}async loadChunk(T){return this.nn.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk(T):(await this.mco).Uz.loadScript(T)}}Object(f.a)(gi,"WordOnlineChunksLoader",null,[]);class qh{constructor(){this.name="WordEditor.EditorAi.Entry"}xc(T){T.ha("WordEditor.EditorAi.WordOnlineChunksLoader",()=>new gi(l.AFrameworkApplication.K,T.Sa("Common.IDynamicScriptLoaderProvider")))}init(){}dispose(){}static main(){L.a.instance.Fc(new qh)}}Object(f.a)(qh,"EditorAiEntryPackage",null,[1,2]);var ym=c(980);class Ol{constructor(T,Aa,ib,Tb,xc,ld,Sd){this.FJd=T;this.Spi=Aa;
this.qwm=ib;this.yXf=Tb;this.qKc=xc;this.pc=ld;this.FK=Sd;this.hvn=(df,De,Ff)=>{switch(Ff){case 1:if(!Object(Dg.d)(De)||!this.yJ)return 8;this.qKc.Ivj();break;case 2:this.qKc.o6e?this.$rj():this.bpb()}return 32};this.irn=(df,De,Ff)=>{2===Ff&&this.yXf.bwl().catch(Wg=>{ra.ULS.dD(508965832,3041,10,Wg,"Failed to initialize Copilot integration package")});return 32};this.PYi=(df,De)=>{De.JY&&(Object(mc.a)("AiMakerInitializationTriggered"),this.FJd.bda(this.PYi),this.FJd.Nd(),this.qKc.Ivj(),this.FK.Ak(19,
()=>{this.qKc.o6e&&this.$rj()}))};this.own=async(df,De)=>{De.JY&&this.qwm.execute(Ff=>{Ff.findImageAndRegisterHandler()})};this.yJ=Yi.App.Hpe.yJ}initialize(){this.FJd.f3(this.PYi);this.FJd.initialize();this.Spi.f3(this.own);this.Spi.initialize();this.pc.eb(Yg.a.kGd,Li.a.view,this.hvn,4);this.pc.eb(Yg.a.ZGi,Li.a.application,this.irn,1028)}$rj(){this.qKc.show().catch(T=>{ra.ULS.dD(508965831,3041,10,T,"Failed to show document wizard")})}bpb(){(new ym.a).Z8d(0)}}Object(f.a)(Ol,"AiMakerInitializer",null,
[]);var ah=c(1740),bk=c(934);class bj extends bk.a{constructor(T){var Aa;super("BooleanFeatureGateConditionId");this.Hn=T.Hn;this.s0a=T.s0a;this.defaultValue=null!==(Aa=T.defaultValue)&&void 0!==Aa?Aa:!1}initialize(){super.initialize();const T=l.AFrameworkApplication.K;T.Po(()=>{const Aa=T.getBooleanFeatureGate(this.s0a,this.defaultValue);this.Sg(Aa)})}Sg(T){super.Sg(T);ra.ULS.sendTraceTag(512369937,3028,50,this.sT(this.Hn,T,`featureGate=${this.s0a}`))}}Object(f.a)(bj,"BooleanFeatureGateCondition",
bk.a,[]);var Il=c(693);class yj extends bk.a{constructor(T){super(T.EHh);this.v7f=T}initialize(){super.initialize();l.AFrameworkApplication.K.Po(()=>{var T,Aa,ib,Tb,xc;const ld=null!==(Aa=null===(T=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===T?void 0:T.WACDatacenter)&&void 0!==Aa?Aa:"unknown";T=null!==(Tb=null===(ib=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===ib?void 0:ib.Ring)&&void 0!==Tb?Tb:"unknown";ib=null===(xc=l.AFrameworkApplication.sessionStartInfoSettings)||
void 0===xc?void 0:xc.Host;xc=this.PBf(ld,T,ib);this.Sg(xc);ra.ULS.sendTraceTag(509747520,3028,50,this.sT(this.v7f.Hn,xc,`datacenter=${ld}`))})}PBf(T,Aa,ib){if("1"===Aa||"unknown"===T||this.v7f.eYh.includes(ib))return!0;const Tb=T.toUpperCase();return!this.v7f.FSh.some(xc=>Tb.includes(xc))}}Object(f.a)(yj,"EditorAiDatacenterCondition",bk.a,[]);class Jm extends bk.a{constructor(T,Aa,ib){super("AiMakerConsentGroupConditionId");this.Hn=T;this.wfa=Aa;this.defaultValue=ib}initialize(){super.initialize();
this.wfa.execute(T=>{var Aa;T.isFeatureEnabled("AiMaker",null!==(Aa=this.defaultValue)&&void 0!==Aa?Aa:!1).then(ib=>{this.Sg(ib);return null})})}Sg(T){super.Sg(T);ra.ULS.sendTraceTag(509752010,3028,50,this.sT(this.Hn,T))}}Object(f.a)(Jm,"AiMakerConsentGroupCondition",bk.a,[]);class Bh extends bk.a{constructor(T){super("RegionComposerEnabledConditionId");this.Hn=T.Hn}initialize(){super.initialize();this.Sg(Yi.App.Hpe.yJ)}Sg(T){super.Sg(T);ra.ULS.sendTraceTag(508965830,3028,50,this.sT(this.Hn,T))}}
Object(f.a)(Bh,"RegionComposerEnabledCondition",bk.a,[]);const Pl="CH DE FR EU UK NO SE NL PIE".split(" ");class Km extends Il.a{constructor(T,Aa,ib){const Tb=new bj({Hn:16,s0a:"Microsoft.Office.WordOnline.IsAiMakerEnabled"});T=new ah.a(16,T,Aa,{QNb:!0,UO:!1,u$b:!1,t$b:!1,TO:!1});Aa=new yj({EHh:"AiMakerDocumentWizardDatacenterConditionId",Hn:16,FSh:Pl,eYh:["Exchange Online Consumer","OneDriveWOPI"]});ib=new Jm(16,ib);const xc=new Bh({Hn:16});super(16,new jb.a([Tb,T,Aa,ib,xc]),null,3028,"AiMakerDocumentWizardTriggered")}}
Object(f.a)(Km,"AiMakerDocumentWizardTriggerModel",Il.a,[]);var Di=c(933);class ln extends bk.a{constructor(T){super("AiImageInsertedConditionId");this.canvasService=T;this.isInitialized=!1;this.qTi=()=>{this.Sg(!0)}}initialize(){this.isInitialized||(super.initialize(),this.isInitialized=!0,this.canvasService.execute(T=>{var Aa;null===(Aa=T.add_onImageWasInsertedHandler)||void 0===Aa?void 0:Aa.call(T,this.qTi)}))}Nd(){this.isInitialized&&(this.canvasService.execute(T=>{var Aa;null===(Aa=T.remove_onImageWasInsertedHandler)||
void 0===Aa?void 0:Aa.call(T,this.qTi)}),this.isInitialized=!1,super.Nd())}}Object(f.a)(ln,"AiImageInsertedCondition",bk.a,[]);class Go extends Il.a{constructor(T){const Aa=new bj({Hn:19,s0a:"Microsoft.Office.WordOnline.IsAiImageRemakeEnabled"}),ib=new ln(T);super(19,new jb.a([Aa,ib]),null,3028,"OnTriggerAiImageRemakeEventKey");this.canvasService=T;this.gri=!1;this.Ktk()}N1a(T){super.N1a(T);super.tAd()&&super.wib("AiImageInsertedConditionId");"AiImageInsertedConditionId"!==T||this.gri||(this.k0n(),
this.gri=!0)}Ktk(){l.AFrameworkApplication.va.eb(Yg.a.lGd,Li.a.view,()=>8,1028)}k0n(){l.AFrameworkApplication.va.Sv(Yg.a.lGd,Li.a.view,()=>8)}}Object(f.a)(Go,"AiImageRemakeTriggerModel",Il.a,[]);class ri{constructor(T){this.vqn=async()=>{const Aa=await this.hHi.value;await this.ISc(Aa);return Aa};this.vzn=L.a.instance;this.hHi=new bb.a(T);this.lAm=new bb.a(this.vqn)}async J3(){await this.hHi.value}async wgb(){return await this.lAm.value}async ISc(T){L.a.instance.Fc(T);return new Promise(Aa=>{this.vzn.registerOnPackageInit(T.name,
Aa)})}}Object(f.a)(ri,"LazyLoadedPackage",null,[]);class kr{constructor(){this.aUh=new ri(()=>Promise.all([c.e(2),c.e(5),c.e(11)]).then(c.bind(null,2069)).then(T=>T.instance));this.j8k=new ri(()=>Promise.all([c.e(2),c.e(5),c.e(29)]).then(c.bind(null,2078)).then(T=>T.instance))}async dwl(){await this.aUh.wgb()}async bwl(){await this.aUh.wgb();await this.j8k.wgb()}}Object(f.a)(kr,"AiMakerPackageManager",null,[]);var Sm=c(289),jq={get Srl(){var T=null===aiMakerDocumentWizardUx||void 0===aiMakerDocumentWizardUx?
void 0:aiMakerDocumentWizardUx.interop;if(!T)throw Error("aiMakerDocumentWizardUx chunk is accessed before loading");return T}};class Mk{constructor(T){this.container=T}getDocumentContentGenerator(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentContentGenerator")}getCanvasService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService")}getFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardFocusManager")}getDocumentLayoutHtmlHelper(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentLayoutHtmlHelper")}getTelemetryLogger(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerTelemetryLogger")}getSurveysManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardSurveysManager")}getStylesService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerStylesService")}getImageRemakeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService")}getImageRemakeSizeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeSizeService")}getImageRemakeFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeFocusManager")}getPromptSuggestionProvider(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerPromptSuggestionProvider")}getController(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController")}getResumeBioInfoEnricher(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerResumeBioInfoEnricher")}}
Object(f.a)(Mk,"AiMakerDocumentWizardDependenciesImpl",null,[]);class Sq{constructor(T,Aa,ib,Tb,xc){this.Mpg=T;this.yXf=Aa;this.$i=ib;this.rc=Tb;this.a5o=xc;this.lzi=!1;this.wqn=async()=>{this.lzi=!0;await Promise.all([this.yXf.dwl(),this.Mpg.loadChunk("aiMakerDocumentWizardUx")]);return jq.Srl};this.wJj=new bb.a(this.wqn)}get o6e(){return this.$i.$la(this.rc.Yc,{UO:!1,$ba:!1,hoa:!1,TO:!1})}Ivj(){this.lzi||this.wJj.value.catch(T=>{ra.ULS.dD(508965829,3041,10,T,"Failed to load document wizard UX interop")})}async show(){const T=
await this.wJj.value;this.o6e?(this.Qsh||(this.Qsh=this.xfn(T)),this.Qsh.open()):ra.ULS.sendTraceTag(508965828,3041,50,"Document wizard show attempt prevented")}xfn(T){const Aa=this.mountApp(T);return Aa?Aa:new mn(this.a5o,()=>this.mountApp(T))}mountApp(T){const Aa=Object(Sm.a)("EditorContainer");return T.mountApp(Aa,new Mk(sa.a.instance))}}Object(f.a)(Sq,"AiMakerDocumentWizardUx",null,[]);class mn{constructor(T,Aa){this.controller=T;this.Mrn=Aa;this.isOpen=!0}get isOpen(){return this.controller.isOpen}set isOpen(T){this.controller.isOpen=
T}open(){this.isOpen||(this.isOpen=!0,this.Mrn())}close(){this.isOpen=!1}}Object(f.a)(mn,"AiMakerDocumentWizardCompatAppRef",null,[]);class cn{constructor(){this.isOpen=!1}}Object(f.a)(cn,"AiMakerDocumentWizardControllerImpl",null,[]);class $n extends Di.a{get name(){return"WordEditor.AiMaker.Entry"}W7(T){this.container=T;T.ha("WordEditor.AiMaker.AiMakerPackageManager",()=>new kr).singleInstance();T.ha("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController",()=>new cn).singleInstance();
T.ha("WordEditor.AiMaker.AiMakerDocumentWizardUx",()=>new Sq(T.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"),T.resolve("WordEditor.AiMaker.AiMakerPackageManager"),T.resolve("Box4.IParagraphReader"),cb.App.xa.ib.rc,T.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController"))).singleInstance()}Y7(){(new Ol(new Km(this.container.resolve("Box4.IParagraphReader"),cb.App.xa.ib.rc,this.container.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),new Go(this.container.Sa("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService")),
this.container.Sa("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService"),this.container.resolve("WordEditor.AiMaker.AiMakerPackageManager"),this.container.resolve("WordEditor.AiMaker.AiMakerDocumentWizardUx"),l.AFrameworkApplication.va,kb.a.get_instance())).initialize()}X7(){}static main(){L.a.instance.Fc(new $n)}}Object(f.a)($n,"AiMakerEntryPackage",Di.a,[]);var om={get interop(){var T=aiInserterUx.interop;if(!T)throw Error("aiInserterUx chunk is accessed before loading");return T}};class ao{constructor(T,
Aa){this.B9d=T;this.u6c=Aa;this.DGa=async(ib,Tb)=>{Tb.JY&&(Object(mc.a)("AiInserterInitializationTriggered"),this.B9d.bda(this.DGa),this.B9d.Nd(),[,ib]=await Promise.all([this.E1m(),Promise.all([c.e(2),c.e(5),c.e(25)]).then(c.bind(null,2071))]),ib.main(om.interop))}}initialize(){this.B9d.f3(this.DGa);this.B9d.initialize()}async E1m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiInserterUx"):(await Object(Dg.c)(this.u6c)).Uz.loadScript("aiInserterUx")}}
Object(f.a)(ao,"AiInserterInitializer",null,[]);class Rr extends bk.a{constructor(T,Aa){super("AiInserterConsentGroupConditionId");this.wfa=T;this.defaultValue=Aa}initialize(){super.initialize();this.wfa.execute(T=>{T.isFeatureEnabled("AiInserter",!!this.defaultValue).then(Aa=>{this.Sg(Aa);return null})})}Sg(T){super.Sg(T)}}Object(f.a)(Rr,"AiInserterConsentGroupCondition",bk.a,[]);const fs="CH DE FR EU UK NO SE NL PIE".split(" ");class Jn extends bk.a{constructor(){super("AiInserterDatacenterConditionId")}initialize(){super.initialize();
l.AFrameworkApplication.K.Po(()=>{var T,Aa,ib,Tb;const xc=null!==(Aa=null===(T=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===T?void 0:T.WACDatacenter)&&void 0!==Aa?Aa:"unknown";T=null!==(Tb=null===(ib=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===ib?void 0:ib.Ring)&&void 0!==Tb?Tb:"unknown";ib=this.PBf(xc,T);this.Sg(ib)})}PBf(T,Aa){if("1"===Aa||"unknown"===T)return!0;const ib=T.toUpperCase();return!fs.some(Tb=>ib.includes(Tb))}}Object(f.a)(Jn,"AiInserterDatacenterCondition",
bk.a,[]);class Cq extends Il.a{constructor(T){const Aa=new bj({Hn:17,s0a:"Microsoft.Office.WordOnline.IsAiInserterEnabled"});T=new Rr(T);const ib=new Jn;super(17,new jb.a([Aa,T,ib]),null,3028,"AiInserterAppTriggered")}}Object(f.a)(Cq,"AiInserterTriggerModel",Il.a,[]);class mj extends Di.a{get name(){return"WordEditor.AiInserter.Entry"}W7(T){this.container=T}Y7(){(new ao(new Cq(this.container.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),this.container.Sa("Common.IDynamicScriptLoaderProvider"))).initialize()}X7(){}static main(){L.a.instance.Fc(new mj)}}
Object(f.a)(mj,"AiInserterEntryPackage",Di.a,[]);const Ms="CH DE FR EU UK NO SE NL PIE".split(" ");class zm extends Il.a{constructor(){const T=new bj({Hn:18,s0a:"Microsoft.Office.WordOnline.IsAiRewriteEnabled"}),Aa=new yj({EHh:"AiRewriteDatacenterConditionId",Hn:18,FSh:Ms,eYh:["Exchange Online Consumer","OneDriveWOPI"]});super(18,new jb.a([T,Aa]),null,3028,"AiRewriteTriggered")}}Object(f.a)(zm,"AiRewriteTriggerModel",Il.a,[]);var wh={get interop(){var T=null===aiRewriteUx||void 0===aiRewriteUx?void 0:
aiRewriteUx.interop;if(!T)throw Error("aiRewriteUx chunk is accessed before loading");return T}};class wi{constructor(T,Aa){this.rAd=T;this.u6c=Aa;this.DGa=async(ib,Tb)=>{Tb.JY&&(Object(mc.a)("AiRewriteInitializationTriggered"),this.rAd.bda(this.DGa),this.rAd.Nd(),[,ib]=await Promise.all([this.y0m(),Promise.all([c.e(2),c.e(5),c.e(12)]).then(c.bind(null,2074))]),ib.main(wh.interop))}}initialize(){this.rAd.f3(this.DGa);this.rAd.initialize()}async y0m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("aiRewriteUx"):(await Object(Dg.c)(this.u6c)).Uz.loadScript("aiRewriteUx")}}Object(f.a)(wi,"AiRewriteInitializer",null,[]);class Kn extends Di.a{get name(){return"WordEditor.AiRewrite.Entry"}W7(T){this.container=T}Y7(){(new wi(new zm,this.container.Sa("Common.IDynamicScriptLoaderProvider"))).initialize()}X7(){}static main(){L.a.instance.Fc(new Kn)}}Object(f.a)(Kn,"AiRewriteEntryPackage",Di.a,[]);var vl;(function(T){T[T.version0=0]="version0";T[T.version1=1]="version1"})(vl||
(vl={}));Object(f.b)("FirstRunExperienceVersion",vl);class Ho{get r1e(){return"Word"}get VAh(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return vl.version0}get currentVersion(){return vl.version1}get BJm(){return Ho.isEnabled()&&l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get icc(){return Ho.isEnabled()&&l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get iDi(){return l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get sGl(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get gPi(){return 24}get Rfj(){return 4E3}get Z5c(){return""}static isEnabled(){const T=
l.AFrameworkApplication.sessionStartInfoSettings?l.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==T&&"Automation"!==T}}Object(f.a)(Ho,"FirstRunExperienceLauncherSettings",null,[2007]);class kq{constructor(T){this.NVg=T}kxo(T){this.NVg&&this.NVg.lxo(T)}}Object(f.a)(kq,"FirstRunExperienceManager",null,[2006]);class sp{constructor(){this.W=null}get name(){return"WordEditor.FirstRunExperience"}xc(T){this.W=T;this.W.ha("WordEditor.FirstRunExperience.IFirstRunExperienceManager",
()=>new kq(this.W.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).singleInstance()}init(){const T=this.W.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");T&&T.kxo(new Ho)}dispose(){}}Object(f.a)(sp,"WordEditorFirstRunExperiencePackageManager",null,[1,2]);class lq{constructor(T,Aa){this.MHa=(ib,Tb,xc,ld,Sd)=>{var df,De;if(1===xc)return Sd=null===(De=null===(df=Tb.view.lb)||void 0===df?void 0:df.gb)||void 0===De?void 0:De.kb,(null===Sd||void 0===Sd?
0:Sd.LH)||ib===Yg.a.I8c&&(null===Sd||void 0===Sd?0:Sd.M2a)?32:8;if(2===xc){df=this.wab.ij.isVisible;this.wab.ZB(!0,1===Sd);De=0;switch(ib){case Yg.a.osj:Sd=1;break;case Yg.a.psj:Sd=2;break;case Yg.a.Yie:Sd=2;De=1;break;case Yg.a.Zie:Sd=1;De=2;break;case Yg.a.I8c:Sd=1;De=3;break;case Yg.a.ome:Sd=this.wab.E4b;break;default:De=Sd=0}df&&ib===Yg.a.MHa||this.wab.Qjo(Sd,De);return 32}return 8};this.DVd=(ib,Tb,xc,ld,Sd)=>{this.toggleButton(Sd,!1);return this.c0k(xc)};this.ome=(ib,Tb,xc,ld,Sd)=>this.wab.ij.isVisible?
this.DVd(ib,Tb,xc,ld,Sd):this.MHa(ib,Tb,xc,ld,Sd);this.ga=T;this.wab=Aa}dispose(){this.wab&&this.wab.dispose()}Tb(){this.ga.qa(Yg.a.ome,Li.a.view,this.ome);this.ga.eb(Yg.a.MHa,Li.a.view,this.MHa,4);this.ga.qa(Yg.a.DVd,Li.a.view,this.DVd);this.ga.eb(Yg.a.Yie,Li.a.view,this.MHa,4);this.ga.qa(Yg.a.Zie,Li.a.view,this.MHa);this.ga.qa(Yg.a.I8c,Li.a.view,this.MHa)}c0k(T){if(1===T)return 32;this.wab.ZB(!1);return 32}toggleButton(T,Aa){T&&(T[ci.a.On]=Aa)}}Object(f.a)(lq,"FormatPictureActor",null,[10]);class nn{constructor(T){this.kyb=
!1;this.ij=T}get E4b(){return this.ij.Zgl}Qjo(T,Aa){switch(T){case 0:case 1:this.ij.kyo(Aa);break;case 2:this.ij.wyo(Aa)}}ZB(T,Aa=!1){this.kyb||this.mAf();T?this.ij.pP(Aa):this.ij.$na()}dispose(){this.ij.dispose()}mAf(){this.kyb||(this.ij.initialize(),this.kyb=!0)}}Object(f.a)(nn,"FormatPictureManager",null,[1972,10]);var ck=c(353),jk=c(153),Hi=c(270);class Uh{}Uh.uP=Hi.a.zNd;Uh.Nfc=1;Uh.Ofc=WordEditorIntl.WordEditorStrings.L_FormatPicture;Uh.Qua="FormatPictureTaskPaneData";Object(f.a)(Uh,"FormatPicturePaneConstants",
null,[]);class en{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(f.a)(en,"FormatPictureTaskPaneProps",null,[]);class mq{constructor(T,Aa,ib,Tb){this.BRe=0;this.Orc=this.Ela=null;this.Gtd=this.xtd=this.rod=this.ffd=
this.$wd=0;this.Ks=this.uUb=!1;this.wxe=0;this.$un=()=>{this.Elj()};this.xm=()=>{let xc=!1;xc=this.CMn()||xc;xc=this.v5a()||xc;xc=this.u5a()||xc;xc=this.Ngc()||xc;(xc=this.yMn()||xc)&&this.Cm()};this.V2=T;this.eak=Aa;this.aJe=ib;this.ig=Tb}initialize(){this.d_();this.cja()}get isVisible(){return this.Ks}pP(T){this.Q8c(T)}$na(){this.mda();this.ytm()}kyo(T){this.Pnj(T,1)}wyo(T){this.Pnj(T,2)}Pnj(T,Aa){this.wxe=Aa;this.BRe=T}get Zgl(){return this.wxe}dispose(){}d_(){this.V2.QNa();this.BRe=this.wxe=0}get focusManager(){return this.eak.value}get pc(){return this.aJe.value}v3a(){return!!this.focusManager.currentScope&&
this.focusManager.currentScope.name===Uh.uP}Elj(){this.focusManager.mg(Uh.uP)}cja(){const T=this.focusManager.fe(Uh.uP);T.parent=Bd.AFrame.rp;T.pfa(this.$un)}mda(){this.v3a()&&this.focusManager.mg(this.focusManager.vT)}Q8c(T){Kj.UISurfaces.Gu().then(Aa=>{Aa.showTaskPane(Uh.uP,this.pA(T));this.isVisible&&T&&this.focusManager.mg(Uh.uP);return null})}Cm(){Kj.UISurfaces.Gu().then(T=>{T.updateTaskPane(Uh.uP,this.pA(!1));return null})}ytm(){Kj.UISurfaces.Gu().then(T=>{T.hideTaskPane(Uh.uP,2);return null})}pA(){const T=
new en;this.Sqo(T);return Object.assign(new Ug.a,{title:Uh.Ofc,hideHeader:!1,width:320,location:2,contentProps:T,onOpen:Aa=>{this.Ks=!0;cb.App.xa.eZa(this.xm);cb.App.xa.updateCommandUI();this.Elj();this.ig.u0b(Uh.uP,Aa)},onClose:()=>{this.mda();this.Ks=!1;cb.App.xa.yhc(this.xm);cb.App.xa.updateCommandUI()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}Sqo(T){const Aa=G.e().numberFormatInfo;T.section=this.BRe;T.numberFormatInfo="object"===typeof Aa?Aa:null;T.title=this.Ela;
T.description=this.Orc;T.topCrop=this.$wd;T.bottomCrop=this.ffd;T.leftCrop=this.rod;T.rightCrop=this.xtd;T.rotationAngle=this.Gtd;T.onTitleChange=this.onTitleChange();T.onDescriptionChange=this.onDescriptionChange();T.onCropSpinButtonChange=this.onCropSpinButtonChange();T.onRotationSpinButtonChange=this.onRotationSpinButtonChange();T.disabled=this.uUb}onTitleChange(){return T=>{if(T!==this.Ela){this.Ela=T;var Aa=new ck.DictionaryPropertySet;Aa.setValue(jk.a.Tib,T);this.pc.Qb(Kg.a.r7c,2,Aa);this.Cm()}}}onDescriptionChange(){return T=>
{if(T!==this.Orc){var Aa=new ck.DictionaryPropertySet;Aa.setValue(jk.a.RX,T);this.Orc=T;this.pc.Qb(Kg.a.pOb,2,Aa);this.Cm()}}}onCropSpinButtonChange(){return(T,Aa)=>{const ib=new ck.DictionaryPropertySet;switch(Aa){case 0:this.$wd=T;ib.setValue(jk.a.Yib,T);this.pc.Qb(Yg.a.eSc,2,ib);break;case 1:this.ffd=T;ib.setValue(jk.a.Vib,T);this.pc.Qb(Yg.a.YRc,2,ib);break;case 2:this.rod=T;ib.setValue(jk.a.Wib,T);this.pc.Qb(Yg.a.ZRc,2,ib);break;case 3:this.xtd=T,ib.setValue(jk.a.Xib,T),this.pc.Qb(Yg.a.$Rc,2,
ib)}this.Cm()}}onRotationSpinButtonChange(){return T=>{this.Gtd=T;const Aa=new ck.DictionaryPropertySet;Aa.setValue(jk.a.lSc,0);Aa.setValue(jk.a.sJ,T);this.pc.Qb(Kg.a.imageRotate,2,Aa);this.Cm()}}CMn(){const T=2===this.pc.Qb(Kg.a.r7c,1,null),Aa=T!==this.uUb;this.uUb=T;return Aa}v5a(){var T=new ck.DictionaryPropertySet;this.pc.Qb(Kg.a.v5a,2,T);T=T.ia(jk.a.Tib,"");const Aa=T!==this.Ela;this.Ela=T;return Aa}u5a(){var T=new ck.DictionaryPropertySet;this.pc.Qb(Kg.a.u5a,2,T);T=T.ia(jk.a.RX,"");const Aa=
T!==this.Orc;this.Orc=T;return Aa}Ngc(){var T=new ck.DictionaryPropertySet;this.pc.Qb(Yg.a.Z2c,2,T);const Aa=T.ia(jk.a.Yib,0),ib=T.ia(jk.a.Vib,0),Tb=T.ia(jk.a.Wib,0);T=T.ia(jk.a.Xib,0);const xc=Aa!==this.$wd||ib!==this.ffd||Tb!==this.rod||T!==this.xtd;this.$wd=Aa;this.ffd=ib;this.rod=Tb;this.xtd=T;return xc}yMn(){var T=new ck.DictionaryPropertySet;this.pc.Qb(Kg.a.uMb,2,T);T=T.ia(jk.a.sJ,0);const Aa=T!==this.Gtd;this.Gtd=T;return Aa}}Object(f.a)(mq,"ReactFormatPicturePane",null,[1971,10]);class og{constructor(){this.Ljd=
this.W=null}get name(){return"WordEditor.FormatPicture"}xc(T){this.W=T;this.W.ha("WordEditor.FormatPicture.IFormatPictureManager",()=>new nn(this.W.resolve("WordEditor.FormatPicture.IFormatPicturePane"))).singleInstance();this.W.ha("WordEditor.FormatPicture.IFormatPicturePane",()=>new mq(Bc.a.instance,new bb.a(()=>ji.FocusManager.instance()),new bb.a(()=>l.AFrameworkApplication.va),Hn.a.instance)).singleInstance();this.W.ha("WordEditor.FormatPicture.FormatPictureActor",()=>new lq(l.AFrameworkApplication.va,
this.W.resolve("WordEditor.FormatPicture.IFormatPictureManager"))).singleInstance()}init(){if(Yi.App.Epg||Yi.App.MLj)this.Ljd=this.W.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.Ljd.Tb(),cb.App.xa.updateCommandUI()}dispose(){this.Ljd&&this.Ljd.dispose()}static main(){L.a.instance.Fc(new og)}}Object(f.a)(og,"WordEditorFormatPicturePackage",null,[1,2]);var Tq=c(1482),Yp=c(509);class Io extends ep.a{constructor(){super();this.Prompt=0;this.FileId=null}fl(){return 100}static construct(T,
Aa){const ib=new Io;ib.FileId=T;ib.Prompt=Aa;return ib}}Object(f.a)(Io,"GraphMergeConsentChangedRequest",ep.a,[]);var kh=c(580);class Uq extends kh.a{constructor(){super();this.Location=this.FileId=null}fl(){return 34}static construct(T,Aa){const ib=new Uq;ib.FileId=T;ib.Location=Aa;return ib}}Object(f.a)(Uq,"PlayGraphMergeReplayRequest",kh.a,[]);class Am{constructor(T,Aa,ib,Tb,xc,ld=null,Sd=null){this.am=!1;this.HN=null;this.hfh=this.HHe=!1;this.J9e=()=>{if(this.Lza.oVd)this.HHe=!0;else if(this.HHe=
!1,!this.ago){this.hfh=!0;var df=this.DJa.Uxa;ra.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",400===df);if(100===df||400===df)df=Io.construct(this.XP(),df),this.Tv(df)}};this.cmi=(df,De)=>{De&&De.kNf&&De.kNf.Taf&&!this.Lza.mDi&&(this.Lza.REj(),this.Lza.oVd=!0,this.Tv(De.kNf.Taf))};this.ami=(df,De)=>{De&&De.ocd&&this.Lza.REj()};this.bmi=(df,De)=>{De&&(De.ShowMergePrompt&&this.DJa.Ldj(this.J9e),l.AFrameworkApplication.Lg&&(l.AFrameworkApplication.Lg.SessionMergeInfo|=De.PartMergeInfo))};
this.XP=T;this.uyd=ib;this.Lza=Tb;this.DJa=xc;this.uyd&&this.uyd.uyk(this.cmi);this.C2=ld||al.a.instance;if(!Sd){const df=new Yp.a;Sd=De=>df.Gga(0,De)}this.ZXj=Sd}get eWm(){return this.HHe}get ago(){return this.hfh}Tv(T){const Aa=new pk.a;Aa.Eq=T;Aa.status=1;Aa.IG="GraphMerge";const ib=this.ZXj(()=>{this.E5c(Aa,33===T.fl())});ib.HI(Aa);ib.yT()}E5c(T,Aa){this.am||(Aa&&(this.Lza.oVd=!1),2===T.statusCode&&!Na.a.LHb(T.Ij)&&1===T.Ij.length&&T.Ij[0]?(T=T.Ij[0],T.StatusCode?this.Lza.Fbg():Aa&&this.DJa.Ldj(this.J9e),
this.C2.mUa(T),this.eWm&&this.J9e()):this.Lza.Fbg())}M4a(T){this.HN=T;this.HN.P0b(this.ami);this.HN.Q0b(this.bmi)}dispose(){this.am||(this.uyd&&this.uyd.l2n(this.cmi),this.HN&&(this.HN.eNb(this.ami),this.HN.Q4c(this.bmi)),this.am=!0)}}Object(f.a)(Am,"GraphMergeBackupManager",null,[2E3,10]);class Ii{constructor(T,Aa=null,ib=null,Tb=null){this.due=0;this.CGe=!1;this.G3g=new Date(0);this.oVd=!1;this.DJa=T;this.Tz=Aa||(()=>new Date);ib||(ib=l.AFrameworkApplication.K?l.AFrameworkApplication.K.mc("WordEditorGraphMergeBackupDelayInMs",
12E4):12E4);this.Sbk=ib;Tb||(Tb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.mc("WordEditorGraphMergeMaxBackups",1):1);this.u6g=Tb}get NUm(){return+this.Tz()-+this.G3g<this.Sbk}get mDi(){return 500===this.DJa.Uxa?!1:100===this.DJa.Uxa?!0:this.CGe||this.oVd||this.NUm}REj(){this.G3g=this.Tz();this.due++;this.due>=this.u6g&&this.Fbg()}Fbg(){this.CGe||(this.CGe=!0,ra.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.due,
this.u6g))}}Object(f.a)(Ii,"GraphMergeBackupThrottler",null,[1999]);class Zp{constructor(T,Aa,ib=null){this.VXg=!1;this.DV=T;this.o3j=Aa;null==ib&&(ib=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));this.XOe=ib?500:300}get Uxa(){return this.XOe}Ldj(T){if(!this.VXg&&300===this.Uxa){var Aa=this.o3j.value;Aa&&Aa.isFeatureEnabled(51)&&(this.VXg=!0,this.DV.execute(ib=>{ib.vxo(()=>{this.P4k(T)},()=>{this.consentDenied(T)})}))}}consentDenied(T){300===
this.Uxa&&(ra.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.XOe=100,T());this.caj()}P4k(T){300===this.Uxa&&(ra.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.XOe=400,T());this.caj()}caj(){this.DV.execute(T=>{T.rtm()})}}Object(f.a)(Zp,"GraphMergeCollectionConsentManager",null,[1998]);class pg extends Sys.EventArgs{constructor(T){super();this.kNf=T}}Object(f.a)(pg,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);
var Ln=c(820),Mo=c(870),ws=c(1037),Dq=c(611),un=c(1771),Rn=c(1769),Sn=c(221),io=c(165);class cj{constructor(T,Aa,ib,Tb,xc,ld){this.i1f=this.og=null;this.lWc=this.hpg=!1;this.Xk=null;this.x8c=T.runtime.x8c;this.lq=T;this.Ud=Aa;this.Kg=ib;this.un=Tb;this.B4k=xc;this.graphNodeComplexMerge=ld}}Object(f.a)(cj,"GraphNodeComplexMergeState",null,[]);var $p=c(1554),gs=c(1538);class jo{constructor(T,Aa=null){this.Ng=T;this.uXb=Aa||this.YOc()}get wlb(){return this.uXb}get Ud(){return this.Ng}YOc(){return[Object(a.a)(this,
this.Uzo,"simpleMerge"),Object(a.a)(this,this.P3k,"complexMerge")]}Yqo(T,Aa,ib,Tb,xc,ld){Aa=new cj(T,ib,new bb.a(()=>new $p.a(Tb?Tb.wm:null,xc)),new bb.a(()=>new $p.a(Tb?Tb.wm:null,ld)),new bb.a(()=>new $p.a(ld,xc)),Aa.RLh(xc,()=>T.runtime.Xb));Aa.og=Tb.x_b;Aa.i1f=new Sn.a;return Aa}merge(T,Aa,ib,Tb,xc,ld){Aa=this.Yqo(T,Aa,ib,Tb,xc,ld);ib=!0;for(Tb=0;Tb<this.wlb.length&&ib;Tb++)(ib=(0,this.wlb[Tb])(Aa))||T.logger.g3d("GraphNodeMerge.GetMergeFunctions()",Tb);if(T=Aa.lWc&&Aa.Xk?new gs.a(Aa.Xk,!1):null)switch(T.qpo(Aa.og),
(T?T.wm:xc).Rc){case 1074135145:Aa.lq.runtime.Oce.Z5k.Z(T.wm.id,T.wm);break;case 1074135153:Aa.lq.runtime.Oce.XLk.Z(T.wm.id,T.wm);break;case 1074135127:Aa.lq.runtime.Oce.J2k.Z(T.wm.id,T.wm);break;case 393230:Aa.lq.runtime.E4d.add(T.wm.id)}return{returnValue:Aa.lWc,Xk:T}}Uzo(T){if(T.lq.runtime.Xb&&T.lq.runtime.Xb.qib(1000005)&&0<T.og.count)return!0;var Aa=T.graphNodeComplexMerge.abe;return T.un.value.eUc(Aa)&&T.B4k.value.eUc(Aa)?T.Kg.value.eUc(Aa)?!0:(Aa=T.un.value.wf,T.lWc=!0,T.Xk=Aa.KK(),!1):(T.lWc=
!0,!1)}P3k(T){const Aa=T.un.value.wf;T.x8c&&io.a.instance.Ta(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",Aa.id,Aa.Rc);const ib=T.graphNodeComplexMerge.klg(T);T.lWc=ib;io.a.instance.Ta(4018184,1,ib?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",ib?"Succeeded":"Failed",Aa.id,Aa.Rc,!!T.Xk);return ib}}Object(f.a)(jo,"GraphNodeMerge",null,[1990]);class vn extends ep.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=
this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=null;this.Prompt=this.Reason=this.Source=0}fl(){return 33}static construct(T,Aa,ib,Tb,xc,ld,Sd,df,De,Ff,Wg){const Vh=new vn;Vh.FileId=T;Vh.BaseRevisions=Aa;Vh.TheirRevisions=ib;Vh.YourRevisions=Tb;Vh.IgnoreConflictsInLastServerRevision=xc;Vh.MergeHint=ld;Vh.ObjectSpaceId=Sd?nm.a(Sd):null;Vh.RequestId=df?nm.a(df):null;Vh.Source=De;Vh.Reason=Ff;Vh.Prompt=Wg;return Vh}}Object(f.a)(vn,
"CreateGraphMergeReplayRequest",ep.a,[]);var Tm=c(808),Ud=c(234),Jo=c(16),lr=c(1879),Tn=c(1969);class cl{constructor(T,Aa=null,ib=null){this.Tql=(Tb,xc)=>{let ld=Tb;var Sd=xc,df=this.vbb.get(Tb);if(!df)return{mHa:ld,xNb:Sd};Sd=new Sn.a;Sd.add(df);var De=this.Ivb.get(Tb)||this.GF.J(Tb);df=new Sn.a;df.add(De);De=new Sn.a;De.add(this.GF.J(Tb));ra.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.lH.twf,
this.lH.Sha,this.Ibi(df),this.Ibi(Sd));var Ff=this.aci(this.lH.Sha);this.NFl(Ff,Tb,Sd);df=new lr.a(Ff,De,1===Ff.input.Sha?df:Sd,1===Ff.input.Sha?Sd:df,this.aci(1),df,Sd);Sd=new Sn.a;for(De=0;De<xc.length;De++){this.lH.SG("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const Wg=({$5a:ld,eqa:Ff}=df.gbd(Tb,xc.J(De))).returnValue;Sd.add(Ff);Wg?ra.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",
Tb,xc.J(De),ld,Ff):ra.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",Tb)}return{mHa:ld,xNb:Sd}};this.lH=T;this.GF=T.uk;this.vbb=T.kKo;this.Ivb=T.W8o;this.Pak=T.J1m;this.Ng=Aa||new ws.a;this.sfk=ib||this.Tql}jKc(T){const Aa=new Sn.a;for(let ib=0;ib<T.length;ib++){const Tb=this.Lql(T.J(ib));Aa.add(Tb)}return Aa}iKc(T,Aa,ib){const Tb=T.qu===T.nz&&T.startCp===T.endCp;Aa&&({mHa:T.qu,eqa:T.startCp}=
this.pUa(T.qu,T.startCp,T.qu),Tb&&(T.nz=T.qu,T.endCp=T.startCp));ib&&!Tb&&({mHa:T.nz,eqa:T.endCp}=this.pUa(T.nz,T.endCp,T.nz));return T}Lql(T){if(T.qu===T.nz){var Aa=new Sn.a;Aa.add(T.startCp);Aa.add(T.endCp);({mHa:T,xNb:Aa}=this.tng(T.qu,Aa));return new Tm.a(T,Aa.J(0),T,Aa.J(1))}Aa=new Sn.a;var ib=new Sn.a;let Tb;Aa.add(T.startCp);({mHa:Aa,xNb:Tb}=this.tng(T.qu,Aa));ib.add(T.endCp);({mHa:T,xNb:ib}=this.tng(T.nz,ib));return new Tm.a(Aa,Tb.J(0),T,ib.J(0))}tng(T,Aa){let ib=T,Tb=Aa;if(!this.GF.J(T))return ra.ULS.sendTraceTag(4339675,
318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",T),{mHa:ib,xNb:Tb};if(this.vbb.get(T))({mHa:ib,xNb:Tb}=this.sfk(T,Aa,ib,Tb));else if(this.lH.Czf&&!this.lH.Czf.J(this.lH.Czf.length-1).o4(T)){Tb=new Sn.a;for(let xc=0;xc<Aa.length;xc++){let ld;({mHa:ib,eqa:ld}=this.pUa(T,Aa.J(xc),ib));Tb.add(ld)}}return{mHa:ib,xNb:Tb}}Ibi(T){let Aa="";T.forEach(ib=>{Aa+=ib.N$c();Aa+=" ";return!0});return Aa}aci(T){const Aa=sa.a.instance.Na("Box4.IFeatureHelper"),
ib=new Tn.a;ib.input.source=this.lH.twf;ib.input.Sha=this.lH.Sha;ib.input.TLc=()=>Aa;ib.runtime.uk=this.GF;ib.runtime.YCa=this.lH.l3k;1===T?(ib.runtime.Eu=this.Ivb,ib.runtime.Jq=this.vbb,ib.runtime.PLd=this.lH.iFi,ib.runtime.Ene=this.lH.zFi):2===T&&(ib.runtime.Eu=this.vbb,ib.runtime.Jq=this.Ivb,ib.runtime.PLd=this.lH.zFi,ib.runtime.Ene=this.lH.iFi);ib.runtime.Xb=Aa;return ib}NFl(T,Aa,ib){if(T.runtime.Eu.mb(Ud.a.zL)){var Tb=T.runtime.Eu.J(Ud.a.zL);Tb=this.Ng.getPropertyObjectIds(Tb,lm.a.u1);if(1===
Tb.length&&(Tb=Tb.J(0),T.runtime.Eu.mb(Tb)&&(Tb=T.runtime.Eu.J(Tb),3===this.Ng.getPropertyInt32(Tb,lm.a.vqb)))){const xc=this.Ng.getPropertyString(Tb,lm.a.Cja),ld=this.Ng.getPropertyString(Tb,lm.a.VQb);Aa.toString()===xc&&xc===ld&&(Aa=this.Ng.getPropertyObjectId(Tb,lm.a.jbd),T.runtime.Eu.mb(Aa)&&ib.add(T.runtime.Eu.J(Aa)))}}}a8l(T,Aa){let ib=0;for(let Tb=0;Tb<T.length;Tb++)if(Aa.equals(T.J(Tb)))return ib=Tb,{returnValue:!0,idx:ib};return{returnValue:!1,idx:ib}}pUa(T,Aa){const ib=this.Pak&&!!this.Ivb.J(T)&&
!this.GF.J(T);let Tb=T,xc=Aa,ld=!1,Sd=!1;(ib?this.Ivb:this.vbb).forEach((df,De)=>{this.lH.SG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");if(this.hFf(De.Rc)&&this.GF.J(df)){De=null;if(ib){De=this.tPc(Wg=>this.Ivb.J(Wg)||this.GF.J(Wg),df);var Ff=this.$Zd(De,T)}else Ff=this.tPc(Wg=>this.GF.J(Wg),df),Ff=this.$Zd(Ff,T);if(Ff&&(Sd=!0,De||(De=this.tPc(Wg=>this.Ivb.J(Wg)||this.GF.J(Wg),df)),df=this.tPc(Wg=>this.vbb.J(Wg)||this.GF.J(Wg),df),Ff=0,({idx:Ff}=this.a8l(De,T)).returnValue)){for(let Wg=
Ff+1;Wg<De.length;Wg++)if(this.$Zd(df,De.J(Wg)))return xc=0,Tb=De.J(Wg),ld=!0,!1;for(--Ff;0<=Ff;Ff--)if(this.$Zd(df,De.J(Ff)))return xc=Number.MAX_VALUE,Tb=De.J(Ff),ld=!0,!1}}return!0});ld||(ra.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",T,Aa,ib,Sd),5===this.lH.twf&&(ra.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",
Tb),({s0h:Aa}=this.UXl()).returnValue?(Tb=Aa,xc=0,ra.ULS.sendTraceTag(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Tb)):ra.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Tb)));return{mHa:Tb,eqa:xc}}UXl(){let T=ih.a.nil,Aa=new Sn.a;this.vbb.forEach((ib,Tb)=>
{this.lH.SG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");return this.hFf(Tb.Rc)?(Aa=this.tPc(xc=>this.vbb.J(xc)||this.GF.J(xc),ib),!1):!0});return 0<Aa.length?(T=Aa.J(0),{returnValue:!0,s0h:T}):{returnValue:!1,s0h:T}}hFf(T){return 393241===T||393250===T||393251===T||393252===T}tPc(T,Aa){var ib=T(Aa);Aa=new Sn.a;if(!this.hFf(ib.Rc))return Aa;ib=this.Ng.getPropertyObjectIds(ib,Jo.a.ef);for(let Tb=0;Tb<ib.length;Tb++){const xc=new Sn.a;this.Tsf(T,ib.J(Tb),xc);Aa.PC(Aa.length,
xc)}return Aa}Tsf(T,Aa,ib){var Tb=T(Aa);if(Tb)if(393230===Tb.Rc)ib.add(Aa);else if(393229===Tb.Rc)Aa=this.Ng.getPropertyObjectIds(Tb,Jo.a.MK).$f(0),this.Tsf(T,Aa,ib);else if(393250===Tb.Rc||393251===Tb.Rc||393252===Tb.Rc)for(Aa=this.Ng.getPropertyObjectIds(Tb,Jo.a.ef),Tb=0;Tb<Aa.length;Tb++)this.Tsf(T,Aa.J(Tb),ib)}$Zd(T,Aa){for(let ib=0;ib<T.length;ib++)if(Aa.equals(T.J(ib)))return!0;return!1}}Object(f.a)(cl,"GraphMergeSelectionRecordUpdater",null,[]);class dl extends un.a{constructor(T=null,Aa=null,
ib=null,Tb=null,xc=null,ld=null,Sd=null,df=null,De=null,Ff=null,Wg=null){var Vh;super();this.rNh=zk=>{const Wi=zk.SW,dk=cb.App.xa.ib.Uc;return new Ln.a(zk,Wi,dk.od,dk.fileId,dk.Fnb,dk.contextId,Wi?Wi.id:ih.a.nil,this.Uee,!1,!0)};this.XP=T||(()=>l.AFrameworkApplication.rootQuerySignature);Aa||(Aa=zk=>new Mo.a(zk));this.Mdh=Aa;this.Ng=ib||new ws.a;this.NOg=Sd||new Rn.ChildNodeListMerge(this.Ud);this.KYb=df;this.Uee||(this.KYb=(zk,Wi,dk)=>new Dq.a(zk,Wi,dk));this.uXb=Tb||this.YOc();this.fab=xc||new Aq.a;
this.CXg=ld||new jo(this.Ud);this.B6g=(null===(Vh=l.AFrameworkApplication.K)||void 0===Vh?void 0:Vh.mc("WordEditorGraphMergeMaxBrowserTimeInMs",750))||750;this.Lza=De;this.DJa=Ff;this.GTd=this.Rml(Wg);this.bVg=()=>sa.a.instance.Na("Box4.IFeatureHelper")}Rml(T){T||(T=l.AFrameworkApplication.K?l.AFrameworkApplication.K.mc("WordEditorGraphMergeBackupCasesBrowser",0):0);return T}kEa(){return(new Date).getTime()}Dwj(T,...Aa){return String.format.apply(null,[T].concat(Aa))}HKo(T){throw oc.a.invalidOperation(T);
}xPd(T){return String.format("Name: {0}, Message: {1}, Stack: {2}",T.name,T.message,T.stack)}OGn(T){if(this.Lza&&this.Lza.mDi||!this.pGo(T))return null;this.z5m(T);let Aa;({lKk:Tb,jKo:xc,V8o:Aa}=this.Fel(T,this.rNh));const ib=un.a.fZl(T);var Tb=vn.construct(this.XP(),Tb.Yya(),xc.Yya(),Aa.Yya(),T.input.xGb,T.input.Sha,T.input.nm,T.input.OJb,T.input.source,ib,this.DJa.Uxa);var xc=T.output.LM;3===ib&&0<xc.length&&(Tb.MergedRevision=this.rNh(T.output.LM.last()));return Tb}jKc(T,Aa){return(new cl(T)).jKc(Aa)}iKc(T,
Aa,ib,Tb){return(new cl(T)).iKc(Aa,ib,Tb)}}Object(f.a)(dl,"GraphMerger",un.a,[]);class fk extends dl{constructor(T,Aa=null,ib=null){super(T,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Aa,ib);this.ra=new M.a}get Uxa(){return this.DJa?this.DJa.Uxa:0}get delayedMergeOperation(){return null}set delayedMergeOperation(T){}uyk(T){this.ra.addHandler(fk.swf,T)}l2n(T){this.ra.removeHandler(fk.swf,T)}Cdg(){return!1}Wdc(T,Aa,ib,Tb,xc,ld,Sd){(T=super.Wdc(T,Aa,ib,Tb,xc,ld,Sd))&&this.ra.raiseEvent(fk.swf,new pg(T));
return T}}fk.swf="GMC";Object(f.a)(fk,"WordEditorGraphMerger",dl,[1997,1560,1561]);class Un{constructor(){this.W=null}get name(){return"WordEditor.GraphMerge"}xc(T){this.W=T;this.W.ha("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new Zp(this.W.Sa("WordEditor.IBusinessBarController"),new bb.a(()=>T.Na("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new Ii(this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").singleInstance();
this.W.ha("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new fk(()=>l.AFrameworkApplication.rootQuerySignature,this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Am(()=>l.AFrameworkApplication.rootQuerySignature,l.AFrameworkApplication.va,this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),
this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").singleInstance()}init(){cb.App.UR||(cb.App.UR=Tq.a.O7());const T=this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");cb.App.UR.eLk(T);this.W.resolve("Box4.IGraphMergeBackupManager")}dispose(){let T=this.W.Na("Box4.IGraphMergeBackupManager");T&&T.dispose()}}Object(f.a)(Un,"GraphMergePackage",null,[1,2]);var Eq=c(281);class Gp{constructor(T){this.kwe=
"FontPicker";this.fGe=null;this.g9a=T;this.$id=this.g9a.gya(Eq.a.$Ib,Object(a.a)(this,this.kDb,"featureStateChangeCallback"));this.g9a.isFeatureEnabled(Eq.a.$Ib,!1).then(Aa=>{this.fGe=Aa})}get isLicensed(){return this.fGe}kDb(T){this.fGe=T.isEnabled;T=appChrome.actions.updateFontPickerLicenseState(this.kwe,T.isEnabled);appChrome.api.dispatch(T)}dispose(){this.g9a.shc(Eq.a.$Ib,this.$id)}}Object(f.a)(Gp,"ModernFontPickerFeatureHelper",null,[1207,10]);var Ko=c(474),pm=c(640),tp=c(1674);class nq{constructor(){this.type=
"FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(f.a)(nq,"FontInfoTaskPaneProps",null,[]);class Bn{constructor(T,Aa,ib,Tb=null){this.pWe=this.TV=this.$id=null;this._state=this.RWb=0;this.aJe=T;this.g9a=Aa;this.XXj=ib;this.Ub=Tb}get pc(){return this.aJe.value}initialize(){this.pc.qa(n.a.p7f,y.a.frame,Object(a.a)(this,this.p7f,"requestFontInfo"));this.$id=this.g9a.gya(Eq.a.$Ib,Object(a.a)(this,this.kDb,
"featureStateChangeCallback"));this.cja()}pP(T=!1){const Aa=Kj.UISurfaces.Gu(),ib=this.g9a.isFeatureEnabled(Eq.a.$Ib,!1),Tb=[];Tb.push(Aa);Tb.push(ib);Promise.all(Tb).then(xc=>{xc[0].showTaskPane(tp.a.FDb,this.pA(xc[1]));T&&this.YJ()})}QYo(T){Kj.UISurfaces.Gu().then(Aa=>{Aa.updateTaskPane(tp.a.FDb,this.pA(T));return null})}kDb(T){this.QYo(T.isEnabled)}p7f(T,Aa,ib,Tb,xc){this.TV=xc.CommandValueId;this.pWe=xc.Trigger;this.RWb=xc.InputMethod;this.pP(2===this._state&&1===this.RWb);return 32}pA(T){const Aa=
new nq;Aa.onUpsellButtonClicked=Object(a.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");Aa.fontName=this.TV;Aa.isLicensed=T;Aa.trigger=this.pWe;Aa.helpArticleUrl=this.b5k();Aa.paneId=tp.a.FDb;T=this.Mym();T.contentProps=Aa;return T}Mym(){return Object.assign(new Ug.a,{title:tp.a.Ofc,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(a.a)(this,this.onOpen,"onOpen"),onClose:Object(a.a)(this,this.onClose,"onClose"),onShow:Object(a.a)(this,
this.onShow,"onShow"),onHide:Object(a.a)(this,this.onHide,"onHide")})}cja(){if(this.Ub){var T=this.Ub.fe(tp.a.FDb);T.parent=Bd.AFrame.rp;T.RH=!0}}onOpen(){this._state=2;this.YJ()}onShow(T){0!==this._state&&(this._state=2,1===T&&(this.RWb=T),this.YJ())}onClose(){this.RWb=this._state=0;this.blur()}onHide(){this._state=1;this.RWb=0}YJ(){this.Ub&&1===this.RWb&&this.Ub.mg(tp.a.FDb)}blur(){this.Ub&&this.Ub.currentScope&&this.Ub.currentScope.name===tp.a.FDb&&this.Ub.mg(this.Ub.vT)}onUpsellButtonClicked(){this.g9a.launchUpsellExperience(tp.a.experienceId)}dispose(){this.g9a.shc(Eq.a.$Ib,
this.$id)}b5k(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.XXj,this.a_l(),"WDWAENDUSER",l.AFrameworkApplication.lcid)}a_l(){switch(this.pWe){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return Bn.ANk(this.TV)}static ANk(T){let Aa="hlpFontInfo";for(let ib=0;ib<T.length;++ib){const Tb=Ta.a.charAt(T,
ib);if(255<T.charCodeAt(ib)||Ta.a.VXd(Tb))Aa+=Tb}return Aa}}Object(f.a)(Bn,"FontInfoPane",null,[942,10]);class em extends Bn{constructor(T,Aa,ib,Tb,xc){super(T,Aa,Tb.jb("FontInfoHelpBaseUrl"),xc);this.V2=ib}pP(T){this.d_();super.pP(T)}kDb(T){super.kDb(T);cb.App.xa.updateCommandUI()}d_(){this.V2.QNa()}}Object(f.a)(em,"WordEditorFontInfoPane",Bn,[]);class Zi{constructor(){this.rVb=this.ipd=this.Atc=this.W=null}get name(){return"WordEditor.ModernFontPicker"}xc(T){this.W=T;T.ha("Common.ModernFontPicker.IModernFontPickerFeatureHelper",
()=>new Gp(this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).singleInstance();T.ha("Common.ModernFontPicker.IFontInfoPane",()=>new em(new bb.a(()=>l.AFrameworkApplication.va),this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Bc.a.instance,l.AFrameworkApplication.K,ji.FocusManager.instance())).singleInstance()}init(){this.ipd=this.W.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.Atc=this.W.resolve("Common.ModernFontPicker.IFontInfoPane");
this.Atc.initialize();l.AFrameworkApplication.K.$("IsAnonymousUser")||((this.rVb=this.W.Na(pm.a))?this.rVb.initialize():ra.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));cb.App.xa.updateCommandUI()}dispose(){this.Atc&&(this.Atc.dispose(),this.Atc=null);this.ipd&&(this.ipd.dispose(),this.ipd=null);this.rVb&&(this.rVb.OCa(),this.rVb=null)}static main(){Object(Ko.a)()&&L.a.instance.Fc(new Zi)}}Object(f.a)(Zi,"ModernFontPickerPackage",null,[1,2]);var el=c(133),Cn=c(5),
Lo=c(245),xk=c(36),qm=c(1099);class Wo{constructor(T,Aa,ib,Tb,xc,ld,Sd,df,De,Ff,Wg,Vh=null){this.YY=ib;this.Wc=T;this.Ic=Aa;this.nh=xc;this.lJa=ld;this.EV=Sd;this.sOg=df;this.rOg=De;this.Wx=Ff;this.u0j=Vh||Wo.mw}get gh(){return this.Wx?this.Wx.gh:!1}dsi(T){return this.dFa(T,0)}RBm(T){return this.dFa(T,1)}dFa(T,Aa){let ib=null;if(this.gh&&this.EV&&(this.rOg.instance&&this.rOg.instance.AIa(T),Aa?1===Aa&&(ib=this.EV.Mbi(T.node)):ib=this.EV.Zof(T.node,T.cpBegin,T.Eb),ib&&!ib.ia(lm.a.J8,!1)))return ra.ULS.shipAssertTag(24749379,
368,!1,"Try to insert page break to inconvertible inline content control"),2;const Tb=Cn.GraphIterator.tX(this.Wc.Bk());Tb.set(T.node);Tb.zb(10);const xc=this.Ic.Oc(15);xc.Lt(Tb);Aa?xk.OutlineElementNavigator.Vd(Tb):(this.splitParagraph(Tb,T),this.YY.zmc(T.node,gk.a.Fs));T=El.ParagraphReader.Vk(Tb.currentNode);this.hDm(Tb);this.gh&&ib&&this.sOg&&(Aa=new jb.a,Aa.add(Tb.currentNode),this.sOg.Gnh(Aa,ib.id));this.Mko(T);xc.dispose();return 32}Mko(T){T=fe.SelectionFactory.pe(T,0);Ui.a.instance.setSelection(T)}hDm(T){this.nh.xz(T,
!0,!0,null,!1,!1);T=xk.OutlineElementNavigator.Ge(T);this.SBm(T)}splitParagraph(T,Aa){const ib=xk.OutlineElementNavigator.Vd(T);if(Aa.cpBegin||this.gh&&(!this.gh||-1!==Aa.Eb)){cb.App.rd.Qo&&Aa.cpBegin!==El.ParagraphReader.textLength(Aa.node)&&cb.App.rd.Tp.VF(Aa.node);this.nh.xz(T,!1,!0,null,!1,!0);var Tb=Cn.GraphIterator.tX(this.Wc.Bk());Tb.set(ib);this.nh.Z9(Tb,T,Aa,!0,!0,!0)}}SBm(T){T=this.u0j(T);this.lJa.Bsi(T)}static ZE(){return new Wo(new qi.a,new Fl.a,sa.a.instance.resolve("Box4.IAutoCorrectScheduler"),
qm.a.instance,sa.a.instance.resolve("Box4.IOutlineElementEditor"),sa.a.instance.resolve("Box4.IBlobEditor"),sa.a.instance.Na("Box4.IContentControlReader"),sa.a.instance.Na("Box4.IContentControlEditor"),sa.a.instance.Sa("Box4.IContentControlConverter"),sa.a.instance.Na("Box4.ContentControlConfigSettings"),sa.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return null!=Wo.FCg?Wo.FCg:Wo.FCg=Wo.ZE()}static mw(T){return Ef.a.mw(T)}}Object(f.a)(Wo,"PageBreakInserter",null,[2021]);class oq{constructor(T,
Aa,ib,Tb,xc,ld,Sd,df){this.kDm=(De,Ff,Wg,Vh)=>{var zk=Ff.view,Wi=zk.lb.tg;if(!Wi)return 2;if(!this.i7e(Ff))return 8;if(1===Wg)return 32;let dk=!0;Wg=8;const mo=this.gHe(Wi);Wi=this.Ic.Oc(15);Wi.Cb(zk.Yc);Wi.jk=De;mo||(Wg=this.ga.Mf(Ff,Kg.a.Oma,2,!0,Vh,null),De=32===Wg,ra.ULS.shipAssertTag(4208012,314,De),dk=De);dk&&(zk=zk.lb.tg,De=this.gHe(zk),ra.ULS.shipAssertTag(4208013,314,De,"{0}",{["ContextId"]:Ff.contextId}),Wg=8,De&&(Wg=this.UEe.dsi(zk),ra.ULS.shipAssertTag(4208014,314,32===Wg)));Wi.dispose();
32===Wg&&this.Sd.Ns(10);return Wg};this.jDm=(De,Ff,Wg)=>{if(!Ff||Ff.contextId!==Li.a.Tc)return 8;if(1===Wg)return Ff.contextId===Li.a.Tc?32:8;if(2===Wg){if(!this.i7e(Ff))return 8;De=this.UEe.dsi(Ff);32===De&&this.Sd.Ns(10);return De}return 32};this.iDm=(De,Ff,Wg)=>{if(!Ff||Ff.contextId!==Li.a.table)return 8;if(1===Wg)return 32;if(2===Wg){if(!this.i7e(Ff))return 8;De=this.UEe.RBm(Ff);32===De&&this.Sd.Ns(10);return De}return 32};this.ga=T;this.UEe=Aa;this.Ic=ib;this.Sm=Tb;this.gHe=xc;this.Jk=ld;this.q9j=
Sd;this.Sd=df}Tb(){this.ga.qa(Yg.a.dFa,Li.a.view,this.kDm);this.ga.qa(Yg.a.dFa,Li.a.Tc,this.jDm);this.ga.qa(Yg.a.dFa,Li.a.table,this.iDm);this.ga.Vc(Yg.a.dFa,4)}Z4(){const T=ji.FocusManager.instance().fe(el.AppFrame.JD);Bd.AFrame.yi(T,qf.KeyInputManager.jc(gk.a.Fs,qf.KeyInputManager.Qh),Yg.a.dFa)}PNm(T){return this.ex(T.iterator)}vRm(T){T=T.J(0);const Aa=$e.SelectionEditor.Cj(T,!0,!1);if(this.ex(Aa.Oa.iterator))return!0;T=$e.SelectionEditor.Cj(T,!1,!1);return this.ex(T.Oa.iterator)}ex(T){return T.zb(14)}i7e(T){let Aa=
null,ib=T;if(ib.contextId===Li.a.view){Aa=ib.view;if(!Aa.features.Ahg)return!1;ib=Aa.lb.tg;if(!ib)return!1}else{const Tb=Cn.GraphIterator.$a(ib.node);if(Tb.zb(36)||Tb.zb(38)||Tb.zb(40)||Tb.zb(14))return!1}return Lo.a.rha(T)?!1:ib.contextId===Li.a.table?this.Jk.zNm(ib.node):!this.Jk.xNm(ib)||this.Sm&&this.Sm.instance&&this.Sm.instance.pU(ib)?!1:((T=this.gHe(ib))?this.PNm(ib):this.vRm(Aa.lb.gb))||T&&this.q9j(ib,!0)?!1:!0}static ZE(){return new oq(l.AFrameworkApplication.va,Wo.instance,new Fl.a,sa.a.instance.Sa("Box4.IExternalSelectionManager"),
$e.SelectionEditor.gf,dp.a.instance,lf.a.Gwa,sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return null!=oq.zBg?oq.zBg:oq.zBg=oq.ZE()}}Object(f.a)(oq,"PageBreakActor",null,[1986]);class Fq{constructor(){this.hNe=this.W=null}get name(){return"WordEditor.PageBreak"}xc(T){this.W=T}init(){this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>{this.hn()})}hn(){this.hNe=oq.instance;this.hNe.Tb();this.hNe.Z4();cb.App.xa.updateCommandUI()}dispose(){}}
Object(f.a)(Fq,"PackageManager",null,[1,2]);var Xo=c(1484),Hp=c(1485),zj=c(271),kk=c(188),fp=c(244),fl=c(275),Xl=c(440);class up{constructor(T,Aa,ib,Tb,xc,ld,Sd){this.Cwb=null;this.ra=new M.a;this.Bxe=1;this.Vnd=-1;this.oXa=null;this.upa=()=>{this.O5e()};this.hb=Aa;this.Gb=ib;this.Xhd=Tb;this.xI=xc;this.Oy=ld;this.bfa=Sd;this.enable()}get LHd(){return this.Bxe}Ioj(T){this.Bxe!==T&&(this.Bxe=T,this.ra.raiseEvent("X"),this.mFf&&this.dng())}get mFf(){const T=sa.a.instance.Na("WordEditor.Pagination.IPageEndMarkers");
return T?T.mFf:!0}get lf(){return this.xI.value}get Kk(){return Ie.a.instance}wxk(T){this.ra.addHandler("X",T)}dng(){this.Kk.ie(()=>{this.bfa.OU(Xl.a.y_i)},"CPC:UPN")}enable(){this.hb.Pw(this.upa);this.O5e()}O5e(){if(!this.oXa||1>=this.oXa.count)this.Ioj(1);else{var T=this.hb.gb.kb;if(T){var Aa=T.Lf?T.Pc:T.Oa;!Aa||0>Aa.cpBegin||(T=Aa.node)&&El.ParagraphReader.Wb(T)&&this.gNm(T)&&(this.Cwb&&(this.Gb.Xe(this.Cwb),this.Cwb=null),this.Cwb=new Qc.a(2,1,400,ib=>{this.findCurrentPageFromIp(ib,Aa)},62),this.Gb.Vb(this.Cwb))}}}gNm(T){T=
Cn.GraphIterator.$a(T);return T.zb(35)||T.zb(37)||T.zb(39)?!1:!0}nHj(T){this.oXa=T;this.MFj()}MFj(){if(-1!==this.Vnd){var T=this.kDl(this.Vnd);-1!==T&&this.Ioj(T)}}findCurrentPageFromIp(T,Aa){this.Cwb===T&&(this.Cwb=null,this.Vnd=this.zLl(Aa),-1!==this.Vnd&&this.MFj())}kDl(T){if(!this.oXa)return-1;for(let Aa=0;Aa<this.oXa.count;Aa++){const ib=this.oXa.J(Aa);if(T>ib.tmh&&T<ib.tmh+ib.height)return ib.Bh}return-1}zLl(T){var Aa=this.t8l(T);if(!Aa||!Aa.htmlElement)return-1;const ib=Aa.getBounds();T=this.kTl(T,
Aa);if(!T)return-1;Aa=pa.a.x1a(this.Xhd.Y4a,Aa.htmlElement).y;return T.y+Math.floor(T.height/2)-ib.y+Aa}t8l(T){return T.node.De(this.lf.fc)}kTl(T,Aa){T=this.Oy?this.Oy.iba(T,!0):T.cpBegin;return fl.a.Tq(Aa,T)}disable(){this.hb.CY(this.upa)}}Object(f.a)(up,"CurrentPageCalculator",null,[2018,2005]);class bh{constructor(T){bh.kZ=T}get Hcf(){return bh.kZ}get LHd(){return this.Hcf.LHd}Uul(){this.Hcf.enable()}qol(){this.Hcf.disable()}}bh.kZ=null;Object(f.a)(bh,"CurrentPageManager",null,[2019]);var uo=c(118);
class vo extends Sys.EventArgs{constructor(T,Aa){super();this.WQi=Aa}}Object(f.a)(vo,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class Mn extends Sys.EventArgs{constructor(T,Aa,ib){super();this.delta=T;this.WQi=ib}}Object(f.a)(Mn,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class Nh{static get JZa(){if(null!=Nh.Ewg)var T=Nh.Ewg;else{var Aa;T=!(null===(Aa=l.AFrameworkApplication.K)||void 0===Aa||!Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CallAfterValidateDirectlyIsEnabled",
!1));T=Nh.Ewg=T}return T}constructor(T,Aa,ib){this.ybh=this.csd=-1;this.Iyc=null;this.ra=new M.a;this.kLe=!1;this.PXf=(Tb,xc)=>{this.kLe=this.vWk();xc.Kmb||this.gtc.value.measure(this.qWk)};this.qWk=()=>{const Tb=this.Y4a.clientHeight;this.pWk(Tb);this.yWk(Tb)};this.rXf=(Tb,xc)=>{xc.property===uo.a.iJ&&(Tb=xc.node)&&Tb.ia(uo.a.iJ,!1)&&(Tb=Tb.De(this.lf.fc))&&(Tb=Tb.htmlElement)&&this.lXa.add(Tb)};this.xI=T;this.gtc=Aa;this.lXa=new jb.a;Nh.JZa||this.lf.I_e(this.PXf);this.oyf();this.Hca=this.Hca.bind(this);
ib.tzb(this.Hca);Nh.JZa&&0===ib.fu&&this.YM()}YM(){this.lf.I_e(this.PXf)}eza(){this.lf.wbj(this.PXf)}get lf(){return this.xI.value}Hca(T,Aa){this.Iyc=null;Nh.JZa&&(1===Aa.Nlb?this.eza():0===Aa.Nlb&&this.YM())}get Y4a(){this.Iyc||(this.Iyc=this.lf.Yc.De(this.lf.fc).Y4a,ra.ULS.shipAssertTag(34136386,336,!!this.Iyc));return this.Iyc}Jyk(T){this.ra.addHandler("OnPageContentSizeChangeKey",T)}pWk(T){T!==this.ybh&&(this.ra.raiseEvent("OnDocumentBottomChangeKey",new vo(T,this.kLe)),this.ybh=T)}yWk(T){T!==
this.csd&&(-1!==this.csd&&this.ra.raiseEvent("OnPageContentSizeChangeKey",new Mn(T-this.csd,T,this.kLe)),this.csd=this.Y4a.clientHeight)}vWk(){let T=!1;for(let Aa=this.lXa.count-1;0<=Aa;Aa--)this.lXa.J(Aa).hasChildNodes()&&(this.lXa.removeAt(Aa),T=!0);return T}oyf(){cb.App.Xj.zl.Ze(23).Go(this.rXf)}}Object(f.a)(Nh,"DocumentSizeManager",null,[]);var Um=c(53),No=c(246);class on{constructor(T){this.xI=T}get lf(){const T=this.xI.value;ra.ULS.shipAssertTag(37820298,336,T.Wi,"OutlineManager.PageView is not a PageView.");
return T}zhe(T,Aa){const ib=Um.a.Ji(on.Sf.xB(T),1);Aa+=ib;T.De(this.lf.fc).htmlElement.firstChild.style.minHeight=Aa+"px"}G9h(){const T=Cn.GraphIterator.$a(this.lf.Yc);T.Bp();T.Pd();ra.ULS.shipAssertTag(37820299,336,10===T.wn.type);return T.wn}dbi(){const T=Cn.GraphIterator.$a(this.lf.Yc);T.Bp();T.J_();ra.ULS.shipAssertTag(37820300,336,10===T.wn.type);return T.wn}f$l(T){const Aa=Cn.GraphIterator.$a(this.lf.Yc);Aa.Bp();Aa.Pd();let ib=Aa.wn,Tb=null;for(;T!==ib&&Aa.Lj();)Tb=ib,ib=Aa.wn;ra.ULS.shipAssertTag(37820301,
336,10===Aa.wn.type);return Tb}static get Sf(){return No.a.instance}}Object(f.a)(on,"OutlineManager",null,[2003]);class wo{constructor(T){this.QAa=0;this.O1=null;this.keg=Aa=>{for(const ib of Aa.customData)this.showAdornmentText(ib)};this.Gb=T}X8d(){this.O1||(this.O1=this.HIc())}qEd(){this.O1&&0<wo.zNc(this.O1).length&&this.Gb.Vb(this.O1);this.O1=null}HIc(){return Object.assign(new Qc.a(3,1,250,this.keg,166),{customData:[]})}tbg(T){this.QAa=T}F8c(T){if(T){T.style.width=this.QAa+"px";if(this.O1)var Aa=
this.O1;else Aa=this.HIc(),this.Gb.Vb(Aa);wo.zNc(Aa).push(T)}}sRc(T){T&&(T.style.width="0px",this.Yxf(T))}abd(T,Aa){Aa?this.F8c(T):this.sRc(T)}showAdornmentText(T){T.style.width===this.QAa+"px"&&(this.MNc(T).style.visibility="visible")}Yxf(T){T&&(this.MNc(T).style.visibility="hidden")}MNc(T){T=T.childNodes;ra.ULS.shipAssertTag(24958351,336,1===T.length,"Expected 1 child div in the page adornment, found "+T.length);return T[0]}static zNc(T){return T.customData}}Object(f.a)(wo,"PageAdornmentAnimationManager",
null,[2001]);class rm{constructor(T){this.em=T;this.eaa=new Dc.a;this.faa=new Dc.a}ZCa(T){T=Cn.GraphIterator.$a(T);if(T.Bp()&&T.Mp()){T.Pd();do 10===T.We&&this.XZf(T.currentNode),T.Bt();while(8!==T.We)}}XOb(T){const Aa=T.Bh;var ib=this.sFb(T.tQb);if(!this.eaa.mb(ib))return ra.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+ib),!1;T=this.eaa.J(ib);ra.ULS.shipAssertTag(24958353,336,this.faa.mb(ib),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");
ib=this.faa.J(ib);return this.Sxf(T,Aa,ib)}WOb(T){const Aa=T.Bh;var ib=this.sFb(T.tQb);if(!this.eaa.mb(ib))return ra.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+ib),!1;T=this.eaa.J(ib);ra.ULS.shipAssertTag(24958355,336,this.faa.mb(ib),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");ib=this.faa.J(ib);return this.Plf(T,Aa,ib)}$uf(T){if(!T)return ra.ULS.sendTraceTag(24979136,
336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var Aa=T.cCd;if(!Aa)return ra.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",T.Bh)),0;Aa=this.em.AEb(Aa);if(!Aa)return ra.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;Aa=this.em.Yga(Aa);const ib=1===T.Bh;T=!(T.Bh%2);return 1===Aa?1:2===Aa?ib?2:1:3===Aa?T?3:4:ib?2:T?3:4}XZf(T){if(10===T.type){var Aa=new Dc.a,ib=this.em.AEb(T);
ra.ULS.shipAssertTag(24958356,336,!!ib,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var Tb=this.em.Yga(ib);T=this.sFb(T);this.rng(T,Tb);this.qng(T,Aa);ib=Cn.GraphIterator.$a(ib);if(ib.Mp()){ib.Pd();do T=ib.currentNode,Tb=this.em.GOc(T),T=this.em.Sni(T),Aa.add(Tb,T),ib.Bt();while(36===ib.We)}}}rng(T,Aa){this.faa.mb(T)?this.faa.Z(T,Aa):this.faa.add(T,Aa)}qng(T,Aa){this.eaa.mb(T)?this.eaa.Z(T,Aa):this.eaa.add(T,Aa)}sFb(T){ra.ULS.shipAssertTag(24958358,
336,10===T.type,"Expected node of type Outline but received node of type "+T.type);return T.ia(lm.a.Oia,0)}Sxf(T,Aa,ib){const Tb=1===Aa;Aa=!(Aa%2);switch(ib){case 2:if(Tb){if(T.mb(2))return T.J(2)}else if(T.mb(0))return T.J(0);break;case 3:if(Aa){if(T.mb(1))return T.J(1)}else if(T.mb(0))return T.J(0);break;case 4:if(Tb){if(T.mb(2))return T.J(2)}else if(Aa){if(T.mb(1))return T.J(1)}else if(T.mb(0))return T.J(0);break;case 1:if(T.mb(0))return T.J(0)}return!1}Plf(T,Aa,ib){const Tb=1===Aa;Aa=!(Aa%2);
switch(ib){case 2:if(Tb){if(T.mb(5))return T.J(5)}else if(T.mb(3))return T.J(3);break;case 3:if(Aa){if(T.mb(4))return T.J(4)}else if(T.mb(3))return T.J(3);break;case 4:if(Tb){if(T.mb(5))return T.J(5)}else if(Aa){if(T.mb(4))return T.J(4)}else if(T.mb(3))return T.J(3);break;case 1:if(T.mb(3))return T.J(3)}return!1}}Object(f.a)(rm,"PageAdornmentContentManager",null,[2002]);var $i=c(1157);class di{constructor(T,Aa,ib,Tb,xc,ld,Sd,df,De){this.vog(T,Aa,ib,ld,Sd,df,De);this.Bh=T;this.Sq=Aa;this.Gr=ib;this.tQb=
Tb;this.cCd=xc;this.cfb=ld;this.N9b=Sd;this.T6b=df;this.K_i=De}get top(){return this.Sq}get height(){return this.Gr}Q7c(T){this.Sq!==T&&(this.cfb.style.top=T+"px",this.Sq=T)}Xag(T){this.height!==T&&(this.cfb.style.height=T+"px",this.Gr=T)}vog(T,Aa,ib,Tb,xc,ld,Sd){ra.ULS.shipAssertTag(37244961,336,0<T,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",T);ra.ULS.shipAssertTag(37244962,336,0<=Aa,"PageAdornmentContainer: top parameter value {0} is unexpected value.",Aa);ra.ULS.shipAssertTag(37244963,
336,0<=ib,"PageAdornmentContainer: height parameter value {0} is unexpected value.",ib,Aa);ra.ULS.shipAssertTag(37244992,336,!!Tb,"PageAdornmentContainer: containerDomElement parameter is null.");ra.ULS.shipAssertTag(37244993,336,!!xc,"PageAdornmentContainer: headerLabelDomElement parameter is null.");ra.ULS.shipAssertTag(37244994,336,!!ld,"PageAdornmentContainer: footerLabelDomElement parameter is null.");ra.ULS.shipAssertTag(37244995,336,!!Sd,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}
Object(f.a)(di,"PageAdornmentContainer",null,[2025]);class Mi{constructor(T,Aa,ib,Tb,xc,ld,Sd,df,De,Ff,Wg,Vh,zk){this.tYg="headerFooterTab";this.swd=null;this.Ks=!0;this.jDe=0;this.sIe=null;this.U1a=!1;this.KKb=Wi=>{this.eln(Wi.Qw);return!0};this.OB=()=>!0;this.fGb=()=>{this.baf()&&(this.U1a=!1,this.iUo(),this.sIe=new Date)};this.OKb=Wi=>{this.U1a||this.yV.F8c(Wi.Qw);return!0};this.NKb=Wi=>{this.U1a||(Wi=Wi.Qw,this.Sdg(Wi)||this.yV.sRc(Wi));return!0};this.cWn=()=>{let Wi=Array.dequeue(this.KPe);for(;Wi;)this.YM(Wi),
Wi=Array.dequeue(this.KPe);this.swd=null};this.xI=T;this.ig=Aa;this.pE=ib;this.Wja=Tb;this.ga=xc;this.sk=ld;this.yV=Sd;this.aAa=df;this.JKa=De;this.Gb=Ff;this.Fa=Wg;this.KPe=[];this.K1=new Map;this.uI=Vh;this.ux=zk;this.JKa.Uzd(this.fGb);this.Lw=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.yJ;if(this.omd=(this.fFe=!!this.Fa&&this.Fa.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&!!this.Fa&&this.Fa.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===cb.App.xa.GI.getLayoutBreakpoint()&&
(this.Ks=!1),cb.App.xa.GI.registerLayoutBreakpointChanged(this.tYg,Wi=>{switch(Wi){case "Small":this.ooi();break;default:this.Ssj()}})}get lf(){return this.xI.value}Ssj(){try{this.dyo()}catch(T){ra.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",T.message,T.stack)}}ooi(){try{this.utm()}catch(T){ra.ULS.shipAssertTag(37244998,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",T.message,T.stack)}}K0n(){for(const T of this.K1.keys())this.vde(T)}ZCa(){try{this.$3k()}catch(T){ra.ULS.shipAssertTag(37244999,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",T.message,T.stack)}}nHj(T){try{this.KYo(T)}catch(Aa){ra.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",Aa.message)}}dispose(){try{this.HSo(),this.nTo(),this.JKa&&this.JKa.Ebj(this.fGb)}catch(T){ra.ULS.shipAssertTag(37245001,336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",T.message,T.stack)}}eln(T){const Aa=this.BUc(T),ib=this.X6h(T);ib?(mc.b("OpenHeaderFooterFromWebViewAdornment"),
T=this.aAa.$uf(ib),this.ga.Qb(Aa?Yg.a.kpe:Yg.a.ecd,2,T),this.U1a=!0):(ra.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+T.id),this.ga.processAction(Yg.a.XWd,2))}HSo(){this.K1.forEach(T=>{this.eza(T)})}nTo(){this.Lw&&(this.omd&&(cb.App.xa.GI.unregisterLayoutBreakpointChanged(this.tYg),this.omd=!1),this.Lw=!1)}eza(T){if(T){var Aa=T.N9b;T=T.T6b;fi.a.Woa(Aa)&&fi.a.Woa(T)?(this.sk.sc(W.a.rR,Aa,this.OKb),this.sk.sc(W.a.rR,T,this.OKb),this.sk.sc(W.a.jL,
Aa,this.NKb),this.sk.sc(W.a.jL,T,this.NKb),this.ig.sc(W.a.click,Aa,this.KKb),this.ig.sc(W.a.click,T,this.KKb),this.pE.sc(Aa,Mi.AKb),this.pE.sc(T,Mi.AKb),this.Wja.sc(W.a.Ox,Aa,this.OB),this.Wja.sc(W.a.Ox,T,this.OB)):ra.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}TNn(T){this.KPe.push(T);this.swd||(this.swd=new Qc.a(2,1,50,this.cWn),this.Gb.Vb(this.swd))}YM(T){if(T){var Aa=T.N9b;T=T.T6b;fi.a.Woa(Aa)&&fi.a.Woa(T)?(this.sk.nb(W.a.rR,
Aa,this.OKb),this.sk.nb(W.a.rR,T,this.OKb),this.sk.nb(W.a.jL,Aa,this.NKb),this.sk.nb(W.a.jL,T,this.NKb),this.ig.nb(W.a.click,Aa,this.KKb),this.ig.nb(W.a.click,T,this.KKb),this.pE.nb(Aa,Mi.AKb),this.pE.nb(T,Mi.AKb),this.Wja.nb(W.a.Ox,Aa,this.OB),this.Wja.nb(W.a.Ox,T,this.OB)):ra.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}dyo(){if(!this.Ks){for(const T of this.K1.values())T.cfb.style.display="block";this.Ks=!0}}utm(){this.Ks&&
(this.K1.forEach(T=>{T.cfb.style.display="none"}),this.Ks=!1)}$3k(){this.aAa.ZCa(this.lf.Yc)}KYo(T){this.yV.X8d();var Aa=0;const ib=new jb.a;this.ZCa();const Tb=this.A1l();for(var xc of T)T=xc.Bh,this.Dzn(xc)||this.vde(xc.Bh),this.K1.has(T)?this.wVo(xc):this.x$k(xc),Aa=T,ib.add(T);for(xc=1;xc<=Aa;xc++)ib.contains(xc)||this.vde(xc);for(Aa+=1;Aa<=Tb;Aa++)this.vde(Aa);this.yV.qEd()}Dzn(T){return this.K1.has(T.Bh)?this.K1.get(T.Bh).tQb.id===T.tQb.id:!1}A1l(){let T=0;this.K1.forEach((Aa,ib)=>{ib>T&&(T=
ib)});return T}x$k(T){const Aa=T.tQb.De(this.lf.fc);if(Aa){var ib=T.Bh;T=this.sIc(ib,T.top,T.height,Aa.qba,T.tQb,T.cCd);this.TNn(T);this.fmg(T);this.Gng(T);this.omd&&!this.Ks&&(T.cfb.style.display="none");this.K1.set(ib,T)}}sIc(T,Aa,ib,Tb,xc,ld){const Sd=tj.b("div","","PageAdornmentContainer");Sd.style.top=Aa+"px";Sd.style.height=ib+"px";Tb.appendChild(Sd);this.P5e(Sd,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);Tb=this.xbf(T);Sd.appendChild(Tb);const df=this.Waf(T);
Sd.appendChild(df);const De=this.Maf(T);Sd.appendChild(De);l.AFrameworkApplication.isRtl&&(Sd.classList.add("Rtl"),df.classList.add("Rtl"),De.classList.add("Rtl"));return new di(T,Aa,ib,xc,ld,Sd,df,De,Tb)}Waf(T){T=tj.b("div","h"+T,this.ux?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.uI&&(this.ux?T.classList.add("PageAdornmentHeaderFooterBorderThemed"):T.style.borderColor=$i.a.Ape);const Aa=tj.b("span","","");Aa.innerText=WordEditorIntl.WordEditorStrings.l_Header;Aa.style.whiteSpace=
"nowrap";T.appendChild(Aa);return T}Maf(T){T=tj.b("div","f"+T,this.ux?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.uI&&(this.ux?T.classList.add("PageAdornmentHeaderFooterBorderThemed"):T.style.borderColor=$i.a.Ape);const Aa=tj.b("span","","");Aa.innerText=WordEditorIntl.WordEditorStrings.l_Footer;Aa.style.whiteSpace="nowrap";T.appendChild(Aa);return T}xbf(T){const Aa=tj.b("div","","PageAdornmentNumberLabel");Aa.innerText=T.toString();return Aa}P5e(T,Aa,ib){if(!this.jDe){const Tb=
tj.b("p","","");Tb.innerText=Aa;Tb.style.whiteSpace="nowrap";Tb.style.visibility="hidden";T.appendChild(Tb);Aa=tj.b("p","","");Aa.innerText=ib;Aa.style.whiteSpace="nowrap";Aa.style.visibility="hidden";T.appendChild(Aa);this.jDe=T.clientWidth;this.yV.tbg(this.jDe);T.removeChild(Tb);T.removeChild(Aa)}}vde(T){if(this.K1.has(T)){var Aa=this.K1.get(T);this.eza(Aa);fi.a.lx(Aa.cfb);this.K1.delete(T)}}wVo(T){if(this.K1.has(T.Bh)){var Aa=this.K1.get(T.Bh);Aa.Q7c(T.top);Aa.Xag(T.height);this.fmg(Aa);this.Gng(Aa)}else ra.ULS.sendTraceTag(37245005,
324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}iUo(){this.yV.X8d();this.ZCa();this.K1.forEach(T=>{this.fmg(T);this.Gng(T)});this.yV.qEd()}fmg(T){const Aa=T.N9b,ib=T.T6b,Tb=this.aAa.XOb(T),xc=this.aAa.WOb(T);this.S_o(T,Tb,xc);this.yV.abd(Aa,Tb);this.yV.abd(ib,xc)}S_o(T,Aa=!0,ib=!0){const Tb=T.N9b;T=T.T6b;3!==l.AFrameworkApplication.va.mode?(Tb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,T.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Tb.title=
Aa?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,T.title=ib?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}Sdg(T){const Aa=this.X6h(T);return Aa?this.BUc(T)?this.aAa.XOb(Aa):this.aAa.WOb(Aa):(ra.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}X6h(T){T=T.id;T=T.substring(1,T.length);T=Number.parseInvariant(T);return this.K1.has(T)?this.K1.get(T):(ra.ULS.sendTraceTag(37245007,336,
10,"Adornment container map does not contain the page number "+T),null)}BUc(T){return T.id.length?"h"===T.id.substring(0,1):(ra.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}Gng(T){const Aa=T.height;Aa<Mi.Ten?(T.N9b.classList.add(Mi.Iib),T.T6b.classList.add(Mi.Iib)):(T.N9b.classList.remove(Mi.Iib),T.T6b.classList.remove(Mi.Iib));Aa<Mi.Uen?(T.K_i.classList.add(Mi.Iib),T.cfb.classList.add(Mi.Iib)):(T.K_i.classList.remove(Mi.Iib),T.cfb.classList.remove(Mi.Iib))}baf(){return!this.sIe||
Y.a.Lxf(this.sIe,500)}static AKb(){return!0}}Mi.Iib="Hidden";Mi.Ten=120;Mi.Uen=50;Object(f.a)(Mi,"PageAdornmentManager",null,[2004,10,2005]);class bo{constructor(T,Aa){this.F9d=new jb.a;this.F9d.add(T);this.F9d.add(Aa)}}Object(f.a)(bo,"PageElementManagerList",null,[]);var ko=c(59);class qk{constructor(T,Aa,ib){this.Vm=T;this.SXb=[];this.vK=Aa;this.uI=ib}v$i(){for(let T=0,Aa=this.SXb.length;T<Aa;T++)fi.a.lx(this.SXb[T]);Array.clear(this.SXb)}B8h(T,Aa,ib,Tb,xc,ld){let Sd=Math.min(Tb.x-ld.x,xc.x-ld.x);
Tb=Math.min(ld.x+ld.width-(Tb.x+Tb.width),ld.x+ld.width-(xc.x+xc.width));Aa+=xc.y-ld.y;({iia:Aa,leftMargin:Sd,rightMargin:Tb}=this.dBk(Aa,Sd,Tb));T=this.t7l(T,Sd,Tb,Sd,Tb,ib);T.style.top=Aa+"px";T.style.zIndex="0";this.SXb.push(T);ko.d(T,!0);return T}mRd(T){return T?T.querySelector(".PageBreakBorderSpan"):null}t7l(T,Aa,ib,Tb,xc,ld){return T?this.Ofm(Aa,ib,Tb,xc,ld):this.N7l(Tb,xc,ld)}dBk(T,Aa,ib){Aa/=this.Vm.instance.jj;ib/=this.Vm.instance.jj;T/=this.Vm.instance.jj;return{iia:T,leftMargin:Aa,rightMargin:ib}}rMm(T){return this.WDi(T)&&
this.E_i(T)?(T=this.hFb(T))&&T.offsetParent?!1:!0:!1}qMm(T){return!this.WDi(T)||this.E_i(T)?!1:!0}nR(){}hFb(T){if(!T.vYf)return null;let Aa=null;T.Ojb&&!T.rca?(T=this.mRd(T.vYf))&&(Aa=T):Aa=T.vYf;return Aa}WDi(T){return T.Ojb&&!T.rca&&T.paragraphNode?!0:!1}E_i(T){T=T.paragraphNode;return!!T&&!!T.anchor}EAh(T,Aa){T=pa.a.gEa(T);Aa=pa.a.gEa(Aa);return(T-Aa)/this.Vm.instance.jj}U5e(T,Aa){T=pa.a.gEa(T);Aa=pa.a.gEa(Aa);return(T-Aa)/this.Vm.instance.jj}Y3d(){this.pHj(!1)}X3d(){this.pHj(!0)}pHj(T){for(let Aa=
0,ib=this.SXb.length;Aa<ib;Aa++){const Tb=this.SXb[Aa];"PageEndMarker.Para"===Tb.id?qk.tHj(Tb,T):"PageEndMarker.Table"===Tb.id&&qk.mIj(Tb,T)}}N7l(T,Aa,ib){if(!qk.P_b){qk.P_b=tj.b("div","PageEndMarker.Para","PageEndMarker");var Tb=tj.b("div","","Current FullWidth");this.uI&&(Tb.style.borderTopColor=this.vK.Ova());qk.P_b.appendChild(Tb);Tb=tj.b("div","","Stale LeftWing");const xc=tj.b("div","","Stale RightWing");this.uI&&(Tb.style.borderTopColor=this.vK.Ova(),xc.style.borderTopColor=this.vK.Ova());
qk.P_b.appendChild(Tb);qk.P_b.appendChild(xc)}Tb=qk.P_b.cloneNode(!0);Tb.childNodes[1].style.width=T-10+"px";Tb.childNodes[2].style.width=Aa-10+"px";qk.tHj(Tb,ib);return Tb}Ofm(T,Aa,ib,Tb,xc){if(!qk.Dyb){qk.Dyb=tj.b("div","PageEndMarker.Table","PageEndMarker");var ld=tj.b("div","","Current LeftWing"),Sd=tj.b("div","","Current RightWing");this.uI&&(ld.style.borderTopColor=this.vK.Ova(),Sd.style.borderTopColor=this.vK.Ova());qk.Dyb.appendChild(ld);qk.Dyb.appendChild(Sd);ld=tj.b("div","","Stale LeftWing");
Sd=tj.b("div","","Stale RightWing");this.uI&&(ld.style.borderTopColor=this.vK.Ova(),Sd.style.borderTopColor=this.vK.Ova());qk.Dyb.appendChild(ld);qk.Dyb.appendChild(Sd)}ld=qk.Dyb.cloneNode(!0);ld.childNodes[0].style.width=T+"px";ld.childNodes[1].style.width=Aa+"px";ld.childNodes[2].style.width=ib-10+"px";ld.childNodes[3].style.width=Tb-10+"px";qk.mIj(ld,xc);return ld}static tHj(T,Aa){Aa?qk.L$m(T):qk.M$m(T)}static M$m(T){T.childNodes[0].style.display="none";T.childNodes[1].style.display="block";T.childNodes[2].style.display=
"block"}static L$m(T){T.childNodes[0].style.display="block";T.childNodes[1].style.display="none";T.childNodes[2].style.display="none"}static mIj(T,Aa){Aa?qk.R$m(T):qk.S$m(T)}static S$m(T){T.childNodes[0].style.display="none";T.childNodes[1].style.display="none";T.childNodes[2].style.display="block";T.childNodes[3].style.display="block"}static R$m(T){T.childNodes[0].style.display="block";T.childNodes[1].style.display="block";T.childNodes[2].style.display="none";T.childNodes[3].style.display="none"}}
qk.P_b=null;qk.Dyb=null;Object(f.a)(qk,"PageEndDOMHelper",null,[]);class fm{constructor(T,Aa){this.Mwb=this.Fbh=null;this.Vm=T;this.ri=Aa}Ogg(T,Aa){try{this.TEo(T,Aa)}catch(ib){ra.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",ib.message)}}x3k(T,Aa,ib,Tb,xc,ld){this.ri.ie(()=>{try{this.y3k(T,Aa,ib,Tb,xc,ld)}catch(Sd){ra.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",
Sd.message)}},"PEMPC:CP")}TEo(T,Aa){this.Fbh=T;this.Mwb=Aa}y3k(T,Aa,ib,Tb,xc,ld){var Sd=this.Fbh;if(Sd&&T){var df=Sd.count,De=T.count;if(df&&De){var Ff=this.NDl(Sd,T);if(Ff.count){var Wg=this.Vm.jj,Vh=this.x3b(Ff)/Wg,zk=this.zHh(Ff)/Wg;T=this.xMd(Sd,T);if(T.count){Sd=this.x3b(T)/Wg;Wg=this.zHh(T)/Wg;var Wi=!0;for(var dk=0;dk<Ff.count;dk++)if(Ff.J(dk)){Wi=!1;break}var mo=dk=0;this.Mwb&&Aa&&(dk=this.mRk(this.Mwb,Aa),mo=Aa.count-this.Mwb.count);ra.ULS.sendTraceTag(35005343,336,50,"{0}",{["HardPageBreakExists"]:Tb,
["EstimatedPageCount"]:df,["CalculatedPageCount"]:De,["InOrderAverageDelta"]:Vh,["InOrderStandardDeviation"]:zk,["ShortestAverageDelta"]:Sd,["ShortestStandardDeviation"]:Wg,["PositionsShouldBeUpdated"]:ib,["DocumentHeightChanged"]:xc,["DeltasAllZero"]:Wi,["HeaderFooterOpenSinceLastResponse"]:ld,["DeltaInViewport"]:dk,["ChangeInViewportMarkerCount"]:mo});xc||ld||Wi||(ra.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),
Aa=Ff.toArray().toString(),ib=T.toArray().toString(),ra.ULS.sendTraceTag(35726603,336,50,"{0} {1}",Aa,ib))}}}}else ra.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}mRk(T,Aa){const ib=new jb.a;for(const Tb of T)ib.add(Tb.top);if(!ib.count)return-1;T=new jb.a;for(const Tb of Aa)T.add(Tb.top);if(!T.count)return-1;Aa=this.xMd(ib,T);return this.x3b(Aa)/this.Vm.jj}x3b(T){if(!T.count)return 0;let Aa=0;for(let ib=
0;ib<T.count;ib++)Aa+=T.J(ib);return Aa/T.count}zHh(T){if(!T.count)return 0;const Aa=this.x3b(T);let ib=0;for(let Tb=0;Tb<T.count;Tb++){const xc=T.J(Tb)-Aa;ib+=xc*xc}return Math.sqrt(ib/T.count)}NDl(T,Aa){const ib=new jb.a;if(!T.count||!Aa.count)return ib;T.Sc((xc,ld)=>xc-ld);Aa.Sc((xc,ld)=>xc-ld);const Tb=Math.min(T.count,Aa.count);for(let xc=0;xc<Tb;xc++){const ld=Math.abs(T.J(xc)-Aa.J(xc));ib.add(ld)}return ib}xMd(T,Aa){const ib=new jb.a;if(!T.count||!Aa.count)return ib;var Tb=T.count<=Aa.count;
const xc=Tb?T:Aa;T=Tb?Aa:T;for(Aa=0;Aa<xc.count;Aa++){Tb=xc.J(Aa);let Sd=Math.abs(Tb-T.J(0)),df=0;for(let De=1;De<T.count;De++){var ld=T.J(De);ld=Math.abs(Tb-ld);ld<Sd&&(Sd=ld,df=De)}ib.add(Sd);T.removeAt(df)}return ib}}Object(f.a)(fm,"PageEndMarkerPositionComparer",null,[1996]);var Jl=c(391),Nc=c(583);class xo{constructor(T,Aa,ib,Tb,xc,ld,Sd,df,De,Ff){this.Sq=T;this._pageNumber=Aa;this.Ojb=ib;this.rca=Tb;this.vYf=xc;this.outlineNode=ld;this.outlineGroupNode=Sd;this.K$g=df;this.paragraphNode=De;this.MU=
Ff}get top(){return this.Sq}get Bh(){return this._pageNumber}get $yn(){return this.K$g}Q7c(T){this.Sq=T}Ahe(T){this._pageNumber=T}Pmj(T){this.K$g=T}}Object(f.a)(xo,"PageEndMarker",null,[]);class Z{constructor(){this.pf=null;this.dRi=0}}Object(f.a)(Z,"PageEndMarkerToRestore",null,[]);class ma{constructor(T,Aa,ib,Tb,xc,ld,Sd){this.rXf=(df,De)=>{De.property===uo.a.iJ&&(df=De.node)&&df.ia(uo.a.iJ,!1)&&this.hyd.contains(df.id)&&(De=df.De(this.lf.fc))&&(De=De.htmlElement)&&(this.hyd.remove(df.id),this.lXa.add(De))};
this.xI=T;this.Vm=Aa;this.GLa=ib;this.ay=Tb;this.lNe=xc;this.CZ=ld;this.Oq=Sd;this.Xt=new jb.a;this.TXb=new jb.a;this.Cyb=new Dc.a;this.hyd=new Nc.a(new Jl.a);this.lXa=new jb.a;this.WXb=!!xc;this.oyf()}get lf(){const T=this.xI.value;ra.ULS.shipAssertTag(37052750,336,T.Wi,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return T}mbd(T){try{this.lYo(T)}catch(Aa){this.ay.nR(Aa.message+" "+Aa.stack),ra.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",
Aa.message)}}cvk(T){try{this.dvk(T)}catch(Aa){this.ay.nR(Aa.message+" "+Aa.stack),ra.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",Aa.message)}}kSk(T){try{return this.lSk(T)}catch(Aa){this.ay.nR(Aa.message+" "+Aa.stack),ra.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",Aa.message)}return!1}w8n(){try{this.x8n()}catch(T){this.ay.nR(T.message+" "+T.stack),ra.ULS.sendTraceTag(37052753,
336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",T.message)}}GPc(){try{return this.Dam()}catch(T){return this.ay.nR(T.message+" "+T.stack),ra.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",T.message),null}}png(){try{this.OZo()}catch(T){this.ay.nR(T.message+" "+T.stack),ra.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",
T.message)}}x7e(){try{return this.TXk()}catch(T){return this.ay.nR(T.message+" "+T.stack),ra.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",T.message),!1}}$Cm(T){try{this.aDm(T)}catch(Aa){this.ay.nR(Aa.message+" "+Aa.stack),ra.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",Aa.message)}}lYo(T){if(T){this.zZk();for(let Aa=0;Aa<T.length;Aa++){const ib=
Aa+1,Tb=this.k5k(T[Aa],ib);this.Xt.add(Tb);this.Cyb.add(ib,Tb)}}}aDm(T){let Aa=!1;for(const ib of T)if(ib)if(0<ib.Ey)for(const Tb of ib.ZAf)Aa=this.Czd(Tb,ib.outlineGroupNode)||Aa;else if(0>ib.Ey){Aa=!0;for(const Tb of ib.JId)this.Skl(Tb.Bh)}Aa&&this.L6f()}dvk(T){const Aa=this.a7h(T.paragraphNode);this.Czd(T,Aa)&&this.L6f()}Skl(T){const Aa=T-1;0>Aa||this.Xt.count<=Aa||(this.Xt.removeAt(Aa),this.Cyb.mb(T)&&this.Cyb.remove(T))}Dam(){const T=new jb.a;for(const Aa of this.Xt)this.xbc(Aa)&&T.add(Aa);return T}Czd(T,
Aa){if(!T)return ra.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;Aa=this.i5k(T,Aa);T=T.ZHm?-1:T.Bh;let ib=!1,Tb;this.Cyb.mb(T)?(Tb=this.Cyb.J(T).Bh,Aa.Ahe(Tb),this.Xt.Z(Tb-1,Aa),this.Cyb.remove(T)):(Tb=Aa.Bh,this.Xt.insert(Tb-1,Aa),ib=!0);return ib}k5k(T,Aa){return new xo(0,Aa,T.HardBreak,!1,null,null,null,0,null,null)}i5k(T,Aa){const ib=T.Pmb,Tb=T.Bh,xc=T.MU,ld=!!xc&&xc.HardBreak,Sd=T.rca,df=T.paragraphNode,De=this.pdi(Aa),
Ff=T.outlineNode;var Wg=this.Lsf(Ff);if(!Wg)return ra.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let Vh=null;ld&&(Vh=this.ay.mRd(T.Pmb));T=this.ay.EAh(Vh||ib,De);Wg=this.ay.U5e(Vh||ib,Wg);return new xo(Wg,Tb,ld,Sd,ib,Ff,Aa,T,df,xc)}lSk(T){this.TXb=new jb.a;this.WXb&&this.lNe.reset();this.E_n();this.SAo();this.eBk();this.$Rk(T);return 0<this.TXb.count}E_n(){for(let T=0;T<this.Xt.count;T++){const Aa=this.Xt.J(T);this.ay.rMm(Aa)?
this.b9m(Aa):(this.ay.qMm(Aa)||this.xbc(Aa)&&!this.Lsf(Aa.outlineNode))&&this.Daj(Aa)}}eBk(){let T=0,Aa=null;var ib=0;let Tb=0;for(let xc=0;xc<this.Xt.count;xc++){const ld=this.Xt.J(xc);this.xbc(ld)&&(ld.Ojb&&(Tb+=this.BAh(ld,ib,Tb)),Aa&&Aa.id===ld.outlineNode.id||(Aa=ld.outlineNode,Tb=T=0),ld.Ojb&&!ld.rca&&(T=this.YRk(ld)),ib=ld.top+T+Tb,ld.Q7c(ib))}this.BAh(null,ib,Tb);this.w_n()}BAh(T,Aa,ib){let Tb=null;this.WXb&&(Tb=this.lNe.aSk(T,Aa,ib));return Tb?Tb.delta:0}x8n(){if(this.TXb){for(let T=0;T<
this.TXb.count;T++){const Aa=this.TXb.J(T);fi.a.Tio(Aa.pf,Aa.dRi)}this.WXb&&this.lNe.t8n()}}OZo(){if(!this.WXb){var T=this.GLa.dbi();if(this.Xt.count){var Aa=this.GLa.G9h();for(let xc=0;xc<this.Xt.count;xc++){var ib=this.Xt.J(xc);if(this.xbc(ib)&&ib.rca){ib=this.GLa.f$l(ib.outlineNode);var Tb=0<xc?this.Xt.J(xc-1).outlineNode:Aa;Tb=xc&&ib.id===Tb.id?this.Xt.J(xc-1).top:0;this.GLa.zhe(ib,Tb)}}Aa=this.Xt.J(this.Xt.count-1);Aa.rca?this.GLa.zhe(T,0):this.GLa.zhe(T,Aa.top)}else this.GLa.zhe(T,0)}}SAo(){this.Xt.Sc((T,
Aa)=>T.Bh-Aa.Bh)}L6f(){for(let T=0;T<this.Xt.count;T++)this.Xt.J(T).Ahe(T+1)}YRk(T){return T?this.DAh(T)-T.top:(ra.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}iSk(T){if(!T)return 0;const Aa=this.pdi(T.outlineGroupNode);return Aa?this.ay.EAh(this.ay.hFb(T),Aa):0}DAh(T){if(!T)return 0;const Aa=this.ay.hFb(T);T=this.Lsf(T.outlineNode);return T?this.ay.U5e(Aa,T):(ra.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),
0)}w_n(){let T=0,Aa=!1,ib=null,Tb=!1;for(let xc=this.Xt.count-1;0<=xc;xc--){const ld=this.Xt.J(xc);this.xbc(ld)&&(ib&&ib.id===ld.outlineNode.id||(Aa=!ib,ib=ld.outlineNode,T=this.d7l(ib)),ld.Ojb?(Aa=!1,T=ld.top):this.WXb&&Aa||!(ld.top>T)||(this.Daj(ld),fi.a.lx(this.ay.hFb(ld)),Tb=!0))}Tb&&this.L6f()}Daj(T){this.Xt.contains(T)&&(this.WXb&&this.CZ.L0n(T),this.Xt.remove(T))}xbc(T){return T?(T=this.ay.hFb(T))&&T.offsetParent?!0:!1:(ra.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),
!1)}TXk(){let T=!1;for(let Aa=this.lXa.count-1;0<=Aa;Aa--)this.lXa.J(Aa).hasChildNodes()&&(this.lXa.removeAt(Aa),T=!0);return T}b9m(T){(T=this.a7h(T.paragraphNode))&&(this.hyd.contains(T.id)||this.hyd.add(T.id))}oyf(){this.Oq&&this.Oq.Ze(23).Go(this.rXf)}$Rk(T){for(let Aa=this.Xt.count-1;0<=Aa;Aa--){const ib=this.Xt.J(Aa);this.xbc(ib)&&this.ZRk(ib,T)}}ZRk(T,Aa){const ib=this.DAh(T),Tb=this.iSk(T);T.Ojb?(T.Q7c(ib),T.Pmj(Tb)):(Aa=Aa?ib-T.top:Tb-T.$yn,T.Q7c(ib-Aa),T.Pmj(Tb-Aa),1<Math.abs(Aa)&&this.vno(this.ay.hFb(T),
Aa))}Lsf(T){if(!T)return null;T=T.De(this.lf.fc);return T?T.htmlElement:(ra.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}pdi(T){return T?(T=T.De(this.lf.fc))?T.htmlElement:null:null}a7h(T){T=Cn.GraphIterator.$a(T);return T.zb(23)?T.jd(23):null}c7l(T){if(!T)return null;T=T.De(this.lf.fc);return T?pa.a.getElementBounds(T.htmlElement):(ra.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}d7l(T){return(T=
this.c7l(T))?T.height/this.Vm.jj:0}vno(T,Aa){Aa=(fi.a.fWl(T)-Aa)*this.Vm.jj;this.TXb.add(Object.assign(new Z,{pf:T,dRi:Aa}))}zZk(){this.Xt=new jb.a;this.Cyb=new Dc.a}}Object(f.a)(ma,"PageEndMarkerPositionUpdater",null,[1993]);var qb=c(364),ec=c(32),uc=c(349),Zc=c(21);class rd{constructor(T,Aa,ib,Tb,xc,ld,Sd=!1,df=!1,De=!1,Ff=!1,Wg=!1){this.vog(Aa,ib,Tb,xc,ld,De,Wg);this.position=T;this.Bh=Aa;this.paragraphNode=ib;this.MU=Tb;this.Pmb=xc;this.outlineNode=ld;this.f3a=Sd;this.sDi=df;this.ZHm=De;this.rca=
Ff;this.n_d=Wg}Ahe(T){this.Bh=T}vog(T,Aa,ib,Tb,xc,ld,Sd){Sd||(ra.ULS.shipAssertTag(38326881,336,!!xc,"PageEndDetails: outlineNode parameter value is null."),ra.ULS.shipAssertTag(24126528,336,0<=T,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",T),ra.ULS.shipAssertTag(24126529,336,!!Aa||ld,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),ra.ULS.shipAssertTag(24126530,336,!!ib||ld,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),
ra.ULS.shipAssertTag(24126531,336,!!Tb||ld,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static ybl(T,Aa){return rd.taf(0,T,null,Aa,!0,!1)}static zbl(T){return rd.taf(0,0,null,T,!1,!0)}static taf(T,Aa,ib,Tb,xc,ld){return new rd(T,Aa,null,null,ib,Tb,xc,ld,!0)}static h4b(T,Aa){return new rd(0,T,null,Aa,null,null,void 0,void 0,void 0,void 0,!0)}}Object(f.a)(rd,"PageEndDetails",null,[]);class Jd{constructor(T,Aa,ib,Tb,xc,ld,Sd,df,De,Ff,Wg,Vh,zk,Wi,dk,mo,Kl,
ig,Uk,no){this.Msa=!0;this.exe=0;this.Wqd=this.kDe=this.lDe=this.gze=this.jNe=this.VCe=!1;this.Vsd=this.ixb=null;this.xGe=!0;this.zKb=()=>{this.Y3d()};this.pUf=()=>{this.lDe=!1};this.qUf=()=>{this.kDe=this.lDe=!0};this.lsn=(pr,Ba)=>{1>=Math.abs(Ba.delta)||(this.gze=!0,this.oHj(!Ba.WQi))};this.xUn=pr=>{pr===this.ixb&&(this.ixb=null);if(this.Msa){var Ba=pr.customData;if(pr=this.mXa.get(Ba.id))for(this.mXa.Z(Ba.id,new jb.a),ra.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",
pr.count,Ba.id),this.gaa&&this.gaa.ZCa(),Ba=0;Ba<pr.count;Ba++){const Qa=pr.J(Ba),Fa=Qa.MU;Fa.HardBreak||(fi.a.lx(Qa.Pmb),this.x6f(Fa))}}};this.wUn=()=>{this.Vsd=null;this.Msa&&this.jia&&0<this.jia.count&&(ra.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.mbd(this.jia.toArray(),this.Msa))};this.xI=T;this.mi=Aa;this.gaa=ib;this.KN=Tb;this.S$g=xc;this.Mbb=ld;Jd.ay=df;this.mXg=De;this.CI=Ff;this.Gb=Wg;this.Y4j=Vh;this.ge=Wi;this.CZ=mo;this.nNe=Kl;this.YXb=
ig;this.kZ=Uk;this.BXb=new qb.a;this.UXb=new jb.a;this.jia=new jb.a;this.mXa=new qb.a;this.wN=zk;this.HS=no;this.L9d=this.L9d.bind(this);this.N9d=this.N9d.bind(this);this.bde=this.bde.bind(this);this.Hca=this.Hca.bind(this);this.wN.dEc(this.zKb);this.kNe=!1;dk&&(dk.Qqh(this.qUf),dk.Uzd(this.pUf));Sd&&Sd.Jyk(this.lsn);this.HS.tzb(this.Hca)}get mFf(){return this.xGe}get lf(){return this.xI.value}get Aj(){return this.mi.value}mbd(T,Aa){const ib=this.ge.Zf("Task","UpdateMarkers");this.REo();this.Msa=
Aa;Jd.ay.v$i();this.BXb=new qb.a;this.UXb.clear();this.jia.clear();this.mXa=new qb.a;this.xGe=this.VCe=!1;this.KN&&this.KN.mbd(T);this.Swl();this.exe=T.length;this.CZ&&this.CZ.reset(T);this.gaa&&this.gaa.ZCa();for(const Tb of T)this.jia.add(Tb),this.x6f(Tb);Aa&&this.KN&&this.nNe&&this.nNe.isEnabled&&(T=this.KN.GPc(),this.nNe.DCa(T));this.w3k();this.gze=this.jNe=!1;this.kDe=this.lDe;Hl.WoncaApp.instance.Zib&&Jd.gzf&&this.KN.png();this.Mbb.JYo(this.KN.GPc(),this.jia.count);this.xGe=!0;this.kZ.dng();
ib.stop();ra.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:ib.si,["RenderedLineCount"]:this.exe,["AvgDurationPerPageInMs"]:ib.si/this.xdi()})}zdi(){const T=this.KN.GPc();if(!T)return null;const Aa=fi.a.FX(),ib=new jb.a;for(const Tb of T)this.fQm(Tb,Aa)&&ib.add(Tb);return ib}fQm(T,Aa){if(!T)return!1;T=Jd.ay.hFb(T);if(!T)return!1;T=pa.a.gEa(T);return 0<=T&&T<=Aa}Z3h(){const T=new jb.a;if(!this.mXa)return ra.ULS.sendTraceTag(35005382,336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),
T;const Aa=this.mXa.keys;for(let xc=0;xc<Aa.length;xc++){var ib=Aa.J(xc);if(ib=this.mXa.J(ib))for(let ld=0;ld<ib.count;ld++){var Tb=ib.J(ld);Tb.MU.HardBreak||Tb.Pmb.classList.contains("Hidden")||(Tb=pa.a.gEa(Tb.Pmb),T.add(Tb))}}return T}REo(){const T=this.Z3h(),Aa=this.zdi();this.S$g.Ogg(T,Aa);this.YXb&&this.YXb.isEnabled&&this.YXb.Ogg(Aa)}w3k(){if(!(25<this.xdi())){var T=this.Z3h(),Aa=this.zdi();this.S$g.x3k(T,Aa,this.jNe,this.VCe,this.gze,this.kDe);this.YXb&&this.YXb.isEnabled&&this.YXb.DCa(Aa)}}Hca(){this.gaa.K0n();
this.BRh()}BRh(){this.Wqd&&(this.lf.wbj(this.L9d),this.lf.G2n(this.N9d),this.lf.m2n(this.bde),this.Wqd=!1)}Swl(){this.Wqd||(this.lf.I_e(this.L9d),this.lf.qzk(this.N9d),this.lf.Kqh(this.bde),this.Wqd=!0)}x6f(T){if(this.kNe)return!0;T=this.D3n(T);if(!T)return!1;this.CZ&&this.CZ.Oom(T);this.KN&&(this.KN.cvk(T),this.Mbb.kHj(this.KN.GPc()),Hl.WoncaApp.instance.Zib&&Jd.gzf&&this.KN.png());return!0}D3n(T){let Aa=this.wM(T.ParaId);if(!Aa)return null;if(!Aa.anchor||!Aa.qj)return this.Hph(T,Aa),null;let ib,
Tb;if(T.HardBreak){var xc=El.ParagraphReader.jg(Aa,!0,!0,!0);this.HAn(xc)&&(Aa=xc);if(!({iia:xc,outlineGroupNode:ib,Nmb:Tb}=this.OPo(T,Aa)).returnValue)return null;this.VCe=!0}else if(!({G9d:xc,outlineGroupNode:ib,Nmb:Tb}=this.E3n(T,Aa)).returnValue)return null;return this.Czd(Aa,T,xc,ib,Tb)}HAn(T){return T?(T=T.De(this.lf.fc))?!!Jd.ay.mRd(T.htmlElement):!1:!1}E3n(T,Aa){var ib=T.PageEndType;let Tb,xc=0,ld=null;if(!ib){if(!({iia:T,eYf:Tb}=this.Adi(T,Aa)).returnValue)return{returnValue:!1,G9d:xc,outlineGroupNode:ld,
Nmb:null}}else if(!({iia:T,tle:Tb}=this.u7l(T,Aa)).returnValue)return{returnValue:!1,G9d:xc,outlineGroupNode:ld,Nmb:null};var Sd=Cn.GraphIterator.$a(Aa);Sd.vd();ld=Sd.jd(23);Aa=ld.De(this.lf.fc).getBounds();Sd=Sd.OSa().De(this.lf.fc);if(!Sd)return ra.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.lf.fc),{returnValue:!1,G9d:xc,outlineGroupNode:ld,Nmb:null};const df=Sd.getBounds();xc=T-Aa.y;ib=Jd.ay.B8h(ib,xc,this.Msa,Tb,Aa,df);Sd.qba.appendChild(ib);return{returnValue:!0,
G9d:xc,outlineGroupNode:ld,Nmb:ib}}OPo(T,Aa){let ib=null;const Tb=Aa.De(this.lf.fc);var xc=0;let ld=null;if(this.C0d(T,Tb,Aa))return{returnValue:!1,iia:xc,outlineGroupNode:ib,Nmb:ld};ib=Jd.DQi(Aa);const Sd=ib.De(this.lf.fc);if(!Sd)return ra.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.lf.fc),{returnValue:!1,iia:xc,outlineGroupNode:ib,Nmb:ld};xc=Sd.getBounds();xc=fl.a.Tq(Tb,T.CP).y-xc.y;ld=this.BZl(Aa);return{returnValue:!0,iia:xc,outlineGroupNode:ib,Nmb:ld}}BZl(T){return T.De(this.lf.fc).htmlElement}wM(T){const Aa=
this.CI.Zhb(T);if(Aa!==ih.a.nil){const ib=this.Aj.Db(Aa);if(ib)return ib}ra.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",T,Aa);return null}Adi(T,Aa){const ib=T.CP;let Tb=0,xc=null;const ld=Aa.De(this.lf.fc);if(this.C0d(T,ld,Aa))return{returnValue:!1,iia:Tb,eYf:xc};xc=ld.getBounds();Tb=ib?this.mXg(Object(ub.a)(86,ld),ib):xc.y-this.Y4j(ld);return{returnValue:!0,iia:Tb,eYf:xc}}u7l(T,Aa){let ib=null,Tb=0;var xc=T.PageEndType;let ld=Cn.GraphIterator.$a(Aa);
ld.vd();if(!ec.TableReader.ex(ld))return ra.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",T.ParaId),{returnValue:({iia:Tb,eYf:ib}=this.Adi(T,Aa)).returnValue,iia:Tb,tle:ib};if(1===xc){Zc.returnToContainingRow(ld);xc=ld.currentNode.De(this.lf.fc);if(this.C0d(T,xc,Aa))return{returnValue:!1,iia:Tb,tle:ib};Tb=xc.getBounds().y}else{xc=Aa.De(this.lf.fc);if(this.C0d(T,xc,Aa))return{returnValue:!1,iia:Tb,tle:ib};Tb=this.mXg(Object(ub.a)(86,
xc),T.CP)}--Tb;Aa=null;do T=Aa,Aa=ld.jd(14);while(Aa);ld=Cn.GraphIterator.$a(T);ld.vd();Zc.moveToFirstRow(ld);ib=ld.currentNode.De(this.lf.fc).getBounds();return{returnValue:!0,iia:Tb,tle:ib}}C0d(T,Aa,ib){if(!Aa||Aa.ixa(16))return this.Hph(T,ib),!0;Aa=Aa.getBounds();return Aa.width||Aa.height?!1:(this.Toh(T),!0)}Toh(T){this.UXb.contains(T)||this.UXb.add(T)}Hph(T,Aa){Aa=Aa.id;let ib;({value:ib}=this.BXb.Dc(Aa)).returnValue||(ib=new jb.a,this.BXb.Z(Aa,ib));ib.add(T)}L9d(){const T=new jb.a;for(let Aa=
this.UXb.count-1;0<=Aa;Aa--){const ib=this.UXb.J(Aa);this.x6f(ib)||T.add(ib)}this.UXb=T;this.x7e()}x7e(){this.KN&&this.KN.x7e()&&this.oHj(!1)}oHj(T){this.KN&&(this.KN.kSk(T)&&(this.jNe=!0),this.KN.w8n(),this.Mbb.kHj(this.KN.GPc()),Hl.WoncaApp.instance.Zib&&Jd.gzf&&this.KN.png())}N9d(T,Aa){try{const ib=Aa.id;if(this.BXb.mb(ib)){const Tb=this.BXb.J(ib);for(T=0;T<Tb.count;T++)this.Toh(Tb.J(T));this.BXb.remove(ib)}}catch(ib){}}Y3d(){this.Msa&&(this.Msa=!1,Jd.ay.Y3d())}X3d(){this.Msa||(this.Msa=!0,Jd.ay.X3d())}eyo(){this.kNe=
!1;this.jia&&this.mbd(this.jia.toArray(),this.Msa);this.gaa&&this.gaa.Ssj()}vtm(){this.kNe=!0;Jd.ay.v$i();this.gaa&&this.gaa.ooi();this.CZ&&this.CZ.wtm()}Czd(T,Aa,ib,Tb,xc){const ld=this.jia.indexOf(Aa)+1;if(0>ld)return null;const Sd=fp.WordSectionNavigator.instance.GJ(T),df=this.rca(Aa,T);T=new rd(ib,ld,T,Aa,xc,Sd,!T||!Aa||!xc,!1,!1,df);this.mXa.mb(Tb.id)||this.mXa.Z(Tb.id,new jb.a);this.mXa.J(Tb.id).add(T);return T}rca(T,Aa){if(!T||!T.HardBreak)return!1;T=Cn.GraphIterator.$a(Aa);T.zb(7);if(T.pJ())return!1;
T.jd(23);return T.pJ()?!1:!0}O8i(T){this.Msa&&(T.anchor&&T.qj?!(T=Jd.DQi(T))||this.ixb&&this.ixb.customData&&this.ixb.customData.id===T.id||(this.ixb=Object.assign(new Qc.a(3,1,500,this.xUn),{customData:T}),this.Gb.Vb(this.ixb)):ra.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}bde(){this.Msa&&!this.Vsd&&this.jia&&0<this.jia.count&&(this.Vsd=new Qc.a(3,1,500,this.wUn),this.Gb.Vb(this.Vsd))}dispose(){this.lf&&this.BRh();this.HS.d6f(this.Hca);
this.wN.Pde(this.zKb)}static get gzf(){null==Jd.lEe&&(Jd.lEe=l.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return Jd.lEe}static xZl(T){let Aa=0;try{const ib=T.htmlElement,Tb=fi.a.VM(ib.firstChild.style.marginTop);T=0;const xc=Jd.ptf(ib.parentNode);if(xc){const ld=xc.firstChild;ld&&ld.classList.contains("ParaWrappingDiv")&&(T=fi.a.VM(ld.firstChild.style.marginBottom))}Aa=Math.max(Tb,T)/2}catch(ib){}return Aa}static ptf(T){let Aa=T.previousSibling;if(!Aa){var ib=T.parentNode;fi.a.DEf(ib)&&
(ib=ib.parentNode)&&(Aa=ib.previousSibling)}if(!Aa&&(T=T.parentNode,T.classList.contains("OutlineGroup")||ra.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",T.tagName,T.className),(T=T.previousSibling)&&T.hasChildNodes())){Aa=T.lastChild;do{if(Aa.classList.contains("OutlineElement")||fi.a.DEf(Aa)&&Aa.classList.contains(uc.a.gdc))break;Aa=Aa.previousSibling}while(Aa)}if(Aa){if(Aa.classList.contains(uc.a.gdc))return Aa.lastChild.lastChild;if(fi.a.DEf(Aa))return Aa.lastChild}return Aa}static DQi(T){T=
Cn.GraphIterator.$a(T);return T.zb(23)?T.jd(23):null}xdi(){return this.exe+1}}Jd.ay=null;Jd.lEe=null;Object(f.a)(Jd,"PageEndMarkers",null,[1994,1995,10]);var Me=c(137);class xg{constructor(T,Aa,ib){this.Xyn=".Outline";this.xI=T;this.Vm=Aa;this.ay=ib}get lf(){const T=this.xI.value;ra.ULS.shipAssertTag(38416594,336,T.Wi,"Invalid PageView.");return T}E7b(T){return(T=T.outlineNode)?this.ndi(T):(ra.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),null)}ndi(T){let Aa,ib;return(Aa=T.De(this.lf.fc))&&
(ib=Aa.htmlElement)?ib.querySelector(this.Xyn):(ra.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}$6h(T){T=xk.OutlineElementNavigator.Gl(T.paragraphNode);let Aa;return T&&(Aa=T.De(this.lf.fc))?Aa.htmlElement:(ra.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}sAh(T,Aa){const ib=this.Wjm(T);return this.eSk(T,Aa)-ib}v8h(T){return this.tdi(T.outlineNode,T.Bh)}tdi(T,Aa){if(!T)return-1;var ib=T.ia(lm.a.qv,-1);ib=Um.a.Ji(ib,1);var Tb=T.ia(lm.a.marginTop,
-1);Tb=Um.a.Ji(Tb,1);T=T.ia(lm.a.marginBottom,-1);T=Um.a.Ji(T,1);return 1===Aa?ib-T:ib-(Tb+T)}Qkl(T){T&&fi.a.lx(T.Pmb)}ktf(T){if(T.sDi||T.rca)return 0;if(T.f3a)return T=this.E7b(T),pa.a.getElementBounds(T).height/this.Vm.jj;const Aa=this.E7b(T);return this.ay.U5e(this.ydi(T),Aa)}j$k(T,Aa,ib){ib=ib.De(this.lf.fc).getBounds();T=T.De(this.lf.fc);const Tb=T.getBounds();ib.y=Tb.y;Aa=this.ay.B8h(0,Aa*this.Vm.jj,!1,ib,ib,Tb);T.qba.appendChild(Aa);return Aa}Tsi(T,Aa){if(T&&!T.n_d)if(T.f3a){if(T=this.E7b(T))T.style.paddingBottom=
Aa+"px"}else if(T.MU&&T.MU.HardBreak)if(T.rca){if(T=this.Qei(T))T.style.paddingBottom=Aa+"px"}else{if(T=this.$6h(T))T.style.paddingTop=Aa+"px"}else ra.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}Grh(T,Aa){Aa=this.E7b(Aa);T=this.E7b(T);return pa.a.gEa(Aa)-pa.a.gEa(T)}Rei(T){T=Cn.GraphIterator.$a(T.outlineNode);T.zb(7);return T.pJ()}pAi(T){if(!T||T.n_d)return!1;if(T.f3a||T.sDi)return!0;T=this.ydi(T);return!!T&&fi.a.a8(T)}nR(T){this.ay.nR(T)}Qei(T){return(T=
this.Rei(T))?(T=T.Fj(this.lf.fc).htmlElement,T?T:(ra.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}ydi(T){return T.MU&&T.MU.HardBreak&&!T.rca?this.ay.mRd(T.Pmb):T.Pmb}Wjm(T){if(T.f3a){T=this.E7b(T);if(!T)return ra.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),-1;T=Me.a.vB(T);return fi.a.Wga(T.paddingBottom)}if(T.MU&&T.MU.HardBreak){if(T.rca)return(T=this.Qei(T))?fi.a.Wga(T.style.paddingBottom):-1;T=this.$6h(T);return T?fi.a.Wga(T.style.paddingTop):(ra.ULS.shipAssertTag(38336529,
336,!0,"Containing outline element Dom is null."),-1)}return 0}eSk(T,Aa){return this.ktf(T)-Aa}}Object(f.a)(xg,"PageFullHeightDOMHelper",null,[]);class gf{constructor(){this.delta=this.dLj=this.Ey=0;this.hia=null;this.tOa=this.H3i=0;this.outlineGroupNode=null;this.aDa=0;this.ZAf=new jb.a;this.JId=new jb.a;this.Ahn=new jb.a}}Object(f.a)(gf,"PageFullHeightInfo",null,[]);class Bg{constructor(T,Aa){this.eBa=T;this.ey=Aa}CAh(T,Aa){try{return this.bSk(T,Aa)}catch(ib){return this.ey.nR(ib.message+" "+ib.stack),
ra.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",ib.message),null}}bSk(T,Aa){ra.ULS.shipAssertTag(38416596,336,T.f3a||T.MU.HardBreak);const ib=this.ey.ktf(T),Tb=this.ey.sAh(T,Aa),xc=this.eBa.pAh(T,Tb);T=Object.assign(new gf,{aDa:Tb,tOa:xc,hia:T});this.wXo(T);T.dLj=T.tOa-T.aDa;T.delta=Aa+xc+T.delta-ib;return T}wXo(T){T.aDa>T.tOa?this.xXo(T):0>T.aDa&&this.Rmg(T)}Rmg(T){let Aa=T.hia.Bh;for(;0>T.aDa;)T.Ey--,T.delta-=this.eBa.pOc(Aa),T.aDa+=this.eBa.pOc(Aa-
1),Aa--;T.tOa=this.eBa.pOc(Aa)}xXo(T){const Aa=this.ey.v8h(T.hia);T.Ey=Math.floor((T.aDa-T.tOa)/Aa)+1;T.delta=T.Ey*Aa;T.aDa-=T.tOa+(T.Ey-1)*Aa;T.tOa=Aa}}Object(f.a)(Bg,"PageFullHeightInfoCalculator",null,[]);class Uf{constructor(T,Aa,ib,Tb){this.CYa=0;this.HMa=null;this.eBa=T;this.owb=Aa;this.lQ=ib;this.ey=Tb;this.Rch=new jb.a}get DY(){return this.Rch}Oom(T){try{this.Vwf(T)}catch(Aa){this.ey.nR(Aa.message+" "+Aa.stack),ra.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",
Aa.message)}}reset(T){try{this.N6n(T)}catch(Aa){this.ey.nR(Aa.message+" "+Aa.stack),ra.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",Aa.message)}}wtm(){try{this.xtm()}catch(T){this.ey.nR(T.message+" "+T.stack),ra.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",T.message)}}bDm(T){try{this.cDm(T)}catch(Aa){this.ey.nR(Aa.message+" "+Aa.stack),ra.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",
Aa.message)}}L0n(T){try{this.M0n(T)}catch(Aa){this.ey.nR("Pagination: "+Aa.message+" "+Aa.stack),ra.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",Aa.message)}}Pzm(){var T=this.lQ.LPd(),Aa=this.lQ.Yai();T=rd.zbl(T);Aa=rd.ybl(this.CYa,Aa);this.DY.Z(0,T);this.Vwf(Aa)}R6n(){var T=fp.WordSectionNavigator.instance.Yai();(T=this.ey.ndi(T).parentNode)&&""!==T.style.minHeight&&(T.style.minHeight="")}MAm(T){this.Rch=new jb.a;this.DY.add(null);
for(let Aa=0;Aa<T.length;Aa++){const ib=rd.h4b(Aa+1,T[Aa]);this.DY.add(ib)}this.DY.add(rd.h4b(T.length+1,null))}xAm(T){this.eBa.Y6n(T)}x7n(){if(this.DY)for(const T of this.DY)T&&this.hyi(T)&&this.ey.Tsi(T,0)}Vwf(T){const Aa=this.a$l(T);if(this.ey.pAi(Aa)){let ib=this.ey.ktf(Aa);T.outlineNode!==Aa.outlineNode&&(ib+=this.ey.Grh(T,Aa));this.kRk(T,ib);this.hyi(T)&&this.y6f(T,ib)}else this.HMa.add(T),20<this.HMa.count&&ra.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.HMa.count);
this.DY.Z(T.Bh,T);this.Eom(T)}xtm(){this.x7n()}N6n(T){this.CYa=T.length+1;this.HMa=new jb.a;this.MAm(T);this.xAm(this.CYa);this.Pzm();this.R6n()}cDm(T){this.eBa.MYo(T);for(const Aa of T){if(!Aa){ra.ULS.sendTraceTag(38916955,336,10,"info is null.");return}if(0<Aa.Ey){T=Aa.hia.Bh;for(const ib of Aa.ZAf)this.DY.insert(T,ib),T++}else if(0>Aa.Ey)for(const ib of Aa.JId)this.DY.remove(ib),this.HMa.contains(ib)&&this.HMa.remove(ib)}this.Kcj()}M0n(T){T=T.Bh;this.eBa.N0n(T);this.DY.removeAt(T);for(const Aa of this.HMa)Aa.Bh===
T&&this.HMa.remove(Aa);this.Kcj()}kRk(T,Aa){Aa=this.ey.sAh(T,Aa);this.eBa.pAh(T,Aa)}y6f(T,Aa){T.MU&&T.MU.HardBreak||this.owb.y6f(T,Aa)}Eom(T){T=T.Bh+1;for(const Aa of this.HMa)if(Aa&&Aa.Bh===T){this.Vwf(Aa);this.HMa.remove(Aa);break}}Kcj(){for(let T=0;T<this.DY.count;T++){const Aa=this.DY.J(T);Aa&&Aa.Ahe(T)}}hyi(T){T=this.n7l(T);return 2===T||1===T}a$l(T){return this.DY.J(T.Bh-1)}n7l(T){return T.f3a?2:T.MU&&T.MU.HardBreak?1:0}}Object(f.a)(Uf,"PageFullHeightManager",null,[2024]);class hg{constructor(T,
Aa,ib,Tb){this.owb=T;this.eBa=Aa;this.lQ=ib;this.ey=Tb}create(){return new Uf(this.eBa,this.owb,this.lQ,this.ey)}}Object(f.a)(hg,"PageFullHeightManagerFactory",null,[]);var gh=c(1092),rg=c(589);class Bf{constructor(T,Aa,ib,Tb,xc){this.VXb=null;this.CZ=T;this.KN=Aa;this.Kyc=ib;this.owb=Tb;this.ey=xc}reset(){this.VXb=new jb.a}aSk(T,Aa,ib){try{return this.cSk(T,Aa,ib)}catch(Tb){return ra.ULS.sendTraceTag(38897350,336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",
Tb.message),null}}t8n(){try{this.u8n()}catch(T){ra.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",T.message)}}cSk(T,Aa,ib){if(!this.CZ.DY.count)return null;const Tb=this.s7l(T,!T);if(!Tb||Tb.n_d)return ra.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(Tb.MU&&Tb.MU.HardBreak)return null;var xc=this.CZ.DY.J(Tb.Bh-1);return this.ey.pAi(xc)&&(Aa-=ib,Tb.outlineNode!==xc.outlineNode&&
(Aa+=this.ey.Grh(Tb,xc)),(xc=this.Kyc.CAh(Tb,Aa))&&1<Math.abs(xc.delta))?(xc.H3i=Aa,xc.outlineGroupNode=this.b7l(T,Tb),this.VXb.add(xc),this.Rmg(xc),xc):null}b7l(T,Aa){return Aa&&Aa.f3a?(T=Object(ub.a)(rg.a,El.ParagraphReader.PD(Aa.outlineNode)),T=Cn.GraphIterator.$a(T),T.Bp(),Object(ub.a)(gh.a,T.jd(23))):T&&T.Ojb?T.outlineGroupNode:null}u8n(){this.VXb.Sc((T,Aa)=>Aa.hia.Bh-T.hia.Bh);for(const T of this.VXb)this.owb.vcj(T);this.PYo()}PYo(){this.KN.value.$Cm(this.VXb);this.CZ.bDm(this.VXb)}s7l(T,Aa){return Aa?
this.CZ.DY.J(this.CZ.DY.count-1):this.CZ.DY.J(T.Bh)}Rmg(T){let Aa=T.hia.Bh;const ib=-T.Ey;for(let Tb=0;Tb<ib;Tb++)Aa--,T.JId.add(this.CZ.DY.J(Aa))}}Object(f.a)(Bf,"PageFullHeightPositionUpdater",null,[2023]);class Oh{constructor(T,Aa,ib,Tb,xc){this.CZ=T;this.KN=Aa;this.Kyc=ib;this.owb=Tb;this.ey=xc}create(){return new Bf(this.CZ,this.KN,this.Kyc,this.owb,this.ey)}}Object(f.a)(Oh,"PageFullHeightPositionUpdaterFactory",null,[]);class ki{constructor(T,Aa){this.ey=T;this.Kyc=Aa}y6f(T,Aa){try{this.H3n(T,
Aa)}catch(ib){this.ey.nR(ib.message+" "+ib.stack),ra.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",ib.message)}}vcj(T){try{this.G3n(T)}catch(Aa){this.ey.nR(Aa.message+" "+Aa.stack),ra.ULS.sendTraceTag(38855577,336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",Aa.message)}}H3n(T,Aa){ra.ULS.shipAssertTag(38285913,336,T.f3a||T.MU.HardBreak);T=this.Kyc.CAh(T,Aa);this.vcj(T)}G3n(T){this.F3n(T);this.y3n(T)}y3n(T){0<T.Ey?this.lDm(T):0>T.Ey&&
this.Rkl(T)}F3n(T){this.ey.Tsi(T.hia,T.dLj)}lDm(T){let Aa=T.H3i+T.tOa;for(let Tb=0;Tb<T.Ey;Tb++){var ib=T.hia.Bh+Tb;const xc=T.hia.rca?this.ey.Rei(T.hia):T.hia.outlineNode;ib=this.i$k(xc,T.outlineGroupNode,Aa,ib);T.ZAf.add(ib);T.Ahn.add(Aa);Aa+=T.tOa}}Rkl(T){for(const Aa of T.JId)this.ey.Qkl(Aa)}i$k(T,Aa,ib,Tb){Aa=this.ey.j$k(T,ib,Aa);return rd.taf(ib,Tb,Aa,T,!1,!1)}}Object(f.a)(ki,"PageFullHeightRenderer",null,[]);class lk{constructor(T){this.Y2f=T}}Object(f.a)(lk,"PageHeightDeltaResult",null,[2022]);
class Vm{constructor(T,Aa,ib){this.sq=null;this.ey=T;this.ri=Aa;ib.execute(Tb=>{Tb.register(this)})}get wZc(){return"PageHeightDelta"}get result(){return this.sq}get yRf(){return 1}get F9f(){return 500}get isEnabled(){return!0}HRf(){this.sq=null}DCa(T){this.ri.ie(()=>{try{this.WFc(T)}catch(Aa){ra.ULS.sendTraceTag(39188045,324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",Aa.message)}},"PHDM:C")}WFc(T){this.sq=null;T=this.XFc(T);-1!==T&&(this.sq=new lk(T))}XFc(T){if(!T.count)return-1;
let Aa=0,ib=0;for(const Tb of T)T=this.dSk(Tb),-1!==T&&(Aa+=T,ib++);return ib?Aa/ib:-1}dSk(T){if(!T.WKm)return-1;const Aa=this.ey.tdi(T.cCd,T.Bh);return-1===Aa?-1:Math.abs(T.height-Aa)}}Object(f.a)(Vm,"PageHeightDeltaMetric",null,[1987]);class Dn{constructor(T){this.$Va=null;this.ey=T}pOc(T){return this.$Va.J(T-1)}Y6n(T){this.$Va=new jb.a;for(let Aa=0;Aa<T;Aa++)this.$Va.add(-1)}pAh(T,Aa){if(this.gQm(T))return this.$Va.J(T.Bh-1);Aa=this.DRk(T,Aa);this.SEo(T,Aa);return Aa}MYo(T){for(const Aa of T)this.LYo(Aa)}SEo(T,
Aa){this.$Va.Z(T.Bh-1,Aa)}N0n(T){this.$Va.removeAt(T-1)}LYo(T){if(T)if(0<T.Ey){var Aa=T.hia.Bh;for(var ib=0;ib<T.Ey;ib++)this.$Va.insert(Aa,T.tOa)}else if(0>T.Ey)for(Aa=-T.Ey,T=T.hia.Bh-Aa,ib=0;ib<Aa;ib++)this.$Va.removeAt(T)}gQm(T){return-1!==this.$Va.J(T.Bh-1)}DRk(T,Aa){if(T.f3a||T.MU.HardBreak)T=this.ey.v8h(T),Aa=Aa<T?T:Aa;return Aa}}Object(f.a)(Dn,"PageHeightStorage",null,[]);var Lm=c(111);class Vq{constructor(T){this.Y2f=T}}Object(f.a)(Vq,"PageLevelDeltaResult",null,[2022]);class Oo{constructor(T,
Aa,ib,Tb){this.sq=null;this.xI=T;this.ota=Aa;this.ri=ib;Tb.execute(xc=>{xc.register(this)})}get lf(){const T=this.xI.value;ra.ULS.shipAssertTag(39081438,336,T.Wi,"PageLevelDeltaMetric.PageView is not a PageView.");return T}get wZc(){return"PageLevelDelta"}get result(){return this.sq}get yRf(){return 0}get F9f(){return 60}get isEnabled(){return!0}HRf(){this.sq=null}DCa(T){this.ri.ie(()=>{try{this.WFc(T)}catch(Aa){ra.ULS.sendTraceTag(39081440,324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",
Aa.message)}},"PLDM:C")}WFc(T){this.sq=null;T=this.XFc(T);-1!==T&&(this.sq=new Vq(T))}XFc(T){if(!T.count)return-1;let Aa=0,ib=0;for(const Tb of T)T=this.fSk(Tb),-1!==T&&(Aa+=T,ib++);return ib?Aa/ib:-1}fSk(T){if(T.Ojb)return-1;var Aa=T.MU.CP;T=T.paragraphNode;ra.ULS.shipAssertTag(39081441,336,!!T);T=T.De(this.lf.fc);ra.ULS.shipAssertTag(39081442,324,Object(Lm.a)(86,T));let ib;({tKh:Aa,lGi:T,Kfj:ib}=this.TRk(T,fi.a.yA(T.htmlElement).length,Aa));return T&&ib?Math.min(Aa.x-T.x,ib.x-Aa.x):(ra.ULS.sendTraceTag(39081443,
336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}TRk(T,Aa,ib){let Tb,xc,ld,Sd=xc=ib,df=ld=Tb=null;if(ib>Aa)return ra.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{tKh:df,ZZm:Sd,lGi:ld,d$n:xc,Kfj:Tb};df=this.ota.Tq(T,ib);for(var De=0,Ff=ib;De<=Ff;){const Wg=Math.floor((De+Ff)/2),Vh=this.ota.Tq(T,Wg);if(De===Ff){Sd=Wg;ld=Vh;break}Vh.y+Vh.height<=df.y?De=Wg+1:Ff=Wg}for(;ib<=
Aa;){De=Math.ceil((ib+Aa)/2);Ff=this.ota.Tq(T,De);if(ib===Aa){xc=De;Tb=Ff;break}Ff.y>=df.y+df.height?Aa=De-1:ib=De}return{tKh:df,ZZm:Sd,lGi:ld,d$n:xc,Kfj:Tb}}}Object(f.a)(Oo,"PageLevelDeltaMetric",null,[1987]);class hs{constructor(T,Aa,ib,Tb,xc,ld,Sd){this.Bh=T;this.top=Aa;this.tmh=ib;this.height=Tb;this.tQb=xc;this.cCd=ld;this.WKm=Sd}}Object(f.a)(hs,"Page",null,[]);class mr{constructor(T,Aa,ib,Tb,xc){this.PXb=null;this.eih=0;this.xI=T;this.Xhd=Aa;this.R$g=ib;this.GLa=Tb;this.T$g=xc;this.oXa=new jb.a}get lf(){const T=
this.xI.value;ra.ULS.shipAssertTag(37007393,336,T.Wi,"PageManager.PageView is not a PageView.");return T}get Yk(){return this.oXa}kHj(T){T=this.P7i(T);this.mHj(T)}JYo(T,Aa){this.eih=Aa;T=this.P7i(T);this.mHj(T);this.T$g.isEnabled&&this.T$g.DCa(T)}P7i(T){this.oXa=new jb.a;this.PXb=new qb.a(0);const Aa=new jb.a;if(!T)return this.Yk;var ib=0,Tb=null;for(let xc=0;xc<T.count;xc++){const ld=T.J(xc);ib=ld.Bh;Tb=this.hHd(ib,Tb,ld);this.Yk.add(Tb);!mr.jLe&&0>Tb.height&&Aa.add(Tb);Tb=ld}T=this.hHd(ib+1,Tb,
null);this.Yk.add(T);!mr.jLe&&0>T.height&&Aa.add(T);for(const xc of Aa)mr.jLe=!0,ra.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+xc.Bh);return this.Yk}hHd(T,Aa,ib){const Tb=Aa?Aa.outlineNode:this.GLa.G9h(),xc=ib?ib.outlineNode:this.GLa.dbi();var ld=this.udi(Tb);const Sd=this.udi(xc),df=Aa?this.zAh(Aa):0;ld=df+ld;const De=ib?this.zAh(ib):this.Xhd.Y4a.clientHeight-Sd;return new hs(T,df,ld,Tb.id===xc.id?De-df:De+Sd-ld,Tb,xc,(ib?ib.Bh:this.eih+1)===(Aa?Aa.Bh:
0)+1)}zAh(T){return T.rca?0:T.top}mHj(T){if(this.R$g.F9d)for(const Aa of this.R$g.F9d)Aa&&Aa.nHj(T)}udi(T){this.PXb||(this.PXb=new qb.a(0));if(this.PXb.mb(T.id))return this.PXb.J(T.id);var Aa=T.De(this.lf.fc);if(!Aa)return ra.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;Aa=pa.a.x1a(this.Xhd.Y4a,Aa.htmlElement).y;this.PXb.Z(T.id,Aa);return Aa}}mr.jLe=!1;Object(f.a)(mr,"PageManager",null,[1985]);var Ql=c(615);class hf{constructor(T,Aa,ib,Tb,xc,ld,Sd,
df){this.Ltj=df;this.kog=this.Z4a=!1;this.Dln=(De,Ff)=>{0!==Ff.Nlb||this.kog?this.xSh():this.fWh()};this.ga=T;this.bfa=Aa;this.WTb=ib;this.Xt=Tb;this.Ri=xc;this.V$g=ld;this.yI=Sd;df||(this.Z4a=0===this.yI.fu,this.yI.nqh(this.Dln))}Tb(){this.ga.eb(Yg.a.y3c,Li.a.application,this.y3c.bind(this),96);this.ga.eb(Yg.a.hce,Li.a.application,this.hce.bind(this),96);this.ga.eb(Yg.a.tme,Li.a.application,this.tme.bind(this),96);this.ga.eb(Yg.a.qme,Li.a.application,this.qme.bind(this),8)}tme(T,Aa,ib){return 1===
ib?32:this.ga.processAction(Yg.a.A7a,2)}qme(T,Aa,ib,Tb){if(1===ib)return this.Ltj?8:0===this.yI.fu?32:8;this.Z4a?(this.xSh(),this.kog=!0):(this.fWh(),this.kog=!1);this.Ri.updateCommandUI();Tb.xs=this.Z4a?1:0;return 32}y3c(T,Aa,ib,Tb,xc){if(1===ib)return 32;T=this.V$g.l9b();-1===T?T="":this.Z4a||1===this.yI.fu?(Aa=this.V$g.XTl(),Aa>T&&(T=Aa),T=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,Aa,T)):T=1===T?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,
T):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,T);xc[Ql.a.Visible]=!0;xc[Ql.a.LabelText]=T;return 32}hce(T,Aa,ib,Tb,xc){if(1===ib)return 32;xc[ci.a.On]=this.Z4a;return 32}fWh(){this.Z4a||this.Ltj||(this.WTb.Uul(),this.Xt.eyo(),this.Z4a=!0)}xSh(){this.Z4a&&(this.WTb.qol(),this.Xt.vtm(),this.Z4a=!1)}}Object(f.a)(hf,"PaginationActor",null,[]);class Cl{constructor(T){this.Y2f=T}}Object(f.a)(Cl,"PaginationDeltaResult",null,[2022]);class Ip{constructor(T,Aa){this.Mwb=this.djd=null;this.ri=
T;Aa.execute(ib=>{ib.register(this)})}get wZc(){return"PaginationDelta"}get result(){return this.djd}get yRf(){return 1}get F9f(){return 200}get isEnabled(){return!0}HRf(){this.djd=null}DCa(T){this.ri.ie(()=>{try{this.WFc(T)}catch(Aa){ra.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",Aa.message)}},"PDM:C")}Ogg(T){this.Mwb=T}WFc(T){this.djd=null;T=this.XFc(this.Mwb,T);-1!==T&&(this.djd=new Cl(T))}XFc(T,Aa){if(!(T&&Aa&&T.count&&Aa.count))return-1;
const ib=new jb.a;for(const Tb of T)ib.add(Tb.top);T=new jb.a;for(const Tb of Aa)T.add(Tb.top);Aa=this.xMd(ib,T);return this.x3b(Aa)}x3b(T){if(!T.count)return 0;let Aa=0;for(let ib=0;ib<T.count;ib++)Aa+=T.J(ib);return Aa/T.count}xMd(T,Aa){const ib=new jb.a;if(!T.count||!Aa.count)return ib;var Tb=T.count<=Aa.count;const xc=Tb?T:Aa;T=Tb?Aa:T;for(Aa=0;Aa<xc.count;Aa++){Tb=xc.J(Aa);let Sd=Math.abs(Tb-T.J(0)),df=0;for(let De=1;De<T.count;De++){var ld=T.J(De);ld=Math.abs(Tb-ld);ld<Sd&&(Sd=ld,df=De)}ib.add(Sd);
T.removeAt(df)}return ib}}Object(f.a)(Ip,"PaginationDeltaMetric",null,[1987]);var Wm=c(382),Sr=c(1403),zr=c(2042);class wn extends Wm.a{constructor(T,Aa,ib,Tb,xc,ld,Sd,df=null){super();this.HN=null;this.dxe=0;this.CYa=-1;this.Ytb=!1;this.sY=()=>{ra.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.zSh()};this.lUf=()=>{if(0==this.HS.fu){var De=this.HN.Ht;ih.a.eq(De,this.YWb)||(this.YWb=De,this.Wqn(this.gLa,this.YWb))}};this.HS=T;this.Hca=this.Hca.bind(this);
this.HS.tzb(this.Hca);this.ga=Aa;this.Xt=ib;this.kZ=Tb;this.fla=xc;this.hJe=df||al.a.instance;this.YWb=this.gLa=ih.a.nil;this.cak=Sd;ld.CWR(()=>ld.result.bC.UMa(this.sY));this.c5b();this.ik=new Sr.a(1E3);this.ik.I_a();this.fla.register(this)}get Tha(){return"Pagination"}get lgf(){return this.cak.value}get LYm(){return this.gLa}get pIa(){return this.CYa}sqo(T){this.CYa!==T&&(this.CYa=T,this.kZ.dng())}Hca(){this.gLa=this.YWb=ih.a.nil;this.c5b()}M4a(T){this.HN=T;this.HN.P0b(this.lUf);this.y0b(this.HN.node)}Wqn(T,
Aa){ih.a.eq(T,Aa)?(this.Xt.X3d(),this.c5b()):(this.Xt.Y3d(),this.FDo())}bvl(){this.enabled=2}c5b(){this.enabled=0}FDo(){this.dxe=0;this.bvl();this.cF(null,null,null)}Xna(){return cb.App.lostSession||cb.App.rd.bC.zo?!1:!!(this.enabled&2)&&this.ik.JX()}cF(){this.ik.ahb();this.fla.WU()}forceOutbound(){}X3(){return 0===this.enabled?!1:this.ee&&2===this.ee.status?!0:this.Xna()}DSa(){if(1===this._state)this.ee.Eq=zr.a.eba(l.AFrameworkApplication.rootQuerySignature,this.gLa),this.ee.IG="Pagination",this.ee.status=
1,this._state=3;else if(3===this._state&&this.ee&&2===this.ee.status)if(l.AFrameworkApplication.Nk)this._state=4;else if(this.ik.v1(),this.ik.B8(),this._state=1,this.dxe++,2!==this.ee.statusCode)this.d5b();else if(1!==(this.ee.Ij?this.ee.Ij.length:0))this.d5b();else{var T=this.ee.Ij[0];this.hJe.mUa(T);104===T.StatusCode?this.zSh():101===T.StatusCode?this.d5b():3===T.StatusCode?this.d5b():T.StatusCode?this.d5b():T.PageEnds?(this.sqo(T.PageEnds.length+1),this.gLa=nm.b(T.LastKnownPaginationRevision),
ra.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.CYa,this.gLa),this.Xt.mbd(T.PageEnds,ih.a.eq(this.gLa,this.YWb)),this.lgf.jia=T.PageEnds,this.kZ.O5e(),ra.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.CYa,this.gLa),this.Aol()):this.d5b()}}zSh(){this.HN&&this.HN.eNb(this.lUf);
this.c5b()}d5b(){60<this.dxe&&this.c5b()}Aol(){ih.a.eq(this.gLa,this.YWb)&&this.c5b()}dispose(){this.HN&&(this.HN.eNb(this.lUf),this.HN.node&&this.A4c(this.HN.node),this.HN=null);this.HS.d6f(this.Hca)}y0b(T){T&&(T.addListener(this),this.Ytb=!0)}A4c(T){this.Ytb&&T&&(T.removeListener(this),this.Ytb=!1)}JKb(T){this.A4c(T)}onBeforeLoadContent(){}onAfterLoadContent(T){(T=T.od.km)&&this.Jnn(this.gLa,T.id)}onAfterFirstSaveContent(){}Jnn(T,Aa){ih.a.eq(T,Aa)&&this.Xt.X3d()}}Object(f.a)(wn,"PaginationReplicator",
Wm.a,[1984,10,104]);class Gq{constructor(){this.gaa=this.Xt=this.kZ=this.WTb=this.Av=null;this.Bsa=!1;this.MDk=()=>{this.Ksh()}}get name(){return"WordEditor.Pagination"}xc(T){this.W=T;this.ld=this.W.resolve("Box4.IFeatureHelper");this.W.ha("WordEditor.Pagination.PageElementManagerList",()=>new bo(this.W.resolve("WordEditor.Pagination.PageAdornmentManager"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.OutlineManager",()=>new on(new bb.a(()=>
cb.App.xa.ib.rc))).as("WordEditor.Pagination.IOutlineManager").singleInstance();this.W.ha("WordEditor.Pagination.PageManager",()=>new mr(new bb.a(()=>cb.App.xa.ib.rc),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageElementManagerList"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").singleInstance();this.W.ha("WordEditor.IPaginationReplicator",
()=>new wn(this.W.resolve("WordEditor.IMainViewModeManager"),l.AFrameworkApplication.va,this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"),Yi.App.j1,cb.App.Tna(),new bb.a(()=>this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings")))).singleInstance();this.W.ha("WordEditor.ICurrentPageManager",()=>new bh(this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.PageLevelDeltaMetric",
()=>new Oo(new bb.a(()=>cb.App.xa.ib.rc),this.W.resolve("Box4.ITextMetricsAdapter"),Ie.a.instance,this.W.Sa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightDeltaMetric",()=>new Vm(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),Ie.a.instance,this.W.Sa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PaginationDeltaMetric",()=>new Ip(Ie.a.instance,this.W.Sa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();
this.W.ha("WordEditor.Pagination.PageHeightStorage",()=>new Dn(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightDOMHelper",()=>new xg(new bb.a(()=>cb.App.xa.ib.rc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightInfoCalculator",()=>new Bg(this.W.resolve("WordEditor.Pagination.PageHeightStorage"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();
this.W.ha("WordEditor.Pagination.PageFullHeightRenderer",()=>new ki(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new Oh(this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),this.W.Ue("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),
this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkerPositionUpdater",()=>new ma(new bb.a(()=>cb.App.xa.ib.rc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),
this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),cb.App.Xj.zl)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManagerFactory",()=>new hg(this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageHeightStorage"),fp.WordSectionNavigator.instance,this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();
this.W.ha("WordEditor.Pagination.PageFullHeightManager",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new fm(this.W.resolve("Common.IZoomManager"),Ie.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").singleInstance();this.W.ha("WordEditor.Pagination.PaginationActor",()=>new hf(l.AFrameworkApplication.va,this.W.resolve("WordEditor.IStatusBarUser"),this.W.resolve("WordEditor.ICurrentPageManager"),
this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),l.AFrameworkApplication.ta,this.W.resolve("WordEditor.IPageNumberFinder"),this.W.resolve("WordEditor.IMainViewModeManager"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SimplifiedPageViewUx",!1)&&this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").J_a)).singleInstance();this.W.ha("WordEditor.Pagination.DocumentSizeManager",()=>new Nh(new bb.a(()=>cb.App.xa.ib.rc),Xo.a.get_instance(),this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();
this.W.ha("WordEditor.Pagination.CurrentPageCalculator",()=>new up(l.AFrameworkApplication.va,Ui.a.instance,nl.a.instance,this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),new bb.a(()=>cb.App.xa.ib.rc),this.W.Na("Box4.CpConversionManagerImpl"),this.W.resolve("WordEditor.IStatusBarUser"))).as("Common.ICurrentPageCalculator").singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkers",()=>this.Xt=new Jd(new bb.a(()=>cb.App.xa.ib.rc),new bb.a(()=>cb.App.xa.ib.Uc.od),this.W.resolve("WordEditor.Pagination.IPageAdornmentManager"),
this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.W.resolve("WordEditor.Pagination.IPageManager"),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),fl.a.nPc,this.W.resolve("WordEditor.ParagraphWordIdMapping"),nl.a.instance,Jd.xZl,this.W.resolve("Box4.ContentEditableViewEventSource"),new Hp.a,this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),
this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.W.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.W.resolve("Common.ICurrentPageCalculator"),this.W.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.Pagination.IPageEndMarkers").as("Box4.IPaginationRefreshHelper").singleInstance();this.W.ha("WordEditor.Pagination.PageEndDOMHelper",()=>new qk(this.W.Sa("Common.IZoomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!cb.App.instance&&
cb.App.instance.RC)).singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new wo(l.AFrameworkApplication.nc)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentContentManager",()=>new rm(this.W.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentManager",()=>this.gaa=new Mi(new bb.a(()=>
cb.App.xa.ib.rc),Hn.a.instance,zj.a.instance,Xe.a.instance,l.AFrameworkApplication.va,kk.a.instance,this.W.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.W.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),nl.a.instance,l.AFrameworkApplication.K,!!cb.App.instance&&cb.App.instance.RC,!!cb.App.instance&&cb.App.instance.Hoa)).as("WordEditor.Pagination.IPageAdornmentManager").singleInstance()}init(){this.ld.Pp.continueWith(()=>
{this.hn()})}hn(){const T=cb.App.xa.ib;T.xwa?this.Ksh():T.sfa(this.MDk)}Ksh(){this.Bsa||(this.Bsa=!0,this.WTb=sa.a.instance.resolve("WordEditor.ICurrentPageManager"),this.kZ=sa.a.instance.resolve("Common.ICurrentPageCalculator"),this.Av=sa.a.instance.resolve("WordEditor.IPaginationReplicator"),sa.a.instance.resolve("WordEditor.Pagination.PaginationActor").Tb())}dispose(){this.gaa&&(this.gaa.dispose(),this.gaa=null);this.Xt&&(this.Xt.dispose(),this.Xt=null);this.Av&&(this.Av.dispose(),this.Av=null);
this.kZ&&(this.kZ.disable(),this.kZ=null);this.WTb&&(this.WTb=null)}}Object(f.a)(Gq,"PackageManager",null,[1,2]);class Ar{constructor(){this.W=null}xc(T){this.W=T||sa.a.instance}dispose(){}}Object(f.a)(Ar,"TellMePackage",null,[1,2]);var gp=c(1500),pq=c(1502),lo=c(343),ei=c(1499),Nk=c(1390);class Ja{constructor(T=null,Aa=null,ib=null,Tb,xc=null){this.Nse=null;this.mLg=!1;this.zVg=this.OSb=null;this.xkk=this.cgh=this.ZWj=this.AVg=!1;this.Dgd=null;this.mXj=null==Aa?l.AFrameworkApplication.Nzb:Aa;this.R7j=
null==ib?l.AFrameworkApplication.U_:ib;this.flk=null==xc?l.AFrameworkApplication.a7a:xc;this.r6j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");this.Rmk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");this.qqo(!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.Imk=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.uWc;this.Jmk=!ei.a.zoa()&&!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");
this.Hmk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.q3j=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.YOb;this.Kmk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.ckk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.uek=this.o8c||this.n8c;this.sek=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");
this.tek=this.QEf;this.c$j=!!l.AFrameworkApplication.K&&this.TTa&&l.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.P4j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.u5j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.D4j=l.AFrameworkApplication.K?parseFloat(l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold",
"-0.6")):-.6;this.$9j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.E9j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.x$j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",
!1);this.n8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1)&&(this.tWm||this.$Pm);this.zZb=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.Olk=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):
"https://substrate.office.com/search/api/v1/suggestions";this.z5j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.dkk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.Rkk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",
!1);this.tkk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("ShowFindInDocumentInZeroTermSearchBox")||this.rP;this.m$j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("TellMeTemplateProviderIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.A9j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);
this.T9j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===l.AFrameworkApplication.uiCulture;this.j$j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("TellMeFeedbackProviderIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.z$j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.$Wj=this.TTa&&
!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.Y5j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.Xkk=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==l.AFrameworkApplication.K.jb("Application"));
this.DYj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.Fok=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMePerformanceMarkerEnabled");this.q8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.u8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.t5j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.l$j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeNotesSuggestionIsEnabled")||this.BUm;this.s8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.t8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.r8j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.B2j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.C2j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.Lmk=this.fDi&&
(this.WWf||this.XWf||this.A0c||this.TTa&&ei.a.Moa()&&!!l.AFrameworkApplication.K&&(this.Sjc||this.cPb||this.dPb||this.ePb||this.gPb||l.AFrameworkApplication.K.$("ShowAnswerSearchResults")||l.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||l.AFrameworkApplication.K.$("ShowEntitySearchResults")||l.AFrameworkApplication.K.$("ShowWolframSearchResults")));this.ZVj=!!l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&l.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&
l.AFrameworkApplication.sCa;this.$Vj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled");this.zzm(T||{});this.yRe="2918242107";this.xRe="1454393937";this.xwb={};this.fdb=[];this.a7k=[ei.a.jne]}get application(){return this.OSb}get Nzb(){return this.mXj}get Hco(){return this.yRe}get Gco(){return this.xRe}get Bkf(){return this.zVg}get D_h(){return this.AVg}get U_(){return this.R7j}get a7a(){return this.flk}get Izb(){return this.ZWj}get ctm(){return this.r6j}get BJo(){return this.Rmk}get fDi(){return!0}get rJo(){return this.Lmk}get qto(){return this.cgh}qqo(T){this.cgh=
T}get TTa(){return this.Imk}get w$c(){return this.Jmk}get u$c(){return this.Hmk}get NBl(){return this.q3j}get pJo(){return this.Kmk}get Pme(){return!1}get A0c(){return this.uek}get WWf(){return this.sek}get XWf(){return this.tek}get w3a(){return!1}get d0d(){return!1}get EGf(){return this.c$j}get Kie(){return this.xkk}get Sjc(){return!1}get Vuo(){return!1}get YZm(){return""}get Yrf(){return 2}get U$l(){return 4}get V$l(){return 5}get Ggi(){return""}get YWl(){return this.P4j}get Xgi(){return this.u5j}get Igi(){return 1E3}get Hgi(){return 1E-6}get LFo(){return this.Olk}get lhg(){return!1}get cxj(){return!1}get nSm(){return this.T9j}get N_d(){return!1}get O_d(){return!1}get Hzi(){return!1}get Gzi(){return!1}get BUm(){return!1}get gDi(){return!1}get nMd(){return!1}get Vob(){return!1}get cPb(){return!1}get dPb(){return!1}get ePb(){return!1}get gPb(){return!1}get o8c(){return this.ckk}get Njc(){return this.dkk}get n8c(){return!1}get fpf(){return null}get H_d(){return!1}get Die(){return this.tkk}get Rci(){return 0}get UQl(){return this.D4j}get Dhi(){return this.z5j}get uTm(){return this.$9j}get KBf(){return this.n8j}get Cie(){return this.zZb}get P4l(){return-3.9}get rP(){return this.Rkk}get vWc(){return this.m$j}get bFf(){return this.A9j}get YGf(){return this.j$j}get Wdb(){return this.$Wj}get BWm(){return this.z$j}get $va(){return this.Y5j}get Ztj(){return this.Xkk}get SMk(){return this.DYj}get Ooe(){return this.Fok}get RXd(){return this.q8j}get qGm(){return this.u8j}get gv(){return this.t5j}get wkb(){return this.l$j}get oGm(){return this.s8j}get pGm(){return this.t8j}get nGm(){return this.r8j}get xAk(){return this.ZVj}get yAk(){return this.$Vj}get mga(){return this.B2j}get oKd(){return this.C2j}get tWm(){return this.x$j}get $Pm(){return this.E9j}get fIb(){return!!l.AFrameworkApplication.ta&&
l.AFrameworkApplication.ta.Nb.yr}get yr(){return!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.yr}get UOm(){return!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.Qjc}get Xhn(){return we.getImageClass("OfficeAssistant_32x32x32")}FPd(){return Promise.reject("GetFindMatchCount method is not overridden")}t0d(T){return Array.contains(appChrome.selectors.getVisibleControlIds(),T)}CYd(){return!1}get VZd(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeModelRankerEnabled")}get Qyj(){return l.AFrameworkApplication.K?
l.AFrameworkApplication.K.jb("TellMeServiceHelpClassifierModelName"):""}get QEf(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeMultiLingualCommandModelEnabled")}get eGb(){return"NoOpHeaderUi"}get U6k(){return this.Dgd}get parameterData(){return this.xwb}get HQo(){return this.fdb}uxl(){if(this.Nse&&!this.mLg&&(this.mLg=!0,this.Mob(this.Nse),this.yr)){var T=sa.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");T=(new Nk.a(T)).TNd(this.Nse.UG);appChrome.api.dispatch(T)}}get P9f(){return""}Mob(){}hnl(T){const Aa=
[];for(let ib=0;ib<T.length;++ib)T[ib].Qvo?Aa.push(new lo.a(T[ib].alternate,ei.a.rDj+ib.toString())):Aa.push(new lo.a(T[ib].standard,ei.a.jne+ib.toString()));return Aa}zzm(T){const Aa={};for(let ib in T){const Tb=ib,xc=T[ib];for(let ld in xc){const Sd=ld,df=xc[ld];(Aa[Sd]||(Aa[Sd]={}))[Tb]=df}}this.Dgd=Aa}get Ryj(){return""}get Osj(){return!1}}Object(f.a)(Ja,"TellMeApplicationData",null,[1227]);class Eb{constructor(T,Aa=null,ib=!1){this.standard=T;this.alternate=Aa;this.Qvo=ib}}Object(f.a)(Eb,"TryQuerySet",
null,[]);class jc{constructor(){this.t7g=this.u7g=null}get vfn(){return this.t7g}bga(T){this.u7g=T;return this.obf(T)}gjn(){this.t7g=this.u7g}AQd(T){return 8===T.type?String.format(CommonUIStrings.l_FindInDocumentText,T.$C):T.$C}Gof(T){return T.$C}}Object(f.a)(jc,"ParameterizedCommand",null,[]);class Fc extends jc{constructor(T){super();this.fWc=T}get commandId(){return this.fWc?"DefinitionsParameterized":"DefinitionButton"}get sYf(){return"Definition"}obf(T){const Aa=Ta.a.yf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,
T.$C));return Re.a(ei.a.dcf(T.value),n.a.Hdf.toString(),Aa,ei.a.aBf,null,Ta.a.yf(ei.a.IBb(T.$C)),Aa,null,null)}AQd(T){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,T.$C)}Gof(T){return ei.a.IBb(T.$C)}}Object(f.a)(Fc,"DefinitionsParameterizedCommand",jc,[]);class gd extends jc{constructor(T){super();this.fWc=T}get commandId(){return this.fWc?l.AFrameworkApplication.ta.Nb.kLm?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get sYf(){return"Find"}obf(T){const Aa=
Ta.a.yf(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,T.$C));return Re.a(ei.a.dcf(T.value),n.a.findInDocument.toString(),Aa,"Find_16x16x32",null,Ta.a.yf(T.$C),Aa,null,null)}AQd(T){return String.format(CommonUIStrings.l_TextWithQuotation,T.$C)}}Object(f.a)(gd,"FindParameterizedCommand",jc,[]);class ae extends jc{constructor(T){super();this.fWc=T}get commandId(){return this.fWc?"SynonymsParameterized":"SynonymButton"}get sYf(){return"Synonym"}obf(T){const Aa=Ta.a.yf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,
T.$C));return Re.a(ei.a.dcf(T.value),n.a.Hdf.toString(),Aa,ei.a.aBf,null,Ta.a.yf(ei.a.IBb(T.$C)),Aa,null,null)}AQd(T){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,T.$C)}Gof(T){return ei.a.IBb(T.$C)}}Object(f.a)(ae,"SynonymsParameterizedCommand",jc,[]);var ef=c(2051),Ae=c(1963),Jf=c(2082),Pf=c(2046),Zg=c(2047),$g=c(1585);class Ka extends ef.a{constructor(){super(...arguments);this.NN=null;this.zYa=Ae.FindManager.createInstance(this,Jf.a.instance,$g.a.instance,
!0,!0)}static get instance(){return Ka._instance}D6b(){this.NN(this.zYa.Qj.tja);this.zYa.LZa(!0)}FPd(T){const Aa=new Promise((ib,Tb)=>{this.NN=ib;setTimeout(()=>{Tb("Find manager execution timed out");this.zYa.LZa(!0)},500)});T=Pf.a.createQuery(T,Zg.a.none);this.zYa.find(T);return Aa}}Ka._instance=new Ka;Object(f.a)(Ka,"TellMeFindStatusSpy",ef.a,[]);class Za extends Ja{constructor(T){super({});this.OSb="Word";this.b5j=T;l.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.AVg=!0,this.zVg=
this.nMd?"FindWithMatchesParameterized":"FindParameterized");T=new Fc(this.fIb);const Aa=new ae(this.fIb);this.parameterData[T.commandId]=T;this.parameterData[Aa.commandId]=Aa;T=new gd(this.fIb);this.parameterData[T.commandId]=T;l.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&(T=[new Eb(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new Eb(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new Eb(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new Eb(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,
"",!1),new Eb(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.fdb=this.hnl(T))}FPd(T){return Ka.instance.FPd(T)}get e6a(){return el.AppFrame.hqa}get eGb(){return el.AppFrame.CPa}get P9f(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}Mob(T){var Aa=l.AFrameworkApplication.K;T=T.UG;T.WordCountFlyout=!this.b5j();T.SelectAllButton=!Aa.$("TellMeSelectAllResultIsEnabled");const ib=Aa.$("TellMeDesktopUpSellIsEnabled");let Tb=l.AFrameworkApplication.e0d;
appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!Tb));Tb=!1;T.TextBoxUpSellButton=!ib||Tb;T.TableOfContentsUpSellButton=!ib||Tb;T.SmartArtUpSellButton=!ib||Tb;T.WordArtUpSellButton=!ib||Tb;T.MultiColumnLayoutUpSellButton=!ib||Tb;T.InsertEquationUpSellButton=!ib||Tb;T.TrackChangesUpSellButton=!ib||Tb;T.ShapesUpSellButton=!ib||Tb;T.LabelsUpSellButton=!ib||Tb;T.InsertCitationUpSellButton=!ib||Tb;T.TextBoxUpSellButtonEnterprise=!ib||!Tb;T.TableOfContentsUpSellButtonEnterprise=
!ib||!Tb;T.SmartArtUpSellButtonEnterprise=!ib||!Tb;T.WordArtUpSellButtonEnterprise=!ib||!Tb;T.MultiColumnLayoutUpSellButtonEnterprise=!ib||!Tb;T.InsertEquationUpSellButtonEnterprise=!ib||!Tb;T.TrackChangesUpSellButtonEnterprise=!ib||!Tb;T.ShapesUpSellButtonEnterprise=!ib||!Tb;T.LabelsUpSellButtonEnterprise=!ib||!Tb;T.InsertCitationUpSellButtonEnterprise=!ib||!Tb;Aa=!Aa.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!l.AFrameworkApplication.U_;T.SynonymButton=Aa;T.DefinitionButton=Aa}get Ryj(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName",
"")}get lhg(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",!1)}get Qyj(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get Sjc(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get QEf(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",
!1)}get Yrf(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get Osj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",!1)}get d0d(){return l.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get VZd(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",
!1)}get N_d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get O_d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",!1)}get Igi(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get Hgi(){return 1E-6*l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",
1)}get Hzi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get Gzi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",!1)}get Ggi(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get gDi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",
!1)}get Rci(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get fDi(){return l.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get Pme(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",!1)}get w3a(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get Kie(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",
!1)}get cxj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get H_d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",!1)}get cPb(){return l.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get dPb(){return l.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get ePb(){return l.AFrameworkApplication.K.$("ShowEntitySearchResults")}get gPb(){return l.AFrameworkApplication.K.$("ShowWolframSearchResults")}get fpf(){return l.AFrameworkApplication.K.$("ModernFontPickerIsEnabled")?
{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(f.a)(Za,"WordEditorTellMeApplicationData",Ja,[]);var tb=c(1536),pc;(function(T){T[T.none=0]="none";T[T.waitAll=1]="waitAll";T[T.synchronizeFast=2]="synchronizeFast";T[T.synchronizeSlow=3]="synchronizeSlow"})(pc||(pc={}));Object(f.b)("ProviderSynchronizationType",pc);var Ec;(function(T){T[T.immediate=0]="immediate";T[T.waitAll=1]="waitAll";T[T.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";T[T.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})(Ec||
(Ec={}));Object(f.b)("MenuUpdatePolicy",Ec);var ad=c(1507),wd=c(1504),Td=c(1642),Je=c(1508),Gf=c(1530),li=c(112),hk=c(287);class Of extends ef.a{constructor(T){super();this.Fpk=T}D6b(){this.Fpk.update()}}Object(f.a)(Of,"TellMeFindStatusManager",ef.a,[]);class $h{constructor(T){this.Zcb=this.PNg=null;this.gi=0;this.Sld="TellMeWAC.";const Aa=T.Bkf;this.ic=T;this.ljd=Aa;this.ZIe=Object.assign(new tb.a,{landingTab:"Indoc",data:null});T=new Of(this);this.zYa=Ae.FindManager.createInstance(T,Jf.a.instance,
$g.a.instance,!0,!0)}cL(){return"WordFindInDocument"}bU(){return this.ic.Yrf?this.ic.Yrf===Ec.waitAll?pc.waitAll:pc.synchronizeSlow:pc.none}PH(T,Aa){this.OVm(T)?(this.Zcb=T,this.PNg=Aa,T=Pf.a.createQuery(T.Dg,Zg.a.none),this.gi=window.performance.now(),this.zYa.find(T)):Aa.resultsUpdated(new ad.a(T))}update(){this.Ffo(Math.round(window.performance.now()-this.gi));var T=String.format(CommonUIStrings.l_TextWithQuotation,this.Zcb.Dg);var Aa=l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.Vob?
ei.a.RNa(this.Zcb.Dg,15,this.ZIe):Ta.a.yf(this.Zcb.Dg);const ib=[];ib.push(appChrome.actions.setControlLabel(this.ljd,T));ib.push(appChrome.actions.setCompoundButtonCommandValueId(this.ljd,Aa));ib.push(appChrome.actions.updateCompoundButtonDescription(this.ljd,this.vvf()));appChrome.api.dispatch(ib);T=new wd.a(this.ljd,Td.a.FindInDocument,this.Zcb.Dg,this.zYa.Qj.tja.toString());Aa=new Je.a(Gf.a.FindInDocument);Aa.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;Aa.Ow(T);const Tb=new ad.a(this.Zcb);
Tb.Yu(Aa);window.requestAnimationFrame(()=>{this.PNg.resultsUpdated(Tb)});this.zYa.LZa(!0);this.Gfo(Math.round(window.performance.now()-this.gi))}vvf(){const T=this.zYa.Qj.tja.toString();return"1"===T?String.format(CommonUIStrings.l_SearchResultText,T):String.format(CommonUIStrings.l_SearchResultsText,T)}OVm(T){return!!T&&!!T.Dg&&""!==T.Dg.trim()}Ffo(T){const Aa={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",
["QueryLength"]:this.Zcb.Dg.length};this.sendActivityEvent(Aa,T)}Gfo(T){const Aa={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.Zcb.Dg.length};this.sendActivityEvent(Aa,T)}sendActivityEvent(T,Aa){T=li.a.kz(T);Md.a.xHa(Object.assign(new hk.a,{name:"Latency",dataFields:T,durationMs:Aa}),this.Sld)}}Object(f.a)($h,"WordFindInDocumentWithMatchesProvider",null,[1247]);class Mj{constructor(T,Aa){this.pc=T;this.rXd=
Aa}u2a(T,Aa,ib){return this.rXd.u2a(0,T,Aa,ib)}insertHtmlText(T){return T?32===this.DAf(T):!1}DAf(T){return this.executeCommand(Kg.a.pCa,T)}executeCommand(T,Aa){const ib=new ck.DictionaryPropertySet;ib.setValue(jk.a.iP,Aa);ib.setValue(jk.a.Pia,!1);Aa=this.pc.processAction(T,1);32===Aa&&(Aa=this.pc.Qb(T,2,ib));return Aa}}Object(f.a)(Mj,"WordInsertContentHandler",null,[1983]);class Sj extends Ar{constructor(){super();this.Px=()=>{if(l.AFrameworkApplication.Qig){var T=cb.App.xa.Nb.nuf(n.a.tellMe);T.hUc?
this.r2i():T.VZ(this.nco);var Aa=new Za(()=>!1);gp.TellMeActor.instance.initialize(Aa,null,null,null,null,null,Object(a.a)(cb.App.xa,cb.App.xa.wNd,"forceUpdateRibbonControls"),l.AFrameworkApplication.K,this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.W.Sa("Common.IActionContextProvider"),this.W.Sa("Common.ISystemInitiatedFeedback"));gp.TellMeActor.instance.gVn(T);gp.TellMeActor.instance.hXn(new Mj(l.AFrameworkApplication.va,this.W.Na("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));
Aa.D_h&&Aa.nMd&&gp.TellMeActor.instance.JE(new $h(Aa),pq.a.tellMe)}};this.nco=()=>{this.r2i()}}get name(){return"WordEditor.TellMe"}init(){l.AFrameworkApplication.K.Po(this.Px)}r2i(){cb.App.xa.updateCommandUI()}}Object(f.a)(Sj,"WordEditorTellMePackage",Ar,[]);class rf{constructor(){this.W=null;this.Tyj=(T,Aa,ib)=>{2===ib&&(T=new fc.StandardDialog,T.Ad=0,T.eja(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>
{this.hn()})}dispose(){}hn(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(126)){l.AFrameworkApplication.va.eb(Yg.a.wordTestFeature,Li.a.view,this.Tyj,96);var T=ji.FocusManager.instance().fe(el.AppFrame.JD);Bd.AFrame.yi(T,qf.KeyInputManager.jc(gk.a.R8a,5|qf.KeyInputManager.Qh),Yg.a.wordTestFeature)}}xc(T){this.W=T}static main(){L.a.instance.Fc(new rf)}}Object(f.a)(rf,"WordEditorTestFeaturePackage",null,[1,2]);var Ue=c(106);class of{constructor(T,Aa){this.rgj=T;this.pc=Aa;this.hge=(ib,
Tb,xc,ld,Sd)=>{if(1===xc)return 32;this.rgj.bN(9,Sd,!1);return 32};this.A0=(ib,Tb)=>{if(9===Tb.type){var xc;(ib=Tb.yL)?("string"===typeof ib?xc=ib:"data"===ib.type&&(xc=Ue.a.sNh(ib.NHn,ib.newState,ib.tqo)),xc&&of.XDc(xc)):ra.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.d4c()}d4c(){this.pc.qa(Yg.a.hge,y.a.frame,this.hge);this.rgj.g3(this.A0)}dispose(){}static XDc(T){T=cb.App.xa.notificationBar.Dma(T,!1);T.image=5;T.eoa="CoAuth_AuthorStatus_16x16x32";
cb.App.xa.notificationBar.lA(T)}}Object(f.a)(of,"TrackChangeNotificationActor",null,[]);class Eg{constructor(){this.hj=this.iWe=this.W=null;this.t0c=()=>{if(this.hj=cb.App.uTd().result)this.W.ha("WordEditor.TrackChange.TrackChangeNotificationActor",()=>new of(this.hj,l.AFrameworkApplication.va)).singleInstance(),this.iWe=this.W.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}}get name(){return"WordEditor.TrackChangeNotificationActor"}xc(T){this.W=T}init(){this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>
{this.hn()})}hn(){cb.App.uTd().continueWith(this.t0c)}dispose(){this.iWe&&this.iWe.dispose()}}Object(f.a)(Eg,"WordEditorTrackChangeNotificationActorPackageManager",null,[1,2]);var Ag=c(97),yk=c(1480),Ai=c(2040);class hi{}hi.Wlg="UnsavedChanges";hi.Xlg="UnsavedChangesThemed";hi.Bbo="SavedChanges";hi.AEj="UnsavedChangesOpenPipe";hi.FTo="UnsavedChangesOpenPipeCssClassNameThemed";hi.zEj="UnsavedChangesClosePipe";hi.CTo="UnsavedChangesClosePipeThemed";hi.DTo="UnsavedChanges";hi.ETo="UnsavedChangesThemed";
hi.Ylg="UnsavedChangesIndicatorPositionRef";Object(f.a)(hi,"UnsavedChangesHighlightUtils",null,[]);class gl extends yk.a{constructor(T,Aa){super();this.xea=T;this.ux=Aa;this.s2=[this.ux?new Ai.a(hi.Xlg,hi.ETo):new Ai.a(hi.Wlg,hi.DTo)]}get Vba(){return!0}get Nib(){return 4}get a2a(){return this.s2}yGa(T,Aa){if(this.xea){var ib=this.xea.NNf;if(ib&&ib.count&&ib.contains(T.id))for(T=Aa.TGa("span"),Aa=0;Aa<T.length;Aa++)ib=T[Aa],Aa||ib.classList.add(this.ux?hi.FTo:hi.AEj),Aa===T.length-1&&ib.classList.add(this.ux?
hi.CTo:hi.zEj),ib.classList.add(this.ux?hi.Xlg:hi.Wlg)}}u1a(){}}Object(f.a)(gl,"UnsavedChangesHighlightActor",yk.a,[]);var ql=c(1040);class Nn{constructor(T){this.Dxe=null;this.xea=T;this.dGe=!1}get key(){return"UnsavedChangesHighlight"}get Uw(){return"UnsavedChanges"}reset(T){if(this.xea){T=T.node;if(El.ParagraphReader.Wb(T)){const Aa=this.xea.NNf;if(Aa&&Aa.contains(T.id)){this.dGe=!0;this.Dxe=T.id;return}}this.dGe=!1;this.Dxe=ih.a.nil}}xIa(){let T=null;return this.dGe?(T=Object.assign(new ql.a,
{MG:this.key,contentObject:this.Dxe,description:null}),{returnValue:!0,WF:T}):{returnValue:!1,WF:T}}}Object(f.a)(Nn,"UnsavedChangesHighlightCpContentDetailsProvider",null,[670,671]);class zt{constructor(T,Aa,ib,Tb,xc,ld,Sd){this.r7g=null;this.a6=T;this.$e=Aa;this.rW=ib;this.C6=Tb;this.pjh=xc;this.UYb=ld;this.ux=Sd;this.$e.UMa(this.sY.bind(this))}get NNf(){return this.r7g}Ttm(){if(this.a6){if(1===this.a6.J8e){if(0===this.a6.DIf&&this.a6.iZi()){this.r7g=this.a6.S4d;const T=this.a6.Zad;this.a6.Cbo.forEach(this.fol.bind(this));
T.forEach(this.Utm.bind(this));0<T.length&&this.Rpl(this.rW);return 0}return this.VQn(this.a6.DIf)}return 2}return 1}VQn(T){switch(T){case 0:return this.a6.Ani()?5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}voi(T,Aa,ib){if(Aa)if(ib){ib=Aa.querySelectorAll("span");for(let Tb=0;Tb<ib.length;Tb++){const xc=ib[Tb];Tb||xc.classList.add(hi.AEj);Tb===ib.length-1&&xc.classList.add(hi.zEj);xc.classList.add(this.ux?hi.Xlg:hi.Wlg)}Aa.classList.add(hi.Ylg);T&&this.C6.Omc(T)}else Aa.classList.add(hi.Bbo)}T9b(T,
Aa){const ib=this.mhm(T);if(T&&(T=T.De(Yi.App.xa.ib.rc.fc)))if(T.Fg&&T.Fg.Oi&&0!==T.Fg.Oi.count)for(const Tb of T.Fg.Oi)this.voi(ib,Tb,Aa);else this.voi(ib,T.htmlElement,Aa)}mhm(T){return this.pjh&&(T=this.pjh.dQc(T))&&T&&(T=T.De(Yi.App.xa.ib.rc.fc))?T:null}Utm(T){this.T9b(T,!0);return!0}fol(T){this.T9b(T,!1);return!0}Rpl(T){T&&T.continueWith(()=>{T.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}sY(T,Aa){Aa===Sys.EventArgs.Empty?ra.ULS.sendTraceTag(572364513,
306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):Aa&&Aa.errorCode?this.UYb.gR||(T=this.Ttm(),ra.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",T),Ma.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==T&&4!==T&&this.oNo(T)):ra.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",Aa?"Error Code":"Kickout Event Args")}oNo(T){let Aa;const ib=new ze.a;ib.extendedProperties=new Map;ib.extendedProperties.set("HighlightUnsavedChangesResult",
T.toString());ib.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(T){case 1:case 2:case 6:Aa="HighlightInternalError";break;case 5:Aa="ChangeOutsideCanvas"}6!==T&&5!==T||ib.extendedProperties.set("UnsavedChangesCollectionResult",this.a6.DIf.toString());Aa&&(Ma.Health.instance.recordQosError(Aa,["UnsavedContentNotHighlighted"],!0,!0,!1,!1,ib),Ma.Health.instance.recordKpiFailure("UnsavedChangesHighlight",Aa,!0,!0,ib))}dispose(){this.$e.fNb(this.sY.bind(this))}}Object(f.a)(zt,"UnsavedChangesHighlighter",
null,[10]);var it=c(499),Zx=c(458),Wq=c(1478);class nr extends Wq.a{constructor(T,Aa){super();this.xea=T;this.ux=Aa}Tob(T){if(!this.xea)return!1;const Aa=this.xea.NNf;return Aa?Aa.contains(T.Bb.id)||T.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}RRk(T,Aa){Aa=T.pwa?T.pwa[Aa]?T.pwa[Aa].style?T.pwa[Aa].style.marginLeft:null:null:null;var ib=T.leftMargin;T=1440<=ib?-(ib/1440*96):T.veb(0,96,this.zoom);ib=0;Aa&&(Aa=Aa.match(/^(\d+)px/))&&Aa[1]&&(ib=Number(Aa[1]));return T-ib}vSk(T,Aa,ib){return Sys.UI.DomElement.getBounds(T).y-
ib.bca[Aa].y}HRk(T){return Sys.UI.DomElement.getBounds(T).height}LMh(T,Aa,ib,Tb){let xc;xc=this.RRk(ib,Aa);Aa=this.vSk(T,Aa,ib);T=this.HRk(T);Tb=it.a.createElement(Tb,Zx.a.div);Tb.className=this.ux?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";Tb.style.left=xc+"px";Tb.style.top=Aa+"px";Tb.style.height=T+"px";return Tb}$Lh(T,Aa,ib,Tb){const xc=[],ld=T.querySelectorAll("."+hi.Ylg);if(0===ld.length&&T.classList.contains(hi.Ylg))ib=this.LMh(T,Aa,ib,Tb),ib.Rfa=Aa,xc.push(ib);else for(T=0;T<
ld.length;T++){const Sd=this.LMh(ld[T],Aa,ib,Tb);Sd.Rfa=Aa;xc.push(Sd)}return xc}sfb(T){let Aa=[];var ib=T.O4;const Tb=ib.fh.ownerDocument;if(ib.zj){let xc=0;for(const ld of ib.Fg.Oi)(ib=this.$Lh(ld,xc,T,Tb))&&(Aa=Aa.concat(ib)),xc+=1}else Aa=this.$Lh(ib.htmlElement,0,T,Tb);return Aa}}Object(f.a)(nr,"UnsavedChangesIndicatorActor",Wq.a,[]);class Br{constructor(){this.XV=this.zv=this.yKa=this.C6=this.Dld=this.xea=null}get name(){return"WordEditor.UnsavedChangesHighlight"}xc(){}init(){this.C6=sa.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;
this.xea=new zt(sa.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),Ah.SessionStatusManager.instance,sk.a.zp(sa.a.instance.Sa("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.C6,sa.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),sa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),!!cb.App.instance&&cb.App.instance.Hoa);this.yKa=sa.a.instance.Sa("Box4.Accessibility.IAccessibilityContextManager");this.XV=sa.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;
this.Dld=new nr(this.xea,!!cb.App.instance&&cb.App.instance.Hoa);this.C6.G5a(this.Dld);this.yKa&&this.yKa.execute(T=>{T.Y4(new Nn(this.xea))});this.zv=new gl(this.xea,!!cb.App.instance&&cb.App.instance.Hoa);this.XV.F5a(this.zv)}dispose(){this.C6&&this.Dld&&this.C6.Lne(this.Dld);this.XV&&this.zv&&this.XV.Rlg(this.zv);Ag.a.YB(this.xea)}static main(){L.a.instance.Fc(new Br)}}Object(f.a)(Br,"WordEditorUnsavedChangesHighlightPackage",null,[1,2,10]);var Ns=c(126);class At{constructor(T,Aa,ib){this.ga=T;
this.Vm=Aa;this.Fa=ib}Tb(){this.Fa.$("ZoomPopupDialogIsEnabled")&&(this.ga.qa(n.a.nkc,y.a.frame,Object(a.a)(this.Vm,this.Vm.nkc,"showZoomDialog")),this.ga.eb(n.a.QNn,y.a.frame,Object(a.a)(this.Vm,this.Vm.gXi,"onQueryZoomText"),96),this.ga.qa(n.a.Gcd,y.a.frame,Object(a.a)(this.Vm,this.Vm.xMj,"zoomDialogTabFocusHandler")),this.ga.qa(n.a.Fcd,y.a.frame,Object(a.a)(this.Vm,this.Vm.xMj,"zoomDialogTabFocusHandler")));this.Fa.$("ZoomSliderIsEnabled")&&(this.ga.eb(n.a.j6i,y.a.frame,Object(a.a)(this.Vm,this.Vm.otn,
"onQueryZoomPercentage"),96),this.ga.eb(n.a.zMj,y.a.frame,Object(a.a)(this.Vm,this.Vm.dxn,"onZoomToPercentage"),96),this.ga.qa(n.a.m9o,y.a.frame,Ns.ActionManager.Nf))}}Object(f.a)(At,"CommonZoomActor",null,[936]);class Os extends At{constructor(T,Aa,ib){super(T,Aa,ib);this.lfa=Aa}Tb(){super.Tb();this.Fa.$("ZoomPopupDialogIsEnabled")&&(this.ga.qa(Yg.a.oqg,y.a.frame,Ns.ActionManager.Nf),this.ga.qa(Yg.a.eqe,y.a.frame,Object(a.a)(this.lfa,this.lfa.k9o,"zoomTo100")));this.ga.qa(Yg.a.zoomToPageWidth,y.a.frame,
Object(a.a)(this.lfa,this.lfa.zoomToPageWidth,"zoomToPageWidth"));this.ga.qa(n.a.ajb,y.a.frame,Object(a.a)(this.lfa,this.lfa.ajb,"increaseZoom"));this.ga.qa(n.a.Ifb,y.a.frame,Object(a.a)(this.lfa,this.lfa.Ifb,"decreaseZoom"));this.ga.qa(Yg.a.d$f,y.a.frame,Object(a.a)(this.lfa,this.lfa.eqo,"setZoomLevelFromRibbon"));this.ga.eb(Yg.a.rnb,y.a.frame,Object(a.a)(this.lfa,this.lfa.gXi,"onQueryZoomText"),96);this.ga.eb(Yg.a.oce,Li.a.application,Object(a.a)(this.lfa,this.lfa.ntn,"onQueryZoomLevelLabelText"),
96);this.ga.qa(Kg.a.uOh,y.a.frame,Ns.ActionManager.Nf);this.ga.qa(Kg.a.tOh,y.a.frame,Ns.ActionManager.Nf);this.ga.qa(Kg.a.yOh,y.a.frame,Ns.ActionManager.Nf);this.ga.qa(Kg.a.vOh,y.a.frame,Ns.ActionManager.Nf);this.ga.qa(Yg.a.Fja,y.a.frame,Ns.ActionManager.Nf)}}Object(f.a)(Os,"WordEditorZoomActor",At,[]);class Hq{constructor(T,Aa){this.zoom=T;this.uCk=Aa}}Object(f.a)(Hq,"SetCustomZoomArgs",null,[]);var qq=c(1150);class Xq{constructor(T,Aa){this.Ail=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,
"200%","150%","100%","75%","50%"];this.Bil=[Xq.Lef,Xq.XId,"200","150","100","75","50"];this.Lma=3;this.zN=0;this.delta=.1;this.yJf=0;this.hd=new M.a;this.$h=null;this.K=T;this.pc=Aa;this.Koj(1)}get jj(){return this.zN}Koj(T){this.zN=T}get fJc(){return Math.round(100*this.jj)}get Lhn(){return Math.floor(this.fJc/10)/10+this.delta}get Khn(){return Math.ceil(this.fJc/10)/10-this.delta}get ga(){return l.AFrameworkApplication.va}iAk(T){this.hd.addHandler("ZoomChanged",T)}T2n(T){this.hd.removeHandler("ZoomChanged",
T)}M0(T){this.iAk(T)}Q5a(T){this.T2n(T)}O9i(){}Haj(){}N9i(){}Gaj(){}Hcd(T){this.yMj(T,this.jj)}yMj(T,Aa){null!==T&&Me.a.snj(T,Aa)}ycg(T,Aa=!0){let ib=T*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(ib=new Hq(T,Aa));this.hlj(ib)}dqo(T,Aa=!1){this.Fja(T,3|(Aa?0:4))}axn(T,Aa,ib){if(1===T)return 32;T=ib/100;T<this.zZc?T=this.zZc:T>this.cZc&&(T=this.cZc);this.Fja(T,1);Aa&&(Aa.xs=Math.floor(100*T));return 32}gXi(T,Aa,ib,Tb,xc){if(1===ib)return 32;T=Ta.a.eEa(this.fJc,6,l.AFrameworkApplication.numberFormat);
xc.Value=T;xc.LabelText=T;return 32}dxn(T,Aa,ib,Tb,xc){return 1===ib?32:this.axn(ib,Tb,xc.value)}otn(T,Aa,ib,Tb,xc){xc.MinValue=100*this.zZc;xc.MaxValue=100*this.cZc;xc.value=this.fJc;return 32}gki(){return this.Ail}hki(){return this.Bil}dUl(){let T=Math.floor(100*this.jj).toString();1===this.Lma?T=Xq.Lef:2===this.Lma&&(T=Xq.XId);return T}ajb(T,Aa,ib){if(1===ib)return 32;this.CYc(this.pc?this.pc.xC:0,"IncreaseZoom");this.Lma=0;this.Fja(this.Lhn);return 32}Ifb(T,Aa,ib){if(1===ib)return 32;this.CYc(this.pc?
this.pc.xC:0,"DecreaseZoom");this.Lma=0;this.Fja(this.Khn);return 32}eqo(T,Aa,ib,Tb,xc){if(1===ib)return 32;this.CYc(this.pc?this.pc.xC:0,"SetZoomLevelFromRibbon");T=xc.Value;if(T.toLowerCase().startsWith("fit"))return T=new Qc.a(0,1,0,()=>{this.zoomToPageWidth(0,null,2,null,null)},138,void 0,!0),nl.a.instance.Vb(T),32;T=parseInt(T)/100;if(isNaN(T))return 2;this.Lma=0;this.Fja(T);return 32}CYc(T,Aa){ra.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",
T,Aa,l.AFrameworkApplication.ta.Nb.yr)}nkc(T,Aa,ib){if(1===ib)return 32;ra.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const T=this.dUl();this.$h=new qq.a(this.gki(),this.hki(),Object(a.a)(this,this.nqm,"handleZoomDialogResult"),ji.FocusManager.instance(),!0);this.$h.nkc(CommonUIStrings.l_ZoomDialogTitle,T)}UJm(T){return T.toLowerCase()===Xq.Lef.toLowerCase()}VJm(T){return T.toLowerCase()===Xq.XId.toLowerCase()}nqm(T){if(T){if(this.UJm(T)){this.Lma=
1;var Aa=32}else if(this.VJm(T))this.Lma=2,Aa=this.zoomToPageWidth(0,null,2,null,null);else if(Aa=Number.parseInvariant(T)){this.Lma=0;let ib=Aa;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(ib=new Hq(Aa,!0));Aa=this.hlj(ib)}else Aa=8;32===Aa?ra.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:T}):ra.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:T})}else ra.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:T})}TPn(){this.hd.raiseEvent("ZoomChanged",
null)}N6i(){}T2f(){}xMj(T){if(!this.$h)return 2;var Aa=this.$h.focusManager.Ts().fk.y3;if(Aa===this.$h.Rz&&T===n.a.Gcd||Aa===this.$h.$G&&T===n.a.Fcd)this.$h.ezb||this.$h.odo(),this.$h.focusManager.Ts().fk.Ly(this.$h.ezb);else if(Aa.id.startsWith(this.$h.E3c)||Aa.className.startsWith(this.$h.r6i))Aa=null,T===n.a.Gcd?Aa=this.$h.$G:T===n.a.Fcd&&(Aa=this.$h.Rz),this.$h.focusManager.Ts().fk.Ly(Aa),Sys.UI.DomElement.removeCssClass(this.$h.ezb.parentNode,this.$h.I2f);else if(T===n.a.Gcd)this.$h.focusManager.Ts().jec();
else if(T===n.a.Fcd)this.$h.focusManager.Ts().hec();else return 2;return 32}}Xq.Lef="FullPage";Xq.XId="PageWidth";Object(f.a)(Xq,"ZoomManager",null,[817]);var Tr;(function(T){T[T.manual=0]="manual";T[T.fitToFullPage=1]="fitToFullPage";T[T.fitWidth=2]="fitWidth";T[T.onBoot=3]="onBoot"})(Tr||(Tr={}));Object(f.b)("ZoomStatus",Tr);c(1062);var Cr;(function(T){T[T.normal=0]="normal";T[T.quiet=1]="quiet";T[T.disableScrollUpdate=2]="disableScrollUpdate";T[T.disableUiControlUpdate=4]="disableUiControlUpdate"})(Cr||
(Cr={}));Object(f.b)("ZoomUpdateFlags",Cr);var Yq=c(239),Tk=c(326),jt=c(1200);class mu extends Xq{constructor(T,Aa,ib,Tb,xc,ld,Sd,df){super(T,Aa);this.l9o=df;this.L5o=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.M5o=[Xq.XId,"200","150","125","100","75","50"];this.aXe=this.wej=!1;this.BMg="AutoFitForAdaptiveLayout";this.O3j="FitPageWidthFailure";this.vok="UpdateZoomFailure";this.Rpk="wwf";this.qYe=null;this.S8i=()=>{this.Lma===Tr.fitWidth&&this.glf()};this.Pgl=De=>{if(De.ctrlKey){l.AFrameworkApplication.va.processAction(Kg.a.vOh,
2);De=De.O4o;if(!De)return!1;this.Fja(this.jj-(0<De?.1:-.1));this.CYc(6,"CtrlScroll");return!0}return!1};this.bxn=()=>{ra.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};this.lQ=ib;this.sk=Tb;this.Ub=xc;this.ig=ld;this.Ptc=Sd;this.p3g=T.$("KeepViewAfterZoomIsEnabled");this.Spk=T.$("ZoomShortCutIsEnabled");this.Jok=T.$("DoNotAutoScrollAfterPinchIsEnabled");this.B8j=(this.fFe=T.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&T.$("AutoFitForSmallScreenModeIsEnabled");
this.W1j=T.$("DoNotProcessUpdateZoomActionIsEnabled");this.Tpk=T.$("ZoomSliderIsEnabled");this.Fz()}get appName(){return"WordEditor"}get cZc(){return 4}get zZc(){return.1}get Qgl(){return wacBoot.CtrlWheelMetrics}xzk(T){this.hd.addHandler("PinchStart",T)}J2n(T){this.hd.removeHandler("PinchStart",T)}wzk(T){this.hd.addHandler("PinchEnd",T)}I2n(T){this.hd.removeHandler("PinchEnd",T)}get TJ(){return null!=this.fHg?this.fHg:this.fHg=sa.a.instance.Na("WordEditor.IStatusBarUser")}zIj(T){T=!(T&Cr.disableUiControlUpdate);
const Aa=kb.a.get_instance().isCompleted(7);return T&&Aa?(T={SelectZoomOption:"ComboBoxModel"},cb.App.xa&&cb.App.xa.WG(T),this.i0o(),!0):!1}Fja(T,Aa=Cr.normal){let ib=!0;this.W1j||l.AFrameworkApplication.va.processAction(Yg.a.Fja,2);if(this.jj===T)return this.aXe||(this.aXe=this.zIj(Aa)),ib;T>this.cZc?T=this.cZc:T<this.zZc&&(T=this.zZc);var Tb=!!(Aa&Cr.quiet);1===T||Tb||l.AFrameworkApplication.va.processAction(Yg.a.oqg,2);try{Tb=null;cb.App.xa&&Object(Lm.a)(jt.PageView,cb.App.xa.ib.rc)&&(Tb=cb.App.xa.ib.rc);
let xc=-1,ld=-1,Sd=-1;const df=!(Aa&Cr.disableScrollUpdate);this.p3g&&df&&(xc=$e.SelectionEditor.ujm(Ui.a.instance.gb.kb,Tb),ld=Tb.rL.scrollLeft,Sd=Tb.rL.scrollTop);const De=this.jj;this.Koj(T);this.TPn();this.aXe=this.zIj(Aa);df&&this.LZo(Tb,xc,ld,Sd,De)}catch(xc){ib=!1,ra.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",xc)}return ib}LZo(T,Aa,ib,Tb,xc){T&&T.isActive?this.p3g?0<=Aa&&100>=Aa?T.Ps.e5(100-Aa,!0,!0):T.Ps.tXm(ib,Tb,xc,this.jj):T.Ps.e5():ra.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}k9o(T,
Aa,ib){2===ib&&(this.CYc(this.pc?this.pc.xC:0,"ZoomTo100"),this.Lma=Tr.manual,this.Fja(1));return 32}hlj(T){this.Lma=Tr.manual;let Aa,ib=!0;if(this.Jok){if(!Object(Lm.a)(Hq,T))return ra.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;Aa=T.zoom/100;ib=T.uCk}else Aa=Number.parseInvariant(String.format("{0}",T))/100;ra.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",Aa);T=Cr.normal;ib||(T=Cr.disableScrollUpdate);this.Fja(Aa,T);return 32}zoomToPageWidth(T,
Aa,ib){if(1===ib)return 32;ra.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(mc.a)("ZoomToPageWidth",!0);this.Lma=Tr.fitWidth;this.$wl();return this.glf()}ntn(T,Aa,ib,Tb,xc){if(1===ib)return 32;T=Ta.a.eEa(this.fJc,6,l.AFrameworkApplication.numberFormat);xc[Yq.a.labelText]=T;return 32}gki(){return this.L5o}hki(){return this.M5o}$wl(){this.wej||(cb.App.xa?(cb.App.xa.WZ(this.S8i),this.wej=!0):ra.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}glf(){if(this.l9o){var T=
this.lQ.LPd();if(!T)return 8;for(var Aa=0;T;)Aa=Math.max(Aa,No.a.instance.At(T)),T=this.lQ.dPc(T);this.qTh(Aa);return 32}if((Aa=cb.App.xa?cb.App.xa.ib.rc:null)&&cb.App.xa.kD){T=null;(Aa=this.$Tl(Aa))&&(T=this.lQ.GJ(Aa));T||(T=this.lQ.LPd());if(null!==T)return this.qTh(No.a.instance.At(T)),32;ra.ULS.sendTraceTag(7185433,353,10,"Zoom to page width: cannot find word section node.")}else ra.ULS.sendTraceTag(7185434,353,10,"Zoom to page width: cannot find editing view node.");return 8}qTh(T){T=Um.a.Ji(T,
0);const Aa=this.Ptc();T+=Aa&&Aa.nie()?wacBoot.ShiftUtils.getFloatingObjectsContainerWidth():0;T+=2*Tk.a.Npg;this.Fja(cb.App.xa.kD.offsetWidth/T)}$Tl(T){return T&&T.lb&&T.lb.gb.kb&&T.lb.gb.kb.Oa&&T.lb.gb.kb.Oa.node?T.lb.gb.kb.Oa.node:null}i0o(){this.TJ&&(this.Tpk?(this.TJ.OU(Xl.a.f9o),this.TJ.OU(Xl.a.h9o)):this.TJ.OU(Xl.a.i9o))}qEo(T){T||(T=window.self.CtrlWheelMetrics);if(T){var Aa=T.ctrlWheelOccurred;if("boolean"!==typeof Aa)ra.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");
else{ra.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",Aa);try{T.stop()}catch(ib){ra.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",ib)}}}else ra.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}Fz(){this.qEo(this.Qgl);if(this.sk){var T=document.getElementById(el.AppFrame.BJd);T&&this.sk.nb(W.a.Clb,T,this.Pgl)}this.Ub&&(T=this.Ub.fe(el.AppFrame.JD),this.Spk&&(T.bindAction(qf.KeyInputManager.jc(gk.a.enc,qf.KeyInputManager.Qh),n.a.ajb),T.bindAction(qf.KeyInputManager.jc(gk.a.Ubd,
qf.KeyInputManager.Qh),n.a.ajb),T.bindAction(qf.KeyInputManager.jc(gk.a.fnc,qf.KeyInputManager.Qh),n.a.Ifb),T.bindAction(qf.KeyInputManager.jc(gk.a.hnc,qf.KeyInputManager.Qh),n.a.Ifb),T.bindAction(qf.KeyInputManager.jc(gk.a.Hdd,qf.KeyInputManager.Qh),Yg.a.eqe)));this.ig&&(this.qYe=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.ig.nb(W.a.click,this.qYe,this.bxn);this.B8j&&(cb.App.xa.GI.registerLayoutBreakpointChanged("canvas",Aa=>{this.j3e(Aa)}),cb.App.xa.GI.registerBoundingWindowRectsChanged("canvas",
()=>{this.j3e(cb.App.xa.GI.getLayoutBreakpoint())}))}j3e(T){let Aa=!0,ib="";if(this.Lma!==Tr.onBoot)return Aa;Ma.Health.instance.recordKpiUsage(this.BMg,0,this.Rpk,null);switch(T){case "Small":8===this.glf()&&(ib=this.O3j,Aa=!1);break;default:1===this.jj||this.Fja(1)||(ib=this.vok,Aa=!1)}Aa||Ma.Health.instance.recordKpiFailure(this.BMg,ib,!0,!0,null);return Aa}O9i(T){this.xzk(T)}Haj(T){this.J2n(T)}N9i(T){this.wzk(T)}Gaj(T){this.I2n(T)}N6i(){this.hd.raiseEvent("PinchStart",null)}T2f(){this.hd.raiseEvent("PinchEnd",
null)}}Object(f.a)(mu,"WordEditorZoomManager",Xq,[1961,817]);class $x{constructor(){this.W=null}get name(){return"WordEditor.Zoom"}init(){if(l.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const T=this.W.resolve("WordEditor.Zoom.WordEditorZoomActor"),Aa=this.W.resolve("WordEditor.Zoom.WordEditorZoomManager");T.Tb();Sys.UI.DomElement.overrideGetBounds=!0;l.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&l.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&
Aa&&kb.a.get_instance().Ak(4,()=>{Aa.j3e(cb.App.xa.GI.getLayoutBreakpoint())||ra.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}xc(T){this.W=T;l.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&(this.W.ha("WordEditor.Zoom.WordEditorZoomManager",()=>new mu(l.AFrameworkApplication.K,l.AFrameworkApplication.va,fp.WordSectionNavigator.instance,kk.a.instance,ji.FocusManager.instance(),Hn.a.instance,()=>T.Na("Box4.IFloatingObjectUpdater"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleOrientationZoomToFitBugFix",
!1))).singleInstance().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),this.W.ha("WordEditor.Zoom.WordEditorZoomActor",()=>new Os(l.AFrameworkApplication.va,this.W.resolve("WordEditor.Zoom.WordEditorZoomManager"),l.AFrameworkApplication.K)).singleInstance())}static main(){L.a.instance.Fc(new $x)}}Object(f.a)($x,"ZoomPackage",null,[1,2]);var nu=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",
Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},
children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",
LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",
Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",
AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},
children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},
{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",
Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",
Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",
attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},
children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]};class vp extends bk.a{constructor(T){var Aa;super("DocumentOwnerConditionId");this.Hn=
T.Hn;this.cdg=null!==(Aa=T.cdg)&&void 0!==Aa?Aa:!0}initialize(){super.initialize();const T=l.AFrameworkApplication.K;T.Po(()=>{const Aa=T.$("IsDocumentOwner");this.Sg(Aa===this.cdg)})}Sg(T){super.Sg(T);ra.ULS.sendTraceTag(508958623,3028,50,this.sT(this.Hn,T))}}Object(f.a)(vp,"DocumentOwnerCondition",bk.a,[]);var En=c(1741);class Fu extends Il.a{constructor(T){var Aa=new bj({Hn:23,s0a:"Microsoft.Office.WordOnline.CopilotSummarySkittle"});const ib=new bj({Hn:23,s0a:"Microsoft.Office.WordOnline.CopilotPaneEnabled"}),
Tb=new vp({Hn:23,cdg:!1});Aa=new jb.a([Aa,ib,Tb]);l.AFrameworkApplication.ue("f5gia801;0f27g313");l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSkittleSummaryGenerationSkipped",!1)&&(T=new En.a({Hn:23},T),Aa.add(T));super(23,Aa,null,3028,"CopilotSummarySkittleInitTriggered")}}Object(f.a)(Fu,"CopilotSummarySkittleInitTriggerModel",Il.a,[]);var $u={get interop(){var T=null===copilotSummarySkittleUx||void 0===copilotSummarySkittleUx?void 0:
copilotSummarySkittleUx.interop;if(!T)throw Error("copilotSummarySkittleUx chunk is accessed before loading");return T}};class or{constructor(T,Aa){this.mGd=T;this.u6c=Aa;this.DGa=async(ib,Tb)=>{if(Tb.JY){Object(mc.a)("CopilotSummarySkittleInitializationTriggered");this.mGd.bda(this.DGa);this.mGd.Nd();try{const [,xc]=await Promise.all([this.v1m(),Promise.all([c.e(2),c.e(28)]).then(c.bind(null,2077))]);xc.main($u.interop)}catch(xc){ra.ULS.sendTraceTag(508944738,3047,10,"Failed to load CopilotSummarySkittleUxChunk/CopilotSummarySkittlePackage")}}}}initialize(){this.mGd.f3(this.DGa);
this.mGd.initialize()}async v1m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("copilotSummarySkittleUx"):(await Object(Dg.c)(this.u6c)).Uz.loadScript("copilotSummarySkittleUx")}}Object(f.a)(or,"CopilotSummarySkittleInitializer",null,[]);class uw extends Di.a{get name(){return"WordEditor.Copilot.SummarySkittle.Entry"}W7(T){this.container=T}Y7(){(new or(new Fu(this.container.resolve("WordEditor.WordCount.IWordCountManagerFactory")),this.container.Sa("Common.IDynamicScriptLoaderProvider"))).initialize()}X7(){}static main(){l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSummarySkittle",
!1)&&L.a.instance.Fc(new uw)}}Object(f.a)(uw,"CopilotSummarySkittleEntryPackage",Di.a,[]);var Dv=c(1778),Ev=c(1772);class Vg{static get isEnabled(){return Object(Dg.b)("Microsoft.Office.WordOnline.IsCopilotComposeEnabled")}}Object(f.a)(Vg,"CopilotComposeFeatureCondition",null,[]);const Po=new ri(()=>Promise.all([c.e(2),c.e(5),c.e(24)]).then(c.bind(null,2070)).then(T=>T.instance));class Yo{constructor(T){this.Mpg=T}initialize(){this.Cql().catch(T=>{ra.ULS.dD(508913495,3048,10,T,"Failed to initialize CopilotCompose")})}async Cql(){await Promise.all([Po.J3(),
this.Mpg.loadChunk("copilotComposeUx")]);await Po.wgb()}}Object(f.a)(Yo,"CopilotComposeInitializer",null,[]);var Al=c(1039);class Bt extends Al.a{placeholderField(T){return new Jp(T)}}Object(f.a)(Bt,"CopilotComposeDataFieldsFactoryImpl",Al.a,[]);class Jp extends Wc.a{constructor(T){super();this.name="placeholder";this.string=T}}Object(f.a)(Jp,"PlaceholderDataField",Wc.a,[]);var fn=c(942);class ou extends fn.a{constructor(T){super(T,"CopilotCompose");this.fieldsFactory=new Bt}}Object(f.a)(ou,"CopilotComposeTelemetryLoggerImpl",
fn.a,[]);class is extends Di.a{constructor(){super(...arguments);this.name="WordEditor.Copilot.ComposeEntry"}W7(T){T.ha("WordEditor.Copilot.Compose.CopilotComposeTelemetryLogger",()=>new ou(T.resolve("Wac.Common.Utils.IOtelWrapper"))).singleInstance()}Y7(){const T=sa.a.instance;T.resolve("WordEditor.Copilot.Compose.CopilotComposeTelemetryLogger").measureActivityPerformance(()=>{(new Yo(T.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"))).initialize()},{name:"Initialize"})}X7(){}static main(){Vg.isEnabled&&
L.a.instance.Fc(new is)}}Object(f.a)(is,"CopilotComposeEntryPackage",Di.a,[]);Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");
Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");$k.main();Type.registerNamespace("Common.App.AccessibilityChecker");
Type.registerNamespace("Common.App.Assistance");Q;Type.registerNamespace("CACPU");Ha.main();Type.registerNamespace("CAEventTimingMeter");eb.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Mb.main();Type.registerNamespace("Common.App.GestureInput");Sa.main();Type.registerNamespace("Common.App.GestureManager");Pa.main();Type.registerNamespace("Common.ModernFontPicker");null==l.AFrameworkApplication.K||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableOfflineLogger",
!1)||(Type.registerNamespace("Common.App.OfflineLogger"),L.a.instance.Fc(new Ve));Type.registerNamespace("Common.App.O365Shell");sb.main();Type.registerNamespace("Common.App.PhoneLink");Dd.main();Type.registerNamespace("Common.App.SensitiveLogging");Fk.main();Type.registerNamespace("Common.App.Rename");L.a.instance.Fc(new ej,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");L.a.instance.Fc(new Sf);Type.registerNamespace("Common.App.SaveAsToHost");Yk.main();Type.registerNamespace("Common.App.SaveToCloudStorage");
tg.main();Type.registerNamespace("Common.App.SaveACopy");Qj.main();Type.registerNamespace("Common.App.SaveToSharePoint");Tf.main();Type.registerNamespace("Common.App.SharedFilePicker");vh.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");Cd.main();bn;L.a.instance.Fc(new Gq);ng.main();nu;og.main();L.a.instance.Fc(new sp);
Zi.main();yq.a.prototype.toString=zq.a.prototype.toString;yr.a.fli=new Aq.a;L.a.instance.Fc(new Un);$x.main();L.a.instance.Fc(new Sg);L.a.instance.Fc(new Fq);L.a.instance.Fc(new Sj);rf.main();tn.main();Nl.main();Br.main();Type.registerNamespace("NLRT");L.a.instance.Fc(new tk);Type.registerNamespace("Common.App.AccessibilitySettings");N.main();L.a.instance.Fc(new Eg);qh.main();$n.main();mj.main();Kn.main();uw.main();is.main();null!=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SwitchRDLMToSliceTwo",
!1)&&Dv.a.main();null!=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SwitchLSTHMToSliceTwo",!1)&&Ev.a.main();window.EventTiming={EventTimingMeter:pl,FrameTimingMeter:Xf}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19794043/wdjs/WordEditorDSVersionHistoryRemoved.box4.dll2.js.map