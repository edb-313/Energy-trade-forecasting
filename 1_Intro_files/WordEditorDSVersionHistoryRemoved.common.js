/*
 Microsoft Corporation. All rights reserved.
*/
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1493:function(F,K,c){c.d(K,"a",function(){return n});F=c(0);var l=c(2),f=c(1972),a=c(48),k=c(7),x=c(1624),y=c(1582);class n{static TIa(u,z){u||(k.ULS.sendTraceTag(16795331,369,10,"The {0} root node should not be null.",z),n.fg())}static lnc(u,z){u&&u.count||(k.ULS.sendTraceTag(16795332,369,10,"The list of {0} objects should not be null or empty.",z),n.fg())}static D1(u,z){n.TIa(u,z);u.isConnected||(k.ULS.sendTraceTag(16795333,
369,15,"The accessed node is no longer connected to the graph in class: {0}.",z),n.Zk())}static Ux(u,z){null===u&&(k.ULS.sendTraceTag(16847773,369,10,"The {0} value should not be null.",z),n.nd())}static mnc(u,z){u&&""!==u||(k.ULS.sendTraceTag(17056035,369,10,"The {0} value should not be null or empty.",z),n.nd())}static wUa(u,z){if(null===u||0>=u)k.ULS.sendTraceTag(17040545,369,10,"{0} is with not supported value: {1}.",z,u),n.nd()}static vUa(u,z){if(null===u||0>u)k.ULS.sendTraceTag(20534342,369,
10,"Set {0} with not supported value: {1}.",z,u),n.nd()}static BP(u){if("number"===typeof u)return u;n.nd();return 0}static RIa(u,z,w){n.mnc(u,z);var E=f.a.zua(u);E=""!==E?E:u;"#"!==E.charAt(0)&&(E="#"+E);let G=!1;if(7>E.length)G=!0;else for(let H=1;7>H;H++){const L=E.charAt(H);if(!("0"<=L&&"9">=L||"A"<=L&&"F">=L||"a"<=L&&"f">=L)){G=!0;break}}if(G)throw k.ULS.sendTraceTag(19240924,369,15,"AppId:{0}, Set {1} with not supported argument: {2}.",w.appId,z,u),OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.invalidArgument,
WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);return n.vHn(E)}static vHn(u){return u.substring(5,7)+u.substring(3,5)+u.substring(1,3)}static KM(u,z,w=0,E=!0){k.ULS.sendTraceTag(17576160,369,50,"{0}",{["MethodName"]:u,["BlobSize"]:w,["Latency"]:z,["ExecutionStatus"]:E})}static jN(u){return(new Date).getTime()-u}static fg(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.generalException,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_GeneralException);}static nd(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.invalidArgument,
WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);}static zk(u=""){if("Getter"!==u)throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notImplemented,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotImplemented);}static Vpb(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.dzb,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_AccessDenied);}static Zk(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.JWm,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_ItemNotFound);
}static zjg(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notSupported,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotSupported);}static Llc(u,z,w="",E=""){u="AppId:"+u+",";u=(""!==w?u+("Property"+w):u+"Method")+(":"+z+", currently is not allowed on Word Wac");""!==E&&(u+=" for Parameter:"+E);k.ULS.sendTraceTag(19415938,369,15,u);"Getter"!==w&&n.iD()}static iD(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notAllowed,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotAllowed);
}static IKo(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.qyn,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_OperationCancelled);}static wi(){return l.AFrameworkApplication.K.$("WordEditorExtensionRichApi_1_3_Enabled")}static wcd(){return l.AFrameworkApplication.K.$("WordEditorContentControlUserEditingIsEnabled")}static Gpe(){return l.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")}static get vza(){return a.a.CZf}static ZHc(u){u=(u||
"").replace(RegExp("\\r","g"),"\\r");u=u.replace(RegExp("\\n","g"),"\\n");return u=u.replace(RegExp("\\v","g"),"\\v")}static Akc(u){return u.split(RegExp("\r\n|\r|\n"))}static Q8i(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorFontEnabled",!1)}static X3f(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorHyperlinkEnabled",!1)}static yUn(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorRangeTextEnabled",
!1)}static sua(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",!1)}static K5o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CustomXmlPartApiIsEnabled",!1)}static KFl(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixGetHtmlStyleBug",!1)}static JIh(){var u;l.AFrameworkApplication.ue("46ab6280;fg4g7862");return null===(u=l.AFrameworkApplication.K)||void 0===u?
void 0:u.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContentControlEventApiEnabled",!1)}static jlf(){l.AFrameworkApplication.ue("241fi198;754i3702");return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixFtnEtnClearFormat",!1)}static YMc(){l.AFrameworkApplication.ue("0cdc8638;0cdc8638");return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FtnEtnBodyEnabled",!1)}static KLj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocumentInsertFileFromBase64ApiIsEnabled",
!1)}static O5o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecognizeCCWhenTrackchangesONOrOFF",!1)}static N5o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InlineContentControlIsValidEnabled",!1)}static jOh(){var u;l.AFrameworkApplication.ue("aa6dc483;d84c1847");return null===(u=l.AFrameworkApplication.K)||void 0===u?void 0:u.getBooleanFeatureGate("Microsoft.Office.WordOnline.CrossFtnEtnNodeEnabled",!1)}static Q5o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetrieveStylesApiIsEnabled",
!1)}static Lwj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StyleAPIEnabled",!1)}static iLc(u){null!==u&&void 0!==u&&u.length&&u.some(z=>-1===n.M$c(z))&&n.nd()}static wif(u,z){null!=u&&(u=n.M$c(u),k.ULS.sendTraceTag(509616404,369,50,`${z}.insertContentControl(${x.a[u]})`),-1===u&&n.nd())}static M$c(u,z=-1){switch(u){case 96:return 1;case 31:return 0;default:return z}}}n.$kb="\r";n.JVh=new Map([[7,"\u0002"],[6,"\x0B"],[8,"\f"],[12,"\t"]]);n.Qha=9;Object(F.a)(n,
"Utility",null,[])},1503:function(F,K,c){c.d(K,"f",function(){return w});c.d(K,"e",function(){return E});c.d(K,"d",function(){return G});c.d(K,"g",function(){return H});c.d(K,"h",function(){return L});c.d(K,"a",function(){return I});c.d(K,"j",function(){return N});c.d(K,"i",function(){return Q});c.d(K,"c",function(){return M});c.d(K,"b",function(){return J});var l=c(56),f=c(7),a=c(1511);c.n(a);F=[{role:2,roleType:a.RoleType.Title},{role:3,roleType:a.RoleType.Subtitle},{role:4,roleType:a.RoleType.Heading1},
{role:5,roleType:a.RoleType.Heading2},{role:6,roleType:a.RoleType.Heading3},{role:7,roleType:a.RoleType.Heading4},{role:8,roleType:a.RoleType.Heading5},{role:9,roleType:a.RoleType.Heading6},{role:10,roleType:a.RoleType.Heading7},{role:11,roleType:a.RoleType.Heading8},{role:12,roleType:a.RoleType.Heading9},{role:15,roleType:a.RoleType.ListItem},{role:13,roleType:a.RoleType.BodyText},{role:14,roleType:a.RoleType.Caption}];K=[{role:1,QG:{default:"Unknown",DJ:null}},{role:2,QG:{default:"Title",DJ:Box4Intl.Box4Strings.L_StyleWordTitle}},
{role:3,QG:{default:"Subtitle",DJ:Box4Intl.Box4Strings.L_StyleWordSubtitle}},{role:4,QG:{default:"Heading1",DJ:Box4Intl.Box4Strings.L_StyleWordHeading1}},{role:5,QG:{default:"Heading2",DJ:Box4Intl.Box4Strings.L_StyleWordHeading2}},{role:6,QG:{default:"Heading3",DJ:Box4Intl.Box4Strings.L_StyleWordHeading3}},{role:7,QG:{default:"Heading4",DJ:Box4Intl.Box4Strings.L_StyleWordHeading4}},{role:8,QG:{default:"Heading5",DJ:Box4Intl.Box4Strings.L_StyleWordHeading5}},{role:9,QG:{default:"Heading6",DJ:Box4Intl.Box4Strings.L_StyleWordHeading6}},
{role:10,QG:{default:"Heading7",DJ:Box4Intl.Box4Strings.L_StyleWordHeading17}},{role:11,QG:{default:"Heading8",DJ:Box4Intl.Box4Strings.L_StyleWordHeading8}},{role:12,QG:{default:"Heading9",DJ:Box4Intl.Box4Strings.L_StyleWordHeading9}},{role:13,QG:{default:"BodyText",DJ:Box4Intl.Box4Strings.L_StyleWordNormal}},{role:14,QG:{default:"Caption",DJ:Box4Intl.Box4Strings.L_StyleWordCaption}},{role:15,QG:{default:"ListItem",DJ:null}},{role:16,QG:{default:"SubtleEmphasis",DJ:Box4Intl.Box4Strings.L_StyleWordSubtleEmphasis}},
{role:17,QG:{default:"Emphasis",DJ:Box4Intl.Box4Strings.L_StyleWordEmphasis}},{role:18,QG:{default:"IntenseEmphasis",DJ:Box4Intl.Box4Strings.L_StyleWordIntenseEmphasis}},{role:19,QG:{default:"Strong",DJ:Box4Intl.Box4Strings.L_StyleWordStrong}},{role:20,QG:{default:"Quote",DJ:Box4Intl.Box4Strings.L_StyleWordQuote}},{role:21,QG:{default:"IntenseQuote",DJ:Box4Intl.Box4Strings.L_StyleWordIntenseQuote}},{role:22,QG:{default:"SubtleReference",DJ:Box4Intl.Box4Strings.L_StyleWordSubtleReference}},{role:23,
QG:{default:"IntenseReference",DJ:Box4Intl.Box4Strings.L_StyleWordIntenseReference}},{role:24,QG:{default:"BookTitle",DJ:Box4Intl.Box4Strings.L_StyleWordBookTitle}},{role:25,QG:{default:"NoSpacing",DJ:Box4Intl.Box4Strings.L_StyleWordNoSpacing}}];const k=new Map(K.map(V=>[V.QG.default,V.role])),x=new Map(K.map(V=>[V.role,V.QG.default])),y=new Map(K.map(V=>[V.role,V.QG.DJ])),n=new Map(F.map(V=>[V.roleType,V.role])),u=new Map(F.map(V=>[V.role,V.roleType])),z=(V,X,W)=>V.has(X)?V.get(X):W,w=V=>z(k,V,1),
E=V=>z(n,V,1),G=V=>z(u,V,a.RoleType.Unknown),H=V=>z(x,V,"Unknown"),L=V=>z(y,V,null),I=V=>{switch(V){case 4:return 0;case 5:return 1;case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:return 8;default:return 9}},N=V=>{switch(V){case 13:return"Normal";case 1:return"Unknown";case 4:return"Heading 1";case 5:return"Heading 2";case 2:return"Title";case 15:return"List Paragraph";case 3:return"Subtitle";case 14:return"Caption";case 6:return"Heading 3";
case 7:return"Heading 4";case 8:return"Heading 5";case 9:return"Heading 6";case 10:return"Heading 7";case 11:return"Heading 8";case 12:return"Heading 9";case 16:return"Subtle Emphasis";case 17:return"Emphasis";case 18:return"Intense Emphasis";case 19:return"Strong";case 20:return"Quote";case 21:return"Intense Quote";case 22:return"Subtle Reference";case 23:return"Intense Reference";case 24:return"Book Title";case 25:return"No Spacing";default:return"Unknown"}},Q=V=>{switch(V){case 13:return l.StyleReader.wordStyleIdNormal;
case 4:return l.StyleReader.wordStyleIdHeading1;case 5:return l.StyleReader.wordStyleIdHeading2;case 2:return l.StyleReader.D8a;case 15:return l.StyleReader.wordStyleIdListParagraph;case 3:return l.StyleReader.Cnc;case 6:return l.StyleReader.wordStyleIdHeading3;case 7:return l.StyleReader.w8a;case 8:return l.StyleReader.x8a;case 9:return l.StyleReader.y8a;case 10:return l.StyleReader.Pqb;case 11:return l.StyleReader.Qqb;case 12:return l.StyleReader.z8a;case 16:return l.StyleReader.C8a;case 17:return l.StyleReader.GUa;
case 18:return l.StyleReader.A8a;case 19:return l.StyleReader.Upg;case 20:return l.StyleReader.PRb;case 21:return l.StyleReader.B8a;case 22:return l.StyleReader.Vpg;case 23:return l.StyleReader.Tpg;case 24:return l.StyleReader.Spg;case 25:return l.StyleReader.ORb;case 14:return l.StyleReader.$Lj;default:return f.ULS.sendTraceTag(512274639,3016,50,"Style ID not supported for role "+H(V)),"Unknown"}},M=V=>{switch(V){case 18:case 21:case 23:return!0;default:return!1}},J=V=>4<=V&&12>=V},1505:function(F,
K,c){c.d(K,"a",function(){return k});F=c(0);var l=c(2),f=c(1813),a=c(19);class k{static I9h(){return k.pAk+"_"+f.a.CRc+"_"+a.a.XW(l.AFrameworkApplication.userName)+"_"}static c4h(x){return x+"_"+f.a.CRc+"_"+a.a.XW(l.AFrameworkApplication.userName)+"_"}static Vei(){return k.GIn+"_"+f.a.CRc+"_"+a.a.XW(l.AFrameworkApplication.userName)+"_"}}k.Qla="ack0";k.Rla="ack1";k.cAd="ack2";k.pAk="ack3";k.hEc="ack4";k.irh="ack7";k.PIf="ack8";k.Prj="ack9";k.k3e="ack10";k.Orj="ack13";k.PFi="ack14";k.X0b="AddinDetailsRefreshed";
k.nAk="DdaMethod";k.mAk="ControlId";k.eAd="OsfcontrolId";k.o0e="SecurityOrigin";k.Z0b="ak0";k.uAk="ak1";k.lrh="ak2";k.iEc="ak4";k.hrh="Office.AutoShowTaskpaneWithDocument";k.jrh="value";k.tAk="errorCode";k.dtl="SourceControlId";k.btl="OsfControl";k.ctl="RibbonUpdaterData";k.ame="AddinShared";k.GIn="__OSF_PRIVATECATALOG_ADDINIDS";Object(F.a)(k,"AddinConstantsString",null,[])},1506:function(F,K,c){c.d(K,"c",function(){return H});c.d(K,"b",function(){return L});c.d(K,"t",function(){return N});c.d(K,
"r",function(){return J});c.d(K,"q",function(){return V});c.d(K,"g",function(){return X});c.d(K,"d",function(){return W});c.d(K,"o",function(){return U});c.d(K,"n",function(){return Y});c.d(K,"a",function(){return ba});c.d(K,"e",function(){return aa});c.d(K,"i",function(){return fa});c.d(K,"m",function(){return na});c.d(K,"s",function(){return oa});c.d(K,"j",function(){return ja});c.d(K,"k",function(){return qa});c.d(K,"h",function(){return Ia});c.d(K,"v",function(){return Va});c.d(K,"u",function(){return Na});
c.d(K,"p",function(){return ia});c.d(K,"f",function(){return sa});c.d(K,"l",function(){return Ha});F=c(22);var l=c(58),f=c(113),a=c(133);K=c(391);var k=c(37),x=c(8),y=c(48),n=c(418),u=c(6),z=c(7),w=c(1514),E=c(1613);const G=()=>document.getElementById(a.AppFrame.BUa),H=new K.a,L=`.ParaWrappingDiv .${k.a.OJd}`,I=F.a.instance.Ue("Box4.CommentParagraphMapping"),N=[Box4Intl.Box4Strings.l_HK_Bold,Box4Intl.Box4Strings.l_HK_Bold_Mac,Box4Intl.Box4Strings.l_HK_Italic,Box4Intl.Box4Strings.l_HK_Italic_Mac,Box4Intl.Box4Strings.l_HK_Underline,
Box4Intl.Box4Strings.l_HK_Underline_Mac];let Q=void 0;const M=()=>{if(void 0===Q){let ra;try{ra=CSS.supports("selector(:not(* *))")}catch(Ma){ra=!1}ra||z.ULS.sendTraceTag(526263553,324,15,"Cannot use complex CSS selector in CommentHelpers, falling back to less performant alternative");Q=ra}return Q},J=ra=>!!ra&&!!ra.Cf,V=(ra,Ma,ya,Ga)=>{if(!ra||!ra.objectId)return!1;const wa=ya.Db(l.a.Ef(ra.objectId)),hb=w.a.Y8b(wa,!0),eb=w.a.Y8b(wa,!1);if(!hb||!eb||hb===eb&&hb!==Ma||!x.ParagraphReader.rVc(Ma,hb,
eb))return!1;ra=!0;var jb=!1;hb===Ma&&(jb=w.a.Eba(wa,ya,!0),ra=ra&&!!jb&&jb.Ib.cp<=Ga,jb=!!jb&&jb.Ib.cp===Ga);Ma===eb&&(Ma=w.a.Eba(wa,ya,!1),ra=ra&&!!Ma&&Ma.Ib.cp>Ga,jb=jb&&!!Ma&&Ma.Ib.cp===Ga);return ra||jb},X=ra=>{if(!ra)return null;ra=f.a.Db(ra,k.a.pHc);return null!==ra&&void 0!==ra?ra:[]},W=ra=>ra?f.a.Db(ra,k.a.TEd):null,U=(ra,Ma)=>{if(!ra)return-1;for(let ya=0;ya<ra.length;ya++)if(ra[ya].Vfc.equals(Ma))return ya;return-1},Y=(ra,Ma)=>{if(!ra)return-1;for(let ya=0;ya<ra.length;ya++)if(ra[ya].sti.equals(Ma))return ya;
return-1},ba=ra=>`Comment Object Id: ${ra.objectId}`,aa=(ra=!1)=>sa(G(),ra),fa=()=>y.a.Vj?Array.from(G().querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart")):pa()?Array.from(G().querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart")):[],na=(ra,Ma=!1)=>{if(ra.zj){for(const ya of ra.Fg.Oi)if(Ha(ya,Ma))return!0;
return!1}return Ha(ra.htmlElement,Ma)},oa=ra=>!!ra&&!!ra.ia(u.a.iM,null),ja=()=>{const ra=new Set,Ma=fa();for(let ya=0;ya<Ma.length;ya++)X(Ma[ya]).forEach(Ga=>{ra.add(Ga.toString())});return ra},qa=(ra,Ma)=>Ma?za(ra,!0,Ma):la(ra,!0),Ia=(ra,Ma)=>Ma?za(ra,!1,Ma):la(ra,!1),Va=(ra,Ma)=>{va(ra,Ma,!0);n.a.isEnabled&&!ra.Fjb&&z.ULS.sendTraceTag(512372928,327,50,`Adding to CommentParagraphMapping CommentId: ${ra.id} StartParaId: ${Ma}`)},Na=(ra,Ma)=>{va(ra,Ma,!1);n.a.isEnabled&&!ra.Fjb&&z.ULS.sendTraceTag(512372899,
327,50,`Adding to CommentParagraphMapping CommentId: ${ra.id} EndParaId: ${Ma}`)},za=(ra,Ma,ya)=>{var Ga,wa;const hb=ra.id.toString();return Ma?n.a.isEnabled?null!==(Ga=I.value.d_a.get(hb))&&void 0!==Ga?Ga:ya:ra.ia(u.a.BTa,ya):n.a.isEnabled?null!==(wa=I.value.c_a.get(hb))&&void 0!==wa?wa:ya:ra.ia(u.a.lva,ya)},la=(ra,Ma)=>{const ya=ra.id.toString();return Ma?n.a.isEnabled?I.value.d_a.get(ya):ra.getValue(u.a.BTa):n.a.isEnabled?I.value.c_a.get(ya):ra.getValue(u.a.lva)},va=(ra,Ma,ya)=>{const Ga=ra.id.toString();
n.a.isEnabled?ra.Fjb||(ya?I.value.d_a:I.value.c_a).set(Ga,Ma):ra.setValue(ya?u.a.BTa:u.a.lva,Ma)},ia=ra=>n.a.isEnabled?I.value.d_a.has(ra.objectId)&&I.value.c_a.has(ra.objectId):!0,pa=()=>0===E.a.Kj||2===E.a.Kj,sa=(ra,Ma)=>{if(Ma&&(pa()||y.a.Vj)){if(M())return Array.from(ra.querySelectorAll(y.a.Vj?".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)":
".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)"));Ma=y.a.Vj?ra.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart"):ra.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart");const ya=
Ma.length;if(0<ya){ra=ra.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart");const Ga=[];let wa=0;for(let hb=0,eb=ra.length;hb<eb;hb++){const jb=ra[hb];wa<ya&&Ma[wa]===jb?++wa:Ga.push(jb)}return Ga}}return Array.from(ra.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart"))},Ha=(ra,Ma)=>{if(Ma&&(pa()||y.a.Vj)){if(M())return!!ra.querySelector(y.a.Vj?".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)":
".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)");Ma=y.a.Vj?ra.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart").length:ra.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart").length;
if(0<Ma)return Ma!==ra.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart").length}return!!ra.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart")}},1510:function(F,K,c){var l=this&&this.gC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.Oz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===
y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1831),K);f(c(1832),K)},1511:function(F,K,c){var l=this&&this.gC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.Oz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===
y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1815),K);f(c(1816),K)},1514:function(F,K,c){F=c(0);var l=c(22),f=c(80),a=c(58),k=c(2),x=c(719),y=c(140),n=c(237),u=c(598),z=c(9),w=c(5),E=c(248),G=c(8),H=c(418),L=c(360),I=c(1169),N=c(75),Q=c(60),M=c(1775),J=c(1818),V=c(1819),X=c(16),W=c(6),U=c(585),Y=c(7),ba=c(111),aa=c(243),fa=c(77),na=c(1676);class oa extends Sys.EventArgs{constructor(va,
ia){super();this.graphNode=va;this.U1k=ia}}Object(F.a)(oa,"OnCopyCommentEventArgs",Sys.EventArgs,[]);class ja extends Sys.EventArgs{constructor(va,ia){super();this.graphNode=va;this.R_k=ia}}Object(F.a)(ja,"OnPasteCommentEventArgs",Sys.EventArgs,[]);var qa=c(1200),Ia=c(1506),Va=c(1575);class Na extends Sys.EventArgs{constructor(va){super();this.commentNode=va}}Object(F.a)(Na,"OnDeleteEventArgs",Sys.EventArgs,[]);class za extends Sys.EventArgs{constructor(va){super();this.commentNode=va}}Object(F.a)(za,
"OnPasteEventArgs",Sys.EventArgs,[]);c.d(K,"a",function(){return la});class la{static get characterPropertiesEditor(){return null!=la.Twg?la.Twg:la.Twg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get hd(){return null!=la.Ayg?la.Ayg:la.Ayg=new f.a}static get XCa(){return Va.a.instance}static get Aj(){return z.App.xa.ib.Uc.od}static get Xb(){return null!=la.Azg?la.Azg:la.Azg=l.a.instance.Na("Box4.IFeatureHelper")}static isComment(va){return 40===va.We}static qYd(va){return 40===va.type}static oCf(va){return!!va&&
39===va.We}static DTf(va,ia){ia.property===X.a.ef&&(la.mHb=!1)}static HTf(va,ia){ia&&!va.Mc&&la.BQh(va)}static BQh(va){const ia=va.Ib.paragraph.Kc;va=ia.Db(va.ak);la.hLc();va&&va.anchor&&la.deleteComment(va,ia)}static gbf(va){const ia=new w.GraphIterator;ia.set(va.Vi());la.XCa.u4a(ia);return ia}static deleteComment(va,ia){va?(la.hLc(),la.yId(va,ia),va.anchor&&(la.hd.raiseEvent(la.Q_c,new Na(va)),ia=va.ia(W.a.$E,0),Y.ULS.sendTraceTag(592188697,327,15,`Comment deleted by canvas anchor removal. ${va.id}`),
la.MPg.add(ia.toString()),ia=new w.GraphIterator,ia.set(va),ia.zb(39),ia.xg())):Y.ULS.sendTraceTag(512275402,327,50,"Comment Node is Undefined")}static HJm(va){return la.MPg.contains(va)}static yId(va,ia){la.hLc();const pa=la.Eba(va,ia,!0);ia=la.Eba(va,ia,!1);la.Inb(pa);la.Inb(ia);pa&&ia&&pa.Ib===ia.Ib&&Y.ULS.sendTraceTag(50619292,327,10,`comment ${va.id} start and end range objects belonged to same chp`)}static Inb(va){if(va&&va.Ib.rf){va.Ib.rf.remove(va);const ia=va.Ib.paragraph;0<=va.qe&&va.qe<
ia.xe.length&&(va.Ib.cp||1!==ia.xe.length||(ia.xe.VX(0,4),ia.xe.nq.Z(1,E.CharacterPropertiesEditor.MM),ia.xe.ft.Z(1,E.CharacterPropertiesEditor.tR)),ia.xe.removeAt(va.qe,4));ia.Yl()}}static rmn(va,ia){if(ia){var pa=ia.paragraph;va=ia.cpBegin;var sa=ia.cpEnd;if(pa&&G.ParagraphReader.Wb(pa)&&(pa=pa.pa)){ia.Mo[la.eFd]||(ia.Mo[la.eFd]=[]);ia=ia.Mo[la.eFd];for(let ra=0;ra<pa.length;ra++){const Ma=pa.J(ra).rf;if(!Ma)continue;const ya=Ma.length;var Ha=pa.J(ra).cp;if(Ha<va||Ha>sa)for(Ha=0;Ha<ya;Ha++)ia.push(Ma.J(Ha))}}}}static Aln(va,
ia){if(ia&&(va=ia.Mo[la.eFd]))for(ia=0;ia<va.length;ia++)la.BQh(va[ia])}static Eba(va,ia,pa){if(!va)return null;const sa=pa?Ia.k(va,a.a.nil):Ia.h(va,a.a.nil);ia=ia.Db(sa);return ia?la.Dva(ia,va.id,pa):(pa||Y.ULS.sendTraceTag(4531344,327,15,`Comment anchor missing! Comment Id: ${va.id} Anchor Id: ${sa} ${la.GJm(sa)}`),null)}static GJm(va){return H.a.isEnabled?`isDeletedParagraph: ${la.dRh.has(va.toString())}`:""}static Dva(va,ia,pa){for(let sa=0;sa<va.pa.length;sa++){const Ha=va.pa.J(sa);if(Ha.rf)for(let ra=
0;ra<Ha.rf.length;ra++)if(Ha.rf.J(ra).ak.equals(ia)&&pa===Ha.rf.J(ra).Mc)return Ha.rf.J(ra)}return null}static Y8b(va,ia){if(!va)return null;ia=ia?Ia.k(va,a.a.nil):Ia.h(va,a.a.nil);return va.Kc.Db(ia)}static RNc(va,ia,pa,sa=null){const Ha=!sa;for(let ra=0;ra<va.pa.length;ra++){const Ma=va.pa.J(ra);if(Ma.cp>=ia&&Ma.rf)for(let ya=0;ya<Ma.rf.length;ya++){const Ga=Ma.rf.J(ya).ak.toString();if(Ma.rf.J(ya).Mc===pa&&(Ha||sa.contains(Ga)))return Ma.rf.J(ya)}}return null}static H1l(va,ia,pa,sa){for(let Ha=
0;Ha<va.pa.length;Ha++){const ra=va.pa.J(Ha);if(ra.cp>ia)break;if(ra.cp===ia&&ra.rf)for(let Ma=ra.rf.length-1;0<=Ma;Ma--){const ya=ra.rf.J(Ma).ak.toString();if(ra.rf.J(Ma).Mc===pa&&sa.contains(ya))return ra.rf.J(Ma)}}return null}static r0b(va,ia,pa,sa){let Ha=null;for(let ra=0;ra<va.pa.length;ra++){let Ma=va.pa.J(ra);if(Ma.cp>=pa){Ma.cp>pa||!Ma.formatting?(Ha=la.characterPropertiesEditor.LY(va,ra,pa,Ha),Ma=va.pa.J(ra)):Ha=Ma.formatting;Ma.rf||(Ma.rf=new L.a(Ma));la.gzd(ia,Ma.rf,Ha.Wj,sa);break}Ma.formatting&&
(Ha=Ma.formatting)}}static gzd(va,ia,pa,sa){pa=ia.Ib.paragraph;const Ha=new I.a(ia.Ib,null,va,sa);for(let ra=0;ra<ia.length;ra++)if(ia.J(ra).ak===va&&ia.J(ra).Mc===sa){Y.ULS.sendTraceTag(589616028,327,10,"CommentRangeObject {0} already exists with isStart value {1} in commentRangeObjects",va,sa);break}ia.add(Ha);pa.Yl();Ha.qe?pa.xe.VX(Ha.qe-1,4):pa.xe.loa(Ha.qe,4);pa.xe.nq.Z(Ha.qe,E.CharacterPropertiesEditor.MM);pa.xe.ft.Z(Ha.qe,E.CharacterPropertiesEditor.tR);return Ha}static hLc(){if(!la.mHb){var va=
new w.GraphIterator;va.set(z.App.xa.ib.Uc);la.XCa.u4a(va);if(va.Sb(1))for(;va.Pf(1););la.mHb=!0}}static KDl(va){const ia=new w.GraphIterator;ia.set(z.App.xa.ib.Uc);la.XCa.u4a(ia);if(39!==ia.We)return!1;let pa;if(pa=ia.Sb(1)){if(pa.id.equals(va))return!0;for(;pa=ia.Pf(1);)if(pa.id.equals(va))return!0}return!1}static RKb(va,ia){la.v4c(ia)}static pRj(va,ia){H.a.isEnabled&&(va=ia.node)&&(ia=G.ParagraphReader.TQ(va),la.Ife(ia)&&la.dRh.add(va.id.toString()))}static Ife(va){return 0<va?document.querySelector("div.PageContentContainer p[paraid='"+
va+"']"):null}static v4c(va){la.h5f(G.ParagraphReader.hEb(va));let ia=null;var pa=new w.GraphIterator;pa.set(va);if(pa.Bp()&&(pa=N.a.Rs(pa,pa.origin),pa.moveNext()))for(;pa.moveNext();)if(G.ParagraphReader.sh(pa.iterator)){ia=pa.iterator.currentNode;break}if(ia){va=G.ParagraphReader.hEb(va);for(const sa of va)sa.Mc&&(va=sa.Ib.paragraph.Kc.Db(sa.ak))&&(la.Inb(sa),la.r0b(ia,va.id,0,!0),Ia.v(va,ia.id))}}static h5f(va){for(const ia of va)if(!ia.Mc){va=ia.Ib.paragraph.Kc;const pa=va.Db(ia.ak);la.deleteComment(pa,
va)}}static uRd(va,ia){const pa=[];if(!va)return Y.ULS.shipAssertTag(594908762,327,!1,"Trying to highlight null node."),pa;if(!va.isConnected)return Y.ULS.shipAssertTag(51467871,327,!1,"Trying to highlight disconnected node."),pa;const sa=la.Eba(va,la.Aj,!0),Ha=la.Eba(va,la.Aj,!1);if(!sa||!Ha)return Y.ULS.shipAssertTag(51467872,327,!1,`Missing comment anchor ${va.id}`),pa;va=!1;let ra=sa.Ib.paragraph;for(;ra&&(!ia||!ia(ra,ra===sa.Ib.paragraph));){ra===sa.Ib.paragraph&&(va=!0);va&&pa.push(ra);if(ra===
Ha.Ib.paragraph)break;ra=G.ParagraphReader.jg(ra,!1)}return pa}static ETf(va,ia){ia.Mo.Comments||(ia.Mo.Comments={});la.O6d(ia.operation,ia.JZi,ia.original,ia.clone,ia.Mo.Comments,!0)}static GTf(va,ia){ia.Mo.Comments||(ia.Mo.Comments={});la.O6d(ia.operation,ia.JZi,ia.original,ia.clone,ia.Mo.Comments,!1)}static mnn(va,ia){ia.Mo.Comments||(ia.Mo.Comments={});va=ia.Mo.Comments;if((ia=Object.keys(va))&&0<ia.length)for(let pa=0;pa<ia.length;pa++){const sa=va[ia[pa].toString()];sa&&(sa.ak=null,la.Inb(sa))}}static O6d(va,
ia,pa,sa,Ha,ra){const Ma=pa.Kc;var ya=G.ParagraphReader.hEb(sa);ya.sort((ab,Ea)=>ab.Ib.cp<Ea.Ib.cp||ab.Ib.cp===Ea.Ib.cp&&ab.Mc?-1:ab.Ib.cp===Ea.Ib.cp&&ab.Mc===Ea.Mc?0:1);const Ga=new fa.a,wa=new aa.a,hb=la.Xb.isFeatureEnabled(115);for(const ab of ya)if(Object(ba.a)(qa.PageView,Q.InteractiveViewManager.instance.Bd)){var eb=Ma.Db(ab.ak);if(eb&&eb.isConnected)if(ab.Mc)Ha[ab.ak.toString()]=ab;else{var jb=eb.ia(W.a.$E,0);ya=ra?la.q2c(eb,sa,va,ia):la.v2c(eb,sa,va,ia);if(ra)hb&&(jb=w.GraphIterator.$a(sa),
jb.zb(25)&&jb.jd(25)&&na.a.hd.raiseEvent(na.a.jUi,new oa(jb.currentNode,ya.getValue(W.a.$E))));else{if(hb){var ub=ya.ia(W.a.$E,0);jb&&ub&&(wa.mb(jb)?wa.J(jb)!==ub&&Y.ULS.sendTraceTag(589616029,327,10,"Failed to add Key {0}, Value {1} to clonedDurableIdMapping, since Key {0}, Value {2} already exists. This could affect copy/paste of tasks.",jb,ub,wa.J(jb)):wa.add(jb,ub))}ya.setValue(W.a.Djb,!0);eb.ia(W.a.$8e,null)||(jb=eb.ia(W.a.CNa,null))&&ya.setValue(W.a.$8e,jb);ya.setValue(W.a.CNa,k.AFrameworkApplication.userSessionId)}jb=
ab.ak.toString();ub=Ha[jb];ab.ak=ya.id;if(!ra){ab.ev=null;eb=eb.getValue(W.a.xH);const Ea=ya.getValue(W.a.xH);Ha[eb]=Ea;if(eb=ya.ia(W.a.iM,null))Ga.mb(eb)||Ga.add(eb,[]),Ga.J(eb).push(ya)}Ia.u(ya,sa.id);sa.id||Y.ULS.shipAssertTag(5564305,327,!1,"Comment node has no end anchor!");ub?(ub.ak=ya.id,ra||(ub.ev=null),Ia.v(ya,ub.Ib.paragraph.id),delete Ha[jb]):(la.r0b(sa,ya.id,ab.Ib.cp,!0),Ia.v(ya,sa.id))}else Y.ULS.sendTraceTag(592188835,327,10,String.format("Node is null or not connected, IsNodeChildOfCommentContent:{0}, IsNull:{1}",
la.KDl(ab.ak),!eb)),ab.ak=null,la.Inb(ab)}else ab.ak=null,la.Inb(ab);if(!ra){for(const ab of Ga){va=ab.key;ia=ab.value;for(const Ea of ia)Ea.setValue(W.a.iM,Ha[va])}0<wa.count&&hb&&(pa=w.GraphIterator.$a(pa),pa.zb(25)&&pa.jd(25)&&na.a.hd.raiseEvent(na.a.IWi,new ja(pa.currentNode,wa)))}sa.hk()}static kif(va,ia){if(va.zb(25)&&va.jd(25)&&!va.Rr(16)){const pa=w.GraphIterator.$a(ia);pa.zb(39);pa.jd(39);ia=U.b(pa.currentNode,ia.Vi().Kc,!0);va.Af(ia,16)}}static Y$e(va,ia){var pa=ia.Vi().od;pa=U.b(va,pa,
!0);ia=w.GraphIterator.$a(ia);la.kif(ia,va);ia.Sb(16);ia.c3(pa,1,va.id);return pa}static q2c(va,ia,pa,sa){la.hLc();ia=la.Y$e(va,ia);ia.Fjb=!0;la.Cyl(va,ia,pa,sa);return ia}static Cyl(va,ia,pa,sa){va=new M.a(w.GraphIterator.$a(va),w.GraphIterator.$a(ia),{});va.UOb=!0;pa=new x.a(pa,sa,new J.a(va,null));pa.Gh=!0;pa.Jl("ExecuteInternalCommentCopy");pa.run()}static v2c(va,ia,pa,sa){la.hLc();var Ha=ia.Vi().od;ia=w.GraphIterator.$a(ia);ia.zb(7);ia.jd(7);ia.Sb(16);Ha=U.b(va,Ha,!0);Ha.$g(W.a.xH,y.a.create().toString());
Ha.$g(W.a.commentId,n.a.uF());let ra=!1;la.TDi(Ha.Gf(W.a.$E))?ra=!0:Ha.$g(W.a.$E,la.Qpf());ia.Af(Ha,1);la.Dyl(va,Ha,pa,sa);ia.sj(Ha);ia.oJ(1);ia.whb(2);ia.Sb(2);Ha.setValue(W.a.xH,ia.currentNode.Gf(W.a.Lc).toString());la.hd.raiseEvent(la.Esn,new za(Ha));ra&&this.aPh.add(Ha.id.toString());return Ha}static Dyl(va,ia,pa,sa){va=new V.a(w.GraphIterator.$a(va),w.GraphIterator.$a(ia),null,null);pa=new x.a(pa,sa,va);pa.Gh=!0;pa.Jl("ExecuteInternalCommentPaste");pa.run()}static Qpf(){const va=n.a.ehc(1,this.zNi);
return la.TDi(va)?va:la.Qpf()}static TDi(va){if(!va)return!1;if(z.App.xa){const ia=new w.GraphIterator;ia.set(z.App.xa.ib.Uc);la.XCa.u4a(ia);let pa=ia.Pd();for(;pa;){if(pa.Gf(W.a.$E)===va)return!1;pa=ia.Lj()}}return!0}static M_e(va){la.hd.addHandler(la.Q_c,va)}}la.Esn="OnPaste";la.Q_c="OnDelete";la.eFd="CommentRangesToTrimOutsideSelection";la.MPg=new u.a;la.mHb=!1;la.zNi=2147483646;la.aPh=new Set;la.dRh=new Set;Object(F.a)(la,"CommentEditor",null,[])},1519:function(F,K,c){c.d(K,"a",function(){return l});
F=c(0);class l extends Sys.EventArgs{constructor(f){super();this.data=f}}Object(F.a)(l,"DesignerEventArgs",Sys.EventArgs,[])},1523:function(F,K,c){c.d(K,"a",function(){return y});F=c(0);var l=c(6),f=c(285),a=c(1178),k=c(1081),x=c(7);class y{constructor(n,u,z,w){this.MZm=n;this.lEm=u;this.kEm=z;this.T1i=w}ggc(n,u,z,w,E){n?(n=this.CIc(n,u,z),null!==n&&(w=this.naf(w,n,E),this.kEm.setState(this.MZm.value,w))):x.ULS.shipAssertTag(543499408,3016,!1,"No ParagraphNode")}CIc(n,u,z){return 0>z?(x.ULS.sendTraceTag(539018900,
389,10,"Attempted to create a ParagraphRange descriptor with negative length"),null):f.a.LIc(n.ia(l.a.Lc,-1),n.ia(l.a.uj,-1),u,z,u,z,n)}naf(n,u,z){return Object.assign(new k.a,{annotationType:n,contentDescriptor:u,state:z})}RBf(n,u,z,w,E){if(n){var G=n.ia(l.a.Lc,-1),H=n.ia(l.a.uj,-1);-1===G||-1===H?E(null):(n=this.CIc(n,u,z),null===n?E(0):this.lEm.k0c(n,w,L=>{E(L)}))}else x.ULS.shipAssertTag(543499409,3016,!1,"No ParagraphNode")}vDn(n){if(n){var u=a.a.S$k(n);this.T1i.Yoh({Qob:u,settingType:n})||x.ULS.shipAssertTag(521416710,
3016,!1,"Persist Designer suppression setting failed")}}cTm(n){return new Promise(u=>{this.T1i.iei(n,z=>{(null===z||void 0===z?0:z.Qob)?u(z.Qob):u(null)})})}}y.o1f="WordDesignerPullQuotesAnnotation";y.CPh="WordDesignerDefaultAnnotation";y.nhg="WordDesignerSuggestedImageAnnotation";y.pzj="WordDesignerThemeImageAnnotation";y.ahg="WordDesignerStylizedTitleAnnotation";y.t3b="WordDesignerComplexDecoratorAnnotationType";y.sRh="DesignerPaneSuppressionSetting";Object(F.a)(y,"PersistenceHelperImpl",null,[1065])},
1524:function(F,K,c){function l(I){return 1===(null===I||void 0===I?void 0:I.Gq)||3===(null===I||void 0===I?void 0:I.Gq)}F=c(0);var f=c(39),a=c(44),k=c(31),x=c(7),y=c(1626),n;(function(I){I[I.initial=0]="initial";I[I.I3o=.1]="viewingOriginal";I[I.gHk=.5]="applying";I[I.applied=1]="applied";I[I.accepted=2]="accepted";I[I.rejected=3]="rejected";I[I.Vmp=4]="roleChanged";I[I.hjp=5]="invalidated"})(n||(n={}));Object(F.b)("ReviewIntentState",n);const u=I=>{switch(I){case n.I3o:return n.rejected;case n.gHk:return n.applied;
default:return I}};var z=c(134);c.d(K,"d",function(){return E});c.d(K,"e",function(){return l});c.d(K,"b",function(){return G});c.d(K,"c",function(){return H});c.d(K,"a",function(){return L});class w{constructor(I,N,Q=null,M,J=!0){this.id=I;this.Gq=N;this.hE=Q;this.Xd=M;this.WIm=J;this.myi=!1;this.jFi=f.a.af()}gni(){return!1}ZQa(I){this.zca(n[u(I)]);this.v3d(I)}v3d(I){1===I&&this.hE&&this.Xd&&(this.WIm?(this.Xd.vGm()&&this.hE.execute(N=>{N.logActivity(z.a.lUj,null)}),2===this.Gq&&this.Xd.gUm()?this.hE.execute(N=>
{N.logActivity(z.a.BUj,null)}):1===this.Gq&&this.Xd.aQm()?this.hE.execute(N=>{N.logActivity(z.a.vUj,null)}):0===this.Gq&&this.Xd.XLm()&&this.hE.execute(N=>{N.logActivity(z.a.pUj,null)})):4===this.Gq&&this.Xd.PJm()&&this.hE.execute(N=>{N.logActivity(z.a.nUj,null)}))}yYc(){6E4>f.a.af()-this.jFi?this.zca("removed"):x.ULS.sendTraceTag(539109067,3016,50,"ID: {0}, Type: {1}, State: {2}",this.id,this.Gq,"removedButKept")}x4m(){this.myi||(this.zca("hovered"),this.myi=!0)}zca(I){this.jFi=f.a.af();x.ULS.sendTraceTag(540357460,
3016,50,"ID: {0}; Type: {1}, State: {2};",this.id,this.Gq,I);a.a(z.a.rml,!0,void 0,[Object.assign(new k.a,{name:"suggestionType",int64:this.Gq}),Object.assign(new k.a,{name:"ID",string:this.id.toString()}),Object.assign(new k.a,{name:"State",string:I})])}}Object(F.a)(w,"DesignerSuggestion",null,[]);class E extends w{constructor(I,N=1,Q=null,M,J=!1,V=0,X=""){super(I,N,Q,M,J);this.s5a=V;this.M2c=X}}Object(F.a)(E,"PullQuoteSuggestion",w,[]);class G extends w{constructor(I,N,Q,M=null,J,V){super(I,2,M,
J);this.BM=N;this.baseUrl=Q;this.i0d=V;this.selectedIndex=0;this.Rkc=z.a.Xym}mxm(){x.ULS.shipAssertTag(527708514,3016,this.Rkc===z.a.Yjn,`${this.Rkc}`);this.Rkc=Math.min(this.BM.length,z.a.p4d)}gni(){return this.Rkc<Math.min(this.BM.length,z.a.p4d)}EEb(I){return I>=this.BM.length?(x.ULS.shipAssertTag(527708515,3016,!1),null):this.baseUrl+this.BM[I].imageId}lvf(I){return I>=this.BM.length?(x.ULS.shipAssertTag(527708544,3016,!1),null):this.baseUrl+this.BM[I].thumbnailId}yX(I){return I>=this.BM.length?
(x.ULS.shipAssertTag(527708545,3016,!1),null):this.BM[I].altText?this.BM[I].altText:this.BM[I].category===y.SuggestionCategory.AbstractImage?WordEditorIntl.WordEditorStrings.L_DesignerImageSuggestionAbstractImageAltText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage}J_l(I){var N;return I>=this.BM.length?(x.ULS.shipAssertTag(527210446,3016,!1),0):null!==(N=this.BM[I].score)&&void 0!==N?N:0}ZQa(I){if(!this.i0d){const N=n[u(I)];x.ULS.sendTraceTag(509653453,3016,50,"ID: {0}; Type: ImageSuggestion for Heading , State: {1};",
this.id,N);a.a(z.a.bml,!0,void 0,[Object.assign(new k.a,{name:"ID",string:this.id.toString()}),Object.assign(new k.a,{name:"State",string:N})])}super.ZQa(I)}}Object(F.a)(G,"ImageSuggestion",w,[]);class H extends w{constructor(I,N=null,Q,M,J=null){super(I,0,N,Q,M);this.metadata=J;this.UOi=!1}ZQa(I){this.UOi||(this.UOi=!0,this.metadata&&a.a(z.a.Jal,!0,0,this.metadata.concat([Object.assign(new k.a,{name:"ID",string:this.id.toString()})])));super.ZQa(I)}}Object(F.a)(H,"InconsistencySuggestion",w,[]);
class L extends w{constructor(I,N=null,Q,M=!1,J){super(I,4,N,Q,M);this.jCn=J}ZQa(I){this.TFo=I;super.ZQa(I)}}Object(F.a)(L,"DesignerPasteSuggestion",w,[])},1526:function(F,K,c){c.d(K,"a",function(){return l});const l={vGh:"CommentDeepLinkNavigationFailed",REd:"CommentDataLoss",m3b:"CommentExperienceDegraded",Tjf:"CommentsFeatureUsage",d9e:"CommentThreadInProgress",fFd:"CommentReplyInProgress",yGh:"CommentEditInProgress",SEd:"CommentDeepLink",tGh:"CommentCommit",n3b:"CommentLoad",NGh:"CommentInitialization"}},
1527:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}l.oq="SpellingErrorV2";l.Wfg="SpellingErrorV2Themed";l.I6k="ContextualSpellingAndGrammarErrorV2";l.y$e="ContextualSpellingAndGrammarErrorV2Themed";l.kAd="AdvancedProofingIssueV2Themed";l.y7i="AdvancedProofingIssueV2Themed";l.similarityReviewed="SimilarityReviewed";l.Gtj="SimilarityReviewedThemed";l.similarityUnreviewed="SimilarityUnreviewed";l.Htj="SimilarityUnreviewedThemed";l.xkc="SpellingErrorHighlight";l.t9b="GrammarErrorHighlight";
l.Mdb="CritiqueIndicatorHighlight";l.x7i="ReactiveRewriteIndicatorHighlight";l.Jzo="SimilarityHighlight";l.Kzo="SimilarityReviewedHighlight";l.ABd="IdeasSuggestionConfirmation";Object(F.a)(l,"CanvasContextualCssClasses",null,[])},1528:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a,k,x=!1,y=!1,n=!1,u=!1,z=null){this.ml=f;this.source=a;this.MQa=k;this.ufa=x;this.rkc=y;this.cjf=n;this.bOa=u;this.Lo=z}}Object(F.a)(l,"ContextualIntentInvocationParameters",null,[])},1529:function(F,
K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a,k,x,y=null,n=null,u=null,z=0,w=0){this.D4=this.ylc=this.FGa=this.xR=null;this.BH=z;this.Nce=f;this.TRa=a;this.w7a=k;x&&(this.xR=x);null!=y&&(this.FGa=y);null!=n&&(this.ylc=n);u&&(this.D4=u);this.shapeId=w}}Object(F.a)(l,"AnchorData",null,[])},1531:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.completion=new Promise((f,a)=>{this.resolve=f;this.reject=a})}}Object(F.a)(l,"ControlledPromise",null,[])},
1534:function(F,K,c){c.d(K,"a",function(){return w});F=c(0);var l=c(19),f=c(186),a=c(9),k=c(527),x=c(43),y=c(17),n=c(23),u=c(233),z=c(8);class w{constructor(E,G,H,L,I){this.rGb=E;this.L1a=G;this.Bvb=H;this.Nka=L;this.Kd=I;this.d5g=0;this.hab=null;this.gjk=!1;this.M4g=!0;this.G_g=null;this.SZc=this.kod=!0;this.V0g=!1;this.Cyc=E?E.innerText:z.ParagraphReader.text(G)}get QC(){throw Error.notImplemented("The inherit class should have the default value.");}set QC(E){}get ZIb(){return this.d5g}Voj(E){this.d5g=
E}get kb(){return this.hab}set kb(E){this.hab=E}get GG(){return this.Bvb}get p0(){return this.Nka}get Exi(){return this.V0g}get HDi(){return!1}get Hxa(){return this.Cyc}get Bvo(){return!0}invoke(){this.V0g=!0;if(this.rGb&&this.rGb.parentNode&&!this.QC){var E=this.rGb.innerText;if(this.SZc&&l.a.substring(this.Cyc,this.Bvb,this.Nka)!==l.a.substring(E,this.Bvb,this.Nka))return 0;this.tCb(this.rGb);this.Voj(this.rGb.innerText.length-E.length);return 1}this.kod||f.a.instance.Yb("MatchTextIsNotTheSame",
{["Reason"]:"MatchTextIsNotTheSame"});if(!this.M4g)return f.a.instance.Yb("AbortedAction",{["Reason"]:this.G_g}),0;var G=z.ParagraphReader.text(this.L1a);E=G.length;var H=this.Cyc.length,L=l.a.substring(this.Cyc,this.Bvb,this.Nka).trimEnd();G=l.a.substring(G,this.Bvb,this.Nka).trimEnd();this.Bvo&&L===G&&this.Nka>H&&(this.Nka=H);if(this.SZc&&L!==G)if(H=L.replace(RegExp('"',"g"),""),H===l.a.substr(G,0,H.length))this.Nka-=2;else return 0;if(a.App.rd.Qo&&k.CoauthLockEditor.getInstance().P6a(w.Wf.C7b(this.L1a)))return 0;
H=new x.GraphTransaction(15);H.Cb(this.L1a);H.jk=this.commandId;this.Vma(this.L1a);this.Voj(z.ParagraphReader.textLength(this.L1a)-E);this.hab&&!this.gjk&&y.SelectionEditor.Sl(this.hab)&&(G=this.hab.Oa,E=G.cpBegin,L=G.cpEnd,G=G.node,G===this.L1a&&this.ZIb&&(E>=this.Nka&&(E+=this.ZIb),L>=this.Nka&&(L+=this.ZIb),this.hab=n.SelectionFactory.ZI(G,E,L)));H.dispose();return 2}LJj(){this.kod=this.uDh()}tCb(){}uDh(){var E=z.ParagraphReader.text(this.L1a);const G=l.a.substring(this.Cyc,this.Bvb,this.Nka).trimEnd();
E=l.a.substring(E,this.Bvb,this.Nka).trimEnd();return G===E}static get Wf(){return u.a.instance}}Object(F.a)(w,"AAutoCorrectAction",null,[540])},1535:function(F,K,c){c.d(K,"a",function(){return a});F=c(0);var l=c(28),f=c(7);class a{constructor(k){this.ml=k}static create(k){if(!k)return f.ULS.shipAssertTag(575930373,3016,!1),null;k=l.a.create(k);return new a(k)}}Object(F.a)(a,"ShowReviewArgs",null,[])},1536:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.data=this.landingTab=
null}}Object(F.a)(l,"LaunchData",null,[])},1540:function(F,K,c){c.d(K,"c",function(){return a});c.d(K,"a",function(){return k});c.d(K,"b",function(){return x});F=c(0);var l=c(1523);class f{constructor(y,n,u){this.suggestion=y;this.Gq=n;this.paragraphNode=u}get role(){switch(this.Gq){case 1:case 3:return 27;case 2:return 28;default:return 1}}}Object(F.a)(f,"AddEnhancementActionData",null,[]);class a extends f{constructor(y,n,u,z,w,E=1){super(y,E,n);this.s5a=u;this.M2c=z;this.callback=w}}Object(F.a)(a,
"AddPullQuoteActionData",f,[]);class k extends f{constructor(y,n,u=0){super(y,2,n);this.doa=u}}Object(F.a)(k,"AddCoverPhotoActionData",f,[]);class x{constructor(y,n,u,z,w){this.suggestion=y;this.Yr=n;this.M$b=u;this.oTc=z;this.gBd=w}get annotationType(){switch(this.suggestion.Gq){case 1:case 3:return l.a.o1f;case 2:return l.a.nhg;default:return l.a.CPh}}get gRa(){return this.Yr&&1<=this.Yr.length?this.Yr[0]:null}}Object(F.a)(x,"AddDesignerSuggestionActionData",null,[])},1544:function(F,K,c){c.d(K,
"a",function(){return l});F=c(0);class l{}Object(F.a)(l,"OAuthResult",null,[])},1545:function(F,K,c){c.r(K);c.d(K,"FindManagerHelper",function(){return y});F=c(0);var l=c(7),f=c(111),a=c(9),k=c(172),x=c(1044);c=c(1827);class y extends c.a{constructor(){super()}get Uc(){return a.App.xa.ib.Uc}get Aj(){return a.App.xa.ib.Uc.od}get Foa(){return a.App.xa.ib.Foa()}get xCf(){return a.App.xa.ib.rc.Wi}a_e(n){a.App.Xj.zl.QMa(n)}m5d(n,u,z){return x.b(n,u,z)}llg(n,u,z){if(1===z){if(!y.Oh.mlg(n))return!1}else if(!(n.We===
u||n.zb(u)&&n.jd(u)))return!1;return Object(f.a)(59,n.currentNode)||this.m5d(n,u,z)?!0:!1}oEa(n){return this.Aj.Db(n).oEa()}hBi(n,u,z,w){if(!n||n.matchCase!==z.matchCase||n.matchWholeWord!==z.matchWholeWord||w.length!==u.length)return!0;for(n=0;n<w.length;n++){if(w[n]!==u[n])return!0;if(z.matchCase){if(w[n]!==u[n])return!0}else if(w[n].toLocaleLowerCase()!==u[n].toLocaleLowerCase())return!0}return!1}rBi(n,u,z,w){if(!n||n.matchWholeWord&&!z.matchWholeWord||n.matchCase&&!z.matchCase||w.length!==u.length)return!1;
if(n.matchWholeWord)return n.matchCase?u[0]===w[0]:w[0].toLocaleLowerCase()===u[0].toLocaleLowerCase();for(let E=0;E<w.length;E++)if(n.matchCase){if(!w[E].startsWith(u[E]))return!1}else if(!w[E].toLocaleLowerCase().startsWith(u[E].toLocaleLowerCase()))return!1;n.matchCase===z.matchCase&&n.matchWholeWord===z.matchWholeWord&&1===u.length&&l.ULS.sendTraceTag(4069025,313,50,"{0}",{["IncrementalSearchTriggeredQueryLength"]:z.text.length});return!0}lde(n,u,z){const w=a.App.Xj.zl.Ze(12);w.Go(n);w.$t(u);
w.Ax(z)}static get Oh(){return k.PageNavigator.instance}static get instance(){y.xtb||(y.xtb=new y);return y.xtb}}y.xtb=null;Object(F.a)(y,"FindManagerHelper",c.a,[])},1546:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);var l=c(2);class f{constructor(){this.currentDocumentPath=l.AFrameworkApplication.K.jb("EditDocInClientUrl")}}Object(F.a)(f,"SmartLookupApplicationInterface",null,[])},1547:function(F,K,c){c.d(K,"a",function(){return Q});F=c(0);var l=c(719),f=c(5),a=c(1775),k=c(1818),x=c(1819),
y=c(202),n=c(8),u=c(43),z=c(139),w=c(172),E=c(536),G=c(6),H=c(585),L=c(78),I=c(156),N=c(526);class Q{constructor(M,J,V,X,W){Q.SYd=!1;this.uE=M;this.qNe=J;this.pNe=V;this.Wc=X;this.A4j=W}Pjo(M,J){this.uE.xoa(M)&&M.properties.setValue(G.a.qna,J)}c6b(){if(!Q.SYd){var M=this.Bdi();for(var J=M.Sb(7);J;J=M.zi(7))for(J=M.Sb(8);J;J=M.zi(8));Q.SYd=!0}}Bdi(){const M=this.Wc.Bk();M.set(this.A4j());Q.Oh.fP(M);return M}Tu(){const M=this.Bdi();this.pNe.n5d(M);this.j4n(M.currentNode);Q.SYd=!1}nJn(M){this.c6b();
if(M.isConnected){var J=this.V3(M);if(J=this.uE.wOc(M,J)){var V=this.Wc.Bk();V.set(J);V.zb(25);M.anchor&&(V.set(M),V.zb(37),V.xg())}}}twl(M,J){if(M.zb(25)&&M.jd(25)&&!M.Rr(7)){const V=f.GraphIterator.$a(J);V.zb(37);V.jd(37);J=H.b(V.currentNode,J.Vi().Kc,!0);M.Af(J,7)}}Hyl(M,J,V,X){M=new a.a(f.GraphIterator.$a(M),f.GraphIterator.$a(J),{});M.UOb=!0;V=new l.a(V,X,new k.a(M,null));V.Gh=!0;V.Jl("ExecuteInternalFootnoteEndnoteCopy");V.run()}Y$e(M,J){J=J.Ib.paragraph;var V=J.Vi().od;V=H.b(M,V,!0);J=f.GraphIterator.$a(J);
this.twl(J,M);J.Sb(7);J.Af(V,8);return V}q2c(M,J,V,X){this.c6b();const W=this.V3(M);if(!this.uE.wOc(this.uE.Mdi(M),W))return null;J=this.Y$e(M,J);this.Hyl(M,J,V,X);return J}v2c(M,J,V,X){this.c6b();var W=J.Ib.paragraph;const U=W.Vi().od;W=f.GraphIterator.$a(W);W.zb(7);W.jd(7);this.k5d(W,J.V3());J=H.b(M,U,!0);W.Af(J,8);this.Iyl(M,J,V,X);return J}Iyl(M,J,V,X){M=new x.a(f.GraphIterator.$a(M),f.GraphIterator.$a(J),null,null);V=new l.a(V,X,M);V.Gh=!0;V.Jl("ExecuteInternalFootnoteEndnotePaste");V.run()}k5d(M,
J){M.Sb(7);this.uE.Rxi(M,J)||M.Pf(7)}Nai(M,J){const V=this.Wc.Bk();V.set(J);V.zb(7);V.jd(7);this.k5d(V,M);return V}rci(M,J,V){return this.Aci(M,J,V,!1)}W9l(M,J,V){return this.Aci(M,J,V,!0)}Aci(M,J,V,X){var W=this.Wc.Bk();let U=null,Y=!1;W.set(M);W.Bp();W.jd(8);W.Pd();for(W=y.a.Rs(W,W.Jbd(8));W.moveNext();){if(n.ParagraphReader.Wb(W.currentNode)){const aa=W.currentNode;var ba=L.i(aa,7);for(const fa of ba){if(aa===M){ba=fa.Ib.cp;if(X&&ba>=J)return U;ba>=J&&-1!==J&&(Y=!0)}if(fa.V3()===V){if(!X&&Y)return fa;
U=fa}}aa===M&&(Y=!0)}if(X&&Y)return U}return null}j4n(M){const J=new u.GraphTransaction(3);J.Cb(M);M=y.a.Zo(Q.Oh.Ys(M));let V=1,X=1;for(;M.moveNext();){var W=M.currentNode;if(W&&n.ParagraphReader.Wb(W)){W=L.i(W,7);for(const U of W){W=U.W3();const Y=U.V3()?V++:X++;this.Pjo(W,Y)}}}J.dispose()}V3(M){return this.uE.xoa(M)?M.properties.getValue(G.a.N3):0}static HYl(){return new Q(N.a.instance,z.PageReader.instance,w.PageNavigator.instance,new E.a,Q.TLl)}static TLl(){return I.App.sn.ib.Uc}static get Oh(){return w.PageNavigator.instance}static get instance(){return null!=
Q.$Bg?Q.$Bg:Q.$Bg=Q.HYl()}}Q.SYd=!1;Object(F.a)(Q,"FootnoteEndnoteEditorInteractive",null,[497])},1553:function(F,K,c){F=c(0);class l{static n5l(){return l._nextEventReceiverId++}}l._nextEventReceiverId=0;Object(F.a)(l,"EventReceiverIdCounter",null,[]);c.d(K,"a",function(){return f});class f{constructor(a,k){this.ZUb=a;this._id=l.n5l();this.eik=k}get id(){return this._id}notify(a,k){this.eik(a,k)}ek(a,k){return this.ZUb.qMn(a,k?this:null)}}Object(F.a)(f,"EventReceiver",null,[426])},1556:function(F,
K,c){c.d(K,"a",function(){return H});F=c(0);var l=c(7),f=c(9),a=c(527),k=c(36),x=c(58),y=c(2038),n=c(2),u=c(1514),z=c(1526),w=c(118),E=c(590),G=c(1506);class H{static C6m(){const L=document.getElementsByClassName(E.a.oXf);if(L&&L.length){var I=L[0].clientWidth;for(let N=1;N<L.length;N++){if(L[N].clientWidth!==I||N===L.length-1){l.ULS.sendTraceTag(540160401,327,50,"{0}:NoOfContainers={1}",L[N].clientWidth-I,L.length);break}I=L[N].clientWidth}}}static qsg(L,I,N){L&&(L=f.App.rd.Tp.Rrf(L),a.CoauthLockEditor.getInstance().P6a(L)&&
l.ULS.sendTraceTag(540160402,327,15,`Comment with ObjectId: ${I.objectId} added to a locked ${N?"start":"end"} paragraph. Lock Type ${L.Type.toString()}`))}static g3o(L,I,N){var Q=I.Db(x.a.Ef(L.objectId));if(Q){var M=u.a.Eba(Q,I,!0);I=u.a.Eba(Q,I,!1);null!==M&&void 0!==M&&M.ev||(M=G.k(Q),l.ULS.sendTraceTag(540160404,327,15,`CommentRangeStart failed to save. startParaId: ${M}, CommentObjectId: ${L.objectId}`),H.NJi(N));null!==I&&void 0!==I&&I.ev||(Q=G.h(Q),l.ULS.sendTraceTag(540160405,327,15,`CommentRangeEnd failed to save. endParaId: ${Q}, CommentObjectId: ${L.objectId}`),
H.NJi(N))}else l.ULS.sendTraceTag(540160403,327,15,`Commited Comment missing CommentNode graph object ObjectId: ${L.objectId}`)}static NJi(L){L.logKpiFailure(z.a.tGh,"CommentReferenceFailedToSave",{isIntentional:!1,isInternal:!0},{name:z.a.REd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1})}static I5m(L,I,N){0!==L.size&&L.forEach(Q=>{I.has(Q)||H.N5m(Q,N)})}static N5m(L,I){I.Db(x.a.Ef(L))&&l.ULS.sendTraceTag(539800642,327,15,`comment start missing for ${L}`)}static MWk(L){const I=new Set;
L.forEach(N=>{N&&N.qj&&((N=H.rdi(N))?I.add(N):l.ULS.sendTraceTag(539554689,327,15,"Outline Node is undefined"))});I.forEach(N=>{const Q=N.ia(w.a.h9e,[]);0===N.ia(w.a.f9e,[]).length&&0===Q.length&&l.ULS.sendTraceTag(539800644,327,15,`Outline Element Node ${N.id.toString()} is missing comment info while paragraph has comments. This will cause some comments to fail to load.`)})}static LVm(L,I,N,Q){L=N.P6h(L);if(!L)return!1;N=G.k(L,x.a.nil);Q=Q.Db(N);I.has(N.toString())&&l.ULS.sendTraceTag(539800643,
327,15,`Para Node ${N} missing comment reference for comment ${L.id}`);return Q&&Q.qj?!0:(l.ULS.sendTraceTag(539567714,327,15,`Para Node ${N} with missing comment reference for comment ${L.id} is in a invalid state ${Q?"paraNode containingGraph is null":"paraNode is null"}`),!1)}static rdi(L){let I;try{I=k.OutlineElementNavigator.Gl(L)}catch(N){l.ULS.sendTraceTag(539567715,327,10,`ParaNode ${L.id} OutlineNode failed to retrieve ${N}`)}return I}static OVl(L){var I;switch(null===(I=L.lz)||void 0===
I?void 0:I.sessionType){case y.a.create:return z.a.d9e;case y.a.reply:return z.a.fFd;case y.a.edit:return z.a.yGh}}static lDh(L){if(n.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForDuplicateReactionUsers",!0)&&(L=L[1])&&0!==L.length){var I=new Set;for(let N=0;N<L.length;N++)I.add(L[N].UserId);L.length>I.size&&l.ULS.sendTraceTag(521458447,327,15,`Reaction UserList has duplicates: ${L.length-I.size}`)}}}Object(F.a)(H,"CommentDiagnosticHelpers",null,[])},1557:function(F,
K,c){c.d(K,"a",function(){return l});F=c(0);class l{}l.open="open";l.refresh="refresh";l.k9f="saveAs";l.translate="translate";l.modeSwitch="modeSwitch";l.sbf="createNew";Object(F.a)(l,"ReasonList",null,[])},1558:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{static Aad(f){if(!f)return"{NULL}";const a=f.length;if(600>=a)return f;const k=a-195;return f.substring(0,400)+"[...]"+f.substring(k,a)}}Object(F.a)(l,"LogUtils",null,[])},1559:function(F,K,c){c.d(K,"b",function(){return l});c.d(K,
"a",function(){return f});c.d(K,"c",function(){return a});const l=(k,x,y,n,u,z,w,E)=>{var G=1;if(!k&&!x||!y||!n)return G;u&&z?(z=y+k,G=n+x,k=1/y,x=1/n,u=k>x?k:x,1>z?z=1:1920<z&&(z=1920),1>G?G=1:1280<G&&(G=1280),k=z-y,x=G-n,E?(y=z/y,n=G/n,G=Math.abs(y-w)<Math.abs(n-w)?y:n):G=Math.abs(k/y)>Math.abs(x/n)?z/y:G/n,G<u&&(G=u)):u?(w=y+k,1>w?w=1:1920<w&&(w=1920),G=w/y):z&&(w=n+x,1>w?w=1:1280<w&&(w=1280),G=w/n);return G},f=(k,x)=>{k=Math.atan2(x.y-k.y,x.x-k.x);0>k&&(k+=2*Math.PI);return k},a=k=>{k%=360;0>
k&&(k+=360);return k}},1560:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}Object(F.a)(l,"SmartLookupSelection",null,[])},1562:function(F,K,c){c.d(K,"a",function(){return N});F=c(0);var l=c(22),f=c(887),a=c(536),k=c(32),x=c(172),y=c(6),n=c(42),u=c(16),z=c(7),w=c(111),E=c(67),G=c(55),H=c(468),L=c(144),I=c(1045);class N{constructor(Q,M,J,V,X,W){this.rpk=Q;this.we=M;this.rwf=J;this.wLa=V;this.vCe=X;this.uCe=W}get yk(){return null!=this.MHg?this.MHg:this.MHg=l.a.instance.resolve("WordEditor.ITableEditor")}get Ld(){return null!=
this.PIg?this.PIg:this.PIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get nj(){return null!=this.vIg?this.vIg:this.vIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get GRb(){return this.rpk.value}get mcd(){return this.we.value}NZk(Q){const M=this.GRb.$8b(Q,f.a.U5d);M&&(this.L6a(M,Q),this.nda(1696,Q))}L6a(Q,M,J=!0){const V=this.GRb.jib(M);if(V&&(Q=this.mcd.kg(Q),V.Di(Q))){const X=this.GRb.YT(M);let W="Unknown";this.GRb.mta.value&&(W=
this.GRb.mta.value.mb(Q)?Q:"CustomStyle");z.ULS.sendTraceTag(0,311,50,"{0}",{["ApplyTableStyleId"]:W,["RowCount"]:this.vCe(M),["ColumnCount"]:this.uCe(M),["HR"]:!!(X&32),["FC"]:!!(X&128),["TR"]:!!(X&64),["LC"]:!!(X&256),["BR"]:!(X&512),["BC"]:!(X&1024),["TableId"]:M.id.toString()});J&&this.$ia(M);this.wng(M,V);J=V.Di(Q);M.properties.setValue(y.a.tableStyle,J.id);this.W7e(M);M.pT.D8(!0)}}FOb(Q,M,J){if(Q=this.GRb.$8b(J,Q))this.nda(M,J),this.L6a(Q,J)}nda(Q,M,J=!0){J&&this.$ia(M);M.properties.setValue(y.a.tableLook,
Q);z.ULS.sendTraceTag(0,311,50,"{0}",{["HR"]:!!(Q&32),["FC"]:!!(Q&128),["TR"]:!!(Q&64),["LC"]:!!(Q&256),["BR"]:!(Q&512),["BC"]:!(Q&1024),["TableId"]:M.id.toString()});M.pT.D8(!0)}wng(Q,M){(Q=this.wLa(Q))&&M.vjc(Q)}W7e(Q){if(Q.isConnected){Q.hasProperty(n.a.Vv)&&Q.removeProperty(n.a.Vv);this.R5f(Q);this.I4c(Q);Q=this.rwf.Vf(Q);for(var M=Q.Sb(1);M;){for(M=Q.Sb(1);M;)M.hasProperty(u.a.wH)&&M.removeProperty(u.a.wH),M.hasProperty(y.a.Mqa)&&M.removeProperty(y.a.Mqa),this.zSa(M),this.I4c(M),M=Q.zi(1);M=
Q.zi(1)}}}OSd(Q){let M=Q.ia(n.a.WRa,null);if(M)return M;if(Q=this.mcd.kg(Q))if(M=({value:M}=this.GRb.mta.value.Dc(Q,M)).returnValue?M:null)return M;return Q}lag(Q,M,J,V,X){Q.properties.setValue(M.style,J);Q.properties.setValue(M.size,V*L.a.W1b);Q.properties.setValue(M.color,X)}$ia(Q){if(this.Ld.rg){var M;Object(w.a)(H.a,Q)&&(M=Object(E.a)(H.a,Q))&&(M=M.FR())&&this.nj.$ia(Q,M)}}R5f(Q){Q.Eg(y.a.Wa,y.a.Xa,y.a.Lqa,y.a.ob,y.a.pb,y.a.Jqa,y.a.Ua,y.a.Va,y.a.Iqa,y.a.qb,y.a.rb,y.a.Kqa,y.a.tb,y.a.ub,y.a.Oya,
y.a.Lb,y.a.Mb,y.a.Pya)}zSa(Q){Q.Eg.apply(Q,this.yk.L6e)}I4c(Q){Q.Eg(y.a.Ca,y.a.za,y.a.Aa,y.a.Ba,y.a.tP,y.a.NR,y.a.dIa,y.a.bIa)}static Wuf(){return new N(l.a.instance.Ue("WordEditor.IWACTableStyleReader"),l.a.instance.Ue("Box4.Styles.IWACStyleReader"),new a.a,Object(G.a)(N.Oh,N.Oh.Ys,"navigateToPageContentNode"),k.TableReader.ag,k.TableReader.Zg,I.a.instance)}static get Oh(){return x.PageNavigator.instance}static get instance(){return null!=N.YCg?N.YCg:N.YCg=N.Wuf()}}Object(F.a)(N,"WACTableStyleEditor",
null,[489,20])},1563:function(F,K,c){c.d(K,"a",function(){return N});F=c(0);var l=c(113),f=c(2),a=c(538),k=c(236),x=c(334),y=c(1527),n=c(766),u=c(302),z=c(501),w=c(854);c.n(w);var E=c(599),G=c(1399),H=c(1660),L=c(104),I;(function(Q){Q[Q.Spelling=0]="Spelling";Q[Q.Grammar=1]="Grammar";Q[Q.Style=2]="Style";Q[Q.goc=3]="Similarity";Q[Q.Pqg=4]="ContextIQ";Q[Q.fNj=5]="AutoReplace"})(I||(I={}));Object(F.b)("AnnotationRenderCategory",I);class N{static DTl(Q){switch(N.$Rd(Q)){case I.Spelling:Q=y.a.Wfg;break;
case I.Grammar:Q=y.a.y$e;break;case I.goc:Q=60!==Q.M_.state&&70!==Q.M_.state?y.a.Htj:y.a.Gtj;break;case I.Pqg:if(H.a.Rqg()&&H.a.pCi(Q))return;Q=y.a.kAd;break;case I.fNj:Q=y.a.ABd;break;default:Q=y.a.kAd}return Q}static mim(Q){switch(N.$Rd(Q)){case I.Spelling:return u.f.SpellingSquiggle;case I.Grammar:return u.f.GrammarSquiggle;default:return u.f.CritiqueSquiggle}}static $Rd(Q){let M;if(N.mWc(Q))switch(Q.priority){case 0:M=I.Spelling;break;case 1:M=I.Grammar;break;default:M=I.Style}else N.Ubc(Q)?M=
I.goc:N.qUc(Q)&&(M=I.Pqg);return M}static mWc(Q){Q=k.a.getTypeNameFor(Q);return Q===x.a.getTypeName()||Q===n.a.getTypeName()}static qUc(Q){return k.a.getTypeNameFor(Q)===w.FlagAnnotation.getTypeName()}static Ubc(Q){return k.a.getTypeNameFor(Q)===a.a.getTypeName()}static T_d(Q){return N.mWc(Q)?0===Q.priority:!1}static kZd(Q){return N.mWc(Q)?1===Q.priority:!1}static YFm(Q){return k.a.getTypeNameFor(Q)===n.a.getTypeName()}static WBf(Q){return null!=Q&&"Spelling"===Q.categoryName&&1===Q.suggestions.length&&
4===(Q.suggestions[0].suggestionActions&4)}static Yem(Q,M){const J=[u.b.IgnoreOnce];switch(Q){case 0:J.push(u.b.IgnoreAll);M&&J.push(u.b.AddToDictionary);break;case 1:J.push(u.b.Options)}return J}static M5h(Q){return N.mWc(Q)?Q.categoryName:N.Ubc(Q)?N.Ftj:N.qUc(Q)?N.lGl:null}static muf(Q,M){let J=z.a.Ejc;switch(Q){case 0:J=M?z.a.fie:z.a.Ppj;break;case 1:J=z.a.Opj}return J}static o7b(Q,M=!1,J){J="IntentProvider_Suggestion_"+J;let V=l.a.Db(Q,J);M&&!V&&l.a.Kl(Q,J,V=new E.a);return V}static Owf(Q,M,J,
V,X,W,U,Y,ba=!1,aa){V&&J&&(!(J=W.W3h(J,X))||!f.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")&&f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)&&this.$Rd(J)==I.Style||(U.HKd(Q,M,Y),N.o7b(Q,!0,aa).add(J.id),M=N.DTl(J),Q.classList.add(M),N.hRb&&N.aZe(Q,J),ba&&G.a.BYc()))}static get hRb(){return null!=N.qJg?N.qJg:N.qJg=f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}static aZe(Q,
M){N.T_d(M)?Q.setAttribute("aria-invalid","spelling"):N.kZd(M)&&Q.setAttribute("aria-invalid","grammar")}static jQa(Q,M,J){Q=(Q=N.o7b(Q,!1,J))?L.firstOrDefault(Q):null;return{returnValue:!!Q,type:Q?J:null,data:Q}}}N.Ftj="Similarity";N.lGl="FlagAnnotation";Object(F.a)(N,"AnnotationHelper",null,[])},1575:function(F,K,c){c.d(K,"a",function(){return a});F=c(0);var l=c(172),f=c(242);class a{u4a(k){a.Oh.fP(k);return k.Sb(16)}static Mr(){return new f.a(()=>new a)}static get instance(){return a._instance.value}static get Oh(){return l.PageNavigator.instance}}
a._instance=a.Mr();Object(F.a)(a,"CommentNavigator",null,[411])},1577:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l extends Sys.EventArgs{constructor(){super();this.WUi=this.kGa=null}}Object(F.a)(l,"OnCommentInitArgs",Sys.EventArgs,[])},1578:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);var l=c(7);class f{constructor(a){this.pj=a}get lf(){return this.pj&&this.pj.Wi?this.pj:null}USa(a,k){return this.lf?this.lf.m6e(a,!0)?this.lf.USa(a,k,!0,!0,!1):(l.ULS.sendTraceTag(579396803,
377,15,"ScrollToHighlightParagraph: unable to scroll to desired paragraph"),null):null}}Object(F.a)(f,"PageViewWrapper",null,[])},1579:function(F,K,c){c.d(K,"a",function(){return y});F=c(0);var l=c(54),f=c(153),a=c(7),k=c(84),x=c(61);class y{constructor(n,u,z){a.ULS.shipAssertTag(6305502,307,!!n);this.properties=n;this.Jc=u;this.XS=z}fei(){return this.properties.ia(f.a.iP,"")}n3i(){return!0}JCj(){let n=!1,u=null;const z=this.fei();if(this.XS||""!==z)try{({$ua:u,returnValue:n}=this.xmc(z))}catch(w){a.ULS.shipAssertTag(4203138,
307,!1),this.Jc.Yb(k.a.kna,{["Reason"]:x.a.V4e}),l.a.f_(u)}else a.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Jc.Yb(k.a.s1,{["Reason"]:x.a.vjf});return{returnValue:n,TFd:u}}}Object(F.a)(y,"AStringInputImportStrategy",null,[776])},1580:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.r$=[]}x7h(){const f=new l;for(let a=0;a<this.r$.length;a++)f.add(this.J(a));return f}get count(){return this.r$.length}J(f){return this.r$[f]}Z(f,a){return this.r$[f]=
a}add(f){this.r$.push(f)}clear(){Array.clear(this.r$)}contains(f){return Array.contains(this.r$,f)}getRange(f,a){const k=new l;for(let x=0;x<a;x++)k.add(this.J(f+x));return k}indexOf(f){return Array.indexOf(this.r$,f)}insert(f,a){Array.insert(this.r$,f,a)}remove(f){return Array.remove(this.r$,f)}removeAt(f){Array.removeAt(this.r$,f)}removeRange(f,a){for(let k=0;k<a;k++)Array.removeAt(this.r$,f)}reverse(){this.r$.reverse()}sort(){this.r$.sort()}toArray(){return Array.clone(this.r$)}}Object(F.a)(l,
"List",null,[])},1582:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}l.generalException="GeneralException";l.invalidArgument="InvalidArgument";l.notImplemented="NotImplemented";l.dzb="AccessDenied";l.JWm="ItemNotFound";l.notSupported="NotSupported";l.apiNotAvailable="ApiNotAvailable";l.notAllowed="NotAllowed";l.qyn="OperationCancelled";l.userNotSignedIn="UserNotSignedIn";l.userAborted="UserAborted";l.invalidResourceUrl="InvalidResourceUrl";l.invalidGrant="InvalidGrant";l.clientError=
"ClientError";l.serverError="ServerError";Object(F.a)(l,"ErrorCodes",null,[])},1583:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f){this.id=f}}Object(F.a)(l,"DesignerPaneToggleData",null,[])},1585:function(F,K,c){c.d(K,"a",function(){return x});F=c(0);var l=c(1861),f=c(536),a=c(6),k=c(1044);class x{constructor(y){this.tXl=(n,u)=>{const z=this.Yfi(n),w=this.Wc.Vf(u);return w.zb(z)?(w.jd(z),new l.a(w.currentNode,u,n)):null};this.sXl=(n,u)=>{let z=null,w=null;const E=this.Yfi(n);
u=this.Wc.Vf(u);({rootNode:z,jja:w}=this.Eno(u,n,E,z,w));return z&&w?new l.a(z,w,n):null};this.xXl=n=>{n=this.Wc.Vf(n);return(this.V8(2)||this.V8(4))&&n.zb(36)?(n.jd(36),this.wEl(n.currentNode)):(this.V8(8)||this.V8(16))&&n.zb(37)?(n.jd(37),this.S_h(n.currentNode)):this.V8(32)&&n.zb(40)?32:this.V8(1)&&n.zb(8)?1:0};this.Wc=y;this.xEl=this.xXl;this.iEl=this.tXl;this.hEl=this.sXl;this.NEl=31;this.thg=this.BXl()}q9h(y){const n=[],u=this.xEl(y);if(u){var z=this.iEl(u,y);z&&(n[n.length]=z)}for(const w of this.thg)w!==
u&&w&&(z=this.hEl(w,y))&&(n[n.length]=z);return n}V8(y){return!!y&&!!(this.NEl&y)}Eno(y,n,u,z,w){if(y.zb(7)){y.jd(7);if(8===u||37===u||39===u)for(var E=y.Pd();E;){if(E.type===u)if(37===u){if((8===n||16===n)&&n===this.S_h(E)){z=y.currentNode;break}}else{z=y.currentNode;break}E=y.Lj()}z&&y.vz()&&(E=this.Wc.Vf(z),k.b(E,u,n)&&(w=y.currentNode))}return{rootNode:z,jja:w}}BXl(){const y=[];this.V8(1)&&(y[y.length]=1);this.V8(2)&&(y[y.length]=2);this.V8(4)&&(y[y.length]=4);this.V8(8)&&(y[y.length]=8);this.V8(16)&&
(y[y.length]=16);this.V8(32)&&(y[y.length]=32);return y}Yfi(y){let n=8;switch(y){case 1:case 2:case 4:n=8;break;case 8:case 16:n=37;break;case 32:n=39}return n}S_h(y){y=y.properties.getValue(a.a.N3);return this.V8(8)&&1===y?8:this.V8(16)&&!y?16:0}wEl(y){y=y.getValue(a.a.L9b);return this.V8(2)&&x.tMm(y)?2:this.V8(4)&&x.RLm(y)?4:0}static ZE(){return new x(new f.a)}static get instance(){return null!=x.fCg?x.fCg:x.fCg=x.ZE()}static tMm(y){return y&&1!==y&&2!==y?!1:!0}static RLm(y){return 3===y||4===y||
5===y?!0:!1}}Object(F.a)(x,"WordFindContextHelper",null,[393])},1593:function(F,K,c){c.d(K,"a",function(){return a});F=c(0);var l=c(90),f=c(1531);class a{constructor(k){this.taskManager=k}o0a(k,x){const {priority:y=2,delay:n=0}=null!==x&&void 0!==x?x:{},u=new f.a,z=async()=>await k();x=new l.a(y,1,n,()=>{z().then(u.resolve).catch(u.reject)});this.taskManager.Vb(x);return u.completion}}Object(F.a)(a,"TaskDispatcher",null,[])},1601:function(F,K,c){var l=c(1529);F=c(0);class f{}Object(F.a)(f,"SerializableAnchorDataV1",
null,[]);class a{}Object(F.a)(a,"SerializableCpDataV1",null,[]);var k=c(982);c.d(K,"a",function(){return x});c.d(K,"c",function(){return y});c.d(K,"b",function(){return n});c.d(K,"d",function(){return u});const x=z=>new l.a(z.RK,z.PS,z.TS,c(1633).versionedDeserialize(z.OS),z.PE,z.TE,c(1633).versionedDeserialize(z.OE),z.DK,z.SI),y=z=>{const w=new f;w.RK=z.Nce;w.PS=z.TRa;w.TS=z.w7a;w.DK=z.BH;w.SI=z.shapeId;z.xR&&(w.OS=u(z.xR));z.FGa&&(w.PE=z.FGa);z.ylc&&(w.TE=z.ylc);z.D4&&(w.OE=u(z.D4));return w},n=
z=>{if(!z)return null;const w=new k.a(z.CP);w.rva=null!=z.FB?z.FB:0;w.wga=null!=z.FE?z.FE:0;w.qua=null!=z.CB?z.CB:0;w.rua=null!=z.CE?z.CE:0;w.JPa=null!=z.HB?z.HB:0;w.dha=null!=z.HE?z.HE:0;w.sya=null!=z.R?z.R:0;w.ova=null!=z.E?z.E:0;w.Uya=null!=z.TW?z.TW:0;w.Kxa=null!=z.PB?z.PB:0;w.symbols=null!=z.SYM?z.SYM:0;w.rwa=null!=z.IE?z.IE:0;w.rxa=null!=z.OO?z.OO:0;w.Gta=null!=z.AX?z.AX:0;w.wua=null!=z.CCI?z.CCI:0;w.dryDeletion=null!=z.DD?z.DD:0;return w},u=z=>{if(!z)return null;const w=new a;w.CP=z.cp;w.VS=
1;0<z.rva&&(w.FB=z.rva);0<z.wga&&(w.FE=z.wga);0<z.qua&&(w.CB=z.qua);0<z.rua&&(w.CE=z.rua);0<z.JPa&&(w.HB=z.JPa);0<z.dha&&(w.HE=z.dha);0<z.sya&&(w.R=z.sya);0<z.ova&&(w.E=z.ova);0<z.Uya&&(w.TW=z.Uya);0<z.Kxa&&(w.PB=z.Kxa);0<z.symbols&&(w.SYM=z.symbols);0<z.rwa&&(w.IE=z.rwa);0<z.rxa&&(w.OO=z.rxa);0<z.Gta&&(w.AX=z.Gta);0<z.wua&&(w.CCI=z.wua);0<z.dryDeletion&&(w.DD=z.dryDeletion);return w}},1611:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a="",k="",x=""){this.IsCurrentUser=
!1;this.UserId=f;this.Provider=a;this.DisplayName=k;this.Email=x}}Object(F.a)(l,"CommentTaskPerson",null,[915])},1612:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a,k,x,y=!1){this.priority=this.completion=-1;this.type=f;this.user=a;this.time=k;this.recordId=x;this.isLossy=y}}Object(F.a)(l,"HistoryRecord",null,[])},1613:function(F,K,c){c.d(K,"a",function(){return k});F=c(0);var l=c(498),f=c(391),a=c(610);class k{constructor(){this.fLg=null;this.fY=!1;this.wKb=this.Xeb=
null;this.Sx=new l.a(new f.a);this.HU=new l.a(new f.a);this.W2f=this.BGb=!1;this.U6a=!0}get Zm(){return a.a.Zm}set Zm(x){a.a.Zm=x}get Adb(){return this.fLg}set Adb(x){this.fLg=x}}k.Kj=1;Object(F.a)(k,"CommentsState",null,[])},1614:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}l.yellow="FFFF00";l.s_m="00FF00";l.lHk="00FFFF";l.IJl="FF00FF";l.blue="0000FF";l.red="FF0000";l.$gn="000080";l.teal="008080";l.green="008000";l.purple="800080";l.lbn="800000";l.Rkn="808000";l.gray="808080";
l.zAo="C0C0C0";l.black="000000";Object(F.a)(l,"FontHighlightColorEnum",null,[])},1615:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.H$={};this.H$.ops=[]}iha(f){const a=this.H$.ops;if(a.length){var k=a.length-1;const x=a[k];if(!x.attributes){x.insert+=f;a[k]=x;this.H$.ops=a;return}}k={};k.insert=f;Array.add(a,k)}Gsi(f,a){const k={};this.nnj(k,a);Array.add(this.H$.ops,this.f4b(f,k))}yAf(f,a,k,x=!1){var y={};y.fullName=a.fullName;y.email=a.email;y.resolveState=a.resolveState;
a={};a.atmention=y;f=this.f4b(f,a);k&&(y={},y.contentId=k.contentId,a={},a.atmention=y,x&&(y.isCurrentUser=k.isCurrentUser),f.optional=a);Array.add(this.H$.ops,f)}insertImage(f,a){f=this.f4b(f,{});const k={};k.base64=a.base64;a={};a.image=k;f.optional=a;Array.add(this.H$.ops,f)}osi(f,a){const k={};k.link=a.link;this.nnj(k,a);Array.add(this.H$.ops,this.f4b(f,k))}gOc(){return Sys.Serialization.JavaScriptSerializer.serialize(this.H$)}f4b(f,a){const k={};k.insert=f;k.attributes=a;return k}nnj(f,a){this.hOb(a.weight>=
l.vNf,f,"weight",a.weight);this.hOb(a.italic,f,"italic",!0);this.hOb(a.underline,f,"underline",!0);this.hOb(a.strikethrough,f,"strikethrough",!0);this.hOb(!!a.highlight,f,"highlight",a.highlight);this.hOb(!!a.color,f,"color",a.color);this.hOb(!!a.paragraph,f,"paragraph",a.paragraph)}hOb(f,a,k,x){f&&(a[k]=x)}static tEb(f){return Sys.Serialization.JavaScriptSerializer.deserialize(f,!0)}}l.vNf=700;Object(F.a)(l,"DeltaFormatCreator",null,[870])},1616:function(F,K,c){c.d(K,"a",function(){return a});F=
c(0);var l=c(583),f=c(391);class a{constructor(k=!1){this.OM=null;this.T1a=!1;k&&(this.OM=new l.a(new f.a))}}Object(F.a)(a,"OpenCommentInfo",null,[])},1617:function(F,K,c){c.d(K,"b",function(){return u});c.d(K,"a",function(){return z});c.d(K,"c",function(){return w});c.d(K,"d",function(){return E});c.d(K,"e",function(){return G});var l=c(20),f=c(2),a=c(118),k=c(7),x=c(453),y=c(438),n=c(257);const u=()=>l.a.iu,z=()=>void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1,w=H=>!!H&&H.isConnected,
E=(H,L,I,N)=>{if(!L||!L.isConnected)return H.dispose(),!1;const Q=L.Vi(),M=L.ia(a.a.EJ,n.a.Jt),J={};J[x.a.nodeId]=L.id.toString();J[x.a.cellId]=Q.nm.toString();J[x.a.fileId]=Q.vr;J[x.a.$ta]=Q.contentReplicator.Ht.toString();J[x.a.IM]=Q.contentReplicator.IM;J[x.a.jX]=I.toString();J[x.a.lcid]=f.AFrameworkApplication.lcid.toString();J[x.a.accessToken]=f.AFrameworkApplication.accessToken;J[x.a.classId]=L.Rc.toString();J[x.a.EJ]=M;N=N||{};for(const V of y.a(N))J[V]=N[V];for(const V of y.a(J))H.b4b(V,J[V]);
return!0},G=(H,L,I)=>{const N={};N.IsResponseNull=!L;L&&(N.OperationResult=L.StatusCode,N.RevisionListLength=L.RevisionList?L.RevisionList.length.toString():"null");k.ULS.sendTraceTag(36783366,322,50,"UploadResponseReceived: {0}",N);I&&I.isConnected&&(L&&!L.StatusCode?(I.GH().contentReplicator.cF(null,null,null),H.r0o()):H.aMb(null,L?L.StatusCode:14))}},1618:function(F,K,c){var l=this&&this.gC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:
function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1833),K);f(c(1834),K)},1619:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(F.a)(l,"InsightsParameters",null,[])},1623:function(F,K,c){c.d(K,"a",function(){return M});F=c(0);var l=
c(22),f=c(887),a=c(56),k=c(5),x=c(32),y=c(172),n=c(6),u=c(42),z=c(16),w=c(7),E=c(242),G=c(111),H=c(67),L=c(55),I=c(77),N=c(468),Q=c(144);class M{constructor(J,V,X,W,U,Y){this.Xu=J;this.x5j=V;this.Ogd=X;this.wLa=W;this.vCe=U;this.uCe=Y;this.mta=new E.a(()=>this.NSd())}get yk(){return null!=this.NHg?this.NHg:this.NHg=l.a.instance.resolve("WordEditor.ITableEditor")}get Ld(){return null!=this.RIg?this.RIg:this.RIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get nj(){return null!=
this.wIg?this.wIg:this.wIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get M4e(){return this.Xu.value}L6a(J,V,X=!0){const W=this.M4e.jib(V);if(W&&(J=this.x5j(J),W.Di(J))){const U=this.M4e.YT(V);let Y="Unknown";this.mta.value&&(Y=this.mta.value.mb(J)?J:"CustomStyle");w.ULS.sendTraceTag(39661653,311,50,"{0}",{["ApplyTableStyleId"]:Y,["RowCount"]:this.vCe(V),["ColumnCount"]:this.uCe(V),["HR"]:!!(U&32),["FC"]:!!(U&128),["TR"]:!!(U&64),["LC"]:!!(U&256),["BR"]:!(U&512),["BC"]:!(U&
1024),["TableId"]:V.id.toString()});X&&this.$ia(V);this.wng(V,W);X=W.Di(J);V.properties.setValue(n.a.tableStyle,X.id);this.W7e(V);V.pT.D8(!0)}}FOb(J,V,X){if(J=this.M4e.$8b(X,J))this.nda(V,X),this.L6a(J,X)}nda(J,V,X=!0){X&&this.$ia(V);V.properties.setValue(n.a.tableLook,J);w.ULS.sendTraceTag(39661654,311,50,"{0}",{["HR"]:!!(J&32),["FC"]:!!(J&128),["TR"]:!!(J&64),["LC"]:!!(J&256),["BR"]:!(J&512),["BC"]:!(J&1024),["TableId"]:V.id.toString()});V.pT.D8(!0)}wng(J,V){(J=this.wLa(J))&&V.vjc(J)}W7e(J){if(J.isConnected){J.hasProperty(u.a.Vv)&&
J.removeProperty(u.a.Vv);this.R5f(J);this.I4c(J);J=this.Ogd(J);for(var V=J.Sb(1);V;){for(V=J.Sb(1);V;)V.hasProperty(z.a.wH)&&V.removeProperty(z.a.wH),V.hasProperty(n.a.Mqa)&&V.removeProperty(n.a.Mqa),this.zSa(V),this.I4c(V),V=J.zi(1);V=J.zi(1)}}}R5f(J){J.Eg(n.a.Wa,n.a.Xa,n.a.Lqa,n.a.ob,n.a.pb,n.a.Jqa,n.a.Ua,n.a.Va,n.a.Iqa,n.a.qb,n.a.rb,n.a.Kqa,n.a.tb,n.a.ub,n.a.Oya,n.a.Lb,n.a.Mb,n.a.Pya)}zSa(J){J.Eg.apply(J,this.yk.L6e)}I4c(J){J.Eg(n.a.Ca,n.a.za,n.a.Aa,n.a.Ba,n.a.tP,n.a.NR,n.a.dIa,n.a.bIa)}lag(J,
V,X,W,U){J.properties.setValue(V.style,X);J.properties.setValue(V.size,W*Q.a.W1b);J.properties.setValue(V.color,U)}NSd(){const J=new I.a;J.Z(f.a.k$c,WordEditorIntl.WordEditorStrings.L_TableGrid);J.Z(f.a.K$d,WordEditorIntl.WordEditorStrings.L_PlainTable1);J.Z(f.a.L$d,WordEditorIntl.WordEditorStrings.L_PlainTable2);J.Z(f.a.M$d,WordEditorIntl.WordEditorStrings.L_PlainTable3);J.Z(f.a.N$d,WordEditorIntl.WordEditorStrings.L_PlainTable4);J.Z(f.a.O$d,WordEditorIntl.WordEditorStrings.L_PlainTable5);J.Z(f.a.FUd,
WordEditorIntl.WordEditorStrings.L_TableGridLight);J.Z(f.a.PTd,WordEditorIntl.WordEditorStrings.L_GridTable1Light);J.Z(f.a.JTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.KTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.LTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.MTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,
Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.NTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.OTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.WTd,WordEditorIntl.WordEditorStrings.L_GridTable2);J.Z(f.a.QTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.RTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel6));
J.Z(f.a.STd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.TTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.UTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.VTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.cUd,WordEditorIntl.WordEditorStrings.L_GridTable3);J.Z(f.a.XTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,
Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.YTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.ZTd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.$Td,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.aUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.bUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable3,
Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.jUd,WordEditorIntl.WordEditorStrings.L_GridTable4);J.Z(f.a.dUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.eUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.fUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.gUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel8));
J.Z(f.a.hUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.iUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.qUd,WordEditorIntl.WordEditorStrings.L_GridTable5Dark);J.Z(f.a.kUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.lUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.mUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,
Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.nUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.oUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.pUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.xUd,WordEditorIntl.WordEditorStrings.L_GridTable6Colorful);J.Z(f.a.rUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));
J.Z(f.a.sUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.tUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.uUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.vUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.wUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,
Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.EUd,WordEditorIntl.WordEditorStrings.L_GridTable7Colorful);J.Z(f.a.yUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.zUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.AUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.BUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,
Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.CUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.DUd,this.Od(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.O1d,WordEditorIntl.WordEditorStrings.L_ListTable1Light);J.Z(f.a.I1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.J1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,
Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.K1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.L1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.M1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.N1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.V1d,WordEditorIntl.WordEditorStrings.L_ListTable2);
J.Z(f.a.P1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.Q1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.R1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.S1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.T1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel9));
J.Z(f.a.U1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.b2d,WordEditorIntl.WordEditorStrings.L_ListTable3);J.Z(f.a.W1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.X1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.Y1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.Z1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,
Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.$1d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.a2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.i2d,WordEditorIntl.WordEditorStrings.L_ListTable4);J.Z(f.a.c2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.d2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel6));
J.Z(f.a.e2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.f2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.g2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.h2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.p2d,WordEditorIntl.WordEditorStrings.L_ListTable5Dark);J.Z(f.a.j2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,
Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.k2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.l2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.m2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.n2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.o2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,
Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.v2d,WordEditorIntl.WordEditorStrings.L_ListTable6Colorful);J.Z(f.a.jdc,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.q2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.r2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.s2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,
Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.t2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.u2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));J.Z(f.a.C2d,WordEditorIntl.WordEditorStrings.L_ListTable7Colorful);J.Z(f.a.w2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));J.Z(f.a.x2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,
Box4Intl.Box4Strings.l_ThemeLabel6));J.Z(f.a.y2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));J.Z(f.a.z2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));J.Z(f.a.A2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));J.Z(f.a.B2d,this.Od(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));return J}Od(J,V){return String.format(WordEditorIntl.WordEditorStrings.L_TableStyleNameWithThemeFormat,
J,V)}$ia(J){if(this.Ld.rg){let V=null;if(Object(G.a)(N.a,J)){const X=Object(H.a)(N.a,J);X&&(V=X.FR())}V&&this.nj.$ia(J,V)}}static Wuf(){return new M(new E.a(()=>a.StyleReader.QTa),a.StyleReader.kg,k.GraphIterator.$a,Object(L.a)(M.Oh,M.Oh.Ys,"navigateToPageContentNode"),x.TableReader.ag,x.TableReader.Zg)}static get Oh(){return y.PageNavigator.instance}static get instance(){return null!=M.ZCg?M.ZCg:M.ZCg=M.Wuf()}}Object(F.a)(M,"TableStyleEditor",null,[581])},1624:function(F,K,c){c.d(K,"a",function(){return l});
c.d(K,"b",function(){return f});F=c(0);var l;(function(a){a[a.Unknown=-1]="Unknown";a[a.Hbp=0]="RichText";a[a.mbp=1]="PlainText";a[a.kbp=2]="Picture";a[a.c$o=3]="ComboBox";a[a.L$o=4]="DropDownList";a[a.V9o=5]="BuildingBlockGallery";a[a.Date=6]="Date";a[a.Cbp=7]="RepeatSectionItem";a[a.$9o=8]="CheckBox";a[a.Bbp=9]="RepeatSection";a[a.Bibliography=10]="Bibliography";a[a.acp=11]="TableOfContents";a[a.kRj=12]="NumberOfContentControlKinds"})(l||(l={}));Object(F.b)("ContentControlKind",l);const f=a=>{for(let k=
0;k<l.kRj;++k)if(l[k]===a)return k;return l.Unknown}},1625:function(F,K,c){c.d(K,"c",function(){return y});c.d(K,"b",function(){return n});c.d(K,"a",function(){return u});var l=c(39),f=c(584),a=c(62),k=c(60),x=c(275);const y=(z,w,E)=>{var G=z.characterData.length;if(w>E||E>G)return null;a:{for(H of z.XG)if(G=H.oc,G.te&&G===k.InteractiveViewManager.instance.Bd){var H=G;break a}H=null}if(!H)return null;H=z.Fj(H.fc);if(!H)return null;G=[];z=z.pa;for(let I=z.Sga(w);I<z.length;I++){var L=z.J(I);if(L.cp>
E||L.cp===E&&w!==E)break;(L=x.a.Tva(H,L.cp))&&0>Array.indexOf(G,L)&&G.push(L)}return G},n=z=>{let w=null;for(const G of z){var E=l.a.getElementBounds(G);w?(z=w,z.x>E.x&&(z.x=E.x),z.x+z.width<E.x+E.width&&(z.width=E.x+E.width-z.x),z.y>E.y&&(z.y=E.y),z.y+z.height<E.y+E.height&&(z.height=E.y+E.height-z.y)):w=E}w||(w=new Sys.UI.Bounds(0,0,0,0));return w},u=(z,w)=>{z=n(z);if(!z.width&&!z.height)return null;const E=document.createElement("div");E.id=w;E.style.position="absolute";E.style.left=z.x+"px";E.style.top=
z.y+"px";E.style.width=z.width+"px";E.style.height=z.height+"px";E.style.zIndex="-9999";a.d(E,f.a.Kzb,"true");return E}},1626:function(F,K,c){var l=this&&this.gC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});
f(c(1855),K);f(c(1856),K);f(c(1857),K);f(c(1858),K);f(c(1859),K)},1627:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f){this.source=f}}Object(F.a)(l,"AcceptAllActionData",null,[])},1629:function(F,K,c){c.d(K,"a",function(){return Q});F=c(0);var l=c(699),f=c(28),a=c(9),k=c(17),x=c(23),y=c(8),n=c(12),u=c(743),z=c(538),w=c(236),E=c(67),G=c(74),H=c(111),L=c(1200),I=c(1528),N=c(854);c.n(N);class Q{constructor(M,J,V,X,W,U,Y){this.KLa=M;this.hb=J;this.Jn=V;this.rn=X;this.s$a=
W;this.T5j=U;this.DUb=Y}Ana(M){return(M=this.rn.Ana(M))&&Object(E.a)(l.a,M.errorDetails)&&!M.errorDetails.Z2a()?M:null}lEa(M){return this.s$a.lEa(M)}lnf(M){if(!M)return null;if(u.a(M.annotationType)){if((M=M.content)&&M.suggestions&&!Q.g1b(M))return M}else if(M.annotationType===z.a.getTypeName()){if((M=M.content)&&M.suggestions)return M}else if(M.annotationType===N.FlagAnnotation.getTypeName()&&(M=M.content)&&M.results)return M;return null}VLd(M,J,V){let X=null,W=null,U=null;var Y=this.Jn.ROc(M,0);
if(!Y||!Y.count)return{returnValue:!1,annotation:X,d5i:W,j1e:U};for(const ba of Y){if(J&&(ba.begin!==M.cpBegin||ba.end!==M.cpEnd))continue;Y=this.lnf(ba.intent);if(!Y||V&&!V(Y))continue;let aa;({stop:aa}=Q.wrj(W,Y)).returnValue&&(X=ba.intent,W=Y,U=f.a.createTextRange(M.node,ba.begin,ba.end));if(aa)break}return{returnValue:!!W,annotation:X,d5i:W,j1e:U}}W3h(M,J){let V=null;for(const X of M){if(X.type)continue;M=this.lnf(X.intent);if(!M||J&&!J(M))continue;let W;({stop:W}=Q.wrj(V,M)).returnValue&&(V=
M);if(W)break}return V}Gii(M,J,V,X,W){const U=new G.a;if(X.yWd){var Y=this.Jn.hPa(M,0,ba=>{if(J>ba.begin||ba.begin>V)return!1;ba=this.lnf(ba.intent);return!ba||Q.g1b(ba)||X.L3c&&!X.L3c(ba)?!1:!0});for(const ba of Y)U.add(ba)}if(X.xWd){Y=this.rn.T3(M,ba=>{if(J>ba.begin||ba.begin>V)return!1;ba=ba.errorDetails;return ba.Z2a()||X.D2c&&!X.D2c(ba)?!1:!0});for(const ba of Y)U.add(ba)}if(X.wWd){M=this.s$a.Hpf(M,ba=>J>ba.begin||ba.begin>V||X.OJc&&!X.OJc(ba.BD)?!1:!0);for(const ba of M)U.add(ba)}U.Sc(W);return U}Kpf(M,
J){return Math.min(Math.abs(J-M.begin),Math.abs(J-M.end))}y5l(M,J,V,X){let W,U=0;X?(X=0,W=J-1):(X=J+1,W=M.characterData.length);V=this.Gii(M,X,W,V,(Y,ba)=>this.Kpf(Y,J)-this.Kpf(ba,J));if(!V.count)return{returnValue:null,offset:U};U=J<V.J(0).begin||J>V.J(0).end?this.Kpf(V.J(0),J):0;return{returnValue:f.a.createTextRange(M,V.J(0).begin,V.J(0).end),offset:U}}qsf(M,J,V,X){let W=0;var U=({offset:W}=this.y5l(M,J,V,X)).returnValue;if(U)return{returnValue:U,offset:W};U=this.KLa.WNh(M,X);if(!U)return{returnValue:null,
offset:W};for(W=X?J:M.characterData.length-J;U.w8();){M=U.Ww;J=this.Gii(M,0,M.characterData.length,V,(Y,ba)=>Y.begin===ba.begin?Y.end-ba.end:Y.begin-ba.begin);if(J.count)return V=X?J.J(J.count-1):J.J(0),W+=X?M.characterData.length-V.end:V.begin,{returnValue:f.a.createTextRange(M,V.begin,V.end),offset:W};W+=M.characterData.length}return{returnValue:null,offset:W}}psf(M,J,V,X){return this.qsf(M,J,V,X).returnValue}JJc(M,J,V){let X=0,W=1;this.psf(M,J,V,!1)&&W++;this.psf(M,J,V,!0)&&(X++,W++);return{index:X,
count:W}}dRl(M,J,V){let X;const W=({offset:X}=this.qsf(M,J<M.characterData.length?J+1:J,V,!0)).returnValue;if(W&&!X)return W;J=({offset:M}=this.qsf(M,1<J?J-1:0,V,!1)).returnValue;return W&&J?X<M?W:J:W?W:J}Yhj(M,J){let V=null;a.App.xa&&Object(H.a)(L.PageView,a.App.xa.ib.rc)&&(V=a.App.xa.ib.rc);if(!V)return!1;this.hb.setSelection(k.SelectionEditor.Cj(x.SelectionFactory.Nn(M),!0,!1));M=V.Ps.$bm();const X=(M-250)/2;V.Ps.e5(100<X?100-100*X/M:-1,void 0,void 0,W=>{window.setTimeout(()=>{J(W)},0)});return!0}bKb(M,
J,V=4,X=!0){const W=()=>{J.Qi.VD||J.lN(new I.a(M,V,!1,X,void 0,!0))};J.Qi.dismiss();this.T5j.select(M.node,M.cpBegin,M.cpBegin);if(!this.DUb.xJd(M.node))return this.Yhj(M,()=>{W()});W();return!0}static g1b(M){if(!M)return!0;if(!M.M_||!M.M_.state)return!1;M=M.M_.state;return 60===M||70===M}static wrj(M,J){const V=w.a.getTypeNameFor(J)===z.a.getTypeName();return{returnValue:!M||V||u.a(w.a.getTypeNameFor(J))&&M.priority>J.priority,stop:V}}BQf(M,J,V,X,W=4,U=!0){M=this.KSl(M);if(!M)return!1;J=this.FRh(M,
J,V,X);return this.bKb(M,J,W,U)}KSl(M){var J=this.hb.gb.kb;for(const V of J)if(y.ParagraphReader.Wb(V.node)&&(J=V.contextId,J===n.a.Tc||J===n.a.Hd||J===n.a.paragraph))return this.dRl(V.node,J!==n.a.paragraph?V.cpBegin:0,M);return null}FRh(M,J,V,X){return this.WFm(M)?J:this.XJm(M)?X:V}WFm(M){return this.VLd(M,!0,null).returnValue}XJm(M){return!!this.lEa(M)}}Object(F.a)(Q,"SuggestionNavigator",null,[])},1630:function(F,K,c){c.d(K,"c",function(){return f});c.d(K,"a",function(){return a});c.d(K,"b",function(){return k});
var l=c(25);const f=(x,y,n)=>{if(!l.c(x)&&"#text"!==x.nodeName&&(y?x.setAttribute("unselectable","on"):x.setAttribute("unselectable","off"),n))for(x=x.firstChild;x;)f(x,y,!0),x=x.nextSibling},a=x=>{x=document.createElement(x);x.setAttribute("unselectable","on");return x},k=(x,y)=>{if(!l.c(x)){var n=x.className;if(l.c(n)||-1===n.indexOf(y))y=n.trim()+" "+y,y=y.trim(),x.className=y}}},1631:function(F,K,c){c.d(K,"a",function(){return u});F=c(0);var l=c(7),f=c(55),a=c(2),k=c(184),x=c(22),y=c(287),n=c(31);
class u{constructor(){this.Zea=null}kne(){try{this.Zea||(this.Zea=x.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"))}catch(z){l.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+z)}}rvf(z,w){return this.Zea?this.Zea.getToken(z,w):new Promise(E=>{x.a.instance.Sa("Common.App.SearchCommon.ISearchOAuthManager").execute(G=>{G?(this.Zea=G,this.Zea.getToken(z,w).then(H=>E(H))):E(null)})})}n3l(){this.kne();return this.Zea?this.Zea.getToken("Search",a.AFrameworkApplication.zLf):
null}Chi(){if("Dev Box"===a.AFrameworkApplication.K.jb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(z=>{window.setTimeout(()=>{z(window.TellMeSubstrateTokenOverride)},750)});this.kne();return this.Zea?this.Zea.getToken("Search",a.AFrameworkApplication.khg):null}tgm(){this.kne();return this.Zea?this.Zea.getToken("Search",this.qgm()):null}qgm(){return a.AFrameworkApplication.K.jb("TellMeServiceAuthEndpointForSearch")}wdm(){if("Dev Box"===
a.AFrameworkApplication.K.jb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(z=>{window.setTimeout(()=>{z(window.TellMeSubstrateTokenOverride)},750)});this.kne();return this.Zea?this.Zea.getToken("SmartLookup",this.tdm()):null}tdm(){return a.AFrameworkApplication.K.jb("SmartLookupShredderServiceEndpoint")}o3l(){return Object(f.a)(this,this.n3l,"getLokiTokenPromise")}Oem(){return Object(f.a)(this,this.Chi,
"getSubstrateTokenPromise")}YOb(){return!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Nb.YOb}hhm(){const z={};this.YOb()&&(z.Loki=this.o3l(),z.Substrate=this.Oem());return z}zYc(z){k.a.xHa(Object.assign(new y.a,{name:"Events",dataFields:[Object.assign(new n.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new n.a,{name:"Status",bool:z})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}y1m(){return a.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>
{this.zYc(!1);return!1}).then(()=>{this.zYc(!0);return!0}):new Promise((z,w)=>{const E=x.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Uz;E?E.loadScript("tellme-strings").then(()=>{this.zYc(!0);z(!0)}).catch(()=>{this.zYc(!1);w(!1)}):(this.zYc(!1),w(!1))})}static zSm(){return!!a.AFrameworkApplication.ta&&(a.AFrameworkApplication.ta.Nb.uWc||a.AFrameworkApplication.ta.Nb.Tbc)}static G_d(){return!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Nb.Tbc}}Object(F.a)(u,"ReactSharedHeaderSearchUtils",
null,[])},1633:function(F,K,c){c.r(K);c.d(K,"validateCpDataV1",function(){return f});c.d(K,"isEqual",function(){return a});c.d(K,"isSupportedCpVersion",function(){return k});c.d(K,"validateVersionedCpData",function(){return y});c.d(K,"versionedDeserialize",function(){return n});var l=c(1601);const f=u=>"number"!==typeof u.CP||null!=u.FB&&"number"!==typeof u.FB||null!=u.FE&&"number"!==typeof u.FE||null!=u.HB&&"number"!==typeof u.HB||null!=u.HE&&"number"!==typeof u.HE||null!=u.CB&&"number"!==typeof u.CB||
null!=u.CE&&"number"!==typeof u.CE||null!=u.R&&"number"!==typeof u.R||null!=u.E&&"number"!==typeof u.E||null!=u.TW&&"number"!==typeof u.TW||null!=u.PB&&"number"!==typeof u.PB||null!=u.SYM&&"number"!==typeof u.SYM||null!=u.IE&&"number"!==typeof u.IE||null!=u.OO&&"number"!==typeof u.OO||null!=u.AX&&"number"!==typeof u.AX||null!=u.CCI&&"number"!==typeof u.CCI||null!=u.DD&&"number"!==typeof u.DD?!1:!0,a=(u,z)=>u||z?u&&z&&u.CP===z.CP&&u.FB===z.FB&&u.FE===z.FE&&u.HB===z.HB&&u.HE===z.HE&&u.CB===z.CB&&u.CE===
z.CE&&u.R===z.R&&u.E===z.E&&u.TW===z.TW&&u.PB===z.PB&&u.SYM===z.SYM&&u.IE===z.IE&&u.OO===z.OO&&u.AX===z.AX&&u.CCI===z.CCI&&u.DD===z.DD?!0:!1:!0,k=u=>1===u,x=u=>{let z=u,w=0;"number"===typeof z.VS&&(w=z.VS);if("number"===typeof z.VS||"number"===typeof z.CP)return{returnValue:z,Jog:w};z=null;for(let E=0;E<u.length;E++){const G=u[E];1===G.VS&&G.VS>w&&(w=G.VS,z=u[E])}return{returnValue:z,Jog:w}},y=u=>{const z=({Jog:u}=x(u)).returnValue;if(!z)return!1;switch(u){case 0:case 1:return f(z);default:return!1}},
n=u=>{if(!u)return null;const z=({Jog:u}=x(u)).returnValue;if(!z)return null;switch(u){case 0:case 1:return l.b(z);default:return null}}},1646:function(F,K,c){c.d(K,"a",function(){return k});F=c(0);var l=c(140),f=c(2),a=c(7);class k{constructor(x,y){this.tQ=x;this.Qqa=y}sP(x,y,n){x={["appId"]:2155,["manifestType"]:"Fps",["submitTime"]:(new Date).toISOString(),["source"]:"Client",["type"]:"Survey",["clientFeedbackId"]:l.a.create().toString(),["email"]:y,["application"]:{["appData"]:"{}",["extendedManifestData"]:JSON.stringify({["surveySpecificData"]:JSON.stringify(n)})},
["survey"]:{["surveyId"]:x},["telemetry"]:this.iAb(),["web"]:this.GFc()};this.WGa(JSON.stringify(x),{["Content-Type"]:"application/json"})}iAb(){const x=f.AFrameworkApplication.sessionStartInfoSettings;return{["officeBuild"]:f.AFrameworkApplication.buildVersion,["featureArea"]:"EditorAi",["audienceGroup"]:x.AudienceGroup,["osBuild"]:x.OsVersion,["platform"]:x.Platform,["processSessionId"]:x.WACSessionID,["flights"]:f.AFrameworkApplication.K.jb("FlightId"),["loggableUserId"]:f.AFrameworkApplication.K.jb("LoggableUserId"),
["tenantId"]:f.AFrameworkApplication.K.jb("TenantId")}}WGa(x,y,n=0){3<n||this.Qqa.o0a(()=>{this.tQ.xj("https://petrol.office.microsoft.com/v1/feedback",2,x,y,!1,2,()=>{a.ULS.sendTraceTag(509207132,3041,50,"Success sending OCV feedback for EditorAi")},()=>{this.WGa(x,y,n+1);a.ULS.sendTraceTag(509207131,3041,50,"Failure sending OCV feedback for EditorAi, attempt {0}",n)},null)},{delay:this.OUl(n)})}OUl(x=0){let y=0;1===x?y=200:1<x&&(y=200+500*(x-1));return y}GFc(){const x=f.AFrameworkApplication.sessionStartInfoSettings;
return{["browser"]:x.Browser,["browserVersion"]:x.BrowserVersion,["dataCenter"]:x.WACDatacenter}}}Object(F.a)(k,"EditorAiSurveysApiClient",null,[])},1647:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);class l{constructor(a){this.selectedRating=a}}Object(F.a)(l,"EditorAiRatingData",null,[]);class f{constructor(a,k,x){this.rating=[new l(a)];this.comment=[k,...x]}}Object(F.a)(f,"EditorAiSurveyData",null,[])},1648:function(F,K,c){F=c(0);var l=c(741),f=c(19),a=c(168),k=c(79),x=c(2),y=c(22),n=c(7),
u=c(1452),z=c(12),w=c(103),E=c(28),G=c(3),H=c(1054),L=c(132),I=c(17),N=c(23),Q=c(98),M=c(8);class J{static get mwh(){J.kpc||(J.kpc=[],J.Gdc(l.a.sg("ar-sa")),J.Gdc(l.a.sg("de-de")),J.Gdc(l.a.sg("es-es")),J.o0(l.a.sg("en-029"),l.a.sg("en-us")),J.o0(l.a.sg("en-au"),l.a.sg("en-us")),J.o0(l.a.sg("en-bz"),l.a.sg("en-us")),J.o0(l.a.sg("en-ca"),l.a.sg("en-us")),J.o0(l.a.sg("en-gb"),l.a.sg("en-us")),J.o0(l.a.sg("en-id"),l.a.sg("en-us")),J.o0(l.a.sg("en-my"),l.a.sg("en-us")),J.o0(l.a.sg("en-ph"),l.a.sg("en-us")),
J.o0(l.a.sg("zh-tw"),l.a.sg("en-us")),J.Gdc(l.a.sg("fr-fr")),J.o0(l.a.sg("hr-ba"),l.a.sg("hr-hr")),J.o0(l.a.sg("it-ch"),l.a.sg("it-it")),J.o0(l.a.sg("nb-no"),l.a.sg("nn-no")),J.Gdc(l.a.sg("nl-nl")),J.o0(l.a.sg("ro-md"),l.a.sg("ro-ro")),J.o0(l.a.sg("ru-md"),l.a.sg("ru-ru")),J.o0(l.a.sg("sr-latn-ba"),l.a.sg("sr-latn-cs")),J.o0(l.a.sg("sr-latn-me"),l.a.sg("sr-latn-cs")),J.o0(l.a.sg("sr-latn-rs"),l.a.sg("sr-latn-cs")),J.Gdc(l.a.sg("sr-cyrl-cs")),J.o0(l.a.sg("sv-fi"),l.a.sg("sv-se")));return J.kpc}static Gdc(Sa){J.kpc[Sa.languageId]=
Sa.LCID}static o0(Sa,xb){J.kpc[Sa.LCID]=xb.LCID}static g9h(Sa){var xb=l.a.sg(Sa);if(!xb)return 0;xb=J.mwh[xb.LCID]||J.mwh[xb.languageId]||0;return xb===Sa?0:xb}}J.kpc=null;Object(F.a)(J,"AutoCorrectListFallback",null,[]);var V=c(353),X=c(83),W=c(153),U=c(118),Y=c(6),ba=c(16),aa=c(5),fa=c(91),na=c(374),oa=c(36),ja=c(59),qa=c(92),Ia=c(43),Va=c(1534);class Na extends Va.a{constructor(Sa,xb,Qb,Ib,$b,hc){super(Sa,xb,Qb,Ib,hc);this.nY=$b}get QC(){return!0}get commandId(){return G.a.mJk}set QC(Sa){super.QC=
Sa}}Object(F.a)(Na,"ARegexCorrectAction",Va.a,[]);class za extends Na{static get clb(){if(null!=za.SDg)var Sa=za.SDg;else(Sa=y.a.instance.Na("Box4.List.IListCommands"))||n.ULS.sendTraceTag(512357316,393,50,"IListCommands was tried to be resolved before it was registered."),Sa=za.SDg=Sa;return Sa}static get Un(){return null!=za.WDg?za.WDg:za.WDg=y.a.instance.resolve("Box4.List.IListEditor")}static get Gd(){return null!=za.mEg?za.mEg:za.mEg=y.a.instance.resolve("Box4.List.IListReader")}get levelText(){const [Sa,
xb]=this.nY;return xb?Sa.replace(xb,"%1"):Sa}}Object(F.a)(za,"AListAutoCorrectAction",Na,[]);var la=c(141);class va extends za{get commandId(){return G.a.eJk}Vma(Sa){if(va.clb){var xb=aa.GraphIterator.$a(Sa);xb.vd();oa.OutlineElementNavigator.Vd(xb);if(va.Un.kie(xb,this.nY[0])){var Qb=va.Gd.qw(xb),Ib=this.nY[0],$b=f.a.charAt(Ib,0),hc=this.F3l($b),pb=na.a.n_(1,hc.listStyle);Qb&&pb.zxf(Qb)||(Qb=new Ia.GraphTransaction(15),Qb.Lt(xb),this.Kd.replaceTextRange(E.a.createTextRange(Sa,this.GG,this.p0+1),
"",!0,!1),va.Un.klo(pb),Sa=new V.DictionaryPropertySet,Sa.setValue(W.a.bmf,!0),$b&&(pb.pQ=$b,Sa.setValue(U.a.pQ,pb.pQ)),Sa.setValue(Y.a.ov,hc.levelText),Sa.setValue(ba.a.font,hc.fontName),"-"===$b&&X.Health.instance.recordKpiUsage("DashBulletAutoCreate",0,va.tB,null),la.a.dY&&(Sa.setValue(U.a.cpa,"autocorrect"),Sa.setValue(U.a.Fha,Ib)),va.clb.iQk(pb.listType,pb.listStyle,Sa),Qb.dispose())}}}F3l(Sa){const xb={listStyle:0,levelText:fa.a.fId,fontName:fa.a.qJc};switch(Sa){case "*":return{...xb,listStyle:1};
case "-":return{...xb,levelText:"-",fontName:qa.a.nG};default:return xb}}static jG(Sa,xb,Qb,Ib,$b){return new va(null,Sa,xb,Qb,Ib,$b)}static uT(Sa,xb,Qb,Ib,$b){return new va(Sa,ja.a(Sa).Bb,xb,Qb,Ib,$b)}}va.tB="wwaengidc";va.d4f=["[\\*](?![\\*])","[\\-](?![\\-])"];Object(F.a)(va,"BulletListAction",za,[]);var ia=c(77);class pa extends Na{constructor(Sa,xb,Qb,Ib,$b,hc){super(Sa,xb,Qb,Ib,$b,hc);this.wvc=!1;this.QC=!Sa;pa.jp=new ia.a}get QC(){return this.wvc}set QC(Sa){this.wvc=Sa}tCb(Sa){this.s7e(Sa.innerText,
(xb,Qb,Ib)=>{Sa.innerText=f.a.substring(Sa.innerText,0,xb)+Ib+f.a.right(Sa.innerText,Qb)})}Vma(Sa){this.s7e(M.ParagraphReader.text(Sa).substring(this.GG,this.p0),(xb,Qb,Ib)=>{this.Kd.replaceTextRange(E.a.createTextRange(Sa,this.GG+xb,this.GG+Qb),Ib,!0,!1)})}s7e(Sa,xb){if(!(2>this.nY.length)&&this.nY[1]){var Qb=this.nY[1];pa.jp.count||this.D2i();pa.jp.mb(Qb)&&(Sa=Sa.lastIndexOf(Qb),-1!==Sa&&xb(Sa,Sa+Qb.length,pa.jp.J(Qb)))}}}Object(F.a)(pa,"ADictionarySequenceReplacerAction",Na,[]);class sa extends pa{get commandId(){return G.a.f3e}D2i(){pa.jp.Z("--",
"\u2014");pa.jp.Z(" -- "," \u2013 ");pa.jp.Z(" - "," \u2013 ");pa.jp.Z("-- ","\u2014");pa.jp.Z(" --"," \u2013");pa.jp.Z(" -"," \u2013")}static jG(Sa,xb,Qb,Ib,$b){return new sa(null,Sa,xb,Qb,Ib,$b)}static uT(Sa,xb,Qb,Ib,$b){return new sa(Sa,ja.a(Sa).Bb,xb,Qb,Ib,$b)}}Object(F.a)(sa,"DashAction",pa,[]);class Ha extends pa{constructor(Sa,xb,Qb,Ib,$b,hc,pb){super(Sa,xb,Qb,Ib,$b,hc);this.ga=pb}get commandId(){return G.a.fJk}D2i(){pa.jp.Z(":)","\ud83d\ude0a");pa.jp.Z(":-)","\ud83d\ude0a");pa.jp.Z(":|","\ud83d\ude10");
pa.jp.Z(":-|","\ud83d\ude10");pa.jp.Z(":(","\ud83d\ude41");pa.jp.Z(":-(","\ud83d\ude41");pa.jp.Z(";)","\ud83d\ude09");pa.jp.Z(";-)","\ud83d\ude09");pa.jp.Z(":D","\ud83d\ude00");pa.jp.Z(":-D","\ud83d\ude00");pa.jp.Z(":')","\ud83d\ude02");pa.jp.Z("=D","\ud83d\ude03");pa.jp.Z(":>","\ud83d\ude06");pa.jp.Z(":->","\ud83d\ude06");pa.jp.Z(":3","\ud83d\ude0a");pa.jp.Z(":-3","\ud83d\ude0a");pa.jp.Z("B-)","\ud83d\ude0e");pa.jp.Z("*-*","\ud83d\ude0d");pa.jp.Z(":*","\ud83d\ude19");pa.jp.Z(":-*","\ud83d\ude19");
pa.jp.Z(":X","\ud83d\ude36");pa.jp.Z(":-X","\ud83d\ude36");pa.jp.Z(":O","\ud83d\ude2e");pa.jp.Z(":-O","\ud83d\ude2e");pa.jp.Z(":#","\ud83e\udd10");pa.jp.Z(":-#","\ud83e\udd10");pa.jp.Z(":P","\ud83d\ude1b");pa.jp.Z(":-P","\ud83d\ude1b");pa.jp.Z(";P","\ud83d\ude1c");pa.jp.Z(";-P","\ud83d\ude1c");pa.jp.Z(":-/","\ud83d\ude15");pa.jp.Z("$-$","\ud83e\udd11");pa.jp.Z(":S","\ud83d\ude16");pa.jp.Z(":-S","\ud83d\ude16");pa.jp.Z(":[","\ud83d\ude1f");pa.jp.Z(":-[","\ud83d\ude1f");pa.jp.Z(":\u2019(","\ud83d\ude22");
pa.jp.Z(":'(","\ud83d\ude22");pa.jp.Z("@-@","\ud83d\ude31")}Vma(Sa){this.s7e(M.ParagraphReader.text(Sa).substring(this.GG,this.p0),(xb,Qb,Ib)=>{xb=E.a.createTextRange(Sa,this.GG+xb,this.GG+Qb);Qb={};Qb.MenuItemId=Ib;this.ga.Mf(xb,G.a.jjb,2,!1,null,Qb,null)})}static jG(Sa,xb,Qb,Ib,$b,hc){return new Ha(null,Sa,xb,Qb,Ib,$b,hc)}static uT(Sa,xb,Qb,Ib,$b,hc){return new Ha(Sa,ja.a(Sa).Bb,xb,Qb,Ib,$b,hc)}}Object(F.a)(Ha,"EmojiAction",pa,[]);class ra{constructor(Sa,xb,Qb,Ib){this.oS=Sa;this.nxd=xb;this.dwc=
Ib;this.OF=Qb}uAi(){if(!this.OF)return!1;this.oS=this.oS.trimStart();return this.oS===this.OF?!0:!1}sWm(){if(!this.oS)return!1;const Sa=this.oS.lastIndexOf(" ");return-1!==Sa&&"."===this.oS.charAt(Sa-1)&&"."===this.oS.charAt(Sa-3)?!0:!1}rWm(){if(!this.oS)return!1;var Sa=this.oS.lastIndexOf(" ");return-1!==Sa&&(Sa=this.oS.substring(0,Sa-1).lastIndexOf(" "),"."===this.oS.charAt(Sa+2))?!0:!1}GPm(){return this.uAi()&&(1===this.OF.length&&"."===this.nxd||"."===this.oS.charAt(1))?!0:!1}HPm(){return this.OF?
0<="\\/".indexOf(this.nxd)||3===this.OF.length&&0<="\\/".indexOf(this.OF.charAt(1))?!0:!1:!1}BOm(){return this.OF?0<=this.OF.indexOf("@")?!0:!1:!1}IB(){if(!this.OF)return!1;for(const Sa of ra.ewf())if(f.a.startsWith(this.OF+this.nxd,Sa))return!0;return!1}iOm(){return this.OF?"i"===this.OF&&0<=ra.quotes.indexOf(this.nxd)?!0:!1:!1}wIm(){if(!this.oS)return!1;const Sa=f.a.J3a(this.oS,this.oS.length-1);if(-1!==Sa&&this.oS.substring(Sa+1,this.oS.length)===this.OF){const xb=this.oS.charAt(Sa-1);if(0<=ra.N$f.indexOf(xb)||
0<=ra.quotes.indexOf(xb)&&0<=ra.N$f.indexOf(this.oS.charAt(Sa-2)))return!0}return!1}bWk(){return!this.oS||this.sWm()||this.GPm()||this.HPm()||this.rWm()||this.BOm()||this.IB()?!1:this.uAi()||this.iOm()||this.wIm()?!0:!1}static ewf(){return ra.i5g||(ra.i5g="http: https: ftp:// mailto: \\\\ www.".split(" "))}}ra.N$f=".!?";ra.quotes="'\"";ra.i5g=null;Object(F.a)(ra,"FirstLetterUpperCaseRules",null,[]);class Ma{constructor(Sa){this.OF=Sa}fJl(){if(!this.OF)return null;for(let Sa=0;Sa<Ma.oki().length;Sa++)if(this.OF===
Ma.oki()[Sa])return Ma.Okm()[Sa];return null}static oki(){return Ma.AWg||(Ma.AWg=["1/2","1/4","3/4"])}static Okm(){return Ma.zWg||(Ma.zWg=["\u00bd","\u00bc","\u00be"])}}Ma.AWg=null;Ma.zWg=null;Object(F.a)(Ma,"FractionsCollection",null,[]);class ya extends Va.a{constructor(Sa,xb,Qb,Ib,$b,hc){super(Sa,xb,Qb,Ib,hc);this.iKh=$b}get QC(){return!0}get commandId(){return G.a.gJk}tCb(Sa){Sa.innerText=f.a.substring(Sa.innerText,0,this.GG)+this.iKh+f.a.right(Sa.innerText,this.p0)}Vma(Sa){this.Kd.replaceTextRange(E.a.createTextRange(Sa,
this.GG,this.p0),this.iKh,!0,!1)}set QC(Sa){super.QC=Sa}static jG(Sa,xb,Qb,Ib,$b){return new ya(null,Sa,xb,Qb,Ib,$b)}}Object(F.a)(ya,"FractionsReplaceCorrectAction",Va.a,[]);class Ga extends za{get commandId(){return G.a.iJk}Vma(Sa){if(Ga.clb){var xb=aa.GraphIterator.$a(Sa);xb.vd();oa.OutlineElementNavigator.Vd(xb);if(Ga.Un.kie(xb,this.nY[0])){var [Qb,Ib]=this.nY,$b=Ga.Tjn(Ib),hc=f.a.kcc(Ib)?4:2,pb=E.a.createTextRange(Sa,this.GG,this.p0+1);Ga.Un.I1b(Sa,xb,hc,$b,pb,Qb,this.levelText,Ga.clb)}}}static jG(Sa,
xb,Qb,Ib,$b){return new Ga(null,Sa,xb,Qb,Ib,$b)}static uT(Sa,xb,Qb,Ib,$b){return new Ga(Sa,ja.a(Sa).Bb,xb,Qb,Ib,$b)}static Tjn(Sa){if(!Sa)return 0;Sa=f.a.Ug(Sa);if(!f.a.UXd(Sa.charAt(0)))return 0;const xb=Sa.charCodeAt(0)-97+1;let Qb;for(Qb=1;Qb<Sa.length&&Sa.charAt(Qb)===Sa.charAt(0);Qb++);return 26*(Qb-1)+xb}}Object(F.a)(Ga,"LetterListAction",za,[]);var wa=c(121);class hb extends za{get commandId(){return G.a.I1b}Vma(Sa){if(hb.clb){var xb=aa.GraphIterator.$a(Sa);xb.vd();oa.OutlineElementNavigator.Vd(xb);
if(hb.Un.kie(xb,this.nY[0])){var [Qb,Ib]=this.nY,$b=parseInt(Ib);if(!(99999999<=$b)){var hc=E.a.createTextRange(Sa,this.GG,this.p0+1);wa.a.F0d()&&wa.a.Lmm();hb.Un.I1b(Sa,xb,1,$b,hc,Qb,this.levelText,hb.clb)}}}}static jG(Sa,xb,Qb,Ib,$b){return new hb(null,Sa,xb,Qb,Ib,$b)}static uT(Sa,xb,Qb,Ib,$b){return new hb(Sa,ja.a(Sa).Bb,xb,Qb,Ib,$b)}}Object(F.a)(hb,"NumberListAction",za,[]);class eb extends Va.a{get QC(){return!0}get commandId(){return G.a.kJk}tCb(){}Vma(Sa){const xb=E.a.createTextRange(Sa,this.p0-
2,this.p0),Qb=new Ia.GraphTransaction(15);Qb.Cb(Sa);let Ib=!1,$b=null,hc=0;for(;hc<Sa.pa.length;){var pb=Sa.pa.J(hc),dc=pb.U8;const Ob=pb.oU;if(pb.cp>=xb.cpBegin){pb.cp>xb.cpBegin||!pb.formatting?$b=Ib?pb.formatting:this.Kd.LY(Sa,hc,xb.cpBegin,$b):($b=pb.formatting,Ob&&(Ib=!1),dc&&(Ib=!0));hc++;break}pb.formatting&&($b=pb.formatting);Ob&&(Ib=!1);dc&&(Ib=!0);hc++}for(;hc<Sa.pa.length;){dc=Sa.pa.J(hc);if(dc.cp>=xb.cpEnd){if(dc.cp>xb.cpEnd||!dc.formatting&&!dc.Rh)Ib||this.Kd.LY(Sa,hc,xb.cpEnd,$b);Ib||
eb.Sn.vqa($b,!0);break}dc.formatting&&(Ib||eb.Sn.vqa($b,!0),$b=dc.formatting);pb=dc.U8;dc=dc.oU;pb&&(Ib=!0);!pb&&dc&&(Ib=!1);hc++}Qb.dispose()}set QC(Sa){super.QC=Sa}static get Sn(){return null!=eb.nAg?eb.nAg:eb.nAg=y.a.instance.resolve("Box4.IFormattingEditor")}static jG(Sa,xb,Qb,Ib){return new eb(null,Sa,xb,Qb,Ib)}}Object(F.a)(eb,"OrdinalsReplaceCorrectAction",Va.a,[]);var jb=c(96),ub=c(209),ab;(function(Sa){Sa[Sa.rand=0]="rand";Sa[Sa.randOld=1]="randOld";Sa[Sa.lorem=2]="lorem"})(ab||(ab={}));Object(F.b)("RandTextType",
ab);class Ea extends Na{constructor(Sa,xb,Qb,Ib,$b,hc){super(Sa,xb,Qb,Ib,$b,hc);Ea.nPe||Ea.aEo()}static rPm(){var Sa;return null===(Sa=x.AFrameworkApplication.K)||void 0===Sa?void 0:Sa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isNoRandDoubleSpaceEnabled",!0)}get commandId(){return G.a.lJk}Vma(Sa){if(!(Sa.Vs||la.a.getInstance().Lv&&(la.a.getInstance().QFf?jb.ListItemReader.isListItem(Sa):ub.a.Aoa(Sa)))){var xb=this.hab.Oa.node===Sa,Qb=5,Ib=3;if(this.nY[0].startsWith("=rand.old")){var $b=ab.randOld;
Qb=3}else if(this.nY[0].startsWith("=rand"))$b=ab.rand;else if(this.nY[0].startsWith("=lorem"))$b=ab.lorem;else return;this.nY[1]&&(Qb=parseInt(this.nY[1]));this.nY[2]&&(Ib=parseInt(this.nY[2]));if(!(20<Ib||100<Qb)){Sa.GH().jF.z7(7);var hc=aa.GraphIterator.$a(Sa);hc.vd();oa.OutlineElementNavigator.Vd(hc);Ea.eg.xz(hc,!1,!1);Ea.eg.YI(hc);var pb=!1;switch($b){case ab.rand:$b=Ea.nPe;break;case ab.randOld:$b=Ea.cch;break;case ab.lorem:$b=Ea.d6g;pb=!0;break;default:return}var dc=0;for(let Vb=0;Vb<Qb;++Vb){const ob=
[];for(var Ob=0;Ob<Ib;Ob++)ob.push($b[dc++%$b.length]);Ob=E.a.Qc(hc.currentNode,0);if(pb){const Xb=w.FormattingReader.Nr(Ob);Ea.Sn.Xl(Xb,Y.a.noProof,!0)}this.Kd.replaceTextRange(Ob,ob.join(Ea.rPm()?"":" "),!0,!1);Vb<Qb-1&&(oa.OutlineElementNavigator.Vd(hc),Ea.eg.xz(hc,!1,!1),Ea.eg.YI(hc))}Qb=hc.currentNode;hc=aa.GraphIterator.$a(Sa);hc.vd();oa.OutlineElementNavigator.Vd(hc);hc.xg();xb&&(this.hab=N.SelectionFactory.pe(Qb,M.ParagraphReader.textLength(Qb)))}}}static get eg(){return null!=Ea.TEg?Ea.TEg:
Ea.TEg=y.a.instance.resolve("Box4.IOutlineElementEditor")}static get Sn(){return null!=Ea.rAg?Ea.rAg:Ea.rAg=y.a.instance.resolve("Box4.IFormattingEditor")}static aEo(){Ea.nPe="Video provides a powerful way to help you prove your point. ;When you click Online Video, you can paste in the embed code for the video you want to add. ;You can also type a keyword to search online for the video that best fits your document. ;To make your document look professionally produced, Word provides header, footer, cover page, and text box designs that complement each other. ;For example, you can add a matching cover page, header, and sidebar. ;Click Insert and then choose the elements you want from the different galleries. ;Themes and styles also help keep your document coordinated. ;When you click Design and choose a new Theme, the pictures, charts, and SmartArt graphics change to match your new theme. ;When you apply styles, your headings change to match the new theme. ;Save time in Word with new buttons that show up where you need them. ;To change the way a picture fits in your document, click it and a button for layout options appears next to it. ;When you work on a table, click where you want to add a row or a column, and then click the plus sign. ;Reading is easier, too, in the new Reading view. ;You can collapse parts of the document and focus on the text you want. ;If you need to stop reading before you reach the end, Word remembers where you left off - even on another device. ".split(";");
Ea.cch=["The quick brown fox jumps over the lazy dog. "];Ea.d6g="Lorem ipsum dolor sit amet, consectetuer adipiscing elit. ;Maecenas porttitor congue massa. ;Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna. ;Nunc viverra imperdiet enim. ;Fusce est. ;Vivamus a tellus. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin pharetra nonummy pede. ;Mauris et orci. ;Aenean nec lorem. ;In porttitor. ;Donec laoreet nonummy augue. ;Suspendisse dui purus, scelerisque at, vulputate vitae, pretium mattis, nunc. ;Mauris eget neque at sem venenatis eleifend. ;Ut nonummy. ;Fusce aliquet pede non pede. ;Suspendisse dapibus lorem pellentesque magna. ;Integer nulla. ;Donec blandit feugiat ligula. ;Donec hendrerit, felis et imperdiet euismod, purus ipsum pretium metus, in lacinia nulla nisl eget sapien. ;Donec ut est in lectus consequat consequat. ;Etiam eget dui. ;Aliquam erat volutpat. ;Sed at lorem in nunc porta tristique. ;Proin nec augue. ;Quisque aliquam tempor magna. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Nunc ac magna. ;Maecenas odio dolor, vulputate vel, auctor ac, accumsan id, felis. ;Pellentesque cursus sagittis felis. ;Pellentesque porttitor, velit lacinia egestas auctor, diam eros tempus arcu, nec vulputate augue magna vel risus. ;Cras non magna vel ante adipiscing rhoncus. ;Vivamus a mi. ;Morbi neque. ;Aliquam erat volutpat. ;Integer ultrices lobortis eros. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin semper, ante vitae sollicitudin posuere, metus quam iaculis nibh, vitae scelerisque nunc massa eget pede. ;Sed velit urna, interdum vel, ultricies vel, faucibus at, quam. ;Donec elit est, consectetuer eget, consequat quis, tempus quis, wisi. ;In in nunc. ;Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos hymenaeos. ;Donec ullamcorper fringilla eros. ;Fusce in sapien eu purus dapibus commodo. ;Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. ;Cras faucibus condimentum odio. ;Sed ac ligula. ;Aliquam at eros. ;Etiam at ligula et tellus ullamcorper ultrices. ;In fermentum, lorem non cursus porttitor, diam urna accumsan lacus, sed interdum wisi nibh nec nisl. ;Ut tincidunt volutpat urna. ;Mauris eleifend nulla eget mauris. ;Sed cursus quam id felis. ;Curabitur posuere quam vel nibh. ;Cras dapibus dapibus nisl. ;Vestibulum quis dolor a felis congue vehicula. ;Maecenas pede purus, tristique ac, tempus eget, egestas quis, mauris. ;Curabitur non eros. ;Nullam hendrerit bibendum justo. ;Fusce iaculis, est quis lacinia pretium, pede metus molestie lacus, at gravida wisi ante at libero. ;Quisque ornare placerat risus. ;Ut molestie magna at mi. ;Integer aliquet mauris et nibh. ;Ut mattis ligula posuere velit. ;Nunc sagittis. ;Curabitur varius fringilla nisl. ;Duis pretium mi euismod erat. ;Maecenas id augue. ;Nam vulputate. ;Duis a quam non neque lobortis malesuada. ;Praesent euismod. ;Donec nulla augue, venenatis scelerisque, dapibus a, consequat at, leo. ;Pellentesque libero lectus, tristique ac, consectetuer sit amet, imperdiet ut, justo. ;Sed aliquam odio vitae tortor. ;Proin hendrerit tempus arcu. ;In hac habitasse platea dictumst. ;Suspendisse potenti. ;Vivamus vitae massa adipiscing est lacinia sodales. ;Donec metus massa, mollis vel, tempus placerat, vestibulum condimentum, ligula. ;Nunc lacus metus, posuere eget, lacinia eu, varius quis, libero. ;Aliquam nonummy adipiscing augue. ".split(";")}static jG(Sa,
xb,Qb,Ib,$b){return new Ea(null,Sa,xb,Qb,Ib,$b)}static uT(Sa,xb,Qb,Ib,$b){return new Ea(Sa,ja.a(Sa).Bb,xb,Qb,Ib,$b)}}Ea.nPe=null;Ea.cch=null;Ea.d6g=null;Object(F.a)(Ea,"RandAction",Na,[]);class Wa{constructor(Sa,xb,Qb,Ib){this.pattern=Ib&8?new RegExp(Sa,"i"):new RegExp(Sa);this.Wum=xb;this.Clm=Qb;this.flags=Ib}}Object(F.a)(Wa,"RegexAutoCorrectEntry",null,[]);class Bb extends za{get commandId(){return G.a.nJk}Vma(Sa){if(Bb.clb){var xb=aa.GraphIterator.$a(Sa);xb.vd();oa.OutlineElementNavigator.Vd(xb);
if(Bb.Un.kie(xb,this.nY[0])){var [Qb,Ib]=this.nY,$b=Bb.Ujn(Ib);if(!(0>=$b)){var hc=f.a.kcc(Ib.charAt(0))?5:3,pb=E.a.createTextRange(Sa,this.GG,this.p0+1);Bb.Un.I1b(Sa,xb,hc,$b,pb,Qb,this.levelText,Bb.clb)}}}}static jG(Sa,xb,Qb,Ib,$b){return new Bb(null,Sa,xb,Qb,Ib,$b)}static uT(Sa,xb,Qb,Ib,$b){return new Bb(Sa,ja.a(Sa).Bb,xb,Qb,Ib,$b)}static axl(){Bb.eMa||(Bb.eMa={},Bb.eMa.M=1E3,Bb.eMa.D=500,Bb.eMa.C=100,Bb.eMa.L=50,Bb.eMa.X=10,Bb.eMa.V=5,Bb.eMa.I=1)}static Ujn(Sa){if(!Sa)return 0;Bb.axl();Sa=f.a.XA(Sa);
let xb=0,Qb=0;for(let Ib=Sa.length-1;0<=Ib;Ib--){const $b=Bb.eMa[f.a.charAt(Sa,Ib).toString()];Qb=$b<xb?Qb-$b:Qb+$b;xb=$b}return Qb}}Bb.eMa=null;Bb.d4f=["M{1,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(CM|CD|DC{0,3}|C{1,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(XC|XL|LX{0,3}|X{1,3})(IX|IV|V?I{0,3})","(IX|IV|VI{0,3}|I{1,3})"].map(Sa=>`\\(?(${Sa})[\\.\\)\\-]`);Object(F.a)(Bb,"RomanListAction",za,[]);var Mb=c(40);class Fb extends Va.a{constructor(Sa,xb,Qb,Ib,$b,hc){super(Sa,xb,Qb,Qb+1,hc);this.Vnk=
Ib;this.AQg=$b;this.SZc=!1}get QC(){return!1}get commandId(){return G.a.oJk}tCb(Sa){Sa.innerText=f.a.substring(Sa.innerText,0,this.GG)+this.AQg+f.a.right(Sa.innerText,this.p0)}Vma(Sa){this.Kd.replaceTextRange(E.a.createTextRange(Sa,this.GG,this.p0),this.Vnk,!0,!1);this.Kd.replaceTextRange(E.a.createTextRange(Sa,this.GG,this.GG+1),this.AQg,!0,!1)}set QC(Sa){super.QC=Sa}static jG(Sa,xb,Qb,Ib,$b,hc){if("'"!==Qb&&'"'!==Qb)return null;var pb=aa.GraphIterator.$a(Sa);pb.vd();oa.OutlineElementNavigator.Vd(pb);
if(Mb.OutlineElementReader.$m(pb.currentNode))return null;Ib=!xb||f.a.sca(Ib)||-1!==Array.indexOf(Fb.sxn,Ib);pb="'"===Qb;return new Fb(hc,Sa,xb,Qb+"",Ib?pb?"\u2018":"\u201c":pb?"\u2019":"\u201d",$b)}}Fb.sxn=["[","{","("];Object(F.a)(Fb,"SmartQuoteCorrectAction",Va.a,[]);class vb extends Va.a{constructor(Sa,xb,Qb,Ib,$b,hc){super(Sa,xb,Qb,Ib,hc);this.zQg=$b}get QC(){return vb.wvc}set QC(Sa){vb.wvc=Sa}get commandId(){return G.a.pJk}LJj(){this.kod=this.uDh();this.kod||(this.M4g=!1,this.G_g="MatchTextIsNotTheSame")}tCb(Sa){Sa.innerText=
f.a.substring(Sa.innerText,0,this.GG)+this.zQg+f.a.right(Sa.innerText,this.p0)}Vma(Sa){this.Kd.replaceTextRange(E.a.createTextRange(Sa,this.GG,this.p0),this.zQg,!0,!1)}static uT(Sa,xb,Qb,Ib,$b){const hc=ja.a(Sa);return new vb(Sa,hc?hc.Bb:null,xb,Qb,Ib,$b)}static jG(Sa,xb,Qb,Ib,$b){return new vb(null,Sa,xb,Qb,Ib,$b)}}vb.wvc=!1;Object(F.a)(vb,"StringReplaceCorrectAction",Va.a,[]);class $a extends Va.a{constructor(Sa,xb,Qb,Ib,$b,hc,pb,dc){super(Sa,xb,Qb,Ib,$b);this.Jk=hc;this.u9j=pb;this.xD=dc}get QC(){return!0}get commandId(){return G.a.qJk}tCb(Sa){let xb=
f.a.substring(Sa.innerText,this.GG,this.p0);xb.charAt(0)!==xb.charAt(0).toUpperCase()&&(xb=xb.charAt(0).toUpperCase()+xb.substring(1,xb.length));Sa.innerText=f.a.substring(Sa.innerText,0,this.GG)+xb+f.a.right(Sa.innerText,this.p0)}Vma(Sa){const xb=this.GG,Qb=this.GG+1,Ib=Sa.characterData.substring(xb,Qb).charAt(0);if(!f.a.kcc(Ib)){const $b=E.a.createTextRange(Sa,xb,Qb);this.SIm($b)||this.xD&&this.xD.xWc(Sa,xb,Qb)||this.Kd.replaceTextRange($b,Ib.toUpperCase().toString(),!0,!1)}}SIm(Sa){return this.u9j?
!!this.Jk&&this.Jk.M8(Sa):!1}set QC(Sa){super.QC=Sa}static uT(Sa,xb,Qb,Ib){const $b=ja.a(Sa);return new $a(Sa,$b?$b.Bb:null,xb,Qb,Ib,null,!1,null)}static jG(Sa,xb,Qb,Ib,$b,hc){return new $a(null,Sa,xb,Qb,Ib,$b,!0,hc)}}Object(F.a)($a,"UpperFirstLetterAutoCorrectAction",Va.a,[]);class kb{constructor(Sa,xb){this.dwc=xb;this.OF=Sa}u2o(){const Sa=Number.parseInvariant(this.OF.substring(0,this.OF.length-2));switch(Number.parseInvariant(this.OF.charAt(this.OF.length-3).toString())){case 1:return 11===Sa?
"th":"st";case 2:return 12===Sa?"th":"nd";case 3:return 13===Sa?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}UPm(){var Sa=l.a.sg(this.dwc);if(!Sa||!Sa.name.toLowerCase().startsWith("en")||!this.OF||2>=this.OF.length)return!1;for(Sa=0;Sa<kb.tTd().length;Sa++)if(this.OF.toLowerCase().endsWith(kb.tTd()[Sa])){if(RegExp("^\\d+$").test(this.OF.substr(0,this.OF.length-2))){const xb=this.u2o();if(this.OF.toLowerCase().endsWith(kb.tTd()[Sa])&&xb===kb.tTd()[Sa])return!0}break}return!1}static tTd(){return kb.p$g||
(kb.p$g=["st","nd","rd","th"])}}kb.p$g=null;Object(F.a)(kb,"ValidateOrdinalsRule",null,[]);c.d(K,"a",function(){return Ua});class Ua{constructor(Sa,xb,Qb,Ib,$b,hc,pb){this.Rzc=[];this.VSb=[];this.jpc=[];this.Ste=new Set;this.Dab=-1;this.tZg=this.Vea=!1;this.P6j=Sa;this.Kd=xb;this.Jk=Qb;this.ga=Ib;this.AV=hc;this.xD=pb;$b?(this.Vea=$b.$("ReplaceQuoteWithSmartQuoteIsEnabled"),this.tZg=$b.$("HyperlinkUrlValidationIsEnabled"),n.ULS.sendTraceTag(23418953,324,50,"{0}",{["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.Vea})):
(n.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.Vea=!1)}Gjb(Sa){return 0<=Ua.g3e.indexOf(Sa)}cHf(Sa){return 0<=Ua.h3e.indexOf(Sa)}JEf(Sa){return Sa.toLowerCase()===Sa}kcc(Sa){return Sa.toUpperCase()===Sa}UXd(Sa){return Sa.toLowerCase()!==Sa.toUpperCase()}pLm(Sa,xb,Qb,Ib){return(new ra(Sa,xb,Qb,Ib)).bWk()}JTl(Sa){do{if(Sa.getAttribute("xml:lang"))return l.a.sg(Sa.getAttribute("xml:lang"))||l.a.wTc;if(Sa.getAttribute("lang"))return l.a.sg(Sa.getAttribute("lang"))||
l.a.wTc;Sa=Sa.parentNode}while(Sa&&1===Sa.nodeType);return l.a.wTc}rpf(Sa){return l.a.sg(w.FormattingReader.language(w.FormattingReader.Nr(Sa)))||l.a.wTc}pMd(Sa,xb){0>xb&&(xb=0);let Qb=-1;const Ib=Ua.g3e.length;for(let $b=0;$b<Ib;++$b){const hc=Sa.lastIndexOf(f.a.charAt(Ua.g3e,$b),xb);hc>Qb&&(Qb=hc)}Sa=f.a.J3a(Sa,xb);Sa>Qb&&(Qb=Sa);return Qb}vDl(Sa){for(let xb=0;xb<Sa.length;++xb)if(this.UXd(f.a.charAt(Sa,xb)))return xb;return-1}Vkf(Sa,xb){if(!Sa||0>xb)return-1;let Qb=xb;Qb=Qb?this.pMd(Sa,Qb-1):-1;
Qb=Qb>f.a.J3a(Sa,xb-1)?Qb:f.a.J3a(Sa,xb-1);Qb++;return Qb}Z_h(Sa,xb,Qb){this.gLc(xb);if(!this.VSb[xb]){xb=J.g9h(xb);if(0>=xb)return null;this.gLc(xb);if(!this.VSb[xb])return null}if(Qb&&this.jpc[xb]&&Array.contains(this.jpc[xb],Sa+Qb))return null;Qb=this.VSb[xb][f.a.Ug(Sa)];if("string"!==typeof Qb||Qb===Sa||!Qb)return null;var Ib=this.vDl(Sa);if(0>Ib||this.JEf(f.a.charAt(Sa,Ib)))return Qb;xb=!0;for(Ib+=1;Ib<Sa.length;++Ib){const $b=f.a.charAt(Sa,Ib);xb&&!this.kcc($b)&&(xb=!1)}return xb?null:f.a.XA(f.a.substring(Qb,
0,1))+f.a.right(Qb,1)}IDl(Sa,xb,Qb,Ib){a.a.mark(4666);const $b=this.JTl(xb).LCID;let hc=0,pb=Sa;const dc=xb.innerText;var Ob=dc.lastIndexOf(" ",Sa);if(this.rDf(dc.substring(Ob+1,Sa)))return a.a.mark(4667),null;Ob=null;var Vb=!1;do{pb=pb?this.pMd(dc,pb-1):-1;if(-1===pb&&!Qb){Vb=xb;var ob=null;if(!this.Gjb(dc.charAt(0))){do{for(;Vb&&!Vb.previousSibling;)Vb=Vb.parentNode;Vb&&(Vb=Vb.previousSibling,ob=Vb.innerText)}while(Vb&&!ob);if(Vb&&ob&&!this.Gjb(f.a.charAt(ob,ob.length-1)))return a.a.mark(4667),
null}Vb=!0}ob=f.a.substring(dc,pb+1,Sa);++hc;var Xb=this.Z_h(ob,$b,Ib.toString());if(Xb)Ob=vb.uT(xb,pb+1,Sa,Xb,this.Kd),Ua.wKf();else for(const Xa of this.Rzc)if(!(Xa.flags&1&&!(Qb&&1>pb)||Xa.flags&4||Xa.flags&2&&" "!==Ib)&&(Xb=Xa.pattern.exec(ob))){Ob=Xa.Wum(xb,pb+1,Sa,Xb,this.Kd,this.ga);break}}while(!Vb&&!Ob&&hc<Ua.DNi&&0<=pb);a.a.mark(4667);return Ob}GDl(Sa,xb,Qb){const Ib=Sa.node;let $b=M.ParagraphReader.text(Ib);0>xb&&(xb=Sa.cpBegin);Sa=this.rpf(Sa).LCID;if(this.rDf($b.substring(f.a.J3a($b,
xb)+1,xb)))return null;var hc=-1,pb=Q.a.JOc(Ib);for(var dc=0;dc<pb.length;dc++)if(xb>pb[dc].cpEnd)hc=pb[dc].cpEnd;else{if(xb>pb[dc].cpBegin)return null;break}pb=null;dc=(dc=xb)?this.pMd($b,dc-1):-1;dc<hc&&(dc=hc-1);hc=f.a.substring($b,dc+1,xb);hc=hc.trimStart();if(1>dc)for(const Ob of this.Rzc){let Vb=$b;" "!==Qb&&(Vb=$b+Qb);if(Ob.pattern.exec(Vb))return null}$b=$b.substring(0,xb);if(!this.pLm($b,Qb.toString(),hc,Sa))return null;hc.charAt(0).toUpperCase()!==hc.charAt(0)&&(pb=$a.jG(Ib,dc+1,xb,this.Kd,
this.Jk,this.xD));return pb}z_h(Sa,xb,Qb){Sa=N.SelectionFactory.ho(Sa,!1);if(!Sa)return null;Sa=Sa.Pc;return I.SelectionEditor.gf(Sa)?this.GDl(Sa,xb,Qb):null}rDf(Sa){return f.a.uU(Sa)}zkf(Sa,xb,Qb,Ib){a.a.mark(4666);const $b=Sa.node,hc=this.rpf(Sa).LCID,pb=M.ParagraphReader.text($b);0>xb&&(xb=Sa.cpBegin);if(Qb&&!this.Gjb(f.a.charAt(pb,xb))||this.rDf(pb.substring(f.a.J3a(pb,xb)+1,xb)))return a.a.mark(4667),null;Sa=-1;Qb=Q.a.JOc($b);for(var dc=0;dc<Qb.length;dc++)if(xb>Qb[dc].cpEnd)Sa=Qb[dc].cpEnd;
else{if(xb>Qb[dc].cpBegin)return null;break}Qb=0;dc=xb;let Ob=null;do{dc=dc?this.pMd(pb,dc-1):-1;dc<Sa&&(dc=Sa-1);const ob=f.a.substring(pb,dc+1,xb);++Qb;var Vb=null;let Xb=!1;if(H.a.rUh){const Xa=pb+String.fromCharCode(Ib);Xb=this.Rzc.some(Pb=>Pb.pattern.exec(Xa))}Xb||(Vb=this.Z_h(ob,hc,null));if(Vb)this.AV.CSa&&(Ob=vb.jG($b,dc+1,xb,Vb,this.Kd),Ua.wKf());else for(const Xa of this.Rzc)if(!(Xa.flags&1&&-1!==dc||Xa.flags&4&&Ib!==k.a.Fs||Xa.flags&2&&Ib!==k.a.QIa)&&(Vb=Xa.pattern.exec(ob))){Ob=Xa.Clm($b,
dc+1,xb,Vb,this.Kd,this.ga);if(Ob.commandId!==G.a.f3e&&!this.AV.CSa||Ob.commandId===G.a.f3e&&!this.AV.c5c)Ob=null;break}}while(0<=dc&&dc>=Sa&&!Ob&&Qb<Ua.DNi);a.a.mark(4667);return Ob}y_h(Sa,xb,Qb){Sa=N.SelectionFactory.ho(Sa,!1);if(!Sa)return null;Sa=Sa.Pc;return I.SelectionEditor.gf(Sa)?this.zkf(Sa,xb,!1,Qb):null}G_h(Sa,xb){var Qb=N.SelectionFactory.ho(Sa,!1);if(!Qb)return null;let Ib=Qb.Pc;Qb.Cx&&Qb.Pc.contextId!==z.a.endOfParagraph&&0<=xb&&(Ib=E.a.Qc(Sa,xb));if(!I.SelectionEditor.gf(Ib)||Q.a.Gwa(Ib,
!1))return null;Qb=M.ParagraphReader.text(Ib.node);Sa=0<xb?f.a.J3a(Qb,xb-1)+1:f.a.J3a(Qb,Qb.length-1)+1;xb=0<xb?xb:Qb.length;Qb=f.a.substring(Qb,Sa,xb);return!Qb||this.tZg&&!Q.a.x3a(Qb)||!f.a.uU(Qb)&&!f.a.jUc(Qb)||!Ua.hyperlinkEditor.J0n(Ib,Sa,xb)?null:this.P6j.ibl(Ib.node,Sa,xb)}L_h(Sa,xb){var Qb=N.SelectionFactory.ho(Sa,!1);if(!Qb)return null;var Ib=Qb.Pc;if(!I.SelectionEditor.gf(Ib))return null;0>xb&&(xb=Ib.cpBegin);var $b=M.ParagraphReader.text(Ib.node);Qb=this.Vkf($b,xb);const hc=Ua.h3e.length;
for(let pb=0;pb<hc;++pb){const dc=$b.lastIndexOf(f.a.charAt(Ua.h3e,pb),xb-1);dc>Qb&&(Qb=dc+1)}$b=f.a.substring($b,Qb,xb);if(!$b)return null;Ib=this.rpf(Ib).LCID;return(new kb($b,Ib)).UPm()?eb.jG(Sa,Qb,xb,this.Kd):null}v_h(Sa,xb){var Qb=N.SelectionFactory.ho(Sa,!1);if(!Qb)return null;Qb=Qb.Pc;if(!I.SelectionEditor.gf(Qb))return null;0>xb&&(xb=Qb.cpBegin);var Ib=M.ParagraphReader.text(Qb.node);Qb=this.Vkf(Ib,xb);Ib=f.a.substring(Ib,Qb,xb);return Ib?(Ib=(new Ma(Ib)).fJl())?ya.jG(Sa,Qb,xb,Ib,this.Kd):
null:null}EEl(Sa,xb,Qb,Ib,$b){var hc=N.SelectionFactory.ho(Sa,!1);if(!hc)return null;hc=hc.Pc;if(Qb>xb||!I.SelectionEditor.gf(hc))return null;0>xb&&(xb=hc.cpBegin);if(0>xb)return null;hc=M.ParagraphReader.text(hc.node);return Fb.jG(Sa,Qb,$b,xb?hc.charAt(xb-1):"\x00",this.Kd,Ib)}kzb(Sa,xb,Qb,Ib){this.Rzc.push(new Wa(`^${Sa}$`,xb,Qb,Ib))}dNf(Sa){if(this.VSb[this.Dab]){const xb=this.VSb[this.Dab];for(const Qb in Sa)xb[Qb]=Sa[Qb]}else this.VSb[this.Dab]=Sa}iNf(Sa){this.jpc[this.Dab]?this.jpc[this.Dab].push(...(Sa||
[])):this.jpc[this.Dab]=Sa}C0m(Sa,xb){var Qb;this.Ste.has(xb)||(this.Ste.add(xb),null===(Qb=x.AFrameworkApplication.Ne)||void 0===Qb?void 0:Qb.xj(Sa,1,null,null,!1,3,Ib=>{this.Dab=xb;try{Object(u.a)(Ib.data.ve)}catch($b){n.ULS.sendTraceTag(5898336,324,50,"Failed to parse autocorrect: {0}",{["ResponseData"]:Ib.data?Ib.data.ve:""})}this.Dab=-1},()=>{this.mwl(xb)},null,void 0,void 0,void 0,void 0,"27"))}mwl(Sa){Sa=J.g9h(Sa);0<Sa&&this.gLc(Sa)}static get KJk(){return null!=Ua.Awg?Ua.Awg:Ua.Awg=(()=>Ua.swh.map(([Sa,
...xb])=>(new Wa(`^${Sa}`,...xb)).pattern))()}static get swh(){return null!=Ua.Bwg?Ua.Bwg:Ua.Bwg=(()=>[...va.d4f.map(Sa=>[Sa,va.uT,va.jG,3]),["\\(?(\\d+)[\\.\\)\\-]",hb.uT,hb.jG,3],["\\(?(L|l|C|c|D|d|M|m){1}[\\.\\)\\-]",Ga.uT,Ga.jG,3],...Bb.d4f.map(Sa=>[Sa,Bb.uT,Bb.jG,11]),["\\(?([A-Za-z]){1}[\\.\\)\\-]",Ga.uT,Ga.jG,3]])()}L0m(){this.gLc(1033);this.kzb("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Ea.uT,Ea.jG,5);this.kzb("=rand\\.old\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Ea.uT,Ea.jG,5);this.kzb("=lorem\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",
Ea.uT,Ea.jG,5);Ua.swh.forEach(Sa=>this.kzb(...Sa));this.kzb("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",sa.uT,sa.jG,0);this.kzb("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",Ha.uT,Ha.jG,0);this.kzb("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",Ha.uT,Ha.jG,0)}gLc(Sa){this.Ste.has(Sa)||this.C0m(L.a.OMk(String.format("Acl/Acl{0}.js",Sa)),Sa)}static wKf(){y.a.instance.Sa("Common.ISystemInitiatedFeedback").execute(Sa=>{Sa.logActivity("AutocorrectStringMatch",null)})}static get hyperlinkEditor(){return null!=
Ua.bBg?Ua.bBg:Ua.bBg=y.a.instance.resolve("Box4.IHyperlinkEditor")}}Ua.g3e=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";Ua.h3e=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";Ua.N$f=".!?";Ua.DNi=5;Object(F.a)(Ua,"AutoCorrectRules",null,[680])},1653:function(F,K,c){F=c(0);var l=c(35),f=c(7),a=c(453),k=c(566),x=c(55),y=c(2),n=c(38);const u=(Y,ba,aa)=>{if(Y){var fa=0;do{try{Y();break}catch(na){if(f.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",
fa,aa,na.message,na.stack),fa>=ba)break}fa++}while(1)}};var z=c(90),w=c(27),E=c(200),G=c(191),H=c(57),L=c(310),I=c(20),N=c(140);class Q{constructor(Y,ba,aa,fa,na,oa,ja,qa,Ia=!0,Va=null,Na=!1){this.YZh="FileUpload.ashx";this._iframe=null;this._initialized=!1;this.Bl=this.ktc=this.YAe=this.LYa=this.gjd=this.tE=this._form=null;this.Kh=!1;this.Py=this.hjd=this.kdb=null;this._parent=Y;this.J7j=ba;this.cik=aa;this.DWg=na;this.zBa=ja;this.OKg=qa;this.lOg=Va;this.dXe=!1;this.I8j=fa.$("CanaryRenewalForFileUploadIsEnabled");
this.$0o=!1;(this.Hbb=Na)||this.x9k(oa);Ia&&this.Fri()}get Hej(){return this.cik}get sessionId(){return this.zBa}get iFrame(){return this._iframe}get JT(){return this.tE}get aKb(){return y.AFrameworkApplication.K?y.AFrameworkApplication.K.$("NativeFileOpenDialogIsEnabled"):!1}get SZh(){return y.AFrameworkApplication.K?y.AFrameworkApplication.K.$("FileInputDescriptionAccessibilityIsEnabled"):!1}get wOm(){return this.Hbb?!1:G.b(this._iframe.contentWindow.location.pathname,this.YZh,0)}get sCk(){return!I.a.zoa&&
y.AFrameworkApplication.K.$("AllowMultipleImageInsertFromLocalDevice")}Fri(){this.Py=N.a.create().toString();this.Hbb?this.qif():this.lEk()}x9k(Y){this._iframe=document.createElement("iframe");this._iframe.className=Y;this._iframe.id=Y;this.DWg&&(this._iframe.style.visibility="visible",this._iframe.style.height="30px",this._iframe.setAttribute("frameborder","0"));this.LYa=Object(x.a)(this,this.KWf,"onUploadFrameLoad");n.a.addHandler(this._iframe,"load",this.LYa)}oJd(Y=null){y.AFrameworkApplication.ta.rae();
if(!this.tE)return f.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";n.a.addHandler(this.tE,"change",()=>{this.WBl(Y)});u(Object(x.a)(this,this.RZh,"fileInputClick"),1,"DoFileOpenDialog");return this.tE.value}WBl(Y){Y&&Y(this.tE.value)}XBl(){this.gjd&&(this.gjd.innerText=this.sai())}GXn(Y){n.a.addHandler(this.tE,"change",()=>{Y(this.sai())})}sai(){let Y=null;if(this.tE.value){const ba=this.tE.value,aa=ba.lastIndexOf("\\");0<aa&&(Y=ba.substring(aa+1,ba.length))}return Y?Y:""}RZh(){try{f.ULS.sendTraceTag(35939520,
322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.tE.click()}catch(Y){throw f.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",Y.message),Y;}}R9c(){this.WSm()?this.Ywj():(this.Dng(),this._form.submit())}WSm(){return(this.I8j||this.Hbb)&&!(void 0===window.self.FormData||null===window.self.FormData)}Ajj(Y){if(Y){const ba=this.DKh();this.Bl=new XMLHttpRequest;this.Bl.open("POST",ba);this.Bl.setRequestHeader("X-CorrelationId",this.Py);this.R3m(Y);
this.Bl.onreadystatechange=Object(x.a)(this,this.jza,"uploadResponseReceived");this.Bl.send(Y)}}R3m(Y){if(!I.a.zoa&&Y.get){var ba=Y.get("ImageId");Y=window.self.navigator;ba={["CorrelationId"]:this.Py,["Canary"]:y.AFrameworkApplication.canary,["ImageNodeId"]:ba};Y&&(Y=Y.connection?Y.connection:Y.mozConnection?Y.mozConnection:Y.webkitConnection?Y.webkitConnection:null)&&(ba.effectiveType=Y.effectiveType,ba.downlink=Y.downlink,ba.type=Y.type,ba.rtt=Y.rtt);f.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",
ba)}}Ywj(){try{this.Dng();f.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");const Y=new (Type.parse("FormData"))(this._form);this.Ajj(Y)}catch(Y){f.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+Y.message),this.wfc(null)}}Xwj(Y){try{if(this.Dng(),f.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.E2o(Y)){this.hjd=Y;this._form.contains(this.tE)&&
this._form.removeChild(this.tE);var ba=new (Type.parse("FormData"))(this._form);ba.append("applicationfileInput",Y.blob,Y.filename);this.Ajj(ba)}else this.wfc(null)}catch(aa){f.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+aa.message),this.wfc(null)}}E2o(Y){return Y&&void 0!==Y.blob&&null!==Y.blob&&void 0!==Y.filename&&null!==Y.filename&&""!==Y.filename?void 0===window.self.FormData||null===window.self.FormData?(f.ULS.sendTraceTag(578380442,322,
10,"FormData isn't supported"),!1):!0:(Y=Y?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===Y.blob||null===Y.blob,void 0===Y.filename||null===Y.filename||""===Y.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",f.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",Y)),!1)}jza(){if(4===this.Bl.readyState)if(200===this.Bl.status){f.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",
this.Py);const Y=this.Bl.getResponseHeader("X-NewKey"),ba=this.KHm(this.Bl);let aa=!1;if(void 0!==Y&&null!==Y&&ba&&(aa=this.p2o(Y),!this.dXe&&aa)){f.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.Py);this.dXe=!0;this.XGd();void 0!==this.hjd&&null!==this.hjd?this.Xwj(this.hjd):this.Ywj();return}f.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",
this.dXe,ba,!(void 0===Y||null===Y),aa,this.Py);this.wfc(this.Bl.responseText)}else f.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Bl.status,this.Bl.responseText?!1:!0,this.Py),this.wfc(null)}KHm(Y){try{const ba=l.a(Y.responseText).Responses;if(void 0!==ba&&null!==ba&&1===ba.length){const aa=ba[0];if(void 0!==aa&&null!==aa&&2===aa.length&&28===aa[1].StatusCode)return!0}}catch(ba){}return!1}p2o(Y){L.a.kmg(Y);return y.AFrameworkApplication.canary!==
Y?!1:!0}Dng(){this.kdb||(this.kdb=new Date)}dispose(){this.Kh||(this.Hbb?this._parent.removeChild(this._form):(this._parent.removeChild(this._iframe),n.a.removeHandler(this._iframe,"load",this.LYa),this.LYa=null),this.YAe&&(n.a.removeHandler(this.tE,"change",this.YAe),this.YAe=null),this.SZh&&(this.ktc&&(n.a.removeHandler(this.tE,"change",this.ktc),this.ktc=null),this.gjd=null),this.tE=this._form=this._parent=this._iframe=null,this.Kh=!0,this.kdb=null,f.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}delayedDispose(){this.dispose()}b4b(Y,
ba){if(this._form){var aa;(aa=this._form.querySelector("input[name="+Y+"]"))?aa.value=ba:(aa=this.fbf(),aa.type="hidden",aa.id=Y,aa.name=Y,aa.value=ba,this._form.appendChild(aa))}}fbf(){return this.Hbb?document.createElement("input"):this._iframe.contentWindow.document.createElement("input")}KWf(){try{if(!this._iframe.contentWindow.document.body)return}catch(ba){this.RQc();return}if(!(this._initialized||this.aKb&&I.a.OH))this.qif();else if(!this.aKb||!I.a.OH||this.wOm){let ba;ba=I.a.Gt?this._iframe.contentWindow.document.body.innerText:
this.$0o?this._iframe.contentWindow.document.body.firstChild.innerText:this._iframe.contentWindow.document.body.firstChild.innerHTML;var Y=this._iframe.contentWindow.document.body.innerText.toLowerCase();const aa=0<=Y.indexOf("responses")||0<=Y.indexOf("wopisrc");Y=0<=Y.indexOf("http error");!aa&&Y&&f.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this._iframe.contentWindow.document.body.innerText);this.wfc(ba)}}qif(){if(!this._initialized){var Y=this.QD("uploadForm");
const ba=this.QD("fileInput"),aa=this.DKh();this.Hal();this._form.id=Y;this._form.method="post";this._form.encoding="multipart/form-data";this._form.action=aa;this.tE.type="file";this.OKg&&(this.tE.accept=this.OKg,this.lOg&&(this.tE.capture=this.lOg));this.tE.id=ba;this.tE.name=ba;this.sCk&&(this.tE.multiple=!0);!this.SZh||I.a.Gt||I.a.iu||(this.ktc=Object(x.a)(this,this.XBl,"fileInputChangedHandleAccessibility"),n.a.addHandler(this.tE,"change",this.ktc),this.gjd=w.a.cth(this._form,this.tE,"InputFileDescription"));
this.DWg&&(this.Hbb||(Y=this._iframe.contentWindow.document.body,Y.style.margin="0",Y.style.overflow="hidden"),Y=y.AFrameworkApplication.ta,this.tE.style.fontFamily=Y.cza,this.tE.style.fontSize=Y.Dlg,this.tE.style.margin="0");(Y=document.getElementById("__REQUESTDIGEST"))&&this.b4b("__REQUESTDIGEST",Y.value);this.XGd();this._form.appendChild(this.tE);this._initialized=!0;this.J7j(this)}}Hal(){if(this.Hbb)this._form=document.createElement("form"),this._parent.appendChild(this._form),this.tE=document.createElement("input");
else{this._form=this._iframe.contentWindow.document.createElement("form");const Y=this._iframe.contentWindow.document;Y.body.appendChild(this._form);this.tE=Y.createElement("input")}}lEk(){this._parent.appendChild(this._iframe);this.aKb&&I.a.OH&&this.qif()}DKh(){var Y=new E.QueryStringBuilder(this.YZh);y.AFrameworkApplication.nfa(Y);this.fho(Y);Y=Y.toString();if(I.a.lj||I.a.OH||I.a.iu)Y=H.a.hNc(Y);return Y}pzd(){const Y=new z.a(2,1,0,Object(x.a)(this,this.delayedDispose,"delayedDispose"),4);y.AFrameworkApplication.nc.Vb(Y)}}
Object(F.a)(Q,"UploadFrame",null,[10]);var M=c(19),J=c(250),V=c(9),X=c(1776);class W extends Q{constructor(Y,ba,aa,fa,na,oa,ja=null,qa=!1){super(Y,ba,aa,fa,na,"WACUploadFrame",y.AFrameworkApplication.userSessionId,oa,!1,ja,qa)}QD(Y){return V.App.xa.mj(Y)}fho(Y){J.a.instance.pzb(Y)}XGd(){y.AFrameworkApplication.canary&&this.b4b(a.a.canary,y.AFrameworkApplication.canary);V.App.xa.ib.activeSection.DH&&this.b4b(a.a.DH,V.App.xa.ib.activeSection.DH)}iuf(Y){let ba=null,aa;({group:aa}=k.a.q1(Y)).returnValue?
ba=aa.Responses[0]:f.ULS.sendTraceTag(41697634,322,10,"Box4UploadFrame.GetServerResponse: unable to deserialize the response");return ba}RQc(){f.ULS.sendTraceTag(41697635,322,15,"Box4ImageUploadFrame.HandleUploadError: The response is invalid, falling back on a default unspecified failure response");const Y=new X.a;Y.StatusCode=14;this.Hej(Y);this.pzd()}wfc(Y){Y?(Y=M.a.Jwj(Y),Y=Y.replace(RegExp("&amp;","g"),"&"),(Y=this.iuf(Y))?(this.Hej(Y),this.pzd()):this.RQc()):this.RQc()}}Object(F.a)(W,"Box4UploadFrame",
Q,[]);c.d(K,"a",function(){return U});class U extends W{constructor(Y,ba,aa,fa,na,oa=null,ja=!1){super(Y,ba,aa,fa,na,U.BLl(),oa,ja);this.Fri()}static BLl(){return U.alh.join(",")+","+U.nXe.join(",")}XGd(){super.XGd();this.b4b(a.a.Nqb,"1");this.b4b(a.a.tRb,"1")}RQc(){super.RQc();f.ULS.sendTraceTag(41697632,322,15,"Box4ImageUploadFrame.HandleUploadError: Falling back on a default Unspecified Failure response")}iuf(Y){const ba=super.iuf(Y);if(!ba)try{const aa=l.a(Y);k.a.Cmf(aa)}catch(aa){f.ULS.sendTraceTag(41697633,
322,10,"Box4ImageUploadFrame.GetServerResponse: {0}",aa.toString())}return ba}}U.alh=".jpg .jpeg .png .gif .bmp .tif .tiff .jfif".split(" ");U.nXe=[".webp"];Object(F.a)(U,"Box4ImageUploadFrame",W,[])},1655:function(F,K,c){F=c(0);var l=c(140),f=c(58),a=c(353),k=c(53),x=c(3),y=c(718),n=c(18),u=c(5),z=c(297),w=c(43),E=c(1324),G=c(815),H=c(118),L=c(42),I=c(16),N=c(6),Q=c(153),M=c(41),J=c(7),V=c(1870),X=c(677),W=c(1710),U=c(124),Y=c(1559);class ba{constructor(ja,qa,Ia,Va,Na,za){this.K5b=this.CH=null;this.Lmf=
qa;if(ja[X.a.yQc])this.GX=ja[X.a.yQc],this.sEc=ja[X.a.sEc],this.K5b=Array(4),this.K5b[0]=ja[X.a.egb],this.K5b[1]=ja[X.a.fgb],this.K5b[2]=ja[X.a.ggb],this.K5b[3]=ja[X.a.dgb],this.V4o=ja[X.a.width],this.atm=ja[X.a.height],this.Xwa=void 0!==ja[X.a.Xwa]?"true"===ja[X.a.Xwa].toLowerCase():void 0,this.jt=Ia,this.z5b=Va;else{qa=ja[X.a.egb];const la=ja[X.a.fgb],va=ja[X.a.ggb],ia=ja[X.a.dgb];za&&za.$("EffectExtentPointsForGraphicsEditorIsEnabled")&&void 0!==qa&&void 0!==la&&void 0!==va&&void 0!==ia?(this.egb=
qa,this.fgb=la,this.ggb=va,this.dgb=ia):(this.egb=ja[X.a.left],this.fgb=ja[X.a.right],this.ggb=ja[X.a.top],this.dgb=ja[X.a.bottom]);this.width=ja[X.a.width];this.height=ja[X.a.height];this.rotationAngle=ja[X.a.angle];this.oEn=ja[X.a.nEn];this.jt=Ia;this.z5b=Va;this.Oeb=Na;this.WEa=2;this.flipH=this.xX(ja,X.a.flipH);this.flipV=this.xX(ja,X.a.flipV);this.Din();this.rWo()}}rWo(){this.CH||(this.CH=Array(4),this.CH[0]=U.a.rG(this.egb),this.CH[1]=U.a.rG(this.fgb),this.CH[2]=U.a.rG(this.ggb),this.CH[3]=
U.a.rG(this.dgb))}Din(){var ja=Y.c(this.rotationAngle);if(45<=ja&&135>=ja||225<=ja&&315>=ja){ja=this.width/2;const qa=this.height/2;this.egb-=ja-qa;this.fgb+=ja-qa;this.ggb-=qa-ja;this.dgb+=qa-ja}}xX(ja,qa){if(ja.hasOwnProperty(qa))return ja[qa]}}Object(F.a)(ba,"JsonToDocumentXmlResponseCommonParams",null,[]);class aa extends ba{constructor(ja,qa,Ia,Va,Na,za){super(ja,qa,Ia,Va,Na,za);this.GCk="string"===typeof ja[X.a.BAd]?ja[X.a.BAd]:null;this.r6b="string"===typeof ja[X.a.r6b]?ja[X.a.r6b]:null}}Object(F.a)(aa,
"JsonToDocumentXmlResponseDrawingParams",ba,[]);var fa=c(514);class na extends ba{constructor(ja,qa,Ia,Va,Na,za){var la,va,ia,pa,sa;super(ja,qa,Ia,Va,Na,za);this.m0o=ja[X.a.YDn];this.z5k=ja[X.a.QDn];this.WEa=1;this.z5k||(this.WEa=0,this.CH=fa.a.instance.yna(U.a.rG(this.width),U.a.rG(this.height),this.rotationAngle));this.iXf=this.xX(ja,X.a.Efc);this.q9d=this.xX(ja,X.a.q9d);this.jXf=this.xX(ja,X.a.jXf);this.YKj=this.xX(ja,X.a.XKj);this.xpe=this.xX(ja,X.a.xpe);this.ppg=this.xX(ja,X.a.ppg);this.p4c=
null!==(la=this.xX(ja,X.a.p4c))&&void 0!==la?la:"";this.extension=ja[X.a.extension];this.Kua=null!==(va=this.xX(ja,X.a.left))&&void 0!==va?va:0;this.Mua=null!==(ia=this.xX(ja,X.a.top))&&void 0!==ia?ia:0;this.Lua=null!==(pa=this.xX(ja,X.a.right))&&void 0!==pa?pa:0;this.Jua=null!==(sa=this.xX(ja,X.a.bottom))&&void 0!==sa?sa:0;this.lockAspectRatio=this.xX(ja,X.a.lockAspectRatio);this.Oxh=this.xX(ja,X.a.pia);this.borderStyle=this.xX(ja,X.a.Kpa);this.borderColor=this.xX(ja,X.a.LGa);this.lMk=void 0!==this.Oxh||
void 0!==this.borderStyle||void 0!==this.borderColor;this.altTextDescription=this.xX(ja,X.a.altTextDescription);this.alphaModFix=this.xX(ja,X.a.alphaModFix)}}Object(F.a)(na,"JsonToDocumentXmlResponsePictureParams",ba,[]);c.d(K,"a",function(){return oa});class oa{constructor(ja,qa,Ia,Va,Na,za,la,va,ia,pa,sa,Ha,ra,Ma,ya,Ga,wa){this.Q$a=this.$xb=null;this.lkd=ja;this.YBe=qa;this.fK=Ia;this.Im=Va;this.Nl=Na;this.Ic=za;this.W2j=va;this.ETg=la;this.Uj=ia;this.Do=pa;this.Tfk=sa;this.Sfk=Ha;this.Fa=ra;this.BV=
Ma;this.ld=ya;this.m9j=Ga;this.p7j=wa}vpa(ja,qa,Ia,Va,Na,za,la){za.stop();la?J.ULS.sendTraceTag(575522565,3001,10,ja):J.ULS.sendTraceTag(575522566,3001,10,ja);this.ETg?(Va=this.Ic.Oc(7,x.a.zQc),Va.Cb(Ia),this.Fa&&this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&qa.Fb.setValue(H.a.GOa,!1),qa.Fb.setValue(L.a.R_,0),qa.Fb.setValue(I.a.Eha,qa.cRk),qa.Fb.setValue(I.a.Dha,qa.aRk),Va.dispose()):Va();this.Q$a&&this.Q$a(ja);Na()}lfc(ja,qa,Ia,Va,Na,za,la){J.ULS.sendTraceTag(575522567,
3001,50,"GraphicsEditorJsonToDocumentXmlRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:la.si});var va=ja.data.ve,ia=null;try{ia=JSON.parse(va)}catch(sa){this.vpa("Failed to parse incoming JSON blob.",qa,Na,Va,Ia,la,!1);return}if(V.a.error in ia)this.vpa("Error code returned from WordGraphicsEditorHandler endpoint: "+ia[V.a.error],qa,Na,Va,Ia,la,!1);else{va=10;var pa=1;try{va=parseInt(ia[X.a.jt]),pa=parseInt(ia[X.a.z5b])}catch(sa){this.vpa("Invalid data found in the JSON blob. (i.e. placeholderkind/drawingid)",
qa,Na,Va,Ia,la,!1);return}Ia=ja.data.request?y.a.OLc(ja.data.request.get_body()):null;ja=null;ja=qa.Fb;Va=qa.getId();qa=ja.getValue(N.a.jt);qa=qa!==va&&(5===qa||5===va||this.Qqm(ja,ia));5===va?(ia=new na(ia,this.YBe,va,pa,Ia,this.Fa),ja=this.WRl(Na,za,ia,qa,ja,Va)):(ia=new aa(ia,this.YBe,va,pa,Ia,this.Fa),ja=this.VRl(Na,za,ia,qa,ja,Va));ia=this.Ic.Oc(7,x.a.zQc);va=Na;n.ImageReader.G8(Na)&&qa&&(va=u.GraphIterator.$a(Na),va.zb(12),va=va.parentNode);ia.Cb(va);ja();this.fK.AHa(za);ia.dispose();if(this.Nl&&
this.Nl!==l.a.nil){const sa=va.Vi();null===sa||void 0===sa?void 0:sa.contentReplicator.forceOutbound(()=>{J.ULS.sendTraceTag(574358089,3001,50,"Graphical Content Properties Persisted to Box4: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:la.si});la.stop();const Ha=new f.a(this.Nl,1);this.Im.s3b(sa,Ha);const ra=this.lkd.properties;null!=ra&&Object(z.a)(()=>{const Ma=new w.GraphTransaction(3,x.a.imageRotate);Ma.Cb(Na);ra.setValue(H.a.b5,1);Ma.dispose()})},null,null)}this.$xb&&this.$xb(Na)}}fth(ja,
qa){ja.ze(V.a.DZf,"false");ja.ze(V.a.Lmf,this.YBe);ja.ze(V.a.D$e,"0");ja.JI(X.a.Oeb,window.self.devicePixelRatio.toString());void 0!==qa&&null!==qa&&(qa=this.Do.Ym(qa.gk),qa=this.Do.Ui(qa),ja.ze(X.a.jt,E.a[qa]));this.m9j&&(ja.ze(X.a.pWd,"true"),ja.ze(X.a.Nwm,this.p7j.toString()))}Qmh(ja){if(this.ETg){ja=ja.gk;var qa=this.Do.Ym(ja);if(!qa)return null;const Ia=new W.a(this.W2j,qa),Va=this.Ic.Oc(15,x.a.zQc);Va.Cb(ja.node);this.P1i(qa,!1);qa.setValue(N.a.jt,qa.ia(N.a.jt,10));Va.jk=x.a.zQc;Va.ZFa(this.Nl,
1);Va.dispose();return Ia}qa=new a.DictionaryPropertySet;this.P1i(qa,!0);return(ja=this.Uj.tTh(ja,qa,this.Nl))&&ja.blob?new W.a(ja.blob.id,ja.blob.properties):null}bSd(){return Box4Intl.Box4Strings.l_GraphicsEditorError}P1i(ja,qa){ja.setValue(I.a.Eha,k.a.Vl(this.Tfk,0));ja.setValue(I.a.Dha,k.a.Vl(this.Sfk,1));this.Fa&&this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&!qa?ja.setValue(H.a.GOa,!0):ja.setValue(L.a.R_,1);ja.setValue(Q.a.g4,!0)}VRl(ja,
qa,Ia,Va,Na,za){const la=va=>{this.lkd.TWo(Ia,va,ja)};return this.NQi(Va,Na,ja)?this.S6h(qa,Na,za,la):()=>{la(Na)}}WRl(ja,qa,Ia,Va,Na,za){const la=va=>{this.lkd.UWo(Ia,va,ja)};return this.NQi(Va,Na,ja,Ia)?this.S6h(qa,Na,za,la):()=>la(Na)}NQi(ja,qa,Ia,Va){return ja?!0:Va?n.ImageReader.hRd(qa,Ia.Kc,!1)!==Va.iXf:!1}S6h(ja,qa,Ia,Va){const Na=G.a.instance.pdd;Na.Vw(qa);Na.id=Ia;return()=>{this.lkd.L4n(ja,Ia,Na,this.BV,Va)}}Koo(ja){this.$xb=ja}ijo(ja){this.Q$a=ja}Qqm(ja,qa){return this.ld.isFeatureEnabled(46)&&
(ja.hasProperty(M.a.GX)&&!qa[X.a.yQc]||!ja.hasProperty(M.a.GX)&&qa[X.a.yQc])?!0:!1}}Object(F.a)(oa,"GraphicsEditorJsonToDocumentXmlRequestHelper",null,[386])},1656:function(F,K,c){F=c(0);var l=c(74),f=c(55),a=c(321),k=c(336);class x{constructor(E,G,H,L=0,I=0,N=null,Q=null){this.commandId=E;this.controlId=G;this.timeStamp=H;this.commandSurface=a.a[L];this.Kx=k.a[I];this.contentType=N;this.Nle=Q}}Object(F.a)(x,"CommandActionInfo",null,[]);class y{constructor(){this.xVj=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))")}WVm(E){return!this.xVj.exec(E)}}
Object(F.a)(y,"EventsCacheLoggingUtils",null,[]);var n=c(2),u=c(1830),z=c(647);c.d(K,"a",function(){return w});class w{constructor(){this.$5g=null;this.eKe=20;this.otc=this.Vfd=this.ygd=null}init(){this.$5g=new y;this.ygd=new l.a;this.Vfd=new l.a;this.otc=new l.a;this.eKe=n.AFrameworkApplication.K.mc("MaxCommandClickedEventQueueSize",20);u.a.gyk(Object(f.a)(this,this.G1k,"commandClickEventRaised"));z.a.instance.hqh(Object(f.a)(this,this.sRn,"recordActionEvent"))}Skg(E){E.count>this.eKe&&E.removeAt(this.eKe)}G1k(E,
G){this.ygd.insert(0,new x(G.commandId,G.controlId,G.time,G.commandSurface,G.Kx,G.contentType));this.Skg(this.ygd)}sRn(E,G){this.Vfd.insert(0,new x(G.actionName,G.controlId,G.timeStamp,G.commandSurface,G.Kx,G.contentType,G.Nle));this.Skg(this.Vfd);this.$5g.WVm(G.actionName)&&(this.otc.insert(0,new x(G.actionName,G.controlId,G.timeStamp,G.commandSurface,G.Kx,G.contentType,G.Nle)),this.Skg(this.otc))}QNc(){return this.ygd}jhb(){return this.Vfd}static get instance(){return w._instance||(w._instance=
new w)}}w._instance=null;Object(F.a)(w,"CommandClickEventsCache",null,[])},1658:function(F,K,c){F=c(0);class l{}Object(F.a)(l,"AuthContext",null,[]);var f=c(2),a=c(742);c.d(K,"a",function(){return k});class k{static getAuthContext(){const x=f.AFrameworkApplication.K.jb("UserPrincipalName")||"";let y=x;f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(y=a.OAuthManagerSettings.nkn||x);return Object.assign(new l,{upn:x,loginHint:y,authority:a.OAuthManagerSettings.authority,
authorityType:k.iOd(),tenantId:f.AFrameworkApplication.K.jb("TenantId")||""})}static iOd(){let x=0;const y=k.X4h();"aad"===y.toLowerCase()?x=2:"msa"===y.toLowerCase()&&(x=1);return x}static X4h(){return f.AFrameworkApplication.K.jb("HostAuthType")||""}}Object(F.a)(k,"OAuthIdentity",null,[])},1659:function(F,K,c){c.r(K);F=c(0);var l=c(1821),f=c(55),a=c(1823),k=c(443),x=c(1824),y=c(171),n=c(2),u=c(95),z=c(88),w=c(525),E=c(228),G=c(11),H=c(66),L=c(79),I=c(100),N=c(90),Q=c(27),M=c(54),J=c(39),V=c(20),
X=c(13);class W{constructor(ba){this.N4d=4;this.Hbh=0;this.ZRg=this.dOg=this.ddh=this.eTg=this.weh=this.GBa=this.h_b=this.Nw=this.vhh=this.jWg=this.kWg=this.wBa=this.QXa=this.sze=this.QVa=this.IVa=this.W=this.f6=this.Sza=null;V.a.Ewa&&(this.N4d=6);this.uv=ba;this.tZ=I.KeyInputManager.jc(L.a.A1,0);this.render()}get containerElement(){return this.W}dispose(){var ba=n.AFrameworkApplication.ta.gD;const aa=n.AFrameworkApplication.ta.hD;ba.sc(G.a.click,this.W,Object(f.a)(this,this.fUi,"onContainerClick"));
ba.sc(G.a.pB,this.W,Object(f.a)(this,this.gUi,"onContainerDoubleClick"));aa.sc(G.a.uh,this.W,Object(f.a)(this,this.hUi,"onContainerKeyPress"));this.IVa&&(ba.sc(G.a.click,this.IVa,Object(f.a)(this,this.OTf,"onDeleteButtonClick")),aa.pqb(this.IVa,this.ZRg));this.QVa&&(ba.sc(G.a.click,this.QVa,Object(f.a)(this,this.VTf,"onDoneButtonClick")),aa.pqb(this.QVa,this.eTg));this.wBa&&(ba.sc(G.a.click,this.wBa,Object(f.a)(this,this.o8d,"onSaveButtonClick")),aa.pqb(this.wBa,this.weh));this.Sza&&(ba.sc(G.a.click,
this.Sza,Object(f.a)(this,this.mTf,"onCancelButtonClick")),aa.pqb(this.Sza,this.dOg));this.QXa&&(ba.sc(G.a.click,this.QXa,Object(f.a)(this,this.SVf,"onReplyButtonClick")),aa.pqb(this.QXa,this.ddh));this.Nw&&(aa.sc(G.a.ju,this.Nw,Object(f.a)(this,this.vGa,"onKeyEvent")),aa.sc(G.a.uh,this.Nw,Object(f.a)(this,this.vGa,"onKeyEvent")),V.a.ti&&(ba=n.AFrameworkApplication.ta.Elc,ba.sc(G.a.wHc,this.Nw,Object(f.a)(this,this.pGa,"onCompositionEvent")),ba.sc(G.a.v3b,this.Nw,Object(f.a)(this,this.pGa,"onCompositionEvent")),
ba.sc(G.a.w3b,this.Nw,Object(f.a)(this,this.pGa,"onCompositionEvent"))),w.a.instance.sc(G.a.paste,this.Nw,Object(f.a)(this,this.i0c,"onPaste")));this.GBa=this.h_b=this.Nw=this.Sza=this.wBa=this.sze=this.QVa=this.QXa=this.IVa=this.W=null}focus(){H.FocusManager.instance().cD(y.AFrame.Kr);this.W.focus();this.uv.Wq.Iof().fk.Ly(this.W)}m1h(){H.FocusManager.instance().cD(a.a.nHc);this.Nw.focus();this.uv.Wq.Iof().fk.Ly(this.Nw);2===this.uv.Xq&&this.Nw.value&&0<this.Nw.value.length&&J.a.A6c(this.Nw);const ba=
this.uv.Wq.Oca.i1c,aa=J.a.x1a(ba,this.W);aa.y+this.W.clientHeight>ba.scrollTop+ba.clientHeight&&(ba.scrollTop=aa.y+this.W.clientHeight-ba.clientHeight)}$El(){Sys.UI.DomElement.removeCssClass(this.W,"NewOrEditComment");this.Sza.style.display="none";this.Nw.style.display="none";H.FocusManager.Xkg(this.Nw);H.FocusManager.Xkg(this.wBa);H.FocusManager.instance().fe(a.a.nHc).jr(this.tZ);H.FocusManager.instance().N5a(a.a.nHc);I.KeyInputManager.instance.sc(G.a.ju,this.Nw,Object(f.a)(this,this.vGa,"onKeyEvent"));
I.KeyInputManager.instance.sc(G.a.uh,this.Nw,Object(f.a)(this,this.vGa,"onKeyEvent"));if(V.a.ti){const ba=n.AFrameworkApplication.ta.Elc;ba.sc(G.a.wHc,this.Nw,Object(f.a)(this,this.pGa,"onCompositionEvent"));ba.sc(G.a.v3b,this.Nw,Object(f.a)(this,this.pGa,"onCompositionEvent"));ba.sc(G.a.w3b,this.Nw,Object(f.a)(this,this.pGa,"onCompositionEvent"))}w.a.instance.sc(G.a.paste,this.Nw,Object(f.a)(this,this.i0c,"onPaste"));this.f6.removeChild(this.Nw);this.f6.removeChild(this.h_b);this.GBa=this.h_b=this.Nw=
null;this.lng();this.tbd();this.focus()}tbd(){this.Bcj(this.vhh,this.kWg,this.jWg,this.sze,this.W)}render(){var ba=k.a("a",this.Pha("cc"),"CommentContainer");Q.a.hr(ba,Q.a.xfa,a.a.W2k);ba.tabIndex=0;this.uv.Cf&&(ba.className+=" Reply1");var aa=k.a("div",this.Pha("ch"),"CommentHeaderRow");const fa=k.a("span",this.Pha("ca"),"CommentAuthor UIFontBold");fa.innerText=this.uv.author;aa.appendChild(fa);const na=k.a("span",this.Pha("ct"),"CommentDate");na.innerText=W.$hl(this.uv.date,this.uv.Wq.Zhl,this.uv.Wq.QKo);
Sys.UI.DomElement.addCssClass(na,n.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight");aa.appendChild(na);const oa=k.a("span",this.Pha("ci"),"CommentStatusIcon");aa.appendChild(oa);let ja=null;this.uv.lHb&&(ja=x.a.r_a(this.Pha("cl"),a.a.$1k,CommonUIStrings.l_CommentCancelButton,"ClosePaneGlyph_16x16x32",!1),Sys.UI.DomElement.addCssClass(ja,n.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight"),ja.tabIndex=0,aa.appendChild(ja));this.f6=k.a("div",this.Pha("cn"),"CommentContent");let qa=null,Ia=null,
Va=null;this.uv.lHb?(qa=k.a("textarea",this.Pha("ce"),a.a.VGh+" UIFont"),qa.rows=this.N4d,qa.cols=50,qa.tabIndex=0,Q.a.hr(qa,"title",CommonUIStrings.l_CommentContent),this.f6.appendChild(qa),Ia=k.a("div","","CommentTextMeasurementContainer"),Va=k.a("textarea","",a.a.VGh+" UIFont"),Va.rows=1,Va.cols=50,Va.style.visibility="hidden",Va.spellcheck=!1,Ia.appendChild(Va),this.f6.appendChild(Ia),2===this.uv.Xq&&(qa.value=this.uv.text.join("\n")+"\n")):this.lng();const Na=k.a("div","","CommentFooterRow"),
za=k.a("span",this.Pha("cf"),""),la=x.a.r_a(this.Pha("cr"),a.a.Q2k+" CommentFooterButton",CommonUIStrings.l_CommentReplyButton,"CommentReply_16x16x32",!1);la.tabIndex=0;la.setAttribute(Q.a.qh,Q.a.j3);za.appendChild(la);const va=x.a.r_a(this.Pha("cd"),"CommentDoneButton CommentFooterButton",CommonUIStrings.l_CommentDoneButton,"CheckboxUnchecked_16x16x32",!1);va.tabIndex=0;const ia=va.childNodes[0].childNodes[0];za.appendChild(va);const pa=x.a.r_a(this.Pha("cx"),a.a.a2k+" CommentFooterButton",CommonUIStrings.l_CommentDeleteButton,
"Delete_16x16x32",!1);va.tabIndex=0;za.appendChild(pa);Na.appendChild(za);const sa=k.a("span",this.Pha("cfa"),""),Ha=x.a.r_a(this.Pha("cs"),a.a.R2k,CommonUIStrings.l_CommentSaveCommentButton,null);x.a.iOb(Ha,!1);Ha.tabIndex=0;sa.appendChild(Ha);Na.appendChild(sa);this.Bcj(oa,za,sa,ia,ba);this.uv.Wq.dKh||(fa.setAttribute("Unselectable","on"),na.setAttribute("Unselectable","on"));ba.appendChild(aa);ba.appendChild(this.f6);ba.appendChild(Na);this.W=ba;this.QVa=va;this.sze=ia;this.IVa=pa;this.QXa=la;
this.wBa=Ha;this.Nw=qa;this.h_b=Ia;this.GBa=Va;this.Sza=ja;this.kWg=za;this.jWg=sa;this.vhh=oa;ba=n.AFrameworkApplication.ta.gD;aa=n.AFrameworkApplication.ta.hD;ba.nb(G.a.click,this.W,Object(f.a)(this,this.fUi,"onContainerClick"));ba.nb(G.a.pB,this.W,Object(f.a)(this,this.gUi,"onContainerDoubleClick"));aa.nb(G.a.uh,this.W,Object(f.a)(this,this.hUi,"onContainerKeyPress"));this.QVa&&(ba.nb(G.a.click,this.QVa,Object(f.a)(this,this.VTf,"onDoneButtonClick")),this.eTg=aa.Anb(this.QVa,Object(f.a)(this,this.VTf,
"onDoneButtonClick"),L.a.Fs));this.QXa&&(ba.nb(G.a.click,this.QXa,Object(f.a)(this,this.SVf,"onReplyButtonClick")),this.ddh=aa.Anb(this.QXa,Object(f.a)(this,this.SVf,"onReplyButtonClick"),L.a.Fs));this.wBa&&(ba.nb(G.a.click,this.wBa,Object(f.a)(this,this.o8d,"onSaveButtonClick")),this.weh=aa.Anb(this.wBa,Object(f.a)(this,this.o8d,"onSaveButtonClick"),L.a.Fs));this.IVa&&(ba.nb(G.a.click,this.IVa,Object(f.a)(this,this.OTf,"onDeleteButtonClick")),this.ZRg=aa.Anb(this.IVa,Object(f.a)(this,this.OTf,"onDeleteButtonClick"),
L.a.Fs));this.Sza&&(ba.nb(G.a.click,this.Sza,Object(f.a)(this,this.mTf,"onCancelButtonClick")),this.dOg=aa.Anb(this.Sza,Object(f.a)(this,this.mTf,"onCancelButtonClick"),L.a.Fs));qa&&(aa.nb(G.a.ju,qa,Object(f.a)(this,this.vGa,"onKeyEvent")),aa.nb(G.a.uh,qa,Object(f.a)(this,this.vGa,"onKeyEvent")),V.a.ti&&(ba=n.AFrameworkApplication.ta.Elc,ba.nb(G.a.wHc,qa,Object(f.a)(this,this.pGa,"onCompositionEvent"),null),ba.nb(G.a.v3b,qa,Object(f.a)(this,this.pGa,"onCompositionEvent"),null),ba.nb(G.a.w3b,qa,Object(f.a)(this,
this.pGa,"onCompositionEvent"),null)),w.a.instance.nb(G.a.paste,qa,Object(f.a)(this,this.i0c,"onPaste")),this.bro())}rnj(ba){x.a.iOb(this.wBa,ba)}Pha(ba){return ba+"_"+this.uv.id}Bcj(ba,aa,fa,na,oa){switch(this.uv.SSa){case 0:case 1:this.ftj(ba,0);break;case 2:case 4:ba.style.display="none";break;case 3:Sys.UI.DomElement.addCssClass(oa,"SaveFailure"),Sys.UI.DomElement.addCssClass(oa,"NoReply"),this.ftj(ba,1)}this.uv.done?(Sys.UI.DomElement.addCssClass(oa,"CommentIsDone"),na.className=z.getImageClass("CheckboxChecked_16x16x32")):
(Sys.UI.DomElement.removeCssClass(oa,"CommentIsDone"),na.className=z.getImageClass("CheckboxUnchecked_16x16x32"));this.uv.lHb?(Sys.UI.DomElement.addCssClass(oa,"NewOrEditComment"),Sys.UI.DomElement.addCssClass(oa,"SelectedComment"),ba.style.display="none",aa.style.display="none",fa.style.display="inline",0===this.uv.Wq.mode&&(this.rnj(!1),x.a.iOb(this.Sza,!1))):(1===this.uv.Sia?(Sys.UI.DomElement.addCssClass(oa,"SelectedComment"),Sys.UI.DomElement.removeCssClass(oa,"SelectedParentComment"),aa.style.display=
1!==this.uv.Wq.mode||3===this.uv.SSa||this.uv.pQa?"none":"inline"):(2===this.uv.Sia?(Sys.UI.DomElement.removeCssClass(oa,"SelectedComment"),Sys.UI.DomElement.addCssClass(oa,"SelectedParentComment")):(Sys.UI.DomElement.removeCssClass(oa,"SelectedComment"),Sys.UI.DomElement.removeCssClass(oa,"SelectedParentComment")),aa.style.display="inline"),fa.style.display="none")}ftj(ba,aa){M.a.wC(ba);switch(aa){case 0:aa=document.createElement("img");aa.alt=CommonUIStrings.l_CommentProgressTooltip;aa.src=u.a.dba("progress16.gif");
ba.appendChild(aa);break;case 1:aa=z.createClusteredImage(16,16,"Risks_16x16x32","",!0,CommonUIStrings.l_CommentFailTooltip),ba.appendChild(aa)}ba.style.display="inline-block"}lng(){M.a.f_(this.f6);var ba=this.uv.text;1===ba.length&&ba[0]&&(ba=ba[0].split("\n"));for(const aa of ba)ba=k.a("p","","CommentContentPara"),ba.innerText=aa||"\u00a0",this.uv.Wq.dKh||ba.setAttribute("Unselectable","on"),this.f6.appendChild(ba)}bro(){const ba=H.FocusManager.instance().fe(a.a.nHc);ba.parent=y.AFrame.Kr;E.a.instance.u0b(a.a.nHc,
this.Nw);ba.bindAction(I.KeyInputManager.jc(L.a.Hre,2),X.a.Ig);ba.bindAction(this.tZ,X.a.V8e);ba.bindAction(I.KeyInputManager.jc(L.a.P5,0),X.a.W_a);ba.bindAction(I.KeyInputManager.jc(L.a.Oda,0),X.a.W_a);ba.jr(H.FocusManager.instance().uW);ba.jr(H.FocusManager.instance().vW)}fUi(ba){if(this.uv.lHb&&ba.Hb.target===this.Nw)return!0;this.uv.fWf();return!0}gUi(){this.uv.JUi();return!0}hUi(ba){let aa=!1;ba.Hb.keyCode===L.a.Fs&&(0===this.uv.Sia?this.uv.fWf():this.uv.JUi(),aa=!0);return aa}OTf(){if(this.IVa.disabled)return!0;
this.uv.$ha();return!0}VTf(){if(this.QVa.disabled)return!0;this.uv.gwn();return!0}SVf(){if(this.QXa.disabled)return!0;this.uv.Wtn();return!0}o8d(){if(this.wBa.disabled)return!0;this.uv.XKb(this.Nw.value);return!0}mTf(){if(this.Sza.disabled)return!0;this.uv.vKb();return!0}vGa(ba){if(ba.Hb.ctrlKey&&ba.Hb.keyCode===L.a.Fs)return 0<this.Nw.value.length&&this.o8d(null),!0;if(ba.Hb.keyCode===L.a.A1)return!0;this.onTextEntered(ba.eventName===G.a.ju&&ba.Hb.charCode===L.a.Fs);return!1}pGa(){this.onTextEntered(!1);
return!1}i0c(){const ba=new N.a(0,1,0,()=>{this.onTextEntered(!1)},1);n.AFrameworkApplication.nc.Vb(ba);return!1}onTextEntered(ba){if(0!==this.uv.Wq.mode&&(this.rnj(0<this.Nw.value.length),!V.a.Ewa)){this.h_b.clientWidth!==this.Nw.clientWidth&&(this.h_b.style.width=this.Nw.clientWidth+"px");this.GBa.value=this.Nw.value+"___";this.Hbh>this.Nw.value.length&&(this.GBa.rows=1);for(var aa=0,fa=Number.MAX_VALUE;1<=(aa=this.GBa.scrollHeight-this.GBa.clientHeight)&&aa<fa;)fa=aa,this.GBa.rows++;this.GBa.rows<
this.N4d?this.Nw.rows=this.N4d:(ba&&this.GBa.rows++,this.Nw.rows=this.GBa.rows);this.Hbh=this.Nw.value.length}}static $hl(ba,aa,fa){if(!ba||isNaN(ba.getDate()))return"";let na=fa;const oa=new Date;if(oa.getFullYear()!==ba.getFullYear()||oa.getMonth()!==ba.getMonth()||oa.getDate()!==ba.getDate())na=String.format(CommonUIStrings.l_CommentLongDateFormat,aa,fa);return ba.localeFormat(na)}}Object(F.a)(W,"CommentViewObject",null,[10,1210]);var U=c(140);c.d(K,"Comment",function(){return Y});class Y{constructor(ba,
aa,fa,na,oa,ja,qa,Ia,Va=!1,Na=null,za=null,la=null){this.GLg=this.HLg=this.ATg=null;this.iud=0;this.wcb=2;this.Yza=0;this.Bze=this.XN=null;this.UEf=!1;this.objectId=null;this.pQa=!1;this._id=ba;this.LXg=aa;this.tMg=fa;this.uhd=na;this.atd=oa;this.$Ja=ja;this.kW=qa;this.JXg=Ia;this.GIh=Va;this.LXj=Na;this.MXj=za;this.usersByReactionType=la;this.Yi=l.a.instance}get id(){return this._id}set id(ba){this._id=ba}get author(){return this.F_d?CommonUIStrings.l_RemovedAuthorName:this.tMg}get authorId(){return this.LXj}get H1b(){return this.MXj}get date(){return this.F_d?
null:this.uhd}set date(ba){this.uhd=ba}get done(){return this.$Ja}set done(ba){this.$Ja!==ba&&(this.$Ja=ba,this.XN&&this.XN.tbd())}get rli(){return this.JXg}set rli(ba){this.JXg=ba}get Cf(){return this.atd}set Cf(ba){this.atd=ba}get text(){return this.kW}set text(ba){this.kW=ba;this.XN&&this.XN.lng()}get uPa(){return this.LXg}set uPa(ba){this.LXg=ba}get a0a(){return this.ATg}set a0a(ba){this.ATg=ba}get vEc(){return this.HLg}set vEc(ba){this.HLg=ba}get uEc(){return this.GLg}set uEc(ba){this.GLg=ba}get Sia(){return this.iud}set Sia(ba){this.iud!==
ba&&(this.iud=ba,this.XN&&this.XN.tbd())}get SSa(){return this.wcb}set SSa(ba){this.wcb===ba||0===this.wcb&&2===ba||3===this.wcb||(this.wcb=ba,this.XN&&this.XN.tbd())}get Xq(){return this.Yza}set Xq(ba){if(this.Yza!==ba){const aa=this.lHb&&0===ba;this.Yza=ba;aa&&this.XN&&this.XN.$El()}}get lHb(){return 1===this.Yza||2===this.Yza}get F_d(){return!!this.Yi&&this.Yi.removePersonalInformation}get containerElement(){return this.XN?this.XN.containerElement:null}get Wq(){return this.Yi}get lz(){return this.Bze}set lz(ba){this.Bze=
ba}dispose(){this.XN&&(this.XN.dispose(),this.XN=null)}render(){this.XN=new W(this);return this.XN.containerElement}r4a(){this.XN&&this.XN.tbd()}focus(){this.fWf();this.XN.focus();this.lHb&&this.XN.m1h()}toString(){let ba="[null]";this.kW&&0<this.kW.length&&(ba=30<this.kW[0].length?this.kW[0].substr(0,30)+"...":this.kW[0]);return String.format('I:{0} A:{1} T:{2} R:{3} D:{4} "{5}"',this._id||"[null]",this.tMg||"[null]",this.uhd?this.uhd.toString():"[null]",this.atd||"[null]",this.$Ja,ba)}fWf(){2===
this.Wq.mode||3===this.Wq.mode?this.lHb&&this.XN.m1h():(H.FocusManager.instance().cD(y.AFrame.Kr),1!==this.iud&&this.Wq.selectComment(this._id))}JUi(){this.Wq.$Fo&&0===this.Yza&&(H.FocusManager.instance().cD(y.AFrame.Kr),this.Yza=2,this.wcb=0,this.Wq.editComment(this,null))}Jon(){3===this.Wq.mode&&(H.FocusManager.instance().cD(y.AFrame.Kr),this.Yza=0,this.wcb=2,this.Wq.u6e())}$ha(){H.FocusManager.instance().cD(y.AFrame.Kr);this.Wq.deleteComment(this)}gwn(){this.Wq.FAb(this,!this.$Ja)}Wtn(){2!==this.Wq.mode&&
(H.FocusManager.instance().cD(y.AFrame.Kr),this.Wq.addReply(this.atd||this._id,null))}XKb(ba){H.FocusManager.instance().cD(y.AFrame.Kr);this.kW=Array(1);this.kW[0]=ba;1===this.Yza?this.Wq.tua(this):this.Wq.Zeb(this)}vKb(){H.FocusManager.instance().cD(y.AFrame.Kr);this.Wq.Oca.i1c&&this.Wq.Oca.i1c.focus();1===this.Yza?(this.Wq.deleteComment(this),this.Wq.Mfe(this.Cf)):this.Jon()}static dLh(ba,aa,fa,na){const oa=U.a.create().toString();ba=new Y(oa,Y.tmm,ba,new Date,aa,!1,[],fa,!1,n.AFrameworkApplication.K.jb("PresenceUserId"),
n.AFrameworkApplication.K.jb("PresenceProvider"));ba.Yza=1;ba.wcb=0;ba.Bze=na;return ba}}Y.tmm=null;Y.L_i=-1;Object(F.a)(Y,"Comment",null,[10,667])},1660:function(F,K,c){F=c(0);var l=c(1207),f=c(2040),a=c(1081),k=c(8),x=c(103),y=c(43),n=c(28),u=c(23),z=c(302),w=c(1086),E=c(935),G=c(58),H=c(2),L=c(762),I=c(20),N=c(79),Q=c(397),M=c(741),J=c(19),V=c(15),X=c(7),W=c(367),U=c(852),Y=c(330),ba=c(854),aa=c(501),fa=c(1034),na=c(31);class oa{constructor(){this.CMe=void 0}onKeyPressed(va){return this.CMe?this.CMe(va):
!1}setKeyPressHandler(va){this.CMe=va}}var ja=c(1450),qa=c(1629),Ia=c(1563),Va=c(1527);c.d(K,"a",function(){return la});var Na;(function(va){va[va.bNj=0]="ArrowDown";va[va.cNj=1]="ArrowUp";va[va.J9o=2]="ArrowLeft";va[va.K9o=3]="ArrowRight";va[va.End=4]="End";va[va.UOj=5]="Enter";va[va.R$o=6]="Escape";va[va.rPj=7]="Home";va[va.Ybp=8]="Space";va[va.Tab=9]="Tab"})(Na||(Na={}));Object(F.b)("KeyIdentifier",Na);var za;(function(va){va.Seen="Seen";va.Tried="Tried";va.Kept="Kept";va.Rejected="Rejected"})(za||
(za={}));Object(F.b)("EngagementType",za);class la extends E.a{constructor(va,ia,pa,sa,Ha,ra,Ma,ya,Ga,wa,hb,eb,jb,ub,ab,Ea,Wa,Bb,Mb){super();this.ga=va;this.Se=ia;this.Kd=pa;this.sD=sa;this.hb=Ha;this.tI=ra;this.jA=Ma;this.xV=ya;this.RAa=Ga;this.DI=hb;this.BK=eb;this.hBa=jb;this.qWj=ub;this.Jn=ab;this.fd=Ea;this.hC=Wa;this.KF=Bb;this.Ic=Mb;this.Jkk=0;this.sSe=!1;this.rKe=1E3;this.Mkk=3500;this.avd="ContextIQSignalId";this.VSe=0;this.X0g=!0;this.Sma=()=>{this.RAa.reset();this.C2m()};this.W_c=(Fb,vb)=>
{for(const $a of vb.Nj)Fb=$a.intent,8===Fb.type&&(0<=$a.ZIb?(Fb=Fb.Ib.paragraph,vb=this.Jn.qQd(Fb,8,$a.cpBegin,$a.cpEnd),1<=vb.count&&vb.J(0)&&(vb=Fb.characterData.indexOf("@",vb.J(0).begin),this.Jn.Mlg(Fb,$a.cpBegin,$a.cpEnd),vb=new l.a(8,vb,vb+1,G.a.create()),this.Jn.jRa(Fb,vb))):this.PAa.Pv(V.a.w$e,!0,void 0,void 0,void 0,void 0))};wa&&wa.execute(Fb=>this.Zka=Fb);this.PAa=new fa.a;this.w3g=new oa;this.getPersonImageUrl=this.getPersonImageUrl.bind(this);this.J3h(!0);this.l3h();this.Kd.O_e(this.W_c);
this.qWj.Bnb(this);this.wea=[new f.a(Va.a.Mdb,Va.a.Mdb)]}onSessionClose(){}onSessionConnect(){this.J3h(!1);this.l3h()}onSessionDisconnect(){}get mGb(){return this.wea}static eDk(va){return va.results&&0!==va.results.length?va.results[0].entityType===ba.EntityType.Topic:!1}static pCi(va){return Ia.a.qUc(va)?this.eDk(va)?!0:va.isStealth:!1}static MPd(va){var ia,pa;if(0!==(null===(ia=null===va||void 0===va?void 0:va.results)||void 0===ia?void 0:ia.length))return null===(pa=null===va||void 0===va?void 0:
va.results[0])||void 0===pa?void 0:pa.entityType}jQa(va,ia){return Ia.a.jQa(va,ia,aa.a.Leb)}y_a(va,ia){va=Ia.a.o7b(va,!1,aa.a.Leb);if(!va||!va.contains(ia))return null;ia=this.Se.Fga(ia);return la.Rqg()&&la.pCi(null===ia||void 0===ia?void 0:ia.content)?Va.a.kAd:Va.a.Mdb}Enb(va){la.cdd()&&!this.zv&&(this.zv=va,this.hBa.TMa((ia,pa)=>{ia=pa.paragraphNode;const sa=pa.Cia;for(const Ha of pa.contents)1!=Ha.qG&&0!=Ha.qG||Ia.a.Owf(Ha.element,ia,Ha.intents,this.yEc,this.IHa,this.BK,this.zv,sa,!1,aa.a.Leb)}))}l3h(){const va=
H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),ia=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQSatoriFlags",!1),pa=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAddressFlags",!1),sa=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQTopicFlags",!1),Ha=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQLoopFlags",
!1),ra=la.ddd()&&la.rCf?void 0:[Object.assign(new ba.CustomProp,{name:"Filter",value:'{"And":[{"Term":{"PeopleType":"Person"}},{"Term":{"PeopleSubtype":"OrganizationUser"}}]}'})],Ma=Object.assign(new U.a,{parentPath:["Signal",ba.ClientConfigSignal.getTypeName()],items:[Object.assign(new W.a,{id:"ClientConfigSignal",body:Object.assign(new ba.ClientConfigSignal,{timestamp:Date.now(),sessionConfig:Object.assign(new ba.SessionConfig,{clientConfig:Object.assign(new ba.ClientConfig,{ecc:Object.assign(new ba.EccConfig,
{enabled:la.edd()||la.ddd(),entities:[Object.assign(new ba.EccEntityConfig,{entityType:ba.EntityType.People,enabled:!0,queryPrefix:["@"],customProps:ra}),Object.assign(new ba.EccEntityConfig,{entityType:ba.EntityType.File,enabled:!0,queryPrefix:["@"]}),Object.assign(new ba.EccEntityConfig,{entityType:ba.EntityType.Loop,enabled:va,queryPrefix:["@"]})],bestMatch:Object.assign(new ba.BestMatchConfig,{enabled:la.Qqg()}),scopes:Object.assign(new ba.ScopeConfig,{enabled:!1})}),flag:Object.assign(new ba.FlagConfig,
{enabled:la.cdd(),entities:[Object.assign(new ba.EntityConfig,{entityType:ba.EntityType.Loop,enabled:va&&Ha}),Object.assign(new ba.EntityConfig,{entityType:ba.EntityType.Topic,enabled:sa}),Object.assign(new ba.EntityConfig,{entityType:ba.EntityType.Address,enabled:pa}),Object.assign(new ba.EntityConfig,{entityType:ba.EntityType.Satori,enabled:ia})]}),nudge:Object.assign(new ba.NudgeConfig,{enabled:!1}),prediction:Object.assign(new ba.PredictionConfig,{enabled:!1})})})})})]});this.jA.Mk().then(()=>
{this.xV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,{operation:Ma}));X.ULS.sendTraceTag(520104021,3034,50,"Submitted ClientConfigSignal Operation.")})}J3h(va){const ia=Object.assign(new U.a,{parentPath:["Signal",ba.StartupSignal.getTypeName()],items:[Object.assign(new W.a,{id:"SessionStartupSignal",body:Object.assign(new ba.StartupSignal,{timestamp:Date.now()})})]});this.jA.Mk().then(()=>{va&&this.UB();this.xV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,
{operation:ia}));X.ULS.sendTraceTag(521412674,3034,50,"Submitted StartupSignal Operation.")})}UB(){la.edd()&&(H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQUseEccResultAnnotation",!1)?(this.Se.nb(this,ba.EccResultAnnotation.getTypeName()),X.ULS.sendTraceTag(521412673,3034,50,"Registered for EccResultAnnotations.")):(this.Se.nb(this,ba.UserInitiatedResultAnnotation.getTypeName()),X.ULS.sendTraceTag(521412672,3034,50,"Registered for UserInitiatedResultAnnotations.")));
la.cdd()&&(this.Se.nb(this,ba.FlagResultAnnotation.getTypeName()),X.ULS.sendTraceTag(512361884,3034,50,"Registered for FlagResultAnnotations."))}OUo(va,ia,pa,sa,Ha){const ra=void 0===ia?!1:this.VSe>ia;this.Qi.VD&&!ra&&(va=this.p3h(va),sa&&va.suggestionGroups&&0<va.suggestionGroups.length&&(va.suggestionGroups[0].previewData=sa.substring(Ha+1,sa.length)),this.Qi.definition=va,ia&&(this.VSe=ia));ia?(sa=Date.now(),pa=[Object.assign(new na.a,{name:this.avd,string:pa}),Object.assign(new na.a,{name:"ContextIQMenuOpen",
bool:this.Qi.VD}),Object.assign(new na.a,{name:"ContextIQStaleAnnotation",bool:ra})],this.PAa.oYc("ContextIQUserInitUserPerceivedLatency",sa-ia,1,!0,void 0,pa)):X.ULS.sendTraceTag(537966025,3034,15,"SignalGenerationTime is undefined, can not determine if this annotation is stale or generate User Perceived Latency telemetry.")}p3h(va){if(va){var ia=[],pa=[];switch(va.annotationType){case ba.UserInitiatedResultAnnotation.getTypeName():var sa=va.content;if(!sa)return;for(var Ha of sa.results)ia=ia.concat(Ha.results);
sa=aa.a.UZa;break;case ba.EccResultAnnotation.getTypeName():Ha=va.content;if(!Ha)return;for(const ra of Ha.entityResults)ia=ia.concat(ra.entities);la.Qqg()&&(pa=null===(sa=Ha.treatments)||void 0===sa?void 0:sa.bestMatchEntries);sa=aa.a.UZa;break;case ba.FlagAnnotation.getTypeName():ia=ia.concat(va.content.results);sa=aa.a.Leb;break;default:return}va={annotationId:va.id,results:ia,bestMatchResults:pa};if(ia=this.X0g)this.X0g=!1;return{...z.g,id:sa,suggestionGroups:[{type:sa,isContentPending:!1,contentData:va,
isFirstInvoke:ia}]}}}async getPersonImageUrl(va,ia){va=new L.a(va,"O365",ia,va);if(this.Zka&&this.Zka.getPersonaIconPropertiesArray&&(va=await this.Zka.getPersonaIconPropertiesArray([va]),0<va.length&&va[0].authorImageURL))return va[0].authorImageURL}static vqe(){return la.edd()||la.cdd()}static edd(){return la.oqe&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAtMentionEntryPointIsEnabled",!1)}static ddd(){return la.oqe&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQConsumerAtMentionEntryPointIsEnabled",
!1)}static cdd(){return la.oqe&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQFlagsAreEnabled",!1)}static Rqg(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQStealthFlagsAreEnabled",!1)}static UNj(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CIQFlagsIgnoreOnce",!1)}static Qqg(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQBestMatchIsEnabled",
!1)}static oqe(){return!I.a.pca&&!I.a.e4}static get $6a(){return la.Lkk}pzo(va){if(this.Zka){var ia={...z.g,id:aa.a.UZa,suggestionGroups:[{type:aa.a.UZa,isContentPending:!0,contentData:{annotationId:"",results:[]}}]},pa=!1;this.ga.y_(V.a.uTa)&&(pa=!0);this.Qi.fja(va,ia,this,!0,!1,null,this.Sma,null,!1,sa=>{sa.shouldIgnoreFocusEvent=Ha=>{var ra;return this.sSe?!0:Ha===(null===(ra=this.fd.editingView)||void 0===ra?void 0:ra.editingElement)};sa.getPersonImageUrl=this.getPersonImageUrl},pa,!1,this.w3g)}else X.ULS.sendTraceTag(539068165,
3034,15,"PeopleAPI was not ready in time for showing a User Init Context IQ Card")}tFh(){this.Qi.dismiss()}onKeyDown(va){if(va&&va.Hb){switch(va.Hb.keyCode){case N.a.Oda:var ia=Na.bNj;break;case N.a.BL:ia=Na.End;break;case N.a.Fs:ia=Na.UOj;break;case N.a.O5:ia=Na.rPj;break;case N.a.Dw:ia=Na.Tab;break;case N.a.P5:ia=Na.cNj}void 0!==ia&&(va.Hb.stopPropagation(),va.Hb.preventDefault(),this.w3g.onKeyPressed(ia))}}EA(va,ia){if(va&&va.content&&ia===w.a.getTypeName()&&(va.annotationType===ba.UserInitiatedResultAnnotation.getTypeName()||
va.annotationType===ba.EccResultAnnotation.getTypeName())){var pa=ia=void 0,sa=void 0,Ha=0,ra=va.parentPath.split("\\");if(ra&&6===ra.length)if(pa=ra[5],ra=Date.now(),pa in la.$6a){clearTimeout(la.$6a[pa].gLo);ia=la.$6a[pa].startTime;sa=la.$6a[pa].Gzo;Ha=la.$6a[pa].uBd;delete la.$6a[pa];const Ma=[Object.assign(new na.a,{name:this.avd,string:pa})];this.PAa.oYc("ContextIQUserInitALLatency",ra-ia,1,!0,void 0,Ma)}else X.ULS.sendTraceTag(537962376,3034,15,"SignalId is not in the dictionary, can not generate AL Latency telemetry.");
else X.ULS.sendTraceTag(537966026,3034,15,"Annotation's parent path is not the expected length of 6. Can not generate AL Latency telemetry.");this.OUo(va,ia,pa,sa,Ha)}}get types(){return[aa.a.UZa,aa.a.Leb]}qmg(va,ia){this.Qi.VD&&this.Qi.qmg(va,ia)}get yEc(){return!Q.SessionStatusManager.instance.Gj&&1!=H.AFrameworkApplication.ta.mode}IHa(va){return va&&Ia.a.qUc(va)?!qa.a.g1b(va):!1}lN(va){if(la.vqe()){var ia,pa;if(Q.SessionStatusManager.instance.Gj||!this.yEc||!({annotation:ia,j1e:pa}=this.BK.VLd(va.ml,
va.cjf,this.IHa)).returnValue)return!1;if(ia.annotationType===ba.FlagAnnotation.getTypeName()){let sa=!1;this.ga.y_(V.a.uTa)&&(sa=!0);const Ha=this.p3h(ia);va=this.Qi.fja(pa,Ha,this,va.MQa,va.bOa,null,ra=>{(null===ra||void 0===ra?void 0:ra.cardType)===aa.a.Leb&&(null===ra||void 0===ra?0:ra.qLf)&&this.PAa.Pv(V.a.XFd,!0,void 0,void 0,void 0,void 0,{$hf:za.Tried,entityType:la.MPd(ia.content)})},null,!1,null,sa);this.Qi.lOb({qLf:!0,cardType:aa.a.Leb});va&&this.PAa.Pv(V.a.XFd,!0,void 0,void 0,void 0,void 0,
{$hf:za.Seen,entityType:la.MPd(ia.content)});return va}return!1}}CQo(va,ia){this.Se.fza(va,70);const pa=this.hC.p7h(va,0);if(pa){const sa=new a.a;sa.contentDescriptor=pa;sa.annotationType=va.annotationType;sa.state=70;this.KF.setState(ia,sa)}}executeAction(va,ia,pa,sa){var Ha,ra,Ma,ya=Date.now();if(!ia)return!1;var Ga=null===(Ha=this.Qi.definition)||void 0===Ha?void 0:Ha.id;switch(va.actionType){case z.b.Apply:this.Qi.lOb({cardType:Ga,qLf:!1});this.KUd(va.descriptorData,ia,pa,sa);Ga===aa.a.Leb&&(ia=
{$hf:za.Kept,entityType:la.MPd(null===(ra=this.Se.Fga(va.descriptorData.annotationId))||void 0===ra?void 0:ra.content)},this.PAa.Pv(V.a.XFd,!0,void 0,void 0,void 0,void 0,ia));this.tFh();break;case z.b.ClearSearch:this.sSe=!0;this.clearSearch(ia,pa,sa,!1);this.Qi.VD&&(this.Ksj(),Ga=k.ParagraphReader.text(ia).substring(0,pa+1),this.bnf(ia,Ga,pa,ya));this.sSe=!1;break;case z.b.Retry:this.Qi.VD&&(this.Ksj(),Ga=k.ParagraphReader.text(ia).substring(0,sa),this.bnf(ia,Ga,pa,ya));break;case z.b.OpenEditorPane:if(32!==
this.ga.processAction(V.a.uTa,2))return X.ULS.sendTraceTag(520898381,3034,15,"Failed to launch the editor pane from contextual card.",va.actionType),!1;break;case z.b.IgnoreOnce:if(!la.UNj)return!1;pa=this.Se.Fga(null===(Ma=va.descriptorData)||void 0===Ma?void 0:Ma.annotationId);this.CQo(pa,ia.Kc);ya=this.Ic.Oc(3);try{ya.Cb(ia),ia.gl(16,!0)}finally{ya&&ya.dispose()}this.PAa.Pv(V.a.XFd,!0,void 0,void 0,void 0,void 0,{$hf:za.Rejected,entityType:la.MPd(pa.content)});this.Qi.lOb({qLf:!1,cardType:Ga});
this.Qi.dismiss();break;default:return X.ULS.sendTraceTag(539849408,3034,15,"Failed to process action of type {0} since it is not known to us.",va.actionType),!1}return!0}bnf(va,ia,pa,sa){var Ha,ra;const Ma=pa.toString(),ya=va.id.toString(),Ga=ya+"-"+Ma;var wa=++this.Jkk;const hb=Ga+"-"+wa;wa=(wa=x.FormattingReader.JPd(va,pa,k.ParagraphReader.textLength(va)))?x.FormattingReader.language(wa):H.AFrameworkApplication.lcid;wa=null!==(ra=null===(Ha=M.a.sg(wa))||void 0===Ha?void 0:Ha.CNd)&&void 0!==ra?
ra:"";ia.length>this.rKe&&(pa-=ia.length-this.rKe,ia=ia.slice(-this.rKe));const eb=Object.assign(new U.a,{parentPath:["Signal",ja.a.getTypeName(),ya,Ma,Ga],items:[Object.assign(new W.a,{id:hb,body:Object.assign(new ja.a,{languageId:wa,startOfSentence:!0,text:ia,timestamp:Date.now(),userInitQuery:!0})})]});this.jA.Mk().then(()=>{this.xV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,{operation:eb}));X.ULS.sendTraceTag(521412643,3034,50,"Submitted Text Predictor Signal.");const jb=
[Object.assign(new na.a,{name:this.avd,string:hb})];this.PAa.oYc("ContextIQUserInitSignalGenerationLatency",Date.now()-sa,1,!0,void 0,jb)});"@"===ia.slice(-1)&&pa===ia.length-1&&(Ha=this.Jn.qQd(va,8,pa,pa))&&0===Ha.count&&(Ha=new l.a(8,pa,pa+1,G.a.create()),this.Jn.jRa(va,Ha));va=setTimeout(()=>{this.bxo(hb)},this.Mkk);la.$6a[hb]={startTime:sa,Gzo:ia,uBd:pa,gLo:va}}CXo(){if(this.Qi.VD&&this.Qi.definition&&this.Qi.definition.suggestionGroups&&this.Qi.definition.suggestionGroups[0]){const va=this.Qi.definition;
va.suggestionGroups[0].isContentPending=!0;this.Qi.definition=va}}Ksj(){this.Qi.definition={...z.g,id:aa.a.UZa,suggestionGroups:[{type:aa.a.UZa,isContentPending:!0,contentData:{annotationId:"",results:[]}}]}}bxo(va){if(va in la.$6a){var ia=la.$6a[va].startTime;ia=void 0===ia?!1:this.VSe>ia;!ia&&this.Qi.VD&&(this.Qi.definition={...z.g,id:aa.a.UZa,suggestionGroups:[{type:aa.a.UZa,isContentPending:!1,errorMessage:"No results received from AugLoop",contentData:{annotationId:"",results:[]}}]});va=[Object.assign(new na.a,
{name:this.avd,string:va}),Object.assign(new na.a,{name:"ContextIQMenuOpen",bool:this.Qi.VD}),Object.assign(new na.a,{name:"ContextIQStaleSignal",bool:ia})];this.PAa.oYc("ContextIQUserInitALTimeout",1,0,!0,void 0,va)}}KUd(va,ia,pa,sa){var Ha=va.type;switch(Ha){case ba.EntityType.File:this.insertHyperlink(ia,pa,sa,va.fileName,va.url+"?web=1");break;case ba.EntityType.People:la.rCf?this.insertHyperlink(ia,pa,sa,va.displayName,"mailto:"+va.primaryEmailAddress):this.gQo(va,ia,pa,sa);break;case ba.EntityType.Loop:this.MCm(va,
ia,pa,sa);break;case ba.EntityType.Address:this.NBm(va,ia,pa,sa);break;case ba.EntityType.Satori:Ha="https://www.bing.com/search?q="+va.title.replace(" ","+");this.insertHyperlink(ia,pa,sa,va.title,Ha);break;case ba.EntityType.Topic:this.insertHyperlink(ia,pa,sa,va.title,va.url);break;default:X.ULS.sendTraceTag(539849409,3034,15,"Failed to process entity of type {0} since it is not known to us.",Ha)}}gQo(va,ia,pa,sa){const Ha=va.primaryEmailAddress,ra=new L.a(Ha,"O365",va.displayName,Ha);this.Zka.checkUserAccess(ra).then(Ma=>
{Ma.UserCanWrite?(X.ULS.sendTraceTag(539100301,3034,50,"User has the correct permissions to be AtMentioned"),this.$Sc(ia,pa,sa,ra)):this.$Cj(ra,ia,pa,sa)},()=>{X.ULS.sendTraceTag(539100302,3034,15,"Got back failed response from checking user access for AtMentioned User");this.$Cj(ra,ia,pa,sa)})}$Cj(va,ia,pa,sa){this.Zka.grantUsersAccess([va]).then(Ha=>{let ra=!1;Ha.Details&&(ra=Ha.Details.Result[0].UserCanWrite);ra?(X.ULS.sendTraceTag(539100303,3034,50,"AtMentioned User has been granted access"),
this.$Sc(ia,pa,sa,va)):(X.ULS.sendTraceTag(539100304,3034,50,"AtMentioned user has been denied access"),this.clearSearch(ia,pa,sa,!0))},()=>{X.ULS.sendTraceTag(539100305,3034,15,"Failed Response from Attempt to grant access to AtMentioned user")})}$Sc(va,ia,pa,sa){this.Jn.Mlg(va,ia,pa);this.PAa.Pv(V.a.w$e,!0,void 0,void 0,void 0,void 0);this.tI.$Sc(va,ia,pa,sa.DisplayName,sa.Email)}insertHyperlink(va,ia,pa,sa,Ha){if(va){var ra=new y.GraphTransaction(15),Ma=sa+" ";try{ra.Cb(va);this.Jn.Mlg(va,ia,pa);
this.PAa.Pv(V.a.w$e,!0,void 0,void 0,void 0,void 0);this.Kd.replaceTextRange(n.a.createTextRange(va,ia,pa),Ma);const ya=J.a.a$b(Ha);this.sD.kG(n.a.createTextRange(va,ia,ia+sa.length),ya,!1,!1,!1);this.hb.setSelection(u.SelectionFactory.pe(va,ia+Ma.length))}finally{ra&&ra.dispose()}}else X.ULS.sendTraceTag(509612897,3034,15,"Paragraph node is undefined/null.")}MCm(va,ia,pa,sa){if(ia){var Ha=new y.GraphTransaction(15);try{Ha.Cb(ia);this.Kd.replaceTextRange(n.a.createTextRange(ia,pa,sa),"");this.hb.setSelection(u.SelectionFactory.pe(ia,
pa));const ra=va.id;ra===aa.a.H9m?this.ga.processAction(V.a.fTc,2):ra===aa.a.E9m?this.ga.processAction(V.a.TSc,2):ra===aa.a.G9m?this.ga.processAction(V.a.gXd,2):X.ULS.sendTraceTag(537458136,3034,15,"Trying to insert unsupported loop type.")}finally{Ha&&Ha.dispose()}}else X.ULS.sendTraceTag(537458135,3034,15,"Paragraph node is undefined/null.")}NBm(va,ia,pa,sa){if(ia){var Ha=new y.GraphTransaction(15);try{Ha.Cb(ia);const ra=J.a.a$b(va.url);this.sD.kG(n.a.createTextRange(ia,pa,sa),ra,!1,!1,!1);this.hb.setSelection(u.SelectionFactory.pe(ia,
sa));const Ma=this.Se.Fga(va.annotationId);this.Se.fza(Ma,60)}finally{Ha&&Ha.dispose()}}else X.ULS.sendTraceTag(509434014,3034,15,"Paragraph node is undefined/null.")}clearSearch(va,ia,pa,sa){if(va){var Ha=new y.GraphTransaction(15);sa||(ia+=1);try{Ha.Cb(va),this.Kd.replaceTextRange(n.a.createTextRange(va,ia,pa),""),this.hb.setSelection(u.SelectionFactory.pe(va,ia))}finally{Ha&&Ha.dispose()}}else X.ULS.sendTraceTag(529413333,3034,15,"Paragraph node is undefined/null.")}C2m(){this.DI.execute(va=>{va.logActivity("CIQ_AtInvoke",
null)})}}la.rCf=!1;la.Lkk={};Object(F.a)(la,"ContextIQIntentProvider",E.a,[359,486])},1662:function(F,K,c){F=c(0);var l=c(331),f=c(270);class a{constructor(x,y,n,u,z,w,E){this.pl=x;this.focusManager=y;this.bF=n;this.clickInputManager=u;this.uic=z;this.D0i=w;this.cQh=E;this.MQ=this.vBb();this.bF.Jaa(this.MQ.name);this.clickInputManager.u0b(this.MQ.name,this.pl,this.MQ.sUa);x=this.Laf();this.focusManager.kAb(this.pl,this.MQ,x)}focus(){this.focusManager.mg(this.MQ.name)}get isFocused(){return this.focusManager.currentScope===
this.MQ}addIsFocusChangedHandler(x){this.MQ.m7(()=>x(!0));this.MQ.aZa(()=>x(!1))}Noh(x){this.MQ.ZYa(x)}dispose(){var x;this.focusManager.N5a(this.MQ.name);this.focusManager.currentScope||this.focusManager.mg(null!==(x=this.cQh)&&void 0!==x?x:f.a.Pn)}vBb(){var x;const y=this.focusManager.fe(this.uic);y.parent=null!==(x=this.D0i)&&void 0!==x?x:f.a.rp;y.sUa=!0;y.J5c=!0;y.RH=!0;return y}Laf(){const x=new l.DOMFocusListing(()=>this.pl);x.Wm(8);return x}}Object(F.a)(a,"EditorAiFocusScopeImpl",null,[]);
c.d(K,"a",function(){return k});class k{constructor(x,y,n,u){this.options=x;this.focusManager=y;this.bF=n;this.clickInputManager=u}registerScope(x){return new a(x,this.focusManager,this.bF,this.clickInputManager,this.options.uic,this.options.D0i,this.options.cQh)}}Object(F.a)(k,"EditorAiFocusManagerImpl",null,[])},1672:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.handler=null}}Object(F.a)(l,"SetAnnotationResultCallbackParameters",null,[])},1674:function(F,K,c){c.d(K,
"a",function(){return l});F=c(0);class l{static get Ofc(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}l.FDb="fontInfoTaskPane";l.experienceId="modernfontpicker";Object(F.a)(l,"FontInfoPaneConstants",null,[])},1675:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.endDate=this.startDate=null}}Object(F.a)(l,"CommentTaskSchedule",null,[])},1676:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);var l=c(80);class f{static get hd(){return null!=f.yyg?
f.yyg:f.yyg=new l.a}static hyk(a){f.hd.addHandler(f.jUi,a)}static Nyk(a){f.hd.addHandler(f.IWi,a)}}f.jUi="OnCopyComment";f.IWi="OnPasteComment";Object(F.a)(f,"CommentEventsManager",null,[])},1677:function(F,K,c){c.d(K,"a",function(){return l});const l={Tjf:"TasksFeatureUsage",KIo:"TaskExperienceDegraded",Cle:"TaskCreate",Dle:"TaskEngagement"}},1680:function(F,K,c){c.d(K,"c",function(){return x});c.d(K,"b",function(){return y});c.d(K,"a",function(){return n});var l=c(74),f=c(7),a=c(2),k=c(35);const x=
u=>{if(!u)return null;let z;try{z=k.b(u)}catch(w){z=null,f.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",w)}return z},y=(u,z)=>{let w=[];if(u.breadcrumbs&&0<u.breadcrumbs.length)w=u.breadcrumbs;else{const E=u.service_info;E&&E.friendly_service_name&&Array.add(w,E.friendly_service_name);u.display_path&&Array.addRange(w,u.display_path)}return w.join(z?" \u00ab ":" \u200f\u00bb ")},n=(u,z=!1)=>{if(!u)return[];if(!u.documents)return f.ULS.sendTraceTag(578352838,
202,15,"missing documents object"),[];if(!u.documents.items)return f.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];u=u.documents.items;const w=new l.a;for(let G=0;G<u.length;G++){const H=u[G];var E=H.web_url;if(!E){f.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!H.url){f.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}E=String.format("{0}?web=1",H.url)}const L={};L.DocumentUrl=E;L.MruId=H.mru_id;{E=H;let I=E.title;I?(E.extension&&(I=String.format("{0}.{1}",I,E.extension)),
E=I):(f.ULS.sendTraceTag(578352837,202,15,"empty file title"),E="")}L.FileName=E;L.IsPinned=H.is_pinned;L.Path=y(H,a.AFrameworkApplication.isRtl);z&&(L.App=H.app,L.TimeStamp=H.time_stamp);w.add(L)}return w.toArray()}},1681:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}l.Callback="action";Object(F.a)(l,"MenuLauncherAsyncTriggerCommandProperties",null,[])},1682:function(F,K,c){var l=this&&this.gC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,
get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1835),K);f(c(1836),K);f(c(1837),K);f(c(1838),K);f(c(1839),K);f(c(1840),K)},1683:function(F,K,c){var l=this&&this.gC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.Oz:n.writable||
n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1841),K);f(c(1842),K)},1684:function(F,K,c){var l=this&&this.gC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.Oz:n.writable||
n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1843),K);f(c(1844),K)},1686:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(F.a)(l,"CalloutButtonProps",
null,[])},1687:function(F,K,c){function l(){a||(f.Health.instance.addQosPillar("AsyncCollab"),a=!0)}c.d(K,"a",function(){return l});var f=c(83);let a=!1},1688:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a=0,k=!1){this.uJj=!1;this.paragraphNode=f;this.dRf=a;this.uJj=k}}Object(F.a)(l,"ReviewActionArgs",null,[])},1692:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f=0,a=0,k=0,x=0,y="",n="",u="",z="",w="0pt",E="0pt",G="0pt",H="0pt"){this.borderTopStyle=
f;this.borderRightStyle=a;this.borderBottomStyle=k;this.borderLeftStyle=x;this.borderTopColor=y;this.borderRightColor=n;this.borderBottomColor=u;this.borderLeftColor=z;this.borderTopWidth=w;this.borderRightWidth=E;this.borderBottomWidth=G;this.borderLeftWidth=H}}Object(F.a)(l,"TableCellBorderProperties",null,[])},1693:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f="",a="",k="",x=""){this.bVk=f;this.aVk=a;this.ZUk=k;this.$Uk=x}}Object(F.a)(l,"TableCellMarginProperties",
null,[])},1697:function(F,K,c){c.d(K,"a",function(){return a});F=c(0);var l=c(43);c(6);var f=c(7);class a{constructor(k,x){this.d8m=()=>{f.ULS.sendTraceTag(39358976,324,50,"ForceSave request was successful in AutoSaveParamsUpdateService.")};this.cxa=(y,n)=>{f.ULS.sendTraceTag(39358977,324,10,"ForceSave request failed in AutoSaveParamsUpdateService with status code {0}.",n)};this.Ftb=x}Fjj(k,x,y,n=null,u=null,z=null){if(k){var w=new l.GraphTransaction(0);w.Cb(k);k.setValue(x,y);w.dispose();try{this.Ftb(15,
!1,n||this.d8m,u||this.cxa,z,null,null)}catch(E){f.ULS.sendTraceTag(39358947,324,10,"Error calling ForceSave in TableOfContentsActor.SendSaveRequest. Message: {0}",E.message)}}else f.ULS.sendTraceTag(39358946,324,10,"AutoSaveParametersNode is null in AutoSaveParamsUpdateService.")}}Object(F.a)(a,"AutoSaveParamsUpdateService",null,[580])},1698:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);var l=c(7);class f{constructor(a){this.Czj=a}ie(a,k){if(a){var x=this.Czj();a();a=this.Czj();l.ULS.sendTraceTag(555307094,
345,50,`${k}-${a-x}`)}else l.ULS.shipAssertTag(520127454,345,!1)}}Object(F.a)(f,"PerfLogger",null,[709])},1699:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a){this.paragraphNode=f;this.state=a}}Object(F.a)(l,"ReviewCompletedArgs",null,[])},1700:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a){this.index=f;this.count=a}}Object(F.a)(l,"DesignerReviewPosition",null,[])},1701:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);var l;(function(a){a[a.empty=
0]="empty";a[a.filled=1]="filled"})(l||(l={}));Object(F.b)("BlueDotHighlightContextType",l);class f{constructor(a,k,x=WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionTooltipClick,y=l.empty){this.Yr=a;this.sFc=k;this.oMo=x;this.FLk=y}}Object(F.a)(f,"BlueDotHighlightContext",null,[])},1702:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.qv=this.Ao=this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0;this.Hwa=!1;this.kLb=this.GJb=5;this.sma=this.UE=
this.gHc=0;this.r1k=!1}}Object(F.a)(l,"SectionPropertiesData",null,[])},1703:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(190);class l extends c.a{constructor(){super();this.OnRetryCommandId=this.RetryButtonTitle=this.AriaDescription=this.IconName=this.Label=null}get ControlType(){return 12}}Object(F.a)(l,"ErrorViewProps",c.a,[])},1704:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(190);class l extends c.a{constructor(){super();this.CommandValueId=this.ActionCommandValueId=
this.ActionText=this.ActionId=this.Details=this.Links=this.Description=this.SecondaryLabel=this.Label=this.iconSet=this.ActionCommandId=this.CommandId=null}get ControlType(){return 13}}Object(F.a)(l,"MultiActionButtonProps",c.a,[])},1705:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}Object(F.a)(l,"PersonaInfo",null,[])},1706:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}Object(F.a)(l,"PersonaIdentifiers",null,[])},1707:function(F,K,c){c.d(K,"a",function(){return l});
F=c(0);K=c(1133);c=c(1064);class l{}l.K0=[new K.a(1440,1440,1440,1440),new K.a(720,720,720,720),new K.a(1440,1440,1080,1080),new K.a(1440,1440,2880,2880),new K.a(1440,1440,1800,1800)];l.Ppa=[new c.a(12240,15840),new c.a(12240,20160),new c.a(10440,15120),new c.a(11907,16839),new c.a(8391,11907)];Object(F.a)(l,"PredefinedPageProperties",null,[])},1709:function(F,K,c){c.d(K,"a",function(){return G});F=c(0);var l=c(200),f=c(2),a=c(22),k=c(20),x=c(18),y=c(1324),n=c(250),u=c(437),z=c(7),w=c(453),E=c(677);
class G{constructor(H,L,I,N,Q,M,J,V,X,W,U,Y,ba,aa){this.mr=H;this.oub=L;this.Fa=I;this.Kp=N;this.Gr=Q;this.mE=M;this.yaa=J;this.e$a=V;this.a$a=X;this.c$a=W;this.d$a=U;this.Z$a=Y;this.$$a=ba;this.pnd=aa}build(H,L,I,N){const Q=new l.QueryStringBuilder("WordOart.ashx");f.AFrameworkApplication.nfa(Q);Q.ze(w.a.nodeId,L.id.toString());L=x.ImageReader.l9l(L,H.Kc);Q.ze(E.a.ZHd,L?L.ia(u.a.iSf,""):"");Q.ze(E.a.width,this.Kp.toString());Q.ze(E.a.height,this.Gr.toString());Q.ze(E.a.N1c,this.yaa.toString());Q.ze(E.a.e4n,
y.a[this.oub]);L=this.Fa.$("WordEditorImageCropIsEnabled");Q.ze(E.a.hOh,L.toString());L&&(Q.ze(E.a.top,this.e$a.toString()),Q.ze(E.a.bottom,this.a$a.toString()),Q.ze(E.a.left,this.c$a.toString()),Q.ze(E.a.right,this.d$a.toString()));L=this.Fa.$("WordEditorImageRotateIsEnabled");Q.ze(E.a.egj,L.toString());L&&(Q.ze(E.a.angle,this.mE.toString()),Q.ze(E.a.flipH,this.Z$a?"true":"false"),Q.ze(E.a.flipV,this.$$a?"true":"false"));Q.ze(E.a.DZf,I?"true":"false");Q.ze(E.a.strict,this.pnd?"true":"false");this.Fa.$("WacWordEditorRenderHighContrastGraphicsIsEnabled")&&
this.mr&&this.mr.jyf&&Q.ze(E.a.Y1a,this.mr.jyf);(H=H.Vi())?(Q.ze(w.a.fileId,H.vr),Q.ze(w.a.cellId,H.nm.toString())):z.ULS.sendTraceTag(575522528,322,10,"parentGraphSpace is null. Cannot set FileId and CellId. url: {0}",Q.toString());H=a.a.instance.Na("Box4.IFeatureHelper");H=!!H&&H.isFeatureEnabled(49);Q.ze(E.a.Ksl,"true");Q.ze(E.a.uBm,H.toString());Q.ze(E.a.KVh,"true");H&&Q.ze(E.a.d2i,H.toString());Q.ze(E.a.xBm,"true");n.a.instance.pzb(Q);I&&N&&!k.a.Gt&&Q.JI(E.a.Oeb,window.self.devicePixelRatio.toString());
Q.ze(E.a.xwh,"true");return Q.toString()}}Object(F.a)(G,"WordOartEndpointUrlBuilder",null,[])},1710:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);var l=c(16);class f{constructor(a,k){this._id=a;this.Fb=k;this.cRk=k.ia(l.a.Eha,0);this.aRk=k.ia(l.a.Dha,0)}getId(){return this._id}}Object(F.a)(f,"GraphicsEditorImageContainer",null,[400])},1711:function(F,K,c){c.d(K,"a",function(){return J});F=c(0);var l=c(58),f=c(2),a=c(124),k=c(200),x=c(18),y=c(514),n=c(718),u=c(6),z=c(153),w=c(42),E=c(16),
G=c(41),H=c(437),L=c(118),I=c(990),N=c(7),Q=c(677),M=c(1709);class J{constructor(V,X,W,U,Y,ba){this.properties=null;this.mr=X;this.Uj=U;this.Fa=Y;this.dA=ba}TWo(V,X,W){V.GX||(X.setValue(u.a.AAd,V.GCk),X.setValue(u.a.ALd,V.r6b));this.pMj(V,X,W)}UWo(V,X,W){X.setValue(u.a.CLb,V.m0o);x.ImageReader.hRd(X,W.Kc,!1)!==V.iXf&&X.Eg(u.a.C$d,z.a.hu,z.a.zpa,w.a.u8a);if(V.q9d)X.setValue(E.a.Tca,l.a.Ef(V.q9d));else{var U=this.FLh(V.iXf,V.jXf,V.extension);W.Kc.Pu(U);X.setValue(E.a.Tca,U.id)}V.xpe?X.setValue(w.a.u8a,
l.a.Ef(V.xpe)):V.YKj&&(U=this.FLh(V.YKj,V.ppg,V.extension),W.Kc.Pu(U),X.setValue(w.a.u8a,U.id));X.ia(u.a.D$d,"")!==V.p4c&&(""!==V.p4c?X.setValue(u.a.D$d,V.p4c):X.removeProperty(u.a.D$d));0===V.Kua&&0===V.Mua&&0===V.Lua&&0===V.Jua||this.Uj.cbg(X,V.Mua,V.Jua,V.Kua,V.Lua);void 0!==V.lockAspectRatio?X.setValue(u.a.UX,V.lockAspectRatio):X.setValue(u.a.UX,!1);V.lMk&&(this.wOb(X,u.a.pia,V.Oxh),this.wOb(X,u.a.Kpa,V.borderStyle),this.wOb(X,u.a.LGa,V.borderColor));void 0!==V.altTextDescription&&X.setValue(u.a.RX,
V.altTextDescription);this.wOb(X,G.a.alphaModFix,V.alphaModFix);this.pMj(V,X,W);V=y.a.instance.Vif(X);X.setValue(u.a.Uca,V)}FLh(V,X,W){const U=new I.a(524345);U.setValue(H.a.iSf,V);U.setValue(H.a.Efc,V);U.setValue(w.a.TBl,l.a.Ef(V).guid);U.setValue(u.a.Lpi,X);U.setValue(H.a.fkf,f.AFrameworkApplication.rootQuerySignature);U.setValue(w.a.PZh,W);return U}pMj(V,X,W){V.GX?(this.properties=X,X.setValue(G.a.GX,V.GX),V.sEc&&X.setValue(G.a.zAd,V.sEc),X.setValue(G.a.Xva,V.V4o),X.setValue(G.a.Yva,V.atm),X.setValue(G.a.tPa,
V.K5b),X.setValue(u.a.jt,V.jt),X.setValue(u.a.GCb,V.z5b),X.setValue(w.a.R_,0),this.Fa&&this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&X.setValue(L.a.GOa,!1),X.setValue(L.a.b5,0),this.wOb(X,G.a.L2a,V.Xwa),this.aoh(X,W,!1,!0),this.gYk(X)):(X.setValue(u.a.WEa,V.WEa),X.setValue(z.a.hu,V.WEa?V.oEn:""),V.Oeb&&X.setValue(z.a.yGb,V.Oeb),X.setValue(u.a.jt,V.jt),X.setValue(u.a.GCb,V.z5b),X.setValue(u.a.Uca,V.CH),X.setValue(E.a.Eha,a.a.rG(V.width)),X.setValue(E.a.Dha,
a.a.rG(V.height)),X.setValue(w.a.tZf,a.a.rG(V.width)),X.setValue(w.a.rZf,a.a.rG(V.height)),X.setValue(z.a.UEa,-1),X.setValue(z.a.TEa,-1),X.setValue(E.a.Jwa,!0),X.setValue(u.a.sJ,V.rotationAngle),this.Fa&&this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&X.setValue(L.a.GOa,!1),X.setValue(w.a.R_,0),V.WEa&&this.aoh(X,W,!0,!1),this.hYk(X));5!=x.ImageReader.Ui(X)?this.jYk(X):this.fYk(X);this.wOb(X,u.a.YQc,V.flipH);this.wOb(X,u.a.kRc,V.flipV)}L4n(V,X,W,
U,Y=null){V=this.Uj.G4n(V.gk,X,W,U);null==V?N.ULS.sendTraceTag(561538391,3001,10,"Failed to replace picture properties"):Y&&Y(V)}aoh(V,X,W,U){let Y=!1;var ba=this.dA.Ys(X);ba&&ba.Gf(u.a.DGf)&&(Y=!0);ba=x.ImageReader.Hba(V);X=(new M.a(this.mr,x.ImageReader.Ui(V),this.Fa,x.ImageReader.fF(V),x.ImageReader.yG(V),x.ImageReader.D_(V),x.ImageReader.dib(V),Math.max(ba.top,0),Math.max(ba.bottom,0),Math.max(ba.left,0),Math.max(ba.right,0),x.ImageReader.fQd(V),x.ImageReader.CEb(V),Y)).build(X,V,!0,!1);U&&(U=
new k.QueryStringBuilder(X),U.ze(Q.a.pWd,"true"),X=U.toString());V.setValue(u.a.bgb,X);W&&n.a.xOb(V,1,f.AFrameworkApplication.K,this.mr)}wOb(V,X,W){void 0===W||null===W?V.removeProperty(X):V.setValue(X,W)}hYk(V){V.removeProperty(G.a.GX);V.removeProperty(G.a.zAd);V.removeProperty(G.a.Xva);V.removeProperty(G.a.Yva);V.removeProperty(G.a.tPa);V.removeProperty(G.a.m6d);V.removeProperty(G.a.jrl);V.removeProperty(G.a.L2a)}jYk(V){V.removeProperty(u.a.C$d);V.removeProperty(u.a.CLb);V.removeProperty(E.a.Tca);
V.removeProperty(u.a.D$d)}fYk(V){V.removeProperty(u.a.ALd);V.removeProperty(u.a.AAd);V.removeProperty(G.a.GX);V.removeProperty(G.a.zAd)}gYk(V){V.removeProperty(u.a.AAd);V.removeProperty(z.a.hu);V.removeProperty(E.a.Eha);V.removeProperty(E.a.Dha);V.removeProperty(u.a.Uca);V.removeProperty(z.a.zpa);V.removeProperty(u.a.ALd);V.removeProperty(u.a.sJ)}}Object(F.a)(J,"GraphicsEditorImageEditor",null,[387])},1712:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}Object(F.a)(l,"SmartLookupApplicationInterface",
null,[])},1713:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a,k,x,y,n){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=f;this.url=a;this.spWebUrl=k;this.uniqueId=x;this.size=y;this.lastModified=n}}Object(F.a)(l,"FileInfo",null,[])},1720:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);K=c(229);var l=c(105);class f extends K.a{constructor(){super();this.CellId=this.FileId=null}fl(){return 37}static construct(a){const k=
new f;k.FileId=a.Vi().vr;k.CellId=l.a(a.Kc.id);return k}}Object(F.a)(f,"LastSavedRevisionRequest",K.a,[])},1740:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);var l=c(7);c=c(254);class f extends c.a{constructor(a,k,x,y){super(f.S3e);this.Hn=a;this.$i=k;this.view=x;this.options=y}initialize(){super.initialize();const a=this.options.QNb==this.$i.$la(this.view.Yc,{UO:this.options.UO,$ba:this.options.u$b,hoa:this.options.t$b,TO:this.options.TO});a&&!this.Loa&&l.ULS.sendTraceTag(557114691,3028,
50,this.sT(this.Hn,!0,`satisfiedIfBlank=${this.options.QNb}`));this.Sg(a)}Nd(){super.Nd()}}f.S3e="BlankDocumentConditionId";Object(F.a)(f,"BlankDocumentCondition",c.a,[])},1744:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f){this.alt=this.ariaLabel=this.src=null;this.src=f}}Object(F.a)(l,"ImageProps",null,[])},1746:function(F,K,c){c.d(K,"a",function(){return w});F=c(0);var l=c(58),f=c(8),a=c(12),k=c(7),x=c(15),y=c(1540),n=c(1524),u=c(1535),z=c(1528);class w{constructor(E,
G,H,L,I,N,Q){this.vUi=(M,J)=>{J&&J.data&&J.data.ml&&(M=new z.a(J.data.ml,1,!0),this.pye.lN(M))};this.yXi=(M,J)=>{J&&J.data&&J.data.ml&&J.data.ml.node&&this.s1j.FQi(this.pye,J.data.ml.node)};this.Yhc=(M,J,V)=>{M=J.view.te?J.view:null;if(!M||!M.lb)return 8;M=M.lb.gb.J(0).Oa;return f.ParagraphReader.Wb(M.node)?1===V?32:2===V?(V=new z.a(M,2,!1),this.pye.lN(V),32):2:2};this.k4b=(M,J,V)=>{var X,W;M=J.view.te?J.view:null;if(!M||!M.lb)return 8;M=null===(X=M.lb.gb.J(0))||void 0===X?void 0:X.Oa;return M&&M.node?
f.ParagraphReader.Wb(M.node)?1===V?32:2===V?(V=M.node,X=f.ParagraphReader.text(M.node),J=M.cpBegin,M=M.cpEnd-J,0<M&&(X=X.substr(J,M)),M=Math.floor(Math.random()*w.Pgj),J=l.a.create(),k.ULS.sendTraceTag(541446531,3016,50,"Create Pull Quote invoked from context menu. PullQuote info: {0}; Document info: {1}",{["suggestionId"]:J,["textLength"]:X.length,["paragraphLength"]:f.ParagraphReader.textLength(V),["paragraphRole"]:null===(W=this.Y6.BA(V))||void 0===W?void 0:W.role,["styleId"]:M},this.dbk.lQd()),
W=[new y.c(new n.d(J,3,null,null,!1,M,X),V,M,X,U=>{this.nUb.I3c(u.a.create(U));this.nUb.chc({role:27,paragraphNode:U,placeholder:!1})},3)],this.Qgk.bBd(W),32):2:2:8};this.ga=E;this.pye=G;this.s1j=H;this.nUb=L;this.Qgk=I;this.Y6=N;this.dbk=Q}initialize(){this.ga.eb(x.a.Yhc,a.a.view,this.Yhc,1028);this.nUb.hzk(this.yXi);this.nUb.dyk(this.vUi);this.ga.eb(x.a.k4b,a.a.view,this.k4b,4)}dispose(){this.ga.Sv(x.a.k4b,a.a.view,this.k4b);this.nUb.f2n(this.vUi);this.nUb.A2n(this.yXi);this.ga.Sv(x.a.Yhc,a.a.view,
this.Yhc)}}w.Pgj=5;Object(F.a)(w,"DesignerActionListener",null,[1098,10])},1748:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}l.seen="Seen";l.kept="Kept";l.rejected="Rejected";Object(F.a)(l,"CritiqueAction",null,[])},1757:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.uRj="PageContentOrigin";this.QOj=500;this.Pvg=["resize"];this.GKo=f=>()=>{!this.nkd&&f&&(this.nkd=setTimeout(()=>this.wEh(),this.QOj),f())}}addHandler(f){this.$Mb();this.GKa=this.GKo(f);
this.$wn(this.GKa);this.Pvg.forEach(a=>{window.addEventListener(a,this.GKa)})}$Mb(){var f;this.wEh();null===(f=this.nmh)||void 0===f?void 0:f.disconnect();this.Pvg.forEach(a=>{window.removeEventListener(a,this.GKa)});this.GKa=void 0}wEh(){this.nkd&&(clearTimeout(this.nkd),this.nkd=void 0)}$wn(f){this.nmh=new MutationObserver(f);(f=document.getElementsByClassName(this.uRj)[0])&&this.nmh.observe(f,{attributes:!0,attributeFilter:["style"]})}}Object(F.a)(l,"EditorAiWindowEventManager",null,[])},1758:function(F,
K,c){c.d(K,"a",function(){return a});F=c(0);var l=c(38),f=c(11);class a{constructor(k){var x,y;this.xo=k;this.JR=null;this.JR=null===(y=null===(x=this.xo)||void 0===x?void 0:x.Bd)||void 0===y?void 0:y.container}addHandler(k){this.JR&&(this.$Mb(),this.GKa=k,l.a.addHandler(this.JR,f.a.scroll,this.GKa),l.a.addHandler(this.JR,f.a.resize,this.GKa))}$Mb(){this.JR&&this.GKa&&(l.a.removeHandler(this.JR,f.a.scroll,this.GKa),l.a.removeHandler(this.JR,f.a.resize,this.GKa))}}Object(F.a)(a,"EditorAiPositionManager",
null,[])},1759:function(F,K,c){var l=this&&this.gC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.Oz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1949),
K);f(c(1950),K);f(c(1951),K);f(c(1952),K);f(c(1953),K);f(c(1954),K)},1761:function(F,K,c){var l=c(0),f=c(1822),a=c(364),k=c(598),x=c(58),y=c(22),n=c(2036),u=c(2),z=c(108),w=c(90),E=c(1615),G=c(181);class H{constructor(fc,yc){this.CommentId=fc;this.ResolveState=yc}}Object(l.a)(H,"CommentProperties",null,[]);var L=c(573),I=c(2038),N=c(2039),Q=c(1659),M=c(189),J=c(1820);class V extends J.a{constructor(fc,yc="",Uc="",zd="",ie=!1){super(fc,yc,Uc,zd,ie);this.DateUtc=null}}Object(l.a)(V,"CommentReactionUser",
J.a,[]);var X;(function(fc){fc[fc.like=1]="like"})(X||(X={}));Object(l.b)("ReactionType",X);var W;(function(fc){fc[fc.first=0]="first";fc[fc.done=0]="done";fc[fc.undone=1]="undone";fc[fc.addComment=2]="addComment";fc[fc.deleteComment=3]="deleteComment";fc[fc.editComment=4]="editComment";fc[fc.addReaction=5]="addReaction";fc[fc.removeReaction=6]="removeReaction";fc[fc.last=7]="last"})(W||(W={}));Object(l.b)("CommentChangeType",W);var U=c(237),Y=c(1455),ba=c(242);class aa{constructor(){this.Efh=this.Uhh=
!1;this.Knk=[]}get gmc(){return this.Knk}get FPb(){return this.Uhh}set FPb(fc){this.Uhh=fc;for(const yc of this.gmc)yc.FPb=fc}get sOb(){return this.Efh}set sOb(fc){this.Efh=fc;for(const yc of this.gmc)yc.sOb=fc}K7a(fc){for(const yc of this.gmc)fc=yc.K7a(fc);return fc}}Object(l.a)(aa,"AggregateCommentTaskPersonTransformer",null,[923]);var fa=c(7),na=c(140),oa=c(1612);class ja{constructor(fc,yc){this.aak=new ba.a(()=>yc.K7a(fc.value))}xUl(){return new Date}q_a(fc,yc,Uc){if(0===fc)throw fa.ULS.sendTraceTag(594650201,
327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");const zd=na.a.create().toString();Uc=new oa.a(fc,this.aak.value,Uc,zd,!1);Uc.commentId=yc;fa.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",fc);return Uc}}Object(l.a)(ja,"HistoryRecordFactory",null,[925]);var qa=c(1675);class Ia{constructor(fc,yc,Uc,zd,ie,Oe){this.isLossy=fc;this.title=yc;this.assignees=Uc;this.schedule=
zd;this.completion=ie;this.priority=Oe}}Object(l.a)(Ia,"CommentTaskState",null,[]);class Va{constructor(){this.commentId=null}}Object(l.a)(Va,"HistoryItem",null,[]);class Na{constructor(fc,yc,Uc,zd,ie,Oe,Ge){this.wFe=!1;if(1!==yc.type)throw Error.argument("createRecord");this.Erc=Uc;this.Brc=zd;this.Crc=ie;this.c8g=1;this.$kd=fc;this.cck=Oe;this._state=new Ia(!1,this.Erc,Ge,new qa.a,this.Crc,this.Brc);this._history=[];this.xMh(yc)}n4b(fc,yc){if(1!==fc.type)throw Error.argument("createRecordTemplate");
const Uc=Na.hfm(fc,this.c8g);this.c8g++;return Object.assign(new oa.a(yc,fc.user,fc.time,Uc),{commentId:fc.commentId})}get fFi(){return this.history[this.history.length-1]}get Pmi(){return this.state.completion===this.Crc}get Omi(){return this.state.priority===this.Brc}get Qmi(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get Rmi(){return this.state.title===this.Erc}xMh(fc){fc=Object.assign(new Va,
{commentId:fc.commentId,records:[fc]});this.history.push(fc)}S4h(fc){let yc=-1;for(let Uc=0;Uc<this.state.assignees.length;Uc++)if(this.$kd.equals(this.state.assignees[Uc],fc)){yc=Uc;break}return yc}Qro(fc){const yc=this.fFi,Uc=yc.records[yc.records.length-1];return this.$kd.equals(Uc.user,fc.user)&&yc.commentId===fc.commentId&&Uc.time.getTime()===fc.time.getTime()?!0:!1}e0o(fc){switch(fc.type){case 2:-1===this.S4h(fc.assignee)&&this.state.assignees.push(fc.assignee);break;case 3:const yc=this.S4h(fc.assignee);
0<=yc&&this.state.assignees.splice(yc,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=fc.schedule;break;case 6:this.state.completion=fc.completion;break;case 9:this.state.title=fc.title;break;case 10:this.state.priority=fc.priority;break;case 0:this.state.isLossy=!0;break;case 1:fa.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.wFe=!0;break;case 8:this.wFe=!1;break;case -1:fa.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");
break;default:this.state.isLossy=!0}fc.isLossy&&(this.state.isLossy=!0);this.Qro(fc)?this.fFi.records.push(fc):this.xMh(fc)}get isDeleted(){return this.wFe}get state(){return this._state}get history(){return this._history}j_l(fc){if(!fc)return this.history;const yc=Array.clone(this.history),Uc=yc[0],zd=Uc.records.shift();if(!this.cck){var ie=this.n4b(zd,4);Uc.records.unshift(ie)}!fc.Pmi&&this.Pmi&&(ie=this.n4b(zd,6),ie.completion=this.Crc,Uc.records.unshift(ie));!fc.Omi&&this.Omi&&(ie=this.n4b(zd,
10),ie.priority=this.Brc,Uc.records.unshift(ie));!fc.Qmi&&this.Qmi&&(ie=this.n4b(zd,5),ie.schedule=new qa.a,Uc.records.unshift(ie));!fc.Rmi&&this.Rmi&&(ie=this.n4b(zd,9),ie.title=this.Erc,Uc.records.unshift(ie));fc.isDeleted&&(fc=this.n4b(zd,8),Uc.records.unshift(fc));return yc}static hfm(fc,yc){return"Synthesized-"+fc.recordId+"-"+yc}}Object(l.a)(Na,"CommentTaskStateBuilder",null,[]);class za{constructor(fc,yc,Uc,zd){this.id=fc;this.commentId=yc;this.currentState=Uc;this.history=zd}}Object(l.a)(za,
"CommentTaskItem",null,[]);var la=c(1611);const va=fc=>{const yc=new la.a(fc.UserId,fc.Provider,fc.DisplayName,fc.Email);yc.IsCurrentUser=fc.IsCurrentUser;return yc};var ia=c(1817);class pa{static clone(fc){fc=pa.P_k(fc.extensions);return new ia.a(fc)}static lFh(fc){return fc?pa.clone(fc):null}static isEmpty(fc){return!fc.extensions||!fc.extensions.count}static jf(fc){return!fc||pa.isEmpty(fc)}static P_k(fc){if(!fc)return null;const yc=new a.a;fc.forEach((Uc,zd)=>{yc.add(Uc,zd);return!0});return yc}}
Object(l.a)(pa,"ExtensionListExtensions",null,[]);class sa{static clone(fc){var yc=va(fc.user);yc=new oa.a(fc.type,yc,fc.time,fc.recordId,fc.isLossy);yc.commentId=fc.commentId;yc.anchorExtensionList=pa.lFh(fc.anchorExtensionList);yc.recordExtensionList=pa.lFh(fc.recordExtensionList);fc.assignee&&(yc.assignee=va(fc.assignee));if(fc.schedule){var Uc=fc.schedule;const zd=new qa.a;zd.startDate=Uc.startDate;zd.endDate=Uc.endDate;yc.schedule=zd}yc.completion=fc.completion;yc.title=fc.title;yc.priority=
fc.priority;yc.undoId=fc.undoId;return yc}}Object(l.a)(sa,"HistoryRecordExtensions",null,[]);class Ha{constructor(fc,yc,Uc,zd,ie,Oe,Ge,re=!1){this.$kd=fc;this.Crd=yc;this.YLa=Uc;this.a0j=zd;this.Erc=ie;this.Brc=Oe;this.Crc=Ge;this.Pmd=re}ofl(fc,yc,Uc,zd=null){if(!fc)throw fa.ULS.sendTraceTag(42796181,327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!yc)throw fa.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!Uc||!Uc.length)throw fa.ULS.sendTraceTag(42796183,
327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==Uc[0].type)throw fa.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var ie=[],Oe=null,Ge=this.EKn(Uc);for(var re of Uc)if(!Ge.contains(re.recordId))if(Uc=this.mji(re.commentId,zd),Uc=this.jLl(re,Uc),1===Uc.type){let Xe=[];this.Pmd&&Oe&&Oe.state&&(Xe=Oe.state.assignees);Oe=new Na(this.$kd,Uc,this.Erc,this.Brc,this.Crc,this.Pmd,Xe);ie.push(Oe)}else if(Oe)Oe.e0o(Uc);
else throw fa.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");Ge=null;re=[];if(Oe){Oe.isDeleted||(Ge=Oe.state);Oe=null;for(var mf of ie)ie=mf.j_l(Oe),Array.addRange(re,ie),Oe=mf}mf=this.mji(yc,zd);Ge&&(Ge.completion=this.Y3k(yc,zd,Ge.completion));return new za(fc,mf,Ge,re)}v3h(fc,yc,Uc,zd=null){if(!yc)throw fa.ULS.sendTraceTag(42796185,
327,10,"update cannot be null."),Error.argumentNull("update");if(Uc&&!fc)throw fa.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const ie=[],Oe=this.YLa.xUl();if(Uc){var Ge=this.YLa.q_a(1,fc,Oe);ie.push(Ge)}Ge=null;if(yc.assigneeUpdate){if(!yc.assigneeUpdate.assigneesToAdd||!yc.assigneeUpdate.assigneesToRemove)throw fa.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var re=
0;re<yc.assigneeUpdate.assigneesToAdd.length;re++){var mf=this.yMh(2,yc.assigneeUpdate.assigneesToAdd[re],fc,Oe);mf&&ie.push(mf)}for(re=0;re<yc.assigneeUpdate.assigneesToRemove.length;re++)(mf=this.yMh(3,yc.assigneeUpdate.assigneesToRemove[re],fc,Oe))&&ie.push(mf)}else yc.assignee&&(Uc||(Ge=this.YLa.q_a(4,fc,Oe),ie.push(Ge)),re=this.YLa.q_a(2,fc,Oe),Ge=this.Crd.K7a(yc.assignee),re.assignee=Ge,ie.push(re));yc.title?(zd=this.YLa.q_a(9,fc,Oe),zd.title=yc.title,ie.push(zd)):Uc&&zd&&(re=this.YLa.q_a(9,
fc,Oe),re.title=this.a0j.Xhm(zd,Ge),ie.push(re));if(yc.schedule){if(yc.schedule.startDate>yc.schedule.endDate)throw fa.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");zd=this.YLa.q_a(5,fc,Oe);zd.schedule=yc.schedule;ie.push(zd)}if(void 0!==yc.completion&&null!==yc.completion){zd=yc.completion;if(0>zd||100<zd)throw fa.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");Uc||fa.ULS.sendTraceTag(595198538,
327,50,"Task progress change. [Progress: {0}]",zd);Uc=this.YLa.q_a(6,fc,Oe);Uc.completion=zd;ie.push(Uc)}if(void 0!==yc.priority&&null!==yc.priority){yc=yc.priority;if(0>yc||10<yc)throw fa.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");fc=this.YLa.q_a(10,fc,Oe);fc.priority=yc;ie.push(fc)}return ie}yMh(fc,yc,Uc,zd){if(2!==fc&&3!==fc)return fa.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;
fc=this.YLa.q_a(fc,Uc,zd);fc.assignee=this.Crd.K7a(yc);return fc}EKn(fc){const yc=new k.a,Uc=new k.a;for(let zd=fc.length-1;0<=zd;zd--){const ie=fc[zd],Oe=Uc.contains(ie.recordId);Oe||-1!==ie.type||(Uc.contains(ie.undoId)?fa.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):Uc.add(ie.undoId));if(Oe||-1===ie.type)yc.contains(ie.recordId)?fa.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):
yc.add(ie.recordId)}return yc}jLl(fc,yc){const Uc=sa.clone(fc);Uc.commentId=yc;Uc.user=this.Crd.K7a(fc.user);Uc.assignee=this.Crd.K7a(fc.assignee);return Uc}Y3k(fc,yc,Uc){let zd=Uc;fc&&yc&&(({value:yc}=yc.Dc(fc)).returnValue?(zd=yc.ResolveState?100:100===Uc?0:Uc,zd!==Uc&&fa.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",fc)):fa.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",
fc));return zd}mji(fc,yc){let Uc=fc;fc&&yc&&(({value:yc}=yc.Dc(fc)).returnValue?Uc=yc.CommentId:(fa.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",fc),Uc=fc));return Uc}}Object(l.a)(Ha,"CommentTaskTranslatorImpl",null,[924]);var ra=c(1036),Ma=c(1212);class ya{constructor(){this.igb=CommonUIStrings.l_Ellipsis}Xhm(fc,yc){if(!fc)throw fa.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");
try{var Uc=E.a.tEb(fc)}catch(mf){throw fa.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var zd=fc=0,ie=0;const Oe=RegExp("\\s+","g"),Ge=new Sys.StringBuilder;for(var re of Uc.ops)re.attributes&&re.attributes.atmention&&re.attributes.atmention.email&&yc&&(Uc=re.attributes.atmention.email,0<Uc.length&&(Uc===yc.UserId||Uc===yc.Email||Uc===ra.a.Jgb(yc.UserId))&&(zd=fc,ie=zd+re.insert.length)),Uc=re.insert.replace(Oe,
" "),fc+=Uc.length,Ge.append(Uc);!ie&&yc&&fa.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",yc.Provider);yc=Ge.toString().trimEnd();fc=yc.length;255<fc?(re=(255-(ie-zd))/2,0>zd-re?(fc=Ma.a.instance.M0a(yc,255-this.igb.length),ie=yc.substring(0,fc)+this.igb,fc="Trimmed End"):ie+re>fc?(zd=Ma.a.instance.e1a(yc,fc-255+this.igb.length),ie=this.igb+yc.substring(zd,fc),fc="Trimmed Start"):(zd=Ma.a.instance.e1a(yc,zd-re+this.igb.length),fc=Ma.a.instance.M0a(yc,ie+re-this.igb.length),
ie=this.igb+yc.substring(zd,fc)+this.igb,fc="Trimmed Both")):(fc="No Trim",ie=yc);fa.ULS.sendTraceTag(592998804,327,50,fc);return ie}}Object(l.a)(ya,"ContentExtractor",null,[]);class Ga{constructor(fc,yc){this.W6j=fc;this.bak=yc;this.sOb=this.FPb=!1}K7a(fc){if(!fc)return null;if(void 0===fc.UserId||null===fc.UserId)throw fa.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(fc.IsCurrentUser||!this.W6j.equals(this.bak.value,fc))return fc;fc=va(fc);fc.IsCurrentUser=
!0;return fc}}Object(l.a)(Ga,"EnsureIsCurrentUserSetTransformer",null,[923]);class wa{constructor(){this.sOb=this.FPb=!1}K7a(fc){if(!fc)return null;if(void 0===fc.UserId||null===fc.UserId)return fc;if(!fc.Email||""===fc.Email){let yc;if(yc=ra.a.Jgb(fc.UserId))return fc=va(fc),fc.Email=yc,fc}return fc}}Object(l.a)(wa,"RestoreEmailTransformer",null,[923]);class hb{constructor(){this.sOb=this.FPb=!1}K7a(fc){if(!fc)return null;if(void 0!==fc.UserId&&null!==fc.UserId)return fc;switch(this.FPb?this.sOb?
2:1:0){case 0:if(void 0===fc.UserId||null===fc.UserId)throw fa.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");fc=va(fc);break;case 1:if(void 0===fc.Id||null===fc.Id)throw fa.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===fc.Email||null===fc.Email)throw fa.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var yc=hb.P0i(fc.Id,fc.Email,null);if(!yc||""===yc)throw fa.ULS.sendTraceTag(593368212,
327,10,"Failed to generate UserId"),Error.argument("UserId");var Uc=u.AFrameworkApplication.K.jb("HostAuthType")||"";if("aad"!==Uc.toLowerCase()||yc.startsWith("S::")){if("msa"===Uc.toLowerCase())throw fa.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");fa.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",Uc)}else throw fa.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");
fc=new la.a(yc,"AD",fc.DisplayName,fc.Email);break;case 2:if(void 0===fc.UserPrincipalName||null===fc.UserPrincipalName)throw fa.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==fc.SuggestionSubtype&&null!==fc.SuggestionSubtype)if("OrganizationUser"===fc.SuggestionSubtype)yc="AD";else throw fa.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",fc.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");
else throw fa.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");Uc=hb.P0i(fc.Id,fc.UserPrincipalName,fc.AadObjectId);if(!Uc||""===Uc)throw fa.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===yc&&!Uc.startsWith("S::"))throw fa.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");fc=new la.a(Uc,yc,fc.Name,fc.UserPrincipalName);break;default:throw fa.ULS.sendTraceTag(593368203,
327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return fc}static P0i(fc,yc,Uc){if(!yc||""===yc)return fa.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),fc;if(Uc&&""!==Uc)return"S::"+yc+"::"+Uc;if(!fc||""===fc)return fa.ULS.sendTraceTag(593368217,327,50,"Missing ID"),fc;if(fc.startsWith("S::"))return fc;if(-1!==fc.indexOf("@")){Uc=fc.split("@");if(na.a.isValid(Uc[0]))return"S::"+yc+"::"+Uc[0];fa.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return fc}}
Object(l.a)(hb,"UserIdCanonicalizationTransformer",null,[923]);class eb{constructor(fc,yc,Uc=!1,zd=!1){this.I2j=fc;this.fOg=yc;this.Nak=Uc;this.Pmd=zd}r$k(){const fc=new ra.a;var yc=new ba.a(eb.aUl);const Uc=new aa;this.fOg&&(Uc.gmc.push(new hb),Uc.gmc.push(new wa));this.I2j&&Uc.gmc.push(new Ga(fc,yc));Uc.FPb=this.fOg;Uc.sOb=this.Nak;yc=new ja(yc,Uc);const zd=new ya;return new Ha(fc,Uc,yc,zd,eb.pjl,eb.fjl,eb.gjl,this.Pmd)}static aUl(){const fc=new la.a(u.AFrameworkApplication.K.jb("PresenceUserId")||
"",u.AFrameworkApplication.K.jb("PresenceProvider")||"",u.AFrameworkApplication.userName||"");fc.IsCurrentUser=!0;return fc}}eb.pjl="";eb.fjl=5;eb.gjl=0;Object(l.a)(eb,"CommentTaskTranslatorFactory",null,[914]);var jb=c(44),ub=c(167),ab=c(13),Ea=c(5),Wa=c(51),Bb=c(9),Mb=c(172),Fb=c(46),vb=c(23),$a=c(724),kb=c(37),Ua=c(8),Sa=c(1207),xb=c(17),Qb=c(28),Ib=c(75),$b=c(284),hc=c(127),pb=c(201),dc=c(391),Ob=c(703),Vb=c(368),ob=c(60),Xb=c(233),Xa=c(12),Pb=c(245),rc=c(6),Ta=c(691),Ab=c(583),Db=c(354),ac=c(55),
Pa=c(599),bb=c(111),lc=c(77),rb=c(218),La=c(1474),sb=c(35),Sb=c(1038);class kc{create(){return new Sb.a}}Object(l.a)(kc,"CommentNodeFactory",null,[598]);var Lb=c(1200),Qc=c(1058),Dc=c(1514),Fd=c(1575);class pe{constructor(){this.YKc=this.B9c=null;this.tKd=this.ike=!1;this.BNa=this.UCa=null}}Object(l.a)(pe,"CommentAnchorParaNodesStatus",null,[]);var ye=c(1407),pf=c(16);class Yf extends ye.a{constructor(fc){super();this.ohk=fc}get index(){return 2}run(){this.ohk()}uGh(fc,yc){yc.property===pf.a.ef&&
this.qY()}}Object(l.a)(Yf,"CommentContentPropertyTracker",ye.a,[]);var Ed=c(1506);class Rc{constructor(fc,yc){this.Vfc=fc;this.sti=yc}}Object(l.a)(Rc,"CommentIntentIdentifier",null,[]);var Yc=c(1027),Mc=c(1213),ge=c(193),Ne=c(156);class Ee extends ye.a{constructor(fc,yc){super();this.F9a=new Ab.a(new Yc.a);this.F_b=new Mc.a(Ed.c);this.G_b=new ge.ScriptSharpLegacyMap;this.ldk=fc;this.pek=yc;this.G_b.add(rc.a.bba,1);this.G_b.add(rc.a.xH,0);this.G_b.add(pf.a.ef,0);this.G_b.add(rc.a.vQ,2)}get index(){return 4}run(){let fc=
"";for(const yc of this.F9a)if(this.ldk(yc),this.F_b.mb(yc.id))for(const Uc of this.F_b.J(yc.id))fc+="_"+Uc;this.pek(fc);this.F9a.clear();this.F_b=new Mc.a(Ed.c)}L2k(fc,yc){fc=yc.property;if(fc===rc.a.bba||fc===rc.a.xH||fc===pf.a.ef||Ne.App.Ope&&fc===rc.a.k3b||fc===rc.a.vQ)this.F9a.add(yc.node),this.G_b.mb(fc)&&(this.F_b.mb(yc.node.id)||this.F_b.add(yc.node.id,new Pa.a),this.F_b.J(yc.node.id).add(this.G_b.J(fc))),this.qY();Dc.a.aPh.has(yc.node.id.toString())&&fc===rc.a.$E&&fa.ULS.sendTraceTag(521484097,
327,15,"Durable ID changed of a Cut Pasted Comment")}X2k(fc,yc){yc.property===pf.a.lo&&(fc=yc.node,fc.nHb&&(this.F9a.add(fc),this.qY()))}RIo(fc,yc){this.F9a.add(yc.node);this.qY()}}Object(l.a)(Ee,"CommentNodeTransactionCompletedProcessor",ye.a,[]);var Ve=c(1577),mc=c(1616);class Oc{constructor(){this.Fze=new Map;this.LCe=new Map}ksk(fc,yc){if(this.Fze.has(fc))throw Error("DuplicateDurableId");if(this.LCe.has(yc))throw Error("DuplicateGuardId");this.Fze.set(fc,yc);this.LCe.set(yc,fc)}sZl(fc){return this.Fze.get(fc)}D8h(fc){return this.LCe.get(fc)}}
Object(l.a)(Oc,"CommentIdMapper",null,[]);var xd=c(15),Dd=c(1526),ud=c(1677),He=c(1556),uf=c(115),Lh=c(114);c.d(K,"a",function(){return Sf});class Sf extends f.a{constructor(fc,yc,Uc,zd,ie,Oe,Ge,re,mf,Xe,qf,kf,$f,xf,Qg,zb,Yb,Tc,Id,Xc,Le,cf,Ig,Ji,Th,Ah=null,Pm){super();this.wx=fc;this.gJe=yc;this.bJe=Uc;this.Ic=zd;this.l_j=ie;this.kvb=Oe;this.$Xe=Ge;this.yqc=re;this.Fa=mf;this.ld=Xe;this.Jn=qf;this.mXb=kf;this.G6=$f;this.aXb=xf;this.X4g=Qg;this.Vg=zb;this.Im=Yb;this.SUa=Tc;this.Zi=Id;this.U1=Xc;this.gK=
Le;this.xYa=cf;this.oAc=Ig;this.Cqc=[];this.kVa=[];this.oVe=new a.a(0);this.jtd=new a.a;this.owd=new Ab.a(Db.a.Fh());this.OUe=new Ab.a(Db.a.Fh());this.gid=null;this.$sb=new a.a;this.iye=!1;this.egd=new k.a;this.B_g=!1;this.twe=new Set;this.Rve=0;this.pZ=[];this.HUb=2;this.IBa=new a.a(!1);this.Qxc=new k.a;this.wsc=new Map;this.$fd=new Oc;this.agd=0;this.k_j=5;this.qKb=(zf,lg)=>{zf=lg.paragraphNode;for(const md of lg.contents)this.awa(md.element,zf,md.intents,md.qG)};this.E_c=(zf,lg)=>{if(zf.Kc.id.equals(this.od.id)){this.SUa.aHa(7);
var md=zf.getValue(rc.a.xH),td=zf.getValue(rc.a.$E).toString();md=this.Vg.qgb?this.wsc.has(td)?this.wsc.get(td):td:md;md=this.MD(md);if(lg){if(md){this.ry&&this.ry.Cf===md.id&&(fa.ULS.sendTraceTag(592188698,327,50,"Draft lost by parent deletion"),this.gK.logKpiFailure(Dd.a.fFd,"DraftCommentLostOnParentDelete",{isIntentional:!1,isInternal:!0},{name:Dd.a.REd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}));lg=md.Cf?"The comment is a reply":"";td=Ed.k(zf,x.a.nil).toString();const Bd=Ed.h(zf,
x.a.nil).toString();if(this.egd.contains(md.id)&&!Dc.a.HJm(md.a0a)){this.egd.remove(md.id);const nl=+new Date-+md.date;fa.ULS.sendTraceTag(577307335,327,15,"New session comment deleted by inbound change: {0}. duration: {1}. startParaId: {2}. endParaId: {3}. {4}.",Ed.a(md),nl,td,Bd,lg)}else fa.ULS.sendTraceTag(50426379,327,50,"{0} deleted by inbound changes. startParaId: {1}. endParaId: {2}. {3}.",Ed.a(md),td,Bd,lg);this.Yi.yJc(md);this.QQh(zf.id)}}else if(!md){this.gK.ensureFeatureDenominatorLoggedAndVetoPillarRegistered();
y.a.instance.Na("WordEditor.Comments.EditorCommentManager")||fa.ULS.sendTraceTag(525379405,327,10,"comment Manager resolve failed");if(this.Vg.iCb&&!this.Zi.fY){this.U1.W4("OnCommentInit",Object.assign(new Ve.a,{WUi:()=>{this.FTf(zf);this.SMb()}}));return}this.Vg.Yq||this.Zi.fY||this.U1.W4("OnCommentInit");this.SNn(zf)||this.FTf(zf)}this.iye=!0}};this.SMb=(zf=null)=>{this.Vg.eQb&&this.sri();this.Vg.eQb&&this.Vvl();this.eJ.UMb(void 0,zf);this.SUa.aHa(8)};this.FYi=(zf,lg,md)=>{if(zf.Kc.id.equals(this.od.id)){var td=
zf.ia(rc.a.taskId,"");if(""===td)fa.ULS.sendTraceTag(42856717,3003,10,"Newly added or deleted task node does not have a task id.");else{if(lg)if(this.OUe.add(td),td=this.aXb.value.mii(zf),void 0!==td&&null!==td)this.$sb.remove(td);else{fa.ULS.sendTraceTag(591971722,3003,10,"A task without comment id was deleted even though that shouldn't be possible.");return}else if(this.owd.add(td),lg=this.aXb.value,zf=lg.mii(zf),void 0!==zf&&null!==zf)for(this.$sb.J(zf)?this.$sb.Z(zf,td):this.$sb.add(zf,td),zf=
lg.oii(td),lg=0;lg<zf.length;lg++){var Bd=zf[lg].commentId;Bd&&(Bd=Number.parseInvariant(Bd),this.$sb.J(Bd)||this.$sb.add(Bd,td))}else{fa.ULS.sendTraceTag(591971723,3003,10,"A task without comment id was added or modified even though that shouldn't be possible.");return}md&&this.SMb()}}};this.lVo=zf=>{if(Dc.a.qYd(zf)){const md=this.z_(zf.id.toString());if(md){const td={text:md.text,done:md.done};var lg=Ea.GraphIterator.$a(zf);md.text=this.iEb(lg);this.YJi(md.text);md.done=zf.ia(rc.a.bba,!1);zf.hasProperty(rc.a.vQ)&&
(lg=(lg=zf.getValue(rc.a.vQ))?sb.b(lg||""):null,md.usersByReactionType=lg,He.a.lDh(md.usersByReactionType),this.WWk(md));this.oVo(zf,md);md.Cf||this.tVo(zf,md);!this.Vg.sua||!this.xE||this.ry&&this.ry.id===md.id||this.xE.fireEvent(10,{comment:md,XSi:td})}}else this.ld.isFeatureEnabled(115)&&72===zf.type?this.FYi(zf,!1,!1):this.nVo(zf)};this.Wvl=()=>{const zf=this.HOd();for(this.Cqc.sort((lg,md)=>{const td=lg.ia(rc.a.iM,null),Bd=md.ia(rc.a.iM,null);if(!td&&Bd)return-1;if(!Bd&&td)return 1;lg.hasProperty(rc.a.VCa)&&
md.hasProperty(rc.a.VCa)?(lg=lg.getValue(rc.a.VCa),md=md.getValue(rc.a.VCa),md=lg<md):(lg=new Date(lg.getValue(rc.a.mHc)),md=new Date(md.getValue(rc.a.mHc)),md=lg<md);return md?-1:1});this.Cqc.length;){const lg=this.Cqc[0];zf.Aib(lg)&&(zf.sj(lg),this.Yi.addComment(this.QGd(zf),null),this.Yi.mode=1);Array.removeAt(this.Cqc,0)}if(zf.Sb(1))for(;zf.Pf(1););this.ld.isFeatureEnabled(115)&&this.aXb.value.qii();this.iye&&(this.SMb(),this.iye=!1)};this.znl=zf=>{1===zf&&(rb.WoncaApp.Tle.NKh(),this.mXb.value.v6a(!0,
"CommentInboundFailed"));this.G6.WC(Wa.a.gaf,this.REi)};this.kha=zf=>{if(!this.Vg.Yq||zf.done)return!1;if(zf.Xq===n.a.beingCreated)return!0;if(zf.objectId){if(this.qIm(zf))return!1;if(!this.yOm(zf.objectId)||zf.Cf)return!0;for(const lg of this.AO())if(lg.Cf===zf.id)return!0}return!1};Sf.fK=Ah;this.Epd=new Ab.a(Db.a.Fh());!this.Vg.iCb&&this.Vg.Yq||Sb.a.tSa(this.E_c);Th.TMa(this.qKb);Ji&&(Ji.Ax((zf,lg)=>{zf=Ed.o(this.pZ,lg.node.id);0<this.pZ.length&&(!zf||zf===this.pZ.length-1)&&(this.HUb=1,this.pZ=
[])}),Pm.execute(zf=>{this.xE=zf}),u.AFrameworkApplication.NH&&(u.AFrameworkApplication.ue("AutoPopulateShareTUIComment;AutoPopulateShareTUICommentCf"),this.Vg.zJk&&this.vrk()))}vrk(){z.a.instance.Vb(new w.a(5,1,0,()=>{const fc=this.Ic.Oc(7);fc.Cb(this.ZIa);var yc=Bb.App.xa.ib.Uc;yc&&(yc=Mb.PageNavigator.instance.LO(yc),yc=Ea.GraphIterator.$a(yc),yc.Pd(),yc.Pd(),yc.Pd(),yc.Pd(),Fb.a.instance.setSelection(vb.SelectionFactory.ZI(yc.currentNode,0,0)),yc=new E.a,yc.iha("Get the conversation going by adding comments and using Share (above) to send a link to this doc. It\u2019s free! No subscription or sign-in necessary. \n"),
this.BBb(Fb.a.instance.gb.kb,"Microsoft Word",yc),fc.dispose(),jb.a("ShareTUICommentCreated"),fa.ULS.sendTraceTag(520728590,327,50,"ShareTUICommentCreated"))}))}get eJ(){return this.Yi}get V0e(){return this.ah}get REi(){return null!=this.IDg?this.IDg:this.IDg=Object.assign(new $a.a,{q3:WoncaIntl.WoncaStrings.l_InboundingCommentFailed,Ifa:1})}get Us(){return this.Ic}get ix(){return this.wx.value}get od(){return this.ix.od}get ZIa(){return this.gJe.value}get XCa(){return this.bJe.value}get lb(){return this.kvb.value}get zY(){return this.Fa.jb("PresenceUserId")}get l5a(){return this.Fa.jb("PresenceProvider")}awa(fc,
yc,Uc,zd){if(Uc&&this.ry&&(!this.ry||!this.ry.Cf)){var ie=!1;for(const Oe of Uc)if(3===Oe.type)switch(ie=!0,Uc=Ed.n(this.pZ,Oe.id),-1<Uc&&(this.pZ[Uc].Vfc=yc.id),fc.classList.add(kb.a.OJd),zd){case 1:fc.classList.add(kb.a.Egf);break;case 0:fc.classList.add(kb.a.Fgf)}ie||fc.classList.remove(kb.a.OJd,kb.a.Fgf,kb.a.Egf);this.SUa.aHa(3)}}Jof(fc=!1){return this.$Xe.CJl(this.ah,u.AFrameworkApplication.va.mode,yc=>!this.Vg.tPb||!fc||this.kha(yc))}oof(fc){return this.$Xe.MPl(this.Yi.model.AO(),u.AFrameworkApplication.va.mode,
fc)}atf(fc){if(!fc||!fc.Cf)return fc;fc=fc.Cf;for(let yc=0;yc<this.ah.length;yc++)if(this.ah[yc].id===fc)return this.ah[yc];return null}q$k(){const fc=[];if(this.ld.isFeatureEnabled(115)){var yc=this.aXb.value;for(const Uc of yc.qii())(yc=this.L3h(Uc))&&fc.push(yc)}return fc}Axm(fc){if(!this.kVa)throw G.a.invalidOperation("UpdateContent must have been called before this.");for(let yc=0;yc<this.kVa.length;yc++)if(this.kVa[yc].id===fc)return yc;return-1}sri(){const fc=new lc.a;for(const Uc of this.ah)if(Uc.objectId&&
Uc.uPa){var yc=x.a.Ef(Uc.objectId);if((yc=this.od.Db(yc))&&yc.hasProperty(rc.a.$E))if(yc=yc.getValue(rc.a.$E).toString(),fc.mb(yc)){const zd=fc.J(yc).CommentId;this.sQj(zd,Uc,yc)}else fc.add(yc,new H(Uc.id,Uc.done))}this.gid=fc}sQj(fc,yc,Uc){fc!==yc.uPa?(fa.ULS.sendTraceTag(42866777,327,10,"Multiple comments contains the same DurableId [{0}]; ObjectId [{1}], GuardId [{2}], GuardId of existing entry: {3}",Uc,yc.objectId,yc.uPa,fc),this.gK.logKpiFailure(Dd.a.n3b,"MultipleCommentsWithSameDurableId",
{isInternal:!0},{name:Dd.a.m3b,isInternal:!0})):fa.ULS.sendTraceTag(554297428,327,15,"Duplicate entry of same comment with DurableId [{0}], GuardId [{1}], ObjectId [{2}]",Uc,yc.uPa,yc.objectId)}L3h(fc){const yc=this.X4g.value;var Uc=this.aXb.value;const zd=Uc.e9b(fc);if(void 0===zd||null===zd)return fa.ULS.sendTraceTag(592234717,3003,50,"GenerateTaskItemForTaskId was called with a taskId [{0}] that has no comment anchor id.",fc),null;Uc=Uc.oii(fc);try{return yc.ofl(fc,zd.toString(),Uc,this.gid)}catch(ie){return fa.ULS.sendTraceTag(42856716,
3003,10,"CreateTaskItemFromHistoryRecords Failed due to [{0}]",ie.message),null}}Q6h(fc=!1,yc=!1){const Uc=new k.a,zd=yc?Ed.j():new Set;this.IBa.keys.forEach(ie=>{zd.has(ie)||fc&&this.IBa.J(ie)||Uc.add(ie);return!0});return Uc}gRd(){if(!this.ah)return 0;let fc=0;for(const yc of this.ah)yc.Cf||fc++;return fc}iUc(fc){var yc,Uc;return(null===(Uc=null===(yc=this.ry)||void 0===yc?void 0:yc.lz)||void 0===Uc?void 0:Uc.draftId)===fc}nsk(fc){var yc;if(fc.Xq===n.a.beingCreated){if(this.Yi.mode=2,this.Cab=fc,
this.lb.gb){var Uc=this.lb.gb.kb;if(Uc&&Uc.Oa){Uc=this.RZo(Uc);for(var zd=0;zd<Uc.length;zd++){var ie=Uc.J(zd).node;if(!Ua.ParagraphReader.Wb(ie)||!(-1!==Uc.J(zd).cpBegin&&-1!==Uc.J(zd).cpEnd||-1!==Uc.J(zd).wj&&-1!==Uc.J(zd).Yo))continue;var Oe=-1===Uc.J(zd).cpBegin?Uc.J(zd).wj:Uc.J(zd).cpBegin;const Ge=-1===Uc.J(zd).cpEnd?Uc.J(zd).Yo:Uc.J(zd).cpEnd,re=x.a.create();this.Jn.jRa(ie,new Sa.a(3,Oe,Ge,re));this.pZ.push(new Rc(ie.id,re));this.Tsk(null===(yc=fc.lz)||void 0===yc?void 0:yc.draftId,ie,Oe,Uc)}}}}else this.P3f(fc);
Uc=({index:yc}=this.cne(fc)).returnValue;zd=null;if(!fc.Cf){ie=this.Q6h();fc.Xq!==n.a.beingCreated&&(zd=this.Jcm(fc),ie.remove(fc.objectId));ie=({index:Oe}=this.R4l(zd,ie)).returnValue;yc=-1<Oe?Oe:yc;Oe=0;if(ie)for(;yc<this.ah.length&&this.ah[yc].Cf;)yc++;if(!ie&&this.Vg.Yq&&fc.Xq===n.a.beingCreated)for(ie=0;ie<yc;ie++)this.ah[ie].Cf||this.ah[ie].done||Oe++;this.WEo(fc,Oe)}Uc&&(Array.insert(this.ah,yc,fc),this.Vg.sua&&this.xE&&fc.Xq!==n.a.beingCreated&&(fc.Cf?this.xE.fireEvent(10,{comment:fc,changeType:"replyAdded"}):
this.xE.fireEvent(11,{comment:fc})),this.qsk(fc,zd))}RZo(fc){if(this.Vg.hzl){var yc=xb.SelectionEditor.pzl(fc);yc&&(this.lb.setSelection(yc),fc=yc)}else xb.SelectionEditor.Sl(fc)&&(yc=xb.SelectionEditor.w_(fc.Oa,!1))&&(this.lb.setSelection(yc),fc=yc);return fc}Tsk(fc,yc,Uc,zd){this.Vg.contentNavigationApiEnabled&&fc&&yc&&zd&&this.oAc.o_e({contentId:fc,containerContentType:0,A9:{yd:Uc,NM:yc.Al}},{selection:zd})}qsk(fc,yc){if(this.Vg.contentNavigationApiEnabled&&fc&&!fc.Cf&&fc.Xq!==n.a.beingCreated){var Uc=
this.od.Db(fc.objectId);if(Uc){var zd=Ed.k(Uc,x.a.nil);zd=this.od.Db(zd);zd=Dc.a.Dva(zd,Uc.id,!1);(null===zd||void 0===zd?0:zd.Ib)&&(null===zd||void 0===zd?0:zd.paragraph)?this.oAc.o_e({contentId:fc.id,containerContentType:0,A9:{yd:zd.Ib.cp,NM:zd.paragraph.Al}},{selection:yc}):fa.ULS.sendTraceTag(520717896,327,10,`comment object id: ${Uc.id},
        commentStartRangeObject Valid: ${!!zd},
        containingProperties Valid: ${!(null===zd||void 0===zd||!zd.Ib)},
        paragraph valid: ${!(null===zd||void 0===zd||!zd.paragraph)};
        Failed to add to ReviewSuggestionModel`)}}}tua(fc){super.tua(fc);this.egd.add(fc.id)}x4n(fc,yc){this.Vg.contentNavigationApiEnabled&&this.oAc.w4n(fc,yc)}WEo(fc,yc){this.Vg.Yq&&fc.Xq===n.a.beingCreated&&fc.lz&&this.oVe.Z(fc.lz.draftId,yc)}Pgm(fc){return this.oVe.J(fc)}R$i(fc){this.oVe.remove(fc)}n0l(fc){let yc=0,Uc=0;for(let zd=0;zd<this.ah.length;zd++){if(this.ah[zd].id===fc.id){Uc=zd;break}this.ah[zd].Cf||this.ah[zd].done||yc++}return{returnValue:Uc,DKo:yc}}euf(fc){var yc=null,Uc=this.od.Db(fc);
fc=Dc.a.Eba(Uc,this.od,!0);Uc=Dc.a.Eba(Uc,this.od,!1);fc&&Uc&&(yc=vb.SelectionFactory.pe(fc.Ib.paragraph,fc.Ib.cp),yc=vb.SelectionFactory.oz(yc,Qb.a.Qc(Uc.Ib.paragraph,Uc.Ib.cp)));fc&&Uc||this.gK.logKpiFailure(Dd.a.n3b,"ParaNodeNotConnected",{isIntentional:!1,isInternal:!0});return yc}Jcm(fc){fc=x.a.Ef(fc.objectId);return this.euf(fc)}E5f(fc,yc){var Uc=this.od.Db(fc);if(Uc){var zd=this.od.Db(Ed.k(Uc));Uc=this.od.Db(Ed.h(Uc));if(zd===Uc)for(Uc=0;Uc<zd.pa.length&&!zd.pa.J(Uc).MQo(fc,yc);Uc++);}}R4l(fc,
yc){let Uc=-1;var zd=null;fc||(fc=this.lb.gb?this.lb.gb.kb:null);if(!fc||!fc.Oa)return{returnValue:null,index:Uc};const ie=this.Cei(fc.Oa);if(!ie)return{returnValue:null,index:Uc};var Oe=Dc.a.H1l(ie.iterator.currentNode,fc.Oa.cpBegin,this.Vg.Yq,yc);Oe&&(zd=this.z_(Oe.ak.toString()),Oe=Array.indexOf(this.ah,zd),zd=0<=Oe?zd:null,Uc=0<=Oe?Oe+1:Uc);zd||(fc=this.O6h(ie,fc.Oa,this.Vg.Yq,yc),zd=0<=fc?this.ah[fc]:null,Uc=0<=fc?fc:Uc);return{returnValue:zd,index:Uc}}JRl(fc=null){var yc=null;yc=this.lb.gb.kb;
return yc&&yc.Oa?this.IXl(yc.Oa,this.Vg.Yq,fc):null}Cei(fc){const yc=new Ea.GraphIterator;yc.set(fc.node);return yc.Bp()?Ib.a.Rs(yc,yc.origin):null}IXl(fc,yc,Uc=null){const zd=this.Cei(fc);fc=this.O6h(zd,fc,yc,Uc);return-1<fc?this.ah[fc]:null}O6h(fc,yc,Uc,zd=null){let ie=-1;if(fc)for(yc=yc.cpBegin;-1===ie&&fc.moveNext();)Ua.ParagraphReader.sh(fc.iterator)&&((yc=Dc.a.RNc(fc.iterator.currentNode,yc,Uc,zd))&&(ie=Array.indexOf(this.ah,this.z_(yc.ak.toString()))),yc=0);return ie}Fvi(fc){const yc=fc.toString();
return this.IBa.mb(yc)&&this.IBa.J(yc)||this.Qxc.contains(fc)&&this.od.ewa(fc)&&this.od.Db(fc).ia(rc.a.bba,!1)}Rkj(fc,yc=!1){if(fc=this.SNc(fc))fc.UEf=!yc}sFf(fc){return this.IBa.mb(fc.toString())||this.Qxc.contains(fc)&&this.od.ewa(fc)&&!this.od.Db(fc).ia(rc.a.iM,null)}P3f(fc){!fc.objectId||fc.Cf||this.IBa.mb(fc.objectId)||this.IBa.add(fc.objectId,fc.done)}deleteComment(fc){fc&&!fc.Cf&&(this.Vg.Yq&&fc.Xq!==n.a.beingCreated?this.IBa.remove(fc.objectId):fc.Xq===n.a.beingCreated&&this.oEj());this.egd.remove(fc.id);
return super.deleteComment(fc)}Rpf(fc){return fc&&fc.hasProperty(rc.a.$E)?fc.Gf(rc.a.$E).toString():""}SNc(fc){if(!fc)return null;if(this.Vg.qgb)return this.MD(fc);for(const yc of this.ah){const Uc=this.od.Db(x.a.Ef(yc.objectId));if(this.Rpf(Uc)===fc.toString())return fc=Uc.Gf(rc.a.xH),this.MD(fc)}return null}F2f(fc,yc=!1){if(fc&&Dc.a.qYd(fc)&&this.ld.isFeatureEnabled(115)){const Uc=this.Rpf(fc);if(""!==Uc){if(yc){let zd;if(this.gid&&({value:zd}=this.gid.Dc(Uc,zd)).returnValue&&zd.ResolveState===
fc.ia(rc.a.bba,!1))return}(fc=this.$sb.J(Number.parseInvariant(Uc)))&&this.owd.add(fc)}}}SNn(fc){const yc=this.Hof(fc);let Uc=!1;yc.ike&&yc.tKd||(this.Qxc.add(fc.id),Uc=!0,this.dUi(fc));return Uc}dUi(fc){L.a.e3(u.AFrameworkApplication.nc,()=>{this.FTf(fc);this.Qxc.remove(fc.id);this.Qxc.count||(this.SMb(),this.eJ.vWo())},"DelayLoadCommentNodeIntoModel")}FTf(fc){if(!this.Yi&&(fa.ULS.sendTraceTag(525379406,327,10,"Comment Manager Not initialized"),this.agd<this.k_j)){this.agd+=1;this.dUi(fc);fa.ULS.sendTraceTag(525378784,
327,50,`Comment Node add Retry attempt ${this.agd}`);return}const yc=this.HOd();yc.sj(fc);if(yc.vz()){let Uc;try{Uc=this.QGd(yc)}catch(zd){fa.ULS.dD(512553930,327,10,zd,"create comment from comment node failed")}if(!Uc){fa.ULS.sendTraceTag(512553929,327,15,`CommentNode Failed to add: ${null===fc||void 0===fc?void 0:fc.id}`);this.gK.logKpiFailure(Dd.a.n3b,"CommentCreationFailed",{isInternal:!0},{name:Dd.a.m3b,isInternal:!0});return}this.Yi.addComment(Uc,null);2!==this.Yi.mode&&3!==this.Yi.mode&&(this.Yi.mode=
1);this.F2f(fc);this.hjn(Uc);this.mKj(Uc)}else this.Cqc.push(fc);this.U1.W4("OnCommentNodeAdded",{commentNode:fc})}hjn(fc){this.Vg.Yq&&!this.Zi.Zm&&this.eJ.Iz&&fc.Cf&&this.eJ.Iz.id===fc.Cf&&this.eJ.notify(String.format(Box4Intl.Box4Strings.L_CommentReplyAdded,fc.author),!1)}Hof(fc){const yc=new pe;yc.B9c=Ed.k(fc,x.a.nil);yc.YKc=Ed.h(fc,x.a.nil);fc=yc.B9c.equals(x.a.nil);const Uc=yc.YKc.equals(x.a.nil);fc||(yc.UCa=this.od.Db(yc.B9c),yc.ike=!!yc.UCa&&yc.UCa.isConnected);Uc||(yc.BNa=this.od.Db(yc.YKc),
yc.tKd=!!yc.BNa&&yc.BNa.isConnected);return yc}UWh(fc,yc){const Uc=this.Axm(fc);-1!==Uc&&Array.removeAt(this.kVa,Uc);yc||((fc=this.L3h(fc))?this.kVa.push(fc):fa.ULS.sendTraceTag(42870813,3003,10,"GenerateTaskItemForTaskId returned null"))}Vvl(){for(const fc of this.owd)this.UWh(fc,!1);this.owd.clear();for(const fc of this.OUe)this.UWh(fc,!0);this.OUe.clear()}cne(fc){var yc=this.ah.length,Uc=!1;if(fc.Cf){var zd=(Uc=this.MD(fc.Cf))&&Uc.objectId?this.od.Db(x.a.Ef(Uc.objectId)):null;zd=!!zd&&zd.hasProperty(rc.a.VCa);
yc=Array.indexOf(this.ah,Uc);Uc=0>yc;for(yc+=1;yc<this.ah.length&&this.ah[yc].Cf===fc.Cf&&this.ah[yc]!==this.ry&&!(zd&&fc.date<this.ah[yc].date);)yc++}return{returnValue:!Uc,index:yc}}eum(){const fc=new Ee(this.lVo,this.SMb),yc=Bb.App.Xj.zl;yc.Ze(40).Go(Object(ac.a)(fc,fc.L2k,"commentPropertyChanged"));yc.Ze(12).Go(Object(ac.a)(fc,fc.X2k,"commentTextChanged"));this.ld.isFeatureEnabled(115)&&yc.Ze(72).Go(Object(ac.a)(fc,fc.RIo,"taskPropertyChanged"));$b.GraphTransactionManager.instance.nqa(fc,3)}YJi(fc){this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.EmptyCommentLogging",
!1)&&fc&&0!==fc.length&&(fc=E.a.tEb(fc[0]),1<fc.ops.length||0===fc.ops.length||("\n"===fc.ops[0].insert&&(this.Rve+=1),3<this.Rve&&fa.ULS.sendTraceTag(509437908,327,15,"comments content cleared. Potentially resulting in data loss")))}WWk(fc){if(fc&&this.twe.has(fc.id)){var yc=fc.usersByReactionType[1];for(let Uc=0;yc&&Uc<yc.length;Uc++)if(yc[Uc].UserId===this.zY)return;fa.ULS.sendTraceTag(542765345,327,15,`Like by current user on Comment ${fc.objectId} removed by inbound changes`)}}tVo(fc,yc){this.a0k(yc);
const Uc=this.Vg.Yq;Uc&&this.Mqm(yc)?(this.Kjl(yc),this.F2f(fc),this.yZo(yc)):Uc||this.F2f(fc,!0)}nVo(fc){const yc=new Ea.GraphIterator;yc.set(fc);yc.zb(40);yc.jd(40);if(yc.currentNode){if(fc=this.z_(yc.currentNode.id.toString())){const Uc={done:fc.done,text:fc.text};fc.text=this.iEb(yc);this.YJi(fc.text);!this.Vg.sua||!this.xE||this.ry&&this.ry.id===fc.id||this.xE.fireEvent(10,{comment:fc,XSi:Uc})}}else fa.ULS.sendTraceTag(592738053,327,15,"UpdateComment Unexpected Node Type: "+hc.a[fc.type])}yZo(fc){if(!this.Zi.Zm){var yc=
new Pa.a;this.moe(fc,yc);0<yc.count&&Ta.b(yc)}}Kjl(fc){const yc=new w.a(0,1,0,()=>{this.mVo(fc)},137,void 0,!0);u.AFrameworkApplication.nc.Vb(yc)}a0k(fc){var yc;null!==(yc=this.ry)&&void 0!==yc&&yc.lz&&this.ry.lz.sessionType!==I.a.metadata&&(yc=this.ry,fc.Cf||!fc.done||yc.Cf!==fc.id&&yc.id!==fc.id||(fa.ULS.sendTraceTag(592188699,327,15,"Draft comment lost on parent resolve, DraftType: {0}",yc.Xq),this.gK.logKpiFailure(Dd.a.fFd,"DraftCommentLostOnParentResolve",{isIntentional:!1,isInternal:!0},{name:Dd.a.REd,
isIntentional:!1,isInternal:!0,isSessionEndingError:!1}),yc.Xq===n.a.beingCreated?(this.Yi.clearSelection(),this.deleteComment(yc),this.selectComment(fc)):yc.Xq===n.a.beingEdited&&(yc.Xq=n.a.normal,yc.SSa=N.a.succeeded,this.Yi.u6e())))}oVo(fc,yc){var Uc;const zd=null===(Uc=yc.lz)||void 0===Uc?void 0:Uc.draftId;if(this.Vg.qgb){if(fc=fc.getValue(rc.a.$E).toString(),yc.id!==fc){if(!yc.Cf)for(Uc=Array.indexOf(this.ah,yc)+1;Uc<this.ah.length&&this.ah[Uc].Cf===yc.id;Uc++)this.ah[Uc].Cf=fc;fa.ULS.sendTraceTag(555044877,
327,50,"durable Id updated.");yc.id=fc;this.wsc.has(fc)&&this.wsc.delete(fc)}}else if(fc=fc.getValue(rc.a.xH),yc.id!==fc){if(!yc.Cf)for(Uc=Array.indexOf(this.ah,yc)+1;Uc<this.ah.length&&this.ah[Uc].Cf===yc.id;Uc++)this.ah[Uc].Cf=fc;yc.id=fc}zd&&this.x4n(zd,yc.id)}Mqm(fc){return this.IBa.mb(fc.objectId)&&this.IBa.J(fc.objectId)!==fc.done}mVo(fc){this.IBa.Z(fc.objectId,fc.done);if(fc.done)if(this.eJ.Nmc(fc),this.Zi.Zm)this.eJ.$_c(fc,!0);else{var yc=new w.a(0,1,0,()=>{this.eJ.$_c(fc,!0,!1);this.jtd.remove(fc.id)},
139);this.jtd.add(fc.id,yc);u.AFrameworkApplication.nc.Vb(yc);this.Vy&&fc.id===(void 0===this.Vy.Cf||null===this.Vy.Cf?this.Vy.id:this.Vy.Cf)&&this.eJ.clearSelection()}else this.eJ.Nmc(fc),yc=null,({value:yc}=this.jtd.Dc(fc.id)).returnValue?(u.AFrameworkApplication.nc.Xe(yc),this.jtd.remove(fc.id)):this.eJ.$_c(fc,!1)}eWi(){this.xzm();this.vzm();u.AFrameworkApplication.K.$("IsDocumentOwner")||y.a.instance.Sa("Common.ISystemInitiatedFeedback").execute(fc=>{fc.logActivity("ShowTUIForCommentAwareness",
null)})}vzm(){this.Vg.eQb&&this.sri();this.Vg.eQb&&(this.kVa=this.q$k(),Qc.a.tSa(this.FYi))}xzm(){!this.Vg.iCb&&this.Vg.Yq&&Sb.a.tSa(this.E_c);this.eum();this.dum()}dum(){const fc=new Yf(this.Wvl),yc=Bb.App.Xj.zl;yc.Ze(39).Go(Object(ac.a)(fc,fc.uGh,"commentContainerPropertyChanged"));this.ld.isFeatureEnabled(115)&&yc.Ze(71).Go(Object(ac.a)(fc,fc.uGh,"commentContainerPropertyChanged"));$b.GraphTransactionManager.instance.nqa(fc,3)}z_(fc){for(let yc=0;yc<this.ah.length;yc++){const Uc=this.ah[yc];if(Uc.objectId===
fc)return Uc}return null}twk(fc){if(fc)for(const yc of fc)yc&&this.Epd.add(yc)}lZk(){this.Epd.clear()}hZe(fc,yc){Array.insert(this.ah,yc,fc);this.P3f(fc);this.P2m(fc);yc=this.lPd(fc);this.Epd.contains(yc)&&(fc.UEf=!0,this.Epd.remove(yc))}mKj(fc){Ed.p(fc)||fa.ULS.sendTraceTag(512278912,327,15,`Missing Start or End mapping info for Comment ${fc.objectId}`)}P2m(fc){fa.ULS.sendTraceTag(539800645,327,50,`Comment added to Model. ${Ed.a(fc)} `)}QGd(fc){40!==fc.We&&fa.ULS.sendTraceTag(594363294,327,15,"[CreateCommentForNode] Iterator is not at commentNode");
const yc=fc.currentNode;var Uc=yc.getValue(rc.a.k3b);const zd=yc.getValue(rc.a.xH),ie=yc.getValue(rc.a.$E).toString(),Oe=yc.getValue(rc.a.mHc);let Ge=null,re=null;if(yc.hasProperty(rc.a.vQ)){var mf=yc.getValue(rc.a.vQ);Ge=mf?sb.b(mf||""):null;He.a.lDh(Ge)}yc.hasProperty(rc.a.VCa)&&(re=yc.getValue(rc.a.VCa));let Xe=null,qf=null;yc.hasProperty(rc.a.OEd)&&yc.hasProperty(rc.a.lHc)&&(Xe=yc.getValue(rc.a.OEd),qf=yc.getValue(rc.a.lHc));mf=Ed.k(yc,x.a.nil).toString();const kf=Ed.h(yc,x.a.nil).toString(),
$f=yc.ia(rc.a.bba,!1),xf=yc.ia(rc.a.iM,null),Qg=yc.ia(rc.a.Fib,!1),zb=this.iEb(fc);Uc=new Q.Comment(this.Vg.qgb?ie:zd,zd,Uc,re||new Date(Oe),this.Vg.qgb?this.$fd.D8h(xf):xf,$f,zb,Q.Comment.L_i,Qg,qf,Xe,Ge);Uc.vEc=mf;Uc.uEc=kf;Uc.objectId=yc.id.toString();Uc.a0a=ie;this.Rnh(ie,zd);fc.jd(39);return Uc}Rnh(fc,yc){(!fc||Number.parseInvariant(fc)>=Dc.a.zNi)&&fa.ULS.sendTraceTag(544022547,327,10,`Durable Id is invalid ${fc}`);yc||fa.ULS.sendTraceTag(544022548,327,10,`Guard Id is invalid ${yc}`);try{this.$fd.ksk(fc,
yc)}catch(Uc){"DuplicateDurableId"===Uc.message?fa.ULS.sendTraceTag(544511521,327,10,`Duplicate Durable Id: ${fc} with Guard Id: ${yc}`):"DuplicateGuardId"===Uc.message?fa.ULS.sendTraceTag(544511522,327,10,`Duplicate GuardId: ${yc} with Durable Id: ${fc}`):fa.ULS.sendTraceTag(544022549,327,10,`Unkown Error when adding to CommentIds map: ${Uc}`)}}iEb(fc){var yc;if(40!==fc.We)return fa.ULS.sendTraceTag(594379426,327,15,"Trying to get text from node of type: {0}",fc.We),this.yqc.Njg([]);let Uc=fc.We+
":";const zd=fc.Mp();0<zd?(fc.Pd(),Uc+=fc.We+":"):(fa.ULS.sendTraceTag(509642946,327,15,`Comment has no paragraphs. ${null===(yc=fc.currentNode)||void 0===yc?void 0:yc.id}`),yc=new uf.a,yc.inStaging=!0,this.gK.logKpiFailure(Dd.a.n3b,"CommentContentNotFound",{isIntentional:!1,isInternal:!0},{name:Dd.a.REd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:yc},Lh.a));yc=Array(zd);for(let ie=0;ie<zd;ie++){fc.Pd();Uc+=fc.We+":";const Oe=fc.currentNode;Oe.nHb=!0;yc[ie]=Oe;Oe.pa||fa.ULS.sendTraceTag(594363293,
327,15,"[GetCommentText_Crash] "+Uc);!Oe.pa&&this.Vg.Aeo&&(u.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordSendErrorReportOnCommentInboundCrashSettings"),this.xp());fc.wc();fc.Lj();Uc+=ie<zd-1?":"+fc.We+":":":"}return this.yqc.Njg(yc)}xp(){if(rb.WoncaApp.Tle){var fc=new La.a(!0,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportTitle,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportDescription,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportPrivacyStatement);fc.Ad=
1;fc.Ee(1,WoncaIntl.WoncaStrings.l_SendErrorReport);fc.Ee(0,WoncaIntl.WoncaStrings.l_NoThanks);fc.$U(1);fc.nx(Wa.a.gaf,CommonUIStrings.l_DefaultDialogTitle,WoncaIntl.WoncaStrings.l_InboundingCommentFailed,this.znl,!1)}else this.G6.WC(Wa.a.gaf,this.REi)}lPd(fc){if(!fc||!fc.objectId)return"";fc=x.a.Ef(fc.objectId);fc=this.od.Db(fc);return this.Rpf(fc)}F8l(fc){return this.lPd(fc.Cf?this.MD(fc.Cf):fc)}gUn(fc,yc){if(this.ld.isFeatureEnabled(115))if(this.Vg.removePersonalInformation)fa.ULS.sendTraceTag(595128897,
3003,50,"RecordTaskChanges no ops because filter PII flag on"),this.SMb();else{this.xYa.Pv(ab.a.Qcg);var Uc=null===yc||void 0===yc?void 0:yc.taskId,zd=!Uc;zd?this.xYa.logKpiUsage(ud.a.Cle,0):this.xYa.logKpiUsage(ud.a.Dle,0);try{const mf=this.aXb.value,Xe=this.lPd(fc);if(""===Xe)this.w3d(zd,"FailedDurableIdForComment");else{var ie=this.F8l(fc);if(""===ie)this.w3d(zd,"FailedDurableIdForParentComment");else if(zd&&fc.lz.sessionType!==I.a.create&&fc.lz.sessionType!==I.a.reply)fa.ULS.sendTraceTag(42856725,
3003,10,"Unexpected create task for drafting session type [{0}]",fc.lz.sessionType),this.xYa.logKpiFailure(ud.a.Cle,"FailedTaskCreateInvalidSessionType");else{var Oe=null;fc.lz.sessionType!==I.a.metadata&&(Oe=Xe);var Ge=this.X4g.value;var re=M.a.jf(fc.text)?Ge.v3h(Oe,yc,zd):Ge.v3h(Oe,yc,zd,fc.text[0]);0<re.length?zd?(mf.xfb(Number.parseInvariant(ie),re)||this.xYa.logKpiFailure(ud.a.Cle,"TaskCreateFailed"),this.SMb()):(this.xYa.logKpiUsage(ud.a.Dle,0),mf.AEk(Uc,re)||this.xYa.logKpiFailure(ud.a.Dle,
"TaskEngagementFailed")):this.w3d(zd,"HistoryRecordsLengthZero")}}}catch(mf){this.w3d(zd,"RecordTaskChangesFailed")}}}w3d(fc,yc){const Uc={name:ud.a.KIo,isInternal:!0};fc?this.xYa.logKpiFailure(ud.a.Cle,yc,Uc):this.xYa.logKpiFailure(ud.a.Dle,yc,Uc)}hzd(fc,yc){if(fc){var Uc=u.AFrameworkApplication.userName,zd=yc.toString();fc.usersByReactionType||(fc.usersByReactionType={});var ie=fc.usersByReactionType[zd];Uc=new V(this.zY,this.l5a,Uc);Uc.DateUtc=new Date;ie?ie.push(Uc):fc.usersByReactionType[zd]=
[Uc];fa.ULS.sendTraceTag(572014993,327,50,"Reaction type {0} added to {1} with Object Id: {2} ",yc,fc.Cf?"reply":"parent",fc.objectId);zd=[fc];this.gK.Pv(xd.a.M2k,{succeeded:!0,customData:{reactionType:X[yc]}});this.U3c(zd,W.addReaction);this.twe.add(fc.id)}}Bde(fc,yc){if(fc&&fc.usersByReactionType){var Uc=fc.usersByReactionType[yc.toString()];if(Uc&&Uc.length){for(let zd=0;zd<Uc.length;zd++)if(Uc[zd].UserId===this.zY){Array.removeAt(Uc,zd);break}fa.ULS.sendTraceTag(572014994,327,50,"Reaction type {0} removed from {1} with Object Id: {2} ",
yc,fc.Cf?"reply":"parent",fc.objectId);Uc=[fc];this.gK.Pv(xd.a.O2k,{succeeded:!0,customData:{reactionType:X[yc]}});this.twe.delete(fc.id);this.U3c(Uc,W.removeReaction)}}}U3c(fc,yc){const Uc=this.Ic.Oc(15);Uc.Cb(this.ZIa);this.ix.jF.z7(3);switch(yc){case W.deleteComment:for(yc=0;yc<fc.length;yc++){var zd=fc[yc];if(zd.Xq===n.a.beingCreated)this.Vg.contentNavigationApiEnabled&&this.oAc.remove(zd.lz.draftId),this.eJ.Dmg();else{var ie=x.a.Ef(zd.objectId);(ie=this.od.Db(ie))&&Dc.a.yId(ie,this.od);fa.ULS.sendTraceTag(39364559,
327,50,`Deleting Comment: [CommentObjectId:${zd.objectId}]`);this.Vg.sua&&this.xE&&(zd.Cf?this.xE.fireEvent(10,{comment:zd,changeType:"replyDeleted"}):this.xE.fireEvent(7,{comment:zd}));this.Vg.contentNavigationApiEnabled&&this.oAc.remove(zd.id)}}break;case W.addComment:this.Yi.mode=1;fc=fc[0];fc.date=new Date;yc=this.Kcl(fc);zd=yc.getValue(rc.a.$E).toString();fc.a0a=zd;this.Vg.qgb&&this.wsc.set(zd,fc.id);zd=fc.text;ie=this.HOd();if(fc.Cf){var Oe=this.MD(fc.Cf),Ge=this.od.Db(x.a.Ef(Oe.objectId));
yc.setValue(rc.a.iM,Ge.getValue(rc.a.xH));this.addReply(yc,zd,this.od,ie,Ge);fa.ULS.sendTraceTag(39364560,327,50,`Adding Reply: [ObjectId:${fc.objectId}][ParentObjectId:${Oe.objectId}]`)}else(Oe=this.lb.gb.kb)&&Oe.Oa&&(xb.SelectionEditor.Sl(Oe)&&(Ge=xb.SelectionEditor.w_(Oe.Oa,!1))&&(this.lb.setSelection(Ge),Oe=Ge,fa.ULS.sendTraceTag(592569872,327,50,"[RecordChanges] Selection extended")),Ua.ParagraphReader.Wb(Oe.Oa.node)&&Ua.ParagraphReader.Wb(Oe.Pc.node)&&(this.jzb(yc,zd,ie,Oe),fa.ULS.sendTraceTag(39364561,
327,50,`Adding Comment: [ObjectId:${fc.objectId}]`)));zd=yc.ia(rc.a.xH,null);fc.uPa=zd;fc.SSa=N.a.sentToServer;fc.SSa=N.a.succeeded;fc.objectId=yc.id.toString();this.P3f(fc);this.mKj(fc);this.Rnh(fc.a0a,fc.uPa);this.Vg.sua&&this.xE&&(fc.Cf?this.xE.fireEvent(10,{comment:fc,changeType:"replyAdded"}):this.xE.fireEvent(11,{comment:fc}));break;case W.editComment:this.Yi.mode=1;fc=fc[0];yc=x.a.Ef(fc.objectId);yc=this.od.Db(yc);zd=fc.uPa;fc.uPa||(zd=yc.getValue(rc.a.xH),fa.ULS.sendTraceTag(554446870,327,
15,`Missing GuardID for Comment with objectId ${fc.objectId} while editing`),zd=this.Vg.qgb?zd:fc.id);this.xFj(yc,fc.text,zd);fa.ULS.sendTraceTag(39364562,327,50,`Editing Comment: [CommentObjectId:${fc.objectId}]`);fc.SSa=N.a.sentToServer;fc.SSa=N.a.succeeded;this.Vg.sua&&this.xE&&this.xE.fireEvent(10,{comment:fc,changeType:fc.Cf?"replyEdited":"edited"});break;case W.addReaction:case W.removeReaction:yc=fc[0];fc=x.a.Ef(yc.objectId);fc=this.od.Db(fc);(yc=(yc=yc.usersByReactionType)?sb.c(yc):"")&&fc.setValue(rc.a.vQ,
yc);break;case W.done:case W.undone:for(yc=0;yc<fc.length;yc++)zd=fc[yc],ie=x.a.Ef(zd.objectId),this.od.Db(ie).setValue(rc.a.bba,zd.done),fa.ULS.sendTraceTag(594124932,327,50,`${zd.done?"Resolved":"Re-opened"} Comment: [CommentObjectId:${zd.objectId}]`),this.Vg.sua&&this.xE&&this.xE.fireEvent(10,{comment:zd,changeType:zd.done?"resolved":"reopened"})}this.Im.kF();fa.ULS.sendTraceTag(572281361,327,50,"Disposing transaction, should raise context reload event");Uc.dispose()}HOd(){const fc=new Ea.GraphIterator;
fc.set(this.ix);this.XCa.u4a(fc);return fc}F6c(){return this.Cij(!0)}G6c(){return this.Cij(!1)}Cij(fc){if(!this.ah.length)return null;let yc=this.Vy;do{if(yc){const Uc=this.Vg.Yq&&!this.Zi.Zm;yc=fc?this.GXl(yc,Uc):this.HXl(yc,Uc)}else yc=fc?this.ah[0]:this.ah[this.ah.length-1];if(!yc)return null}while(yc.Cf&&""!==yc.Cf);this.selectComment(yc);return yc}eLh(fc,yc,Uc,zd,ie){const Oe=this.l_j.create(1074135127);this.Vg.removePersonalInformation&&(yc=CommonUIStrings.l_RemovedAuthorName,Uc=null);Oe.setValue(rc.a.commentId,
U.a.uF());Oe.setValue(rc.a.$E,Dc.a.Qpf());Oe.setValue(rc.a.CNa,u.AFrameworkApplication.userSessionId);Oe.setValue(rc.a.xH,fc);Oe.setValue(rc.a.k3b,yc);Oe.setValue(rc.a.OGh,yc);Oe.setValue(rc.a.mHc,Uc?Y.a.xNd(Uc,"MM/dd/yyyy HH:mm:ss",Y.a.dataCulture):"");Oe.setValue(rc.a.VCa,Uc);Oe.setValue(rc.a.bba,zd);ie&&(fc=ie?sb.c(ie):"",Oe.setValue(rc.a.vQ,fc));Oe.setValue(rc.a.lHc,this.zY);Oe.setValue(rc.a.OEd,this.l5a);return Oe}Kcl(fc){var yc;const Uc=this.eLh(fc.id,fc.author,fc.date,fc.done,null!==(yc=fc.usersByReactionType)&&
void 0!==yc?yc:{});fc.Cf&&(this.Vg.qgb?((yc=this.$fd.sZl(fc.Cf))||fa.ULS.sendTraceTag(555008772,327,10,`Missing guardId for Comment With Durable Id ${fc.Cf}`),fc=yc):fc=fc.Cf,Uc.setValue(rc.a.iM,fc));return Uc}addReply(fc,yc,Uc,zd,ie){this.addComment(fc,yc,zd);yc=Sf.gph(fc,Uc,ie,!0);Uc=Sf.gph(fc,Uc,ie,!1);yc&&Ed.v(fc,yc.Ib.paragraph.id);Uc&&(Ed.u(fc,Uc.Ib.paragraph.id),Uc.Ib.paragraph.id||fa.ULS.shipAssertTag(5564303,327,!1,"Comment node has no end anchor!"))}jzb(fc,yc,Uc,zd){this.addComment(fc,yc,
Uc);let ie,Oe;({start:yc,end:ie,startCp:Uc,endCp:Oe,Yuh:Ge}=this.hRk());Ge&&(zd.Oa.node===yc&&(Uc=pb.a.Chb(zd,!0)),zd.Pc.node===ie&&(Oe=pb.a.Chb(zd,!1)));if(-1===Uc||-1===Oe){this.B_g||0!==this.HUb||(this.gK.logKpiFailure(Dd.a.d9e,"DraftSelectionLost",{isInternal:!0},{name:Dd.a.m3b,isInternal:!0}),this.B_g=!0);yc=zd.Oa.node;Uc=pb.a.Chb(zd,!0);ie=zd.Pc.node;Oe=pb.a.Chb(zd,!1);if(2<zd.length){var Ge=[];for(let re=0;re<zd.length;re++)Ge.push(zd.J(re).node.id);this.Koh(fc,Ge)}fa.ULS.sendTraceTag(51233603,
327,50,"Intents invalid reason {0}",this.HUb)}else if(2<this.pZ.length){Ge=[];for(zd=0;zd<this.pZ.length;zd++)Ge.push(this.pZ[zd].Vfc);this.Koh(fc,Ge)}Dc.a.r0b(yc,fc.id,Uc,!0);Dc.a.r0b(ie,fc.id,Oe,!1);Ed.v(fc,yc.id);Ed.u(fc,ie.id);this.oEj();ie.id||fa.ULS.shipAssertTag(5564304,327,!1,"Comment node has no end anchor!")}Koh(fc,yc){if(!(2>=yc.length||!fc||Ed.s(fc))){this.Zi.HU.add(fc.id,new Ab.a(new dc.a));for(var Uc=x.a.eq(yc[0],yc[1])?2:1,zd=yc.length-2;Uc<=zd;Uc++){const ie=yc[Uc];this.Zi.Sx.mb(ie)?
this.Zi.Sx.J(ie).OM||(this.Zi.Sx.J(ie).OM=new Ab.a(new dc.a)):this.Zi.Sx.add(ie,new mc.a(!0));this.Zi.Sx.J(ie).T1a=!0;this.Zi.Sx.J(ie).OM.add(fc.id);this.Zi.HU.J(fc.id).add(ie)}}}hRk(){let fc=null,yc=-1,Uc=null;var zd=-1;let ie=!1;if(!this.pZ.length||2!==this.HUb)return{start:fc,end:Uc,startCp:yc,endCp:zd,Yuh:ie};fc=this.od.Db(this.pZ[0].Vfc);Uc=1===this.pZ.length?fc:this.od.Db(this.pZ[this.pZ.length-1].Vfc);if(Ua.ParagraphReader.Wb(fc)&&Ua.ParagraphReader.Wb(Uc)){zd=Ge=>3===Ge.type;let Oe=this.Jn.hPa(fc,
3,zd);yc=0<Oe.count?Oe.J(0).begin:-1;fc!==Uc&&(Oe=this.Jn.hPa(Uc,3,zd));zd=0<Oe.count?Oe.J(0).end:-1;-1===yc&&null!=fc&&(yc=fc.pa.first.cp,ie=!0,fa.ULS.sendTraceTag(524862562,327,50,"Draft Anchor startCp was adjusted"));-1===zd&&null!=Uc&&(zd=Uc.pa.last.cp,ie=!0,fa.ULS.sendTraceTag(524862563,327,50,"Draft Anchor endCp was adjusted"))}this.HUb=-1===yc||-1===zd?0:2;return{start:fc,end:Uc,startCp:yc,endCp:zd,Yuh:ie}}oEj(){for(const fc of this.pZ){const yc=this.od.Db(fc.Vfc);Ua.ParagraphReader.Wb(yc)&&
this.Jn.U7a(yc,3)}this.pZ=[];this.HUb=2}addComment(fc,yc,Uc){fc.anchor||(Uc.Af(fc,1),Uc.sj(fc),this.Skj(fc,yc,Uc))}Skj(fc,yc,Uc){let zd=0;var ie=null;yc=this.yqc.BLo(yc,Oe=>{const Ge=new Ob.a;Uc.Af(Ge,1);Uc.sj(Ge);Uc.Af(Oe,2);Uc.sj(Oe);Uc.wc();Uc.wc()});for(let Oe=0;Oe<yc.length;Oe++)ie=yc[Oe],zd=ie.getValue(rc.a.Lc),Sf.paragraphEditor.qUa(ie),Sf.fK&&Sf.fK.kNa&&Sf.fK.AHa(Qb.a.create(ie));fc.setValue(rc.a.xH,zd.toString());return ie}Cjb(fc,yc){return this.EGm(fc,yc)}Uqm(){return 0<this.pZ.length}BBb(fc,
yc,Uc){return fc.Oa&&Ua.ParagraphReader.Wb(fc.Oa.node)&&Ua.ParagraphReader.Wb(fc.Pc.node)?(yc=this.eLh(Ua.ParagraphReader.TQ(fc.Pc.node).toString(),yc?yc:u.AFrameworkApplication.userName,new Date,!1,{}),Uc||(Uc=new E.a,Uc.iha("\n")),this.jzb(yc,[Uc.gOc()],this.HOd(),fc),yc):null}us(fc){return!this.$Xe.Ldg(this.SNc(fc.getValue(rc.a.$E)))}xFj(fc,yc,Uc){const zd=new Ea.GraphIterator;for(zd.set(fc);zd.Pd();)zd.xg();this.Skj(fc,yc,zd).$g(rc.a.Lc,Number.parseInvariant(Uc));fc.setValue(rc.a.xH,Uc);if(yc=
this.z_(fc.id.toString()))yc.GIh=!1;fc.setValue(rc.a.Fib,!1)}wFj(fc,yc){this.xFj(fc,[Sys.Serialization.JavaScriptSerializer.serialize(yc)],fc.getValue(rc.a.xH))}EG(fc){fc=this.od.Db(x.a.Ef(fc));return!!fc&&fc.ia(rc.a.EG,!1)}f2i(fc){fc=this.od.Db(x.a.Ef(fc));return!!fc&&fc.ia(rc.a.oIh,!1)}qIm(fc){const yc=Ed.j();return fc&&yc.has(fc.objectId)}yOm(fc){const yc=this.od.Db(x.a.Ef(fc));return yc?this.kbc(yc):(fa.ULS.sendTraceTag(562562755,341,15,"CommentNode is null, commentObjectId: "+fc),!1)}kbc(fc){var yc=
fc.id,Uc=Ed.k(fc),zd=Ed.h(fc);if(!x.a.eq(Uc,zd))return!1;Uc=fc.Kc.Db(Uc);if(!Uc)return!1;zd=({DGc:fc}=this.lIc(Uc,yc,!0)).returnValue;var ie=({DGc:yc}=this.lIc(Uc,yc,!1)).returnValue;if(-1===zd||-1===ie)return!1;Uc=Uc.pa;zd=Uc.J(fc);ie=Uc.J(yc);if(!zd.hyperlink||!zd.hyperlink.DG||!ie.Om)return!1;for(fc+=1;fc<yc;fc++)if(zd=Uc.J(fc),zd.hyperlink||zd.Om)return!1;return!0}VQc(){return Sf.drm(this.ah,fc=>this.EG(fc),fc=>this.f2i(fc))}lIc(fc,yc,Uc){let zd;for(zd=0;zd<fc.pa.length;zd++){const ie=fc.pa.J(zd);
if(ie.rf)for(let Oe=0;Oe<ie.rf.length;Oe++){const Ge=ie.rf.J(Oe);if(Ge.ak.equals(yc)&&Ge.Mc===Uc)return{returnValue:ie.cp,DGc:zd}}}return{returnValue:-1,DGc:zd}}QQh(fc){if(this.Zi.HU.mb(fc)){const yc=new Pa.a;for(const Uc of this.Zi.HU.J(fc))this.r_n(Uc,fc,yc);this.Zi.HU.remove(fc);Ta.b(yc)}}moe(fc,yc){if(fc.objectId){fc=x.a.Ef(fc.objectId);var Uc=this.od.Db(fc);if(Uc){var zd=Ed.k(Uc,x.a.nil);Uc=Ed.h(Uc,x.a.nil);zd.equals(x.a.nil)||yc.add(this.od.Db(zd));Uc.equals(x.a.nil)||yc.add(this.od.Db(Uc));
if(this.Zi.HU.mb(fc))for(const ie of this.Zi.HU.J(fc))yc.add(this.od.Db(ie))}}}r_n(fc,yc,Uc){let zd;({value:zd}=this.Zi.Sx.Dc(fc,zd));zd&&(zd.OM.remove(yc),zd.OM.count||(zd.T1a=!1,Uc.add(this.od.Db(fc))))}static get paragraphEditor(){return null!=Sf.EFg?Sf.EFg:Sf.EFg=y.a.instance.resolve("Box4.IParagraphEditor")}static getInstance(){return Sf.Rl()}static Rl(){if(Sf._instance)return Sf._instance;const fc=new ba.a(()=>(new eb(!0,!0,!0)).r$k()),yc=y.a.instance;Sf._instance=new Sf(new ba.a(()=>Bb.App.xa.ib.Uc),
new ba.a(()=>Bb.App.xa.ib.rc.Yc),new ba.a(()=>Fd.a.instance),new Vb.a,new kc,new ba.a(()=>Fb.a.instance),yc.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),yc.resolve("WordEditor.Comments.ICommentFormatTranslator"),yc.resolve("Common.IAppSettingsManager"),yc.resolve("Box4.IFeatureHelper"),yc.resolve("Box4.Intent.IIntentRangeEditor"),new ba.a(()=>Bb.App.iV),yc.resolve("Box4.IKickoutExecutor"),yc.Ue("WordEditor.Tasks.ITaskActor"),fc,yc.resolve("WordEditor.Comments.CommentsSettings"),
yc.resolve("Box4.IUndoManager"),yc.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),yc.resolve("WordEditor.Comments.CommentsState"),yc.resolve("WordEditor.Comments.WordCommentEventsActor"),yc.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),yc.resolve("WordEditor.Comments.ITasksUsageAndHealthLogger"),yc.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentModel"),Bb.App.Xj.zl.Ze(12),yc.resolve("Box4.ParagraphRenderEvents"),yc.resolve("Box4.CatchUpActivity.IChangeIdEditor"),
yc.Sa("WordEditor.Extension.RichApiEventManager"));return Sf._instance}static gph(fc,yc,Uc,zd){yc=Dc.a.Eba(Uc,yc,zd);if(!yc)return null;yc=yc.Ib.rf;return Dc.a.gzd(fc.id,yc,yc.J(0).ev,zd)}EGm(fc,yc){if(Bb.App.lostSession||(yc?!Bb.App.us:!Bb.App.us&&!Bb.App.vm)||1===fc.mode||!Object(bb.a)(Lb.PageView,ob.InteractiveViewManager.instance.Bd))return!1;fc=this.sNl();return!fc||Xb.a.instance.k_(fc)||Xb.a.instance.uha(fc)||fc.contextId===Xa.a.anchoredObject||Pb.a.EDf(fc)&&Pb.a.Jac()?!1:!0}sNl(){const fc=
ob.InteractiveViewManager.instance.Bd;var yc=fc.lb.tg;this.sIm()&&this.ry&&ub.n(yc.node)&&(yc=Ea.GraphIterator.$a(yc.node),yc.zb(12),yc=yc.Xn(12),yc=vb.SelectionFactory.Cma(yc),fc.lb.setSelection(yc),yc=fc.lb.tg);return yc}sIm(){var fc;return null===(fc=this.Fa)||void 0===fc?void 0:fc.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCommentInLoopsBugFixEnabled",!1)}static drm(fc,yc,Uc){const zd=new Pa.a,ie=new Pa.a,Oe=new lc.a,Ge=new lc.a;for(const Xe of fc){var re=Xe.id,mf=Xe.objectId;fc=Xe.done;
const qf=!!mf&&yc(mf);re&&(fc&&zd.add(re),qf&&ie.add(re),mf&&Oe.Z(re,mf));if(re=Xe.Cf)({value:mf}=Ge.Dc(re,0)).returnValue||(mf=0),Ge.Z(re,mf+1);if(!re&&!fc&&!qf)return!0}for(const Xe of ie){if(zd.contains(Xe))continue;let qf;if(({value:qf}=Oe.Dc(Xe,qf)).returnValue&&Uc(qf))return!0;let kf;if(({value:kf}=Ge.Dc(Xe,0)).returnValue&&0<kf)return!0}return!1}DRl(fc){const yc=[];let Uc=this.ah.findIndex(zd=>zd.id===fc);if(-1<Uc)for(yc.push(this.ah[Uc]);++Uc<this.ah.length&&this.ah[Uc].Cf===fc;)yc.push(this.ah[Uc]);
return yc}SVl(fc){return this.$fd.D8h(fc)}}Sf._instance=null;Sf.fK=null;Object(l.a)(Sf,"EditorCommentModel",f.a,[652,653,654])},1764:function(F,K,c){F=c(0);var l=c(397),f=c(140),a=c(44),k=c(302),x=c(3),y=c(7),n=c(15),u=c(1627),z=c(1583);class w{constructor(aa,fa,na=!1){this.paragraphNode=aa;this.role=fa;this.duj=na}}Object(F.a)(w,"DesignerReviewActionData",null,[]);class E{constructor(aa,fa,na){this.paragraphNode=aa;this.Gq=fa;this.role=na}}Object(F.a)(E,"TriageActionData",null,[]);class G extends E{constructor(aa,
fa){super(aa,0,fa)}}Object(F.a)(G,"RoleTriageActionData",E,[]);class H extends E{constructor(aa,fa,na){super(aa,1,27);this.styleId=fa;this.jX=na}}Object(F.a)(H,"PullQuoteTriageActionData",E,[]);class L extends E{constructor(aa,fa){super(aa,2,28);this.doa=fa}}Object(F.a)(L,"ImageTriageActionData",E,[]);class I{constructor(aa,fa){this.paragraphNode=aa;this.yIb=fa}}Object(F.a)(I,"ViewOriginalActionData",null,[]);var N=c(134),Q=c(1524),M=c(1699);class J{constructor(aa,fa){this.currentNode=aa;this.nextNode=
fa}}Object(F.a)(J,"ReviewNavigationArgs",null,[]);class V{constructor(aa,fa){this.paragraphNode=aa;this.isVisible=fa}}Object(F.a)(V,"ReviewVisibilityArgs",null,[]);class X{constructor(aa){this.$ik=aa}getSelectedOption(){return this.$ik}getSeparatorIndexes(){return[1]}}Object(F.a)(X,"DesignerPreviewData",null,[]);var W=c(501),U=c(935),Y=c(1700);c.d(K,"a",function(){return ba});class ba extends U.a{constructor(aa,fa,na,oa,ja,qa,Ia,Va,Na,za,la,va){super();this.pc=aa;this.Xd=fa;this.PId=na;this.uwa=oa;
this.$i=ja;this.WB=qa;this.CBj=Ia;this.Wl=Va;this.Iv=Na;this.QId=za;this.ys=la;this.Kmf=va;this.ddb=null;this.Led=void 0;this.Twe=0;this.qH=[W.a.lRh]}get types(){return this.qH}get Sij(){return Box4Intl.Box4Strings.l_ShowDesignerReviewTooltipSelectOrPress}get pae(){return 0}Yuo(aa){return 3!==aa.suggestion.Gq&&!this.Iv.isVisible&&(!this.Twe||!aa.Fzb&&1===this.Twe)}lN(aa){var fa;if(!aa.source||l.SessionStatusManager.instance.Gj)return!1;const na=aa.ml;var oa=this.uwa.ROc(na,1);if(!oa||!oa.count)return!1;
const ja=oa.J(0).intent;if(aa.rkc)return.5!=(null===ja||void 0===ja?void 0:ja.state)&&4!=(null===ja||void 0===ja?void 0:ja.state);const qa=na.node;if(0==(null===ja||void 0===ja?void 0:ja.state)&&(2==(null===ja||void 0===ja?void 0:ja.suggestion.Gq)||1==(null===ja||void 0===ja?void 0:ja.suggestion.Gq)))return ja.Fzb(),this.uwa.U7a(qa,1),this.WB.G6i(new M.a(qa,1)),!0;if(1==aa.source&&27==(null===ja||void 0===ja?void 0:ja.gjb)&&(.5==(null===ja||void 0===ja?void 0:ja.state)||4==(null===ja||void 0===ja?
void 0:ja.state)))return!1;oa=this.Iv.isVisible?this.PId.Uml(qa):new Y.a(0,1);let Ia;const Va=this.U0l(null===(fa=null===ja||void 0===ja?void 0:ja.suggestion)||void 0===fa?void 0:fa.Gq);fa=this.Qi.fja(na,{id:"Intent-"+W.a.lRh,suggestionGroups:[{type:Va,id:Va,title:ja.description,snippet:this.rHn(this.$i.plainText(na.node)),snippetFormatting:[],supportedActions:this.tof(null===ja||void 0===ja?void 0:ja.suggestion,!0),suggestions:({Mdo:Ia}=this.SNh(qa)).returnValue,previewData:Ia?new X(Ia):null,isContentPending:!1}],
setSize:oa.count,positionInSet:oa.index},this,aa.MQa,!1,()=>{var Na;this.WB.H6i(new V(qa,!0));this.Iv.isVisible||3===(null===(Na=null===ja||void 0===ja?void 0:ja.suggestion)||void 0===Na?void 0:Na.Gq)||this.Twe++},()=>{this.WB.H6i(new V(qa,!1))},null,!1,Na=>{Na.showDesignerButton=!this.Iv.isVisible;Na.shouldSkipTwoStepReview=!0;Na.isFormattingSuggestion=0==ja.suggestion.Gq;Na.isMultiParagraphSuggestion=1<ja.aO.length;Na.proactivePromptHintType=this.Yuo(ja)?k.e.HideFromReviewCardAndRibbon:k.e.None});
a.c(n.a.yxn,fa,void 0,void 0,30);return fa}executeAction(aa,fa){var na,oa,ja,qa,Ia;if(!aa||!fa)return!1;const Va=this.Wl.BA(fa);y.ULS.sendTraceTag(541446529,3016,50,"Action: {0}; Role: {1}; Pane: {2};",aa.actionType,null===Va||void 0===Va?void 0:Va.role,this.Iv.isVisible);const Na=this.QId.cU(fa);try{switch(aa.actionType){case k.b.Accepted:const za=this.pc.Qb(n.a.Cyd,2,new w(fa,null===Va||void 0===Va?void 0:Va.role,!0));this.Tmg(Ma=>{Ma.supportedActions=this.tof(null===Na||void 0===Na?void 0:Na.suggestion,
!1)});return this.Iv.isVisible&&32===za?this.AQf(fa):32===za;case k.b.Rejected:const la=this.pc.Qb(n.a.ode,2,new w(fa,null===Va||void 0===Va?void 0:Va.role,!0));2===(null===Na||void 0===Na?void 0:Na.suggestion.Gq)||Object(Q.e)(null===Na||void 0===Na?void 0:Na.suggestion)||this.lbd(fa,!1);2===(null===Na||void 0===Na?void 0:Na.suggestion.Gq)&&this.Qi.dismiss();return this.Iv.isVisible&&32===la?this.AQf(fa):32===la;case k.b.Next:case k.b.Previous:return!this.Iv.isVisible||this.AQf(fa,aa.actionType===
k.b.Previous);case k.b.Apply:const va=null===(na=aa.suggestion)||void 0===na?void 0:na.contentData;let ia;switch(null===va||void 0===va?void 0:va.Gq){case 0:ia=new G(fa,va.role);break;case 1:case 3:const Ma=va.s5a;y.ULS.sendTraceTag(541446530,3016,50,"Changing PullQuote style: {0}",{["suggestionId"]:null===(oa=null===Na||void 0===Na?void 0:Na.suggestion)||void 0===oa?void 0:oa.id,["newStyleId"]:Ma});Na.suggestion.s5a=Ma;ia=new H(fa,Ma,f.a.create());break;case 2:ia=new L(fa,va.doa);break;default:return y.ULS.shipAssertTag(527459665,
3016,!1,String.format("DesignerSuggestionType: {0}",va.Gq)),!1}this.Qi.focus();const pa=this.pc.Qb(n.a.changeDesignerRole,2,ia);this.lbd(fa,!1);return 32===pa;case k.b.AcceptAll:return 32===this.pc.Qb(x.a.ydb,2,new u.a(2));case k.b.RejectAll:return 32===this.pc.processAction(n.a.o4c,2);case k.b.SnoozeAll:return 32===this.pc.processAction(n.a.designerSnoozeContextualSuggestions,2);case k.b.Undo:const sa=this.pc.Qb(n.a.FIa,2,new w(fa,null===Va||void 0===Va?void 0:Va.role));this.lbd(fa,!0);return 32===
sa;case k.b.OpenDesignerPane:return 32===this.pc.Qb(n.a.mIa,2,new z.a(6));case k.b.ViewOriginal:const Ha={yIb:aa.descriptorData.isViewingOriginal,hbg:aa.descriptorData.setIsViewingOriginal};if(void 0==(null===Ha||void 0===Ha?void 0:Ha.yIb)||void 0==(null===Ha||void 0===Ha?void 0:Ha.hbg))return y.ULS.shipAssertTag(538789889,3016,!1,String.format("isViewingOriginal: {0}; setIsViewingOriginal: {1}",null===Ha||void 0===Ha?void 0:Ha.yIb,null===Ha||void 0===Ha?void 0:Ha.hbg)),!1;this.Qi.focus();const ra=
this.pc.Qb(n.a.Cef,2,new I(fa,Ha.yIb));Ha.hbg(!Ha.yIb);this.lbd(fa,!0);return 32===ra;case k.b.GiveFeedback:switch(null===(ja=null===Na||void 0===Na?void 0:Na.suggestion)||void 0===ja?void 0:ja.Gq){case 0:return this.ys.invokeUserFeedback(N.a.rUj),!0;case 1:case 3:return this.ys.invokeUserFeedback(N.a.xUj),!0;case 2:return this.ys.invokeUserFeedback(N.a.tUj),!0;default:return y.ULS.shipAssertTag(537658138,3016,!1,String.format("DesignerSuggestionType: {0}",null===(qa=null===Na||void 0===Na?void 0:
Na.suggestion)||void 0===qa?void 0:qa.Gq)),!1}case k.b.ShowMore:switch(null===(Ia=null===Na||void 0===Na?void 0:Na.suggestion)||void 0===Ia?void 0:Ia.Gq){case 2:y.ULS.sendTraceTag(527210449,3016,50,"User clicked show more images"),Na.suggestion.mxm(),this.lbd(fa,!0,!0)}return!0;default:return!1}}catch(za){return y.ULS.shipAssertTag(572027277,3016,!1,String.format("{0} {1}",za.message,za.stack)),!1}}AQf(aa,fa=!1){const na=this.PId.p8b(aa,fa)||this.PId.p8b(aa,!fa);this.WB.bPn(new J(aa,na,!fa));return!na||
this.PId.FQi(this,na)}PYl(aa){switch(aa.Gq){case 0:case 1:case 3:return{...k.h,font:aa.font,cssColor:aa.color,fontSize:aa.fontSize,fontWeight:aa.bold?k.d.Bold:k.d.Normal,italic:aa.italic,underlineType:aa.underline?k.f.Single:k.f.None,backgroundImg:aa.backgroundImg};case 2:break;default:y.ULS.shipAssertTag(527569927,3016,!1,`${aa.Gq}`)}}Q_l(aa){if(2===aa.Gq)return{src:aa.imageUrl,width:0,height:0,imageAltText:aa.altText}}SNh(aa){var fa=null;let na=null;if(this.ddb=this.CBj.H6l(aa)){na=Array(this.ddb.options.length);
for(aa=0;aa<this.ddb.options.length;aa++)fa=this.ddb.options[aa],na[aa]={type:"DesignerTriageItem",id:String.format("DesignerTriageItem {0}",aa),title:fa.title,supportedActions:[k.b.Apply],contentData:fa,image:this.Q_l(fa),titleFormatting:[this.PYl(fa)]};fa=(null===na||void 0===na?0:na.length)?na[this.ddb.selectedIndex]:void 0}return{returnValue:na,Mdo:fa}}Tmg(aa){this.Qi.definition?this.Qi.definition.suggestionGroups?1===this.Qi.definition.suggestionGroups.length&&(aa(this.Qi.definition.suggestionGroups[0]),
this.Qi.definition=this.Qi.definition):y.ULS.sendTraceTag(512274571,3016,50,"UXManger.definition.suggestionGroups is null"):y.ULS.sendTraceTag(512274572,3016,50,"UXManger.definition is null")}lbd(aa,fa,na=!1){const oa=this.QId.cU(aa);this.Tmg(ja=>{ja.supportedActions=this.tof(null===oa||void 0===oa?void 0:oa.suggestion,fa);if(this.ddb){if(na){var qa=this.SNh(aa).returnValue;ja.suggestions=qa}qa=this.CBj.ncm(this.ddb.options,aa);ja.previewData=new X(ja.suggestions[qa])}})}tof(aa,fa){const na=[];fa?
(na.push(k.b.Accepted),na.push(k.b.Rejected),0==(null===aa||void 0===aa?void 0:aa.Gq)&&na.push(k.b.ViewOriginal)):(na.push(k.b.Next),na.push(k.b.Undo));this.Iv.isVisible||(this.Xd.XIm()&&this.xHk(oa=>{oa&&this.Tmg(ja=>ja.supportedActions.push(k.b.GiveFeedback))})&&na.push(k.b.GiveFeedback),this.Xd.IJm()&&na.push(k.b.OpenDesignerPane),na.push(k.b.SnoozeAll));0===(null===aa||void 0===aa?void 0:aa.Gq)&&na.push(k.b.AcceptAll);na.push(k.b.RejectAll);(null===aa||void 0===aa?0:aa.gni())&&na.push(k.b.ShowMore);
return na}rHn(aa){const fa=aa.split(" ",10);return 10>fa.length?aa:fa.join(" ")+"\u2026"}static OJm(aa){return aa===W.a.mRh||aa===W.a.nRh||aa===W.a.rRh}U0l(aa){return 2===aa?W.a.nRh:1===aa||3===aa?W.a.rRh:W.a.mRh}xHk(aa){void 0===this.Led&&this.Kmf.execute(async fa=>{this.Led=await fa.isFeatureEnabled(N.a.tQi,!1);aa(this.Led)});return!!this.Led}}Object(F.a)(ba,"DesignerIntentProvider",U.a,[])},1772:function(F,K,c){F=c(0);var l=c(2),f=c(2049),a=c(397),k=c(178),x=c(80),y=c(310),n=c(9),u=c(587),z=c(7),
w=c(566),E=c(1720);class G{constructor(X,W){this.pik=X;this.qik=W}}Object(F.a)(G,"LastSavedToHostDetailsEventArgs",null,[1304]);class H{constructor(X,W,U,Y,ba,aa){this.snk=5E4;this.AVe=0;this.dbb=new Date(Date.UTC(0,1,1,0,0));this.D0j=6E4;this.XYb=this.WWb=0;this.ra=new x.a;this.sfo=()=>{z.ULS.sendTraceTag(509372108,3037,50,"Running LastSavedToHostDetailsManager task.  Run count: {0}",this.XYb++);this.$e.zo||this.Y6b().then(fa=>{this.ra.raiseEvent(H.wFi,fa);this.E4g=new Date;fa=this.YZb;this.kl&&
!this.kl.isVisible&&(fa=this.Plk);this.hza(fa)}).catch(fa=>{this.hza(this.Wgm(fa))})};this.dvd=X;this.$e=U;this.C2=ba;this.Bv=aa;this.YZb=W.mc("LastSavedToHostDetailsIntervalMs",6E4);this.ttb=W.mc("LastSavedToHostDetailsFailureIntervalMs",5E3);this.Plk=W.mc("LastSavedToHostDetailsSuccessIntervalOnHidden",this.YZb);this.XRe=W.mc("LastSavedToHostDetailsSentTimeoutMs",12E4);this.E4g=new Date;Y.execute(fa=>{this.kl=fa;this.kl.gZa((na,oa)=>{this.HX(oa)})});0==l.AFrameworkApplication.Lg.RunawayDatalossSystemStartedAt&&
l.AFrameworkApplication.Lg.qNi();this.hza(this.YZb)}HX(X){0!==X.newState&&1!==X.newState||0===X.oldState||1===X.oldState||this.$e.zo||(this.hza(this.AVe),z.ULS.sendTraceTag(521412808,3037,50,"LastSavedToHostDetails Pending since {0}, The next tick of LastSavedToHostDetails will be in {1} ms",this.E4g,this.AVe))}qQa(){return this.Ito?1==this.$e.networkState:1==this.$e.networkState||3==this.$e.networkState}Y6b(){this.dbb=new Date;return new Promise((X,W)=>{if(this.qQa())z.ULS.sendTraceTag(525214230,
3037,15,"Network is offline. Not Attempting to send request."),W(0);else if(this.$e.kca)z.ULS.sendTraceTag(524154146,3037,15,"Waiting for token to refresh. Not attempting to send request."),W(2);else if(this.Bv.gR)z.ULS.sendTraceTag(509641685,3037,50,"Session is up to date. Not attempting to send request."),W(3);else{var U=u.b(E.a.construct(this.d9b()));z.ULS.sendTraceTag(524154147,3037,50,"Sending LastSavedToHostDetails Request");var Y=0;Y=this.dvd.xj(H.serviceUrl,2,U,{"Content-Type":"application/json; charset=utf-8"},
!1,0,ba=>this.zYm(ba,X,W),ba=>this.AYm(ba,W),null,null,!0,this.XRe);0>=Y&&(z.ULS.sendTraceTag(525214231,3037,15,"Invalid request id returned "+Y.toString()),W(0))}})}AYm(X,W){let U=2;if(X=X.data){if(5===X.status)U=1;else if(7===X.status||13===X.status)U=this.oso?0:1;z.ULS.sendTraceTag(525214232,3037,15,String.format("Request Failed with status {0}. Failed getting LastSavedToHostDetails",X.status))}else z.ULS.sendTraceTag(525214233,3037,15,"Failed to get LastSavedToHostDetails");W(U)}zYm(X,W,U){if(X=
X.data){var Y={},ba=X.Bj?X.Bj[y.a.N7]:"";Y.HttpStatus=X.Qe;Y.Correlation=ba;Y.Id=X.id;z.ULS.sendTraceTag(525214235,3037,50,"LastSavedRevisionID Response Summary: {0}",Y);(X=this.Vua(X.ve))?(this.C2.mUa(X),W(new G(X.LastSavedRevisionId,X.RevisionSequenceNumber))):(z.ULS.sendTraceTag(525214237,3037,15,"Deserialized response is null"),U(2))}else z.ULS.sendTraceTag(525214234,3037,15,"Request succeeded with null item."),U(2)}hza(X){0!==this.WWb&&window.clearTimeout(this.WWb);this.WWb=window.setTimeout(this.sfo,
X);z.ULS.sendTraceTag(525100416,3037,50,"LastSavedToHostDetails request queued with timeout "+X)}d9b(){const X=n.App.xa.ib.rc;return X?X.Yc:null}Wgm(X){return 1===X?this.AVe:0===X?this.snk:3===X?this.YZb:this.ttb}Vua(X){let W;return({group:W}=w.a.q1(X)).returnValue?W.Responses[0]:null}cAk(X){this.ra.addHandler(H.wFi,X)}async g2h(){const X=new Promise((W,U)=>{window.setTimeout(U,3E3)});await Promise.race([X,this.Y6b()]).then(()=>{z.ULS.sendTraceTag(509100305,3038,50,"LSTHDM ran Synchronously: Success")}).catch(()=>
{z.ULS.sendTraceTag(509100304,3038,15,"LSTHDM ran Synchronously: Failure")})}fwj(){0!==this.WWb&&(z.ULS.sendTraceTag(509215702,3037,50,"LastSavedToHostDetails Stopped"),window.clearTimeout(this.WWb),this.WWb=0)}rvj(X){z.ULS.sendTraceTag(509686350,3037,50,"LastSavedToHostDetails started with interval {0}",X);this.hza(X)}get Rcc(){return this.dbb.getTime()}get EOh(){return this.D0j}xA(){const X={};X.LastScanTime=this.dbb.toISOString();X.RunCounter=this.XYb;return X}get oso(){return null!=this.IGg?this.IGg:
this.IGg=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldDelayOnTimeout",!1):!1}get Ito(){return null!=this.OGg?this.OGg:this.OGg=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotCheckAppNetworkStatusTimeout",!1):!1}}H.wFi="ULSTHD";H.serviceUrl=n.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedToHostDetailsRequest";Object(F.a)(H,"LastSavedToHostDetailsManager",null,[1285,1270]);
var L=c(250),I=c(2080),N=c(12),Q=c(15);class M{constructor(X,W,U){this.Lrm=X;this.rya=W;this.yYm=U;this.RYf=()=>{const Y=this.Lrm();return 32!==Y?Y:!this.rya||this.rya.gR?32:8};this.PXo=(Y,ba,aa,fa,na)=>{this.yYm.hza(parseInt(na.toString()));return 32}}Tb(X){X.qa(Q.a.RYf,N.a.view,this.RYf);X.qa(Q.a.XFj,N.a.view,this.PXo);X.Vc(Q.a.XFj,101)}}Object(F.a)(M,"LastSavedToHostDetailsManagerActor",null,[]);var J=c(218);c.d(K,"a",function(){return V});class V{constructor(){this.W=null}get name(){return"WordEditor.LastSavedToHost"}xc(X){const W=
l.AFrameworkApplication.K;this.W=X;const U=new f.a(l.AFrameworkApplication.userSessionId,l.AFrameworkApplication.Ne.SY,l.AFrameworkApplication.Ne.dQh);this.W.ha("WordEditor.ILastSavedToHostDetailsManager",()=>new H(U,W,this.W.Na("Common.ISessionStatus")||a.SessionStatusManager.instance,this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"),L.a.instance,this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"))).singleInstance();this.O4f()}init(){(new M(()=>J.WoncaApp.DF.nni(),this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"),
this.W.resolve("WordEditor.ILastSavedToHostDetailsManager"))).Tb(l.AFrameworkApplication.va);this.W.resolve("WordEditor.ILastSavedToHostDetailsManager");this.W.resolve("WordEditor.LastSavedToHostDetailsManagerWatchDog")}dispose(){}static main(){k.a.instance.Fc(new V)}O4f(){this.W.ha("WordEditor.LastSavedToHostDetailsManagerWatchDog",()=>new I.a(this.W.resolve("WordEditor.ILastSavedToHostDetailsManager"),l.AFrameworkApplication.K.mc("LastSavedToHostDetailsIntervalMs",6E4),l.AFrameworkApplication.K.mc("TimerBasedWatchDogGracePeriodInMs",
18E4))).singleInstance()}}Object(F.a)(V,"LastSavedToHostDetailsPackage",null,[1,2])},1773:function(F,K,c){F=c(0);var l=c(499),f=c(458),a=c(11),k=c(1478),x=c(2041),y=c(349),n=c(7),u=c(111),z=c(1535);class w{constructor(I,N,Q){this.isVisible=I;this.elements=N;this.content=Q}}Object(F.a)(w,"TooltipVisibilityArgs",null,[]);var E;(function(I){I[I.consistency=0]="consistency";I[I.wmp=1]="pullQuote";I[I.Vop=2]="suggestedImage";I[I.xmp=3]="pullQuoteMenu";I[I.Ofp=4]="designerPaste"})(E||(E={}));Object(F.b)("DesignerSuggestionType",
E);var G=c(134),H=c(1701);c.d(K,"a",function(){return L});class L extends k.a{constructor(I,N,Q,M,J,V,X,W){super();this.Nm=I;this.Hu=N;this.b_k=Q;this.BPi=M;this.$i=J;this.WB=V;this.YH=X;this.rc=W;this.iua=this.QEa=null;this.onMouseEnter=U=>{U=U.Ro;this.WB.$6i(new w(!0,[U.sFc],U.oMo));if(U.Yr&&0<U.Yr.length){const Y=this.YH.cU(U.Yr[0]);Y&&Y.suggestion.x4m()}return this.Vlj(U)};this.tpa=U=>{this.WB.$6i(new w(!1));return this.yEh(U.Ro)};this.oGa=U=>{if(L.q3a(U.Ro,this.iua))return!0;this.WB.cPn(z.a.create(U.Ro.Yr[0]));
return!0};this.UVf=(U,Y)=>{Y.data?Y.data.isVisible?this.Rho(Y.data.paragraphNode):this.LYk():n.ULS.shipAssertTag(573850384,3016,!1)};this.WB.X_e(this.UVf)}jko(I){I?(I=this.Rqf(I))&&this.Vlj(I):n.ULS.shipAssertTag(589693324,3016,!1)}aZk(){this.yEh(this.QEa)}Tob(I){I=this.$i.Vk(I.Bb);return!!I&&this.YH.SVc(I)}sfb(I){const N=I.veb(0,G.a.ELk,this.zoom),Q=[];Q.push(this.lDa(I.O4,N,I.snc[0].y-I.bca[0].y));return Q}lDa(I,N,Q){var M,J=I.fh.ownerDocument;const V=l.a.createElement(J,f.a.div);V.className=G.a.zLk;
V.style.left=N+"px";V.style.top=Q+"px";N=l.a.createElement(J,f.a.div);N.className=G.a.CLk;J=l.a.createElement(J,f.a.div);J.className=G.a.ALk;I=this.$i.Vk(I.Bb);Q=this.YH.cU(I);if(null===(M=null===Q||void 0===Q?void 0:Q.suggestion)||void 0===M?0:M.Gq)J.className+=String.format(" {0}",E[Q.suggestion.Gq]);N.appendChild(J);V.appendChild(N);V.id=L.l5h(I);M=this.Rqf(I,V);1==M.FLk&&(J.className+=String.format(" {0}",G.a.BLk));this.iua&&this.iua.Yr.includes(I)?(V.className+=String.format(" {0}",G.a.$3e),
this.iua=M):this.QEa&&this.QEa.Yr.includes(I)&&(V.className+=String.format(" {0}",G.a.Z3e),this.QEa=M);this.BPi(a.a.rR,V,this.onMouseEnter,M);this.BPi(a.a.jL,V,this.tpa,M);this.b_k(a.a.click,V,this.oGa,M);return V}Rho(I){if(I){var N=this.Rqf(I);N?(this.YH.cU(I)&&(I=Object.assign(new x.a,{action:0,type:3,FA:N,LJ:this.iua}),this.Hu.zF(I)),this.iua=N,L.q3a(this.QEa,this.iua)&&(this.QEa=null)):n.ULS.shipAssertTag(590112344,3016,!1)}else n.ULS.shipAssertTag(590112343,3016,!1)}LYk(){if(this.iua){var I=
Object.assign(new x.a,{action:1,type:3,FA:null,LJ:this.iua});this.iua=null;this.Hu.zF(I)}}Vlj(I){if(L.q3a(I,this.iua)||L.q3a(I,this.QEa))return!0;const N=Object.assign(new x.a,{action:2,type:3,FA:I,LJ:this.QEa});this.QEa=I;this.Hu.zF(N);return!0}yEh(I){if(L.q3a(I,this.iua))return!0;I=Object.assign(new x.a,{action:3,type:3,FA:null,LJ:this.QEa});this.QEa=null;this.Hu.zF(I);return!0}Rqf(I,N){N=N?N:this.MOl(I);if(!N)return null;const Q=this.YH.cU(I);return new H.a(0<(null===Q||void 0===Q?void 0:Q.aO.length)?
null===Q||void 0===Q?void 0:Q.aO:[I],N,L.Zii(Q),L.NOl(Q))}static Zii(I){if(!I)return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion;switch(I.suggestion.Gq){case 0:return L.dYd(I.state)?WordEditorIntl.WordEditorStrings.L_ReviewUpdatedDesignerFormattingSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerFormattingSuggestion;case 1:case 3:return L.dYd(I.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerPullQuoteSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerPullQuoteSuggestion;
case 2:return L.dYd(I.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerText2ImageSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerText2ImageSuggestion;default:return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion}}static NOl(I){return I?L.dYd(I.state)?1:0:0}static dYd(I){return 0!==I&&.1!==I}MOl(I){var N=null,Q=this.Nm.Vf(I);Q.zb(11)&&(Q.wc(),Q=Q.currentNode.Fj(this.rc.fc))&&(I=String.format("#{0}",L.l5h(I)),N=Q.htmlElement.querySelector(I),!N&&Object(u.a)(y.a,
Q)&&(N=(N=Q.Dkf())?N.querySelector(I):null));return N}static l5h(I){return String.format("p{0}{1}",I.id.guid,I.id.n)}static q3a(I,N){return!!N&&!!I&&I.sFc===N.sFc}}Object(F.a)(L,"BlueDotActor",k.a,[383,384])},1775:function(F,K,c){F=c(0);var l=c(628);class f{constructor(k){this.jFa=k.X0l();this.MFb=k.Jqf("intCopy");this.$9d=k.Sdi("intCopy");this.LAb=k.yof("intCopy");this.geb=k.Xnf("intCopy")}static eF(){return f.Mr()}static Mr(){return new f(l.a.instance)}}Object(F.a)(f,"InternalCopyUsageHelper",null,
[]);c.d(K,"a",function(){return a});class a{constructor(k,x,y){this.FW=f.eF();this.IDd=null;this.UOb=this.Hoe=!1;this.$Ug=null;this.source=k;this.target=x;this.jYf=y}get Gja(){return this.FW}get Mo(){return this.$Ug}set Mo(k){this.$Ug=k}}Object(F.a)(a,"InternalCopyArguments",null,[])},1776:function(F,K,c){F=c(0);var l=c(1447);class f extends l.a{constructor(){super();this.LastAutoSaveErrorReported=0;this.LastAutoSaveCorrelation=null;this.MeritsErrorReport=!1;this.LocalCobaltMachineId=this.LocalCobaltSessionId=
null;this.WaciiEnabledRequests=0;this.ShowMergePrompt=!1;this.PartMergeInfo=0}}Object(F.a)(f,"ALocalCobaltServerResponse",l.a,[]);c.d(K,"a",function(){return a});class a extends f{constructor(){super();this.RootCellId=null;this.AvailableFileAccess=0;this.PageHtml=this.ClientKnowledge=this.LatestRevisionId=this.RevisionList=null;this.PinRevisionForAugLoopResponse=this.ContentBytes=0;this.RevisionIdPinnedForAugLoop=null;this.ScheduledShutdownTime=0;this.LastSavedToHostRevisionSequenceNumber=-1}}Object(F.a)(a,
"GetChangesResponse",f,[])},1777:function(F,K,c){F=c(0);var l=c(80);class f extends Sys.EventArgs{constructor(){super()}}Object(F.a)(f,"UploadEventArgs",Sys.EventArgs,[]);c.d(K,"a",function(){return a});class a{constructor(){this.ra=new l.a}Lng(k){this.ra.raiseEvent("UploadStarted",new f(k,-1))}Xmc(k,x){this.ra.raiseEvent("UploadComplete",new f(k,x))}static get instance(){return null!=a.NCg?a.NCg:a.NCg=new a}}Object(F.a)(a,"Box4UploadNotifier",null,[560])},1778:function(F,K,c){F=c(0);var l=c(2),f=
c(397),a=c(22),k=c(178),x=c(9),y=c(2080),n=c(218),u=c(724),z=c(51),w=c(7),E=c(2050),G=c(1404),H=c(83),L=c(115),I=c(500);class N{constructor(M,J,V,X,W,U,Y,ba){this.QV=null;this.jzc=this.FZ=0;this.dbb=new Date(Date.UTC(0,1,1,0,0));this.Zv={};this.BAc=this.XYb=0;this.zDh=async()=>{var aa;w.ULS.sendTraceTag(509372107,3038,50,"Running RunawayDataLossMonitor task. Run count: {0}",this.XYb++);if(this.$e.zo)this.x5c(),this.stop(),w.ULS.sendTraceTag(522818053,3038,50,"The application kicked out. RSNManager was tracking {0} unsavedRevision(s) ",
this.Bv.R7a);else{this.dbb=new Date;var fa={};fa.DocxSaveMonitor_IsUpToDate=null===(aa=this.QV)||void 0===aa?void 0:aa.gR;fa.RSNManager_IsUpToDate=this.Bv.gR;fa.RSNManager_CountRevisionsWithOutServerRevisionSequenceNumbers=this.Bv.R3b();fa.RSNManager_CountRevisionsWithServerRevisionSequenceNumbers=this.Bv.BGd();w.ULS.sendTraceTag(521413850,3038,50,"Logging IsUpToDate state for RSNManager and DocxSaveMonitor : {0}",fa);if(this.kl&&!this.kl.isVisible)w.ULS.sendTraceTag(524154191,3038,50,"App is hidden. RSNManager is tracking {0} unsavedRevision(s)",
this.Bv.R7a),this.MGn();else if(aa=this.Bv.S3b(this.AAc),0<aa){aa=this.O4h(aa);w.ULS.sendTraceTag(526192649,3038,15,JSON.stringify(aa));this.mnl&&w.ULS.sendTraceTag(524158796,3038,15,"Diagnostic Log :{0}",this.xA());if(0==this.FZ)this.jzc=this.Rcc;else if(1<this.FZ){w.ULS.sendTraceTag(524137233,3038,15,"StaleRevision(s) persist for more than {0} scans and {1} ms",this.FZ,this.Rcc-this.jzc);if(this.SHm&&(!await this.Bv.hVd(this.Pqm)||0===this.Bv.S3b(this.AAc))){this.x5c();return}this.hNi(aa,this.Rcc);
this.Zv.ShouldKickout&&(w.ULS.sendTraceTag(523547595,3038,50,JSON.stringify(this.Zv)),aa=this.p1l(),fa=this.HOl(aa),this.G6.WC(aa,fa))}this.FZ++}else this.x5c(),this.jXk()}};this.ADh=async()=>{await this.zDh();this.rgg()};this.Bv=M;this.$e=J;this.G6=Y;this.ojk=ba;this.fRe=X;this.AAc=W;this.Lik=U;this.QV=a.a.instance.Na("Wonca.IDocxSaveMonitor");this.Zv.ShouldKickout=!1;this.A$d=this.yDn;this.nZf=this.zDn;V.execute(aa=>{this.kl=aa});this.$e.UMa(this.sY.bind(this))}get Rcc(){return this.dbb.getTime()}O4h(M){return{["NumberOfStaleRevisions"]:M,
["BrowserIsOnline"]:E.a[this.$e.networkState],["NavigatorOnLine"]:window.navigator.onLine,["IsKickedOut"]:this.$e.zo,["IsSessionExpired"]:this.$e.kca,["IsSessionLost"]:this.$e.XUc,["HasEmergencyViewDeployed"]:this.$e.Gj,["IsVisible"]:window.document.visibilityState,["HasFocus"]:document.hasFocus(),["VisibilityManager_AppVisibilityState"]:this.kl?G.a[this.kl.sC]:"undefined"}}sY(M,J){if(J){M=Date.now();var V=this.Bv.S3b(this.AAc);0<V&&(V=this.O4h(V),this.hNi(V,M));this.cao();this.e5m(J.errorCode)}this.stop();
this.QV=a.a.instance.Na("Wonca.IDocxSaveMonitor")}jXk(){this.Bv.tVd(this.Lik)&&this.PTo()}PTo(){w.ULS.sendTraceTag(520663501,3038,15,"Cancelling all blocked operations in server replication scheduler.");this.ojk.s6e();I.a.emf(21)}HOl(M){let J=new u.a;M==z.a.Rpg&&(J=Object.assign(new u.a,{Ifa:4,WW:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,q3:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0}));return J}p1l(){return this.aTm?z.a.L6o:this.$e.kca?z.a.Rpg:z.a.K6o}stop(){0!==
this.BAc&&(window.clearInterval(this.BAc),this.BAc=0);w.ULS.sendTraceTag(509215701,3038,50,"Stopping RDLM task")}async g2h(){this.udp&&this.stop();this.ADh();w.ULS.sendTraceTag(509101133,3038,50,"RDLM running Synchronously")}sDo(M){this.BAc=window.setTimeout(this.ADh,M);w.ULS.sendTraceTag(509162245,3038,50,"Running RDLM Once");this.x5c()}rgg(){this.BAc=window.setInterval(this.zDh,this.fRe);w.ULS.sendTraceTag(509215700,3038,50,"Starting RDLM task");this.x5c()}cao(){this.qqj?this.a3h(this.Zv):(this.Zv.shouldKickout||
(0==this.Bv.S3b(this.AAc)?(this.Zv.NoKickoutReason="No Stale Revisions",this.Zv.OldestRevisionCreationTime=this.Bv.qEb()):this.kl&&!this.kl.isVisible?(this.Zv.NoKickoutReason="Session not active",this.Zv.VisibilityManager_AppVisibilityState=this.kl.sC):this.pGf&&this.FZ<=this.nZf?(this.Zv.NoKickoutReason="Persistent Runaway dataloss does not exceed minimum threshold",this.Zv.ScansWithPersistentRunawayDataLoss=this.FZ):this.FZ<=this.A$d?(this.Zv.NoKickoutReason="Persistent Runaway dataloss does not exceed maximum threshold",
this.Zv.ScansWithPersistentRunawayDataLoss=this.FZ):this.Zv.NoKickoutReason="undefined",this.Zv.LastScanTime=this.dbb.toISOString(),this.Zv.RunCounter=this.XYb),w.ULS.sendTraceTag(523114659,3038,50,JSON.stringify(this.Zv)))}get Lgj(){if(this.qqj){const M=Object.assign({},this.Zv);this.a3h(M);return M}return this.Zv}a3h(M){M.shouldKickout||(0==this.Bv.S3b(this.AAc)?(M.NoKickoutReason="No Stale Revisions",M.OldestRevisionCreationTime=this.Bv.qEb()):this.kl&&!this.kl.isVisible?(M.NoKickoutReason="Session not active",
M.VisibilityManager_AppVisibilityState=this.kl.sC):this.pGf&&this.FZ<=this.nZf?(M.NoKickoutReason="Persistent Runaway dataloss does not exceed minimum threshold",M.ScansWithPersistentRunawayDataLoss=this.FZ):this.FZ<=this.A$d?(M.NoKickoutReason="Persistent Runaway dataloss does not exceed maximum threshold",M.ScansWithPersistentRunawayDataLoss=this.FZ):M.NoKickoutReason="undefined");M.LastScanTime=this.dbb.toISOString();M.RunCounter=this.XYb}xA(){const M={};this.QV&&(M.DSM=this.QV.xA());this.Bv&&
(M.RSN=this.Bv.xA());return M}x5c(){w.ULS.sendTraceTag(509215699,3038,50,"Resetting RDLM scans and timer. Previous persistent runaway dataloss scan count: {0}, Previous runaway dataloss timer: {1}",this.FZ,this.jzc);this.jzc=this.FZ=0}MGn(){this.FZ=Math.min(this.A$d-1,this.FZ);this.jzc=Date.now()}pGf(){return 0===this.kl.sC&&this.$e.MH&&!this.$e.XUc&&!this.$e.kca&&!this.$e.Gj}hNi(M,J){this.FZ>this.nZf&&this.pGf()?this.Zv.ShouldKickout||(this.Zv.ShouldKickout=!0,this.b3h("Persistent RunawayDataLoss detected in active session",
J,M)):this.FZ>this.A$d&&!this.Zv.ShouldKickout&&(this.Zv.ShouldKickout=!0,this.b3h("Runaway DataLoss persists for more than 3 minutes.",J,M))}b3h(M,J,V){this.Zv.KickoutTime=(new Date(J)).toISOString();this.Zv.KickoutReason=M;this.Zv.DSM_isUpToDate=this.QV?this.QV.gR:"Undefined";this.Zv.SessionInfo=V}e5m(M){const J=this.Zv.ShouldKickout;H.Health.instance.recordKpiUsage(N.$qe,1,N.SLd,null);const V=new Map;M&&V.set("ErrorCode",M.toString());J?(V.set("ShouldKickout","true"),V.set("KickoutTime",this.Zv.KickoutTime),
V.set("Reason",this.Zv.KickoutReason),H.Health.instance.recordKpiSuccess(N.$qe,Object.assign(new L.a,{extendedProperties:V}))):(V.set("ShouldKickout","false"),M=this.Zv.NoKickoutReason,V.set("Reason",M),H.Health.instance.recordKpiFailure(N.$qe,M,!1,!1,Object.assign(new L.a,{extendedProperties:V})))}fwj(){w.ULS.sendTraceTag(509686349,3037,50,"RunawayDataLossMonitor stopped");this.stop()}rvj(M){w.ULS.sendTraceTag(509686348,3037,50,"RunawayDataLossMonitor started with interval {0}",M);this.bGf?this.sDo(M):
(this.fRe=M,this.rgg())}get mnl(){return null!=this.eyg?this.eyg:this.eyg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DiagnosticLoggingForRunawayDatalossMonitorIsEnabled",!0)}get Pqm(){return null!=this.PAg?this.PAg:this.PAg=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RDLMHasDataLossTimeOutInMs",3E3):3E3}get SHm(){return null!=this.gDg?this.gDg:this.gDg=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForHasDataLossIsEnabled",
!0)}get bGf(){return null!=this.CDg?this.CDg:this.CDg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RunComponentBeforeNextScan",!1)}get qqj(){return null!=this.JGg?this.JGg:this.JGg=l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldOnlyKickoutWhenVisible",!1)||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotKickoutFromDocxSaveMonitor",!1))}get zDn(){return null!=
this.YFg?this.YFg:this.YFg=l.AFrameworkApplication.K.mc("RunawayDataLossMinimumScansBeforeKickout",1)}get yDn(){return null!=this.XFg?this.XFg:this.XFg=l.AFrameworkApplication.K.mc("RunawayDataLossMaximumScansBeforeKickout",5)}get aTm(){return 1===this.$e.networkState||3===this.$e.networkState}get EOh(){return this.fRe}}N.$qe="RunAwayDataLossKickout";N.SLd="wwrelfc";Object(F.a)(N,"RunawayDataLossMonitor",null,[1269,1270]);c.d(K,"a",function(){return Q});class Q{constructor(){this.NRg=3E4;this.a1j=
24E4;this.b1j=12E4;this.W=this.Rtd=null}get name(){return"WordEditor.RunawayDataLossMonitor"}init(){if(x.App.us||x.App.vm)this.Rtd=this.W.resolve(this.name),this.Rtd.rgg(),this.W.resolve("WordEditor.RunawayDataLossMonitorWatchDog"),0==l.AFrameworkApplication.Lg.RunawayDatalossSystemStartedAt&&l.AFrameworkApplication.Lg.qNi()}uel(){return new N(this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"),this.W.resolve("Common.ISessionStatus")||f.SessionStatusManager.instance,this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"),
l.AFrameworkApplication.K.mc("RunawayDataLossScanIntervalInMs",this.NRg),this.sao,this.b1j,a.a.instance.Na("Wonca.KickoutExecutor"),n.WoncaApp.DF)}xc(M){if(x.App.us||x.App.vm)this.W=M,M.ha(this.name,this.uel.bind(this)).as("WordEditor.IRunawayDataLossMonitor").singleInstance(),this.O4f()}dispose(){this.Rtd&&this.Rtd.stop()}static main(){k.a.instance.Fc(new Q)}O4f(){this.W.ha("WordEditor.RunawayDataLossMonitorWatchDog",()=>new y.a(this.W.resolve(this.name),l.AFrameworkApplication.K.mc("RunawayDataLossScanIntervalInMs",
this.NRg),l.AFrameworkApplication.K.mc("TimerBasedWatchDogGracePeriodInMs",18E4))).singleInstance()}get sao(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossKickoutIntervalInMs",this.tao)}get tao(){return l.AFrameworkApplication.K.mc("RunawayDataLossKickoutIntervalInMs",this.a1j)}}Object(F.a)(Q,"WordEditorRunawayDataLossMonitorPackage",null,[1,2])},1781:function(F,K,c){F=c(0);var l=c(31),f=c(1039);class a extends f.a{isUserPromptField(H){return new k(H)}annotationStatusField(H){return new x(H)}annotationCharCountField(H){return new y(H)}userPromptCharCountField(H){return new n(H)}precedingTextsCharCountField(H){return new u(H)}followingTextsCharCountField(H){return new z(H)}promptTriggerSourceField(H){return new w(H)}promptIdField(H){return new E(H)}}
Object(F.a)(a,"AiInserterDataFieldsFactoryImpl",f.a,[]);class k extends l.a{constructor(H){super();this.name="isUserPrompt";this.bool=H}}Object(F.a)(k,"IsUserPromptDataField",l.a,[]);class x extends l.a{constructor(H){super();this.name="annotationStatus";this.int64=H}}Object(F.a)(x,"AnnotationStatusDataField",l.a,[]);class y extends l.a{constructor(H){super();this.name="annotationCharCount";this.int64=H}}Object(F.a)(y,"AnnotationCharCountField",l.a,[]);class n extends l.a{constructor(H){super();this.name=
"userPromptCharCount";this.int64=H}}Object(F.a)(n,"UserPromptCharCountField",l.a,[]);class u extends l.a{constructor(H){super();this.name="precedingTextsCharCount";this.int64=H}}Object(F.a)(u,"PrecedingTextsCharCountField",l.a,[]);class z extends l.a{constructor(H){super();this.name="followingTextsCharCount";this.int64=H}}Object(F.a)(z,"FollowingTextsCharCountField",l.a,[]);class w extends l.a{constructor(H){super();this.name="promptTriggerSource";this.string=H}}Object(F.a)(w,"PromptTriggerSourceField",
l.a,[]);class E extends l.a{constructor(H){super();this.name="promptId";this.string=H}}Object(F.a)(E,"PromptIdField",l.a,[]);l=c(942);c.d(K,"a",function(){return G});class G extends l.a{constructor(H){super(H,"AiInsert");this.fieldsFactory=new a}}Object(F.a)(G,"AiInserterTelemetryLoggerImpl",l.a,[])},1811:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=
!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static W4h(f){switch(f){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(F.a)(l,"WopiAuthContext",null,[831])},1812:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}l.hxn="OneDriveWOPI";Object(F.a)(l,"HostApplicationType",null,[])},1813:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}l.jMj="WAC_Word";
l.CRc=null;Object(F.a)(l,"AddinHostApp",null,[])},1815:function(F,K){Object.defineProperty(K,"__esModule",{value:!0});K.RoleType=K.ErrorCode=void 0;(function(c){c[c.Success=0]="Success";c[c.DocumentTooLarge=1]="DocumentTooLarge"})(K.ErrorCode||(K.ErrorCode={}));(function(c){c[c.Unknown=0]="Unknown";c[c.Title=1]="Title";c[c.Subtitle=2]="Subtitle";c[c.Heading1=3]="Heading1";c[c.Heading2=4]="Heading2";c[c.Heading3=5]="Heading3";c[c.Heading4=6]="Heading4";c[c.Heading5=7]="Heading5";c[c.Heading6=8]="Heading6";
c[c.Heading7=9]="Heading7";c[c.Heading8=10]="Heading8";c[c.Heading9=11]="Heading9";c[c.ListItem=12]="ListItem";c[c.BodyText=13]="BodyText";c[c.ListHeader=14]="ListHeader";c[c.Caption=15]="Caption";c[c.CoverPageElement=16]="CoverPageElement"})(K.RoleType||(K.RoleType={}))},1816:function(F,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.NavigationPaneInputClassifierSignal=K.DesignerInputClassifierSignal=K.DocumentRoleDetectionAnnotation=K.RoleDetectionAnnotation=K.RoleDetectionSettings=K.RoleDetectionCustomMetadata=
K.BasePartialDocumentLevelAnnotation=K.WordNavPaneInputTargetDocumentClassificationAnnotation=K.WordDesignerInputTargetDocumentClassificationAnnotation=K.BaseInputTargetDocumentClassificationAnnotation=void 0;const l=c(195);class f{constructor(G){l.SchemaObject.assign(f,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,
[f.getTypeName()])}}K.BaseInputTargetDocumentClassificationAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(G){l.SchemaObject.assign(a,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_RoleDetection_WordDesignerInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,
[a.getTypeName()])}}K.WordDesignerInputTargetDocumentClassificationAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(G){l.SchemaObject.assign(k,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_RoleDetection_WordNavPaneInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,
[k.getTypeName()])}}K.WordNavPaneInputTargetDocumentClassificationAnnotation=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class x{constructor(G){l.SchemaObject.assign(x,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,[x.getTypeName()])}}K.BasePartialDocumentLevelAnnotation=x;x.H_=
{T_:x.getTypeName(),B_:x.getBaseTypes()};class y{constructor(G){l.SchemaObject.assign(y,this,G)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionCustomMetadata"}static getBaseTypes(){return[]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,[y.getTypeName()])}}K.RoleDetectionCustomMetadata=y;y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class n{constructor(G){l.SchemaObject.assign(n,this,G)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionSettings"}static getBaseTypes(){return[]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,
[n.getTypeName()])}}K.RoleDetectionSettings=n;n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class u{constructor(G){l.SchemaObject.assign(u,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,[u.getTypeName()])}}K.RoleDetectionAnnotation=u;u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};
class z{constructor(G){l.SchemaObject.assign(z,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_RoleDetection_DocumentRoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation","AugLoop_Core_Annotation"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,[z.getTypeName()])}}K.DocumentRoleDetectionAnnotation=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class w{constructor(G){l.SchemaObject.assign(w,
this,G)}static getTypeName(){return"AugLoop_RoleDetection_DesignerInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,[w.getTypeName()])}}K.DesignerInputClassifierSignal=w;w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class E{constructor(G){l.SchemaObject.assign(E,this,G)}static getTypeName(){return"AugLoop_RoleDetection_NavigationPaneInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(G){return l.SchemaObject.matchesTypesFor(G,
[E.getTypeName()])}}K.NavigationPaneInputClassifierSignal=E;E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()}},1817:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f){this.extensions=f}}Object(F.a)(l,"ExtensionList",null,[])},1818:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(1775);class l extends c.a{constructor(f,a){super(f.source,f.target,f.jYf);this.Bi=f;this.insertAfter=a}get Gja(){return this.Bi.Gja}get Mo(){return this.Bi.Mo}set Mo(f){this.Bi.Mo=f}}Object(F.a)(l,
"CoreInternalCopyArguments",c.a,[])},1819:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a,k,x,y=null){this.source=f;this.target=a;this.insertAfter=k;this.sXf=x;this.Mo=y||{}}}Object(F.a)(l,"CoreInternalPasteArguments",null,[])},1820:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a="",k="",x="",y=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=f;this.Provider=a;this.DisplayName=k;this.Email=
x;this.IsCurrentUser=y}}Object(F.a)(l,"OfficeSharedCommentUser",null,[])},1821:function(F,K,c){c.d(K,"a",function(){return I});F=c(0);var l=c(55),f=c(1822),a=c(171),k=c(2),x=c(126),y=c(331),n=c(1381),u=c(757),z=c(528),w=c(1382),E=c(176),G=c(175),H=c(68),L=c(13);class I{constructor(N){this.O$=this.Yh=this.V1=null;this.nD=0;this.ETb=this.tka=this.Ub=null;this.Pfh=!1;this.pwe=null;this.dKh=!0;this.ga=N;this.Tb()}get Oca(){return this.V1}get model(){return this.Yh}get V9b(){return this.O$}get Zhl(){return k.AFrameworkApplication.Jro}get QKo(){return k.AFrameworkApplication.Vpj}get pkl(){return CommonUIStrings.l_DeleteCommentConfirm}get $Fo(){return!1}get sA(){return!1}get fRi(){return!1}get ijj(){return!1}get TXh(){return this.tka}set TXh(N){this.tka=
N}get mode(){return this.nD}set mode(N){N!==this.nD&&(this.nD=N,-1!==this.nD&&(this.V1.r4a(),this.Yh.r4a(),0===this.nD&&this.Qhf()))}get POb(){return this.Pfh}set POb(N){this.Pfh=N}get removePersonalInformation(){return!1}get Vrj(){return!0}dispose(){this.V1&&(this.V1.dispose(),this.V1=null);this.Yh&&(this.Yh.dispose(),this.Yh=null);this.O$&&(this.O$.dispose(),this.O$=null);this.Qhf()}selectComment(N,Q=1){const M=this.Yh.MD(N);!M||2===this.mode&&1!==M.Xq||(this.Yh.selectComment(M),this.O$.highlightComment(M,
!0),this.V1.selectComment(M,Q),1===Q&&this.POb&&this.tka.selectComment(N))}F6c(){const N=this.Yh.F6c();N&&(this.O$.highlightComment(N,!0),this.V1.selectComment(N),this.POb&&this.tka.selectComment(N.id))}G6c(){const N=this.Yh.G6c();N&&(this.O$.highlightComment(N,!0),this.V1.selectComment(N),this.POb&&this.tka.selectComment(N.id))}Mfe(N){N?this.selectComment(N,0):this.V1.VQi&&this.Iof().fk.Ly(this.V1.VQi)}clearSelection(){this.Yh.clearSelection();this.POb&&this.tka.selectComment(null);this.O$.ZYk()}paneClosing(){this.sA||
(2===this.nD?(this.clearSelection(),this.deleteComment(this.Yh.ry)):this.clearSelection())}jzb(N){if(1===this.mode){N=f.a.BBb(N);var Q=({anchor:M}=this.O$.s9k()).returnValue;if(M&&0===Q)this.addComment(N,M);else{switch(Q){case 1:N=CommonUIStrings.l_NewCommentError;break;case 2:N=CommonUIStrings.l_NewCommentInvalidContent;break;default:N=CommonUIStrings.l_NewCommentError}var M=new G.StandardDialog;M.Ad=0;M.eja(CommonUIStrings.l_DefaultDialogTitle,N,null)}}}addComment(N){0!==this.mode&&(this.Yh.nsk(N),
0===N.Xq||this.fRi||this.selectComment(N.id),this.ga.processAction(L.a.QGh,2))}editComment(N,Q){1===this.mode&&N&&(this.Yh.FKc(N,Q),this.selectComment(N.id))}u6e(){this.Yh.hUk()}addReply(N,Q){1===this.mode&&(N=this.Yh.IKh(N,Q),this.selectComment(N.id,0),this.ga.processAction(L.a.UGh,2))}deleteComment(N){if(1!==this.mode)if(2===this.mode){if(1!==N.Xq)return;this.mode=1}else return;this.Vrj&&1!==N.Xq?(this.ETb=N,N=new G.StandardDialog,N.Ad=4,N.$U(2),N.Teg(CommonUIStrings.l_DefaultDialogTitle,this.pkl,
Object(l.a)(this,this.wkl,"deleteDialogHandler"))):this.yJc(N)}Tb(){this.ga.eb(L.a.W1k,H.a.frame,x.ActionManager.Nf,64);this.ga.eb(L.a.X1k,H.a.frame,x.ActionManager.Nf,64);this.ga.eb(L.a.pGh,H.a.frame,x.ActionManager.Nf,64);this.ga.qa(L.a.V8e,H.a.frame,x.ActionManager.Nf);this.ga.qa(L.a.wGh,H.a.frame,x.ActionManager.Nf);this.ga.qa(L.a.xGh,H.a.frame,x.ActionManager.Nf);this.ga.eb(L.a.b2k,H.a.frame,x.ActionManager.Nf,64);this.ga.eb(L.a.c2k,H.a.frame,x.ActionManager.Nf,64);this.ga.qa(L.a.QGh,H.a.frame,
x.ActionManager.Nf);this.ga.qa(L.a.RGh,H.a.frame,x.ActionManager.Nf);this.ga.qa(L.a.UGh,H.a.frame,x.ActionManager.Nf);this.ga.eb(L.a.S2k,H.a.frame,x.ActionManager.Nf,64);this.ga.eb(L.a.U2k,H.a.frame,x.ActionManager.Nf,64);this.ga.eb(L.a.T2k,H.a.frame,x.ActionManager.Nf,64);this.ga.qa(L.a.WGh,H.a.frame,x.ActionManager.Nf);this.ga.qa(L.a.A4a,H.a.frame,()=>{this.A4a();return 32})}wkl(N){1===N?this.yJc(this.ETb):(this.ETb&&this.selectComment(this.ETb.id),this.ETb=null)}yJc(N){const Q=N.Cf;1===N.Xq?this.ga.processAction(L.a.V8e,
2):this.ga.processAction(L.a.wGh,2);this.ETb=null;this.POb||this.clearSelection();N=this.Yh.deleteComment(N);for(let M=0;M<N.length;M++)N[M].dispose();this.Mfe(Q)}FAb(N,Q){0!==this.mode&&(this.ga.processAction(Q?L.a.xGh:L.a.WGh,2),this.Yh.FAb(N,Q))}tua(N){this.Yh.tua(N);this.mode=1;this.ga.processAction(L.a.RGh,2)}Zeb(N){this.Yh.Zeb(N);this.mode=1}h3k(N,Q){this.Yh.gUn(N,Q)}NSc(){}Qhf(){}kPb(N,Q,M,J,V){return this.V1.kPb(N,Q,M,J,V)}jV(N,Q,M,J,V){return this.V1.jV(N,Q,M,J,V)}Iof(){var N=this.Ub.getRegion(a.AFrame.Kr);
if(!N){const Q=this.Ub.fe(a.AFrame.Kr);N=new y.DOMFocusListing(()=>this.Oca.i1c);N.Zpa=!0;N.Wm(3);N.Wm(2);N.Wm(4);N.Wm(1);N.Wm(6);N.Wm(5);this.Ub.hma(()=>this.Oca.i1c,Q,N);N=this.Ub.getRegion(a.AFrame.Kr);N.vSa();N.oR=!0;N.f_a=!0;Q.jr(this.Ub.uW);Q.jr(this.Ub.vW)}return N}hzd(N,Q){0!==this.mode&&this.Yh.hzd(N,Q)}Bde(N,Q){0!==this.mode&&this.Yh.Bde(N,Q)}A4a(){E.UISurfaces.vM().then(N=>{var Q=Object.assign(new n.a,{target:this.ijj?'[data-unique-id*="ShowCommentsTopBar"]':'[data-unique-id~="ShowCommentsTopBar"]',
showCloseIcon:!0,content:CommonUIStrings.l_DeepLinkedCommentDoesNotExistNotification,calloutProps:Object.assign(new w.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});Q=N.callout(Q);const M=Object.assign(new z.a,{expirationOptions:Object.assign(new u.a,{displayTimeoutSeconds:10,onExpire:Object(l.a)(this,this.dismiss,"dismiss")})});this.pwe=N.addNotification(Q,M)})}dismiss(){E.UISurfaces.vM().then(N=>{N.removeNotification(this.pwe);return this.pwe=null})}static get instance(){return I._instance||
(I.factory?I._instance=I.factory():null)}static set instance(N){I._instance=N}}I._instance=null;I.factory=null;Object(F.a)(I,"CommentManager",null,[650,651,10])},1822:function(F,K,c){c.d(K,"a",function(){return a});F=c(0);var l=c(2),f=c(936);class a{constructor(){this.Yi=null;this.ah=[];this._changes=[];this.Cab=this.iZb=this.Vy=null}get nt(){return this.Vy}get ry(){return this.Cab}initialize(k){this.Yi=k}dispose(){const k=this.ah.length;for(let x=0;x<k;x++)this.ah[x].dispose();this.ah=[]}r4a(){this.Vy&&
this.Vy.r4a();this.iZb&&this.iZb.r4a()}selectComment(k){this.clearSelection();k.Sia=1;this.Vy=k;if(k.Cf){var x=Array.indexOf(this.ah,k);for(--x;0<=x;x--){const y=this.ah[x];if(y.id===k.Cf){y.Sia=2;this.iZb=y;break}}}l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Nb.Noa&&f.ShyRibbon.Geb(1,0)}F6c(){if(!this.ah.length)return null;let k;k=this.Vy?this.L6h(this.Vy,!0):this.ah[0];this.selectComment(k);return k}G6c(){if(!this.ah.length)return null;let k;k=this.Vy?this.ERl(this.Vy):this.ah[this.ah.length-
1];this.selectComment(k);return k}clearSelection(){this.Vy&&(this.Vy.Sia=0,this.Vy=null);this.iZb&&(this.iZb.Sia=0,this.iZb=null)}FKc(k,x){this.Yi.mode=3;k.Xq=2;k.SSa=0;k.lz=x;this.Cab=k}hUk(){this.Cab=null;this.Yi.mode=1}IKh(k,x){var y=this.MD(k);this.Yi.mode=2;this.Cab=k=c(1659).Comment.dLh(l.AFrameworkApplication.userName,k,y.rli,x);for(x=this.ah.length-1;0<=x;x--)if(y=this.ah[x],y.Cf===k.Cf||y.id===k.Cf){Array.insert(this.ah,x+1,k);break}return k}tua(k){this.XGh(k,2)}Zeb(k){this.XGh(k,4)}deleteComment(k){const x=
[],y=Array.indexOf(this.ah,k);for(;y<this.ah.length;){const n=this.ah[y];if(n.id===k.id||n.Cf===k.id)Array.removeAt(this.ah,y),Array.add(x,n);else break}this.U3c(x,3);-1<Array.indexOf(x,this.Cab)&&(this.Cab=null,this.Yi.mode=1);return x}FAb(k,x){const y=[];let n=Array.indexOf(this.ah,k);for(;n<this.ah.length;){const u=this.ah[n];if(u.id===k.id||u.Cf===k.id)u.done=x,Array.add(y,u),n++;else break}this.U3c(y,x?0:1)}AO(){return Array.clone(this.ah)}A9b(){return!!this.ah&&!!this.ah.length}MD(k){for(let x=
0;x<this.ah.length;x++){const y=this.ah[x];if(y.id===k)return y}return null}L6h(k,x){k=Array.indexOf(this.ah,k);return k===this.ah.length-1?x?this.ah[0]:null:this.ah[k+1]}GXl(k,x=!1){let y=k=Array.indexOf(this.ah,k);do if(y=y===this.ah.length-1?0:y+1,!x||!this.ah[y].done)return this.ah[y];while(y!==k);return this.ah[k]}ERl(k){return(k=Array.indexOf(this.ah,k))?this.ah[k-1]:this.ah[this.ah.length-1]}HXl(k,x=!1){let y=k=Array.indexOf(this.ah,k);do if(y=y?y-1:this.ah.length-1,!x||!this.ah[y].done)return this.ah[y];
while(y!==k);return this.ah[k]}hzd(){}Bde(){}XGh(k,x){const y=[];k.Xq=0;Array.add(y,k);this.U3c(y,x);this.Cab=null}static BBb(k){return c(1659).Comment.dLh(l.AFrameworkApplication.userName,null,c(1659).Comment.L_i,k)}}Object(F.a)(a,"CommentModel",null,[10,653])},1823:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}l.nHc="CommentPaneTextbox";l.dFd="CommentPane";l.a2k="CommentDeleteButton";l.R2k="CommentSaveButton";l.Q2k="CommentReplyButton";l.$1k="CommentCancelButton";l.VGh="CommentTextEntry";
l.W2k="CommentTabHelp";Object(F.a)(l,"CommentManagerConstants",null,[])},1824:function(F,K,c){c.d(K,"a",function(){return k});F=c(0);var l=c(443),f=c(88),a=c(27);class k{dispose(){}static r_a(x,y,n,u=null,z=!0){var w=z?"":n;x=l.a("a",x,"StandardButton "+y);x.title=w;x.tabIndex=0;w=null;u?(w=f.createClusteredImage(16,16,u,"StandardButtonImage",!0,null),w.setAttribute(a.a.qh,a.a.fz),x.appendChild(w)):Sys.UI.DomElement.addCssClass(x,"StandardButtonNoImage");z?(u=l.a("span",null,"StandardButtonLabel"),
u.innerText=n,x.appendChild(u)):Sys.UI.DomElement.addCssClass(w,"StandardButtonImageNoText");x.setAttribute(a.a.qh,a.a.j3);return x}static iOb(x,y){void 0!==x&&null!==x&&(x.disabled=!y,y?(y=a.a.fM,Sys.UI.DomElement.removeCssClass(x,"DisabledButton"),Sys.UI.DomElement.removeCssClass(x,"cui-disabled")):(y=a.a.lp,Sys.UI.DomElement.containsCssClass(x,"DisabledButton")||Sys.UI.DomElement.addCssClass(x,"DisabledButton"),Sys.UI.DomElement.containsCssClass(x,"cui-disabled")||Sys.UI.DomElement.addCssClass(x,
"cui-disabled")),a.a.hr(x,a.a.D2e,y))}}Object(F.a)(k,"SimpleButtonFactory",null,[10])},1826:function(F,K,c){c.d(K,"a",function(){return w});F=c(0);var l=c(79),f=c(11),a=c(2),k=c(20),x=c(19),y=c(44),n=c(7),u=c(3),z=c(9);class w{constructor(E,G,H,L,I="@"){this.nQe=this.Cnd=this.NEe=this.ae=null;this.t3g=this.Aub=this.Ika=this.vsa=this.PMg=!1;this.Gea=0;this.Xdg=!1;this.bLb=()=>{this.reset()};this.cNa=N=>{this.Gea=N.Hb.keyCode;var Q=N.Hb.rawEvent.key;Q&&Q!==this.Qma||(this.Xdg=!0);return this.Ika&&this.Cnd?
N.Hb.keyCode===l.a.A1||N.Hb.keyCode===l.a.Fs||N.Hb.keyCode===l.a.Dw?(Q=!1,N.Hb.keyCode===l.a.A1?(n.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"),Q=!0):N.Hb.keyCode===l.a.Fs?n.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"):N.Hb.keyCode===l.a.Dw&&n.ULS.sendTraceTag(51451662,324,50,"@ mention People Picker tab pressed while picker is up"),this.Cnd(N),Q&&this.reset(),!0):N.Hb.keyCode===l.a.Oda||N.Hb.keyCode===l.a.P5||N.Hb.keyCode===
l.a.B1||N.Hb.keyCode===l.a.C1||N.Hb.keyCode===l.a.O5||N.Hb.keyCode===l.a.BL?(this.Cnd(N),!0):!1:!1};this.Tqa=N=>{if(this.Xdg||this.Ika){this.Xdg=!1;var Q=this.uPc(),M=this.fOc(N.Hb.target),J=N.Hb.rawEvent.inputType;return(void 0!==J&&null!==J||this.Gea!==l.a.fC&&this.Gea!==l.a.z1)&&"deleteContentBackward"!==J&&"deleteContentForward"!==J?this.wmi(Q,M,N.Hb.target):!1}};this.wKk=N=>{if(1!==N.Hb.rawEvent.key.length)return!1;const Q=this.uPc(),M=this.fOc(N.Hb.target);return this.wmi(Q,M,N.Hb.target)};
this.NQa=N=>{if(!this.Ika)return!1;const Q=this.uPc(),M=this.fOc(N.Hb.target);(N.Hb.keyCode===l.a.fC||N.Hb.keyCode===l.a.z1||(N.Hb.keyCode===l.a.RUa||N.Hb.keyCode===l.a.poc)&&N.Hb.ctrlKey)&&this.Rwf(Q,M,N.Hb.target);return!1};this.t3e=(N,Q)=>{this.Gea=Q.YBf?l.a.fC:Q.isDelete?l.a.z1:this.Gea;this.Ika&&(Q.YBf?this.Nmm(Q.MEi):Q.isDelete&&this.tnm(Q.MEi))};this.Ae=E;this.qk=G;this.mpc=H;this.fd=L;this.Qma=I;this.reset()}deb(E,G){this.vsa||(this.vsa=!0,E.xwa?this.eeb(G):E.sfa(()=>{this.vsa||this.eeb(G)}))}dispose(){this.Aub&&
(z.App.xa.Hlc.sc(f.a.input,this.fd.editingView.editingElement,this.Tqa),this.Aub=!1);this.PMg&&(this.ae.sc(f.a.KBd,this.fd.editingView.editingElement,this.wKk),this.PMg=!1);this.t3g&&(this.ae.sc(f.a.$F,this.fd.editingView.editingElement,this.cNa),this.ae.sc(f.a.uh,this.fd.editingView.editingElement,this.NQa));z.App.xa.ada(this.bLb);this.ewj()}z4f(E){this.NEe=E}J4f(E){this.nQe=E}A4f(E){this.Cnd=E}CKk(){this.Ika=!0;a.AFrameworkApplication.ue("ContextIQAtMentionEntryPoint-Treatment;ContextIQAtMentionEntryPoint-Control")}ewj(){this.Ika=
!1}VD(){return this.Ika}eeb(E){this.ae=E;if(!this.fd.Bd)n.ULS.sendTraceTag(593376530,324,10,"SelectionView is null. AtMentions will not work in this session");else if(this.fd.Bd.Wi){if(z.App.AFc&&k.a.Tke||k.a.iu)z.App.xa.Hlc.nb(f.a.input,this.fd.editingView.editingElement,this.Tqa,null),this.Aub=!0;this.ae&&(this.ae.nb(f.a.$F,this.fd.editingView.editingElement,this.cNa),this.ae.nb(f.a.uh,this.fd.editingView.editingElement,this.NQa),this.t3g=!0);this.mpc.pqh(this.t3e);z.App.xa.WZ(this.bLb)}}wmi(E,
G,H){if(1>G)return!1;E=E.replace(new RegExp(w.newLine,"g"),"");const L=E.charAt(G-1);this.Ika&&L!==this.Qma?this.Rwf(E,G,H):this.Ika||L!==this.Qma?this.Ika&&L===this.Qma&&n.ULS.sendTraceTag(41178052,324,50,"Tried to type @ while already in at mention mode"):this.NEe&&(this.reset(),this.hIn(G,E)&&(this.CKk(),this.Rwf(E,G,H),n.ULS.sendTraceTag(41178051,324,50,"@ typed.  Beginning of paragraph?: {0}",1===G?"true":"false")));return this.Ika}reset(){this.vsa=!1;this.ewj();this.nQe&&this.nQe()}fOc(E){return this.qk.v7b(2,
E)}uPc(){return this.Ae.ow().innerText}hIn(E,G){return 0>E-2||this.GVk(G.charAt(E-2))?!0:!1}GVk(E){return x.a.sca(E)||"("===E}Rwf(E,G,H){if(!E||""===E||0>G)this.reset();else{const {gij:L,uBd:I}=this.PXm(E,G);this.NEe(L,H,I)}}PXm(E,G){const H=this.$Nl(E,G);if(0<=H&&G<=E.length)return{gij:E.substring(H,G),uBd:H};this.reset();return{gij:"",uBd:H}}$Nl(E,G){let H=-1,L=G;for(L;0<=L&&63>=G-L;L--)if(E.charAt(L)===this.Qma){H=L;break}63<G-L&&-1==H&&y.c(u.a.mRo,!0,void 0,void 0,void 0,void 0);return H}Nmm(E){E=
this.fOc(E.Hb.target);E=this.uPc().charAt(E-1);this.Ika&&E===this.Qma&&this.reset()}tnm(E){E=this.fOc(E.Hb.target);E=this.uPc().charAt(E);this.Ika&&E===this.Qma&&this.reset()}}w.newLine="\n";Object(F.a)(w,"AtMentionsListener",null,[14])},1827:function(F,K,c){c.d(K,"a",function(){return z});F=c(0);var l=c(7),f=c(78),a=c(755),k=c(122),x=c(8),y=c(346),n=c(1828);class u{constructor(w,E){this.yRc=w;this.KTc=E}F8h(){return this.KTc?this.yRc.begin:this.yRc.end}Pio(w){this.KTc?this.yRc.begin=w:this.yRc.end=
w}tyi(w,E){const G=this.F8h()+(this.KTc?0:-1);return G>=w&&G<E}}Object(F.a)(u,"HitRangeEdge",null,[]);class z{get Uc(){return null}get Aj(){return null}get Foa(){return!1}get xCf(){return!1}a_e(){}m5d(){return!1}llg(){return!1}s9h(w){return f.f(w,()=>!1)}oEa(){return null}F4d(w,E,G,H,L){E=E||[];G=G||[];const I=[];let N=0,Q=0,M=0;for(;N<E.length||Q<G.length;){const J=N<E.length&&Q<G.length?E[N].begin<G[Q].begin?E[N++]:G[Q++]:N<E.length?E[N++]:G[Q++];I[M]=n.a.createInstance(J.begin,J.end,w,M,H,L);++M}return I}k_l(w,
E){if(!E)return null;if(!x.ParagraphReader.sIh(w))return this.uib(w.characterData,E);const G=this.Gjm(w,k.AParagraphNode.uMc);w=this.Kjm(w,G);E=this.uib(w,E);if(!E)return E;E=this.gFn(E);this.JZn(E,G);return E=this.ICl(E,G)}Gjm(w,E){E=Object(y.c)(E);const G=Object(y.a)(E);return[...x.ParagraphReader.FPc(w)].map(H=>{H.isVisible=G(H);return H})}Kjm(w,E){E=E.filter(G=>G.isVisible);return x.ParagraphReader.USd(w,E)}gFn(w){const E=[];for(const G of w)E.push(new u(G,!0)),E.push(new u(G,!1));return E}JZn(w,
E){if(0!==w.length){var G=0,H=0;for(const L of E){if(G>=w.length)break;if(L.isVisible)for(;G<w.length;){E=w[G];if(!E.tyi(L.chp.cp-H,L.cpEnd-H))break;E.Pio(E.F8h()+H);G++}else H+=L.cpEnd-L.chp.cp}}}ICl(w,E){if(0===w.length)return[];const G=[];let H=0,L=!1;for(const I of E){if(H>=w.length)break;if(I.isVisible)for(;H<w.length;){E=w[H];if(!E.tyi(I.chp.cp,I.cpEnd))break;E.KTc?L=!0:!E.KTc&&L&&(G.push(E.yRc),L=!1);H++}else L=!1}return G}hBi(){return!1}rBi(){return!1}uib(w,E){if(E&&w){let G;const H=[];try{for(;G=
E.exec(w);){const L=new a.a(G.index,E.lastIndex);H.push(L)}return H}catch(L){l.ULS.sendTraceTag(522846819,313,15,L instanceof SyntaxError?"Invalid regular expression":`errorName: ${L.name}`)}}return null}lde(){}}Object(F.a)(z,"BaseFindManagerHelper",null,[531])},1828:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a,k,x,y,n,u){this.id=++l.gik;this.QMg=f;this.K$a=a;this.j8g=k;this.PYg=x;this.$j=y;this.Q_g=n;this.gp=u;this.next=this.previous=null}get begin(){return this.QMg}get end(){return this.K$a}get type(){return this.$j}kdi(){return this.gp.oEa(this.nodeId)}get nodeId(){return this.j8g}get FPa(){return this.PYg}get SXd(){return this.Q_g}p8k(f){this.QMg=
f.begin;this.K$a=f.end;this.j8g=f.nodeId;this.PYg=f.FPa;this.$j=f.type;this.Q_g=f.SXd}static createInstance(f,a,k,x,y,n){const {FindManagerHelper:u}=c(1545);return new l(f,a,k,x,y,n,u.instance)}}l.gik=0;Object(F.a)(l,"FindResult",null,[552])},1829:function(F,K,c){c.d(K,"a",function(){return k});F=c(0);var l=c(55),f=c(90),a=c(20);class k{constructor(x,y,n){this.Es=this.JWf=null;this.Edh=this.pcb=this.Ddh=this.qBa=0;this.jjd=null;this._context=x;this.Gb=y;this.Fa=n;this.a5b=!1;this.Loe=!0;this.f7n();
this.aKb=this.K.$("NativeFileOpenDialogIsEnabled")}get context(){return this._context}get K(){return this.Fa}get retryCount(){return this.qBa}get e9n(){return this.Ddh}get a6a(){return this.pcb}get f9n(){return this.Edh}vfc(x){this.Es=x;if(!this.a5b){if(this.Loe){if(this.aKb&&a.a.OH){this.jjd=x.oJd(Object(l.a)(this,this.ZTf,"onFileChosen"));return}this.jjd=x.oJd(null);if(!this.rza(this.jjd,x))return}this.BOa(x,null)}}ZTf(x){if(this.rza(x,this.Es)){if(a.a.OH||a.a.lj)this.jjd=x;this.BOa(this.Es,null)}}y0c(){this.JWf&&
this.JWf()}l9n(x){if(!x||this.retryCount>=this.e9n)return!1;this.qBa=this.retryCount+1;const y=new f.a(2,1,this.a6a,()=>{this.kee(x)},110);this.Gb.Vb(y);this.a6a<this.f9n&&(this.pcb=2*this.a6a);return!0}f7n(){this.qBa=0;this.Ddh=this.K.mc("Box4UploadRetryCount",20);this.pcb=this.K.mc("Box4UploadRetryDelayStart",200);this.Edh=this.K.mc("Box4UploadRetryDelayMax",3200);this.Es&&(this.Es.dispose(),this.Es=null)}}Object(F.a)(k,"FileUploader",null,[])},1830:function(F,K,c){c.d(K,"a",function(){return f});
F=c(0);var l=c(2);c=c(80);class f{static gyk(a){f.cwg.addHandler(f.bGh,a)}static wOn(a){l.AFrameworkApplication.K.$("SqmCommandEventSourceEnabled")&&f.cwg.raiseEvent(f.bGh,a)}}f.bGh="CommandClickEvent";f.cwg=new c.a;Object(F.a)(f,"CommandClickEvents",null,[])},1831:function(F,K){Object.defineProperty(K,"__esModule",{value:!0});K.ErrorCode=K.FormattingSuggestionsRange=K.FormattingSuggestionType=void 0;(function(c){c[c.FontSize=0]="FontSize";c[c.FontFamily=1]="FontFamily";c[c.FontColor=2]="FontColor";
c[c.Alignment=3]="Alignment";c[c.Indentation=4]="Indentation";c[c.Bold=5]="Bold";c[c.RightIndentation=6]="RightIndentation";c[c.Italic=7]="Italic";c[c.Underline=8]="Underline";c[c.AllCaps=9]="AllCaps";c[c.LineSpacing=10]="LineSpacing";c[c.BeforeSpacing=11]="BeforeSpacing";c[c.AfterSpacing=12]="AfterSpacing";c[c.SpecialIndentType=13]="SpecialIndentType";c[c.SpecialIndentBy=14]="SpecialIndentBy";c[c.FontKerning=15]="FontKerning"})(K.FormattingSuggestionType||(K.FormattingSuggestionType={}));(function(c){c[c.Paragraph=
0]="Paragraph";c[c.List=1]="List"})(K.FormattingSuggestionsRange||(K.FormattingSuggestionsRange={}));(function(c){c[c.Success=0]="Success";c[c.DocumentTooLarge=1]="DocumentTooLarge"})(K.ErrorCode||(K.ErrorCode={}))},1832:function(F,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.FormattingSuggestionsSummaryAnnotation=K.FormattingSuggestionsAnnotation=void 0;const l=c(195);class f{constructor(k){l.SchemaObject.assign(f,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[f.getTypeName()])}}K.FormattingSuggestionsAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}K.FormattingSuggestionsSummaryAnnotation=a;a.H_={T_:a.getTypeName(),
B_:a.getBaseTypes()}},1833:function(F,K){Object.defineProperty(K,"__esModule",{value:!0})},1834:function(F,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.PullQuotesSignal=K.DocumentPullQuoteAnnotation=K.PullQuoteAnnotation=void 0;const l=c(195);class f{constructor(x){l.SchemaObject.assign(f,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=x}static getTypeName(){return"AugLoop_PullQuotes_PullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,
[f.getTypeName()])}}K.PullQuoteAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(x){l.SchemaObject.assign(a,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=x}static getTypeName(){return"AugLoop_PullQuotes_DocumentPullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[a.getTypeName()])}}K.DocumentPullQuoteAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(x){l.SchemaObject.assign(k,
this,x)}static getTypeName(){return"AugLoop_PullQuotes_PullQuotesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[k.getTypeName()])}}K.PullQuotesSignal=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()}},1835:function(F,K){Object.defineProperty(K,"__esModule",{value:!0})},1836:function(F,K){Object.defineProperty(K,"__esModule",{value:!0})},1837:function(F,K){Object.defineProperty(K,"__esModule",{value:!0})},1838:function(F,K,
c){Object.defineProperty(K,"__esModule",{value:!0});K.TextToImageAnnotation=void 0;var l=c(195);F=function(){function f(a){l.SchemaObject.assign(f,this,a)}Object.defineProperty(f.prototype,"metadata",{get:function(){return this.M_},set:function(a){this.M_=a},enumerable:!1,configurable:!0});f.getTypeName=function(){return"AugLoop_TextToImage_TextToImageAnnotation"};f.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};f.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};
f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();K.TextToImageAnnotation=F},1839:function(F,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.TextToImageSignal=void 0;var l=c(195);F=function(){function f(a){l.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_TextToImage_TextToImageSignal"};f.getBaseTypes=function(){return["AugLoop_TextToSuggestions_TextToSuggestionSignal","AugLoop_Signals_Signal"]};f.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();K.TextToImageSignal=F},1840:function(F,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.TextToImageTraceSignal=void 0;var l=c(195);F=function(){function f(a){l.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_TextToImage_TextToImageTraceSignal"};f.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};f.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_=
{T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();K.TextToImageTraceSignal=F},1841:function(F,K){Object.defineProperty(K,"__esModule",{value:!0})},1842:function(F,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.ThemeExtractorSignal=K.ThemeExtractorAnnotation=void 0;const l=c(195);class f{constructor(k){l.SchemaObject.assign(f,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[f.getTypeName()])}}K.ThemeExtractorAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}K.ThemeExtractorSignal=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1843:function(F,K){Object.defineProperty(K,"__esModule",{value:!0});K.TableType=
void 0;F=K.TableType||(K.TableType={});F[F.Other=0]="Other";F[F.SimpleHeaded=1]="SimpleHeaded"},1844:function(F,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.TableTypeAnnotation=void 0;const l=c(195);class f{constructor(a){l.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_TableAnalysis_TableTypeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])}}K.TableTypeAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1845:function(F,K,c){c.d(K,"a",function(){return w});F=c(0);c(1560);var l=c(1619),f=c(2),a=c(19);c(1546);c(35);var k=c(7),x=c(1410),y=c(9),n=c(17),u=c(122),z=c(8);class w{constructor(E=2E3){this.Aok=/(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)?/g;this.qbb=E}nJm(){w.RT();return!0}DVm(){return!0}getSelectedText(){const E=w.RT();return this.pSd(E)}buf(){const E=
w.RT();return this.Acm(E)}pSd(E){return this.wgi(E,!0)}Acm(E){return this.wgi(E,!1)}wgi(E,G){try{return this.zcm(E,G)}catch(H){k.ULS.sendTraceTag(545869845,1303,15,"Error accessing selection: {0}",H)}return Object.assign(new l.a,{neighborhood:"",mentionStart:0,mentionLength:0})}zcm(E,G){var H=null;let L=!1;G&&E&&E.Cx&&n.SelectionEditor.gf(E.Oa)&&n.SelectionEditor.pkb(E.Oa)&&(k.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),L=n.SelectionEditor.gf(E.Oa),(H=
n.SelectionEditor.w_(E.Oa,!1))&&H.Cx&&0<=H.Oa.cpBegin&&0<=H.Oa.cpEnd&&1>=H.Oa.cpEnd-H.Oa.cpBegin&&(H=null));H&&(E=H);if(!E)return Object.assign(new l.a,{neighborhood:"",mentionStart:0,mentionLength:0});const I=new Sys.StringBuilder;H=G=0;const N=[],Q=E.length;let M=null;for(let W=0;W<Q;W++){var J=E.J(W);if(!z.ParagraphReader.Wb(J.node)||Array.contains(N,J.node.Al))continue;N.push(J.node.Al);const U=x.a.create(J.cpBegin,J.cpEnd),Y=z.ParagraphReader.Ogb(J.node,u.AParagraphNode.uMc,null,U);f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",
!1)&&L&&(M=this.vAl(Y,U.yd));let ba=Y,aa=0;var V=z.ParagraphReader.jg(J.node,!0,!0,!0);J=z.ParagraphReader.jg(J.node,!1,!0,!0);let fa=0;for(;ba.length<this.qbb&&(V||J);){if(!(fa%2)&&V){var X=z.ParagraphReader.text(V,u.AParagraphNode.uMc);X&&(ba=X+" "+ba,aa+=X.length+1);V=z.ParagraphReader.jg(V,!0,!0,!0)}1===fa%2&&J&&(ba=(X=z.ParagraphReader.text(J,u.AParagraphNode.uMc))?ba+" "+X:ba,J=z.ParagraphReader.jg(J,!1,!0,!0));fa++}V=W===Q-1;W||-1===U.yd||(G=U.yd);H+=V&&-1!==U.endCp?U.endCp:Y.length;I.append(ba);
f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",!1)&&L&&M&&(G=M.start,H=M.start+M.length);G+=aa;H+=aa;V||(I.append(" "),H++)}for(E=u.AParagraphNode.IR(I.toString()," ");G<H&&a.a.Mv(E.charCodeAt(G));)G++;for(;H>G&&a.a.Mv(E.charCodeAt(H-1));)H--;return this.iBk(E,G,H)}vAl(E,G){for(var H;null!==(H=this.Aok.exec(E));){const L=H.index;H=H[0].length;if(G>=L&&G<=L+H)return{start:L,length:H}}return null}iBk(E,G,H){if(E.length>this.qbb){var L=H-G;if(L>
this.qbb)E=E.substr(G,this.qbb),H=this.qbb,G=0;else{L=Math.max(G-Math.floor((this.qbb-L)/2),0);let I;I=Math.min(L+this.qbb,E.length);L=Math.max(I-this.qbb,0);G-=L;H-=L;E=E.substring(L,I)}}return Object.assign(new l.a,{neighborhood:E,mentionStart:G,mentionLength:H-G})}static RT(){var E=y.App.xa.ib.rc;if(!E)return k.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;E=E.lb;return E&&E.gb&&E.gb.length?E.gb.kb:(k.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),
null)}}Object(F.a)(w,"Box4InsightsSelection",null,[508,509])},1846:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(402);class l extends c.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(F.a)(l,"IconGalleryButtonProps",c.a,[])},1847:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.y=this.x=0}}Object(F.a)(l,"IPoint",null,[])},1848:function(F,K,c){c.d(K,"a",function(){return a});
F=c(0);var l=c(19),f=c(7);c=c(1579);class a extends c.a{constructor(k,x,y,n,u){super(k,x,u);this.lk=y;this.vgh=u}xmc(k){let x;if(this.XS&&!k)return f.ULS.sendTraceTag(594408835,307,10,"No htmlDomContent"),{returnValue:!1,$ua:null};if(this.vgh){if(this.lk)return x=this.lk.BYf(k,!1),{returnValue:!0,$ua:x};f.ULS.sendTraceTag(592269661,307,10,"_clipboardDataHelper should not be null")}x=document.createElement("div");k=k.split(RegExp("\r\n|\r|\n"));for(var y=0;y<k.length-1;y++){const n=document.createElement("p");
n.innerText=this.TXc(k[y]);x.appendChild(n)}y=document.createElement("span");y.innerText=l.a.WKc(k[k.length-1]);x.appendChild(y);return{returnValue:!0,$ua:x}}TXc(k){return l.a.WKc(k.length?k:" ")}}Object(F.a)(a,"MultiLineTextImportStrategy",c.a,[])},1849:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(851);class l extends c.a{constructor(f,a,k,x,y=null,n=0,u=0,z=null,w=null,E=null,G=null){super(y?y.t9:null,y?y.yB:null,y?y.Ixa:null,y?y.cultureName:null,y?y.YBa:null);this.src=f;this.alt=
a;this.width=k;this.height=x;this.maxWidth=n;this.maxHeight=u;this.href=z;this.Dll=w;this.Gjf=E;this.kEd=G}}Object(F.a)(l,"ImageSemanticArgs",c.a,[])},1850:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);var l=c(105);class f{constructor(){this.Desc=this.Alt=this.Src=this.ImageId=null;this.ImageAnchorId=this.LockId=this.Height=this.Width=0;this.IsImageFromPaste=!1;this.EditContainerWidth=0;this.LocalizedPicture=null;this.IsLayoutSizeSetByUser=!1;this.ClipServiceArgs=this.WordId=this.RunId=this.ContentNodes=
null}static construct(a,k,x,y,n,u,z,w,E,G,H,L,I,N,Q,M=null){const J=new f;J.ImageId=a;J.Src=k;J.Alt=x;J.Width=y;J.Height=n;J.Desc=u;J.LockId=z;J.ImageAnchorId=w;J.IsImageFromPaste=E;J.EditContainerWidth=G;J.LocalizedPicture=H;J.IsLayoutSizeSetByUser=L;if(I&&0<I.length){J.ContentNodes=Array(I.length);a=0;for(const V of I)J.ContentNodes[a]=l.a(V),a++}J.RunId=N;J.WordId=Q;J.ClipServiceArgs=M;return J}}Object(F.a)(f,"PastedPicture",null,[])},1851:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);
var l=c(22);c=c(580);class f extends c.a{constructor(){super();this.DataUriPictures=!1;this.FileId=this.PastedPictures=null;this.InkExternalPartFileFormatFixIsEnabled=this.PictureEditingInIllustrationCanvasIsEnabled=this.InkEditingInCanvasSupportedIsEnabled=this.ChartsPasteFromXLOIsEnabled=this.ClipServicePictures=!1}fl(){return 31}static construct(a,k,x=null,y=!1){const n=new f;n.DataUriPictures=k;n.PastedPictures=a;(a=l.a.instance.Na("Box4.IFeatureHelper"))&&a.isFeatureEnabled(11)&&a.isFeatureEnabled(49)&&
(n.ClipServicePictures=y,n.ChartsPasteFromXLOIsEnabled=!0,n.InkEditingInCanvasSupportedIsEnabled=!0,n.PictureEditingInIllustrationCanvasIsEnabled=!0,n.InkExternalPartFileFormatFixIsEnabled=!0);x&&x.length&&(n.FileId=x);return n}}Object(F.a)(f,"PicturePasteRequest",c.a,[])},1852:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a,k,x=!1){this.LDb=f;this.LEi=a;this.bTk=k;this.uXm=x}}Object(F.a)(l,"ClearSpecificFormattingProperties",null,[])},1855:function(F,K){Object.defineProperty(K,
"__esModule",{value:!0})},1856:function(F,K){Object.defineProperty(K,"__esModule",{value:!0});K.SuggestionCategory=void 0;F=K.SuggestionCategory||(K.SuggestionCategory={});F[F.TextRelatedImage=0]="TextRelatedImage";F[F.AbstractImage=1]="AbstractImage";F[F.Icon=2]="Icon"},1857:function(F,K){Object.defineProperty(K,"__esModule",{value:!0})},1858:function(F,K){Object.defineProperty(K,"__esModule",{value:!0})},1859:function(F,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.TextToSuggestionSignal=
void 0;var l=c(195);F=function(){function f(a){l.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_TextToSuggestions_TextToSuggestionSignal"};f.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};f.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();K.TextToSuggestionSignal=F},1860:function(F,K,c){c.d(K,"a",function(){return y});F=c(0);var l=c(90),f=c(189),a=c(7),k=c(111),x=c(48);class y{constructor(n,
u,z,w,E,G,H,L,I){this.lyd=0;this.iW=null;this.qdb="";this.cWb=this.cBe=!1;this.oKa=this.i7=null;this.Q6f=!1;this.jVb=null;this.iDo=N=>{this.oKa===N&&(this.oKa=null,this.i7?this.qdb=this.Uea.h2c(this.iW.text):(this.aTf(),this.findInternal(null)),this.mvj())};this.findInternal=()=>{this.i7=null;if(!this.w6e())if(!this.Uea.vLb(this.qdb).length)this.zeb(),this.Oob(!0);else if(!this.U7f())switch(this._state){case 0:this.t4o();break;case 1:this.N7i()}};this.W$a=n;this.Uea=u;this.z3j=z;this.gp=w;this.eJe=
E;this.jxb=G;this.J3j=H;this.kVb=L;this.Qj=I;this._state=2;this.KL=0}get epg(){return this.lyd}set epg(n){this.lyd=n}get wnc(){return this.lyd}set wnc(n){this.lyd=n}get taskManager(){return this.eJe.value}get kNb(){return this.jxb.value}get K5c(){return this.J3j.value}get fDl(){return this.cBe}Oob(n){(this.cBe=n)&&this.W$a&&this.W$a.D6b()}get Nkf(){return null}get qMc(){return this.jVb}find(n){this.iW=n;this.wZk();this.oKa=new l.a(2,1,this.epg,this.iDo,51);this.taskManager.Vb(this.oKa)}LZa(){}T7f(){}Qki(){}Vki(){}wni(){return!1}wZk(){this.i7&&
(this.taskManager.Xe(this.i7),this.i7=null);this.oKa&&(this.taskManager.Xe(this.oKa),this.oKa=null)}t4o(){var n=(new Date).getTime();this.ITi();const u=this.u4o(n);this._state||(this.i7=new l.a(2,1,this.wnc,this.findInternal,52),this.taskManager.Vb(this.i7));n=(new Date).getTime()-n;a.ULS.sendTraceTag(17306246,313,50,"{0}",{["Extension Walk Time"]:n,["Count"]:u})}zwf(n,u,z=!0){this.cDh(n);if(Object(k.a)(59,n))if(12===n.type)this.$lm(n,u,this.cWb,z);else{const w=this.gp.uib(n.oEa(),this.qMc);z&&(w&&
0<w.length?this.dTa(n,w):n.nma());z=this.gp.F4d(n.id,w,null,u,this.cWb);this.Fzd(n.id,z,n,u);this.BMf(n)}}$lm(n,u,z,w=!0){const E=[];var G=this.gp.s9h(n);if(!f.a.jf(G)&&(this.BMf(n),w))for(var H of G)G=this.gp.uib(H.oEa(),this.qMc),f.a.jf(G)?this.nma(H):(this.dTa(H,G),E.push(G));H=x.a.Vj?this.gp.k_l(n,this.qMc):this.gp.uib(n.oEa(),this.qMc);this.nma(n);!f.a.jf(H)&&w&&this.dTa(n,H);z=this.gp.F4d(n.id,H,E,u,z);this.Fzd(n.id,z,n,u)}u4o(n){let u=this._state=0;const z=this.mhi();this.s3i();const w=this.loj();
do this.QWf(),u++;while(this.z9e(z)&&(new Date).getTime()-n<y.WNi);w&&w.dispose();this.LSf();return u}aTf(){}mvj(){}w6e(){return!1}zeb(){}U7f(){return!1}N7i(){}ITi(){}cDh(){}dTa(){}nma(){}BMf(){}Fzd(){}LSf(){}mhi(){return null}s3i(){}loj(){return null}QWf(){}z9e(){return!1}}y.WNi=200;Object(F.a)(y,"BaseFindManager",null,[1525])},1861:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a,k){this.rootNode=f;this.jja=a;this.J6b=k}}Object(F.a)(l,"FindNodeContext",null,[])},1867:function(F,
K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a=null,k=null,x=null){this.iconSet={};this.iconSet["default"]=f;this.iconSet.icon16=a;this.iconSet.icon24=k;this.iconSet.icon32=x}}Object(F.a)(l,"IconSetContainer",null,[])},1870:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);c=c(453);class l extends c.a{constructor(){super()}}l.D$e="conversionRequestType";l.DZf="png";l.Lmf="gc2json";l.strict="strict";l.azl="existingcontent";l.error="error";Object(F.a)(l,"GraphicsEditorParameters",
c.a,[])},1883:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f){this.Urb=0;this.lpd=isFinite(f)?Math.max(f,8):8;this.hp=Array(this.lpd);this.fj=this.udb=this.JXa=0;this.FQg=this.C7h(this.lpd)}get count(){return this.fj}get isEmpty(){return!this.count}enqueue(f){this.count===this.Urb&&this.hxm();this.hp[this.udb]=f;this.udb++;this.udb===this.Urb&&(this.udb=0);this.fj=this.count+1}dequeue(){if(!this.count)throw Error.create("Empty Queue");const f=this.hp[this.JXa];this.JXa++;
this.JXa===this.Urb&&(this.JXa=0);this.fj=this.count-1;this.count<=this.FQg&&this.lil();return f}QA(){if(!this.count)throw Error.create("Empty Queue");return this.hp[this.JXa]}hxm(){this.Hmj(2*this.Urb)}lil(){const f=Math.max(this.Urb/2,this.lpd);this.count>f||this.Hmj(f)}Hmj(f){const a=Array(f);let k=0;if(this.JXa<this.udb||!this.count)for(var x=this.JXa;x<this.udb;x++)a[k]=this.hp[x],k++;else{for(x=this.JXa;x<this.Urb;x++)a[k]=this.hp[x],k++;for(x=0;x<this.udb;x++)a[k]=this.hp[x],k++}this.hp=a;
this.Urb=f;this.JXa=0;this.udb=k;this.FQg=this.C7h(f)}C7h(f){return f<=this.lpd?-1:Math.floor(.25*f)}}Object(F.a)(l,"Queue",null,[])},1949:function(F,K){Object.defineProperty(K,"__esModule",{value:!0})},1950:function(F,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.AiInsertAnnotation=void 0;const l=c(195);class f{constructor(a){l.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_AiInsert_AiInsertAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,
[f.getTypeName()])}}K.AiInsertAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1951:function(F,K){Object.defineProperty(K,"__esModule",{value:!0})},1952:function(F,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.AiInsertSignal=void 0;const l=c(195);class f{constructor(a){l.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_AiInsert_AiInsertSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}
K.AiInsertSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1953:function(F,K){Object.defineProperty(K,"__esModule",{value:!0});K.Status=void 0;F=K.Status||(K.Status={});F[F.Success=0]="Success";F[F.BlockedByLanguageDetector=1]="BlockedByLanguageDetector";F[F.BlockedByPrefilter=2]="BlockedByPrefilter";F[F.BlockedByContentModerator=3]="BlockedByContentModerator";F[F.BlockedByPostfilter=4]="BlockedByPostfilter";F[F.FailedToGenerateContent=5]="FailedToGenerateContent";F[F.UnexpectedError=6]="UnexpectedError"},
1954:function(F,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.QualityStatus=void 0;const l=c(195);class f{constructor(a){l.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_AiInsert_QualityStatus"}static getBaseTypes(){return[]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}K.QualityStatus=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1963:function(F,K,c){c.r(K);F=c(0);var l=c(2),f=c(90),a=c(2044),k=c(7),x=c(67),y=c(55),n=c(111),u=c(242),
z=c(536),w=c(368),E=c(75),G=c(3),H=c(9),L=c(70),I=c(43),N=c(1044),Q=c(5),M=c(94);class J extends L.a{constructor(){super(new M.a(33));this.Pkf=this.R8f=0}HWd(){return 0}mGa(){const eb=new I.GraphTransaction(3);eb.Cb(this);const jb=new Q.GraphIterator;jb.set(this);if(jb.vz()){const ub=jb.Pd();jb.set(ub);const ab=N.b(jb,this.R8f,this.Pkf),Ea=new Q.GraphIterator;Ea.set(this);Ea.Pd();Ea.xg();ab&&jb.currentNode!==ub&&Ea.Af(jb.currentNode,-2)}eb.dispose()}}Object(F.a)(J,"FindTrackingNode",L.a,[]);var V=
c(17),X=c(46),W=c(8),U=c(1860),Y=c(1861);class ba{constructor(eb){this.Wc=eb;eb=[];eb.push(1);this.thg=eb}q9h(eb){const jb=this.Wc.Bk();jb.set(eb);const ub=[];jb.zb(8)&&(jb.jd(8),ub.push(new Y.a(jb.currentNode,eb,1)));return ub}static ZE(){return new ba(new z.a)}static get instance(){return null!=ba.SBg?ba.SBg:ba.SBg=ba.ZE()}}Object(F.a)(ba,"FindContextHelper",null,[393]);var aa=c(1545),fa=c(364),na=c(108),oa=c(16);class ja{constructor(eb,jb,ub,ab,Ea,Wa,Bb,Mb,Fb){this.uo=null;this.HVb=this.OCe=!1;
this.q$a=this.kLg=this.F9a=null;this.xdh=!1;this.tY=(vb,$a)=>{vb=$a.node;$a.property===oa.a.lo&&this.iVc(vb)&&this.QFb(vb,3)};this.smb=(vb,$a)=>{vb=$a.node;this.iVc(vb)&&this.QFb(vb,2)};this.bia=(vb,$a)=>{vb=$a.node;$a=$a.PCf;!this.bB.fDl&&$a||!this.iVc(vb)||this.QFb(vb,1)};this.processDirtyNodes=()=>{const vb=this.ge.Zf("UserAction","ProcessDirtyNodesInFindResultsTime");this.uo=null;const $a=this.Ic.Oc(3);$a.Cb(this.gp.Uc);0<this.addedNodes.count&&(this.HVb=!0,this.UOg(this.addedNodes,this.bB.Qj));
0<this.CJc.count&&this.UOg(this.CJc,this.bB.Qj);if(0<this.Heb.count){const kb=!this.shk(this.Heb,this.bB,this.gp,this.rhk);this.HVb=this.HVb||kb}$a.dispose();this.bB.Qj.qqb();this.Fob(this.HVb);this.Ihj();vb.stop()};this.Vbo=()=>{this.cEd();if(0<this.Heb.count||0<this.addedNodes.count||0<this.CJc.count)this.uo=new f.a(2,1,500,this.processDirtyNodes,53),this.Gb.Vb(this.uo)};this.bB=eb;this.SV=jb;this.gp=ub;this.Gb=ab;this.Ic=Ea;this.UOg=Wa;this.shk=Bb;this.rhk=Mb;this.ge=Fb;this.reset();this.Ihj=this.Vbo;
this.gp.lde(this.tY,this.bia,this.smb)}get Heb(){return this.F9a}get addedNodes(){return this.kLg}get CJc(){return this.q$a}get Tej(){return this.xdh}get Kqm(){return 0<this.Heb.count||0<this.CJc.count}start(){this.OCe=!0;this.Fob(!1)}stop(){this.reset()}reset(){this.OCe=!1;this.Fob(!1);this.F9a=new fa.a;this.kLg=new fa.a;this.q$a=new fa.a;this.cEd()}iVc(eb){return!!eb.Kc&&!!this.gp.Aj&&eb.Kc.id.equals(this.gp.Aj.id)}QFb(eb,jb){if(this.OCe&&Object(n.a)(59,eb)&&!this.bB.kNb.d5c)if(this.bB.Qj.E7a||
this.bB.Qj.Nkb.length){switch(jb){case 1:this.Heb.mb(eb.id)||this.addedNodes.Z(eb.id,eb);break;case 2:this.Heb.mb(eb.id)&&this.Heb.remove(eb.id);this.addedNodes.mb(eb.id)?this.addedNodes.remove(eb.id):this.CJc.Z(eb.id,eb);break;case 3:this.Heb.Z(eb.id,eb)}this.Ihj()}else 2!==jb&&this.Fob(this.HVb=!0)}cEd(){this.uo&&(this.Gb.Xe(this.uo),this.uo=null)}Fob(eb){this.Tej!==eb&&(this.xdh=eb,this.SV.Fob(eb));eb||(this.HVb=!1)}static ZE(eb,jb){return new ja(eb,jb,aa.FindManagerHelper.instance,na.a.instance,
new w.a,ja.RYk,ja.mZn,ja.lZn,H.App.xa.Hq)}static createInstance(eb,jb){return ja._instance||(ja._instance=ja.ZE(eb,jb))}static mZn(eb,jb,ub,ab){let Ea=!1;const Wa=ja.wji(eb,ja.$bn);for(let Bb=0;Bb<Wa.length;++Bb){const Mb=!ab(Wa[Bb],jb,ub);Ea=Ea||Mb;eb.remove(Wa[Bb].id)}return!Ea}static lZn(eb,jb,ub){const ab=jb.Qj;eb.nma();const Ea=eb.id,Wa=ab.O8b(Ea);if(Wa)jb=ub.uib(eb.oEa(),jb.qMc),ub=ub.F4d(Ea,jb,null,Wa.type,Wa.SXd),eb.dTa(jb),ab.gee(Ea,ub);else return!1;return!0}static RYk(eb,jb){const ub=ja.wji(eb,
ja.Zbn);for(let ab=0;ab<ub.length;++ab){const Ea=ub[ab],Wa=Ea.id;Ea.nma();jb.G4c(Wa);eb.remove(Wa)}}static wji(eb,jb){const ub=[];let ab=jb;eb.forEach((Ea,Wa)=>{ub.push(Wa);--ab;return ab?!0:!1});return ub}}ja.$bn=5;ja.Zbn=15;ja._instance=null;Object(F.a)(ja,"FindResultAppEventCoordinator",null,[1542]);class qa{constructor(eb,jb){this.vyb=this.ySb=0;this.irc=this.JBc=this.Pja=null;this.w_b=0;this.$ub=null;this.SV=eb;this.wka=jb;this.VXa=new fa.a;this.nxb=new fa.a;this.Abb=new fa.a;this.y$a=new fa.a;
this.UXa=new fa.a(0);this.lAc=new fa.a;for(eb=0;eb<jb.length;++eb)this.UXa.Z(jb[eb],0);this.Nkb=[]}get EE(){return this.Pja}set EE(eb){this.Pja=eb;eb=Array(1);eb[0]=this.Pja;this.SV.COa(3,eb)}get b$(){return this.JBc}set b$(eb){this.JBc=eb}get A3(){return this.irc}set A3(eb){this.irc=eb}get $Da(){let eb=null;for(const jb of this.wka)if(eb=this.VXa.J(jb))break;return eb}get QYe(){return this.ySb}cie(eb){eb!==this.ySb&&(this.ySb=eb)}get tja(){return this.vyb}Cjc(eb){eb!==this.vyb&&(this.vyb=eb,this.SV&&
!this.vyb&&(this.SV.qge(0),this.SV.Yhe(0)))}get E7a(){return this.w_b}get Mcc(){return this.$ub}YYe(eb,jb){if(eb&&!(0>=eb.length)){var ub=eb[0].type,ab=jb,Ea=ab?ab.next:this.VXa.J(ub);ab||this.VXa.Z(ub,eb[0]);for(const Wa of eb){const Bb=Wa;this.lAc.Z(Bb.id,Bb);ab&&(ab.next=Bb);Bb.previous=ab;ab=Bb}ab&&(ab.next=Ea);Ea&&(Ea.previous=ab);jb&&eb[0].nodeId.equals(jb.nodeId)||this.Abb.Z(eb[0].nodeId,eb[0]);!Ea&&ab&&this.nxb.Z(ab.type,ab);this.Mcc===jb&&(this.$ub=ab);this.UXa.Z(ub,this.UXa.J(ub)+eb.length);
this.Cjc(this.tja+eb.length);this.w_b=this.E7a+eb.length;this.SV&&this.SV.COa(0,eb)}}Kzd(eb){!eb||0>=eb.length||this.YYe(eb,this.nxb.J(eb[0].type))}xnh(eb){!eb||0>=eb.length||(this.Mcc&&this.Mcc.type!==eb[0].type&&(this.$ub=null),this.YYe(eb,this.Mcc))}G4c(eb){const jb=this.O8b(eb);if(jb){eb=jb;for(var ub=0;eb;){++ub;if(!eb.next||!eb.nodeId.equals(eb.next.nodeId))break;eb=eb.next}this.Naj(jb,eb)}else k.ULS.sendTraceTag(4069027,313,15,"RemoveResultsForNode called for node not in cache: {0}",eb.toString())}Naj(eb,
jb){let ub=0,ab=0;const Ea=[];let Wa=eb;for(;Wa!==jb.next;){const Bb=this.DBi(Wa);this.Abb.J(Wa.nodeId).id===Wa.id&&(Wa.next&&Wa.next.nodeId.equals(Wa.nodeId)?(this.Abb.Z(Wa.nodeId,Wa.next),Bb&&this.y$a.Z(Wa.nodeId,Wa.next)):(this.Abb.remove(Wa.nodeId),Bb&&this.y$a.remove(Wa.nodeId)));this.Mcc&&this.Mcc.id===Wa.id&&(this.$ub=eb.previous);this.b$&&this.b$.id===Wa.id&&(this.b$=this.rsf(Wa,eb));this.A3&&this.A3.id===Wa.id&&(this.A3=this.rsf(Wa,eb));this.EE&&this.EE.id===Wa.id&&(this.EE=this.rsf(Wa,eb));
this.lAc.remove(Wa.id);Ea.push(Wa);Wa=Wa.next;Bb?++ab:++ub}eb.previous?eb.previous.next=jb.next:jb.next?this.VXa.Z(jb.type,jb.next):this.VXa.remove(jb.type);jb.next?jb.next.previous=eb.previous:eb.previous?this.nxb.Z(eb.type,eb.previous):this.nxb.remove(eb.type);jb.next=null;eb.previous=null;this.UXa.Z(eb.type,this.UXa.J(eb.type)-ub);this.Cjc(this.tja-ub);this.w_b=this.E7a-(ub+ab);this.SV&&this.SV.COa(1,Ea)}gee(eb,jb){const ub=this.O8b(eb);if(ub){const ab=[],Ea=[],Wa=[];let Bb=ub,Mb,Fb=0;do Fb<jb.length?
(Bb.p8k(jb[Fb]),ab.push(Bb)):(Ea.push(Bb),this.b$&&this.b$.id===Bb.id&&0<ab.length&&(this.b$=ab[ab.length-1])),++Fb,Mb=Bb,Bb=Bb.next;while(Bb&&Mb.nodeId.equals(Bb.nodeId));for(;Fb<jb.length;++Fb)Wa.push(jb[Fb]);0<Ea.length&&this.Naj(Ea[0],Ea[Ea.length-1]);0<Wa.length&&this.YYe(Wa,0<ab.length?ab[ab.length-1]:ub);jb=ab.length;if(0<jb){if(this.y$a.mb(eb)){this.y$a.remove(eb);this.Cjc(this.tja+jb);let vb,$a;(vb=this.UXa).Z($a=ab[0].type,vb.J($a)+jb)}this.SV&&this.SV.COa(4,ab)}}else k.ULS.sendTraceTag(4069056,
313,15,"ReplaceResultsForNode: NodeId not found in cache nodeId={0}",eb.toString())}JEh(){this.Abb=new fa.a;this.y$a=new fa.a;this.VXa=new fa.a;this.nxb=new fa.a;this.lAc=new fa.a;for(let eb=0;eb<this.wka.length;++eb)this.UXa.Z(this.wka[eb],0);this.EE=null;this.cie(0);this.A3=this.b$=this.$ub=null;this.Cjc(0);this.w_b=0;this.SV&&this.SV.COa(2,null)}eNi(){this.y$a=new fa.a;this.Abb.forEach((eb,jb)=>{this.y$a.Z(eb,jb);return!0});for(let eb=0;eb<this.wka.length;++eb)this.UXa.Z(this.wka[eb],0);this.EE=
null;this.cie(0);this.$ub=null;this.Cjc(0);this.SV&&this.SV.COa(2,null)}O8b(eb){return this.Abb.mb(eb)?this.Abb.J(eb):null}ek(eb){let jb=null;this.lAc.mb(eb)&&(jb=this.lAc.J(eb));return jb}C9h(eb){return this.VXa.mb(eb)?this.VXa.J(eb):null}J1l(eb){return this.nxb.mb(eb)?this.nxb.J(eb):null}qqb(){var eb=0;if(this.EE){eb=0;const ab=this.EE.type;var jb=this.VXa.J(ab);if(jb){for(var ub=1;jb&&this.EE.id!==jb.id;)this.DBi(jb)||++ub,jb=jb.next;jb&&(eb=ub)}if(jb){jb=0;for(ub=0;ub<this.wka.length&&this.wka[ub]!==
ab;++ub)jb+=this.UXa.J(this.wka[ub]);eb=jb+eb}else k.ULS.sendTraceTag(4069057,313,10,"UpdateActiveIndexFromActiveResult, active result not found in cache, setting it to null"),this.EE=null,eb=0}this.cie(eb);this.SV&&(this.SV.qge(this.QYe),this.SV.Yhe(this.tja))}q1a(eb){return this.dRd(eb,!1)}RRd(eb){return this.dRd(eb,!0)}dRd(eb,jb){let ub=jb?eb.previous:eb.next,ab=eb.type;for(;!ub&&(ab=this.x5l(ab,jb),ub=jb?this.J1l(ab):this.C9h(ab),ab!==eb.type););return ub||eb}S7b(eb){return this.x6h(eb,!1)}abi(eb){return this.x6h(eb,
!0)}x6h(eb,jb){let ub=this.dRd(eb,jb);for(;ub.nodeId.equals(eb.nodeId)&&ub.id!==eb.id;)ub=this.dRd(ub,jb);return ub}x5l(eb,jb){let ub=0;for(let ab=0;ab<this.wka.length;++ab)if(eb===this.wka[ab]){ub=ab;break}jb?(--ub,0>ub&&(ub=this.wka.length-1)):(++ub,ub===this.wka.length&&(ub=0));return this.wka[ub]}iej(){this.$ub=null}rsf(eb,jb){eb=this.q1a(eb);eb.id===jb.id&&(eb=null);return eb}DBi(eb){return this.y$a.mb(eb.nodeId)}static createInstance(eb,jb,ub=!1){return ub?new qa(eb,jb):qa._instance||(qa._instance=
new qa(eb,jb))}}qa._instance=null;Object(F.a)(qa,"FindResultManager",null,[1524]);class Ia{constructor(eb,jb){this.tlm=ub=>{const ab=this.gp.Aj.Db(ub.nodeId);if(ab){if(this.pC.EE){var Ea=this.gp.Aj.Db(this.pC.EE.nodeId);(Ea=Object(x.a)(59,Ea))?Ea.kEh():k.ULS.sendTraceTag(4069060,313,15,"{0}",{["GoToResultInternal"]:"ActiveHitNodeNotFound",["NodeId"]:this.pC.EE.nodeId})}ab.oMf(ub.FPa,ub.type)?(this.pC.EE=ub,k.ULS.sendTraceTag(4065305,313,50,"{0}",{["GoToResultInternal"]:"Success",["ResultId"]:ub.id})):
c(1963).FindManager.instance.wni()?k.ULS.sendTraceTag(4575581,313,15,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:ab.id,["HitIndexInNode"]:ub.FPa,["ResultId"]:ub.id}):k.ULS.sendTraceTag(4069061,313,10,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:ab.id,["HitIndexInNode"]:ub.FPa,["ResultId"]:ub.id});this.pC.qqb()}else k.ULS.sendTraceTag(4069059,313,10,"{0}",{["GoToResultInternal"]:"Invalid findResult.NodeId",["NodeId"]:ub.nodeId})};this.pC=eb;this.gp=jb;this.hwf=this.tlm}Tki(){const eb=
this.pC.EE?this.pC.q1a(this.pC.EE):this.pC.$Da;this.hwf(eb)}slm(){const eb=this.pC.EE?this.pC.RRd(this.pC.EE):this.pC.$Da;this.hwf(eb)}Xki(eb){const jb=this.pC.ek(eb);jb?this.hwf(jb):k.ULS.sendTraceTag(4069058,313,10,"{0}",{["GoToResult"]:"Invalid FindResult",["ResultId"]:eb})}static ZE(eb){return new Ia(eb,aa.FindManagerHelper.instance)}static createInstance(eb){return Ia._instance||(Ia._instance=Ia.ZE(eb))}}Ia._instance=null;Object(F.a)(Ia,"FindResultNavigator",null,[1522]);var Va=c(19),Na=c(1212);
L=c(145);class za{static vLb(eb){const jb=[];var ub=RegExp('"[^"\\r\\n]*"',"ig"),ab=eb.match(ub);let Ea;if(ab&&0<ab.length)for(Ea=0;Ea<ab.length;Ea++){var Wa=ab[Ea].split('"').join("");Wa=Wa.trim();Wa=Wa.split(za.m9c).join(" ");if(""!==Wa){jb.push(Wa);var Bb=Wa.split(za.punctuation).join(" ");Bb=Bb.trim();Bb=Bb.split(za.m9c).join(" ");""!==Bb&&Bb!==Wa&&jb.push(Bb)}}eb=eb.split(ub).join(" ");ub=Na.a.instance.qPl(eb);if(!ub.length)return jb.sort(za.xuj),jb;ab=ub[0];for(Ea=1;Ea<ub.length;Ea++)if(Bb=
ub[Ea],2!==ab.CL||2!==Bb.CL)Wa=eb.substring(ab.cp,Bb.cp),Wa=Wa.trim(),za.pEi(Wa,ab)&&jb.push(Wa),ab=Bb;Wa=eb.substring(ab.cp,eb.length);Wa=Wa.trim();za.pEi(Wa,ab)&&jb.push(Wa);jb.sort(za.xuj);return jb}static pEi(eb,jb){return""!==eb&&'"'!==eb&&1!==jb.CL}static N4n(eb){for(let jb=0;jb<eb.length;jb++)eb[jb]=eb[jb].split(za.m9c).join("\\s+");return eb}static xuj(eb,jb){return eb.length>jb.length?-1:eb.length===jb.length?0:1}}za.punctuation=RegExp("[\\[\\]\\\\\\^\\$\\.\\|\\+\\(\\)\\?\\*\\-_=,;:%!'<>/@#&{}]");
za.m9c=RegExp("\\s+");za.aVn=[new L.a(RegExp("\\[","g"),"\\["),new L.a(RegExp("\\]","g"),"\\]"),new L.a(RegExp("\\\\","g"),"\\\\"),new L.a(RegExp("\\^","g"),"\\^"),new L.a(RegExp("\\$","g"),"\\$"),new L.a(RegExp("\\.","g"),"\\."),new L.a(RegExp("\\|","g"),"\\|"),new L.a(RegExp("\\+","g"),"\\+"),new L.a(RegExp("\\(","g"),"\\("),new L.a(RegExp("\\)","g"),"\\)"),new L.a(RegExp("\\?","g"),"\\?"),new L.a(RegExp("\\*","g"),"\\*")];Object(F.a)(za,"SearchAndFindUtils",null,[]);class la{h2c(eb){return Va.a.oga(eb,
za.aVn)}vLb(eb){eb=za.vLb(eb);return eb=za.N4n(eb)}w3i(){return null}v0d(){return!1}static get instance(){return null!=la.sCg?la.sCg:la.sCg=new la}}Object(F.a)(la,"QueryProcessor",null,[930]);var va=c(719),ia=c(22),pa=c(12),sa=c(28),Ha=c(639),ra=c(755),Ma=c(201),ya=c(233);class Ga{constructor(){this.e5c=this.transaction=null;this.oIa=this.S6f=0;this.P6f=this.Dfb=null}}Object(F.a)(Ga,"ReplaceAllContext",null,[]);class wa{constructor(eb,jb,ub,ab,Ea,Wa,Bb,Mb,Fb,vb,$a){this.Fpn=(kb,Ua,Sa,xb,Qb)=>{let Ib=
null;if(kb>Ua)for(Ib=Sa;0<Ua&&Ib.nodeId.equals(Qb.id);)Ib=this.pC.q1a(Ib),--Ua;else 0<kb?Ib=this.pC.S7b(Sa):xb.nodeId!==Qb.id&&(Ib=xb);return Ib};this.BEh=()=>{const kb=this.pC.Nkb;if(kb&&0<kb.length){const Ua=this.Ic.Oc(3);Ua.Cb(this.gp.Aj.Db(kb[0]));for(let Sa=0;Sa<kb.length;++Sa){const xb=this.gp.Aj.Db(kb[Sa]);xb?xb.nma(!1,!0):k.ULS.sendTraceTag(4069064,313,10,"Last replaced node not found in object Space, NodeId: {0}",kb[Sa])}Ua.dispose();Array.clear(this.pC.Nkb)}};this.wvn=(kb,Ua)=>{this.cAc=
!0;this.qaj();const Sa=new Ga;Sa.e5c=kb?kb:"";Sa.P6f=Ua;Sa.oIa=this.pC.tja;kb=this.Ic.Oc(15);kb.Cb(this.gp.Uc);Sa.transaction=kb;this.Qyl(Sa,kb)};this.Xon=(kb,Ua)=>{kb=new va.a(null,this.dKn,kb);const Sa=this.gp.Uc;Sa&&Sa.GH().jF.z7(9);kb.Jl("ReplaceAll");Ua.zHa(kb);kb.run()};this.htn=(kb,Ua)=>{kb=this.ge.Zf("UserAction","OnProcessReplaceAll");if(this.RRm(Ua))return this.L3k(Ua),!1;let Sa=Ua.Dfb;Sa||(Sa=this.pC.$Da);Ua.Dfb=this.pC.S7b(Sa);const xb=this.gp.Aj.Db(Sa.nodeId);if(!xb)return k.ULS.sendTraceTag(4065307,
313,10,"ReplaceAll: Node for result with id: {0} and nodeId: {1}, Not Found!",Sa.id,Sa.nodeId),!0;const Qb=xb.cPa();if(Qb&&Qb.length)if(this.OVk(xb,Qb[0].begin,Qb[0].end))k.ULS.sendTraceTag(5007254,313,50,"ReplaceAll: Skipping node: {0} as Paragraph is locked",xb.id);else{let Ib=0;for(let $b=0;$b<Qb.length;++$b){Ua.S6f+=1;const hc=this.replaceText(this.bB.Nkf,xb,Ua.e5c,sa.a.createTextRange(xb,Qb[$b].begin+Ib,Qb[$b].end+Ib));Ib+=Ua.e5c.length-(Qb[$b].end-Qb[$b].begin)+hc;xb.Mbg(0,Ua.e5c.length)}0<
Ua.e5c.length&&this.pC.Nkb.push(Sa.nodeId)}else k.ULS.sendTraceTag(4065308,313,15,"ReplaceAll: No hits found for result with id: {0} and nodeId: {1}!",Sa.id,Sa.nodeId);kb.stop();return!0};this.xnn=kb=>{kb.transaction.dispose();this.cAc=!1;this.bB.LZa(!1);kb.P6f&&kb.P6f(kb.S6f,kb.oIa)};this.Utn=(kb,Ua,Sa,xb)=>{!kb.matchCase&&0<Sa.length&&(kb=Ua.oEa().substr(xb.cpBegin,xb.cpEnd-xb.cpBegin),Sa=this.yUk(Sa,kb));return this.dAc(xb,Sa,!0,!1)};this.bB=eb;this.pC=jb;this.gp=ub;this.Ic=ab;this.dJe=Ea;this.P8j=
Bb;this.TKg=Mb;this.dAc=Fb;this.$$j=vb;this.ge=$a;this.cAc=!1;this.EDo=this.wvn;this.dKn=this.htn;this.L3k=this.xnn;this.Qyl=this.Xon;this.qaj=this.BEh;this.replaceText=this.Utn;this.yUk=wa.Hmn;this.E5l=this.Fpn}get U0(){return this.dJe.value}get d5c(){return this.cAc}replace(eb){var jb=!1;if(this.d5c)return k.ULS.sendTraceTag(4069062,313,15,"Replace: Cancelled as replace is already in progress"),jb;if(this.U0.ghl){var ub=this.U0.L3;const Wa=ub.node;ub.contextId===pa.a.paragraph&&(ub=sa.a.createTextRange(Wa,
0,W.ParagraphReader.textLength(Wa)));var ab=Object(x.a)(59,Wa);if(ab){var Ea=new ra.a(ub.cpBegin,ub.cpEnd);Ea=ab.iai(Ea);if(Ea!==Ha.a.invalid&&0<=Ea){if(this.MCh(ub))return k.ULS.sendTraceTag(5007250,313,50,"Replace: Cancelled as Paragraph is locked"),jb;this.cAc=!0;jb=this.Ic.Oc(15);jb.Cb(Wa);this.replaceText(this.bB.Nkf,ab,eb,ub);jb.dispose();this.qaj();ab.Mbg(Ea,eb.length);0<eb.length&&this.pC.Nkb.push(Wa.id);eb=this.pC.O8b(Wa.id);ub=this.pC.q1a(eb);ab=ab.cPa();ab=this.gp.F4d(Wa.id,ab,null,eb.type,
eb.SXd);this.pC.gee(Wa.id,ab);(ub=this.E5l(ab.length,Ea,eb,ub,Wa))?this.bB.K5c.Xki(ub.id):this.pC.qqb();jb=!0;this.cAc=!1}else k.ULS.sendTraceTag(5007251,313,50,"Replace: Cancelled as current selection not on a find hit.")}else k.ULS.sendTraceTag(4069063,313,15,"Replace: Failed as No node found corresponding to current selection")}else k.ULS.sendTraceTag(5007252,313,50,"Replace: Cancelled as current selection does not contain single context");jb?(k.ULS.sendTraceTag(4065306,313,50,"ReplaceManager Replace Success"),
this.bB.Q6f=!0):(k.ULS.sendTraceTag(5007253,313,50,"ReplaceManager Replace Not Successful"),this.bB.K5c.Tki());return jb}replaceAll(eb,jb){this.d5c?k.ULS.sendTraceTag(4069065,313,15,"ReplaceAll: Called when Replace is already in Progress"):this.pC.tja?this.EDo(eb,jb):k.ULS.sendTraceTag(4069066,313,15,"ReplaceAll: Called when total results is 0")}MCh(eb){const jb=this.P8j(eb);!jb&&this.TKg.value&&this.$$j.value&&this.TKg.value(eb.node);return jb}OVk(eb,jb,ub){return this.MCh(sa.a.createTextRange(eb,
jb,ub))}RRm(eb){return eb.Dfb===this.pC.$Da}static get characterPropertiesEditor(){return null!=wa.Swg?wa.Swg:wa.Swg=ia.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static ZE(eb,jb){const ub=new u.a(()=>H.App.rd&&H.App.rd.Tp?Object(y.a)(H.App.rd.Tp,H.App.rd.Tp.VF,"acquireAndApplyLock"):null);return new wa(eb,jb,aa.FindManagerHelper.instance,new w.a,new u.a(()=>Ma.a.instance),new u.a(()=>X.a.instance),Object(y.a)(ya.a.instance,ya.a.instance.VIm,"isContextSetInLockedRange"),ub,Object(y.a)(wa.characterPropertiesEditor,
wa.characterPropertiesEditor.replaceTextRange,"replaceTextRange"),new u.a(()=>H.App.rd.Qo),H.App.xa.Hq)}static createInstance(eb,jb){return wa._instance||(wa._instance=wa.ZE(eb,jb))}static Hmn(eb,jb){const ub=Va.a.Ug(jb);!Va.a.localeCompare(Va.a.XA(jb),jb)&&Va.a.localeCompare(ub,jb)?eb=Va.a.XA(eb):Va.a.kcc(jb.charAt(0))&&!Va.a.JEf(jb.charAt(0))&&(jb=Va.a.XA(eb.substr(0,1)),eb=1===eb.length?jb:jb+eb.substr(1,eb.length-1));return eb}}wa._instance=null;Object(F.a)(wa,"ReplaceManager",null,[1467]);c.d(K,
"FindManager",function(){return hb});class hb extends U.a{constructor(eb,jb,ub,ab,Ea,Wa,Bb,Mb,Fb,vb,$a,kb,Ua,Sa,xb,Qb=!1){super(eb,jb,ub,Ea,Wa,Ua,Sa,$a,kb);this.vka=this.JAc=null;this.nyd=!1;this.TBa=this.m$a=this.cbb=null;this.Tsc=0;this.Ovd=ab;this.kvb=Bb;this.Wc=Mb;this.Ic=Fb;this.sOe=vb;this.I3j=xb;this.Bwc=[];this._state=2;this.Nxb=!Qb;this.xsb=new J;this.gp.a_e(this.xsb);this.OZb=new J;this.gp.a_e(this.OZb);this.gp.Uc&&(this.cbb=this.gp.Aj);this.epg=400;this.wnc=100}get lb(){return this.kvb.value}get Nkf(){return this.JAc}get uMd(){return this.I3j.value}LZa(eb=
!0){this.kNb&&this.kNb.d5c||(this.zeb(eb),this.W$a.reset(),this.qdb="",this.Ovd&&this.uMd.stop(),this.xZk(),this.Inj(null))}xZk(){this.i7&&(this.taskManager.Xe(this.i7),this.i7=null);this.oKa&&(this.taskManager.Xe(this.oKa),this.oKa=null)}zeb(eb=!0){!this.cbb&&0<this.Qj.E7a&&k.ULS.sendTraceTag(4235910,313,10,"{0}",{["CancelFind"]:"LastKnowSpaceNull"});if(0<this.Qj.E7a&&this.cbb){let ub=this.Qj.$Da;const ab=ub.nodeId;if(this.cbb.Db(ab)){const Ea=this.Ic.Oc(3);for(Ea.Cb(this.cbb.Db(ab));ub;){const Wa=
this.cbb.Db(ub.nodeId);var jb=Object(x.a)(59,Wa);if(jb){if(this.Nxb&&(jb.nma(void 0,eb),W.ParagraphReader.Wb(Wa)&&(jb=this.gp.s9h(Wa))))for(const Bb of jb)Bb.nma(void 0,eb);Wa.gl(16,!0)}ub=this.Qj.S7b(ub);if(!ub||ub.nodeId.equals(ab))break}Ea.dispose()}else k.ULS.sendTraceTag(4235911,313,10,"ClearFindHits: Error - node not in last known space");this.Qj.JEh()}eb&&this.kNb&&this.kNb.BEh();this.oej();this.Bwc=[];this.jVb=this.JAc=null;this.KL=0;this.Q6f=this.nyd=!1}T7f(){const eb=this.iW;this.zeb();
eb&&""!==eb.text&&this.find(eb)}wni(){return this.Ovd&&this.uMd.Kqm}Kej(){10>this.Tsc?(this.Tsc++,k.ULS.sendTraceTag(4069014,313,15,"{0}",{["ErrorRestartCount"]:this.Tsc}),this.find(this.iW)):(k.ULS.sendTraceTag(4235912,313,10,"RestartFindAfterErrorCondition: max retries reached"),l.AFrameworkApplication.va.processAction(G.a.B2b,2),this.Tsc=0)}N7i(){var eb=(new Date).getTime();let jb=!1;this.Qj.E7a||(jb=!0);let ub=0;if(!jb){this.Qj.b$||(this.Qj.b$=this.Qj.$Da);this.Qj.A3||(this.Qj.A3=this.Qj.b$,this.Qj.EE=
null);let ab=null,Ea=!0;for(;!jb&&this.Qj.A3&&(new Date).getTime()-eb<U.a.WNi;){const Wa=this.Qj.A3,Bb=this.gp.Aj.Db(Wa.nodeId);Bb?(Ea&&(ab=this.Ic.Oc(3),ab.Cb(Bb),Ea=!1),Wa.SXd&&!this.m$a&&(this.m$a=Bb),this.Qj.A3=this.Qj.S7b(this.Qj.A3),jb=!this.Qj.A3||this.Qj.A3.nodeId.equals(this.Qj.b$.nodeId),this.zwf(Bb,Wa.type,this.Nxb),++ub):this.Qj.G4c(Wa.nodeId)}ab&&ab.dispose()}this.Qj.qqb();jb&&(this.Qj.A3=null,this.nyd?this._state=0:(this._state=2,this.Oob(!0)));this.i7=new f.a(2,1,this.wnc,Object(y.a)(this,
this.findInternal,"findInternal"),52);this.taskManager.Vb(this.i7);eb=(new Date).getTime()-eb;k.ULS.sendTraceTag(4065247,313,50,"{0}",{["RecheckTime"]:eb,["Count"]:ub,["Total"]:this.Qj.tja,["TotalWithDirty"]:this.Qj.E7a})}aHn(){this.zeb();this.KL=0;if(this.gp.xCf&&this.Nxb){var eb=this.lb;if(eb){var jb=eb.gb.kb;if(jb){var ub=H.App.xa.ib.rc;(ub=ub?ub.Ps:null)&&ub.p7a();jb=V.SelectionEditor.Cj(jb,!1,!1);eb.setSelection(jb);ub&&ub.kZa()}}}eb=this.gnl();this.vka=this.z3j.q9h(eb)}Jnj(){this.Inj(this.vka[this.KL].jja)}Inj(eb){this.Boo(eb);
this.blj(eb)}oej(){this.m$a=null;this.cWb=!1}osf(eb){const jb=this.Wc.Bk();jb.set(eb);if(!jb.zb(7))return jb.reset(),null;if(this.gp.m5d(jb,7,0))return eb=jb.currentNode,jb.reset(),eb;k.ULS.sendTraceTag(4235914,313,10,"GetNextFindableNode: No findable nodes");jb.reset();return null}gnl(){if(this.gp.xCf){var eb=this.lb;if((eb=eb?eb.gb.kb:null)&&this.Nxb)return eb.Pc.hl?(eb=eb.Pc,V.SelectionEditor.mv(eb)?(eb=eb.node,Object(n.a)(59,eb)?eb:this.osf(eb)):Object(n.a)(59,eb.node)?eb.node:this.osf(eb.node)):
this.osf(this.gp.Uc);eb=this.Wc.Bk();eb.set(this.gp.Uc);if(this.gp.llg(eb,8,1)){k.ULS.sendTraceTag(4069018,313,50,"No Selection: No selection, choosing title or first findable");const jb=eb.currentNode;eb.reset();return jb}k.ULS.sendTraceTag(4235915,313,10,"TryMoveToPageLeadingContent failed")}k.ULS.sendTraceTag(4235916,313,10,"Error: ContentView isn't PageView");return null}vuf(){const eb=this.Wc.Bk();eb.set(this.OZb);if(1===eb.Mp())return eb.Pd(),eb.currentNode;k.ULS.sendTraceTag(4069019,313,15,
"Something went wrong in GetStartingNode...");return null}Boo(eb){const jb=this.Ic.Oc(3);jb.Cb(this.OZb);const ub=this.Wc.Bk();ub.set(this.OZb);ub.vz()&&(ub.Pd(),ub.xg());eb&&(ub.Af(eb,81),eb=this.vka[this.KL],this.OZb.R8f=eb.rootNode.type,this.OZb.Pkf=eb.J6b);jb.dispose()}VTl(){if(this.xsb){var eb=this.Wc.Bk();eb.set(this.xsb);if(eb.Mp())return eb.Pd(),eb.currentNode;eb=this.sOe(this.gp.Uc);eb.moveNext();if(eb.currentNode)return eb.currentNode}k.ULS.sendTraceTag(4069020,313,15,"Something went wrong in GetCurrentNode...");
return null}blj(eb){const jb=this.Ic.Oc(3);jb.Cb(this.xsb);const ub=this.Wc.Bk();ub.set(this.xsb);ub.vz()&&(ub.Pd(),ub.xg());eb&&(ub.Af(eb,81),eb=this.vka[this.KL],this.xsb.R8f=eb.rootNode.type,this.xsb.Pkf=eb.J6b);jb.dispose()}Qki(){let eb=this.Qj.EE||this.Qj.$Da;if(eb){for(var jb=!1,ub=!0;eb;){var ab=this.gp.Aj.Db(eb.nodeId);if(ab=Object(x.a)(59,ab))if(jb=ab.pMf(eb.type)){ub&&(eb=this.Qj.q1a(eb));break}else eb=this.Qj.q1a(eb);else if(ub=eb,eb=this.Qj.S7b(eb),this.Qj.G4c(ub.nodeId),!eb||ub.nodeId.equals(eb.nodeId))break;
ub=!1}jb?(this.Qj.EE=eb,this.Qj.qqb(),k.ULS.sendTraceTag(4065248,313,50,"FindManager GoToNextHit Success")):k.ULS.sendTraceTag(4069022,313,15,"Failed to go to Next Hit")}}Vki(){let eb=this.Qj.EE||this.Qj.$Da;if(eb){for(var jb=!1,ub=!0;eb;){var ab=this.gp.Aj.Db(eb.nodeId);if(ab=Object(x.a)(59,ab))if(jb=ab.YMi(eb.type)){ub&&(eb=this.Qj.RRd(eb));break}else eb=this.Qj.RRd(eb);else if(ub=eb,eb=this.Qj.abi(eb),this.Qj.G4c(ub.nodeId),!eb||ub.nodeId.equals(eb.nodeId))break;ub=!1}jb?(this.Qj.EE=eb,k.ULS.sendTraceTag(4065249,
313,50,"FindManager GoToPreviousHit Success")):k.ULS.sendTraceTag(4069024,313,15,"Failed to go to Previous Hit");this.Qj.qqb()}}WTk(){return 2===this._state&&(this.Q6f||this.Ovd&&this.uMd.Tej)}aTf(){this.gp.Foa?(this.qdb=this.Uea.h2c(this.iW.text),this.cbb=this.gp.Aj,this.oej()):this.Kej()}mvj(){this.Ovd&&this.uMd.start()}w6e(){if(!this.gp.Foa||this.cbb!==this.gp.Aj)return this.zeb(),this.Kej(),!0;this.Tsc=0;return!1}U7f(){const eb=this.Uea.vLb(this.qdb),jb=this.WTk();let ub=!1;if(jb||this.gp.hBi(this.JAc,
this.Bwc,this.iW,eb)){ub=!0;this.Oob(!1);this.W$a.update();this.W$a.Skf();!jb&&this.gp.rBi(this.JAc,this.Bwc,this.iW,eb)?(this.Qj.eNi(),this.Qj.A3=null,this._state=1):(this.aHn(),this.Jnj(),this._state=0,this.nyd=!0);this.JAc=this.iW;this.Bwc=eb;try{this.jVb=this.kVb.L8b(this.Bwc.join("|"),this.iW)}catch(ab){return k.ULS.sendTraceTag(0,313,10,"FindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",this.iW.matchCase,this.iW.matchWholeWord),this.jVb=null,
this._state=2,this.Oob(!0),!0}this.i7=new f.a(2,1,this.wnc,Object(y.a)(this,this.findInternal,"findInternal"),52);this.taskManager.Vb(this.i7)}return ub}ITi(){if(!this.m$a){const eb=this.Wc.Bk();eb.set(1===this.vka[this.KL].J6b?this.gp.Uc:this.vka[this.KL].rootNode);this.gp.llg(eb,this.vka[this.KL].rootNode.type,this.vka[this.KL].J6b)?(this.m$a=eb.currentNode,eb.reset()):(k.ULS.sendTraceTag(17306254,313,10,"TryToMoveToPageLeadingParagraph failed."),eb.reset(),this.i7=new f.a(2,1,this.wnc,Object(y.a)(this,
this.findInternal,"findInternal"),52),this.taskManager.Vb(this.i7))}}LSf(){this.Qj.qqb();this.blj(this.TBa.currentNode);this.TBa.currentNode===this.vuf()&&(this.KL++,this.KL===this.vka.length?(this.KL=0,this._state=2,this.nyd=!1,this.Oob(!0)):this.Jnj());this.TBa=null}mhi(){return this.vuf()}s3i(){const eb=this.VTl();this.TBa=this.Wc.Bk();this.TBa.set(eb);this.TBa.r1(this.vka[this.KL].rootNode)}loj(){const eb=this.Ic.Oc(3);eb.Cb(this.TBa.currentNode);return eb}QWf(){this.zwf(this.TBa.currentNode,
this.vka[this.KL].J6b,this.Nxb);this.gp.m5d(this.TBa,this.vka[this.KL].rootNode.type,this.vka[this.KL].J6b)}z9e(eb){return!!this.TBa.currentNode&&!this.TBa.currentNode.id.equals(eb.id)}cDh(eb){!this.cWb&&this.m$a&&eb.id===this.m$a.id&&this.vuf().id!==this.m$a.id&&0<this.Qj.E7a&&(this.cWb=!0,this.Qj.iej())}Fzd(eb,jb,ub,ab){const Ea=this.Qj.O8b(eb);Ea?this.Qj.gee(eb,jb):this.cWb?this.Qj.xnh(jb):this.Qj.Kzd(jb);this.Nxb&&!this.Qj.EE&&0<jb.length&&ub.pMf(ab)&&(this.Qj.EE=Ea?Ea:jb[0],this.Qj.b$||(this.Qj.b$=
this.Qj.EE))}dTa(eb,jb){eb.dTa(jb)}nma(eb){this.Nxb&&eb.nma()}BMf(eb){eb.gl(16,!0)}static ZE(eb,jb,ub,ab,Ea=!1){jb||(jb=la.instance);ub||(ub=ba.instance);const Wa=qa.createInstance(eb,ub.thg,Ea),Bb=new u.a(()=>wa.createInstance(hb.instance,hb.instance.Qj)),Mb=new u.a(()=>Ia.createInstance(hb.instance.Qj)),Fb=new u.a(()=>ja.createInstance(hb.instance,eb));return new hb(eb,jb,ub,ab,aa.FindManagerHelper.instance,new u.a(()=>l.AFrameworkApplication.nc),new u.a(()=>X.a.instance),new z.a,new w.a,E.a.createInstance,
a.a.instance,Wa,Bb,Mb,Fb,Ea)}static get instance(){return hb._instance}static createInstance(eb,jb=null,ub=null,ab=!1,Ea=!1){return Ea?hb.ZE(eb,jb,ub,ab,!0):hb.instance||(hb._instance=hb.ZE(eb,jb,ub,ab))}}hb._instance=null;Object(F.a)(hb,"FindManager",U.a,[])},1965:function(F,K,c){F=c(0);var l=c(22),f=c(2),a=c(237),k=c(44),x=c(6),y=c(16),n=c(42),u=c(7),z=c(67),w=c(111),E=c(74),G=c(86),H=c(206),L=c(12),I=c(5),N=c(585),Q=c(103),M=c(815),J=c(1031),V=c(36),X=c(217),W=c(204),U=c(81);class Y{constructor(Fb){this.opa=
Fb}}Object(F.a)(Y,"ValidParentData",null,[]);var ba=c(40),aa=c(333),fa=c(655),na=c(362),oa=c(654),ja=c(508);class qa{constructor(){this.V4b=0}}Object(F.a)(qa,"BelowOutlineElementData",null,[]);var Ia=c(626),Va=c(858),Na=c(530);class za extends Ia.a{constructor(Fb,vb,$a,kb){super(4,kb);this.U4b=Fb;this.czb=vb;this.lFc=$a}n9b(){var Fb=this.U4b;if(!Fb)return u.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const vb=[],$a=new Va.a(this.U4b.id,
this.U4b.Lc,this.czb?this.czb.id:null);""!==Fb.characterData&&Fb.characterData&&(Fb=new Na.DeleteTextUpdateHint(this.U4b.id,0,Fb.characterData),vb.push(Fb));vb.push($a);return vb}}Object(F.a)(za,"DeleteParagraphOperation",Ia.a,[]);var la=c(939),va=c(463);class ia extends Ia.a{constructor(Fb,vb,$a,kb,Ua){super(3,Ua);this.qpa=Fb;this.BRa=vb;this.lhn=$a;this.mxa=kb}n9b(){const Fb=[];var vb=new la.AddParagraphUpdateHint(this.mxa.id,this.mxa.Lc,this.qpa?this.qpa.id:null);Fb.push(vb);""!==this.mxa.characterData&&
this.mxa.characterData&&(vb=new va.a(this.mxa.id,0,this.mxa.characterData),Fb.push(vb));return Fb}}Object(F.a)(ia,"InsertNewParagraphOperation",Ia.a,[]);var pa=c(938);class sa extends Ia.a{constructor(Fb,vb,$a,kb){super(2,kb);this.qpa=Fb;this.BRa=vb;this.D4d=$a}n9b(){const Fb=[],vb=new pa.MergeParagraphUpdateHint(this.qpa.id,this.qpa.Lc,this.qpa.characterData.length,this.BRa.id,this.BRa.Lc,this.D4d.id,this.D4d.Lc);Fb.push(vb);return Fb}}Object(F.a)(sa,"MergeParagraphOperation",Ia.a,[]);var Ha=c(857);
class ra extends Ia.a{constructor(Fb,vb,$a,kb,Ua){super(1,Ua);this.E4=Fb;this.Puj=vb;this.czb=$a;this.lFc=kb}n9b(){const Fb=[],vb=new Ha.a(this.E4.id,this.E4.Lc,this.Puj,this.czb.id,this.czb.Lc,this.lFc.id,this.lFc.Lc);Fb.push(vb);return Fb}}Object(F.a)(ra,"SplitParagraphOperation",Ia.a,[]);var Ma=c(373),ya=c(9),Ga=c(527),wa=c(43),hb=c(1092),eb=c(32),jb=c(122),ub=c(233),ab=c(8),Ea=c(177),Wa=c(13),Bb=c(96);c.d(K,"a",function(){return Mb});class Mb{constructor(Fb,vb,$a,kb,Ua,Sa,xb=null,Qb=null,Ib=null,
$b=null,hc=null){this.E0=hc;this.uK=Fb;this.sK=vb;this.Hf=$a;this.x6=xb;this.Vu=Qb;this.Xy=Ib;this.Jp=$b}Eqk(Fb){var vb;(null===(vb=ya.App.rd)||void 0===vb?0:vb.Qo)&&ya.App.rd.Tp.VF(Fb)}Fya(Fb,vb,$a,kb=!1){V.OutlineElementNavigator.Ge(Fb);ab.ParagraphReader.sh(Fb)?Mb.paragraphEditor.jq.Fya(Fb,vb,$a):eb.TableReader.isTable(Fb)&&14===Fb.We&&(vb=(new na.a(1,$a)).Ot,$a=Object(z.a)(aa.TableNode,Fb.currentNode),this.Tnj($a,vb,kb));V.OutlineElementNavigator.Vd(Fb)}Tnj(Fb,vb,$a=!1){Fb&&Object(w.a)(aa.TableNode,
Fb)&&($a?vb?(Fb.setValue(x.a.$d,vb),vb=eb.TableReader.Zg(Fb),Mb.yk.xbg(Fb,vb)):Fb.removeProperty(x.a.$d):Fb.$d=vb)}get jq(){return J.a.dFb}get lE(){return this.Vu||(this.Vu=l.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}get uc(){return this.Xy||(this.Xy=l.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Ld(){return null!=this.HIg?this.HIg:this.HIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get nj(){return null!=this.sIg?this.sIg:this.sIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Un(){return this.sK.value}get Gd(){return this.Hf.value}get nL(){return this.uK.value}get Wf(){return ub.a.instance}get AD(){return null!=
this.uxg?this.uxg:this.uxg=l.a.instance.Na("Box4.IContentControlConverter")}wfb(){const Fb=M.a.instance.createInstance(393229);Fb.setValue(y.a.oL,X.a.first);Fb.setValue(y.a.ngl,new Date);Fb.Pmc();return Fb}fdl(){const Fb=new hb.a;Fb.setValue(y.a.oL,X.a.first);return Fb}Rgf(Fb,vb,$a=!1){ba.OutlineElementReader.aGf(Fb)?(Fb=ba.OutlineElementReader.isRtl(Fb),$a?this.AOb(vb,Fb):this.zOb(vb,Fb)):this.f1n(vb)}zjc(Fb,vb){const $a=V.OutlineElementNavigator.Gl(Fb);ba.OutlineElementReader.$m($a)!==vb&&(this.zOb($a,
vb),Fb.anchor.WX(4))}zOb(Fb,vb){const $a=new wa.GraphTransaction(7);$a.Cb(Fb);this.AOb(Fb,vb);const kb=new I.GraphIterator;kb.set(Fb);Ma.a.instance.OEm(kb);if(kb.zb(10)){const Ua=kb.jd(10);kb.Sb(1)===Fb&&this.nL.zOb(Ua,vb)}$a.dispose()}AOb(Fb,vb){let $a=null,kb=null;if(G.a.instance.J(1)&&Fb.isConnected){$a=ab.ParagraphReader.tw(Fb,!0,!0);kb=new E.a;for(let Ua=0;Ua<$a.count;Ua++)12===$a.J(Ua).type&&kb.add($a.J(Ua).ND())}Fb.properties.setValue(y.a.B0,vb);if(G.a.instance.J(1)&&$a&&kb)if($a.count!==kb.count)u.ULS.shipAssertTag(35973010,
376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",$a.count,kb.count);else for(Fb=0;Fb<$a.count;Fb++)this.nj.aV($a.J(Fb),kb.J(Fb),this.Ld.rg)}f1n(Fb){Fb.properties.removeProperty(y.a.B0)}YI(Fb,vb=null,$a=!1){var kb,Ua=null;let Sa=null;if(!ba.OutlineElementReader.Nh(Fb))return u.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),null;let xb=null,Qb=null,Ib=0;vb&&(xb=vb.formatting,Qb=vb.Kja,Ib=vb.languageId);$a||({qpa:Ua,BRa:Sa}=this.X3h(Fb,
Ua,Sa));vb=H.a.instance.createInstance(393230);vb.setValue(y.a.lo,"");Fb.Af(vb,2);Fb.sj(vb);Mb.paragraphEditor.bNb(vb);Mb.paragraphEditor.C$m(vb);Mb.paragraphEditor.qUa(vb);this.Eqk(vb);f.AFrameworkApplication.NH&&!f.AFrameworkApplication.$bj&&(f.AFrameworkApplication.ue("AutoRenameNewDocument-tf;AutoRenameNewDocument-cf"),(null===(kb=f.AFrameworkApplication.K)||void 0===kb?0:kb.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocument",!1))&&this.CJk());xb&&(vb.pa.first.formatting.Wj=
xb);Ib||(Ib=f.AFrameworkApplication.lcid);Fb.currentNode.$g(y.a.V5c,Fb.currentNode.ia(y.a.V5c,Ib));Fb.currentNode.setValue(x.a.URa,0);Qb&&this.lE.RJ(Qb,vb,!0);!$a&&Ua&&($a=new ja.a(vb),Ua=new ia(Ua,Sa,Ua,$a,vb.Yma),Fb.currentNode.GH().jF.HI(Ua));return vb}CJk(){if(this.E0){for(var Fb,vb=this.E0.clf();vb;){const $a=vb.node;if(0<ab.ParagraphReader.textLength($a,9)&&(Fb=jb.AParagraphNode.mXl($a.characterData.trim()),0<Fb.length))break;vb=vb.next}Fb&&32===f.AFrameworkApplication.va.Qb(Wa.a.renameFile,
2,Fb)&&this.Jp&&(this.Jp.execute($a=>{$a.logActivity("AutoRenameDocumentCallout",null)}),k.a("AutoRenameDocumentSuccess"))}}X3h(Fb,vb,$a){$a=new I.GraphIterator;$a.Zc(Fb);vb=null;$a.yDf?$a.currentNode.GH().jF.z7(6):(V.OutlineElementNavigator.t0($a,!0,!1),vb=this.WPd($a));$a.Zc(Fb);$a=this.e5h($a);return{qpa:vb,BRa:$a}}e5h(Fb){const vb=new I.GraphIterator;vb.Zc(Fb);Fb=null;vb.DFa||(V.OutlineElementNavigator.Xr(vb,!0,!1),Fb=this.WPd(vb));return Fb}WPd(Fb,vb=!1){Fb=V.OutlineElementNavigator.Ge(Fb,!0);
return Fb?this.m$h(Fb,vb):(u.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)}m$h(Fb,vb=!1){if(12===Fb.type)return vb?new ja.a(Fb):new oa.a(Fb);Fb.GH().jF.z7(5);return new fa.a(Fb)}x_k(Fb,vb){var $a=vb.currentNode.clone();Fb.JH($a,null,1);Fb.sj($a);$a.$aa=vb.currentNode;V.OutlineElementNavigator.Ge(vb);vb.C8&1&&vb.currentNode.zRb(null);$a=vb.currentNode.clone();$a.ZHa=vb.currentNode.ZHa;$a.mN=vb.currentNode.mN;Fb.JH($a,null,2);Fb.sj($a);Fb.W_(1);$a.$aa=vb.currentNode;
$a.setValue(x.a.Lc,a.a.uF());vb.mt(11)}bNb(Fb){Fb.Sb(2)&&Fb.xg()}y4n(Fb,vb){const $a=Fb.currentNode;V.OutlineElementNavigator.Ge(Fb);const kb=Fb.currentNode;V.OutlineElementNavigator.Vd(Fb);vb.oJ(1);V.OutlineElementNavigator.Ge(vb);Fb.Af(vb.currentNode,2);vb.xg();var Ua=new I.GraphIterator;Ua.Zc(vb);if(Ua.Sb(1)){const Sa=new I.GraphIterator;Sa.Zc(Fb);const xb=new Y(null);if(!this.ijm(Sa,Ua.currentNode,xb))return;N.g(Sa,null,1,1,Ua,-1)}vb.xg();Ua=null;Fb.zM(1)&&(Ua=Fb.currentNode);for(Fb.wc();W.OutlineNavigator.h9(vb);)Fb.JH(vb.currentNode,
Ua,1),Ua=vb.currentNode,vb.xg();Fb.sj($a);Fb.sj(kb);Fb.xg()}Z9(Fb,vb,$a,kb,Ua,Sa,xb=!1,Qb=!1){var Ib=ba.OutlineElementReader.Nh(Fb),$b=ba.OutlineElementReader.Nh(vb),hc=$a.isValid&&$a.contextId===L.a.Tc;Ib&&$b&&hc||u.ULS.sendTraceTag(594642515,307,15,"sourceOutlineElementIsValid:{0}; destinationOutlineElementIsValid:{1}; ipContextIsValid:{2}",Ib,$b,hc);var pb=Fb.currentNode;this.bNb(vb);$b=vb.We;let dc,Ob=null;Ib=hc=null;let Vb=!1;V.OutlineElementNavigator.Ge(Fb);const ob=Fb.We;if(ab.ParagraphReader.sh(Fb)){dc=
Fb.currentNode;(hc=Object(z.a)(jb.AParagraphNode,dc))?hc.pa&&hc.pa.length||u.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",hc):u.ULS.sendTraceTag(38925731,307,15,"srcParaNode is null");hc=new ja.a(hc);(Vb=$a.cpBegin===ab.ParagraphReader.textLength(dc))&&(Ib=this.e5h(vb));const Xb=vb.currentNode;Ob=this.YI(vb,void 0,!0);Mb.paragraphEditor.ATa(Fb,vb,$a,Ua,Sa,xb,Qb);kb?(Ua=this.uc.No(dc))&&this.lE.RJ(Ua,Ob,!0):Vb&&(Ua=this.uc.No(dc))&&((Qb=Ua.ia(n.a.Yd,null))?
(Ua=this.uc.NC(Ob).Di(Qb),this.lE.RJ(Ua,Ob,!1)):this.lE.RJ(Ua,Ob,!0));this.Rgf(pb,Xb)}V.OutlineElementNavigator.Vd(Fb);V.OutlineElementNavigator.Vd(vb);V.OutlineElementNavigator.Ge(Fb);(pb=Object(z.a)(jb.AParagraphNode,Fb.currentNode))?pb.pa&&pb.pa.length||u.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",pb):u.ULS.sendTraceTag(38925761,307,15,"srcPara is null");pb=new ja.a(pb);V.OutlineElementNavigator.Vd(Fb);(Fb=Ob)?Fb.pa&&Fb.pa.length||u.ULS.sendTraceTag(38925764,
307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",Fb):(u.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),u.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:Vb,["moveText"]:Sa,["overrideParagraphStyle"]:kb,["sourceOutlineElementContentNodeType"]:ob,["destinationOutlineElementNodeType"]:$b,["alwaysMoveEopToDestinationPara"]:xb}));Vb?($a=new ja.a(Fb),$a=new ia(hc,Ib,pb,$a,Fb.Yma),vb.currentNode.GH().jF.HI($a)):($a=Sa?new ra(hc,$a.cpBegin,pb,new ja.a(Fb),
Fb.Yma):new ra(hc,$a.cpBegin,new ja.a(Fb),pb,Fb.Yma),vb.currentNode.GH().jF.HI($a));return Fb}WAh(Fb,vb){V.OutlineElementNavigator.Ge(Fb);let $a=ab.ParagraphReader.wt(Fb.currentNode)&&this.BTk(Fb);const kb=Fb.currentNode;$a=vb?$a&&!this.Wf.ZAn(kb):$a&&!this.Wf.PAn(kb);V.OutlineElementNavigator.Vd(Fb);return $a}BTk(Fb){return ab.ParagraphReader.sh(Fb)&&!ab.ParagraphReader.dfb(Fb.currentNode)}merge(Fb,vb,$a,kb,Ua=null,Sa=!1,xb,Qb=!1,Ib=!1,$b=!1){var hc;if(Fb.currentNode.id===vb.currentNode.id)return!1;
let pb;const dc=new I.GraphIterator;dc.Zc(vb);xb=this.WPd(dc);dc.Zc(Fb);pb=this.WPd(dc,!0);if(!this.WAh(vb,!0)||!this.WAh(Fb,!1))return!1;if(this.Wf.gh){V.OutlineElementNavigator.Ge(Fb);V.OutlineElementNavigator.Ge(vb);var Ob=ab.ParagraphReader.sh(Fb)?Fb.currentNode:null,Vb=ab.ParagraphReader.sh(vb)?vb.currentNode:null;V.OutlineElementNavigator.Vd(Fb);V.OutlineElementNavigator.Vd(vb);if(Ob&&Vb&&!this.Wf.XAh(Ob,Vb,!1)){if(!this.AD||!this.Wf.XAh(Ob,Vb,!0))return!1;this.AD&&(this.AD.GDj(Ob,!1),this.AD.GDj(Vb,
!0))}}Ob=Object(z.a)(jb.AParagraphNode,Fb.currentNode);Ob=($a||!Ob||!Ob.characterData.length)&&!Bb.ListItemReader.yg(Fb);Qb||this.Un.merge(Fb,vb,Ob,Ua);V.OutlineElementNavigator.Ge(Fb);Ua=Fb.currentNode.Yma;V.OutlineElementNavigator.Ge(vb);if(ab.ParagraphReader.sh(vb)){Qb=vb.currentNode;if(null===(hc=ya.App.rd)||void 0===hc?0:hc.Qo)if(hc=Fb.currentNode,Ob=Ga.CoauthLockEditor.getInstance(),Ob.P6a(this.Wf.C7b(Qb))||Ob.P6a(this.Wf.C7b(hc)))return vb.wc(),Fb.wc(),!1;hc=!1;(Qb=Fb.parentNode)&&ba.OutlineElementReader.Eoa(Qb)&&
(hc=Bb.ListItemReader.yg(Qb));(Qb=this.Vro(ab.ParagraphReader.isEmpty(Fb),hc,$a,kb,Ib))&&(Ob=this.uc.zuf(vb))&&this.lE.RJ(Ob,Fb.currentNode,!0);$a&&(Ob=vb.currentNode,Vb=Fb.currentNode,(Qb||hc)&&Ea.b(Ob,Vb),Ib&&kb||this.x6.JOi(Ob,Vb,hc),f.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordPreserveEopFormattingPasteSettings"),$b&&(Ib=this.n8k(Vb,Ob),u.ULS.sendTraceTag(588288132,307,50,"wasCopied: {0}",Ib)));$a=Mb.paragraphEditor.merge(Fb,vb,$a,kb,Sa);Sa=dc.currentNode;kb=Fb.currentNode;
Fb.wc();$a&&ba.OutlineElementReader.isEmpty(vb,!0)&&this.U_a(vb);Fb=new sa(pb,xb,new oa.a(Sa),Ua);kb.GH().jF.HI(Fb);return!0}vb.wc();Fb.wc();return!1}n8k(Fb,vb){let $a=null;vb&&vb.pa&&0<vb.pa.length&&vb.pa.first.Rh&&($a=vb.pa.first.formatting);return $a&&Fb&&Fb.pa&&0<Fb.pa.length&&Q.FormattingReader.H5k(Fb.pa)?(Fb.pa.last.formatting=$a.Df(Fb.pa.last),!0):!1}Vro(Fb,vb,$a,kb,Ua){return vb?!1:$a?!(kb&&Ua):Fb}eDm(Fb){const vb=new I.GraphIterator;vb.set(Fb.node);vb.vd();V.OutlineElementNavigator.Vd(vb);
const $a=this.noa(vb),kb=this.noa(vb);this.Z9(vb,$a,Fb,!1,!0,!0);ba.OutlineElementReader.isEmpty(vb,!1)&&(this.Un.Zca(vb),vb.xg());ba.OutlineElementReader.isEmpty($a,!1)&&!ba.OutlineElementReader.Wjb($a)&&(this.Un.Zca($a),$a.xg());return kb}xz(Fb,vb,$a,kb=null,Ua=!1,Sa=!0){if(!this.xTk(Fb))return null;const xb=Fb.currentNode;var Qb=!1;Sa&&(Qb=Bb.ListItemReader.yg(Fb),Ua=vb||Ua||!ba.OutlineElementReader.isEmpty(Fb,!1),Qb=this.Un.yvo(Qb,Ua));Ua=vb?Fb.zM(1):Fb.currentNode;Fb.wc();$a=this.nL.kjb(Fb,Ua,
$a,kb);if(!$a)return null;this.Rgf(xb,$a);Sa&&Qb&&this.Un.GNo(Fb,vb,xb,$a);return $a}xTk(Fb){return ba.OutlineElementReader.Nh(Fb)&&(Fb=Fb.parentNode,U.OutlineReader.h_d(Fb)||ba.OutlineElementReader.Eoa(Fb)||ba.OutlineElementReader.tQa(Fb))?!0:!1}eHa(Fb){const vb=new I.GraphIterator;vb.set(Fb);vb.vd();vb.mt(11);let $a=null,kb=null;({qpa:$a,BRa:kb}=this.X3h(vb,$a,kb));let Ua=-1;12===Fb.type&&(Ua=Fb.Yma);vb.currentNode?(vb.currentNode.GH().jF.HI(new za(this.m$h(Fb,!0),$a,kb,Ua)),this.U_a(vb)):u.ULS.sendTraceTag(574650269,
324,15,"The content to be deleted does not have a containing OE")}U_a(Fb){if(Fb.Rr(1)){const vb=new qa,$a=new I.GraphIterator;$a.Zc(Fb);this.vOl($a,vb)&&this.jq.DJc(Fb,-vb.V4b)}Fb.xg();eb.TableReader.ex(Fb)&&this.SFn(Fb)}PAf(Fb,vb,$a){if(!U.OutlineReader.fx(Fb)&&!ba.OutlineElementReader.Nh(Fb))return null;const kb=this.fdl();0<$a&&$a<X.a.last&&kb.setValue(y.a.oL,Math.min(X.a.nil,$a));Fb.JH(kb,vb,1);return kb}gDm(Fb,vb){if(!ba.OutlineElementReader.Nh(Fb)&&!ba.OutlineElementReader.fL(Fb)||!U.OutlineReader.Lwa(Fb.parentNode)&&
!ba.OutlineElementReader.Eoa(Fb.parentNode))return null;const $a=Fb.currentNode;let kb;kb=Fb.currentNode;Fb.wc();vb=this.PAf(Fb,kb,vb);Fb.sj($a);return vb}SFn(Fb){ba.OutlineElementReader.fL(Fb)&&(Fb.Rr(1)||Fb.xg());this.H0h(Fb,!1);this.Krh(Fb)}H0h(Fb,vb){var $a,kb=null;for($a=Fb.Sb(1);$a;){var Ua=!1;ba.OutlineElementReader.tQa($a)&&!Fb.Rr(1)&&(Ua=!0);var Sa=$a;$a=Fb.zi(1);if(Ua)Ua=new I.GraphIterator,Ua.set(Sa),Ua.vd(),Ua.xg();else if(ba.OutlineElementReader.tQa(Sa)){if(kb){Ua=new I.GraphIterator;
Ua.set(kb);var xb=new I.GraphIterator;xb.set(Sa);xb.vd();Ua.Af(xb.currentNode,1);xb.xg();xb=ba.OutlineElementReader.Hga(Sa);xb===X.a.nil&&(xb=1);const Qb=ba.OutlineElementReader.Hga(Sa);(xb=Math.max(0,Qb-xb))?Sa.setValue(y.a.oL,Math.min(X.a.nil,xb)):(Ua.sj(Sa),Fb.Sb(1),N.e(Ua),Ua.wc());vb&&this.H0h(Ua,!0)}}else kb=Sa}vb=null;kb=X.a.last+1;for($a=Fb.Sb(1);$a;$a=Fb.zi(1))if(ba.OutlineElementReader.fL(Fb))Sa=ba.OutlineElementReader.Hga($a),kb>Sa&&(kb=Sa,vb=$a);else{Fb.wc();return}if(vb){for($a=Fb.Sb(1);$a;$a=
Fb.zi(1))$a!==vb&&($a=ba.OutlineElementReader.Hga($a),Fb.currentNode.setValue(y.a.oL,Math.min(X.a.nil,$a-kb)));kb+=ba.OutlineElementReader.Hga(Fb.currentNode);Fb.currentNode.setValue(y.a.oL,Math.min(X.a.nil,kb));$a=new I.GraphIterator;$a.Zc(Fb);$a.sj(vb);$a.Sb(1);N.e($a)}}ijm(Fb,vb,$a){var kb=ba.OutlineElementReader.Hga(Fb.currentNode);if(1===kb)return!0;if(ba.OutlineElementReader.fL(Fb))return!1;if(!Fb.whb(1)||this.LPm(Fb,vb))return Fb.currentNode.setValue(y.a.oL,Math.min(X.a.nil,1)),!0;if($a.opa&&
Fb.sj($a.opa)){if(ba.OutlineElementReader.fL(Fb)&&1===kb+ba.OutlineElementReader.Hga(Fb.currentNode))return $a.opa=Fb.oJ(1),Fb.wc(),!0;Fb.wc()}if($a.opa&&Fb.sj($a.opa)||!$a.opa&&Fb.Sb(1)){if(Fb.currentNode!==vb&&Fb.Pf(1)&&ba.OutlineElementReader.fL(Fb)&&1===kb+ba.OutlineElementReader.Hga(Fb.currentNode))return $a.opa=null,!0;Fb.wc()}if(Fb.Aib(vb)&&this.KPm(Fb,vb)){for($a=Fb.Sb(1);$a;$a=Fb.zi(1))if($a!==vb){var Ua=ba.OutlineElementReader.Hga($a);$a.setValue(y.a.oL,Math.min(X.a.nil,Ua+(kb-1)))}Fb.currentNode.setValue(y.a.oL,
Math.min(X.a.nil,1));return!0}if(1>kb)return kb=this.PAf(Fb,$a.opa,1-kb),Fb.sj(kb),$a.opa=null,!0;if(1<kb){Fb.currentNode.setValue(y.a.oL,Math.min(X.a.nil,1));vb=null;for(Ua=Fb.Sb(1);Ua;){if(ba.OutlineElementReader.fL(Fb)){Ua.setValue(y.a.oL,Math.min(X.a.nil,kb-1+ba.OutlineElementReader.Hga(Ua)));Ua=Fb.zi(1);continue}vb||(vb=this.gDm(Fb,kb-1));const Sa=Ua;Ua=N.i(Fb,vb,1);Ua===vb&&(Ua=Fb.zi(1));$a.opa===Sa&&($a.opa=vb,vb=null)}return!0}return!1}LPm(Fb,vb){return I.GraphIterator.vba(()=>{if(1===Fb.whb(1)){const $a=
Fb.Sb(1);Fb.wc();if($a===vb)return!0}return!1})}KPm(Fb,vb){return I.GraphIterator.vba(()=>{let $a;for($a=Fb.Sb(1);$a;$a=Fb.zi(1))if($a!==vb&&!ba.OutlineElementReader.fL(Fb))return Fb.wc(),!1;return!0})}vOl(Fb,vb){vb.V4b=0;do{const $a=Fb.currentNode;if(Fb.Sb(1))vb.V4b-=ba.OutlineElementReader.Hga($a);else{if(U.OutlineReader.fx(Fb)||null===Fb.currentNode)return!1;if(3!==Fb.role||!Fb.aha(1))for(;!Fb.zi(1);)if(vb.V4b+=ba.OutlineElementReader.Hga(Fb.currentNode),U.OutlineReader.fx(Fb)||null===Fb.currentNode)return!1}}while(ba.OutlineElementReader.fL(Fb));
return!0}noa(Fb,vb=!1){return this.bXd(Fb,!1,vb)}dDm(Fb){return this.bXd(Fb,!0,!1)}bXd(Fb,vb,$a=!1){const kb=new I.GraphIterator;kb.Zc(Fb);Fb=new I.GraphIterator;Fb.Zc(kb);this.xz(Fb,vb,!1,null,$a);Fb.currentNode.setValue(y.a.oL,Math.min(X.a.nil,ba.OutlineElementReader.Hga(kb.currentNode)));kb.Sb(1)&&N.g(Fb,null,1,1,kb,-1);return Fb}Krh(Fb){if(ba.OutlineElementReader.i6n(Fb)){1!==ba.OutlineElementReader.Hga(Fb.currentNode)&&Fb.currentNode.setValue(y.a.oL,X.a.first);for(var vb=Fb.Sb(1);vb;)if(ba.OutlineElementReader.fL(Fb)){vb=
new I.GraphIterator;vb.Zc(Fb);vb.wc();const $a=new I.GraphIterator;$a.Zc(Fb);$a.Sb(1);N.g(vb,Fb.currentNode,1,1,$a,-1);vb=Fb.Tfb(1)}else this.Krh(Fb),vb=Fb.zi(1)}}static get yk(){return null!=Mb.SHg?Mb.SHg:Mb.SHg=l.a.instance.resolve("Box4.ITableEditor")}static get paragraphEditor(){return Mb.Ms||(Mb.Ms=l.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(Fb){Mb.Ms=Fb}}Mb.Ms=null;Object(F.a)(Mb,"OutlineElementEditor",null,[501])},1966:function(F,K,c){F=c(0);var l=c(140),f=c(57),
a=c(22),k=c(2),x=c(58),y=c(635),n=c(90),u=c(83),z=c(397),w=c(352),E=c(19),G=c(353),H=c(53),L=c(175),I=c(44),N=c(35),Q=c(13),M=c(1580),J=c(118),V=c(6),X=c(16),W=c(153),U=c(7),Y=c(453),ba=c(677),aa=c(566),fa=c(115),na=c(18),oa=c(244),ja=c(246),qa=c(28),Ia=c(34);class Va{constructor(ub){this.Ny=null;this.E6g=!1;this.Hp=null;this.XL=new M.a;this.oEe=new M.a;this.Ec=ub}get Vlb(){Ia.a(4281429,307,this.XL.count===this.oEe.count);return this.XL.count}get r4d(){return this.E6g}set r4d(ub){this.E6g=ub}N1b(ub){this.Ny=
ub}get jX(){return null}Srh(ub,ab){this.XL.add(ub);this.oEe.add(ab)}}Va.slb=2712;Object(F.a)(Va,"APicturePasteHandler",null,[778]);var Na=c(250),za=c(3),la=c(9),va=c(1147),ia;(function(ub){ub[ub.unknown=0]="unknown";ub[ub.other=1]="other";ub[ub.file=2]="file";ub[ub.blob=3]="blob";ub[ub.chromeExtension=4]="chromeExtension";ub[ub.cid=5]="cid"})(ia||(ia={}));Object(F.b)("UnsupportedUrlScheme",ia);var pa=c(257),sa=c(43),Ha=c(8),ra=c(1850),Ma=c(1851),ya=c(1777);class Ga{constructor(){this.delay=this.retry=
0}}Object(F.a)(Ga,"ForceInboundData",null,[]);class wa{constructor(ub,ab,Ea,Wa){this.dVd=!1;this.request=ub;this.$5n=ab;this.url=Wa;this.sDm=Ea}}Object(F.a)(wa,"PicturePasteRequestInfo",null,[]);var hb=c(393);c.d(K,"a",function(){return jb});const eb=["ImageInsertFailed"];class jb extends Va{constructor(ub,ab,Ea,Wa,Bb,Mb=null,Fb=null,vb=!1,$a=null,kb=null){super(ub);this.Nl=l.a.nil;this.iB=new M.a;this.yLa=0;this.nwc=this.Ldh=null;this.Wbh=!1;this.nzc=null;this.Ijd=new M.a;this.Wp=null;this.mHn=()=>
{var Ua=this.qOl(),Sa=131073;this.s$j&&(Sa=1073872970);Ua=f.a.fo(Ua,Y.a.cellId,this.Hp.nm.toString());Ua=f.a.fo(Ua,Y.a.jX,this.Nl.toString());Ua=f.a.fo(Ua,Y.a.classId,Sa.toString());this.Hp.DH&&(Ua=f.a.fo(Ua,Y.a.DH,this.Hp.DH));Ua=f.a.fo(Ua,Y.a.Nqb,"1");Ua=f.a.fo(Ua,ba.a.imageType,"1");Ua=Na.a.instance.q_e(Ua);this.Hp.contentReplicator&&this.Hp.contentReplicator.vIb&&(Ua=f.a.fo(Ua,Y.a.Y3e,"1"));let xb=0;Sa=Ua;var Qb=new M.a;const Ib=new M.a,$b=new M.a,hc=new M.a,pb=new M.a,dc=new M.a;var Ob="",Vb=
a.a.instance.Na("Box4.IFeatureHelper");Vb=!!Vb&&Vb.isFeatureEnabled(11)&&Vb.isFeatureEnabled(49);for(let rc=0;rc<this.Vlb;rc++){var ob=this.oEe.J(rc);U.ULS.shipAssertTag(7869452,307,!!ob.src);U.ULS.shipAssertTag(7869453,307,""!==ob.src);U.ULS.shipAssertTag(7869454,307,19922944>ob.src.length);const Ta=this.XL.J(rc);var Xb=Ta.node.ia(J.a.EJ,pa.a.Jt);this.tXo(Ta.blob,ob);var Xa=ob.alt;var Pb=ob.Dll;Pb||(Pb=Xa,Xa="");const Ab=Ta.blob;Xb=ra.a.construct(Ab?Ab.id.toString():Ta.node.id.toString(),ob.src,
Xa,ob.width,ob.height,Pb,Xb,Ta.iU,!!Ab&&Ab.properties.ia(V.a.sha,!1),Ab?Ab.properties.ia(J.a.kga,-1):-1,Ab?Ab.properties.ia(V.a.jlb,Box4Intl.Box4Strings.l_Picture):"",Ta.node.properties.ia(X.a.Jwa,!1),null,null,null,ob.kEd);ob.src.startsWith("data:")?(Pb=!1,Vb&&ob.kEd?(Pb=!0,ob=pb,Xa=dc):(ob=$b,Xa=hc),ob.add(Xb),Xa.add(Ta),Pb=Ma.a.construct(ob.toArray(),!Pb,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Hp.vr:null,Pb),Pb=N.c(Pb),Pb.length>jb.tcn?(U.ULS.shipAssertTag(7869456,
307,1<ob.count),ob.remove(Xb),Xa.remove(Ta),Pb=this.iB.count?(new x.a(this.Nl,xb)).toString():this.Hp.contentReplicator.Ht.toString(),Sa=f.a.fo(Sa,Y.a.$ta,Pb),Sa=f.a.fo(Sa,Y.a.bgc,xb.toString()),na.ImageReader.increaseMaxWebFriendlyDimensionTo1600&&(Sa=f.a.fo(Sa,Y.a.tRb,"1")),this.iB.add(new wa(Ma.a.construct(ob.toArray(),!0,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Hp.vr:null),Ob,Xa,Sa)),xb+=$b.count,ob=new M.a,ob.add(Xb),Xa=new M.a,Xa.add(Ta)):Ob=Pb):(Qb.add(Xb),
Ib.add(Ta))}$b.count&&(Sa=Ua,Pb=this.iB.count?(new x.a(this.Nl,xb)).toString():this.Hp.contentReplicator.Ht.toString(),Sa=f.a.fo(Sa,Y.a.$ta,Pb),Sa=f.a.fo(Sa,Y.a.bgc,xb.toString()),na.ImageReader.increaseMaxWebFriendlyDimensionTo1600&&(Sa=f.a.fo(Sa,Y.a.tRb,"1")),Ob=Ma.a.construct($b.toArray(),!0,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Hp.vr:null),this.iB.add(new wa(Ob,N.c(Ob),hc,Sa)),xb+=$b.count,this.Ijd.add(jb.Zlf));Qb.count&&(Sa=Ua,Pb=this.iB.count?(new x.a(this.Nl,
xb)).toString():this.Hp.contentReplicator.Ht.toString(),Sa=f.a.fo(Sa,Y.a.$ta,Pb),Sa=f.a.fo(Sa,Y.a.bgc,xb.toString()),Sa=f.a.fo(Sa,Y.a.tRb,"1"),Qb=Ma.a.construct(Qb.toArray(),!1,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Hp.vr:null),this.iB.add(new wa(Qb,N.c(Qb),Ib,Sa)),k.AFrameworkApplication.Kha("WoInc325;WoInc325cf"),this.Ijd.add(this.nWg));pb.count&&(Sa=Ua,Pb=this.iB.count?(new x.a(this.Nl,xb)).toString():this.Hp.contentReplicator.Ht.toString(),Sa=f.a.fo(Sa,
Y.a.$ta,Pb),Sa=f.a.fo(Sa,Y.a.bgc,xb.toString()),Sa=f.a.fo(Sa,Y.a.tRb,"1"),Ua=Ma.a.construct(pb.toArray(),!1,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Hp.vr:null,!0),this.iB.add(new wa(Ua,N.c(Ua),dc,Sa)),this.Ijd.add(this.nWg));U.ULS.sendTraceTag(595068930,307,50,"Prepared "+(this.iB?this.iB.count:-1)+" picture paste requests to send");this.mob()};this.picturePasteRequestSucceeded=Ua=>{var Sa;U.ULS.sendTraceTag(572528019,307,50,"PicturePasteRequestSucceeded received response with Http status: {0}",
this.w_l(Ua));if(({group:xb}=aa.a.q1(Ua.data.ve)).returnValue){var xb=xb.Responses[0];if(xb.StatusCode)if(46!==xb.StatusCode||this.iB.J(this.yLa).dVd){U.ULS.sendTraceTag(51212675,322,15,"Picture paste request failed with reason "+xb.StatusCode);Ua=Object.assign(new fa.a,{extendedProperties:new Map});Ua.extendedProperties.set("statuscode",xb.StatusCode.toString());if(null===(Sa=k.AFrameworkApplication.K)||void 0===Sa?0:Sa.$("ShouldLogPicturesExtendedHealthKpis")){var Qb={name:hb.c.j$b,errorNameOverride:null,
isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:Ua};Ua.extendedProperties.set("ErrorLevel","warning");this.pg.logKpiFailure({kpiName:hb.c.VEa,errorName:"PictureRemotePasteFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:Ua},optionalVeto:Qb})}else u.Health.instance.recordQosError("PictureRemotePasteFailed",eb,!1,!0,!1,!1,Ua);this.Rnm()}else this.iB.J(this.yLa).dVd=!0,this.mob();else{xb=Sa="";Ua&&Ua.data&&Ua.data.Bj&&(ba.a.UH in Ua.data.Bj&&
Ua.data.Bj[ba.a.UH]&&(xb=Ua.data.Bj[ba.a.UH]),"X-CorrelationId"in Ua.data.Bj&&Ua.data.Bj["X-CorrelationId"]&&(Sa=Ua.data.Bj["X-CorrelationId"]));U.ULS.sendTraceTag(595068929,307,50,"PicturePasteRequestSucceeded called.[Status code: {0}][X-CorrelationID: {1}]",xb,Sa);(null===(Qb=k.AFrameworkApplication.K)||void 0===Qb?0:Qb.$("ShouldLogPicturesExtendedHealthKpis"))&&this.pg.logKpiSuccess({kpiName:hb.c.VEa});this.nzc&&(this.nzc.stop(),this.nzc=null);this.yLa++;this.CEj&&this.mob();this.Ldh=this.Hp.contentReplicator.Ht;
let Ib=null;Ib=Object.assign(new Ga,{retry:0,delay:this.Ijd.J(this.yLa-1)});Ua=new n.a(2,1,jb.Zlf,()=>{this.Hp.contentReplicator.lae(this.Z1h,null,Ib)},124);this.Gb.Vb(Ua)}}else U.ULS.sendTraceTag(7869457,307,10,"PicturePasteRequestSucceeded received null or empty server response group"),Ua=new y.a(Ua.data),this.igc(Ua)};this.Z1h=Ua=>{const Sa=!x.a.eq(this.Ldh,this.Hp.contentReplicator.Ht);U.ULS.sendTraceTag(8246492,307,50,"Revision changed after ForceInbound: {0}",Sa);if(Sa)this.LAh();else{const xb=
Ua?Ua:null;if(Ua&&xb&&xb.retry<jb.jIl){xb.retry+=1;Ua=new n.a(2,1,xb.delay,()=>{this.Hp.contentReplicator.lae(this.Z1h,null,xb)},125);this.Gb.Vb(Ua);return}Ua=jb.Zlf;null!=xb&&(Ua=xb.delay);Ua=new n.a(2,1,Ua,()=>{this.Hp.contentReplicator.lae(null,null,null)},125);this.Gb.Vb(Ua);this.MAh()}jb.bSf--;k.AFrameworkApplication.va.processAction(Q.a.e8a,2);ya.a.instance.Xmc(this.Hp,0);this.hvg();this.zu.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)};this.igc=Ua=>{var Sa,xb="",Qb="";Ua&&Ua.data&&
Ua.data.Bj&&("X-CorrelationId"in Ua.data.Bj&&Ua.data.Bj["X-CorrelationId"]&&(xb=Ua.data.Bj["X-CorrelationId"]),ba.a.UH in Ua.data.Bj&&Ua.data.Bj[ba.a.UH]&&(Qb=Ua.data.Bj[ba.a.UH]));Qb=""===Qb?"":String.format("[Operation Result: {0}]",Qb);xb=""===xb?"":String.format("[X-CorrelationID: {0}]",xb);U.ULS.sendTraceTag(51212676,322,15,"Picture paste request failed.[HttpStatus: {2}] [Connection state: {3}]{0}{1}",Qb,xb,Ua.data.Qe,z.SessionStatusManager.instance.MH);9===Ua.data.status||this.iB.J(this.yLa).dVd?
(ya.a.instance.Xmc(this.Hp,127),this.vCh(),this.nzc=null,(null===(Sa=k.AFrameworkApplication.K)||void 0===Sa?0:Sa.$("ShouldLogPicturesExtendedHealthKpis"))?(Ua=Object.assign(new fa.a,{extendedProperties:new Map([["HttpStatus",String(Ua.data.Qe)],["ConnectionState",String(z.SessionStatusManager.instance.MH)],["OperationResult",Qb],["CorrelationId",xb],["ErrorLevel","warning"]])}),this.pg.logKpiFailure({kpiName:hb.c.VEa,errorName:"PictureRemotePasteFailed",optionalProperties:{isIntentional:!1,isInternal:!0,
additionalValues:Ua},optionalVeto:{name:hb.c.j$b,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):u.Health.instance.recordQosError("PictureRemotePasteFailed",eb,!1,!0,!1,!1,null)):(this.iB.J(this.yLa).dVd=!0,this.mob())};this.pg=w.a.getInstance(hb.a);this.Uj=ab;this.Gb=Ea;this.Im=Wa;this.ge=la.App.xa.Hq;this.pEe=Mb;this.Q6=Fb;this.Uak=vb;this._operationId=$a;this.Jik=kb;this.nWg=k.AFrameworkApplication.K.mc("PicturePasteHttpForceInboundDelay",
3E3);this.Wbh=this.K?this.K.$("ProvideUnsupportedUrlSchemeIsEnabled"):!1;la.App.Flc.addHandler(this);this.s$j=!!Bb&&Bb.isFeatureEnabled(121)}get zu(){return this.Wp||(this.Wp=a.a.instance.resolve("Common.Utils.IAriaNotifier"))}get K(){return k.AFrameworkApplication.K}get hgc(){return la.App.hgc}get RNi(){return this.Vlb===la.App.JMf}get CEj(){return this.yLa!==this.iB.count}hvg(){k.AFrameworkApplication.K&&k.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>
{const ub=a.a.instance.Sa("Common.ISystemInitiatedFeedback");ub&&ub.execute(ab=>{ab.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}get jX(){return this.Nl}vxa(ub){var ab;ub.alt.length>Va.slb&&(ub.alt=ub.alt.substring(0,E.a.yz(ub.alt,Va.slb)?Va.slb-1:Va.slb));this.pg.logKpiUsage({kpiName:hb.c.VEa,kpiType:0});if(this.Q6&&jb.VMm(ub)){this.Uak&&I.c(za.a.GAl);var Ea="unknown";this.Wbh&&(ub=new URL(ub.src),Ea=ia[va.a.STo(ub.protocol)]);U.ULS.sendTraceTag(41969745,
322,15,"Unable to paste image with local URL. OperationId: {0}, URL scheme: {1}, rtfDataStatus: {2}",this._operationId,Ea,this.Jik);ub=Object.assign(new fa.a,{extendedProperties:new Map});ub.extendedProperties.set("protocol",Ea);(null===(ab=k.AFrameworkApplication.K)||void 0===ab?0:ab.$("ShouldLogPicturesExtendedHealthKpis"))?(ab={name:hb.c.j$b,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:ub},ub.extendedProperties.set("ErrorLevel",
"warning"),this.pg.logKpiFailure({kpiName:hb.c.VEa,errorName:"PictureRemoteWithLocalPath",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:ub},optionalVeto:ab})):u.Health.instance.recordQosError("PictureRemoteWithLocalPath",eb,!0,!0,!1,!1,ub);this.Nyo()}else ab=new G.DictionaryPropertySet,ub=this.yhj(ub),null!==ub.kEd&&"chart"===ub.kEd.type&&ab.setValue(V.a.jt,7),this.Uj.sae(ab,ub.width,ub.height,!0),U.ULS.shipAssertTag(7869444,307,Ha.ParagraphReader.Wb(this.Ec.currentNode)),this.nzc=
this.ge.Zf("WebServiceCall",jb.SDn),U.ULS.sendTraceTag(20505094,322,50,String.format("ImagePasteRequest img width: {0}, height {1}",ub.width,ub.height)),Ea=qa.a.mw(this.Ec.currentNode),ab=this.Uj.eXd(Ea,ab),this.Srh(ab,ub)}yVf(){0<this.Vlb&&(this.Nl=l.a.create(),this.Hp=this.XL.J(0).node.Vi(),U.ULS.sendTraceTag(38122840,307,50,"Pasted pictures: {0}",this.Vlb),this.r4d&&(U.ULS.sendTraceTag(38122841,307,15,"MaxPicturesExceeded in paste."),this.Rxo()),ya.a.instance.Lng(this.Hp),this.hvg(),this.Hp.contentReplicator.forceOutbound(this.mHn,
null,null))}bhe(ub){if(0<this.Vlb){const Ea=ub.ia(V.a.sha,!1),Wa=ub.ia(W.a.IWc,!1),Bb=ub.ia(W.a.g4,!1);ub=ub.ia(J.a.kga,-1);for(let Mb=0;Mb<this.XL.count;Mb++){var ab=this.XL.J(Mb).blob;ab&&(ab=ab.properties,ab.setValue(V.a.sha,Ea),ab.setValue(W.a.IWc,Wa),ab.setValue(W.a.g4,Bb),ab.setValue(J.a.kga,ub),this.Uj.y9f(ab,ub))}}}Q4a(){}yhj(ub){var ab=oa.WordSectionNavigator.instance.GJ(this.Ec.wn);if(!ab)return ub;var Ea=H.a.Ji(jb.Sf.xB(ab)-jb.Sf.Nva(ab)-jb.Sf.Fna(ab),1);ab=H.a.Ji(jb.Sf.At(ab)-jb.Sf.nJ(ab)-
jb.Sf.$K(ab),0);U.ULS.shipAssertTag(7869449,307,0<=Ea);U.ULS.shipAssertTag(7869450,307,0<=ab);if(ub.height>Ea){const Wa=Ea/ub.height;ub.height=Ea;ub.width=Math.floor(ub.width*Wa)}ub.width>ab&&(Ea=ab/ub.width,ub.width=ab,ub.height=Math.floor(ub.height*Ea));return ub}Nyo(){const ub=Box4Intl.Box4Strings.l_PastedImageFailedWithInvalidUrl;if(!this.nwc||this.nwc.message!==ub&&!this.nwc.zha)this.nwc=this.Q6.Dma(ub,!1),this.Q6.lA(this.nwc)}qOl(){if(this.pEe&&this.pEe.ljp())return this.pEe.Ohp();var ub=new Sys.Net.WebRequest;
ub.set_url("PicturePaste.ashx");ub=ub.getResolvedUrl();k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")||(ub=f.a.fo(ub,Y.a.fileId,this.Hp.vr));return ub}tXo(ub,ab){if(ub&&ab){const Ea=H.a.vf(na.ImageReader.JC(ub.properties),0);ub=H.a.vf(na.ImageReader.HH(ub.properties),1);0<Ea&&Ea<ab.width&&(ab.width=Ea,ab.height=ub)}}mob(){const ub={},ab=l.a.create().toString();ub[jb.correlationID]=ab;k.AFrameworkApplication.Ne.xj(this.iB.J(this.yLa).url,2,this.iB.J(this.yLa).$5n,ub,!1,
2,this.picturePasteRequestSucceeded,this.igc,null,void 0,void 0,void 0,void 0,"26");jb.bSf++;U.ULS.sendTraceTag(572528018,307,50,"SendPicturePasteRequest PicturePaste request added to the queue with correlation id : {0}",ab)}w_l(ub){return ub&&ub.data?ub.data.Qe:-1}Rnm(){ya.a.instance.Xmc(this.Hp,127);this.vCh()}vCh(){U.ULS.shipAssertTag(7869458,307,this.CEj);const ub=new sa.GraphTransaction(15);ub.Cb(this.XL.J(0).node);for(let ab=this.yLa;ab<this.iB.count;ab++){const Ea=this.iB.J(ab).sDm;for(let Wa=
0;Wa<Ea.count;Wa++){const Bb=Ea.J(Wa).blob.properties;this.Uj.eTa(Bb,Box4Intl.Box4Strings.l_PastedImageFailed);na.ImageReader.$lj(Bb)}}ub.dispose();this.Im.b3b(this.Hp,!1);this.KAh()}Rxo(){const ub=new L.StandardDialog;ub.Ad=0;ub.nx(0,Box4Intl.Box4Strings.l_MaxPicturesExceededTitle,String.format(Box4Intl.Box4Strings.l_MaxPicturesExceededMessage,la.App.JMf),null,!0);k.AFrameworkApplication.va.processAction(za.a.n1i,2)}Cqn(ub,ab){ub.alt.length>Va.slb&&(ub.alt=ub.alt.substring(0,E.a.yz(ub.alt,Va.slb)?
Va.slb-1:Va.slb));const Ea=new G.DictionaryPropertySet;this.Uj.sae(Ea,ub.width,ub.height);ab=this.Uj.eXd(ab,Ea);ub=this.yhj(ub);this.Srh(ab,ub)}KAh(){}LAh(){}MAh(){}wVd(){return!!jb.bSf}static get Sf(){return ja.a.instance}static VMm(ub){return!!ub&&!!ub.src&&!va.a.CCi(ub.src)}}jb.Zlf=1E3;jb.jIl=4;jb.SDn="PicturePasteRequestTime";jb.correlationID="X-CorrelationId";jb.bSf=0;jb.tcn=20971520;Object(F.a)(jb,"Box4ImageSteward",Va,[551])},1968:function(F,K,c){F=c(0);var l=c(55),f=c(88),a=c(11),k=c(27);
class x extends Sys.UI.Control{constructor(H,L,I,N){super(document.createElement("div"));this.gZ=this.Zja=this.IL=this.Yv=this.q2=this.q9a=this.Jbb=null;this.duc=this.kab=!1;this.content=this._title=null;this.Mja=0;this.Cwh=null;this.Cfa=0;this.cYi=null;this.uih=H;this.bYb=L;this.sk=I;this.oFh=N;this.gj=L.ownerDocument;this.vVd=this.Et=this.zS=!1}get r9(){this.Jbb||(this.Jbb=this.gj.createElement("div"),this.Jbb.id=this.mj("WACCalloutOuter"),this.Jbb.className="WACCalloutOuter",this.Jbb.setAttribute(k.a.qh,
k.a.hvh),this.Jbb.style.width=this.Mja+"px");return this.Jbb}get jFc(){if(!this.q9a){this.q9a=this.gj.createElement("div");this.q9a.id=this.mj("WACCalloutBeakContainer");this.q9a.className="WACCalloutBeakContainer";var H="CalloutBeakTopFilled_32x16x32";if(5===this.Cfa||6===this.Cfa||4===this.Cfa)H="CalloutBeakBottomFilled_32x16x32";H=f.createClusteredImage(32,16,H,"WACCalloutBeak",!0,"");this.q9a.appendChild(H)}return this.q9a}set jFc(H){this.q9a=H}get ax(){return this.zS}get title(){return this._title}set title(H){this._title!==
H&&(this._title=H,this.Zja&&(this.Zja.innerText=this._title))}get Et(){return this.kab}set Et(H){this.kab!==H&&(this.kab=H,this.q2&&(this.q2.contains(this.IL)&&!this.kab?this.q2.removeChild(this.IL):!this.q2.contains(this.IL)&&this.kab&&this.Qnh()))}get vVd(){return this.duc}set vVd(H){this.duc!==H&&(this.duc=H,this.q2&&(this.q2.contains(this.Zja)&&!this.duc?this.q2.removeChild(this.Zja):!this.q2.contains(this.Zja)&&this.duc&&this.Aph()))}show(){this.zS||(this.dal(),this.LI(),this.bYb.appendChild(this.r9),
this.r9.style.display="Block",this.roo(),this.zS=!0,this.cYi&&this.cYi())}dismiss(){this.zS&&(this.Bml(),this.bYb.removeChild(this.r9),this.zS=!1,this.oFh&&this.oFh())}dispose(){this.dismiss();this.Zja=this.IL=this.Yv=this.q9a=this.q2=this.Jbb=null;Sys.Component.prototype.dispose.call(this)}mj(H){return this.get_element().id+H}dal(){this.q2=this.gj.createElement("div");this.q2.id=this.mj("WACCalloutHeader");this.q2.className="WACCalloutHeader";this.Et&&this.Qnh();this.vVd&&this.Aph();this.Yv=this.gj.createElement("div");
this.Yv.id=this.mj("WACCalloutContent");this.Yv.className="WACCalloutContent";this.Yv.style.width=190<this.Mja?this.Mja-26+"px":"164px";this.Yv.appendChild(this.content);this.r9.appendChild(this.jFc);this.r9.appendChild(this.q2);this.r9.appendChild(this.Yv)}Qnh(){this.IL=this.gj.createElement("a");this.IL.className="WACCalloutCloseAnchor";this.IL.id=this.mj("WACCalloutCloseAnchor");this.IL.href="#";this.q2.appendChild(this.IL);const H=f.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",
!0,CommonUIStrings.l_DialogClose);this.IL.appendChild(H)}Aph(){this.Zja=this.gj.createElement("div");this.Zja.className="WACCalloutTitle UIFontBold";this.Zja.style.width=190<this.Mja?this.Mja-30+"px":"160px";this.Zja.id=this.mj("WACCalloutTitle");this.Zja.innerText=this.title;this.q2.contains(this.IL)?this.q2.insertBefore(this.Zja,this.IL):this.q2.appendChild(this.Zja)}roo(){var H=this.uih;let L;if(1===this.Cfa){var I=this.Cwh.y+16;L=-16}else 2===this.Cfa||3===this.Cfa||0===this.Cfa?(I=H.y+H.height+
15,L=-15):(I=H.y-this.r9.clientHeight-15-2,L=this.r9.clientHeight-1);this.r9.style.top=I+"px";this.jFc.style.top=L+"px";1===this.Cfa?(H=this.Cwh.x-16,this.r9.style.left="50%",this.r9.style.marginLeft=-this.Mja/2+"px",I=Sys.UI.DomElement.getBounds(this.r9),this.jFc.style.left=H-I.x+"px"):(I=H.x+this.uih.width/2,2===this.Cfa||5===this.Cfa?(H=20,I-=36):0===this.Cfa||4===this.Cfa?(H=this.Mja/2-16,I-=this.Mja/2):(H=this.Mja-20-32,I=I-this.Mja+36),this.r9.style.left=I+"px",this.jFc.style.left=H+"px")}LI(){this.Et&&
!this.gZ&&(this.gZ=Object(l.a)(this,this.qma,"closeHandler"),this.sk.nb(a.a.click,this.IL,this.gZ,null))}Bml(){this.Et&&this.gZ&&(this.sk.sc(a.a.click,this.IL,this.gZ),this.gZ=null)}qma(){this.dismiss();return!0}}Object(F.a)(x,"Callout",Sys.UI.Control,[1147]);class y extends x{constructor(H,L,I,N,Q,M=null){super(H,I,Q.k1,M);this.n7g=0;this.Mja=this.h4l(N);this.v_b=L;this.Ri=Q;this.fLo=7;this.Pq=this.v_b.ownerDocument.createElement("div");this.Pq.className="ModalCalloutControlOverlay";this.Pq.tabIndex=
0;this.v_b.insertBefore(this.Pq,this.v_b.firstChild)}show(){this.ax||(this.Ri.rae(),this.Ri.Dfa(!1),this.Pq.style.zIndex=String(this.Ri.aCa),super.show(),this.Fz(),this.n7g=window.setTimeout(Object(l.a)(this,this.dismiss,"dismiss"),1E3*this.fLo))}dismiss(){this.ax&&(this.Ri.tba(!1),this.j$(),this.v_b&&this.v_b.contains(this.Pq)&&this.v_b.removeChild(this.Pq),super.dismiss(),window.clearTimeout(this.n7g))}Fz(){this.Ri.WZ(Object(l.a)(this,this.dismiss,"dismiss"));this.Ri.gD.nb(a.a.click,this.Pq,Object(l.a)(this,
this.onClick,"onClick"))}j$(){this.Ri.ada(Object(l.a)(this,this.dismiss,"dismiss"));this.Ri.gD.sc(a.a.click,this.Pq,Object(l.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}h4l(H){let L=0;switch(H){case 0:L=190;break;case 1:L=250;break;case 2:L=300;break;case 3:L=360}return L}}Object(F.a)(y,"ModalCallout",x,[]);var n=c(7),u=c(528),z=c(176);class w extends y{constructor(H,L,I,N,Q,M=null){super(H,L,I,N,Q,M);this.IS=null}show(){if(!this.ax){const H=Object.assign(new u.a,{onShow:()=>
{y.prototype.show.call(this)}});z.UISurfaces.vM().then(L=>{const I=L.externalNotification();this.IS=L.addNotification(I,H);return null},L=>{n.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",L);return null})}}dismiss(){this.ax&&this.IS&&(z.UISurfaces.vM().then(H=>{H.removeNotification(this.IS);return this.IS=null},H=>{n.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null}),super.dismiss())}}Object(F.a)(w,"ReactManagedModalCallout",
y,[]);var E=c(2);c.d(K,"a",function(){return G});class G{static qMh(H,L,I,N){return E.AFrameworkApplication.ta.Nb.zQa?new w(H,L,I,N,E.AFrameworkApplication.ta,null):new y(H,L,I,N,E.AFrameworkApplication.ta,null)}}Object(F.a)(G,"ModalCalloutControlFactory",null,[])},1972:function(F,K,c){F=c(0);var l=c(53),f=c(124),a=c(19),k=c(2),x=c(82);class y{constructor(G,H){this.value=G;this.AJl=H}get gZd(){return this.AJl}}Object(F.a)(y,"ElementValueWrapper",null,[]);class n extends y{constructor(G,H,L){super(G,
H);this.uBi=L}}Object(F.a)(n,"DimensionWrapper",y,[]);var u=c(1692),z=c(1693),w=c(7);c.d(K,"a",function(){return E});class E{static get Zoi(){return E.K6j}static get mle(){return E.imk}static get kle(){return E.hmk}static Rvf(G,H,...L){H=E.Gji(H);let I=!1;H||(H=E.ojm(G,...L),I=!!H);return new y(H,I)}static Gji(G){for(const H of G)if(void 0!==H&&null!==H&&""!==H)return H.trim();return null}static ojm(G,...H){for(const L of H)if(H=G.getAttribute(L),void 0!==H&&null!==H&&(H+="",void 0!==H&&null!==H&&
""!==H))return H.trim();return null}static n9l(G,H){H=parseFloat(H);if(isNaN(H))return 0;switch(G){case "px":return Math.round(H);case "pt":return Math.round(l.a.J0(H,0,!1));case "in":return Math.round(l.a.Zba(H,0,!1));case "cm":return Math.round(l.a.Zba(f.a.pCh(H),0,!1));case "mm":return Math.round(l.a.Zba(f.a.pCh(.1*H),0,!1));default:return H}}static Oee(G,H,...L){G=E.Rvf(G,H,...L);L=0;H=!1;if(G.value){H=G.value.endsWith("%");let I;H?(L="%",I=a.a.substring(G.value,0,G.value.length-1)):G.gZd?(L=
"px",I=G.value):(L=G.value.substr(G.value.length-2),isNaN(parseFloat(L))?I=a.a.substring(G.value,0,G.value.length-2):(L="px",I=G.value));L=E.n9l(L,I)}return new n(L,G.gZd,H)}static Tji(G){return E.Oee(G,[G.style.width],"width","WIDTH","Width")}static A$h(G){return E.Oee(G,[G.style.height],"height","HEIGHT","Height")}static nJ(G){return E.Oee(G,[G.style.marginLeft],"leftmargin","LEFTMARGIN","LeftMargin")}static $K(G){return E.Oee(G,[G.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static tjm(G){G=
E.Rvf(G,[G.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return G.value&&G.value in E.mle&&void 0!==E.mle[G.value]&&null!==E.mle[G.value]?E.mle[G.value]:0}static jUm(G){G=E.Gji([G.style.borderCollapse]);return!!G&&!(void 0===G||null===G)&&("collapse"===G||"COLLAPSE"===G||"Collapse"===G)}static kOl(G){return E.Rvf(G,[G.style.backgroundColor,G.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static J7k(G){const H=a.a.substring(G,0,1),L=a.a.substring(G,1,2);G=a.a.substring(G,
2,3);return H+H+L+L+G+G}static zua(G){let H="";if(!G||""===G)return H;H=G.trim();if(H.startsWith("rgb")){H=a.a.substring(H,H.indexOf("(")+1,H.length-1);G=H.split(",");if(3!==G.length)return"";H="";for(let I=0;I<G.length;I++){var L=parseInt(G[I]);if(isNaN(L)||0>L||255<L)return"";L=L.toString(16);1===L.length&&(L="0"+L);H+=L}return a.a.XA(H)}if(E.Zoi[a.a.Ug(H)])return E.Zoi[a.a.Ug(H)];H.startsWith("#")&&(H=a.a.substring(H,1,H.length));if(isNaN(parseInt(H,16)))return"";3===H.length&&(H=E.J7k(H));return 6!==
H.length?"":H}static NBn(G){var H=G.indexOf("mso-tab-count");if(-1===H)return 0;const L=RegExp("([\\d])");let I="";for(H=H+13+1;H<G.length;H++){const N=G.charAt(H).toString();if(L.test(N))I+=N;else break}G=0;""!==I&&(G=parseInt(I));return G}static NUd(G,H){const L=E.kOl(G);L&&""!==L&&H.jv(I=>I.N9(E.zua(L)))}static N5h(G){var H,L=G.style;if(!L)return null;let I=E.kle[L.borderTopStyle];const N=E.zua(L.borderTopColor);let Q=L.borderTopWidth,M=E.kle[L.borderRightStyle];const J=E.zua(L.borderRightColor);
let V=L.borderRightWidth,X=E.kle[L.borderBottomStyle];const W=E.zua(L.borderBottomColor);let U=L.borderBottomWidth,Y=E.kle[L.borderLeftStyle];const ba=E.zua(L.borderLeftColor);L=L.borderLeftWidth;k.AFrameworkApplication.ue("gdea6103;0df65435");if(null===(H=k.AFrameworkApplication.K)||void 0===H?0:H.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBorderFixEnabled",!1))G=G.getAttribute("border"),null!==G&&(I=this.Zic(G,I),X=this.Zic(G,X),Y=this.Zic(G,Y),M=this.Zic(G,M),Q=this.$ic(G,Q),
V=this.$ic(G,V),U=this.$ic(G,U),L=this.$ic(G,L),w.ULS.sendTraceTag(509125330,3022,50,"getCellBorders: Table Border Attribute found and fixed"));return new u.a(I,M,X,Y,N,J,W,ba,Q,V,U,L)}static $ic(G,H){return""===H?G+"px":H}static Zic(G,H){return 0===H?"0"===G?1:11:H}static eQl(G){var H=G.querySelectorAll("[class^=TableCellContent]");H=1===H.length?H[0]:void 0;return(G=(null===H||void 0===H?0:H.style)?H.style:G.style)?new z.a(G.paddingTop,G.paddingRight,G.paddingBottom,G.paddingLeft):null}}E.K6j=x.a.D5("aliceblue",
"F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood","DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9",
"darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B","darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia",
"FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo","4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3",
"lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00","limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise",
"48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500","orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080",
"red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD","slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5",
"yellow","FFFF00","yellowgreen","9ACD32");E.imk=x.a.D5("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);E.hmk=x.a.D5("",0,"initial",3,"inherit",11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(F.a)(E,"DefaultHtmlTranslatorHelper",null,[])},1975:function(F,K,c){F=c(0);class l{constructor(a){this.next=null;this.data=a}}Object(F.a)(l,
"QueueNode",null,[]);c.d(K,"a",function(){return f});class f{constructor(){this.Itb=this.Jrb=null;this.fj=0}get count(){return this.fj}get isEmpty(){return!this.count||!this.Jrb||!this.Itb}enqueue(a){a=new l(a);this.isEmpty?this.Itb=this.Jrb=a:this.Jrb=this.Jrb.next=a;this.fj=this.count+1}back(){return this.isEmpty?null:this.Jrb.data}dequeue(){if(this.isEmpty)return null;const a=this.Itb;this.Itb=a.next;this.fj=this.count-1;this.Itb||(this.Jrb=null);return a.data}clear(){this.Itb=this.Jrb=null;this.fj=
0}toArray(){const a=Array(this.count);let k=this.Itb;for(let x=0;x<this.count&&k;x++)a[x]=k.data,k=k.next;return a}}Object(F.a)(f,"Queue",null,[])},2034:function(F,K,c){c.d(K,"b",function(){return l});c.d(K,"e",function(){return f});c.d(K,"d",function(){return a});c.d(K,"c",function(){return k});c.d(K,"h",function(){return x});c.d(K,"a",function(){return y});c.d(K,"f",function(){return n});c.d(K,"g",function(){return u});var l;(function(z){z[z.Unspecified=0]="Unspecified";z[z.Inline=1]="Inline";z[z.Floating=
2]="Floating"})(l||(l={}));var f;(function(z){z[z.Undefined=0]="Undefined";z[z.Bullet=1]="Bullet";z[z.Numbered=2]="Numbered";z[z.Lim=3]="Lim";z[z.Nil=4]="Nil";z[z.Any=5]="Any";z[z.NoList=6]="NoList";z[z.Invalid=7]="Invalid"})(f||(f={}));var a;(function(z){z[z.DontCare=1]="DontCare";z[z.Thin=2]="Thin";z[z.ExtraLight=3]="ExtraLight";z[z.Light=4]="Light";z[z.Normal=5]="Normal";z[z.Medium=6]="Medium";z[z.SemiBold=7]="SemiBold";z[z.Bold=8]="Bold";z[z.ExtraBold=9]="ExtraBold";z[z.Heavy=10]="Heavy"})(a||
(a={}));var k;(function(z){z[z.NoCaps=0]="NoCaps";z[z.SmallCaps=1]="SmallCaps";z[z.AllCaps=2]="AllCaps";z[z.AllPetiteCaps=3]="AllPetiteCaps";z[z.PetiteCaps=4]="PetiteCaps";z[z.Unicase=5]="Unicase";z[z.Titling=6]="Titling";z[z.Other=7]="Other"})(k||(k={}));var x;(function(z){z[z.None=0]="None";z[z.Words=1]="Words";z[z.SingleLine=2]="SingleLine";z[z.DoubleLine=3]="DoubleLine";z[z.HeavyLine=4]="HeavyLine";z[z.DottedLine=5]="DottedLine";z[z.DottedHeavyLine=6]="DottedHeavyLine";z[z.DashLine=7]="DashLine";
z[z.DashHeavyLine=8]="DashHeavyLine";z[z.DashLongLine=9]="DashLongLine";z[z.DashLongHeavyLine=10]="DashLongHeavyLine";z[z.DotDashLine=11]="DotDashLine";z[z.DotDashHeavyLine=12]="DotDashHeavyLine";z[z.DotDotDashLine=13]="DotDotDashLine";z[z.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";z[z.WavyLine=15]="WavyLine";z[z.WavyHeavyLine=16]="WavyHeavyLine";z[z.WavyDoubleLine=17]="WavyDoubleLine"})(x||(x={}));var y;(function(z){z[z.Left=0]="Left";z[z.Right=1]="Right";z[z.Center=2]="Center";z[z.Justified=
3]="Justified";z[z.Other=4]="Other";z[z.None=5]="None";z[z.JustifyLow=6]="JustifyLow";z[z.Distributed=7]="Distributed";z[z.ThaiDistributed=8]="ThaiDistributed"})(y||(y={}));var n;(function(z){z[z.Image=0]="Image";z[z.TextBox=1]="TextBox";z[z.Chart=2]="Chart";z[z.SmartArt=3]="SmartArt";z[z.Drawing=4]="Drawing";z[z.EquationObject=5]="EquationObject";z[z.Ink=6]="Ink";z[z.InkSpace=7]="InkSpace";z[z.InkEndOfLine=8]="InkEndOfLine";z[z.LineBreak=9]="LineBreak";z[z.PageBreak=10]="PageBreak";z[z.PageNumbers=
11]="PageNumbers";z[z.FootnoteEndnote=12]="FootnoteEndnote";z[z.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";z[z.Tab=14]="Tab";z[z.UnsupportedObject=15]="UnsupportedObject";z[z.Other=16]="Other"})(n||(n={}));var u;(function(z){z[z.Initial=0]="Initial";z[z.FirstLine=1]="FirstLine";z[z.Hanging=2]="Hanging"})(u||(u={}))},2036:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);var l;(function(f){f[f.normal=0]="normal";f[f.beingCreated=1]="beingCreated";f[f.beingEdited=2]="beingEdited"})(l||
(l={}));Object(F.b)("CommentType",l)},2038:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{static jrf(f){return f===l.create?0:f===l.reply?1:f===l.edit?2:f===l.metadata?3:null}}l.create="CREATE";l.reply="REPLY";l.edit="EDIT";l.metadata="METADATA";Object(F.a)(l,"CommentSessionType",null,[])},2039:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);var l;(function(f){f[f.unsaved=0]="unsaved";f[f.sentToServer=1]="sentToServer";f[f.succeeded=2]="succeeded";f[f.failed=3]="failed";f[f.saveNotNeeded=
4]="saveNotNeeded"})(l||(l={}));Object(F.b)("CommentSaveStatus",l)},2040:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a){this.className=f;this.AQc=a}}Object(F.a)(l,"HighlightCssClassPair",null,[])},2041:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.type=this.action=0;this.LJ=this.FA=null}}Object(F.a)(l,"HighlightOperation",null,[])},2042:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);K=c(229);var l=c(105);class f extends K.a{constructor(){super();
this.LastKnownPaginationRevision=this.FileId=null}fl(){return 36}static eba(a,k){const x=new f;x.FileId=a;x.LastKnownPaginationRevision=l.a(k);return x}}Object(F.a)(f,"PaginationRequest",K.a,[])},2044:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{L8b(f,a){let k="g";a.matchCase||a.j4d||(k+="i");if(a.matchPrefix||a.matchWholeWord)f="\\b"+f;if(a.matchSuffix||a.matchWholeWord)f+="\\b";return new RegExp(f,k)}static get instance(){return l._instance||(l._instance=new l)}}l._instance=null;
Object(F.a)(l,"FindUtils",null,[1239])},2046:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a){this._text=f;this.ptc=a}get text(){return this._text}get matchCase(){return this.ZHb(1)}get matchWholeWord(){return this.ZHb(2)}get j4d(){return this.ZHb(4)}get matchPrefix(){return this.ZHb(8)}get matchSuffix(){return this.ZHb(16)}get ignorePunct(){return this.ZHb(32)}get ignoreSpace(){return this.ZHb(64)}ZHb(f){return(this.ptc&f)===f}static createQuery(f,a){return new l(f,
a)}}Object(F.a)(l,"Query",null,[1237])},2047:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);var l;(function(f){f[f.none=0]="none";f[f.matchCase=1]="matchCase";f[f.wholeWordOnly=2]="wholeWordOnly";f[f.wildCards=4]="wildCards";f[f.prefix=8]="prefix";f[f.suffix=16]="suffix";f[f.ignorePunct=32]="ignorePunct";f[f.ignoreSpace=64]="ignoreSpace"})(l||(l={}));Object(F.b)("QueryFilters",l)},2048:function(F,K,c){c.d(K,"a",function(){return y});F=c(0);var l=c(174),f=c(171),a=c(2),k=c(66),x=c(198);class y extends l.a{constructor(n,
u=!1){super(n,!1,u)}get dVc(){return!1}get UK(){return x.a.NJc+"/modeless"}get Pkb(){return null}set Pkb(n){}get Lkb(){return null}set Lkb(n){}Wh(n,u=null,z=null){this.bT&&(z.isModal=!1);super.Wh(n,u,z)}hide(){if(a.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.Hc)this.LGj(),a.AFrameworkApplication.ta.ox.Xw(f.AFrame.LNf),super.hide()}btk(){const n=a.AFrameworkApplication.ta.ox,u=a.AFrameworkApplication.ta.Ap;n.Jaa(this.UK);
n.dT(this.UK);u.fe(this.UK).parent=f.AFrame.rp}eCa(){k.FocusManager.bK()&&(super.eCa(),this.btk(),a.AFrameworkApplication.ta.ox.FI(f.AFrame.LNf))}q5f(){if(k.FocusManager.bK()&&!a.AFrameworkApplication.Nk){const n=k.FocusManager.instance();n.CR(this.UK);const u=n.getRegion(this.UK);u&&u.fk.Ly(null);n.N5a(this.UK)}}Xca(){"DL"===this.VBa||"DP"===this.VBa?super.Xca():a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("WacAutoFitNonModalDialogIsEnabled")?(this.LGj(),this.pwh()&&this.Stj(this.Hc.clientHeight,
this.Hc.clientWidth)):this.vL()}vL(){this.Stj(l.a.JRg,l.a.QRg)}Stj(n,u){if(this.Lkb&&this.Pkb){let z,w;z=x.a.hae+this.Pkb;w=x.a.gae+this.Lkb;z+n>this.xB()&&(z=this.xB()-n);w+u>this.At()&&(w=this.At()-u);this.Ttj(z,w)}else super.vL()}xsf(n){if(!n)return null;n.endsWith("px")&&(n=n.substring(0,n.length-2));return x.a.sbc(n)?((n=parseInt(n))||(n=1),n):null}LGj(){if(this.Hc&&this.Hc.style){var n=this.xsf(this.Hc.style.top);n&&(this.Pkb=n-x.a.hae);if(n=a.AFrameworkApplication.isRtl?this.xsf(this.Hc.style.right):
this.xsf(this.Hc.style.left))this.Lkb=n-x.a.gae}}}Object(F.a)(y,"ModelessCustomDialog",l.a,[])},2049:function(F,K,c){c.d(K,"a",function(){return z});F=c(0);var l=c(7),f=c(2),a=c(310),k=c(196),x=c(635),y=c(760),n=c(761),u=c(19);class z{constructor(w,E=null,G=-1,H=null){this.d7=w;this.slh=H||(()=>E);this.zhd=G}xj(w,E,G,H,L,I,N,Q,M,J=null,V=!1,X=null,W=null){const U=new XMLHttpRequest;let Y="";I="";2===E?(Y="POST",G&&(I=G)):Y="GET";E={};this.d7&&(w=a.a.xZe(E,w,a.a.Uoe,f.AFrameworkApplication.xRb,this.d7));
U.open(Y,w,!0);this.kPk(E,w);if(H)for(let aa in H)U.setRequestHeader(aa,u.a.aR(H[aa]));for(let aa in E)U.setRequestHeader(aa,E[aa]);w=X||this.zhd;0<w&&(U.timeout=w);w=[];Array.add(w,a.a.N7);H=new Sys.Net.WebRequest;const ba=new y.a(1,2,H,w,L,N,Q,M,V,J,W);U.onreadystatechange=()=>{this.utn(U,ba)};try{U.send(I)}catch(aa){l.ULS.sendTraceTag(24938643,205,15,"Invoke failed in SimpleClientRequestSender")}return 1}N8b(){return 1}utn(w,E){if(this.lXk(w,E)&&4===w.readyState)if(w.getResponseHeader(a.a.zWh)&&
f.AFrameworkApplication.$Kc)f.AFrameworkApplication.$Kc();else{var G=w.getResponseHeader(a.a.rBh);a.a.kmg(G);this.vZo(w,E);w.status===k.a.My?(E.status=2,E.dI(new n.a(E))):(E.status=w.status&&w.status!==k.a.Ehc?w.status===k.a.via?5:3:7,E.K3(new x.a(E)))}}kPk(w,E){w["X-xhr"]=1;f.AFrameworkApplication.i3a&&(w[a.a.iKi]=1);f.AFrameworkApplication.buildVersion&&(w[a.a.Jec]=u.a.aR(f.AFrameworkApplication.buildVersion));let G=null;this.slh&&(G=this.slh());G&&(w[a.a.Zog]=G);f.AFrameworkApplication.canary&&
(w[a.a.z2b]=u.a.aR(f.AFrameworkApplication.canary),f.AFrameworkApplication.pYc&&l.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",w[a.a.z2b]));f.AFrameworkApplication.accessToken&&(a.a.JAb(E,f.AFrameworkApplication.j7)||(w[a.a.xYe]=u.a.aR(f.AFrameworkApplication.accessToken)),a.a.JAb(E,f.AFrameworkApplication.$Ba)||(w[a.a.yYe]=f.AFrameworkApplication.KMa.toString()));f.AFrameworkApplication.userType&&(w[a.a.rJj]=u.a.aR(f.AFrameworkApplication.userType))}vZo(w,E){E.Qe=w.status?w.status:k.a.Ehc;
try{E.ve=w.responseText;if(void 0!==E.KSa&&null!==E.KSa){E.Bj={};for(let G=0;G<E.KSa.length;++G){const H=E.KSa[G];E.Bj[H]=w.getResponseHeader(H)}}E.Bie&&(E.Hia=w.responseText&&w.responseText.length?w.responseXML:null)}catch(G){l.ULS.sendTraceTag(24938645,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",E.id,E.request.get_url(),4===w.readyState)}}lXk(w,E){return w?E?!0:(l.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),
!1):(l.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),!1)}static create(w,E,G){return new z(w,null,G,E)}}Object(F.a)(z,"SimpleClientRequestSender",null,[851])},2050:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);var l;(function(f){f[f.connected=0]="connected";f[f.disconnected=1]="disconnected";f[f.connecting=2]="connecting";f[f.timeout=3]="timeout"})(l||(l={}));Object(F.b)("AppNetworkConnectivityState",l)},2051:function(F,
K,c){c.d(K,"a",function(){return l});F=c(0);class l{COa(){}D6b(){}Yhe(){}qge(){}reset(){}Skf(){}update(){}Fob(){}dispose(){}}Object(F.a)(l,"FindStatusManagerStub",null,[376,10])},2059:function(F,K,c){c.d(K,"b",function(){return l});c.d(K,"a",function(){return f});var l;(function(a){a[a.None=0]="None";a[a.BetweenLeftAndRightMargin=1]="BetweenLeftAndRightMargin";a[a.BetweenLeftAndRightEdge=2]="BetweenLeftAndRightEdge";a[a.FitToBox=3]="FitToBox"})(l||(l={}));var f;(function(a){a.left="left";a.center=
"center";a.right="right";a.both="both"})(f||(f={}))},2079:function(F,K,c){F=c(0);var l=c(1611),f=c(1612),a=c(1675),k=c(221),x=c(35);class y{}y.eventType="Type";y.zgb="Time";y.eventId="Id";y.Xvh="AttributionId";y.Yvh="AttributionProvider";y.Wvh="AttributionName";y.Gvh="AssigneeId";y.Hvh="AssigneeProvider";y.Fvh="AssigneeName";y.startDate="Start";y.endDate="End";y.title="Title";y.oGh="Anchor";y.anchorExtensionList="AnchorExtensionList";y.v1i="Percent";y.priority="Priority";y.undoId="UndoId";y.isLossy=
"IsLossy";y.recordExtensionList="RecordExtensionList";Object(F.a)(y,"Key",null,[]);var n=c(364),u=c(1817);const z=E=>{if(!E)return null;let G=null;E=n.a.$3b(E,H=>H.toString(),H=>H.toString());0<E.count&&(G=new u.a(E));return G};c.d(K,"a",function(){return w});class w{O$f(E){if(!E)return"[]";E=w.y7k(E);return x.c(E)}X4b(E){E=x.b(E||"[]");return w.h7k(E)}static Kda(E,G){throw Error.argument(E,G);}static u8b(E,G){G=G.toString();return G in E?E[G].toString():null}static uFb(E,G){G=G.toString();G in E||
w.Kda("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",G));return E[G].toString()}static mrf(E,G){G=G.toString();G in E||w.Kda("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",G));return Number.parseInvariant(E[G].toString())}static F6l(E,G,H){G=G.toString();return G in E?Boolean.parse(E[G].toString()):H}static G6l(E,G){G=G.toString();return G in E?E[G]:null}static Sgg(E){E=new Date(E);isNaN(E.getUTCMilliseconds())&&w.Kda("dateTime",
"Date and time is in invalid format");return E}static odf(E){return E.toISOString()}static DLh(E,G){return z(w.G6l(E,G))}static z7k(E){const G={};G[y.eventType]=E.type;G[y.zgb]=w.odf(E.time);G[y.eventId]=E.recordId;E.isLossy!==w.wzi&&(G[y.isLossy]=E.isLossy);E.user&&(E.user.UserId&&E.user.Provider&&E.user.DisplayName||w.Kda("record","HistoryRecord has invalid attribution"),G[y.Xvh]=E.user.UserId,G[y.Yvh]=E.user.Provider,G[y.Wvh]=E.user.DisplayName);E.commentId&&(G[y.oGh]=E.commentId);if(E.anchorExtensionList&&
E.anchorExtensionList.extensions){var H=E.anchorExtensionList.extensions.Slc();G[y.anchorExtensionList]=H}E.recordExtensionList&&E.recordExtensionList.extensions&&(H=E.recordExtensionList.extensions.Slc(),G[y.recordExtensionList]=H);switch(E.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:E.assignee&&E.assignee.UserId&&E.assignee.Provider&&E.assignee.DisplayName||w.Kda("record","HistoryRecord has invalid assignee");G[y.Gvh]=E.assignee.UserId;G[y.Hvh]=E.assignee.Provider;G[y.Fvh]=E.assignee.DisplayName;
break;case 5:E.schedule||w.Kda("record","Schedule history record must have a schedule object");E.schedule.startDate&&(G[y.startDate]=w.odf(E.schedule.startDate));E.schedule.endDate&&(G[y.endDate]=w.odf(E.schedule.endDate));break;case 6:(0>E.completion||100<E.completion)&&w.Kda("record","Progress history record must have a completion >= 0 and <= 100");G[y.v1i]=E.completion;break;case 10:(0>E.priority||10<E.priority)&&w.Kda("record","Priority history record must have a completion >= 0 and <= 10");G[y.priority]=
E.priority;break;case 9:E.title||w.Kda("record","SetTitle history record must have a title");G[y.title]=E.title;break;case -1:E.undoId||w.Kda("record","Undo history record must have an id to undo");G[y.undoId]=E.undoId;break;default:w.Kda("record","Unsupported history record type")}return G}static I7k(E){var G=null,H=w.u8b(E,y.Xvh);const L=w.u8b(E,y.Yvh),I=w.u8b(E,y.Wvh);if(H||L||I)H&&L&&I||w.Kda("dictionary","Record has invalid attribution user"),G=new l.a(H,L,I);G=new f.a(w.mrf(E,y.eventType),G,
w.Sgg(w.uFb(E,y.zgb)),w.uFb(E,y.eventId));G.commentId=w.u8b(E,y.oGh);G.anchorExtensionList=w.DLh(E,y.anchorExtensionList);G.recordExtensionList=w.DLh(E,y.recordExtensionList);G.isLossy=w.F6l(E,y.isLossy,w.wzi);switch(G.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:G.assignee=new l.a(w.uFb(E,y.Gvh),w.uFb(E,y.Hvh),w.uFb(E,y.Fvh));break;case 5:G.schedule=new a.a;if(H=w.u8b(E,y.startDate))G.schedule.startDate=w.Sgg(H);if(E=w.u8b(E,y.endDate))G.schedule.endDate=w.Sgg(E);break;case 10:G.priority=
w.mrf(E,y.priority);(0>G.priority||10<G.priority)&&w.Kda("dictionary","Priority record must have history >= 0 and <= 10");break;case 6:G.completion=w.mrf(E,y.v1i);(0>G.completion||100<G.completion)&&w.Kda("dictionary","Progress record must have history >= 0 and <= 100");break;case 9:G.title=w.uFb(E,y.title);break;case -1:G.undoId=w.uFb(E,y.undoId);break;default:w.Kda("dictionary","Unsupported history record type")}return G}static y7k(E){const G=Array(E.length);for(let H=0;H<E.length;++H)G[H]=w.z7k(E.J(H));
return G}static h7k(E){const G=new k.a;for(const H of E)E=w.I7k(H),G.add(E);return G}}w.wzi=!1;Object(F.a)(w,"JsonTaskHistorySerialization",null,[708])},2080:function(F,K,c){F=c(0);var l=c(2),f=c(7),a;(function(x){x[x.Healthy=0]="Healthy";x[x.MissedScan=1]="MissedScan";x[x.NeedsReset=2]="NeedsReset";x[x.CriticalUnresponsive=3]="CriticalUnresponsive";x[x.KickoutComponent=4]="KickoutComponent"})(a||(a={}));Object(F.b)("TimerBasedWatchDogStatus",a);c.d(K,"a",function(){return k});class k{constructor(x,
y,n){this.Utd=this.L3g=this.O4g=this.NTb=this.SAa=0;this.sPi=3;this.kId=3E4;this.p_b=x;this.N9a=y;this.$ki=n}X5a(){this.SAa=0}async qfn(){const x=Date.now(),y=this.p_b.Rcc;this.Utd++;if(this.L3g==y&&this.mvo(x,this.O4g))return{["WatchDogScanTime"]:x,["LastComponentScanTime"]:y,["ComponentStatus"]:a[this.NTb],["ActionTaken"]:"None. Skipping to Match Interval"};this.L3g=y;this.O4g=x;this.N9a=this.p_b.EOh;this.NTb=this.V6h(x,y);3===this.NTb&&(await this.NRo(),this.NTb=this.V6h(x,this.p_b.Rcc));return this.KCk(this.NTb,
x,y)}gWm(){return 0===this.NTb}V6h(x,y){let n=0;x>y+Math.max(this.N9a,this.kId)+this.$ki&&(n=0===this.SAa?1:this.SAa<this.sPi?2:this.SAa===this.sPi?3:4);return n}KCk(x,y,n){const u={};u.WatchDogScanNumber=this.Utd;u.WatchDogScanTime=y;u.LastComponentScanTime=n;u.ComponentStatus=a[x];u.ExpectedComponentScanInterval=this.N9a;u.GraceTimeInMS=this.$ki;u.ActualTimeBetweenWatchDogAndComponentScans=y-n;switch(x){case 0:u.ActionTaken="None";this.SAa=0;break;case 1:this.SAa++;u.ActionTaken="Missed Scan, Wait to Restart component";
break;case 2:this.SAa++;u.ActionTaken="Component restarted";f.ULS.sendTraceTag(509686347,3037,15,"Restarting Component with interval {0}",this.N9a);this.p_b.fwj();x=this.N9a;this.bGf&&(x=Math.min(this.N9a,this.kId/2));this.p_b.rvj(x);break;case 3:this.SAa++;u["ActionTaken?"]="Attempted Synchronous run: "+a[x];break;case 4:f.ULS.sendTraceTag(512570578,3037,10,"Component is not Responding. WatchDog would kickout now"),u["ActionTaken?"]="Kickout would happen here",this.SAa++}u.NextExpectedComponentScanTimeInMs=
n+(this.SAa+1)*this.N9a;u.MissedScans=this.SAa;return u}async NRo(){return this.p_b.g2h()}mvo(x,y){return y+this.N9a>x}get bGf(){return null!=this.BDg?this.BDg:this.BDg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RunComponentBeforeNextScan",!1)}}Object(F.a)(k,"TimerBasedWatchDog",null,[1349])},2082:function(F,K,c){F=c(0);class l{constructor(k){this.result=null;this.d9i=k}exec(k){return(this.result=this.d9i.exec(k))?!0:!1}lJ(){return this.result.index}DQd(){return this.d9i.lastIndex}}
Object(F.a)(l,"RegularExpressionWrapper",null,[]);var f=c(19);c.d(K,"a",function(){return a});class a{h2c(k){return this.dvj(k).join("").replace(RegExp("(\\\\.\\\\.\\\\.)","g"),"(\\.\\.\\.|\u2026)")}w3i(k){var x=k.text;x=k.j4d?this.uCo(x):this.dvj(x);if(k.ignorePunct||k.ignoreSpace){let y="";k.ignoreSpace&&(y+="\\s");k.ignorePunct&&(y+=a.TLn);y="["+y+"]*";for(let n=1;n<x.length;n++)if(!k.j4d||"{"!==x[n].charAt(0)&&"@"!==x[n].charAt(0))x[n]=y+x[n]}return x.join("")}vLb(k){return[k]}v0d(k){for(let x=
0;x<k.length;++x){const y=k.charAt(x);let n=0;if("["===y){if(!({KD:n}=this.GTm(k.substr(x))).returnValue)return!1;x=n+x-1}else if("<"===y){if(!this.DTm(k.substr(x)))return!1}else if(">"===y){if(!x)return!1}else if("{"===y){if(!x||!({KD:n}=this.FTm(k.substr(x))).returnValue)return!1;x=n+x-1}else if("@"===y){if(!x||!this.ETm(k.substr(x)))return!1}else if("("===y){if(!({KD:n}=this.CTm(k.substr(x))).returnValue)return!1;x=n+x-1}else if("}"===y||"]"===y||")"===y)return!1}return!0}g0h(k,x){let y,n;n=y=
0;if(k.length<=x)return{returnValue:!1,KD:y,pcd:n};const u=k.length;var z=k.charAt(x);if("["===z)for(z=x+1;z<u;z++){if("]"===k.charAt(z)&&1!==z-x)return y=z,n=5,{returnValue:!0,KD:y,pcd:n}}else if("{"===z)for(z=-1,x+=1;x<u;x++){let w=k.charAt(x);if(","===w)z=x;else if("}"===w)return n=-1===z?6:1!==x-z?7:8,y=x,{returnValue:!0,KD:y,pcd:n}}return{returnValue:!1,KD:y,pcd:n}}kRo(k,x,y){let n;if((n=x)||1!==k.length)switch(k.charAt(x+1)){case "{":let u,z;if(!({KD:u,pcd:z}=this.g0h(k,x+1)).returnValue)return{returnValue:this.CIa("*",
y,!1),KD:n};k=this.CIa("*",y,!0)+this.CIa(k.substring(x+1,u+1),z);n=u;if(7===z||8===z)k+="?";return{returnValue:k,KD:n};case "@":return n=x+1,{returnValue:this.CIa("*",y,!0),KD:n};case "*":if(!x){for(n++;"*"===k.charAt(n);)n++;if(n===k.length)return{returnValue:this.CIa("*",y,!0),KD:n}}return{returnValue:this.CIa("*",y,!1),KD:n};default:return{returnValue:this.CIa("*",y,!1),KD:n}}else return{returnValue:this.CIa(k,y,!0),KD:n}}CIa(k,x,y=!1){const n=k.length;switch(x){case 5:return"!"===k.charAt(1)&&
2<n?"([^"+this.x3i(k.substr(2,n-3))+"]\u0640*)":"(["+this.x3i(k.substr(1,n-2))+"]\u0640*)";case 6:return k;case 7:return k;case 9:return"+?";case 8:return k;case 3:return"\\b";case 4:return"\\b";case 1:return".";case 2:return y?"(.+?)":"(.*?)";case 10:return k}return null}Vji(k){switch(k){case "?":return 1;case "*":return 2;case "<":return 3;case ">":return 4;case "@":return 9}return 0}sGn(k){return"["===k||"]"===k||"\\"===k||"("===k||")"===k?String.format("\\{0}",k):"'"===k||"\u2018"===k||"\u2019"===
k||'"'===k||"\u201c"===k||"\u201d"===k||f.a.sca(k)?this.q0f(k):k}x3i(k){const x=[];for(let y=0;y<k.length;++y)x[y]=this.sGn(k.charAt(y));return x.join("")}GTm(k){let x;var y;x=-1;var n=new l(RegExp("\\[.+?\\]","g"));if(n.exec(k)){if(y=n.lJ())return{returnValue:!1,KD:x};x=n.DQd()}else return{returnValue:!1,KD:x};if((new l(RegExp("(\\(\\))|(.+?!)","g"))).exec(k.substring(1,x-1)))return{returnValue:!1,KD:x};y=new l(RegExp("[^!\\[]-[^\\]]","g"));for(k.substring(0,x);y.exec(k.substring(0,x));){n=y.lJ();
const u=RegExp("[-]","g");n=k.substring(n,y.DQd()).split(u);if(n[0].charAt(0)>n[1].charAt(0))return{returnValue:!1,KD:x}}return{returnValue:!0,KD:x}}DTm(k){return(new l(RegExp("\\<(\\{|\\@|\\>|\\<|\\}|\\))","g"))).exec(k)?!1:!0}FTm(k){let x;x=-1;var y;if((new l(RegExp("(\\}\\{)|(\\}\\@)","g"))).exec(k))return{returnValue:!1,KD:x};const n=new l(RegExp("\\{\\d+(,|(,\\d+))?\\}","g"));if(n.exec(k)){if(y=n.lJ())return{returnValue:!1,KD:x};x=n.DQd();y=RegExp("[{,}]","g");y=k.substring(0,x).split(y);if(4===
y.length&&(k=Number.parseInvariant(y[1]),y=Number.parseInvariant(y[2]),k>=y))return{returnValue:!1,KD:x}}else return{returnValue:!1,KD:x};return{returnValue:!0,KD:x}}ETm(k){return(new l(RegExp("\\@\\{","g"))).exec(k)?!1:!0}CTm(k){let x;x=-1;let y;const n=new l(RegExp("\\(([^\\[\\]]*?(\\[.+?\\])?)+?\\)","g"));if(n.exec(k)){y=n.lJ();x=n.DQd();if(y)return{returnValue:!1,KD:x};if(this.v0d(k.substring(1,x-1)))return{returnValue:!0,KD:x}}return{returnValue:!1,KD:x}}uCo(k){const x=[],y=k.length;let n=0;
for(let u=0;u<y;++u){const z=n,w=k.charAt(u);let E=0,G=0;"["===w||"\\"===w||"^"===w||"$"===w||"."===w||"|"===w||"+"===w||"("===w||")"===w||"?"===w||"*"===w||"<"===w||">"===w||"@"===w||"?"===w||"{"===w?"["!==w&&"{"!==w||!({KD:E,pcd:G}=this.g0h(k,u)).returnValue?"?"===w||"<"===w||">"===w||"@"===w?(G=this.Vji(w),x[z]=this.CIa(w,G)):"*"===w?(G=this.Vji(w),x[z]=({KD:E}=this.kRo(k,u,G)).returnValue,u=E):"("===w||")"===w?(G=10,x[z]=this.CIa(w,G)):x[z]=String.format("\\{0}",w):(x[z]=this.CIa(k.substr(u,E+
1-u),G),u=E):x[z]="'"===w||"\u2018"===w||"\u2019"===w||'"'===w||"\u201c"===w||"\u201d"===w||"-"===w||"\u2013"===w||"\u2014"===w||f.a.sca(w)?"["+this.q0f(w)+"]":"\u2026"===w?"\\.\\.\\.":w;""!==x[z]&&0===G&&(x[z]=u<k.length-1&&("@"===k.charAt(u+1)||"{"===k.charAt(u+1))?"("+x[z]+"\u0640*)":x[z]+"\u0640*");n++}return x}dvj(k){const x=[];for(let y=0;y<k.length;++y){const n=k.charAt(y);x[y]="["===n||"\\"===n||"^"===n||"$"===n||"."===n||"|"===n||"+"===n||"("===n||")"===n||"?"===n||"*"===n?String.format("\\{0}",
n):"'"===n||"\u2018"===n||"\u2019"===n||'"'===n||"\u201c"===n||"\u201d"===n||"-"===n||"\u2013"===n||"\u2014"===n||f.a.sca(n)?"["+this.q0f(n)+"]":"\u2026"===n?"\\.\\.\\.":n;""!==x[y]&&(x[y]+="\u0640*")}return x}q0f(k){return"'"===k||"\u2018"===k||"\u2019"===k?"'\u2018\u2019":'"'===k||"\u201c"===k||"\u201d"===k?'"\u201c\u201d':"-"===k||"\u2013"===k||"\u2014"===k?"-\u2013\u2014":f.a.sca(k)?a.oSo:k}static get instance(){return a._instance||(a._instance=new a)}}a._instance=null;a.oSo=" \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000";
a.TLn='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d\u201c';Object(F.a)(a,"WordQueryProcessor",null,[930])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19794043/wdjs/WordEditorDSVersionHistoryRemoved.common.js.map