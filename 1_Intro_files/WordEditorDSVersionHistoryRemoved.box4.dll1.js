'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1053:function(F,K,c){function l(M,J=self){J.addEventListener("message",function W(X){if(X&&X.data){var {id:U,type:Y,path:ba}=Object.assign({path:[]},X.data),aa=(X.data.evh||[]).map(n);try{const na=ba.slice(0,-1).reduce((ja,qa)=>ja[qa],M),oa=ba.reduce((ja,qa)=>ja[qa],M);switch(Y){case "GET":var fa=oa;break;case "SET":na[ba.slice(-1)[0]]=n(X.data.value);fa=!0;break;case "APPLY":fa=oa.apply(na,aa);break;case "CONSTRUCT":const ja=
new oa(...aa);fa=Object.assign(ja,{[w]:!0});break;case "ENDPOINT":const {port1:qa,port2:Ia}=new MessageChannel;l(M,Ia);fa=x(qa,[qa]);break;case "RELEASE":fa=void 0;break;default:return}}catch(na){fa={value:na,[H]:0}}Promise.resolve(fa).catch(na=>({value:na,[H]:0})).then(na=>{const [oa,ja]=y(na);J.postMessage(Object.assign(Object.assign({},oa),{id:U}),ja);"RELEASE"===Y&&(J.removeEventListener("message",W),"MessagePort"===J.constructor.name&&J.close())})}});J.start&&J.start()}function f(M){if(M)throw Error("Proxy has been released and is not useable");
}function a(M,J=[],V=function(){}){let X=!1;const W=new Proxy(V,{get(U,Y){f(X);if(Y===G)return()=>u(M,{type:"RELEASE",path:J.map(ba=>ba.toString())}).then(()=>{"MessagePort"===M.constructor.name&&M.close();X=!0});if("then"===Y){if(0===J.length)return{then:()=>W};U=u(M,{type:"GET",path:J.map(ba=>ba.toString())}).then(n);return U.then.bind(U)}return a(M,[...J,Y])},set(U,Y,ba){f(X);const [aa,fa]=y(ba);return u(M,{type:"SET",path:[...J,Y].map(na=>na.toString()),value:aa},fa).then(n)},apply(U,Y,ba){f(X);
U=J[J.length-1];if(U===E)return u(M,{type:"ENDPOINT"}).then(n);if("bind"===U)return a(M,J.slice(0,-1));const [aa,fa]=k(ba);return u(M,{type:"APPLY",path:J.map(na=>na.toString()),evh:aa},fa).then(n)},construct(U,Y){f(X);const [ba,aa]=k(Y);return u(M,{type:"CONSTRUCT",path:J.map(fa=>fa.toString()),evh:ba},aa).then(n)}});return W}function k(M){M=M.map(y);return[M.map(J=>J[0]),Array.prototype.concat.apply([],M.map(J=>J[1]))]}function x(M,J){N.set(M,J);return M}function y(M){for(const [J,V]of I)if(V.eBh(M)){const [X,
W]=V.serialize(M);return[{type:"HANDLER",name:J,value:X},W]}return[{type:"RAW",value:M},N.get(M)||[]]}function n(M){switch(M.type){case "HANDLER":return I.get(M.name).deserialize(M.value);case "RAW":return M.value}}function u(M,J,V){return new Promise(X=>{const W=z();M.addEventListener("message",function ba(Y){Y.data&&Y.data.id&&Y.data.id===W&&(M.removeEventListener("message",ba),X(Y.data))});M.start&&M.start();M.postMessage(Object.assign({id:W},J),V)})}function z(){return Array(4).fill(0).map(()=>
Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}F=c(0);const w=Symbol("Comlink.proxy"),E=Symbol("Comlink.endpoint"),G=Symbol("Comlink.releaseProxy"),H=Symbol("Comlink.thrown"),L=M=>"object"===typeof M&&null!==M||"function"===typeof M,I=new Map([["proxy",{eBh:M=>L(M)&&M[w],serialize(M){const {port1:J,port2:V}=new MessageChannel;l(M,J);return[V,[V]]},deserialize(M){M.start();return a(M,[],void 0)}}],["throw",{eBh:M=>L(M)&&H in M,serialize({value:M}){return[M instanceof Error?
{fQa:!0,value:{message:M.message,name:M.name,stack:M.stack}}:{fQa:!1,value:M},[]]},deserialize(M){if(M.fQa)throw Object.assign(Error(M.value.message),M.value);throw M.value;}}]]),N=new WeakMap;c.d(K,"a",function(){return Q});class Q{static LUj(M){Q.L$a=M;Q.Mpk=a(M,[],void 0)}static get Endpoint(){return Q.L$a}static get MUj(){return Q.Mpk}}Object(F.a)(Q,"WorkerUtils",null,[])},1068:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{}Object(F.a)(l,"WaterlineOverrideSettings",null,[])},
1069:function(F,K,c){F=c(0);var l=c(412),f=c(520),a=c(566),k=c(229);class x extends k.a{constructor(){super();this.LowWaterline=this.HighWaterline=this.FileId=null}fl(){return 97}static eba(E,G,H){const L=new x;L.FileId=E;L.HighWaterline=G;L.LowWaterline=H;return L}}Object(F.a)(x,"GetActivitiesRequest",k.a,[]);class y extends k.a{constructor(E,G,H){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=E;this.Waterline=G;this.Settings=H}fl(){return 107}static eba(E,G,H){return new y(E,
G,H)}}Object(F.a)(y,"GetRelevantActivitiesRequest",k.a,[]);class n extends k.a{constructor(E,G){super();this.WaterlineOverrideSettings=this.FileId=null;this.FileId=E;this.WaterlineOverrideSettings=G}fl(){return 96}static eba(E,G){return new n(E,G)}}Object(F.a)(n,"GetWywaActivitiesRequest",k.a,[]);class u{}Object(F.a)(u,"RelevantActivitiesSettings",null,[]);class z extends k.a{constructor(){super();this.FileId=null}fl(){return 109}static eba(E){const G=new z;G.FileId=E;return G}}Object(F.a)(z,"UpdateWaterlineRequest",
k.a,[]);c.d(K,"a",function(){return w});class w{constructor(E,G,H,L,I){this.mck=E;this.Etd=G;this.dQe=H;this.Zoc=L;this.qOg=I}requestWYWAActivities(E){E=n.eba(this.Etd(),E);return l.a.then(this.sba(E,"wywa"),G=>G)}requestActivities(E,G){E=x.eba(this.Etd(),E,G);return l.a.then(this.sba(E,"activities"),H=>H)}e6n(){const E=z.eba(this.Etd());return l.a.then(this.sba(E,"waterline"),G=>G)}requestRelevantActivities(E,G){G=Object.assign(new u,{FirstDocumentOpen:G,MockDataEnabled:!1});E=y.eba(this.Etd(),E,
G);return l.a.then(this.sba(E,"relevant"),H=>H)}updateActivityState(E){return l.a.F$c(this.qOg,G=>G.dUo(E.itemIds,E.activityStatesToSet,E.activityStatesToReset,E.resetUnseenCount))}requestActivityFeed(){return l.a.F$c(this.qOg,E=>E.getActivityFeed(null))}sba(E,G){const H={"Content-Type":"application/json; charset=utf-8"};return l.a.then(l.a.F$c(this.mck,L=>L.Tv(this.dQe,H,f.a.WHh(E,this.Zoc),G)),L=>{if(!(L&&L.args&&L.args.data&&L.args.data.ve))return null;({group:L}=a.a.q1(L.args.data.ve));return L&&
L.Responses&&L.Responses.length?L.Responses[0]:null})}}Object(F.a)(w,"SharedActivityRepository",null,[])},1412:function(F,K,c){c.d(K,"a",function(){return f});var l;(function(a){a[a.Unknown=0]="Unknown";a[a.pap=1]="Inference"})(l||(l={}));var f;(function(a){a[a.Unknown=0]="Unknown";a[a.Ccp=1]="VoiceDictationBadge";a[a.Dcp=2]="VoiceDictationPhrase"})(f||(f={}))},1518:function(F,K,c){c.r(K);c.d(K,"Box4PasteSteward",function(){return ba});F=c(0);var l=c(22),f=c(2),a=c(19),k=c(124),x=c(53),y=c(6),n=c(7),
u=c(34),z=c(74),w=c(9),E=c(96),G=c(98),H=c(8),L=c(3),I=c(86),N=c(5),Q=c(141),M=c(36),J=c(81),V=c(40),X=c(56),W=c(28),U=c(441),Y=c(1765);class ba extends Y.a{constructor(aa,fa,na,oa,ja,qa,Ia,Va=null,Na=null){super(aa,Ia,Va,Na);this._formatting=null;this.wKa=!1;this.gub=null;this.NVb=-1;this.Ovb=0;this.bCc=new z.a;this.Sbn=4294967295;u.a(4223754,307,V.OutlineElementReader.Nh(aa));this.nub=fa;this.nub.N1b(this);this.ZL=na;this.ZL.N1b(this);this.jq=oa;this.Un=ja;this.QNe=E.ListItemReader.yg(this.Ec);
ba.AAm();ba.mAm();ba.XAm()}get vwa(){return null!=this.bDg?this.bDg:this.bDg=l.a.instance.Na("Box4.IInternalLinkManager")}get IHd(){return this._formatting}get O3b(){return this.QNe&&!this.ZL.uDa}get YBb(){return 0<this.Ovb}reset(){super.reset();this._formatting=this.Bpf(!1)}B1e(aa){var fa;u.a(4223762,307,V.OutlineElementReader.Nh(this.Ec)||J.OutlineReader.fx(this.Ec));this.lec(!1);var na=new N.GraphIterator;na.Zc(this.Ec);aa=Y.a.eg.YI(this.Ec,this.bPc(aa));this.aBd(na,!1);u.a(4223763,307,aa===this.Ec.currentNode);
u.a(4223764,307,H.ParagraphReader.Wb(aa));-1!==this._formatting.vw&&ba.paragraphEditor.gE(aa,this._formatting.vw);if(ba.paragraphEditor.jq&&!this.$Y.trj&&this._formatting.textIndent&&({unit:ja,returnValue:oa}=ba.d$d(this._formatting.textIndent),na=!1,oa)){if(0>oa){na=!0;var oa=-1*oa}var ja=ba.O$e(oa,ja);na?ba.paragraphEditor.jq.vob(aa,ja):ba.paragraphEditor.jq.lda(aa,ja)}(ba.Ld.rg||I.a.instance.J(1)&&w.App.Ev.AQb)&&aa.setValue(y.a.rQa,!0);this._formatting.lineSpacing&&ba.paragraphEditor.eD(aa,this._formatting.lineSpacing);
f.AFrameworkApplication.ue("702j5362;7g13g664");this._formatting.BR&&(null===(fa=f.AFrameworkApplication.K)||void 0===fa?0:fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(n.ULS.sendTraceTag(509092556,307,50,"Setting before and after Spacing from margin top and bottom which we got from pasted HTML"),ba.paragraphEditor.pob(aa,this._formatting.BR.afterSpacing),ba.paragraphEditor.qob(aa,this._formatting.BR.beforeSpacing));if(this._formatting.Zkc){fa=[];
na=[];ja=[];oa=this._formatting.Zkc.split(" ");let Ia=1,Va=0;for(let Na=0;Na<oa.length;Na++){var qa=ba.Q7k(oa[Na]);const za=ba.P7k(oa[Na]);if(-1!==qa)Ia=qa;else if(-1!==za)Va=za;else{const {unit:la,returnValue:va}=ba.d$d(oa[Na]);qa=ba.O$e(va,la);if(0<=qa&&qa<=this.Sbn)fa.push(qa),na.push(Ia),ja.push(Va);else{u.b(555103310,307,15,"Invalid custom tab value. tabStops: "+this._formatting.Zkc+" index: "+Na);break}Ia=1;Va=0}}0<fa.length&&ba.paragraphEditor.Esk(aa,fa,na,ja)}this._formatting.paragraph=aa;
this.wKa=!0}aBd(aa,fa){u.a(8128518,307,!fa);this.NU&&(0<this.NU&&this.jq.DJc(aa,this.NU),0>this.NU&&this.jq.eSa(aa,this.NU,0));aa&&this.Un.phe(aa,this.YBb);this.NU=0}oad(aa){this.bCc.add(aa)}P7e(){this.NU=0}Lca(aa,fa=null){u.a(4223772,307,H.ParagraphReader.sh(this.Ec));const na=this.Ec.currentNode;this._formatting.Wkg(na);if(!this.$Y.flg(this.Ec,fa,!1)){var oa=na.pa.last,ja=W.a.mw(na);this.wKa&&(oa.formatting=this._formatting.OQ.Df(oa),na.Yl(),this.wKa=!1);aa=this.$Y.Xwf(aa,fa);this.$Y.S9(this.Ec.currentNode,
this._formatting.Rca,fa);this.characterPropertiesEditor.replaceTextRange(ja,aa,void 0,void 0,L.a.paste)}}Kca(aa){this.$Y.l_d&&this.$Y.dZd(aa)?(this.pF(),this.aE(aa)):(u.a(4223773,307,H.ParagraphReader.sh(this.Ec)),aa=W.a.mw(this.Ec.currentNode),this.characterPropertiesEditor.gha(aa,fa=>new U.a(fa)))}Amb(){this.$Y.cxf(this.Ec)}vxa(aa){if(ba.csl(aa)){const fa=this.Ec.currentNode;H.ParagraphReader.Wb(fa)&&(fa.dgc=aa.Gjf)}else this.nub.vxa(aa)}rGa(aa){this._formatting=aa;this.wKa=!0}DRa(aa){u.a(4223774,
307,H.ParagraphReader.sh(this.Ec));u.a(4223775,307,!this.gub);u.a(4223776,307,0>this.NVb);this.gub=aa;this.NVb=H.ParagraphReader.textLength(this.Ec.currentNode)}CRa(){u.a(4223777,307,H.ParagraphReader.sh(this.Ec));u.a(4223778,307,!!this.gub);u.a(4223779,307,0<=this.NVb);let aa=W.a.createTextRange(this.Ec.currentNode,this.NVb,H.ParagraphReader.textLength(this.Ec.currentNode)),fa="",na="";this.vwa&&({R4f:fa,MDb:na}=this.vwa.Ykg(G.a.lPa(this.gub))).returnValue&&(this.gub=fa,na&&(this.characterPropertiesEditor.replaceTextRange(aa,
na),aa=W.a.createTextRange(this.Ec.currentNode,this.NVb,H.ParagraphReader.textLength(this.Ec.currentNode))));ba.hyperlinkEditor.kG(aa,this.gub,!1);this.wKa=!0;this.gub=null;this.NVb=-1}aE(aa){this.B1e(aa);this._formatting.Wme(this.Ec.currentNode);this.$Y.S9(this.Ec.currentNode,this._formatting.Rca,aa,this._formatting.marginLeft,this._formatting.textIndent)}pF(){u.a(4223808,307,H.ParagraphReader.sh(this.Ec));ba.hyperlinkEditor.Cwl(this.Ec.currentNode);M.OutlineElementNavigator.Vd(this.Ec)}vmb(){}umb(){}HRa(){}O4a(){}zxa(){u.a(4223809,
307,V.OutlineElementReader.Nh(this.Ec)||J.OutlineReader.fx(this.Ec));let aa=!1;this.YBb||(aa=this.O3b||!0);aa||(this.NU+=1);this.Ovb++}xxa(){this.Ovb--;let aa=!1;this.YBb||(aa=this.O3b||!0,this.Un.vaj(this.bCc));aa||--this.NU}wGa(aa){u.a(4223810,307,V.OutlineElementReader.Nh(this.Ec)||J.OutlineReader.fx(this.Ec));u.a(4223811,307,!!aa.listStyleType);this.Un.ohe(this.W_m(aa))}yxa(){u.a(4223813,307,V.OutlineElementReader.Nh(this.Ec))}Q4a(aa){this.nub.Q4a(aa)}p9(aa){this.ZL.p9(aa)}n9(){this.ZL.n9()}M4(aa){this.ZL.M4(aa)}o9(){this.ZL.o9()}m9(aa){this.ZL.m9(aa)}l9(){this.ZL.l9()}static get paragraphEditor(){return null!=
ba.IFg?ba.IFg:ba.IFg=l.a.instance.resolve("Box4.IParagraphEditor")}static get hyperlinkEditor(){return null!=ba.cBg?ba.cBg:ba.cBg=l.a.instance.resolve("Box4.IHyperlinkEditor")}static get Ld(){return null!=ba.$Ig?ba.$Ig:ba.$Ig=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get IKj(){return null!=ba.QJg?ba.QJg:ba.QJg=l.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get Ukc(){return ba.kUe}static set Ukc(aa){ba.kUe=aa}static get Vn(){return Q.a.getInstance()}static AAm(){ba.a5a[1]=
X.StyleReader.wordStyleIdHeading1;ba.a5a[2]=X.StyleReader.wordStyleIdHeading2;ba.a5a[3]=X.StyleReader.wordStyleIdHeading3;ba.a5a[4]=X.StyleReader.w8a;ba.a5a[5]=X.StyleReader.x8a;ba.a5a[6]=X.StyleReader.y8a;ba.a5a[7]=null}static mAm(){ba.axa.unspecified=0;ba.axa.defaultUnordered=1;ba.axa.defaultOrdered=1;ba.axa.none=0;ba.axa.disc=1;ba.axa.circle=2;ba.axa.square=3;ba.axa.decimal=1;ba.axa.lowerAlpha=2;ba.axa.lowerRoman=3;ba.axa.upperAlpha=4;ba.axa.upperRoman=5}static XAm(){ba.kUe=ba.IKj.Qr()}static Q7k(aa){let fa=
-1;if(!aa)return fa;aa=aa.toLowerCase();switch(aa){case "left":fa=1;break;case "center":fa=3;break;case "right":fa=4;break;case "decimal":fa=6;break;case "bar":fa=7}return fa}static P7k(aa){let fa=-1;if(!aa)return fa;aa=aa.toLowerCase();switch(aa){case "blank":fa=0;break;case "dotted":fa=1;break;case "dashed":fa=2;break;case "lined":fa=3}return fa}static nBb(aa){const fa=a.a.substring(aa,0,2),na=a.a.substring(aa,2,4);return a.a.substring(aa,4,6)+na+fa}static d$d(aa){let fa=0;const na=aa.length;var oa=
a.a.substring(aa,0,na-2);oa=parseFloat(oa);aa=a.a.substr(aa,na-2,2);switch(aa){case "in":fa=3;break;case "px":fa=7;break;case "cm":fa=1;break;case "pt":fa=5;break;default:n.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",aa),oa=0}return{returnValue:oa,unit:fa}}static O$e(aa,fa){let na=0;switch(fa){case 3:na=k.a.Kv(aa);break;case 7:na=x.a.Fy(aa,0);break;case 1:na=k.a.T6e(aa);break;case 5:na=k.a.Kv(k.a.GZf(aa));break;default:n.ULS.sendTraceTag(8208451,
307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",aa,fa)}return na}static csl(aa){return!!aa&&!!aa.Gjf&&""!==aa.Gjf}}ba.a5a=Array(8);ba.axa={};ba.kUe=null;Object(F.a)(ba,"Box4PasteSteward",Y.a,[])},1552:function(F,K,c){F=c(0);var l=c(2),f=c(2035),a=c(7);const k=(y,n)=>{const u={};let z=null;switch(y){case 0:z="HtmlProcessor";var w=n.a;null!=w&&(u.SessionID=w);var E=n.b.toString();null!=E&&(u.Elements=E);var G=n.c.toString();null!=G&&(u.PrunedElements=
G);var H=n.d.toString();null!=H&&(u.TransparentElements=H);var L=n.e.toString();null!=L&&(u.VoidElements=L);var I=n.f.toString();null!=I&&(u.UnknownElements=I);break;case 1:z="WordConverter";var N=n.a;null!=N&&(u.SessionID=N);var Q=n.b.toString();null!=Q&&(u.BulletsConverted=Q);var M=n.c.toString();null!=M&&(u.NumberedConverted=M);break;case 2:z="FormattingSteward";var J=n.a;null!=J&&(u.SourceApp=J);var V=n.b;null!=V&&(u.Browser=V);var X=n.c;null!=X&&(u.OperationId=X);var W=n.d.toString();null!=W&&
(u.Lang=W);var U=n.e.toString();null!=U&&(u.TextDir=U);var Y=n.f.toString();null!=Y&&(u.Bold=Y);var ba=n.g.toString();null!=ba&&(u.Math=ba);var aa=n.h.toString();null!=aa&&(u.Italics=aa);var fa=n.i.toString();null!=fa&&(u.Underline=fa);var na=n.j.toString();null!=na&&(u.Strikethrough=na);var oa=n.k.toString();null!=oa&&(u.Subscript=oa);var ja=n.l.toString();null!=ja&&(u.Superscript=ja);var qa=n.m.toString();null!=qa&&(u.Fontsize=qa);var Ia=n.n.toString();null!=Ia&&(u.Fontface=Ia);var Va=n.o.toString();
null!=Va&&(u.GrowFontsize=Va);var Na=n.p.toString();null!=Na&&(u.ShrinkFontsize=Na);var za=n.q.toString();null!=za&&(u.FontColor=za);var la=n.r.toString();null!=la&&(u.FontHighlight=la);var va=n.s.toString();null!=va&&(u.ParagraphStyle=va);var ia=n.t.toString();null!=ia&&(u.TextAlign=ia);var pa=n.u.toString();null!=pa&&(u.TextIndent=pa);var sa=n.v.toString();null!=sa&&(u.MarginLeft=sa);var Ha=n.w.toString();null!=Ha&&(u.ParagraphSpaceBefore=Ha);var ra=n.x.toString();null!=ra&&(u.ParagraphSpaceAfter=
ra);var Ma=n.y.toString();null!=Ma&&(u.LineSpace=Ma);var ya=n.z.toString();null!=ya&&(u.CellShadingColor=ya);var Ga=n.ba.toString();null!=Ga&&(u.StyleDefinition=Ga);var wa=n.bb.toString();null!=wa&&(u.TabStops=wa);break;case 3:z="SemanticEvents";var hb=n.a;null!=hb&&(u.SessionID=hb);var eb=n.b.toString();null!=eb&&(u.Text=eb);var jb=n.c.toString();null!=jb&&(u.LineBreak=jb);var ub=n.d.toString();null!=ub&&(u.Image=ub);var ab=n.e.toString();null!=ab&&(u.File=ab);var Ea=n.f.toString();null!=Ea&&(u.FormattingChange=
Ea);var Wa=n.g.toString();null!=Wa&&(u.Anchor=Wa);var Bb=n.h.toString();null!=Bb&&(u.Paragraph=Bb);var Mb=n.i.toString();null!=Mb&&(u.Math=Mb);var Fb=n.j.toString();null!=Fb&&(u.List=Fb);var vb=n.k.toString();null!=vb&&(u.ListItem=vb);var $a=n.l.toString();null!=$a&&(u.RenderAugmentation=$a);var kb=n.m.toString();null!=kb&&(u.Span=kb);break;case 4:z="SemanticTableEvents";var Ua=n.a;null!=Ua&&(u.SessionID=Ua);var Sa=n.b.toString();null!=Sa&&(u.Tables=Sa);var xb=n.c.toString();null!=xb&&(u.TableRow=
xb);var Qb=n.d.toString();null!=Qb&&(u.TableCell=Qb);var Ib=n.e.toString();null!=Ib&&(u.TablePart=Ib);break;case 5:z="HtmlEvents";var $b=n.a;null!=$b&&(u.OperationId=$b);var hc=n.b;null!=hc&&(u.SourceApp=hc);var pb=n.c;null!=pb&&(u.Browser=pb);var dc=null==n.d?null:n.d.toString();null!=dc&&(u.Text=dc);var Ob=null==n.e?null:n.e.toString();null!=Ob&&(u.A=Ob);var Vb=null==n.f?null:n.f.toString();null!=Vb&&(u.Abbr=Vb);var ob=null==n.g?null:n.g.toString();null!=ob&&(u.Acronym=ob);var Xb=null==n.h?null:
n.h.toString();null!=Xb&&(u.Address=Xb);var Xa=null==n.i?null:n.i.toString();null!=Xa&&(u.Applet=Xa);var Pb=null==n.j?null:n.j.toString();null!=Pb&&(u.Area=Pb);var rc=null==n.k?null:n.k.toString();null!=rc&&(u.B=rc);var Ta=null==n.l?null:n.l.toString();null!=Ta&&(u.Base=Ta);var Ab=null==n.m?null:n.m.toString();null!=Ab&&(u.Basefont=Ab);var Db=null==n.n?null:n.n.toString();null!=Db&&(u.Bdo=Db);var ac=null==n.o?null:n.o.toString();null!=ac&&(u.Big=ac);var Pa=null==n.p?null:n.p.toString();null!=Pa&&
(u.Blockquote=Pa);var bb=null==n.q?null:n.q.toString();null!=bb&&(u.Body=bb);var lc=null==n.r?null:n.r.toString();null!=lc&&(u.Br=lc);var rb=null==n.s?null:n.s.toString();null!=rb&&(u.Button=rb);var La=null==n.t?null:n.t.toString();null!=La&&(u.Caption=La);var sb=null==n.u?null:n.u.toString();null!=sb&&(u.Center=sb);var Sb=null==n.v?null:n.v.toString();null!=Sb&&(u.Cite=Sb);var kc=null==n.w?null:n.w.toString();null!=kc&&(u.Code=kc);var Lb=null==n.x?null:n.x.toString();null!=Lb&&(u.Col=Lb);var Qc=
null==n.y?null:n.y.toString();null!=Qc&&(u.Colgroup=Qc);var Dc=null==n.z?null:n.z.toString();null!=Dc&&(u.Dd=Dc);var Fd=null==n.ba?null:n.ba.toString();null!=Fd&&(u.Del=Fd);var pe=null==n.bb?null:n.bb.toString();null!=pe&&(u.Dfn=pe);var ye=null==n.bc?null:n.bc.toString();null!=ye&&(u.Dir=ye);var pf=null==n.bd?null:n.bd.toString();null!=pf&&(u.Div=pf);var Yf=null==n.be?null:n.be.toString();null!=Yf&&(u.Dl=Yf);var Ed=null==n.bf?null:n.bf.toString();null!=Ed&&(u.Dt=Ed);var Rc=null==n.bg?null:n.bg.toString();
null!=Rc&&(u.Em=Rc);var Yc=null==n.bh?null:n.bh.toString();null!=Yc&&(u.Fieldset=Yc);var Mc=null==n.bi?null:n.bi.toString();null!=Mc&&(u.Font=Mc);var ge=null==n.bj?null:n.bj.toString();null!=ge&&(u.Form=ge);var Ne=null==n.bk?null:n.bk.toString();null!=Ne&&(u.Frame=Ne);var Ee=null==n.bl?null:n.bl.toString();null!=Ee&&(u.Frameset=Ee);var Ve=null==n.bm?null:n.bm.toString();null!=Ve&&(u.H=Ve);var mc=null==n.bn?null:n.bn.toString();null!=mc&&(u.Head=mc);var Oc=null==n.bo?null:n.bo.toString();null!=Oc&&
(u.Hr=Oc);var xd=null==n.bp?null:n.bp.toString();null!=xd&&(u.Html=xd);var Dd=null==n.bq?null:n.bq.toString();null!=Dd&&(u.I=Dd);var ud=null==n.br?null:n.br.toString();null!=ud&&(u.Iframe=ud);var He=null==n.bs?null:n.bs.toString();null!=He&&(u.Img=He);var uf=null==n.bt?null:n.bt.toString();null!=uf&&(u.Input=uf);var Lh=null==n.bu?null:n.bu.toString();null!=Lh&&(u.Ins=Lh);var Sf=null==n.bv?null:n.bv.toString();null!=Sf&&(u.Isindex=Sf);var fc=null==n.bw?null:n.bw.toString();null!=fc&&(u.Kbd=fc);var yc=
null==n.bx?null:n.bx.toString();null!=yc&&(u.Label=yc);var Uc=null==n.by?null:n.by.toString();null!=Uc&&(u.Legend=Uc);var zd=null==n.bz?null:n.bz.toString();null!=zd&&(u.Li=zd);var ie=null==n.ca?null:n.ca.toString();null!=ie&&(u.Link=ie);var Oe=null==n.cb?null:n.cb.toString();null!=Oe&&(u.Map=Oe);var Ge=null==n.cc?null:n.cc.toString();null!=Ge&&(u.Math=Ge);var re=null==n.cd?null:n.cd.toString();null!=re&&(u.Menu=re);var mf=null==n.ce?null:n.ce.toString();null!=mf&&(u.Meta=mf);var Xe=null==n.cf?null:
n.cf.toString();null!=Xe&&(u.Noframes=Xe);var qf=null==n.cg?null:n.cg.toString();null!=qf&&(u.Noscript=qf);var kf=null==n.ch?null:n.ch.toString();null!=kf&&(u.Object=kf);var $f=null==n.ci?null:n.ci.toString();null!=$f&&(u.Ol=$f);var xf=null==n.cj?null:n.cj.toString();null!=xf&&(u.Optgroup=xf);var Qg=null==n.ck?null:n.ck.toString();null!=Qg&&(u.Option=Qg);var zb=null==n.cl?null:n.cl.toString();null!=zb&&(u.P=zb);var Yb=null==n.cm?null:n.cm.toString();null!=Yb&&(u.Param=Yb);var Tc=null==n.cn?null:n.cn.toString();
null!=Tc&&(u.Pre=Tc);var Id=null==n.co?null:n.co.toString();null!=Id&&(u.Q=Id);var Xc=null==n.cp?null:n.cp.toString();null!=Xc&&(u.S=Xc);var Le=null==n.cq?null:n.cq.toString();null!=Le&&(u.Samp=Le);var cf=null==n.cr?null:n.cr.toString();null!=cf&&(u.Script=cf);var Ig=null==n.cs?null:n.cs.toString();null!=Ig&&(u.Select=Ig);var Ji=null==n.ct?null:n.ct.toString();null!=Ji&&(u.Small=Ji);var Th=null==n.cu?null:n.cu.toString();null!=Th&&(u.Span=Th);var Ah=null==n.cv?null:n.cv.toString();null!=Ah&&(u.Strike=
Ah);var Pm=null==n.cw?null:n.cw.toString();null!=Pm&&(u.Strong=Pm);var zf=null==n.cx?null:n.cx.toString();null!=zf&&(u.Style=zf);var lg=null==n.cy?null:n.cy.toString();null!=lg&&(u.Sub=lg);var md=null==n.cz?null:n.cz.toString();null!=md&&(u.Sup=md);var td=null==n.da?null:n.da.toString();null!=td&&(u.Tables=td);var Bd=null==n.db?null:n.db.toString();null!=Bd&&(u.Tbody=Bd);var nl=null==n.dc?null:n.dc.toString();null!=nl&&(u.Td=nl);var ni=null==n.dd?null:n.dd.toString();null!=ni&&(u.Textarea=ni);var si=
null==n.de?null:n.de.toString();null!=si&&(u.Tfoot=si);var zi=null==n.df?null:n.df.toString();null!=zi&&(u.Th=zi);var yl=null==n.dg?null:n.dg.toString();null!=yl&&(u.Thead=yl);var Dl=null==n.dh?null:n.dh.toString();null!=Dl&&(u.Title=Dl);var ji=null==n.di?null:n.di.toString();null!=ji&&(u.Tr=ji);var ej=null==n.dj?null:n.dj.toString();null!=ej&&(u.Tt=ej);var fj=null==n.dk?null:n.dk.toString();null!=fj&&(u.U=fj);var um=null==n.dl?null:n.dl.toString();null!=um&&(u.Ul=um);var Gg=null==n.dm?null:n.dm.toString();
null!=Gg&&(u.Var=Gg);var dg=null==n.dn?null:n.dn.toString();null!=dg&&(u.Unknown=dg);break;case 6:z="List";var Ri=n.a;null!=Ri&&(u.SessionID=Ri);var am=n.b.toString();null!=am&&(u.MaxListLevel=am)}u.Table=z;return Sys.Serialization.JavaScriptSerializer.serialize(u)};c.d(K,"a",function(){return x});class x{static get Boa(){null==x.Lub&&(x.Lub=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("UsageEditorLoggingIsDisabled"));return x.Lub}static get uzi(){null==x.lGe&&(x.lGe=!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.$("WordUsageEditorLoggingIsEnabled"));return x.lGe}static l0(y){a.ULS.sendTraceTag(524038472,307,50,y)}static L$h(y){const n={};n.a=y;n.b=0;n.c=0;n.d=0;n.e=0;n.f=0;return n}static B4m(y){x.Boa||x.l0(k(0,y))}static a6h(y){const n={};n._sessionID=y;return n}static Yji(y){const n={};n.a=y;n.b=0;n.c=0;return n}static m9m(y){x.Boa||x.l0(k(1,y))}static K$h(y,n){const u={};u.c=f.a[y];u.a=n;return u}static A4m(y,n){x.uzi&&y&&(y.b=n,x.l0(k(5,y)))}static Bgi(y){const n={};n.a=y;n.b=
0;n.c=0;n.d=0;n.e=0;n.f=0;n.g=0;n.h=0;n.i=0;n.j=0;n.k=0;n.l=0;n.m=0;return n}static N7m(y){x.Boa||x.l0(k(3,y))}static Cgi(y){const n={};n.a=y;n.b=0;n.c=0;n.d=0;n.e=0;return n}static O7m(y){x.Boa||x.l0(k(4,y))}static Cqf(y,n){const u={};u.b=f.a[y];u.c=n;u.d=0;u.e=0;u.f=0;u.g=0;u.h=0;u.i=0;u.j=0;u.k=0;u.l=0;u.m=0;u.n=0;u.o=0;u.p=0;u.q=0;u.r=0;u.s=0;u.t=0;u.w=0;u.x=0;u.y=0;u.z=0;u.u=0;u.v=0;u.ba=0;u.bb=0;return u}static d4m(y,n){x.uzi&&y&&(y.a=n,x.l0(k(2,y)))}static a3l(y){const n={};n.a=y;n.b=-1;return n}static i5m(y){!x.Boa&&
y&&0<=y.b&&x.l0(k(6,y))}}x.Lub=null;x.lGe=null;Object(F.a)(x,"UsageEditor",null,[])},1561:function(F,K,c){c.d(K,"a",function(){return a});F=c(0);var l=c(2),f=c(5);class a{static get Qpb(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordDesignerTelemetryPerConstructIsEnabled")}static zhb(k,x=!1){const y=f.GraphIterator.$a(k);y.vd();return(x?y.Sb(4):y.aha(4))?4:f.GraphIterator.$a(k).zb(36)?16:f.GraphIterator.$a(k).zb(14)?2:f.GraphIterator.$a(k).zb(38)?32:1}}Object(F.a)(a,"ConstructTypeHelper",
null,[])},1576:function(F,K,c){c.d(K,"a",function(){return Va});F=c(0);var l=c(22),f=c(53),a=c(124),k=c(2);K=c(82);var x=c(6),y=c(16),n=c(7),u=c(111),z=c(67),w=c(703),E=c(185),G=c(32),H=c(5),L=c(204),I=c(81),N=c(26),Q=c(76),M=c(21),J=c(333),V=c(1518),X=c(211),W=c(256),U=c(701),Y=c(12),ba=c(43),aa=c(36),fa=c(116),na=c(40),oa=c(269),ja=c(143),qa=c(558),Ia=c(44);class Va{static get Rum(){return Va.I6j}static get avm(){return Va.M6j}static get Zum(){return Va.L6j}static get Xg(){return null!=Va.Lxg?Va.Lxg:
Va.Lxg=X.ContextSetEditor.instance}static get yk(){return null!=Va.PHg?Va.PHg:Va.PHg=l.a.instance.resolve("Box4.ITableEditor")}static get fD(){return null!=Va.HHg?Va.HHg:Va.HHg=l.a.instance.Na("Box4.Styles.ITableCellspacingReader")}static HJn(Na,za){const la=Na.currentNode;M.forEachCell(Na,za.rowSpan,za.colSpan,(va,ia,pa)=>{const sa=va.currentNode;sa!==la&&(sa.hg=!0,Va.zRh(va),!pa&&1<=za.colSpan&&(sa.colSpan=za.colSpan),Va.Mlj(va,za.oja,ia,pa,za.rowSpan,za.colSpan))})}static qKn(Na,za){M.forEachCell(Na,
za.rowSpan,za.colSpan,la=>{Va.pGk(la);Va.zRh(la)})}static pGk(Na){Na=Na.currentNode;Na.hg=!0;Na.r4=!0;Na.Yob=!0}static zRh(Na){Na&&(Na.Sb(1),Object(u.a)(w.a,Na.currentNode)&&Na.xg())}static fHk(Na,za,la){0<za&&(Na=Object(z.a)(E.TableCellNode,Na.currentNode))&&(Na.width=la?za:f.a.Vl(za,0))}static rFk(Na,za,la){if(Na=Object(z.a)(J.TableNode,Na.currentNode))0<za&&(Na.$d=f.a.Fy(za,0)),0<la&&(Na.nu=f.a.Fy(la,0))}static dHk(Na,za){void 0!==za&&null!==za&&Na.currentNode.properties.setValue(x.a.Mqa,Va.avm[za+
""])}static oGk(Na,za){void 0!==za&&null!==za&&""!==za&&(za=parseInt(V.Box4PasteSteward.nBb(za),16),Na.currentNode.properties.setValue(y.a.wH,za))}static RAk(Na){if(Na){if(n.ULS.sendTraceTag(520890260,3022,50,"Adjusting column width after paste."),Object(Ia.a)("AdjustingColumnWidthAfterPaste",!0),16==Na.type){var za=new H.GraphIterator;za.set(Na);if(za.zb(14)){var la=Q.a(za),va=N.TableCellReader.EO(Na);if(za.jd(14)){Na=za.currentNode;var ia=G.TableReader.Iga(za);if(ia){var pa=Array.clone(ia);za=G.TableReader.YQd(za);
var sa=0,Ha=0;for(var ra=0;ra<ia.length;ra++)ra>=la&&ra<la+va?za[ra]>ia[ra]&&(sa+=za[ra]-ia[ra],pa[ra]=za[ra]):Ha+=ia[ra]>za[ra]?ia[ra]-za[ra]:0;(null==Ha||0>=Ha||isNaN(Ha))&&n.ULS.sendTraceTag(521187336,3022,50,"spaceAvailableToShrink is invalid");(null==sa||0>=sa||isNaN(sa))&&n.ULS.sendTraceTag(521187335,3022,50,"spaceToShrink is invalid");if(Ha<sa)for(la=0;la<ia.length;la++)pa[la]=za[la];else for(ra=0;ra<ia.length;ra++)if((ra<la||ra>=la+va)&&ia[ra]>za[ra]){const Ma=(ia[ra]-za[ra])/Ha;pa[ra]-=Ma*
sa;(null==pa[ra]||0>=pa[ra]||isNaN(pa[ra]))&&n.ULS.sendTraceTag(521187334,3022,50,"Getting negative column width for scale {0}",Ma)}la=ja.a.Bda+(Va.fD?Va.fD.Sva(Na):0);for(ia=0;ia<pa.length;ia++)if(null==pa[ia]||0>=pa[ia]||isNaN(pa[ia]))n.ULS.sendTraceTag(521187333,3022,50,"Column width can not be negative."),pa[ia]=f.a.Vl(la,0);Na.hG=pa}else n.ULS.sendTraceTag(510253120,3022,50,"Column width should not be null")}}}}else n.ULS.sendTraceTag(537997910,3022,15,"Table cell should not be null")}static Him(Na){var za=
new H.GraphIterator;za.Zc(Na);if((Na=L.OutlineNavigator.s8f(za))&&I.OutlineReader.fx(za)){za=Na.Gf(x.a.Ao);const la=Na.Gf(x.a.marginLeft);Na=Na.Gf(x.a.marginRight);return za-la-Na}return 0}static ORm(Na){return!(void 0===Na||null===Na||1===Na)}static $ic(Na,za,la,va,ia){if(void 0===za||null===za||""!==za){switch(za){case "thin":za=a.a.T$d(.25);break;case "initial":case "medium":za=a.a.T$d(.5);break;case "thick":za=a.a.T$d(1);break;default:za=Va.oem(za,la,va)}ia.currentNode.properties.setValue(Na,
za)}}static Zic(Na,za,la){void 0!==za&&null!==za&&za&&la.currentNode.properties.setValue(Na,Va.Zum[za+""])}static xho(Na,za,la){void 0!==za&&null!==za&&""!==za&&(za=parseInt(V.Box4PasteSteward.nBb(za),16),la.currentNode.properties.setValue(Na,za))}static oem(Na,za,la){let va=0;const ia=({unit:Na}=V.Box4PasteSteward.d$d(Na)).returnValue;switch(Na){case 5:va=a.a.T$d(ia);break;case 1:va=a.a.hVk(ia);break;case 3:va=a.a.qqi(ia);break;case 7:va=f.a.bEn(ia,la)}if(6===za||7===za||10===za)va/=3;return Math.round(va)}static pem(Na,
za){let la=0;const va=({unit:Na}=V.Box4PasteSteward.d$d(Na)).returnValue;switch(Na){case 5:la=a.a.Qxa(va);break;case 1:la=a.a.S6e(va);break;case 3:la=a.a.mwa(va);break;case 7:la=f.a.Vl(va,za)}return la}static vge(Na,za,la,va,ia,pa,sa){if(ia&&(!sa||16===ia.We||sa||14!==ia.We)&&12!==la){if(sa)switch(va){case 5:va=x.a.Lqa;var Ha=x.a.Xa;var ra=x.a.Wa;var Ma=0;break;case 4:va=x.a.Kqa;Ha=x.a.rb;ra=x.a.qb;Ma=1;break;case 0:va=x.a.Iqa;Ha=x.a.Va;ra=x.a.Ua;Ma=0;break;case 3:va=x.a.Jqa;Ha=x.a.pb;ra=x.a.ob;Ma=
1;break;default:return}else switch(va){case 5:va=x.a.XPb;Ha=x.a.Ipb;ra=x.a.elc;Ma=0;break;case 4:va=x.a.WPb;Ha=x.a.Hpb;ra=x.a.dlc;Ma=1;break;case 0:va=x.a.UPb;Ha=x.a.Fpb;ra=x.a.blc;Ma=0;break;case 3:va=x.a.VPb;Ha=x.a.Gpb;ra=x.a.clc;Ma=1;break;default:return}void 0!==ia.currentNode&&null!==ia.currentNode&&(Va.ORm(la)?(Va.xho(va,Na,ia),Va.Zic(Ha,la,ia),Va.$ic(ra,za,la,Ma,ia)):pa||sa||ia.currentNode.properties.setValue(Ha,"nil"))}}static Mlj(Na,za,la,va,ia,pa){va||(Va.huh(za,Na,!1,!1),Va.a2e(za,Na,!0,
!1));va===pa-1&&Va.a2e(za,Na,!0,!1);la||Va.Huh(za,Na,!0,!1);la===ia-1&&Va.Oth(za,Na,!0,!1)}static Nth(Na,za,la,va){Na&&(Va.Huh(Na,za,la,va),Va.a2e(Na,za,la,va),Va.Oth(Na,za,la,va),Va.huh(Na,za,la,va))}static Huh(Na,za,la,va){Va.vge(Na.borderTopColor,Na.borderTopWidth,Na.borderTopStyle,5,za,la,va)}static a2e(Na,za,la,va){Va.vge(Na.borderRightColor,Na.borderRightWidth,Na.borderRightStyle,4,za,la,va)}static Oth(Na,za,la,va){Va.vge(Na.borderBottomColor,Na.borderBottomWidth,Na.borderBottomStyle,0,za,la,
va)}static huh(Na,za,la,va){Va.vge(Na.borderLeftColor,Na.borderLeftWidth,Na.borderLeftStyle,3,za,la,va)}static wge(Na,za,la){if(la&&16===la.We&&""!==Na){switch(za){case 3:za=x.a.dIa;var va=0;break;case 2:za=x.a.NR;va=1;break;case 0:za=x.a.bIa;va=0;break;case 1:za=x.a.tP;va=1;break;default:return}(Na=Va.pem(Na,va))&&la.currentNode.properties.setValue(za,Na)}}static MEk(Na,za){za&&(Va.XGk(za,Na),Va.hGk(za,Na),Va.TEk(za,Na),Va.BFk(za,Na))}static XGk(Na,za){Va.wge(Na.bVk,3,za)}static hGk(Na,za){Va.wge(Na.aVk,
2,za)}static TEk(Na,za){Va.wge(Na.ZUk,0,za)}static BFk(Na,za){Va.wge(Na.$Uk,1,za)}static ZEk(Na,za,la,va){var ia=0;const pa=Array(Na.length);var sa=0;va&&(sa=(sa=a.a.Sad(Va.Him(za)))?sa:1);for(va=0;va<Na.length;va++)pa[va]=0<sa?sa/100*Na[va]:f.a.Vl(Na[va],0),ia+=pa[va];Na=la.getValue(y.a.Lz);va=new H.GraphIterator;va.Zc(za);za=0;if(N.TableCellReader.b0(va)){if(Na=M.returnToContainingCell(va))za=Na.width;sa=Q.a(va);va=M.returnToContainingTable(va);if(-1!==sa&&sa<=va.hG.length){let Ha=0;for(let ra=
sa;ra<sa+Na.colSpan&&ra<va.hG.length;ra++)Ha+=va.hG[ra];za=Math.min(za,Ha);za===Ha&&(za-=f.a.Vl(Va.ghn,0))}}else if(Na)for(sa=0;sa<Na.length;sa++)za+=Na[sa];if(0<za&&ia>za&&ia)for(ia=za/ia,za=0;za<pa.length;za++)pa[za]*=ia;la.setValue(y.a.Lz,pa)}static iGk(Na,za){Na.currentNode.setValue(x.a.f1,f.a.Vl(za,1))}static foo(Na){var za,la;n.ULS.sendTraceTag(520890259,3022,50,"Setting selection info and bound");Object(Ia.a)("SettingTableSelectionBounds",!0);var va=Na.gb,ia=Na.tg;Na=Va.Xg.PQ(ia,16);if(ia=
Va.Xg.iT(ia,14))if(ia=ia.node,!ia||14!==ia.type)n.ULS.sendTraceTag(537507990,306,15,"Table node must be present");else if(!Na)n.ULS.sendTraceTag(537507991,306,15,"Cell context must be present");else{if(!((null===(la=null===(za=null===va||void 0===va?void 0:va.kb)||void 0===za?void 0:za.Me)||void 0===la?0:la.Oa)&&va.kb.Me.Oa.contextId===Y.a.d1&&W.TableBorderSelectionCache.oPa()&&0<W.TableBorderSelectionCache.oPa().length)){W.TableBorderSelectionCache.KSc(ia);za=W.TableBorderSelectionCache.K9;za.leftMostColumnSelected=
Number.MAX_SAFE_INTEGER;za.rightMostColumnSelected=Number.MIN_SAFE_INTEGER;za.topMostRowSelected=Number.MAX_SAFE_INTEGER;za.bottomMostRowSelected=Number.MIN_SAFE_INTEGER;for(la=0;la<Na.length;la++){if(Na.getContext(la).contextId!==Y.a.tableCell)return;va=Na.getContext(la).node;if(!N.TableCellReader.Ur(va)){var pa=new H.GraphIterator;pa.set(va);if(pa.zb(14)&&M.getContainingTable(pa)===ia){pa.jd(14);pa=N.TableCellReader.hEa(pa,va);if(!pa)return;Array.add(W.TableBorderSelectionCache.oPa(),new U.a(va,
pa.rowIndex,pa.vo,va.rowSpan,va.colSpan));za.leftMostColumnSelected=Math.min(za.leftMostColumnSelected,pa.vo);za.rightMostColumnSelected=Math.max(za.rightMostColumnSelected,pa.vo);za.topMostRowSelected=Math.min(za.topMostRowSelected,pa.rowIndex);za.bottomMostRowSelected=Math.max(za.bottomMostRowSelected,pa.rowIndex)}}}W.TableBorderSelectionCache.K9=za}}else n.ULS.sendTraceTag(537145810,306,15,"IP in table should be there")}static thj(Na){var za;if(Na&&14===Na.type){n.ULS.sendTraceTag(520890258,3022,
50,"Scaling Column Width");Object(Ia.a)("ScalingColumnWidthForCCP",!0);var la=new H.GraphIterator;la.set(Na);if(la.vd()&&G.TableReader.ex(la)){var va=Na.hG,ia=G.TableReader.YQd(la),pa=M.returnToContainingCell(la),sa=M.getContainingTable(la);if(pa&&sa){var Ha=Q.a(la),ra=N.TableCellReader.EO(pa);if(la.jd(14)){var Ma=G.TableReader.Iga(la);la=0;for(let ya=Ha;ya<Ha+ra;ya++)la+=Ma[ya];Ha=ja.a.yM(pa,sa,x.a.tP,x.a.za,0);pa=ja.a.yM(pa,sa,x.a.NR,x.a.Aa,0);la-=f.a.Vl(Ha+pa,0);(null==la||0>=la||isNaN(la))&&n.ULS.sendTraceTag(521187332,
3022,50,"Containing cell width is invalid for cell margins {0} & {1}",Ha,pa);pa=0;for(sa=0;sa<va.length;sa++)pa+=va[sa];sa=la/pa;(null==sa||0>=sa||isNaN(sa))&&n.ULS.sendTraceTag(521187331,3022,50,"scale is invalid");Ha=0;for(ra=0;ra<va.length;ra++)Ma=va[ra],va[ra]*=sa,va[ra]<ia[ra]&&(va[ra]=ia[ra],1>sa&&(null===(za=k.AFrameworkApplication.K)||void 0===za?0:za.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1))&&(sa=(la-ia[ra])/(pa-Ma))),Ha+=va[ra];Ha>la&&(va=
Array.clone(ia));za=ja.a.Bda+(Va.fD?Va.fD.Sva(Na):0);for(ia=0;ia<va.length;ia++)if(null==va[ia]||0>=va[ia]||isNaN(va[ia]))n.ULS.sendTraceTag(521187330,3022,50,"Column width is invalid for inner table"),va[ia]=f.a.Vl(za,0);za=new ba.GraphTransaction(4);za.Cb(Na);Na.hG=va;za.dispose()}}}else n.ULS.sendTraceTag(512291460,3022,50,"Table is not a nested table.")}else n.ULS.sendTraceTag(524932511,3022,15,"Table node should not be null")}static Q4n(Na){if(!Na||!G.TableReader.SGf(Na)||1!=Na.Mp())return n.ULS.sendTraceTag(525361986,
3022,50,"Outline iterator should contain a single table"),null;n.ULS.sendTraceTag(525361987,3022,50,"Pasting table over cell selection");Object(Ia.a)("ReplaceTableContentForExternalPaste",!0);let za=new H.GraphIterator;za.set(Na.currentNode);za.zb(14);aa.OutlineElementNavigator.Ge(za);const la=new H.GraphIterator;la.set(Na.currentNode);la.zb(14);if(!la.jd(14)||!za||14!=za.currentNode.type)return null;if(Na=M.getContainingTableCell(za))if(Na=N.TableCellReader.hEa(la,Na)){if(W.TableBorderSelectionCache.nQc())var va=
this.Ccm();else{va=G.TableReader.ag(za.currentNode)-(G.TableReader.ag(la.currentNode)-Na.rowIndex);var ia=G.TableReader.Zg(za.currentNode)-(G.TableReader.Zg(la.currentNode)-Na.vo);this.svk(la,va,ia);va=new oa.a(Na.vo,G.TableReader.Zg(la.currentNode)-1,Na.rowIndex,G.TableReader.ag(la.currentNode)-1)}if(!va)return null;ia=va.bottomMostRowSelected-va.topMostRowSelected+1;var pa=va.rightMostColumnSelected-va.leftMostColumnSelected+1;ia=Math.min(ia,G.TableReader.ag(za.currentNode));pa=Math.min(pa,G.TableReader.Zg(za.currentNode));
for(let sa=0;sa<ia;sa++){M.moveToCell(la,sa+va.topMostRowSelected,va.leftMostColumnSelected);M.moveToCell(za,sa,0);for(let Ha=0;Ha<pa;Ha++)sa==Na.rowIndex-va.topMostRowSelected&&Ha==Na.vo-va.leftMostColumnSelected||this.TPi(za,la),M.moveToNextColumn(la),M.moveToNextColumn(za);la.mt(14);za.mt(14)}M.moveToCell(la,Na.rowIndex,Na.vo);Na.rowIndex-va.topMostRowSelected<G.TableReader.ag(za.currentNode)&&Na.vo-va.leftMostColumnSelected<G.TableReader.Zg(za.currentNode)?M.moveToCell(za,Na.rowIndex-va.topMostRowSelected,
Na.vo-va.leftMostColumnSelected):za=null;this.TPi(za,la);la.mt(14);M.moveToCell(la,va.topMostRowSelected,va.leftMostColumnSelected);la.Pd();return la.currentNode}}static wCn(Na){if(Na&&G.TableReader.SGf(Na)&&1==Na.Mp()){n.ULS.sendTraceTag(520890257,3022,50,"Pasting table below table");Object(Ia.a)("PasteTableBelowTable",!0);var za=new H.GraphIterator;za.set(Na.currentNode);Na=fa.a.$a(Na.currentNode);za.Bp()&&Na.Bp()&&(aa.OutlineElementNavigator.t0(Na,!1,!0),na.OutlineElementReader.Nh(Na)&&1==Na.Mp()&&
(aa.OutlineElementNavigator.Ge(za),aa.OutlineElementNavigator.Ge(Na),za&&Na&&za.currentNode!=Na.currentNode&&G.TableReader.isTable(za)&&G.TableReader.isTable(Na)&&this.Mdn(za,Na)&&(n.ULS.sendTraceTag(525361989,3022,50,"Pasting table below table"),za.xg(),za.xg())))}else n.ULS.sendTraceTag(525361988,3022,50,"Outline iterator should contain a single table")}static TPi(Na,za){if(za&&N.TableCellReader.isTableCell(za)){var la=za.Mp();if(Na&&N.TableCellReader.isTableCell(Na)&&Na.vz())for(;Na.vz();)Na.Pd(),
za.Af(Na.currentNode,Na.role),Na.xg();else la--;for(;0<la--;)za.Pd(),za.xg()}}static Mdn(Na,za){if(!G.TableReader.isTable(Na)||!G.TableReader.isTable(za))return!1;var la=G.TableReader.Zg(Na.currentNode),va=G.TableReader.Zg(za.currentNode);if(la!=va)return n.ULS.sendTraceTag(525361990,3022,50,"Number of columns in source and target table should be same"),!1;la=G.TableReader.ag(Na.currentNode);va=G.TableReader.ag(za.currentNode);const ia=new ba.GraphTransaction(4);ia.Cb(za.currentNode);za.currentNode.setValue(y.a.Rya,
la+va);for(ia.dispose();Na.vz();){Na.Pd();za.Af(Na.currentNode,1);la=new H.GraphIterator;la.set(Na.currentNode);Na.xg();la.Pd();do la.currentNode&&16==la.currentNode.type&&(la.currentNode.VE=za.currentNode);while(la.Bt())}return!0}static svk(Na,za,la){n.ULS.sendTraceTag(512291459,307,50,"Adding rows and columns for content replace in CCP.");Object(Ia.a)("AddRowAndColumnForExternalCCP",!0);Va.xAa=qa.a.o8b;0<za&&(M.moveToLastRow(Na),n.ULS.sendTraceTag(523896290,307,50,"Begin insert rows: "+za),this.yk.insertRows(Na,
!1,za,this.xAa),n.ULS.sendTraceTag(523896291,307,50,"Completed inserting rows."),Na.jd(14));0<la&&(n.ULS.sendTraceTag(523896320,307,50,"Begin insert columns: "+la),this.yk.insertColumns(Na,G.TableReader.Zg(Na.currentNode),!1,la,this.xAa),n.ULS.sendTraceTag(523896321,307,50,"Completed inserting columns."))}static Ccm(){return W.TableBorderSelectionCache?W.TableBorderSelectionCache.K9:null}}Va.ghn=8;Va.vin="Normal Table";Va.gQh="Table Grid";Va.xAa=null;Va.I6j=K.a.D5("MsoNormalTable","Normal Table",
"MsoTableGrid",Va.gQh,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4",
"MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1",
"Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5",
"Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful",
"MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1",
"MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3",
"List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6",
"List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3",
"List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5",
"MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6",
"MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6");Va.M6j=K.a.D5("0","center","1","top","2","center","3",
"bottom");Va.L6j=K.a.D5("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(F.a)(Va,"Box4TableStewardHelper",null,[])},1581:function(F,K,c){c.d(K,"a",function(){return X});F=c(0);var l=c(74),f=c(186),a=c(22),k=c(168),x=c(2),y=c(237),n=c(6),u=c(84),z=c(61),w=c(9),E=c(43),G=c(586),H=c(211),L=c(233),I=c(8),N=c(245),Q=c(18),M=c(12),J=c(279),V=c(3);class X{static get Xg(){return H.ContextSetEditor.instance}static get Wf(){return L.a.instance}static get Jc(){return f.a.instance}static Zw(){return X.Sm||
(X.Sm=a.a.instance.Sa("Box4.IExternalSelectionManager"))}static get OA(){return null!=X.KFg?X.KFg:X.KFg=a.a.instance.resolve("Box4.IParagraphIndentationReader")}static ahm(){this.VN||(this.VN=new l.a,this.VN.add(V.a.UA),this.VN.add(V.a.font),this.VN.add(V.a.GY),this.VN.add(V.a.gua),this.VN.add(V.a.bold),this.VN.add(V.a.setItalic),this.VN.add(V.a.superscript),this.VN.add(V.a.subscript),this.VN.add(V.a.QZa),this.VN.add(V.a.eua),this.VN.add(V.a.JCa),this.VN.add(V.a.V6e),this.VN.add(V.a.KCa),this.VN.add(V.a.PZa),
this.VN.add(V.a.K_),this.VN.add(V.a.Z0),this.VN.add(V.a.clearFormatting),this.VN.add(V.a.Meb),this.VN.add(V.a.JGc));return this.VN}static pac(W){return X.ahm().contains(W)?!0:!1}static gw(W,U,Y,ba,aa){var fa=!0;if(!U.view.te)return 2;var na=U.view,oa=na.lb;oa&&oa.gb.kb||(X.Jc.Yb(u.a.kf,{["Reason"]:z.a.noSelection}),fa=!1);X.Xg.cDa(Q.ImageReader.IUc,na.lb.tg)&&(X.Jc.Yb(u.a.kf,{["Reason"]:z.a.$9e}),fa=!1);if(X.Xg.cDa(Q.ImageReader.B2a,na.lb.tg))return X.Jc.Yb(u.a.kf,{["Reason"]:z.a.GHc}),8;var ja=!X.pac(W);
X.Wf.tac(na.lb.tg,ja)&&(X.Jc.Yb(u.a.kf,{["Reason"]:z.a.WE}),fa=!1);X.Xg.cDa(Q.ImageReader.ZYd,na.lb.tg)&&(X.Jc.Yb(u.a.kf,{["Reason"]:z.a.V9e}),fa=!1);X.Xg.cDa(J.c,na.lb.tg)&&(X.Jc.Yb(u.a.kf,{["Reason"]:z.a.W9e}),fa=!1);X.Xg.cDa(N.a.CDf,na.lb.tg)&&(X.Jc.Yb(u.a.kf,{["Reason"]:z.a.U9e}),fa=!1);X.Xg.sza(I.ParagraphReader.kU,na.lb.tg)&&(X.Jc.Yb(u.a.kf,{["Reason"]:z.a.hO}),fa=!1);X.Zw()&&X.Zw().instance&&X.Zw().instance.pU(na.lb.tg)&&(X.Jc.Yb(u.a.kf,{["Reason"]:z.a.externalSelection}),fa=!1);var qa=null;
oa&&oa.gb.kb&&(qa=oa.gb.kb);if(1===Y||!fa||!qa)return fa?32:8;fa=W===V.a.bdc||W===V.a.N2b||W===V.a.bic||W===V.a.g7b;na=W===V.a.gMb||W===V.a.lCb||W===V.a.thc;ja=W===V.a.kTa||W===V.a.lTa||W===V.a.eD;const Ia=new E.GraphTransaction(15);Ia.Cb(qa.Oa.node);qa=new l.a;let Va=!1;if(fa||na||ja)k.a.mark(7121),U=X.Xg.e3h(U.gk);else{k.a.mark(7119);U=G.OutlineElementGeneralizer.tna(oa.gb,!0);if(!U)return X.Jc.Yb(u.a.kna,{["Reason"]:z.a.HLd}),Ia.dispose(),8;oa=W===V.a.j2a||W===V.a.bjb;U.$w&&oa&&(Va=X.wrm(qa,U))}(W===
V.a.leftJustify||W===V.a.bdc||W===V.a.centerJustify||W===V.a.N2b||W===V.a.rightJustify||W===V.a.bic||W===V.a.fullJustify||W===V.a.g7b)&&U.$w&&1<U.length&&X.xrm(U)&&(aa||(aa={}),Object.getType(aa)===Object&&(aa.InContextSet=!0));x.AFrameworkApplication.va.Mf(U,W,Y,!0,ba,aa);Va&&X.Bin(qa,U,aa);Ia.dispose();w.App.xa.updateCommandUI();fa||na||ja?k.a.mark(7122):k.a.mark(7120);return 32}static wrm(W,U){if(!U.$w)return!1;let Y=!1,ba=!1;for(let fa=0;fa<U.length;fa++)if(U.getContext(fa).hl){var aa=U.getContext(fa).node;
aa&&(aa=X.OA.Qhb(aa),2===aa.specialIndentType?(Y=!0,W.add(fa)):1!==aa.specialIndentType&&aa.specialIndentType||(ba=!0))}return ba&&Y}static Bin(W,U,Y){if(U.$w)for(let aa=0;aa<W.count;aa++){var ba=U.getContext(W.J(aa));if(!ba.hl)continue;ba=ba.node;const fa=X.OA.Qhb(ba);2!==fa.specialIndentType||y.a.Awa(Y.value,fa.AB)||ba.setValue(n.a.$d,fa.AB-fa.vda)}}static pdg(W,U){let Y=!0;U.contextId!==M.a.paragraph?Y=!1:X.Wf.n3a(U)?(X.Jc.Yb(u.a.fn,{["Reason"]:z.a.WE}),Y=!1):X.Zw()&&X.Zw().instance&&X.Zw().instance.pU(U)?
(X.Jc.Yb(u.a.fn,{["Reason"]:z.a.externalSelection}),Y=!1):U.hl&&(U=U.node,I.ParagraphReader.Wb(U)&&U.yQ&&(X.Jc.Yb(u.a.fn,{["Reason"]:z.a.hO}),Y=!1));return{returnValue:1!==W&&Y,ly:Y?32:8}}static xrm(W){if(!W.$w)return!1;let U=1;for(let ba=0;ba<W.length;ba++){var Y=W.getContext(ba);if(Y&&Y.hl&&Y.contextId===M.a.paragraph&&(Y=Y.node))if(Y=I.ParagraphReader.Gx(Y),!ba)U=Y;else if(Y!==U)return!0}return!1}}X.Sm=null;X.VN=null;Object(F.a)(X,"FormattingActionHelper",null,[])},1584:function(F,K,c){c.d(K,"a",
function(){return f});c.d(K,"b",function(){return a});var l=c(2);const f=k=>{switch(k){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},a=()=>{var k;return null===(k=l.AFrameworkApplication.K)||void 0===k?
void 0:k.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1596:function(F,K,c){c.r(K);F=c(0);var l=c(2),f=c(126),a=c(22),k=c(53),x=c(353),y=c(43),n=c(5);class u{Ydf(Db,ac,Pa){return 1===Pa?32:u.Pkl(ac.node)}static Pkl(Db){const ac=new n.GraphIterator;ac.set(Db);ac.Bp();Db=new y.GraphTransaction(7);Db.Lt(ac);ac.xg();Db.dispose();return 32}}Object(F.a)(u,"DeleteOutlineLevelContentStrategy",null,[]);var z=c(153),w=c(172),E=c(79),G=c(211),H=c(17),L=c(23),I=c(8),N=
c(103),Q=c(36),M=c(204),J=c(81),V=c(28);class X{constructor(Db){this.Im=null;this.Gla=Db}get Pzb(){return null!=this.wwg?this.wwg:this.wwg=a.a.instance.Na("Box4.IAutoCorrectRules")}get RW(){return null!=this.ywg?this.ywg:this.ywg=a.a.instance.Na("Box4.IAutoCorrectScheduler")}get SM(){return null!=this.oFg?this.oFg:this.oFg=a.a.instance.Na("Box4.Pages.IPageContentEditor")}get nL(){return null!=this.MEg?this.MEg:this.MEg=a.a.instance.Na("Box4.IOutlineEditor")}get Pg(){return this.Im||(this.Im=this.Gla())}jGi(Db,
ac,Pa){if(this.nL&&X.Sn){var bb=G.ContextSetEditor.wrf(ac);Db=bb.node;H.SelectionEditor.Hk(bb)&&(bb=V.a.Qc(Db,I.ParagraphReader.textLength(Db)));var lc=N.FormattingReader.language(N.FormattingReader.Nr(bb));bb=n.GraphIterator.$a(Pa.Yc);X.Oh.O5c(bb);var rb=Db=null;if(bb)for(let La=bb.Sb(1);La&&!rb;La=bb.zi(1))J.OutlineReader.Lwa(La)&&(rb=La);if(bb&&!rb){if(!this.SM||!this.nL)return;Db=new y.GraphTransaction(7);Db.Lt(bb);rb=this.SM.gHd(bb);this.nL.r7(bb,!0);lc&&(Q.OutlineElementNavigator.Ge(bb),bb=
V.a.Qc(bb.currentNode,0),X.Sn.ihe(N.FormattingReader.Nr(bb),lc))}lc=L.SelectionFactory.ho(rb,!0);Pa.lb.setSelection(lc);H.SelectionEditor.gf(ac)&&(Pa=n.GraphIterator.$a(ac.node),Pa.Bp(),M.OutlineNavigator.s8f(Pa),this.Pzb&&this.RW&&J.OutlineReader.HA(Pa,ac,!0)&&(ac=this.Pzb.zkf(ac,-1,!1,E.a.Dw))&&this.RW.Ghj(ac));this.Pg&&this.Pg.kF();Db&&Db.dispose()}}static get Sn(){return null!=X.uAg?X.uAg:X.uAg=a.a.instance.Na("Box4.IFormattingEditor")}static get instance(){return null!=X.$Cg?X.$Cg:X.$Cg=X.Rl()}static Rl(){return new X(()=>
a.a.instance.Na("Box4.IUndoManager"))}static get Oh(){return w.PageNavigator.instance}}Object(F.a)(X,"TitleViewEditor",null,[]);var W=c(46),U=c(465),Y=c(631),ba=c(21),aa=c(12),fa=c(279),na=c(3);class oa{constructor(){this.m1j=new u;this.Ydf=(Db,ac,Pa,bb,lc)=>this.m1j.Ydf(Db,ac,Pa,bb,lc)}Tb(Db){const ac=this.cRh.ief.bind(this.cRh),Pa=this.Ydf,bb=this.SQh.Ukl.bind(this.SQh);this.j4f(Db,ac,Pa,bb);Db.qa(na.a.backspace,aa.a.Tc,bb);Db.qa(na.a.backspace,aa.a.Hd,bb);Db.qa(na.a.backspace,aa.a.endOfParagraph,
f.ActionManager.IQ);Db.qa(na.a.backspace,aa.a.outline,Pa);Db.qa(na.a.backspace,aa.a.view,ac);Db.Vc(na.a.backspace,1124);Db.qa(na.a.Sua,aa.a.Tc,f.ActionManager.IQ);Db.qa(na.a.Sua,aa.a.Hd,bb);Db.qa(na.a.Sua,aa.a.endOfParagraph,f.ActionManager.IQ);Db.qa(na.a.Sua,aa.a.outline,Pa);Db.qa(na.a.Sua,aa.a.view,ac);Db.eb(na.a.DHd,aa.a.view,ac,1124);Db.qa(na.a.AH,aa.a.Tc,bb);Db.qa(na.a.AH,aa.a.Hd,bb);Db.qa(na.a.AH,aa.a.endOfParagraph,f.ActionManager.IQ);Db.qa(na.a.AH,aa.a.outline,Pa);Db.qa(na.a.AH,aa.a.view,
ac);Db.Vc(na.a.AH,1124);Db.eb(na.a.tcf,aa.a.view,ac,1124);Db.eb(na.a.Oma,aa.a.view,oa.Oma,1028)}j4f(){}static get Oh(){return w.PageNavigator.instance}static get eg(){return null!=oa.PEg?oa.PEg:oa.PEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get SM(){return null!=oa.lFg?oa.lFg:oa.lFg=a.a.instance.resolve("Box4.Pages.IPageContentEditor")}static get nL(){return null!=oa.LEg?oa.LEg:oa.LEg=a.a.instance.resolve("Box4.IOutlineEditor")}static get Xb(){return null!=oa.Bzg?oa.Bzg:oa.Bzg=a.a.instance.Na("Box4.IFeatureHelper")}static Oma(Db,
ac,Pa,bb,lc){bb=ac.view;if(!bb.lb||!bb.lb.gb.kb||H.SelectionEditor.Sl(bb.lb.gb.kb))return 8;if(1===Pa)return 32;Pa=bb.lb.gb;const rb=Pa.kb;var La=rb.Oa,sb=null,Sb=!1;if(Pa.wJ){if(La.contextId===aa.a.outline&&1===Pa.length){for(Db=n.GraphIterator.$a(La.node);Db.Pd();)Db.xg();oa.nL.r7(Db,!0);Q.OutlineElementNavigator.Ge(Db);Db=L.SelectionFactory.pe(Db.currentNode,0);bb.lb.setSelection(Db);return 32}var kc=La.node;sb=null;if(fa.c(La)){var Lb=kc.De(bb.fc);Lb&&(Lb=Lb.Gmp)&&0<=Lb.width&&0<=Lb.height&&(sb=
new U.a(k.a.Vl(Lb.x,0),k.a.Vl(Lb.y,1)));sb||(sb=Y.a(kc))}else sb=Y.a(La.node);La=n.GraphIterator.$a(La.node);La.Bp();oa.Oh.O5c(La);kc=oa.SM.gHd(La);Y.b(kc,sb.x,sb.y);oa.nL.r7(La,!0);sb=L.SelectionFactory.ho(kc,!0)}else if(1===Pa.length){Sb=Pa.last;La=W.a.ABb(Sb);if(oa.Xb&&oa.Xb.isFeatureEnabled(25)&&G.ContextSetEditor.instance.hfg(La).returnValue)return 2;Sb=Sb.Pc;Sb=!Pa.uw&&(H.SelectionEditor.Hk(Sb)||I.ParagraphReader.lm(Sb)||H.SelectionEditor.K8(Sb))}Sb&&(Sb=H.SelectionEditor.Cj(rb,!1,!1,void 0,
!1),bb.lb.setSelection(Sb),l.AFrameworkApplication.va.Mf(ac,na.a.newLine,2,!1,null,lc),sb=bb.lb.gb.kb,bb.lb.setSelection(rb));lc||(lc=new x.DictionaryPropertySet);lc.setValue(z.a.kKc,!0);l.AFrameworkApplication.va.Mf(ac,na.a.AH,2,!0,null,lc);if(sb&&sb.Oa.isValid)return bb.lb.setSelection(sb),32;Pa.wJ&&X.instance.jGi(Db,ac.gk,bb);H.SelectionEditor.Sl(bb.lb.gb.kb)||l.AFrameworkApplication.va.Mf(ac,na.a.newLine,2,!1,null,lc);return 32}static Okl(Db,ac){if(1===ac)return 32;ac=new y.GraphTransaction(7);
ac.Cb(Db);oa.eg.eHa(Db);ac.dispose();return 32}}Object(F.a)(oa,"ADeleteActor",null,[]);var ja=c(9),qa=c(233),Ia=c(255),Va=c(1514),Na=c(58),za=c(19),la=c(111),va=c(67),ia=c(118),pa=c(688),sa=c(48);class Ha{get Wf(){return qa.a.instance}Ukl(Db,ac,Pa,bb,lc){bb=null===lc||void 0===lc?void 0:lc.Lbd;if(1===Pa)return 32;var rb=Db===na.a.backspace;if(this.Wf.gh){if(this.Wf.eyi(ac)&&Ha.Vfa&&(Pa=ac.clone(),Pa.Rb+=1,--Pa.Eb,this.Wf.ccc(Pa)))return Ha.Vfa.k$i([Pa]),32;if(this.Wf.IEf(ac,rb))return 2}if(Ha.Zw()&&
Ha.Zw().instance&&Ha.Zw().instance.pU(ac))return 4;var La=ac.node;let sb=ac.cpBegin;Pa=ac.cpEnd;let Sb=ac.Eb,kc=ac.Rb;const Lb=I.ParagraphReader.text(La),Qc=Lb.length;let Dc=!1;if(sb===Pa){if(rb&&!sb||!rb&&sb===Qc)return 2;rb?({cp:sb,returnValue:Dc}=this.Wf.RPi(La,sb),Dc||({cp:sb,kma:Sb,returnValue:Dc}=this.Wf.QPi(ac,sb,Sb)),Dc||(sb--,za.a.yz(Lb,sb)&&sb--),Db=na.a.s3e):({cp:Pa,returnValue:Dc}=this.Wf.Tfn(La,Pa),Dc||({cp:Pa,kma:kc,returnValue:Dc}=this.Wf.Sfn(ac,Pa,kc)),Dc||(Pa++,za.a.yz(Lb,Pa)&&Pa++),
Db=na.a.AQh)}ac=sb===Pa?V.a.Qc(La,sb):V.a.createTextRange(La,sb,Pa);Dc&&this.Wf.gh&&(rb?ac.Eb=Sb:ac.Rb=kc);if(!this.Wf.ccc(ac))return 2;this.h0b(La);rb=new y.GraphTransaction(15);rb.jk=Db;rb.Cb(La);La=Object(la.a)(pa.a,lc)&&lc.E0a;if(!Ha.Ld.rg||La||sa.a.rr&&Ha.HCa.J_d(W.a.instance.gb.kb))this.TQh(ac,bb);else{La=Ha.Ld.wZa();try{const Fd=Ha.Ch.o9c(ac);let pe;if(({type:pe}=Fd.hTd()).returnValue){const ye=Object(va.a)(101,lc);ye&&ye.ia(ia.a.QCf,!1)||!sa.a.rr&&4===pe?Ha.Ld.f5a=pe:Ha.Ld.Ns(pe)}lc=0;for(let ye=
Fd.length-1;0<=ye;--ye){let pf;const Yf=({m0d:pf}=Fd.getContext(ye)).returnValue;pf?(Ha.hyperlinkEditor.Rlb(Yf,null),lc+=Ha.nj.Lob(Yf,2),Ha.nj.FGd=Pa+lc):this.TQh(Yf,bb)}}finally{La&&La.dispose()}}rb.dispose();return 32}h0b(){}static get Ld(){return null!=Ha.IIg?Ha.IIg:Ha.IIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get nj(){return null!=Ha.tIg?Ha.tIg:Ha.tIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Ch(){return null!=
Ha.dJg?Ha.dJg:Ha.dJg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get hyperlinkEditor(){return null!=Ha.dBg?Ha.dBg:Ha.dBg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static Zw(){return Ha.Sm||(Ha.Sm=a.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Vfa(){Ha.Ktb||(Ha.Ktb=a.a.instance.Sa("Box4.ContentControl.IContentControlOperator"));return Ha.Ktb.instance}static get HCa(){return null!=Ha.Kwg?Ha.Kwg:Ha.Kwg=a.a.instance.resolve("Box4.IContentControlViewElementManager")}}
Ha.Sm=null;Ha.Ktb=null;Object(F.a)(Ha,"ADeleteParagraphContentStrategy",null,[]);var ra=c(166),Ma=c(800),ya=c(215),Ga=c(225),wa=c(78),hb=c(74),eb=c(77);class jb extends Ha{constructor(){super()}get characterPropertiesEditor(){return null!=this.Rwg?this.Rwg:this.Rwg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Vq(){return null!=this.Hwg?this.Hwg:this.Hwg=a.a.instance.Sa("Box4.ContentControlConfigSettings")}get fec(){return null!=this.yEg?this.yEg:this.yEg=a.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor")}get dX(){return null!=
this.pxg?this.pxg:this.pxg=a.a.instance.resolve("Box4.IContentControlChpHelper")}get zOa(){return null!=this.Ozg?this.Ozg:this.Ozg=a.a.instance.resolve("Box4.IFieldEditor")}TQh(Db,ac){this.gkl(Db,ac)}fBk(Db,ac,Pa,bb){this.Vq.instance&&this.Vq.instance.gh&&(Db.cpBegin===ac.cpBegin?Db.Eb=ac.Eb:Pa&&(Db.Eb=Pa.Jb&&Pa.Jb.length?0:-1),Db.Rb=bb)}h0b(Db){const {DeleteActor:ac}=c(1596);ac.h0b(Db)}gkl(Db,ac){var Pa=Db.node;const bb=Ga.b([new ra.a(Db.cpBegin,Db.cpEnd)],this.kim(Db));var lc=new eb.a,rb=[];jb.S0k(Pa,
bb,lc,rb);for(const La of lc.keys)1<lc.J(La)&&Ma.a.mTi(Na.a.Ef(La));this.C_n(Pa,rb);this.fec.LGc(Pa);Pa=Db.Rb;lc=!!this.Vq.instance&&this.Vq.instance.gh;for(rb=bb.length-1;0<=rb;rb--)Pa=this.deleteRange(Db,bb[rb],Pa,lc,ac)}kim(Db){const ac=[],Pa=Db.node;var bb=wa.f(Pa,La=>La.jma);for(var lc of bb)bb=lc.Ib.cp,ac.push(new ra.a(bb,bb+1));lc=[];ya.a.j8?this.zOa&&(lc=this.zOa.j9h(Pa,Db)):lc=I.ParagraphReader.aPa(Pa);for(var rb of lc)this.vPm(rb,Db)&&ac.push(rb);rb=!!this.Vq.instance&&this.Vq.instance.woa;
this.Vq.instance&&this.Vq.instance.gh||!rb||!Pa.Vs||(jb.MIh&&jb.MIh.BZn(Db),this.dX&&ac.push(...this.dX.Xof(Pa).toArray()));return Ga.a(ac)}vPm(Db,ac){return ya.a.j8?this.zOa?!this.zOa.uwi(Db,ac):!1:!Db.PK||!jb.wDf(Db,ac)}C_n(Db,ac){const Pa=new hb.a;for(const bb of ac)for(ac=0;ac<bb.length;){ac=this.hai(bb,ac,0);if(-1===ac)break;let lc=this.hai(bb,ac+1,3);if(-1===lc)break;if(bb.J(ac).PK)for(;lc>=ac;){const rb=bb.J(lc);Pa.add(rb.qe);bb.remove(rb);lc--}ac=lc+1}Db.$pa(Pa)}hai(Db,ac,Pa){for(;ac<Db.length;ac++){const bb=
Db.J(ac);if(1===bb.oF&&bb.zg===Pa)return ac}return-1}deleteRange(Db,ac,Pa,bb,lc){const rb=ac.begin,La=ac.end;ac=null;bb&&(ac=Db.node.pa.Mh(rb));rb<La&&(bb=V.a.createTextRange(Db.node,rb,La),this.fBk(bb,Db,ac,Pa),this.characterPropertiesEditor.replaceTextRange(bb,"",void 0,void 0,na.a.hFc,!1,lc));return Pa=ac&&ac.Jb&&ac.Jb.length?ac.Jb.length:-1}static get MIh(){return null!=jb.yxg?jb.yxg:jb.yxg=a.a.instance.Na("WordEditor.ContentControl.IContentControlOperator")}static wDf(Db,ac){return Db.begin>=
ac.cpBegin&&Db.end<=ac.cpEnd}static S0k(Db,ac,Pa,bb){let lc=0;Db=Db.pa;for(const rb of ac)for(;lc<Db.length;){ac=Db.J(lc);if(ac.cp>=rb.begin&&ac.cp<rb.end&&(ac.ed&&ac.ed.A5k&&bb.push(ac.ed),ac.Dh))for(let La=0;La<ac.Dh.length;La++){const sb=ac.Dh.J(La).jn.toString();Pa.mb(sb)?Pa.Z(sb,Pa.J(sb)+1):Pa.Z(sb,1)}++lc}}}Object(F.a)(jb,"DeleteParagraphContentStrategy",Ha,[]);class ub{static get ZJ(){return Ia.a.instance}static pll(Db,ac,Pa){if(1===Pa)return 32;Db=ac.node;return ub.ZJ.JCd(Db)?oa.Okl(Db,Pa):
32}}Object(F.a)(ub,"DeleteUnsupportedObjectStrategy",null,[]);var ab=c(168),Ea=c(307),Wa=c(186),Bb=c(372),Mb=c(7),Fb=c(1031),vb=c(40),$a=c(116),kb=c(1621),Ua=c(401),Sa=c(524),xb=c(586),Qb=c(838),Ib=c(163),$b=c(136),hc=c(201),pb=c(503),dc=c(32),Ob=c(122);class Vb{constructor(Db,ac,Pa,bb,lc){this.B3o=Db;this.I9=Pa;this.xd=bb;this.actionId=ac;this.Lbd=lc}}Object(F.a)(Vb,"DeleteActionData",null,[]);var ob=c(1011),Xb=c(141),Xa=c(859);class Pb{constructor(Db,ac,Pa,bb,lc,rb,La,sb,Sb,kc){this.UQh=Db;this.Wf=
ac;this.ZJ=Pa;this.hyperlinkEditor=bb;this.P_=lc;this.$i=rb;this.r0i=La;this.characterPropertiesEditor=sb;this.Ld=Sb;this.HCa=kc}hNo(Db){return!H.SelectionEditor.nl(Db)&&!H.SelectionEditor.fca(Db)}Tcm(Db,ac,Pa){var bb;let lc,rb,La;if(!ac&&Db&&Db.Cx&&(bb=Db.Oa)&&H.SelectionEditor.gf(bb)&&this.$i.Wb(bb.node)&&(lc=bb.node.pa.Mh(bb.cpBegin))&&lc.Om&&(rb=this.SQl(lc))&&rb.hyperlink.DG&&(La=this.Hcm(Db,rb.cp)))return La;if(!Db)return null;if(sa.a.Vj&&(bb=this.ZQo(Db,ac)))return bb;if(!Pa)return Db;ac=H.SelectionEditor.YDa(Db,
!ac,{RA:!1,Cs:!0,HC:!0,jE:!0});return L.SelectionFactory.oz(Db,ac.Oa,!1)}SQl(Db){const ac=Db.paragraph.pa;let Pa=null;Db=Db.cp;for(let bb=0;bb<ac.length;bb++){const lc=ac.J(bb);if(lc.cp>=Db)break;lc.Om&&(Pa=null);lc.hyperlink&&(Pa=lc)}return Pa}Kcm(Db,ac){var Pa=Db.Oa.node;if(ac){if(ac=H.SelectionEditor.wTa(Db.Oa.node,Db.Oa.cpBegin,!0),Db=L.SelectionFactory.oz(Db,V.a.Qc(Db.Oa.node,ac),!1),Pa=Pa.pa.Mh(ac),Pa.Y_||Pa.mU)Db.Oa.Eb=0}else if(ac=H.SelectionEditor.wTa(Db.Oa.node,Db.Oa.cpBegin,!1),Db=L.SelectionFactory.oz(Db,
V.a.Qc(Db.Oa.node,ac),!1),Pa=Pa.pa.Mh(ac),Pa.Y_||Pa.mU)Db.Oa.Eb=Pa.Cw+Pa.fN;Db.Rac=!0;return Db}ZQo(Db,ac){var Pa=Db.Oa;let bb=null;if(!Db.Cx||!Pa||!H.SelectionEditor.gf(Pa))return null;if(this.$i.Wb(Pa.node)&&(bb=ac?Pa.node.pa.Mh(Pa.cpBegin):Pa.node.pa.Ihb(Pa.cpBegin-1))&&bb.iR)return this.Kcm(Db,ac);Pa=n.GraphIterator.$a(Db.Oa.node);if(!Pa.zb(8))return null;Q.OutlineElementNavigator.Vd(Pa);let lc=!1;const rb=[];if(ac?bb&&bb.Rh:0===Db.Oa.cpBegin){do(Db=ac?Q.OutlineElementNavigator.Xr(Pa,!0,!0,!1):
Q.OutlineElementNavigator.t0(Pa,!0,!0,!1))&&(null===Db||void 0===Db?0:Db.OPa)?(rb.push(V.a.create(Q.OutlineElementNavigator.Ge(Pa))),Q.OutlineElementNavigator.Vd(Pa)):lc=!0;while(!lc);if(0<rb.length)return ac=new Ib.Selection(ac?rb:rb.reverse(),ac),ac.Rac=!0,ac}return null}Hcm(Db,ac){var Pa=H.SelectionEditor.ZDa(Db,{RA:!1,Cs:!1,HC:!0,jE:!0});if(!Pa||!Pa.Cx||Pa.Oa.node!==Db.Oa.node)return null;Pa=Pa.Oa;if(Pa.cpBegin!==Pa.cpEnd)return null;const bb=this.$i.text(Pa.node);for(let lc=Pa.cpBegin-1;lc>=
ac;lc--)if(!za.a.Mv(bb.charCodeAt(lc)))return L.SelectionFactory.oz(Db,V.a.Qc(Pa.node,lc+1),!1);return L.SelectionFactory.oz(Db,V.a.Qc(Pa.node,ac),!1)}ief(Db,ac,Pa,bb,lc){var rb,La;if(1===Pa)return 32;(Pa=null===(La=null===(rb=ac.view)||void 0===rb?void 0:rb.lb)||void 0===La?void 0:La.tg)&&G.ContextSetEditor.instance.vPh(Pa).filter(I.ParagraphReader.kU).forEach(sb=>{var Sb;return null===(Sb=I.ParagraphReader.dPa(sb.node))||void 0===Sb?void 0:Sb.Whe("delete_selection")});La=!1;Db===na.a.tcf?(Db=na.a.AH,
La=!0):Db===na.a.DHd?(Db=na.a.backspace,La=!0):Db===na.a.Sua&&(ac=new Sa.a(ja.App.xa.ib.rc));if(!ac.view.te)return 2;$b.GrippersManager.instance.ZB(!1);rb=Db===na.a.AH;Pa=hc.a.D9h(ac);if(La&&this.Wf.gh&&Pa&&H.SelectionEditor.Sl(Pa)&&this.Wf.IEf(Pa.Oa,!rb,!0))return 2;La=this.Tcm(Pa,rb,La);return this.rll(Db,ac,bb,lc,La,rb)}rll(Db,ac,Pa,bb,lc,rb){var La;const sb=ac.view,Sb=sb.lb;var kc=bb,Lb=bb;Db===na.a.Sua&&(Lb=kc=null,lc=new Ib.Selection(bb,!0));if(!lc)return 32;const Qc=this.rso(kc,rb);if(this.Wf.gh&&
Pb.Vfa&&1===Sb.gb.length&&H.SelectionEditor.Sl(lc)&&lc.Cx&&Pb.Vfa.$co(lc.Oa,rb))return 32;let Dc;rb?ab.a.mark(Dc=5009):ab.a.mark(Dc=5011);kc=new y.GraphTransaction(15);kc.jk=Db;kc.Cb(sb.Yc);let Fd=null,pe=({Dbo:Fd}=this.QSl(Db,bb,Sb,lc,Fd)).returnValue;var ye=null;({Aje:ye}=G.ContextSetEditor.instance.hfg(pe)).returnValue&&(pe=ye);if(!pe)return kc.dispose(),32;ye=!1;l.AFrameworkApplication.ue("b1jb9393;09icj321");if(null===(La=l.AFrameworkApplication.K)||void 0===La?0:La.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",
!1))La=pe.node,ye=null===La||void 0===La?void 0:La.Vs;const pf=new Vb(ac,Db,Pa,Lb,ye);this.Wf.gh&&Pb.Vfa&&(Lb=G.ContextSetEditor.instance.dO(pe),Pb.Vfa.k$i(Lb));this.kBj(pe);const Yf=this.WNd(pe,lc,rb);let Ed=null;rb?Ed=new Qb.a(lc):Yf&&(Ed=new Qb.a(Yf));let Rc=!1;Lb=Pb.Kk;if(H.SelectionEditor.gf(pe)){const Yc=ob.a.s8b(sb.Yc,Qc);Lb.ie(()=>{this.bkl(ac,Pa,bb,pe,rb,Ed,lc,Yc,Sb,Qc,pf,Yf)},"DVS:DAIPC")}else!this.Ld.rg||sa.a.rr&&this.HCa.J_d(lc)?Lb.ie(()=>{Rc=this.J1i(Db,sb.Yc,pe,Sb,Qc,pf,Ed,Fd)},"DVS:PUD"):
(Lb.ie(()=>{this.gNo(Db,sb.Yc,pe,rb,lc,Sb,Qc,pf,Ed)},"DVS:TCDC"),Rc=!0);this.GFl(Sb);this.mej(pe);kc.dispose();ab.a.mark(Dc+1);return Db===na.a.Sua?Rc?32:8:32}J1i(Db,ac,Pa,bb,lc,rb,La,sb){ac=ob.a.s8b(ac,lc);this.hNo(Pa)&&ac.G7a(Pa);Db=Pb.Jc.yp(Db);Db.properties.Z("CountOfParagraphsDeleted",this.$i.caf(Pa).toString());Pa=this.Bpl(Pa,bb,lc,ac,rb,La,sb);Db.end();return Pa}gNo(Db,ac,Pa,bb,lc,rb,La,sb,Sb){var kc=0,Lb=null;const Qc=G.ContextSetEditor.instance.dO(Pa),Dc=Qc[Qc.length-1];if(Dc.contextId===
aa.a.paragraph||Dc.contextId===aa.a.endOfParagraph){var Fd=n.GraphIterator.$a(Dc.node);Fd.vd();Q.OutlineElementNavigator.Vd(Fd);Q.OutlineElementNavigator.Xr(Fd,!0,!1)&&(Lb=Q.OutlineElementNavigator.Ge(Fd))&&(kc=this.$i.textLength(Lb))}else kc=this.$i.textLength(Dc.node)-Dc.cpEnd;Fd=Object(va.a)(101,sb.xd);if(Fd=!!Fd&&Fd.ia(ia.a.QCf,!1))this.H1i(Db,ac,Pa,rb,La,sb,Sb,!1,Fd);else{Fd=this.Ld.wZa();try{this.H1i(Db,ac,Pa,rb,La,sb,Sb,!0)}finally{Fd&&Fd.dispose()}}if(sa.a.Vj&&lc.Rac)kc=this.WNd(Pa,lc,bb),
this.$i.Wb(kc.Oa.node)&&W.a.instance.setSelection(kc);else{if(bb){if(Pa.$w){Db=Qc.length-1;do lc=Qc[Db],Db--;while(!lc.node.isConnected&&0<=Db)}else lc=Pa;if(!this.$i.Wb(lc.node))return;switch(Dc.contextId){case aa.a.paragraph:case aa.a.endOfParagraph:kc=Lb&&Lb.isConnected?0:kc;break;case aa.a.Tc:case aa.a.Hd:break;default:kc=0}kc=L.SelectionFactory.pe(lc.node,this.$i.textLength(lc.node)-kc);lc.wj===kc.Oa.cpBegin&&(kc.Oa.Eb=lc.Eb)}else{kc=lc.Oa.node;if(!this.$i.Wb(kc))return;Lb=lc.Oa.contextId===
aa.a.paragraph?0:lc.Oa.contextId===aa.a.endOfParagraph?this.$i.textLength(kc):lc.Oa.cpBegin;kc=L.SelectionFactory.pe(kc,Lb)}W.a.instance.setSelection(kc)}}H1i(Db,ac,Pa,bb,lc,rb,La,sb,Sb=!1){Pa=this.$Jl(bb,Pa);Pa=Pb.Ch.o9c(Pa);({type:Lb}=Pa.hTd()).returnValue&&(sb&&4!==Lb?this.Ld.Ns(Lb):sa.a.rr||(this.Ld.f5a=Lb));for(sb=Pa.length-1;0<=sb;--sb){var kc=void 0;var Lb=({m0d:kc}=Pa.getContext(sb)).returnValue;kc?(kc=Sb&&Lb.contextId===aa.a.endOfParagraph&&sb===Pa.length-1,this.hyperlinkEditor.Rlb(Lb,2),
kc||Pb.nj.Lob(Lb,2)):this.J1i(Db,ac,Lb,bb,lc,rb,La,null)}}$Jl(Db,ac){if(Object(la.a)(Ua.a,ac)){Db=xb.OutlineElementGeneralizer.tna(Db.gb,!0);for(let Pa=0;Pa<Db.length;Pa++)if(Db.getContext(Pa).contextId===aa.a.table)return Db}return ac}QSl(Db,ac,Pa,bb,lc){Db===na.a.Sua?(Db=Ea.a.mDa(ac),lc=pb.SelectionReferenceFactory.instance.FBb()):(lc=null,Db=1===Pa.gb.length?W.a.ABb(bb):Pa.tg);return{returnValue:Db,Dbo:lc}}lTk(Db){return!Db.hl||Db.contextId!==aa.a.paragraph||!this.$i.Wb(Db.node)||this.Ld.rg||this.Wf.k_d(Db)?
!1:!0}kBj(Db){if(Db.$w)for(let ac=0;ac<Db.length;ac++)this.kBj(Db.getContext(ac));else this.lTk(Db)&&(Db.node.KCd=!0)}mej(Db){if(Db.$w)for(let ac=0;ac<Db.length;ac++)this.mej(Db.getContext(ac));else Db.hl&&(Db=Db.node)&&this.$i.Wb(Db)&&(Db.KCd=!1)}WNd(Db,ac,Pa){if(Db.hl&&H.SelectionEditor.gf(Db)&&!Pa){const bb=Db.node;let lc=Db.cpBegin,rb=-1;if(({cp:lc}=this.Wf.RPi(bb,lc)).returnValue)return L.SelectionFactory.pe(bb,lc);if(({cp:lc,kma:rb}=this.Wf.QPi(Db,lc,rb)).returnValue)return ac=L.SelectionFactory.pe(bb,
lc),ac.Oa.Eb=rb,ac.Oa.Rb=rb,ac}ac=sa.a.Vj?H.SelectionEditor.YDa(ac,!Pa,{RA:!ac.Rac||ac.Cx,Cs:!1,HC:!1,jE:!0,fua:H.SelectionEditor.Sl(ac)}):H.SelectionEditor.YDa(ac,!Pa,{RA:!0,Cs:!1,HC:!1,jE:!0});this.Wf.gh&&H.SelectionEditor.nl(Db)&&(ac.Oa.Rb=ac.Oa.Eb=Pa?Db.Rb:Db.Eb);return ac}bkl(Db,ac,Pa,bb,lc,rb,La,sb,Sb,kc,Lb,Qc){const Dc=Pb.Kk;!H.SelectionEditor.HA(bb.node,bb,lc)||this.Wf.gh&&this.Wf.eyi(bb)?Dc.ie(()=>{this.Gkl(bb,lc,rb,La,sb,Sb,kc,Lb)},"DVS:IPM"):Dc.ie(()=>{const {response:Fd,IY:pe}=this.Fkl(Db,
ac,Pa,bb,lc,La,sb,Sb,Lb,Qc);Pb.ORi(sb,32===Fd);pe&&Pb.dqa(Sb,rb)},"DVS:ISE")}wom(Db,ac){Xb.a.dY&&(ac.xd||(ac.xd=new x.DictionaryPropertySet),ac.xd.setValue(ia.a.cpa,"delete"),ac.xd.setValue(ia.a.Fha,"backspace"));var Pa=Db.VI;const bb=Pb.Gd.BX(Pa),lc=kb.a.GYm;if(null===lc||void 0===lc?0:lc.HRm(Pa,bb)){Xb.a.dY&&ac.xd.setValue(ia.a.Fha,"backspace-autocorrect");Pa=lc.XBj+" ";const rb=V.a.Qc(Db,0);this.characterPropertiesEditor.replaceTextRange(rb,Pa);Db=L.SelectionFactory.pe(Db,Pa.length);W.a.instance.setSelection(Db);
Mb.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",lc.XBj)}return l.AFrameworkApplication.va.Mf(ac.B3o,bb.zz?na.a.wL:na.a.jD,2,!1,ac.I9,ac.xd)}Unm(Db,ac,Pa,bb,lc){let rb=!1;0<this.r0i.U3(Db).Ot&&(lc=l.AFrameworkApplication.va.Mf(ac,na.a.thc,2,!1,Pa,bb),rb=!0);return{dU:rb,response:lc}}aom(Db,ac,Pa,bb,lc){let rb=!1;0<this.r0i.xG(Db).Ot&&(lc=l.AFrameworkApplication.va.Mf(ac,na.a.B4c,2,!1,Pa,bb),rb=!0);return{dU:rb,response:lc}}fpm(Db,ac,Pa,bb,lc){let rb=!1;Pb.jq.zAb(Db)&&
(lc=l.AFrameworkApplication.va.Mf(ac,na.a.KG,2,!1,Pa,bb),rb=!0);return{dU:rb,response:lc}}Dmm(Db,ac,Pa,bb,lc,rb,La,sb,Sb,kc){const Lb=new $a.a;Lb.Zc(ac);let Qc=!1;if(Q.OutlineElementNavigator.gGa(Lb,!1,!Db,!1)){kc=!0;Sb=32;Qc=!0;(new n.GraphIterator).Zc(Lb);Q.OutlineElementNavigator.Ge(Lb);const Fd=Lb.currentNode;I.ParagraphReader.vua(Fd)&&I.ParagraphReader.dPa(Fd).Whe("delete_ip");var Dc=new n.GraphIterator;Dc.set(La);(Dc=this.$i.isEmpty(Dc))&&lc&&H.SelectionEditor.K8(lc.Oa)?(Pa.G7a(rb),Q.OutlineElementNavigator.Ge(ac),
Pb.eg.eHa(ac.currentNode)):Fd.vJ?(Pa.G7a(rb),Q.OutlineElementNavigator.Vd(Lb),Lb.xg()):Db&&Dc?this.Wf.zAi(La)&&!({IY:kc}=this.w4i(Db,La,Fd,lc,kc)).returnValue&&(Pa.G7a(rb),Pb.Un.Zca(ac),this.UQh.VGn(La),ac.xg()):dc.TableReader.isTable(Lb)?(Pa.G7a(rb),Db&&(ba.moveToFirstRow(Lb),ba.moveToFirstColumn(Lb),M.OutlineNavigator.h9(Lb),Q.OutlineElementNavigator.Ge(Lb),sb.setSelection((new Qb.a(L.SelectionFactory.pe(Lb.currentNode,0))).restore())),Sb=2,kc=!1):this.$i.Wb(Fd)&&(1==this.$i.textLength(Fd)&&(sb=
wa.e(Fd),1==sb.length&&8==sb[0].zh&&(sb=V.a.createTextRange(Fd,0,1),this.characterPropertiesEditor.replaceTextRange(sb,"",void 0,void 0,na.a.hFc))),({IY:kc}=this.w4i(Db,La,Fd,lc,kc)).returnValue||(bb.actionId==na.a.backspace&&Pa.emc(La),this.UQh.ckl(Db,Pa,rb,ac,La,Lb)))}return{dU:Qc,response:Sb,IY:kc}}w4i(Db,ac,Pa,bb,lc){if(this.Ld.rg){if(Pb.xua){const rb=Object(la.a)(Ob.AParagraphNode,Pa)?Pb.xua.sVc(Pa):!1,La=Object(la.a)(Ob.AParagraphNode,ac)?Pb.xua.sVc(ac):!1;if(rb!==La)return{returnValue:!1,IY:lc};
if(!sa.a.rr&&La)return this.Wf.gh&&Pb.BHk(ac,Pa,Db)&&this.Ld.Ns(4),{returnValue:!1,IY:lc}}Db=Db?ac:Pa;if(!Object(la.a)(Ob.AParagraphNode,Db))return{returnValue:!1,IY:lc};ac=Db.pa.last;Pa=l.AFrameworkApplication.userName;if(!ac.ej||ac.ej.authorName!==Pa)return Pb.nj.KOb(Db,2),bb&&(W.a.instance.setSelection(bb),lc=!1),{returnValue:!0,IY:lc}}return{returnValue:!1,IY:lc}}pom(Db,ac,Pa,bb,lc,rb,La,sb){vb.OutlineElementReader.sLm(ac,Db)||({response:La,IY:sb}=Pb.tql(Pa,bb,Db,rb,lc,La,sb));return{dU:!1,response:La,
IY:sb}}Fkl(Db,ac,Pa,bb,lc,rb,La,sb,Sb,kc){let Lb=!1,Qc=2;const Dc=bb.node;let Fd=void 0,pe=!1;const ye=Pb.Kk;if(!lc){if(Dc.VI)return ye.ie(()=>{Qc=this.wom(Dc,Sb)},"DVS:HLOE"),{response:Qc,IY:Lb};ye.ie(()=>{({response:Qc,dU:pe}=this.Unm(Dc,Db,ac,Pa,Qc))},"DVS:HIOD");if(pe)return{response:Qc,IY:Lb};ye.ie(()=>{({response:Qc,dU:pe}=this.aom(Dc,Db,ac,Pa,Qc))},"DVS:HWPF");if(pe)return{response:Qc,IY:Lb};Fd=this.Oai(Dc);ye.ie(()=>{({response:Qc,dU:pe}=this.fpm(Fd,Db,ac,Pa,Qc))},"DVS:HPOB");if(pe)return{response:Qc,
IY:Lb}}null!==Fd&&void 0!==Fd?Fd:Fd=this.Oai(Dc);ye.ie(()=>{({response:Qc,dU:pe,IY:Lb}=this.Dmm(lc,Fd,La,Sb,kc,bb,Dc,sb,Qc,Lb))},"DVS:HAOE");if(pe)return{response:Qc,IY:Lb};ye.ie(()=>{({response:Qc,dU:pe,IY:Lb}=this.pom(lc,Fd,ac,Pa,La,rb,Qc,Lb))},"DVS:HFLOE");return{response:Qc,IY:Lb}}Bso(Db){return H.SelectionEditor.nl(Db)||this.ZJ.LDi(Db)||H.SelectionEditor.fca(Db)}rso(Db,ac){return Db&&Db.hasProperty(z.a.kKc)?!Db.ia(z.a.kKc,!1):!ac}static get Gd(){return null!=Pb.gEg?Pb.gEg:Pb.gEg=a.a.instance.resolve("Box4.List.IListReader")}static get Un(){return null!=
Pb.YDg?Pb.YDg:Pb.YDg=a.a.instance.resolve("Box4.List.IListEditor")}static get eg(){return null!=Pb.XEg?Pb.XEg:Pb.XEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get jq(){return Fb.a.dFb}static get nj(){return null!=Pb.xIg?Pb.xIg:Pb.xIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Ch(){return null!=Pb.gJg?Pb.gJg:Pb.gJg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Jc(){return Wa.a.instance}static get Vfa(){Pb.Ktb||
(Pb.Ktb=a.a.instance.Sa("Box4.ContentControl.IContentControlOperator"));return Pb.Ktb.instance}static get xua(){return null!=Pb.Cxg?Pb.Cxg:Pb.Cxg=a.a.instance.Na("Box4.IContentControlReader")}static get Kk(){return Bb.a.instance}GFl(Db){if(1===Db.gb.length&&(Db=Db.gb.J(0),H.SelectionEditor.Sl(Db))){var ac=Db.Oa;Db=ac.node;ac=ac.cpBegin;var Pa=this.$i.text(Db);ac<Pa.length&&0<ac&&" "===Pa.charAt(ac-1)&&" "===Pa.charAt(ac)&&this.characterPropertiesEditor.replaceTextRange(V.a.createTextRange(Db,ac-1,
ac),"\u00a0")}}XJk(Db,ac){if(!ac.hyperlink.b3a){const Pa=new y.GraphTransaction(15);try{Pa.Cb(Db.node),this.P_.HR(Db,ac)}finally{Pa&&Pa.dispose()}ac.hyperlink.DG&&this.Ld.Ns(2)}}static tql(Db,ac,Pa,bb,lc,rb,La){if(Pa=H.SelectionEditor.YDa(bb,!Pa,{RA:!1,Cs:!1,HC:!1,jE:!0})){bb=L.SelectionFactory.oz(bb,Pa.Oa);rb=32;for(Pa=0;Pa<bb.length;++Pa){lc.G7a(bb.J(Pa));const sb=l.AFrameworkApplication.va.Mf(bb.J(Pa),na.a.AH,2,!0,Db,ac);2!==sb&&(rb=sb)}32===rb&&(La=!0)}return{response:rb,IY:La}}Bpl(Db,ac,Pa,bb,
lc,rb,La){let sb=!1;this.Cso(Db)?(sb=Pb.Gff(Db,!0,ac,Pa,bb,lc))&&Pb.NIa(rb,ac,La):this.Bso(Db)?(sb=Pb.Gff(Db,!1,ac,Pa,bb,lc))&&Pb.NIa(rb,ac,La):(bb.normalize(),Pb.NIa(rb,ac,La));return sb}static NIa(Db,ac,Pa){Pa&&Pa.dqa()||Pb.dqa(ac,Db)}static Gff(Db,ac,Pa,bb,lc,rb){var La;bb||J.OutlineReader.uQa(Db)||(Pa=Pb.Mad(Pa))&&lc.Poo(Pa);l.AFrameworkApplication.ue("b1jb9393;09icj321");if(null===(La=l.AFrameworkApplication.K)||void 0===La?0:La.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",
!1))rb.xd?rb.xd.Lbd=rb.Lbd:rb.xd={Lbd:rb.Lbd};La=Db instanceof Ua.a?Db.getContext(0).node:Db.node;La=Pb.Z6l(La);Db=32===l.AFrameworkApplication.va.Mf(Db,rb.actionId,2,ac,rb.I9,rb.xd);Pb.ORi(lc,Db,La);return Db}static get Sn(){return null!=Pb.xAg?Pb.xAg:Pb.xAg=a.a.instance.resolve("Box4.IFormattingEditor")}static get HTa(){return null!=Pb.mHg?Pb.mHg:Pb.mHg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static Z6l(Db){const ac=new Xa.a;if(Db){let Pa=null;Db=L.SelectionFactory.ho(Db,!0);if(!Db)Mb.ULS.sendTraceTag(509645905,
315,10,"Unexpected null selection.");else for(let bb=0;bb<Db.length;bb++)if(N.FormattingReader.X9e(Db.J(bb))){Pa=Db.J(bb);break}Pa&&((Db=N.FormattingReader.Nr(Pa))&&Db.cache&&Db.cache.IB&&(Db=Db.Df(null),Pb.Sn.a5(Db)),Db&&(ac.formatting=Db.Wj,ac.languageId=N.FormattingReader.language(Db)),ac.Kja=Pb.HTa.No(Pa.node))}return ac}static ORi(Db,ac,Pa){ac?Db.normalize(Pa):Db.cancel()}static dqa(Db,ac){ac&&Pb.Kk.ie(()=>{const Pa=ac.restore();Pa&&Db.setSelection(Pa)},"DVS:RS")}Gkl(Db,ac,Pa,bb,lc,rb,La,sb){let Sb;
!ac&&({hyperlink:Sb}=this.P_.cbc(Db)).returnValue?(Pa=new Qb.a(bb),this.XJk(Db,Sb),lc.normalize(),Pb.dqa(rb,Pa)):Pb.Gff(Db,!1,rb,La,lc,sb)&&(ac&&this.Ld.rg?(ac=Pb.nj.FGd)?(rb.setSelection(L.SelectionFactory.pe(Db.node,ac)),Pb.nj.FGd=null):Pb.dqa(rb,Pa):Pb.dqa(rb,Pa))}static BHk(Db,ac,Pa){Pa?(Pa=Db,Db=ac):Pa=ac;ac=Pb.xua.Bbc(Pa,!1);Db=Pb.xua.Bbc(Db,!0);return!(ac&&Db)}Cso(Db){return Db.$w||J.OutlineReader.uQa(Db)||this.$i.lm(Db)}static Mad(Db){return(Db=xb.OutlineElementGeneralizer.tna(Db.gb,!0))&&
1===Db.length&&(Db=Db.getContext(0).node,dc.TableReader.xU(Db))?Db:null}Oai(Db){const ac=new n.GraphIterator;ac.set(Db);ac.vd();Q.OutlineElementNavigator.Vd(ac);return ac}}Pb.Ktb=null;Object(F.a)(Pb,"ADeleteViewStrategy",null,[]);class rc{ckl(Db,ac,Pa,bb,lc,rb){const La=rb.currentNode;Q.OutlineElementNavigator.Vd(rb);Db?(ac.emc(rb.currentNode),rc.Wf.pzi(Pa,lc,La,!1)||rc.eg.merge(bb,rb,!1,!1)):rc.Wf.pzi(Pa,La,lc,!0)||rc.eg.merge(rb,bb,!1,!1)}VGn(Db){Db&&I.ParagraphReader.Wb(Db)&&(Va.a.v4c(Db),rc.ftl.w0e(Db))}static get eg(){return null!=
rc.SEg?rc.SEg:rc.SEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get ftl(){return null!=rc.oyg?rc.oyg:rc.oyg=a.a.instance.resolve("Box4.IDynamicRangeEditor")}static get Wf(){return qa.a.instance}}Object(F.a)(rc,"DeleteParagraphNodeStrategy",null,[407]);class Ta extends Pb{constructor(Db,ac,Pa,bb,lc,rb,La,sb,Sb){super(new rc,Db,ac,Pa,bb,lc,rb,La,sb,Sb)}}Object(F.a)(Ta,"DeleteViewStrategy",Pb,[]);c.d(K,"DeleteActor",function(){return Ab});class Ab extends oa{constructor(Db,ac,Pa,bb,lc,
rb,La,sb,Sb,kc,Lb,Qc){super();this.deleteParagraph=(Dc,Fd)=>{Dc=Fd.node;Va.a.v4c(Dc);this.Ize.w0e(Dc);this.pn&&this.pn.instance&&this.pn.instance.DWi(Dc);Dc.Vs&&(this.$l.AZn(Dc,!this.gh),this.gh&&this.JWg.instance&&this.JWg.instance.DFj(Dc));return 0};this.zId=(Dc,Fd,pe)=>{2==pe&&(Dc=l.AFrameworkApplication.breadcrumbFolderUrl,Dc&&0!=Dc.length||(Dc=l.AFrameworkApplication.breadcrumbBrandUrl),ja.App.Xgb(Dc));return 32};this.akl=(Dc,Fd,pe)=>{({DeleteActor:Dc}=c(1596));if(1===pe)return 32;pe=ja.App.xa.Hq.Zf("ModelUpdate",
"DeleteAnchoredObject");Fd=Fd.node;const ye=new n.GraphIterator;ye.set(Fd);ye.zb(12);const pf=ye.Xn(12);if(qa.a.instance.qVc(pf))return 2;Dc.h0b(pf);Dc=new y.GraphTransaction(7);Dc.Cb(Fd);ye.xg();Dc.dispose();pe.stop();return 32};this.n1j=new jb;this.o1j=new Ta(qa.a.instance,Ia.a.instance,rb,La,sb,Sb,kc,Lb,Qc);this.$l=Db;this.Ltc=ac;this.JWg=Pa;this.Ize=bb;this.pn=lc}get gh(){return this.Ltc.instance?this.Ltc.instance.gh:!1}get cRh(){return this.o1j}get SQh(){return this.n1j}j4f(Db,ac,Pa,bb){const lc=
ub.pll,rb=this.akl;Db.qa(na.a.backspace,aa.a.anchoredObject,rb);Db.qa(na.a.backspace,aa.a.unsupportedObject,lc);Db.qa(na.a.AH,aa.a.anchoredObject,rb);Db.qa(na.a.AH,aa.a.unsupportedObject,lc);Db.qa(na.a.backspace,aa.a.paragraph,this.deleteParagraph);Db.qa(na.a.AH,aa.a.paragraph,this.deleteParagraph);Db.qa(na.a.Sua,aa.a.paragraph,this.deleteParagraph);Db.qa(na.a.zId,aa.a.view,this.zId);Db.Vc(na.a.Sua,64);super.j4f(Db,ac,Pa,bb)}static h0b(Db){var ac;(null===(ac=ja.App.rd)||void 0===ac?0:ac.Qo)&&ja.App.rd.Tp.VF(Db)}}
Object(F.a)(Ab,"DeleteActor",oa,[])},1597:function(F,K,c){c.r(K);F=c(0);var l=c(7),f=c(1446),a=c(1610),k=c(912),x=c(1544);class y{constructor(la){this.Ubk=la}initialize(){return Promise.resolve(0)}E2d(){return Promise.resolve(0)}PY(){l.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new x.a,{IsSuccess:!0,Token:this.Ubk}))}gne(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",
ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Wke(){return!1}QPc(){return"MockAuthTokenStrategy"}}Object(F.a)(y,"MockAuthTokenStrategy",null,[401]);var n=c(1658);class u{static get(la,va,ia){if(!ia)return la;let pa=0;return Promise.race([la,new Promise(sa=>{pa=window.setTimeout(()=>{sa(va)},ia)})]).then(sa=>{window.clearTimeout(pa);return Promise.resolve(sa)}).catch(()=>{window.clearTimeout(pa);return Promise.resolve(va)})}}Object(F.a)(u,"PromiseWithTimeout",
null,[]);var z=c(2),w=c(742);class E{constructor(la,va,ia,pa,sa){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=la;this.scope=va;this.silentLogin=ia;this.options=pa;this.correlationId=sa}}Object(F.a)(E,"TokenRequestParameters",null,[409]);var G=c(20),H=c(22);class L{constructor(){this.Klh=null;let la=z.AFrameworkApplication.K.jb(z.AFrameworkApplication.yja),va=z.AFrameworkApplication.K.jb(z.AFrameworkApplication.tne);this.UZb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",
la&&""!==la?la:"Unspecified",va&&""!==va?va:"Unspecified")}initialize(){return new Promise(la=>{H.a.instance.Sa("Common.App.WopiIdentity.IWopiIdentity").execute(va=>{this.Klh=va;la(0)})})}fe(la){const va=["HTTPS:","API:"];let ia=!1;const pa=la.toLocaleUpperCase();for(const sa of va)if(pa.startsWith(sa)){ia=!0;break}return ia||this.oMm(la)?la+"/.default":la}oMm(la){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(la)}E2d(){return Promise.resolve(0)}PY(la,
va,ia,pa,sa,Ha,ra){if(G.a.FQa){sa=w.OAuthManagerSettings.a4o;if(!sa)return va=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(va);if(!Array.contains(sa,la))return va=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+la}),Promise.resolve(va)}la=this.fe(ia);ia=new E(ia,la,!pa,null,z.AFrameworkApplication.userSessionId);return this.Klh.getAccessToken(ia,va,ra).then(Ma=>Object.assign(new x.a,
{IsSuccess:!0,Token:Ma.accessToken}),Ma=>Object.assign(new x.a,{IsSuccess:!1,ErrorCode:Ma}))}gne(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Wke(){return!1}QPc(){return this.UZb}}Object(F.a)(L,"ParentFrameTokenStrategy",null,[401]);var I=c(55),N=c(745),Q=c(74);class M{constructor(){this.reject=this.resolve=null;this.startTime=0;this.b5i=
this.zwh=null}}Object(F.a)(M,"PromiseWrapper",null,[]);class J{constructor(la=0){this.Zx=0;this.dzc=!1;this.gy=new Q.a;this._timeout=la}enqueue(la){return new Promise((va,ia)=>{this.gy.add(Object.assign(new M,{b5i:la,resolve:va,reject:ia}));this.process()})}process(){if(this.dzc||this.Zx===this.gy.count)return!1;const la=this.gy.J(this.Zx++);try{this.dzc=!0,la.b5i().then(va=>{this.dzc=!1;this.r9e(la,va,null,!0)}).catch(va=>{this.dzc=!1;this.r9e(la,null,va,!1)})}catch(va){this.dzc=!1,this.r9e(la,null,
va,!1)}return!0}r9e(la,va,ia,pa){if(pa){const sa=()=>{la.resolve(va);this.process()};0<this._timeout?window.setTimeout(()=>{sa()},this._timeout):sa()}else{const sa=()=>{la.reject(ia);this.process()};0<this._timeout?window.setTimeout(()=>{sa()},this._timeout):sa()}}}Object(F.a)(J,"PromiseQueue",null,[]);class V{constructor(){this.correlationId=this.resolve=null}}Object(F.a)(V,"ResolveWithCorrelation",null,[]);var X=c(67),W=c(174),U=c(943),Y=c(85);class ba extends W.a{constructor(la,va,ia,pa,sa,Ha){super(!1,
!1,!0);this.uSg=this.bAa=null;this.dta=la;this.ugk=ia;this.Nq=pa;this.Snk=sa;this.Cub=Ha;this.mH=document.createElement("iframe");this.mH.id="SharedAuthInteractiveFrame";this.mH.setAttribute("name","SharedAuthInteractiveFrame");this.mH.setAttribute("title","SharedAuthInteractiveFrame");this.mH.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.mH.style.border="0";this.mH.style.height="48px";this.mH.style.width="190px";$addHandler(this.mH,"error",Object(I.a)(this,
this.fvn,"onSharedAuthFrameError"));la=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.dta,va,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",z.AFrameworkApplication.userType);this.mH.src=la;this.x1j=new Promise(ra=>{this.uSg=ra});this.vSg=!1}tTa(){this.bAa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.ugk,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:z.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(I.a)(this,
this.Kal,"createFrame"),["resolveDialogStyles"]:this.uSg}};this.Ad=5;this.Wh(CommonUIStrings.l_SignIn,Object(I.a)(this,this.sro,"sharedAuthConsentDialogHandler"),this.bAa)}IHj(la=!1,va=5){this.bAa&&this.bAa.bodyControls&&(!0!==Object(X.a)(Object,this.bAa.bodyControls).frameLoaded&&(Object(X.a)(Object,this.bAa.bodyControls).frameLoaded=!0),la!==Object(X.a)(Object,this.bAa.bodyControls).frameLoadSuccess&&(Object(X.a)(Object,this.bAa.bodyControls).frameLoadSuccess=la),va!==this.bAa.dialogButtonsOption&&
(this.bAa.dialogButtonsOption=null,this.Ad=va),this.update(this.bAa))}Kyo(la,va){const ia=new U.a(Y.a.wro);ia.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:z.AFrameworkApplication.isRtl,["messageCorrelationId"]:la,["dialogStyles"]:va};this.Nq.YSa(ia,this.mH.contentWindow,this.dta)}f2h(){this.IHj(!1,6)}get ppj(){return this.mH}get Bnl(){return this.x1j.then(la=>{this.vSg=!0;return la})}get Cnl(){return this.vSg}fvn(){this.f2h()}Kal(){return this.mH}sro(la){0===
la&&(this.Snk.reject(Object.assign(new x.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.Cub(null))}}Object(F.a)(ba,"SharedAuthConsentDialog",W.a,[408]);var aa=c(958),fa=c(83),na=c(149),oa=c(39),ja=c(140),qa=c(115);class Ia{constructor(){this.mH=null;this.Wkd=0;this.qXb=this.C_b=this.Qte=this.Cub=this.waa=this.Ljh=null;this.Nq=new aa.a(null,null);this.UZb="SharedAuthTokenStrategy Unloaded";this.dta=w.OAuthManagerSettings.uro;this.Sfh=w.OAuthManagerSettings.tro;
this.ZTg=w.OAuthManagerSettings.enableConsoleLogging;this.F2j=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.Zkk=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.Kok=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.$bb={};this.Z7j=new J(1500)}QPc(){return this.UZb}initialize(){var {OAuthManager:la}=c(1597);
if("loadFrame"in this.$bb)return this.$bb.loadFrame.zwh;if(!this.dta)return fa.Health.instance.recordKpiFailure(la.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),l.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);la=this.yke("loadFrame");this.Wkd=oa.a.af();var va=this.dta+this.Sfh+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+z.AFrameworkApplication.userSessionId+"&WacUserType="+z.AFrameworkApplication.userType;
this.Kok&&(va+="&webworker=1");this.mH=document.createElement("iframe");this.dAf(this.mH);this.mH.style.cssText="height:0;width:0;display:none;";this.mH.id="SharedAuthFrame";this.mH.setAttribute("name","SharedAuthFrame");this.mH.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.mH.setAttribute("title","SharedAuthFrame");this.mH.src=va;document.body.appendChild(this.mH);va=oa.a.af()-this.Wkd;l.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",
va,this.mH.src);return la}E2d(la){this.Qte=la;const va=new U.a(Y.a.spj);va.Values=this.fwh(la);la=this.yke("initFrame");this.Nq.YSa(va,this.mH.contentWindow,this.dta);l.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return la}PY(la,va,ia,pa,sa,Ha){const ra=new U.a(Y.a.xro),Ma=this.Hfi();ra.Values=this.VCj(la,va,ia,pa,sa,Ha,Ma);la=this.yke(Ma);pa&&z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",
!1)?this.Z7j.enqueue(()=>new Promise(ya=>{this.aQo(Ha,ra,ya,Ma)})):(this.Nq.YSa(ra,this.mH.contentWindow,this.dta),l.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",va));return la}aQo(la,va,ia,pa){const sa=this.$bb[pa];sa&&(this.C_b=va,this.Cub=Object.assign(new V,{resolve:ia,correlationId:pa}),this.waa=new ba(this.dta,this.Sfh,la,this.Nq,sa,ia),this.waa.tTa())}Hfi(){return ja.a.create().toString()}VCj(la,va,ia,pa,sa,Ha,ra){const Ma={};Ma.appName=
la;Ma.appId=va;Ma.target=ia;Ma.withPopup=pa;Ma.claims=sa;Ma.promptMessage=Ha;Ma.messageCorrelationId=ra;return Ma}dAf(la){$addHandler(la,"load",Object(I.a)(this,this.gqn,"onIFrameLoaded"));$addHandler(la,"error",Object(I.a)(this,this.lmb,"onIFrameError"));this.Nq.Iaa(this.dta);this.Nq.Dv(Y.a.vpj);this.Nq.TB(Y.a.vpj,Object(I.a)(this,this.Gun,"onScriptLoaded"));this.Nq.Dv(Y.a.upj);this.Nq.TB(Y.a.upj,Object(I.a)(this,this.Fun,"onScriptInitialized"));this.Nq.Dv(Y.a.qpj);this.Nq.TB(Y.a.qpj,Object(I.a)(this,
this.Hpn,"onGetTokenResponse"));this.Nq.Dv(Y.a.wpj);this.Nq.TB(Y.a.wpj,Object(I.a)(this,this.nrn,"onLoginResponse"));this.Nq.Dv(Y.a.tpj);this.Nq.TB(Y.a.tpj,Object(I.a)(this,this.Hqn,"onInteractiveFlowReady"));this.Nq.Dv(Y.a.rpj);this.Nq.TB(Y.a.rpj,Object(I.a)(this,this.Rpn,"onHideDialog"));this.Nq.Dv(Y.a.opj);this.Nq.TB(Y.a.opj,Object(I.a)(this,this.uTf,"onCloseDialog"))}yke(la){const va=new M;va.startTime=oa.a.af();const ia=new Promise((pa,sa)=>{va.resolve=pa;va.reject=sa});va.zwh=ia;this.$bb[la]=
va;return ia}gqn(){const la=oa.a.af()-this.Wkd;l.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",la)}lmb(la){const {OAuthManager:va}=c(1597),ia=oa.a.af()-this.Wkd,pa=Object.assign(new qa.a,{durationMs:ia});fa.Health.instance.recordKpiFailure(va.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,pa);l.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ia,this.ZTg?JSON.stringify(la):"")}Gun(la){const {OAuthManager:va}=c(1597),
ia=this.$bb.loadFrame;var pa=oa.a.af()-ia.startTime,sa=la.Values.AuthLibrary.toString();la=la.Values.Success.toString();l.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",la,sa,pa);sa&&(this.UZb="SharedAuthTokenStrategy "+sa);sa=Boolean.parse(la);sa||(la=na.a.iG(),void 0!==la&&null!==la&&(la.set("AuthLibrary",this.QPc()),pa=Object.assign(new qa.a,{durationMs:pa,extendedProperties:la}),fa.Health.instance.recordKpiFailure(va.kpiName,
"SharedAuthStrategyInitFailed",!1,!0,pa)));ia.resolve(sa?0:1)}Fun(la){if(la.Values.interactive&&this.C_b&&this.C_b.Values.messageCorrelationId){const ia=this.C_b.Values.messageCorrelationId.toString();if(la.Values.interactive&&this.waa){this.waa.Bnl.then(pa=>{this.Nq.YSa(this.C_b,this.waa.ppj.contentWindow,this.dta);this.waa.Kyo(ia,pa);this.waa.IHj(!0);this.C_b=null});return}}la=this.$bb.initFrame;const va=oa.a.af()-la.startTime;l.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",
va);la.resolve(0)}Hpn(la){if(la.Values.messageCorrelationId&&la.Values.messageCorrelationId.toString()){var va=la.Values.messageCorrelationId.toString(),ia=this.$bb[va];if(ia){var pa=oa.a.af()-ia.startTime;l.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",pa);la.Values.isSuccess&&la.Values.isSuccess?ia.resolve(la.Values.response):ia.reject(la.Values.response);this.uDj(va)}else l.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(573112904,
3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}Hqn(){if(this.waa.Cnl)this.waa.f2h();else if(this.Qte&&this.waa){const la=new U.a(Y.a.spj);la.Values=this.fwh(this.Qte,!0);this.Nq.YSa(la,this.waa.ppj.contentWindow,this.dta)}}Rpn(){this.waa&&this.waa.GVd()}uTf(la){la.Values.cancelled&&la.Values.cancelled&&la.Values.messageCorrelationId&&this.uDj(la.Values.messageCorrelationId.toString());this.waa&&this.waa.hide()}fwh(la,va=!1){const ia={};ia.appIds=this.ONl();
ia.upn=la.loginHint;ia.authority=la.authority;ia.authorityType=Object(f.a)(k.a,la.authorityType);ia.tenantId=la.tenantId;ia.correlationId=z.AFrameworkApplication.userSessionId;ia.enableConsoleLogging=this.ZTg;ia.enablePopupFlash=this.F2j;ia.skipUpnCheck=this.Zkk;ia.interactive=va;return ia}ONl(){const la=[],va=w.OAuthManagerSettings.q1e;for(let pa in va){var ia=va[pa];Array.contains(la,ia)||Array.add(la,ia)}return la}gne(la,va,ia,pa,sa,Ha){const ra=new U.a(Y.a.vro),Ma=this.Hfi();ra.Values=this.VCj(la,
va,ia,pa,sa,Ha,Ma);this.Ljh=ra;la=this.yke(Ma);l.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",va);this.qwo();return la}Wke(){return!0}qwo(){this.qXb||(this.qXb=new N.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.qXb.id=16,this.qXb.XZd=!1,this.qXb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{l.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");
this.Nq.YSa(this.Ljh,this.mH.contentWindow,this.dta)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),z.AFrameworkApplication.ta.Nb.Ola(this.qXb,!0)||l.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}nrn(la){if(la.Values.messageCorrelationId&&la.Values.messageCorrelationId.toString()){var va=this.$bb[la.Values.messageCorrelationId.toString()];if(va){var ia=oa.a.af()-va.startTime;l.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",
ia);la.Values.isSuccess&&la.Values.isSuccess?va.resolve(la.Values.response):va.reject(la.Values.response)}else l.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}uDj(la){this.Cub&&this.Cub.correlationId===la&&(this.Cub.resolve(null),this.Cub=null)}}Object(F.a)(Ia,"SharedAuthTokenStrategy",null,[401]);
class Va{constructor(la){this.V6=la;this.UZb="UnsupportedAuthTokenStrategy Reason="+a.a[this.V6]}initialize(){return Promise.resolve(0)}E2d(){return Promise.resolve(0)}PY(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:a.a[this.V6],ErrorMessage:"Unable to get a token. Reason: ["+a.a[this.V6]+"]"}))}gne(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Wke(){return!1}QPc(){return this.UZb}}
Object(F.a)(Va,"UnsupportedAuthTokenStrategy",null,[401]);var Na=c(1505);c.d(K,"OAuthManager",function(){return za});class za{constructor(la=null){this.s$=0;this.t$=null;this.kxb=0;this.h2g=!!window.location.search.match(RegExp("wdpa=1","gi"));const va=oa.a.af();this.F7j=this.Fml(la).then(ia=>ia?this.Uxm():(l.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.WK(),Math.floor(oa.a.af()-va)),ia=na.a.iG(),void 0!==ia&&
null!==ia&&(ia.set("AuthLibrary",this.WK()),ia=Object.assign(new qa.a,{durationMs:Math.floor(oa.a.af()-va),extendedProperties:ia}),fa.Health.instance.recordKpiFailure(za.kpiName,"StrategyPickFailed",!1,!0,ia)),Promise.resolve(1))).then(ia=>0!==ia?Promise.resolve(ia):this.B0m())}Gml(){if(this.h2g)this.s$=5,this.t$=new Va(this.s$);else{var la=w.OAuthManagerSettings.Yen;la&&0<la.length?(this.s$=1,this.t$=new y(la)):z.AFrameworkApplication.K.$("IsO365ConsumerHost")||z.AFrameworkApplication.K.$("IsO365CommercialHost")?
z.AFrameworkApplication.K.$("IsAnonymousUser")?(this.s$=2,this.t$=new Va(this.s$)):(la=n.a.getAuthContext().loginHint)&&la.length?w.OAuthManagerSettings.GRc?(this.s$=1,this.t$=new L):(this.s$=1,this.t$=new Ia):(this.s$=3,this.t$=new Va(this.s$)):(this.s$=4,this.t$=new Va(this.s$))}}WK(){return this.t$?this.t$.QPc()||"Unknown":"None"}Fml(la=null){l.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const va=oa.a.af();return z.AFrameworkApplication.K.WYl().then(ia=>{ia?(this.Gml(),la&&(this.t$=
la),l.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",w.OAuthManagerSettings.clientVersion,w.OAuthManagerSettings.appVersion,w.OAuthManagerSettings.mrl,this.WK(),Math.floor(oa.a.af()-va))):l.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(oa.a.af()-va));return Promise.resolve(ia)},()=>
{l.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(oa.a.af()-va));return Promise.resolve(!1)})}Uxm(){l.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.WK());const la=oa.a.af();return u.get(this.t$.initialize(),2,w.OAuthManagerSettings.d1f).then(va=>{if(0===va)l.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.WK(),Math.floor(oa.a.af()-la));
else if(1===va){l.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.WK(),Math.floor(oa.a.af()-la));var ia=na.a.iG();void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.WK()),ia=Object.assign(new qa.a,{durationMs:Math.floor(oa.a.af()-la),extendedProperties:ia}),fa.Health.instance.recordKpiFailure(za.kpiName,"StrategyInitFailed",!1,!0,ia))}else 2===va&&(l.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.WK(),Math.floor(oa.a.af()-la)),ia=na.a.iG(),void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.WK()),ia=Object.assign(new qa.a,{durationMs:Math.floor(oa.a.af()-la),extendedProperties:ia}),fa.Health.instance.recordKpiFailure(za.kpiName,"StrategyInitTimedOut",!1,!0,ia)));return Promise.resolve(va)},()=>{l.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.WK(),Math.floor(oa.a.af()-la));return Promise.resolve(1)})}B0m(){l.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.WK());const la=oa.a.af();return u.get(this.t$.E2d(n.a.getAuthContext()),2,w.OAuthManagerSettings.d1f).then(va=>{if(0===va)l.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.WK(),Math.floor(oa.a.af()-la));else if(1===va){l.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.WK(),Math.floor(oa.a.af()-la));var ia=na.a.iG();void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.WK()),ia=Object.assign(new qa.a,
{durationMs:Math.floor(oa.a.af()-la),extendedProperties:ia}),fa.Health.instance.recordKpiFailure(za.kpiName,"StrategyLoadFailed",!1,!0,ia))}else 2===va&&(l.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.WK(),Math.floor(oa.a.af()-la)),ia=na.a.iG(),void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.WK()),ia=Object.assign(new qa.a,{durationMs:Math.floor(oa.a.af()-la),extendedProperties:ia}),fa.Health.instance.recordKpiFailure(za.kpiName,
"StrategyLoadTimedOut",!1,!0,ia)));return Promise.resolve(va)},()=>{l.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.WK(),Math.floor(oa.a.af()-la));return Promise.resolve(1)})}PY(la,va,ia=null){return this.umc(la,va,!1,null,"",ia)}WCj(la,va,ia,pa,sa=null){return this.umc(la,va,!0,ia,pa,sa)}umc(la,va,ia,pa,sa,Ha,ra=0){ra+=1;l.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
la,this.PNb(la,va),this.WK(),ra);var Ma=na.a.iG();void 0!==Ma&&null!==Ma&&(Ma.set("AuthLibrary",this.WK()),Ma.set("AppName",la),Ma.set("Target",this.PNb(la,va)),fa.Health.instance.recordKpiUsage(za.kpiName,0,"WacOAuthFC",Ma));if(!w.OAuthManagerSettings.isEnabled||this.h2g){var ya;return this.FKf((ya=new x.a,ya.IsSuccess=!1,ya.Token=null,ya.ErrorCode="NotEnabled",ya.ErrorMessage="OAuthManager is disabled.",ya),la)}const Ga=w.OAuthManagerSettings.q1e[la];if(void 0===Ga||null===Ga){l.ULS.sendTraceTag(41961345,
3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",la);var wa;return this.FKf((wa=new x.a,wa.IsSuccess=!1,wa.Token=null,wa.ErrorCode="DisallowedApp",wa.ErrorMessage="Disallowed appName: "+la,wa),la)}const hb=oa.a.af();let eb=hb;const jb=this;Ma=this.F7j.then(Wa=>{eb=oa.a.af();return jb.OFm(la,Ga,va,ia,pa,sa,Ha,Wa)});ya=ia?0:w.OAuthManagerSettings.d1f;let ub;wa=(ub=new x.a,ub.IsSuccess=!1,ub.Token=null,ub.ErrorCode="authTokenStrategy_timeout",
ub.ErrorMessage="Auth Strategy timed out after ["+ya+"] ms when fetching token",ub);let ab=this,Ea=this;return u.get(Ma,wa,ya).then(Wa=>ra<=za.mcn&&(Wa.ErrorCode===za.Rzj||Wa.ErrorCode===za.YEo)?(l.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",ra,Math.floor(oa.a.af()-hb)),ab.umc(la,va,ia,pa,sa,Ha,ra)):Wa.ErrorCode===za.zEi&&!ia&&(l.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",
ra,za.eWh),za.Yul&&ab.t$.Wke()&&ab.t$.gne(la,Ga,va,ia,pa,sa).then(Bb=>Promise.resolve(ab.r3d(Bb,la,va,Ga,hb,eb))).catch(()=>{let Bb;const Mb=(Bb=new x.a,Bb.IsSuccess=!1,Bb.Token=null,Bb.ErrorCode="authTokenStrategy_failure",Bb.ErrorMessage="LoginPopup failed, GetToken could not be called",Bb);return Promise.resolve(ab.r3d(Mb,la,va,Ga,hb,eb))}),za.eWh)?ab.umc(la,va,!0,pa,sa,Ha,ra):Promise.resolve(ab.r3d(Wa,la,va,Ga,hb,eb))).catch(()=>{let Wa;const Bb=(Wa=new x.a,Wa.IsSuccess=!1,Wa.Token=null,Wa.ErrorCode=
"authTokenStrategy_failure",Wa.ErrorMessage="Auth Strategy failed with an unknown error",Wa);return Promise.resolve(Ea.r3d(Bb,la,va,Ga,hb,eb))})}OFm(la,va,ia,pa,sa,Ha,ra,Ma){return 1===Ma||2===Ma?this.FKf(Object.assign(new x.a,{IsSuccess:!1,Token:null,ErrorCode:1===Ma?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),la):this.t$.PY(la,va,ia,pa,sa,Ha,ra).then(ya=>Promise.resolve(this.PRi(ya,!0,la))).catch(ya=>Promise.resolve(this.PRi(ya,!1,la)))}r3d(la,va,ia,pa,sa,Ha){const ra=
{},Ma=oa.a.af()-Ha;ra.IsSuccess=la.IsSuccess;ra.ErrorCode=la.IsSuccess?"Success":la.ErrorCode||"";ra.ErrorMessage=la.IsSuccess?"Success":this.PNb(va,la.ErrorMessage||"");ra.Target=this.PNb(va,ia||"");ra.TimeInMS=Math.floor(Ma);ra.LoadTimeInMS=Math.floor(Ha-sa);ra.AuthLibrary=this.WK();ra.AppName=va;ra.AuthorityType=Object(f.a)(k.a,n.a.iOd());ra.UserType=this.$im(n.a.getAuthContext());ra.IsAuthSupportedInSession=a.a[this.s$];ra.RequestCount=++this.kxb;ra.AppId=pa;l.ULS.sendTraceTag(593863640,3E3,50,
JSON.stringify(ra));la.IsSuccess||(ia=na.a.iG(),void 0!==ia&&null!==ia&&(ia.set("AppName",va),ia.set("AuthLibrary",this.WK()),ia.set("ErrorCode",la.ErrorCode),ia.set("ErrorMessage",this.PNb(va,la.ErrorMessage)),va=Object.assign(new qa.a,{durationMs:Ma,extendedProperties:ia}),fa.Health.instance.recordKpiFailure(za.kpiName,"TryGetTokenFailure",!1,!0,va)));return la}FKf(la,va){l.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",va,this.PNb(va,
la.ErrorMessage));const ia=na.a.iG();void 0!==ia&&null!==ia&&(ia.set("AppName",va),ia.set("AuthLibrary",this.WK()),ia.set("ErrorCode",la.ErrorCode),ia.set("ErrorMessage",this.PNb(va,la.ErrorMessage)),va=Object.assign(new qa.a,{extendedProperties:ia}),fa.Health.instance.recordKpiFailure(za.kpiName,"FailureBeforeGetToken",!1,!0,va));return Promise.resolve(la)}Txi(la){return la===Na.a.ame}PNb(la,va){return this.Txi(la)&&va?"REDACTED":va}$im(la){return z.AFrameworkApplication.K.$("IsAnonymousUser")?"anonymous":
!la.loginHint||1>la.loginHint.length?"empty":-1<la.loginHint.indexOf("guest#")?"guest":-1<la.loginHint.indexOf("ext#")?"external":0>la.upn.indexOf("@")?"no-at":"supported"}XGm(){return 1===this.s$}PRi(la,va,ia){let pa=null,sa=null,Ha=null,ra=null;la?la.ErrorCode||la.ErrorMessage?(sa=la.ErrorCode?la.ErrorCode:za.cYh,Ha=la.ErrorMessage?la.ErrorMessage:"No message"):la.Token?va?pa=la.Token:(sa=za.rZn,Ha="A rejected promise returned a token."):(sa=za.cYh,Ha=JSON.stringify(la)):(sa=za.Whn,Ha="No result came from Auth Token Strategy");
la&&la.Telemetry&&!this.Txi(ia)&&(ra=la.Telemetry,l.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(ra)));if(sa===za.sfn||sa===za.hMo)sa=za.Rzj,Ha="Auth Library Timed Out";sa===za.YIk&&-1<Ha.indexOf(za.Xpk)&&(sa=za.zEi);if(sa||Ha)pa=null;return Object.assign(new x.a,{IsSuccess:!!pa,Token:pa,ErrorCode:sa,ErrorMessage:Ha,Telemetry:ra})}static get eWh(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get Yul(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",
!1)}}za.hMo="token_renewal_error";za.cYh="Exception";za.Whn="NoResult";za.rZn="RejectToken";za.sfn="monitor_window_timeout";za.Rzj="Timeout";za.YEo="authTokenStrategy_timeout";za.YIk="login_required";za.Xpk="AADSTS50058";za.zEi="Cookies Disabled";za.kpiName="OAuthManager";za.mcn=2;Object(F.a)(za,"OAuthManager",null,[373])},1600:function(F,K,c){F=c(0);class l{constructor(y,n,u,z){this.l0j=y;this.hik=n;this.fik=u;this.iik=z}get $Fd(){return this.l0j}get Kee(){return this.hik}get Iee(){return this.fik}get resultType(){return this.iik}}
Object(F.a)(l,"SearchContext",null,[1251]);class f{pHd(y,n,u,z){var w=u-n;let E;if(100<=w)w=n,E=u;else{w=Math.max(0,n+Math.ceil(w/2)-50);E=Math.min(y.length,w+100);w=Math.max(0,E-100);let H;if(w&&" "!==y.charAt(w-1)){H=Math.min(n,w+10);for(var G=w;G<H;++G)if(" "===y.charAt(G)){w=G+1;break}}if(E!==y.length&&" "!==y.charAt(E))for(H=Math.max(u,E-10),G=E-1;G>=H;--G)if(" "===y.charAt(G)){E=G;break}}y=y.substring(w,E);return new l(y,n-w,u-w,z)}qHd(y){return this.pHd(y.kdi(),y.begin,y.end,"")}}Object(F.a)(f,
"SearchContextFactory",null,[1233]);var a=c(122),k=c(1584);c.d(K,"a",function(){return x});class x extends f{constructor(){super()}qHd(y){let n=y.begin,u=y.end;const z=({begin:n,end:u}=x.P7l(y,n,u)).returnValue;y=k.a(y.type);return this.pHd(z,n,u,y)}static get instance(){return null!=x.bCg?x.bCg:x.bCg=new x}static P7l(y,n,u){y=y.kdi();return x.V$i(y,n,u)}static V$i(y,n,u){const z=a.AParagraphNode.IR(y);if(z.length<y.length){y=y.substring(0,n);const w=a.AParagraphNode.IR(y);y=y.length-w.length;n-=
y;u-=y}return{returnValue:z,begin:n,end:u}}}Object(F.a)(x,"EditorSearchContextFactory",f,[])},1602:function(F,K,c){F=c(0);var l=c(2),f=c(22),a=c(327),k=c(708),x=c(23),y=c(9),n=c(139),u=c(46),z=c(536),w=c(204),E=c(244),G=c(81),H=c(28),L=c(8),I=c(3),N=c(6),Q=c(585),M=c(1049);class J{create(){return new M.a}}Object(F.a)(J,"FootnoteEndnoteContainerNodeFactory",null,[598]);var V=c(526);c.d(K,"a",function(){return X});class X{constructor(W,U,Y,ba,aa,fa,na,oa,ja){this.Bxd=null;X.ga=W;this.uE=Y;this.qNe=
ba;this.N_j=fa;this.Wc=na;this.hb=aa;this.hck=oa;this.Z0j=ja;X.Jh=U}k5d(W,U){this.uwl(W);W.Sb(7);this.uE.Rxi(W,U)||W.Pf(7)}uwl(W){if(this.qNe.rAi(W)){var U=!1,Y=!1;if(W.Sb(7)){do{const ba=W.currentNode;if(37===ba.type)switch(ba.getValue(N.a.N3)){case 0:Y=!0;break;case 1:U=!0}}while(W.zi(7))}Y||this.Tnh(W,0);U||this.Tnh(W,1)}}Tnh(W,U){const Y=this.N_j.create(1074135124);Y.setValue(N.a.N3,U);W.Af(Y,7)}pdo(W){W&&this.yij(W.pna)}yij(W){W&&(W=x.SelectionFactory.pe(W.Ib.paragraph,W.Ib.cp+1),this.hb.setSelection(W))}Vgn(W){let U=
this.hck(W);void 0!==U&&null!==U?this.uE.xoa(U)&&(U=this.uE.Mdi(U)):U=W;return this.Z0j(U)}nzo(){this.Bxd?X.Jh.notificationBar.removeEntry(this.Bxd):this.Bxd=X.Jh.notificationBar.Dma(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);X.Jh.notificationBar.lA(this.Bxd)}nFk(W,U){W=this.Wc.Jva(W,37,37);let Y=!1;if(W.Pd()){do{const ba=W.currentNode;this.uE.IGf(ba)?this.Zth(ba,U):Y=!0}while(W.Lj())}Y&&this.nzo()}Zth(W,U){Q.f(W,Y=>{X.IIl(Y,U);return!0},12)}erm(W,U){W=
this.uE.wOc(W,U);return W?(W=this.Wc.Vf(W))?W.vz():!1:!1}u9h(W,U){W=this.uE.wOc(W,U);W=this.Wc.Vf(W);if(W.Pd()){do if(U=W.currentNode,1===U.getValue(N.a.qna))return U;while(W.Lj())}return null}static xOc(){return new X(l.AFrameworkApplication.va,y.App.xa,V.a.instance,n.PageReader.instance,u.a.instance,new J,new z.a,w.OutlineNavigator.Qgn,E.WordSectionNavigator.Adf)}static get instance(){return null!=X.lCg?X.lCg:X.lCg=X.xOc()}static get paragraphEditor(){return null!=X.GFg?X.GFg:X.GFg=f.a.instance.resolve("Box4.IParagraphEditor")}static IIl(W,
U){U.Cib?X.paragraphEditor.jq.lda(W,G.OutlineReader.vX(W)):X.paragraphEditor.jq.lda(W,0);W=H.a.createTextRange(W,0,L.ParagraphReader.textLength(W));X.ga.Mf(W,I.a.font,2,!0,new a.a,new k.a(U.fontName));X.ga.Mf(W,I.a.UA,2,!0,new a.a,new k.a(U.fontSize))}}X.ga=null;X.Jh=null;Object(F.a)(X,"FootnoteEndnoteEditor",null,[575])},1610:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);var l;(function(f){f[f.unknown=0]="unknown";f[f.supported=1]="supported";f[f.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";
f[f.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";f[f.hostUnsupported=4]="hostUnsupported";f[f.perfAutomation=5]="perfAutomation"})(l||(l={}));Object(F.b)("SupportStatus",l)},1620:function(F,K,c){c.d(K,"a",function(){return L});F=c(0);var l=c(353),f=c(58),a=c(22),k=c(153),x=c(7),y=c(111),n=c(67),u=c(12),z=c(103),w=c(524),E=c(122),G=c(98),H=c(8);class L{constructor(I,N,Q,M,J,V=null,X="",W=!0,U=!1){this.v0a=this.jke=this.Wnb=this.j5i=this.iee=null;this.LUc=!1;this.Ezf=null;this.aSf=0;this.Rle=
null;this.context=I;this.he=I.view;this.yx=N;this.xd=J;this.yR=Q;this.I9=M;this.Pia=this.failed=!1;this.o9d=null;this.P2a=this.vbc=!1;this.cAo=L.v$e(I);this.browserName=X;this.bJj=W;this.yWc=U;this.tUa=!1;this.Q3b=0;if(I=Object(y.a)(101,J)?J:null){this.j5i=new l.DictionaryPropertySet;this.j5i.Vw(I);Q=I.ia(k.a.D1c,f.a.nil);this.UGc=Q!=f.a.nil?Q.toString():f.a.create().toString();if(I.ia(k.a.o1i,!1)){this.vbc=!0;this.P2a=I.ia(k.a.P2a,!1);this.o9d=V;for(V=this.he.lb.tg;V.$w;)V=V.getContext(0);if(J=Object(n.a)(E.AParagraphNode,
V.node)){Q=0;M=H.ParagraphReader.textLength(J);switch(V.contextId){case u.a.Hd:Q=V.cpBegin;M=V.cpEnd;break;case u.a.endOfParagraph:Q=M}this.iee=z.FormattingReader.JPd(V.node,Q,V.Eb);x.ULS.shipAssertTag(6305503,307,!!this.iee);J=G.a.JOc(J);for(const Y of J)Y.cpEnd<=Q||Y.cpBegin>=M||L.hyperlinkEditor.HR(V.node,Y.hyperlink)}}this.Pia=I.ia(k.a.Pia,!1);this.tUa=I.ia(k.a.tUa,!1);this.Wnb=I.ia(k.a.Wnb,null)}else this.UGc=f.a.create().toString();N&64&&(this.Pia=!0)}static get hyperlinkEditor(){return null!=
L.VAg?L.VAg:L.VAg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static v$e(I){if(I){if(I.$w){for(let N=0;N<I.length;N++)if(L.v$e(I.getContext(N)))return!0;return!1}if(Object(y.a)(w.a,I))return L.v$e(I.gk);if(H.ParagraphReader.Wb(I.node)&&I.node.iO)return!0}return!1}}Object(F.a)(L,"ClipboardActionArguments",null,[])},1621:function(F,K,c){c.d(K,"a",function(){return k});F=c(0);var l=c(7),f=c(209),a=c(96);class k{static get GYm(){return k.iod}static F9k(x,y,n){try{k.iod=k.xcl(x,y,n)}catch(u){k.iod=null,
l.ULS.dD(539787540,393,10,u,"Error in creating autoTriggerTextContext: {0}",u instanceof Error?u.message:"Unknown Error")}}static jej(){k.iod=null}static xcl(x,y,n){if(!a.ListItemReader.yg(y))throw l.ULS.sendTraceTag(539787541,393,10,"Given iterator should be at a ListOutlineElement"),Error("Given iterator should be at a ListOutlineElement");const u=f.a.L2l(y);if(null===u||void 0===u||!u.id)throw l.ULS.sendTraceTag(539787542,393,10,"No list node with id found under outline element"),Error("No list node with id found under outline element");
y=n.qw(y);if(!y)throw l.ULS.sendTraceTag(539787543,393,10,"No listInfo found for given iterator"),Error("No listInfo found for given iterator");return new k(x,u.id,y)}constructor(x,y,n){this.XBj=x;this.k0m=y;this.W4f={listType:n.listType,listStyle:n.listStyle,RJf:n.Ku}}HRm(x,y){return y&&x&&this.k0m===x.id&&y.listType===this.W4f.listType&&y.listStyle===this.W4f.listStyle&&y.Ku===this.W4f.RJf}}k.iod=null;Object(F.a)(k,"AutoTriggerTextContext",null,[])},1622:function(F,K,c){c.d(K,"a",function(){return N});
F=c(0);var l=c(22),f=c(58),a=c(43),k=c(629),x=c(139),y=c(536),n=c(172),u=c(9),z=c(109),w=c(6),E=c(871),G=c(759),H=c(526),L=c(1547),I=c(1602);class N{constructor(Q,M,J,V,X,W){this.uE=Q;this.vKa=J;this.qNe=V;this.aye=X;this.Wc=W}RCm(Q,M,J){const V=this.Nai(M,Q.node),X=Q.node.Kc;if(!X)return null;const W=new a.GraphTransaction(15);W.Cb(Q.node);W.jk=J;J=this.SCm(V,M);N.TCm(J,X,Q,M);W.dispose();return J}Nai(Q,M){const J=this.Wc.Bk();J.set(M);J.zb(7);J.jd(7);this.vKa.k5d(J,Q);return J}SCm(Q,M){const J=
G.a.createNode();J.properties.setValue(w.a.N3,M);Q.Af(J,8);this.aye.M$k(J,M);return J}static get characterPropertiesEditor(){return null!=N.Qwg?N.Qwg:N.Qwg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Tda(){return N.GW||(N.GW=new k.WACStyleSet)}static set Tda(Q){N.GW=Q}static xOc(){const {FootnoteEndnoteDefaultContentInserter:Q}=c(1695);return new N(H.a.instance,L.a.instance,I.a.instance,x.PageReader.instance,Q.instance,new y.a)}static get instance(){return null!=N.RCg?N.RCg:
N.RCg=N.xOc()}static get Oh(){return N.dA||(N.dA=n.PageNavigator.instance)}static set Oh(Q){N.dA=Q}static TCm(Q,M,J,V){u.App.rd.Qo&&u.App.rd.Tp.VF(J.node);const X=new z.a;X.setValue(w.a.U6b,Q.id);X.setValue(w.a.N3,V);const W=M.Pu(X,f.a.create());N.characterPropertiesEditor.gha(J,U=>E.a.getInstance(U,W,Q.id),N.Z5h(J.node,V))}static Z5h(Q,M){let J=null;(Q=N.Oh.Ys(Q))&&(Q=N.Tda.VQ(Q))&&(J=Q.GEa(M?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference));return J}}
N.GW=null;N.dA=null;Object(F.a)(N,"FootnoteEndnoteInserter",null,[601])},1628:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{static t4n(f,a){l.QMe=f;l.YPe=a}static q4n(f,a){l.WPe=f;l.BYa=a}static Gfi(){return l.WPe===l.BYa?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,l.BYa,l.QMe,l.YPe):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,l.WPe,l.BYa,l.QMe,l.YPe)}}l.WPe=0;l.BYa=0;l.QMe=null;l.YPe=null;Object(F.a)(l,"ReplaceAllContext",null,[])},
1650:function(F,K,c){c.r(K);F=c(0);var l=c(2043),f=c(58),a=c(2),k=c(306),x=c(22),y=c(1963),n=c(9),u=c(7),z=c(242),w=c(2045),E=c(13),G=c(15),H=c(1600);class L{constructor(Ob="",Vb="",ob=!1,Xb=!1){this.ZOm=ob;this.ASm=Xb;this.actionId=Ob;this.THa=Vb}}Object(F.a)(L,"SearchEntryPointContext",null,[]);class I{constructor(Ob){this.$ea=null;this.Ks=!1;this.rN=Ob}initialize(){this.d_();this.Fz();this.D7(0)}Fz(){this.$ea.Fz()}dispose(){this.rN=null}HPc(){return!1}get mG(){return this.$ea?this.$ea.mG:0}D7(Ob){this.$ea.D7(Ob)}get isVisible(){return this.Ks}d_e(Ob){this.$ea&&
this.$ea.Kdp(Ob)}Taj(Ob){this.$ea&&this.$ea.Fmp(Ob)}XHj(Ob){this.$ea&&this.$ea.cqp(Ob)}lEh(){this.$ea&&this.$ea.Sep()}Pfe(Ob){this.$ea&&this.$ea.Pfe(Ob)}}Object(F.a)(I,"FindReplacePane",null,[521,10]);var N=c(66),Q=c(1409),M=c(1062),J=c(171),V=c(176),X=c(1050),W=c(90),U=c(108),Y=c(83),ba=c(44),aa=c(25),fa=c(398),na=c(1511),oa=c(329),ja=c(1030),qa=c(692),Ia=c(77),Va=c(1080);class Na{constructor(Ob){this.utk=(Vb,ob)=>{this.Cxd.mb(Vb)?this.Cxd.Z(Vb,ob):this.Cxd.add(Vb,ob);(Vb=this.zNl(Vb))&&this.gui(ob,
Vb,this.jJh(oa.a.getTypeName()))};this.Cxd=new Ia.a;this.zV=new Ia.a;this.annotationType=na.RoleDetectionAnnotation.getTypeName();Ob.tVn(this.utk)}EA(Ob,Vb){let ob;const Xb=Ob.parentPath.substr(Ob.parentPath.lastIndexOf("\\")+1),Xa=Ob.content;if(!Xa||this.gSm(Xa))""!==Xb&&({value:ob}=this.Cxd.Dc(Xb,ob)).returnValue&&this.gui(ob,Ob,this.jJh(Vb)),Vb===oa.a.getTypeName()?(Vb=null,({value:Vb}=this.zV.Dc(Xb,Vb)).returnValue?this.zV.Z(Xb,Ob):this.zV.add(Xb,Ob)):Vb===ja.a.getTypeName()&&this.zV.remove(Xb)}gui(Ob,
Vb,ob){const Xb=this.Y1l(Vb);Vb=this.ANl(Vb);0<Vb&&Ob(ob,Xb,Vb)}ANl(Ob){try{return Number.parseInvariant(Ob.id.substr(2))}catch(Vb){u.ULS.sendTraceTag(554747009,367,10,Vb.toString())}return-1}zNl(Ob){let Vb;return({value:Vb}=this.zV.Dc(Ob,Vb)).returnValue?Vb:null}e2c(Ob){if(Ob)for(const Vb of Ob)this.EA(Vb,"AugLoop_Core_AddOperation")}Y1l(Ob){if(Ob=Ob.content)switch(Ob.roleType){case na.RoleType.Heading1:return 1;case na.RoleType.Heading2:return 2;case na.RoleType.Heading3:return 3;case na.RoleType.Heading4:return 4;
case na.RoleType.Heading5:return 5;case na.RoleType.Heading6:return 6;case na.RoleType.Heading7:return 7;case na.RoleType.Heading8:return 8;case na.RoleType.Heading9:return 9}return-1}gSm(Ob){Ob=Ob.roleType;return Ob===na.RoleType.Heading1||Ob===na.RoleType.Heading2||Ob===na.RoleType.Heading3||Ob===na.RoleType.Heading4||Ob===na.RoleType.Heading5||Ob===na.RoleType.Heading6||Ob===na.RoleType.Heading7||Ob===na.RoleType.Heading8||Ob===na.RoleType.Heading9}jJh(Ob){if(Ob===oa.a.getTypeName()||Ob===qa.a.getTypeName())return Va.a.NZe;
if(Ob===ja.a.getTypeName())return Va.a.CId;throw Error.create("Invalid operation type");}}Object(F.a)(Na,"RoleDetectionAnnotationHandler",null,[359]);var za=c(132),la=c(60),va=c(1143),ia=c(46),pa=c(74),sa=c(55),Ha=c(192),ra=c(172),Ma=c(645);class ya extends Ha.a{constructor(Ob,Vb){super(Ob,Vb,n.App.Hda);this.U0d=null;this.DPa=this.T1b=0;this.headingsReady=!1;this.Yxa=this.aNa=0;this.BLi=!1;this.P7g=this.xYg=this.FUg=null}get E0d(){return!0}get FYh(){return this.FUg}get A5d(){return this.P7g}jKj(){this.headingsReady&&
(this.xYg.style.display="none",this.DPa||this.T1b?(this.FYh.style.display="none",this.container.style.display="block"):(this.container.style.display="none",this.FYh.style.display="block"))}get E8(){return super.E8|240}static Gbf(Ob,Vb,ob){var Xb=n.App.xa.ib.Uc;if(Xb&&(Xb=ra.PageNavigator.instance.LO(Xb))){const Xa=new ya(new Ma.a,x.a.instance.resolve("Box4.IHtmlViewRootFactory"));Xa.DPa=0;Xa.T1b=0;Xa.U0d=null;Xa.Xzb(Ob);Xa.FUg=Vb;Xa.xYg=ob;Xa.ME(Xb);Xa.headingsReady=!0;Xa.jKj();Xa.P7g=null;return Xa}return null}}
Object(F.a)(ya,"WordNavigationPaneHeadingsView",Ha.a,[549,193,82,10]);class Ga{constructor(Ob){this.zV=new Ia.a;this.b9g=Ob}EA(Ob,Vb){Vb===oa.a.getTypeName()?(Vb=null,({value:Vb}=this.zV.Dc(Ob.id,Vb)).returnValue?this.zV.Z(Ob.id,Ob):this.zV.add(Ob.id,Ob)):Vb===ja.a.getTypeName()&&this.zV.remove(Ob.id);this.b9g&&this.b9g()}e2c(Ob){if(Ob)for(const Vb of Ob)this.EA(Vb,oa.a.getTypeName())}p7b(){var Ob;const Vb=[];if(0<(null===(Ob=this.zV)||void 0===Ob?void 0:Ob.count))for(const ob of this.zV.values)Vb.push(ob);
return Vb}}Object(F.a)(Ga,"ContractEntityAnnotationHandler",null,[359]);var wa=c(3);class hb{constructor(Ob){this.ga=Ob}Zmn(){this.cancelSearch()}epn(Ob){this.ga.Qb(G.a.wTd,2,Ob)}wsn(){this.cancelSearch()}cancelSearch(){this.ga.processAction(wa.a.B2b,2)}Iun(){this.ga.processAction(wa.a.findOnPage,2)}onSearchQueryChanged(Ob){this.ga.Qb(wa.a.Hkf,2,Ob)}twn(){this.ga.processAction(G.a.replace,2)}uwn(){this.ga.processAction(G.a.replaceAll,2)}pwn(){this.ga.processAction(E.a.Ekf,2)}qwn(){this.ga.processAction(E.a.Ukf,
2)}swn(){this.ga.processAction(wa.a.S_f,2)}rwn(){this.ga.processAction(wa.a.jRf,2)}Vgc(Ob){this.ga.Qb(G.a.Vgc,2,Ob)}}Object(F.a)(hb,"FindReplaceActions",null,[548]);var eb=c(270);class jb{}jb.uP=eb.a.Qgb;jb.Nfc=0;jb.Qua="FindReplaceTaskPaneData";jb.QR=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(F.a)(jb,"FindReplaceConstants",null,[]);var ub=c(755);class ab{PCj(Ob){var Vb,ob,Xb;return fa.a.Vhb(null===(Xb=null===(ob=null===(Vb=n.App.xa)||void 0===Vb?void 0:Vb.ib)||void 0===ob?void 0:
ob.Uc)||void 0===Xb?void 0:Xb.od,Ob)}clearSelection(){if(this.IIe){const Ob=this.PCj(this.IIe);Ob&&Ob.nma()}this.IIe=this.Seh=null}gdo(Ob){this.clearSelection();if(Ob){const Vb=this.PCj(Ob.parentPath);if(Vb){const ob=Ob.content;ob&&(this.Seh=Ob.id,Vb.dTa([new ub.a(ob.range.start,ob.range.start+ob.range.length)]),Vb.oMf(0,1));this.IIe=Ob.parentPath}}}}Object(F.a)(ab,"RangeAnnotationContentSelector",null,[]);var Ea=c(1628);class Wa{constructor(Ob){this.rak=Ob}get Qj(){return this.rak.value}F5l(Ob){Ob=
this.Qj.q1a(Ob);return this.yLm(Ob)?null:Ob}yLm(Ob){return Ob.id===this.Qj.$Da.id}static get instance(){return null!=Wa.GBg?Wa.GBg:Wa.GBg=Wa.ZE()}static ZE(){const Ob=new z.a(()=>y.FindManager.instance.Qj);return new Wa(Ob)}}Object(F.a)(Wa,"SearchResultOrder",null,[]);var Bb=c(8),Mb=c(201);class Fb{constructor(Ob){this.dJe=Ob}get U0(){return this.dJe.value}getSelectedText(){var Ob=this.U0.L3;if(Ob){const Vb=Ob.cpBegin,ob=Ob.cpEnd-Vb;if(0<ob&&(Ob=Ob.node,Bb.ParagraphReader.Wb(Ob)))return Ob.characterData.substr(Vb,
ob)}return null}static getInstance(){return Fb.Rl()}static Rl(){const Ob=new z.a(()=>Mb.a.instance);return new Fb(Ob)}}Object(F.a)(Fb,"SelectionHelper",null,[]);var vb=c(31),$a=c(115),kb=c(330),Ua=c(852),Sa=c(236),xb=c(367),Qb=c(1862),Ib=c(368);class $b extends Ha.a{constructor(Ob,Vb,ob){super(Ob,Vb,n.App.Hda);this.ZGa=ob;this.$mi=!1}get E0d(){return!0}get E8(){return super.E8|248}static Gbf(Ob){var Vb=n.App.xa.ib.Uc;const ob=Ib.a.instance.Oc(3);return Vb&&(Vb=ra.PageNavigator.instance.LO(Vb))?(Ob=
new $b(new Ma.a,x.a.instance.resolve("Box4.IHtmlViewRootFactory"),Ob),ob.U7c(Ob.fc),Ob.ME(Vb),ob.dispose(),Ob.$mi=!0,Ob):null}}Object(F.a)($b,"WordNavigationPaneReactHeadingsView",Ha.a,[193,82,10]);class hc extends I{constructor(Ob,Vb,ob,Xb,Xa,Pb,rc,Ta,Ab,Db,ac,Pa,bb){var lc,rb,La;super(Ob);this.ytb=jb.uP;this.Emk="FindReplaceTaskPaneProps";this.Ub=N.FocusManager.instance();this.pVa=this.dMa=this.AZ=this.iUe=null;this.USb=a.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled");this.cpc=a.AFrameworkApplication.K.$("AutoDetectedHeadingsIsEnabled");
this.Apd=(null===(lc=a.AFrameworkApplication.K)||void 0===lc?void 0:lc.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactHeadings",!1))||(null===(rb=a.AFrameworkApplication.K)||void 0===rb?void 0:rb.$("NavPaneReactHeadings"));this.fck=null===(La=a.AFrameworkApplication.K)||void 0===La?void 0:La.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",!1);this.FGj=()=>{this.isVisible&&this.KHd===w.a.intelligentPlaceholder&&this.Cm()};this.hB=new Q.a;this.rXg=Vb;this.QJa=
w.a.headings;this.eDc=l.a.initial;this.dsa=new pa.a;this.VP="";this.qtc={matchCase:!1,matchWholeWord:!1};this.XPe="";this.KRe=null;this.V2=ob;this.Cgh=!1;this.Acb=Xb;this.hb=Xa;this.vck=Pb;this.RBa=rc;this.tI=Ta;this.sqd=!0;this.M6=this.L6=!1;this.Se=Ab;this.iH=Db;this.Gb=ac;this.xV=Pa;this.nQg=bb;this.Kte&&this.RBa.cZn(()=>{this.Cm()})}get RUe(){return 1}get Kte(){return this.USb&&this.cpc&&!!this.Se}get Lte(){return this.USb&&this.fck&&!!this.Se}get headingsReady(){return this.Apd?this.iH.headingsReady:
this.Ckd?this.Ckd.headingsReady:!1}set headingsReady(Ob){this.Apd?this.iH.headingsReady=Ob:this.Ckd&&(this.Ckd.headingsReady=Ob)}get KHd(){return this.QJa}rsj(){this.QJa=w.a.headings;this.Cm()}Iwo(){this.QJa=w.a.contracts;this.Cm()}isj(){this.QJa=w.a.find;ba.a("NavigationPaneFind");this.Cm()}atj(){this.QJa=w.a.replace;this.Cm()}Dsj(){this.QJa=w.a.intelligentPlaceholder;this.Cm()}J8c(Ob){this.Cgh=Ob;this.Cm()}HPc(){return this.KHd===w.a.replace}get mG(){return this.eDc}D7(Ob){this.eDc=Ob;this.Cm()}d_e(Ob){this.zvk(Ob);
this.Cm()}zvk(Ob){const Vb=this.vck(Ob[Ob.length-1]);if(Vb){let ob=-1;for(let Xb=0;Xb<this.dsa.count;Xb++)if(Vb.id===this.dsa.J(Xb).id){ob=Xb;break}-1===ob?u.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.dsa.PC(ob,this.JJh(Ob))}else this.dsa.addRange(this.JJh(Ob))}Taj(Ob){for(const Vb of Ob)for(Ob=this.dsa.count-1;0<=Ob;Ob--)if(this.dsa.J(Ob).id===Vb.id){this.dsa.removeAt(Ob);break}this.Cm()}XHj(Ob){for(const Vb of Ob)for(Ob=this.dsa.count-1;0<=Ob;Ob--)if(this.dsa.J(Ob).id===
Vb.id){this.dsa.Z(Ob,this.IJh(Vb));break}this.Cm()}lEh(){this.dsa.clear();this.KRe=null;this.Cm()}Pfe(Ob){this.KRe=Ob?Ob.id:null;this.Cm()}JJh(Ob){if(!Ob)return new pa.a;const Vb=new pa.a;for(const ob of Ob)Vb.add(this.IJh(ob));return Vb}IJh(Ob){const Vb=this.Acb.qHd(Ob);return{id:Ob.id,searchBeginIndex:Vb.Kee,searchEndIndex:Vb.Iee,searchResult:Vb.$Fd}}boe(){}p_o(){var Ob={};this.rN.Vgc(Ob);Ob=Ob[M.a.Value];this.iUe=aa.c(Ob)?"":Ob;this.Cm()}$Oa(){return this.VP}oFb(){return this.XPe}Nag(Ob){this.VP=
Ob;this.Cm()}clearSearch(){}initialize(){this.Yud=window.performance.now();const Ob=this.Ub.fe(this.ytb);Ob.parent=J.AFrame.rp;Ob.RH=!0;this.d_();this.D7(l.a.initial)}pP(){this.isVisible?(u.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),V.UISurfaces.Gu().then(Ob=>{Ob.setSelectedTaskPane(this.ytb,this.RUe);this.O9();this.sqd&&this.vnj(!0);return null}).catch(Ob=>{hc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Ob)})):(this.Q8c(),
this.sqd&&this.vnj(!1))}vnj(Ob){const Vb=this.rXg();Vb?this.VP=Vb:Ob&&this.VP||(this.VP="");this.rN.onSearchQueryChanged(this.VP)}$na(){V.UISurfaces.Gu().then(Ob=>{Ob.hideTaskPane(this.ytb,this.RUe);return null}).catch(Ob=>{hc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Ob)})}d_(){this.V2.QNa();this.AZ=this.V2.o4b(this.Ub);this.gtk()}Q8c(){V.UISurfaces.Gu().then(Ob=>{this.Yud=window.performance.now();Ob.showTaskPane(this.ytb,this.pA());Ob=[Object.assign(new vb.a,{name:"Tab",
string:this.QJa})];const Vb=window.performance.now()-this.Yud;ba.a("NavigationPaneOpen",!0,Vb,Ob);return null}).catch(Ob=>{hc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Ob)})}Cm(){V.UISurfaces.Gu().then(Ob=>{Ob.updateTaskPane(this.ytb,this.pA());return null}).catch(Ob=>{hc.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],Ob)})}pA(){const Ob={activeTab:w.a.initial};this.hB.Cob(Ob);return Object.assign(new X.a,{title:jb.QR,hideHeader:!1,width:320,
location:this.RUe,contentProps:Ob,onOpen:()=>{this.Ks=!0;this.AYn();this.GVn();this.sqd&&this.O9();n.App.xa.updateCommandUI();n.App.xa.eZa(this.FGj)},onClose:()=>{try{const Vb=window.performance.now();this.mda();this.Ks=!1;this.LSo();this.oTo();this.rN.wsn();this.iUe="";this.eDc=l.a.initial;n.App.xa.yhc(this.FGj);n.App.xa.updateCommandUI();const ob=window.performance.now()-Vb;ba.a("NavigationPaneClose",!0,ob)}catch(Vb){hc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Vb)}},
enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0})}AYn(){this.Kte&&!this.dMa&&fa.a.Mk().then(()=>{this.dMa=new Na(this.RBa);this.Se.nb(this.dMa,this.dMa.annotationType);this.Se.getAnnotationsByType(this.dMa.annotationType).then(Ob=>{this.dMa.e2c(Ob)})})}oTo(){this.Kte&&this.dMa&&(this.Se.sc(this.dMa,this.dMa.annotationType),this.dMa=null)}nOo(){if(this.Lte){var Ob=new Qb.ContractEntitySignal;Ob=Object.assign(new Ua.a,{parentPath:["Signal",Sa.a.getTypeNameFor(Ob)],items:[Object.assign(new xb.a,
{body:Ob})]});this.xV.getAugLoopRuntimeManager().submitOperation(Object.assign(new kb.a,{operation:Ob}))}}GVn(){this.Lte&&!this.pVa&&fa.a.Mk().then(()=>{this.pVa=new Ga(this.Cm);this.Se.nb(this.pVa,Qb.ContractEntityAnnotation.getTypeName());this.nOo();this.Se.getAnnotationsByType(Qb.ContractEntityAnnotation.getTypeName()).then(Ob=>{this.pVa.e2c(Ob)})})}LSo(){this.Lte&&this.pVa&&(this.Se.sc(this.pVa,Qb.ContractEntityAnnotation.getTypeName()),this.pVa=null)}gtk(){this.hB.qL(this.wXl());this.hB.qL(this.yXl());
this.hB.qL(this.XZl());this.hB.qL(this.USl());this.hB.qL(this.S0l());this.hB.qL(this.VLl());this.hB.qL(this.onLinkExecute());this.hB.qL(this.onPivotTabExecute());this.hB.qL(this.sdm());this.hB.qL(this.mgm());this.hB.qL(this.x0l());this.hB.qL(this.dhm());this.hB.qL(this.Fam())}dhm(){return Ob=>{Ob.autoDetectedHeadingsToggleDisabled=this.RBa?!this.RBa.sJk():!0}}mgm(){return Ob=>{Ob.type=this.Emk}}onLinkExecute(){return Ob=>{Ob.onLinkExecute=()=>{this.rN.Iun()}}}onPivotTabExecute(){return Ob=>{Ob.onPivotTabExecute=
Vb=>{switch(Vb){case w.a.headings:this.rsj();break;case w.a.replace:this.atj();break;case w.a.contracts:this.Iwo();break;case w.a.intelligentPlaceholder:this.Dsj();break;default:this.isj()}aa.b(this.VP)&&(this.VP=this.rXg(),this.VP||(this.VP=""),aa.b(this.VP)||(this.rN.onSearchQueryChanged(this.VP),this.Cm()))}}}sdm(){return Ob=>{Ob.showOutOfSyncNotification=this.Cgh}}yXl(){return Ob=>{Ob.findSearchBoxContent={onSearchQueryChanged:Vb=>{this.VP=Vb;this.Cm();this.rN.onSearchQueryChanged(Vb)},findOptions:this.qtc,
matchCase:this.L6,matchWholeWord:this.M6,findSearchText:this.VP,onClearButtonExecute:()=>{void 0!==this.VP&&null!==this.VP&&""!==this.VP&&(this.VP="",this.hb.setSelection(null),this.rN.Zmn())},onMatchCaseExecute:()=>{this.qtc.matchCase=!this.qtc.matchCase;this.L6=!this.L6;this.Cm();this.rN.pwn()},onMatchWholeWordExecute:()=>{this.qtc.matchWholeWord=!this.qtc.matchWholeWord;this.M6=!this.M6;this.Cm();this.rN.qwn()},onMenuClose:()=>{if(this.AZ)this.AZ.onMenuClose()},onMenuOpen:()=>{if(this.AZ)this.AZ.onMenuOpen()}}}}VLl(){return Ob=>
{Ob.activeTab=this.KHd}}x0l(){return Ob=>{Ob.autoDetectedHeadingsToggleState=this.RBa?this.RBa.i3e:!1;this.iH.ELc=Ob.autoDetectedHeadingsToggleState;!Ob.autoDetectedHeadingsToggleState&&this.RBa&&this.RBa.Tlc(!1)}}wXl(){return Ob=>{const Vb={onReplaceAllExecute:()=>{this.rN.uwn()},onReplaceExecute:()=>{this.rN.twn()},onReplaceQueryChanged:ob=>{this.XPe=ob;this.Cm()},replaceSearchText:this.XPe};Ob.findReplaceContent={searchResults:this.dsa.toArray(),replaceSearchBoxContent:Vb,onNextSearchResultExecute:()=>
{this.rN.rwn()},onPrevSearchResultExecute:()=>{this.rN.swn()},onSearchResultSelected:ob=>{const {FindReplaceUIManager:Xb}=c(1650);this.rN.epn(ob);Xb.fLi(1)},selectedResultId:this.KRe,summaryLabel:this.iUe,explanationText:this.OWl(this.eDc),haveTooManySearchResults:this.eDc===l.a.tooManyResults}}}OWl(Ob){switch(Ob){case l.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;case l.a.noMatchesFound:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case l.a.replaceAllComplete:return Ea.a.Gfi();
case l.a.tooManyResults:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;default:return""}}Fam(){return Ob=>{Ob.replaceFollowUpsWithCommentsIsEnabled=!0}}S0l(){return Ob=>{var Vb=this.tI.LMl();const ob=[];for(const Xb of Vb)Vb=this.tI.$Nd(Xb.Kc,Xb.id),ob.push({id:Xb.id.toString(),intelligentPlaceholderAnchorText:Vb});Ob.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:ob,onIntelligentPlaceholderInputExecute:Xb=>{this.VP=Xb;this.QJa=w.a.find;this.Cm();this.rN.onSearchQueryChanged(Xb)},
onSearchResultSelected:Xb=>{this.Cm();Xb=f.a.Ef(Xb);this.tI.qdo(Xb)}}}}XZl(){return Ob=>{let Vb=()=>{};this.RBa&&(Vb=Object(sa.a)(this.RBa,this.RBa.Tlc,"toggleAutoDetectedHeadings"));Ob.headingsContent={onHeaderInputExecute:ob=>{this.VP=ob;this.QJa=w.a.find;this.Cm();ba.a("NavigationPaneFind");this.rN.onSearchQueryChanged(ob)},renderHeadingContent:(ob,Xb,Xa)=>{this.Gb.Vb(new W.a(0,1,100,()=>{var Pb=window.performance.now()-this.Yud;if(this.Apd){var rc=this.iH.v9;this.headingsReady=!0;this.Cm();Xa.style.display=
"none";rc.first&&(ob.style.display="block");this.Gb.Vb(new W.a(1,1,0,()=>{$b.Gbf(this)}))}else this.Ckd=ya.Gbf(ob,Xb,Xa),this.Cm();rc=window.performance.now()-this.Yud;ba.a("NavigationPaneHeadingsLoaded",!0,rc,[Object.assign(new vb.a,{name:"NavPaneReactHeadings",bool:this.Apd})]);Pb=[Object.assign(new vb.a,{name:"HeadingFetchStart",double:Pb}),Object.assign(new vb.a,{name:"HeadingFetchFinished",double:rc})];ba.a("NavigationPaneHeadingsLoadDetails",!0,void 0,Pb)}))},autoDetectedHeadingsToggle:Vb,onHeadingsUnmounted:()=>
{this.headingsReady=!1},headingsReady:this.headingsReady,headingsList:this.iH.v9,onHeadingChevronClick:ob=>{this.iH.gzl(ob);this.Cm()},onClickHeading:ob=>{if(this.Gb.Nv){u.ULS.sendTraceTag(512328290,312,50,"OnClickHeading: TaskManager isYielding, creating an onclick task for [HeadingParagraphID: {0}]",ob);const Xb=window.performance.now();this.Gb.Vb(new W.a(0,1,0,()=>{this.iH.onClickHeading(ob);this.Cm();const Xa=window.performance.now()-Xb;ba.a("NavigationPaneAsyncOnClickHeadingItem",!0,Xa)}))}else this.iH.onClickHeading(ob),
this.Cm()},onClickBookmark:ob=>{if(this.Gb.Nv){u.ULS.sendTraceTag(512328289,312,50,"OnClickBookmark: TaskManager isYielding, creating an onclick task for [BookmarkName: {0}]",ob);const Xb=window.performance.now();this.Gb.Vb(new W.a(0,1,0,()=>{this.iH.onClickBookmark(ob);this.Cm();const Xa=window.performance.now()-Xb;ba.a("NavigationPaneAsyncOnClickHeadingItem",!0,Xa)}))}else this.iH.onClickBookmark(ob),this.Cm()},onShareHeadingClick:ob=>{this.iH.onShareHeadingClick(ob)},bookmarkIconUrl:za.a.vg("BookmarkDefault.png")}}}TSl(){var Ob,
Vb=null===(Ob=this.pVa)||void 0===Ob?void 0:Ob.p7b();if(Vb){Ob=Array(Vb.length);let ob=0;for(const Xb of Vb)(Vb=Xb.content)&&(Ob[ob++]={id:Xb.id,type:Vb.type,value:Vb.value});return Ob}return null}USl(){return Ob=>{Ob.contractsContent={onHeaderInputExecute:Vb=>{this.VP=Vb;this.QJa=w.a.find;this.Cm();ba.a("NavigationPaneFind");this.rN.onSearchQueryChanged(Vb)},contractEntities:this.TSl(),selectedEntityId:this.nQg.Seh,onEntitySelected:Vb=>{var ob;const Xb=null===(ob=this.pVa)||void 0===ob?void 0:ob.p7b();
if(Xb)for(const Xa of Xb)if(Xa.id===Vb){this.nQg.gdo(Xa);break}this.Cm()}}}}Lmj(Ob){this.sqd=Ob}zYo(Ob){this.Gb.Vb(new W.a(0,1,0,()=>{this.iH.$mg(Ob)&&this.Cm()}))}Hli(Ob){this.Gb.Vb(new W.a(0,1,0,()=>{const Vb=this.iH.jMb;this.iH.Mkl(Ob)?this.Cm():0===this.iH.jMb&&0<Vb&&this.Cm()}))}gmg(Ob,Vb){this.Gb.Vb(new W.a(0,1,0,()=>{const ob=this.iH.jMb;this.iH.gmg(Ob,Vb)?this.Cm():0<this.iH.jMb&&0===ob&&this.Cm()}))}ekl(Ob){this.Gb.Vb(new W.a(0,1,0,()=>{const Vb=this.iH.jMb;this.iH.fkl(Ob)?this.Cm():0===
this.iH.jMb&&0<Vb&&this.Cm()}))}npo(Ob){this.iH.OLo(Ob);this.Cm()}Jmg(Ob){this.iH.Jmg(Ob)&&this.Cm()}DId(Ob){this.iH.DId(Ob)&&this.Cm()}VLn(){return 0<this.iH.jMb}O9(){this.Ub.mg(this.ytb);u.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}mda(){if(this.v3a()){var Ob;(Ob=la.InteractiveViewManager.instance.Bd)?(Ob=Ob.hJ,u.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(Ob=this.Ub.vT,u.ULS.sendTraceTag(40469192,312,50,
"Taskpane now hidden with focus on default scope."));this.Ub.mg(Ob)}}v3a(){return!!this.Ub.currentScope&&this.Ub.currentScope.name===this.ytb}static getInstance(){return hc.Rl()}static Rl(){return new hc(new hb(a.AFrameworkApplication.va),Object(sa.a)(Fb.getInstance(),Fb.getInstance().getSelectedText,"getSelectedText"),va.a.instance,H.a.instance,ia.a.instance,Object(sa.a)(Wa.instance,Wa.instance.F5l,"getNextSearchResult"),x.a.instance.Na("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),
x.a.instance.Na("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),x.a.instance.Na("Box4.AugmentationLoop.IAnnotationStorage"),x.a.instance.resolve("WordEditor.FindReplace.NavPaneHeadingsManager"),U.a.instance,x.a.instance.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),new ab)}static recordQosError(Ob,Vb,ob){const Xb=Object.assign(new $a.a,{extendedProperties:new Map});ob&&Xb.extendedProperties.set("exception",ob);Y.Health.instance.recordQosError(Ob,Vb,!1,!0,!1,!1,Xb)}}Object(F.a)(hc,
"ReactFindReplacePane",I,[520,521,10]);var pb=c(1584);c.d(K,"FindReplaceUIManager",function(){return dc});class dc{constructor(Ob,Vb,ob=null,Xb=null,Xa=null,Pb=null){this.Zgd=this.t2=0;this.M6=this.L6=this.kyb=!1;this.hm=this.p8g=this.Pja=null;this.AFa=this.XGe=!1;this.ij=Ob;this.Wp=ob;this.Acb=Xb;this.W4g=Xa;this.ge=Pb;dc.o2b=new L}get YFf(){return this.XGe}set YFf(Ob){Ob!==this.XGe&&(this.XGe=Ob,this.WCh())}Yhe(Ob){this.t2=Ob;this.update();this.t2||this.mG!==l.a.searchComplete&&this.mG!==l.a.tooManyResults?
0<this.t2&&this.mG===l.a.noMatchesFound?this.D7(l.a.searchComplete):this.t2>dc.vAj&&this.mG!==l.a.tooManyResults&&(u.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.D7(l.a.tooManyResults)):this.D7(l.a.noMatchesFound)}qge(Ob){this.Zgd=Ob;this.AFa&&this.update();this.W4g&&!this.W4g.value.d5c&&this.hag()}reset(){}Skf(){this.ge&&(this.hm=this.ge.Zf("UserAction","Find"));if(this.AFa||!this.mG)this.AFa=!1,u.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.D7(l.a.searching)}D6b(){var Ob;
this.AFa=!0;let Vb=this.t2?l.a.searchComplete:l.a.noMatchesFound;if(this.mG!==l.a.tooManyResults&&y.FindManager.instance){const ob=y.FindManager.instance.Qj;0<ob.tja&&(ob.tja>dc.vAj?Vb=l.a.tooManyResults:this.BZo(ob))}this.D7(Vb);this.update();this.hm&&(this.hm.stop(),this.hm=null);dc.eij=f.a.create().toString();dc.fLi(0,this.E4b,this.$Oa().length,this.t2);Object(pb.b)()&&(null===(Ob=this.ij)||void 0===Ob?0:Ob.isVisible)&&(Ob={},a.AFrameworkApplication.va.Qb(E.a.gce,2,Ob),Ob[k.a.On]&&a.AFrameworkApplication.va.Qb(E.a.IXd,
2,{CommandValueId:{query:this.$Oa(),matchCase:this.L6,matchWholeWordOnly:this.M6,totalResultLimit:-1}}))}BZo(Ob){const Vb=Ob.$Da;let ob=Vb;const Xb=[];do Xb[Xb.length]=ob,ob=Ob.q1a(ob);while(Vb!==ob);this.ij.d_e(Xb);this.Pja&&this.ij.Pfe(this.Pja)}update(){this.ij&&this.ij.p_o()}get mG(){return this.ij.mG}get E4b(){return this.ij.KHd}Fob(Ob){this.YFf=Ob}WCh(){if(this.YFf)switch(this.mG){case l.a.searchComplete:case l.a.noMatchesFound:case l.a.tooManyResults:this.ij.J8c(!0)}else this.ij.J8c(!1)}D7(Ob){if(this.ij.isVisible){switch(Ob){case l.a.noMatchesFound:case l.a.searchComplete:this.mG===
l.a.tooManyResults&&(Ob=l.a.tooManyResults)}this.ij&&(this.ij.D7(Ob),this.WCh());this.update();this.hag()}}COa(Ob,Vb){const ob=this.AFa&&this.mG!==l.a.tooManyResults;switch(Ob){case 0:ob&&this.ij.d_e(Vb);break;case 1:ob&&this.ij.Taj(Vb);break;case 4:ob&&this.ij.XHj(Vb);break;case 2:this.ij.lEh();break;case 3:this.Pja=Vb[0],ob&&0<this.t2&&this.ij.Pfe(this.Pja)}}get matchCase(){return this.L6}set matchCase(Ob){this.L6!==Ob&&(this.L6=Ob,this.fGj())}get matchWholeWord(){return this.M6}set matchWholeWord(Ob){this.M6!==
Ob&&(this.M6=Ob,this.fGj())}fGj(){this.ij.boe()}$Oa(){return this.ij.$Oa()}oFb(){return this.ij.oFb()}Nag(Ob){this.ij.Nag(Ob)}clearSearch(){this.ij.clearSearch()}get btj(){return 0<this.t2&&this.mG!==l.a.replaceAllInProgress&&this.mG!==l.a.replaceAllComplete}hho(Ob){let Vb="";Ob?Vb=0<this.t2?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.$Oa(),this.oFb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.$Oa(),this.oFb()):
Ob||0<this.t2&&(Vb=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.hag(Vb)}dispose(){this.ij.dispose()}HPc(){return this.ij.HPc()}Vlo(Ob,Vb=!0){Ob!==this.E4b&&(Ob===w.a.headings?(u.ULS.sendTraceTag(9056651,367,50,""),this.ij.rsj()):Ob===w.a.find?this.ij.isj():Ob===w.a.replace?this.ij.atj():Ob===w.a.intelligentPlaceholder&&(Vb||this.ij.Lmj(Vb),this.ij.Dsj()))}ZB(Ob,Vb=!0){this.ij.Lmj(Vb);Ob?(this.kyb||this.mAf(),this.ij.pP(),this.t2||this.mG===l.a.noMatchesFound?a.AFrameworkApplication.K&&
a.AFrameworkApplication.K.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.ij.D7(l.a.searchComplete):this.D7(l.a.initial)):this.ij.$na()}mAf(){this.kyb||(this.ij.initialize(),this.kyb=!0)}hag(Ob=""){var Vb=this.Tam();Vb&&(Ob=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Ob,Vb));this.Acb&&Vb&&this.Pja&&this.mG!==l.a.tooManyResults&&this.mG!==l.a.replaceAllInProgress&&(Vb=this.Acb.qHd(this.Pja),Ob=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
Ob,Vb.$Fd));(Vb=this.NWl())&&(Ob=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Ob,Vb));this.Wp&&Ob&&this.p8g!==Ob&&(this.p8g=Ob,this.Wp.sendNotification(Ob,!0))}Tam(){let Ob="";switch(this.mG){case l.a.startSearch:Ob=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case l.a.searchComplete:Ob=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.Zgd,this.t2);break;case l.a.tooManyResults:this.AFa&&(Ob=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,
this.Zgd,this.t2));break;case l.a.noMatchesFound:Ob=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case l.a.replaceAllInProgress:Ob=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case l.a.replaceAllComplete:Ob=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return Ob}NWl(){let Ob="";switch(this.mG){case l.a.initial:Ob=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,
this.qXl());break;case l.a.noMatchesFound:Ob=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;case l.a.replaceAllComplete:Ob=Ea.a.Gfi();break;case l.a.tooManyResults:Ob=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return Ob}qXl(){let Ob="";this.L6&&this.M6?Ob=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.L6?Ob=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,
WordEditorIntl.WordEditorStrings.l_MatchCase):this.M6&&(Ob=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return Ob}static getInstance(Ob){return dc.Rl(Ob)}static Rl(Ob){const Vb=hc.getInstance();return new dc(Vb,Ob,x.a.instance.resolve("Common.Utils.IAriaNotifier"),H.a.instance,new z.a(()=>y.FindManager.instance.kNb),n.App.xa.Hq)}static fLi(Ob,Vb=-1,ob=-1,Xb=-1){u.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:Ob,["SearchComplete.ResultsCount"]:Xb,
["SearchOpsCorrelation"]:dc.eij,["ActionId"]:dc.o2b.actionId,["SourceControlId"]:dc.o2b.THa,["IsNavPanOpenedAlready"]:dc.o2b.ZOm,["IsSearchFromNavPane"]:dc.o2b.ASm,["CurrentTab"]:Vb,["QueryLength"]:ob})}static YQk(Ob,Vb,ob){Vb=void 0!==Vb&&null!==Vb?void 0===Vb.SourceControlId||null===Vb.SourceControlId?"Unknown":Vb.SourceControlId:Ob===G.a.apb?"FindKeyboardShorcut":Ob===G.a.cpb?"ReplaceKeyboardShorcut":"Unknown";switch(Ob){case G.a.dkc:Ob="ShowHeadingsPane";break;case G.a.apb:Ob="ShowFindPane";break;
case G.a.cpb:Ob="ShowReplacePane";break;case G.a.gkc:Ob="ShowIntelligentPlaceholderPane";break;case G.a.A7a:Ob="ToggleNavigationPane";break;default:Ob="Unknown"}dc.o2b=new L(Ob,Vb,ob,!0)}}dc.vAj=100;dc.eij=null;dc.o2b=null;Object(F.a)(dc,"FindReplaceUIManager",null,[485,376,10])},1651:function(F,K,c){c.r(K);F=c(0);var l=c(171),f=c(100),a=c(79),k=c(2),x=c(22),y=c(66),n=c(1083),u=c(133),z=c(9),w=c(7),E=c(15),G=c(270),H=c(467),L=c(1547),I=c(1824),N=c(27),Q=c(331),M=c(11),J=c(443),V=c(17),X=c(262),W=
c(46),U=c(526),Y=c(1696);class ba{constructor(ab,Ea,Wa,Bb,Mb,Fb,vb){this.a8g=this.rbh=this.uWg=this.sI=this.V8a=this.pSb=this.BBe=this.vxe=this.dze=this.UV=this.Hea=this.Rea=null;this.Qne=()=>{const $a=this.Vsa.U7b(this.sI),kb=this.Vsa.EYl(this.sI);this.vxe.innerText=$a.toString();this.BBe.innerText=kb.toString();I.a.iOb(this.Rea,1===$a?!1:!0);I.a.iOb(this.Hea,$a===kb?!1:!0)};this.vjo=()=>{const $a=this.Ub.getRegion(G.a.C0a);let kb;if(this.UV&&!this.UV.disabled)kb=this.UV;else if(this.Rea.disabled){if(this.Hea.disabled)return;
kb=this.Hea}else kb=this.Rea;kb.focus();$a.fk.Ly(kb)};this.Rpa=($a,kb)=>{($a=kb.ol.kb)&&this.UV&&I.a.iOb(this.UV,V.SelectionEditor.Sl($a)?!0:!1)};this.d8e=()=>{if(!this.Hea.disabled){const $a=this.Vsa.Mjb(this.sI)?E.a.w5d:E.a.v5d;this.ga.processAction($a,2)}return!0};this.e8e=()=>{if(!this.Rea.disabled){const $a=this.Vsa.Mjb(this.sI)?E.a.y5d:E.a.x5d;this.ga.processAction($a,2)}return!0};this.c8e=()=>{this.UV&&!this.UV.disabled&&this.ga.processAction(E.a.OFi,2);return!0};this.Ub=ab;this.ga=Bb;this.ig=
Mb;this.ae=Fb;this.hb=vb;this.Vsa=Wa;this.M7=document.createElement("div");this.M7.classList.add("FootnoteEndnoteActionBarControl");this.M7.style.zIndex=String(X.a.YJd);this.M7.style.position="relative";this.ksc=document.createElement("div");this.ksc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.M7.appendChild(this.ksc);this.m9k();this.M7.appendChild(this.pSb);this.M7.appendChild(this.V8a);this.tZ=f.KeyInputManager.jc(a.a.A1,0);this.Uzm();this.Tzm()}rga(ab){w.ULS.shipAssertTag(4520065,
308,this.Vsa.xoa(ab));if(this.sI!==ab){this.sI=ab;this.Qne();ab=this.Vsa.Mjb(this.sI);this.Ial(ab);this.sI.Eqh(this.Qne);let Ea="",Wa="";const Bb=this.Vsa.U7b(this.sI);-1!==Bb&&(Ea=(Bb-1).toString(),Wa=(Bb+1).toString());ab?(this.Hea.title=this.Hea.disabled?WordEditorIntl.WordEditorStrings.L_NextFootnote:String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,Wa),this.Rea.title=this.Rea.disabled?WordEditorIntl.WordEditorStrings.L_PrevFootnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,
Ea)):(this.Hea.title=this.Hea.disabled?WordEditorIntl.WordEditorStrings.L_NextEndnote:String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,Wa),this.Rea.title=this.Rea.disabled?WordEditorIntl.WordEditorStrings.L_PrevEndnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,Ea));this.cHa()}}qCb(){this.sI&&(this.UV&&this.UV.parentNode===this.pSb&&this.pSb.removeChild(this.UV),this.Aja(),this.sI.k2n(this.Qne),this.sI=null)}dispose(){this.Ub.fe(G.a.C0a).jr(this.tZ)}Ial(ab){3===
this.ga.mode&&(ab=ab?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.UV=this.haf("FootnoteEndnoteFormattingOptionButton","FootnoteEndnoteActionBarFormattingButton",ab,null),N.a.hr(this.UV,N.a.yfa,ab),this.pSb.appendChild(this.UV))}m9k(){this.pSb=document.createElement("div");this.pSb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.V8a=document.createElement("div");this.V8a.classList.add("FootnoteEndnoteActionBarButtonHolder",
"FootnoteEndnoteActionBarRightDiv");this.Rea=this.haf("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");this.V8a.appendChild(this.Rea);this.vxe=J.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");this.V8a.appendChild(this.vxe);this.dze=J.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.dze.innerText=" / ";this.V8a.appendChild(this.dze);this.BBe=J.b("span","FootnoteEndnoteActionBarTotalCount",
"FootnoteEndnoteActionBar");this.V8a.appendChild(this.BBe);this.Hea=this.haf("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");this.V8a.appendChild(this.Hea)}haf(ab,Ea,Wa,Bb){ab=I.a.r_a(ab,Ea,Wa,Bb,void 0===Bb||null===Bb);ab.setAttribute(N.a.qh,N.a.j3);return ab}Uzm(){const ab=this.Ub.fe(G.a.C0a);ab.parent=u.AppFrame.rp;ab.bindAction(this.tZ,E.a.D3);ab.pfa(this.vjo)}Tzm(){var ab=new Q.DOMFocusListing(()=>this.M7);ab.Zpa=!1;ab.Wm(2);ab.Wm(1);ab=this.Ub.kAb(this.M7,
this.Ub.fe(G.a.C0a),ab);ab.vSa();ab.oR=!0}cHa(){this.UV&&(this.ig.nb(M.a.click,this.UV,this.c8e),this.uWg=this.ae.Anb(this.UV,this.c8e,a.a.Fs));this.ig.nb(M.a.click,this.Rea,this.e8e);this.rbh=this.ae.Anb(this.Rea,this.e8e,a.a.Fs);this.ig.nb(M.a.click,this.Hea,this.d8e);this.a8g=this.ae.Anb(this.Hea,this.d8e,a.a.Fs);this.hb.Pw(this.Rpa)}Aja(){this.UV&&(this.ig.sc(M.a.click,this.UV,this.c8e),this.ae.pqb(this.UV,this.uWg));this.ig.sc(M.a.click,this.Rea,this.e8e);this.ae.pqb(this.Rea,this.rbh);this.ig.sc(M.a.click,
this.Hea,this.d8e);this.ae.pqb(this.Hea,this.a8g);this.hb.CY(this.Rpa)}static zYl(){return ba.AYl()}static AYl(){return new ba(y.FocusManager.instance(),Y.a.instance,U.a.instance,k.AFrameworkApplication.va,z.App.xa.gD,z.App.xa.hD,W.a.instance)}}Object(F.a)(ba,"FootnoteEndnoteActionBarControl",null,[606]);var aa=c(228),fa=c(13),na=c(1602),oa=c(1786);class ja{constructor(ab,Ea,Wa,Bb,Mb,Fb,vb,$a,kb,Ua,Sa,xb){this.vE=null;this.zS=!1;this.Yv=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.bYb=
ab;this.E5b=Ea;this.yoc=Wa;this.bek=Bb;this.eMe=Mb;this.fm=Fb;this.gab=vb;this.ig=$a;this.$$g=kb;this.M1j=Sa;this.Er=this.bYb.ownerDocument.createElement("div");this.Er.id="FootnoteEndnoteControlOverlay";this.Er.className="EditingSurfaceOverlay";this.lI=this.VSl();this.V0(!1);this.bYb.appendChild(this.Er);this.bYb.appendChild(this.lI);this.E5b.bind();this.$h=null;this.ga=xb;this.vKa=Ua}Z6n(){const ab=this.$$g();ab&&ab.Wi&&(ab.dob=0,ab.iAd())}eFj(ab){if(this.fFc){const Ea=this.fFc.pna;Ea&&(Ea.JDf=
ab)}}get ax(){return this.zS}get fFc(){return this.vE}get dialog(){return this.$h}get wo(){return null!=this.EAg?this.EAg:this.EAg=x.a.instance.Sa("Common.IZoomManager")}Naf(){this.$h=oa.a.IYl()}w5c(){this.$h=null}show(ab=!0){this.zS||(this.eFj(!0),this.M1j(),this.V0(!0),this.Fz(),ab&&this.setFocus())}setFocus(){this.zS&&(this.E5b.setInitialSelection(),this.bek())}update(){this.zS&&(this.vE.isConnected?this.yoc.Qne():this.dismiss())}dismiss(ab=!1,Ea=!1){this.zS&&(this.eFj(!1),this.j$(),this.Z6n(),
this.V0(!1),this.eMe(Ea),this.$h&&(this.ga.processAction(fa.a.LJc,2),this.$h=null),!ab&&this.vE&&this.vE.isConnected&&this.vKa.pdo(this.vE),this.qCb())}J5n(ab){const Ea=null!==this.wo.instance?this.wo.instance.jj:1;this.lI.style.width=ab.lIh*Ea+"px";this.Yv.style.width=ab.QHc*Ea+"px";this.lI.style.marginLeft=ab.B3b*Ea+"px";this.fm?this.Yv.style.marginRight=ab.r$e*Ea+"px":this.Yv.style.marginLeft=ab.K3b*Ea+"px";if(ab=this.$$g())ab=ab.rL,this.lI.style.bottom=ab.offsetHeight-ab.clientHeight+"px"}rga(ab){w.ULS.shipAssertTag(4520073,
308,this.gab.xoa(ab));this.vE!==ab&&(this.vE=ab,this.E5b.rga(ab),this.yoc.rga(this.vE))}dispose(){this.dismiss();this.E5b.dispose();this.yoc.dispose()}Fz(){this.ig&&this.ig.nb(M.a.click,this.Er,this.onClick)}j$(){this.ig&&this.ig.sc(M.a.click,this.Er,this.onClick)}VSl(){let ab;ab=document.createElement("div");ab.classList.add("FootnoteEndnoteControl");this.Yv=document.createElement("div");this.Yv.classList.add("FootnoteEndnoteContent");this.Yv.appendChild(this.E5b.M7);this.Yv.appendChild(this.yoc.M7);
ab.appendChild(this.Yv);return ab}V0(ab){ab=(this.zS=ab)?"":"none";this.Er.style.display=ab;this.lI.style.display=ab}qCb(){this.vE&&(this.E5b.qCb(),this.yoc.qCb(),this.vE=null)}static pRd(){const ab=z.App.xa.ib.rc;return ab&&ab.Wi?ab:null}static DYl(ab,Ea,Wa,Bb,Mb){return new ja(ab,Ea,Wa,Bb,Mb,k.AFrameworkApplication.isRtl,U.a.instance,aa.a.instance,ja.pRd,na.a.instance,ja.upl,k.AFrameworkApplication.va)}static upl(){k.AFrameworkApplication.va.Qb(fa.a.Jib,2,!0)}}Object(F.a)(ja,"FootnoteEndnoteControl",
null,[605]);var qa=c(809),Ia=c(5),Va=c(204),Na=c(36),za=c(8),la=c(23),va=c(78),ia=c(1695),pa=c(347),sa=c(970),Ha=c(574),ra=c(1461),Ma=c(60),ya=c(111);class Ga extends pa.a{constructor(ab,Ea,Wa,Bb,Mb,Fb,vb,$a,kb,Ua,Sa,xb,Qb,Ib,$b,hc,pb){super(G.a.Aga,Wa,Bb,Mb,vb,$a,kb,Ua,Sa,xb,Qb,Ib,$b,hc,pb);this.qQg=ab;this.RXa=Fb;this.RXa.q$c=this;Ea(this);this.features.yhg=!0}get Sxi(){return!0}Vvf(){const ab=this.qQg.Vmf(this);return sa.ViewReference.eF(this,ab)}Bff(ab){Object(ya.a)(Ga,ab)||this.qQg.yff()}MPc(){return Ha.a.pPi}onResize(){super.onResize();
this.RXa.oXh()}ME(ab,Ea=null){super.ME(ab,Ea);this.RXa.aXh(this.Yc.qj)}detach(){this.RXa.nXh();super.detach()}tNd(){this.onResize()}static p_a(){const {FootnoteEndnoteControlManager:ab}=c(1651);return new Ga(ab.instance,ra.a.G9e,z.App.xa.ib,Ma.InteractiveViewManager.instance,()=>x.a.instance.resolve("Box4.IUndoManager"),x.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),k.AFrameworkApplication.va,x.a.instance.resolve("Box4.IHtmlViewRootFactory"),x.a.instance.resolve("Box4.IInteractiveEventNotifier"),
x.a.instance.Sa("Box4.ITextMetricsAdapter"),x.a.instance.resolve("Box4.IRotatingCoordinateConverter"),x.a.instance.Sa("Common.IZoomManager"),x.a.instance.Na("Box4.IContentControlViewElementManager"),x.a.instance.Na("Box4.CpConversionManagerImpl"),x.a.instance.Na("Box4.ContentControlConfigSettings"),x.a.instance.Na("Box4.IContentControlReader"),x.a.instance.Na("Box4.IContentControlBoundaryNavigator"))}}Object(F.a)(Ga,"FootnoteEndnoteEditView",pa.a,[]);class wa{constructor(ab,Ea,Wa,Bb=!1){this.Etb=
null;this.NFe=this.kNg=!1;this.WHl=()=>{const Mb=String.format("{0} {1}",this.NFe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.zu.sendNotification(Mb,!0)};this.Ub=ab;this.Vsa=Ea;this.sea=Wa();this.Wld=Bb;this.M7=document.createElement("div");this.M7.classList.add("FootnoteEndnoteEditControl");this.ksc=
document.createElement("div");this.ksc.classList.add("FootnoteEndnoteEditControlDividerElement");this.Nyb=(new qa.a(this.M7,"WACViewPanel_FootnoteEndnoteEditControl")).gI;this.M7.appendChild(this.ksc);this.M7.appendChild(this.Nyb)}get zu(){return null!=this.nwg?this.nwg:this.nwg=x.a.instance.resolve("Common.Utils.IAriaNotifier")}rga(ab){w.ULS.shipAssertTag(4520077,308,this.Vsa.xoa(ab));this.Etb!==ab&&(this.Etb=ab,this.Z2e(this.Etb),this.NFe=this.Vsa.Mjb(this.Etb),this.Wld?(this.sea.mOb(N.a.jBd),this.Ub.fe(G.a.Aga).m7(this.WHl)):
this.sea.rlj(this.NFe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,N.a.jBd))}qCb(){const ab=U.a.instance.Mjb(this.Etb)?"Footnote":"Endnote";w.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:ab,["CalloutHeight"]:this.M7.scrollHeight});this.Rfb();this.Etb=null}bind(){this.kNg||(this.sea.Xzb(this.Nyb),this.kNg=!0)}setInitialSelection(){const ab=this.Bcm();ab?this.sea.setSelection(ab):this.sea.H7c()}dispose(){this.Rfb()}Z2e(ab){this.Rfb();
this.sea.ME(ab,ab.qj)}Rfb(){this.sea.detach()}Bcm(){let ab=0;var Ea=null,Wa=Ia.GraphIterator.$a(this.Etb);Va.OutlineNavigator.h9(Wa);if((Wa=Na.OutlineElementNavigator.Ge(Wa))&&za.ParagraphReader.Wb(Wa)){if(Ea=wa.B1l(Wa)){ab=Ea.Ib.cp+1;Ea=ia.FootnoteEndnoteDefaultContentInserter.eQh;const Bb=Ea.length;ab+Bb<=za.ParagraphReader.textLength(Wa)&&Wa.characterData.substr(ab,Bb)===Ea&&(ab+=Bb)}Ea=la.SelectionFactory.pe(Wa,ab)}return Ea}static FYl(){return wa.GYl()}static GYl(){return new wa(y.FocusManager.instance(),
U.a.instance,()=>Ga.p_a(),k.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static B1l(ab){ab=va.i(ab,10);return 0<ab.length?ab[ab.length-1]:null}}Object(F.a)(wa,"FootnoteEndnoteEditControl",null,[602]);var hb=c(1177);class eb{constructor(ab,Ea){this.lBa=ab;this.fm=Ea}U8b(ab,Ea){ab=this.lBa.U8b(ab);var Wa=Ea.clientWidth;const Bb=Ea.scrollLeft,Mb=ab.lIh;let Fb=ab.B3b,vb=ab.B3b,$a=eb.wNf,kb=eb.xNf,Ua=Mb,Sa=ab.QHc;this.fm?kb=ab.r$e-vb:$a=ab.K3b-Fb;Wa<Mb&&(Fb=Math.max(Fb-
Bb,0),Ua=Wa-Fb,this.fm?(Wa=Ea.scrollWidth-Bb-Wa,vb=Ea.scrollWidth-ab.B3b-Mb,kb=Math.max(ab.r$e-Wa-vb,eb.xNf),Sa=Ua-kb-eb.wNf):($a=Math.max(ab.K3b-Bb-Fb,eb.wNf),Sa=Ua-$a-eb.xNf));return new hb.a(Fb,Ua,$a,kb,Sa)}}eb.wNf=25;eb.xNf=50;Object(F.a)(eb,"FootnoteEndnoteViewPositionProvider",null,[]);class jb{constructor(ab,Ea=0,Wa=0){this.clientWidth=ab;this.scrollLeft=Ea;this.scrollWidth=Wa?Wa:ab}}Object(F.a)(jb,"PageViewScrollContainerSizeInfo",null,[]);c.d(K,"FootnoteEndnoteControlManager",function(){return ub});
class ub{constructor(ab,Ea,Wa,Bb,Mb,Fb,vb,$a){this.qE=null;this.O9=()=>{this.fp.FI(G.a.Aga);this.fp.FI(G.a.C0a);this.fp.Xw(l.AFrame.Pn);this.Ub.CDc(G.a.Aga);this.Ub.mg(G.a.Aga)};this.Djo=kb=>{this.fp.Xw(G.a.Aga);this.fp.Xw(G.a.C0a);this.fp.FI(l.AFrame.Pn);this.Ub.lJc(G.a.Aga);(kb||this.Ub.currentScope&&(this.Ub.currentScope.name===G.a.Aga||this.Ub.currentScope.name===G.a.C0a))&&this.Ub.mg(l.AFrame.Pn)};this.Ub=ab;this.fp=Ea;this.T4j=Wa;this.U4j=Bb;this.S4j=Mb;this.lBa=Fb;this.gsa=vb;this.DZ=$a;this.tZ=
f.KeyInputManager.jc(a.a.A1,0);this.fAf();this.dT()}get control(){return this.qE}get dialog(){return this.control.dialog}get $vi(){return this.control.ax}Naf(){this.control.Naf()}w5c(){this.control.w5c()}bind(ab){this.Z4k(ab)}neg(ab){if(this.control.fFc!==ab.k_a)this.control.dismiss();else if(this.$vi)return;this.g5b();this.control.rga(ab.k_a);this.control.show(ab.oie)}g5b(){if(this.DZ){const ab=new n.a(!0);this.DZ.XGa(ab)}}FY(){this.control.setFocus()}fbd(){this.control.update()}yff(ab,Ea=!1){this.g5b();
this.control.dismiss(ab,Ea)}H5n(ab){const Ea=ub.pRd().rL;ab=this.lBa.U8b(ab,new jb(Ea.clientWidth,Ea.scrollLeft,Ea.scrollWidth));this.control.J5n(ab)}dispose(){this.control.dispose();this.Ub.fe(G.a.Aga).jr(this.tZ)}Vmf(ab){w.ULS.shipAssertTag(4520074,308,!!this.control);w.ULS.shipAssertTag(4520075,308,!!this.control.fFc);return this.Wmf(this.control.fFc.id,ab)}Z4k(ab){const Ea=this.U4j(),Wa=this.S4j();this.qE=this.T4j(ab,Ea,Wa,this.O9,this.Djo)}fAf(){const ab=this.Ub.fe(G.a.Aga);ab.parent=3===k.AFrameworkApplication.va.mode?
u.AppFrame.JD:u.AppFrame.hhc;this.Ub.sZe(G.a.Aga);ab.bindAction(this.tZ,E.a.D3)}dT(){this.fp.dT(G.a.Aga);this.fp.dT(G.a.C0a)}Wmf(ab,Ea){return()=>{const Wa=ub.pRd().Yc.Kc.Db(ab);this.gsa.c6b();if(!Wa.isConnected)return w.ULS.sendTraceTag(4520076,308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.neg(new H.a(Wa,!0));return Ea}}static Rl(){const ab=new eb(x.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),k.AFrameworkApplication.isRtl);return new ub(y.FocusManager.instance(),
z.App.xa.ox,ja.DYl,wa.FYl,ba.zYl,ab,L.a.instance,x.a.instance.resolve("Box4.IPasteFloatieEventSource"),x.a.instance.resolve("Common.IAppSettingsManager"))}static pRd(){const ab=z.App.xa.ib.rc;return ab&&ab.Wi?ab:null}static get instance(){return null!=ub.ICg?ub.ICg:ub.ICg=ub.Rl()}}Object(F.a)(ub,"FootnoteEndnoteControlManager",null,[576])},1673:function(F,K,c){c.d(K,"a",function(){return z});F=c(0);var l=c(7),f=c(55),a=c(171),k=c(2),x=c(11),y=c(160),n=c(128),u=c(22);class z{constructor(w,E){this.Vt=
null;this.Msd=!1;this.rbb=0;this.F3g="";this.Zue={};this.KKe=w;this.Ub=E;this.x9g=Object(f.a)(this,this.dVf,"onModalMouseWheel");this.B2g=!!k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Nb.Noa;this.Lw=!!k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Nb.yJ}onMenuOpen(){0<this.rbb?this.rbb++:(this.rbb++,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(f.a)(this,
this.r5i,"pushTransientFocusScope"),0)}):this.r5i(),this.showModal())}r5i(){this.Ub&&this.Ub.pL(a.AFrame.Vpa,!0)}NPl(){const w=n.f(),E=appChrome.selectors.getShyState();return String.format("{0}{1}",w,this.B2g&&E.isActive&&1===E.state?"_ShyRibbon":"")}qhm(w){var E=0;if(this.Lw){if(this.Zue[w])return this.Zue[w];(E=document.getElementById("BusinessBar"))||l.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");E=E?E.offsetTop:0;this.Zue[w]=
E}return E}showModal(){if(!this.Vt)if(this.Vt=this.createElement("div"),this.Vt.setAttribute("id","ReactModalDiv"),this.Vt.style.position="absolute",this.Vt.style.bottom="0px",this.Vt.style.left="0px",this.Vt.style.right="0px",this.Vt.style.backgroundColor="white",this.Vt.style.opacity="0.0",this.Lw){var w=document.getElementById("regionComposerRoot");w&&w.appendChild(this.Vt)}else this.KKe.appendChild(this.Vt);w=this.NPl();if(w!==this.F3g){const E=this.qhm(w),G=appChrome.selectors.getShyState();
this.B2g&&G.isActive&&1===G.state&&n.a("getRibbonHeight")?this.Vt.style.top=String.format("{0}px",E+appChrome.api.getRibbonHeight(n.f())):this.Vt.style.top=String.format("{0}px",E);this.F3g=w}this.Vt.style.display="block";this.Vt.style.visibility="visible";this.Vt.style.zIndex="1000";this.Msd||(window.addEventListener("wheel",this.x9g,!0),this.TZd()?y.a.instance.nb(x.a.WM,this.Vt,Object(f.a)(this,this.N7d,"onModalPointerUp")):y.a.instance.nb(x.a.pointerDown,this.Vt,Object(f.a)(this,this.M7d,"onModalPointerDown")),
this.Msd=!0)}onMenuClose(){this.rbb--;0<this.rbb||(0>this.rbb?this.rbb=0:this.noi())}tTf(){this.rbb=0;this.$Jc();this.noi()}createElement(w){w=document.createElement(w);w.setAttribute("unselectable","on");return w}moi(){this.Ub&&this.Ub.currentScope&&this.Ub.currentScope.name===a.AFrame.Vpa&&!k.AFrameworkApplication.nc.Nv&&this.Ub.CR(a.AFrame.Vpa,!1);this.Vt&&(this.Vt.style.zIndex="-1",this.Vt.style.visibility="hidden",this.Vt.style.display="none");this.Msd&&(window.removeEventListener("wheel",this.x9g,
!0),this.TZd()?y.a.instance.sc(x.a.WM,this.Vt,Object(f.a)(this,this.N7d,"onModalPointerUp")):y.a.instance.sc(x.a.pointerDown,this.Vt,Object(f.a)(this,this.M7d,"onModalPointerDown")),this.Msd=!1)}noi(){this.TZd()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.moi()},0)}):this.moi()}M7d(){this.f5b();this.KSh();this.tTf();this.y6a();return!0}N7d(){this.f5b();this.KSh();this.tTf();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.y6a()},0)});return!0}y6a(){4===k.AFrameworkApplication.ta.Nb.Tl&&
k.AFrameworkApplication.K.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?k.AFrameworkApplication.ta.y6a():this.Ub.mg(a.AFrame.Pn)}dVf(w){w.stopPropagation()}f5b(){const w=u.a.instance.Na("Common.IReactContextualUILauncher");w&&w.f5b()}$Jc(){const w=u.a.instance.Na("Common.IReactContextualUILauncher");w&&w.$Jc()}KSh(){k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Nb.yQa&&(this.TZd()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}TZd(){return k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",
!1)}}Object(F.a)(z,"ReactModalDiv",null,[])},1678:function(F,K,c){c.d(K,"a",function(){return f});c.d(K,"b",function(){return a});c.d(K,"c",function(){return k});var l=c(2);const f=(x,y)=>{const n=RegExp("mailto:(.*)").exec(x.url);y.email=n&&2===n.length?n[1]:x.url;y.resolveState=x.hw.charAt(35)===c(1774).ACommentFormatTranslator.xIk?1:0},a=(x,y)=>{y.contentId=x.hw},k=(x,y,n)=>{y.contentId=x.hw;y.isCurrentUser=n.email===l.AFrameworkApplication.K.jb("UserPrincipalName")}},1679:function(F,K,c){c.d(K,
"a",function(){return a});F=c(0);var l=c(1040),f=c(6);class a{constructor(k,x){this.yN=this.iyc=null;this.fb=k;this.L9a=x}get key(){return"COMMENT"}get Uw(){return WordEditorIntl.WordEditorStrings.L_Comment}get z3(){return this.yN}reset(k){this.yN=k.node}xIa(k){let x=null;if(this.iyc&&this.fwi(k,this.z3,this.iyc))return x=Object.assign(new l.a,{MG:this.key,contentObject:this.iyc}),{returnValue:!0,WF:x};this.iyc=null;const y=this.L9a.gbf(this.z3);if(this.L9a.oCf(y)){let n=y.Pd();for(;n;){if(this.fwi(k,
this.z3,n))return this.iyc=n,x=Object.assign(new l.a,{MG:this.key,contentObject:n,description:this.Bhb()}),{returnValue:!0,WF:x};n=y.Lj()}}return{returnValue:!1,WF:x}}fwi(k,x,y){if(this.prj(y))return!1;const n=this.L9a.Y8b(y,!0),u=this.L9a.Y8b(y,!1);return n&&u&&this.fb.rVc(x,n,u)&&(x=this.L9a.Dva(n,y.id,!0))&&(n!==this.z3||x.Ib.cp<=k)&&(y=this.L9a.Dva(u,y.id,!1))&&(u!==this.z3||y.Ib.cp>k||y.Ib.cp>=k)?!0:!1}prj(k){return k.ia(f.a.EG,!1)}Bhb(){return null}}Object(F.a)(a,"CommentDetailsProvider",null,
[670,671])},1685:function(F,K,c){c.d(K,"a",function(){return f});F=c(0);K=c(151);var l=c(102);class f extends K.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new l.a,{T_:f.getTypeName(),B_:f.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(F.a)(f,"DocumentTypeClassifierAnnotation",K.a,[])},1689:function(F,K,c){c.d(K,"a",function(){return z});
F=c(0);var l=c(2),f=c(352),a=c(83),k=c(7),x=c(55),y=c(84),n=c(61),u=c(338);class z{constructor(w,E,G,H,L,I){this.KNe=null;this.kbh=0;this.N2=!1;this.ud=H;this.Te=E;this.c6=L;this.KDe=G;this.gqc=l.AFrameworkApplication.aeg();this.Lve=w.appSettings.ChromeClipboardAccessOperationTimeout;this.oI=0;this.LZj=I;this.c3j=w.$("EnableExternalPasteSupportOnMobileIsEnabled");this.pg=f.a.getInstance(u.a.NZa);this.N2=w.$("ShouldLogCcpExtendedHealthKpis")}get YRa(){return this.c6.YRa}process(w,E){if(!this.oI)return this.tCn(E);
if(1===this.oI)return this.prepareForPaste(w,E);if(2===this.oI)return this.oI=3,this.KNe(w,E);3===this.oI&&this.c6.znj(w,E);return!1}tCn(w){let E=!0;this.c3j&&(E=!(w.yx&1));this.Te.m4&&E||w.yx&512?(this.KNe=w.yx&2?Object(x.a)(this.c6,this.c6.paste,"paste"):Object(x.a)(this.c6,this.c6.Z0i,"pasteInternal"),this.oI=2):(this.gqc?(this.oI=1,this.kbh=Date.now()):this.oI=2,this.KNe=Object(x.a)(this.c6,this.c6.paste,"paste"));u.a.H6m(w);return!0}prepareForPaste(w,E){w=!0;if(this.KDe.value.n3i())this.oI=2;
else{const G=Date.now()-this.kbh;G>this.Lve&&(k.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",G),this.ud.Yb(y.a.kna,{["Reason"]:n.a.KZi}),E.yR&&(E.yR.fail("Prepare for paste timed out",!1),this.N2?this.pg.logKpiFailure({kpiName:u.a.lNa,errorName:"PreparePasteTimedOut",optionalVeto:{name:u.a.Zmb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):a.Health.instance.recordQosError("PreparePasteTimedOut",[u.a.Zmb],!1,!0,!0,!1,null)),E.failed=!0,w=!1,this.LZj.p7n())}return w}}
Object(F.a)(z,"ClipboardOperationPasteProcessor",null,[770])},1690:function(F,K,c){c.d(K,"a",function(){return W});F=c(0);K=c(292);var l=c(352),f=c(83),a=c(2),k=c(44),x=c(153),y=c(7),n=c(111),u=c(67),z=c(1446),w=c(55),E=c(86),G=c(3),H=c(84),L=c(61),I=c(1085),N=c(17),Q=c(46),M=c(1620),J=c(1691),V=c(338),X=c(115);class W extends K.a{constructor(U,Y,ba,aa,fa,na,oa,ja,qa,Ia,Va,Na,za,la,va,ia,pa,sa,Ha,ra,Ma,ya,Ga,wa,hb,eb,jb,ub=!0){super();this.$ja=this.fw=null;this.HL=this.cA=0;this.Ycb=this.LRe=this.caa=
this.mh=null;this.F6=!1;this.NS=!0;this.cYg=!1;this.init(U);this.Jl("ClipboardOperation");this.ejb(qa,Y,fa,na,oa);this.ud=Ia;this.Ie=Va;this.Te=Na;this.Ic=za;this.iPg=la;this.kPg=va;this.jPg=ia;this.Yve=pa;this.wTb=sa;this.Zve=Ha;this.gqc=ja;this.Upc=ra;this.pMa=Ma;this.Iok=ub;this.xD=ya;this.Sd=Ga;this.Im=wa;this.DZ=hb;this._context=aa;this.efa=eb;this.AZb=jb;this.pg=l.a.getInstance(V.a.NZa);oa&&Object(n.a)(101,oa)&&(this.caa=Object(u.a)(775,oa.ia(x.a.kua,null)));this.caa||(this.caa=this.efa.A9c());
this.nrb=void 0===ba||null===ba?"NotAvailable":Object(z.a)(J.a,ba);this.caa.qEk(this.nrb.split(", "));U=this._context;if(this.AZb){if(!W.bBh(U,this.Yve,this.ud,this.caa,ub)){this.pr=8;this.finish();return}this.mh=U.view;this.F6=3===this.mh.IIb;this.cA=0;this.HL=ba;this.Ycb=pa.YRa}else{if(!U.view.te){this.ud.Yb(H.a.kf,{["Reason"]:L.a.iKb});this.caa.fail("Not in interactive view",!0);this.pr=8;this.finish();return}this.mh=U.view;if(!this.mh.lb){this.ud.Yb(H.a.kf,{["Reason"]:L.a.noSelection});this.caa.fail("No selection manager",
!0);this.pr=8;this.finish();return}this.F6=3===this.mh.IIb;this.cA=0;this.HL=ba;this.Ycb=pa.YRa;if(ub&&!(this.Ycb&&this.Ycb.kb&&this.Ycb.length)){this.ud.Yb(H.a.kf,{["Reason"]:L.a.noSelection});this.caa.fail("No selection when one required",!0);this.pr=8;this.finish();return}}pa=N.SelectionEditor.Sl(this.Ycb.kb);pa=!(this.HL&16&&pa);pa=Ha.bIm(ba,this.tg)&&pa;1!==this.behavior&&pa||(pa||this.caa.fail("Clipboard operation disabled for selection",!0),this.pr=pa?32:8,this.tqa());!this.cYg&&this.Te.ti&&
(k.b("IPadCCP"),this.cYg=!0)}get tg(){this.LRe||(this.LRe=Q.a.i2b(this.Ycb));return this.LRe}Yca(){super.Yca();this.Ycb=null}run(){this.cA||this.setup();1===this.cA&&this.process();2===this.cA&&this.teardownSync();3===this.cA&&this.teardownAsync();4===this.cA&&this.finish()}setup(){if(this.HL&256&&this.gqc){this.vC||this.wTb.AXk(this,this.HL,this.nrb);this.vC.run();if(this.vC.inProgress)return;this.NS=this.vC.ypa;this.SDd();if(!this.NS){this.caa.fail("No access to system clipboard",!0);this.pr=8;
this.cA=4;this.$2d();return}}else y.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.HL,this.nrb,this.Te.eG,this.actionId);this.HL&32&&!this.Ie.JYd(this.mh.lb.tg)?(y.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.ud.Yb(H.a.kf,{["Reason"]:L.a.adf}),this.caa.fail("Cut not allowed",!0),this.Upc.show(),this.pr=8,this.cA=4):(this.HL&16||this.HL&32)&&E.a.instance.J(1)&&this.xD.K_d(this.mh.lb.gb.kb)?(this.caa.fail("Selected content deleted in coauthoring",
!0),this.Sd.lPb(),this.pr=8,this.cA=4):(this.HL&4096&&(this.DZ.dhc(Object.assign(new I.a,{rUc:!0,yY:this.nrb})),this.Im.undo()),this.Zve.bHn(this.HL),this.mh.Yc?(this.fw=this.Ic.Oc(15),this.fw.jk=this.actionId,this.fw.Cb(this.mh.Yc),this.cA=1):(this.caa.fail("Interactive view has null target node",!0),this.pr=8,this.cA=4))}process(){if(!this.vC){y.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.HL,this.nrb,this.Te.eG);y.ULS.shipAssertTag(6305507,307,!this.$ja);
this.$ja=new M.a(this._context,this.HL,this.caa,this.I9,this.GL,void 0,this.Te.eG,this.Iok,this.F6);let U;U=this.HL&65536?Object(w.a)(this.iPg,this.iPg.process,"process"):this.HL&64?Object(w.a)(this.kPg,this.kPg.process,"process"):this.HL&1?Object(w.a)(this.Yve,this.Yve.process,"process"):Object(w.a)(this.jPg,this.jPg.process,"process");this.HL&16&&this.mh.lb.Wya.c2h();this.pMa.create(this,U,this.$ja).Jl("ClipboardAction")}y.ULS.shipAssertTag(6305536,307,!!this.vC);this.vC.run();this.vC.inProgress||
(this.SDd(),this.cA=this.Gh?2:3)}teardownSync(){this.$ja.vbc&&(this.fw.jk=G.a.typing);this.$ja.LUc&&this.fw.ZFa(this.$ja.Ezf,this.$ja.aSf);this.fw.dispose();this.pr=this.$ja.failed?8:32;this.cA=4}teardownAsync(){if(this.vC){if(this.vC.run(),this.vC.inProgress)return}else if(this.$ja.vbc&&(this.fw.jk=G.a.typing),this.fw.zHa(this),this.$ja.LUc&&this.fw.ZFa(this.$ja.Ezf,this.$ja.aSf),this.fw.dispose(),this.MYe)return;this.pr=this.$ja.failed?8:32;this.cA=4}finish(){this.DZ.dhc(Object.assign(new I.a,{rUc:!1}));
this.tqa();32===this.response?y.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.HL,this.nrb,this.Te.eG):y.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.HL,this.nrb,this.Te.eG);this.efa.pga(this.caa);(W.IRn||W.ydg)&&this.Z2m()}$2d(){const U=!!(this.HL&1),Y=this._context.view;Y&&V.a.$2d(U,Y.lb,this.Te.eG)}Z2m(){if(!(this.HL&4||
this.HL&64)){var U=new Map;U.set("isCopy",String.format("{0}",!!(this.HL&16)));U.set("isIPad",String.format("{0}",this.Te.ti));W.ydg?(U.set("SkipAria","false"),U.set("ErrorLevel","info"),this.pg.logKpiUsage({kpiName:V.a.iDd,kpiType:0,optionalProperties:{extendedProperties:U},blockFutureEmissionDurationInMs:0})):f.Health.instance.recordKpiUsage(V.a.iDd,0,V.a.jDd,U);this.NS||(W.ydg?(U.set("SkipAria","false"),U.set("ErrorLevel","info"),this.pg.logKpiFailure({kpiName:V.a.iDd,errorName:V.a.hCh,optionalProperties:{isIntentional:!0,
isInternal:!0,additionalValues:{extendedProperties:U}},blockFutureEmissionDurationInMs:0})):(U=Object.assign(new X.a,{extendedProperties:U}),f.Health.instance.recordKpiFailure(V.a.iDd,V.a.hCh,!0,!0,U)))}}static get IRn(){null==W.CPe&&(W.CPe=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("RecordCcpErrorDialogKpiIsEnabled"));return W.CPe}static get ydg(){null==W.N2&&(W.N2=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis"));return W.N2}static v3f(U,Y,
ba,aa){U&&U.Yb(H.a.kf,{["Reason"]:ba});Y&&Y.fail(aa,!0)}static bBh(U,Y,ba=null,aa=null,fa=!0){return U.view.te?U.view.lb?!fa||Y.YRa&&Y.YRa.kb&&Y.YRa.length?!0:(W.v3f(ba,aa,L.a.noSelection,"Paste target is invalid"),!1):(W.v3f(ba,aa,L.a.noSelection,"No selection manager"),!1):(W.v3f(ba,aa,L.a.iKb,"Not in interactive view"),!1)}}W.CPe=null;W.N2=null;Object(F.a)(W,"ClipboardOperation",K.a,[])},1691:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);var l;(function(f){f[f.paste=1]="paste";f[f.textOnly=
2]="textOnly";f[f.overtype=4]="overtype";f[f.copy=16]="copy";f[f.deleteSelection=32]="deleteSelection";f[f.move=64]="move";f[f.useSystemClipboard=256]="useSystemClipboard";f[f.forceInternalClipboard=512]="forceInternalClipboard";f[f.reformatPastedContent=4096]="reformatPastedContent";f[f.pasteAsPlainText=8192]="pasteAsPlainText";f[f.showPlaceholderGlossary=65536]="showPlaceholderGlossary";f[f.reformatPastedContentWithDesignerPaste=131072]="reformatPastedContentWithDesignerPaste";f[f.noSpacesAdjustment=
262144]="noSpacesAdjustment"})(l||(l={}));Object(F.b)("ClipboardActionFlags",l)},1694:function(F,K,c){var l=this&&this.gC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.Oz:n.writable||n.configurable))n={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,
x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1853),K);f(c(1854),K)},1695:function(F,K,c){c.r(K);c.d(K,"FootnoteEndnoteDefaultContentInserter",function(){return H});F=c(0);var l=c(22),f=c(58),a=c(2),k=c(36),x=c(536),y=c(28),n=c(6),u=c(16),z=c(55),w=c(1186),E=c(877),G=c(1622);class H{constructor(L,I,N,Q,M=null){this.Wc=L;this.DZj=I;this.fm=N;H.nh=Q;this.OQg=M||H.Ebl}get nL(){return null!=this.IEg?this.IEg:this.IEg=l.a.instance.resolve("Box4.IOutlineEditor")}M$k(L,I){var N=this.Wc.Bk();
N.set(L);this.nL.kjb(N,null,!0);H.nh.AOb(N.currentNode,this.fm);L=k.OutlineElementNavigator.Ge(N);H.y5.M7c(I?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,L);N=this.OQg(N.currentNode);H.characterPropertiesEditor.replaceTextRange(N,H.eQh);this.UCm(L,I)}UCm(L,I){var N=this.DZj(131073);N.setValue(n.a.jt,1===I?36:35);N.setValue(n.a.jma,!0);N.setValue(u.a.g$,!0);const Q=L.Kc.Pu(N,f.a.create());N=this.OQg(L);H.characterPropertiesEditor.gha(N,M=>E.a.getInstance(M,
Q,!0),G.a.Z5h(L,I))}static Rl(){return new H(new x.a,Object(z.a)(w.a.instance,w.a.instance.createInstance,"createInstance"),a.AFrameworkApplication.isRtl,l.a.instance.resolve("Box4.IOutlineElementEditor"))}static get y5(){return null!=H.gHg?H.gHg:H.gHg=l.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get characterPropertiesEditor(){return null!=H.Xwg?H.Xwg:H.Xwg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get instance(){return null!=H.XCg?H.XCg:H.XCg=H.Rl()}static Ebl(L){return y.a.Qc(L,
0)}}H.eQh=" ";H.nh=null;Object(F.a)(H,"FootnoteEndnoteDefaultContentInserter",null,[638])},1696:function(F,K,c){c.d(K,"a",function(){return x});F=c(0);var l=c(536),f=c(526),a=c(1547),k=c(1622);class x{constructor(y,n){this.gsa=n}ATd(y,n,u){return(y=this.gsa.rci(y.node,u?y.cpBegin:y.cpEnd,n))?y.W3():null}Zki(y,n){return(y=this.gsa.W9l(y.node,y.cpBegin,n))?y.W3():null}static xOc(){return new x(f.a.instance,a.a.instance,new l.a,k.a.instance)}static get instance(){return null!=x.tCg?x.tCg:x.tCg=x.xOc()}}
Object(F.a)(x,"FootnoteEndnoteNavigator",null,[600])},1708:function(F,K,c){c.d(K,"a",function(){return x});F=c(0);var l=c(1767),f=c(2),a=c(50),k=c(22);class x{constructor(y,n,u,z,w,E){this.Hsa=y;this.Isa=n;this.NDe=u;this.aZ=z;this.Ihd=w;this.OSb=E}get ssj(){return!this.Isa&&!this.NDe}get KSi(){return 2===this.OSb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get JXh(){return CommonUIStrings.l_OICErrorMessageNoOffice}get mpi(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get Gib(){return CommonUIStrings.l_OICErrorHelpLink}get $ni(){return"OICFailure"}get icon(){return 3}get Hyd(){return 2===
this.OSb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}wQn(y){this.VSi(y)}i_m(y){this.VSi(y)}VSi(y){let n=10;1===y?(k.a.instance.resolve("Common.IOfficeTrialExperience").XIf(this.OSb),n=3):2===y&&((!this.NDe||this.NDe(this.aZ))&&this.Isa&&l.a.instance.Scl(this.Isa,this.Hsa,this.aZ),n=5);(0===y||1===y)&&this.Hsa&&this.Hsa(this.aZ);f.AFrameworkApplication.l5c(a.a.yZi,this.Ihd,n);this.dispose()}dispose(){this.aZ=
this.Isa=this.Hsa=null}}Object(F.a)(x,"AOICErrorDialogWithTrial",null,[10])},1765:function(F,K,c){F=c(0);var l=c(2),f=c(20),a=c(22),k=c(741),x=c(1552),y=c(34);class n{constructor(ra,Ma=null){this.wck=ra;this.Y2=Ma||x.a.Cqf(f.a.eAb,"")}get By(){return this.wck}get Gc(){return this.Y2}jbg(ra){this.Gc.d++;return this.By.jbg(ra)}zjc(ra){this.Gc.e++;return this.By.zjc(ra)}sL(ra){this.Gc.f++;return this.By.sL(ra)}xob(ra){this.Gc.h++;return this.By.xob(ra)}m5(ra){this.Gc.i++;return this.By.m5(ra)}Yia(ra){this.Gc.j++;
return this.By.Yia(ra)}GHa(ra){this.Gc.k++;return this.By.GHa(ra)}vqa(ra){this.Gc.l++;return this.By.vqa(ra)}Tge(ra){this.Gc.m++;return this.By.Tge(ra)}cTa(ra,Ma=!1){this.Gc.n++;return this.By.cTa(ra,Ma)}Cwf(){this.Gc.o++;return this.By.Cwf()}ifg(){this.Gc.p++;return this.By.ifg()}Uv(ra){this.Gc.q++;return this.By.Uv(ra)}Dya(ra){this.Gc.r++;return this.By.Dya(ra)}njc(ra){this.Gc.g++;return this.By.njc(ra)}O7c(ra){return this.By.O7c(ra)}Bob(ra){this.Gc.s++;return this.By.Bob(ra)}Che(ra){this.Gc.s++;
return this.By.Che(ra)}Sbf(ra){this.Gc.ba++;return this.By.Sbf(ra)}yge(ra){this.Gc.s++;return this.By.yge(ra)}zob(ra){this.Gc.s++;return this.By.zob(ra)}HOb(ra){this.Gc.t++;return this.By.HOb(ra)}Rhe(ra){this.Gc.u++;return this.By.Rhe(ra)}Via(ra){this.Gc.v++;return this.By.Via(ra)}$bg(ra){this.Gc.bb++;return this.By.$bg(ra)}S9(ra){return this.By.S9(ra)}N9(ra){this.Gc.z++;return this.By.N9(ra)}E7f(){return this.By.E7f()}pda(ra,Ma){this.Gc.w++;this.Gc.x++;return this.By.pda(ra,Ma)}eD(ra){this.Gc.y++;
return this.By.eD(ra)}clearFormatting(){return this.By.clearFormatting()}clone(){return new n(this.By.clone(),this.Gc)}}Object(F.a)(n,"FormattingStewardUsageCollector",null,[275]);class u extends n{constructor(ra,Ma=null){super(ra,Ma)}get j9(){return this.By}get vw(){return this.j9.vw}set vw(ra){this.j9.vw=ra}get textIndent(){return this.j9.textIndent}get marginLeft(){return this.j9.marginLeft}get Zkc(){return this.j9.Zkc}get BR(){return this.j9.BR}get lineSpacing(){return this.j9.lineSpacing}get t5(){return this.j9.t5}get leftIndent(){return this.j9.leftIndent}get Rca(){return this.j9.Rca}get paragraph(){return this.j9.paragraph}set paragraph(ra){this.j9.paragraph=
ra}get OQ(){return this.j9.OQ}get ilc(){return this.j9.ilc}Wme(ra){return this.j9.Wme(ra)}Wkg(ra){return this.j9.Wkg(ra)}clone(){const ra=this.By.clone();return new u(ra,this.Gc)}}Object(F.a)(u,"FormattingStewardUsageCollector",n,[816,275]);var z=c(8),w=c(374),E=c(859),G=c(36),H=c(204),L=c(81),I=c(40),N=c(58),Q=c(353),M=c(135),J=c(19),V=c(83),X=c(53),W=c(16),U=c(6),Y=c(42),ba=c(115),aa=c(583),fa=c(354),na=c(138),oa=c(56),ja=c(101),qa=c(182),Ia=c(1614),Va=c(147),Na=c(28),za=c(1402),la=c(876);class va{constructor(ra,
Ma,ya,Ga,wa,hb,eb,jb,ub,ab,Ea=null){var Wa;this.oE=this._paragraph=null;this.grd=0;this.AOg=this.hrd=null;this.Y$=0;this.wwb=this.ilc=this.leftIndent=this.t5=this.Hwc=this.BR=this._tabStops=this._marginLeft=this._textIndent=null;this.paragraph=ra;this.Ce=Ma;this.Vu=ya;this.Xy=Ga;this.oK=wa;this.xVb=hb;this.yka=eb;this.fUb=jb;this.WVa=ub;this.Ctb=ab;Ea?(y.a(4223818,307,!!Ea.oE),this.oE=Ea.oE.pma(this.paragraph),this.grd=Ea.Yfc,this.hrd=Ea.oYf,Ea.BR&&(this.BR=new za.a,this.BR.afterSpacing.value=Ea.BR.afterSpacing.value,
this.BR.beforeSpacing.value=Ea.BR.beforeSpacing.value,null===(Wa=l.AFrameworkApplication.K)||void 0===Wa?0:Wa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(this.BR.afterSpacing.unit=Ea.BR.afterSpacing.unit,this.BR.beforeSpacing.unit=Ea.BR.beforeSpacing.unit),Ea.lineSpacing&&(this.Hwc=Ea.lineSpacing.clone()),this.Y$=Ea.Y$,this.ilc=Ea.ilc.clone(),this._textIndent=Ea.textIndent,this._marginLeft=Ea.marginLeft,this._tabStops=Ea.Zkc,this.t5=Ea.t5,this.leftIndent=
Ea.leftIndent,Ea.Rca&&(this.wwb=Ea.Rca)):(this.oE=new qa.a(this.paragraph,0),this.oE.formatting=new Va.a(this.oE,N.a.nil),Ma=Na.a.mw(ra),Ma=this.oK.Nr(Ma),this.zio(Ma),this.Vvo(ra)?(this.xVb.Ujo(this.oE.formatting,Ma),ra.hasProperty(W.a.Hh)?this.Y$=ra.getValue(W.a.Hh):this.Y$=0):this.Y$=-1,this.grd=0,this.BR=this.hrd=null,this.Ctb&&(this.BR=this.xVb.yEa(ra),this.Hwc=this.xVb.TEb(ra),this.t5=this.xVb.X8b(ra),this.leftIndent=this.xVb.XT(ra)),this.ilc=new Q.DictionaryPropertySet)}get paragraph(){return this._paragraph}set paragraph(ra){y.a(4223816,
307,!!ra&&z.ParagraphReader.Wb(ra));this._paragraph=ra}get OQ(){return this.oE.formatting}get Yfc(){return this.grd}get oYf(){return this.hrd}get kw(){return this.AOg}get vw(){return this.Y$}set vw(ra){y.a(4223817,307,1===ra||2===ra||3===ra||6===ra);this.Y$=ra}get textIndent(){return this._textIndent}get marginLeft(){return this._marginLeft}get Zkc(){return this._tabStops}get lineSpacing(){return this.Hwc}get Rca(){return this.wwb}get uc(){return this.Xy}zio(ra){const Ma=this.oK.language(ra);Ma&&
this.Ce.kbg(this.oE.formatting,Ma,0,ra.cache.KHb,!1)}Vvo(ra){ra=this.uc.kg(this.uc.No(ra));return ra===oa.StyleReader.Acd||ra===oa.StyleReader.wordStyleIdNormal||ra===oa.StyleReader.ORb||ra===oa.StyleReader.styleIdNormal}jbg(ra){(ra=k.a.sg(ra))&&this.Ce.ihe(this.oE.formatting,ra.LCID);return!0}zjc(){return!1}sL(ra){this.Ce.sL(this.oE.formatting,ra);return!0}xob(ra){this.Ce.setItalic(this.oE.formatting,ra);return!0}m5(ra){this.Ce.m5(this.oE.formatting,ra);return!0}Yia(ra){this.Ce.Yia(this.oE.formatting,
ra);return!0}GHa(ra){this.Ce.GHa(this.oE.formatting,ra);return!0}vqa(ra){this.Ce.vqa(this.oE.formatting,ra);return!0}Tge(ra){if(0>=ra)return!1;this.Ce.UA(this.oE.formatting,ra);return!0}cTa(ra,Ma){if(!ra||""===ra)return!1;if(({y1h:ya}=M.FontUtils.CDj(ra)).returnValue)return this.Ce.Uia(this.oE.formatting,ya.fontName),!0;var ya=!1;const Ga=M.FontUtils.yRa(ra);Ma&&this.tkb(Ga,this.yka)&&(this.yka.Ema(ra),ya=!0);if(this.tkb(Ga,this.fUb)||this.tkb(Ga,this.WVa))ya=!0;ya&&this.Ce.Uia(this.oE.formatting,
Ga);return ya}tkb(ra,Ma){return!!Ma&&Ma.isEnabled&&Ma.tkb(ra)}Cwf(){this.Ce.wli(this.oE.formatting);return!0}ifg(){this.Ce.utj(this.oE.formatting);return!0}Uv(ra){var {Box4PasteSteward:Ma}=c(1518);if(null===ra||""===ra)return!1;ra=Ma.nBb(ra);Ma=null;this.Rca&&this.Rca.hasOwnProperty(U.a.listLevel.id.toString())&&(Ma=this.Rca[U.a.listLevel.id.toString()]);this.Ce.Uv(this.oE.formatting,ra,Ma);return!0}Dya(ra){const {Box4PasteSteward:Ma}=c(1518);if(!ra||""===ra||!va.hlm().contains(ra))return!1;this.Ce.Dya(this.oE.formatting,
Ma.nBb(ra));return!0}njc(ra){this.Ce.njc(this.oE.formatting,ra);return!0}O7c(ra){let Ma=0;switch(J.a.Ug(ra)){case "small-caps":Ma=1;break;case "uppercase":Ma=2}this.Ce.Xl(this.oE.formatting,Y.a.capitalization,Ma);return!0}N9(ra){const {Box4PasteSteward:Ma}=c(1518);if(!ra||""===ra)return!1;this.ilc.setValue(W.a.wH,parseInt(Ma.nBb(ra),16));return!0}zob(ra){return 0>=ra?!1:this.Che(this.uc.xhi(ra))}Bob(ra){this.clearFormatting();this.grd=ra;return!0}Sbf(ra){var {Box4PasteSteward:Ma}=c(1518),ya=new Map;
ya.set("Source","CreateStyleCCP_FormattingSteward");V.Health.instance.recordKpiUsage(na.a.GLj,0,na.a.tB,ya);ya=ja.a.Cem(ra);ra=[];ra.push(ya);(ra=ja.a.RDc(ra,this.paragraph))?(Ma.Ukc=this.uc.Qr(),y.b(593078085,3017,50,"Custom style created via paste.")):(Ma=new Map,Ma.set("Source","CreateStyleCCP_FormattingSteward"),Ma.set("IsStyleNull",(!ya).toString()),Ma=Object.assign(new ba.a,{extendedProperties:Ma}),V.Health.instance.recordKpiFailure(na.a.GLj,"UnableToCreateStyle",!1,!0,Ma));return ra}Che(ra){const {Box4PasteSteward:Ma}=
c(1518);return ra&&0<ra.length&&Ma.Ukc&&Ma.Ukc.Di(ra)?(this.hrd=ra,!0):!1}yge(ra){const {Box4PasteSteward:Ma}=c(1518);return ra&&0<ra.length&&Ma.Ukc&&Ma.Ukc.Di(ra)?(this.AOg=ra,!0):!1}Wkg(ra){if(this.kw){ra=this.uc.NC(ra);if(!ra)return y.a(41968715,307,!1),!1;(ra=ra.Di(this.kw))&&this.Ce.M6a(this.oE.formatting,ra);return!0}return!1}pda(ra,Ma){this.BR=new za.a;this.BR.beforeSpacing=this.Dmo(ra);this.BR.afterSpacing=this.Cmo(Ma);return!0}Dmo(ra){return new la.a(4,ra)}Cmo(ra){return new la.a(4,ra)}eD(ra){if(!ra)return!1;
const Ma=parseFloat(J.a.substring(ra,0,J.a.Ug(ra).indexOf("px")));if(!isNaN(Ma))return this.Hwc=new la.a(3,X.a.Fy(Ma,1)),!0;ra=parseFloat(J.a.substring(ra,0,J.a.Ug(ra).indexOf("%")));return isNaN(ra)?!1:(this.Hwc=new la.a(2,ra/100),!0)}HOb(ra){let Ma=0;if(!ra||""===ra)return!1;switch(ra){case "left":Ma=1;break;case "center":Ma=2;break;case "right":Ma=3;break;case "justify":Ma=6}if(!Ma)return!1;this.vw=Ma;return!0}Rhe(ra){this._textIndent=ra;return!0}Via(ra){this._marginLeft=ra;return!0}$bg(ra){this._tabStops=
ra;return!0}S9(ra){this.wwb=JSON.parse(ra);return this.Rca?!0:!1}clearFormatting(){this.oE.formatting=new Va.a(this.oE,N.a.nil);return!0}E7f(){this.Y$=0;return!0}Wme(ra){var {Box4PasteSteward:Ma}=c(1518);if(0<this.Yfc&&Ma.a5a[this.Yfc]){y.a(4223819,307,1<=this.Yfc);y.a(4223820,307,7>=this.Yfc);Ma=this.uc.NC(ra);if(!Ma)return y.a(4223821,307,!1),!1;Ma=Ma.Di(c(1518).Box4PasteSteward.a5a[this.Yfc]);this.Vu.RJ(Ma,ra,!1);return!0}if(this.oYf){Ma=this.uc.NC(ra);if(!Ma)return y.a(41968716,307,!1),!1;Ma=
Ma.Di(this.oYf);this.Vu.RJ(Ma,ra,!1);return!0}return!1}clone(){return new va(this.paragraph,this.Ce,this.Vu,this.Xy,this.oK,this.xVb,this.yka,this.fUb,this.WVa,this.Ctb,this)}static hlm(){va.RZ||(va.RZ=new aa.a(fa.a.Fh()),va.RZ.add(Ia.a.yellow),va.RZ.add(Ia.a.s_m),va.RZ.add(Ia.a.lHk),va.RZ.add(Ia.a.IJl),va.RZ.add(Ia.a.blue),va.RZ.add(Ia.a.red),va.RZ.add(Ia.a.$gn),va.RZ.add(Ia.a.teal),va.RZ.add(Ia.a.green),va.RZ.add(Ia.a.purple),va.RZ.add(Ia.a.lbn),va.RZ.add(Ia.a.Rkn),va.RZ.add(Ia.a.gray),va.RZ.add(Ia.a.zAo),
va.RZ.add(Ia.a.black));return va.RZ}}va.RZ=null;Object(F.a)(va,"FormattingSteward",null,[816,275]);class ia{flg(){return!1}Xwf(ra){return ra}cxf(){}S9(){}ohe(){}dZd(){return!1}get l_d(){return!1}eD(){}pda(){}Khe(){}get trj(){return!1}}Object(F.a)(ia,"NoOpPasteStewardBridge",null,[330]);var pa=c(74);class sa{constructor(ra,Ma){this.Tin=ra;this.Uin=Ma||"Normal"}}Object(F.a)(sa,"NoteTagInfoBox4",null,[]);c.d(K,"a",function(){return Ha});class Ha{constructor(ra,Ma,ya=null,Ga=null){this.pHl=l.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");
this.Eah=0;this.Ec=ra;this.H6=Ma;this.$Y=Ga||new ia;this.Gc=ya||x.a.Cqf(f.a.eAb,"")}get characterPropertiesEditor(){return null!=this.Pwg?this.Pwg:this.Pwg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get fontService(){return null!=this.Wzg?this.Wzg:this.Wzg=a.a.instance.Na("Box4.IFontService")}get wDa(){return null!=this.Uxg?this.Uxg:this.Uxg=a.a.instance.Na("Box4.CustomFontService")}get xul(){return null!=this.uyg?this.uyg:this.uyg=a.a.instance.Na("Box4.IEmbeddedFontService")}reset(){}get sJc(){return this.Bpf(!1)}Bpf(ra){y.a(4223770,
307,I.OutlineElementReader.Nh(this.Ec));const Ma=G.OutlineElementNavigator.Ge(this.Ec);G.OutlineElementNavigator.Vd(this.Ec);y.a(4223771,307,!!Ma&&z.ParagraphReader.Wb(Ma));ra=new va(Ma,Ha.Sn,Ha.lE,Ha.uc,Ha.m8,Ha.XIl,this.fontService,this.wDa,this.xul,this.pHl,void 0,ra);return new u(ra,this.Gc)}Lca(){}Kca(){}Amb(){}vxa(){}rGa(){}DRa(){}CRa(){}aE(){}pF(){}vmb(){}umb(){}HRa(){}O4a(){}zxa(){}xxa(){}wGa(){}yxa(){}Q4a(){}lec(ra){I.OutlineElementReader.Nh(this.Ec)?(Ha.eg.noa(this.Ec,!0),G.OutlineElementNavigator.Xr(this.Ec,
!1,!1)):L.OutlineReader.fx(this.Ec)?H.OutlineNavigator.h9(this.Ec)?ra?(this.Ec.xg(),Ha.nL.r7(this.Ec,!1)):Ha.eg.bNb(this.Ec):Ha.nL.r7(this.Ec,!1):y.a(8128524,307,!1,"Unexpected node type {0} encountered",this.Ec.We)}bPc(ra){let Ma=null;if(ra&&ra.t9&&ra.cultureName)try{Ma=Object.assign(new E.a,{languageId:k.a.sg(ra.cultureName).LCID})}catch(ya){y.a(8128526,307,!1,"Setting up culture {0} encountered {1}",ra.cultureName,ya)}Ma||null==this.H6||(Ma=Object.assign(new E.a,{languageId:this.H6}));return Ma}get NU(){return this.Eah}set NU(ra){this.Eah=
ra}aBd(){}oad(){}P7e(){}get O3b(){return!1}get YBb(){return!1}W_m(ra){var Ma=1;if(ra.hzi){var ya=0;switch(ra.listStyleType){case 1:Ma=0;break;case 7:Ma=1;break;case 8:Ma=2;break;case 9:Ma=3;break;case 10:Ma=4;break;case 11:Ma=5}}else switch(ya=1,ra.listStyleType){case 1:Ma=0;break;case 3:Ma=1;break;case 4:Ma=2;break;case 5:Ma=3}var Ga=w.a,wa=Ga.n_,hb=ra.Ixa;const eb=new pa.a;for(const jb of hb)hb=new sa(jb.Tin,jb.Uin),eb.add(hb);Ga=wa.call(Ga,ya,Ma,eb,ra.listId,ra.listLevel,ra.levelText,ra.font);
3!==ra.Wr&&(Ga.J5=ra.Wr);ra.hzi&&!ra.Xui&&(Ga.VB=0<ra.listId&&0<=ra.listLevel&&!ra.agc?ra.Ckc:ra.chl);!Ga.zz||3!==Ga.listStyle&&5!==Ga.listStyle||(Ga.vw="right");(ra=ra.MJf)&&Ga.propertySet.Vw(ra);Ga.d7b=!0;this.$Y.ohe(this.Ec);return Ga}p9(){}n9(){}M4(){}o9(){}m9(){}l9(){}static get eg(){return null!=Ha.ZEg?Ha.ZEg:Ha.ZEg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get nL(){return null!=Ha.OEg?Ha.OEg:Ha.OEg=a.a.instance.resolve("Box4.IOutlineEditor")}static get Sn(){return null!=Ha.wAg?
Ha.wAg:Ha.wAg=a.a.instance.resolve("Box4.IFormattingEditor")}static get lE(){return null!=Ha.OJg?Ha.OJg:Ha.OJg=a.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get uc(){return null!=Ha.rKg?Ha.rKg:Ha.rKg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get m8(){return null!=Ha.AAg?Ha.AAg:Ha.AAg=a.a.instance.resolve("Box4.IFormattingReader")}static get XIl(){return null!=Ha.BAg?Ha.BAg:Ha.BAg=a.a.instance.resolve("Box4.Actors.IFormattingStewardBridge")}}Ha.Hf=null;Object(F.a)(Ha,
"Box4PasteStewardBase",null,[791,268,269])},1767:function(F,K,c){F=c(0);var l=c(55),f=c(7),a=c(2),k=c(50),x=c(459),y=c(22);class n{constructor(Q,M,J,V){this.XJe=null;this.Ihd=V;this.Hsa=Q;this.Isa=M;this.aZ=J;this.igh=this.DJb.Kto;Q=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.ibk=Q[0];this.hbk=Q[1]}get DJb(){return this.XJe||(this.XJe=y.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get Gib(){return CommonUIStrings.l_OICErrorHelpLink}get q8c(){return this.igh}get RMi(){return this.ibk}get QMi(){return this.hbk}get PMi(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.igh?
3:2}get uLc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get IFd(){return!!this.Isa}get vLc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}b3f(Q){this.A_c(Q)}AJf(Q){this.A_c(Q)}A_c(Q){let M=10;this.Isa&&1===Q&&(this.Isa(this.aZ),M=1);this.Hsa&&this.Hsa(this.aZ);this.ZM(M)}nKb(){x.Redirect.showHelp("OICFailure");this.ZM(2)}rSf(){this.DJb.QFi();this.ZM(4)}ZM(Q){f.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.Ihd,Q);a.AFrameworkApplication.l5c(k.a.wZi,this.Ihd,Q)}dispose(){this.aZ=this.Hsa=this.Isa=null}}Object(F.a)(n,"AOICErrorDialog",null,[10]);var u=c(38),z=c(175);class w extends n{constructor(Q,M,J,V){super(Q,M,J,V);this.pbb=this.JF=null;Q=document.createElement("span");Q.id="errorMessageText";Q.innerText=this.errorMessage;Q.appendChild(document.createElement("br"));Q.appendChild(document.createElement("br"));this.JF=document.createElement("a");this.JF.href="#";this.JF.innerText=this.Gib;Q.appendChild(this.JF);
u.a.addHandler(this.JF,"click",Object(l.a)(this,this.nKb,"oicErrorHelpLinkHandler"));M=new z.StandardDialog;M.wg=this.id;this.q8c?(J=document.createElement("span"),V=document.createElement("span"),J.innerText=this.RMi,V.innerText=this.QMi,this.pbb=document.createElement("a"),this.pbb.href="#",this.pbb.innerText=this.PMi,Q.appendChild(document.createElement("br")),Q.appendChild(J),Q.appendChild(this.pbb),Q.appendChild(V),u.a.addHandler(this.pbb,"click",Object(l.a)(this,this.rSf,"oicErrorMacOfferLinkHandler"))):
this.IFd&&(Q.appendChild(document.createElement("br")),Q.appendChild(document.createElement("br")),J=document.createElement("span"),J.innerText=this.uLc,Q.appendChild(J));this.IFd?(M.Ad=1,M.Ee(1,this.vLc)):M.Ad=0;M.Ou(this.dialogTitle,null,this.icon,Object(l.a)(this,this.AJf,"legacyOICErrorDialogHandler"),Q);M.h5("errorMessageText")}dispose(){this.JF&&(u.a.removeHandler(this.JF,"click",Object(l.a)(this,this.nKb,"oicErrorHelpLinkHandler")),this.JF=null);this.pbb&&(u.a.removeHandler(this.pbb,"click",
Object(l.a)(this,this.rSf,"oicErrorMacOfferLinkHandler")),this.pbb=null);super.dispose()}}Object(F.a)(w,"OICErrorDialog",n,[]);class E{constructor(Q,M,J){this.Hsa=M;this.Isa=Q;this.aZ=J}get id(){return"OICErrorDialogWithDownload"}get KXh(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get Gib(){return CommonUIStrings.l_OICErrorHelpLink}get uLc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get vLc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}b3f(Q){this.A_c(Q)}AJf(Q){this.A_c(Q)}A_c(Q){let M=
10;1===Q&&(this.Isa(this.aZ),M=1);this.Hsa&&this.Hsa(this.aZ);this.ZM(M)}nKb(){x.Redirect.showHelp("OICFailure");this.ZM(2)}ZM(Q){a.AFrameworkApplication.l5c(k.a.xZi,3,Q)}dispose(){this.aZ=this.Isa=this.Hsa=null}}Object(F.a)(E,"AOICErrorDialogWithDownload",null,[10]);class G extends E{constructor(Q,M,J){super(Q,M,J);this.JF=null;Q=document.createElement("span");Q.id="errorMessageText";Q.innerText=this.KXh;Q.appendChild(document.createElement("br"));Q.appendChild(document.createElement("br"));this.JF=
document.createElement("a");this.JF.href="#";this.JF.innerText=this.Gib;Q.appendChild(this.JF);u.a.addHandler(this.JF,"click",Object(l.a)(this,this.nKb,"oicErrorHelpLinkHandler"));Q.appendChild(document.createElement("br"));Q.appendChild(document.createElement("br"));M=document.createElement("span");M.innerText=this.uLc;Q.appendChild(M);M=new z.StandardDialog;M.wg=this.id;M.Ad=1;M.Ee(1,this.vLc);M.Ou(this.dialogTitle,null,this.icon,Object(l.a)(this,this.AJf,"legacyOICErrorDialogHandler"),Q);M.h5("errorMessageText")}dispose(){this.JF&&
(u.a.removeHandler(this.JF,"click",Object(l.a)(this,this.nKb,"oicErrorHelpLinkHandler")),this.JF=null);super.dispose()}}Object(F.a)(G,"OICErrorDialogWithDownload",E,[]);var H=c(174);class L extends n{constructor(Q,M,J,V){super(Q,M,J,V);M={["errorMessage"]:this.errorMessage};M.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Gib,["onExecute"]:X=>{this.nKb(X)}};this.q8c?(M.macOfficePreLinkText=this.RMi,M.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.PMi,
["onExecute"]:X=>{this.rSf(X)}},M.macOfficePostText=this.QMi):this.IFd&&(M.errorFileDownloadOffer=this.uLc);Q=new H.a(!1,!1,!0);this.IFd?(Q.Ad=1,Q.Ee(1,this.vLc)):Q.Ad=0;Q.wg=this.id;M={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:M};Q.Wh(this.dialogTitle,Object(l.a)(this,this.b3f,"reactOICErrorDialogHandler"),M)}}Object(F.a)(L,"ReactOICErrorDialog",n,[]);class I extends E{constructor(Q,M,J){super(Q,M,J);M={["errorMessage"]:this.KXh,["errorFileDownloadOffer"]:this.uLc};M.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.Gib,["onExecute"]:V=>{this.nKb(V)}};Q=new H.a(!1,!1,!0);Q.Ad=1;Q.Ee(1,this.vLc);Q.wg=this.id;M={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:M};Q.Wh(this.dialogTitle,Object(l.a)(this,this.b3f,"reactOICErrorDialogHandler"),M)}}Object(F.a)(I,"ReactOICErrorDialogWithDownload",E,[]);c.d(K,"a",function(){return N});class N{constructor(){this.ZKa=!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Nb.mF}Rcl(Q,M,J){this.ZKa?new L(Q,M,null,J):new w(Q,M,null,
J)}Scl(Q,M,J){this.ZKa?new I(Q,M,J):new G(Q,M,J)}Tcl(Q,M,J,V,X){const {ReactOICErrorDialogWithTrial:W}=c(1868),{OICErrorDialogWithTrial:U}=c(1869);this.ZKa?new W(Q,M,J,null,V,X):new U(Q,M,J,null,V,X)}static get instance(){return N._instance||(N._instance=new N)}}N._instance=null;Object(F.a)(N,"OICErrorDialogFactory",null,[999])},1768:function(F,K,c){c.r(K);F=c(0);var l=c(306),f=c(1847),a=c(945),k=c(353),x=c(2),y=c(58),n=c(352),u=c(22),z=c(126),w=c(100),E=c(79),G=c(1448),H=c(186),L=c(39),I=c(20),N=
c(265),Q=c(153),M=c(7),J=c(242),V=c(111),X=c(67),W=c(303),U=c(12),Y=c(28),ba=c(3),aa=c(9),fa=c(133),na=c(524),oa=c(46),ja=c(1690),qa=c(1689),Ia=c(338),Va=c(292);class Na extends Va.a{constructor(ya,Ga,wa,hb,eb,jb){super();this.init(ya);this.Jl("DummyClipboardOperation");this.ejb(x.AFrameworkApplication.va,Ga,hb,eb,jb);this._context=wa;this.pr=8;this.tqa()}run(){this.Jab=!0;this.h7c(this._context);this.q5a();this.pr=32}}Object(F.a)(Na,"DummyClipboardOperation",Va.a,[]);Va=c(1579);class za extends Va.a{constructor(ya,
Ga,wa,hb,eb){super(ya,Ga,eb);this.lk=wa;this.rSe=hb}xmc(ya){let Ga;if(this.XS&&!ya)return M.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,$ua:null};Ga=null;if(this.rSe&&!this.XS){const wa=this.properties.ia(Q.a.g1i,"");wa&&(Ga=this.lk.Xmb(wa))}Ga||(Ga=this.lk.Xmb(ya));return{returnValue:!0,$ua:Ga}}}Object(F.a)(za,"HtmlStringImportStrategy",Va.a,[]);var la=c(1848);class va extends la.a{constructor(ya,Ga,wa,hb,eb){super(ya,Ga,wa,hb,eb)}fei(){return this.properties.ia(Q.a.xLb,
"")}xmc(ya){x.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordUseClipboardDataHelperInMultiLineImportSettings");if(this.vgh){if(this.lk)return ya=this.lk.BYf(ya,!0),{returnValue:!0,$ua:ya};M.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.xmc(ya)}TXc(ya){ya=super.TXc(ya);return ya.length&&" "!==ya?ya:"\u00a0"}}Object(F.a)(va,"MultiLinePlainTextImportStrategy",la.a,[]);class ia extends Va.a{constructor(ya,Ga,wa){super(ya,Ga,wa)}xmc(ya){({ClipboardActor:Ga}=
c(1768));if(this.XS&&!ya)return M.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,$ua:null};var Ga=Ga.uCn;Ga.innerText=ya;return{returnValue:!0,$ua:Ga}}}Object(F.a)(ia,"PlainTextImportStrategy",Va.a,[]);var pa=c(84),sa=c(61);class Ha{constructor(ya){this.q4=this.BFf=!1;this.cfa=ya}n3i(){this.BFf||(this.BFf=!0,this.q4=!1,this.cfa.prepareForPaste(()=>{this.q4=!0}));return this.q4}JCj(){this.BFf=!1;const ya=this.cfa.paste();return ya?ya.hasChildNodes()?{returnValue:!0,TFd:ya}:
(M.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),Ha.Jc.Yb(pa.a.s1,{["Reason"]:sa.a.vjf}),{returnValue:!1,TFd:ya}):(M.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),Ha.Jc.Yb(pa.a.hDb,{["Reason"]:sa.a.Phg}),{returnValue:!1,TFd:ya})}static get Jc(){return H.a.instance}}Object(F.a)(Ha,"SystemClipboardImportStrategy",null,[776]);var ra=c(245);c.d(K,"ClipboardActor",function(){return Ma});class Ma{get mFi(){return this.eLa}set mFi(ya){this.eLa=ya}constructor(ya,Ga,wa,hb,eb,jb,
ub,ab,Ea,Wa,Bb,Mb,Fb,vb,$a,kb,Ua,Sa){this.mfd=null;this.eLa=0;this.mkd=this.TCc=!1;this.Qrb=l.a.On;this.O8c=()=>{const xb=Array(1);xb.push("PasteRecoveryFloatie");var Qb=this.yfk.bPa();Qb=Object.assign(new f.a,{x:Qb.x,y:Qb.y});this.JL.showFloatie(Qb,xb,1);return 32};this.jGb=()=>{this.JL.$_&&this.JL.dismissFloatie();return 32};this.Y5i=(xb,Qb,Ib,$b,hc)=>{if(1===Ib)return 32;hc[a.a.On]=!1;return 32};this.Osl=(xb,Qb,Ib,$b,hc,pb)=>{M.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");
var dc=pb.DataTransfer;pb=dc.getData("text/html");dc=dc.getData("text/plain");let Ob=!1;const Vb=new k.DictionaryPropertySet;0<pb.length?(M.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),Vb.setValue(Q.a.iP,pb),Ob=!0):0<dc.length&&(M.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Vb.setValue(Q.a.xLb,dc),Ob=!0);if(Ob){const ob=this.Vz.J(Qb);return this.nEd.create(xb,Qb,ob,new J.a(()=>this.IJc(ob,Vb)),Ib,$b,hc,Vb)}return null};this.n2f=
(xb,Qb,Ib,$b,hc)=>{if(Qb="object"===typeof hc?hc:null)this.BZb?this.Bho(xb,this.eLa,Qb):xb===ba.a.Obe?(xb=this.eLa!==ba.a.reformatPastedContent&&this.eLa!==ba.a.qSa&&this.eLa!==ba.a.dya,Qb[this.Qrb]=this.eLa===ba.a.reformatPastedContent||xb):xb===ba.a.Pbe?Qb[this.Qrb]=this.eLa===ba.a.qSa:xb===ba.a.j2f&&(Qb[this.Qrb]=this.eLa===ba.a.dya);return 32};this.aX=(xb,Qb,Ib,$b,hc,pb)=>{if((x.AFrameworkApplication.protectFile||x.AFrameworkApplication.LG)&&!x.AFrameworkApplication.QCb||ra.a.rha(Ib)&&ra.a.Jac())return new Na(xb,
Qb,Ib,$b,hc,pb);let dc=this.Vz.J(Qb);1!==$b&&dc&1&&(this.eLa=Qb);if(1!==$b){var Ob=Object(V.a)(101,pb)?pb:null;pb?(dc&1&&(this.mfd=Ob),Ob=Ob?Ob.ia(Q.a.yY,0):0,Qb===ba.a.paste&&Ob===ba.a.KZa?dc=this.Vz.J(ba.a.c_):Qb===ba.a.x9&&Ob===ba.a.vAb&&(dc=this.Vz.J(ba.a.r$d))):!pb&&dc&4096&&(pb=this.mfd,Ob=Object(V.a)(101,pb)?pb:null)&&(Ob=Ob.ia(Q.a.D1c,y.a.nil),M.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",Ob))}return this.nEd.create(xb,Qb,dc,new J.a(()=>this.IJc(dc,
pb)),Ib,$b,hc,pb)};this.bJn=(xb,Qb,Ib,$b,hc)=>this.Z5e(xb,Qb,Ib,hc);this.aJn=(xb,Qb,Ib,$b,hc)=>this.Z5e(xb,Qb,Ib,hc);this.$In=(xb,Qb,Ib,$b,hc)=>this.Z5e(xb,Qb,Ib,hc);this.f5d=(xb,Qb,Ib,$b,hc,pb)=>{pb=Y.a.Qc(oa.a.instance.gb.kb.Oa.node,pb);return this.aX(xb,Qb,Ib,$b,hc,pb)};this.PZj=ya;this.cfa=Ga;this.ud=wa;this.lk=hb;this.ga=jb;this.Lfd=Wa;this.wTb=Bb;this.Ae=Mb;this.gg=Fb;this.Ub=Ea;this.AZb=vb;this.BZb=$a;this.yfk=kb;this.JL=Ua;this.KGe=Sa;this.pg=n.a.getInstance(Ia.a.NZa);ab&&(this.TCc=ab.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),
this.mkd=this.BZb&&ab.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));this.Vz=new W.a;this.Vz.Z(ba.a.paste,257);this.Vz.Z(ba.a.x9,8449);this.Vz.Z(ba.a.c_,1);this.Vz.Z(ba.a.p2a,1);this.Vz.Z(ba.a.Dzb,1);this.Vz.Z(ba.a.lCa,1);this.Vz.Z(ba.a.wXd,513);this.Vz.Z(ba.a.reformatPastedContent,4097);this.Vz.Z(ba.a.qSa,12289);this.Vz.Z(ba.a.dya,131073);this.Vz.Z(ba.a.FYf,7);this.Vz.Z(ba.a.q$d,1);this.Vz.Z(ba.a.r$d,8193);this.Vz.Z(ba.a.copy,272);this.Vz.Z(ba.a.CFc,16);this.Vz.Z(ba.a.cut,304);this.Vz.Z(ba.a.X4e,
48);this.Vz.Z(ba.a.e5d,64);this.Vz.Z(ba.a.f5d,64);this.Vz.Z(ba.a.showPlaceholderGlossary,65536);this.Vz.Z(ba.a.Ggf,1);this.mkd&&this.Vz.Z(ba.a.anb,this.Vz.J(ba.a.r$d))}get NTa(){return null!=this.BHg?this.BHg:this.BHg=u.a.instance.Na("Box4.Clipboard.ISystemClipboardAccessManager")}get telemetry(){return null!=this.WHg?this.WHg:this.WHg=u.a.instance.Na("Common.Utils.Telemetry.ITelemetry")}get nEd(){return this.PZj.value}get nHo(){return this.cfa}Tb(){this.ga.eb(ba.a.KMn,U.a.application,this.Y5i,97);
this.ga.eb(ba.a.LMn,U.a.application,this.Y5i,97);this.ga.eb(ba.a.Obe,U.a.application,this.n2f,97);this.ga.eb(ba.a.Pbe,U.a.application,this.n2f,97);this.ga.eb(ba.a.j2f,U.a.application,this.n2f,97);this.ga.cT(ba.a.X4e,U.a.view,this.aX,1028);this.ga.Cdb(ba.a.CFc,U.a.view,this.aX);this.ga.cT(ba.a.Ggf,U.a.view,this.Osl,1028);this.ga.cT(ba.a.c_,U.a.view,this.aX,1028);this.ga.cT(ba.a.p2a,U.a.view,this.aX,1028);this.ga.cT(ba.a.Dzb,U.a.view,this.aX,1028);this.ga.cT(ba.a.lCa,U.a.view,this.aX,1028);this.AZb&&
this.ga.eb(ba.a.KZa,U.a.view,this.$In,1028);this.BZb&&this.ga.eb(ba.a.vAb,U.a.view,this.aJn,1028);this.ga.cT(ba.a.paste,U.a.view,this.aX,1028);this.ga.cT(ba.a.x9,U.a.view,this.aX,1028);this.ga.cT(ba.a.r$d,U.a.view,this.aX,1028);this.ga.cT(ba.a.q$d,U.a.view,this.aX,1028);this.ga.cT(ba.a.FYf,U.a.view,this.aX,1028);this.ga.cT(ba.a.reformatPastedContent,U.a.view,this.aX,1028);this.ga.cT(ba.a.qSa,U.a.view,this.aX,1028);this.ga.qa(ba.a.pNb,U.a.view,z.ActionManager.Nf);this.ga.qa(ba.a.n1i,U.a.view,z.ActionManager.Nf);
this.ga.qa(ba.a.k1i,U.a.view,z.ActionManager.Nf);this.ga.qa(ba.a.l1i,U.a.view,z.ActionManager.Nf);this.ga.qa(ba.a.m1i,U.a.view,z.ActionManager.Nf);this.ga.qa(ba.a.j1i,U.a.view,z.ActionManager.Nf);this.ga.Cdb(ba.a.e5d,U.a.view,this.aX);this.ga.Cdb(ba.a.f5d,U.a.view,this.f5d);this.ga.Cdb(ba.a.wXd,U.a.view,this.aX);this.ga.Cdb(ba.a.showPlaceholderGlossary,U.a.view,this.aX);this.mkd&&(this.ga.eb(ba.a.$Fc,U.a.view,this.bJn,1028),this.ga.cT(ba.a.anb,U.a.view,this.aX,1028));this.ga.qa(ba.a.wOh,U.a.view,
z.ActionManager.Nf);this.ga.qa(ba.a.$Oh,U.a.view,z.ActionManager.Nf);this.KGe&&(this.ga.eb(ba.a.O8c,U.a.view,this.O8c,96),this.ga.eb(ba.a.jGb,U.a.view,this.jGb,96))}Z4(){if(this.Ub){const ya=this.Ub.fe(fa.AppFrame.JD);this.mkd&&ya.bindAction(w.KeyInputManager.jc(E.a.irb,w.KeyInputManager.Qh|4),ba.a.$Fc)}else M.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}Bho(ya,Ga,wa){switch(Ga){case ba.a.qSa:case ba.a.x9:case ba.a.anb:Ga=ba.a.Pbe;break;case ba.a.dya:Ga=
ba.a.j2f;break;default:Ga=ba.a.Obe}wa[this.Qrb]=ya===Ga}S8l(){const ya=Object(V.a)(101,this.mfd)?this.mfd:null;return ya?ya.ia(Q.a.D1c,y.a.nil):y.a.nil}Z5e(ya,Ga,wa,hb){if(1===wa){if(!Object(V.a)(na.a,Ga)||!this.Lfd||ra.a.rha(Ga)&&ra.a.Jac())return 8;wa=new J.a(()=>this.IJc(this.Vz.J(ba.a.c_),hb));const eb=this.Lfd.create(wa,Object(X.a)(101,hb));wa=new qa.a(x.AFrameworkApplication.K,G.a.instance,wa,H.a.instance,eb,this.wTb);return ja.a.bBh(Ga,wa)?32:8}if(2===wa){if(this.Lso(aa.App.TYa))return this.KZa(ya);
aa.App.mhc(()=>{this.KZa(ya)});return 32}return 2}KZa(ya){if(!this.Ae)return M.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),8;var Ga=this.Ae.Fhb();if(!Ga)return M.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;Ga=Ga.Qn;if(!Ga)return M.ULS.sendTraceTag(592454659,307,10,"No document"),8;M.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",ya);this.pg.logKpiUsage({kpiName:Ia.a.lNa});this.gg.Pul(ya);ya=L.a.aDb(Ga,"paste");Ga=this.gg.mol();M.ULS.sendTraceTag(573388233,
307,50,"PasteEventHandled: {0}",Ga);if(ya)return M.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),this.pg.logKpiSuccess({kpiName:Ia.a.lNa}),32;this.Nnm();M.ULS.sendTraceTag(592454662,307,10,"execCommand failed");this.pg.logKpiFailure({kpiName:Ia.a.lNa,errorName:"ExecCommandFailed"});return 8}Nnm(){this.NTa&&(this.NTa.mPb(),Ia.a.$2d(!0,oa.a.instance,I.a.eG));if(this.telemetry){const ya=this.telemetry.A9c();ya.s1b("CallExecCommandPasteOperation");ya.fail("call to execCommand('paste') failed",
!0);this.telemetry.pga(ya)}}Lso(ya){let Ga=!1;this.Ub?this.Ub.currentScope?Ga=!this.Ub.dDf(this.Ub.currentScope.name):M.ULS.sendTraceTag(573388235,307,10,"No CurrentScope"):M.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(Ga){M.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.Ub.currentScope.name);if(1>ya)return M.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Ub.Elf();return!1}return!0}IJc(ya,Ga){return ya&256?new Ha(this.nHo):ya&2?ya&4096?new za(Ga,
this.ud,this.lk,aa.App.instance.FUc,aa.App.instance.rTa):new ia(Ga,this.ud,aa.App.instance.rTa):Ga.hasProperty(Q.a.xLb)?new va(Ga,this.ud,this.lk,this.TCc,aa.App.instance.rTa):new za(Ga,this.ud,this.lk,aa.App.instance.FUc,aa.App.instance.rTa)}static get uCn(){return N.a.nSd("Box4PasteScratchPad")}aBh(ya,Ga,wa,hb){return!x.AFrameworkApplication.protectFile&&!x.AFrameworkApplication.LG||x.AFrameworkApplication.QCb?(ya=this.aX(null,ya?ba.a.cut:ba.a.copy,Ga,1,wa,hb))?ya.response:8:8}}Object(F.a)(Ma,"ClipboardActor",
null,[])},1774:function(F,K,c){c.r(K);F=c(0);var l=c(19),f=c(2037),a=c(1825);class k extends a.a{constructor(){super();this.isCurrentUser=!1}}Object(F.a)(k,"IsMeAtMentionOptionalAttributes",a.a,[]);class x{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(F.a)(x,"DeltaAttributes",null,[]);var y=c(1615),n=c(8),u=c(72),z=c(16),w=c(7),E=c(1678);c.d(K,"ACommentFormatTranslator",
function(){return G});class G{constructor(H){this.Vg=H}rEk(H,L){const I=n.ParagraphReader.text(L);let N=null,Q=null,M=null,J=0;var V=0,X=!1;let W="";for(L.pa||I&&I.length&&"\n"!==I||w.ULS.sendTraceTag(50870150,327,10,"paragraph chps are null and paragraph text is null or empty");J<L.pa.length;){const Y=L.pa.J(J),ba=Y.cp;var U=Y.formatting?Y.formatting.yn:null;W+=l.a.substring(I,X?V+1:V,ba);Y.Om&&N&&(V=new f.a,V.fullName=W.startsWith("@")?W.substr(1):W,E.a(N,V),X=new k,E.c(N,X,V),H.yAf(W,V,X,!0),W=
"",N=null);Y.Om&&Q&&(V=M||new x,V.link=Q.url,H.osi(W,V),W="",Q=null);N&&Q||""===W||(this.Vg.Uzb&&M?(H.Gsi(W,M),M=null):H.iha(W),W="");Y.hyperlink&&(Y.hyperlink.hw?N=Y.hyperlink:Y.hyperlink.url&&(Q=Y.hyperlink));this.Vg.Uzb&&U&&(M=new x,M.weight=U.ia(z.a.bold,!1)?y.a.vNf:0,M.italic=U.ia(z.a.italic,!1),M.underline=U.ia(z.a.underline,!1),M.strikethrough=U.ia(z.a.strikethrough,!1),U.hasProperty(z.a.highlight)&&(V=U.getValue(z.a.highlight),M.highlight=u.a.YE(V)),U.hasProperty(z.a.fontColor)&&(U=U.getValue(z.a.fontColor),
M.color=u.a.YE(U)));V=ba;X=!!Y.blob;J++}}}G.wIk="_@_";G.xIk="Z";Object(F.a)(G,"ACommentFormatTranslator",null,[717])},1786:function(F,K,c){F=c(0);var l=c(174),f=c(19),a=c(27),k=c(22),x=c(2),y=c(159),n=c(156);class u{static get Yg(){return l.a.vA(u.Km,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}u.Km="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(F.a)(u,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var z=c(15),w=c(3);c.d(K,"a",function(){return E});class E extends l.a{constructor(G,H,L){super();this.WXg=!1;this.TV=null;this.THl=I=>{switch(I){case 1:this.ga.processAction(z.a.L1h,2);break;case 2:this.ga.processAction(z.a.M1h,2);break;case 0:this.ga.processAction(z.a.N1h,2)}};this.wu=H;this.rS=!1;this.sVb=E.AHl;this.Jh=G;this.ga=L;this.wg="FootnoteEndnoteFormattingOptionsDialog";this.Ad=2;this.Yg=u.Yg;this.Ee(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.Ee(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.Wh(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.THl,null);this.Cib=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.TV}set fontName(G){this.TV=G;if(G=document.getElementById("FontSizeComboBox"))G.focus(),this.Jh.updateCommandUI()}get fontSize(){return this.sVb}get Cib(){return this.WXg}set Cib(G){this.WXg=G;this.xEn()}k9(){this.lCd("FontStyleComboBox",
"FontPlaceholder",z.a.hNd.toString(),z.a.I5i.toString(),z.a.W1c.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.lCd("FontSizeComboBox","FontPlaceholder",z.a.iNd.toString(),w.a.W2c.toString(),z.a.X1c.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const G=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
f.a.QX(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),H=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',f.a.QX(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.HFc("NoStyle","IndentPlaceholderStyles",
z.a.P1h.toString(),z.a.J5i.toString(),G,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.HFc("FirstLineIndent","IndentPlaceholderStyles",z.a.O1h.toString(),z.a.Q1f.toString(),H,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}lCd(G,H,L,I,N,Q,M){L=y.c(G,L,!0,!0,I,N,f.a.yf(Q),!0,M);this.TGd(G,H,L,"Medium")}HFc(G,H,L,I,N,Q,M){L=y.f(G,L,I,f.a.yf(N),f.a.yf(Q),M);this.TGd(G,H,L,"Large",Q)}TGd(G,H,L,I,N=null){H=document.getElementById(H);
this.wu.YYa(G,L);L=this.wu.rEb(G,I);N&&a.a.OAd(L,String.format("{0}Label",G),N);H.appendChild(L);this.wu.Npa(G)}xEn(){this.wu.Npa("NoStyle");this.wu.Npa("FirstLineIndent")}dispose(){this.rS||(this.wu.BY("FontStyleComboBox"),this.wu.BY("FontSizeComboBox"),this.wu.BY("NoStyle"),this.wu.BY("FirstLineIndent"),this.rS=!0);this.Jh.updateCommandUI();super.dispose()}static get XTa(){return k.a.instance.resolve("Common.IStandaloneRootController").sda}static JYl(){return new E(n.App.sn,E.XTa,x.AFrameworkApplication.va)}static IYl(){return E.JYl()}}
E.AHl=-1;Object(F.a)(E,"FootnoteEndnoteFormattingOptionsDialog",l.a,[])},1814:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(f,a){this.gi=this.lod=0;this.sXg=a;this.wmk=f}Ilb(){return this.lod-this.gi>=this.wmk}reset(){this.gi=this.lod=this.sXg()}update(){this.lod=this.sXg()}}Object(F.a)(l,"TimeBasedTaskYieldStrategy",null,[441])},1825:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.contentId=""}}Object(F.a)(l,"AtMentionOptionalAttributes",
null,[])},1853:function(F,K){Object.defineProperty(K,"__esModule",{value:!0});K.ObjectSchemaType=K.ObjectSemantic=K.SequenceType=K.IntentIds=void 0;(function(c){c.Logging="Logging";c.ZeroTermMenu="ZeroTermMenu";c.Floatie="Floatie"})(K.IntentIds||(K.IntentIds={}));(function(c){c.CommandId="CommandId";c.ControlId="ControlId"})(K.SequenceType||(K.SequenceType={}));(function(c){c.CommandIdHistory="CommandIdHistory";c.ControlIdHistory="ControlIdHistory";c.FilteredCommandIdHistory="FilteredCommandIdHistory";
c.CanvasContext="CanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.GenericSuggestions="GenericSuggestions"})(K.ObjectSemantic||(K.ObjectSemantic={}));(function(c){c.CommandExecutionSequence="CommandExecutionSequence";c.WordCanvasContext="WordCanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.RankedSuggestion="RankedSuggestion"})(K.ObjectSchemaType||(K.ObjectSchemaType={}))},1854:function(F,K,c){Object.defineProperty(K,"__esModule",
{value:!0});K.SearchSuggestionAnnotation=K.SearchSuggestionSignal=void 0;const l=c(195);class f{constructor(k){l.SchemaObject.assign(f,this,k)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[f.getTypeName()])}}K.SearchSuggestionSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=
k}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}K.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1862:function(F,K,c){var l=this&&this.gC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var n=Object.getOwnPropertyDescriptor(k,x);if(!n||("get"in n?!k.Oz:n.writable||n.configurable))n={enumerable:!0,
get:function(){return k[x]}};Object.defineProperty(a,y,n)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1863),K);f(c(1864),K);f(c(1865),K);f(c(1866),K)},1863:function(F,K){Object.defineProperty(K,"__esModule",{value:!0})},1864:function(F,K){Object.defineProperty(K,"__esModule",{value:!0})},1865:function(F,K,c){Object.defineProperty(K,
"__esModule",{value:!0});K.ContractEntityAnnotation=void 0;const l=c(195);class f{constructor(a){l.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}K.ContractEntityAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},
1866:function(F,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.ContractEntitySignal=void 0;const l=c(195);class f{constructor(a){l.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}K.ContractEntitySignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1868:function(F,K,c){c.r(K);c.d(K,"ReactOICErrorDialogWithTrial",
function(){return k});F=c(0);var l=c(55);K=c(1708);var f=c(459),a=c(174);class k extends K.a{constructor(x,y,n,u,z,w){super(x,y,n,u,z,w);y={["errorMessage"]:this.JXh,["offerString"]:this.KSi};x=new a.a(!1,!1,!0);this.ssj?(x.Ad=1,y.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Gib,["onExecute"]:()=>{f.Redirect.showHelp(this.$ni)}}):(x.Ad=4,x.Ee(2,this.mpi));x.Ee(1,this.Hyd);x.wg=this.id;y={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:y};x.Wh(this.dialogTitle,Object(l.a)(this,
this.wQn,"reactOICErrorDialogWithTrialHandler"),y)}}Object(F.a)(k,"ReactOICErrorDialogWithTrial",K.a,[])},1869:function(F,K,c){c.r(K);c.d(K,"OICErrorDialogWithTrial",function(){return a});F=c(0);var l=c(55);K=c(1708);var f=c(175);class a extends K.a{constructor(k,x,y,n,u,z){super(k,x,y,n,u,z);k=document.createElement("span");k.innerText=this.JXh;k.appendChild(document.createElement("br"));k.appendChild(document.createElement("br"));x=document.createElement("span");x.innerText=this.KSi;k.appendChild(x);
x=new f.StandardDialog;this.ssj?(x.Ad=1,x.yZe(this.Gib,this.$ni)):(x.Ad=4,x.Ee(2,this.mpi));x.Ee(1,this.Hyd);x.wg=this.id;x.Ou(this.dialogTitle,null,this.icon,Object(l.a)(this,this.i_m,"legacyOICErrorDialogWithTrialHandler"),k)}}Object(F.a)(a,"OICErrorDialogWithTrial",K.a,[])},1871:function(F,K,c){var l=this&&this.gC||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),f=this&&this.__exportStar||
function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(K,"__esModule",{value:!0});f(c(1872),K);f(c(1873),K)},1872:function(F,K){Object.defineProperty(K,"__esModule",{value:!0})},1873:function(F,K,c){Object.defineProperty(K,"__esModule",{value:!0});K.SearchProviderAnnotation=K.SearchProviderSignal=void 0;const l=c(195);class f{constructor(k){l.SchemaObject.assign(f,this,k)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[f.getTypeName()])}}K.SearchProviderSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}K.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1959:function(F,
K,c){function l(ka){Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");ka?N.VXn():N.main();dg.main(ka);nl.main(ka);z.a.instance.Fc(new jr,0,ka);z.a.instance.Fc(new wk,0,ka);vm(ka);Zn(ka)}var f=c(0),a=c(7),k=c(1597),x=c(1610),y=c(2),n=c(83),u=c(742),z=c(178),w=c(35),E=c(39),G=c(20),H=c(82),L=c(22),I=c(115);class N{get name(){return"Common.App.OAuth.OAuthPackage"}xc(ka){ka.register(373,"Common.App.OAuth.IOAuthManager").singleInstance().Rd(()=>
new k.OAuthManager)}init(){const ka=L.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.XQo(ka)}XQo(ka){const db=y.AFrameworkApplication.K.jb("FileSource");if(y.AFrameworkApplication.K.$("IsO365ConsumerHost")||y.AFrameworkApplication.K.$("IsO365CommercialHost")||"WopiTest"===db){var yb=u.OAuthManagerSettings.$$e;if(yb&&yb.IsEnabled){var Zb=yb.Application,tc=u.OAuthManagerSettings.authority;if(void 0!==Zb&&null!==Zb&&Zb.length&&void 0!==tc&&null!==tc&&tc.length){var Pc=x.a[ka.s$],Od=G.a.eG,
ke=ka.WK();try{var od=new Map;void 0!==od&&null!==od?(od.set("SupportStatus",Pc),od.set("Browser",Od),od.set("AuthStrategy",ke)):od=null}catch(Se){od=null}n.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",od);var Pe=E.a.af();ka.PY("Core",Zb).then(Se=>{const ng=Math.floor(E.a.af()-Pe);Pc=x.a[ka.s$];Od=G.a.eG;ke=ka.WK();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
ng,Se.IsSuccess,Pc,Se.ErrorCode,db,Od,ke);od&&(od.set("SupportStatus",Pc),od.set("Browser",Od),od.set("AuthStrategy",ke));var Dg=Object.assign(new I.a,{durationMs:ng,extendedProperties:od});if(Se.IsSuccess){if(n.Health.instance.recordKpiSuccess("WacCorePFT",Dg),Se="Bearer "+Se.Token,y.AFrameworkApplication.Ne.cpg=Se,Dg=yb.Endpoint){var gi=E.a.af();y.AFrameworkApplication.Ne.F0b(Dg,1,null,{["Authorization"]:Se},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(qh=>{var ym=Math.floor(E.a.af()-
gi),Ol=null;qh.yo?qh="Canceled":qh.Ai?qh="Faulted":(Ol=qh.result,qh=Ol.succeeded?"Completed":"Failed");ym={["TaskResult"]:qh,["BrowserTokenDurationMS"]:ng,["BrowserValidationDurationMS"]:ym};Ol&&(ym.HttpStatus=Ol.args.data.Qe,Ol.succeeded&&(Ol=w.a(Ol.args.data.ve),ym.ServerValidationDurationMS=Ol.ElapsedMilliseconds,ym.ServerValidationResult=Ol.ValidatedToken,ym.KMSI=Ol.KMSI,ym.Scopes=Ol.Scopes,ym.TokenExpirationS=Math.floor(parseInt(Ol.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,
3E3,"Completed"===qh?50:15,H.a.toJSON(ym))})}}else n.Health.instance.recordKpiFailure("WacCorePFT",Se.ErrorCode,!1,!1,Dg)}).catch(Se=>{var ng=Math.floor(E.a.af()-Pe);ng=Object.assign(new I.a,{durationMs:ng,extendedProperties:od});n.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+Se.toString(),!1,!1,ng)})}}}}dispose(){}static main(){z.a.instance.Fc(new N)}static VXn(){z.a.instance.Fc(new N,0,!0)}}Object(f.a)(N,"OAuthPackage",null,[1,2]);var Q=c(372),M=c(364),J=c(19);class V{constructor(){this.Xtd=
new M.a}KQo(ka,db){if(!ka)return a.ULS.sendTraceTag(40478031,306,10,"SDX AssetId is null."),!1;ka=J.a.Ug(ka);if(this.Xtd.mb(ka))return a.ULS.sendTraceTag(40478032,306,10,"ISdxPaneSuppressionHandler already registered for SDX AssetId: {0}.",ka),!1;this.Xtd.Z(ka,db);return!0}J7l(ka){if(!ka)return a.ULS.sendTraceTag(40478033,306,10,"SDX AssetId is null."),null;ka=J.a.Ug(ka);return this.Xtd.mb(ka)?this.Xtd.J(ka):(a.ULS.sendTraceTag(40478034,306,10,"ISdxPaneSuppressionHandler does not exist for SDX AssetId: {0}.",
ka),null)}}Object(f.a)(V,"SdxPaneSuppressionManager",null,[]);var X=c(242),W=c(250),U=c(9);class Y{constructor(ka){this.tLe=0;this.Ick=ka}Ilb(){return this.tLe>=this.Ick}reset(){this.tLe=0}update(){this.tLe++}}Object(f.a)(Y,"NodeCountBasedTaskYieldStrategy",null,[441]);var ba=c(1814);class aa{constructor(){this.$6c=new Set}Bnb(ka){this.$6c.add(ka)}cTo(ka){this.$6c.delete(ka)}Xun(){return()=>{this.$6c.forEach(ka=>{ka.onSessionClose()})}}Yun(){return()=>{this.$6c.forEach(ka=>{ka.onSessionConnect()})}}Zun(){return()=>
{this.$6c.forEach(ka=>{ka.onSessionDisconnect()})}}}Object(f.a)(aa,"AlSessionLifeEventNotifier",null,[427]);var fa=c(1397),na=c(80),oa=c(90),ja=c(58),qa=c(6),Ia=c(1511),Va=c(151),Na=c(329),za=c(1030),la=c(692),va=c(236),ia=c(409),pa=c(666),sa=c(416),Ha=c(403);class ra{constructor(){this.token=null}}Object(f.a)(ra,"ReleaseAnnotationParameters",null,[]);class Ma{constructor(){this.value=this.id=this.parentPath=null}}Object(f.a)(Ma,"SetAnnotationMetadataParameters",null,[]);class ya{constructor(){this.id=
this.parentPath=null;this.value=0}}Object(f.a)(ya,"SetAnnotationStateParameters",null,[]);var Ga=c(583),wa=c(354),hb=c(74),eb=c(77),jb=c(585),ub=c(1207),ab=c(304),Ea=c(743),Wa=c(8),Bb=c(398);class Mb extends Sys.EventArgs{constructor(ka,db){super();this.annotation=ka;this.Odb=db}}Object(f.a)(Mb,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var Fb=c(1002);class vb{constructor(ka){this.n1e=this.annotations=null;if(!ka)a.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.annotations=
null;else if(ka.items&&0<ka.items.length){const db=vb.zRd(ka.parentPath);this.annotations=Array(ka.items.length);let yb=0;for(const Zb of ka.items){const tc=Object.assign(new Fb.a,{id:Zb.id,parentPath:db,content:Zb.body,annotationType:va.a.getTypeNameFor(Zb.body),parentRevId:ka.parentRevId});this.annotations[yb++]=tc}this.n1e=va.a.getTypeNameFor(ka)}}static zRd(ka){return ka?ka.join("\\"):""}}Object(f.a)(vb,"AnnotationOperation",null,[]);class $a extends Sys.EventArgs{constructor(ka,db){super();this.annotationType=
ka;this.activated=db}}Object(f.a)($a,"AnnotationActivationEventArgs",Sys.EventArgs,[]);class kb extends Sys.EventArgs{constructor(ka,db){super();this.annotation=ka;this.opType=db}}Object(f.a)(kb,"AnnotationOperationEventArgs",Sys.EventArgs,[]);class Ua{constructor(){this.newState=this.oldState=0;this.handlers=new hb.a}}Object(f.a)(Ua,"AnnotationResultStateUpdateData",null,[]);var Sa=c(599),xb=c(996);class Qb{constructor(){this.k1e=this.gDk=this.l1e=null}}Object(f.a)(Qb,"AnnotationCallbacks",null,
[]);class Ib{constructor(ka,db,yb,Zb,tc,Pc){this.c0b=null;this.Wyc=new M.a(0);this.oDc=new M.a;this.Aed=new M.a;this.Ard=new Sa.a;this.AVf=null;this.ri=ka;this.WKa=db;this.KF=yb;this.hC=Zb;this.wI=tc;this.ld=Pc}B4o(ka,db,yb,Zb){this.hC.aac(ka)&&this.ri.ie(()=>{if(!this.c0b){this.c0b=new M.a;var tc=Wa.ParagraphReader.tw(Bb.a.getRootNode(),!0,!0);for(const Pc of tc)Pc&&(tc=Pc.ia(qa.a.Lc,0))&&(this.c0b.add(tc,Pc.id),this.Wyc.Z(Pc.id.toString(),tc))}this.WKa.zVf(ka,(Pc,Od)=>{if(Pc){var ke=this.hC.Gbi(ka);
Pc.contentDescriptor.Ov===ke&&((ke=this.gZl(Pc))?Pc.Ndb?(ke=this.maf(Pc,ke))&&(Od?yb(Od,Pc.contentDescriptor):db(ke,Pc.contentDescriptor)):Zb(Pc.contentDescriptor):this.Ejl(Pc,Object.assign(new Qb,{l1e:db,gDk:yb,k1e:Zb})))}})},"PAS:FEPAOT")}gZl(ka){if(3===ka.contentDescriptor.Ov){let db;return({value:db}=this.c0b.Dc(ka.contentDescriptor.paragraphId)).returnValue?db:null}if(4===ka.contentDescriptor.Ov)return ja.a.nil;a.ULS.sendTraceTag(592525442,Ib.Ci,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");
return null}kMm(ka,db){if(3===ka.contentDescriptor.Ov)return db=this.wI.value.Db(db).getValue(qa.a.uj),ka.contentDescriptor.uj===db;if(4===ka.contentDescriptor.Ov&&db===ja.a.nil)return!0;a.ULS.sendTraceTag(592525443,Ib.Ci,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}Ejl(ka,db){if(3===ka.contentDescriptor.Ov){const yb=ka.contentDescriptor.paragraphId;this.oDc.mb(yb)||this.oDc.add(yb,new hb.a);this.oDc.J(yb).add(Zb=>{12===Zb.type&&this.c0b.add(yb,Zb.id);ka.Ndb?(Zb=this.maf(ka,
Zb.id))&&db.l1e(Zb,ka.contentDescriptor):db.k1e(ka.contentDescriptor)})}else if(4===ka.contentDescriptor.Ov)if(ka.Ndb){const yb=this.maf(ka,ja.a.nil);yb&&db.l1e(yb,ka.contentDescriptor)}else db.k1e(ka.contentDescriptor);else a.ULS.sendTraceTag(592525444,Ib.Ci,15,"DelayCallbackForAnnotation: Unsupported content type")}maf(ka,db){if(this.kMm(ka,db)){if(db=this.hC.jin(ka.Ndb,ka.contentDescriptor,db.toString()))return this.Aed.Z(db.id,ka.J5a),db}else this.ld.isFeatureEnabled(88)&&this.KF.UDc(ka);return null}zHj(ka,
db){const yb=this.hC.QOd(ka);yb&&(db===za.a.getTypeName()?this.nPo(ka,yb):this.$Oo(ka,yb))}nPo(ka,db){this.hC.aac(ka.annotationType)&&(this.KF.xSa(this.wI.value,db,ka.annotationType),this.Aed.remove(ka.id))}$Oo(ka,db){if(this.hC.aac(ka.annotationType)){db=Object.assign(new xb.a,{Ndb:this.hC.kDk(ka),contentDescriptor:db,annotationType:ka.annotationType});db=this.KF.addAnnotation(this.wI.value,db);this.Aed.Z(ka.id,db);const yb=this.hC.eki(ka.annotationType);yb&&this.Ard.contains(yb)&&(this.ri.ie(()=>
{var Zb=Wa.ParagraphReader.tw(Bb.a.getRootNode(),!0,!0);if(Zb&&0<Zb.count){const tc=new hb.a;for(const Pc of Zb)(Zb=Ib.wRd(Pc))&&tc.add(Zb);0<tc.count&&this.KF.Soh(this.wI.value,yb,tc.toArray())}},"PAS:TAOCPA"),this.Ard.remove(yb))}}tmb(ka){if(this.c0b)if(ka){var db=ka.ia(qa.a.Lc,0);if(db&&(this.Wyc.Z(ka.id.toString(),db),({value:db}=this.oDc.Dc(db)).returnValue))for(const yb of db)yb(ka)}else a.ULS.sendTraceTag(592525445,Ib.Ci,10,"OnParagraphNodeConnected: Invalid node")}FWi(ka,db){if(ka){var yb=
ka.id.toString();ka=ka.ia(qa.a.Lc,0);var Zb=0;({value:Zb}=this.Wyc.Dc(yb)).returnValue&&(3===db?(this.oDc.remove(Zb),this.Wyc.remove(yb)):2===db?this.Wyc.Z(yb,ka):a.ULS.sendTraceTag(592525447,Ib.Ci,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,Ib.Ci,10,"UpdatePersistedAnnotations: Invalid node")}zam(ka){let db;return({value:db}=this.Aed.Dc(ka)).returnValue?db:ja.a.nil}h0o(ka,db,yb){ka?db?this.WKa.jei(ka,Zb=>{if(Zb){const Od=
Ib.wRd(db,yb);if(Od){var tc=Array(Zb.length),Pc=!1;for(let ke=0;ke<Zb.length;ke++)if(Pc||Od!==Zb[ke])tc[ke]=Zb[ke];else{const od=Ib.wRd(db);if(!od)return;Pc=!0;tc[ke]=od;Zb[ke]=od}Pc&&this.KF.Soh(this.wI.value,ka,tc)}}}):a.ULS.sendTraceTag(588863697,Ib.Ci,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,Ib.Ci,10,"UpdateWorkflowParagraphVersion: null workflowType")}Mmo(ka){ka?this.Ard.add(ka):a.ULS.sendTraceTag(588863698,Ib.Ci,10,"SetPendingWorkflow: null workflowType")}yZk(ka){ka?
this.Ard.remove(ka):a.ULS.sendTraceTag(588105731,Ib.Ci,10,"ClearPendingWorkflow: null workflowType")}static wRd(ka,db=0){if(!ka)return null;db||(db=ka.ia(qa.a.uj,0));ka=Wa.ParagraphReader.TQ(ka);if(db&&ka)return String.format("{0}{1}{2}",ka,Ib.eBn,db);a.ULS.sendTraceTag(588091606,Ib.Ci,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",db?"valid":"0",ka?"valid":"0");return null}}Ib.Ci=389;Ib.eBn="-";Object(f.a)(Ib,"PersistedAnnotationStorage",null,[438]);class $b{constructor(){this.config=
this.token=null}}Object(f.a)($b,"UpdateAnnotationConfigParameters",null,[]);var hc=c(121),pb=c(1185),dc=c(334),Ob=c(1408),Vb=c(854),ob=c(201),Xb=c(1089);class Xa{constructor(ka,db,yb,Zb,tc,Pc,Od,ke,od,Pe,Se,ng=null,Dg){this.rcb=Dg;this.ra=new na.a;this.Eza=new eb.a;this.T5=new eb.a;this.mD=new eb.a;this.qte=new eb.a;this.Krc=new Ga.a(wa.a.Fh());this.SMe=new hb.a;this.JSb=new eb.a;this.mte=new eb.a;this.Bed=new eb.a;this.KSb=new eb.a;this.Xoc=new eb.a;this.Ced=new eb.a;this.Pgd=new eb.a;this.Kpd=[];
this.Lpd=[];this.fxc=null;this.Jck=new Ga.a(wa.a.Fh());this.ote=new Map;this.Hrc=new Map;this.hqc=null;this.Sja=new eb.a;this.dJc=null;this.uah=this.F_g=0;this.$Xa=null;this.Sgl=()=>{if(this.Kpd.length||this.Lpd.length)try{0<this.Kpd.length&&this.Man(),0<this.Lpd.length&&this.xSo()}finally{this.LZk()}else this.Gb.Xe(this.fxc),this.fxc=null};this.HZk=()=>{const gi=new hb.a;for(const qh of this.mD.values)if(gi.add(qh),gi.count===Xa.Tck)break;for(const qh of gi)this.jCb(qh),this.aOb(qh,za.a.getTypeName());
this.mD.count||(this.Gb.Xe(this.hqc),this.hqc=null)};this.W_c=(gi,qh)=>{for(const ym of qh.Nj)gi=ym.intent,!gi.type&&this.qso(gi.intent,ym.cpBegin,ym.cpEnd,ym.ZIb)&&this.jCb(gi.intent)};this.w8j=ka.$("AugLoopAnnotationsAttachingIsEnabled");this.ijk=ka.LC("SendReleaseMessageAnnotationList")||[];this.ld=Pe;this.iJa=ng;this.WKa=Pc;this.KF=Od;this.Jn=yb;this.hC=ke;this.kaa=od;this.wI=Zb;this.ri=db;this.Gb=tc;L.a.instance.resolve("Box4.ICharacterPropertiesEditor").O_e(this.W_c);this.Us=Se;this.EWj=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",
!1);this.l8j=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1);this.Z9j=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContext",!1);this.J1g=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContextLogs",!1);this.rcb&&this.Xom();this.Wy=ob.a.instance}get c$i(){return this.KSb}set c$i(ka){this.KSb=ka}nb(ka,db){a.ULS.sendTraceTag(41521862,Xa.Ci,50,"New registration for annotation type: {0}.",db);this.addHandler(ka,
db);this.HYe(db).catch(yb=>{a.ULS.sendTraceTag(594396739,Xa.Ci,10,"Failed to activate annotation type {0}: {1}",db,yb.toString())})}addHandler(ka,db){if(ka&&db&&""!==db){var yb=null;({value:yb}=this.KSb.Dc(db,yb)).returnValue?yb.add(ka):(yb=new hb.a,yb.add(ka),this.KSb.add(db,yb))}else a.ULS.sendTraceTag(41521861,Xa.Ci,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!ka,!db,""===db)}sc(ka,db){a.ULS.sendTraceTag(41521863,Xa.Ci,50,"Unregister handler for annotation type: {0}.",
db);let yb=null;({value:yb}=this.KSb.Dc(db,yb)).returnValue&&(yb.remove(ka),yb.count||(a.ULS.sendTraceTag(41521864,Xa.Ci,50,"Unregister all handlers for annotation type: {0}.",db),this.KSb.remove(db),this.Iln(db)))}Mnj(ka){this.dJc||(this.dJc=this.Us.Oc(2),this.dJc.Cb(ka))}LZk(){var ka;null===(ka=this.dJc)||void 0===ka?void 0:ka.dispose();this.dJc=null}YKh(){this.fxc||(this.fxc=new oa.a(4,2,100,this.Sgl,141),this.Gb.Vb(this.fxc))}Man(){let ka;ka=Array.dequeue(this.Kpd);const db=Bb.a.ZEb(this.wI.value,
ka);if(db)if(db.qj){this.Mnj(db);var yb=null;if(({value:yb}=this.Xoc.Dc(ka,yb)).returnValue){this.Xoc.remove(ka);for(const Zb of yb)this.Nan(db,Zb)}else a.ULS.sendTraceTag(50663568,Xa.Ci,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.Jck.add(ka);else a.ULS.sendTraceTag(50436127,Xa.Ci,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}Nan(ka,db){var yb=db.content.range;yb=new ub.a(0,yb.start,yb.start+yb.length,ja.a.create(),db,Zb=>{this.qte.Z(db.id,
Zb.toString())});this.Jn.jRa(ka,yb);this.ra.y8&&this.ra.raiseEvent(Xa.Lec,new kb(db,Na.a.getTypeName()))}oNi(ka){const db=Bb.a.D1a(ka.parentPath);let yb=null;({value:yb}=this.Xoc.Dc(db,yb)).returnValue||(yb=new hb.a,this.Xoc.add(db,yb),this.Kpd.push(db));yb.add(ka);this.YKh()}Qan(ka,db){this.ri.ie(()=>{let yb;if(({value:yb}=this.T5.Dc(ka,yb)).returnValue){var Zb=this.Zqj(ka);for(const tc of yb){let Pc;({value:Pc}=this.mD.Dc(tc,Pc)).returnValue&&db(Pc)&&Xa.bHb(Pc)&&(this.oNi(Pc),Zb&&this.ra.raiseEvent(Xa.Lec,
new kb(Pc,za.a.getTypeName())))}}},"AS:MIFAT")}ySo(ka,db){this.ri.ie(()=>{let yb;if(({value:yb}=this.T5.Dc(ka,yb)).returnValue)for(const Zb of yb){let tc;({value:tc}=this.mD.Dc(Zb,tc)).returnValue&&db(tc)&&Xa.bHb(tc)&&this.Llg(tc)}},"AS:UIFAT")}Pln(ka){var db=Bb.a.uM(ka);let yb=null;if(({value:yb}=this.Eza.Dc(db,yb)).returnValue){db=0;for(var Zb=new hb.a;yb.count>db;){var tc=yb.J(db),Pc=null;({value:Pc}=this.mD.Dc(tc,Pc)).returnValue&&Xa.bHb(Pc)?this.hC.j8c(ka,Pc)?this.jCb(Pc,!this.ld.isFeatureEnabled(88)):
(tc=Pc.content.range,Pc=new ub.a(0,tc.start,tc.start+tc.length,ja.a.create(),Pc),Zb.add(Pc),db++):db++}0<Zb.count&&this.Jn.zMf(ka,Zb)}}xSo(){let ka="";ka=Array.dequeue(this.Lpd);const db=Bb.a.ZEb(this.wI.value,ka);if(db&&12===db.type){this.Mnj(db);var yb=null;({value:yb}=this.Ced.Dc(ka,yb)).returnValue?(this.Jn.Yad(Zb=>yb.contains(Zb.intent),db,0),this.Ced.remove(ka)):a.ULS.sendTraceTag(50663570,Xa.Ci,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")}else a.ULS.sendTraceTag(50436128,
Xa.Ci,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}Llg(ka){let db;({value:db}=this.qte.Dc(ka.id,db)).returnValue||(db=Bb.a.D1a(ka.parentPath));this.qte.remove(ka.id);var yb=null;({value:yb}=this.Ced.Dc(db,yb)).returnValue||(yb=new hb.a,this.Ced.add(db,yb),this.Lpd.push(db));yb.add(ka);this.YKh();yb=null;({value:yb}=this.Xoc.Dc(db,yb)).returnValue&&yb.remove(ka)}fuk(ka){const db=ka.id;var yb=ka.annotationType;const Zb=ka.parentPath;if(this.hC.akb(ka)){var tc=Bb.a.Vhb(this.wI.value,
Zb);if(tc&&(tc=tc.ia(qa.a.uj,0).toString(),ka.parentRevId&&tc!==ka.parentRevId))return!1}tc=null;({value:tc}=this.T5.Dc(yb,tc)).returnValue||(tc=new hb.a,this.T5.add(yb,tc));tc.add(db);yb=null;({value:yb}=this.Eza.Dc(Zb,yb)).returnValue||(yb=new hb.a,this.Eza.add(Zb,yb));yb.add(db);this.mD.add(db,ka);this.A4o(ka);return!0}A4o(ka){const db=this.hC.q4h(ka);if(0===db.length)this.QSh(ka);else{let yb=!1;this.WKa.Jsn(db,ka.annotationType,(Zb,tc)=>{this.mD.mb(ka.id)?(tc=this.hC.skb(ka,Bb.a.DNl(ka)),!Zb&&
tc?this.Wmg(ka,10,!1):Zb&&this.Wmg(ka,Zb),yb||(this.QSh(ka),yb=!0)):tc.sTa=!0})}}QSh(ka){const db=Xa.bHb(ka);db&&this.oNi(ka);!db&&this.ra.y8&&this.ra.raiseEvent(Xa.Lec,new kb(ka,Na.a.getTypeName()))}XEj(ka,db,yb,Zb){let tc=!0;this.ri.ie(()=>{if(Zb.startsWith(Bb.a.wCb)){var Pc=ka.id,Od=null;if(db===za.a.getTypeName())this.jCb(ka);else if(({value:Od}=this.mD.Dc(Pc,Od)).returnValue)a.ULS.sendTraceTag(41418891,Xa.Ci,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",Pc,ka.annotationType),
this.mD.Z(Pc,ka);else if(!this.fuk(ka)){tc=!1;return}yb&&db===Na.a.getTypeName()&&Zb!==Bb.a.wCb&&this.SMe.add(ka.annotationType)}this.aOb(ka,db)},"AS:UAS");return tc}gio(ka){if(ka)for(const db of ka)this.aOb(db,la.a.getTypeName()),ka=db.content,this.Pgd.mb(ka.categoryName)?this.Pgd.Z(ka.categoryName,db):this.Pgd.add(ka.categoryName,db);else a.ULS.sendTraceTag(592802119,Xa.Ci,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}Qxk(ka){this.ra.addHandler(Xa.Lec,ka)}oqh(ka){this.ra.addHandler(Xa.uTi,
ka)}$$b(ka){return this.JSb.mb(ka)}Pxk(ka){this.ra.addHandler(Xa.y6d,ka)}Y1n(ka){this.ra.removeHandler(Xa.y6d,ka)}Zqj(ka){return!Bb.a.jf(ka)&&Ea.a(ka)&&this.ra.y8}jCb(ka,db=!0){if(this.mD.mb(ka.id)){var yb=this.mD.J(ka.id);this.mD.remove(ka.id);var Zb=null;({value:Zb}=this.Eza.Dc(ka.parentPath,Zb)).returnValue?(Zb.remove(ka.id),Xa.bHb(yb)&&this.Llg(yb)):a.ULS.sendTraceTag(50734169,Xa.Ci,15,"DeleteAnnotationFromStorage: No annotations in given parent path");Zb=null;({value:Zb}=this.T5.Dc(ka.annotationType,
Zb)).returnValue?Zb.remove(ka.id):a.ULS.sendTraceTag(50734170,Xa.Ci,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.Zqj(ka.annotationType)?this.ra.raiseEvent(Xa.Lec,new kb(yb,za.a.getTypeName())):this.aOb(ka,za.a.getTypeName());db&&this.kaa.zHj(yb,za.a.getTypeName())}}Hnf(ka,db,yb=!1){const Zb=new hb.a;var tc;if(!({value:tc}=this.T5.Dc(ka,tc)).returnValue)return Zb;for(const Pc of tc)this.mD.mb(Pc)?(ka=this.mD.J(Pc),(tc=this.hC.QOd(ka))&&(db.equals(tc)||
yb&&db.overlaps(tc))&&Zb.add(ka)):a.ULS.sendTraceTag(577843217,Xa.Ci,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",Pc);return Zb}vId(ka){let db=null;if(({value:db}=this.T5.Dc(ka,db)).returnValue){ka=db.toArray();for(const yb of ka){let Zb;({value:Zb}=this.mD.Dc(yb,Zb)).returnValue&&this.jCb(Zb)}}}fJm(ka){return va.a.getTypeNameFor(ka)===dc.a.getTypeName()}gwi(ka){var db,yb;return(null===(yb=null===(db=this.rcb)||void 0===db?void 0:db.Cbi)||void 0===yb?void 0:
yb.call(db))===pb.a.Xnc&&ka&&0===ka.priority?this.rcb.y$c(ka.context.substr(ka.startInContext,ka.range.length)):!1}M4i(ka,db){this.ri.ie(()=>{a.ULS.Y9(Xa.Ci,100)&&a.ULS.sendTraceTag(41418894,Xa.Ci,100,"Operation of type {0} with path {1} received",va.a.getTypeNameFor(ka),ka.parentPath.join("\\"));try{const yb=new vb(ka);for(const Zb of yb.annotations)if(Zb.annotationType===Vb.FlagResultAnnotation.getTypeName()){const tc=Zb.content.results.map(Pc=>{var Od;const ke=null===(Od=Pc.M_)||void 0===Od?void 0:
Od.seq;Od=void 0===ke?Zb.id:Zb.id+"_"+ke;return{id:Od,body:{...Pc,id:Od},source:"",revId:"",contextId:"",sourceTimestamp:Date.now()}});this.M4i({items:tc,parentPath:ka.parentPath,parentRevId:ka.parentRevId,H_:ka.H_},db)}else yb.n1e===Na.a.getTypeName()&&this.dvo(Zb)?(y.AFrameworkApplication.ue("g8469255;j5hhe441"),this.J1g&&(this.$Xa||(this.$Xa=Xb.a.hOd()),this.F_g++,this.$Xa.wnh("AnnotationSkippedDueToInvalidContextCount",this.F_g.toString()))):this.JUd(Zb,db,yb.n1e,!0)}catch(yb){a.ULS.sendTraceTag(41418898,
Xa.Ci,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",yb.message,yb.stack)}},"AS:PO")}dvo(ka){var db;y.AFrameworkApplication.ue("01dfc961;05c12706");if(this.Z9j&&Ea.a(ka.annotationType)){var yb;let tc=yb=null;if(this.Wy){yb=this.Wy.L3;var Zb=null===yb||void 0===yb?void 0:yb.node;yb=Bb.a.D1a(ka.parentPath);if(Bb.a.ZEb(this.wI.value,yb)!==Zb)return!1;ka=ka.content;yb=ka.context.substring(ka.startInContext,ka.startInContext+ka.range.length);tc=null===(db=null===Zb||
void 0===Zb?void 0:Zb.characterData)||void 0===db?void 0:db.substring(ka.range.start,ka.range.start+ka.range.length);this.J1g&&ka&&0===ka.priority&&(db=0<ka.range.start?Zb.characterData.charAt(ka.range.start-1):null,Zb=ka.range.start+ka.range.length<Zb.characterData.length?Zb.characterData.charAt(ka.range.start+ka.range.length):null,"en-us"==ka.language.toLocaleLowerCase()&&tc&&yb&&tc===yb&&(db&&db.match("[A-Za-z0-9]")||Zb&&Zb.match("[A-Za-z0-9]"))&&(this.$Xa||(this.$Xa=Xb.a.hOd()),this.uah++,this.$Xa.wnh("partialWordAnnotationsCount",
this.uah.toString())))}return tc&&yb&&tc!==yb?!0:!1}return!1}JUd(ka,db,yb,Zb){if(this.fJm(ka.content)&&this.gwi(ka.content))this.fza(ka,70);else{var tc=ka.parentPath;yb!==za.a.getTypeName()&&Zb||this.P$i(ka);Zb&&yb===Na.a.getTypeName()&&Ea.a(ka.annotationType)&&ka.content.isHotCritique&&this.l8j?this.Hrc.set(ka.id,{annotation:ka,time:Date.now()}):(Zb=ka.annotationType,Bb.a.jf(Zb)||Zb!==ia.a.getTypeName()?!Bb.a.jf(Zb)&&Ea.a(Zb)&&ka.content&&0==ka.content.priority&&hc.a.p4?(ka=Bb.a.D1a(tc))&&ka==hc.a.ULl()&&
a.ULS.sendTraceTag(539870169,Xa.Ci,10,"Skipping the Spelling Error Annotation as Text Prediction is visible"):yb!==za.a.getTypeName()&&this.Krc.contains(tc)?a.ULS.sendTraceTag(41418897,Xa.Ci,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",tc,ka.id):this.VEj(ka,tc,yb,db):a.ULS.sendTraceTag(595342670,Xa.Ci,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",tc))}}b_n(ka){if(ka&&ka.annotationType&&this.hC.aac(ka.annotationType)){var db;
if(({value:db}=this.T5.Dc(ka.annotationType,db)).returnValue&&(ka=this.hC.QOd(ka)))for(const yb of db){let Zb;({value:Zb}=this.mD.Dc(yb,Zb)).returnValue&&(db=this.hC.QOd(Zb))&&(ka.equals(db)||ka.overlaps(db))&&this.jCb(Zb)}}}aOb(ka,db){this.ri.ie(()=>{let yb=null;if(({value:yb}=this.c$i.Dc(ka.annotationType,yb)).returnValue)for(const Zb of yb)Zb.EA(ka,db)},"AS:SATH")}GZk(){a.ULS.sendTraceTag(50860999,Xa.Ci,50,"ClearStorage: Initiated Clearing Storage");this.hqc||(this.hqc=new oa.a(4,2,100,this.HZk,
142),this.Gb.Vb(this.hqc))}activateAnnotation(ka,db){let yb;if(({value:yb}=this.Bed.Dc(ka,yb)).returnValue){if(yb.contains(db))return Promise.resolve(null);yb.add(db)}else{let Zb;this.Bed.add(ka,(Zb=new hb.a,Zb.add(db),Zb))}return this.HYe(ka)}HYe(ka){a.ULS.sendTraceTag(41521865,Xa.Ci,50,"ActivateAnnotation: Activating annotation type {0}.",ka);if(this.JSb.mb(ka))return Promise.resolve(null);var db=null;if(({value:db}=this.mte.Dc(ka,db)).returnValue)return db;this.Wqk(ka);db=null;this.iJa&&(db=this.iJa());
if(db){const yb=new Ha.a;yb.annotationType=ka;this.EWj&&(this.Sja.mb(ka)||this.Sja.Z(ka,new Ua),yb.stateUpdateHandler=(Zb,tc)=>{this.Sja.J(ka).oldState=Zb;this.Sja.J(ka).newState=tc;for(const Pc of this.Sja.J(ka).handlers)Pc(ka,Zb,tc)});db=db.activateAnnotation(yb);this.mte.add(ka,db);return db.then(Zb=>{this.mte.remove(ka);this.JSb.add(ka,Zb.token);this.WEj(Zb.token,ka);this.ra.raiseEvent(Xa.y6d,new $a(ka,!0));this.Vom(ka);return Zb})}return Promise.reject(Error.create("Error during annotation activation"))}Vom(ka){const db=
this.hC.eki(ka);db&&this.WKa.jei(db,yb=>{if(this.kaa.AVf){var Zb=Wa.ParagraphReader.tw(Bb.a.getRootNode(),!0,!0);if(Zb&&0<Zb.count){let tc=0;for(const Pc of Zb){Zb=Ib.wRd(Pc);if(!Zb)continue;let Od=!1;for(;tc<yb.length;){if(Zb===yb[tc]){Od=!0;break}tc++}if(!Od){this.kaa.AVf(db);break}tc++}}}})}Wqk(ka){this.kaa.B4o(ka,(db,yb)=>{0<this.Hnf(ka,yb,!0).count||this.XEj(db,Na.a.getTypeName(),!0,db.parentPath)},(db,yb)=>{if(3!==yb.Ov)a.ULS.sendTraceTag(591541786,Xa.Ci,15,"Annotation moved to unsupported location type: {0}",
yb.Ov);else if(db.Ov!==yb.Ov)a.ULS.sendTraceTag(591541787,Xa.Ci,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",db.Ov,yb.Ov);else{db=this.Hnf(ka,db);for(const tc of db){const Pc=tc.content;db=Bb.a.Vhb(this.wI.value,tc.parentPath);if(!db){a.ULS.sendTraceTag(591541788,Xa.Ci,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.Jn.Yad(Od=>Od.intent===Pc,db,0))break;var Zb=yb.Rta;Zb=new ub.a(0,Zb,Zb+yb.Qta,null,Pc);this.Jn.jRa(db,
Zb)}}},db=>{for(const yb of this.Hnf(ka,db))this.jCb(yb,!1)})}releaseAnnotation(ka,db){let yb;if(({value:yb}=this.Bed.Dc(ka,yb)).returnValue){yb.contains(db)&&yb.remove(db);if(0<yb.count)return Promise.resolve(!1);this.Bed.remove(ka)}a.ULS.sendTraceTag(593790408,Xa.Ci,50,"ReleaseAnnotation: Releasing annotation type {0}.",ka);return this.Djj(ka)}Iln(ka){var db=null;if(({value:db}=this.T5.Dc(ka,db)).returnValue){a.ULS.sendTraceTag(41418899,Xa.Ci,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",
ka);for(const yb of db)if(db=null,({value:db}=this.mD.Dc(yb,db)).returnValue){const Zb=db.parentPath;let tc=null;({value:tc}=this.Eza.Dc(Zb,tc)).returnValue&&(tc.remove(yb),tc.count||this.Eza.remove(Zb));this.mD.remove(yb);Xa.bHb(db)&&this.Llg(db)}this.T5.remove(ka)}Array.contains(this.ijk,ka)&&this.Djj(ka)}Djj(ka){let db=null,yb=null;this.iJa&&(yb=this.iJa());if(yb){if(({value:db}=this.JSb.Dc(ka,db)).returnValue){const Zb=new ra;Zb.token=db;this.JSb.remove(ka);this.ra.raiseEvent(Xa.y6d,new $a(ka,
!1));return yb.releaseAnnotation(Zb)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}xGi(){this.ri.ie(()=>{if(this.w8j){var ka=Bb.a.getRootNode();if(ka){var db=new eb.a;jb.f(ka,yb=>{var Zb=Bb.a.uM(yb),tc=null;if(({value:tc}=this.Eza.Dc(Zb,tc)).returnValue)for(const Pc of tc)Zb=null,({value:Zb}=this.mD.Dc(Pc,Zb)).returnValue&&(Zb.parent=yb,Zb.UUc=!0,Zb.uLb=2,db.mb(Zb.annotationType)||db.Z(Zb.annotationType,new hb.a),db.J(Zb.annotationType).add(Pc),
tc=null,({value:tc}=this.T5.Dc(Zb.annotationType,tc)).returnValue&&tc.remove(Zb.id));return!0},12);for(const yb of this.T5.keys)if(ka=null,({value:ka}=this.T5.Dc(yb,ka)).returnValue)for(const Zb of ka)if(ka=null,({value:ka}=this.mD.Dc(Zb,ka)).returnValue){let tc=null;ka.parentPath===Bb.a.wCb?(ka.uLb=1,ka.parent=null):({value:tc}=this.mD.Dc(ka.parentPath,tc)).returnValue?(ka.uLb=3,ka.parent=tc):(ka.uLb=0,ka.parent=null,a.ULS.sendTraceTag(41554060,Xa.Ci,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",
ka.id));ka.UUc=!0;db.mb(ka.annotationType)||db.Z(ka.annotationType,new hb.a);db.J(ka.annotationType).add(Zb)}else a.ULS.sendTraceTag(41997840,Xa.Ci,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",Zb);else a.ULS.sendTraceTag(41997841,Xa.Ci,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",yb);this.T5=db;this.SMe.clear()}else a.ULS.sendTraceTag(41554058,Xa.Ci,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,
Xa.Ci,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}jDk(ka){this.M4i(ka,!0)}Wvn(ka,db){this.ri.ie(()=>{const yb=db?db+String.format("\\{0}",ka.id):Bb.a.uM(ka);a.ULS.sendTraceTag(41418900,Xa.Ci,50,"OnTileDeleted: Tile delete event received for tile {0}.",yb);this.Krc.contains(yb)||this.Krc.add(yb);var Zb=null;if(({value:Zb}=this.Eza.Dc(yb,Zb)).returnValue){a.ULS.sendTraceTag(41418901,Xa.Ci,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",Zb.count,
yb);for(const tc of Zb)Zb=null,({value:Zb}=this.mD.Dc(tc,Zb)).returnValue&&(this.aOb(Zb,za.a.getTypeName()),this.ra.y8&&this.ra.raiseEvent(Xa.Lec,new kb(Zb,za.a.getTypeName())),this.mD.remove(tc));this.Eza.remove(yb)}},"AS:OTD")}Vvn(ka){ka=Bb.a.uM(ka);this.Krc.remove(ka)&&a.ULS.sendTraceTag(41418902,Xa.Ci,50,"OnTileAdded: Deleted tile {0} was re-added.",ka)}mZo(ka){if(ka){a.ULS.sendTraceTag(50436131,Xa.Ci,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",ka.count);var db=new eb.a;
for(var yb of ka)ka=null,({value:ka}=db.Dc(yb.parentPath,ka)).returnValue||(ka=new eb.a,db.add(yb.parentPath,ka)),ka.Z(yb.id,yb);for(const Zb of db){db=Bb.a.Vhb(this.wI.value,Zb.key);if(!db){a.ULS.sendTraceTag(50436160,Xa.Ci,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}yb=new ab.a([0]);for(let tc=0,Pc=db.pa.length;tc<Pc;tc++)ka=db.pa.J(tc),ka.Nj&&yb.rUa(ka.Nj,void 0,(Od,ke)=>{if(ke){var od=null,Pe=ke.intent;Pe&&({value:od}=Zb.value.Dc(Pe.id,od)).returnValue&&(Pe=new pa.a,
Pe.start=ke.Ib.cp,Pe.length=Od.Ib.cp-Pe.start,od.content.range=Pe,od.ixa=!1)}})}}else a.ULS.sendTraceTag(50436130,Xa.Ci,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(ka){a.ULS.sendTraceTag(593049729,Xa.Ci,50,"GetAnnotationsByType: Method called for type {0}.",ka);return this.HYe(ka).then(()=>{const db=new hb.a;this.ri.ie(()=>{if(Bb.a.jf(ka)||ka!==ia.a.getTypeName()){this.SMe.contains(ka)&&this.xGi();var yb=null;if(({value:yb}=this.T5.Dc(ka,yb)).returnValue){a.ULS.sendTraceTag(41418903,
Xa.Ci,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",ka);var Zb=new hb.a;for(const tc of yb)yb=null,({value:yb}=this.mD.Dc(tc,yb)).returnValue&&(yb.ixa&&Zb.add(yb),db.add(yb));Zb&&0<Zb.count&&Xa.bHb(Zb.J(0))&&this.mZo(Zb)}}else for(Zb of this.Pgd.values)db.add(Zb);db.count||a.ULS.sendTraceTag(41418904,Xa.Ci,50,"GetAnnotationsByType: No annotations found for type {0}!",ka)},"AS:GABT");return db},db=>{a.ULS.sendTraceTag(41418905,Xa.Ci,10,"Exception occurred while fetching annotations of type {0}: {1}",
ka,db);return null})}Fga(ka){let db=null;return({value:db}=this.mD.Dc(ka,db)).returnValue?db:null}E4h(ka){let db=null;if(this.Eza.mb(ka))for(const yb of this.Eza.J(ka))if(ka=this.Fga(yb))db||(db=new hb.a),db.add(ka);return db}dJb(ka){return(ka=this.Fga(ka))?(ka.UUc||this.xGi(),ka):null}fza(ka,db){this.Doo(ka,db);this.Wmg(ka,db);this.aOb(ka,la.a.getTypeName())}pUo(ka,db){this.gYo(ka,db);this.Plo(ka,Bb.a.CNl(ka));this.aOb(ka,la.a.getTypeName())}qUo(ka,db){ka=this.hC.q4h(ka);for(const yb of ka)this.KF.Hmg(this.wI.value,
yb,db)}Doo(ka,db){let yb=null;this.iJa&&(yb=this.iJa());yb&&(ka=this.ENl(ka,db))&&yb.setAnnotationState(ka)}Wmg(ka,db,yb=!0){if(ka&&Xa.bvi(ka)){var Zb=this.Fga(ka.id);!ka.content||Zb&&ka.content===Zb.content||Bb.a.setAnnotationState(ka,db);Zb&&Zb.content&&Bb.a.setAnnotationState(Zb,db);yb&&this.ra.y8&&(70===db||60===db)&&this.ra.raiseEvent(Xa.uTi,new Mb(ka,db))}}ENl(ka,db){let yb=null;ka&&(yb=Object.assign(new ya,{id:ka.id,value:db}),Bb.a.jf(ka.parentPath)||(yb.parentPath=ka.parentPath.split("\\")));
return yb}Plo(ka,db){const yb=this.iJa?this.iJa():null;yb&&(ka=this.BNl(ka,db))&&yb.setAnnotationMetadata(ka)}gYo(ka,db){if(ka&&Xa.bvi(ka)){var yb=this.Fga(ka.id);!ka.content||yb&&ka.content==yb.content||Bb.a.nkj(ka,db);yb&&yb.content&&Bb.a.nkj(yb,db)}}BNl(ka,db){if(!ka)return null;const yb=new Ma;yb.id=ka.id;yb.value=db;Bb.a.jf(ka.parentPath)||(yb.parentPath=ka.parentPath.split("\\"));return yb}qso(ka,db,yb,Zb){const tc=ka.content;if(this.hC.akb(ka)&&tc){const Pc=tc.range.start+tc.range.length;if(0<
Zb&&Pc<=yb||0>Zb&&Pc<=yb+Zb)return!1;if(0<Zb&&tc.range.start>=db||0>Zb&&tc.range.start>=yb)return tc.range.start+=Zb,!1}return!this.ld.isFeatureEnabled(61)&&tc&&tc.M_?(ka=this.hC.skb(ka,60),!(60===tc.M_.state&&ka)):!0}Bnh(ka,db){this.Sja.mb(db)||this.Sja.Z(db,new Ua);this.Sja.J(db).handlers.add(ka);ka(db,this.Sja.J(db).oldState,this.Sja.J(db).newState)}x$i(ka,db){this.Sja.mb(db)&&this.Sja.J(db).handlers.contains(ka)&&this.Sja.J(db).handlers.remove(ka)}static bvi(ka){ka=va.a.getBaseTypesFor(ka.content);
return Array.contains(ka,Va.a.getTypeName())}static bHb(ka){if(void 0===ka.content||null===ka.content||""===Bb.a.D1a(ka.parentPath))return!1;const db=va.a.getBaseTypesFor(ka.content);return Array.contains(db,sa.a.getTypeName())&&ka.annotationType!==Ia.RoleDetectionAnnotation.getTypeName()}oUo(ka){ka?(this.ote.AugLoop_Text_Critique=ka,ka=this.$$b("AugLoop_Text_Critique")?this.JSb.J("AugLoop_Text_Critique"):null,this.WEj(ka,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,Xa.Ci,50,"Annotation configuration could not be updated for annotation type: {0}.",
"AugLoop_Text_Critique")}WEj(ka,db){if(ka&&this.ote[db]){const yb=new $b;yb.token=ka;yb.config=this.ote[db];this.iJa&&(this.iJa().updateAnnotationConfig(yb),a.ULS.sendTraceTag(540615553,Xa.Ci,50,"Annotation configuration has been updated for annotation type: {0}.",db))}}P$i(ka){let db=null;({value:db}=this.mD.Dc(ka.id,db)).returnValue&&(ka.annotationType=db.annotationType);this.Hrc.has(ka.id)&&this.Hrc.delete(ka.id)}VEj(ka,db,yb,Zb){this.b_n(ka);this.XEj(ka,yb,Zb,db)&&this.kaa.zHj(ka,yb)}xSa(ka){const db=
ka.parentPath,yb=za.a.getTypeName();this.P$i(ka);this.fza(ka,70);this.Krc.contains(db)||this.VEj(ka,db,yb,!0)}g3l(ka){const db=new hb.a;ka=this.T5.Dc(ka).value;if(null===ka)return db;for(const yb of ka)ka=this.mD.Dc(yb).value,null!==ka&&db.push(ka);return db}async Xom(){await Object(Ob.b)();this.J$i()}J$i(){const ka=this.g3l(dc.a.getTypeName());for(const db of ka)this.gwi(db.content)&&this.xSa(db)}}Xa.Ci=389;Xa.Lec="OnAnnotationOperation";Xa.uTi="OnAnnotationLocalStateChange";Xa.y6d="OnAnnotationActivationChange";
Xa.Tck=20;Object(f.a)(Xa,"AnnotationStorage",null,[439]);class Pb{constructor(){this.Lfe=null;this.s8c=!1}}Object(f.a)(Pb,"AugmentationLoopStateManager",null,[437]);var rc=c(196),Ta=c(566),Ab=c(67),Db=c(104),ac=c(587),Pa=c(229);class bb extends Pa.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=
!1}fl(){return 102}static construct(ka,db,yb,Zb,tc,Pc){const Od=new bb;Od.ExpectedEndRevisionId=ka;Od.OriginString=db;Od.Authorization=yb;Od.AugLoopSeedUrl=Zb;Od.FileId=tc;Od.SeedBatchesInParallelIsEnabled=Pc;Od.AddDocumentKindTypeToPathIsEnabled=!0;Od.CheckOnDemandNodeVersionEnabled=!0;Od.AddSubDocumentKindTypeToPathIsEnabled=!0;return Od}}Object(f.a)(bb,"FullFileAugLoopSeedingRequest",Pa.a,[]);class lc{constructor(){this.authToken=this.url=this.RZi=null}}Object(f.a)(lc,"ReseedingTaskInfo",null,
[]);class rb{constructor(ka,db,yb,Zb,tc,Pc){this.C$=null;this.GWg=!1;this.oUb=null;this.mQe=0;this.x2c=(Od,ke)=>{Od=ke.Vaa;this.oUb&&Db.AT(Od,od=>od===this.oUb)&&(ke.httpStatusCode!==rc.a.My||ke.UH||2!==ke.vZf?ke.httpStatusCode!==rc.a.My||ke.UH||1!==ke.vZf?this.kfj(()=>{a.ULS.sendTraceTag(50861003,rb.Ci,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",ke.httpStatusCode,
ke.UH,ke.vZf,ke.Lr)}):(this.RN.s8c=!1,this.C$.eNb(this.x2c),this.Se.GZk(),a.ULS.sendTraceTag(50861002,rb.Ci,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),Od=Object(Ab.a)(lc,this.oUb),this.l6i(ke.H9n,Od.RZi,Od.url,Od.authToken)):this.kfj(()=>{a.ULS.sendTraceTag(50861001,rb.Ci,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.fCl=Od=>{if(void 0===Od||null===Od||void 0===Od.data||null===Od.data||void 0===Od.data.ve||null===Od.data.ve)a.ULS.sendTraceTag(41445393,
rb.Ci,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(Od.data.Qe!==rc.a.My)a.ULS.sendTraceTag(41445394,rb.Ci,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",Od.data.Qe);else try{let ke;({group:ke}=Ta.a.q1(Od.data.ve)).returnValue?ke.Responses&&ke.Responses.length?(Od=null,ke&&ke.Responses&&ke.Responses.length&&(Od=ke.Responses[0])?(this.C2.mUa(Od),Od.StatusCode?a.ULS.sendTraceTag(41445398,rb.Ci,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",
Od.StatusCode):a.ULS.sendTraceTag(41445399,rb.Ci,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",Od.LastSeededRevisionId)):a.ULS.sendTraceTag(41445397,rb.Ci,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):a.ULS.sendTraceTag(41445396,rb.Ci,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):
a.ULS.sendTraceTag(41445395,rb.Ci,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(ke){a.ULS.sendTraceTag(41445400,rb.Ci,10,"FileSeedingSuccessCallback: {0}",ke.message)}};this.eCl=Od=>{void 0===Od||null===Od||void 0===Od.data||null===Od.data||void 0===Od.data.ve||null===Od.data.ve?a.ULS.sendTraceTag(41445401,rb.Ci,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):a.ULS.sendTraceTag(41445402,rb.Ci,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",
Od.data.Qe)};this.zXj=ka.$("AugLoopServerSideSeedingIsEnabled");this.xXj=ka.$("AugLoopReseedingIsEnabled");this.yXj=ka.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.G6g=ka.mc("MaxReseedingRetries",1);this.Xf=db;this.Pkd=yb;this.RN=Zb;this.C2=tc;this.Se=Pc;U.App.xa&&U.App.xa.ib&&U.App.xa.ib.Uc&&U.App.xa.ib.Uc.contentReplicator&&(this.C$=U.App.xa.ib.Uc.contentReplicator)}pBm(ka,db,yb){if(this.zXj){var Zb=this.RN.Lfe;Zb&&Zb.trim().length?this.GWg?this.xXj&&(a.ULS.sendTraceTag(50861E3,rb.Ci,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),
this.mQe=0,this.C$?(this.RN.s8c=!0,this.C$.P0b(this.x2c),this.oUb=Object.assign(new lc,{RZi:ka,url:db,authToken:yb}),this.C$.cF(null,null,this.oUb)):a.ULS.sendTraceTag(592814793,rb.Ci,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,rb.Ci,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),this.l6i(Zb,ka,db,yb),this.GWg=!0):a.ULS.sendTraceTag(41445391,rb.Ci,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,
rb.Ci,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}kfj(ka){this.mQe<this.G6g?(a.ULS.sendTraceTag(594384E3,rb.Ci,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",++this.mQe,this.G6g),this.C$.cF(null,null,this.oUb)):(this.RN.s8c=!1,this.C$.eNb(this.x2c),ka())}l6i(ka,db,yb,Zb){const tc=bb.construct(ka,db,Zb,yb,y.AFrameworkApplication.rootQuerySignature,this.yXj);
a.ULS.sendTraceTag(595178454,rb.Ci,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.Pkd.m2a.execute(()=>{this.Avk(tc)})}Avk(ka){a.ULS.sendTraceTag(595178453,rb.Ci,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");this.Xf.xj(U.App.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,ac.b(ka),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.fCl,this.eCl,ka);a.ULS.sendTraceTag(42016906,
rb.Ci,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}rb.Ci=389;Object(f.a)(rb,"FullFileAugLoopSeedingService",null,[]);class La{constructor(){}}Object(f.a)(La,"RuntimeManagerInitializationTracker",null,[]);var sb=c(695);class Sb{getAugLoopRuntimeManager(){return sb.a.getAugLoopRuntimeManager()}}Object(f.a)(Sb,"AlFactoryWrapper",null,[436]);class kc{Mk(){return Bb.a.Mk()}}Object(f.a)(kc,"UtilsWrapper",null,[435]);var Lb=c(741),Qc=c(53),Dc=c(16),Fd=c(42),pe=c(153),ye=c(2034),
pf=c(5),Yf=c(103),Ed=c(213),Rc=c(28),Yc=c(350),Mc=c(391),ge=c(92),Ne=c(48);class Ee{constructor(ka,db,yb,Zb,tc){this.Fa=ka;this.Hf=yb;this.Xo=Zb;this.we=tc;this.voa=this.Fa.$("WordDesignerCaptionDetectionEnabled")}Tjo(ka,db){ka.listType=this.Z2l(db);ka.outlineLevel=Wa.ParagraphReader.Ina(db);ka.indentation=Ee.erf(this.Xo.XT(db));ka.alignment=Ee.unf(Wa.ParagraphReader.Gx(db));ka.isInsideTable=this.isInsideTable(db);ka.isInsideTOC=db.xr;ka.rightIndentation=Ee.erf(this.Xo.y1a(db));var yb=this.Xo.X8b(db);
ka.specialIndentType=Ee.Odm(yb);ka.specialIndentBy=Ee.erf(yb);ka.listType!==ye.e.NoList&&this.ylo(db,ka);this.xoo(db,ka);yb=[];this.voa&&(yb=this.SIn(db));ka.formattedRanges=this.QYl(db,yb);this.voa&&null!=yb&&(ka.objectReferences=0<yb.length?yb:void 0)}QYl(ka,db){var yb=ka.pa?ka.pa.length:0,Zb=Yf.FormattingReader.Nr(Rc.a.create(ka));let tc=ge.a.nG,Pc=0,Od=ge.a.oM/2;Zb&&(Od=Yf.FormattingReader.Rn(Zb,Dc.a.fontSize,ge.a.oM)/2,tc=Yf.FormattingReader.Rn(Zb,Dc.a.font,ge.a.nG),Pc=Yf.FormattingReader.language(Zb));
Zb="Normal";var ke=this.we.No(ka);ke&&(Zb=ke.getValue(Fd.a.ka)||"Normal",ke.hasProperty(Dc.a.font)&&(tc=ke.getValue(Dc.a.font)));if(yb){--yb;ke=[];let qh=null,ym=void 0,Ol=null;this.voa&&ka.hasProperty(Dc.a.Gn)&&(Ol=ka.getValue(Dc.a.Gn));const ah=ka.properties.ia(qa.a.gga,null);for(let bk=0;bk<yb;bk++){var od=ka.pa.J(bk),Pe=ka.Kc,Se=null;this.voa&&(Se=Ee.hvf(ka,Ol,bk));od.rf&&(qh=Ee.LVo(Pe,od.rf,qh));od.hyperlink&&od.hyperlink.url?ym=od.hyperlink.url:od.Om&&(ym=void 0);var ng=ka.pa.J(bk+1).cp-1;Pe=
od.cp;ng=ng-od.cp+1;let bj=!1,Il=!1,yj=!1,Jm=Od,Bh=0,Pl=0,Km=Zb,Di=void 0,ln=Pc,Go=tc,ri;if(od.formatting){var Dg=od.formatting;bj=Yf.FormattingReader.Rn(Dg,Dc.a.bold,!1);Il=Yf.FormattingReader.Rn(Dg,Dc.a.italic,!1);yj=Yf.FormattingReader.Rn(Dg,Dc.a.underline,!1);Jm=Yf.FormattingReader.Rn(Dg,Dc.a.fontSize,2*Od)/2;Bh=Yf.FormattingReader.Rn(Dg,Fd.a.capitalization,0);Pl=Yf.FormattingReader.Rn(Dg,Dc.a.fontColor,0);ln=Yf.FormattingReader.language(Dg)||Pc;Go=Yf.FormattingReader.Rn(Dg,Dc.a.font,tc);Km=Zb;
var gi=Dg.yn;gi&&(gi=gi.ia(Fd.a.kw,null))&&!gi.equals(ja.a.nil)&&Dg.paragraph.Kc&&(Dg=Dg.paragraph.Kc.Db(gi))&&(Km=(new Ed.a(Dg)).getValue(Fd.a.ka))}this.voa&&(ri=this.Asf(Se),null!=ri&&this.Eph(db,Se,ri,ke.length,ye.b.Inline));qh&&(Di=0<qh.count);od={isDeleted:this.FJm(ah,od,bk,ym),fontFamily:Go,fontWeight:bj?ye.d.Bold:ye.d.Normal,fontSize:Jm,italic:Il,underline:yj?ye.h.SingleLine:ye.h.None,capitalization:Ee.FJh(Bh),color:Pl,styleName:Km,isFollowUp:Di,languageId:Ee.vJh(ln),start:Pe,length:ng,link:ym,
isReference:Ee.isReference(od)?!0:void 0,objectType:null!==ri&&void 0!==ri?ri:void 0};Se=0<ke.length?ke[ke.length-1]:void 0;Ee.CTk(Se,od)?Se.length+=od.length:ke.push(od)}return ke}return[{fontFamily:tc,fontWeight:ye.d.Normal,fontSize:Od,italic:!1,underline:ye.h.None,capitalization:Ee.FJh(0),color:0,styleName:Zb,isFollowUp:void 0,languageId:Ee.vJh(Pc),start:0,length:ka.characterData.length}]}FJm(ka,db,yb,Zb){if(this.BB()){if(db.blob||db.formatting&&db.formatting.cache&&db.formatting.cache.KHb||Zb)return!0;
if(ka&&yb<ka.length)return ka[yb]}return Ne.a.Vj&&db.iR?!0:db.ei?!0:!1}BB(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static CTk(ka,db){return!!ka&&!!db&&ka.start+ka.length===db.start&&ka.isDeleted===db.isDeleted&&ka.fontFamily===db.fontFamily&&ka.fontWeight===db.fontWeight&&ka.fontSize===db.fontSize&&ka.italic===db.italic&&ka.underline===db.underline&&ka.capitalization===db.capitalization&&ka.color===
db.color&&ka.highlightColor===db.highlightColor&&ka.styleName===db.styleName&&void 0===ka.link&&void 0===db.link&&ka.languageId===db.languageId&&!ka.isReference&&!db.isReference&&!ka.isFollowUp&&!db.isFollowUp&&void 0===ka.objectType&&void 0===db.objectType}Z2l(ka){const db=new pf.GraphIterator;db.set(ka);db.zb(11);db.jd(11);return(ka=this.Hf.qw(db))?Ee.T7k(ka.listType):ye.e.NoList}ylo(ka,db){var yb=this.Hf.MC(ka);yb&&(yb.hasProperty(qa.a.listID)&&(db.listId=yb.getValue(qa.a.listID).toString()),yb=
this.pbi(ka,Dc.a.font),ka=this.pbi(ka,Dc.a.fontSize),yb&&(db.bulletAndNumberFontFamily=yb),ka&&(db.bulletAndNumberFontSize=ka))}isInsideTable(ka){const db=new pf.GraphIterator;db.set(ka);return db.zb(14)}xoo(ka,db){db.spacingBeforeParagraph=this.bhi(ka,qa.a.T4,qa.a.wY,qa.a.Hi);db.spacingAfterParagraph=this.bhi(ka,qa.a.S4,qa.a.vY,qa.a.sa);db.lineSpacing=this.TEb(ka)}bhi(ka,db,yb,Zb){if(Wa.ParagraphReader.Rn(ka,db,!1))return 0;db=Wa.ParagraphReader.Rn(ka,yb,-1);if(0<=db)return db*Yc.a.nLb/100;ka=Wa.ParagraphReader.Rn(ka,
Zb,-1);return 0<=ka?ka/20:0}pbi(ka,db){ka=this.VVl(ka);if(null!=ka&&null!=ka.cache)return ka.cache.getValue(db)}VVl(ka){var db;ka=null===(db=ka.pa)||void 0===db?void 0:db.last;return null!=ka&&ka.Rh?ka.formatting:(a.ULS.sendTraceTag(520680196,389,50,"EOP for list item does not have any formatting applied."),null)}TEb(ka){const db=Wa.ParagraphReader.Rn(ka,qa.a.ya,Yc.a.ya);ka=Wa.ParagraphReader.Rn(ka,qa.a.ua,Yc.a.lineSpacing);switch(db){case 0:return ka/240;case 1:return ka/20;default:return 0}}static LVo(ka,
db,yb){for(let Zb=0;Zb<db.length;Zb++){const tc=db.J(Zb),Pc=tc.ak,Od=ka.Db(Pc);Od&&Od.ia(qa.a.EG,!1)&&(yb||(yb=new Ga.a(new Mc.a)),tc.Mc?yb.add(Pc):yb.remove(Pc))}return yb}static vJh(ka){return(ka=Lb.a.sg(ka))&&ka.name?ka.name.toLowerCase():void 0}static erf(ka){return ka?2===ka.unit?Math.floor(Qc.a.HAb(ka.value)/20):Math.floor(ka.value/20):0}static Odm(ka){if(!ka)return ye.g.Initial;switch(ka.specialIndentType){case 1:return ye.g.FirstLine;case 2:return ye.g.Hanging;default:return ye.g.Initial}}static FJh(ka){switch(ka){case 2:return ye.c.AllCaps;
case 1:return ye.c.SmallCaps;default:return ye.c.NoCaps}}static unf(ka){switch(ka){case 1:return ye.a.Left;case 3:return ye.a.Right;case 2:return ye.a.Center;case 6:return ye.a.Justified;case 0:return ye.a.None;default:return ye.a.Other}}static T7k(ka){switch(ka){case 15:return ye.e.Any;case 1:return ye.e.Bullet;case 42:return ye.e.Invalid;case 13:return ye.e.Lim;case 14:return ye.e.Nil;case 16:return ye.e.NoList;case 0:return ye.e.Numbered;default:return ye.e.Invalid}}static isReference(ka){return ka.blob&&
(7===ka.blob.zh||10===ka.blob.zh)||ka.Dh&&0<ka.Dh.length||ka.rf&&0<ka.rf.length||ka.Jb&&0<ka.Jb.length?!0:!1}static hvf(ka,db,yb){return null==db?null:db[yb]&&!db[yb].equals(ja.a.nil)&&ka.Kc?ka.Kc.Db(db[yb]):null}Asf(ka){if(null==ka)return null;if(ka.hasProperty(qa.a.jt)){var db=ka.getValue(qa.a.jt);if(Ee.h2i.has(db))return Ee.h2i.get(db)}if(ka.hasProperty(qa.a.U6b)&&null!=ka.getValue(qa.a.U6b))return ye.f.FootnoteEndnote;if(ka.hasProperty(qa.a.pageBreak)&&ka.getValue(qa.a.pageBreak))return ye.f.PageBreak;
if(ka.hasProperty(qa.a.oIb)&&ka.getValue(qa.a.oIb))return ye.f.Tab;db=!1;ka.hasProperty(pe.a.g4)?db=ka.getValue(pe.a.g4):ka.hasProperty(qa.a.sha)&&(db=ka.getValue(qa.a.sha));return db&&ka.hasProperty(qa.a.imageType)&&1==ka.getValue(qa.a.imageType)?ye.f.Image:null}static uMm(ka){return ka.hasProperty(qa.a.L9b)&&0<=ka.getValue(qa.a.L9b)?!0:!1}GCi(ka){return Ee.gGo.has(ka)}JMh(ka,db,yb,Zb){return null==ka||null==db?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),
null):Zb===ye.b.Inline&&null==yb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),null):Zb===ye.b.Floating&&null!=yb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),null):0>yb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):Ee.uMm(ka)?null:this.GCi(db)?{referencedPath:["session",
"doc","main",ka.id.toString()],formattedRangeIndex:yb,anchorMode:null!==Zb&&void 0!==Zb?Zb:ye.b.Unspecified,anchoredObjectType:Zb==ye.b.Floating?db:void 0}:null}Eph(ka,db,yb,Zb,tc){db=this.JMh(db,yb,Zb,tc);null!=db&&null!=ka&&ka.push(db)}SIn(ka){const db=[];if(null==ka)return a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),db;let yb=null;ka.hasProperty(qa.a.p7)&&(yb=ka.getValue(qa.a.p7));if(null!=yb)for(let Zb=0;Zb<yb.length;++Zb){const tc=Ee.hvf(ka,
yb,Zb),Pc=this.Asf(tc);null!=Pc&&this.Eph(db,tc,Pc,null,ye.b.Floating)}return db}wIh(ka){if(null==ka||!ka.hasProperty(Dc.a.Gn))return!1;const db=ka.getValue(Dc.a.Gn);for(let Zb=0;Zb<db.length;Zb++){var yb=Ee.hvf(ka,db,Zb);yb=this.Asf(yb);if(this.GCi(yb))return!0}return!1}}Ee.h2i=new Map([[5,ye.f.Image],[11,ye.f.TextBox],[7,ye.f.Chart],[6,ye.f.SmartArt],[10,ye.f.Drawing],[2,ye.f.EquationObject],[4,ye.f.Ink],[19,ye.f.PageBreak],[23,ye.f.FootnoteEndnote],[24,ye.f.FootnoteEndnote],[35,ye.f.FootnoteEndnoteReferenceMark],
[36,ye.f.FootnoteEndnoteReferenceMark],[0,ye.f.Other]]);Ee.gGo=new Set([ye.f.Image,ye.f.TextBox,ye.f.Chart,ye.f.SmartArt,ye.f.Drawing,ye.f.Ink]);Object(f.a)(Ee,"FormattingExtractor",null,[434]);var Ve=c(1213);class mc extends Sys.EventArgs{constructor(ka){super();this.G9b=ka}}Object(f.a)(mc,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class Oc extends Sys.EventArgs{constructor(ka){super();this.L8=ka}}Object(f.a)(Oc,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class xd{constructor(ka,db,yb){this.h_c=
ka;this.graphNode=db;this.fullPath=yb}}Object(f.a)(xd,"NodeEvent",null,[482]);class Dd{constructor(){this.oFe=this.$Ce=!1;this.evb=null;this.ra=new na.a;this.baa=new M.a(0);this.bab=new Ve.a(wa.a.Fh());this.Qvb=new Ve.a(wa.a.Fh());this.Jpd=[]}cqh(ka){this.ra.addHandler("IsCollectingNodeEventsChangedKey",ka)}mZk(){this.baa=new M.a(0);this.G9b=!1}get G9b(){return this.$Ce}set G9b(ka){this.$Ce!==ka&&(this.$Ce=ka,this.ra.raiseEvent("HasNodeEventsChangedKey",new mc(ka),this))}get L8(){return this.oFe}set L8(ka){this.oFe!==
ka&&(this.oFe=ka,this.ra.raiseEvent("IsCollectingNodeEventsChangedKey",new Oc(ka),this))}SNb(ka,db){this.bab.mb(ka)||this.bab.Z(ka,db)}kbo(ka,db){this.Qvb.Z(ka,db)}vNl(ka){let db=null;this.Qvb.mb(ka)&&(db=this.Qvb.J(ka),this.Qvb.remove(ka));return db}Yce(ka,db){if(ka)if(this.L8){var yb=3!==db&&4!==db&&5!==db||!this.bab.mb(String.format("{0}",ka.id))?Bb.a.uM(ka):this.bab.J(String.format("{0}",ka.id));if(({value:Zb}=this.baa.Dc(yb)).returnValue)if(Zb||3!==db)if(5===Zb&&3===db){if(ka=yb.split("\\").pop(),
this.Qvb.mb(ka)){var Zb=this.Qvb.J(ka);Zb===yb?(this.vLf(yb,db),this.baa.add(yb,db)):(this.Qvb.Z(ka,yb),this.bab.Z(ka,Zb),this.yLi(yb),this.baa.remove(yb),this.vLf(yb,db),this.baa.add(Zb,5))}}else Zb&&(4!==Zb||0!==db&&3!==db&&5!==db)&&(this.vLf(yb,db),this.baa.add(yb,db));else this.yLi(yb),this.baa.remove(yb);else this.o9m(yb,db),this.Jpd.push(ka),this.baa.add(yb,db);this.G9b=0<this.baa.count}else a.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,
389,15,"node is null.")}o9m(ka,db){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",ka,db)}vLf(ka,db){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",ka,db)}yLi(ka){a.ULS.sendTraceTag(593761367,389,100,"Removing node {0} form _nodeIdEventKindMap.",ka)}m5k(){let ka=null;var db=!1;let yb=null;for(;this.Jpd.length&&!db;){yb=Array.dequeue(this.Jpd);if(!yb)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),
null;this.bab.mb(String.format("{0}",yb.id))?(ka=this.bab.J(String.format("{0}",yb.id)),this.bab.remove(String.format("{0}",yb.id)),this.Jpd.push(yb)):ka=Bb.a.uM(yb);db=this.baa.mb(ka)}if(!db)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.mZk(),null;db=this.baa.J(ka);this.baa.remove(ka);this.G9b=0<this.baa.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",ka,db);return new xd(db,yb,ka)}xTn(ka){this.evb=ka}n5k(){if(!this.evb)return null;
for(var ka=0;ka<this.evb.length;ka++){var db=this.evb.J(ka);db=Bb.a.uM(db.node);if(this.baa.mb(db))return null}ka=this.evb;this.evb=null;return ka}EZk(){this.evb=null}WCo(){this.L8=!0}UKm(ka){return this.baa.mb(ka.id.toString())}}Object(f.a)(Dd,"NodeEventsCollection",null,[433]);var ud=c(1483),He=c(1407),uf=c(285),Lh=c(105);class Sf extends He.a{constructor(ka,db,yb,Zb,tc,Pc,Od,ke,od,Pe,Se){super();this.gld=new ud.a;this.N$a=!1;this.xsc=null;this.bia=(ng,Dg)=>{(ng=Dg.node)&&this.Q6a(ng)&&(a.ULS.sendTraceTag(40253400,
389,100,"New paragraph Connect event."),Bb.a.auo(ng,this.Wka.L8,this.USb,this.Yik)&&(this.Wka.Yce(ng,0),this.$Fj(ng)));this.Wka.L8&&this.kaa.tmb(ng)};this.FTi=(ng,Dg)=>{ng=Dg.node;this.Wka.SNb(String.format("{0}",ng.id),Bb.a.uM(ng))};this.SKb=(ng,Dg)=>{(ng=Dg.node)&&this.Q6a(ng)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.Wka.L8&&this.Wka.Yce(ng,3));this.Wka.L8&&this.kaa.FWi(ng,3)};this.tY=(ng,Dg)=>{ng=Dg.node;Dg=Dg.property;ng&&this.VWj.has(Dg)&&this.Q6a(ng)&&(a.ULS.sendTraceTag(40253402,
389,100,"New paragraph Modified event."),this.Wka.L8&&(this.Wka.Yce(ng,2),Dg===qa.a.uj&&this.$Fj(ng)));this.Wka.L8&&Dg===qa.a.Lc&&this.kaa.FWi(ng,2)};this.GTi=(ng,Dg)=>{(ng=Dg.node)&&Wa.ParagraphReader.Wb(ng)&&!this.asc.has(ng)&&!this.kAe.has(ng)&&(this.asc.add(ng),this.qY())};this.HWi=(ng,Dg)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(ng=Dg.node)&&this.Se.Pln(ng)};this.vRf=()=>{this.v8c()?this.YM():this.N$a&&!this.Wka.L8&&this.eza()};this.oC=db;this.Wka=yb;this.Yik=Lh.b(Zb.Lfe);
this.USb=ka.$("AugLoopOperationsAreEnabled");this.Se=tc;this.kaa=Pc;this.hC=Od;this.Gb=ke;this.Jn=od;this.KF=Pe;this.asc=new Set;this.kAe=new Set;Se.nqa(this,7);this.VWj=new Set([Dc.a.lo,Dc.a.bold,Dc.a.italic,Dc.a.underline,Dc.a.font,Dc.a.fontSize,Dc.a.fontColor,Fd.a.capitalization,Dc.a.Hh,Dc.a.Gn,qa.a.T4,qa.a.wY,qa.a.Hi,qa.a.S4,qa.a.vY,qa.a.sa,qa.a.ya,qa.a.ua,qa.a.listID,qa.a.UM,qa.a.$d,qa.a.lia,qa.a.nu,qa.a.uj])}get index(){return 7}get q0c(){return this.xsc}set q0c(ka){this.xsc=ka;this.kaa.AVf=
ka?()=>{this.xsc()}:null}init(){this.v8c()&&this.YM();this.Wka.cqh(this.vRf)}YM(){this.oC?(this.N$a=!0,this.oC.$t(this.bia),this.oC.nQ(this.FTi),this.oC.Ax(this.SKb),this.oC.Go(this.tY),this.oC.Lqh(this.HWi),this.oC.byk(this.GTi)):a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}eza(){this.oC?(this.N$a=!1,this.oC.SU(this.bia),this.oC.$ca(this.FTi),this.oC.bqa(this.SKb),this.oC.TU(this.tY),this.oC.Kbj(this.HWi),this.oC.d2n(this.GTi)):a.ULS.sendTraceTag(39403913,
389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}fWd(ka){ka&&this.gld.add(ka.id,ka.ia(qa.a.uj,0))}$Fj(ka){this.gld.mb(ka.id)?(this.kaa.h0o(fa.a.Ije,ka,this.gld.J(ka.id)),this.gld.remove(ka.id)):(this.kaa.yZk(fa.a.Ije),this.q0c&&this.q0c())}Q6a(ka){const db=U.App.xa.ib.rc;return!!db&&db.lv&&!!db.Yc&&!!db.Yc.Kc&&!!ka&&!!ka.Kc&&ka.Kc.id===db.Yc.Kc.id}run(){if(0!==this.asc.size){var ka=[];for(const db of this.asc)ka.push(db),this.kAe.add(db),100<=ka.length&&(this.EWh(ka),
ka=[]);0<ka.length&&this.EWh(ka);this.asc.clear()}}EWh(ka){const db=new oa.a(4,1,500,()=>{for(const yb of ka)this.kAe.delete(yb),this.updateAnnotationRangeData(yb)},158);this.Gb.Vb(db)}updateAnnotationRangeData(ka){var db=this.Jn.hPa(ka,0,Zb=>this.Fvo(Zb.intent));if(0<db.count)for(const Zb of db){db=this.kaa.zam(Zb.intent.id);var yb=ka.$ma;const tc=Wa.ParagraphReader.TQ(ka);Zb.end<Zb.begin||(yb=uf.a.LIc(tc,yb,Zb.begin,Zb.end-Zb.begin,Zb.begin,Zb.end-Zb.begin,ka),this.KF.Y4f(ka.Kc,db,yb))}}Fvo(ka){return!!ka&&
this.hC.akb(ka)&&!!ka.content}v8c(){return!this.N$a&&this.Wka.L8}}Object(f.a)(Sf,"ParagraphNodeEventHandler",He.a,[429]);var fc=c(1009),yc=c(397),Uc=c(449),zd=c(102);class ie extends Uc.a{constructor(){super();this.H_=Object.assign(new zd.a,{T_:ie.getTypeName(),B_:ie.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(f.a)(ie,"DeltaUpdateOperation",Uc.a,[]);var Oe=c(367);class Ge{constructor(){this.referencedPath=
null}}Object(f.a)(Ge,"ItemReference",null,[]);class re extends Oe.a{constructor(){super();this.op=this.deltas=this.delta=this.parentPath=null}}Object(f.a)(re,"ItemWithPath",Oe.a,[]);var mf=c(979);class Xe extends mf.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new zd.a,{T_:Xe.getTypeName(),B_:Xe.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(f.a)(Xe,
"MoveOperation",mf.a,[]);var qf=c(439);class kf extends qf.a{constructor(){super();this.selectedRanges=null;this.H_=Object.assign(new zd.a,{T_:kf.getTypeName(),B_:kf.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(f.a)(kf,"SelectionSignal",qf.a,[]);class $f extends kf{constructor(){super();this.content=null;this.H_=Object.assign(new zd.a,{T_:$f.getTypeName(),B_:$f.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal",
"AugLoop_Signals_Signal"]}}Object(f.a)($f,"SelectionContentSignal",kf,[]);class xf{constructor(){this.range=this.tileReference=null}}Object(f.a)(xf,"TextTileRange",null,[]);var Qg=c(1672),zb=c(330),Yb=c(36),Tc=c(17);class Id{constructor(ka,db,yb,Zb,tc,Pc,Od,ke){this._augLoopRuntimeManager=this.pjd=null;this.ASe=!1;this.ola=this.KIe=this.nud=null;this.TRg=2E3;this.dFl=()=>{if(U.App.lostSession||yc.SessionStatusManager.instance&&yc.SessionStatusManager.instance.zo)sb.a.getAugLoopRuntimeManager().closeSession(),
a.ULS.sendTraceTag(512623445,389,15,"TileView.firePreparedEventsForOperations: Closing AL session"),this.Gb.Xe(this.pjd);this.ri.ie(()=>{var od;const Pe=ob.a.instance.L3;this.BB()&&this.l6n();for(this.gCc.reset();this.cXa.G9b&&!this.gCc.Ilb();){let Dg;Dg=this.cXa.m5k();if(!Dg||!Dg.graphNode){a.ULS.sendTraceTag(41719901,389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.gCc.update();continue}if(!this.Hto(Dg)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",
Dg.graphNode.id);this.gCc.update();continue}const gi=Dg.graphNode.id.toString();var Se=-1,ng=!0;Pe&&Tc.SelectionEditor.gf(Pe)&&gi==Pe.node.id.toString()&&(Se=Pe.cpBegin,ng=!1);let qh=null;if(this.yxb.contains(gi))switch(Dg.h_c){case 3:this.yxb.remove(gi);qh=3;break;default:qh=Dg.h_c}else switch(Dg.h_c){case 0:case 1:this.yxb.add(gi);qh=0;break;case 2:this.yxb.add(gi);qh=0;break;case 3:this.yxb.remove(gi);qh=3;break;default:qh=Dg.h_c}if(null!=qh){Se=this.hdi(Dg.graphNode,Dg.fullPath,qh,Se,ng);if(4==
qh||5==qh){if(Se.prevParentPath.join()!==Se.parentPath.join()){ng=Object.assign(new za.a,{parentPath:Se.prevParentPath,items:Se.items});const ym=Object.assign(new Na.a,{parentPath:Se.parentPath,items:Se.items,prevId:Se.prevId,nextId:Se.nextId});gi!==Se.prevId&&gi!==Se.nextId||a.ULS.sendTraceTag(512231646,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",qh,gi,Se.prevId,Se.nextId,Dg.graphNode.type);this._augLoopRuntimeManager.submitOperation(Object.assign(new zb.a,
{operation:ng}));this._augLoopRuntimeManager.submitOperation(Object.assign(new zb.a,{operation:ym}));14===Dg.graphNode.type&&this.njj(Dg.graphNode,Se.parentPath).forEach(Ol=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new zb.a,{operation:Ol}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new zb.a,{operation:Se}));if(this.Xed&&this.ola&&this.ola[0]==gi)switch(qh){case 3:this.ola=null;break;case 0:case 1:case 2:case 4:case 5:this.ola[1]=null===(od=this.Svb.aFb(Dg.graphNode))||
void 0===od?void 0:od.VNc(Dg.graphNode)}a.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",va.a.getTypeNameFor(Se),gi);switch(qh){case 0:case 4:case 5:this.Se.Vvn(Dg.graphNode);break;case 3:this.Se.Wvn(Dg.graphNode,Se.parentPath.join("\\"))}}this.gCc.update()}(od=this.cXa.n5k())&&this.pdj(od)},"TV:FPEFO")};this.Rpa=(od,Pe)=>{var Se;if(Pe.ol&&Pe.ol.length){if(this.Xed)if(od=Bb.a.O5l(Pe.ol),!od)this.ola=null;else if(!this.ola||this.ola[0]!=
od.id.toString()){const ng=this.cXa.UKm(od)?null:null===(Se=this.Svb.aFb(od))||void 0===Se?void 0:Se.VNc(od);this.ola=[od.id.toString(),ng]}this.ASe&&this.cXa.xTn(Pe.ol.kb)}};this.Fa=ka;this.cXa=db;this.Gb=yb;this.gCc=Zb;this.wXj=this.Fa.$("AugLoopOperationsAreEnabled");this.yxb=new Ga.a(wa.a.Fh());this.Se=tc;this.ri=Pc;this.Svb=Od;this.hb=ke;this.Xed=this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.hb.Pw(this.Rpa);Bb.a.Mk().then(()=>{this._augLoopRuntimeManager=
sb.a.getAugLoopRuntimeManager();y.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacBox4AugLoopTimeBasedYieldTraversalSettings");this.Fa.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new Qg.a,{handler:od=>{this.Se.jDk(od)}}));this.wXj&&this.cXa.WCo();this.NDo()}).catch(()=>{});this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.IncreasedIntervalForDelayedCritiquesIsEnabled",!1)&&(this.TRg=5E3)}l6n(){const ka=this.Se.Hrc.entries();
for(let db=0;db<this.Se.Hrc.size;db++){const yb=ka.next();y.AFrameworkApplication.ue("gi204158;ef1e2812");Date.now()-yb.value[1].time>=this.TRg&&this.Se.JUd(yb.value[1].annotation,!0,Na.a.getTypeName(),!1)}}Hto(ka){return 3===ka.h_c||Bb.a.yrj(ka.graphNode)}NDo(){!this.pjd&&this.cXa.L8&&(this.pjd=new oa.a(4,2,this.Fa.mc("NodeEventsFiringInterval",500),this.dFl,131),this.Gb.Vb(this.pjd))}njj(ka,db){var yb,Zb=[];const tc=pf.GraphIterator.$a(ka),Pc=tc.Mp();for(var Od=0;Od<Pc;Od++){let ke=tc.iF(Od);11===
ke.type&&(ke=Yb.OutlineElementNavigator.Ge(tc));const od=ke.id.toString(),Pe=null===(yb=this.Svb.aFb(ke))||void 0===yb?void 0:yb.mBb(ke);Zb.push(Object.assign(new Oe.a,{body:Pe,id:od,revId:Bb.a.nvf(ke)}));tc.jd(ka.type)}db.push(ka.id.toString());yb=[];yb.push(Object.assign(new Na.a,{parentPath:db.slice(),items:Zb,prevId:null}));for(Zb=0;Zb<Pc;Zb++)Od=tc.iF(Zb),11===Od.type&&(Od=Yb.OutlineElementNavigator.Ge(tc)),0<tc.Mp()&&(yb=yb.concat(this.njj(Od,db))),tc.jd(ka.type);db.pop();return yb}kPa(ka){return ka.split("\\").slice(0,
-1)}hdi(ka,db,yb,Zb=-1,tc=!0){var Pc;let Od=null,ke=null;const od=ka.id.toString();var Pe=null;3!==yb&&(Pe=Bb.a.UPk(ka));if(Pe)for(let Se=0;Se<Pe.length;Se++)if(Pe[Se]===od){ke=Se+1<Pe.length?Pe[Se+1]:null;Od=Se?Pe[Se-1]:null;break}od!==Od&&od!==ke||a.ULS.sendTraceTag(512231645,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",yb,od,Od,ke,ka.type);Pe=null===(Pc=this.Svb.aFb(ka))||void 0===Pc?void 0:Pc.mBb(ka,Zb,tc);
Zb=[Object.assign(new Oe.a,{body:Pe,id:od,revId:Bb.a.nvf(ka)})];switch(yb){case 0:case 1:return Object.assign(new Na.a,{parentPath:this.kPa(db),items:Zb,prevId:Od,nextId:ke});case 4:return Object.assign(new Xe,{parentPath:this.kPa(Bb.a.uM(ka)),prevParentPath:this.kPa(db),items:Zb,prevId:Od,nextId:ke});case 5:return yb=this.cXa.vNl(od),Object.assign(new Xe,{parentPath:this.kPa(null!==yb&&void 0!==yb?yb:Bb.a.uM(ka)),prevParentPath:this.kPa(db),items:Zb,prevId:Od,nextId:ke});case 2:return Object.assign(new la.a,
{parentPath:this.kPa(db),items:Zb});case 3:return Object.assign(new za.a,{parentPath:this.kPa(db),items:Zb});default:return a.ULS.sendTraceTag(42084322,389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",yb,od),Object.assign(new mf.a,{parentPath:this.kPa(db),items:Zb,prevId:Od,nextId:ke})}}Fhm(ka){return this.ola&&this.ola[0]===ka?this.ola[1]:null}Mfo(ka){var db;if(!this.Xed)return a.ULS.sendTraceTag(545552581,389,10,"sendTile: autoreplace is not enabled"),!1;if(!Bb.a.yrj(ka))return!1;
const yb=ka.id.toString();var Zb=this.yxb.contains(yb)?2:0;Zb=this.hdi(ka,Bb.a.uM(ka),Zb);this._augLoopRuntimeManager.submitOperation(Object.assign(new zb.a,{operation:Zb}));this.yxb.add(yb);this.ola=[yb,null===(db=this.Svb.aFb(ka))||void 0===db?void 0:db.VNc(ka)];return!0}yeo(ka,db){var yb;if(this.Xed){var Zb=ka.id.toString(),tc=this.kPa(Bb.a.uM(ka));db=[Object.assign(new re,{id:Zb,revId:Bb.a.nvf(ka),parentPath:tc,delta:db})];tc=Object.assign(new ie,{parentPath:tc,items:db});this._augLoopRuntimeManager.submitOperation(Object.assign(new zb.a,
{operation:tc}));a.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",Zb);this.ola=[Zb,null===(yb=this.Svb.aFb(ka))||void 0===yb?void 0:yb.VNc(ka)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}MHk(ka,db){if(ka.tileReference.referencedPath.length!==db.tileReference.referencedPath.length||ka.range.start!==db.range.start||ka.range.length!==db.range.length)return!1;for(let yb=0;yb<ka.tileReference.referencedPath.length;yb++)if(ka.tileReference.referencedPath[yb]!==
db.tileReference.referencedPath[yb])return!1;return!0}HHk(ka,db){if(ka.selectedRanges.length!==db.selectedRanges.length||ka.content!==db.content)return!1;for(let yb=0;yb<ka.selectedRanges.length;yb++)if(!this.MHk(ka.selectedRanges[yb],db.selectedRanges[yb]))return!1;return!0}pdj(ka){var db;if(ka){var yb=new hb.a,Zb="";for(let Od=0;Od<ka.length;Od++){var tc=ka.J(Od),Pc=(null===(db=this.Svb.aFb(tc.node))||void 0===db?void 0:db.mBb(tc.node)).content;Zb+=Pc;Pc=tc.cpBegin<Pc.length?tc.cpBegin:-1;Pc=Object.assign(new pa.a,
{start:Pc,length:tc.cpEnd-tc.cpBegin});const ke=tc.node.id.toString();tc=this.kPa(Bb.a.uM(tc.node));tc.push(ke);yb.add(Object.assign(new xf,{range:Pc,tileReference:Object.assign(new Ge,{referencedPath:tc})}))}ka=Object.assign(new $f,{selectedRanges:yb.toArray(),content:Zb});this.KIe&&this.HHk(ka,this.KIe)||(db=this.nud?this.nud:ja.a.create().toString(),yb=[Object.assign(new Oe.a,{body:ka,id:db})],this.nud?db=Object.assign(new la.a,{parentPath:["session","doc"],items:yb}):(this.nud=db,db=Object.assign(new Na.a,
{parentPath:["session","doc"],items:yb})),this._augLoopRuntimeManager.submitOperation(Object.assign(new zb.a,{operation:db})),this.KIe=ka)}}poo(ka){(this.ASe=ka)?this.pdj(this.hb.gb.kb):this.cXa.EZk()}BB(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}Object(f.a)(Id,"TileView",null,[431]);var Xc=c(41),Le=c(99);class cf{constructor(ka){Le.a.assign(cf,this,ka)}static getTypeName(){return"AugLoop_Table_TableRow"}static getBaseTypes(){return[]}static typeGuard(ka){return Le.a.matchesTypesFor(ka,
[cf.getTypeName()])}}cf.H_={T_:cf.getTypeName(),B_:cf.getBaseTypes()};class Ig{constructor(ka){Le.a.assign(Ig,this,ka)}static getTypeName(){return"AugLoop_Table_TableCell"}static getBaseTypes(){return[]}static typeGuard(ka){return Le.a.matchesTypesFor(ka,[Ig.getTypeName()])}}Ig.H_={T_:Ig.getTypeName(),B_:Ig.getBaseTypes()};class Ji{constructor(ka){Le.a.assign(Ji,this,ka)}static getTypeName(){return"AugLoop_Table_Table"}static getBaseTypes(){return[]}static typeGuard(ka){return Le.a.matchesTypesFor(ka,
[Ji.getTypeName()])}}Ji.H_={T_:Ji.getTypeName(),B_:Ji.getBaseTypes()};class Th{constructor(ka){Le.a.assign(Th,this,ka)}static getTypeName(){return"AugLoop_Table_WordTable"}static getBaseTypes(){return["AugLoop_Table_Table"]}static typeGuard(ka){return Le.a.matchesTypesFor(ka,[Th.getTypeName()])}}Th.H_={T_:Th.getTypeName(),B_:Th.getBaseTypes()};class Ah{constructor(ka){Le.a.assign(Ah,this,ka)}static getTypeName(){return"AugLoop_Table_WordOOXmlTableTile"}static getBaseTypes(){return["AugLoop_Table_WordTable",
"AugLoop_Table_Table"]}static typeGuard(ka){return Le.a.matchesTypesFor(ka,[Ah.getTypeName()])}}Ah.H_={T_:Ah.getTypeName(),B_:Ah.getBaseTypes()};var Pm;(function(ka){ka[ka.Top=0]="Top";ka[ka.Center=1]="Center";ka[ka.Bottom=2]="Bottom"})(Pm||(Pm={}));var zf;(function(ka){ka[ka.none=0]="none";ka[ka.firstRow=32]="firstRow";ka[ka.lastRow=64]="lastRow";ka[ka.firstCol=128]="firstCol";ka[ka.lastCol=256]="lastCol";ka[ka.noHBand=512]="noHBand";ka[ka.noVBand=1024]="noVBand";ka[ka.nwCell=160]="nwCell";ka[ka.neCell=
288]="neCell";ka[ka.swCell=192]="swCell";ka[ka.seCell=320]="seCell";ka[ka.defaultLook=1184]="defaultLook"})(zf||(zf={}));Object(f.b)("TableLookFlags",zf);class lg{mBb(ka){if(ka)switch(ka.type){case 14:return this.lfl(ka);case 15:return new cf;case 16:return this.kfl(ka)}else a.ULS.sendTraceTag(524149331,389,10,"ConvertNodeToTile: Node can't be null.")}lfl(ka){var db=ka.hG||[];let yb=0;for(let Zb=0;Zb<db.length;Zb++)yb+=db[Zb];db=db.map((Zb,tc)=>({columnId:tc.toString(),widthPercent:0!=yb?100*Zb/yb:
0}));return new Th({columnDefs:db,tableLook:ka.properties.ia(qa.a.tableLook,zf.defaultLook),complexTable:ka.properties.ia(qa.a.complexTable,!1),floatingTable:ka.properties.ia(qa.a.Lxi,!1)})}kfl(ka){return new Ig({rowspan:ka.properties.ia(qa.a.rowSpan,1),colspan:ka.properties.ia(qa.a.colSpan,1),borderInfo:{topBorder:{color:ka.properties.ia(qa.a.XPb,0),size:ka.properties.ia(qa.a.elc,4),style:ka.properties.ia(qa.a.Ipb,"single")},leftBorder:{color:ka.properties.ia(qa.a.VPb,0),size:ka.properties.ia(qa.a.clc,
4),style:ka.properties.ia(qa.a.Gpb,"single")},rightBorder:{color:ka.properties.ia(qa.a.WPb,0),size:ka.properties.ia(qa.a.dlc,4),style:ka.properties.ia(qa.a.Hpb,"single")},bottomBorder:{color:ka.properties.ia(qa.a.UPb,0),size:ka.properties.ia(qa.a.blc,4),style:ka.properties.ia(qa.a.Fpb,"single")}},verticalAlignment:ka.properties.ia(qa.a.Mqa,Pm.Top),ghostCell:ka.properties.ia(qa.a.ghostCell,!1),renderCell:ka.properties.ia(qa.a.renderCell,!1),skippedCell:ka.properties.ia(qa.a.skippedCell,!1),fillColor:ka.properties.ia(Dc.a.wH,
0),verticalMerge:ka.properties.ia(Xc.a.vMerge,null)})}VNc(ka){return null===ka||void 0===ka?void 0:ka.properties}}Object(f.a)(lg,"TableElementNodeToTileConverter",null,[430]);class md{constructor(ka,db,yb){this.Oo=db;this.Qya=yb;this.dLd=!1;this.xsc=null;this.zYi=(Zb,tc)=>{this.bya(tc.node,0)};this.vYi=(Zb,tc)=>{Zb=tc.node;this.Qya.SNb(Zb.id.toString(),Bb.a.uM(Zb))};this.AYi=(Zb,tc)=>{this.bya(tc.node,3)};this.G8d=(Zb,tc)=>{this.bya(tc.node,2)};this.CYi=(Zb,tc)=>{this.bya(tc.node,0)};this.DYi=(Zb,
tc)=>{this.bya(tc.node,3)};this.BYi=(Zb,tc)=>{Zb=tc.node;this.Qya.SNb(Zb.id.toString(),Bb.a.uM(Zb))};this.H8d=(Zb,tc)=>{this.bya(tc.node,2)};this.xYi=(Zb,tc)=>{this.bya(tc.node,0)};this.wYi=(Zb,tc)=>{Zb=tc.node;this.Qya.SNb(Zb.id.toString(),Bb.a.uM(Zb))};this.yYi=(Zb,tc)=>{this.bya(tc.node,3)};this.E8d=(Zb,tc)=>{var Pc;Zb=tc.node;if(tc.property===qa.a.ghostCell){if(tc=Zb.hg?Zb:null===(Pc=Zb.gxa)||void 0===Pc?void 0:Pc.controlCell){Pc=pf.GraphIterator.$a(tc);var Od=Pc.Mp();for(var ke=0;ke<Od;ke++){Pc.iF(ke);
var od=Yb.OutlineElementNavigator.Ge(Pc);this.Qya.SNb(od.id.toString(),String.format("{0}\\{1}",Bb.a.uM(tc),od.id));this.bya(od,4);Pc.jd(16)}}}else if(tc.property===Dc.a.ef){tc=pf.GraphIterator.$a(Zb);Pc=tc.Mp();let Pe=null;Od=[];for(ke=0;ke<Pc;ke++){tc.iF(ke);od=Yb.OutlineElementNavigator.Ge(tc);this.Qya.kbo(od.id.toString(),String.format("{0}\\{1}",Bb.a.uM(Zb),od.id));if(14!==od.type){if(Pe=Bb.a.uM(od))this.Qya.SNb(od.id.toString(),Pe),this.bya(od,5)}else Od.push(od);tc.jd(16)}Pe&&Od.forEach(Se=>
{this.Qya.SNb(Se.id.toString(),String.format("{0}\\{1}",Pe.split("\\").slice(0,-1).join("\\"),Se.id));this.bya(Se,5)})}this.bya(Zb,2)};this.vRf=()=>{this.v8c()?this.YM():this.dLd&&!this.Qya.L8&&this.eza()};this.USb=ka.$("AugLoopOperationsAreEnabled")}get q0c(){return this.xsc}init(){this.v8c()&&this.YM();this.Qya.cqh(this.vRf)}YM(){const {lyj:ka,ule:db,$xj:yb}=this.X8h();if(ka&&db&&yb){this.dLd=!0;var Zb=this.vYi,tc=this.AYi,Pc=this.G8d;ka.$t(this.zYi);ka.nQ(Zb);ka.Ax(tc);ka.Go(Pc);Zb=this.BYi;tc=
this.DYi;Pc=this.H8d;db.$t(this.CYi);db.nQ(Zb);db.Ax(tc);db.Go(Pc);Zb=this.wYi;tc=this.yYi;Pc=this.E8d;yb.$t(this.xYi);yb.nQ(Zb);yb.Ax(tc);yb.Go(Pc)}else a.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}eza(){const {lyj:ka,ule:db,$xj:yb}=this.X8h();if(ka&&db&&yb){this.dLd=!1;var Zb=this.vYi,tc=this.AYi,Pc=this.G8d;ka.SU(this.zYi);ka.$ca(Zb);ka.bqa(tc);ka.TU(Pc);Zb=this.BYi;tc=this.DYi;Pc=this.H8d;db.SU(this.CYi);db.$ca(Zb);db.bqa(tc);db.TU(Pc);
Zb=this.wYi;tc=this.yYi;Pc=this.E8d;yb.SU(this.xYi);yb.$ca(Zb);yb.bqa(tc);yb.TU(Pc)}else a.ULS.sendTraceTag(524149330,389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}bya(ka,db){ka&&this.Q6a(ka)&&this.Qya.L8&&this.USb&&this.Qya.Yce(ka,db)}X8h(){return{lyj:this.Oo.Ze(14),ule:this.Oo.Ze(15),$xj:this.Oo.Ze(16)}}Q6a(ka){const db=U.App.xa.ib.rc;return!!db&&db.lv&&!!db.Yc&&!!db.Yc.Kc&&!!ka&&!!ka.Kc&&ka.Kc.id===db.Yc.Kc.id}v8c(){return!this.dLd&&!!this.Qya.L8}}Object(f.a)(md,"TableNodeEventHandler",
null,[429]);class td{constructor(ka,db){this.t0i=ka;this.QHo=db}aFb(ka){return ka?14===ka.type||15===ka.type||16===ka.type?this.QHo:12===ka.type?this.t0i:null:null}}Object(f.a)(td,"NodeToTileConverterHolder",null,[428]);var Bd=c(368);class nl{get name(){return"Box4.AugmentationLoop"}xc(ka){this.W=ka;const db=this.W.resolve("Common.IAppSettingsManager"),yb=db.$("AugLoopTaskUseTimeBasedYieldStrategy"),Zb=new Dd,tc=yb?new ba.a(db.mc("AugLoopTaskAllowedRunTimeBeforeYielding",10),E.a.af):new Y(db.mc("AugLoopTaskNodesToRunBeforeYielding",
10));this.W.ha("Common.ICpuMeter",()=>Q.a.instance).singleInstance();this.W.ha("Box4.AugmentationLoop.AugmentationLoopStateManager",()=>new Pb).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").singleInstance();this.W.ha("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new Sf(db,U.App.Xj.zl.Ze(12),Zb,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),
this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),y.AFrameworkApplication.nc,this.W.resolve("Box4.Intent.IIntentRangeEditor"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").singleInstance();Bb.a.sie()&&this.W.ha("Box4.AugmentationLoop.TableNodeEventHandler",()=>new md(db,U.App.Xj.zl,Zb)).singleInstance();this.W.ha("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",
()=>new V).singleInstance();this.W.ha("Box4.AugmentationLoop.IFormattingExtractor",()=>new Ee(this.W.resolve("Common.IAppSettingsManager"),this.W.Na("Box4.IFeatureHelper"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IParagraphIndentationReader"),this.W.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();this.W.ha("Box4.AugmentationLoop.IAnnotationPolicies",()=>new fa.a(new X.a(()=>U.App.xa.ib.Uc.od),this.W.resolve("Box4.Intent.IIntentRangeEditor"))).singleInstance();this.W.ha("Box4.AugmentationLoop.IPersistedAnnotationStorage",
()=>new Ib(this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.IIntelligenceReader"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),new X.a(()=>U.App.xa.ib.Uc.od),ka.resolve("Box4.IFeatureHelper"))).singleInstance();const Pc=this.W.resolve("IRoamingDictionary");this.W.ha("Box4.AugmentationLoop.IAnnotationStorage",()=>new Xa(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.Intent.IIntentRangeEditor"),
new X.a(()=>U.App.xa.ib.Uc.od),y.AFrameworkApplication.nc,this.W.Na("Box4.IIntelligenceReader"),this.W.Na("Box4.IIntelligenceEditor"),this.W.Na("Box4.AugmentationLoop.IAnnotationPolicies"),this.W.Na("Box4.AugmentationLoop.IPersistedAnnotationStorage"),ka.resolve("Box4.IFeatureHelper"),Bd.a.instance,()=>{try{return sb.a.getAugLoopRuntimeManager()}catch(Od){return a.ULS.sendTraceTag(50935320,389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",Od),null}},Pc)).singleInstance();
this.W.ha("Box4.AugmentationLoop.INodeToTileConverterHolder",()=>new td(new fc.a(this.W.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new lg)).singleInstance();this.W.ha("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",()=>new Id(db,Zb,y.AFrameworkApplication.nc,tc,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),this.W.resolve("Box4.ISelectionManager"))).singleInstance();
a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.W.ha("Box4.AugmentationLoop.IUtilsWrapper",()=>new kc).singleInstance();this.W.ha("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new Sb).singleInstance()}init(){if(y.AFrameworkApplication.bG.BootFailed)a.ULS.sendTraceTag(512624089,389,15,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(y.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");
const ka=new rb(this.W.resolve("Common.IAppSettingsManager"),y.AFrameworkApplication.Ne,U.App.C5,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),W.a.instance,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage")),db=new aa;this.W.register(427,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").singleInstance().J1o(()=>db);y.AFrameworkApplication.ue("b8afb343;bjdjj400");y.AFrameworkApplication.ue("72af9564;82jf1647");const yb=Bb.a.z0m(this.W.resolve("Common.IDynamicScriptLoaderProvider").Uz,
this.W.resolve("Common.App.OAuth.IOAuthManager"),ka,this.W.resolve("Common.ISharedDependencyLoader"),db);this.W.ha("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new La(yb)).singleInstance();this.W.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();Bb.a.sie()&&this.W.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();this.W.resolve("Box4.IIntelligenceReader").init();this.W.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(ka){z.a.instance.Fc(new nl,
0,ka);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(f.a)(nl,"Box4AugmentationLoopPackage",null,[1,2]);var ni=c(598),si=c(43),zi=c(12),yl=c(407),Dl=c(1136);class ji{constructor(ka,db,yb,Zb=null,tc=null,Pc=null){this.jM=new Dl.a(db,Zb,tc,Pc);this.Ib=ka;this.Mc=yb}get type(){return this.jM.type}get id(){return this.jM.id}get intent(){return this.jM.intent}Df(ka){return new ji(ka,this.type,this.Mc,this.id,this.intent,this.jM.txa)}toString(){return String.format("Core = [{0}], IsStart = {1}",
this.jM,this.Mc)}}Object(f.a)(ji,"IntentObject",null,[130]);var ej=c(472),fj=c(148),um=c(243);class Gg{constructor(){this.ptc=new fj.a}uzd(ka,db,yb,Zb,tc=null,Pc=null,Od=null){ka=ka.u_(db,ka.pa.iPo(db));ka.Nj||(ka.Nj=new ej.a(ka));ka.Nj.add(new ji(ka,yb,Zb,tc,Pc,Od));ka.isFromErrorRangeSplit=!0}naj(ka){return ka.Ib&&ka.Ib.Nj&&ka.Ib.Nj.O4c(db=>db===ka,[ka.type])?!0:!1}oaj(ka,db){if(ka.type===db.type&&ka.Mc&&!db.Mc&&ka.Ib&&ka.Ib.Nj&&ka.Ib.Nj.contains(ka)&&db.Ib&&db.Ib.Nj&&db.Ib.Nj.contains(db)){var yb=
[ka.type];ka.Ib.Nj.O4c(Zb=>Zb===ka,yb);db.Ib.Nj.O4c(Zb=>Zb===db,yb)}}C2o(ka,db,yb){if(!db)return!1;yb=new ab.a([yb]);for(let Zb=0;Zb<ka.length;Zb++){const tc=ka.J(Zb);if(!tc.Nj)continue;let Pc=!0;yb.rUa(tc.Nj,void 0,Od=>{Od.id&&db.equals(Od.id)&&(Pc=!1)});if(!Pc)return!1}return!0}YGn(ka,db,yb,Zb){let tc=null,Pc=null;db=new ab.a([db]);const Od=ka.pa;for(let ke=0;ke<Od.length;ke++){const od=Od.J(ke);if(!od.Nj)continue;let Pe=!0;db.rUa(od.Nj,void 0,(Se,ng)=>{if(ng){var Dg=ng.Ib.cp<yb,gi=Se.Ib.cp>Zb;
Dg&&Se.Ib.cp<=yb||ng.Ib.cp>=Zb&&gi||(Dg&&gi?Pe=!1:Dg?tc=Se:gi?Pc=ng:this.oaj(ng,Se))}});if(!Pe)return!1}if(tc){if(!this.naj(tc))return!1;this.uzd(ka,yb,tc.type,tc.Mc,tc.id,tc.intent,tc.jM.txa)}if(Pc){if(!this.naj(Pc))return!1;this.uzd(ka,Zb,Pc.type,Pc.Mc,Pc.id,Pc.intent,Pc.jM.txa)}return!0}zdg(ka){let db;return y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:db}=this.ptc.Dc(ka.type,db)).returnValue?db.zdg(ka):!0}Oan(ka,db){if(this.zdg(db)){var yb=
db.id,Zb=db.type,tc=db.begin,Pc=db.end;if(({cpEnd:Pc}=Gg.XJj(ka,tc,Pc)).returnValue){if(yl.a(Zb)){if(!this.C2o(ka.pa,yb,Zb))return}else if(!this.YGn(ka,Zb,tc,Pc))return;this.uzd(ka,tc,Zb,!0,yb,db.intent,db.jM.txa);this.uzd(ka,Pc,Zb,!1,yb,db.intent,db.jM.txa)}}}K1c(ka,db){U.App.xa.eif(ka,()=>{const yb=new si.GraphTransaction(2);try{yb.Cb(ka);const Zb=ka.NY();try{const tc=ka.q_();try{db()}finally{tc&&tc.dispose()}}finally{Zb&&Zb.dispose()}}finally{yb&&yb.dispose()}})}jRa(ka,db){this.K1c(ka,()=>{this.Oan(ka,
db)})}Ran(ka,db){if(db.count){var yb=new Sa.a,Zb=new um.a;for(var tc of db){var Pc=tc.value;yl.a(tc.key)||Pc.Sc((ke,od)=>ke.begin!==od.begin?ke.begin-od.begin:ke.end-od.end);if(Gg.G2o(Pc))for(var Od of Pc)Pc=Od.end,({cpEnd:Pc}=Gg.XJj(ka,Od.begin,Pc)).returnValue&&(Pc=Pc!==Od.end?new ub.a(Od.type,Od.begin,Pc,Od.id,Od.intent,Od.jM.txa):Od,yb.add(Pc.begin),yb.add(Pc.end),Gg.Ltk(Zb,Pc))}ka.BKd(yb);ka=ka.pa;for(yb=0;yb<ka.length;yb++){tc=ka.J(yb);if(Od=tc.Nj)for(const od of db.keys)Od.gbj(od);let ke;({value:ke}=
Zb.Dc(tc.cp,ke)).returnValue||(ke=null);if(ke){Od||(Od=tc.Nj=new ej.a(tc));for(const od of ke)Od.add(od.Df(tc))}tc.isFromErrorRangeSplit=!0}}}zMf(ka,db){const yb=new fj.a;for(const Zb of db){let tc;({value:tc}=yb.Dc(Zb.type,tc)).returnValue||(tc=new hb.a,yb.Z(Zb.type,tc));tc.add(Zb)}this.K1c(ka,()=>{this.Ran(ka,yb)})}zSo(ka,db,yb){ka=ka.pa;const Zb=new ab.a([8]);db===yb&&(yb+=1);for(let tc=0;tc<ka.length;tc++){const Pc=ka.J(tc);Pc.Nj&&Zb.rUa(Pc.Nj,void 0,(Od,ke)=>{ke&&Math.max(ke.Ib.cp,db)<Math.min(Od.Ib.cp,
yb)&&this.oaj(ke,Od)})}}Mlg(ka,db,yb){this.K1c(ka,()=>{this.zSo(ka,db,yb)})}BSo(ka,db){ka=ka.pa;for(let yb=0;yb<ka.length;yb++){const Zb=ka.J(yb);Zb.Nj&&Zb.Nj.gbj(db)}}U7a(ka,db){this.K1c(ka,()=>{this.BSo(ka,db)})}ASo(ka,db,yb){let Zb=!1;db=db.pa;yb=[yb];for(let tc=0;tc<db.length;tc++){const Pc=db.J(tc);Pc.Nj&&(Zb=Pc.Nj.O4c(ka,yb)||Zb)}return Zb}Yad(ka,db,yb){let Zb=!1;this.K1c(db,()=>{Zb=this.ASo(ka,db,yb)});return Zb}qQd(ka,db,yb,Zb){return!ka||0>yb||Zb>ka.characterData.length||yb>Zb?new hb.a:this.hPa(ka,
db,tc=>Math.max(tc.begin,yb)<=Math.min(tc.end,Zb))}hPa(ka,db,yb){return Gg.V0l(ka,db,yb)}static V0l(ka,db,yb){const Zb=new hb.a;ka=ka.pa;db=new ab.a([db]);if(!ka)return Zb;for(let tc=0;tc<ka.length;tc++){const Pc=ka.J(tc);Pc.Nj&&db.rUa(Pc.Nj,void 0,(Od,ke)=>{ke&&(Od=new ub.a(ke.type,ke.Ib.cp,Od.Ib.cp,ke.id,ke.intent,ke.jM.txa),yb(Od)&&Zb.add(Od))})}return Zb}ROc(ka,db){const yb=new hb.a;if(!Gg.xVm(ka.contextId))return yb;let Zb;const tc=ka.node;ka.contextId!==zi.a.paragraph?(Zb=ka.cpBegin,ka=ka.cpEnd):
(Zb=0,ka=tc.characterData.length);yb.addRange(this.qQd(tc,db,Zb,ka));return yb}lXn(ka){this.ptc.mb(0)||this.ptc.Z(0,ka)}static XJj(ka,db,yb){ka=Wa.ParagraphReader.textLength(ka);if(db>=ka)return{returnValue:!1,cpEnd:yb};yb>ka&&(yb=ka);return{returnValue:!0,cpEnd:yb}}static G2o(ka){if(!ka.count)return!0;const db=new ni.a,yb=ka.J(0).type,Zb=yl.a(yb);let tc=-1;for(const Pc of ka){if(Pc.type!==yb||(yl.c(Pc.type)?Pc.begin>Pc.end:Pc.begin>=Pc.end))return!1;if(Zb){ka=Pc.id;if(!ka||ka.equals(ja.a.nil)||db.contains(ka))return!1;
db.add(ka)}else if(-1===tc)tc=Pc.end;else if(tc>Pc.begin)return!1}return!0}static Ltk(ka,db){let yb;({value:yb}=ka.Dc(db.begin,yb)).returnValue||(yb=new hb.a,ka.Z(db.begin,yb));yb.add(new ji(null,db.type,!0,db.id,db.intent,db.jM.txa));({value:yb}=ka.Dc(db.end,yb)).returnValue||(yb=new hb.a,ka.Z(db.end,yb));yb.add(new ji(null,db.type,!1,db.id,db.intent,db.jM.txa))}static xVm(ka){return ka===zi.a.Hd||ka===zi.a.Tc||ka===zi.a.paragraph}}Object(f.a)(Gg,"IntentRangeEditor",null,[432]);class dg{constructor(){this.W=
null}get name(){return"Box4.Intent"}xc(ka){this.W=ka;this.W.ha("Box4.Intent.IntentRangeEditor",()=>new Gg).as("Box4.Intent.IIntentRangeEditor").singleInstance()}init(){this.W.resolve("Box4.IProofingManager")}dispose(){}static main(ka){z.a.instance.Fc(new dg,0,ka);a.ULS.sendTraceTag(512336855,306,50,"Box4 Intent package registered.")}}Object(f.a)(dg,"PackageManager",null,[1,2]);var Ri=c(1023),am=c(111),gj=c(1411);class Tg{constructor(ka){this.b$m=ka;this.Y9m=[]}get handler(){return this.b$m}get ina(){return this.Y9m}}
Object(f.a)(Tg,"RegisteredListener",null,[]);class Si{constructor(ka,db){this.type=0;this.payload=null;this.type=ka;this.payload=db}}Object(f.a)(Si,"OfficeSharedCommentsEvent",null,[847]);class kj{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(f.a)(kj,"ViewContainerEvent",null,[847]);var Mh=c(573);class Qh{constructor(ka){this.TLf=!1;this.hpa=new hb.a;this.T3d=ka}IWn(ka){ka=new Tg(ka);this.hpa.add(ka)}tEj(ka){for(let db=0;db<this.hpa.count;++db)if(this.hpa.J(db).handler===
ka){this.hpa.removeAt(db);break}}TSa(ka=!1){const db=()=>{if(y.AFrameworkApplication.Nk)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let tc=0;tc<this.hpa.count;++tc){const Pc=this.hpa.J(tc);for(;0<Pc.ina.length;){var yb=Array.dequeue(Pc.ina);if(Object(am.a)(kj,yb)){var Zb=Pc.handler;Zb(yb)}else Object(am.a)(Si,yb)&&(Zb=Pc.handler,Zb(yb.type,yb.payload))}}};ka?db():this.TLf||(this.TLf=!0,Mh.a.e3(this.T3d,()=>{db();this.TLf=!1},gj.a.OGl))}}
Object(f.a)(Qh,"GenericEventHost",null,[]);class Qk{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(f.a)(Qk,"BasicEventPayload",null,[884]);class Hj{constructor(ka){this.nextPopulatedContextDetails=
0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ka}}Object(f.a)(Hj,"CommentContextDetails",null,[]);class tl{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(f.a)(tl,"ContextChangeWithSelectedThreadIndex",null,[884]);class Qj{constructor(){this.tasks=this.comments=null}}Object(f.a)(Qj,"LoadCommentsNoVirtualization",null,[884]);class zl extends Qh{constructor(ka){super(ka);
this.Tdh=0}Bno(){this.Tdh=1656}sXn(ka,db,yb,Zb,tc,Pc){ka=new Tg(ka);Pc&&Array.enqueue(ka.ina,this.d$k(Pc,this.Tdh));Pc=db?db.length:0;Array.enqueue(ka.ina,this.hLh(Pc,yb,Zb,0));Pc&&Array.enqueue(ka.ina,this.jMh(db,tc));this.hpa.add(ka);this.TSa()}PQb(ka){this.tEj(ka)}teo(ka,db,yb,Zb=0){this.RGb(this.hLh(ka,db,yb,Zb));this.TSa()}ueo(ka,db,yb){this.RGb(this.C$k(ka,db,yb));this.TSa()}Teo(ka,db){this.RGb(this.jMh(ka,db));this.TSa()}selectComment(ka){this.RGb(this.kNh(ka,6));this.TSa()}highlightComment(ka){this.RGb(this.kNh(ka,
7));this.TSa()}bng(ka,db){this.RGb(this.Jcl(ka,db));this.TSa()}f_f(ka,db){this.RGb(this.Oel(ka,db));this.TSa()}d$k(ka,db=0){const yb=new Qk;yb.modelCapabilityFlags=ka;yb.richTextCapabilityFlags=db;return new Si(12,yb)}hLh(ka,db,yb,Zb){const tc=new Qk;tc.numberOfComments=ka;tc.numberOfThreads=db;tc.contextDetails=Object.assign(new Hj(yb),{nextPopulatedContextDetails:Zb});tc.contextDrafts=null;tc.rehydrationDrafts=null;return new Si(0,tc)}C$k(ka,db,yb){const Zb=new Qk;Zb.comments=ka;Zb.numberOfThreads=
db;Zb.tasks=yb;return new Si(2,Zb)}jMh(ka,db){const yb=new Qj;yb.comments=ka;yb.tasks=db;return new Si(1,yb)}kNh(ka,db){const yb=new Qk;yb.commentId="";ka&&(yb.commentId=ka);return new Si(db,yb)}Jcl(ka,db){const yb=new Qk;yb.changes=[];yb.contextDetails=Object.assign(new Hj(db),{nextPopulatedContextDetails:ka});return new Si(10,yb)}Oel(ka,db){const yb=new Qk;yb.commentId=ka;yb.smartReplies=db;return new Si(15,yb)}RGb(ka){for(let db=0;db<this.hpa.count;++db)Array.enqueue(this.hpa.J(db).ina,ka)}}Object(f.a)(zl,
"OfficeSharedCommentsEventHost",Qh,[872]);var Rh=c(228),Dk=c(188),ok=c(271);class Rk{constructor(){this.jSe=this.ZKg=!1;this.DI=this.Ep=this.k_g=this.u5g=this.ayd=this.eYb=this.xih=this.GPg=this.Uz=this.fBc=null}initialize(ka,db,yb,Zb=null,tc=null,Pc=null,Od=null,ke=null,od=null,Pe=null){this.Uz=ka;this.GPg=db;this.xih=yb;this.eYb=Zb;this.ayd=tc;this.u5g=Pc;this.k_g=Od;this.Ep=ke;this.ZKg=!0;this.DI=od;this.fBc=Pe}kXd(ka=null,db=null){if(!this.ZKg)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),
new Promise((yb,Zb)=>{Zb(Mh.a.ED(-2130915313))});if(this.jSe)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.fBc||(y.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?this.fBc=appResourceLoader.loadChunk("sharedComments"):this.fBc=this.Uz.loadScript("sharedComments"));return this.fBc.then(()=>{ka&&ka();this.jSe||(this.DI&&this.DI.execute(yb=>{yb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate",
"InitializeFloodgateServiceInCommentsPane")}),db&&db(),sharedComments.instantiate(this.GPg,this.xih,this.eYb,this.ayd,this.u5g,this.k_g,this.Ep));this.jSe=!0})}}Object(f.a)(Rk,"CommentActivationManager",null,[916]);class Gm extends Qh{constructor(ka){super(ka)}gZn(ka){this.IWn(ka)}wTo(ka){this.tEj(ka)}yoj(ka){ka=this.y$k(ka);for(let db=0;db<this.hpa.count;++db)Array.enqueue(this.hpa.J(db).ina,ka);this.TSa(!0)}y$k(ka){const db=new kj;db.eventType=3;db.viewContainerVisibilityState=ka;return db}lHl(){const ka=
this.Ufl();for(let db=0;db<this.hpa.count;++db)Array.enqueue(this.hpa.J(db).ina,ka);this.TSa(!0)}Ufl(){const ka=new kj;ka.eventType=2;return ka}}Object(f.a)(Gm,"ViewContainerEventHost",Qh,[833]);var bm=c(55);class cm{constructor(){this.actionBehavior=this.actionType=0}}Object(f.a)(cm,"CommentUIActionPayload",null,[]);var qg=c(303);class Yk{constructor(ka,db){this.ga=ka;this.mrb=db;this.Boc=new qg.a;for(let yb of this.mrb)this.Boc.Z(yb.value.canvasActionId,yb.key),ka=yb.value,ka.delayActionsUntilRegistration||
this.qa(ka)}qa(ka){ka.withFlags?this.ga.eb(ka.canvasActionId,ka.canvasContextId,Object(bm.a)(this,this.Vmh,"actionHandler"),97):this.ga.qa(ka.canvasActionId,ka.canvasContextId,Object(bm.a)(this,this.Vmh,"actionHandler"))}sSa(ka,db){this.mrb.mb(ka)&&(this.mrb.J(ka).delayActionsUntilRegistration&&this.qa(this.mrb.J(ka)),this.mrb.J(ka).registeredCallback=db)}Vmh(ka,db,yb,Zb,tc){if(this.Boc.mb(ka)){var Pc=this.Boc.J(ka);if(!this.mrb.mb(Pc))return 8;const Od=this.mrb.J(Pc);if(Od.preCallback){const ke=
Od.preCallback(ka,db,yb,Zb,tc);if(2!==ke)return ke}if(!Od.registeredCallback)return 1===yb?8:2;Pc=Object.assign(new cm,{actionType:Pc});1===yb&&(Pc.actionBehavior=1);Pc=Od.registeredCallback(Pc);return Od.postCallback?Od.postCallback(Pc,ka,db,yb,Zb,tc):Pc?32:8}return 2}}Object(f.a)(Yk,"OfficeSharedCommentsActionHost",null,[873]);var Wl=c(1821),kg=c(66),Hd=c(131),Ad=c(1467),wf=c(13),eg=c(26),tg=c(536),ce=c(1143),jd=c(133),gk=c(305),Ch=c(46),ug=c(21),ul=c(1042),th=c(1034),fg=c(1575),ag=c(171),Ek=c(11),
ze=c(37),Kf=c(691),rj=c(466),Ij=c(15),ai=c(2040);class gg{constructor(ka){this.XV=ka;this.jgc=new M.a;this.$1a=new M.a;this.eAm();this.Qtm=[new ai.a(ze.a.zGh,ze.a.k2k),new ai.a(ze.a.XEd,ze.a.j2k),new ai.a(ze.a.qGh,ze.a.Z1k),new ai.a(ze.a.PEd,ze.a.Y1k),new ai.a(ze.a.AGh,ze.a.m2k),new ai.a(ze.a.YEd,ze.a.l2k)]}wSa(ka){this.XV.wSa(ka);this.p_n(ka)}gFf(ka,db){return!!ka&&!!ka.objectId&&db.contains(ja.a.Ef(ka.objectId))}HQa(ka){ka=Object(Ab.a)(667,ka);return!!ka&&!!ka.objectId}p_n(ka){for(const db of this.Qtm)ka.classList.remove(db.className,
db.AQc);ka.classList.remove(ze.a.EZf,ze.a.$Ed,ze.a.rGh,ze.a.ZEd,gg.Yrg)}eAm(){const ka=new M.a,db=new M.a;ka.add(0,null);ka.add(1,ze.a.XEd);ka.add(2,ze.a.zGh);ka.add(3,ze.a.$Ed);db.add(0,null);db.add(1,ze.a.PEd);db.add(2,ze.a.qGh);db.add(3,ze.a.rGh);this.$1a.Z(1,ka);this.$1a.Z(2,db);this.$1a.Z(3,db);this.jgc.add(0,null);this.jgc.add(1,ze.a.YEd);this.jgc.add(2,ze.a.AGh);this.jgc.add(3,ze.a.ZEd)}}gg.Yrg="CommentImportant";Object(f.a)(gg,"CommentHighlightUtils",null,[]);class ol{constructor(){this.eKd=
0;this.WAb=null}}Object(f.a)(ol,"CommentGuidsInElementInfo",null,[]);class oi{constructor(){this.bni=!1;this.uma=this.dLb=null;this.aSa=this.nGb=0}}Object(f.a)(oi,"HighlightInfoForElement",null,[]);class Hm{constructor(){this.Eqi=this.Gqi=this.Fqi=-1;this.woi=[];this.l3b=[];this.xSc=this.ySc=-1;this.Evi=!1}}Object(f.a)(Hm,"HighlightInfoForElementsInPara",null,[]);class An{constructor(){this.Jlg=this.eVf=null}}Object(f.a)(An,"OnAnchorMouseOutData",null,[]);var vg=c(1506);class sk{constructor(ka,db,
yb,Zb,tc,Pc,Od,ke){this.rwe=ka;this.x$=db;this.sk=yb;this.f2=Zb;this.ga=tc;this.Gb=Pc;this.Zi=Od;this.hXa=this.Yi=null;this.lnn=od=>{if(!this.Yi||this.f2.tZd)return!0;if(od=od.Ro){if(this.Yi.Iz&&od[0].toString()===this.Yi.Iz.objectId)return!0;this.hXa&&od[0].equals(this.hXa.Jlg[0])?this.Gb.Xe(this.hXa.eVf):(this.hXa&&(this.Gb.Xe(this.hXa.eVf),this.ga.Qb(wf.a.aFd,2,this.hXa.Jlg)),this.Yi.Jo.Fvi(od[0])&&!this.Zi.Zm||this.ga.Qb(wf.a.X8e,2,od));this.hXa=null}return!0};this.knn=od=>{if(this.f2.tZd)return!0;
const Pe=od.Ro;Pe&&(od=new oa.a(2,1,0,()=>{this.ga.Qb(wf.a.aFd,2,Pe);this.hXa=null}),this.Gb.Vb(od),this.hXa=Object.assign(new An,{eVf:od,Jlg:Pe}));return!0};this.cUi=od=>{const Pe=new oa.a(2,1,0,()=>{if(this.Yi&&!this.Yi.Jo.ry){var Se=od.Ro;if(!Se)Se=U.App.xa.Ap.currentScope,this.Yi.Iz&&(!Se||Se.name!==ag.AFrame.sM&&Se.name!==ag.AFrame.Kr)&&this.Yi.clearSelection();else if(!this.Yi.Iz||Se.toString()!==this.Yi.Iz.objectId)if(Se=this.Yi.Jo.z_(Se.toString()))Se=Object.assign(new Ad.a,{commentId:Se.id,
LR:!1,M9:1}),this.ga.Qb(Ij.a.selectComment,2,Se)}});this.Gb.Vb(Pe);return!1};ke.execute(od=>{this.Yi=od})}Gyh(ka,db,yb,Zb){const tc=new Hm,Pc=[],Od=this.x$.HQa(db)?db.objectId:null;for(let Pe=0,Se=ka.length;Pe<Se;Pe++){var ke=ka[Pe],od=vg.g(ke);const ng=vg.d(ke);ke=new ni.a;const Dg=new oi;if(od){const gi=new rj.a(vg.c);od=this.d_h(od,Od,gi);0<od.length&&(this.aXo(od,yb,ke,Dg,Od,Zb),Pc.push(Object.assign(new ol,{eKd:Pe,WAb:gi})))}ng&&(od=this.d_h(ng,Od),0<od.length&&(this.cXo(od,yb,ke,Dg,tc,Od,Zb,
Pe),this.sVo(Pc,od,Pe,Dg)));0<yb.count&&this.dXo(db,yb,Dg,Zb);this.qVo(Pc,Dg);tc.woi.push(Dg)}return tc}cuh(ka,db,yb){let Zb=!1;for(let tc=0,Pc=ka.length;tc<Pc;tc++){const Od=ka[tc],ke=db.woi[tc],od=Kf.a(Od);if(1!==od&&2!==od&&3!==od)continue;const Pe=3===od||2===od&&-1!==Od.className.indexOf(ze.a.MPa);this.x$.wSa(Od);this.Kuk(Od,ke,Pe,Zb);this.wtk(Od,tc,od,ke,db,yb);this.xtk(Od,tc,db,ke);Zb=Pe}}d_h(ka,db,yb=null){const Zb=[];for(let tc=0;tc<ka.length;tc++)this.rwe.Wpj(ka[tc],ka[tc].toString()===
db)&&(Zb.push(ka[tc]),yb&&yb.add(ka[tc]));return Zb}aXo(ka,db,yb,Zb,tc,Pc){var Od;let ke=!1,od=!1;for(const Se of ka){db.add(Se);yb.add(Se);var Pe=Se.toString();Pe===tc?(Pe=Pc?1:2,Zb.aSa=Pe,Zb.nGb=Pe):this.gFf(this.Yi.Iz,db)&&(Pe===(null===(Od=this.Yi.Iz)||void 0===Od?void 0:Od.objectId)&&(od=!0),ke=!0)}0<ka.length&&!Zb.aSa&&(Zb.aSa=od?1:3,Zb.nGb=ke?1:3)}cXo(ka,db,yb,Zb,tc,Pc,Od,ke){var od,Pe;const Se=new rj.a(vg.c);Od=Od?1:2;let ng=!1;for(const Dg of ka){const gi=Dg.toString();db.contains(Dg)||(gi===
Pc?tc.Eqi=ke:(tc.Fqi=ke,Zb.aSa=3,(null===(od=this.Yi.Iz)||void 0===od?void 0:od.objectId)===gi&&(tc.Gqi=ke,Zb.aSa=1)),Se.add(Dg));gi===(null===(Pe=this.Yi.Iz)||void 0===Pe?void 0:Pe.objectId)&&(ng=!0);db.remove(Dg);yb.contains(Dg)&&this.bXo(Zb,Dg,gi,Pc,Od);gi===Pc&&(Zb.aSa=Od)}0<ka.length&&!Zb.aSa&&(Zb.aSa=ng?1:3);0<Se.count&&tc.l3b.push(Object.assign(new ol,{eKd:ke,WAb:Se}))}sVo(ka,db,yb,Zb){0!==ka.length&&(db.forEach(tc=>{for(let Pc=ka.length-1;0<=Pc;Pc--){const Od=ka[Pc];if(Od.WAb.contains(tc)){Od.eKd===
yb&&(Zb.uma?Zb.uma.push(tc):Zb.uma=[tc]);Od.WAb.remove(tc);break}}}),ka=ka.filter(tc=>0<tc.WAb.count))}dXo(ka,db,yb,Zb){var tc,Pc;this.gFf(ka,db)?yb.nGb=Zb?1:2:yb.nGb||(yb.nGb=null!=(null===(tc=this.Yi.Iz)||void 0===tc?void 0:tc.objectId)&&db.contains(ja.a.Ef(null===(Pc=this.Yi.Iz)||void 0===Pc?void 0:Pc.objectId))?1:3);yb.dLb||(yb.dLb=[]);for(const Od of db)yb.dLb.push(Od)}qVo(ka,db){if(0<ka.length){db.uma||(db.uma=[]);for(const yb of ka[ka.length-1].WAb)db.uma.push(yb)}}bXo(ka,db,yb,Zb,tc){ka.bni=
!0;ka.dLb||(ka.dLb=[]);ka.dLb.push(db);yb===Zb&&(ka.nGb=tc)}gFf(ka,db){return!!ka&&!!ka.objectId&&db.contains(ja.a.Ef(ka.objectId))}Kuk(ka,db,yb,Zb){!db.aSa||yb||Zb||((yb=this.x$.jgc.J(db.aSa))&&ka.classList.add(yb),db.bni&&ka.classList.add(ze.a.EZf))}wtk(ka,db,yb,Zb,tc,Pc){Zb=this.x$.$1a.J(yb).J(Zb.nGb);db<tc.Eqi?Zb=Pc?this.x$.$1a.J(yb).J(1):this.x$.$1a.J(yb).J(2):db<tc.Fqi&&!Zb&&(Zb=db<tc.Gqi?this.x$.$1a.J(yb).J(1):this.x$.$1a.J(yb).J(3));Zb&&(db=tc.Evi,ka.classList.add(Zb),db&&ka.classList.add(gg.Yrg))}xtk(ka,
db,yb,Zb){Zb.uma||(Zb.uma=this.ORl(db,yb)||Zb.dLb);db=null;Zb.uma&&0<Zb.uma.length&&(this.sk.nb(Ek.a.s0,ka,this.lnn,Zb.uma),this.sk.nb(Ek.a.hxa,ka,this.knn,Zb.uma),db=Zb.uma[0]);this.sk.nb(Ek.a.click,ka,this.cUi,db);this.sk.nb(Ek.a.XJ,ka,this.cUi,db)}ORl(ka,db){for(;0<db.l3b.length&&db.l3b[0].eKd===ka;)db.l3b.splice(0,1);if(0<db.l3b.length){ka=[];for(const yb of db.l3b[0].WAb)ka.push(yb);return ka}return null}}Object(f.a)(sk,"AllMarkupModeHighlightChangeHandler",null,[657]);var Ti=c(1477);class Tf extends Ti.a{constructor(ka){super(100,
25);this.zoc=new M.a(0);this.hWj=6E4;this.KGl=()=>{const db=this.zoc.keys;if(db.length){var yb="";for(let Zb=0;Zb<db.length;Zb++)yb+=db.J(Zb)+":"+this.zoc.J(db.J(Zb))+";";this.Xpa(yb);this.zoc=new M.a(0)}};this.xrb=new hb.a;this.xrb.add(1);this.xrb.add(6);this.xrb.add(2);this.xrb.add(4);this.xrb.add(10);this.xrb.add(11);this.Vg=ka;ka.w3f&&window.setInterval(this.KGl,this.hWj)}aHa(ka){this.Vg.oRo&&this.Vg.w3f&&(this.xrb.contains(ka)?this.uRn(ka):this.Xpa(ka+""))}uRn(ka){this.zoc.Z(ka,this.zoc.pz(ka,
0)+1)}}Object(f.a)(Tf,"CommentActionInTypingRecorder",Ti.a,[677]);var dm=c(1615),je=c(237);class Xi{static C0n(ka){ka&&ka.atmention&&delete ka.atmention.isCurrentUser;return ka}}Object(f.a)(Xi,"DeltaFormatHelpers",null,[]);class Fk{constructor(){this.optional=this.attributes=null}}Object(f.a)(Fk,"Operation",null,[]);class wg extends Fk{constructor(){super();this.insert=null}}Object(f.a)(wg,"DeltaOperation",Fk,[]);class bg{constructor(){this.ops=null}}Object(f.a)(bg,"Delta",null,[]);var vh=c(140),
Ej=c(182),im=c(147),Nd=c(56),Qn=c(72),Cd=c(98),pl=c(489),Xf=c(1186),yg=c(1774);class cb extends yg.ACommentFormatTranslator{constructor(ka,db){super(ka);this.we=db}Njg(ka){const db=new dm.a;for(let yb=0;yb<ka.length;yb++){const Zb=ka[yb];Zb.nHb=!0;this.rEk(db,Zb);db.iha("\n")}return[db.gOc()]}BLo(ka,db){ka=dm.a.tEb(ka[0]);ka=this.wHn(ka);const yb=new hb.a;let Zb=0,tc=null,Pc=null;for(;Zb<ka.ops.length;){const Od=ka.ops[Zb];tc||(tc=Xf.a.instance.createInstance(393230),tc.nHb=!0,tc.$g(qa.a.Lc,je.a.uF()),
db(tc),tc.pa.clear(),tc.qqa(""));"\n"===Od.insert?(Pc=this.$Jf(tc,Pc),this.$po(tc),yb.add(tc),tc=null):Pc=this.C1m(tc,Od,Pc);Zb++}return yb.toArray()}$po(ka){const db=ka.qAh();for(let yb=0;yb<db;yb++)ka.xe.nq.Z(yb,cb.Bhn),ka.xe.ft.Z(yb,cb.ZQf)}$Jf(ka,db){var yb=ka.AKd();yb.cp===ka.characterData.length?yb.Rh=!0:(yb=Object.assign(new Ej.a(ka,ka.characterData.length),{Rh:!0}),ka.pa.add(yb));yb=ka.pa.last;if(db){db=!!db.hw;const Zb=this.VHh(ka,yb,!db,db,null);yb.formatting=Zb;db&&(ka=this.THh(ka,yb),
yb.hU=ka.Wj);yb.Om=!0;db=null}yb.cp||yb.formatting||(yb.formatting=new im.a(yb,ja.a.nil));return db}C1m(ka,db,yb){const Zb=ka.AKd(),tc=!!db.attributes&&!!db.attributes.link,Pc=!!db.attributes&&!!db.attributes.atmention,Od=this.VHh(ka,Zb,tc,Pc,db);Zb.formatting=Od;yb&&(yb.hw&&(yb=this.THh(ka,Zb),Zb.hU=yb.Wj),Zb.Om=!0,yb=null);if(tc||Pc)this.c1m(Zb,ka,db),yb=Zb.hyperlink;ka.qqa(ka.characterData+db.insert);return yb}THh(ka,db){db=new im.a(db,ja.a.create());let yb=this.jHd();yb.setValue(qa.a.lIb,!0);
yb=ka.Kc.GR(yb);db.Wj=yb.id;return db}VHh(ka,db,yb,Zb,tc){db=new im.a(db,ja.a.create());let Pc=Xf.a.instance.createInstance(1179649);if(yb||Zb)Pc.setValue(Dc.a.IB,!0),Pc.setValue(Dc.a.l4,!0),yb&&this.Nho(ka,Pc);this.Vg.Uzb&&tc&&tc.attributes&&this.Cno(tc.attributes,Pc);Pc=ka.Kc.GR(Pc);db.Wj=Pc.id;return db}Nho(ka,db){(ka=this.we.NC(ka))&&(ka=ka.Di(Nd.StyleReader.NRb))&&db.setValue(Fd.a.kw,ka.id)}Cno(ka,db){this.vOb(ka.weight>=dm.a.vNf,db,Dc.a.bold,!0);this.vOb(ka.italic,db,Dc.a.italic,!0);this.vOb(ka.underline,
db,Dc.a.underline,!0);this.vOb(ka.underline,db,Dc.a.underlineType,ge.a.LQb);this.vOb(ka.strikethrough,db,Dc.a.strikethrough,!0);if(Qn.a.MWc(ka.highlight)){var yb=Qn.a.MEa(ka.highlight);this.vOb(!!ka.highlight,db,Dc.a.highlight,Qn.a.d5(yb))}Qn.a.MWc(ka.color)&&(yb=Qn.a.MEa(ka.color),this.vOb(!!ka.color,db,Dc.a.fontColor,Qn.a.d5(yb)))}vOb(ka,db,yb,Zb){ka&&db.setValue(yb,Zb)}c1m(ka,db,yb){if(yb.attributes&&yb.attributes.atmention){var Zb=Cd.a.lPa(yb.attributes.atmention.email);yb=yb.optional&&yb.optional.atmention&&
yb.optional.atmention.contentId?yb.optional.atmention.contentId:cb.FKl(1===yb.attributes.atmention.resolveState);Zb=new pl.a(ka,Zb,!0,void 0,void 0,void 0,yb);this.u9k(Zb,db.Kc);ka.hyperlink=Zb}else db=Cd.a.lPa(yb.attributes.link),Zb=this.cbl(ka.paragraph.pa.first),ka.hyperlink=new pl.a(ka,db,!1,Zb.Wj)}cbl(ka){let db=this.bNh();db=ka.paragraph.Kc.GR(db);ka=new im.a(ka,ja.a.nil);ka.Wj=db.id;return ka}u9k(ka,db){var yb=String.format(' HYPERLINK "{0}"',ka.url),Zb=ka.hw;const tc=this.jHd();tc.setValue(qa.a.jt,
15);tc.setValue(qa.a.hw,Zb);tc.setValue(qa.a.EQa,!0);tc.setValue(qa.a.fieldInstruction,yb);ka.Jta(db.GR(tc).id);Zb=this.jHd();Zb.setValue(qa.a.jt,47);Zb.setValue(qa.a.fieldInstruction,yb);ka.Jta(db.GR(Zb).id);yb=this.jHd();yb.setValue(qa.a.jt,16);ka.Jta(db.GR(yb).id)}bNh(){const ka=Xf.a.instance.createInstance(1179649);ka.setValue(Dc.a.IB,!0);ka.setValue(Dc.a.l4,!0);ka.setValue(Dc.a.isHidden,!0);return ka}jHd(){const ka=this.bNh();ka.setValue(Dc.a.g$,!0);return ka}wHn(ka){const db=new hb.a;for(let yb=
0;yb<ka.ops.length;yb++){const Zb=ka.ops[yb];Zb.optional=Xi.C0n(Zb.optional);if(-1!==Zb.insert.indexOf("\n")&&"\n"!==Zb.insert){const tc=Zb.insert.split("\n");for(let Pc=0;Pc<tc.length;Pc++)if(yb!==ka.ops.length-1||Pc!==tc.length-1||tc[Pc])db.add(Object.assign(new wg,{insert:tc[Pc],attributes:Zb.attributes,optional:Zb.optional})),Pc!==tc.length-1&&db.add(Object.assign(new wg,{insert:"\n"}))}else db.add(Zb)}return Object.assign(new bg,{ops:db.toArray()})}static FKl(ka){return yg.ACommentFormatTranslator.wIk+
vh.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(ka?"Z":"")}}cb.Bhn=0;cb.ZQf=0;Object(f.a)(cb,"CommentDeltaFormatTranslator",yg.ACommentFormatTranslator,[]);var Hb=c(1679),bc=c(1556);class Cc{get userPrincipalName(){return this.K.jb("UserPrincipalName")}constructor(ka,db,yb){this.Dj=ka;this.K=db;this.OI=yb}MD(ka){return this.Dj.MD(ka)}pIm(ka){ka=this.Dj.MD(ka);return ka?!ka.done:(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}iUc(ka){return this.Dj.iUc(ka)}isCurrentUserMentioned(ka){var db,
yb;ka=this.Dj.DRl(ka);for(const Zb of ka){if(!Zb.text||0===Zb.text.length)continue;ka=dm.a.tEb(Zb.text[0]);let tc=0;for(;ka.ops&&tc<ka.ops.length;){const Pc=null===(yb=null===(db=ka.ops[tc])||void 0===db?void 0:db.attributes)||void 0===yb?void 0:yb.atmention;if(Pc&&Pc.email===this.userPrincipalName)return!0;tc++}}return!1}Z_c(){this.OI.W4("OnContentFilterUpdate")}}Object(f.a)(Cc,"CommentFilterActor",null,[676]);var Kc=c(100),kd=c(2036),Wd=c(884),ve=c(590);class Ie{constructor(ka,db,yb,Zb,tc,Pc,Od,
ke,od){this.Yh=ka;this.Gb=db;this.ri=yb;this.SUa=Zb;this.Zi=tc;this.U1=Pc;this.vh=Od;this.lT=ke;this.dN=od;this.Btb=null;this.vVe=0;this.vnd=!1;this.Vrd=0;this.$Qb=this.$8c=this.KOg=this.Pvc=this.Oyb=!1;this.updateViewportInfo=()=>{this.lT.Zdg()&&this.vh.updateViewportInfo(this.vnd,this.OWf)};this.$lb=()=>{this.vh.Lla.Foa()&&(this.i4c(this.vh.Lla.rc),this.vh.Lla.whc(this.$lb))};this.OWf=()=>{this.c8a();this.lT.NWf()};this.Lgg=()=>{!this.Oyb&&this.lT.qdg()&&(this.Vrd=this.yXe.scrollTop,this.Oyb=!0,
this.SUa.aHa(2))};this.U3f=(Pe,Se)=>{this.Oyb&&(Pe=this.yXe.scrollTop,Pe-this.Vrd?(this.Pvc||Se.mpe||this.updatePosition(),this.Pvc||1!==Se.mpe||this.c8a(),this.B0e(Pe),this.lT.JVf()):this.Pvc=this.Oyb=!1)};this.yXe=this.vh.Sda;this.nia=ve.a.t9d;this.ot=this.vh.ot;this.vh.JHh()}get YYd(){return this.lT.sGf()}get nia(){return this.vh.nia}set nia(ka){this.vh.nia=ka}get Tuh(){return"1"===this.ot.rF.style.opacity}ipj(ka){this.$8c||(this.$8c=!0,this.vh.M2i(),this.Btb=ka(this.ot.aFa,this.vh.Waj,()=>{this.updatePosition()}),
this.vh.kKi(this.Btb),this.lT.initialize(this.Btb,this),this.vh.initialize(this.Btb,this.lT.bmb),this.vh.v9i(),this.vh.cpj(),this.vh.dpj(),this.vh.hpj(this.lT.N3e,this.lT.q8d,this.lT.p8d),this.G4f())}$7c(){}nie(){return this.vh.$pj()}setInitialActiveContainerId(ka,db,yb=null){this.vh.setInitialActiveContainerId(ka,0,yb)}updatePosition(){if(!this.$Qb&&this.YYd&&this.Yh.A9b()){var ka=E.a.af()-this.vVe<ve.a.EHj;ka||this.vnd||this.c8a(ka)}}S2e(){this.c8a()}VSa(ka,db,yb){this.dN.PCb&&this.U1.W4("OnFloatingCommentsVisibilityChange",
!0);this.vh.VSa(ka,db,yb)}deleteContainer(ka,db,yb=!1){this.vh.deleteContainer(ka,db,()=>{this.Yh.VQc()||this.vh.IVd();this.lT.PTf()},yb)}addContainer(ka,db,yb){this.vh.addContainer(ka,db,yb,this.vh.lf,this.lT.ePc,this.lT.ASf)}r1i(ka){this.$Qb=!0;ka();this.$Qb=!1}b5c(ka,db,yb){this.vh.b5c(ka,db,yb)}Y2b(){this.vh.Y2b()}$Hj(){const ka="1"===this.ot.rF.style.opacity;switch(!0){case ka&&!this.Yh.VQc():this.vh.IVd();break;case !ka&&this.Yh.VQc():this.vh.pPb()}}akg(ka=!0){this.lT.Udg&&this.vh.qAj(ka)}static q8h(ka,
db=null){const yb=new eb.a;for(const Zb of ka)Zb.Cf||Zb.Xq!==kd.a.beingCreated&&(!db||db(Zb))&&Ie.msk(yb,Zb.objectId,Zb);return yb}static msk(ka,db,yb){let Zb;({value:Zb}=ka.Dc(db,Zb)).returnValue||(Zb=[],ka.Z(db,Zb));Zb.push(yb)}i4c(ka){ka&&(ka.Pla(()=>{this.updateViewportInfo()}),this.Vrd=this.yXe.scrollTop,ka.Zqh(this.Lgg),ka.$qh(this.U3f))}G4f(){this.vh.lf?this.i4c(this.vh.lf):this.vh.Lla?this.vh.Lla.N0b(this.$lb):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}B0e(ka){this.ot.rF.style.top=
ka-this.Vrd+"px";this.Pvc=!1}c8a(ka=!1){ka=new oa.a(0,1,0,()=>{this.egf()},129,void 0,!ka);this.Gb.Vb(ka);this.vnd=!0;this.Pvc=this.Oyb;this.SUa.aHa(10)}dtf(ka){return this.vh.w_a({contentAnchorPositions:ka.contentAnchorPositions})}egf(){this.vnd=!1;if(this.ot.aFa&&this.Btb&&this.Yh.A9b()){this.vh.QKd();var ka=0;this.ri.ie(()=>{ka=this.vh.iPd()},"FCM:UP:GET");var db=null,yb=null;this.ri.ie(()=>{const Zb=this.lT.R6h(ka,this.vh.lf);db=Zb.Y2k;yb=this.dtf(Zb)},"FCM:UP:GP");this.ri.ie(()=>{this.Oyb?(this.vh.NVh(yb),
this.Oyb=!1):this.Btb.emitEvent(3,yb);this.U1.Dce()},"FCM:UP:RC");this.Btb.setFirstCommentRenderDone();"0"===this.ot.rF.style.opacity&&0<db.count&&!this.Zi.Zm&&this.Zi.U6a&&this.ri.ie(()=>{this.vh.pPb()},"FCM:UP:SFC");!this.KOg&&0<db.count&&(Mh.a.e3(this.Gb,this.vh.PKi,gj.a.OKi),this.KOg=!0);this.vVe=E.a.af();this.SUa.aHa(6)}else this.vVe=E.a.af()}}Object(f.a)(Ie,"FloatingCommentManager",null,[647,648]);var yf=c(113),gc=c(1478),ff;(function(ka){ka[ka.Wnp=0]="singleHint";ka[ka.Ekp=1]="multiHint";ka[ka.Nmp=
2]="resolvedHint";ka[ka.Fkp=3]="multiResolvedHint";ka[ka.entryPoint=4]="entryPoint";ka[ka.unknown=void 0]="unknown"})(ff||(ff={}));Object(f.b)("CommentIconType",ff);var Gk=c(128),Sh=c(1103);const jm={[1]:"CommentMultiHintIcon_16",[0]:"CommentHintIcon_16",[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[ff.unknown]:""},Jj={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter",
"OfficeIconColors_mCommentMultiHintIconBorder"],[2]:["OfficeIconColors_mCommentResolvedHintIconCenter","OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter","OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[ff.unknown]:[]},Yd=(ka,db)=>{switch(ka){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch(db){case 3:return Sh.a.GGh;
case 2:return Sh.a.HGh;case 1:return Sh.a.IGh}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch(db){case 3:return Sh.a.DGh;case 2:return Sh.a.EGh;case 1:return Sh.a.FGh}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch(db){case 3:return Sh.a.JGh;case 2:return Sh.a.KGh;
case 1:return Sh.a.LGh}}},ih=(ka,db)=>{Gk.a("renderIcon")&&appChrome.api.renderIcon(ka,db)};class mg{}mg.yoi=16;mg.aum=1;mg.Izf=20;mg.uMj=2;Object(f.a)(mg,"CommentIconConstants",null,[]);class Do{constructor(){this.QEd=0;this.QEc=!1}}Object(f.a)(Do,"CommentHintCensus",null,[]);class Eo{constructor(ka,db,yb,Zb,tc){this.JPg=ka;this.f0b=yb;this.I1j=Zb;this.Rfa=tc;this.JMa=-1;this.qwe=new Set(db)}get y(){if(-1!==this.JMa)return this.JMa;const ka=Sys.UI.DomElement.getBounds(this.JPg),db=this.JPg.getClientRects();
return this.JMa=0<db.length&&db[0]?this.I1j?ka.y/this.f0b+mg.uMj:Math.floor(db[0].height)/(2*this.f0b)+ka.y/this.f0b-mg.yoi/2:0}get WEd(){return Array.from(this.qwe)}nwk(ka){this.qwe=new Set([...this.qwe,...ka])}}Object(f.a)(Eo,"HintInfo",null,[695]);class Da extends gc.a{constructor(ka,db,yb,Zb,tc,Pc,Od,ke,od,Pe,Se,ng,Dg,gi){super();this.Vg=ka;this.ig=db;this.sk=yb;this.pE=Zb;this.ga=tc;this.Yh=Pe;this.Dra=Se;this.SUa=ng;this.Zi=Dg;this.i_j=gi;this.Yfd=new Map;this.fub=this.Axb=null;this.Ylc={oIa:-1,
nRf:-1}}Tob(ka){let db=!1;U.App.LLj&&ka.oc.Wi?Q.a.instance.ie(()=>{db=vg.m(ka,!0)},"CHA:SCIVE"):Q.a.instance.ie(()=>{db=vg.l(ka.htmlElement,!0)},"CHA:SCI");return db}sfb(ka){const db=this.zoom,yb=ka.O4,Zb=ka.pwa;let tc=0;for(let ke=0;ke<ka.bca.length;ke++)if(0<ka.bca[ke].width){tc=ke;break}const Pc=ka.veb(1,mg.Izf,db,tc);this.SUa.aHa(1);let Od=[];Zb.forEach((ke,od)=>{const Pe=ka.bca[od].y/db;ke=this.rbl(this.i_l(ke,od),Se=>this.ebl(yb,Se,Se.y-Pe,Pc),()=>Da.ddl(yb));Od=Od.concat(ke)});return Od}rbl(ka,
db,yb){yb=yb();const Zb=[];for(const tc of ka){ka=db(tc);for(const Od of tc.WEd)this.Yfd.set(Od.toString(),ka);const Pc=this.Qci(tc.WEd);this.tGj(Pc,ka);null==yb.Rfa&&(yb.Rfa=tc.Rfa);yb.appendChild(ka);Zb.push(ka)}this.U9b(this.fub);this.Mib(this.Axb);return[yb]}bsl(ka,db){ka=null===ka||void 0===ka?void 0:ka.querySelectorAll("."+Da.a_i);return 0<(null===ka||void 0===ka?void 0:ka.length)&&ka[0]&&(ka=Array.from(ka[0].querySelectorAll(Da.n2k)))?this.Dco(ka,db):!1}Dco(ka,db){let yb=0,Zb=ka.length-1,tc;
for(;Zb>=yb;){tc=Math.floor((Zb-yb)/2+yb);const Pc=ka[tc];if(Pc.offsetTop>=db-2&&Pc.offsetTop<=db+2)return!0;Pc.offsetTop>db+2?Zb=tc-1:yb=tc+1}return!1}Qci(ka){var db,yb;let Zb=0,tc=0;for(const Pc of ka)if(this.Yh.sFf(Pc)){if(this.Vg.contentFilterApiEnabled&&this.Zi.Zm&&(ka=this.Yh.z_(Pc.toString()),null===(yb=(db=this.i_j).isContentInFilteredContent)||void 0===yb||!yb.call(db,ka.id)))continue;this.Yh.Fvi(Pc)?tc+=1:Zb+=1}db=new Do;db.QEd=Zb+tc;db.QEc=0===Zb;return db}Nmc(ka){if(ka=this.Yfd.get(ka.objectId)){var db=
vg.g(ka);db=this.Qci(db);this.tGj(db,ka)}}tGj(ka,db){let yb,Zb;if(this.Vg.contentFilterApiEnabled&&0===ka.QEd)db.style.display="none";else if(1===ka.QEd?(yb=ka.QEc?2:0,Zb=ka.QEc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):1<=ka.QEd&&(yb=ka.QEc?3:1,Zb=ka.QEc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),db.style.display=
"block",ka=db.firstElementChild)this.oko(ka,yb),ka.title=Zb+". "+ka.title,ih(jm[yb],ka)}oko(ka,db){ka.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;yf.a.Kl(ka,Da.MGh,db)}i_l(ka,db){ka=this.fbl(ka,db);ka.sort((yb,Zb)=>yb.y-Zb.y);return this.ydn(ka)}fbl(ka,db){const yb=[],Zb=this.Vg.Yq,tc=this.zoom;ka=vg.f(ka,!0);for(let Pc=0,Od=ka.length;Pc<Od;Pc++){const ke=ka[Pc],od=vg.g(ke);od&&yb.push(new Eo(ke,od,tc,Zb,db))}return yb}ydn(ka){let db=null;const yb=[];for(let Zb=0;Zb<
ka.length;Zb++)db&&Math.abs(ka[Zb].y-db.y)<mg.yoi+mg.aum?db.nwk(ka[Zb].WEd):(db=ka[Zb],yb.push(db));return yb}ebl(ka,db,yb,Zb){const tc=ka.fh.ownerDocument,Pc=tc.createElement("div");Pc.className=Da.BGh;Pc.style.top=yb+"px";Pc.style.left=Zb+"px";Pc.style.right="auto";Pc.style.zIndex="40";yf.a.Kl(Pc,ze.a.pHc,db.WEd);db=tc.createElement("span");this.Qmg(db,Pc);ih(jm[0],db);this.UB(db,ka);return Pc}Qmg(ka,db){ka.title=CommonUIStrings.l_CommentHintTooltip;ka.setAttribute("role","button");db.appendChild(ka)}UB(ka,
db){this.ig.eE(Ek.a.click,ka,this.Spn.bind(this),db);this.ig.nb(Ek.a.pB,ka,this.Wpn.bind(this));this.sk.nb(Ek.a.s0,ka,this.Ypn.bind(this));this.sk.nb(Ek.a.jL,ka,this.Xpn.bind(this));this.pE.nb(ka,this.Vpn.bind(this))}static ddl(ka){ka=ka.fh.ownerDocument.createElement("div");ka.className=Da.a_i;return ka}Vpn(){return!0}Wpn(){return!0}Spn(ka){const db=vg.g(ka.Qw.parentNode);ka.eventName===Ek.a.XJ&&(this.Dra.N7e(),this.zEh());this.ga.Qb(wf.a.CGh,2,db);return!0}Ypn(ka){this.qEa(this.fub)!==ka.Qw&&(ka=
vg.g(ka.Qw.parentNode),this.ga.Qb(wf.a.X8e,2,ka));return!0}Xpn(){this.ga.processAction(wf.a.aFd,2);return!0}U9b(ka){this.zEh();this.fub=ka;this.pFk()}pFk(){this.qFk(this.qEa(this.fub),this.qEa(this.Axb))}Mib(ka){this.$Yk();this.Axb=ka;if(ka=this.qEa(this.Axb)){const db=this.bQd(ka);this.Yge(ka,db,1)}}qEa(ka){if(!ka)return null;let db=null;if(ka=this.Yh.z_(ka))if(ka=ka.Cf?this.Yh.MD(ka.Cf):ka)db=ka.objectId;return db&&this.Yfd.has(db)?this.Yfd.get(db).firstChild:null}zEh(){this.bZk(this.qEa(this.fub),
this.qEa(this.Axb))}bZk(ka,db){if(ka){const yb=this.bQd(ka);this.Yge(ka,yb,ka===db?1:3);this.fub=null}}qFk(ka,db){ka&&(ka.title=0<this.Ylc.nRf&&1<this.Ylc.oIa?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.Ylc.nRf,this.Ylc.oIa):CommonUIStrings.l_CommentHintTooltip,db!==ka&&(db=this.bQd(ka),this.Yge(ka,db,2)))}$Yk(){const ka=this.qEa(this.fub),db=this.qEa(this.Axb);if(db){const yb=this.bQd(db);this.Yge(db,yb,ka===db?2:3);this.Axb=null}}Yge(ka,db,yb){this.BMm()?
this.fko(ka,yb):this.bmo(ka,db,yb)}fko(ka,db){ka=null===ka||void 0===ka?void 0:ka.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===ka||void 0===ka?void 0:ka.length)&&(ka[0].style.fill=2===db||1===db?"Highlight":"ButtonText")}bmo(ka,db,yb){db=Jj[db];for(let tc=0;tc<db.length;tc++){var Zb=db[tc];const Pc=Yd(Zb,yb);if(!this.kJm(Pc)){a.ULS.sendTraceTag(512262488,327,15,`The following CSS variable is undefined: ${Pc}.`);break}Zb=null===ka||void 0===ka?void 0:ka.querySelectorAll("."+Zb);0<(null===
Zb||void 0===Zb?void 0:Zb.length)&&(Zb[0].style.fill=`var(${Pc})`)}}BMm(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}bQd(ka){return yf.a.Db(ka,Da.MGh)}kJm(ka){var db;const yb=document.getElementById(jd.AppFrame.pKc);return!(null===(db=null===yb||void 0===yb?void 0:yb.style)||void 0===db||!db.getPropertyValue(ka))}}Da.BGh="clip16x16 HintContainer";Da.n2k=".clip16x16.HintContainer";Da.a_i="OutlineElementHintMargin";Da.MGh="CommentIconType";Object(f.a)(Da,
"CommentHintActor",gc.a,[666]);var nb=c(1008);class nc extends nb.a{get Udg(){return this.L_()}get hgf(){return this.n8o.Rgi()}constructor(ka,db,yb,Zb,tc,Pc,Od,ke,od,Pe){super();this.Vh=ka;this.vs=db;this.Dj=yb;this.taskManager=Zb;this.Ryd=tc;this.OI=Pc;this.vh=Od;this.getSelectedText=ke;this.n8o=od;this.focusManager=Pe;this.K_c=()=>{};this.j7d=()=>{};this.dMg=!1;this.nVk={[0]:()=>this.DQh(),[1]:()=>this.okc.S2e(),[2]:()=>this.DQh()};this.NWf=()=>{this.Ryd.aHa(11)};this.N3e=Se=>{if(this.vs.Uzb)for(const ng of vg.t)Se.bindAction(Kc.KeyInputManager.CG(ng),
Ij.a.A5e)};this.q8d=()=>{this.j7d()};this.p8d=(Se,ng)=>{if(Se.name!==ag.AFrame.Kr&&ng){var Dg=this.Dj.nt?this.Dj.nt.id:"";this.Vh.wKb||(this.Vh.wKb=Mh.a.e3(this.taskManager,()=>{this.K_c(Dg)}))}};this.eYi=()=>{};this.bmb=()=>{this.Urj()};this.ASf=(Se,ng)=>{0===ng&&(this.OI.Dce(),this.Ryd.aHa(0))};this.PTf=()=>{this.Ryd.aHa(5)};this.ePc=Se=>{let ng=0;const Dg=this.Dj.AO();for(let gi=0;gi<Dg.length;gi++){if(Dg[gi].Cf||Dg[gi].done)continue;if((Dg[gi].Xq===kd.a.beingCreated?Dg[gi].lz.draftId:Dg[gi].id)===
Se.contentId)break;const qh=this.Fx.getContentAnchorPosition(Dg[gi].id);!qh||4<Math.abs(Se.anchorTop-qh.anchorTop)||ng++}return ng};this.oTi=()=>{this.OI.Dce()};this.JVf=()=>{this.Ryd.aHa(2)};this.Urj=()=>{if(!this.dMg&&this.vh.Sda){const Se=this.vh.Sda.getElementsByClassName(Da.BGh);for(let ng=0;ng<Se.length;ng++)Se[ng].style.opacity="1";this.dMg=!0}}}initialize(ka,db){this.Fx=ka;this.okc=db;this.h4c();this.vs.PCb&&this.IXn()}Ejo(ka,db){this.j7d=ka;this.K_c=db}c7h(ka,db){return{nZa:this.pSl(ka,db),
containerContentByType:{}}}R6h(ka,db){const yb=Ie.q8h(this.Dj.AO(),this.Dj.kha),Zb=[],tc=vg.e(!0);var Pc=this.Dj.AO();db=this.zJn(db,Pc,yb);!db.O_f&&db.contentAnchorPosition&&(Zb.push(db.contentAnchorPosition),db.contentAnchorPosition=null);for(Pc=0;Pc<tc.length;Pc++){const Od=tc[Pc],ke=vg.g(Od);if(ke)for(let od=0;od<ke.length;od++){const Pe=this.getContentAnchorPosition(ka,yb,Od,ke[od]);Pe&&(Zb.push(Pe),db.O_f&&db.contentAnchorPosition&&Pe.contentId===db.O_f.id&&(Zb.push(db.contentAnchorPosition),
db.contentAnchorPosition=null))}}db.contentAnchorPosition&&Zb.splice(0,0,db.contentAnchorPosition);return{Y2k:yb,contentAnchorPositions:Zb}}sGf(){var ka;return!(null===(ka=this.Fx)||void 0===ka||!ka.getAreContainersEnabled())}L_(){return this.Dj.A9b()}qdg(){return this.L_()}A8c(){return this.L_()}Zdg(){return this.Fx&&this.vh.Sda&&this.L_()}XLo(){this.OI.W4("OnFloatingCommentsVisibilityChange",this.Vh.U6a);if(this.Vh.U6a)this.vh.pPb();else{const ka=this.Dj.eJ;ka.Iz&&ka.clearSelection();this.vh.IVd()}}UXi(ka){0!==
ka&&this.K_c(this.Dj.nt?this.Dj.nt.id:"")}getContentAnchorPosition(ka,db,yb,Zb){let tc=null;return({value:tc}=db.Dc(Zb.toString(),tc)).returnValue?(db=tc[0])&&!db.Cf?{...(new Wd.a),anchorTop:(ve.a.lOc(yb)-ka)/this.vh.mba,anchorLeft:0,containerContentType:0,contentId:db.id}:null:null}zJn(ka,db,yb){var Zb,tc;const Pc={};"CREATE"===(null===(tc=null===(Zb=this.Dj.ry)||void 0===Zb?void 0:Zb.lz)||void 0===tc?void 0:tc.sessionType)&&(Zb=this.vh.Sda.querySelectorAll(vg.b),ka=this.vh.z4h((0<Zb.length?Zb[0]:
null)||this.getSelectedText(),this.Dj.ry.lz.draftId,0,ka),Pc.O_f=this.C8l(db,yb),Pc.contentAnchorPosition=ka);return Pc}C8l(ka,db){var yb=Array.indexOf(ka,this.Dj.ry);for(--yb;-1<yb;yb--)if(db.mb(ka[yb].objectId))return ka[yb]}pSl(ka,db){return this.R6h(ka,db).contentAnchorPositions}h4c(){this.OI.G9("OnAfterTrackChangeMarkupViewChange",(ka,db)=>{if(db)this.nVk[db.Kj]()})}IXn(){this.OI.G9("OnFloatingCommentsToggle",this.XLo.bind(this))}DQh(){const ka=vg.i();if(0!==ka.length){var db=Ie.q8h(this.Dj.AO()),
yb=this.Dj.eJ;for(let Zb=0;Zb<ka.length;Zb++){const tc=vg.g(ka[Zb]);for(let Pc=0;Pc<tc.length;Pc++){let Od;({value:Od}=db.Dc(tc[Pc].toString(),Od)).returnValue&&(Od.forEach(ke=>{var od;ke&&!ke.Cf&&(this.okc.deleteContainer(ke.id,0,!1),(null===(od=yb.Iz)||void 0===od?void 0:od.id)===ke.id&&yb.clearSelection())}),this.focusManager.mg(ag.AFrame.Pn))}}}}}Object(f.a)(nc,"CommentFloatingContainerActor",nb.a,[675]);var Hc=c(1480),bd=c(2041),ee=c(193);class ic extends Hc.a{constructor(ka,db,yb,Zb,tc,Pc,Od,
ke,od){super();this.yak=ka;this.L9a=db;this.rwe=yb;this.ri=tc;this.x$=ke;this.U1=od;this.Yi=null;this.Kj=1;Zb.execute(Pe=>{this.Yi=Pe});this.s2=[];this.zqc=new ee.ScriptSharpLegacyMap;this.zVn(Pc,Od);this.h4c()}get Aj(){return this.yak.value}get commentEditor(){return this.L9a}get Vba(){return!!this.Yi}get Nib(){return 0}get a2a(){return this.s2}get MYg(){return this.zqc.mb(this.Kj)?this.zqc.J(this.Kj):this.zqc.J(0)}HQa(ka){return this.x$.HQa(ka)}u1a(ka,db){if(ka=Object(Ab.a)(667,ka))for(const yb of this.QJn(ka))db.add(yb)}yGa(ka,
db){this.Vba&&this.ri.ie(()=>{this.Asn(ka,db)},"CHA:OPHC")}Asn(ka,db){if(this.Yi.Jo.A9b()){var yb=this.Hu.oDa,Zb=new Ga.a(new Mc.a),tc=db.TGa("*"),Pc=this.SRl(yb),Od=!!yb&&!yb.action||!!Pc&&Pc===this.Yi.Iz,ke;this.ri.ie(()=>{this.rwe.C6l(ka.id,Zb,null===Pc||void 0===Pc?void 0:Pc.objectId)},"OPHC:GOI");this.ri.ie(()=>{ke=this.MYg.Gyh(tc,Pc,Zb,Od);ke.Evi=this.Cvi(yb)&&0===yb.action},"OPHC:BHI");this.ri.ie(()=>{this.MYg.cuh(tc,ke,Od)},"OPHC:AH")}}SRl(ka){let db=null;!this.Cvi(ka)||0!==ka.action&&2!==
ka.action||(db=this.Hu.oDa.FA);return db||this.Yi.Iz}QJn(ka){if(!ka)return[];ka=this.Aj.Db(ja.a.Ef(ka.objectId));return this.commentEditor.uRd(ka,null)}u$i(){return!1}zF(ka,db,yb){this.Vba&&(ka=Object.assign(new bd.a,{action:ka,type:0,FA:db,LJ:yb}),this.Hu.zF(ka))}N7e(){this.Vba&&(this.zF(3,this.Yi.$9b,this.Yi.$9b),this.Yi.$9b=null)}zVn(ka,db){this.zqc.add(1,ka);this.zqc.add(0,db)}h4c(){this.U1.G9("OnBeforeTrackChangeMarkupViewChange",(ka,db)=>{db&&db.XQf!==this.Kj&&(this.Kj=db.XQf)})}Cvi(ka){return ka&&
0===ka.type}}Object(f.a)(ic,"CommentHighlightActor",Hc.a,[669,416]);var af=c(1027),Vc=c(360),Mg=c(498),We=c(1514);class Jh{constructor(ka,db){this.K2k=ka;this.tSf=db}}Object(f.a)(Jh,"CommentEndParaIdBeforeChangeInfo",null,[]);var pi=c(1616);class Yj{constructor(ka,db,yb,Zb,tc,Pc,Od,ke){this.mJf=ka;this.Vh=db;this.Dj=yb;this.OI=Zb;this.Oo=tc;this.Kk=Pc;this.g2k=Od;this.vs=ke;this.csb=null;this.AJn=(od,Pe)=>{(od=Pe.commentNode)&&!vg.s(od)&&(Pe=this.Dj.Hof(od),ja.a.eq(Pe.B9c,Pe.YKc)||this.UFj(Pe,od)||
this.jDh(Pe.UCa,Pe.BNa,od)||this.cng(od))};this.bmn=(od,Pe)=>{Pe.property===qa.a.lva&&(od=vg.h(Pe.node,ja.a.nil),this.csb=new Jh(Pe.node.id,od))};this.nnn=(od,Pe)=>{od=Pe.node;if(Pe.property===qa.a.lva&&od){var Se=vg.k(od,ja.a.nil);Pe=vg.h(od,ja.a.nil);var ng=this.csb?this.od.Db(this.csb.tSf):null;!vg.s(od)&&Se&&!Se.equals(Pe)&&this.csb&&od.id.equals(this.csb.K2k)&&!Se.equals(this.csb.tSf)&&ng&&ng.isConnected&&this.MZe(this.csb.tSf,od.id);Pe&&this.Vh.Sx.mb(Pe)&&(Se=this.Vh.Sx.J(Pe),Se.T1a&&(a.ULS.shipAssertTag(572835481,
327,!!Se.OM,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),Se.OM&&Se.OM.contains(od.id)&&(Se.OM.remove(od.id),Se.OM.count||(Se.T1a=!1),this.Vh.HU.mb(od.id)?this.Vh.HU.J(od.id).remove(Pe):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};this.h0c=(od,Pe)=>{od=Pe.node.id;this.Vh.Sx.mb(od)&&this.H0n(od)};this.Mln=(od,Pe)=>{Pe&&Pe.node&&this.hVa.mb(Pe.node)&&(od=this.hVa.J(Pe.node).s9d,this.hVa.mb(od)||(od=this.hVa.J(Pe.node),
this.jDh(od.Gcf?od.currentNode:od.s9d,od.Gcf?od.s9d:od.currentNode,od.commentNode)||this.cng(od.commentNode)),this.hVa.remove(Pe.node))};this.qnn=(od,Pe)=>{const Se=od.ak;if(!Pe&&this.ccb.mb(Se)){var ng;(ng=this.ccb).Z(Se,ng.J(Se)&(od.Mc?-2:-3));this.ccb.J(Se)||(this.cng(this.od.Db(Se)),this.ccb.remove(Se))}};this.hVa=new Mg.a(new af.a);this.ccb=new Ve.a(vg.c);this.OI.G9("OnCommentNodeAdded",this.AJn);this.vs.contentFilterApiEnabled?(this.OI.G9("OnCommentPaneOpen",this.$Em.bind(this)),this.OI.G9("OnCommentPaneClose",
this.ZEm.bind(this)),this.OI.G9("OnContentFilterUpdate",this.Z_c.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach(od=>{this.OI.G9(od,this.XEm.bind(this))});this.vs.PCb&&this.OI.G9("OnFloatingCommentsVisibilityChange",this.YEm.bind(this));ka=this.Oo.Ze(12);ka.Ax(this.h0c);ka.$t(this.Mln);this.Oo.Ze(40).cEc(this.bmn);this.Oo.Ze(40).Go(this.nnn);Vc.a.tSa(this.qnn)}get ix(){return this.mJf.value}get od(){return this.ix.od}C6l(ka,db,yb){if(this.VAn(ka))for(const Zb of this.Vh.Sx.J(ka).OM)!this.Wpj(Zb,
yb===Zb.toString())||db.add(Zb)}Wpj(ka,db){const yb=this.od.Db(ka),Zb=vg.s(yb);if(!yb||Zb)return!1;ka=this.Dj.z_(ka.toString());return!ka||this.vs.contentFilterApiEnabled&&this.Vh.Zm&&!this.g2k.isContentInFilteredContent(ka.id)||!this.Vh.Zm&&!this.Dj.kha(ka)&&!db?!1:!0}VAn(ka){return this.BAn(ka)}cng(ka){if(ka){var db=We.a.uRd(ka,null),yb=new Sa.a;for(let Zb=1;Zb<db.length-1;Zb++)this.MZe(db[Zb].id,ka.id),yb.add(db[Zb]);Kf.b(yb)}}YEm(){const ka=new Sa.a;for(const db of this.Dj.AO())!db.Cf&&db.Xq!==
kd.a.beingCreated&&this.Dj.kha(db)&&this.Dj.moe(db,ka);Kf.b(ka)}BAn(ka){if(!this.Vh.fY)return!1;let db=null;if(({value:db}=this.Vh.Sx.Dc(ka,db)).returnValue)return db.T1a;let yb=!1;this.Kk.ie(()=>{const Zb=vg.e();for(let tc=0;tc<Zb.length;tc++)yb=this.GYo(Zb[tc],ka,yb);yb||(this.Vh.Sx.add(ka,new pi.a),this.Vh.Sx.J(ka).T1a=!1)},"CHORA:PHOC");return yb}GYo(ka,db,yb){ka=vg.g(ka);if(!ka)return yb;for(let Zb=0;Zb<ka.length;Zb++){const tc=this.od.Db(ka[Zb]);tc&&!vg.s(tc)&&(yb=yb||this.NVk(tc,db))}return yb}NVk(ka,
db){var yb=this.Dj.Hof(ka);if(this.UFj(yb,ka))return!1;var Zb=yb.B9c;const tc=yb.YKc;yb=yb.UCa;if(Zb!==ja.a.nil&&(Zb.equals(tc)||Zb.equals(db)))return!1;for(Zb=Wa.ParagraphReader.jg(yb,!1);Zb&&!Zb.id.equals(tc);){if(Zb.id.equals(db))return this.MZe(db,ka.id),!0;Zb=Wa.ParagraphReader.jg(Zb,!1)}return!1}MZe(ka,db){this.Vh.HU.mb(db)||this.Vh.HU.add(db,new Ga.a(new Mc.a));this.Vh.HU.J(db).add(ka);this.Vh.Sx.mb(ka)?this.Vh.Sx.J(ka).OM||(this.Vh.Sx.J(ka).OM=new Ga.a(new Mc.a)):this.Vh.Sx.add(ka,new pi.a(!0));
this.Vh.Sx.J(ka).T1a=!0;this.Vh.Sx.J(ka).OM.add(db)}H0n(ka){if(this.Vh.Sx.J(ka).OM)for(const db of this.Vh.Sx.J(ka).OM)this.Vh.HU.mb(db)?this.Vh.HU.J(db).remove(ka):a.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.Vh.Sx.remove(ka)}XEm(){const ka=new Sa.a;for(const db of this.Dj.AO())db.Cf||db.Xq===kd.a.beingCreated||this.Dj.kha(db)||this.Dj.moe(db,ka);Kf.b(ka)}$Em(){this.sBf("OnCommentPaneOpen")}Z_c(){this.sBf("OnContentFilterUpdate")}ZEm(){this.sBf("OnCommentPaneClose")}sBf(ka){const db=
new Sa.a;for(const yb of this.Dj.AO())yb.Cf||yb.Xq===kd.a.beingCreated||this.Dj.eJ.$Ah(ka,yb)||this.Dj.moe(yb,db);Kf.b(db)}UFj(ka,db){let yb=!1;if(!ka.ike||!ka.tKd){yb=!0;if(!ka.UCa||!ka.BNa)return a.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",!ka.UCa,!ka.BNa),!0;ka.ike||this.hVa.mb(ka.UCa)||this.hVa.add(ka.UCa,{commentNode:db,currentNode:ka.UCa,s9d:ka.BNa,Gcf:!0});ka.tKd||this.hVa.mb(ka.BNa)||this.hVa.add(ka.BNa,{commentNode:db,currentNode:ka.BNa,s9d:ka.UCa,
Gcf:!1})}return yb}jDh(ka,db,yb){ka=We.a.Dva(ka,yb.id,!0);db=We.a.Dva(db,yb.id,!1);let Zb;ka||({value:Zb}=this.ccb.Dc(yb.id,Zb),this.ccb.Z(yb.id,Zb&1));db||({value:Zb}=this.ccb.Dc(yb.id,Zb),this.ccb.Z(yb.id,Zb&2));return!ka||!db}}Object(f.a)(Yj,"CommentHighlightOnRestActor",null,[668]);var Zk=c(534),sj=c(415),tk=c(623);class Qm{constructor(ka,db){this.Nyb=ka;this.tka=db}getViewContainer(){return this.Nyb}registerForViewContainerEvents(ka){this.tka.gZn(ka)}unregisterForViewContainerEvents(ka){this.tka.wTo(ka)}}
Object(f.a)(Qm,"ViewContainerProvider",null,[834]);class Li{constructor(ka,db,yb,Zb){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=ka;this.appLocale=db;this.uiCulture=yb;this.dataCulture=Zb}}Object(f.a)(Li,"LocalizationDetails",null,[]);var km=c(1140),Kg=c(1526);class sf{constructor(ka,db,yb,Zb,tc,Pc,Od,ke,od,Pe,Se,ng,Dg,gi,qh,ym,Ol,ah,bk,bj,Il,yj,Jm,Bh,Pl,Km,Di,ln,Go,ri,kr){this.Wq=ka;this.Dj=db;this.o3b=yb;this.i_=Zb;this.vs=tc;this.Vh=Pc;this.NMd=
Od;this.V9b=ke;this.Fq=od;this.pc=Pe;this.dynamicScriptLoader=Se;this.S9n=ng;this.focusManager=Dg;this.e9e=gi;this.a9e=qh;this.bnh=ym;this.z3o=Ol;this.$0=ah;this.OI=bk;this.Bao=bj;this.Vzl=Il;this.RSi=yj;this.A3o=Jm;this.XAb=Bh;this.lT=Pl;this.vh=Km;this.dN=Di;this.p$e=ln;this.X4a=Go;this.bFd=ri;this.m6k=kr;this.Lld=this.uXa=null;this.f_g=!1;this.nMe=[];this.Sdh=this.g_g=!1;this.initialize=(Sm,jq)=>{this.ezm(jq)};this.Rhl=Sm=>Qn.a.L$e(Sm);this.rnn=()=>{this.Bri()};this.gYl=(Sm,jq,Mk)=>{Sm={...(new km.a),
containerPanel:Sm,paneOpenedCallback:jq,paneClosedCallback:Mk,ulsLogger:new Zk.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:y.AFrameworkApplication.isRtl,viewportInfo:this.vh.vpf(),destroyAllContainersCallback:()=>{this.Vh.Zm||a.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.vs.OMd,synchronousContainerPositioningEnabled:!1,trackChangeInSidetrackEnabled:this.vs.trackChangeInSidetrackEnabled,
improveJumpingFixEnabled:!1,shouldInitialize:!this.vs.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,contentNavigationApiEnabled:this.vs.contentNavigationApiEnabled,contentFilterApiEnabled:this.vs.contentFilterApiEnabled,returnToDraftFixEnabled:!0}};this.vs.contentNavigationApiEnabled&&(Sm.sidetrackContentNavigationApi=this.p$e,Sm.featureGateApiSettings=this.lT.hgf,Sm.telemetryDetails=this.RSi,this.vs.contentFilterApiEnabled&&(Sm.contentFilterAPI=this.m6k));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(Sm)};
this.jpn=Sm=>{2!==this.Wq.mode&&3!==this.Wq.mode&&this.Dj.nt&&Sm===this.Dj.nt.id&&this.Wq.clearSelection();U.App.xa.updateCommandUI(!0)};this.eUi=(Sm,jq)=>{this.zx("onCSCStart",window.performance.now());this.Adb&&!Sm&&(this.wxn(),this.zx("openInFishbowl",!0));this.o3b.Edb&&this.vs.iCb&&this.pc.processAction(wf.a.newComment,2);jq&&jq();this.zx("onCSCEnd",window.performance.now())};this.OI.G9("OnCommentInit",this.initialize);this.OI.G9("OnCommentRenderedOnce",this.rnn);this.lT.Ejo(()=>{},this.jpn)}get cKa(){return this.Wq}get Adb(){return this.Vh.Adb}zx(ka,
db){this.X4a.zx(Ri.a.comments,ka,db,!0)}ezm(ka){if(this.Vh.fY)ka&&ka.kGa&&ka.kGa();else if(this.f_g)(null===ka||void 0===ka?0:ka.kGa)&&this.nMe.push(ka.kGa);else{var db=this.vs.B9b;this.zx("hasCommentOnBoot",db);db?this.XAb.logKpiUsage(Kg.a.n3b,0):sj.a.Aec("canvas","floatingComments");this.f_g=!0;this.zx("initInProgress",!0);this.Dj.initialize(this.Wq);this.o3b.initialize(this.Wq,null);this.o3b.epj(this.Wq);this.V9b.Zzm(this.i_.ioo);this.zx("InitAMSetup",window.performance.now());tk.a.zp(this.Vzl).continueWith(yb=>
{(this.uXa=yb.result)||a.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.e9e.initialize(this.uXa);this.cKa.T8e.initialize(this.cKa,this.Dj,this.uXa,this.e9e);this.bnh.initialize(this.dynamicScriptLoader,this.cKa.T8e,this.RSi,this.uXa,new Qm(this.z3o,this.A3o),this.Ebi(),"",this.e9e.Rgi(),this.$0,U.App.eie);this.zx("AMInitialized",window.performance.now());this.vs.contentNavigationApiEnabled?(U.App.xDb?U.App.xDb:this.vh.eHi()).then(()=>{this.zx("FCMLoaded",
window.performance.now());this.$7c();this.kXd(ka)}):this.kXd(ka)})}}vGn(){var ka;null===(ka=sharedComments.setDarkModeColorHandler)||void 0===ka?void 0:ka.call(sharedComments,this.Rhl)}kXd(ka){this.Lld=this.bnh.kXd(void 0,this.vGn.bind(this));this.NSc(ka);this.Vh.fY=!0;this.vs.vfg&&this.a9e.initialize()}NSc(ka){if(!this.Vh.BGb){this.zx("InitCSStart",window.performance.now());var db=this.Fq.Zf("Task","InitiateCommentingSession");this.XAb.logKpiUsage(Kg.a.NGh,0);try{const yb=this.Fq.Zf("Task","InitiateCommentingSession-UpdateModel");
this.bFd.wzm();yb.stop();this.zx("initAtBoot",window.performance.now());this.vs.Yq&&this.Dj.A9b()&&a.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",E.a.af()));Hd.a.get_instance().$H(12);a.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.Vh.BGb=!0;this.Lld.then(()=>{this.zx("SCLoaded",window.performance.now());this.vh.Qzm();this.zx("FCMInitiated",window.performance.now());if(this.vs.Yq){let tc=!1;if(this.Adb){var Zb=
this.i_.JOd(this.Adb);Zb?(y.AFrameworkApplication.ue("3ge3g205;cha3g788"),Zb=this.i_.KOd(Zb,0),Zb)?this.Dj.kha(Zb)||(tc=!0,this.xxn(Zb)):(tc=!0,this.A4a()):tc=!0}Zb=ka?ka.WUi:null;this.vs.contentNavigationApiEnabled?this.eUi(tc,Zb):this.X0m(tc,Zb)}ka&&ka.kGa&&ka.kGa();for(const tc of this.nMe)tc();this.g_g&&this.Bri();this.nMe=[]})}catch(yb){a.ULS.dD(539567713,327,10,yb,`Comments Initialization Failed: ${yb}`),this.XAb.logKpiFailure(Kg.a.NGh,"CommentsInitializationFailed",{isInternal:!0},{name:Kg.a.m3b,
isInternal:!0})}finally{db.stop(),this.zx("InitCSEnd",window.performance.now())}this.pc.processAction(wf.a.pGh,2)}}xxn(ka){this.pc.processAction(wf.a.jV,2);this.lT.Urj();Mh.a.e3(y.AFrameworkApplication.nc,()=>{this.i_.selectComment(ka,{...(new Ad.a),LR:!0,M9:1});this.focusManager.mg(ag.AFrame.Kr);a.ULS.sendTraceTag(574734912,327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-y.AFrameworkApplication.VW)},gj.a.ldo);this.XAb.Pv(wf.a.W8e);y.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordLinkToCommentSettings")}A4a(){this.pc.processAction(wf.a.A4a,
2)}X0m(ka,db){(U.App.xDb?U.App.xDb:this.vh.eHi()).then(()=>{this.zx("FCMLoaded",window.performance.now());this.$7c();this.eUi(ka,db)}).catch(yb=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+yb.toString())})}$7c(){this.dN.trackChangeInSidetrackEnabled?(this.NMd.$7c(),this.zx("STSet",window.performance.now())):this.NMd.ipj(this.gYl)}Bri(){this.Sdh||(this.Vh.fY&&this.Lld?(this.Lld.then(()=>{const ka=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();
this.Bao.execute(db=>{ka.registerSafelinksNavigator(db.wmc.bind(db))});this.S9n.execute(db=>{db.CVn(ka)})}),this.Sdh=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),this.g_g=!0))}Ebi(){return new Li(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}wxn(){this.i_.rij(this.Adb,{...(new Ad.a),Pdg:!1,cUc:!0});this.XAb.Pv(wf.a.W8e)}}Object(f.a)(sf,"CommentInitActor",
null,[]);class he{constructor(ka,db,yb,Zb,tc){this.ig=ka;this.pE=db;this.ga=yb;this.j_j=Zb;this.oj=tc;this.Toe=this.XVa=null}get zoom(){let ka=1;this.oj&&this.oj.instance&&(ka=this.oj.instance.jj);return 0<ka?ka:1}vBl(ka,db){if(!this.Toe||!ka.pwa||db>=ka.pwa.length)return null;const yb=this.zoom,Zb=ka.O4,tc=ka.veb(1,mg.Izf,yb,db);return this.mal(ka.pwa[db],Zb,(this.Toe.y-ka.bca[db].y)/yb+mg.uMj,tc)}mal(ka,db,yb,Zb){if(this.XVa)return(db=this.XVa.parentElement)&&db.removeChild(this.XVa),this.Wkj(ka,
this.XVa,yb,Zb),this.XVa;const tc=db.fh.ownerDocument,Pc=tc.createElement("div");Pc.className=he.d2k;this.Wkj(ka,Pc,yb,Zb);ka=tc.createElement("span");this.Qmg(ka,Pc);ih(jm[4],ka);this.PWn(ka,db);return this.XVa=Pc}Qmg(ka,db){ka.title=CommonUIStrings.l_CommentNewCommentButton;ka.setAttribute("role","button");db.appendChild(ka)}PWn(ka,db){this.ig.eE(Ek.a.click,ka,this.Ron.bind(this),db);this.ig.nb(Ek.a.pB,ka,this.Ton.bind(this));this.pE.nb(ka,this.Son.bind(this))}CVd(){if(this.XVa){const ka=this.XVa.parentElement;
ka&&ka.removeChild(this.XVa)}}Wkj(ka,db,yb,Zb){this.j_j.bsl(ka,yb)?db.style.left=Zb+mg.Izf+"px":db.style.left=Zb+"px";db.style.top=yb+"px";db.style.right="auto";db.style.display="block";db.style.position="absolute";db.style.overflow="hidden";db.style.cursor="default";db.style.zIndex="40"}Ton(){return!0}Ron(ka){this.ga.xC=30;this.ga.processAction(wf.a.newComment,2);ka=ka.Qw;ih(jm[4],ka);ka=ka.parentElement;(null===ka||void 0===ka?0:ka.parentElement)&&ka.parentElement.removeChild(ka);return!0}Son(){return!0}}
he.d2k="clip16x16 EntryPointContainer";Object(f.a)(he,"CommentMarginEntryPointActor",null,[]);var oe=c(418),$e=c(75),fe=c(221),El=c(33),Im=c(118);class Yh{constructor(ka,db,yb,Zb,tc,Pc,Od){this.mJf=ka;this.LZm=db;this.Jo=yb;this.Vh=Zb;this.vs=tc;this.Z8e=Pc;this.XAb=Od;this.V4i=new Set;this.kJb=new Set;this.L0c=new fe.a;this.p3b=new Map;this.SGh=L.a.instance.Ue("Box4.CommentParagraphMapping");this.YAb=new Set;this.Nfa=this.IOd()}get ix(){return this.mJf.value}get od(){return this.ix.od}get XCa(){return this.LZm.value}IOd(){const ka=
new pf.GraphIterator;ka.set(this.ix);this.XCa.u4a(ka);return ka}wzm(){this.Vh.BGb&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",El.Debug.J0a());this.vs.contentNavigationApiEnabled||(this.vs.B9b&&this.uzm(),this.Jo.eWi())}umn(){this.ifj();this.YAb.forEach(ka=>{this.zvg(ka)});this.YAb.clear();this.Jo.eWi()}zvg(ka){if(oe.a.isEnabled){a.ULS.sendTraceTag(512235650,327,15,`Missing Start or End mapping info for Comment ${ka}`);
var db=this.p3b.get(ka).Dkc,yb=this.p3b.get(ka).X5b;db===ja.a.nil||yb===ja.a.nil?a.ULS.sendTraceTag(512235652,327,15,`start ${db} or end ${yb} has invalid value`):(this.SGh.value.d_a.set(ka,db),this.SGh.value.c_a.set(ka,yb),a.ULS.sendTraceTag(512235651,327,50,`Start ${db} and End ${yb} mapping info for Comment ${ka} added on Comment Model load`))}}aCm(ka){const db=[];for(const yb of ka)ka=yb.ak.toString(),this.yFj(ka,yb.paragraph.id,yb.Mc),yb.Mc&&(this.V4i.has(ka)?a.ULS.sendTraceTag(523334301,327,
50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",yb.ak):(this.V4i.add(ka),(ka=this.osk(yb))&&db.push(ka)));return db}yFj(ka,db,yb){oe.a.isEnabled&&(this.p3b.has(ka)||this.p3b.set(ka,{Dkc:ja.a.nil,X5b:ja.a.nil}),yb?this.p3b.get(ka).Dkc=db:this.p3b.get(ka).X5b=db)}osk(ka){var db=this.od.Db(ka.ak);this.Nfa.sj(db);if(40!==this.Nfa.We||!db)return a.ULS.sendTraceTag(523334303,327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",
!db,!ka.ak),this.Nfa=39===this.Nfa.We?this.Nfa:this.IOd(),null;db=this.Jo.QGd(this.Nfa);let yb;if(({index:yb}=this.Jo.cne(db)).returnValue)if(this.Jo.hZe(db,yb),this.kJb.add(db.objectId),vg.p(db)||this.YAb.add(db.objectId),db.Cf)this.ilf(db);else return{contentId:db.id,containerContentType:0,A9:{yd:ka.Ib.cp,NM:ka.paragraph.Al}};else this.L0c.add(db);return null}ilf(ka){if(ka.Cf){var db=this.Jo.MD(ka.Cf);if(db&&db.Cf){const yb=this.Jo.MD(db.Cf);yb&&(yb.Cf?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):
(ka.Cf=db.Cf,a.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${ka.objectId} parentObjectId: ${db.objectId}`)))}}}uzm(){const ka=new M.a(0),db=$e.a.Zo(this.Jo.ZIa),yb=new Set;this.vs.Wyn&&!oe.a.isEnabled&&this.wuk(db,ka);const Zb=this.IOd(),tc=new Set,Pc=new Set,Od=new si.GraphTransaction(2);try{if(Od.Lt(Zb),Zb.Rr(1)){for(;db.moveNext();){if(!Wa.ParagraphReader.sh(db.iterator))continue;const od=db.iterator.currentNode,Pe=Wa.ParagraphReader.hEb(od);oe.a.isEnabled&&
this.Uan(od,Pe,ka);yb.add(od.id.toString());this.q4i(Pe,Pc,Zb,tc)}this.ifj();const ke=this.TRl(yb);0<ke.length&&this.i9n(ke,yb,Zb,Pc);this.YAb.forEach(od=>{this.zvg(od)});this.YAb.clear()}}finally{Od&&Od.dispose()}0==this.kJb.size&&this.vs.B9b&&a.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");bc.a.I5m(tc,Pc,this.od)}q4i(ka,db,yb,Zb){for(const tc of ka){ka=this.vs.Yq?!tc.Mc:tc.Mc;const Pc=tc.ak.toString();this.yFj(Pc,tc.paragraph.id,tc.Mc);ka?db.has(Pc)||
Zb.add(Pc):db.has(Pc)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",tc.ak):(db.add(Pc),this.psk(tc,yb))}}i9n(ka,db,yb,Zb){const tc=this.M7l(ka);bc.a.MWk(tc);const Pc=new Set,Od=new Set;tc.forEach(od=>{db.has(od.id.toString())||Od.has(od.id.toString())||(Od.add(od.id.toString()),od=Wa.ParagraphReader.hEb(od),a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${od.length} CommentRangeObjects`),this.q4i(od,Zb,yb,Pc))});const ke=[];ka.forEach(od=>{this.kJb.has(od)||
ke.push(od)});0<ke.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${ke.length} Failed To Load on Retry: ${ke.join(",")}`),this.XAb.logKpiFailure(Kg.a.n3b,"CommentsFailedToLoadOnRetry",{isInternal:!0},{name:Kg.a.m3b,isInternal:!0}))}M7l(ka){const db=[];ka.forEach(yb=>{if(yb=this.Z8e.P6h(yb))yb=vg.k(yb),(yb=this.od.Db(yb))&&yb.qj&&db.push(yb)});return db}psk(ka,db){const yb=this.od.Db(ka.ak);db.sj(yb);40===db.We&&yb?(ka=this.Jo.QGd(db),({index:db}=this.Jo.cne(ka)).returnValue?(this.Jo.hZe(ka,
db),this.kJb.add(ka.objectId),vg.p(ka)||this.YAb.add(ka.objectId),ka.Cf&&this.ilf(ka)):this.L0c.add(ka)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",!yb,!ka.ak),39===db.We||this.IOd())}TRl(ka){const db=[],yb=this.Z8e.NRl();if(this.kJb.size===yb.length)return db;yb.forEach(Zb=>{!this.kJb.has(Zb)&&bc.a.LVm(Zb,ka,this.Z8e,this.od)&&db.push(Zb)});return db}ifj(){for(let ka=0;ka<this.L0c.length;ka++){const db=this.L0c.J(ka);
let yb;({index:yb}=this.Jo.cne(db)).returnValue?(this.Jo.hZe(db,yb),vg.p(db)||this.YAb.add(db.objectId),this.kJb.add(db.objectId),db.Cf&&this.ilf(db)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ObjectId: {2}, ParentId: {3}",db.uPa,db.a0a,db.objectId,db.Cf))}this.L0c.clear()}wuk(ka,db){ka.mo(yb=>{if(11===yb.We){var Zb=yb.currentNode;const tc=Zb.ia(Im.a.h9e,null),Pc=Zb.ia(Im.a.f9e,null);yb=!!tc&&0<tc.length;const Od=
!!Pc&&0<Pc.length;yb&&tc.forEach(od=>{const Pe=this.od.Db(od);Pe&&!vg.s(Pe)&&db.add(od,0)});Od&&Pc.forEach(od=>{db.mb(od)&&db.remove(od)});(Zb=Zb.ia(Dc.a.MK,null))&&Zb.forEach(od=>{const Pe=this.od.Db(od);Wa.ParagraphReader.Wb(Pe)&&!this.Vh.Sx.mb(od)&&this.Vh.Sx.add(od,new pi.a)});const ke=db.keys;for(let od=0;od<ke.length;od++){Zb&&0<db.J(ke.J(od))&&(this.Vh.HU.mb(ke.J(od))||this.Vh.HU.add(ke.J(od),new Ga.a(new Mc.a)),Zb.forEach(Se=>{const ng=this.od.Db(Se);Wa.ParagraphReader.Wb(ng)&&(this.Vh.Sx.J(Se).OM||
(this.Vh.Sx.J(Se).OM=new Ga.a(new Mc.a)),this.Vh.HU.J(ke.J(od)).add(Se),this.Vh.Sx.J(Se).T1a=!0,this.Vh.Sx.J(Se).OM.add(ke.J(od)))}));let Pe;db.Z(Pe=db.keys.J(od),db.J(Pe)+1)}return yb||Od}return!0},null)}Uan(ka,db,yb){ka&&(this.yTj(db,yb),this.Vh.Sx.mb(ka.id)||this.Vh.Sx.add(ka.id,new pi.a),yb.forEach((Zb,tc)=>{0<tc&&(this.Vh.HU.mb(Zb)||this.Vh.HU.add(Zb,new Ga.a(new Mc.a)),this.Vh.Sx.J(ka.id).OM||(this.Vh.Sx.J(ka.id).OM=new Ga.a(new Mc.a)),this.Vh.HU.J(Zb).add(ka.id),this.Vh.Sx.J(ka.id).T1a=!0,
this.Vh.Sx.J(ka.id).OM.add(Zb));yb.Z(Zb,tc+1);return!0}))}yTj(ka,db){ka.forEach(yb=>{if(yb.Mc){const Zb=this.od.Db(yb.ak);Zb&&!vg.s(Zb)&&db.Z(yb.ak,0)}else db.mb(yb.ak)&&db.remove(yb.ak)})}}Object(f.a)(Yh,"CommentModelBootLoader",null,[664]);var Kk=c(1038);class bf{constructor(ka){this.PGh=ka;this.ttc=null;this.j7g=void 0;this.k7g=null;this.cyc=new Map;this.Gze=new Map}XYn(){Kk.a.tSa(this.pVo.bind(this))}pVo(ka,db){const yb=ka.id.toString();var Zb=ka.getValue(qa.a.$E).toString();db?(this.cyc.delete(yb),
this.Gze.delete(Zb)):(this.cyc.set(yb,ka),this.Gze.set(Zb,ka));0===this.cyc.size&&this.ttc&&(ka=+new Date-+this.ttc,this.ttc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${ka}`));db||this.j7g!==Zb||(db=+new Date-+this.k7g,a.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${db}`),Zb=new I.a,Zb.durationMs=db,this.PGh.logKpiFailure(Kg.a.SEd,"CommentFoundAfterDeeplinkAttempt",
{isInternal:!0,additionalValues:Zb},{name:Kg.a.vGh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:Zb}));this.ttc||(this.ttc=new Date)}set Wen(ka){this.j7g=ka;this.k7g=new Date;if(ka=this.LRl(ka))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${ka.id} present but failed to load`),ka=new I.a,this.PGh.logKpiFailure(Kg.a.SEd,"CommentPresentButFailedToLoad",{isInternal:!0},{name:Kg.a.vGh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ka})}NRl(){return[...this.cyc.keys()]}LRl(ka){return this.Gze.get(ka)}P6h(ka){return this.cyc.get(ka)}}
Object(f.a)(bf,"CommentNodeTracker",null,[]);class tf{get contentType(){return 0}constructor(ka,db,yb,Zb,tc){this.x8f=ka;this.Jo=db;this.i_=yb;this.eJ=Zb;this.Vh=tc;this.x8f.T9i(this)}vij(ka,db,yb){0===db?(db=this.Jo.iUc(ka),this.i_.selectComment(db?this.Jo.ry:this.Jo.MD(ka),Object.assign(new Ad.a,{LR:yb||db,M9:1}))):this.eJ.clearSelection()}Bqj(ka){return this.Vh.Zm||this.Jo.iUc(ka.contentId)?!0:this.Jo.kha(this.Jo.MD(ka.contentId))}}Object(f.a)(tf,"CommentReviewSuggestionContentActor",null,[663]);
class Ep{get nxj(){return this.rhg}constructor(ka,db){this.bFd=ka;this.vs=db;this.rhg=new Set([12])}initialize(){}mHi(ka){if(!Wa.ParagraphReader.Wb(ka.node))return[];ka=Wa.ParagraphReader.hEb(ka.node);return this.bFd.aCm(ka)}MTi(){this.bFd.umn()}Lmi(){return this.vs.fAo?this.vs.B9b:!0}}Object(f.a)(Ep,"CommentReviewSuggestionContentProvider",null,[662]);var Lk=c(68),hj=c(126),uk=c(245),eh=c(1577);class Og{constructor(){this.commentId=null;this.XVc=!1}}Object(f.a)(Og,"CommentToSelectOnPaneLoadData",
null,[]);class Re{constructor(ka,db,yb,Zb,tc,Pc,Od,ke,od,Pe,Se,ng,Dg,gi,qh){this.Wq=ka;this.Jo=db;this.WCa=yb;this.i_=Zb;this.OI=tc;this.Vh=Pc;this.NMd=Od;this.vs=ke;this.o3b=od;this.M3a=Pe;this.pc=Se;this.nJf=ng;this.focusManager=Dg;this.Kk=gi;this.H2k=qh;this.pc.qa(wf.a.kPb,Lk.a.frame,this.Wq.kPb.bind(this.Wq));this.pc.qa(wf.a.IJd,Lk.a.frame,this.IJd.bind(this));this.pc.qa(wf.a.U8e,Lk.a.frame,this.jnn.bind(this));this.pc.qa(wf.a.S1k,Lk.a.frame,this.inn.bind(this));this.pc.qa(wf.a.UQi,Lk.a.frame,
this.Srn.bind(this));this.pc.qa(wf.a.MSh,Lk.a.frame,this.xon.bind(this));this.pc.qa(wf.a.CGh,Lk.a.frame,this.Tpn.bind(this));this.pc.eb(wf.a.X8e,Lk.a.frame,this.$Ek.bind(this),64);this.pc.eb(wf.a.aFd,Lk.a.frame,this.q_n.bind(this),64);this.pc.qa(Ij.a.selectComment,Lk.a.frame,this.i_.ido.bind(this.i_));this.vs.r_m&&this.pc.qa(Ij.a.u1d,Lk.a.frame,this.u1d.bind(this));this.Ynh(Ij.a.xJc,!1);this.Ynh(Ij.a.Sdf,!0);this.pc.eb(Ij.a.cFd,Lk.a.frame,this.cFd.bind(this),64);this.vs.PCb&&this.pc.qa(Ij.a.Xjg,Lk.a.frame,
this.ewn.bind(this));this.pc.qa(Ij.a.UJi,Lk.a.frame,hj.ActionManager.Nf);this.vs.Uzb&&this.pc.qa(Ij.a.A5e,Lk.a.frame,this.AQk.bind(this));this.pc.qa(Ij.a.CQh,Lk.a.frame,(ym,Ol)=>uk.a.rha(Ol.gk)&&uk.a.Jac()?8:32)}get Dj(){return this.Jo}get mode(){return this.Wq.mode}get Iz(){return this.Wq.Iz}get sA(){return this.vs.Yq}get Aj(){return this.M3a.value}get lb(){return this.nJf.value}get eJ(){return this.Wq}IJd(ka,db,yb,Zb,tc){return tc?tc?(ka=this.i_.JOd(tc.NavigationId))&&this.i_.KOd(ka,1)?32:8:(a.ULS.sendTraceTag(540160449,
327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}jnn(ka,db,yb,Zb,tc){tc&&this.OI.W4("OnCommentInit",{...(new eh.a),kGa:()=>{var Pc=this.i_.JOd(tc.NavigationId);if(Pc){var Od=this.i_.KOd(Pc,1);Od?this.o3b.isVisible?(this.D6c(Od,1),this.focusManager.cD(ag.AFrame.Kr)):this.Dj.kha(Od)?(Pc=vg.r(Od),this.i_.selectComment(Od,{...(new Ad.a),LR:!Pc,M9:1}),this.focusManager.cD(ag.AFrame.sM)):(this.Vh.Zm||this.pc.processAction(wf.a.jV,
2),Mh.a.e3(y.AFrameworkApplication.nc,()=>{this.D6c(Od,1)},gj.a.D6c)):this.pc.processAction(wf.a.A4a,2)}}});return 32}inn(ka,db,yb,Zb,tc){tc?(ka=this.Dj.SNc(tc))?this.eJ.Pec(ka.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.eJ.Pec(null);return 32}Srn(ka,db,yb,Zb,tc){if(tc){if(this.Vh.BGb){for(ka=0;ka<tc.length;ka++)this.Dj.Rkj(tc[ka]);this.Wq.UMb()}else this.Dj.twk(tc);this.V5m(tc)}return 32}xon(ka,db,yb,Zb,tc){if(tc)if(this.Vh.BGb){for(ka=
0;ka<tc.length;ka++)this.Dj.Rkj(tc[ka],!0);this.Wq.UMb()}else this.Dj.lZk();return 32}Tpn(ka,db,yb,Zb,tc){this.sA||this.Vh.Zm||this.pc.processAction(wf.a.jV,2);if(tc){ka=null;if(!this.Iz||2!==this.mode&&3!==this.mode){if(!tc)return 8;if(this.sA)ka=this.eDl(tc);else for(db=0;db<tc.length&&(ka=this.Dj.z_(tc[db].toString()),this.NMd.YYd&&(!ka||ka.done));db++);}else ka=this.Iz;this.D6c(ka,1);ka&&this.Vh.fY&&this.focusManager.mg(this.sA&&!this.Vh.Zm?ag.AFrame.sM:ag.AFrame.Kr)}else a.ULS.sendTraceTag(5017933,
327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}$Ek(ka,db,yb,Zb,tc){var Pc;if(!tc)return 32;if(tc&&0<tc.length){db=ka=yb=0;Zb=!1;for(let Od=0;Od<tc.length;Od++)tc[Od].toString()===(null===(Pc=this.Iz)||void 0===Pc?void 0:Pc.objectId)?(Zb=!0,ka++):this.Jo.sFf(tc[Od])&&(Zb&&0===yb&&(yb=Od,db=ka),ka++);(Pc=this.Jo.z_(tc[yb].toString()))?(this.WCa.Ylc.nRf=db+1,this.WCa.Ylc.oIa=ka,this.eJ.Pec(Pc.id)):(tc=tc[yb],this.Aj.Db(tc)?a.ULS.sendTraceTag(540148256,327,10,
`Comment Node with ObjectId ${tc} has no corresponding comment in Model`):a.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",tc.toString()))}return 32}q_n(){this.eJ.Pec(null);return 32}Ynh(ka,db){this.pc.qa(ka,Lk.a.frame,(yb,Zb,tc)=>this.aon(tc,db))}ewn(ka,db,yb){if(2===yb&&this.Vh.Zm)return this.pc.processAction(wf.a.jV,2),this.Vh.U6a=!1,this.OI.W4("OnFloatingCommentsToggle"),32;if(2===yb&&!this.Jo.VQc())return 32;2===yb&&(this.Vh.U6a=
!this.Vh.U6a,this.OI.W4("OnFloatingCommentsToggle"));return 32}u1d(ka,db,yb){2===yb&&(ka=this.Dj.Us.Oc(7),ka.Cb(this.Dj.ZIa),db=new dm.a,db.iha(`${String.fromCodePoint(128077)} \n`),this.Jo.BBb(Ch.a.instance.gb.kb,void 0,db),this.H2k.CVd(),ka.dispose());return 32}aon(ka,db=!1){if(2===ka)ka=this.Dj.Us.Oc(15),ka.Cb(this.Dj.ZIa),this.Kk.ie(()=>{this.xJc(db)},"ECM:DAC"),ka.dispose();else if(1===ka&&!this.Dj.A9b())return 2;return 32}xJc(ka=!1){this.Wq.mode=1;const db=this.Dj.AO();for(const yb of db)yb.Xq===
kd.a.beingCreated||ka&&!yb.done||yb.Cf||this.Wq.deleteComment(yb);this.focusManager.mg(ag.AFrame.Pn);0<(ka?this.Dj.AO().filter(yb=>yb.done):this.Dj.AO()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",ka):a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",ka)}cFd(ka,db,yb){if(2===yb)if(ka=this.focusManager.currentScope.name,ka!==ag.AFrame.Kr&&ka!==ag.AFrame.sM){!this.sA||this.Vh.Zm?(this.Vh.Zm||
this.pc.processAction(wf.a.jV,2),this.focusManager.mg(ag.AFrame.Kr)):this.focusManager.mg(ag.AFrame.sM);var Zb=this.lb.gb.kb;if(!Zb||!Zb.Oa)return 2;ka=Zb.Oa.cpBegin;db=Zb.Oa.node;Zb=!!this.Iz&&(Tc.SelectionEditor.Sl(Zb)||Zb.LH)&&vg.q(this.Iz,db,this.Aj,ka);ka=!!this.Iz&&(2===this.mode||3===this.mode);if(Zb||ka)return this.eJ.xij(this.Iz.id,!0),32;Zb=this.sA&&!this.Vh.Zm?this.Dj.Q6h(!0,!0):null;this.eJ.rdo(Zb)}else this.Dj.nt&&(this.Wq.V9b.qij(this.Dj.nt,!0),this.Wq.V9b.Mib(null===(Zb=this.Dj.nt)||
void 0===Zb?void 0:Zb.objectId)),this.focusManager.mg(ag.AFrame.Pn);return 32}AQk(){return 4}V5m(ka){const db=new Set;for(let yb=0;yb<ka.length;yb++){const Zb=this.Dj.SNc(ka[yb]);Zb&&db.add(Zb.Cf?Zb.Cf:Zb.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",db.size.toString())}D6c(ka,db){ka?this.o3b&&!this.Vh.fY?this.Vh.Xeb=Object.assign(new Og,{commentId:ka.id,XVc:!1}):this.i_.selectComment(ka,Object.assign(new Ad.a,{LR:!!db,M9:db})):a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}eDl(ka){let db=
null,yb=!1;for(let Zb=0;Zb<ka.length;Zb++){const tc=ka[Zb].toString();if(this.Dj.sFf(ka[Zb])){db||(db=tc);if(yb&&this.Dj.nt.objectId!==tc)return this.Dj.z_(tc);yb=yb||!!this.Dj.nt&&this.Dj.nt.objectId===tc}}return db?this.Dj.z_(db):null}}Object(f.a)(Re,"CommentsActionManager",null,[]);var we=c(231),Gb=c(47),Ui=c(176),dp=c(1823),qi=c(513),Fl=c(31),$k;(function(ka){ka[ka.afp=0]="commentDeeplink";ka[ka.catchUpActivity=1]="catchUpActivity"})($k||($k={}));Object(f.b)("DeeplinkSource",$k);class bn{constructor(ka,
db,yb,Zb,tc,Pc,Od,ke,od,Pe,Se,ng,Dg){this.ga=ka;this.Yh=db;this.zv=yb;this.swe=Zb;this.WP=tc;this.Qfh=Pc;this.Ub=Od;this.Zi=ke;this.Vg=od;this.kvb=Pe;this.uwe=Se;this.gK=ng;this.ZSe=!1;this.ioo=gi=>{if(this.Vg.Yq&&!this.Zi.Zm){const qh=new oa.a(0,1,0,()=>{this.Dkj(gi)},136,void 0,!0);y.AFrameworkApplication.nc.Vb(qh)}else this.Dkj(gi)};Dg.execute(gi=>{this.xE=gi})}get Jo(){return this.Yh}get lb(){return this.kvb.value}OVh(ka){let db=ka.Xq===kd.a.beingCreated?ka.lz.draftId:ka.id,yb=null;ka.Cf&&(db=
ka.Cf,yb=()=>{this.Qfh.selectComment(ka.id)});this.WP.setInitialActiveContainerId(db,0,yb)}ido(ka,db,yb,Zb,tc){if(!tc.commentId)return 2;ka=this.Yh.MD(tc.commentId);if(!ka)return 2;this.iob(ka,tc);return 32}uij(ka,db){var yb,Zb;if(ka){var tc=(null===(Zb=null===(yb=this.Yh.ry)||void 0===yb?void 0:yb.lz)||void 0===Zb?void 0:Zb.draftId)===ka?this.Yh.ry:this.Yh.MD(ka);this.selectComment(tc,db)}}selectComment(ka,db){ka&&this.iob(ka,db)}rij(ka,db){var yb=this.JOd(ka);yb&&((yb=this.KOd(yb,0))?db.Pdg?(this.Zi.Xeb=
Object.assign(new Og,{commentId:yb.id,XVc:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):(this.iob(yb,Object.assign(new Ad.a,{commentId:yb.id,M9:1,LR:!0,cUc:!0})),this.Vg.Yq&&void 0!==ka&&null!==ka&&this.OVh(yb),Mh.a.e3(y.AFrameworkApplication.nc,()=>{this.Ub.mg(this.Vg.Yq&&!this.Zi.Zm?ag.AFrame.sM:ag.AFrame.Kr)},gj.a.Gjo),we.a.instance.qf(Gb.a.xPh,(new Date).getTime()),ka=this.Vg.Yq?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",
ka+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,ka,(new Date).getTime()-y.AFrameworkApplication.VW)):this.ga.processAction(wf.a.A4a,2))}JOd(ka){let db=null;var yb=null;if(J.a.sbc(ka))db=ka;else if(({av:yb}=w.d(ka)).returnValue&&(ka=yb))return qi.a.comment in ka&&(db=ka[qi.a.comment]),db;db||(yb=yb?Object.keys(yb):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",yb?yb.join(","):"Not Json."));return db?db.toString():null}KOd(ka,db){const yb=this.Yh.SNc(ka),
Zb=0===db;Zb&&this.gK.logKpiUsage(Kg.a.SEd,0);if(!yb){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",ka,db);const tc=new Fl.a;tc.name="DeepLinkSource";tc.string=$k[db];this.gK.logActivity("CommentDeeplinkNotFound",{dataFields:[tc]});Zb&&(db=new I.a,db.extendedProperties=new Map([["ErrorLevel","warning"]]),this.gK.logKpiFailure(Kg.a.SEd,"CommentNotFound",{isIntentional:!1,isInternal:!0,additionalValues:db}),this.uwe.Wen=ka)}return yb}Dkj(ka){this.ZSe=
!0;this.lb.setSelection(ka);this.ZSe=!1}iob(ka,db){if(ka){this.Vg.PCb&&!this.Zi.U6a&&this.ga.processAction(Ij.a.Xjg,2);this.Zi.wKb&&(y.AFrameworkApplication.nc.Xe(this.Zi.wKb),this.Zi.wKb=null);var yb=this.Yh.nt,Zb=this.Jo.atf(ka),tc=2===db.M9,Pc={};tc&&(Pc.TriggeredByFindReplace=!0);if(this.Zi.Zm)tc&&(Pc.PaneAlreadyOpen=!0),Ui.UISurfaces.Gu().then(Od=>{Od.setSelectedTaskPane(dp.a.dFd);return null});else if(ka.Xq!==kd.a.beingCreated&&!this.Jo.kha(ka))this.Zi.fY?this.ga.processAction(Ij.a.jV,2):this.Zi.Xeb=
Object.assign(new Og,{commentId:ka.id,XVc:db.cUc}),tc&&(Pc.OpeningPaneToSelect=!0);else if(this.Vg.Yq){const Od=Zb.Xq===kd.a.beingCreated;Od?this.WP.VSa(Zb.lz.draftId,0,db.LR):this.WP.VSa(Zb.id,0,db.LR);!Od&&tc&&(Pc.SelectingDHC=!0)}Mh.a.e3(y.AFrameworkApplication.nc,()=>{this.Zi.fY&&(db.LR&&this.Ub.mg(this.Vg.Yq&&!this.Zi.Zm?ag.AFrame.sM:ag.AFrame.Kr),db.cUc&&this.Jo.kha(ka)||!db.LR&&!db.M9||this.Qfh.selectComment(ka.id))},gj.a.Pag);tc=this.Jo.atf(yb);this.Vg.sua&&this.xE&&tc&&tc.id!==Zb.id&&this.xE.fireEvent(9,
{comment:tc});this.Yh.selectComment(ka);this.Vg.sua&&this.xE&&ka.Xq===kd.a.normal&&!ka.Cf&&this.xE.fireEvent(8,{comment:ka});this.swe.highlightComment(ka,!0);this.zv.zF(0,Zb,yb);U.App.xa.updateCommandUI(!0);0<Object.keys(Pc).length&&this.gK.Pv(Ij.a.selectComment,{customData:Pc})}}}Object(f.a)(bn,"CommentSelectionActor",null,[660]);class yq extends qf.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new zd.a,{T_:yq.getTypeName(),B_:yq.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(f.a)(yq,"CommentSmartReplySignal",qf.a,[]);class zq extends Va.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new zd.a,{T_:zq.getTypeName(),B_:zq.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(f.a)(zq,"SmartReply",Va.a,[]);var yr=c(852);class Aq{constructor(ka){this.Cra=ka}f4b(ka,db){return Object.assign(new yr.a,
{parentPath:["Signal",yq.getTypeName()],items:[Object.assign(new Oe.a,{body:Object.assign(new yq,{commentId:ka,comment:db})})]})}f_f(ka){const db=new hb.a;if(ka&&ka.CommentId&&ka.ResultSets&&0<ka.ResultSets.length&&ka.ResultSets[0].Documents&&0<ka.ResultSets[0].Documents.length){for(const yb of ka.ResultSets[0].Documents)db.add(yb.Caption);0<db.count&&this.Cra.f_f(ka.CommentId,db.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return zq.getTypeName()}}
Object(f.a)(Aq,"BaseCommentSmartReplyProvider",null,[946]);class Hn extends Aq{constructor(ka,db,yb,Zb){super(ka);this.Se=db;this.jA=yb;this.AXj=Zb}initialize(){this.jA.Mk().then(()=>{this.Se.nb(this,Aq.prototype.getTypeName.call(this))})}invoke(ka,db){this.jA.Mk().then(()=>{this.AXj.getAugLoopRuntimeManager().submitOperation(Object.assign(new zb.a,{operation:this.f4b(ka,db)}))})}EA(ka,db){ka&&va.a.getTypeNameFor(ka.content)===this.getTypeName()&&db===Na.a.getTypeName()?this.f_f(ka.content):a.ULS.sendTraceTag(579170963,
327,10,"Invalid annotation event for smart replies")}}Object(f.a)(Hn,"CommentSmartReplyProvider",Aq,[359]);var Fp=c(38),In=c(139),vk=c(156),go=c(370);class lj{constructor(ka,db,yb,Zb,tc,Pc){this.Fa=ka;this.ld=db;this.wx=yb;this.bJe=Zb;this.uwe=tc;this.dN=Pc;this.pub=!1;this.uwe.XYn();this.h_j=this.f6l();this.w3f&&(Fp.a.addHandler(window.self,Ek.a.Qrh,()=>{this.pub=!0}),Fp.a.addHandler(window.self,Ek.a.Rrh,()=>{this.pub=!1}))}get ix(){return this.wx?this.wx.value:null}get XCa(){return this.bJe.value}get oRo(){return this.pub}get B9b(){return 0<
this.h_j}get Yq(){return this.dN.Yq}get Xol(){return!0}get zJk(){return Object(go.c)()?!1:this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoPopulateShareTUIComment",!1)}get eQb(){return this.ld.isFeatureEnabled(115)&&!vk.App.kVc}get Aeo(){return this.ld.isFeatureEnabled(37)&&this.Fa.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get T1k(){return this.Fa.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get w3f(){return this.Fa.$("RecordCommentActionsInTypingIsEnabled")}get yRi(){return this.Fa.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get iCb(){return this.Yq&&
!this.B9b&&!this.Fa.jb("BootActivityNavigationId")&&G.a.iu}get Uzb(){return this.ld.isFeatureEnabled(7)}get yIk(){return this.Fa.$("AtMentionUserFloodGateCampaignIsEnabled")}get i2k(){return this.Fa.$("CommentFriendlyTimestampsIsEnabled")}get Qol(){return this.Fa.jb("DisabledChangeGatesInSharedComments")}get OMd(){return this.dN.OMd}get tPb(){return this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",!1)}get vfg(){return this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",
!1)}get zY(){return this.Fa.jb("PresenceUserId")}get removePersonalInformation(){return vk.App.Ope&&!!In.PageReader.instance&&In.PageReader.instance.Gna(U.App.xa.ib.Uc).removePersonalInformation}get qgb(){return this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",!1)}get x0m(){return this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SharedCommentsLivePersonaCardForWeb",!1)}get MIo(){return this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1)}get PCb(){return this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.HideCommentsByDefaultEnabled",!1)}get $2k(){return this.Fa.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get P2k(){return this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReactionsFPSEnabled",!1)}get r_m(){return this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",!1)}get contentNavigationApiEnabled(){return this.dN.contentNavigationApiEnabled}get Wyn(){return this.ld.isFeatureEnabled(86)}get sua(){return this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",
!1)}get contentFilterApiEnabled(){return this.dN.contentFilterApiEnabled}get h2k(){return this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentFilterHintIconFix",!0)}get fAo(){return this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipParaTraversalIfNoComments",!1)}get hzl(){return this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExpandToFullHyperlinkRange",!1)}f6l(){if(this.ix&&this.XCa){const ka=new pf.GraphIterator;ka.set(this.ix);this.XCa.u4a(ka);let db=0;39===
ka.We&&(db=ka.Mp());return db}return-1}}Object(f.a)(lj,"CommentsSettings",null,[]);var tj=c(1613),fi=c(1374);class lb{constructor(ka){this.x$=ka}Gyh(ka,db,yb){const Zb=new Hm;db=this.x$.HQa(db)?db.objectId:null;if(!db)return Zb;db=ja.a.Ef(db);if(yb.contains(db))return Zb.ySc=0,Zb.xSc=ka.length,Zb;for(let Pc=0,Od=ka.length;Pc<Od;Pc++){var tc=ka[Pc];yb=vg.g(tc);tc=vg.d(tc);yb&&fi.a.pIh(yb,db)&&(Zb.ySc=Pc);if(tc&&fi.a.pIh(tc,db)){Zb.xSc=Pc;break}}return Zb}cuh(ka,db,yb){const Zb=-1===db.ySc&&-1===db.xSc,
tc=-1<db.ySc?db.ySc:-1;db=-1<db.xSc?db.xSc:ka.length;const Pc=!Zb&&tc===db;var Od=!1;for(let ke=0;ke<ka.length;ke++){const od=ka[ke],Pe=Kf.a(od);if(1!==Pe&&2!==Pe&&3!==Pe)continue;this.x$.wSa(od);if(Zb||ke<tc||ke>db)continue;const Se=3===Pe||2===Pe&&-1!==od.className.indexOf(ze.a.MPa),ng=yb?1:2;this.aGk(ke,tc,db,ng,Se,Od,od,Pc);if(ke!==db||Pc)(Od=this.x$.$1a.J(Pe).J(ng))&&od.classList.add(Od),Od=Se}}aGk(ka,db,yb,Zb,tc,Pc,Od,ke){ka!==db&&ka!==yb||tc||Pc||((ka=this.x$.jgc.J(Zb))&&Od.classList.add(ka),
ke&&Od.classList.add(ze.a.EZf))}}Object(f.a)(lb,"DefaultHighlightChangeHandler",null,[657]);var vc;(function(ka){ka[ka.success=0]="success";ka[ka.noSelection=1]="noSelection";ka[ka.invalidContent=2]="invalidContent"})(vc||(vc={}));Object(f.b)("AnchorCreationResult",vc);var fd=c(60),Md=c(23),Wc=c(275),Cf=c(233),$c=c(1200);class fh{}Object(f.a)(fh,"EditorAnchorInfo",null,[690]);class Df{constructor(ka,db,yb,Zb,tc,Pc,Od,ke){this.QZm=ka;this.nJf=db;this.Dj=yb;this.k2a=Zb;this.WCa=tc;this.xo=Pc;this.OI=
Od;this.vs=ke;this.Hfh=null;this.k2a.G5a(this.WCa);this.vs.contentFilterApiEnabled&&(this.OI.G9("OnCommentPaneOpen",this.lXo.bind(this)),this.OI.G9("OnCommentPaneClose",this.kXo.bind(this)),this.OI.G9("OnContentFilterUpdate",this.Z_c.bind(this)))}get lb(){return this.nJf.value}get Aj(){return this.QZm.value}initialize(){}Zzm(ka){this.Hfh=ka}dispose(){}Mib(ka){this.WCa.Mib(ka)}U9b(ka){this.WCa.U9b(ka)}highlightComment(ka){this.qij(ka,!1);this.WCa.Mib(ka.objectId)}Nmc(ka){this.WCa.Nmc(ka)}qEa(ka){return this.WCa.qEa(ka)}Z_c(){this.Bre("OnContentFilterUpdate")}lXo(){this.Bre("OnCommentPaneOpen")}kXo(){this.Bre("OnCommentPaneClose")}Bre(ka){const db=
[],yb=new Set;for(const tc of this.Dj.AO())if(!tc.Cf&&tc.Xq!==kd.a.beingCreated&&!this.Dj.eJ.$Ah(ka,tc)){var Zb=this.$6l(tc);yb.has(Zb.id.toString())||(yb.add(Zb.id.toString()),(Zb=Zb.De(fd.InteractiveViewManager.instance.Bd.fc))&&db.push(Zb))}db.forEach(tc=>{this.k2a.Omc(tc)})}$6l(ka){var db,yb;const Zb=null===(db=this.Aj)||void 0===db?void 0:db.Db(ka.objectId);if(!Zb)return null;ka=vg.k(Zb);db=null===(yb=this.Aj)||void 0===yb?void 0:yb.Db(ka);return bc.a.rdi(db)}qij(ka,db){if(!ka.Xq){var yb=this.Aj.Db(ja.a.Ef(ka.objectId)),
Zb=We.a.Eba(yb,this.Aj,!0);yb=We.a.Eba(yb,this.Aj,!1);if(Zb&&yb){const tc=Zb.Ib.paragraph;Zb=Zb.Ib.cp;if(this.TSm(tc,Zb))U.App.xa.updateCommandUI(!0);else{Zb=Md.SelectionFactory.pe(tc,Zb);yb=Rc.a.Qc(yb.Ib.paragraph,yb.Ib.cp);if(Df.Wf.M8(Zb.Oa)||Df.Wf.M8(yb))ka.pQa=!0,ka.r4a();ka=db?Md.SelectionFactory.oz(Zb,yb):Zb;this.Hfh(ka)}}}}ZYk(){this.WCa.U9b(null);this.WCa.Mib(null)}s9k(){const ka=new fh;return{returnValue:vc.success,anchor:ka}}TSm(ka,db){if(ka&&Object(am.a)($c.PageView,this.xo.Bd)){var yb=
ka.De(this.xo.Bd.fc);ka=document.getElementById(jd.AppFrame.BUa);if(yb&&ka){db=Wc.a.Tq(yb,db);if(!db)return!1;db=db.y;yb=Sys.UI.DomElement.getBounds(ka).y;ka=ka.offsetHeight;if(db>=yb&&db<=yb+ka)return!0}}return!1}static get Wf(){return Cf.a.instance}static getInstance(){return Df.Rl()}static Rl(){return Df._instance||(Df._instance=new Df(new X.a(()=>U.App.xa.ib.Uc.od),new X.a(()=>Ch.a.instance),L.a.instance.resolve("WordEditor.Comments.IEditorCommentModel"),L.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,
L.a.instance.resolve("WordEditor.Comments.CommentHintActor"),fd.InteractiveViewManager.instance,L.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),L.a.instance.resolve("WordEditor.Comments.CommentsSettings")))}}Df._instance=null;Object(f.a)(Df,"EditorCommentHintManager",null,[655,656,10]);var sd=c(2038),Ug=c(349),Kj=c(1149);class nh extends Wl.a{constructor(ka,db,yb,Zb,tc,Pc,Od,ke,od,Pe,Se,ng,Dg,gi,qh,ym,Ol,ah,bk,bj,Il,yj,Jm,Bh,Pl,Km){super(Od);this.mi=db;this.kvb=ke;this.T8e=Pe;this.Dra=
Se;this.Bqc=ng;this.WP=Dg;this.Vg=gi;this.Wp=qh;this.GTb=ym;this.Zi=Ol;this.U1=ah;this.ge=bj;this.gK=Il;this.lT=Jm;this.UEd=Bh;this.vMo=Km;this.Rni=this.Ahh=this.oWa=null;this.$lb=()=>{this.mra.Foa()&&(this.L9i(this.mra.rc),this.mra.whc(this.$lb))};this.BZc=Di=>{2===Di.mode?this.nD=1:1===Di.mode&&(this.nD=0);this.Yh.ry&&0===this.nD?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",this.Yh.ry.lz.sessionType):this.Zi.fY&&(this.sA||
this.V1.isVisible)&&this.UMb()};this.qln=()=>{this.Zi.BGb?this.mode=0:this.nD=0};this.AGa=(Di,ln)=>{var Go;Di=ln.ol.kb;if((this.sA||this.Oca&&this.Oca.isVisible)&&!this.GTb.ZSe&&Di){ln=Tc.SelectionEditor.Sl(Di);var ri=Di.LH;null!==(Go=this.Rni)&&void 0!==Go&&Go.rba||(this.Jo||a.ULS.sendTraceTag(509698397,327,15,"onSelectionChange: CommentModel Not Set."),Go=this.Jo&&this.Jo.Cjb(this.ga,!1),1!==this.mode||ln&&!ri||!Go?this.Bqc.CVd():this.icl(Di));2!==this.mode&&3!==this.mode&&this.Vg.T1k&&this.DPo(Di,
ln,ri)}};this.IWk=()=>{if(this.Dj&&this.Dj.ry&&!U.App.LBf){var Di=this.Dj.ry;Di.lz.sessionType!==sd.a.metadata&&(a.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${Di.Xq} present on app shutdown`),(Di=bc.a.OVl(Di))&&this.gK.logKpiFailure(Di,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:Kg.a.m3b,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.zln=()=>{if(this.Zi.fY){var Di=()=>!0;this.sA&&!this.Zi.Zm&&(Di=ln=>this.Jo.kha(ln));Di=this.Jo.oof(Di);this.UMb(Di)}};this.ga=
Od;this.nD=1===this.ga.mode?0:1;this.V1=tc;this.Yh=Zb;this.O$=Pc;this.Ub=od;this.XXn();yb.F5a(this.Dra);this.lb.Pw(this.AGa);ka.CWR(()=>ka.result.bC.UMa(this.qln));y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.dZa(this.BZc);this.U1.G9("OnAfterTrackChangeMarkupViewChange",this.zln);y.AFrameworkApplication.cI&&y.AFrameworkApplication.cI(this.IWk);Pl.execute(Di=>{this.xE=Di});yj.execute(Di=>{Di.T6k.execute(ln=>{this.Rni=ln})})}XXn(){this.mra&&(this.mra.Foa()?this.L9i(this.mra.rc):this.mra.N0b(this.$lb))}L9i(ka){ka.Pla(()=>
{this.GDo()})}get mra(){var ka;return null===(ka=vk.App.sn)||void 0===ka?void 0:ka.ib}get lb(){return this.kvb.value}get Dj(){return this.Yh}get Jo(){return this.Yh}get sA(){return this.Vg.Yq}get fRi(){return!0}get ijj(){return!0}get $9b(){return this.oWa}set $9b(ka){this.oWa=ka}get mode(){return super.mode}set mode(ka){ka!==this.nD&&(super.mode=ka,this.r4a())}get Iz(){return this.model&&this.model.nt?this.model.nt.Cf?this.model.MD(this.model.nt.Cf):this.model.nt:null}get Aj(){return this.mi.value}get Vrj(){return!1}get removePersonalInformation(){return this.Vg.removePersonalInformation}UMb(ka=
null,db=null){const yb=this.Jo,Zb=!this.nD,tc=this.Oca.e2k,Pc=yb.gRd();tc.bng(Pc?5:1,Zb);ka=this.Vg.tPb&&ka?ka:yb.Jof(this.Vg.tPb&&this.sA&&!this.Zi.Zm);tc.ueo(ka,Pc,yb.kVa);this.Dmg();db&&a.ULS.sendTraceTag(572281362,327,50,db)}$_c(ka,db,yb=!1){this.Zi.Zm?this.WP.$Hj():db?this.WP.deleteContainer(ka.Xq===kd.a.beingCreated?ka.lz.draftId:ka.id,0,yb):this.dQn(ka)}dQn(ka){const {DKo:db}=this.Yh.n0l(ka),yb=this.O$.qEa(ka.objectId);yb&&this.WP.addContainer(ka.id,yb.parentElement,0,db)}Bij(ka){const db=
this.Iz;this.F6c();this.Dra.zF(0,this.Yh.nt,db);this.sA&&this.Yh.nt&&!this.Zi.Zm&&this.WP.VSa(this.Yh.nt.id,0,1===ka)}sdo(){const ka=this.Iz;this.G6c();this.Dra.zF(0,this.Yh.nt,ka);this.sA&&this.Yh.nt&&!this.Zi.Zm&&this.WP.VSa(this.Yh.nt.id,0,!1)}Nmc(ka){this.O$.Nmc(ka)}zul(ka,db){this.WP.addContainer(ka,null,0,db)}ICn(ka){this.WP.r1i(ka)}Bul(ka,db){this.WP.b5c(ka,db,0)}vWo(){this.WP.S2e()}tij(ka){if(ka&&(2!==this.mode||ka.Xq===kd.a.beingCreated)){var db=this.Yh.nt;db!==ka&&(this.Yh.selectComment(ka),
this.V1.isVisible?this.Zi.fY?(this.V1.selectComment(ka,1),this.tka.selectComment(ka.id)):this.Zi.Xeb=Object.assign(new Og,{commentId:ka.id,XVc:!1}):this.sA&&!ka.done&&(this.xij(ka.id,!1),this.tka.selectComment(ka.id)),!this.V1.isVisible&&this.sA&&ka.done||(this.V9b.Mib(ka.objectId),this.Dra.zF(0,this.Iz,db)))}}NSc(){}Qhf(){this.Zi.BGb=!1}jzb(ka){this.Vg.yRi&&this.Yh.nt&&this.clearSelection();super.jzb(ka);this.gK.logKpiUsage(Kg.a.d9e,0);this.Dmg();if(this.sA){const db=this.Yh.Pgm(ka.draftId);this.zul(ka.draftId,
db)}}addReply(ka,db){this.gK.logKpiUsage(Kg.a.fFd,0);super.addReply(ka,db)}tua(ka){this.sA&&null!=ka.lz&&this.Yh.R$i(ka.lz.draftId);super.tua(ka);this.O$.Mib(ka.objectId);a.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",vg.a(ka));this.gK.logKpiUsage(Kg.a.tGh,0);this.NWk(ka);bc.a.g3o(ka,this.Aj,this.gK);this.gK.Pv(Ij.a.sGh,{succeeded:!0,customData:{actionType:ka.Cf?sd.a.reply:sd.a.create}})}Zeb(ka){super.Zeb(ka);this.gK.Pv(Ij.a.sGh,{succeeded:!0,customData:{actionType:sd.a.edit}})}NWk(ka){if(ka.Cf){var db=
this.Yh.atf(ka);if(db.uEc&&db.vEc){var yb=this.Aj.Db(ja.a.Ef(db.vEc));db=db.vEc===db.uEc?null:this.Aj.Db(ja.a.Ef(db.uEc));bc.a.qsg(yb,ka,!0);bc.a.qsg(db,ka,!1)}}}yJc(ka){super.yJc(ka);this.Iz&&this.Iz.id===ka.id&&(super.clearSelection(),this.sA&&this.WP.Y2b());if(this.sA)if(vg.r(ka)){var db=[];let yb=null;for(const Zb of this.model.AO())Zb!==ka&&(Zb.Cf===ka.Cf&&db.push(Zb),Zb.id===ka.Cf&&(yb=Zb));yb&&yb.id&&yb.objectId&&!yb.done&&this.Jo.EG(yb.objectId)&&!this.Jo.f2i(yb.objectId)&&!db.length&&this.$_c(yb,
!0)}else db=ka.Xq===kd.a.beingCreated,ka.done||this.$_c(ka,!0),db&&this.Yh.R$i(ka.lz.draftId)}editComment(ka,db){1===this.mode&&ka&&(this.Yh.FKc(ka,db),sd.a.edit===db.sessionType&&this.gK.logKpiUsage(Kg.a.yGh,0),this.Vg.eQb&&3!==sd.a.jrf(db.sessionType)&&this.GTb.selectComment(ka,Object.assign(new Ad.a,{LR:!1,M9:0})))}Mfe(ka){this.sA&&!this.Zi.Zm||super.Mfe(ka)}deleteComment(ka){ka.Xq!==kd.a.beingCreated&&this.Jo.QQh(ja.a.Ef(ka.objectId));this.oWa&&this.oWa.id===ka.id&&(this.Yh.nt&&this.oWa.id===
this.Yh.nt.id?this.oWa=null:this.Dra.N7e());!this.Yh.nt||this.Yh.nt.id!==ka.id&&this.Yh.nt.Cf!==ka.id?this.Yh.nt&&this.Dra.zF(0,this.Yh.nt,null):void 0===ka.Cf||null===ka.Cf?this.clearSelection():this.Yh.selectComment(this.Yh.MD(ka.Cf));ka.pQa&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",vg.a(ka));super.deleteComment(ka);a.ULS.sendTraceTag(50426377,327,50,`${vg.a(ka)} deleted by user action. DurableId: ${ka.a0a}`)}FAb(ka,db){super.FAb(ka,db);this.sA&&
!this.Zi.Zm&&db&&(this.Yh.nt&&this.Yh.nt.id===ka.id&&this.clearSelection(),this.$9b&&this.$9b.id===ka.id&&this.Dra.N7e())}rdo(ka=null){(ka=this.Jo.JRl(ka))?this.GTb.selectComment(ka,Object.assign(new Ad.a,{LR:!0,M9:1})):this.Bij(1)}icl(ka){var db,yb=this.mra.rc;if(yb){var Zb=ka.Oa.node,tc=null===(db=this.vMo.instance)||void 0===db?void 0:db.dQc(Zb);if(tc)for(const Pc of yb.MOa(tc))if(Pc&&Pc instanceof Ug.a&&(db=Pc,yb=Kj.a.NMh(db),this.Bqc.Toe=this.FBl(Zb,ka),tc=this.LRk(yb),null!==tc)){if(ka=this.Bqc.vBl(yb,
tc))yb.pwa[tc].appendChild(ka),db.Mz(ka);break}}}FBl(ka,db){let yb;for(const Zb of ka.XG)if(Zb&&Zb){yb=Zb;break}ka=db.Oa.wj;db=!(null===yb||void 0===yb||!yb.Tn)&&0<yb.Tn.length;return 0>ka||!db||null===yb||void 0===yb||!yb.eop?null:Wc.a.b_(ka,yb,!1,!1)}LRk(ka){var db;const yb=null===(db=this.Bqc.Toe)||void 0===db?void 0:db.y;for(const [Zb,tc]of ka.bca.entries())if(ka=yb-tc.y,-2<=ka&&ka<tc.height+2)return Zb;return null}r4a(){U.App.zib=2===this.mode||3===this.mode;1!==this.mode&&this.Bqc.CVd()}DPo(ka,
db,yb){const Zb=this.Ub.currentScope;let tc=null;if(db||yb){db=ka.Oa.cpBegin;ka=ka.Oa.node;if(this.Iz&&vg.q(this.Iz,ka,this.Aj,db))return;tc=this.U4l(ka,db)}tc?!this.sA||this.Zi.Zm?Mh.a.e3(y.AFrameworkApplication.nc,()=>{this.tij(tc)},gj.a.kdo):this.tij(tc):!this.Yh.nt||Zb&&Zb.name===ag.AFrame.sM||this.clearSelection()}U4l(ka,db){let yb=null;const Zb=this.model.AO();for(let tc=Zb.length-1;0<=tc;tc--){const Pc=Zb[tc];if(Pc.objectId&&!(Pc.Cf||this.sA&&!this.Oca.isVisible&&Pc.done)&&vg.q(Pc,ka,this.Aj,
db)){yb=Pc;break}}return yb}selectComment(ka,db=1){this.GTb.uij(ka,Object.assign(new Ad.a,{LR:1===db,M9:db}))}xij(ka,db){const yb=this.Yh.MD(ka);yb?this.sA&&!vg.r(yb)&&yb.Xq!==kd.a.beingCreated&&this.WP.VSa(ka,0,db):a.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const ka=this.model.nt;this.Vg.sua&&this.xE&&ka&&this.xE.fireEvent(9,{comment:ka});super.clearSelection();this.Dra.zF(1,ka,ka);this.sA&&ka&&this.WP.Y2b()}vSm(){var ka;return 500>(null===(ka=this.Ahh)||
void 0===ka?void 0:ka.si)}Pec(ka,db=1){if(!this.Vg.yRi||!this.Yh.ry){var yb=this.Yh.MD(ka),Zb=null;yb||(Zb=this.oWa);var tc=this.vSm(),Pc=!1;1===db&&this.tka&&(tc?Pc=!0:this.tka.highlightComment(ka));ka?yb?tc?Pc=!0:this.O$.U9b(yb.objectId):a.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.O$.U9b(null);yb?tc?Pc=!0:(this.oWa=yb,this.Dra.zF(2,yb,Zb)):(this.oWa=null,this.Dra.zF(3,null,Zb));Pc&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}GDo(){this.ge&&
(this.Ahh=this.ge.Zf("UserAction","StartScrollDetectionStopwatch"))}notify(ka,db){this.Wp.sendNotification(ka,db)}Dmg(){this.UEd.onContentChanged()}$Ah(ka,db){var yb,Zb;switch(ka){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.$zo(db);case "OnContentFilterUpdate":return!(null===(Zb=(yb=this.UEd).isContentInFilterUpdateDiff)||void 0===Zb?0:Zb.call(yb,db.id));default:return!0}}$zo(ka){return this.Vg.h2k?!ka.done&&this.Jo.kha(ka)===this.UEd.isContentInFilteredContent(ka.id):this.Jo.kha(ka)===
this.UEd.isContentInFilteredContent(ka.id)}static getInstance(){return nh.Rl()}static Rl(){nh.Mg||(nh.Mg=new nh(U.App.Tna(),new X.a(()=>U.App.xa.ib.Uc.od),L.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,L.a.instance.resolve("Common.Comments.ICommentModel"),L.a.instance.resolve("Common.Comments.ICommentPane"),Df.getInstance(),y.AFrameworkApplication.va,new X.a(()=>Ch.a.instance),kg.FocusManager.instance(),L.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),
L.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),L.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),L.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),L.a.instance.resolve("WordEditor.Comments.CommentsSettings"),L.a.instance.resolve("Common.Utils.IAriaNotifier"),L.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),L.a.instance.resolve("WordEditor.Comments.CommentsState"),L.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),
vk.App.sn.ib.rc,U.App.xa.Hq,L.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),L.a.instance.Sa("WordEditor.HeaderFooter.HeaderFooterControlOwner"),L.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),L.a.instance.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),L.a.instance.Sa("WordEditor.Extension.RichApiEventManager"),L.a.instance.Sa("WordEditor.Indicator.TopLevelOutlineElementCache")),nh.Mg.POb=!0);return nh.Mg}}nh.Mg=null;Object(f.a)(nh,
"EditorCommentManager",Wl.a,[649,650,651,10]);var Hh=c(1761);class Bc{constructor(ka,db,yb,Zb){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=ka;this.body=db;this.confirmButton=yb;this.cancelButton=Zb}}Object(f.a)(Bc,"ViewContainerModalDialogStrings",null,[]);var Pg=c(306);c(1486);class yh{constructor(ka,db){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=
ka;this.canvasContextId=db}}Object(f.a)(yh,"CommentUIAction",null,[]);var bi=c(1050);class Yi{constructor(ka,db,yb,Zb,tc,Pc,Od,ke,od,Pe,Se,ng,Dg,gi,qh,ym,Ol){this.ga=ka;this.ig=db;this.ae=yb;this.Ub=Zb;this.fp=tc;this.Jh=Pc;this.V2=Od;this.Cra=ke;this.ayd=od;this.wXe=Pe;this.Gb=Se;this.WP=ng;this.Vg=Dg;this.Zi=gi;this.GTb=qh;this.U1=ym;this.qka=Ol;this.swe=this.Yi=null;this.Lfh=this.hLg=!1;this.Izc=null;this.zxo=(ah,bk,bj)=>2!==bj||this.Zi.fY?1===bj?32:2:(this.U1.W4("OnCommentInit",Object.assign(new eh.a,
{kGa:()=>{this.ga.processAction(wf.a.jV,2)}})),32);this.Uqi=(ah,bk,bj)=>1!==bj||this.Zi.fY?2:8;this.jrk=(ah,bk,bj)=>{if(1===bj)return!this.Cjb()||this.Edb?8:this.Zi.fY?2:32;if(!this.Zi.fY)return this.Edb=!0,this.U1.W4("OnCommentInit",Object.assign(new eh.a,{kGa:()=>{this.Yq||this.Zi.Zm||this.ga.processAction(wf.a.jV,2)}})),32;this.Yq||this.Zi.Zm||this.ga.processAction(wf.a.jV,2);(this.Yq||this.Zi.Zm)&&this.Ub.mg(this.Zi.Zm?ag.AFrame.Kr:ag.AFrame.sM);return 2};this.Xjl=(ah,bk,bj)=>1===bj&&yc.SessionStatusManager.instance.Gj?
8:2;this.xol=(ah,bk,bj,Il)=>1!==Il||(this.Yq||this.isVisible)&&this.Yi.model.nt?ah||this.Yi.model.nt?32:8:8;this.Jib=(ah,bk,bj,Il,yj)=>{if(1===bj||!this.Zi.Zm)return 32;if(!this.Yq&&2===bj&&(2===this.Yi.mode||3===this.Yi.mode))return yj=new Bc(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume),this.ayd.invokeModalConfirmationDialog(()=>{this.znn(ah,bk,bj,Il)},()=>{this.Emn()},yj),32;this.EVd();
if(this.Yq)return 32;yj&&this.MVh();return 32};this.DMb=(ah,bk,bj,Il,yj)=>{if(1===bj)return 32;yj[Pg.a.On]=this.isVisible;return 32};this.Boc=this.o9k()}get isVisible(){return this.Zi.Zm}get Edb(){return this.hLg}set Edb(ka){this.hLg=ka}get yro(){return"SharedCommentsTaskPaneProps"}get i1c(){return null}get VQi(){return null}get bF(){return this.fp}get Oca(){return null}get e2k(){return this.Cra}get Yq(){try{return this.Vg.Yq}catch(ka){return!1}}Ebi(){return new Li(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,
y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}o9k(){const ka=new fj.a,db=new yh(wf.a.newComment,Lk.a.frame);db.preCallback=this.jrk;const yb=new yh(Ij.a.hRf,Lk.a.frame),Zb=new yh(Ij.a.R_f,Lk.a.frame),tc=new yh(Ij.a.deleteComment,Lk.a.frame);tc.preCallback=this.Xjl;tc.postCallback=this.xol;this.Yq&&(yb.preCallback=this.Uqi,Zb.preCallback=this.Uqi);const Pc=new yh(wf.a.jV,Lk.a.frame);Pc.preCallback=this.zxo;ka.Z(6,Pc);ka.Z(0,db);ka.Z(1,yb);ka.Z(2,Zb);ka.Z(3,tc);return ka}epj(ka){this.Lfh||
(this.Cmk=this.ZRd(),this.V2.QNa(),this.Kqo(),this.Gqo(ka),this.Lfh=!0)}Gqo(ka){this.Yi=ka;this.swe=ka.V9b;this.Yi.TXh=this.Cra}initialize(ka){this.epj(ka);this.Tb()}iAf(){this.Izc&&this.Ub.mg(ag.AFrame.Kr);this.Edb&&!this.Yq?(this.ga.processAction(wf.a.newComment,2),this.Edb=!1):this.Zi.Xeb&&Mh.a.e3(y.AFrameworkApplication.nc,()=>{const ka=this.Zi.Xeb.commentId,db=this.Zi.Xeb.XVc;this.ga.Qb(Ij.a.selectComment,2,Object.assign(new Ad.a,{commentId:ka,M9:1,LR:!0,cUc:db}));db&&(Mh.a.e3(y.AFrameworkApplication.nc,
()=>{this.Ub.mg(ag.AFrame.Kr)},gj.a.Pag),we.a.instance.qf(Gb.a.xPh,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.VW);this.Zi.Xeb=null},gj.a.jdo)}dispose(){}p5(){}selectComment(){this.isVisible||this.Yq||this.Esj();this.Jh.updateCommandUI(!0)}Tb(){this.ga.qa(wf.a.Jib,Lk.a.frame,this.Jib);this.ga.eb(wf.a.DMb,Lk.a.frame,this.DMb,96)}r4a(){-1!==this.Yi.mode&&(this.Yi.mode||this.MVh())}MVh(){const ka=
this.Yi,db=ka.Jo,yb=db.gRd(),Zb=db.Jof(this.Vg.tPb&&this.Vg.Yq&&!this.Zi.Zm);this.Cra.teo(Zb.length,yb,!ka.mode,yb?5:1);this.Cra.Teo(Zb,db.kVa)}Kqo(){const ka=this.Ub.fe(ag.AFrame.Kr);ka.parent=ag.AFrame.rp;ka.RH=!0;ka.J5c=!0;ka.sUa=!0;ka.aZa((db,yb)=>{ve.a.ZAh(yb.name)&&(this.Zi.wKb=Mh.a.e3(this.Gb,()=>{yb.name!==ag.AFrame.sM&&2!==this.Yi.mode&&3!==this.Yi.mode&&(this.Yi.clearSelection(),this.Jh.updateCommandUI(!0));this.Zi.wKb=null},gj.a.onn))});this.fp.dT(ag.AFrame.Kr);if(this.Vg.Uzb)for(const db of vg.t)ka.bindAction(Kc.KeyInputManager.CG(db),
Ij.a.A5e)}tjo(){this.Izc&&this.wXe.lHl()}VCh(){this.$3j&&this.tjo()}znn(ka,db,yb,Zb){const tc=this.Yi,Pc=tc.Jo.ry;Pc&&Pc.lz?tc.T8e.endCommentSession(Pc.lz.draftId):a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.Jib(ka,db,yb,Zb,!0);Mh.a.e3(this.Gb,()=>{this.Jh.updateCommandUI(!0)},gj.a.c$n)}Emn(){this.Izc&&this.Ub.mg(ag.AFrame.Kr);this.Jh.updateCommandUI(!0)}$Ga(ka){ka.jr(this.Ub.uW);ka.jr(this.Ub.vW)}kPb(ka,db,yb){if(1===yb)return 32;this.Esj();return 32}Esj(){this.isVisible||
(this.Vg.PCb&&(this.Zi.U6a=!0),this.Zi.fY?(this.vpl(),this.Zi.Zm=!0,this.U1.Dce(),this.Ub.CDc(ag.AFrame.Kr),this.Yq&&this.Vg.tPb&&this.Yi.UMb(this.Yi.model.oof(()=>!0)),this.$3j=!0,Ui.UISurfaces.Gu().then(ka=>{ka.showTaskPane(dp.a.dFd,this.Cmk);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.Yi.Pec(null),this.Jh.updateCommandUI(!0),this.$Ga(this.Ub.fe(ag.AFrame.Kr)),this.U1.W4("OnCommentPaneOpen"),a.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):
this.U1.W4("OnCommentInit",Object.assign(new eh.a,{kGa:()=>{this.Zi.Zm||this.ga.processAction(wf.a.jV,2)}})))}vpl(){this.ga.Qb(Ij.a.D3,2,null);this.ga.Qb(Ij.a.xT,2,null)}Cjb(){return this.qka.Cjb(this.ga,!1)}jzb(){}show(){this.isVisible||this.ga.processAction(wf.a.jV,2)}editComment(){return 2}EVd(){this.Yi.paneClosing();this.Zi.Zm=!1;if(this.Yq&&this.Vg.tPb){const db=this.Yi.model;this.Yi.UMb(db.oof(yb=>db.kha(yb)))}var ka=kg.FocusManager.instance();ka.currentScope&&ka.currentScope.name===ag.AFrame.Kr&&
ka.mg(this.Yq&&(2===this.Yi.mode||3===this.Yi.mode||this.Yi.Dj.nt)?ag.AFrame.sM:ka.vT);this.fp.Xw(ag.AFrame.Kr);this.Ub.lJc(ag.AFrame.Kr);Ui.UISurfaces.Gu().then(db=>{db.hideTaskPane(dp.a.dFd,2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.Yq&&(ka=this.Yi.model.nt)&&this.xVo(ka);this.U1.W4("OnCommentPaneClose");a.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}xVo(ka){ka.done?this.Yi.clearSelection():this.GTb.OVh(ka)}Nvn(ka=null){this.wXe.yoj(3);
this.iAf();if(ka){this.VCh();Fp.a.r4f(ka,[Ek.a.contextMenu]);const db=this.Ub.fe(ag.AFrame.Kr);this.ig.u0b(ag.AFrame.Kr,ka,db.sUa)}}qtn(ka){this.fp.FI(ag.AFrame.Kr);1!==ka&&Mh.a.e3(y.AFrameworkApplication.nc,()=>{this.Ub.cD(ag.AFrame.Kr)},gj.a.Pag)}onTaskPaneClose(){this.Zi.fY&&this.wXe.yoj(1)}ZRd(){const ka={type:this.yro,vhp:this.VCh};return Object.assign(new bi.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,contentProps:ka,hideHeader:!1,width:300,location:2,onOpen:db=>{this.Izc=db;this.Nvn(db);
this.WP.akg(!0)},onClose:()=>{this.Izc=null;this.ga.Qb(wf.a.Jib,2,!0);this.Jh.updateCommandUI(!0);this.onTaskPaneClose();const db=this.Yi.Jo;this.Zi.U6a&&db.VQc()&&this.WP.akg(!1)},onShow:db=>{this.qtn(db)}})}jV(){return 32}}Object(f.a)(Yi,"OfficeSharedCommentPane",null,[10,645,646]);var ij=c(1677),Vd=c(175);class le{constructor(ka,db){this.containerType="full-pane";this.identifier=null;this.ga=ka;this.identifier=db}openView(){this.ga.processAction(wf.a.kPb,2)}closeView(){this.ga.Qb(wf.a.Jib,2,!0)}invokeModalConfirmationDialog(ka,
db,yb){const Zb=new Vd.StandardDialog;yb&&yb.title&&yb.body&&yb.confirmButton&&yb.cancelButton||(a.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),yb=new Bc("","","",""));Zb.Ad=1;Zb.Ee(1,yb.confirmButton);Zb.Ee(0,yb.cancelButton);Zb.Ou(yb.title,yb.body,1,tc=>{1===tc?ka():db()})}}Object(f.a)(le,"ViewContainerAPI",null,[643,644]);class ci{constructor(ka,db,yb){this.WMo=ka;this.Vh=db;this.rIa=yb;this.hd=new na.a;this.WMo.execute(Zb=>{this.rIa.nde("OnBeforeTrackChangeMarkupViewChange",
(tc,Pc)=>{Pc&&Pc.XQf!==Zb.Kj&&this.hd.raiseEvent("OnBeforeTrackChangeMarkupViewChange",Pc)});this.rIa.nde("OnAfterTrackChangeMarkupViewChangeEventKey",(tc,Pc)=>{Pc&&Pc.Kj===Zb.Kj&&(tj.a.Kj=Zb.Kj,this.hd.raiseEvent("OnAfterTrackChangeMarkupViewChange",Pc))})})}G9(ka,db){this.hd.addHandler(ka,db)}W4(ka,db){this.hd.raiseEvent(ka,db)}Dce(){this.Vh.W2f||(this.Vh.W2f=!0,this.hd.raiseEvent("OnCommentRenderedOnce"))}}Object(f.a)(ci,"WordCommentEventsActor",null,[]);var uj=c(1820);class Gl{constructor(){this.insertIndex=
0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(f.a)(Gl,"InitCommentSessionResult",null,[]);class Eh extends Gl{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(f.a)(Eh,"BeginDraftingHostResult",Gl,[]);var Ef=c(2081),lf=c(2039),Vi=c(1036);class Bq{constructor(ka,db,yb,Zb,tc,Pc,Od,ke,od,Pe,Se,ng,Dg,gi,qh){this.taskManager=ka;this.Cra=db;this.zVj=yb;this.cOo=Zb;this.a9e=tc;this.vs=Pc;this.tt=Od;this.focusManager=ke;
this.$0=od;this.pc=Pe;this.Kk=Se;this.i_=ng;this.Vh=Dg;this.I2k=gi;this.G2k=qh;this.eYb=this.O6=this.Gm=null;this.q_j="WordWebCommitNewCommentActivity";this.r_j="WordWebCommitTaskActivity";this.n_j="WordWebCommentReactionActivity";this.LPg=null}get qka(){return this.O6}gHn(ka){var db;const yb=this.qka.ry,Zb=this.O6.AO();if(Zb&&yb){const tc=Vi.a.Jgb(null!==(db=yb.authorId)&&void 0!==db?db:"");db=new uj.a(yb.authorId,yb.H1b,yb.author,null!==tc&&void 0!==tc?tc:"",!0);ka.author=db;ka.insertIndex=Array.indexOf(Zb,
yb);ka.authorName=yb.author;ka.authorIdentity="";return null}return Mh.a.ED(-2130915320)}initialize(ka,db,yb,Zb){this.Gm=ka;this.O6=db;this.eYb=yb;this.LPg=Zb}beginDraftingAsync(ka){if(!ka)return new Promise((Zb,tc)=>{tc(Mh.a.ED(-2130915327))});const db=new Eh,yb=sd.a.jrf(ka.sessionType);return void 0===yb||null===yb?new Promise((Zb,tc)=>{tc(Mh.a.ED(-2130915317))}):new Promise((Zb,tc)=>{Mh.a.e3(this.taskManager,()=>{if(1!==this.Gm.mode)a.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",
this.Gm.mode),tc(Mh.a.ED(-2130915325));else{this.sCh();try{switch(yb){case 0:if(!this.Gm.Oca.Cjb()){tc(Mh.a.ED(-2130915326));return}this.I2k.CVd();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${ka.draftId}`);this.Gm.jzb(ka);break;case 1:if(!ka.threadId||""===ka.threadId){tc(Mh.a.ED(-2130915324));return}if(this.vs.vfg){const ke=this.O6.MD(ka.threadId);if(ke){const od=this.O6.L6h(ke,!1),Pe=Ef.a.iEb(ke,od,ke.authorId===this.vs.zY);Pe&&this.a9e.invoke(ka.threadId,Pe)}else a.ULS.sendTraceTag(579170962,
327,10,"Smart reply provider not invoked since comment is null",this.Gm.mode)}this.Gm.addReply(ka.threadId,ka);break;case 3:if(!ka.threadId||""===ka.threadId){tc(Mh.a.ED(-2130915324));return}var Pc=this.O6.MD(ka.threadId);if(!Pc){tc(Mh.a.ED(-2130915323));return}this.Gm.editComment(Pc,ka);break;case 2:if(!ka.commentId||""===ka.commentId){tc(Mh.a.ED(-2130915324));return}const Od=this.O6.MD(ka.commentId);if(!Od){tc(Mh.a.ED(-2130915323));return}this.Gm.editComment(Od,ka)}}catch(Od){tc(Od);this.bej();
a.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${Od} on Session ${yb}`);return}(Pc=this.gHn(db))?tc(Pc):Zb(db);this.bej()}},gj.a.beginDraftingAsync)})}commit(ka,db,yb){const Zb=this.qka.ry;if(!Zb)throw Mh.a.ED(-2130915320);var tc=Zb.lz;if(!tc)throw Mh.a.ED(-2130915320);const Pc=sd.a.jrf(tc.sessionType);if(void 0===Pc||null===Pc)throw Mh.a.ED(-2130915317);if(ka!==tc.draftId)throw Mh.a.ED(-2130915327);let Od=!1,ke=!1;tc=!1;switch(Pc){case 3:if(!yb)throw Mh.a.ED(-2130915327);break;case 0:this.Kk.ie(()=>
{if(!this.Gm.Oca.Cjb())throw Mh.a.ED(-2130915326);Zb.text=[db];this.Gm.sA&&!this.Vh.Zm?this.Gm.ICn(()=>{this.Gm.tua(Zb);this.Gm.Bul(ka,Zb.id)}):this.Gm.tua(Zb);ke=yb&&null!=yb.Task;Od=this.Gm.sA;Mh.a.e3(this.taskManager,()=>{this.iob(Zb.id)},gj.a.iob)},"WESCA:C:C");break;case 1:this.Kk.ie(()=>{Zb.text=[db];this.Gm.tua(Zb);ke=yb&&null!=yb.Task;Od=this.Gm.sA},"WESCA:C:R");break;case 2:this.Kk.ie(()=>{Zb.text=[db];this.Gm.Zeb(Zb);this.u4i(Ij.a.Q2m)},"WESCA:C:E");break;default:throw Mh.a.ED(-2130915322);
}yb&&(yb.Resolve&&(this.Tkj(Zb,yb.Resolve.isResolved),yb.Resolve.isResolved&&!this.Vh.Zm&&this.Gm.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),yb.Task&&this.Gm.h3k(Zb,yb.Task),yb.Reaction&&(tc=this.vs.P2k,yb.Reaction.isActive?this.Gm.hzd(Zb,yb.Reaction.reactionType):this.Gm.Bde(Zb,yb.Reaction.reactionType)));this.vs.$2k&&ke&&this.$0.execute(od=>od.logActivity(this.r_j,"CommentsTasksFpsIsEnabled"));Od&&this.$0.execute(od=>{od.logActivity(this.q_j,"CommentsFpsIsEnabled")});tc&&this.$0.execute(od=>
{od.logActivity(this.n_j,"CommentReactionsFpsIsEnabled")});return Zb.id}endCommentSession(ka){const db=this.qka.ry;if(db){if(db.lz&&db.lz.draftId!==ka)throw Mh.a.ED(-2130915327);if(db.Xq===kd.a.beingCreated)this.Gm.deleteComment(db),!this.Gm.sA||db.Cf||this.Vh.Zm||this.focusManager.mg(ag.AFrame.Pn);else{if(3!==this.Gm.mode){a.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");return}db.Xq=kd.a.normal;db.SSa=lf.a.succeeded;db.lz=null;this.Gm.u6e()}}this.tt&&
this.tt.updateCommandUI(!0);this.qka.gRd()||this.Cra.bng(1,!this.Gm.mode)}deleteComment(ka){(ka=this.O6.MD(ka))?(this.Gm.deleteComment(ka),this.Gm.sA&&!this.Vh.Zm?ka.Cf||this.focusManager.mg(ag.AFrame.Pn):this.focusManager.cD(ag.AFrame.Kr),this.cOo.Ldg(ka)&&this.u4i(Ij.a.UJi)):a.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(ka){this.iob(ka,0)}highlightComment(ka){this.Gm.Pec(ka,0)}setThreadResolvedState(ka,db){(ka=this.O6.MD(ka))&&this.Tkj(ka,db)}Tkj(ka,
db){if(ka.Cf&&""!==ka.Cf)throw Mh.a.ED(-2130915321);this.Gm.FAb(ka,db);db&&!this.Vh.Zm&&this.focusManager.mg(ag.AFrame.Pn)}presentLinkToComment(ka){var db=this.O6.MD(ka);db?(db=this.qka.lPd(db))?(ka={["nav"]:btoa(`{"${qi.a.comment}":${db}}`),["mode"]:"copy"},this.G2k.Pv(Ij.a.presentLinkToComment),this.pc.Qb(wf.a.k8,2,ka,{["ControlId"]:"CopyLinkToComment"})):a.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",ka):a.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",
ka)}selectFirstThreadInNextCommentContext(){this.Gm.Bij(0)}selectLastThreadInPreviousCommentContext(){this.Gm.sdo()}registerForCommentEvents(ka){const db=this.qka.Jof(this.vs.tPb&&this.vs.Yq&&!this.Vh.Zm),yb=this.qka.kVa,Zb=this.qka.gRd(),tc=!this.Gm.mode;this.Cra.Bno();this.LPg.k4l().then(Pc=>{this.Cra.sXn(ka,db,Zb,tc,yb,Pc);this.Cra.bng(Zb?5:1,tc);this.tt&&this.tt.updateCommandUI(!0)})}unregisterForCommentEvents(ka){this.Cra.PQb(ka)}registerForAction(ka,db){this.zVj.sSa(ka,db)}unregisterForAction(){}checkAtMentionCapability(){return this.eYb?
this.eYb.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),new Promise(ka=>{ka(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}sCh(){const ka=this.Gm.sA&&!this.Vh.Zm?ag.AFrame.sM:ag.AFrame.Kr;if(ka===ag.AFrame.Kr){if(!this.Vh.Zm)return;Ui.UISurfaces.Gu().then(db=>{db.setSelectedTaskPane(dp.a.dFd);return null})}this.focusManager.cD(ka)}iob(ka,db=
1){this.sCh();this.i_.uij(ka,Object.assign(new Ad.a,{M9:db,LR:1===db}))}bej(){this.Gm.Oca.Edb&&(this.Gm.Oca.Edb=!1)}u4i(ka){this.pc.processAction(ka,2)}}Object(f.a)(Bq,"WordEditorSharedCommentAPI",null,[641,642]);class lm{constructor(ka,db,yb,Zb,tc,Pc,Od=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ka;this.parentId=db;this.commentBody=yb;this.author=Zb;this.date=tc;this.commentFlags=Pc;this.usersByReactionType=
Od}}Object(f.a)(lm,"OfficeSharedCommentModel",null,[]);c(1659);class Yg{constructor(ka,db){this.Fa=ka;this.M3a=db;this.snh="AD";this.Aqc=new M.a;this.hXe=new M.a;this.aJk=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.IPg=new ni.a}get userPrincipalName(){return this.Fa.jb("UserPrincipalName")}get l5a(){return this.Fa.jb("PresenceProvider")}get zY(){return this.Fa.jb("PresenceUserId")}get Aj(){return this.M3a.value}LRi(ka){const db=this.aJk.exec(ka);return db?db[1]:ka}Qgi(ka,db=!1){let yb=0;ka.done&&(yb=ka.Cf&&
""!==ka.Cf?yb|4:yb|8);ka.GIh&&(yb|=2);db&&(yb|=1);this.Ldg(ka)&&(yb|=16);ka.UEf&&(yb|=32);this.Trm(ka)||(yb|=128);return yb}Trm(ka){return ka?(ka=this.Aj.Db(ka.objectId))?ka.hasProperty(qa.a.vQ):!1:!1}Ldg(ka){if(!ka)return!1;if(void 0===ka.authorId||null===ka.authorId||""===ka.authorId)return this.fLf(ka.id,ka.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.zY||null===this.zY||""===this.zY)return this.fLf(ka.id,ka.objectId,"PresenceUserId null or empty"),!1;if(this.zY==ka.authorId&&
ka.H1b==this.l5a)return!1;const db=this.CLd(ka.authorId),yb=this.CLd(this.zY);if(this.l5a===this.snh&&db&&yb&&db[0]!=this.userPrincipalName&&db[1]!=yb[1])return!0;this.fLf(ka.id,ka.objectId,"Unknown");return!1}isCurrentUser(ka){if(!ka||void 0===ka.authorId||null===ka.authorId||""===ka.authorId||void 0===this.zY||null===this.zY||""===this.zY)return!1;if(this.zY==ka.authorId&&ka.H1b==this.l5a)return!0;ka=this.CLd(ka.authorId);const db=this.CLd(this.zY);return this.l5a===this.snh&&ka&&db?ka[0]==this.userPrincipalName||
ka[1]==db[1]:!1}CLd(ka){if(void 0===ka||null===ka)return null;ka=ka.split("::");return 3===ka.length?ka.slice(1,3):null}fLf(ka,db,yb){ka&&!this.IPg.contains(ka)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${db}; reason: ${yb}`),this.IPg.add(ka))}L2h(ka,db){var yb;if(!ka)return null;const Zb=ka.F_d;let tc=!1;1===db&&(tc=!0);db=ka.author?this.LRi(ka.author):"";const Pc=Vi.a.Jgb(null!==(yb=ka.authorId)&&void 0!==yb?yb:"");yb=new uj.a(ka.authorId?ka.authorId:"",ka.H1b,
db,null!==Pc&&void 0!==Pc?Pc:"",this.isCurrentUser(ka));return new lm(ka.id?ka.id:"",ka.Cf?ka.Cf:"",ka.text&&ka.text.length?ka.text[0]:null,yb,ka.date||Zb?ka.date:new Date,this.Qgi(ka,tc),this.Sgi(ka.usersByReactionType))}CJl(ka,db,yb){const Zb=[],tc=new M.a;if(!ka)return Zb;for(const Pc of ka)Pc.Xq!==kd.a.beingCreated&&yb(Pc)&&(Pc.id&&this.Aqc.mb(Pc.id)?(ka=this.Aqc.J(Pc.id),ka=this.Acl(Pc,ka,db),Zb.push(ka),tc.Z(Pc.id,ka)):Pc.id?(ka=this.L2h(Pc,db),Zb.push(ka),tc.Z(Pc.id,ka)):a.ULS.sendTraceTag(50667679,
327,10,"CommentId should not be null"));this.Aqc=tc;return Zb}MPl(ka,db,yb){const Zb=[];for(const tc of ka)tc.Xq!==kd.a.beingCreated&&yb(tc)&&(tc.id&&this.Aqc.mb(tc.id)?Zb.push(this.Aqc.J(tc.id)):tc.id&&Zb.push(this.L2h(tc,db)));return Zb}Acl(ka,db,yb){var Zb=ka.F_d,tc=1===yb;yb=ka.Cf?ka.Cf:"";const Pc=ka.text&&ka.text.length?ka.text[0]:null,Od=ka.author?this.LRi(ka.author):"",ke=ka.authorId?ka.authorId:"",od=ka.H1b?ka.H1b:"",Pe=Vi.a.Jgb(ke);Zb=ka.date||Zb?ka.date:new Date;tc=this.Qgi(ka,tc);const Se=
this.isCurrentUser(ka),ng=this.Sgi(ka.usersByReactionType);return db.parentId===yb&&db.commentBody===Pc&&db.author.DisplayName===Od&&db.author.UserId===ke&&db.author.Provider===od&&db.author.IsCurrentUser===Se&&db.date===Zb&&db.commentFlags===tc&&this.DHk(db.usersByReactionType,ng)?db:(db=new uj.a(ke,od,Od,null!==Pe&&void 0!==Pe?Pe:"",Se),new lm(ka.id,yb,Pc,db,Zb,tc,ng))}DHk(ka,db){if(!ka&&!db)return!0;if(!db||!ka)return!1;var yb=Object.keys(ka);if(yb.length!==Object.keys(db).length)return!1;for(const Zb of yb){if(!(Zb in
db))return!1;yb=ka[Zb];const tc=db[Zb];if(yb.length!==tc.length)return!1;for(let Pc=0;Pc<yb.length;Pc++)if(!this.rHk(yb[Pc],tc[Pc]))return!1}return!0}rHk(ka,db){return ka||db?ka&&db&&ka.UserId===db.UserId&&ka.Provider===db.Provider&&ka.Email===db.Email&&ka.DisplayName===db.DisplayName&&ka.IsCurrentUser===db.IsCurrentUser?!0:!1:!0}Sgi(ka){if(!ka)return null;const db={},yb=this.Fa.jb("PresenceUserId");for(const tc of Object.keys(ka)){const Pc=[];var Zb=ka[tc];for(const Od of Zb){Zb=Od.UserId===yb;let ke;
this.hXe.mb(Od.UserId)?(ke=this.hXe.J(Od.UserId),ke.IsCurrentUser=Zb):(ke=new uj.a(Od.UserId,Od.Provider,Od.DisplayName,Od.Email,Zb),this.hXe.add(Od.UserId,ke));Pc.push(ke)}db[tc]=Pc}return db}}Object(f.a)(Yg,"WordEditorSharedCommentModelTranslator",null,[473]);class Ye{constructor(){this.Ep=null;this.Qed=this.pbh=this.mMg=this.wih=this.mlh=this.Z7g=this.qdh=!1}Rgi(){this.Ep||(a.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.Enj());
return this.Ep}k4l(){return new Promise((ka,db)=>{this.Qed?ka(this.eci()):this.skj().then(()=>{ka(this.eci())}).catch(yb=>{db(yb)})})}eci(){this.Qed||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ka;ka=33;this.mMg&&(ka|=2);this.qdh&&(ka|=8);this.mlh&&(ka|=16);this.Z7g&&(ka|=4);this.wih&&(ka|=64);this.pbh&&(ka|=128);return ka}}Object(f.a)(Ye,"OfficeSharedCommentsAppCapabilities",null,
[871]);class vf extends Ye{constructor(ka){super();this.uXa=null;this.Vg=ka;this.Moo();this.Enj()}Moo(){this.wih=this.Vg.eQb;this.mlh=!1;this.pbh=this.Z7g=this.qdh=!0}initialize(ka){this.uXa=ka;this.skj()}Enj(){this.Ep={};this.Ep.LivePersonaPicker="true";this.Ep.PersonaColor="true";this.Ep.DiscreteHostedComments=this.Vg.Xol.toString();this.Ep.NewCommentButton="true";this.Ep.DisabledChangeGates=this.Vg.Qol;this.Ep.CommentsFluentUI="true";this.Ep.CommentTasks=this.Vg.eQb.toString();this.Ep.CommentTasksFromReply=
this.Ep.CommentTasks;this.Ep.CommentFriendlyTimestamps=this.Vg.i2k.toString();this.Ep.AtMentionFloodgateSurvey=this.Vg.yIk.toString();this.Ep.HyperlinksInComments="true";this.Ep.LogDraftCommentIdPair="true";this.Ep.RichTextFormattingInWeb=this.Vg.Uzb.toString();this.Ep.RichContentEditIntegration="true";this.Ep.HyperlinksWithDisplayText="true";this.Ep.SmartReplies=this.Vg.vfg.toString();this.Ep.LinkToComment="true";this.Ep.TaskPaneWithNewInfrastructure="true";this.Ep.CommentReactions="true";this.Ep.WebThemeIntegration=
"true";this.Ep.NewSelectionInteractions="true";this.Ep.HighlightsAndFontColorInWebComments="true";this.Ep.TruncationUIWithReadMoreText="true";this.Ep.CtrlEnterTip="true";this.Ep.AtMentionHintMessage="true";this.Ep.LivePersonaCardForWeb=this.Vg.x0m.toString();this.Ep.TaskHistoryRecordIDs=this.Vg.MIo.toString();this.Ep.ContentNavigation=this.Vg.contentNavigationApiEnabled.toString()}skj(){return new Promise((ka,db)=>{this.uXa?this.uXa.atMentionsEnabledAsync().then(yb=>{this.mMg=yb;this.Qed=!0;ka(this.Qed)}):
(a.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),db(Mh.a.ED(-2130915320)))})}}Object(f.a)(vf,"WordSharedCommentsAppCapabilities",Ye,[472]);class mm{constructor(){this._initialized=!1;this.Z2k={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:Kg.a.Tjf,vetoPillar:7};this.TIo={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:ij.a.Tjf,vetoPillar:7}}get X4a(){return null!=
this.dFg?this.dFg:this.dFg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}UZ(ka){this.X4a.UZ(Ri.a.comments,ka,!0)}get name(){return"WordEditor.Comments"}xc(ka){this.W=ka;this.UZ("CPConfigStart");ka.ha("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new ul.a(n.Health.instance,new th.a,this.Z2k)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").singleInstance();ka.ha("WordEditor.Comments.ITasksUsageAndHealthLogger",()=>new ul.a(n.Health.instance,new th.a,this.TIo)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").singleInstance();
ka.ha("WordEditor.Comments.CommentNodeTracker",()=>new bf(this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").singleInstance();ka.ha("WordEditor.Comments.CommentsSettings",()=>new lj(y.AFrameworkApplication.K,this.W.resolve("Box4.IFeatureHelper"),new X.a(()=>U.App.xa.ib.Uc),new X.a(()=>fg.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").singleInstance();
ka.ha("WordEditor.Comments.CommentsState",()=>new tj.a).singleInstance();ka.ha("WordEditor.Comments.WordCommentEventsActor",()=>new ci(ka.Sa("Box4.TrackChange.ITrackChangeManager"),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).singleInstance();ka.ha("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new Yg(y.AFrameworkApplication.K,new X.a(()=>U.App.xa.ib.Uc.od))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").singleInstance();
ka.ha("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new cb(ka.resolve("WordEditor.Comments.CommentsSettings"),ka.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Comments.ICommentFormatTranslator").singleInstance();ka.ha("Common.Comments.OfficeSharedCommentsEventHost",()=>new zl(y.AFrameworkApplication.nc)).as("Common.Comments.IOfficeSharedCommentsEventHost").singleInstance();ka.ha("WordEditor.Comments.CommentActionInTypingRecorder",()=>new Tf(this.W.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").singleInstance();
ka.ha("WordEditor.Comments.EditorCommentModel",Hh.a.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").singleInstance();ka.ha("WordEditor.Comments.ICommentModelBootLoader",()=>new Yh(new X.a(()=>U.App.xa.ib.Uc),new X.a(()=>fg.a.instance),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.Comments.CommentsSettings"),ka.resolve("WordEditor.Comments.CommentNodeTracker"),
this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger")));ka.ha("WordEditor.Comments.ICommentFilterActor",()=>new Cc(ka.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.K,ka.resolve("WordEditor.Comments.WordCommentEventsActor"))).singleInstance();ka.resolve("WordEditor.Comments.ICommentFilterActor");ka.ha("WordEditor.Comments.CommentHighlightOnRestActor",()=>new Yj(new X.a(()=>U.App.xa.ib.Uc),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.Comments.IEditorCommentModel"),
ka.resolve("WordEditor.Comments.WordCommentEventsActor"),ka.resolve("Box4.INotebookManager").zl,Q.a.instance,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),ka.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentHighlightOnRestActor").singleInstance();ka.ha("WordEditor.Comments.CommentHighlightUtils",()=>new gg(ka.resolve("Box4.Highlight.IHighlightManager"))).singleInstance();ka.ha("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new lb(ka.resolve("WordEditor.Comments.CommentHighlightUtils"))).singleInstance();
ka.ha("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new sk(ka.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),ka.resolve("WordEditor.Comments.CommentHighlightUtils"),y.AFrameworkApplication.ta.k1,y.AFrameworkApplication.ta.kIa,y.AFrameworkApplication.va,y.AFrameworkApplication.nc,ka.resolve("WordEditor.Comments.CommentsState"),ka.Sa("WordEditor.Comments.IEditorCommentManager"))).singleInstance();ka.ha("WordEditor.Comments.CommentHighlightActor",()=>new ic(new X.a(()=>U.App.xa.ib.Uc.od),
ka.resolve("WordEditor.CommentsInteractive.ICommentEditor"),ka.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),ka.Sa("WordEditor.Comments.IEditorCommentManager"),Q.a.instance,ka.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),ka.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),ka.resolve("WordEditor.Comments.CommentHighlightUtils"),ka.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").singleInstance();
ka.ha("WordEditor.Comments.CommentHintActor",()=>new Da(ka.resolve("WordEditor.Comments.CommentsSettings"),Rh.a.instance,Dk.a.instance,ok.a.instance,y.AFrameworkApplication.va,eg.TableCellReader.cOm,ug.moveToLastRenderedCellOfTheRow,new tg.a,ka.Sa("Box4.ContentControlConfigSettings"),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.ICommentHighlightActor"),ka.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),ka.resolve("WordEditor.Comments.CommentsState"),
ka.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentHintActor").singleInstance();ka.ha("WordEditor.Comments.CommentMarginEntryPointActor",()=>new he(Rh.a.instance,ok.a.instance,y.AFrameworkApplication.va,ka.resolve("WordEditor.Comments.ICommentHintActor"),ka.Sa("Common.IZoomManager"))).singleInstance();ka.ha("WordEditor.Comments.ViewContainerAPI",()=>new le(y.AFrameworkApplication.va,"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").singleInstance();
ka.ha("Common.Comments.CommentActivationManager",()=>new Rk).as("Common.Comments.ICommentActivationManager").singleInstance();ka.ha("Common.Comments.ViewContainerEventHost",()=>new Gm(y.AFrameworkApplication.nc,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").singleInstance();ka.ha("WordEditor.Comments.CommentSmartReplyProvider",()=>new Hn(this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),
this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").singleInstance();ka.ha("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new vf(ka.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").singleInstance();this.UZ("CPConfigEnd")}init(){this.UZ("CPInitStart");this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>{try{this.hn(),this.UZ("CPInitEnd")}catch(ka){throw a.ULS.dD(524300632,
327,10,ka,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",ka),this.X4a.zx(Ri.a.comments,"CPInitException",ka,!0),ka;}})}hn(){const ka=this.W.resolve("WordEditor.Comments.CommentsSettings");this.UZ("onAfterGFNLoadedStart");this.W.ha("WordEditor.Comments.OfficeSharedCommentPane",()=>new Yi(y.AFrameworkApplication.va,y.AFrameworkApplication.ta.gD,y.AFrameworkApplication.ta.hD,y.AFrameworkApplication.ta.Ap,y.AFrameworkApplication.ta.ox,U.App.xa,ce.a.instance,
this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.resolve("Common.Comments.IViewContainerEventHost"),y.AFrameworkApplication.nc,this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ka,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").singleInstance();
this.W.ha("Common.Comments.OfficeSharedCommentsActionHost",()=>new Yk(y.AFrameworkApplication.va,this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane").Boc)).as("Common.Comments.IOfficeSharedCommentsActionHost").singleInstance();this.W.ha("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new Bq(y.AFrameworkApplication.nc,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.W.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),
this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),ka,U.App.xa,y.AFrameworkApplication.ta.Ap,this.W.Sa("Common.ISystemInitiatedFeedback"),y.AFrameworkApplication.va,Q.a.instance,this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").singleInstance();
Wl.a.factory=nh.getInstance;this.W.ha("WordEditor.Comments.EditorCommentManager",nh.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").singleInstance();this.W.ha("WordEditor.Comments.CommentFloatingContainerActor",()=>new nc(this.W.resolve("WordEditor.Comments.CommentsState"),ka,this.W.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.nc,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),
this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),()=>document.querySelector(`#${jd.AppFrame.BUa} .${gk.a.P4b}`),this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),y.AFrameworkApplication.ta.Ap)).as("WordEditor.Comments.ICommentFloatingContainerActor").singleInstance();const db=this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"),yb=db.trackChangeInSidetrackEnabled;yb&&this.W.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").z9i(this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));
this.W.ha("WordEditor.Comments.FloatingCommentManager",()=>new Ie(this.W.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.nc,Q.a.instance,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),db)).singleInstance();this.W.ha("WordEditor.Comments.IFloatingCommentManager",
()=>yb?this.W.resolve("WordEditor.Sidetrack.SidetrackManager"):this.W.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").singleInstance();this.W.ha("WordEditor.Comments.CommentSelectionActor",()=>new bn(y.AFrameworkApplication.va,this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.ICommentHighlightActor"),Df.getInstance(),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
y.AFrameworkApplication.ta.Ap,this.W.resolve("WordEditor.Comments.CommentsState"),ka,new X.a(()=>Ch.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.Sa("WordEditor.Extension.RichApiEventManager"))).as("WordEditor.Comments.ICommentSelectionActor").singleInstance();this.W.ha("WordEditor.Comments.CommentInitActor",()=>new sf(this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),
this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),ka,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),Df.getInstance(),U.App.xa.Hq,y.AFrameworkApplication.va,this.W.resolve("Common.IDynamicScriptLoaderProvider").Uz,this.W.Sa("WordEditor.Comments.ICommentRibbonCommandHandler"),y.AFrameworkApplication.ta.Ap,this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),
this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),this.W.resolve("Common.Comments.ICommentActivationManager"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.Sa("Common.ISystemInitiatedFeedback"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.Sa("Common.App.SafeLinks.ISafeLinksManager"),this.W.Sa("Common.App.People.IExternalPeopleAPI"),this.W.resolve("Common.OfficeSharedCommentsTelemetry"),this.W.resolve("Common.Comments.IViewContainerEventHost"),
this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),db,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.W.resolve("Box4.IPackageBootPerfLogger"),this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).singleInstance();this.W.ha("WordEditor.Comments.CommentsActionManager",
()=>new Re(this.W.resolve("WordEditor.Comments.EditorCommentManager"),this.W.resolve("WordEditor.Comments.EditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentHintActor"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ka,this.W.resolve("Common.Comments.ICommentPane"),new X.a(()=>U.App.xa.ib.Uc.od),y.AFrameworkApplication.va,
new X.a(()=>Ch.a.instance),kg.FocusManager.instance(),Q.a.instance,this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"))).as("WordEditor.Comments.CommentsActionManager").singleInstance();this.W.resolve("WordEditor.Comments.CommentInitActor");ka.contentNavigationApiEnabled&&(this.W.ha("WordEditor.Comments.CommentContentProvider",()=>new Ep(this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.Comments.CommentsSettings"))).singleInstance(),this.W.ha("WordEditor.Comments.CommentContentActor",
()=>new tf(this.W.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.CommentsState"))).singleInstance(),this.W.resolve("WordEditor.Comments.CommentContentProvider"),this.W.resolve("WordEditor.Comments.CommentContentActor"));const Zb=ka.Yq,tc=this.W.resolve("WordEditor.Comments.EditorCommentManager");
this.W.resolve("WordEditor.Comments.CommentsActionManager");tc&&Zb&&(this.W.resolve("WordEditor.Comments.CommentsState").Adb=mm.q5h(),ka.iCb||this.W.resolve("WordEditor.Comments.WordCommentEventsActor").W4("OnCommentInit"));bc.a.C6m();ka.B9b&&U.App.xa.ib.GWh();Wl.a.instance&&(ka.iCb||Hd.a.get_instance().Ak(4,()=>{this.pnn(Zb)},11).continueWith(()=>{this.tzm()}),this._initialized=!0);this.yVn(this.W.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}tzm(){this.W.resolve("WordEditor.Comments.WordCommentEventsActor").W4("OnCommentInit")}pnn(ka){ka||
this.plm()}plm(){const ka=mm.q5h();ka&&(a.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.VW),this.W.resolve("WordEditor.Comments.WordCommentEventsActor").W4("OnCommentInit",Object.assign(new eh.a,{kGa:()=>{Wl.a.instance.Oca.isVisible||y.AFrameworkApplication.va.processAction(wf.a.jV,2);this.W.resolve("WordEditor.Comments.ICommentSelectionActor").rij(ka,Object.assign(new Ad.a,{Pdg:!0}))}})),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").Pv(wf.a.W8e))}yVn(ka,
db,yb){ka&&ka.execute(Zb=>{Zb.Y4(new Hb.a(db,yb))})}dispose(){this._initialized&&(Wl.a.instance&&Wl.a.instance.dispose(),this._initialized=!1)}static q5h(){return y.AFrameworkApplication.K.jb("BootActivityNavigationId")}}Object(f.a)(mm,"PackageManager",null,[1,2]);const Zn=ka=>{const db=L.a.instance.Sa("Box4.IPackageBootPerfLogger"),yb=window.performance.now();db.execute(Zb=>{Zb.zx(Ri.a.comments,"CPMain",yb,!0)});z.a.instance.Fc(new mm,0,ka)};var kn=c(1964);class pk{isComment(ka){return We.a.isComment(ka)}qYd(ka){return We.a.qYd(ka)}oCf(ka){return We.a.oCf(ka)}DTf(ka,
db){We.a.DTf(ka,db)}HTf(ka,db){We.a.HTf(ka,db)}gbf(ka){return We.a.gbf(ka)}u4a(ka){return fg.a.instance.u4a(ka)}deleteComment(ka,db){We.a.deleteComment(ka,db)}yId(ka,db){We.a.yId(ka,db)}Inb(ka){We.a.Inb(ka)}Eba(ka,db,yb){return We.a.Eba(ka,db,yb)}Dva(ka,db,yb){return We.a.Dva(ka,db,yb)}Y8b(ka,db){return We.a.Y8b(ka,db)}RNc(ka,db,yb,Zb=null){return We.a.RNc(ka,db,yb,Zb)}r0b(ka,db,yb,Zb){We.a.r0b(ka,db,yb,Zb)}gzd(ka,db,yb,Zb){return We.a.gzd(ka,db,yb,Zb)}get mHb(){return We.a.mHb}set mHb(ka){We.a.mHb=
ka}RKb(ka,db){We.a.RKb(ka,db)}v4c(ka){We.a.v4c(ka)}h5f(ka){We.a.h5f(ka)}uRd(ka,db){return We.a.uRd(ka,db)}ETf(ka,db){We.a.ETf(ka,db)}GTf(ka,db){We.a.GTf(ka,db)}O6d(ka,db,yb,Zb,tc,Pc){We.a.O6d(ka,db,yb,Zb,tc,Pc)}kif(ka,db){We.a.kif(ka,db)}q2c(ka,db,yb,Zb){return We.a.q2c(ka,db,yb,Zb)}v2c(ka,db,yb,Zb){return We.a.v2c(ka,db,yb,Zb)}}Object(f.a)(pk,"CommentEditorProxy",null,[471]);class ep{constructor(){this.W=null}get YPb(){return null!=this.JHg?this.JHg:this.JHg=(()=>this.W.Sa("WordEditor.ITableEditor"))()}get X4a(){return null!=
this.eFg?this.eFg:this.eFg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}UZ(ka){this.X4a.UZ(Ri.a.comments,ka,!0)}get name(){return"WordEditor.CommentsInteractive"}xc(ka){this.W=ka;this.UZ("CIPConfigStart");ka.ha("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new pk).as("WordEditor.CommentsInteractive.ICommentEditor").singleInstance();this.UZ("CIPConfigEnd")}init(){this.UZ("CIPInitStart");this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>{this.hn();this.UZ("CIPInitEnd")})}hn(){this.fum()}dispose(){}fum(){Vc.a.tSa(We.a.HTf);
kn.a.V_e(We.a.ETf);kn.a.Vzd(We.a.GTf);kn.a.iyk(We.a.mnn);this.YPb.execute(db=>{db.W_e(We.a.RKb)});const ka=U.App.Xj.zl;ka.Ze(39).Go(We.a.DTf);kn.a.pxk(We.a.rmn);kn.a.gxk(We.a.Aln);oe.a.isEnabled&&ka.Ze(12).Ax(We.a.pRj)}}Object(f.a)(ep,"PackageManager",null,[1,2]);const vm=ka=>{const db=L.a.instance.Sa("Box4.IPackageBootPerfLogger"),yb=window.performance.now();db.execute(Zb=>{Zb.zx(Ri.a.comments,"CIPMain",yb,!0)});z.a.instance.Fc(new ep,0,ka)};var wm=c(2079),oc=c(172),To=c(1676);class Ic{constructor(ka,
db,yb,Zb,tc,Pc,Od){this.xMa=ka;this.Caa=db;this.b7=yb;this.Wc=Zb;this.m5j=tc;this.yLe=Pc;this.vvb=Od;To.a.hyk((ke,od)=>{this.ewk(od.graphNode,od.U1k)});To.a.Nyk((ke,od)=>{this.G8k(od.graphNode,od.R_k)})}uQd(){var ka=this.m5j();const db=this.Wc.Bk();db.set(ka);if(this.Caa.bRo(db))return db;db.set(ka);oc.PageNavigator.instance.fP(db);ka=this.b7.nfl(db.currentNode);db.sj(ka);return db}QSd(ka){const db=this.uQd();let yb=null;this.Caa.pNd(db,Zb=>{this.b7.pii(Zb)===ka&&(yb=Zb);return!yb});return yb}lii(ka){const db=
this.uQd();let yb=null;this.Caa.pNd(db,Zb=>{this.b7.e9b(Zb)===ka&&(yb=Zb);return!yb});return yb}HKi(ka,db,yb){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",ka,db,yb)}qii(){const ka=this.uQd(),db=[];this.Caa.pNd(ka,yb=>{db.push(this.b7.pii(yb));return!0});return db}xfb(ka,db){if(!db.length)return this.vvb&&a.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const yb=this.uQd(),Zb=
vh.a.create().toString(),tc=new fe.a;for(let Pc of db)tc.add(Pc),this.HKi(Pc.type,Zb,Pc.completion);db=this.xMa.O$f(tc);this.b7.xfb(yb.currentNode,Zb,ka,db);this.yLe();return Zb}Xe(ka){(ka=this.QSd(ka))?(this.b7.Xe(ka),this.yLe()):this.vvb&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}e9b(ka){ka=this.QSd(ka);return ka?this.b7.e9b(ka):(this.vvb&&a.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}mii(ka){return this.b7.e9b(ka)}oii(ka){ka=
this.QSd(ka);if(!ka)return this.vvb&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;ka=this.b7.huf(ka);return this.xMa.X4b(ka).toArray()}AEk(ka,db){if(!db.length)return this.vvb&&a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const yb=this.QSd(ka);if(!yb)return this.vvb&&a.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const Zb=this.b7.huf(yb),tc=this.xMa.X4b(Zb);
for(let Pc of db)tc.add(Pc),this.HKi(Pc.type,ka,Pc.completion);ka=this.xMa.O$f(tc);ka!==Zb&&(this.b7.noo(yb,ka),this.yLe());return!0}ewk(ka,db){if(db=this.lii(db)){const yb=this.Wc.Bk();yb.set(ka);this.b7.Vb(db.clone(),this.b7.mxl(db,yb))}}n8i(ka,db,yb){if(db.mb(ka))return db.J(ka);const Zb=vh.a.create().toString();db.add(ka,Zb);yb&&this.vvb&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return Zb}G8k(ka,db){const yb=new um.a;var Zb=
this.Wc.Bk();Zb.set(ka);Zb.Sb(38)&&this.Caa.pNd(Zb,tc=>{const Pc=this.b7.e9b(tc);void 0!==Pc&&null!==Pc&&yb.add(Pc,tc);return!0});for(let tc of db)if(ka=null,({value:ka}=yb.Dc(tc.key,ka)).returnValue)if(tc.value===tc.key)ka=this.lii(tc.key),this.b7.$oo(ka,parseInt(tc.key));else{ka=this.b7.huf(ka);if(!ka||""===ka){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}ka=this.xMa.X4b(ka);Zb=new eb.a;for(let Pc=0;Pc<ka.length;Pc++){if(ka.J(Pc).commentId){const Od=
Number.parseInvariant(ka.J(Pc).commentId);db.mb(Od)?ka.J(Pc).commentId=db.J(Od).toString():ka.J(Pc).commentId=null}ka.J(Pc).recordId=this.n8i(ka.J(Pc).recordId,Zb,!1);-1===ka.J(Pc).type&&(ka.J(Pc).undoId=this.n8i(ka.J(Pc).undoId,Zb,!0))}this.xfb(tc.value,ka.toArray())}}static Mr(){return new Ic(L.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),L.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),L.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new tg.a,()=>U.App.xa.ib.Uc,()=>
{L.a.instance.Sa("Common.Interface.IEditNotificationManager").execute(ka=>{ka.editHappened()})},!0)}}Object(f.a)(Ic,"TaskActor",null,[640]);var Uo=c(1115);class ek{create(){return new Uo.a}}Object(f.a)(ek,"TaskContentNodeFactory",null,[598]);var sn=c(1058);class ho{create(){return new sn.a}}Object(f.a)(ho,"TaskNodeFactory",null,[598]);class sc{constructor(ka,db,yb,Zb,tc,Pc){this.Caa=ka;this.Ic=db;this.Wc=yb;this.xmk=Zb;this.Amk=tc;this.WSb=Pc}Odl(ka,db,yb){const Zb=this.Amk.create(1074135162);Zb.setValue(qa.a.taskId,
ka);Zb.setValue(qa.a.bQb,db);Zb.setValue(qa.a.Tya,yb);return Zb}g9b(ka){const db=this.Ic.Oc(4);db.Cb(ka);this.WSb();return db}pii(ka){return this.Caa.rIb(ka)?ka.getValue(qa.a.taskId):(a.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}e9b(ka){return this.Caa.rIb(ka)?ka.hasProperty(qa.a.bQb)?ka.getValue(qa.a.bQb):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}huf(ka){return this.Caa.rIb(ka)?ka.getValue(qa.a.Tya):(a.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),
null)}nfl(ka){if(7!==ka.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const db=this.g9b(ka);try{const yb=this.xmk.create(1074135161),Zb=this.Wc.Bk();Zb.set(ka);Zb.c3(yb,38,sc.IIo);return yb}finally{db&&db.dispose()}}xfb(ka,db,yb,Zb){if(!this.Caa.VGf(ka))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const tc=this.g9b(ka);try{const Pc=this.Odl(db,yb,Zb),Od=this.Wc.Bk();Od.set(ka);Od.c3(Pc,1,new ja.a(vh.a.Hua(yb.toString()),1));return Pc}finally{tc&&
tc.dispose()}}Xe(ka){if(this.Caa.rIb(ka))if(ka.anchor&&ka.anchor.hq){var db=ka.anchor.hq.zr.node;if(this.Caa.VGf(db)){var yb=this.g9b(db);try{const Zb=this.Wc.Bk();Zb.set(db);Zb.sj(ka.anchor.node);Zb.xg()}finally{yb&&yb.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}noo(ka,db){if(this.Caa.rIb(ka)){var yb=
this.g9b(ka);try{ka.setValue(qa.a.Tya,db)}finally{yb&&yb.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}$oo(ka,db){if(this.Caa.rIb(ka)){var yb=this.g9b(ka);try{const Zb=ka.hasProperty(qa.a.bQb)?ka.getValue(qa.a.bQb):null;void 0===Zb||null===Zb||Zb===db?ka.$g(qa.a.bQb,db):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{yb&&yb.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}mxl(ka,db){if(!db.Rr(38)){const yb=this.Wc.Bk();
yb.set(ka);yb.zb(71);yb.jd(71);ka=jb.b(yb.currentNode,ka.Vi().Kc,!0);db.Af(ka,38)}return db.Sb(38)}Vb(ka,db){if(this.Caa.VGf(db)){var yb=this.g9b(db);try{const Zb=this.Wc.Bk();Zb.set(db);Zb.Af(ka,1)}finally{yb&&yb.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static Mr(){return new sc(L.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),new Bd.a,new tg.a,new ek,new ho,()=>{vk.App.sn.ib.Uc.jF.z7(10)})}}sc.IIo=new ja.a(vh.a.Ef("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),
1);Object(f.a)(sc,"TaskEditor",null,[639]);class hq{constructor(ka,db){this.wx=ka;this.pwb=db}rIb(ka){return!!ka&&72===ka.type}yUm(ka){return!!ka&&71===ka.We}VGf(ka){return!!ka&&71===ka.type}bRo(ka){ka.set(this.wx.value);this.pwb.fP(ka);return!!ka.Sb(38)}pNd(ka,db){if(ka&&db)if(this.yUm(ka))for(var yb=!0,Zb=ka.Sb(1);yb&&Zb;)this.rIb(Zb)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",Zb.type),yb=db(Zb),Zb=ka.Pf(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",
ka.We);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static Mr(){return new hq(new X.a(()=>U.App.xa.ib.Uc),oc.PageNavigator.instance)}}Object(f.a)(hq,"TaskNavigator",null,[474]);class wk{constructor(){this.W=null}get name(){return"WordEditor.Tasks"}init(){this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>{this.hn()})}dispose(){}xc(ka){this.W=ka;ka.ha("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new wm.a).as("WordEditor.Tasks.ITaskHistorySerialization").singleInstance();
ka.ha("WordEditor.Tasks.TaskNavigator",()=>hq.Mr()).as("WordEditor.Tasks.ITaskNavigator").singleInstance();ka.ha("WordEditor.Tasks.TaskEditor",()=>sc.Mr()).as("WordEditor.Tasks.ITaskEditor").singleInstance();ka.ha("WordEditor.Tasks.TaskActor",()=>Ic.Mr()).as("WordEditor.Tasks.ITaskActor").singleInstance()}hn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(115)}}Object(f.a)(wk,"TasksPackage",null,[1,2]);var Sg=c(79),Vo=c(1673),tn=c(400),hd=c(93);class Rm{constructor(){this.onResizeMiddleContainer=
this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(f.a)(Rm,"TaskPaneGroupAppProps",null,[]);var Fo=c(179);class Wp{static m3k(ka,db){kg.FocusManager.bK()&&(Dk.a.instance.dCa(ka,db,!1),Fo.a.instance.dCa(ka,db,!1),y.AFrameworkApplication.ta.ox.dT(ka))}}Object(f.a)(Wp,"ReactTaskPaneManagerUtils",null,[]);var Nl=c(137),Xp=c(331);class Sk{constructor(){this.type=
null}}Object(f.a)(Sk,"SampleTaskPaneProps",null,[]);var Zj=c(1674);class al{constructor(){this.entry=null;this.show=!1}}Object(f.a)(al,"AnimationBatchEntry",null,[]);var Hl=c(291),If=c(1131),ik=c(125);class vj{constructor(){this.cah=[];this.dah=[];this.Dla={};this.IJa=this.HJa=null;this.qwd=!1;this.AZ=null;this.ytd=this.tod=0;this.Voc=[];this.LGe=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Nb.hkb;this.Lw=!1}initialize(){this.qwd=!1;(this.Lw=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Nb.yJ)&&
this.Vbf()}Xbf(ka,db,yb,Zb){db=this.SSd(db);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.Vbf();const tc=document.createElement("div");tc.id=db;tc.className=vj.h4o;tc.style.width="0";this.LGe||(this.Xsk(yb,db,tc),this.Dla[db]=ka.Xbf(db,yb,Zb,tc));return tc}Vbf(){this.qwd||this.$qo()}Xsk(ka,db,yb){let Zb=null,tc=null;0===ka?(Zb=this.HJa,tc=this.cah):1===ka&&(Zb=this.IJa,tc=this.dah);if(Zb){ka=!1;for(let Pc=0;Pc<tc.length;Pc++)if(!ka)tc[Pc]===db&&(ka=!0);else if(tc[Pc]in this.Dla){this.NDm(Zb,
yb,this.Dla[tc[Pc]]);return}Zb.appendChild(yb)}}NDm(ka,db,yb){ka.insertBefore(db,yb.element)}hql(ka){ka=this.SSd(ka);if(ka in this.Dla){const db=this.Dla[ka];db.element.parentNode.removeChild(db.element);delete this.Dla[ka]}}ktj(ka){ka=this.SSd(ka);ka in this.Dla&&(ka=this.Dla[ka])&&!ka.isVisible&&(this.usj(ka,!0),this.wrh(ka.position,!0,this.oAh(ka,!0)),1===ka.position&&1<H.a.count(this.Dla)&&this.c9m())}Dtm(ka){ka=this.SSd(ka);ka in this.Dla&&(ka=this.Dla[ka])&&ka.isVisible&&(this.usj(ka,!1),this.wrh(ka.position,
!1,this.oAh(ka,!1)))}o4b(ka){if(this.AZ)return this.AZ;const db=document.createElement("div");document.body.appendChild(db);db&&(this.AZ=new Vo.a(db,ka));return this.AZ}usj(ka,db){ka.element&&(ka.isVisible=db,this.Voc.push(Object.assign(new al,{entry:ka,show:db})));0===ka.position?this.tod+=db?1:-1:this.ytd+=db?1:-1;1===this.Voc.length&&window.setTimeout(Object(bm.a)(this,this.ADo,"startPaneAnimation"),0);this.Lw&&ka.element&&ka.element.parentNode&&(0===ka.position&&!this.tod||1===ka.position&&!this.ytd?
(ka.element.parentNode.style.minHeight="0px",ka.element.parentNode.style.height="0px",ka.element.parentNode.style.overflow="hidden"):(ka.element.parentNode.style.minHeight="",ka.element.parentNode.style.height="",ka.element.parentNode.style.overflow=""))}ADo(){this.BWi();var ka=Db.where(Db.asEnumerable(this.Voc),tc=>0===tc.entry.position),db=Db.where(ka,tc=>!tc.show);if(Db.any(db)&&Db.Ct(db)!==Db.Ct(ka)){for(var yb of db)yb.entry.element.style.width="0";ka=Db.where(ka,tc=>tc.show)}db=Db.where(Db.asEnumerable(this.Voc),
tc=>1===tc.entry.position);yb=Db.where(db,tc=>!tc.show);if(Db.any(yb)&&Db.Ct(yb)!==Db.Ct(db)){for(var Zb of yb)Zb.entry.element.style.width="0";db=Db.where(db,tc=>tc.show)}for(let tc of Db.concat(ka,db))ka=tc.entry,ik.WacAirSpace.YU(ka.element,Hl.a.Ceg),Zb=new If.a(ka.element),tc.show?Zb.g1e(0,ka.width):Zb.g1e(ka.width,0),ik.WacAirSpace.animate(Zb,null,null);this.Voc.length=0}BWi(){}oAh(ka,db){let yb=ka.width;ka=0===ka.position?this.tod:this.ytd;if(db&&1===ka||!db&&!ka)yb+=1;return yb}$qo(){this.qwd||
(this.HJa||(this.HJa=document.createElement("div"),this.HJa.id=vj.f4o,this.HJa.className=vj.JKj,Sys.UI.DomElement.addCssClass(this.HJa,"alignLeft"),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Nb.S8&&Sys.UI.DomElement.addCssClass(this.HJa,"FlexBoxLayout"),this.LGe&&Sys.UI.DomElement.addCssClass(this.HJa,vj.GKj),this.zph(0,this.HJa)),this.IJa||(this.IJa=document.createElement("div"),this.IJa.id=vj.g4o,this.IJa.className=vj.JKj,Sys.UI.DomElement.addCssClass(this.IJa,"alignRight"),y.AFrameworkApplication.ta&&
y.AFrameworkApplication.ta.Nb.S8&&Sys.UI.DomElement.addCssClass(this.IJa,"FlexBoxLayout"),this.LGe&&Sys.UI.DomElement.addCssClass(this.IJa,vj.GKj),this.zph(1,this.IJa)),this.GYi(this.HJa,this.IJa),this.qwd=!0)}GYi(){}gCa(ka,db){Array.add(1===ka?this.dah:this.cah,db)}SSd(ka){return ka+"-Entry"}c9m(){let ka=0;for(const db of H.a.GO(this.Dla)){const yb=Object(Ab.a)(933,this.Dla[db]);yb&&yb.isVisible&&1===yb.position&&ka++}2===ka?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<ka&&
a.ULS.sendTraceTag(595179605,320,50,ka+" simultaneous panes open")}}vj.f4o="WACTaskPaneContainerLeft";vj.g4o="WACTaskPaneContainerRight";vj.JKj="WACTaskPaneContainer";vj.h4o="WACTaskPaneEntry";vj.GKj="WACReactTaskPaneContainer";Object(f.a)(vj,"BaseTaskPaneManager",null,[934]);var nf=c(486),ph=c(289);class Cg extends vj{constructor(ka,db){super();this.Pxc=this.Oxc=this.AXe=this.zXe=0;this.$1h=()=>{fd.InteractiveViewManager.instance.forEach(yb=>{yb.tNd()})};this.ga=ka;this.V_g=db}zph(ka,db){const yb=
U.App.xa.kD;yb.parentNode&&(ka?1===ka&&(this.Lw?((ka=Object(ph.a)("FarPane"))&&ka.appendChild(db),db.classList.add("regionComposer"),U.App.xa.GI.registerBoundingWindowRectsChanged("farPane",(Zb,tc)=>{"DP"===tc||3===tc?db.classList.add("DL"):db.classList.remove("DL")})):yb.parentNode.insertBefore(db,yb.nextSibling)):this.Lw?((ka=Object(ph.a)("NearPane"))&&ka.appendChild(db),db.classList.add("regionComposer")):yb.parentNode.insertBefore(db,yb))}wrh(ka,db,yb){this.Lw||(db=db?yb:-yb,ka?this.Pxc+=db:this.Oxc+=
db)}BWi(){if(!this.Lw){var ka=U.App.xa.kD;ik.WacAirSpace.YU(ka,Hl.a.Ceg);if(this.zXe!==this.Oxc){const db=new nf.a(ka);db.VCk(this.zXe,this.Oxc,this.V_g);ik.WacAirSpace.animate(db,null,this.$1h);this.zXe=this.Oxc}this.AXe!==this.Pxc&&(ka=new nf.a(ka),ka.WCk(this.AXe,this.Pxc,this.V_g),ik.WacAirSpace.animate(ka,null,this.$1h),this.AXe=this.Pxc)}}}Object(f.a)(Cg,"TaskPaneManager",vj,[]);var Ci=c(270);class nm extends Cg{get vxi(){null==this.Tre&&(this.Tre=y.AFrameworkApplication.K?y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",
!1):!1);return this.Tre}constructor(ka,db){super(ka,db);this.uW=Kc.KeyInputManager.jc(Sg.a.Dw,0);this.vW=Kc.KeyInputManager.jc(Sg.a.Dw,4);this.qQe=this.Axc=null;this.b5g="AccCheckerTaskPane";this.ra=new na.a;this.isPaneOpen=!1;this.Tre=this.IAe=null;this.gCa(0,"SampleTaskPane");this.gCa(0,Ci.a.Qgb);this.gCa(1,Ci.a.tIk);this.gCa(1,"CustomTaskPane");this.gCa(1,Ci.a.bBf);this.gCa(1,ag.AFrame.Kr);this.gCa(1,ag.AFrame.pnh);this.gCa(1,ag.AFrame.knh);this.gCa(1,Ci.a.zNd);this.gCa(1,Ci.a.GJc);this.gCa(1,
Ci.a.tLc);this.O9j=(this.SLg=!!y.AFrameworkApplication.ta&&!!y.AFrameworkApplication.ta.Nb)&&y.AFrameworkApplication.ta.Nb.OFf;this.U8j=vk.App.zIb;this.$8j=this.SLg&&y.AFrameworkApplication.ta.Nb.LVc;this.initialize();ka.eb(Ij.a.Ueg,zi.a.application,nm.Ueg,96)}get Dee(){if(!U.App.xa||!U.App.xa.kD)return null;this.qQe||(this.qQe=new Vo.a(U.App.xa.kD,kg.FocusManager.instance()));return this.qQe}Tb(){}GYi(ka,db){const yb=tn.a.instance,Zb=kg.FocusManager.instance(),tc=hd.EventHandlerManager.instance,
Pc=this;Ui.UISurfaces.Gu().then(Od=>{Pc.Axc=Pc.o4b(Zb);let ke;Od.renderTaskPaneGroups(ka,db,(ke=new Rm,ke.middleContainer=U.App.xa.kD,ke.onTabStripFocus=()=>{Zb.cD(Ci.a.$kc)},ke.onOpen=(od,Pe)=>{Pc.PFf(od)&&Wp.m3k(od,Pe);tc.qZe(Pe,"focus",Pc.kgi(od,Zb),!0);var Se=Pc.ezi(od),ng=Od.selectors.getTabbedTaskPaneCount(Se?1:2);Se=Se?Ci.a.ile:Ci.a.$kc;1===ng&&(yb.Jaa(Se),this.isPaneOpen=!0,this.M6i({isPaneOpen:this.isPaneOpen,dQb:Pe}));Pe=Pc.uqf(od);if(ng=Zb.fe(Pe))ng.FHc=Se,Pc.Evo(od)&&(ng.jr(Pc.uW),ng.jr(Pc.vW)),
yb.Oxi(Pe)&&yb.Xw(Pe);this.vxi&&this.yLd&&this.yLd.dismissFloatie(!0)},ke.onClose=(od,Pe)=>{Pc.PFf(od);const Se=Pc.ezi(od),ng=Se?Ci.a.ile:Ci.a.$kc;Od.selectors.getTabbedTaskPaneCount(Se?1:2)||(yb.Xw(ng),this.isPaneOpen=!1,this.M6i({isPaneOpen:this.isPaneOpen,dQb:Pe}));tc.k5f(Pe,"focus",Pc.kgi(od,Zb),!0);this.vxi&&this.yLd&&this.yLd.dismissFloatie(!0)},ke.setFocusCallback=(od,Pe)=>{Pc.PFf(od)&&Pe&&(od=Zb.fe(Pc.uqf(od)),od.FZk(),od.pfa(Pe))},ke.onOverflowMenuOpen=()=>{if(Pc.Axc)Pc.Axc.onMenuOpen()},
ke.onOverflowMenuClose=()=>{if(Pc.Axc)Pc.Axc.onMenuClose()},ke.onShow=(od,Pe)=>{2===Pe&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{Zb.mg(od)},0)})},ke.onHide=(od,Pe,Se)=>{Se&&1!==Pe&&Zb.mg(Zb.vT)},ke.onResizeStart=()=>{if(U.App.xa&&(U.App.xa.kD.className=jd.AppFrame.Oog,Pc.Dee))Pc.Dee.onMenuOpen()},ke.onResizeEnd=()=>{if(U.App.xa&&(Nl.a.sBi()||(U.App.xa.kD.className+=" "+U.App.xa.HBh),Pc.Dee))Pc.Dee.onMenuClose()},ke));this.cja(Ci.a.$kc,Zb,db,Pc);this.cja(Ci.a.ile,Zb,ka,Pc);return null})}cja(ka,
db,yb,Zb){const tc=db.fe(ka);tc.parent=ag.AFrame.rp;tc.RH=!0;Dk.a.instance.dCa(ka,yb,!1);Fo.a.instance.dCa(ka,yb,!1);ka=new Xp.DOMFocusListing(()=>yb);ka.Wm(3);ka.Wm(2);ka.Wm(4);ka.Wm(1);db.hma(()=>yb,tc,ka).oR=!0;tc.jr(Zb.uW);tc.jr(Zb.vW)}uqf(ka){return ka===this.b5g?Ci.a.vmh:ka}kgi(ka,db){return()=>{db.cD(this.uqf(ka))}}Evo(ka){return ka===this.b5g?!1:!0}lLm(ka){return ka===Ci.a.Qgb}PFf(ka){return this.lLm(ka)||ka===Ci.a.vmh||0<=ka.indexOf("AppForOfficePanel")||ka===Ci.a.zNd||ka===Ci.a.bBf&&this.O9j||
ka===Ci.a.GJc&&this.U8j||ka===Ci.a.tLc&&this.$8j||ka===Zj.a.FDb?!0:!1}ezi(ka){return ka===Ci.a.Qgb||"SampleTaskPane"===ka}static lgm(){return new nm(y.AFrameworkApplication.va,y.AFrameworkApplication.isRtl)}static Ueg(ka,db,yb,Zb,tc){if(1===yb)return 32;Ui.UISurfaces.Gu().then(Pc=>{Pc.showTaskPane(tc,Object.assign(new bi.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new Sk,{type:"SampleTaskPaneProps"})}));return null});return 32}hZa(ka){this.ra.addHandler("onPaneToggle",
ka)}T4c(ka){this.ra.removeHandler("onPaneToggle",ka)}M6i(ka){this.ra.raiseEvent("onPaneToggle",ka)}get yLd(){this.IAe||(this.IAe=L.a.instance.Na("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.IAe}}Object(f.a)(nm,"TaskPaneManager",Cg,[389]);class jr{constructor(){this.$S=null}get name(){return"WordEditor.TaskPaneManager"}xc(){}init(){this.$S=nm.lgm();this.$S.Tb();U.App.xa.u7a=this.$S}dispose(){}}Object(f.a)(jr,"PackageManager",null,[1,2]);c.d(K,"a",function(){return l})},1964:function(F,
K,c){F=c(0);var l=c(168),f=c(719),a=c(352),k=c(22),x=c(2),y=c(80),n=c(44),u=c(41),z=c(6),w=c(16),E=c(7),G=c(74),H=c(438),L=c(86),I=c(465),N=c(5),Q=c(585),M=c(202),J=c(220),V=c(18),X=c(1097),W=c(36),U=c(81),Y=c(40),ba=c(764),aa=c(26),fa=c(76),na=c(21),oa=c(52);class ja{constructor(Sa,xb,Qb,Ib){this.KId=this.IId=null;this.l9c=Sa;this.qle=xb;this.zuj=Qb;this.Auj=Ib}}Object(F.a)(ja,"TableSimplificationInformation",null,[]);var qa=c(78),Ia=c(28),Va=c(441),Na=c(255),za=c(920),la=c(1576),va=c(279),ia=c(3),
pa=c(9),sa=c(139),Ha=c(17),ra=c(256),Ma=c(32),ya=c(248),Ga=c(8),wa=c(628),hb=c(558),eb=c(338);class jb extends Sys.EventArgs{constructor(Sa){super();this.Mo=Sa}}Object(F.a)(jb,"AfterTrimCompleteOnCopyArgs",Sys.EventArgs,[]);var ub=c(1775);class ab extends ub.a{constructor(Sa,xb,Qb,Ib){super(Sa,xb,{});this.XSa=[];for(Sa=0;Sa<Qb.length;Sa++)this.XSa.push(...Qb.J(Sa).toArray());this.dDa=0;this.py=Ib;this.Mo={}}}Object(F.a)(ab,"BasicInternalCopyArguments",ub.a,[]);class Ea extends Sys.EventArgs{constructor(Sa,
xb){super();this.Mo=xb;this.XSa=[];for(xb=0;xb<Sa.length;xb++)this.XSa.push(...Sa.J(xb).toArray())}}Object(F.a)(Ea,"BeforeCopyArguments",Sys.EventArgs,[]);class Wa extends Sys.EventArgs{constructor(Sa){super();this.Mo=Sa}}Object(F.a)(Wa,"BeforePasteArguments",Sys.EventArgs,[]);class Bb extends Sys.EventArgs{constructor(Sa,xb,Qb,Ib){super();this.paragraph=Sa;this.cpBegin=xb;this.cpEnd=Qb;this.Mo=Ib}}Object(F.a)(Bb,"BeforeTrimOnCopyArguments",Sys.EventArgs,[]);var Mb=c(1818),Fb=c(1819);class vb{constructor(Sa,
xb,Qb,Ib,$b,hc,pb,dc,Ob){this.glc=Sa;this.source=xb;this.target=Qb;this.sXf=Ib;this.rowIndex=$b;this.vo=hc;this.SZa=pb;this.$0i=dc;this.he=Ob}}Object(F.a)(vb,"CoreInternalTablePasteArguments",null,[]);class $a extends Sys.EventArgs{constructor(Sa,xb,Qb,Ib,$b){super();this.operation=Sa;this.JZi=xb;this.original=Qb;this.clone=Ib;this.Mo=$b}}Object(F.a)($a,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var kb=c(96);c.d(K,"a",function(){return Ua});class Ua{constructor(Sa,xb,Qb,Ib,$b,hc,pb,dc,Ob,Vb,
ob,Xb,Xa,Pb,rc){this.FW=this.rt=null;this.rLe=!1;this.xAa=null;this.cZk=(Ta,Ab)=>{l.a.mark(5566);Ab=Ab.target;if(Ab.Pd())return Ab.xg(),!0;Ta.hi(this.BLc);return!0};this.BLc=(Ta,Ab)=>{Ab=new Mb.a(Ab,null);const Db=new f.a(Ta,this.hIc,Ab);Db.Jl("ExecuteCoreCopyToInternalClipboard");this.WIn(Ab);Db.run();Ta.hi(this.QOo);return!0};this.hIc=(Ta,Ab)=>{if(!Ab.source.Pd())return Ab.Bi&&(Ab.Bi.IDd=null),E.ULS.shipAssertTag(6305560,307,!1),this.pg.logKpiFailure({kpiName:eb.a.hDd,errorName:"InternalCopyFailedSourceHasNoChildren"}),
!1;Ta.hi(this.eKh);return!0};this.eKh=(Ta,Ab)=>{const Db=Ab.insertAfter,ac=Ab.source,Pa=Ab.target,bb=ac.currentNode;var lc=this.hZi;if(!bb.wha)return Ta.hi(this.gIc),!0;Ab.Bi.UOb&&(Ab.UOb=!0);if(!this.LWk(Ab))return Ab.Gja.jFa.c++,Ta.hi(this.gIc),!0;if(!Ab.UOb&&(bb.k6b()&&Ab.Gja.jFa.c++,bb.k6b()||lc&&!bb.dkb(this.rv)))return Ta.hi(this.gIc),!0;if(!Ab.UOb&&lc&&!bb.Gz)return ac.vz()&&(Ab.Hoe=!0,Ab=new f.a(Ta,this.hIc,new Mb.a(Ab,Db)),Ab.Jl("RecursiveCoreCopyToInternalClipboard"),Ab.run()),Ta.hi(this.gIc),
!0;lc=Pa.currentNode.Vi().od;lc=Q.b(bb,lc,!0);lc.Fjb=!0;this.fra.Zce(Ab.Gja.MFb,lc);Pa.JH(lc,Db,18===ac.parentNode.type?1:ac.role);Pa.sj(lc);Ab.insertAfter=lc;Ga.ParagraphReader.Wb(lc)&&(this.iJn(Ta,this.hIc,bb,lc,Ab),this.hJn(Ta,bb,lc));this.uXh(bb,lc);ac.vz()&&(E.ULS.shipAssertTag(6305562,307,!Ab.Hoe),Ab=new f.a(Ta,this.hIc,new Mb.a(Ab,null)),Ab.Jl("RecursiveCoreCopyToInternalClipboard"),Ab.run());Ta.hi((rb,La)=>this.I8k(rb,La));return!0};this.gIc=(Ta,Ab)=>{Ab.Hoe&&(Ab.insertAfter=Ab.IDd,Ab.Hoe=
!1);if(!Ab.source.Bt()){Ab.Bi&&(Ab.Bi.IDd=Ab.insertAfter);const Db=Ab.source;11!==Db.We||Db.q8b(-1)||this.MJn(Ta,Db.currentNode,Ab.target.currentNode,Ab);return!1}Ta.hi(this.eKh);return!0};this.QOo=(Ta,Ab)=>{if(Ab.dDa>=Ab.XSa.length)return Ua.ra.raiseEvent("AfterTrimCompleteOnCopy",new jb(Ab.Mo)),Ta.hi(this.H8k),!0;Ta=Ab.XSa[Ab.dDa];var Db=Ta.node,ac=Ta.cpBegin;let Pa=Ta.cpEnd;if(!Ha.SelectionEditor.mv(Ta))if(!Ab.dDa&&Ha.SelectionEditor.Hk(Ta))Pa=ac=Ga.ParagraphReader.textLength(Db);else if(Ga.ParagraphReader.lm(Ta))ac=
0,Pa=Ga.ParagraphReader.textLength(Db);else if(Ha.SelectionEditor.fca(Ta)){E.ULS.shipAssertTag(6305568,307,!Ab.dDa);var bb=N.GraphIterator.$a(Db);ac=bb.zb(12);E.ULS.shipAssertTag(6305569,307,ac);Db=bb.origin;Pa=ac=Ga.ParagraphReader.textLength(Db)}else{if(U.OutlineReader.e_d(Ta))for(Ta=M.a.Zo(Ta.node);Ta.moveNext();)bb=Ta.currentNode,Ga.ParagraphReader.Wb(bb)&&Ab.XSa.push(Ia.a.createTextRange(bb,0,Ga.ParagraphReader.textLength(bb)));Ab.dDa++;return!0}bb=Ab.jYf[Db.id.toString()];E.ULS.shipAssertTag(6305570,
307,!!bb);if(!bb)return E.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:Ab.dDa,["SelectedContextsLength"]:Ab.XSa.length,["SelectedNodeType"]:Db.type,["ContextId"]:Ta.contextId}),Ab.dDa++,!0;Db=qa.e(bb);let lc,rb=!1;for(lc=Db.length-1;0<=lc;lc--)if(!Db[lc].FCa)if(4===Db[lc].zh)Db[lc].Ib.blob=null,Db[lc].Ib.blob=new Va.a(Db[lc].Ib),Ab.Gja.jFa.e++;else{Db[lc].Ib.blob=null;if(-1!==Db[lc].qe){var La=Db[lc].Ib.formatting,sb=void 0,Sb=void 0;La&&-1===La.qe?(Sb=Db[lc].qe+
1,sb=Db[lc].A4-1,La.qe=Db[lc].qe):(sb=Db[lc].A4,Sb=Db[lc].qe);for(La=0;La<sb;La++)bb.xe.removeAt(Sb,16);0<sb&&(rb=!0)}sb="";va.f(Db[lc])?(sb=" ",Ab.Gja.jFa.f++):va.g(Db[lc])&&(Sb=va.b(Db[lc]))&&(sb=va.a(Sb),Ab.Gja.jFa.g++);Sb=Db[lc].Ib.cp;Sb>=ac&&Sb<Pa&&(Ua.characterPropertiesEditor.replaceTextRange(Ia.a.createTextRange(bb,Sb,Sb+1),sb,void 0,void 0,void 0,void 0,!0),Pa=Pa-1+sb.length,Ab.Gja.jFa.i++)}rb&&bb.Yl();this.R0n(bb);Ua.ra.raiseEvent("BeforeTrimOnCopy",new Bb(bb,ac,Pa,Ab.Mo));Db=Ga.ParagraphReader.textLength(bb);
Pa<Db&&Ua.characterPropertiesEditor.replaceTextRange(Ia.a.createTextRange(bb,Pa,Db),"",void 0,void 0,void 0,void 0,!0);0<ac&&Ua.characterPropertiesEditor.replaceTextRange(Ia.a.createTextRange(bb,0,ac),"",void 0,void 0,void 0,void 0,!0);this.Gmm(bb,Ab.Gja.jFa);Ga.ParagraphReader.textLength(bb)||Ab.dDa!==Ab.XSa.length-1||!Ha.SelectionEditor.mv(Ta)||bb.Vs||(Ta=N.GraphIterator.$a(bb),Ta.zb(25)&&(W.OutlineElementNavigator.Vd(Ta),this.nh.U_a(Ta),Ab.dDa&&(this.rt.kb.mva=!0)));Ab.dDa!=Ab.XSa.length-1||this.mva||
bb.Eg(u.a.U4,u.a.Pca,u.a.Dpa,u.a.Lxa,u.a.u9);this.fra.Y3c(Ab.Gja.$9d,Ab.Gja.LAb,Ab.Gja.geb,bb);Ab.dDa++;return!0};this.H8k=(Ta,Ab)=>{this.sja.zRb(null);Ab.py.dispose();l.a.mark(5567);this.yin();this.FW=Ab.Gja;this.LJi("Copy");this.cIm&&E.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1};this.yCn=(Ta,Ab)=>{if(Ab.glc){if(Ab.glc.inProgress)return!0;aa.TableCellReader.isTableCell(Ab.source)||Ab.source.jd(16);if(this.$fn(Ab))return!1}else Ma.TableReader.isTable(Ab.target)||Ab.target.jd(14),
Ma.TableReader.isTable(Ab.source)||Ab.source.jd(14),na.moveToCell(Ab.target,Ab.rowIndex,Ab.vo),na.moveToCell(Ab.source,0,0);if(aa.TableCellReader.hg(Ab.source)||aa.TableCellReader.hg(Ab.target))return!0;this.lCn(Ab,Ta);return!0};this.iIc=(Ta,Ab)=>{if(!Ab.source.Pd())return Ta.hi(this.$mb),!0;Ta.hi(this.gKh);return!0};this.gKh=(Ta,Ab)=>{const Db=Ab.source,ac=Ab.target,Pa=Db.currentNode;if(!Pa.wha||!Pa.iNa||this.lvo(Db,ac))return Ta.hi(this.aaf),!0;if(L.a.instance.J(1)&&Y.OutlineElementReader.Nh(Db)){if(!W.OutlineElementNavigator.Ge(Db).iNa)return W.OutlineElementNavigator.Vd(Db),
Ta.hi(this.aaf),!0;W.OutlineElementNavigator.Vd(Db)}E.ULS.shipAssertTag(6305608,307,!Pa.k6b());var bb=ac.currentNode.Vi().od;bb=Q.b(Pa,bb,!0);bb.nGa();bb.vVc=!0;this.a5n(Db,ac);ac.JH(bb,Ab.insertAfter,Db.role);ac.sj(bb);Ab.insertAfter=bb;pa.App.rd.Qo&&pa.App.rd.Tp.VF(bb);this.uXh(Pa,bb);Ab=new f.a(Ta,this.iIc,new Fb.a(Db,ac,null,Ab.sXf,Ab.Mo));Ab.Jl("RecursiveCorePasteOperation");Ab.run();Ta.hi(this.L8k);return!0};this.L8k=(Ta,Ab)=>{const Db=Ab.target,ac=Db.currentNode,Pa=Ab.source,bb=Pa.currentNode;
let lc=-1;Ab.Mo[Ua.hzf]&&(lc=Ab.Mo[Ua.hzf]);Ga.ParagraphReader.Wb(ac)&&(this.YJn(Ta,this.iIc,bb,ac,Ab),this.UJn(Ta,bb,ac));ac.v0();Ab.Mo[X.a.Cti]?22===ac.type&&(aa.TableCellReader.b0(Pa)||ac.setValue(z.a.listID,Number.MAX_VALUE)):this.sK.k4n(ac);if(Ga.ParagraphReader.Wb(ac)&&(Ab=qa.i(ac,5),0<Ab.length)){for(const rb of Ab)!rb.properties.hasProperty(z.a.CLb)&&rb.properties.hasProperty(z.a.C$d)&&(Ab=rb.properties.getValue(z.a.C$d),rb.properties.setValue(z.a.CLb,Ab)),V.ImageReader.kac()?V.ImageReader.tIb(rb.properties)&&
this.Uj.y9f(rb.properties,lc):V.ImageReader.wy(rb.properties)||this.Uj.y9f(rb.properties,lc);ac.Vi().contentReplicator.forceOutbound(null,null,null)}this.tXh(Db);this.y_o(bb,ac);Ma.TableReader.xU(ac)&&E.ULS.sendTraceTag(524919814,3022,50,"TablePasted");aa.TableCellReader.Roa(Db)&&la.a.thj(ac);Db.wc();Ta.hi(this.aaf);return!0};this.aaf=(Ta,Ab)=>{if(!Ab.source.Bt())return Ta.hi(this.$mb),!0;Ta.hi(this.gKh);return!0};this.$mb=()=>{l.a.mark(5565);return!1};this.CXb=hc;this.Xo=pb;this.Uj=Sa;this.GUe=xb;
this.uK=Qb;this.nh=Ib;this.sK=$b;this.Fa=dc;this.Ic=Vb;this.Vxd=Ob.create(2097162);this.l4f(this.Vxd);this.Dze=Ob.create(2097162);this.l4f(this.Dze);this.CXe=Ob.create(2097162);this.l4f(this.CXe);this.Dwd=this.Vxd;this.hZ=ob;this.S2=Xb;this.Sd=Xa;this.pg=a.a.getInstance(eb.a.NZa);this.dBc=Pb;this.njk=Pb.substr(0,3);this.x6=rc}get paragraphEditor(){return null!=this.DFg?this.DFg:this.DFg=k.a.instance.resolve("Box4.IParagraphEditor")}get Xb(){return null!=this.uzg?this.uzg:this.uzg=k.a.instance.Na("Box4.IFeatureHelper")}get rv(){return this.rt?
this.rt.rv:0}get dBb(){return this.rt.kb.dBb}get mva(){return this.rt.kb.mva}get sja(){return this.Dwd}get jzj(){return this.CXe}get d$e(){return this.rt.wJ&&!this.rLe}Foj(){this.rLe=!0}get hZi(){return!this.rt.wJ}get fra(){return wa.a.instance}l4f(Sa){var xb=new za.a(-1);this.CXb.zl.QMa(xb);const Qb=new N.GraphIterator;Qb.set(xb);x.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordNoRenderGraphTransactionInternalClipboardSettings");xb=3;this.Fa&&this.Fa.$("NoRenderGraphTransactionInternalClipboardIsEnabled")&&
(xb=0);xb=this.Ic.Oc(xb);xb.Lt(Qb);Qb.Af(Sa,80);xb.dispose()}vGd(Sa,xb=null){Sa=Sa.lb;this.rt=Sa.gb.clone();this.rLe=!1;Sa=N.GraphIterator.$a(Sa.m1);const Qb=N.GraphIterator.$a(this.sja),Ib=this.Ic.Oc(3,ia.a.internalCopy);Ib.Lt(Qb);Sa.Sb(82);do Sa.currentNode.zRb(null);while(Sa.zi(82));Sa=new f.a(xb,this.cZk,new ab(Sa,Qb,this.rt,Ib));Sa.Jl("InternalCopy");Sa.Gh=!xb||xb.Gh;Sa.run()}I8k(Sa,xb){var Qb=xb.source;const Ib=xb.target;var $b=Ib.currentNode,hc=Qb.currentNode;Ga.ParagraphReader.sh(Ib)&&(xb.jYf[hc.id.toString()]=
$b);if(Ga.ParagraphReader.Wb($b)){if(0<Ga.ParagraphReader.Nhi(hc))if(0<this.Xo.xG(hc).Ot)hc.setValue(z.a.URa,0);else{const pb=this.Xo.U3(hc).Ot;this.paragraphEditor.jq.lda($b,pb)}if(!this.tYd&&this.x6.a1i){Qb.wc();if(!Ma.TableReader.ex(Ib)&&Qb.DFa&&!this.mva)for(const pb of this.x6.lYf)$b.removeProperty(pb);Qb.sj(hc)}}if(Ga.ParagraphReader.Wb($b)){for(hc=0;hc<$b.xe.length;hc++)$b.xe.nq.Z(hc,ya.CharacterPropertiesEditor.MM),$b.xe.ft.Z(hc,ya.CharacterPropertiesEditor.tR);E.ULS.shipAssertTag(6305565,
307,!!pa.App.rd);(this.Sd.rg||L.a.instance.J(1)&&pa.App.Ev.AQb)&&$b.setValue(z.a.rQa,!0);$b.Eg(z.a.nDb,z.a.b0i,z.a.cYf);L.a.instance.J(1)&&Ga.ParagraphReader.Wb($b)&&$b.Eg(z.a.Owa)}this.hZi&&(this.tXh(Ib),Ma.TableReader.isTable(Ib)&&($b=this.rt.nO(),$b.moveNext(),($b=aa.TableCellReader.hEa(Qb,$b.current.node))||($b=new ba.a(0,0)),Qb=new ja($b,Ib,Ma.TableReader.Iga(Qb),Ma.TableReader.Rtf(Qb)),this.GUe.value.j7n(Qb)));Y.OutlineElementReader.Nh(Ib)&&!Ib.Rr(2)&&(this.nh.YI(Ib),Ib.wc());Ib.wc();xb.Bi&&
(xb.Bi.IDd=xb.insertAfter);Sa.hi(this.gIc);return!0}LWk(Sa){const xb=Sa.source;if(Y.OutlineElementReader.Nh(xb)&&xb.Bib(12)){const Qb=xb.Pd();if(Ga.ParagraphReader.Wb(Qb)&&Qb.ia(z.a.kN,null))return xb.wc(),Sa.UOb=!1;xb.wc()}else if(Ga.ParagraphReader.Wb(xb.wn)&&xb.wn.ia(z.a.kN,null))return!1;return!0}hJn(Sa,xb,Qb){xb=qa.e(xb);Qb=qa.e(Qb);for(let Ib=0;Ib<xb.length;Ib++)xb[Ib].hTf(Qb[Ib],Sa,this.hIc)}R0n(Sa){if(Sa=Sa.pa){var xb=new G.a;for(let Qb=0;Qb<Sa.length;Qb++){const Ib=Sa.J(Qb);Ib.yj&&xb.add(Ib)}for(const Qb of xb)Qb.yj=
null}}get cIm(){return!N.GraphIterator.$a(this.sja).Pd()}eJj(){this.Dwd=this.CXe}dJj(){this.Dwd=this.Vxd}Y0o(){this.Dwd=this.Dze}get nVm(){return this.sja===this.Vxd}get mKm(){return this.sja===this.Dze}AEh(){const Sa=N.GraphIterator.$a(this.sja);for(;Sa.Pd();)Sa.xg()}LJi(Sa){const xb=this.FW.jFa.b;Sa+="-"+xb;this.FW.jFa.b=Sa;this.FW.MFb.b=Sa;this.FW.$9d.b=Sa;this.FW.LAb.b=Sa;this.FW.geb.b=Sa;this.fra.T4m(this.FW.jFa);this.fra.NKf(this.FW.MFb);this.fra.RKi(this.FW.$9d);this.fra.BKf(this.FW.LAb);this.fra.xKf(this.FW.geb);
this.FW.jFa.b=xb;this.FW.MFb.b=xb;this.FW.$9d.b=xb;this.FW.LAb.b=xb;this.FW.geb.b=xb}X0i(Sa,xb,Qb,Ib,$b=null,hc=null){this.LJi("Paste");xb=N.GraphIterator.$a(xb);const pb=N.GraphIterator.$a(this.sja);var dc=null;$b&&(dc=new I.a(U.OutlineReader.Iil,U.OutlineReader.sjl),dc=$b.equals(new I.a(-1,-1))?new I.a(0,0):$b.Ike(dc));if(this.wti())if(pb.Pd(),V.ImageReader.Ju(pb.currentNode))$b=pb.currentNode,pb.wc(),pb.JH(this.nh.wfb(),null,1),pb.Pd(),pb.JH($b,null,2),pb.wc(),pb.sj($b),pb.xg(),this.Foj();else if(J.isFloatingEmbeddedFileNode(pb.currentNode)){$b=
pb.currentNode;pb.wc();pb.JH(this.nh.wfb(),null,1);pb.Pd();var Ob=this.nh.YI(pb);Ob=Ia.a.Qc(Ob,0);Ua.characterPropertiesEditor.replaceTextRange(Ob,"<<"+J.getEmbeddedFileName($b)+">>",void 0,void 0,void 0,void 0,!0);pb.wc();pb.wc();pb.sj($b);pb.xg();this.Foj()}this.hZ&&this.hZ.tFf(Qb)||!this.pDi(pb,xb)?(l.a.mark(5564),pb.currentNode.zRb(null),Sa={},Sa[Ua.hzf]=Ib,kb.ListItemReader.yg(Qb)&&(Sa[X.a.Cti]=!0),Qb=new Fb.a(pb,xb,Qb,dc,Sa),Ib=new f.a(hc,this.iIc,Qb),Ib.Jl("ExecuteCorePasteFromInternalClipboard"),
Ib.Gh=!hc||hc.Gh,this.XIn(Qb),Ib.run()):(pb.currentNode.zRb(null),E.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.P4n(hc,pb,xb,dc,Sa),E.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended."))}MCi(Sa){if(Sa&&Sa.isValid){const xb=N.GraphIterator.$a(this.sja);return this.pDi(xb,Sa)}return!1}pDi(Sa,xb){if(aa.TableCellReader.Roa(xb)&&1===Sa.Mp()){Sa.Sb(1);if(Y.OutlineElementReader.Nh(Sa)){W.OutlineElementNavigator.Ge(Sa);if(Ma.TableReader.isTable(Sa))return Ma.TableReader.DB(Sa.currentNode)&&
E.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table."),xb.zb(14)&&!Ma.TableReader.DB(na.getContainingTable(xb))?E.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."):E.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table."),!0;W.OutlineElementNavigator.Vd(Sa)}Sa.wc()}return!1}P4n(Sa,xb,Qb,Ib,$b){let hc,pb;let dc;Object(n.a)("ReplaceTableCellsFromClipboardTable",!0);Qb.zb(14);hc=oa.a.Bs(Qb);pb=fa.a(Qb);Qb.jd(14);var Ob=Ma.TableReader.ag(Qb.currentNode);
dc=Ma.TableReader.Zg(Qb.currentNode);const Vb=Ma.TableReader.ag(xb.currentNode),ob=Ma.TableReader.Zg(xb.currentNode);E.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};  and target insert index: {5},{6}",Ob,dc,Vb,ob,hc,pb);if(ra.TableBorderSelectionCache.nQc())this.Zoo(),Ob=Math.min(this.Ale+1,Ob),dc=Math.min(this.xig+1,dc),this.xig-this.GIo==dc-1&&(this.uyj==this.Ale?pb=0:this.Ale-this.uyj==Ob-1&&(Qb.Pd(),hc=oa.a.Bs(Qb),pb=fa.a(Qb)));else{this.xAa=
hb.a.o8b;const Xb=hc+Vb-Ob;0<Xb&&(na.moveToLastRow(Qb),E.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+Xb),this.GUe.value.insertRows(Qb,!1,Xb,this.xAa),E.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),Qb.jd(14));const Xa=pb+ob-dc;if(0<Xa){E.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+Xa);try{this.GUe.value.insertColumns(Qb,dc,!1,Xa,this.xAa)}catch(Pb){throw E.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",Pb.toString()),Pb;}E.ULS.sendTraceTag(8716377,
307,50,"Completed inserting columns.")}(0<Xb||0<Xa)&&Object(n.a)("InsertRowsAndColumnsForInternalCCP",!0)}Ob=this.uQl(Ob,dc,Vb,ob,hc,pb);E.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");Sa=new f.a(Sa,this.yCn,new vb(null,xb,Qb,Ib,hc,pb,Ob,null,$b));Sa.Jl("ExecuteCorePasteTableInTable");Sa.Gh=!1;Sa.run()}yin(){if(this.tYd){for(var Sa=N.GraphIterator.$a(this.sja),xb=Sa.currentNode;14!==Sa.We;)if(xb=Sa.Pd(),!xb){E.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");
return}this.QRi(xb)}}Cin(Sa){this.tYd&&this.QRi(Sa)}uLo(Sa){const xb=N.GraphIterator.$a(Sa);this.uK.kjb(xb,null,!0);Sa.hg=!1;Sa.rowSpan=1;Sa.colSpan=1}QRi(Sa){if(Sa&&14===Sa.type){E.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var xb={},Qb=Ma.TableReader.ag(Sa),Ib=Ma.TableReader.Zg(Sa),$b=N.GraphIterator.$a(Sa);na.forEachCellInTable($b,(hc,pb,dc)=>{const Ob={};hc=hc.currentNode;if(16===hc.type)if(hc.hg)Ua.tHh(pb,dc)in xb||(this.uLo(hc),Ob.IsGhostCell="->false");else{Ua.JUn(Sa,
hc,pb,dc,Qb,(ob,Xb,Xa)=>{Ob.rowSpan=String.format("{0}:{1}->{2}",ob,Xb,Xa)});Ua.IUn(Sa,hc,dc,pb,Ib,(ob,Xb,Xa)=>{Ob.colSpan=String.format("{0}:{1}->{2}",ob,Xb,Xa)});const Vb=String.format("{0},{1}-{2},{3}",pb,dc,pb+hc.rowSpan,dc+hc.colSpan);for(let ob=0;ob<hc.rowSpan;ob++)for(let Xb=0;Xb<hc.colSpan;Xb++)if(ob||Xb)xb[Ua.tHh(pb+ob,dc+Xb)]=Vb}if(0<H.a(Ob).length){if(void 0===Ob.IsGhostCell||null===Ob.IsGhostCell){if(void 0===Ob.rowSpan||null===Ob.rowSpan)Ob.rowSpan=hc.rowSpan;if(void 0===Ob.colSpan||
null===Ob.colSpan)Ob.colSpan=hc.colSpan}E.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",pb,dc,Ob)}return!0});Ua.Xsl(xb)}}Gmm(Sa,xb){if(Sa&&Ga.ParagraphReader.Wb(Sa)){var Qb=0,Ib=N.GraphIterator.$a(Sa);for(Ib.Sb(6);!Ib.Sr;){var $b=Ib.currentNode;Ib.zi(6);V.ImageReader.Ju($b)?V.ImageReader.VFf($b)?N.GraphIterator.$a($b).Bib(59)?E.ULS.sendTraceTag(590455048,307,50,"HandleAnchoredObjectsForInternalCopy: Not converting anchored image to inline."):(this.paragraphEditor.iJh($b,Ia.a.Qc(Sa,
Qb),!0),xb.d++,Qb++):($b=N.GraphIterator.$a($b),$b.zb(12),$b.xg(),xb.h++):E.ULS.shipAssertTag(6305571,307,!1)}}}get tYd(){return!!this.Fa&&this.Fa.$("ComplexTableCellPasteWithFormattingIsEnabled")}uQl(Sa,xb,Qb,Ib,$b,hc){const pb=[];let dc,Ob,Vb,ob;ra.TableBorderSelectionCache.nQc()?(dc=Math.min(Sa,$b+Qb),Ob=Math.min(xb,hc+Ib),ob=$b):(ob=0,dc=Math.max($b+Qb,Sa));for(;ob<dc;ob++)for(ra.TableBorderSelectionCache.nQc()?Vb=hc:(Vb=0,Ob=hc+Ib,ob<$b?Vb=xb:ob>=$b&&ob<Math.min($b+Qb,Sa)?Vb=hc:ob>=$b+Qb&&ob<
Sa?Vb=xb:Ob=Math.max(hc+Ib,xb));Vb<Ob;Vb++)pb.push(Array(2)),pb[pb.length-1][0]=ob,pb[pb.length-1][1]=Vb;return pb}a5n(Sa,xb){if(this.tYd)if(!xb||!Sa)E.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:Sa,["table"]:xb});else if(16===xb.currentNode.type&&16===Sa.parentNode.type){xb=xb.currentNode;Sa=Sa.parentNode;var Qb={};xb.hg!==Sa.hg&&(xb.hg=Sa.hg,Qb.IsGhostCell=xb.hg);xb.r4!==Sa.r4&&(xb.r4=Sa.r4,Qb.IsSkippedCell=xb.r4);xb.Yob!==Sa.Yob&&(xb.Yob=Sa.Yob,Qb.ShouldRenderCell=
xb.Yob);xb.colSpan!==Sa.colSpan&&(Qb.ColSpan=String.format("{0}<={1}.",xb.colSpan,Sa.colSpan),xb.colSpan=Sa.colSpan);xb.rowSpan!==Sa.rowSpan&&(Qb.RowSpan=String.format("{0}<={1}.",xb.rowSpan,Sa.rowSpan),xb.rowSpan=Sa.rowSpan);H.a(Qb)}}lvo(Sa,xb){let Qb=!1;Y.OutlineElementReader.Nh(Sa)&&(Qb=Y.OutlineElementReader.yQ(Sa)&&this.xUm(xb));return Qb}xUm(Sa){if(Sa)return Sa=Sa.We,36===Sa||38===Sa||16===Sa;throw Error.argument("IsTargetNodeInValidForIFrameContent: target iterator is null for paste.");}UJn(Sa,
xb,Qb){xb=qa.e(xb);const Ib=qa.e(Qb);for(let $b=xb.length-1;0<=$b;$b--){if(!xb[$b].Rjc(Qb)){const hc=Ia.a.createTextRange(Qb,xb[$b].Ib.cp,xb[$b].Ib.cp+1);Ua.characterPropertiesEditor.replaceTextRange(hc,"",void 0,void 0,void 0,void 0,!0)}xb[$b].J_c(Ib[$b],Sa,this.iIc,this.mKm)}}y_o(Sa,xb){if(L.a.instance.J(1)&&Ma.TableReader.xU(Sa)){let Qb=0;const Ib=Ma.TableReader.ag(Sa);for(const $b of Ma.TableReader.Ix(Sa,0,Ib-1))$b.Ru&&Qb++;Sa=this.Ic.Oc(4);Sa.Cb(xb);xb.properties.setValue(w.a.Rya,Ib-Qb);Sa.dispose()}}W5d(){return!N.GraphIterator.$a(this.sja).Pd()}wti(){return this.d$e?
1===N.GraphIterator.$a(this.sja).Mp():!1}z7h(Sa){try{return this.eTl(Sa)}catch(xb){return E.ULS.sendTraceTag(23643968,307,10,"GetCopySourceFromDOMTree failed with exception:{0}",xb.message),0}}eTl(Sa){let xb=0;if(Sa&&(xb=this.dTl(Sa),!xb&&Sa.childNodes))for(let Qb=0;Qb<Sa.childNodes.length&&!(xb=this.z7h(Sa.childNodes[Qb]));Qb++);return xb}dTl(Sa){if(1===Sa.nodeType&&Sa.getAttribute){Sa=(Sa.getAttribute("class")||"").split(" ");for(const xb of Sa)if(xb.startsWith(this.njk))return xb.startsWith(this.dBc)?
this.rv&&xb===this.dBc+this.rv?3:2:1}return 0}iJn(Sa,xb,Qb,Ib,$b){$b.Mo||($b.Mo={});Ua.ra.raiseEvent("OnParagraphCopy",new $a(Sa,xb,Qb,Ib,$b.Mo))}MJn(Sa,xb,Qb,Ib){Ib.Mo||(Ib.Mo={});Ua.ra.raiseEvent("OnCopyComplete",new $a(Sa,null,xb,Qb,Ib.Mo))}XIn(Sa){Sa.Mo||(Sa.Mo={});Ua.ra.raiseEvent("BeforePaste",new Wa(Sa.Mo))}WIn(Sa){Sa.Mo||(Sa.Mo={});Ua.ra.raiseEvent("BeforeCopy",new Ea(this.rt,Sa.Mo))}YJn(Sa,xb,Qb,Ib,$b){Ua.ra.raiseEvent("OnParagraphPaste",new $a(Sa,xb,Qb,Ib,$b.Mo))}tXh(Sa){aa.TableCellReader.isTableCell(Sa)&&
(Sa.Sb(1)||this.uK.r7(Sa,!0),Sa.wc())}uXh(Sa,xb){this.S2.Twa(xb)&&(xb.width=Sa.width)}static V_e(Sa){Ua.ra.addHandler("OnParagraphCopy",Sa)}static Vzd(Sa){Ua.ra.addHandler("OnParagraphPaste",Sa)}static r2n(Sa){Ua.ra.removeHandler("OnParagraphPaste",Sa)}static iyk(Sa){Ua.ra.addHandler("OnCopyComplete",Sa)}static oxk(Sa){Ua.ra.addHandler("BeforePaste",Sa)}static L1n(Sa){Ua.ra.removeHandler("BeforePaste",Sa)}static mxk(Sa){Ua.ra.addHandler("BeforeCopy",Sa)}static pxk(Sa){Ua.ra.addHandler("BeforeTrimOnCopy",
Sa)}static gxk(Sa){Ua.ra.addHandler("AfterTrimCompleteOnCopy",Sa)}static get characterPropertiesEditor(){return null!=Ua.Ywg?Ua.Ywg:Ua.Ywg=k.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get ZJ(){return Na.a.instance}static get oi(){return sa.PageReader.instance}static Xsl(Sa){const xb={};for(const Qb of H.a(Sa)){const Ib=Sa[Qb];xb[Ib]=Ib in xb?String.format("{0}|{1}",xb[Ib],Qb):Qb}1<=H.a(xb).length&&E.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",xb)}static IUn(Sa,
xb,Qb,Ib,$b,hc){xb.colSpan>$b-Qb&&(hc&&hc("A",xb.colSpan,$b-Qb),xb.colSpan=$b-Qb);Sa=Ua.yzo(Sa,xb,Ib,Qb);xb.colSpan!==Sa&&(hc&&hc("B",xb.colSpan,Sa),xb.colSpan=Sa)}static JUn(Sa,xb,Qb,Ib,$b,hc){xb.rowSpan>$b-Qb&&(hc&&hc("A",xb.rowSpan,$b-Qb),xb.rowSpan=$b-Qb);Sa=Ua.zzo(Sa,xb,Qb,Ib);xb.rowSpan!==Sa&&(hc&&hc("B",xb.rowSpan,Sa),xb.rowSpan=Sa)}static yzo(Sa,xb,Qb,Ib){return Ua.wtj(Sa,xb.colSpan,($b,hc)=>{na.moveToCell($b,Qb,Ib+hc)})}static zzo(Sa,xb,Qb,Ib){return Ua.wtj(Sa,xb.rowSpan,($b,hc)=>{na.moveToCell($b,
Qb+hc,Ib)})}static wtj(Sa,xb,Qb){if(14!==Sa.type)throw Error.argument("tableNode is not a Table.");if(!Qb)throw Error.argumentNull("MoveToCellAction");for(let $b=1;$b<xb;$b++){var Ib=N.GraphIterator.$a(Sa);Qb(Ib,$b);Ib=Ib.currentNode;if(!Ib||16!==Ib.type||!Ib.hg)return $b}return xb}static tHh(Sa,xb){return Sa+","+xb}lCn(Sa,xb){for(;Sa.target.Pd();)Sa.target.xg();Sa.glc=new f.a(xb,Sa.$0i?Sa.$0i:this.iIc,new Fb.a(Sa.source,Sa.target,null,Sa.sXf));Sa.glc.Jl("ExecuteCorePasteCellContentInCell");Sa.glc.Gh=
!1;Sa.glc.run()}$fn(Sa){let xb=!1;if(ra.TableBorderSelectionCache.nQc()){const Qb=fa.a(Sa.target),Ib=oa.a.Bs(Sa.target);let $b=this.Ale;isNullOrUndefined(Sa.SZa[Sa.SZa.length-1])||($b=Math.min($b,Sa.SZa[Sa.SZa.length-1][0]));let hc=this.xig;isNullOrUndefined(Sa.SZa[Sa.SZa.length-1])||(hc=Math.min(hc,Sa.SZa[Sa.SZa.length-1][1]));aa.TableCellReader.oQa(Sa.target)||aa.TableCellReader.oQa(Sa.source)||Ib==$b&&Qb==hc?xb=!0:(aa.TableCellReader.isTableCell(Sa.target)||Sa.target.jd(16),aa.TableCellReader.lca(Sa.source)?
(aa.TableCellReader.oQa(Sa.target)||(na.moveToNextRow(Sa.target),na.moveToColumnByIndex(Sa.target,Sa.vo),E.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")),na.moveToNextOrPreviousCell(Sa.source,!1,!1)):aa.TableCellReader.lca(Sa.target)||Qb==hc?(na.moveToNextRow(Sa.source),na.moveToColumnByIndex(Sa.source,0),E.ULS.sendTraceTag(537519906,307,50,"Move to next row to replace cell contents"),na.moveToNextRow(Sa.target),na.moveToColumnByIndex(Sa.target,Sa.vo),E.ULS.sendTraceTag(537519907,
307,50,"Move to next row to replace cell contents")):(na.moveToNextOrPreviousCell(Sa.target,!1,!1),na.moveToNextOrPreviousCell(Sa.source,!1,!1)))}else aa.TableCellReader.oQa(Sa.source)?xb=!0:(aa.TableCellReader.isTableCell(Sa.target)||Sa.target.jd(16),aa.TableCellReader.lca(Sa.source)?(na.moveToNextRow(Sa.target),na.moveToColumnByIndex(Sa.target,Sa.vo),E.ULS.sendTraceTag(537716887,307,50,"Move to next row to replace cell contents")):na.moveToNextOrPreviousCell(Sa.target,!1,!1),na.moveToNextOrPreviousCell(Sa.source,
!1,!1));xb&&(this.hZ&&this.hZ.WJn(Sa.target,Sa.SZa),Ma.TableReader.isTable(Sa.target)||Sa.target.jd(14),this.Cin(Sa.target.currentNode),E.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"));return xb}Zoo(){this.Ale=ra.TableBorderSelectionCache.K9.bottomMostRowSelected;this.xig=ra.TableBorderSelectionCache.K9.rightMostColumnSelected;this.GIo=ra.TableBorderSelectionCache.K9.leftMostColumnSelected;this.uyj=ra.TableBorderSelectionCache.K9.topMostRowSelected}}Ua.ra=new y.a;Ua.hzf=
"PasteConstrainingWidth";Object(F.a)(Ua,"InternalClipboard",null,[])},1974:function(F,K,c){F=c(0);var l=c(2),f=c(126),a=c(58),k=c(237),x=c(22),y=c(19),n=c(83),u=c(186),z=c(16),w=c(42),E=c(6),G=c(7),H=c(67),L=c(44),I=c(31),N=c(303),Q=c(86),M=c(12),J=c(5),V=c(103),X=c(18),W=c(36),U=c(244),Y=c(40),ba=c(246),aa=c(21),fa=c(78),na=c(147),oa=c(874),ja=c(3),qa=c(84),Ia=c(61),Va=c(9),Na=c(92),za=c(43),la=c(474),va=c(586),ia=c(211),pa=c(17),sa=c(23),Ha=c(46),ra=c(32),Ma=c(233),ya=c(8),Ga=c(1561),wa=c(1581),
hb=c(292),eb=c(168),jb=c(66),ub=c(503),ab=c(48);class Ea extends hb.a{constructor($a,kb,Ua,Sa,xb,Qb,Ib,$b){super();this.Yeh=this.fw=null;this.init($a);this.Jl("FormattingViewOperation");this.ejb(l.AFrameworkApplication.va,kb,Sa,xb,Qb);this._context=Ua;this.T8a=0;this.Js=!0;this.L3j=Ib;this.Sm=$b}get wba(){return this.Sm.instance}run(){const $a=this._context.view;var kb=null;$a.te&&(kb=$a.lb);if(kb){var Ua=kb.gb.kb,Sa=!wa.a.pac(this.actionId);!Ua||Ea.Wf.lGf(Ua,Sa)?(Ea.Jc.Yb(qa.a.kf,{["Reason"]:Ia.a.WE}),
this.Js=!1):this.wba&&this.wba.Gac(Ua)?(Ea.Jc.Yb(qa.a.kf,{["Reason"]:Ia.a.externalSelection}),this.Js=!1):Ea.Xg.sza(ya.ParagraphReader.kU,kb.tg)&&(Ea.Jc.Yb(qa.a.kf,{["Reason"]:Ia.a.hO}),this.Js=!1)}else Ea.Jc.Yb(qa.a.kf,{["Reason"]:Ia.a.Gca}),this.Js=!1;1!==this.behavior&&this.Js||(this.Js&&(Ua=kb.gb.kb,1===kb.gb.length&&1===Ua.length&&pa.SelectionEditor.nl(Ua.Oa)&&fa.b(Ua.Oa)&&(Ea.Jc.Yb(qa.a.kf,{["Reason"]:Ia.a.IHc}),this.Js=!1)),(Ua=this.Js)&&this.actionId===ja.a.j5&&((Ua=Array.from(kb.gb.kb).some(V.FormattingReader.X9e))||
Ea.Jc.Yb(qa.a.kf,{["Reason"]:Ia.a.ugf})),this.pr=Ua?32:8,this.T8a=3);this.T8a||(eb.a.mark(5730),this.Yeh=ub.SelectionReferenceFactory.instance.FBb(),Ua=kb.gb.kb.Oa,this.fw=new za.GraphTransaction(15),this.fw.Cb(Ua.node),this.fw.jk=this.actionId,this.T8a=1);if(1===this.T8a){this.vC||this.h7c(this._context.gk);if(1===this.q5a())return;this.T8a=2}if(2===this.T8a){if(this.actionId===ja.a.j5)if(kb=kb.tg,kb.$w)for(Ua=0;Ua<kb.length;Ua++)Sa=kb.getContext(Ua),this.BDj(Sa);else this.BDj(kb);ab.a.k$e&&this.ePo(this.actionId,
this.xd);this.Yeh.dqa(this.actionId===ja.a.GY||this.actionId===ja.a.gua);(kb=Object(H.a)(29,this.xd))&&!kb.qTa||jb.FocusManager.instance().mg($a.hJ);this.fw.dispose();this.fw=null;Va.App.xa.updateCommandUI();eb.a.mark(5731);this.T8a=3;this.pr=32}3===this.T8a&&(this.L3j.process(this.actionId,this._context,this.behavior,this.response),this.tqa())}ePo($a,kb){const Ua={};Ua.FormattingActionId=$a;Ua.FormattingActionData=kb;8===this.ga.Qb(ja.a.XAd,2,Ua)&&G.ULS.sendTraceTag(509110153,368,10,"Command applyFormattingToContentControls failed! ActionId '{0}', ActionData '{1}'",
$a,kb)}BDj($a){(pa.SelectionEditor.mv($a)||pa.SelectionEditor.Hk($a))&&Va.App.iN.wda($a.node)}static get Wf(){return Ma.a.instance}static get Xg(){return ia.ContextSetEditor.instance}static get Jc(){return u.a.instance}}Object(F.a)(Ea,"FormattingViewOperation",hb.a,[]);var Wa=c(1032),Bb=c(940),Mb=c(72);c.d(K,"a",function(){return vb});const Fb=new Set([ja.a.K_,ja.a.Z0,ja.a.clearFormatting,ja.a.JCa,ja.a.KCa,ja.a.PZa,ja.a.eua,ja.a.QZa]);class vb{constructor($a,kb,Ua=null,Sa,xb,Qb,Ib,$b,hc,pb,dc,Ob,
Vb){this.kpiName="ChangeCaseCommandUsage";this.h8="wwaengidc";this.Hkb=new Map;this.W5g=new Set;this.ODb=()=>new oa.a(2);this.C5i=(ob,Xb,Xa,Pb,rc)=>{Pb=!0;Xb.contextId!==M.a.view&&(Pb=!1);if(1===Xa&&!Pb)return 8;if(ob===ja.a.X2c)ob=rc.formatting,rc=rc.yfg;else{if(!Xb.view||!Xb.view.te)return 2;Xb=Xb.view;if(!Xb.lb||!Xb.lb.gb.kb)return 8;ob=rc;rc=Xb.lb.gb}this.Z3k(rc,ob);return 32};this.H1e=(ob,Xb,Xa,Pb,rc,Ta)=>new Ea(ob,Xb,Xa,Pb,rc,Ta,this.r4j,vb.Zw());this.UAd=(ob,Xb,Xa,Pb,rc)=>{var Ta,Ab,Db;let ac=
!0,Pa=Xb;const bb=!wa.a.pac(ob);Xb.contextId!==M.a.Hd&&Xb.contextId!==M.a.Tc?ac=!1:(vb.Wf.M8(Pa,!1,bb)&&(vb.Jc.Yb(qa.a.fn,{["Reason"]:Ia.a.WE}),ac=!1),vb.Zw()&&vb.Zw().instance&&vb.Zw().instance.pU(Pa)&&(ac=!1),ac&&pa.SelectionEditor.nl(Xb)&&fa.b(Pa)&&(vb.Jc.Yb(qa.a.fn,{["Reason"]:Ia.a.IHc}),ac=!1),ya.ParagraphReader.kU(Xb)&&(vb.Jc.Yb(qa.a.kf,{["Reason"]:Ia.a.hO}),ac=!1));if(1===Xa||!ac)return ac?32:8;if(Xb.contextId===M.a.Tc)return 2;(Xb=null===(Ta=this.Co)||void 0===Ta?void 0:Ta.FRd(Pa))&&(Pa=Xb);
this.Cvo(ob)&&(Ta=pa.SelectionEditor.EQb(Pa),pa.SelectionEditor.gf(Ta)||(Pa=Ta));Ta="boolean"===typeof rc&&rc;Xb=!1;(null===(Ab=this.L$)||void 0===Ab?0:Ab.annotateRange)&&(null===(Db=this.L$)||void 0===Db?0:Db.Dbc(Pa.node))&&(Xb=this.YZ(Pa,ob,rc,Ta));Xb&&ob!==ja.a.j5||vb.Sqa.YZ(Pa,lc=>{this.djc(lc,ob,rc,Pa.cpEnd)},Ta);Pa.node.xr&&(Ab=[Object.assign(new I.a,{name:"Source",string:"CharacterFormatting"})],L.a("TOCFormatting",!0,void 0,Ab));this.QHm(ob)&&this.pDd(Pa,ob);Pb&&Ga.a.Qpb&&(Pb.xs|=Ga.a.zhb(Pa.node));
return 32};this.R$c=(ob,Xb,Xa)=>1!==Xa&&2===Xa?(this.Hkb.set("Source","Shortcut"),ob=Xb.node.characterData.substr(Xb.cpBegin,Xb.cpEnd-Xb.cpBegin),vb.GGf(ob,0,ob.length)?this.pDd(Xb,ja.a.JCa):vb.KTm(ob,ob.length)?this.pDd(Xb,ja.a.eua):this.pDd(Xb,ja.a.KCa)):32;this.Meb=(ob,Xb,Xa)=>{let Pb=!0;ob=!wa.a.pac(ob);Xb.contextId!==M.a.Hd&&Xb.contextId!==M.a.Tc?Pb=!1:(vb.Wf.M8(Xb,!1,ob)&&(vb.Jc.Yb(qa.a.fn,{["Reason"]:Ia.a.WE}),Pb=!1),Pb&&pa.SelectionEditor.nl(Xb)&&fa.b(Xb)&&(vb.Jc.Yb(qa.a.fn,{["Reason"]:Ia.a.IHc}),
Pb=!1),Pb&&ya.ParagraphReader.kU(Xb)&&(vb.Jc.Yb(qa.a.kf,{["Reason"]:Ia.a.hO}),Pb=!1));if(1===Xa||!Pb)return Pb?32:8;Xb=Xb.node;this.Ms.$2b(Xb,!1);Xb.xr&&(Xb=[Object.assign(new I.a,{name:"Source",string:"ClearFormatting"})],L.a("TOCFormatting",!0,void 0,Xb));return 32};this.JGc=(ob,Xb,Xa,Pb,rc)=>{ob={};ob[Wa.a.XIa]=6168;ob[Wa.a.WIa]=6169;const Ta=Xb.view;var Ab=null;Ta.Wi&&(Ab=Ta);var Db=!0;let ac=32;Ab&&(Ab=Ab.lb.gb.kb)&&(vb.Wf.lGf(Ab)?(vb.Jc.Yb(qa.a.kf,{["Reason"]:Ia.a.WE}),ac=8,Db=!1):1===Xa&&(ac=
32,Db=!1));Db&&(Db=new za.GraphTransaction(1===Xa?3:15),Db.Cb(Ta.root),ac=Wa.a.Ipa(ja.a.Meb,Xb,Xa,Pb,rc,ob,12),Db.dispose());return ac};this.P1e=(ob,Xb,Xa,Pb,rc)=>{var Ta,Ab=!0,Db=32;const ac=!wa.a.pac(ob);Xb.contextId!==M.a.Tc?Ab=!1:vb.Wf.M8(Xb,!1,ac)&&(vb.Jc.Yb(qa.a.fn,{["Reason"]:Ia.a.WE}),Ab=!1);if(1===Xa||!Ab)return Ab?32:8;Xa=Xb.node;ob===ja.a.clearFormatting&&(vb.Un.KGc(Xa),this.Ms.SEh(Xa),Ab=this.Xy.NC(Xa).Di(this.Xy.wordStyleIdNormal),this.Vu.RJ(Ab,Xa,!0));Xa=vb.tj.fuf(Xb);!Xa&&(Ab=null===
(Ta=this.Co)||void 0===Ta?void 0:Ta.FRd(Xb))&&(Xb=Ab,Xa=sa.SelectionFactory.Nn(Xb));if(Xa)Db=Ha.a.ABb(Xa),Db=l.AFrameworkApplication.va.Mf(Db,ob,2,!1,Pb,rc);else{Pb=Object(H.a)(29,rc);Ta=V.FormattingReader.Nr(Xb);if(!Ta)return 16;Ta=Ta.cache;switch(ob){case ja.a.font:vb.Z0h();if(Pb&&Pb.xd){const {fontName:Pa,Jda:bb,bold:lc,italic:rb}=vb.wqf(Pb.xd);vb.tj.Sge(Pa);vb.tj.fcg(bb);Object(la.a)()&&(ob=1==lc,rc=1==rb,ob||rc)&&(vb.tj.sL(ob),vb.tj.setItalic(rc))}break;case ja.a.Uv:G.ULS.sendTraceTag(595153824,
340,50,"Font color is selected from Standard/Theme colors.");vb.tj.Uv(rc);break;case ja.a.sqa:vb.tj.Uv(rc);this.recentColors.bZa(rc)||G.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ja.a.Lfa:vb.tj.Lfa();break;case ja.a.GY:G.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors.");vb.tj.Dya(rc);break;case ja.a.P9:vb.tj.Dya(rc);this.recentColors.bZa(rc)||G.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");
break;case ja.a.gua:vb.tj.WDd();break;case ja.a.UA:vb.Z0h();vb.tj.UA(Pb.xd);break;case ja.a.K_:ob=vb.tj.zG(z.a.fontSize,Ta.fontSize);vb.tj.UA(this.Ce.K_(ob));break;case ja.a.Z0:ob=vb.tj.zG(z.a.fontSize,Ta.fontSize);vb.tj.UA(this.Ce.Z0(ob));break;case ja.a.bold:ob=vb.tj.zG(z.a.bold,Ta.isBold);vb.tj.sL(!ob);break;case ja.a.setItalic:ob=vb.tj.zG(z.a.italic,Ta.isItalic);vb.tj.setItalic(!ob);break;case ja.a.underline:ob=vb.tj.zG(z.a.underline,Ta.isUnderline);vb.tj.m5(!ob);break;case ja.a.aja:vb.tj.aja(rc);
break;case ja.a.superscript:ob=vb.tj.zG(z.a.superscript,Ta.isSuperscript);vb.tj.vqa(!ob);break;case ja.a.subscript:ob=vb.tj.zG(z.a.subscript,Ta.isSubscript);vb.tj.GHa(!ob);break;case ja.a.strikethrough:ob=vb.tj.zG(z.a.strikethrough,Ta.isStrikethrough);vb.tj.Yia(!ob);break;case ja.a.zt:ob=vb.tj.zG(w.a.zt,Ta.isDoubleStrikethrough);vb.tj.Mge(!ob);break;case ja.a.clearFormatting:vb.tj.W5a();break;case ja.a.j5:rc.hasProperty(z.a.gL)&&vb.tj.j5(rc.getValue(z.a.gL));rc.hasProperty(E.a.noProof)&&(ob=rc.getValue(E.a.noProof),
vb.tj.amo(ob));break;default:this.W5g.has(ob)||(this.W5g.add(ob),(rc=f.ActionManager.Gaa(ob))&&rc.length||(rc="UnknownAction"),G.ULS.sendTraceTag(523120736,324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${rc} (${ob})`))}}Va.App.xa.updateCommandUI();return Db};this.gT=(ob,Xb,Xa,Pb,rc)=>{Pb=vb.Jc.yp(ja.a.Wio);var Ta=!0;Xb.contextId!==M.a.endOfParagraph&&(Ta=!1);if(1===Xa||!Ta)return Ta?32:8;Xa=Xb.node;Ta=J.GraphIterator.$a(Xb.node);Ta.vd();Ta=Ta.aha(4);if((Ta=!!Ta&&vb.Gd.mca(Ta))&&
!Va.App.fdc)return 8;var Ab=!ya.ParagraphReader.textLength(Xa);Pb.properties.Z("Action",ob.toString());Pb.properties.Z("ListContext",Ta.toString());Pb.properties.Z("IsEmptyParagraph",Ab.toString());G.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",ob,Ta,Ab);Ta=Xa.pa.last;this.$0n(Xa,ob);var Db=!!Ta.formatting;const ac=Xa.getValue(E.a.endOfParagraphFormatting);Ab=this.Kd.j0a(Xa);Db=!Db&&ac&&ac.equals(a.a.nil)?new na.a(Ta,a.a.nil):Ab.Df(Ab.Ib);this.djc(Ab,
ob,rc,Ta.cp);Q.a.instance.J(1)&&vb.nj.nOb(Xa,Ta,Xb.cpBegin,Xb.cpEnd,Db,Ab,vb.Ld.rg);Pb.end();return 32};this.Xla=(ob,Xb,Xa)=>{ob=!0;const Pb=J.GraphIterator.$a(Xb.node);Pb.vd();Xb.contextId===M.a.endOfParagraph&&Pb.aha(4)||(vb.Jc.Yb(qa.a.fn,{["Reason"]:Ia.a.QJf}),ob=!1);return vb.Gd.mca(Pb.currentNode)?1!==Xa&&ob?32:ob?32:8:8};this.Upa=(ob,Xb,Xa,Pb,rc)=>{ob=!0;Xb.contextId!==M.a.paragraph&&(ob=!1);if(1===Xa&&!ob)return 8;Xa=Xb.node;-1!==rc.Hh?rc.Hh!==ya.ParagraphReader.Gx(Xa)&&(rc.Hh=0):rc.Hh=ya.ParagraphReader.Gx(Xa);
ob=this.Xo.Qhb(Xa);rc.Ft?(!rc.vrm&&this.yrm(rc.Ft,ob)&&2===rc.Ft.specialIndentType&&(rc.Ft.specialIndentType=0),rc.Ft.DGb===ob.DGb&&k.a.Awa(rc.Ft.AB,ob.AB)||(rc.Ft.AB=Number.MAX_VALUE),rc.Ft.EGb===ob.EGb&&k.a.Awa(rc.Ft.joa,ob.joa)||(rc.Ft.joa=Number.MAX_VALUE)):rc.Ft=ob;Xb=vb.Xg.Svh(Xb.gk);void 0!==Xb&&null!==Xb&&(Xb=Xb.node,void 0!==Xb&&null!==Xb&&(Xb=U.WordSectionNavigator.instance.GJ(Xb),void 0!==Xb&&null!==Xb&&(Xb=vb.Sf.At(Xb)-(vb.Sf.nJ(Xb)+vb.Sf.$K(Xb)+Va.App.wza),ob.wSc=Xb-ob.AB,ob.vSc=Xb-ob.joa,
rc.Ft.vSc=Math.min(rc.Ft.vSc,ob.vSc),rc.Ft.wSc=Math.min(rc.Ft.wSc,ob.wSc))));Xb=this.$V.yEa(Xa);rc.spacing?(rc.spacing.beforeSpacing=vb.Erh(Xb.beforeSpacing,rc.spacing.beforeSpacing),rc.spacing.afterSpacing=vb.Erh(Xb.afterSpacing,rc.spacing.afterSpacing),rc.spacing.lineSpacing.unit===Xb.lineSpacing.unit&&k.a.Awa(rc.spacing.lineSpacing.value,Xb.lineSpacing.value)||(rc.spacing.lineSpacing.unit=0,rc.spacing.lineSpacing.value=0)):rc.spacing=Xb;Xb=new J.GraphIterator;Xb.set(Xa);Xb.zb(11);if(Xa=Xb.jd(11))rc.isRtl=
Y.OutlineElementReader.$m(Xa);Xa=vb.Gd.qw(Xb);Xb=16;void 0!==Xa&&null!==Xa&&(Xb=Xa.listType);rc.listType=vb.MTl(rc.listType,Xb);rc.Mx=16===rc.listType?null:Xa;return 32};this.HMn=(ob,Xb,Xa,Pb,rc)=>{rc.isRtl=Y.OutlineElementReader.$m(W.OutlineElementNavigator.Gl(Xb.node));return 32};this.Euh=(ob,Xb,Xa)=>{if(ob===ja.a.JOb)ob=!0;else if(ob===ja.a.IOb)ob=!1;else return 2;ob&&this.eLi(Xb);if(1===Xa)return 32;this.nh.zOb(W.OutlineElementNavigator.Gl(Xb.node),ob);return 32};this.xMn=(ob,Xb,Xa,Pb,rc)=>{ob=
Xb.node;rc.isRtl=Y.OutlineElementReader.isRtl(W.OutlineElementNavigator.Gl(ob));rc.Hh=X.ImageReader.Gx(ob);return 32};this.HNn=(ob,Xb,Xa,Pb,rc)=>{ob=Xb.node;rc.isRtl=Y.OutlineElementReader.isRtl(W.OutlineElementNavigator.Gl(ob));rc.Hh=ra.TableReader.Gx(ob);-1!==rc.Hh&&rc.Hh||(rc.Hh=rc.isRtl?3:1);return 32};this.Z1e=(ob,Xb,Xa,Pb,rc)=>{let Ta;if(!({ly:Ta}=wa.a.pdg(Xa,Xb)).returnValue)return Ta;const Ab=Xb.node;switch(ob){case ja.a.IOb:this.nh.zjc(Ab,!1);break;case ja.a.JOb:this.eLi(Xb);this.nh.zjc(Ab,
!0);break;case ja.a.j5:Ta=l.AFrameworkApplication.va.Mf(Xb.gk,ob,Xa,!0,Pb,rc),32===Ta&&ya.ParagraphReader.lm(Xb)&&vb.E2c&&vb.E2c.wda(Ab)}return 32};this.WYk=(ob,Xb,Xa,Pb,rc)=>{const Ta={};Ta[Wa.a.XIa]=6168;Ta[Wa.a.WIa]=6169;var Ab=Xb.view;const Db=new za.GraphTransaction(1===Xa?3:15);Db.Cb(Ab.root);let ac=Wa.a.Ipa(ob,Xb,Xa,Pb,rc,Ta,0),Pa=null;Ab.Wi&&(Pa=Ab);Ab=!0;let bb=null;Pa&&(bb=Pa.lb.gb.kb)&&(ob=!wa.a.pac(ob),vb.Wf.lGf(bb,ob)?(vb.Jc.Yb(qa.a.kf,{["Reason"]:Ia.a.WE}),ac=8,Ab=!1):1===Xa&&(ac=32,
Ab=!1),vb.Xg.sza(ya.ParagraphReader.kU,Pa.lb.tg)&&(vb.Jc.Yb(qa.a.kf,{["Reason"]:Ia.a.hO}),ac=8,Ab=!1));Ab&&this.PTm(bb)&&(ac=Wa.a.Ipa(ja.a.Meb,Xb,Xa,Pb,rc,Ta,12));Db.dispose();return ac};this.VYk=(ob,Xb,Xa)=>{ob=!0;Xb.contextId!==M.a.paragraph&&Xb.contextId!==M.a.Tc?ob=!1:vb.Wf.n3a(Xb)&&(vb.Jc.Yb(qa.a.fn,{["Reason"]:Ia.a.WE}),ob=!1);if(1===Xa||!ob)return ob?32:8;Xb=Xb.node;Xa=new za.GraphTransaction(15);Xa.Cb(Xb);vb.Un.KGc(Xb);this.Ms.$2b(Xb,!0);this.Vu.U7e(Xb);Xa.dispose();return 2};this.Wmm=(ob,
Xb,Xa)=>{ob=!0;Xb.contextId!==M.a.view&&(ob=!1);if(1===Xa&&!ob)return 8;if(!Xb.view||!Xb.view.te)return 2;Xb=Xb.view;if(!Xb.lb||!Xb.lb.gb.kb)return 8;if(vb.Xg.sza(ya.ParagraphReader.kU,Xb.lb.tg))return vb.Jc.Yb(qa.a.kf,{["Reason"]:Ia.a.hO}),8;Xb=Xb.lb.gb;for(const Pb of Xb)for(const rc of Pb)if(rc&&rc.contextId!==M.a.Hd&&rc.contextId!==M.a.Tc&&rc.contextId!==M.a.paragraph&&rc.contextId!==M.a.endOfParagraph)return 2;return 32};this.w5a=(ob,Xb,Xa,Pb,rc)=>{ob=!0;Xb.contextId!==M.a.paragraph&&(ob=!1);
if(1===Xa&&!ob)return 8;rc.Ft||(Xb=Xb.node,Xa=this.Xo.Qhb(Xb),rc.Ft=Xa,Xb=W.OutlineElementNavigator.Gl(Xb),rc.isRtl=Xb?Y.OutlineElementReader.$m(Xb):!1);return 32};this.INn=(ob,Xb,Xa,Pb,rc)=>{Xb=Xb.node;ob=W.OutlineElementNavigator.Gl(Xb);rc.Ft||(Xb=this.g8l(Xb),Xb=this.Xo.Qhb(Xb),rc.Ft=Xb,rc.isRtl=Y.OutlineElementReader.isRtl(ob));return 32};this.r4j=$a;this.L$=kb;this.v6=Ua;this.Co=Sa;this.Ce=xb;this.Kd=Qb;this.Ms=Ib;this.$V=$b;this.Vu=pb;this.Xy=hc;this.nh=dc;this.Xo=Vb}get recentColors(){return null!=
this.fGg?this.fGg:this.fGg=x.a.instance.Na("Box4.UI.RecentColorsSectionHandler")}get dNd(){return!!this.v6&&this.v6.enabled}Tb(){const $a=l.AFrameworkApplication.va,kb=this.HMn;(vb.Xb?vb.Xb.GB(42):l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled"))?($a.qa(ja.a.font,M.a.endOfParagraph,this.gT),$a.qa(ja.a.UA,M.a.endOfParagraph,this.gT),$a.qa(ja.a.K_,M.a.endOfParagraph,this.gT),$a.qa(ja.a.Z0,M.a.endOfParagraph,this.gT),$a.qa(ja.a.Uv,M.a.endOfParagraph,this.gT),
$a.qa(ja.a.sqa,M.a.endOfParagraph,this.gT),$a.qa(ja.a.Lfa,M.a.endOfParagraph,this.gT),$a.qa(ja.a.GY,M.a.endOfParagraph,this.gT),$a.qa(ja.a.P9,M.a.endOfParagraph,this.gT),$a.qa(ja.a.gua,M.a.endOfParagraph,this.gT),$a.qa(ja.a.bold,M.a.endOfParagraph,this.gT),$a.qa(ja.a.setItalic,M.a.endOfParagraph,this.gT),$a.qa(ja.a.underline,M.a.endOfParagraph,this.gT),$a.qa(ja.a.aja,M.a.endOfParagraph,this.gT),$a.qa(ja.a.superscript,M.a.endOfParagraph,this.gT),$a.qa(ja.a.subscript,M.a.endOfParagraph,this.gT),$a.qa(ja.a.strikethrough,
M.a.endOfParagraph,this.gT),$a.qa(ja.a.zt,M.a.endOfParagraph,this.gT),$a.qa(ja.a.j5,M.a.endOfParagraph,this.gT),$a.qa(ja.a.clearFormatting,M.a.endOfParagraph,this.gT)):Va.App.fdc&&($a.qa(ja.a.font,M.a.endOfParagraph,this.Xla),$a.qa(ja.a.UA,M.a.endOfParagraph,this.Xla),$a.qa(ja.a.Uv,M.a.endOfParagraph,this.Xla),$a.qa(ja.a.sqa,M.a.endOfParagraph,this.Xla),$a.qa(ja.a.Lfa,M.a.endOfParagraph,this.Xla),$a.qa(ja.a.bold,M.a.endOfParagraph,this.Xla),$a.qa(ja.a.setItalic,M.a.endOfParagraph,this.Xla),$a.qa(ja.a.superscript,
M.a.endOfParagraph,this.Xla),$a.qa(ja.a.subscript,M.a.endOfParagraph,this.Xla),$a.qa(ja.a.strikethrough,M.a.endOfParagraph,this.Xla),$a.qa(ja.a.zt,M.a.endOfParagraph,this.Xla),$a.qa(ja.a.K_,M.a.endOfParagraph,this.Xla),$a.qa(ja.a.Z0,M.a.endOfParagraph,this.Xla));const Ua=Va.App.WTa.tIc(Sa=>va.OutlineElementGeneralizer.tna(Sa.gb,!0));$a.eb(ja.a.V6e,M.a.view,this.Wmm,100);$a.eb(ja.a.R$c,M.a.Hd,this.R$c,1028);$a.qa(ja.a.t5a,M.a.view,this.C5i);$a.qa(ja.a.X2c,M.a.view,this.C5i);$a.qa(ja.a.Upa,M.a.view,
Ua);$a.qa(ja.a.Upa,M.a.paragraph,this.Upa);$a.qa(ja.a.Upa,M.a.image,this.xMn);$a.qa(ja.a.Upa,M.a.unsupportedObject,kb);$a.qa(ja.a.Upa,M.a.table,this.HNn);$a.qa(ja.a.w5a,M.a.view,Ua);$a.qa(ja.a.w5a,M.a.paragraph,this.w5a);$a.qa(ja.a.w5a,M.a.table,this.INn);$a.Vc(ja.a.t5a,99);$a.Vc(ja.a.X2c,1127);$a.Vc(ja.a.Upa,97);$a.Vc(ja.a.w5a,97);this.cM($a,ja.a.font);this.cM($a,ja.a.UA);this.cM($a,ja.a.K_);this.cM($a,ja.a.Z0);$a.Cdb(ja.a.w1h,M.a.view,this.H1e);$a.Vc(ja.a.w1h,1092);this.cM($a,ja.a.Uv);this.cM($a,
ja.a.sqa);this.cM($a,ja.a.Lfa);this.cM($a,ja.a.GY);this.cM($a,ja.a.P9);this.cM($a,ja.a.PZa);this.cM($a,ja.a.JCa);this.cM($a,ja.a.KCa);this.cM($a,ja.a.eua);this.cM($a,ja.a.QZa);this.cM($a,ja.a.gua);this.cM($a,ja.a.bold);$a.fOb(ja.a.bold,this.ODb);this.cM($a,ja.a.setItalic);$a.fOb(ja.a.setItalic,this.ODb);this.cM($a,ja.a.underline);$a.fOb(ja.a.underline,this.ODb);this.cM($a,ja.a.aja);this.cM($a,ja.a.superscript);$a.fOb(ja.a.superscript,this.ODb);this.cM($a,ja.a.subscript);$a.fOb(ja.a.subscript,this.ODb);
this.cM($a,ja.a.strikethrough);$a.fOb(ja.a.strikethrough,this.ODb);this.cM($a,ja.a.zt);$a.fOb(ja.a.zt,this.ODb);$a.eb(ja.a.YPa,M.a.Hd,this.UAd,96);$a.Cdb(ja.a.j5,M.a.view,this.H1e);$a.qa(ja.a.j5,M.a.paragraph,this.Z1e);$a.qa(ja.a.j5,M.a.Hd,this.UAd);$a.qa(ja.a.j5,M.a.Tc,this.P1e);$a.qa(ja.a.clearFormatting,M.a.view,this.WYk);$a.qa(ja.a.clearFormatting,M.a.paragraph,this.VYk);$a.qa(ja.a.clearFormatting,M.a.Hd,this.UAd);$a.qa(ja.a.clearFormatting,M.a.Tc,this.P1e);$a.Vc(ja.a.clearFormatting,1036);$a.qa(ja.a.Meb,
M.a.Hd,this.Meb);$a.qa(ja.a.Meb,M.a.Tc,this.Meb);$a.qa(ja.a.JGc,M.a.view,this.JGc);$a.qa(ja.a.IOb,M.a.view,wa.a.gw);$a.qa(ja.a.IOb,M.a.paragraph,this.Z1e);$a.qa(ja.a.IOb,M.a.unsupportedObject,this.Euh);$a.Vc(ja.a.IOb,1028);$a.qa(ja.a.JOb,M.a.view,wa.a.gw);$a.qa(ja.a.JOb,M.a.paragraph,this.Z1e);$a.qa(ja.a.JOb,M.a.unsupportedObject,this.Euh);$a.Vc(ja.a.JOb,1028)}cM($a,kb){$a.Cdb(kb,M.a.view,this.H1e);$a.qa(kb,M.a.Hd,this.UAd);$a.qa(kb,M.a.Tc,this.P1e);$a.Vc(kb,1036)}Z3k($a,kb){for(const $b of $a)for(const hc of $b){$a=
null;if(hc.contextId===M.a.Hd){if(fa.b(hc))continue;$a=[];var Ua=hc.node.pa;if(Ua){var Sa=Ua.length-1;const pb=hc.cpBegin,dc=hc.cpEnd;let Ob=!1;const Vb=hc.node.characterData;if(Vb&&""!==Vb){var xb=Vb.substr(pb,dc-pb);xb&&""!==xb&&y.a.f$e(xb,0,xb.length)&&(Ob=!0)}xb=!1;for(let ob=0;ob<Sa;ob++){var Qb=Ua.J(ob).cp,Ib=Ua.J(ob+1).cp;if(Ua.J(ob).formatting&&Math.max(Qb,pb)<Math.min(Ib,dc)){if(Vb&&""!==Vb&&(Qb=Qb<pb?pb:Qb,Ib=Vb.substr(Qb,(Ib<dc?Ib:dc)-Qb),!Ob&&y.a.f$e(Ib,0,Ib.length)))continue;xb=!0;$a.push(Ua.J(ob).formatting)}else if(xb)break}Ua.J(Sa).formatting&&
hc.cpEnd>Ua.J(Sa).cp&&$a.push(Ua.J(Sa).formatting)}}else if(hc.contextId===M.a.paragraph&&!ya.ParagraphReader.kU(hc)){if($a=[],Ua=hc.node.pa)for(Sa=0;Sa<Ua.length;Sa++)Ua.J(Sa).formatting&&$a.push(Ua.J(Sa).formatting)}else if(hc.contextId===M.a.endOfParagraph)$a=[V.FormattingReader.Nr(hc)];else if(hc.contextId===M.a.Tc){this.gMn(hc,kb);return}if($a&&0<$a.length)for(const pb of $a)if(V.FormattingReader.nmg(kb,pb.cache,hc))return}}gMn($a,kb){if($a=V.FormattingReader.Nr($a)){$a=$a.cache;var Ua=vb.tj.zG(z.a.bold,
$a.isBold);kb.bold=Ua?1:0;Ua=vb.tj.zG(z.a.italic,$a.isItalic);kb.italic=Ua?1:0;Ua=vb.tj.zG(z.a.underline,$a.isUnderline);kb.underline=Ua?1:0;kb.underlineType=vb.tj.zG(z.a.underlineType,$a.underlineType);Ua=vb.tj.zG(z.a.superscript,$a.isSuperscript);kb.superscript=Ua?1:0;Ua=vb.tj.zG(z.a.subscript,$a.isSubscript);kb.subscript=Ua?1:0;Ua=vb.tj.zG(z.a.strikethrough,$a.isStrikethrough);kb.strikethrough=Ua?1:0;Ua=vb.tj.zG(w.a.zt,$a.isDoubleStrikethrough);kb.zt=Ua?1:0;Ua=vb.tj.zG(z.a.font,$a.tG);kb.fontName=
Na.a.c1a(Ua);kb.Jda=$a.He;kb.fontSize=vb.tj.zG(z.a.fontSize,$a.fontSize);kb.fontColor=vb.tj.zG(z.a.fontColor,$a.fontColor);kb.highlight=vb.tj.zG(z.a.highlight,$a.highlight)}}Cvo($a){return $a===ja.a.underline||$a===ja.a.aja||$a===ja.a.strikethrough||$a===ja.a.zt||$a===ja.a.GY}static wqf($a){return"string"===typeof $a?{fontName:$a,Jda:-1,bold:2,italic:2}:$a}YZ($a,kb,Ua,Sa){var xb;const Qb=$a.cpBegin,Ib=$a.cpEnd,$b=$a.node;var hc=V.FormattingReader.Nr($a);let pb=Qb;const dc=null===(xb=l.AFrameworkApplication.K)||
void 0===xb?void 0:xb.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);xb=vb.Ld.rg;if(dc&&(xb||$b.Vs))return!1;if(Fb.has(kb))for(const Ob of $b.pa)if(!(Ob.cp<=Qb)){if(Ob.cp>=Ib)break;Ob.formatting&&Ob.formatting.cache.fontSize!=hc.cache.fontSize&&(hc=this.Bqf($a.node,hc,kb,Ua,dc?null:Sa),this.L$.annotateRange($a.node,dc?$b.pa.Y_a(pb):pb,dc?$b.pa.Y_a(Ob.cp):Ob.cp,hc),pb=Ob.cp,hc=Ob.formatting)}kb=this.Bqf($a.node,hc,kb,Ua,dc?null:Sa);this.L$.annotateRange($a.node,dc?
$b.pa.Y_a(pb):pb,dc?$b.pa.Y_a(Ib):Ib,kb);return!0}Bqf($a,kb,Ua,Sa,xb){const Qb={},Ib=Object(H.a)(29,Sa),$b=kb.cache;switch(Ua){case ja.a.bold:2===Sa.value&&(Sa.value=$b.isBold?0:1);Qb[z.a.bold.id]=1===Sa.value;break;case ja.a.setItalic:2===Sa.value&&(Sa.value=$b.isItalic?0:1);Qb[z.a.italic.id]=1===Sa.value;break;case ja.a.underline:2===Sa.value&&(Sa.value=$b.isUnderline?0:1);Qb[z.a.underline.id]=1===Sa.value;break;case ja.a.aja:Qb[z.a.underlineType.id]=Sa.number;break;case ja.a.superscript:2===Sa.value&&
(Sa.value=$b.isSuperscript?0:1);Qb[z.a.superscript.id]=1===Sa.value;1===Sa.value&&(Qb[z.a.subscript.id]=!1);break;case ja.a.subscript:2===Sa.value&&(Sa.value=$b.isSubscript?0:1);Qb[z.a.subscript.id]=1===Sa.value;1===Sa.value&&(Qb[z.a.superscript.id]=!1);break;case ja.a.strikethrough:6!==l.AFrameworkApplication.va.xC?G.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):G.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===Sa.value&&(Sa.value=
$b.isStrikethrough?0:1);Qb[z.a.strikethrough.id]=1===Sa.value;break;case ja.a.zt:2===Sa.value&&(Sa.value=$b.isDoubleStrikethrough?0:1);Qb[w.a.zt.id]=1===Sa.value;break;case ja.a.font:if(Ib&&Ib.xd){const {fontName:pb,Jda:dc,bold:Ob,italic:Vb}=vb.wqf(Ib.xd);Sa=pb.substr(0,vb.GNi);this.dNd&&(Qb[E.a.hT.id]=Sa,Qb[E.a.BC.id]=Sa,Qb[E.a.j_.id]=Sa,Qb[E.a.N_.id]=Sa,Qb[E.a.Ke.id]=dc,Qb[E.a.Ye.id]=dc,Qb[E.a.Je.id]=dc,Qb[E.a.Le.id]=dc);Qb[z.a.font.id]=Sa;Qb[E.a.He.id]=dc;if(Object(la.a)()){Sa=1==Ob;var hc=1==
Vb;if(Sa||hc)Qb[z.a.bold.id]=Sa,Qb[z.a.italic.id]=hc}}break;case ja.a.Uv:Sa=Bb.a.instance.nua($a,Sa);Qb[z.a.fontColor.id]=Sa;break;case ja.a.sqa:hc=Bb.a.instance.nua($a,Sa);Qb[z.a.fontColor.id]=hc;this.recentColors.bZa(Sa)||G.ULS.sendTraceTag(529006977,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ja.a.Lfa:Qb[z.a.fontColor.id]=Mb.a.auto;break;case ja.a.GY:Qb[z.a.highlight.id]=parseInt(Sa,16);break;case ja.a.P9:Qb[z.a.highlight.id]=parseInt(Sa,16);this.recentColors.bZa(Sa)||
G.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ja.a.gua:Qb[z.a.highlight.id]=Mb.a.auto;break;case ja.a.UA:Qb[z.a.fontSize.id]=this.Ce.z3b(Ib.xd);break;case ja.a.K_:Qb[z.a.fontSize.id]=this.h0l($b.fontSize);break;case ja.a.Z0:Qb[z.a.fontSize.id]=this.zUl($b.fontSize);break;case ja.a.YPa:if(Sa=null===(hc=vb.Yz)||void 0===hc?void 0:hc.YPa)for(const pb of Sa.Hl())Qb[pb.id]=Sa.Gf(pb);break;case ja.a.clearFormatting:if(Sa=kb.yn)for(const pb of Sa.Hl())Qb[pb.id]=
null;Qb[E.a.OAb.id]=!0;break;case ja.a.JCa:case ja.a.KCa:case ja.a.PZa:case ja.a.eua:case ja.a.QZa:$b.wPa&&2===$b.capitalization&&(Qb[w.a.capitalization.id]=0)}null!=xb&&(Qb[l.AFrameworkApplication.Dmf]=xb);return Qb}h0l($a){$a=this.Ce.K_($a);return this.Ce.z3b($a)}zUl($a){$a=this.Ce.Z0($a);return this.Ce.z3b($a)}djc($a,kb,Ua,Sa){var xb=$a.cache;const Qb=Object(H.a)(29,Ua);switch(kb){case ja.a.bold:2===Ua.value&&(Ua.value=xb.isBold?0:1);this.Ce.sL($a,1===Ua.value);break;case ja.a.setItalic:2===Ua.value&&
(Ua.value=xb.isItalic?0:1);this.Ce.setItalic($a,1===Ua.value);break;case ja.a.underline:2===Ua.value&&(Ua.value=xb.isUnderline?0:1);this.Ce.m5($a,1===Ua.value);break;case ja.a.aja:this.Ce.aja($a,Ua);break;case ja.a.superscript:2===Ua.value&&(Ua.value=xb.isSuperscript?0:1);this.Ce.vqa($a,1===Ua.value);break;case ja.a.subscript:2===Ua.value&&(Ua.value=xb.isSubscript?0:1);this.Ce.GHa($a,1===Ua.value);break;case ja.a.strikethrough:6!==l.AFrameworkApplication.va.xC?G.ULS.sendTraceTag(539305613,340,50,
"User used strikethrough from ribbon"):G.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");2===Ua.value&&(Ua.value=xb.isStrikethrough?0:1);this.Ce.Yia($a,1===Ua.value);break;case ja.a.zt:2===Ua.value&&(Ua.value=xb.isDoubleStrikethrough?0:1);this.Ce.Mge($a,1===Ua.value);break;case ja.a.font:if(Qb&&Qb.xd){const {fontName:Ib,Jda:$b,bold:hc,italic:pb}=vb.wqf(Qb.xd);this.Ce.Uia($a,Ib.substr(0,vb.GNi));this.Ce.fcg($a,$b);Object(la.a)()&&(Ua=1==hc,Sa=1==pb,Ua||Sa)&&(this.Ce.sL($a,
Ua),this.Ce.setItalic($a,Sa))}break;case ja.a.Uv:G.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");this.Ce.Uv($a,Ua,null);break;case ja.a.sqa:this.Ce.Uv($a,Ua,null);this.recentColors.bZa(Ua)||G.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ja.a.Lfa:this.Ce.Lfa($a);break;case ja.a.GY:G.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors.");this.Ce.Dya($a,Ua);break;case ja.a.P9:this.Ce.Dya($a,
Ua);this.recentColors.bZa(Ua)||G.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ja.a.gua:this.Ce.WDd($a);break;case ja.a.UA:this.Ce.UA($a,Qb.xd);break;case ja.a.K_:this.Ce.wli($a);break;case ja.a.Z0:this.Ce.utj($a);break;case ja.a.j5:xb=Ua.ia(E.a.noProof,!1);this.Ce.kbg($a,Ua.getValue(z.a.gL),Sa,xb);break;case ja.a.YPa:this.Ce.Uge($a);break;case ja.a.clearFormatting:this.Ce.Kfa($a);break;case ja.a.JCa:case ja.a.KCa:case ja.a.PZa:case ja.a.eua:case ja.a.QZa:xb.wPa&&
2===xb.capitalization&&this.Ce.JYk($a)}}$0n($a,kb){ja.a.clearFormatting===kb&&W.OutlineElementNavigator.Gl($a).properties.removeProperty(z.a.B0)}yrm($a,kb){return this.Xuh($a,kb)||this.Xuh(kb,$a)}Xuh($a,kb){return(1===$a.specialIndentType||!$a.specialIndentType)&&2===kb.specialIndentType}g8l($a){$a=J.GraphIterator.$a($a);$a.zb(11);aa.moveToCell($a,0,0);$a.Pd();$a.J_();return $a.currentNode}PTm($a){return!$a||pa.SelectionEditor.Sl($a)||1===$a.length&&pa.SelectionEditor.nl($a.Oa)&&!pa.SelectionEditor.Kjb($a.Oa)?
!1:!0}eLi($a){vb.leh.mb($a.contextId)||(G.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",$a.contextId),vb.leh.Z($a.contextId,!0))}QHm($a){return $a===ja.a.PZa||$a===ja.a.JCa||$a===ja.a.KCa||$a===ja.a.eua||$a===ja.a.QZa}pDd($a,kb){const Ua=$a.node,Sa=Ua.characterData.substr($a.cpBegin,$a.cpEnd-$a.cpBegin);this.Hkb.set("Command",kb.toString());n.Health.instance.recordKpiUsage(this.kpiName,1,this.h8,this.Hkb);kb=vb.MJo(Sa,kb);Ua.qqa(Ua.characterData.substr(0,$a.cpBegin)+kb+Ua.characterData.substr($a.cpEnd));
return 32}static get tj(){return vb.Yz||(vb.Yz=x.a.instance.resolve("Box4.IInsertionPointFormatting"))}static Zw(){return vb.Sm||(vb.Sm=x.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Xg(){return ia.ContextSetEditor.instance}static get Wf(){return Ma.a.instance}static get Jc(){return u.a.instance}static get Xb(){return null!=vb.rzg?vb.rzg:vb.rzg=x.a.instance.Na("Box4.IFeatureHelper")}static get E2c(){return Va.App.iN}static get Ld(){return null!=vb.XIg?vb.XIg:vb.XIg=x.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get nj(){return null!=
vb.yIg?vb.yIg:vb.yIg=x.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Sqa(){return null!=vb.aIg?vb.aIg:vb.aIg=x.a.instance.resolve("Box4.TextFormattingHelper")}static get Gd(){return null!=vb.oEg?vb.oEg:vb.oEg=x.a.instance.resolve("Box4.List.IListReader")}static get Un(){return null!=vb.aEg?vb.aEg:vb.aEg=x.a.instance.resolve("Box4.List.IListEditor")}static get Sf(){return ba.a.instance}static MTl($a,kb){return 42===$a?kb:$a!==kb||16===$a?16:$a}static Erh($a,kb){$a.Zvi||
(kb.Zvi?kb=$a:kb.unit===$a.unit&&k.a.Awa(kb.value,$a.value)||(kb.value=-1));return kb}static MJo($a,kb){switch(kb){case ja.a.JCa:return $a.toLowerCase();case ja.a.KCa:return 6!==l.AFrameworkApplication.va.xC?G.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):G.ULS.sendTraceTag(539305616,340,50,"User changed the case from keyboard shortcut"),$a.toUpperCase();case ja.a.PZa:case ja.a.eua:return vb.BVk($a,kb===ja.a.eua);case ja.a.QZa:return vb.aMo($a);default:return $a}}static aMo($a){let kb=
"";for(let Ua=0;Ua<$a.length;Ua++)kb=$a.charAt(Ua)===$a.charAt(Ua).toUpperCase()?kb+$a.charAt(Ua).toLowerCase():kb+$a.charAt(Ua).toUpperCase();return kb}static BVk($a,kb){let Ua,Sa,xb=!0,Qb=$a.length,Ib=0,$b=vb.GGf($a,Ib,Qb);for(;0<Qb;){Sa=Ua=!1;var hc=Qb;let dc;var pb=void 0;for(pb=0;0<hc&&vb.UXk($a.charAt(Ib+pb));pb++,hc--)Sa=vb.M_d($a.charAt(Ib+pb));for(dc=pb;0<hc&&!(Ua=vb.M_d($a.charAt(Ib+pb)))&&" "!==$a.charAt(Ib+pb)&&"/"!==$a.charAt(Ib+pb);pb++,hc--);hc=pb-dc;if(0>=hc)break;Ib+=dc;pb=$a.substr(Ib,
hc);pb=pb===pb.toUpperCase();if($b||!pb)$a=xb||Sa||kb?$a.substr(0,Ib)+$a.charAt(Ib).toUpperCase()+$a.substr(Ib+1,hc-1).toLowerCase()+$a.substr(Ib+hc):$a.substr(0,Ib)+$a.substr(Ib,hc).toLowerCase()+$a.substr(Ib+hc);Qb-=hc+dc;Ib+=hc;if(xb=Ua)Ib++,Qb--,$b=vb.GGf($a,Ib,Qb)}return $a}static GGf($a,kb,Ua){for(;0<Ua&&!vb.M_d($a.charAt(kb));){if($a.charAt(kb)!==$a.charAt(kb).toUpperCase())return!1;kb++;Ua--}return!0}static KTm($a,kb){for(var Ua=0;0<kb&&!vb.M_d($a.charAt(Ua));){if($a.charAt(Ua)!==$a.charAt(Ua).toLowerCase())return!1;
Ua++;kb--}return!0}static M_d($a){return"."===$a||"!"===$a||"?"===$a?!0:!1}static UXk($a){return-1==="0123456789".indexOf($a)&&$a.toUpperCase()===$a.toLowerCase()}static Z0h(){const $a=x.a.instance.Sa("Common.ISystemInitiatedFeedback");$a&&$a.execute(kb=>{kb.logActivity("FontsSurveyActivity","FontsFloodgateSurvey")})}}vb.leh=new N.a;vb.Yz=null;vb.Sm=null;vb.GNi=31;Object(F.a)(vb,"TextFormattingActor",null,[])},2035:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);var l;(function(f){f[f.chrome=
0]="chrome";f[f.edge=1]="edge";f[f.firefox=2]="firefox";f[f.IE=3]="IE";f[f.safari=4]="safari";f[f.others=5]="others";f[f.unknown=6]="unknown";f[f.electron=7]="electron";f[f.chromiumEdge=8]="chromiumEdge";f[f.teamsElectron=9]="teamsElectron"})(l||(l={}));Object(F.b)("BrowserCode",l)},2037:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(F.a)(l,"AtMentionAttributes",null,[])},2043:function(F,K,c){c.d(K,"a",function(){return l});
F=c(0);var l;(function(f){f[f.initial=0]="initial";f[f.startSearch=1]="startSearch";f[f.searching=2]="searching";f[f.searchComplete=3]="searchComplete";f[f.replaceAllInProgress=4]="replaceAllInProgress";f[f.replaceAllComplete=5]="replaceAllComplete";f[f.tooManyResults=6]="tooManyResults";f[f.noMatchesFound=7]="noMatchesFound"})(l||(l={}));Object(F.b)("FindReplaceViewType",l)},2045:function(F,K,c){c.d(K,"a",function(){return l});var l;(function(f){f[f.initial=0]="initial";f[f.headings=1]="headings";
f[f.find=2]="find";f[f.replace=3]="replace";f[f.intelligentPlaceholder=4]="intelligentPlaceholder";f[f.contracts=5]="contracts"})(l||(l={}))},2060:function(F,K,c){function l(b,h){h=Object.assign(new na.a,{name:"LinkType",string:h});f(Gb.a.zCm,b,[h])}function f(b,h,v,D=!0){h&&h.UILocation&&Object(Xe.d)(b,D,Xe.e,0,h.UILocation,0,v)}function a(b,h){const v=Ea.a.instance;return new kv(b,h,v.Ue("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value,v.Ue("WordEditor.Bookmark.FullBookmarkManager").value,
v.resolve("Box4.IHyperlinkStrategy"),v.resolve("Box4.IHyperlinkEditor"),v.resolve("Box4.ICharacterPropertiesEditor"),v.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,v.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,ns.a.instance,v.Na("Box4.IInternalLinkManager"))}function k(b,h){var v;return b===Jt.none?"none":null===(v=Pz[b])||void 0===v?void 0:v[h]}function x(){const b=Ea.a.instance.Na("WordEditor.Gc2Inline.IWordEditHostFactory");void 0===b&&u.ULS.sendTraceTag(509694672,
322,10,"getEditHostFactory: Failed to resolve edit host factory from container.");return b}function y(){const b=Ea.a.instance.Na("WordEditor.Gc2Inline.IGc2ClassFactory");void 0===b&&u.ULS.sendTraceTag(509224267,322,10,"getGC2ClassFactory: Failed to resolve GC2 class factory from container.");return b}c.r(K);var n=c(0),u=c(7),z=c(55),w=c(2),E=c(35),G=c(19),H=c(161),L=c(85);class I{constructor(b){this.Hjg=0;this.pGb=this.Hgc=this.DTa=null;this.MR=w.AFrameworkApplication.ta.Hq;this.OX=b;this.OX.Dv(L.a.flj);
this.OX.TB(L.a.flj,Object(z.a)(this,this.wtn,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.pGb)return u.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.pGb;this.DTa=this.MR.Zf("ComponentAttach","getCustomAuthConfig");return this.pGb=new Promise((b,h)=>{const v={};let D=!1,P=!1,ca=0;this.Hjg=window.setInterval(()=>{4>ca?(ca++,this.OX.sendMessage(L.a.getCustomAuthConfig,v)):(window.clearInterval(this.Hjg),D=!0,u.ULS.sendTraceTag(588087303,344,10,E.c({["error"]:"Request timeout after 4 retries."})),
h("Request timeout."))},1E3);this.Hgc=(ta,Ra)=>{window.clearInterval(this.Hjg);D||P||(P=!0,ta?(u.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),b(ta)):(u.ULS.sendTraceTag(589050654,369,10,E.c({["error"]:Ra.toString()})),h(Ra)))};this.OX.sendMessage(L.a.getCustomAuthConfig,v)})}wtn(b){try{const h=E.a(b.Values[H.a.OQk]);let v=w.AFrameworkApplication.K.jb("Application")||"";v=G.a.Ug(v);h.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+v+"%3Facctsw%3D1&prompt=select_account";
h.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+v+"%3Facctsw%3D1";h.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+v+"%3Facctsw%3D1&prompt=select_account";h.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+v+"%3Facctsw%3D1";this.DTa&&(this.DTa.stop(),this.DTa=null);this.Hgc(h,"")}catch(h){u.ULS.sendTraceTag(589050655,344,10,E.c({["error"]:h.message,["stack"]:h.stack})),this.Hgc(null,h.message)}}}Object(n.a)(I,"AccountSwitchingManager",null,[370]);var N=c(178);
class Q{get name(){return"Common.App.AccountSwitching"}xc(b){b.register(I,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").singleInstance().Rd(()=>new I(b.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){N.a.instance.Fc(new Q)}}Object(n.a)(Q,"AccountSwitchingPackage",null,[1,2]);var M;(function(b){b[b.generalException=0]="generalException";b[b.invalidArgument=1]="invalidArgument";b[b.notAllowed=2]="notAllowed";b[b.apiNotAvailable=
3]="apiNotAvailable";b[b.unresolvedPendingRequest=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.adalTimeout=6]="adalTimeout";b[b.userNotSignedIn=7]="userNotSignedIn";b[b.userAborted=8]="userAborted";b[b.silentSignInFailed=9]="silentSignInFailed";b[b.invalidResourceUrl=10]="invalidResourceUrl";b[b.invalidGrant=11]="invalidGrant";b[b.connectionLost=12]="connectionLost";b[b.clientError=13]="clientError";b[b.serverError=14]="serverError"})(M||(M={}));Object(n.b)("ErrorCodes",M);c(1812);class J{constructor(b,
h){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=h}}Object(n.a)(J,"OutstandingRequest",null,[]);class V{}V.bin="AADSTS50058";V.invalidResourceUrl="AADSTS50001";V.Vhn="AADSTS65001";V.Lin="AADSTS70011";V.userAborted="13002";V.FFn="Popup Window is null";V.EFn="Popup Window closed";V.adalTimeout="Token renewal operation failed due to timeout";V.iMo="tokenRevoked";Object(n.a)(V,"WopiHostErrorType",null,[]);var X=c(742),W=c(58),U=c(1811);class Y{constructor(){this.authority=
this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(n.a)(Y,"WopiIdentityInfo",null,[843]);class ba{constructor(b,h,v){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=h;this.expiration=v}}Object(n.a)(ba,"WopiIdentityToken",null,[839]);var aa=c(20),fa=c(184),na=c(31),oa=c(170);class ja{constructor(b){this._initialized=!1;this.Hfc={};this.xke={};this.MR=w.AFrameworkApplication.ta.Hq;this.Ayf=b}wgb(b){this._initialized||(b.Dv(L.a.wgc),
b.TB(L.a.wgc,Object(z.a)(this,this.vtn,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(b,h,v=null){this.Mha(b,h);return new Promise((D,P)=>{if(this.OBf(h))if(h in this.Hfc)P("unresolvedPendingRequest");else{var ca=window.setTimeout(()=>{u.ULS.sendTraceTag(37856032,344,10,E.c({["error"]:"Request timeout.",["callerId"]:h}));P("timeout")},12E4);this.nnf(b,h,v,(ta,Ra)=>{window.clearTimeout(ca);ta?D(ta):(u.ULS.sendTraceTag(37856033,369,15,E.c({["error"]:M[Ra]})),P(Ra))})}else u.ULS.sendTraceTag(37856034,
344,10,E.c({["error"]:"Caller is not allowed."})),P("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((h,v)=>{this.OBf(b)?this.h$l((D,P)=>{D?h(D):(u.ULS.sendTraceTag(37856064,369,10,E.c({["error"]:P.toString()})),v(P))}):(u.ULS.sendTraceTag(37856065,344,10,E.c({["error"]:"Caller is not allowed."})),v("notAllowed"))})}getAuthContext(b){return new Promise((h,v)=>{const D=this.getAuthContextSync(b);D?h(D):v("notAllowed")})}getAuthContextSync(b){if(this.OBf(b)){const h=new U.a;h.upn=w.AFrameworkApplication.K.jb("UserPrincipalName");
h.userId=w.AFrameworkApplication.K.jb("LoggableUserId");h.authority=w.AFrameworkApplication.K.jb("HostAuthAuthority");h.tenantId=w.AFrameworkApplication.K.jb("TenantId");h.isAnonymous=w.AFrameworkApplication.K.$("IsAnonymousUser");h.supportsAuthToken=this.Eum(b);b=w.AFrameworkApplication.K.jb("HostAuthType");h.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return h}u.ULS.sendTraceTag(40751647,344,10,E.c({["error"]:"Caller is not allowed."}));return null}Eum(b){const h=X.OAuthManagerSettings.GRc;
return aa.a.FQa?h&&X.OAuthManagerSettings.Eyj?Array.contains(X.OAuthManagerSettings.Eyj,b.toLowerCase()):!1:h}nnf(b,h,v,D){var P=[];Array.add(P,Object.assign(new na.a,{name:"CallerId",string:h}));Array.add(P,Object.assign(new na.a,{name:H.a.egg,string:b.correlationId}));fa.a.sendTelemetryEvent(Object.assign(new oa.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:P}));P=W.a.create().toString();const ca="getAccessToken_"+P,ta=this.MR.Zf("ComponentAttach",ca);this.xke[ca]=
ta;const Ra={};Ra[H.a.fgg]=P;Ra[H.a.GCo]=b.resource;Ra[H.a.HCo]=b.scope;Ra[H.a.gvj]=w.AFrameworkApplication.K.jb("HostAuthType");Ra[H.a.KCo]=w.AFrameworkApplication.K.jb("UserPrincipalName");Ra[H.a.ICo]=b.silentLogin;Ra[H.a.DCo]=b.options;Ra[H.a.egg]=b.correlationId;Ra[H.a.ECo]=h;v&&(Ra[H.a.addinName]=v.AddinName,Ra[H.a.CCo]=v.AddinTrustId);this.Ayf.execute(mb=>{this.wgb(mb);mb.sendMessage(L.a.getAuthToken,Ra)});this.Hfc[P]=new J(b,D)}h$l(b){const h=w.AFrameworkApplication.K.jb("UserName"),v=w.AFrameworkApplication.K.jb("UserPrincipalName"),
D=w.AFrameworkApplication.K.jb("LoggableUserIdSpace"),P=new Y;P.email=v;P.displayName=h;switch(D){case "OrgIdPuid":P.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":P.authority="MicrosoftAccount";break;default:P.authority=D}b(P,null)}vtn(b){let h=null;try{let D=b.Values[H.a.fgg];const P=b.Values[H.a.BCo],ca=b.Values[H.a.gvj],ta=b.Values[H.a.JCo];let Ra=null,mb=null;const Jb=this.Hfc[D];if("undefined"!==typeof Jb&&Jb){var v=[];Array.add(v,Object.assign(new na.a,{name:H.a.egg,
string:Jb.requestParameters.correlationId}));fa.a.sendTelemetryEvent(Object.assign(new oa.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:v}));h=Jb.requestCallback;delete this.Hfc[D];"undefined"!==typeof P&&P&&P.length?mb=new ba(P,ca,ta):Ra=M[this.ian(b)];v="getAccessToken_"+D;v in this.xke&&(this.xke[v].stop(),delete this.xke[v]);h(mb,Ra)}else u.ULS.sendTraceTag(37856066,344,10,E.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:D}))}catch(D){b=
b.Values[H.a.fgg],b in this.Hfc&&delete this.Hfc[b],this.S2d(),u.ULS.sendTraceTag(37856067,344,10,E.c({["error"]:D.message,["stack"]:D.stack})),h&&h(null,"generalException")}}OBf(b){var h=w.AFrameworkApplication.elm();b=b.toLowerCase();for(const v of h)if(b===v.toLowerCase())return!0;h=X.OAuthManagerSettings.q1e;for(let v in h)if(b===h[v].toLowerCase())return!0;return!1}ian(b){b=b.Values[H.a.FCo];this.S2d();u.ULS.sendTraceTag(39068821,344,15,E.c({["error"]:b}));return b?-1<b.indexOf(V.bin)?9:-1<b.indexOf(V.FFn)||
-1<b.indexOf(V.EFn)?12:-1<b.indexOf(V.invalidResourceUrl)?10:-1<b.indexOf(V.userAborted)?8:-1<b.indexOf(V.Lin)||-1<b.indexOf(V.Vhn)||b===V.iMo?11:-1<b.indexOf(V.adalTimeout)?6:0:13}Mha(b,h){b=this.DUn(b.resource);u.ULS.sendTraceTag(39921882,344,50,E.c({["callerId"]:h,["resource"]:b}))}S2d(){u.ULS.sendTraceTag(39068822,344,50,E.c({["userAgent"]:window.navigator.userAgent}))}DUn(b){return(b?b:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(n.a)(ja,"WopiIdentityManager",
null,[824]);class qa{constructor(){this.W=null}get name(){return"Common.App.WopiIdentity"}xc(b){this.W=b;b.register(ja,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").singleInstance().Rd(()=>new ja(b.Sa("Postmessage.IHostPostmessenger")))}init(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.Po(Object(z.a)(this,this.Px,"onFullAppSettingsReady"))}Px(){try{this.W.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(b){u.ULS.sendTraceTag(571074327,383,
10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}dispose(){}static main(){N.a.instance.Fc(new qa)}}Object(n.a)(qa,"WopiIdentityPackage",null,[1,2]);var Ia=c(498),Va=c(354),Na=c(67),za;(function(b){b[b.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";b[b.cloudPolicySettings=1]="cloudPolicySettings";b[b.alternateAuthToken=2]="alternateAuthToken"})(za||(za={}));Object(n.b)("ApplicationFeatureHelperRequestType",za);class la{constructor(){this.message=null;this.httpStatusCode=
0}}Object(n.a)(la,"HttpRequstToPromiseRejectData",null,[]);var va=c(83),ia=c(57),pa=c(196),sa=c(749);class Ha{constructor(b,h){this.Fa=b;this.Xf=h}BIc(b,h,v,D=null,P=null,ca=null,ta=null,Ra=null){const mb=za[v],Jb=mb+"RequestFailure";va.Health.instance.recordKpiUsage(Jb,0,"jpittsdirects",null);return new Promise((Ub,cc)=>{u.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",mb);const Ac=null!=ta?ta:this.Fa.mc("ApplicationFeatureHelperRequestQueueTimeout",
15E3),Lc=null!=Ra?Ra:this.Fa.mc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Xf.mzb(b,1,null,this.Oqf(v,D),ca,1,id=>{u.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",mb);try{if(void 0===id||null===id||void 0===id.data||null===id.data||void 0===id.data.ve||null===id.data.ve){va.Health.instance.recordKpiFailure(Jb,"Invalid RequestSucceededEventArgs",!1,!0,null);let xe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
mb);cc(this.CEa(xe,id))}else if(id.data.Qe!==pa.a.My){va.Health.instance.recordKpiFailure(Jb,"HttpStatusCode_"+id.data.Qe.toString(),!1,!0,null);let xe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",id.data.Qe,mb);cc(this.CEa(xe,id))}else{void 0!==P&&null!==P&&void 0!==id.data.Bj&&null!==id.data.Bj&&P(id.data.Bj);var vd=h(id.data.ve);if(vd)u.ULS.sendTraceTag(50622690,3004,50,
"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",mb),Ub(vd);else{va.Health.instance.recordKpiFailure(Jb,"Parse Failure",!1,!0,null);let xe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",mb);cc(this.CEa(xe,id))}}}catch(xe){va.Health.instance.recordKpiFailure(Jb,"Unexpected Failure",!1,!0,null),vd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
xe,mb),cc(this.CEa(vd,id))}},id=>{if(id.data){va.Health.instance.recordKpiFailure(Jb,"HttpStatusCode_"+id.data.Qe.toString(),!1,!0,null);var vd=sa.a.R8b(id.data.ve||"No Data");vd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",id.data.Qe,vd,mb)}else va.Health.instance.recordKpiFailure(Jb,"Invalid RequestFailedEventArgs",!1,!0,null),vd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
mb);cc(this.CEa(vd,id))},void 0,void 0,Ac,Lc)})}CEa(b,h){const v=new la;v.message=b;v.httpStatusCode=h&&h.data?h.data.Qe:-1;return v}Oqf(b,h){const v={};v["x-UserDataSignature"]=this.Fa.jb("UserDataSignature");v["x-LicensingIsEnabled"]=this.Fa.$("LicensingIsEnabled").toString();v["x-CacheIsEnabled"]=this.Fa.$("LicensingRedisIsEnabled").toString();v["x-OcpsIsEnabled"]=this.Fa.$("OcpsIsEnabled").toString();v["x-LicensingAADIdIsEnabled"]=this.Fa.$("LicensingAadIdIsEnabled").toString();0===b&&(v["x-LicenseCheckOnTenantEnabled"]=
"true",v["x-SupportUserConsentDependentFeatures"]="true",v["x-AFHUserConsentGroupValue"]="0",v["x-UseShellServiceForUserConsentGroup"]="true",v["x-SMBUserLicensingEnabled"]="true",v["x-AFHPIPLComplianceEnabled"]=ia.a.aU(window.location.href,"wd_afhpipl")||"false");if(h)for(let D of h.keys)v[D]=h.J(D);return v}}Object(n.a)(Ha,"HttpRequestToPromiseUtility",null,[]);var ra;(function(b){b[b.loki=0]="loki";b[b.augloopACLP=1]="augloopACLP"})(ra||(ra={}));Object(n.b)("AlternateAuthSupportApp",ra);class Ma{constructor(){this.Token=
null;this.ExpirationTime=0}}Object(n.a)(Ma,"WacAlternateAuthToken",null,[]);class ya{constructor(b,h){this.gMo=3E5;if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Fa=b;this.ued=new Ia.a(Va.a.Fh());this.xuc=new Ha(b,h);void 0!==X.OAuthManagerSettings.yLf&&null!==X.OAuthManagerSettings.yLf&&void 0!==X.OAuthManagerSettings.A3d&&null!==X.OAuthManagerSettings.A3d&&0<X.OAuthManagerSettings.A3d&&(b=new Ma,b.Token=X.OAuthManagerSettings.yLf,
b.ExpirationTime=X.OAuthManagerSettings.A3d,this.ued.Z("loki",b))}mNl(){let b=null;this.ued.mb(ra[0])&&(b=this.ued.J(ra[0]));return void 0===b||null===b||this.SUm(b)?this.yBl():Promise.resolve(b.Token)}SUm(b){return b.ExpirationTime-Date.now()<this.gMo}yBl(){const b=new Ia.a(Va.a.Fh());b.Z("X-AlternateAuthApp",ra[0]);return this.xuc.BIc(this.Ghb("/afhs/AlternateAuthHelperHandler.ashx"),Object(z.a)(this,this.nBn,"parseAlternateAuthTokenResponse"),2,b).then(h=>{u.ULS.sendTraceTag(545821456,3004,50,
"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",ra[0]);this.ued.Z(ra[0],h);return h.Token},h=>{h=Object(Na.a)(la,h);u.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",h.message,h.httpStatusCode);return null})}nBn(b){let h=null;({av:h}=E.d(b));u.ULS.sendTraceTag(545821457,3004,h?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",b);return h}Ghb(b){return String.format("{0}{1}?{2}",
this.Fa.jb("WebServiceBase"),b,w.AFrameworkApplication.im)}}Object(n.a)(ya,"AlternateAuthHelper",null,[808]);var Ga=c(599);class wa{constructor(b,h,v){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=b;this.isEnabled=h;this.tierName=v}}Object(n.a)(wa,"FeatureStateChangeArgs",null,[]);var hb=c(149),eb=c(200),jb=c(82),ub=c(140),ab;(function(b){b[b.Enabled=0]="Enabled";b[b.Disabled=1]="Disabled"})(ab||(ab={}));Object(n.b)("FeatureState",ab);var Ea=c(22),Wa=c(13),Bb=c(115);class Mb{constructor(b,
h,v=null,D=null,P=null){this.Ngb=this.hla=this.jdh=this.hbb=this.zvd=null;this.xuc=new Ha(b,h);this.Fa=b;this.Cak=b.mc("LicensingMaxRetryAttempts",0);this.Rmd=b.$("IsO365ConsumerHost");this.tGe=b.$("IsO365CommercialHost");this.PFe=b.$("PremiumUpsellIsEnabled");this.oWb=!1;this.VIe=0;this.nPg=v;this.Ykh=D;this.ga=P;this.gbb=b.$("LicensingIsEnabled");this.Wvb=b.$("OcpsIsEnabled")&&this.tGe;this.iXe=b.$("ShowPrivacyDialog")&&!!D;this.dWb=b.$("IsAnonymousUser");this.LLd=new Promise(ca=>{ca(!1)});this.jqb=
new Promise(ca=>{ca(!0)});this.Mgb=new Ia.a(Va.a.Fh());this.Wxd=!0;this.e5g=this.e2l();this.l3a()&&!this.dWb?(void 0!==w.AFrameworkApplication.ta&&null!==w.AFrameworkApplication.ta&&(this.zvd=w.AFrameworkApplication.ta.Hq,void 0!==this.zvd&&null!==this.zvd&&(this.hbb=this.zvd.hRa("WebServiceCall","ApplicationFeatureHelperService"))),this.Ngb=this.hlg()):this.Ngb=new Promise(ca=>{ca({})});this.Ngb.catch(ca=>{ca=Object(Na.a)(la,ca);u.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",
ca?ca.httpStatusCode.toString():"Unknown")});this.Wxd&&this.isFeatureEnabled("FreemiumUpsell",!0).then(ca=>{this.oWb=ca;return null})}e2l(){const b=this.Fa.Sw("AllLicensedFeatures")?this.Fa.LC("AllLicensedFeatures"):[],h=new Ga.a;for(let v=0;v<b.length;v++)h.add(b[v]);return h}l3a(){return this.tGe||this.Rmd}hlg(b=0,h=!1){u.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",h);const v=hb.a.iG();v&&(v.set("retryAttempt",b.toString()),v.set("forceRefresh",
h.toString()),v.set("isO365ConsumerHost",this.Rmd.toString()),v.set("isO365CommercialHost",this.tGe.toString()),v.set("isFreemiumUpsellSettingEnabled",this.PFe.toString()));va.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",v);va.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",v);void 0!==this.hbb&&null!==this.hbb&&this.hbb.start();let D=null;h&&(D=new Ia.a(Va.a.Fh()),D.Z("x-LicensingForceRefresh","true"));this.jdh=new Date;
return(this.gbb?this.xuc.BIc(this.Ghb("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(z.a)(this,this.rBn,"parseApplicationFeatureHelperResponse"),0,D,Object(z.a)(this,this.UIn,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(P=>{const ca=Object.assign(new Bb.a,{durationMs:this.dwj()});ca.extendedProperties=v;ca.extendedProperties&&P&&(ca.extendedProperties.set("featureCount",jb.a.count(P).toString()),ca.extendedProperties.set("licensingTestFeatureEnabled",
("LicensingTestFeature"in P).toString()),ca.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in P).toString()),"FreemiumUpsell"in P&&ca.extendedProperties.set("isFreemiumUpsellEnabled",P.FreemiumUpsell.toString()),this.hla&&ca.extendedProperties.set("fromCache",(this.hla<this.jdh).toString()));va.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",ca);return P},P=>{const ca=Object.assign(new Bb.a,{durationMs:this.dwj()}),ta=Object(Na.a)(la,P);if(!ta)return u.ULS.sendTraceTag(51491471,
3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),va.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,ca),new Promise((Ra,mb)=>{mb(P)});ca.extendedProperties=v;ca.extendedProperties&&ca.extendedProperties.set("status",ta.httpStatusCode.toString());va.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,ca);return 408===ta.httpStatusCode&&++b<=this.Cak?
this.hlg(b):new Promise((Ra,mb)=>{mb(ta)})})}rBn(b){(b=E.b(b))?(u.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),u.ULS.sendTraceTag(50938594,3004,50,"{0}",b)):u.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return b.Features}Ghb(b){var h=String.format("{0}{1}",this.Fa.jb("WebServiceBase"),b);this.Fa.Sw("ApplicationFeatureHelperHttpCachingEnabled")&&
this.Fa.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=Mb.RQd(this.Fa))&&0<b.length&&(this.Wxd&&(b+="ucbf"),h=new eb.QueryStringBuilder(h),h.ze("afhskey",b),h=h.toString());return h}isFeatureEnabled(b,h){if(!this.Wvb&&!this.iXe&&!this.gbb)return this.jqb;u.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",b);if("ConnectedServices"===b){var v=this.Wvb?this.nPg.o8("ControllerConnectedServicesEnabled"):this.jqb;const ca=
this.iXe?this.Ykh.getSettings().then(ta=>2!==ta.WI,()=>h):this.jqb;return v.then(ta=>ta?ca:this.LLd)}if("FreemiumUpsell"===b&&(!this.PFe||!this.Rmd||this.dWb))return this.LLd;v=null;v=this.Wvb?this.nPg.isFeatureEnabled(b):this.jqb;let D=null;D=this.gbb?this.dLm(b,h):this.jqb;let P=null;P=this.iXe?this.Ykh.isFeatureEnabled(b):this.jqb;return v.then(ca=>ca?P.then(ta=>ta?D:this.LLd):this.LLd).then(ca=>{this.dKi(b,ca,!0);return ca},()=>{this.dKi(b,h,!1);return h})}dKi(b,h,v){u.ULS.sendTraceTag(526713106,
3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,h,v)}getFeatureTier(b,h){if(!this.gbb)return new Promise(v=>{v(2)});u.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.Ngb.then(v=>this.ZSd(b,v,h),()=>h)}isFreemiumUpsellEnabled(){if(this.PFe&&this.Rmd&&!this.dWb){if(this.oWb&&2!==this.VIe||!this.oWb&&1!==this.VIe)u.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",
this.oWb.toString()),this.VIe=this.oWb?2:1;return this.oWb}return!1}launchUpsellExperience(b,h=null){u.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",b));var v=hb.a.iG();v&&(v.set("experienceId",b),h&&v.set("campaignId",h));va.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",v);if(v=Ea.a.instance.Na("Common.IInProductMessagingUIManager")){const D=Object(z.a)(this,this.Anm,
"handleDimeTaskComplete");v.JFi(b,D,h)}else u.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),va.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.ga.Qb(Wa.a.GNd,2,{["experience"]:b})}gya(b,h){if(!this.gbb)return null;if(!b||!h)return u.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const v=ub.a.create().toString();this.Mgb.mb(b)||this.Mgb.Z(b,
new Ia.a(Va.a.Fh()));this.Mgb.J(b).add(v,h);u.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",v,b));return v}shc(b,h){this.gbb&&(b&&this.Mgb.mb(b)?h&&ub.a.isValid(h)?this.Mgb.J(b).mb(h)?(u.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",h,b)),this.Mgb.J(b).remove(h)):u.ULS.sendTraceTag(594564809,
3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",h,b)):u.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",h,b)):u.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",b)))}ZSd(b,h,v){return this.Wxd?b in h?h[b].LicenseTier:
v:b in h?this.aCn(h[b],v):v}aCn(b,h){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return h}}Anm(){u.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.Ngb.then(b=>{this.X8i(b)}).catch(()=>{this.X8i({})})}X8i(b){u.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const h=this.hlg(0,!0);h.then(v=>{this.Ngb=h;jb.a.count(v)>jb.a.count(b)?va.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",
null):va.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let D of this.Mgb.keys)if(D in v){const P=this.ZSd(D,v,0);D in b?this.ZSd(D,b,0)!==P&&this.MRf(D,!0,P):this.MRf(D,!0,P)}else D in b&&this.MRf(D,!1,this.ZSd(D,b,0))}).catch(v=>{va.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);u.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(v))})}MRf(b,h,v){u.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
b,h,v);h=new wa(b,h,v);v=this.Mgb.J(b);for(let D of v)try{D.value(h)}catch(P){u.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",b,D.key,P.message))}}cLm(b,h){if(this.gbb){const v=this.e5g.contains(b);let D=!0,P="",ca=!1;return this.Ngb.then(ta=>{b in ta?(ta=ta[b],P=ab[ta.FeatureState],D=1!==ta.FeatureState):D=!v;this.sKi(b,v,P,ca,h,D);return D},()=>{ca=!0;
v&&(D=h);this.sKi(b,v,P,ca,h,D);return D})}return this.jqb}sKi(b,h,v,D,P,ca){u.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,h,D,v,P,ca)}dLm(b,h){if(this.Wxd)return this.cLm(b,h);if(this.gbb){if(this.e5g.contains(b))return this.Ngb.then(v=>b in v,()=>h);u.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",
b)}return this.jqb}UIn(b){try{b&&"Date"in b&&(this.hla=new Date(b.Date),u.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.hla.toString()))}catch(h){u.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",h)}}dwj(){if(void 0!==this.hbb&&null!==this.hbb){const b=this.hbb.si;this.hbb.stop();return b}return null}static RQd(b){try{if(aa.a.Xke){const h=b.jb("UserDataSignature").split(".");if(1<h.length){const v=
window.self.atob(h[1]),D=JSON.parse(v).LocalStorageKey;if(void 0!==D&&null!==D&&0<D.length)return D}}}catch(h){u.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",h.toString())}return null}}Object(n.a)(Mb,"ApplicationFeatureHelper",null,[809]);var Fb=c(74);class vb{constructor(b,h){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+h);this.ExpirationTime=b.getTime()}}Object(n.a)(vb,"CloudPolicySettingsCacheData",
null,[]);var $a=c(1378),kb=c(622),Ua=c(288);class Sa{static Atj(){return w.AFrameworkApplication.K.$("SideCarIsEnabled")?Sa.Gfe&&Sa.hUc?new Promise(b=>{b(!0)}):new Promise((b,h)=>{Sa.Gfe=Ua.a.create(w.AFrameworkApplication.K.jb("SideCarUrl"));kb.a.pX(Sa.Gfe);Sa.Gfe.VZ((v,D)=>{(Sa.hUc=D.succeeded)?b(D.succeeded):h(D.succeeded)})}):new Promise(b=>{b(!1)})}}Sa.hUc=!1;Sa.Gfe=null;Object(n.a)(Sa,"SideCarLoader",null,[]);class xb{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=
null}}Object(n.a)(xb,"CloudPolicySettingsData",null,[]);class Qb{constructor(b,h){this.xve=0;this.tEd=null;this.xuc=new Ha(b,h);this.Fa=b;h=b.jb("HostAuthType");this.Wvb=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===h||null===h)&&"aad"===h.toLowerCase();this.O8g=E.b(b.jb("OcpsDefaultSettings")||"{}");this.Rwc=this.RQd();h=this.Fa.Sw("ServicesControlsMicrosoftControllerServicesList")?this.Fa.LC("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.Hgd=new Ga.a;for(let v=0;v<
h.length;v++)this.Hgd.add(h[v]);this.Wvb&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.tEd=this.eQo():this.tEd=this.glg(this.Wvb,this.Ghb("/afhs/CloudPolicySettings.ashx"),Object(z.a)(this,this.vBn,"parseCloudPolicySettingsResponse"));this.tEd.then(()=>null).catch(v=>{v=Object(Na.a)(la,v);u.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",v?v.httpStatusCode.toString():"Unknown")})}o8(b,h=!0){if(!this.Wvb){const ca=this;return new Promise(ta=>
{ta(ca.iPc(b))})}let v=this,D=this;const P=this.tEd.then(ca=>{try{let ta=null;ca.PolicySettings&&"unknown"in ca.PolicySettings&&(ta=ca.PolicySettings.unknown);if(ta){if(b in ta&&void 0!==ta[b]&&null!==ta[b])return new Promise(mb=>{mb("0"!==ta[b])});const Ra=b.toLowerCase();if(Ra in ta&&void 0!==ta[Ra]&&null!==ta[Ra])return new Promise(mb=>{mb("0"!==ta[Ra])});u.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default");return new Promise(mb=>{mb(v.iPc(b))})}return new Promise(Ra=>{Ra(v.iPc(b))})}catch(ta){return u.ULS.sendTraceTag(50622686,
3004,10,"Failed to get "+b+" policy value. Error Message: {0}",ta.message),v.handleError(ta.toString(),h,v.iPc(b))}},ca=>D.handleError(ca,h,D.iPc(b)));P.then(ca=>{u.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,ca);return null});return P}isFeatureEnabled(b,h=!0){if(this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.fLm(b,h);let v=new Promise(P=>{P(!0)}),
D="";this.Hgd.contains(b)&&(D="ControllerConnectedServicesEnabled",v=this.o8(D,h));v.then(P=>{u.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,P,D);return null});return v}fLm(b,h=!0){let v=new Promise(P=>{P(!0)}),D="";"mso_sendASmile"===b?D="Enabled":"Survey"===b||"FloodgateSurvey"===b?D="SurveyEnabled":this.Hgd.contains(b)&&(D="ControllerConnectedServicesEnabled");""!==D&&(v=this.o8(D,h));v.then(P=>{u.ULS.sendTraceTag(558187080,
3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",b,P,D);return null});return v}handleError(b,h,v){return h?new Promise(D=>{D(v)}):new Promise((D,P)=>{P(b)})}glg(b,h,v){if(!b)return Promise.resolve(new xb);let D=!1,P=null;va.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let ca=this.laf("GetCloudPolicySettings");return(new Promise((ta,Ra)=>{if(void 0!==this.Rwc&&null!==this.Rwc&&0<this.Rwc.length){const mb=this.IPo();
if(void 0!==mb&&null!==mb){D=!0;ta(mb);return}}this.xuc.BIc(h,v,1,null,Object(z.a)(this,this.fJn,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.Fa.mc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Fa.mc("CloudPolicySettingsRequestSentTimeout",3E4)).then(mb=>{u.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.RQo(mb);ta(mb);return mb},mb=>{Ra(mb);return null})})).then(ta=>{({WA:ca,returnValue:P}=this.tke(ca));var Ra=hb.a.iG();Ra&&Ra.set("FromCache",
D.toString());Ra=Object.assign(new Bb.a,{durationMs:P,extendedProperties:Ra});va.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Ra);return ta})}eQo(){return Sa.Atj().then(()=>{u.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}Ghb(b){return String.format("{0}{1}",this.Fa.jb("WebServiceBase"),b)}vBn(b){let h=null;({av:h}=E.d(b));b=!!h;u.ULS.sendTraceTag(50622687,
3004,b?50:10,"ParseCloudPolicySettingsResponse: Success={0}",b);return h}fJn(b){try{if(void 0!==b&&null!==b&&"CheckIn-Interval"in b){const h=parseInt(b["CheckIn-Interval"]);void 0!==h&&null!==h&&0<h&&(this.xve=h)}}catch(h){u.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",h)}}iPc(b){return b in this.O8g?"0"!==this.O8g[b]:!0}IPo(){try{const b=$a.a.instance.getItem(this.Rwc);if(void 0===b||null===b)return u.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),
null;u.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const h=JSON.parse(b);if(void 0===h||null===h)return u.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===h.ExpirationTime||null===h.ExpirationTime)return u.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;
if((new Date(h.ExpirationTime)).getTime()<Date.now())return u.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const v=new xb;v.PolicySettings=h.PolicySettings;v.ControllerConnectedServicesFeatureNames=new Fb.a;this.Fa.Sw("ServicesControlsMicrosoftControllerServicesList")&&this.Fa.LC("ServicesControlsMicrosoftControllerServicesList");for(let D of this.Hgd)v.ControllerConnectedServicesFeatureNames.add(D);u.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");
return v}catch(b){return u.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}RQo(b){try{if(void 0===b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)u.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.xve)u.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const h=new vb(b,this.xve),v=JSON.stringify(h);
u.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",v);$a.a.instance.setItem(this.Rwc,v);u.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(h){u.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",h.toString())}}RQd(){const b=Mb.RQd(this.Fa);return b&&0<b.length?"OCPS"+b:null}laf(b){const h=Ea.a.instance.Na("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==
h&&null!==h?h.Zf("WebServiceCall",b):null}tke(b){if(void 0!==b&&null!==b){const h=b.si;b.stop();return{returnValue:h,WA:null}}return{returnValue:null,WA:b}}}Object(n.a)(Qb,"CloudPolicySettingsHelper",null,[806]);class Ib{constructor(){this.AUh=this.kJj=this.WI=0;this.BUh=this.lJj=this.kBb="";this.rTe=this.uUa=2}clone(){const b=new Ib;b.WI=this.WI;b.kJj=this.kJj;b.AUh=this.AUh;b.kBb=this.kBb;b.lJj=this.lJj;b.BUh=this.BUh;b.uUa=this.uUa;b.rTe=this.src;return b}get src(){return this.rTe}serialize(b=
null){const h={};if(!b||b.contains(Ib.mKb))h[Ib.mKb]=this.WI;if(!b||b.contains(Ib.w_c))h[Ib.w_c]=this.kBb;if(!b||b.contains(Ib.x_c))h[Ib.x_c]=this.uUa;return JSON.stringify(h)}static create(b,h=null){const v=new Ib;v.rTe=b;void 0!==h&&null!==h&&(Ib.mKb in h&&(v.WI=h[Ib.mKb]),Ib.w_c in h&&(v.kBb=h[Ib.w_c]),Ib.x_c in h&&(v.uUa=h[Ib.x_c]));return v}static deserialize(b,h){try{const v=JSON.parse(b);if(void 0!==v&&null!==v)return Ib.create(h,v);u.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",
b);throw Error.argument("settingsData");}catch(v){throw u.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",v.toString()),v;}}}Ib.mKb="CCS";Ib.w_c="CCSTime";Ib.x_c="OfficePrivacyRoamedNoticeShown";Object(n.a)(Ib,"UserPrivacySettings",null,[]);var $b=c(152);class hc{constructor(b,h){if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Fa=b;this.Xf=h;this.hSe=this.Uf=null}Ghb(b){var h=String.format("{0}RoamingServiceHandler.ashx?action=",
this.Fa.appSettings.RoamingServiceHandlerWebServiceBase||"");h=new Sys.StringBuilder(h);h.append(b);h.append("&");h.append(w.AFrameworkApplication.im);return h.toString()}executeRequest(b,h,v,D=null){return this.Xf.F0b(b,h,D,null,v,"33",!1,null,6E4)}saveSettings(b){return new Promise((h,v)=>{try{if(void 0===this.Uf||null===this.Uf||void 0===b||null===b)u.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),v("Can't determine setting changes to save");
else{var D=this.Uf.WI!==b.WI;if(2===this.Uf.src&&D)this.vbo(b),h(!0);else{var P=this.sgo(b);if(void 0===P||null===P||!P.length)u.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),v("No changes to save");else if(1===this.Uf.src)h(this.wDj(P));else if(0===this.Uf.src){u.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",P);const ca=this.executeRequest(this.Ghb("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
P);ca.continueWith(()=>{if(ca.yo||ca.Ai)u.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),h(!1);else{var ta=ca.result;void 0!==ta.args&&null!==ta.args&&void 0!==ta.args.data&&null!==ta.args.data&&ta.args.data.Qe===pa.a.My?(u.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),h(!0)):(u.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),h(!1))}})}}}}catch(ca){u.ULS.sendTraceTag(50860930,
3004,10,"SaveUserPrivacySettings: Exception = {0}",ca.toString()),h(!1)}})}sgo(b){if(void 0===this.Uf||null===this.Uf||void 0===b||null===b)throw Error.invalidOperation("User Privacy settings have not been initialized");const h=new Fb.a;0===b.src?(this.Uf.WI!==b.WI&&(h.add(Ib.mKb),h.add(Ib.w_c)),this.Uf.uUa!==b.uUa&&h.add(Ib.x_c)):1===b.src&&this.Uf.WI!==b.WI&&h.add(Ib.mKb);return h.count?b.serialize(h):(u.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),
null)}getSettings(){if(!this.hSe){const b=this;this.hSe=new Promise(h=>{try{b.Uf?h(b.Uf.clone()):b.$Po().then(v=>{b.Uf=v;h(b.Uf.clone());return null},()=>{b.YPo().then(v=>{b.Uf=v;h(b.Uf.clone());return null},()=>{b.ZPo().then(v=>{b.Uf=v;h(b.Uf.clone());return null},()=>{u.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Uf=new Ib;h(b.Uf.clone());return null});return null});return null})}catch(v){u.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
v.toString()),b.Uf=new Ib,h(b.Uf.clone())}})}return this.hSe}$Po(){return new Promise((b,h)=>{try{const D=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Fa.$("PrivacyDialogShouldCheckRoaming")||D){var v=this.executeRequest(this.Ghb("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");v.continueWith(()=>{try{if(v.yo||v.Ai)u.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const P=v.result;if(P&&P.args&&P.args.data)if(P.args.data.Qe!==
pa.a.My)u.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",P.args.data.Qe);else{if(P.args.data.ve){b(hc.parse(P.args.data.ve,0));u.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",P.args.data.ve);return}u.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else u.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");
h("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(P){u.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",P.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else u.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),h("Roaming should not be used")}catch(D){u.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",
D.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}YPo(){return new Promise((b,h)=>{try{const v=$b.a.get("WacUPToggleState");let D=null;void 0!==v&&null!==v&&0<v.length&&(D=decodeURIComponent(v));if(void 0!==D&&null!==D&&0<D.length){const P=hc.parse(D,1);u.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",P.toString());b(P)}else{const P=Ib.create(1),ca=new Fb.a;ca.add(Ib.mKb);const ta=P.serialize(ca);this.wDj(ta)?
(u.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",ta),b(P)):(u.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",ta),h("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(v){u.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",v.toString()),h("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}ZPo(){return new Promise(b=>
{try{var h=-1!==window.location.href.indexOf("&wdccsoff=1");let v=Ib.create(2);h?(v.WI=2,w.AFrameworkApplication.sSh(),u.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",v.toString())):(v.WI=1,u.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",v.toString()));b(v)}catch(v){u.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",v.toString()),
h=Ib.create(2),h.WI=1,b(h)}})}vbo(b){u.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===b.WI?w.AFrameworkApplication.sSh():w.AFrameworkApplication.Tul();u.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}wDj(b){try{u.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const h=this.Fa.jb("PrivacyCookieDomain")||"";if(!h||!h.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");
u.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return $b.a.Coj("WacUPToggleState",b,$b.a.mRa,h)}catch(h){return u.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",h.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(h=>{const v=this.Fa.Sw("ServicesControlsMicrosoftControllerServicesList")?this.Fa.LC("ServicesControlsMicrosoftControllerServicesList"):[],D=new Ga.a;for(let P=0;P<v.length;P++)D.add(v[P]);return D.contains(b)?
2!==h.WI:!0},()=>{u.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);return!0})}static parse(b,h){try{return u.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",b,h),Ib.deserialize(b,h)}catch(v){throw u.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",v.toString()),v;}}}Object(n.a)(hc,"UserPrivacySettingsHelper",null,[807]);class pb{constructor(){this.W=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}xc(b){this.W=
b;this.W.register(806,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").singleInstance().Rd(()=>new Qb(w.AFrameworkApplication.K,w.AFrameworkApplication.Ne));this.W.register(807,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").singleInstance().Rd(()=>new hc(w.AFrameworkApplication.K,w.AFrameworkApplication.Ne));this.W.register(808,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").singleInstance().Rd(()=>new ya(w.AFrameworkApplication.K,w.AFrameworkApplication.Ne));
this.W.register(809,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").singleInstance().Rd(()=>new Mb(w.AFrameworkApplication.K,w.AFrameworkApplication.Ne,this.W.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.W.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),w.AFrameworkApplication.va))}init(){w.AFrameworkApplication.K.Po(()=>{const b=this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");w.AFrameworkApplication.K.$("LicensingIsEnabled")&&
(b.isFeatureEnabled("LicensingTestFeature",!1).then(h=>{u.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",h,w.AFrameworkApplication.K.jb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(h=>{u.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",h,w.AFrameworkApplication.K.jb("IsAnonymousUser"));
return null}));this.W.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.wJo()})}dispose(){}wJo(){try{w.AFrameworkApplication.K.$("SideCarIsEnabled")&&Sa.Atj().then(b=>{u.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){N.a.instance.Fc(new pb)}}Object(n.a)(pb,"ApplicationFeatureHelperPackage",null,[1,2]);var dc=c(166);class Ob{WQd(b,h){let v;const D=[];for(;v=h.exec(b);){const P=v.index;
D.push(new dc.a(P,P+v[0].length))}return D}isEndPuncSpecialCase(b){const h=this.WQd(b,Ob.sBo);for(const v of h)if(v.end===b.length)return!0;return!1}GLc(b){for(const h of Ob.mzl){const v=this.WQd(b,h);if(0<v.length&&!v[0].begin)return v[0].end-1}return 0}findBeginBoundary(b,h,v){var D=b.substring(v,h);b=this.WQd(D,Ob.xWh);for(h=b.length-1;0<=h;h--){const P=D.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(P))return D=D.substring(b[h].begin,D.length),v+b[h].end+this.GLc(D)}return v}findEndBoundary(b,
h,v){var D=b.substring(h,v);b=this.WQd(D,Ob.xWh);for(v=0;v<b.length;v++){const P=D.substring(0,b[v].end);if(!this.isEndPuncSpecialCase(P))return D=D.substring(b[v].begin,D.length),h+b[v].end+this.GLc(D)}return-1}}Ob.rjf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";
Ob.sjf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";Ob.tjf="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";Ob.mzl=
[new RegExp(Ob.rjf,"ig"),new RegExp(Ob.sjf,"ig"),new RegExp(Ob.tjf,"ig")];Ob.Gfg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Ob.Jfg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";Ob.Ifg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
Ob.Hfg=Ob.Jfg+"|"+Ob.Ifg;Ob.Kfg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Ob.Lfg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";Ob.Mfg="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
Ob.Nfg="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";Ob.M$f="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
Ob.Hfg+"|"+Ob.Kfg+"|"+Ob.Lfg+")";Ob.L$f="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
Ob.Mfg+")";Ob.sRf=Ob.Gfg+"|"+Ob.Nfg;Ob.Ffg=Ob.sRf+"|"+Ob.M$f+"|"+Ob.L$f;Ob.xWh=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");Ob.sBo=new RegExp(Ob.Ffg,"g");Object(n.a)(Ob,"ProofingSentenceSeparatorScriptSharp",null,[801]);class Vb{idd(b,h){const v=[];let D;for(;null!=(D=h.exec(b));){const P=D.index;v.push({begin:P,end:P+D[0].length})}return v}isEndPuncSpecialCase(b){return this.idd(b,Vb.ISj).some(h=>
h.end==b.length)}GLc(b){for(const h of Vb.YOj){const v=this.idd(b,h);if(0<v.length&&0==v[0].begin)return v[0].end-1}return 0}findBeginBoundary(b,h,v){var D=b.substring(v,h);b=this.idd(D,Vb.qrg);for(h=b.length-1;0<=h;h--){const P=D.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(P))return D=D.substring(b[h].begin,D.length),v+b[h].end+this.GLc(D)}return v}findEndBoundary(b,h,v){var D=b.substring(h,v);b=this.idd(D,Vb.qrg);for(v=0;v<b.length;v++){const P=D.substring(0,b[v].end);if(!this.isEndPuncSpecialCase(P))return D=
D.substring(b[v].begin,D.length),h+b[v].end+this.GLc(D)}return-1}}Vb.JNj="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";Vb.DSj="[\u2639\u263a\u263b]";Vb.Ctg="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";Vb.KOj="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
Vb.sRj="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";Vb.bug="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
Vb.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
Vb.Btg="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";Vb.mQj="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";Vb.lQj="[\uff21-\uff3a\uff41-\uff5a]";Vb.jQj="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
Vb.iQj="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";Vb.kQj="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";Vb.Bqe="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";Vb.prg="[\u3002\uff61]";Vb.Edd="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";Vb.ePj="[\u00bb\u2019\u201d\u203a\"']";Vb.Vqe=Vb.JNj+"|"+Vb.DSj;Vb.nQj="[\u2028\u2029\n\r]";Vb.hQj="("+Vb.Edd+"|"+Vb.Ctg+"|"+Vb.bug+"|"+Vb.Btg+
")";Vb.gQj="("+Vb.Edd+"|"+Vb.Ctg+"|"+Vb.bug+"|"+Vb.Symbol+"|"+Vb.Btg+"|"+Vb.KOj+"|"+Vb.sRj+")";Vb.rjf="("+Vb.Bqe+"("+Vb.Vqe+"|"+Vb.ePj+"|"+Vb.Edd+")*"+Vb.nQj+")";Vb.sjf="("+Vb.Bqe+"("+Vb.Vqe+")*("+Vb.Edd+")+)";Vb.tjf="("+Vb.prg+"("+Vb.Vqe+")*)";Vb.YOj=[new RegExp(Vb.rjf,"ig"),new RegExp(Vb.sjf,"ig"),new RegExp(Vb.tjf,"ig")];Vb.Gfg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Vb.Jfg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
Vb.Ifg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";Vb.Hfg=Vb.Jfg+"|"+Vb.Ifg;Vb.Kfg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Vb.Lfg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
Vb.Mfg="(("+Vb.mQj+"|"+Vb.jQj+"|"+Vb.kQj+")[.])+|(("+Vb.iQj+")[.\ufe52\uff0e])+";Vb.Nfg="("+Vb.lQj+")[.\ufe52\uff0e]";Vb.M$f=Vb.hQj+"("+Vb.Hfg+"|"+Vb.Kfg+"|"+Vb.Lfg+")";Vb.L$f=Vb.gQj+"("+Vb.Mfg+")";Vb.sRf=Vb.Gfg+"|"+Vb.Nfg;Vb.Ffg=Vb.sRf+"|"+Vb.M$f+"|"+Vb.L$f;Vb.qrg=new RegExp(Vb.Bqe+"|"+Vb.prg,"ig");Vb.ISj=new RegExp(Vb.Ffg,"g");Object(n.a)(Vb,"ProofingSentenceSeparator",null,[801]);class ob{constructor(){this.W=null}get name(){return"Box4.ProofingGrammarCheck"}xc(b){this.W=b;w.AFrameworkApplication.K.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new Vb).singleInstance():b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new Ob).singleInstance()}init(){this.W.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){N.a.instance.Fc(new ob)}}Object(n.a)(ob,"Box4GrammarCheckPackage",null,[1,2]);var Xb=c(100),Xa=c(9),Pb=c(60),rc=c(1826);class Ta{constructor(){this.W=null}get name(){return"Box4.AtMentions"}xc(b){this.W=b;this.W.ha("Box4.AtMentions.IAtMentionsListener",()=>
new rc.a(this.W.resolve("Box4.IEditingDomManager"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.BackspaceDeleteEventSource"),Pb.InteractiveViewManager.instance)).singleInstance()}init(){w.AFrameworkApplication.K.Po(()=>{this.W.resolve("Box4.AtMentions.IAtMentionsListener").deb(Xa.App.xa.ib,Xb.KeyInputManager.instance)})}dispose(){this.W.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){N.a.instance.Fc(new Ta)}}Object(n.a)(Ta,"Box4AtMentionsPackage",null,[1,
2]);class Ab{get name(){return"Box4.Workers"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new Ab)}}Object(n.a)(Ab,"Box4WorkersPackage",null,[1,2]);var Db=c(303),ac=c(77);class Pa{constructor(){this.gJa=new ac.a}g5(b,h){this.gJa.Z(b,h)}tnf(b){({value:b}=this.gJa.Dc(b));return b}}Object(n.a)(Pa,"AggregationMethodsForActivityName",null,[]);var bb=c(247);class lc{constructor(){this.esd=new Db.a;this.gJa=new Db.a}g5(b,h,v){this.gJa.mb(b)&&this.gJa.J(b)||this.gJa.Z(b,new Pa);this.gJa.J(b).g5(h,
v)}tnf(b,h){return this.gJa.mb(b)&&this.gJa.J(b)?this.gJa.J(b).tnf(h):null}BPc(b){this.esd.mb(b)&&this.esd.J(b)||this.esd.Z(b,new bb.a);return this.esd.J(b)}nPh(b,h){this.BPc(b).add(h)}}Object(n.a)(lc,"ActivityAggregationInfo",null,[823]);var rb=c(111),La=c(987),sb=c(1012);class Sb extends La.a{constructor(b,h){super(b);this.FWe=(this.IVj=h)?h.aYl():sb.a.enf()}get bCa(){return this.IVj}get activityName(){return this.bCa.name}get startTime(){return this.bCa.startTime}get endTime(){return this.bCa.endTime}end(){}cancel(){}Ylf(){}JWo(){this.c7b.Z("AM",
this.bCa.mode.toString());this.c7b.Z("C",this.bCa.count.toString());this.c7b.Z("DA",this.bCa.TUh.toFixed(2));this.c7b.Z("DV",this.bCa.$sl.toFixed(2))}rtf(b){return this.bCa.rtf(b)}Ztf(){return this.bCa.Ztf()}L0b(){for(let b of this.bCa.cCa)b.L0b()}}Object(n.a)(Sb,"AggregatedActivity",La.a,[]);class kc{constructor(b,h){this.Vse=0;this.Bza=b;this.TUa=h}HBk(b,h){this.Vse=h;for(h=0;h<b.count;h++){const v=b.J(h);this.IBk(v)}}IBk(b){const h=Object(Na.a)(Sb,b);if(h)if(1===this.Vse)this.GBk(h);else if(2===
this.Vse){this.JBk(h);for(let v of this.TUa.BPc(this.Bza)){const D=h.bCa.cCa.J(0);D.properties.mb(v)&&b.properties.Z(v,D.properties.J(v))}}}GBk(b){for(let h of this.TUa.BPc(this.Bza))this.ygj(b,h)}JBk(b){for(let h of b.Ztf())this.ygj(b,h)}ygj(b,h){const v=this.TUa.tnf(this.Bza,h);if(v){const D=b.rtf(h);b.properties.Z(h,v(D))}}}Object(n.a)(kc,"PropertyAggregationHelper",null,[]);var Lb=c(1075);class Qc{constructor(b,h,v,D,P){this.FSb=b;this.TUa=h;this.RPg=P;this.Dse=D;this.Z$j=v}get inh(){return this.Z$j.value}rHc(b){if(Object(rb.a)(Lb.a,
b))b.rHc();else if(Object(rb.a)(Sb,b)&&this.Dse.hBh(b.activityName.toString())){b=Object(Na.a)(Sb,b);b.JWo();b=b.ZMi();var h=[];Array.add(h,b);b=E.c(h);u.ULS.sendTraceTag(6907266,213,50,b)}}iCa(b,h){const v=(new Date).getTime();var D=this.RPg.list.J(b);const P=({LBk:D}=this.vMl(D)).returnValue;this.RPg.list.Z(b,new Fb.a);h&&(D=this.Q8k(D,v,this.FSb.ali));0<D.count&&(new kc(b,this.TUa)).HBk(D,P)}Q8k(b,h,v){const D=new Fb.a;for(let P=0;P<b.count;P++){const ca=b.J(P);ca.startTime>h-v?ca.L0b():D.add(ca)}return D}vMl(b){const h=
this.inh.Hzj(b);b=this.inh.TKo(b);const v=this.MBk(h,b);return{returnValue:v,LBk:1===v?h:b}}MBk(b,h){return b.count*this.FSb.tPi<h.count?1:2}get enabled(){return this.FSb.enabled}L0b(){}}Object(n.a)(Qc,"ActivityAggregationManager",null,[822]);class Dc{constructor(b){this.enabled=!1;this.KNi=500;this.ZOi=2;this.tPi=5;this.ali=3E4;this.QLc(b.appSettings)}QLc(b){this.enabled=Boolean.parse(b[Dc.Mhf]||"false");this.KNi=parseInt(b[Dc.Tbn]||"500");this.ZOi=parseInt(b[Dc.Ben]||"2");this.tPi=parseInt(b[Dc.$en]||
"5");this.ali=parseInt(b[Dc.ylm]||"30000")}}Dc.Mhf="ActivityAggregationEnabled";Dc.Tbn="ActivityAggregationMaxInterval";Dc.Ben="ActivityAggregationMinChain";Dc.$en="ActivityAggregationModeFactor";Dc.ylm="ActivityAggregationGraceWindow";Object(n.a)(Dc,"ActivityAggregationParams",null,[]);class Fd{constructor(b,h){this.TUa=b;this.eLg=h}Hzj(b,h=1){if(!b||!b.count)return b;const v=new Fb.a;var D=null;for(let P=0;P<b.count;P++){const ca=b.J(P);if(!ca)continue;const ta=ca.activityName;D?D.nWm(ca)?D.add(ca):
(D=D.process(),v.addRange(D),D=this.eLg(ta,h),D.add(ca)):(D=this.eLg(ta,h),D.add(ca))}D&&(b=D.process(),v.addRange(b));return v}TKo(b){if(!b||!b.count)return b;const h={};var v=null;for(let P=0;P<b.count;P++){const ca=b.J(P);if(ca){if(!v){v=new Fb.a;var D=this.TUa.BPc(ca.activityName);for(let ta of D)v.add(ta)}D=this.I$l(ca,v);null!==D&&(D in h&&h[D]||(h[D]=new Fb.a),h[D].add(ca))}}b=new Fb.a;for(const P of jb.a.GO(h))v=this.Hzj(h[P],2),b.addRange(v);return b}I$l(b,h){let v="";for(let D of h)v+=D,
v=b.properties.mb(D)&&void 0!==b.properties.J(D)&&null!==b.properties.J(D)?v+b.properties.J(D):v+"null";return v}}Object(n.a)(Fd,"ActivityAggregationSchemes",null,[820]);class pe{constructor(b,h,v,D,P){this.es=this.gi=0;this.FSb=v;this.Ioc=D;this.TUa=P;this.name=b;this.Ty=h;this.cCa=new Fb.a}get mode(){return this.Ty}get count(){return this.cCa.count}get startTime(){return this.gi}get endTime(){return this.es}get TUh(){if(!this.count)return 0;let b=0;for(let h of this.cCa)b+=h.endTime-h.startTime;
return b/this.count}get $sl(){if(!this.count)return 0;let b=0;const h=this.TUh;for(let v of this.cCa){const D=v.endTime-v.startTime;b+=(D-h)*(D-h)}return b/this.count}add(b){this.count?this.es=b.endTime>this.endTime?b.endTime:this.endTime:(this.gi=b.startTime,this.es=b.endTime);this.cCa.add(b)}nWm(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.FSb.KNi}process(){if(this.count>=this.FSb.ZOi){const b=new Fb.a,h=this.Ioc(this);b.add(h);return b}return this.cCa}rtf(b){const h=new Fb.a;for(let v of this.cCa)if(v.properties.mb(b)){const D=
v.properties.J(b);h.add(D)}else h.add(null);return h}Ztf(){const b=this.TUa.BPc(this.name),h=new bb.a;for(let v of this.ZMl())b.contains(v)||h.add(v);return h}ZMl(){const b=new bb.a;if(!this.cCa)return b;for(let h of this.cCa)for(let v of h.properties.keys)b.add(v);return b}aYl(){return this.cCa.J(0).uniqueID}}Object(n.a)(pe,"ActivityCollection",null,[819]);class ye{constructor(){this.esb=new Db.a}get list(){return this.esb}add(b){const h=b.activityName;if(this.esb.mb(h)&&this.esb.J(h)){const v=this.k0l(this.esb.J(h),
b);this.esb.J(h).insert(v,b)}else this.esb.Z(h,new Fb.a),this.esb.J(h).add(b)}k0l(b,h){for(let v=b.count-1;0<=v;v--)if(h.startTime>b.J(v).startTime)return v+1;return 0}}Object(n.a)(ye,"CompletedActivitiesHelper",null,[818]);class pf{constructor(){this.W=null}get name(){return"Common.App.ActivityAggregator"}init(){w.AFrameworkApplication.cI(()=>{this.W.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}xc(b){this.W=b;const h=D=>new Sb(()=>b.Na("Common.App.Activities.IActivityAggregationManager"),
D),v=(D,P)=>new pe(D,P,b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),h,b.resolve("Common.IActivityAggregationInfo"));b.register(Qc,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").singleInstance().Rd(()=>new Qc(b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b.resolve("Common.IActivityAggregationInfo"),b.Ue("Common.App.ActivityAggregator.IActivityAggregationSchemes"),b.resolve("Common.App.Activities.IActivityThrottler"),
b.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));b.register(Dc,"Common.App.ActivityAggregator.ActivityAggregationParams").singleInstance().Rd(()=>new Dc(w.AFrameworkApplication.K));b.register(lc,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").singleInstance().Rd(()=>new lc);b.register(Fd,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").singleInstance().Rd(()=>
new Fd(b.resolve("Common.IActivityAggregationInfo"),v));b.register(ye,"Common.App.ActivityAggregator.CompletedActivitiesHelper").singleInstance().Rd(()=>new ye)}static main(){N.a.instance.Fc(new pf)}}Object(n.a)(pf,"ActivityAggregatorPackage",null,[1,2]);var Yf=c(525),Ed=c(11),Rc=c(1389);class Yc{constructor(b){this.Ebh=0;this.uve=null;this.ehk=b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get Scg(){return this.ehk.value}Tb(){this.isInitialized?this.lhc():this.EXn(Object(z.a)(this,
this.lhc,"registerActionsInternal"))}lhc(){u.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(b=>{b.getChatsContainer(Object(z.a)(this,this.Qmn,"onChatContainerReady"))}).catch(b=>{u.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",b)}),this.chat.getChatsCounter().then(b=>{b.onChatsCountChange(Object(z.a)(this,this.LVk,"chatCountChanged"))}).catch(b=>{u.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",
b)}),this.chat.getKeyboard().then(b=>{b.onKeyDown(Object(z.a)(this,this.Tmn,"onChatKeyPress"))}).catch(b=>{u.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",b)}))}catch(b){u.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",b)}}LVk(b){u.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",b);if(!b)this.Scg.Pmn();else if(1===b&&!this.Ebh){const h=document.getElementById(this.uve?this.uve:Rc.a.IAb);h?this.Scg.Umn(h,Object(z.a)(this,this.FNo,"transferFocusToChat")):
u.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.Ebh=b}Qmn(b){this.uve=b}Tmn(b){b.ctrlKey&&"f6"===b.key.toLowerCase()&&this.ENo(b.shiftKey)}EXn(b){Yf.a.instance.nb(Ed.a.MGo,window.self,()=>{b();return!0})}FNo(){u.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(b=>{b.focusConversationInput()}).catch(b=>{u.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",b)})}catch(b){u.ULS.sendTraceTag(50595974,
333,10,"Failed to transfer focus to chat: {0}",b)}}ENo(b){u.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.Scg.Rmn(b)}}Object(n.a)(Yc,"ChatManager",null,[798]);var Mc=c(80);class ge{constructor(){this.ra=new Mc.a;this.znk=!1}kzk(b){this.ra.addHandler("OnTopRowControlsCreatedEvent",b)}Vyk(b){this.ra.addHandler("OnRenameTextboxStatusChangedEventKey",b)}get yMo(){return this.znk}Q6i(b){this.ra.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(n.a)(ge,
"HeaderEventSource",null,[]);var Ne=c(171),Ee=c(331),Ve=c(79);class mc{constructor(b,h,v,D,P){this.hxd=null;this.Ub=b;this.fp=h;this.sk=v;this.Cnk=D;this.ga=P}x9i(b,h,v,D=null){const P=this.Ub.fe(h);P.parent=v;P.RH=!0;D&&P.m7(D);this.sk.dCa(h,b,!1);this.Cnk.dCa(h,b,!1);h=new Ee.DOMFocusListing(()=>b);h.Wm(2);h.Wm(1);h.Wm(8);h.Wm(5);h.Wm(3);h.Wm(6);this.Ub.hma(()=>b,P,h).oR=!0;h=Xb.KeyInputManager.jc(Ve.a.Dw,0);v=Xb.KeyInputManager.jc(Ve.a.Dw,4);P.jr(h);P.jr(v)}onFlexPaneOpen(b){this.x9i(b,Rc.a.Tdc,
Rc.a.CPa);this.Ub.mg(Rc.a.Tdc);this.fp.Jaa(Rc.a.Tdc)}onFlexPaneClose(){this.fp.Xw(Rc.a.Tdc);this.Ub.mg(Rc.a.CPa)}Umn(b,h){this.hxd||(this.hxd=h,this.x9i(b,Rc.a.IAb,Ne.AFrame.eM,Object(z.a)(this,this.Smn,"onChatFocus")));this.Ub.mg(Rc.a.IAb);this.fp.Jaa(Rc.a.IAb)}Smn(){this.hxd&&this.hxd()}Pmn(){this.fp.Xw(Rc.a.IAb);this.Ub.uNd(Ne.AFrame.Pn)}Rmn(b){this.ga.processAction(b?Wa.a.Kjf:Wa.a.Dqe,2)}}Object(n.a)(mc,"ReactSharedHeaderFocusManager",null,[797]);var Oc=c(126),xd=c(1047),Dd=c(39),ud=c(68);class He{constructor(b){this.ga=
b}Tb(){this.ga.qa(Wa.a.GNd,ud.a.frame,Object(z.a)(this,this.GQi,"navigateToUpsellPage"));this.ga.qa(Wa.a.xJl,ud.a.frame,Object(z.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.ga.qa(Wa.a.u5n,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.idj,ud.a.frame,Oc.ActionManager.Nf)}GQi(b,h,v,D,P){if(1===v)return 32;b=8;2===v&&(v=this.Eof(P,"experience","gopremiumribbon"),P=ia.a.t8("2116536"),P=ia.a.fo(P,"ocid",xd.b(w.AFrameworkApplication.ta.Nb.Tl,w.AFrameworkApplication.ta.Nb.Wha,v)),
Dd.a.om(P,"_blank",void 0,"NavigateToUpsellPage"),b=32,this.ga.processAction(Wa.a.idj,2),u.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return b}launchUpsellExperience(b,h,v,D,P){if(1===v)return 32;var ca=8;2===v&&(u.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(ca=Ea.a.instance.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(b=this.Eof(P,"experience","gopremium"),P=this.Eof(P,"dimeCampaignId",null),ca.launchUpsellExperience(b,P),ca=32):
(u.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),ca=this.GQi(b,h,v,D,P)));return ca}Eof(b,h,v){b&&b[h]&&(v=Object(Na.a)(String,b[h]));return v}}Object(n.a)(He,"UpsellActor",null,[796]);class uf{constructor(){this.W=null}get name(){return"Common.App.Header"}init(){Ea.a.instance.resolve("Common.App.Header.IUpsellActor").Tb();Ea.a.instance.resolve("Common.App.Header.IChatManager").Tb()}dispose(){}xc(b){this.W=b;this.W.register(ge,"Common.App.Header.HeaderEventSource").singleInstance();
this.W.register(He,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").singleInstance().Rd(()=>new He(w.AFrameworkApplication.va));this.W.register(mc,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").singleInstance().Rd(()=>new mc(w.AFrameworkApplication.ta.Ap,w.AFrameworkApplication.ta.ox,w.AFrameworkApplication.ta.k1,w.AFrameworkApplication.ta.Ule,w.AFrameworkApplication.va));this.W.register(Yc,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").singleInstance().Rd(()=>
new Yc(this.W.Ue("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){N.a.instance.Fc(new uf)}}Object(n.a)(uf,"CommonAppHeaderPackage",null,[1,2]);var Lh=c(745);class Sf{static P4h(b,h){switch(b){case 3:return Sf.tkm(h);case 2:return Sf.l7l(h);case 1:return Sf.KWl(h)}return""}static tkm(b){switch(b){case 1:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static l7l(b){switch(b){case 1:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static KWl(b){switch(b){case 1:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return w.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(b,h,v){if(aa.a.ti||aa.a.EM)window.setTimeout(()=>{Sf.N8i(v,Sf.nTd())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Sf.$sh(v),b,0,!1)}static l_k(b,h,v,D){h&&
D&&D();Sf.openInClient(b,h,v)}static nTd(){return aa.a.ti?1:aa.a.EM?2:aa.a.B3a?3:aa.a.Wk?4:0}static akm(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static bkm(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get HEf(){return"zh-CN"===window.navigator.language}static N8i(b,h){1===h?(u.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),b=Sf.P4h(b,h),8<aa.a.b2a?Dd.a.om(b,void 0,void 0,"RedirectToAppStore"):Dd.a.EDb(b)):document.hidden||(Sf.HEf?(b=w.AFrameworkApplication.K.appSettings.WildFireUrlChinaStoreAndroid.toString())?(u.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),Dd.a.EDb(b)):u.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(u.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(Sf.P4h(b,
h),null,null)))}static $sh(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get Iie(){return(aa.a.B3a||aa.a.Wk)&&aa.a.Aq}static get cvo(){return aa.a.ti||aa.a.EM}static i5h(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static ozi(b){return(b=Sf.d1l(b))&&""!==b?Boolean.parse(b):!1}static lcg(b){Sf.Qko(b)}static d1l(b){try{return localStorage.getItem(b)}catch(h){return u.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}}static Qko(b){try{localStorage.setItem(b,"true")}catch(h){u.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}}}Sf.QDh="ChromeExtensionBarDismiss";Object(n.a)(Sf,"WildFireUtilities",null,[]);var fc=c(364);class yc{constructor(){this.lte=new fc.a;this.jte=new fc.a;this.ite=new fc.a;this.yNk(this.lte);this.xNk(this.jte);this.wNk(this.ite);this.QDe=new fc.a;
this.PDe=new fc.a;this.ODe=new fc.a;this.cQk(this.QDe);this.bQk(this.PDe);this.aQk(this.ODe);this.Mve=new fc.a;this.KNk(this.Mve);this.hzb(this.Mve);this.hzb(this.ite);this.hzb(this.jte);this.hzb(this.lte);this.hzb(this.PDe);this.hzb(this.QDe);this.hzb(this.ODe)}zSd(b,h){switch(b){case 1:return this.jlm(h);case 2:return this.xNl(h)}return Sf.Iie?this.Mve:null}yNk(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}xNk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}wNk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}cQk(b){b.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1",
"Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}KNk(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}bQk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}aQk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}hzb(b){b.add("Corporation","Microsoft Corporation")}jlm(b){switch(b){case 3:return this.QDe;case 2:return this.PDe;case 1:return this.ODe}return null}xNl(b){switch(b){case 3:return this.lte;case 2:return this.jte;case 1:return this.ite}return null}static get instance(){yc._instance||
(yc._instance=new yc);return yc._instance}}yc._instance=null;Object(n.a)(yc,"WildFireStringFactory",null,[]);class Uc{constructor(b,h,v,D,P=null,ca=null){this.GMe=null;this._id=b;this.iOe=h;this.C5j=P;this.qvc=D;this.EAc=ca;this.i9a=null;this.YCc=v;this.NBc=yc.instance.zSd(h,b)}b$k(){this.i9a=new Lh.a(this.title,this.message,null);this.i9a.addButton(this.tQk,Object(z.a)(this,this.xmn,"onButtonOneClick"),"");this.YCc&&this.i9a.rph(this.zQk,Object(z.a)(this,this.Cmn,"onButtonTwoClick"));this.i9a.qma=
Object(z.a)(this,this.$ol,"dismissBar");this.i9a.image=3;this.i9a.id=16;this.i9a.closeable=!0}get title(){return this.NBc.J("Headline")}get message(){return this.NBc.J("CallToAction")}get tQk(){return this.YCc?this.NBc.J("InstallButton"):this.NBc.J("UseAppButton")}get zQk(){return this.YCc?this.NBc.J("OpenAppButton"):""}xmn(){this.YCc?this.cEm():this.W0o()}Cmn(){this.YCc&&this.qxn()}get nzh(){return this.i9a}get T4a(){this.GMe||(this.GMe=this.C5j());return this.GMe}cEm(){u.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.qvc&&this.EAc&&this.EAc();Sf.N8i(this._id,this.iOe)}qxn(){this.T4a&&(u.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.qvc&&this.EAc&&this.EAc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Sf.$sh(this._id),this.T4a,0,!1))}W0o(){Sf.Iie?this.pQk():(u.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),Sf.lcg("BizBarClicked"),1!==this.iOe&&2!==this.iOe||Sf.l_k(this.T4a,this.qvc,this._id,this.EAc))}pQk(){this.qvc?
u.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):u.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Dd.a.EDb(w.AFrameworkApplication.K.appSettings.WildFireChromeExtensionUrl.toString())}apl(){this.qvc?u.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):u.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");Sf.lcg(Sf.QDh)}$ol(){Sf.Iie?this.apl():(Sf.lcg(Sf.i5h(this._id)),u.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static acf(){const b=w.AFrameworkApplication.ta.Nb;
new Uc(b.Tl,Sf.nTd(),8<aa.a.b2a,1===b.Wha,()=>b.Mfa,b.j9f());u.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(n.a)(Uc,"WildFireBusinessBar",null,[]);class zd{get name(){return"Common.App.WildFire"}eZe(b){const h=w.AFrameworkApplication.ta.Nb;let v=!1;b&&(b.b$k(),b.nzh&&(v=h.Ola(b.nzh,!0)));return v}g$k(){var b=w.AFrameworkApplication.ta.Nb;b=new Uc(b.Tl,Sf.nTd(),!1,1===b.Wha);this.eZe(b)&&u.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}acf(b,h,v,D,P,ca){b=new Uc(b,
v,D,h,P,ca);this.eZe(b)&&u.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}dgl(){const b=w.AFrameworkApplication.ta.Nb;var h=w.AFrameworkApplication.K;const v=b.Tl,D=1===b.Wha;if(h.$(Sf.akm(v))){var P=Sf.nTd(),ca=8<aa.a.b2a;if(2!==v||2!==P||!D){h=h.$(Sf.bkm(v));var ta=b.j9f(),Ra=()=>b.Mfa;h&&!Sf.ozi(Sf.i5h(v))&&this.acf(v,D,P,ca,Ra,ta)}}}init(){var b=w.AFrameworkApplication.K;const h=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&h;Sf.Iie&&b&&!Sf.ozi(Sf.QDh)?
this.g$k():(document.body&&Sf.cvo&&this.dgl(),w.AFrameworkApplication.va.qa(Wa.a.aJf,ud.a.frame,Object(z.a)(this,this.aJf,"launchWildFireBusinessBar")))}aJf(b,h,v,D,P){if(1===v)return 32;if(!P)return 8;this.acf(P.app,P.mode,P.platform,P.useTwoButton,null,null);return 32}dispose(){}xc(){}static main(){N.a.instance.Fc(new zd)}}Object(n.a)(zd,"PackageManager",null,[1,2]);class ie{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(n.a)(ie,"BrowserInfo",null,[]);class Oe{constructor(){this.Version=
this.Name=null}}Object(n.a)(Oe,"PluginInfo",null,[]);class Ge{static zca(){if(w.AFrameworkApplication.K.$("LogBrowserInfoIsEnabled")){var b=Ge.UJl();try{const h=JSON.stringify(b);u.ULS.sendTraceTag(6903563,102,50,h)}catch(h){u.ULS.sendTraceTag(6903564,102,15,h.message)}}else u.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static s9l(){const b=window.navigator.plugins;if(!b||!b.length)return null;const h=[];for(let v=0;v<b.length;v++){const D=b[v].name,P=b[v].version;
Array.add(h,Object.assign(new Oe,{Name:D,Version:P}))}return h}static UJl(){const b=new ie,h=new Sys.StringBuilder;Ge.IH(v=>{b.DocElemClientHeight=v},()=>document.documentElement.clientHeight,h);Ge.IH(v=>{b.DocElemClientWidth=v},()=>document.documentElement.clientWidth,h);Ge.IH(v=>{b.DocElemOffsetHeight=v},()=>document.documentElement.offsetHeight,h);Ge.IH(v=>{b.DocElemOffsetWidth=v},()=>document.documentElement.offsetWidth,h);Ge.IH(v=>{b.ScreenAvailHeight=v},()=>window.screen.availHeight,h);Ge.IH(v=>
{b.ScreenAvailWidth=v},()=>window.screen.availWidth,h);Ge.IH(v=>{b.ScreenWidth=v},()=>window.screen.width,h);Ge.IH(v=>{b.ScreenHeight=v},()=>window.screen.height,h);Ge.IH(v=>{b.ScreenLogicalXdpi=v},()=>window.screen.logicalXDPI,h);Ge.IH(v=>{b.ScreenLogicalYdpi=v},()=>window.screen.logicalYDPI,h);Ge.IH(v=>{b.ScreenDeviceXdpi=v},()=>window.screen.deviceXDPI,h);Ge.IH(v=>{b.ScreenDeviceYdpi=v},()=>window.screen.deviceYDPI,h);Ge.IH(v=>{b.WinInnerHeight=v},()=>window.self.innerHeight,h);Ge.IH(v=>{b.WinInnerWidth=
v},()=>window.self.innerWidth,h);Ge.IH(v=>{b.WinOuterHeight=v},()=>window.self.outerHeight,h);Ge.IH(v=>{b.WinOuterWidth=v},()=>window.self.outerWidth,h);Ge.IH(v=>{b.WinOrientation=v},()=>window.self.orientation,h);Ge.IH(v=>{b.WinDevicePixelRatio=v},()=>window.self.devicePixelRatio,h);Ge.IH(v=>{b.SupportsTouch=v},()=>aa.a.Z9c,h);Ge.IH(v=>{b.NavAppName=v},()=>window.navigator.appName,h);Ge.IH(v=>{b.NavAppVersion=v},()=>window.navigator.appVersion,h);Ge.IH(v=>{b.NavLanguage=v},()=>window.navigator.browserLanguage||
window.navigator.language,h);Ge.IH(v=>{b.NavUserAgent=v},()=>window.navigator.userAgent,h);Ge.IH(v=>{b.NavPlatform=v},()=>window.navigator.platform,h);Ge.IH(v=>{b.NavPlugins=v},Ge.s9l,h);Ge.IH(v=>{b.CalculatedDevicePixelRatio=v},()=>Ge.devicePixelRatio,h);b.Error=h.toString();return b}static get devicePixelRatio(){const b=window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static IH(b,h,v){try{const D=h();b(D)}catch(D){v.isEmpty()||v.append(" | "),v.append(D.message||
"null")}}}Object(n.a)(Ge,"BrowserInfoLogger",null,[]);class re{get name(){return"Common.App.BrowserInfoLogger"}xc(){}init(){Ge.zca()}dispose(){}static main(){N.a.instance.Fc(new re)}}Object(n.a)(re,"BrowserInfoLoggerPackage",null,[1,2]);class mf{constructor(){this.ra=new Mc.a}Idb(b){this.ra.addHandler("OnEditHappenedEvent",b)}R4c(b){this.ra.removeHandler("OnEditHappenedEvent",b)}GOn(){this.ra.raiseEvent("OnEditHappenedEvent")}}Object(n.a)(mf,"EditNotificationEventSource",null,[]);var Xe=c(44),qf=
c(90);class kf{constructor(b,h,v,D,P,ca,ta=0){this.Lze=!1;this.Kze=this.Uvb=null;this.Tkh=!1;this.Gb=h;this.Qpd=b;this.sab=v;this.nea=D;this.Rkh=P;this.l2j=ca;this.jid=0;this.okd=!1;try{0<ta&&(this.jid=ta,3E5>this.jid&&(this.jid=3E5),this.Gb&&!this.Kze&&(this.Kze=new qf.a(3,2,this.jid,Object(z.a)(this,this.o5n,"reportEditDocumentUserActionTelemetryIfNecessary")),this.Gb.Vb(this.Kze)))}catch(Ra){u.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+
Ra)}}get hog(){return this.Tkh}editHappened(){this.hog?this.okd=!0:(this.Tkh=!0,va.Health.instance.addQosPillar("Save"),va.Health.instance.addQosPillar("ContentCreation"),Xe.c(Wa.a.editDocument));this.Lze=!0;this.Rkh&&this.Rkh.lnh();this.nea&&this.nea.GOn();w.AFrameworkApplication.Lg&&w.AFrameworkApplication.Lg.zan();this.l2j&&!this.Uvb&&(this.S6c(null),this.Uvb=new qf.a(3,2,this.Qpd,Object(z.a)(this,this.S6c,"sendPostMessageIfNecessary"),113),this.Gb.Vb(this.Uvb))}S6c(){this.Lze&&(this.sab.CWR(()=>
this.sab.result.sendMessage(L.a.editNotification,null)),u.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.Lze=!1)}o5n(){try{this.okd&&(Xe.c(Wa.a.editDocument),this.okd=!1)}catch(b){this.okd=!1,u.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+b)}}}Object(n.a)(kf,"EditNotificationManager",null,[799]);class $f{constructor(b,h,v,D,P){this.QCe=this.Uvb=null;this.GVb=this.zse=!1;this.Gb=h;this.Qpd=
b;this.sab=v;this.sk=D;this.$Le=P;this.E9i(null)}E9i(){const b=document.getElementById(w.AFrameworkApplication.u1b);!this.GVb&&this.sk&&b&&(this.sk.nb(Ed.a.s0,b,Object(z.a)(this,this.RNf,"mouseActivityHandler"),null),this.GVb=!0);this.$Le(()=>{this.dispose()})}RNf(){this.GVb&&(this.sk.sc(Ed.a.s0,document.getElementById(w.AFrameworkApplication.u1b),Object(z.a)(this,this.RNf,"mouseActivityHandler")),this.GVb=!1);this.lnh();return!1}lnh(){this.zse=!0;this.QCe||(this.QCe=new qf.a(3,2,this.Qpd,Object(z.a)(this,
this.E9i,"registerHandlerTask"),112),this.Gb.Vb(this.QCe));this.Uvb||(this.S6c(null),this.Uvb=new qf.a(3,2,this.Qpd,Object(z.a)(this,this.S6c,"sendPostMessageIfNecessary"),111),this.Gb.Vb(this.Uvb))}S6c(){this.zse&&(this.sab.CWR(()=>this.sab.result.sendMessage(L.a.w1o,null)),u.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.zse=!1)}dispose(){this.GVb&&(this.sk.sc(Ed.a.s0,document.getElementById(w.AFrameworkApplication.u1b),Object(z.a)(this,
this.RNf,"mouseActivityHandler")),this.GVb=!1)}}Object(n.a)($f,"UserActivityHostNotificationManager",null,[800,10]);var xf=c(188),Qg=c(108),zb=c(623);class Yb{constructor(){this.W=null}get name(){return"Common.App.EditNotification"}init(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.Po(Object(z.a)(this,this.Px,"onFullAppSettingsReady"))}Px(){Yb.wtl&&0<Yb.$gf&&(this.W.register(mf,"Common.App.HostNotification.EditNotificationEventSource").singleInstance(),this.W.register($f,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").singleInstance().Rd(()=>
new $f(6E4,Qg.a.instance,zb.a.zp(this.W.Sa("Postmessage.IHostPostmessenger")),xf.a.instance,w.AFrameworkApplication.cI)),this.W.register(kf,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").singleInstance().Rd(()=>new kf(Yb.$gf,Qg.a.instance,zb.a.zp(this.W.Sa("Postmessage.IHostPostmessenger")),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.W.Na("Common.Interface.IUserActivityHostNotificationManager"),Yb.xtl,Yb.ptl)),
this.W.resolve("Common.Interface.IEditNotificationManager"),u.ULS.shipAssertTag(38086291,209,0<Yb.$gf,"EditNotification Interval is less than or equal to 0."))}xc(b){this.W=b}dispose(){}static get $gf(){return w.AFrameworkApplication.K?parseInt(w.AFrameworkApplication.K.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get ptl(){return w.AFrameworkApplication.K?parseInt(w.AFrameworkApplication.K.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get wtl(){return!!w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.$("EditNotificationIsEnabled")}static get xtl(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("EditNotificationPostMessageIsEnabled")}static main(){N.a.instance.Fc(new Yb)}}Object(n.a)(Yb,"CommonHostNotificationPackage",null,[1,2]);class Tc{constructor(b,h,v){this.Oxb=null;this.Gb=b;this.ga=h;this.WVg=v.create()}Dnb(){this.Oxb?u.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(u.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),
this.Oxb=new qf.a(2,1,3E4,Object(z.a)(this,this.Vie,"showFloatPane"),67),this.Gb.Vb(this.Oxb))}Vie(){this.Oxb=null;u.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.WVg.display()}sSa(){this.ga.qa(Wa.a.Vie,ud.a.frame,Object(z.a)(this,this.mxo,"showFloatPaneHandler"))}mxo(b,h,v,D,P){return b!==Wa.a.Vie?2:1===v?32:2===v&&P?(u.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",P),P?this.Dnb():(this.Oxb?(u.ULS.sendTraceTag(23674914,
207,50,"Hide float pane via removing show task!"),this.Gb.Xe(this.Oxb)):(u.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.WVg.remove(null)),this.Oxb=null),32):8}}Object(n.a)(Tc,"FloatPaneActor",null,[803]);var Id=c(95),Xc=c(88),Le=c(38),cf=c(27);class Ig{constructor(b,h,v,D,P){this.rJe=this.luc=this.Psd=this.NXa=this.Oea=this.gVa=this.Fue=this.haa=this.Ryc=this.Mwc=this.Nwc=this.tBe=null;this.Gb=h;this.Fa=b;this.ig=v;this.W=P;this.Fza=D}jLh(){this.haa=document.createElement("div");
this.haa.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.haa.style.width=this.Oea.width+"px";(this.rJe=this.h6l(this.Fza))?(this.NXa=document.createElement("a"),this.NXa.setAttribute(cf.a.qh,cf.a.fz),this.ig.nb(Ed.a.click,this.NXa,Object(z.a)(this,this.iXi,"onRedirectClick")),this.NXa.href=this.rJe,this.NXa.target="_blank",this.NXa.appendChild(this.Oea),this.haa.appendChild(this.NXa)):this.haa.appendChild(this.Oea);this.gVa=document.createElement("a");this.gVa.setAttribute(cf.a.qh,
cf.a.j3);this.gVa.className="StandardButton WACFloatPaneCloseButton";this.gVa.title=CommonUIStrings.l_Close;this.gVa.tabIndex=-1;this.Fue=Xc.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.Fue.setAttribute(cf.a.qh,cf.a.fz);this.gVa.appendChild(this.Fue);this.ig.nb(Ed.a.click,this.gVa,Object(z.a)(this,this.onClose,"onClose"));this.haa.appendChild(this.gVa);this.Ryc.appendChild(this.haa)}W_l(b){const h=this.Fa.$("O365PromotionHasStarted");
switch(b){case 2:return Id.a.dba(String.format("adppt{0}.png",h?"sale":""));case 1:return Id.a.dba(String.format("adxls{0}.png",h?"sale":""));case 3:return Id.a.dba(String.format("addoc{0}.png",h?"sale":""))}return null}h6l(b){const h=this.Fa.jb("O365AdPaneRedirectedURL");switch(b){case 1:return String.format(h,"Excel");case 2:return String.format(h,"PowerPoint");case 3:return String.format(h,"Word")}return null}hide(b=null){this.luc=null;this.haa&&!this.Psd&&(b?u.ULS.sendTraceTag(23674904,207,50,
"The float pane is closed automatically."):u.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.haa.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.haa.style.height="0px",this.Psd=new qf.a(2,1,1E3,Object(z.a)(this,this.remove,"remove"),67),this.Gb.Vb(this.Psd))}remove(){this.haa&&this.Ryc&&(this.NXa&&this.ig.sc(Ed.a.click,this.NXa,Object(z.a)(this,this.iXi,"onRedirectClick")),this.ig.sc(Ed.a.click,this.gVa,Object(z.a)(this,this.onClose,
"onClose")),this.Ryc.removeChild(this.haa),this.haa=null);this.Psd=null}display(){if(this.tBe=this.W.Na("Common.IFloatPaneContainer"))if(this.Ryc=this.tBe.container){var b=this.W_l(this.Fza);b?(u.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.Oea=document.createElement("img"),this.Oea.className="WACFloatPaneImage",this.Nwc=Object(z.a)(this,this.krn,"onLoadImageFinish"),Le.a.addHandler(this.Oea,Ed.a.load,this.Nwc),this.Mwc=Object(z.a)(this,this.jrn,"onLoadImageError"),
Le.a.addHandler(this.Oea,Ed.a.error,this.Mwc),this.Oea.src=b):u.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else u.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else u.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}krn(){const b=this.Fa.mc("O365AdPaneShowingDuration",60);this.jLh();this.haa.style.display="block";this.haa.style.height=this.Oea.height+
"px";this.luc=new qf.a(2,1,1E3*b,Object(z.a)(this,this.hide,"hide"),67);this.Gb.Vb(this.luc);this.kaj()}jrn(){u.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.kaj();this.Oea=null}kaj(){this.Nwc&&this.Oea&&Le.a.removeHandler(this.Oea,Ed.a.load,this.Nwc);this.Nwc=null;this.Mwc&&this.Oea&&Le.a.removeHandler(this.Oea,Ed.a.error,this.Mwc);this.Mwc=null}iXi(){u.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");
return!1}onClose(){this.luc&&this.Gb.Xe(this.luc);this.hide();return!0}dispose(){this.hide()}}Object(n.a)(Ig,"FloatPane",null,[821]);class Ji{constructor(b,h,v,D,P){this.Gb=h;this.Fa=b;this.ig=v;this.W=P;this.Fza=D}create(){return new Ig(this.Fa,this.Gb,this.ig,this.Fza,this.W)}}Object(n.a)(Ji,"FloatPaneFactory",null,[804]);var Th=c(228);class Ah{constructor(){this.W=null}get name(){return"Common.App.FloatPane"}get Jxi(){return w.AFrameworkApplication.K.$("O365AdvertisementIsEnabled")&&w.AFrameworkApplication.K.$("IsShowAdvertisementPaneEnabled")}init(){this.Jxi&&
(u.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").Dnb(),u.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").sSa())}xc(b){this.W=b;this.Jxi&&(this.W.register(Ji,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Rd(()=>new Ji(w.AFrameworkApplication.K,w.AFrameworkApplication.nc,Th.a.instance,w.AFrameworkApplication.ta.Nb.Tl,
this.W)).singleInstance(),this.W.register(Tc,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Rd(()=>new Tc(w.AFrameworkApplication.nc,w.AFrameworkApplication.va,this.W.resolve("Common.App.FloatPane.IFloatPaneFactory"))).singleInstance())}dispose(){}static main(){N.a.instance.Fc(new Ah)}}Object(n.a)(Ah,"FloatPanePackage",null,[1,2]);var Pm=c(1658);class zf{}Object(n.a)(zf,"LokiTokenResult",null,[]);class lg{constructor(b){this.Ypd=b}Urf(){const b=this.m3l();return b?
lg.l3a?new Promise((h,v)=>{this.Ypd.continueWith(()=>{this.Ypd.yo||this.Ypd.Ai?v(Error.create("Error downloading auth library")):this.Ypd.result.PY("Loki",b).then(D=>{D=w.AFrameworkApplication.K.$("ForceLokiFallbackToACLPTokenIsEnabled")?this.p3l():D.IsSuccess&&D.Token?Object.assign(new zf,{isSuccess:!0,token:D.Token,errorMessage:null}):Object.assign(new zf,{isSuccess:!1,token:null,errorMessage:JSON.stringify(D)});h(D);return D})})}):Promise.resolve(Object.assign(new zf,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):
Promise.resolve(Object.assign(new zf,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",Pm.a.X4h())}))}p3l(){const b=w.AFrameworkApplication.K.jb("LokiUserDataSignature")||"";return Object.assign(new zf,{isSuccess:!0,token:b,errorMessage:null})}m3l(){let b=null;const h=Pm.a.iOd();2===h?b=w.AFrameworkApplication.K.jb("LokiAADAppId"):1===h&&(b=w.AFrameworkApplication.K.jb("LokiMSAAppId"));return b}static get l3a(){return w.AFrameworkApplication.K.$("IsO365CommercialHost")||
w.AFrameworkApplication.K.$("IsO365ConsumerHost")}}Object(n.a)(lg,"LokiTokenManager",null,[781]);class md{get name(){return"Common.App.LivePersonaUtils"}init(){Ea.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}xc(b){b.register(lg,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").singleInstance().Rd(()=>new lg(zb.a.zp(b.Sa("Common.App.OAuth.IOAuthManager"))))}static main(){N.a.instance.Fc(new md)}}Object(n.a)(md,"LivePersonaUtilsPackage",null,[1,2]);class td{constructor(b){this.ete=
b}Qwi(b){if(!this.ete)return!0;b=ia.a.Uqf(b);if(!b)return!1;b=b.toLowerCase();for(let h=0;h<this.ete.length;h++)if(b.endsWith(this.ete[h]))return!0;return!1}}Object(n.a)(td,"DomainAllowListManager",null,[]);class Bd{constructor(b,h){this.Wcf=null;this.FVe=b;this.url=h}get Ong(){return ia.a.jya(this.url)}get Zr(){return this.FVe}Rjg(){const b={},h=this.Zr;b.a=this.Ong;b.b=this.round(h.navigationStart);b.c=this.round(h.unloadEventStart);b.d=this.round(h.unloadEventEnd);b.e=this.round(h.redirectStart);
b.f=this.round(h.redirectEnd);b.g=this.round(h.fetchStart);b.h=this.round(h.domainLookupStart);b.i=this.round(h.domainLookupEnd);b.j=this.round(h.connectStart);b.k=this.round(h.connectEnd);b.l=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.m=this.round(h.requestStart);b.n=this.round(h.responseStart);b.o=this.round(h.responseEnd);b.q=this.round(h.domInteractive);b.r=this.round(h.domContentLoadedEventStart);b.s=this.round(h.domContentLoadedEventEnd);
b.t=this.round(h.domComplete);b.u=this.round(h.loadEventStart);b.v=this.round(h.loadEventEnd);b.w=this.Wcf;return b}round(b){return Math.round(1E3*b)/1E3}}Object(n.a)(Bd,"PerformanceTimingEntry",null,[]);const nl=(b,h)=>{const v={};let D=null;switch(b){case 0:D="ResourceTiming";b=h.a;null!=b&&(v.Url=b);b=h.b;null!=b&&(v.InitiatorType=b);b=null==h.c?null:h.c.toString();null!=b&&(v.RedirectStart=b);b=null==h.d?null:h.d.toString();null!=b&&(v.RedirectEnd=b);b=null==h.e?null:h.e.toString();null!=b&&(v.FetchStart=
b);b=null==h.f?null:h.f.toString();null!=b&&(v.DomainLookupStart=b);b=null==h.g?null:h.g.toString();null!=b&&(v.DomainLookupEnd=b);b=null==h.h?null:h.h.toString();null!=b&&(v.ConnectStart=b);b=null==h.i?null:h.i.toString();null!=b&&(v.ConnectEnd=b);b=null==h.j?null:h.j.toString();null!=b&&(v.SecureConnectionStart=b);b=null==h.k?null:h.k.toString();null!=b&&(v.RequestStart=b);b=null==h.l?null:h.l.toString();null!=b&&(v.ResponseStart=b);b=null==h.m?null:h.m.toString();null!=b&&(v.ResponseEnd=b);b=h.n;
null!=b&&(v.CustomText=b);b=null==h.o?null:h.o.toString();null!=b&&(v.DecodedBodySize=b);b=null==h.p?null:h.p.toString();null!=b&&(v.EncodedBodySize=b);h=null==h.q?null:h.q.toString();null!=h&&(v.TransferSize=h);break;case 1:D="PerformanceTiming",b=h.a,null!=b&&(v.Url=b),b=null==h.b?null:h.b.toString(),null!=b&&(v.NavigationStart=b),b=null==h.c?null:h.c.toString(),null!=b&&(v.UnloadEventStart=b),b=null==h.d?null:h.d.toString(),null!=b&&(v.UnloadEventEnd=b),b=null==h.e?null:h.e.toString(),null!=b&&
(v.RedirectStart=b),b=null==h.f?null:h.f.toString(),null!=b&&(v.RedirectEnd=b),b=null==h.g?null:h.g.toString(),null!=b&&(v.FetchStart=b),b=null==h.h?null:h.h.toString(),null!=b&&(v.DomainLookupStart=b),b=null==h.i?null:h.i.toString(),null!=b&&(v.DomainLookupEnd=b),b=null==h.j?null:h.j.toString(),null!=b&&(v.ConnectStart=b),b=null==h.k?null:h.k.toString(),null!=b&&(v.ConnectEnd=b),b=null==h.l?null:h.l.toString(),null!=b&&(v.SecureConnectionStart=b),b=null==h.m?null:h.m.toString(),null!=b&&(v.RequestStart=
b),b=null==h.n?null:h.n.toString(),null!=b&&(v.ResponseStart=b),b=null==h.o?null:h.o.toString(),null!=b&&(v.ResponseEnd=b),b=null==h.p?null:h.p.toString(),null!=b&&(v.DomLoading=b),b=null==h.q?null:h.q.toString(),null!=b&&(v.DomInteractive=b),b=null==h.r?null:h.r.toString(),null!=b&&(v.DomContentLoadedEventStart=b),b=null==h.s?null:h.s.toString(),null!=b&&(v.DomContentLoadedEventEnd=b),b=null==h.t?null:h.t.toString(),null!=b&&(v.DomComplete=b),b=null==h.u?null:h.u.toString(),null!=b&&(v.LoadEventStart=
b),b=null==h.v?null:h.v.toString(),null!=b&&(v.LoadEventEnd=b),h=h.w,null!=h&&(v.CustomText=h)}v.Table=D;return Sys.Serialization.JavaScriptSerializer.serialize(v)};var ni=c(47),si=c(231),zi=c(164);class yl{constructor(b,h=null,v=null){this.Tf=b;this.Nng=this;this.I4j=h||(()=>window.location.href);this.rze=new td(v)}run(){if(yl.peb(window.performance))try{const P=this.I4j();if(yl.Lnk.exec(P)&&this.rze.Qwi(P)){var b=new Bd(window.performance.timing,P);zi.a.instance.FRn(b.Zr.fetchStart);zi.a.instance.GRn(b.Zr.navigationStart);
zi.a.instance.oY(ni.a.gJl,"connectStart","requestStart");zi.a.instance.oY(ni.a.oJl,"requestStart","responseStart");zi.a.instance.oY(ni.a.rJl,"responseStart","responseEnd");this.Nng.X3a(1,b.Rjg());this.Tf.qf(ni.a.dhb,b.Zr.fetchStart);this.Tf.qf(ni.a.lJl,b.Zr.domainLookupStart);this.Tf.qf(ni.a.kJl,b.Zr.domainLookupEnd);this.Tf.qf(ni.a.iJl,b.Zr.connectStart);this.Tf.qf(ni.a.tJl,b.Zr.secureConnectionStart);this.Tf.qf(ni.a.hJl,b.Zr.connectEnd);this.Tf.qf(ni.a.pJl,b.Zr.requestStart);this.Tf.qf(ni.a.wmf,
b.Zr.responseStart);this.Tf.qf(ni.a.mJl,b.Zr.responseEnd-b.Zr.responseStart);this.Tf.qf(ni.a.qJl,b.Zr.responseStart-b.Zr.requestStart);var h=0,v=0,D=0;({transferSize:h,Ohf:v,sdf:D}=this.vQo(P)).returnValue&&(this.Tf.qf(ni.a.vJl,h),this.Tf.qf(ni.a.jJl,D),this.Tf.qf(ni.a.nJl,v));this.Tf.qf(ni.a.VMc,b.Zr.navigationStart)}}catch(P){u.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",P)}}vQo(b){let h,v,D;D=v=h=-1;if(void 0===window.performance.getEntriesByName||null===
window.performance.getEntriesByName)return{returnValue:!1,transferSize:h,Ohf:v,sdf:D};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:h,Ohf:v,sdf:D};b=b[0];var P=b.transferSize;void 0!==h&&null!==h&&(h=P);P=b.decodedBodySize;void 0!==P&&null!==P&&(D=P);b=b.encodedBodySize;void 0!==b&&null!==b&&(v=b);return{returnValue:!0,transferSize:h,Ohf:v,sdf:D}}X3a(b,h){u.ULS.sendTraceTag(4551815,306,50,nl(b,h))}static get instance(){return yl._instance||
(yl._instance=new yl(si.a.instance,null,w.AFrameworkApplication.K.$("PerfTimingLoggerFilterDomainsIsEnabled")?w.AFrameworkApplication.K.LC("ResourceLoggerDomainAllowList"):null))}static peb(b){return!(void 0===b||null===b)&&!(void 0===b.timing||null===b.timing)}}yl._instance=null;yl.Lnk=RegExp("^https?://.*","i");Object(n.a)(yl,"PerformanceTimingLogger",null,[782]);class Dl{constructor(b,h){this.Wcf=null;this.FVe=b;this.behavior=h;this.url=this.Zr.name}get Ong(){return 2===this.behavior?this.url:
ia.a.jya(this.url)}get Zr(){return this.FVe}Rjg(){const b={},h=this.Zr;b.a=this.Ong;b.b=h.initiatorType;b.c=this.round(h.redirectStart);b.d=this.round(h.redirectEnd);b.e=this.round(h.fetchStart);b.f=this.round(h.domainLookupStart);b.g=this.round(h.domainLookupEnd);b.h=this.round(h.connectStart);b.i=this.round(h.connectEnd);b.j=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.k=this.round(h.requestStart);b.l=this.round(h.responseStart);b.m=this.round(h.responseEnd);
b.o=this.round(Dl.fib(h,"decodedBodySize"));b.p=this.round(Dl.fib(h,"encodedBodySize"));b.q=this.round(Dl.fib(h,"transferSize"));b.n=this.Wcf;return b}round(b){return Math.round(1E3*b)/1E3}static fib(b,h){return b[h]}}Object(n.a)(Dl,"ResourceTimingEntry",null,[793]);class ji{constructor(b,h=null,v=100){this.VLg=b;this.wvd=h;this.f9a={};this.aZj=v}bPo(b){var h=b.name.toLowerCase();const v=ia.a.oPc(h);this.Gej(v,h)&&(v in this.f9a?u.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
v):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.nDi(b),h.encodedsize=Dl.fib(b,"encodedBodySize"),h.decodedsize=Dl.fib(b,"decodedBodySize"),this.f9a[v]=h))}cPo(b){var h=b.name.toLowerCase();const v=ia.a.oPc(h);this.c8n(v,h)&&(v in this.f9a?u.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",v):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.nDi(b),h.encodedsize=Dl.fib(b,"encodedBodySize"),
h.decodedsize=Dl.fib(b,"decodedBodySize"),h.it=b.initiatorType,h.ress=b.responseStart,h.cs=b.connectStart,h.ce=b.connectEnd,h.dls=b.domainLookupStart,h.dle=b.domainLookupEnd,h.rs=b.redirectStart,h.re=b.redirectEnd,h.reqs=b.requestStart,h.scs=b.secureConnectionStart,this.f9a[v]=h))}Gej(b,h){if(this.VLg)return Array.contains(this.VLg,b);if(this.wvd)for(b=ia.a.C_(h),h=0;h<this.wvd.length;h++)if(this.wvd[h]&&b.endsWith(this.wvd[h]))return!0;return!1}c8n(b,h){return this.Gej(b,h)?b.endsWith(".js")||b.endsWith(".css"):
!1}nDi(b){try{const h=Dl.fib(b,"transferSize");if(void 0!==h&&null!==h)return!h;u.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return b.responseEnd-b.fetchStart<this.aZj}catch(h){u.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",h.message)}return!1}fUn(){if(jb.a.jf(this.f9a))u.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");
else{var b=w.AFrameworkApplication.flightId?w.AFrameworkApplication.flightId.split(";"):[],h=Object.assign(new Bb.a,{extendedProperties:hb.a.iG()});h.extendedProperties.set("Flights",E.c(b));this.AKi(h,this.f9a,va.Health.instance)}}snf(b){let h=0,v=0,D=0,P=0;const ca=this.f9a;for(let Ra in ca){var ta=ca[Ra];Ra.endsWith(".js")&&(ta=Object(Na.a)(Object,ta),ta.responseend<b&&(h+=1,v+=ta.decodedsize,P+=ta.encodedsize,D+=ta.iscached?0:ta.encodedsize))}b={};b.filesLoaded=h;b.decodedBytes=v;b.transferredBytes=
D;b.encodedBytes=P;return b}AKi(b,h,v){if(h){var D=0,P=0,ca=0,ta=0,Ra=0,mb=0,Jb=0,Ub=0,cc=0,Ac=0,Lc=0;for(let vd in h){var id=h[vd];try{const xe=Object(Na.a)(Object,id);if(!xe)continue;const Ld=xe.iscached?Boolean.parse(xe.iscached.toString()):!1,Qd=xe.fetchstart?this.parseFloat(xe.fetchstart.toString()):0,Zd=(xe.responseend?this.parseFloat(xe.responseend.toString()):0)-Qd,te=xe.encodedsize?this.parseFloat(xe.encodedsize.toString()):0,Qf=xe.decodedsize?this.parseFloat(xe.decodedsize.toString()):0;
D+=Zd;ta+=te;Jb+=Qf;Ac++;Ld?(ca+=Zd,mb+=te,cc+=Qf,Lc++):(P+=Zd,Ra+=te,Ub+=Qf)}catch(xe){u.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",xe.message)}}b.extendedProperties.set("StaticResources",E.c(h));b.extendedProperties.set("TotalResourceDownloadLatency",D.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",P.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",ca.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
ta.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Ra.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",mb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Jb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Ub.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",cc.toString());b.extendedProperties.set("TotalNumberOfResourcesDownloaded",Ac.toString());
b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Lc.toString());v.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);v.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(n.a)(ji,"AppStaticResourceManager",null,[]);class ej extends Sys.EventArgs{constructor(b){super();this.entries=b}}Object(n.a)(ej,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class fj{constructor(b,
h,v=null,D=null,P=100,ca=!1){this.xHe=!1;this.uo=null;this.$qc=0;this.ra=new Mc.a;this.Erb=null;this.yZ=!1;this.fjh=0;this.Gb=b;this.GRg=0;this.Nng=this;this.rze=new td(v);this.yK=h;D&&(this.Erb=new ji(null,D,P));this.gWj=ca}get ryh(){try{return!(void 0===this.yK||null===this.yK)&&!(void 0===this.yK.getEntriesByType||null===this.yK.getEntriesByType)}catch(b){return u.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",b),!1}}get uil(){return this.GRg}get isActive(){return this.yZ}get Ijg(){return this.fjh}$ph(b){this.ra.addHandler(fj.Kif,
b)}pbj(b){this.ra.removeHandler(fj.Kif,b)}xc(b,h){const v=this.Ijg!==b;this.fjh=b;this.isActive&&this.Gb&&v&&(this.Xe(),this.Vb());this.GRg=h}activate(){!this.isActive&&this.ryh&&(this.Vb(),this.yZ=!0)}deactivate(b){this.isActive&&(this.Xe(),b&&this.flush(),this.yZ=!1)}flush(){if(this.isActive&&this.ryh)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.$qc&&u.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",
b.length-this.$qc);const h=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);h&&(window.performance.clearResourceTimings(),this.$qc=0);const v=[];for(let D=this.$qc;D<b.length;D++)this.rze.Qwi(b[D].name)&&(this.Erb&&(this.gWj?this.Erb.cPo(b[D]):this.Erb.bPo(b[D])),v.push(new Dl(b[D],this.uil)));h||(this.$qc=b.length);this.ra.raiseEvent(fj.Kif,new ej(v));for(b=0;b<v.length;b++)0!==v[b].behavior&&2!==v[b].behavior||this.Nng.X3a(0,v[b].Rjg());0<v.length&&
u.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",v.length)}catch(h){u.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",h)}}X3a(b,h){u.ULS.sendTraceTag(4310804,306,50,nl(b,h))}ARn(){this.Erb.fUn()}snf(b){return this.Erb.snf(b)}Vb(){this.Gb&&0<this.Ijg&&(this.uo=new qf.a(3,2,1E3*this.Ijg,()=>{this.flush()},5),this.Gb.Vb(this.uo),this.xHe=!0)}Xe(){this.xHe&&(this.Gb.Xe(this.uo),this.uo=null,this.xHe=
!1)}}fj.Kif="EntriesAvailable";Object(n.a)(fj,"ResourceTimingLogger",null,[757,782]);class um{constructor(){this.W=null}get name(){return"Common.ResourceTiming"}init(){this.W.resolve("Common.NetworkTiming.IResourceTimingLogger");yl.instance.run()}dispose(){}xc(b){this.W=b;let h=null;if(w.AFrameworkApplication.K.$("ResourceLoggerFilterDomainsIsEnabled"))try{h=w.AFrameworkApplication.K.LC("ResourceLoggerDomainAllowList")}catch(ca){u.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const v=
[];v.push(ia.a.C_(Id.a.v5).toLowerCase());v.push(ia.a.C_(Id.a.d8c).toLowerCase());const D=w.AFrameworkApplication.K.mc("AppStaticResourceMonitorCacheThresholdInMs",100),P=w.AFrameworkApplication.K.$("PPTAggregateResourceTimingV2Enabled");b.register(757,"Common.NetworkTiming.IResourceTimingLogger").singleInstance().Rd(()=>new fj(w.AFrameworkApplication.nc,window.performance,h,v,D,P))}static main(){N.a.instance.Fc(new um)}}Object(n.a)(um,"ResourceTimingPackage",null,[1,2]);var Gg=c(242);class dg{constructor(){this.wse=
{}}Sqk(b){this.wse[b.id.toString()]=b}djn(b){const h=this.wse;for(let v in h)h[v].notify(b,!1);this.wse={}}qMn(b,h){h&&this.Sqk(h);return this.vXi(b,h)}Ahf(b){this.djn(b)}LVh(b,h){b.notify(h,!0)}}Object(n.a)(dg,"AEventEmitter",null,[763]);var Ri;(function(b){b[b.notStarted=0]="notStarted";b[b.waiting=1]="waiting";b[b.shouldRetry=2]="shouldRetry";b[b.complete=3]="complete"})(Ri||(Ri={}));Object(n.b)("EventResultState",Ri);class am{constructor(){this._state=0}get state(){return this._state}set state(b){u.ULS.sendTraceTag(5849616,
202,50,"Changing event result state. {0}",{["OldState"]:Ri[this._state],["NewState"]:Ri[b]},"ResultType",this.Ofi());this._state=b}}Object(n.a)(am,"AEventResult",null,[762]);class gj extends am{constructor(){super();this.XTe=this.lzc=null;this.state=0;this.bFe=this.y_g=!1}get Sca(){return this.lzc}get j7a(){return this.XTe}get iEm(){return this.y_g}Ofi(){return"GetMoreInfo Result"}}Object(n.a)(gj,"GetMoreInfoResult",am,[814,762]);var Tg=c(1380),Si=c(1557),kj=c(1048);class Mh{constructor(b,h,v,D,P,
ca,ta,Ra){this.ga=b;this.Xf=h;this.Jh=v;this.Fza=D;this.Gb=P;this.qD=ca;this.a6j=ta;this.Tvd=Ra}AVn(){this.rec.qa(Wa.a.Afc,ud.a.frame,Object(z.a)(this,this.Afc,"openUrlInNewTab"));this.rec.qa(Wa.a.ZWf,ud.a.frame,Object(z.a)(this,this.ZWf,"openDocumentUrl"));w.AFrameworkApplication.iga?this.GKi():this.rec.eb(Wa.a.zJd,ud.a.frame,Object(z.a)(this,this.zJd,"documentLoaded"),96)}Afc(b,h,v,D,P){P&&P.MenuItemId&&(u.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:P.SourceControlId,["AppType"]:kj.a[this.lxa]}),
Dd.a.om(P.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}ZWf(b,h,v,D,P){if(P&&P.MenuItemId){const ca=w.AFrameworkApplication.K.$("WacInTabOpenMRUIsEnabledForUiHost"),ta=w.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");u.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",ca,ta);if(ca&&ta){u.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:P.SourceControlId,["AppType"]:kj.a[this.lxa]});
b=P.MenuItemId.toString();const Ra={};Ra[H.a.jhc]="1";Ra[H.a.documentUrl]=b;Ra[H.a.reason]=Si.a.open;u.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");w.AFrameworkApplication.MO().execute(mb=>{mb.sendMessage(L.a.xCb,Ra)})}else this.Afc(b,h,v,D,P)}return 32}zJd(){this.GKi();return 32}YQa(b,h,v=""){if(h&&h.KH){const D=Tg.a[h.status];h=h.KH.getTime();const P=this.iq()-h;u.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:b,["RequestStatus"]:D,
["ElapsedMs"]:P,["StartTime"]:h,["Notes"]:v})}else u.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}GKi(){var b=w.AFrameworkApplication.K.$("QPGVCI"),h=ia.a.aU(document.URL,"wdNewAndOpenCt",b);if(h){h=parseInt(h);var v=ia.a.aU(document.URL,"wdPreviousSession",b);b=ia.a.aU(document.URL,"wdPreviousCorrelation",b);var D=w.AFrameworkApplication.K.$("NAOPLP");if(w.AFrameworkApplication.iga){var P=w.AFrameworkApplication.iga.getTime();
!h||h>P?u.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:h,["DocumentLoadedTime"]:P,["SessionId"]:v,["Correlation"]:b}):u.ULS.sendTraceTag(5849683,202,D?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:P-h,["ClickTimestamp"]:h,["SessionId"]:v,["Correlation"]:b})}else u.ULS.sendTraceTag(5849681,202,D?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:h,["SessionId"]:v,["Correlation"]:b})}}get rec(){return this.ga.value}get YZc(){return this.Xf.value}get TQi(){return this.Jh.value}get lxa(){return this.Fza.value}get F5d(){return this.Gb.value}get iq(){return this.qD}get vRa(){return this.a6j.value}get n7a(){return this.Tvd.value}static get instance(){return Mh._instance||(Mh._instance=Mh.Mr())}static Mr(){return new Mh(new Gg.a(()=>w.AFrameworkApplication.va),new Gg.a(()=>w.AFrameworkApplication.Ne),new Gg.a(()=>w.AFrameworkApplication.ta),
new Gg.a(()=>w.AFrameworkApplication.ta.Nb.Tl),new Gg.a(()=>w.AFrameworkApplication.nc),()=>(new Date).getTime(),new Gg.a(()=>w.AFrameworkApplication.ta.Nb.vRa),new Gg.a(()=>w.AFrameworkApplication.n7a))}}Mh._instance=null;Object(n.a)(Mh,"NewAndOpenCommonHelpers",null,[760]);class Qh{constructor(b,h,v){this.sud=this.uo=null;this.AQe=0;this.pjk=b;this.Gb=h;this.gSg=v}sBk(){this.AQe=this.Shc+1}J7f(b){this.uo&&(this.Gb.Xe(this.uo),this.uo=null);b&&(this.AQe=0)}xDo(b){const h=this.dLo;0<=h?(this.sBk(),
this.J7f(!1),this.uo=new qf.a(4,1,h,b,107),this.Gb.Vb(this.uo)):(this.J7f(!0),u.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.gSg}))}get Shc(){return this.AQe}get dLo(){return this.Shc>=this.Xjj.length?-1:this.Xjj[this.Shc]}get Xjj(){if(!this.sud){const b=(this.pjk.value||"0").split(",");this.sud=[];for(let h=0;h<b.length;h++){const v=parseInt(b[h]);isNaN(v)?u.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.gSg,["Entry"]:b[h]}):
Array.add(this.sud,v)}}return this.sud}}Object(n.a)(Qh,"RetryHelper",null,[]);class Qk extends dg{constructor(b,h){super();this.WAa=b;this.mAc=new Qh(h,this.EZc.F5d,"GetMoreInfo");this.sq=new gj}E$m(){this.nMf("Document opened")}gcl(b){return()=>{this.nMf(b,!0)}}vXi(b,h=null){u.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:b});3===this.sq.state?(h&&this.LVh(h,this.sq),u.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):
this.nMf(b);return this.sq}nMf(b,h=!1){this.mAc.J7f(!h);1===this.sq.state?u.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.mAc.Shc}):(u.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.mAc.Shc}),this.sq.state=1,h=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.EZc.vRa,w.AFrameworkApplication.im),this.EZc.YZc.mzb(h,1,null,null,[Qk.Pah,Qk.Bhh],5,this.Val(),this.Ual(b)))}Val(){return b=>
{var h=!1;let v=!1;var D=!1,P;w.AFrameworkApplication.K.$("GetMoreInfoDataFromResponseBody")&&(b.data.ve?({av:P}=E.d(b.data.ve)).returnValue?P?(D=!0,this.sq.XTe=P.StorageServiceDisplayName,this.sq.lzc=Qk.dEi(P.PersonalFileStorageUrl)?P.PersonalFileStorageUrl:"",""===this.sq.Sca&&"SharePointOnlineConsumer"===w.AFrameworkApplication.K.jb("FileSource")&&(this.sq.lzc=ia.a.jya(w.AFrameworkApplication.breadcrumbFolderUrl)),h=""===this.sq.Sca&&""!==this.sq.j7a):u.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
u.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):u.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));D||((P=b.data.Bj)?(this.sq.XTe=(P[Qk.Bhh]||"").toString(),h=(P[Qk.Pah]||"").toString(),this.sq.lzc=Qk.dEi(h)?h:"",""===this.sq.Sca&&"SharePointOnlineConsumer"===w.AFrameworkApplication.K.jb("FileSource")?(this.sq.lzc=ia.a.jya(w.AFrameworkApplication.breadcrumbFolderUrl),
h=""===this.sq.Sca&&""!==this.sq.j7a):h=""===h&&""!==this.sq.j7a):(u.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),v=!0));D=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.mAc.Shc,v,h,D);this.EZc.YQa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,D);this.mkj(3,h,v)}}Ual(b){return h=>{this.EZc.YQa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",h.data,"Failure");
this.mkj(2);this.mAc.xDo(this.gcl(b))}}mkj(b,h=!1,v=!1){this.sq.state=b;this.sq.y_g=h;this.sq.bFe=v;this.Ahf(this.sq)}get EZc(){return this.WAa.value}static get instance(){return Qk._instance||(Qk._instance=Qk.Mr())}static Mr(){return new Qk(new Gg.a(()=>Mh.instance),new Gg.a(()=>w.AFrameworkApplication.z4l))}static dEi(b){if(!b)return u.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(G.a.Ug(b).startsWith("https://"))return!0;u.ULS.sendTraceTag(5849625,
202,10,"StorageUrl has invalid scheme.");return!1}}Qk.Pah="PersonalFileStorageUrl";Qk.Bhh="StorageServiceDisplayName";Qk._instance=null;Object(n.a)(Qk,"GetMoreInfoActor",dg,[]);class Hj{constructor(b,h,v,D,P){this.r7j=6E4;this.nqi="inactive";this.cnh="active";this.yZ=!0;this.Gb=b;this.g5j=h;this.qD=v;this.Rwd=D;this.ra=new Mc.a;P&&this.mDo();this.E3g=this.ebi()}Dnh(b){this.ra.addHandler(this.cnh,b)}puk(b){this.ra.addHandler(this.nqi,b)}mDo(){const b=new qf.a(5,2,this.r7j,Object(z.a)(this,this.Uwm,
"inactiveLoop"),108);this.Vwm.Vb(b)}Uwm(){const b=this.ebi(),h=this.iq()-b;h>this.fme&&this.yZ&&(u.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:h}),this.yZ=!1,this.ra.raiseEvent(this.nqi));b-this.E3g>this.fme&&(this.yZ=!0,this.ra.raiseEvent(this.cnh));this.E3g=b}get Vwm(){return this.Gb.value}get ebi(){return this.g5j}get iq(){return this.qD}get fme(){return this.Rwd.value}static get instance(){return Hj._instance||(Hj._instance=Hj.Mr())}static Mr(){return new Hj(new Gg.a(()=>
Qg.a.instance),()=>w.AFrameworkApplication.NIf.getTime(),()=>(new Date).getTime(),new Gg.a(()=>w.AFrameworkApplication.fme),!0)}}Hj._instance=null;Object(n.a)(Hj,"InactivityManager",null,[]);var tl=c(1680);class Qj extends am{constructor(){super();this.$bk=this.G7g=this.F7g=null;this.state=this.gjh=0;this.bFe=!1}get pOf(){return this.F7g}get iQi(){return this.G7g}get jLo(){return this.gjh}Ofi(){return"MruActor Result"}}Object(n.a)(Qj,"MruResult",am,[761,762]);class zl{constructor(b,h,v){this.task=
null;this.GGb=b;this.maxRetries=h;this.taskManager=v;this.retryCount=this.sTc=0;this.OOe=this.gXc=null}GQm(b,h){return b===pa.a.W6b||20===h||18===h||3===h}bSm(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===b||16===b||23===b||26===b||27===b||28===b}get Cae(){return this.OOe}reset(){this.sTc=this.retryCount=0;this.OOe=this.gXc=null;this.task&&(this.taskManager.Xe(this.task),this.task=null)}rBm(b,h,v,D){this.OOe=String.format("{0}_{1}",v,D);if(this.retryCount>=
this.maxRetries)return u.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.GQm(v,D))return u.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.bSm(D)&&1<=this.sTc)return this.gXc=v,!1;h=Math.max(h,this.GGb*Math.pow(2,this.sTc));if(26===D)h=Math.max(h,3E4);else if(27===D||28===D)h=Math.max(h,6E4);9===D||412===v&&(null==this.gXc||412!==this.gXc)?h=500:this.sTc+=1;this.gXc=v;this.retryCount+=1;this.task&&this.taskManager.Xe(this.task);u.ULS.sendTraceTag(562656909,
202,50,"Scheduling next retry after {0} ms.",h);this.task=new qf.a(2,1,h,b,107);this.taskManager.Vb(this.task);return!0}}Object(n.a)(zl,"RetryManager",null,[]);var Rh=c(128);class Dk{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(n.a)(Dk,"WriteOptions",null,[]);var ok=c(741);class Rk extends dg{constructor(b,h,v,D,P,ca,ta){super();this.WAa=b;this.Rak=h;this.hcb=new zl(w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.QM.F5d);this.vdb=new zl(w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.QM.F5d);this.hhk=v;this.cmh=D;this.Npk={};this.Qka=new Qj;this.E4j=P;this.wpd="";this.LL=ca;this.dUg=ta;this.Hsd="";this.lhk=w.AFrameworkApplication.K.mc("WordRecentLinksCount",
25)}get bqe(){return this.Npk}jZn(){this.QM.rec.qa(Wa.a.bcj,ud.a.frame,Object(z.a)(this,this.$2n,"renameMruEntry"))}$2n(){return this.iqg("Rename")}V$m(){this.aNi("File Opened")}W$m(){this.aNi("IntervalUpdate")}aNi(b){u.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.iqg(b)}Nga(b){(b=G.a.Nga(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}L4h(){switch(this.QM.lxa){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";
case 4:return"OneNote";default:return"Unknown"}}fjm(b){var h=this.E4j();if(!h)return null;const v=new Dk;v.documentUrl=this.dUg.value?encodeURI(h):h;v.mruItemId=this.wpd;v.app=this.L4h();if(h=this.LL())v.folderName=h.breadcrumbFolderName,h=h.gz,v.documentName=G.a.kJ(h),v.documentExt=this.Nga(h);b&&(v.documentName?v.documentName.length?255<=v.documentName.length?b.set("DocumentNameLength","Long"):2084<=v.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength",
"Null"));return JSON.stringify(v)}iqg(b,h=!1){if(4===this.QM.lxa&&!w.AFrameworkApplication.wJd)return 2;var v=hb.a.iG();v&&(v.set("Trigger",b),v.set("IsRetry",h?"true":"false"),v.set("MruIdSent",this.wpd?"true":"false"),v.set("URLEncoded",this.dUg.value?"true":"false"));va.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",v);b=this.fjm(v);if(!b)return h=!w.AFrameworkApplication.LRb,v&&(v.set("WebEditingIsEnabled",w.AFrameworkApplication.LRb?"true":"false"),v.set("ProtectedFile",w.AFrameworkApplication.protectFile?
"true":"false")),va.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",h,!1,Object.assign(new Bb.a,{extendedProperties:v})),2;this.vdb&&!h&&this.vdb.reset();v=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.QM.vRa,this.pKf);this.cmh?this.bqe["X-FileId"]=w.AFrameworkApplication.im:v+=String.format("&{0}",w.AFrameworkApplication.im);w.AFrameworkApplication.sessionStartInfoSettings&&(this.bqe["X-Office-AudienceGroup"]=Object(Na.a)(String,w.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");this.bqe["X-Timeout"]=15E3;return this.QM.YZc.xj(v,2,b,this.bqe,!0,5,Object(z.a)(this,this.K8o,"writeMruV2EntryOnServerSuccessCallback"),Object(z.a)(this,this.kgl,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}K8o(b){this.$li(b.data)}$li(b){const h=hb.a.iG();this.vdb&&(h&&this.vdb.Cae&&(h.set("LastError",this.vdb.Cae),h.set("NumRetries",this.vdb.retryCount.toString())),this.vdb.reset());const v=tl.c(b.ve);v&&v.diagnostics_data&&(this.wpd=v.diagnostics_data.mru_id);
b=+b.nT-+b.KH;h&&h.set("RequestDuration",b.toString());va.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Bb.a,{extendedProperties:h}))}kgl(b){if(b.data.Qe===pa.a.VIc)this.$li(b.data);else{var h=b.data.Qe===pa.a.via,v=hb.a.iG();this.jmi(this.vdb,b,this.Pfl(),v);v&&(v.set("StatusCode",b.data.Qe.toString()),h||this.pZe(b.data,v));va.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",b.data.Qe),h,!1,Object.assign(new Bb.a,{extendedProperties:v}))}}Pfl(){return()=>
{this.iqg("Retry",!0)}}I4l(){this.PYc("Polling")}H4l(){this.PYc("Retry",!0)}H$m(){this.PYc("Open")}G$m(){this.PYc("Activity")}F$m(){this.PYc("ActivityRecentLinks",!1,!0)}PYc(b,h=!1,v=!1){u.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:b});const D=hb.a.iG();D&&(D.set("Trigger",b),D.set("IsRetry",h?"true":"false"),v&&D.set("RecentLinks","true"));va.Health.instance.recordKpiUsage("GetMru",0,"smartfio",D);this.hcb&&!h&&this.hcb.reset();v?this.PLh(Object(z.a)(this,this.J4l,"getMruV2ForRecentLinksFromServerSuccessCallback"),
Object(z.a)(this,this.E4l,"getMruForRecentLinksFromServerFailureCallback"),!0):this.PLh(Object(z.a)(this,this.K4l,"getMruV2FromServerSuccessCallback"),Object(z.a)(this,this.G4l,"getMruFromServerFailureCallback"))}pZe(b,h){b&&b.Bj&&(b=b.Bj["X-CorrelationId"])&&h.set("ServerCorrelationId",b)}k4m(b,h){b&&(h&&h.set("RequestDuration",(+b.nT-+b.KH).toString()),va.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Bb.a,{extendedProperties:h})))}K4l(b){this.ici(b)}ici(b,h=!1){var v="";let D=null,
P=null,ca=null;const ta=tl.c(b.data.ve);ta&&(D=ta.places?ta.places.items:[],P=ta.documents?ta.documents.items:[],(ca=tl.a(ta,h))&&(v=E.c(ca)));w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.yQa&&Rh.c()&&(h?this.Hsd=v:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(v,!0)));v=hb.a.iG();this.hcb&&(v&&this.hcb.Cae&&(v.set("LastError",this.hcb.Cae),v.set("NumRetries",this.hcb.retryCount.toString())),this.hcb.reset());h&&v&&v.set("RecentLinks","true");ca||D||P?(h?this.QM.YQa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",
b.data,"Success"):this.QM.YQa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.joe(3,ca,D,P),this.k4m(b.data,v)):(h?this.QM.YQa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.QM.YQa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),v&&this.pZe(b.data,v),va.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Bb.a,{extendedProperties:v})),this.joe(3,null,null,null,!0));this.Ahf(this.Qka)}J4l(b){this.ici(b,
!0)}jmi(b,h,v,D){let P=0,ca=0;const ta=tl.c(h.data.ve);ta&&(null!=ta.response_code&&(P=ta.response_code,D&&D.set("MruResponseCode",P.toString()),9===P&&(this.wpd="")),ta.error_data&&null!=ta.error_data.retry_after_ms&&(ca=ta.error_data.retry_after_ms,D&&D.set("ExpectedRetryAfter",ca.toString())));b&&(h=b.rBm(v,ca,h.data.Qe,P),D&&(D.set("CurrentRetryCount",b.retryCount.toString()),D.set("RetryScheduled",h?"true":"false")))}G4l(b){this.hci(b)}hci(b,h=!1){const v=b.data.Qe===pa.a.via,D=hb.a.iG();D&&
(D.set("StatusCode",b.data.Qe.toString()),h&&D.set("RecentLinks","true"),v||this.pZe(b.data,D));h?this.QM.YQa("MruActor.GetMruForRecentLinksFromServerFailureCallback",b.data,"Failure"):this.QM.YQa("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.joe(2);this.jmi(this.hcb,b,Object(z.a)(this,this.H4l,"getMruFromServerRetryTask"),D);va.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",b.data.Qe),v,!1,Object.assign(new Bb.a,{extendedProperties:D}));this.Ahf(this.Qka);
w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.yQa&&Rh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),h?this.Hsd=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}E4l(b){this.hci(b,!0)}joe(b,h=null,v=null,D=null,P=!1){if(3!==this.Qka.state||3===b)this.Qka.F7g=h,this.Qka.G7g=v,this.Qka.$bk=D,this.Qka.state=b,this.Qka.bFe=P,this.Qka.gjh=this.QM.iq()}vXi(b,h){u.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.Qka.state});
h&&3===this.Qka.state&&this.LVh(h,this.Qka);return this.Qka}PLh(b,h,v=!1){this.joe(1);let D;const P={};D=v?String.format(this.QM.vRa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.lhk,"OfficeSuite",this.pKf,"ClassicMru"):String.format(this.QM.vRa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.L4h(),this.pKf);this.hhk.value||(D+="&entity=docs");w.AFrameworkApplication.sessionStartInfoSettings&&(P["X-Office-AudienceGroup"]=Object(Na.a)(String,w.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");v&&(P["X-Office-Application"]="147");this.cmh?P["X-FileId"]=w.AFrameworkApplication.im:D+=String.format("&{0}",w.AFrameworkApplication.im);this.QM.YZc.xj(D,1,null,P,!0,5,b,h,null)}get QM(){return this.WAa.value}get pKf(){return this.Rak.value}static get instance(){return Rk._instance||(Rk._instance=Rk.Mr())}static Mr(){return new Rk(new Gg.a(()=>Mh.instance),new Gg.a(()=>ok.a.sg(w.AFrameworkApplication.lcid).name),new Gg.a(()=>w.AFrameworkApplication.ta.Nb.mF),w.AFrameworkApplication.K.$("MruWriteFileIdInHeader"),
()=>w.AFrameworkApplication.ta.Nb.Mfa,()=>w.AFrameworkApplication.zs,new Gg.a(()=>w.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled")))}}Rk._instance=null;Object(n.a)(Rk,"MruActor",dg,[]);class Gm{constructor(){this.QCc=this.mch=this.W=null;this.Kh=!1}get name(){return"Common.App.NewAndOpen.Core"}xc(b){this.W=b;b.register(760,"Common.INewAndOpenCommonHelpers").singleInstance().Rd(()=>Mh.instance);b.register(763,"Common.IEventEmitter<Common.IGetMoreInfoResult>").singleInstance().Rd(()=>Qk.instance);
b.register(763,"Common.IEventEmitter<Common.IMruResult>").singleInstance().Rd(()=>Rk.instance)}init(){w.AFrameworkApplication.K.Po(()=>{this.l2a()})}l2a(){this.W.resolve("Common.INewAndOpenCommonHelpers");this.W.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.W.resolve("Common.IEventEmitter<Common.IMruResult>");var b=!1;Mh.instance.AVn();w.AFrameworkApplication.iGa&&(b=!0);w.AFrameworkApplication.g3f&&(Rk.instance.H$m(),0<w.AFrameworkApplication.jQi&&this.roh(),this.Tqo(),b=!0);w.AFrameworkApplication.n7a&&
b&&Qk.instance.E$m();w.AFrameworkApplication.wYo&&(b=Rk.instance,b.jZn(),b.V$m(),Qg.a.instance.Vb(this.xYo))}Tqo(){Hj.instance.Dnh(Object(z.a)(Rk.instance,Rk.instance.G$m,"makeGetMruRequestActivityTrigger"));Hj.instance.Dnh(Object(z.a)(this,this.roh,"addGetMruFromServerTask"));Hj.instance.puk(Object(z.a)(this,this.Hkl,"deleteGetMruFromServerTask"))}Hkl(){Qg.a.instance.Xe(this.kQi)}roh(){Qg.a.instance.Vb(this.kQi)}get kQi(){return this.mch||(this.mch=new qf.a(5,2,w.AFrameworkApplication.jQi,Object(z.a)(Rk.instance,
Rk.instance.I4l,"getMruFromServerTask"),109))}get xYo(){return this.QCc||(this.QCc=new qf.a(2,2,6E4*w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(z.a)(Rk.instance,Rk.instance.W$m,"makeUpdateMruTask"),197))}dispose(){this.Kh||(this.Kh=!0,this.QCc&&(Qg.a.instance.Xe(this.QCc),this.QCc=null))}}Object(n.a)(Gm,"CorePackageManager",null,[1,2,10]);var bm=c(1553),cm=c(145);class qg{static ivl(b){return qg.dzh("New",b)}static jvl(b){return qg.dzh("Open",
b)}static Jyh(b,h){return qg.GZa("LoadingMenuSection",qg.I1m,b,qg.JFc("lblLoading",h))}static KFc(b,h,v=null,D=null){return qg.GZa("MessageMenuSection",qg.hQi,h,qg.JFc("lblMessage",b,v,D))}static ROk(b){return qg.Jyh(b,CommonUIStrings.l_VoicedLoadingText)}static SOk(b,h){return qg.KFc(CommonUIStrings.l_NewCreationLocationMessage,b.labelText,h.Sca,h.j7a)}static QOk(b,h){return qg.KFc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,h.j7a,"\n\n"),b.labelText)}static Nyh(b){return qg.KFc(CommonUIStrings.l_NewGenericErrorMessage,
b.labelText)}static OOk(b,h,v){return qg.GZa("menuNewBlank",qg.Bsm,v?b.labelText:null,qg.FFc(b.Mni,b.Nni,b.Oni,null,b.c2a,b.XRc,h,"blank"))}static LPk(){return qg.JFc("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static bzh(){return qg.JFc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static MPk(b,h){return qg.GZa("menuNewTemplates",b,null,h)}static MOk(b,h){return qg.GZa("menuNewMoreTemplates",qg.J1h,null,qg.FFc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,
CommonUIStrings.l_NewMoreTemplates,null,null,null,b,h))}static CNk(b,h,v){let D="";v&&h&&(D=qg.GZa("BrowseMoreMenuSection",qg.J1h,null,qg.FFc("btnBrowseMore",h,h,null,null,null,b||"1959943459",v)));return D}static JFc(b,h,v=null,D=null){let P=D;h&&0<h.length&&(P=qg.bRi.cnb(h).trimEnd(),P=0<=P.indexOf("{0}")?String.format(P,D):String.format("{0} {1}",P,D));v=v&&D?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',G.a.yf(v),G.a.yf(D),G.a.yf(P)):
"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',G.a.yf(b||""),qg.bRi.cnb(G.a.yf(h||"")),v)}static FFc(b,h,v,D,P,ca,ta,Ra){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',G.a.yf(b||""),G.a.yf(h||""),G.a.yf(v||""),D||"32by32",G.a.yf(P||""),
G.a.yf(ca||""),ta,G.a.yf(Ra||""))}static dzh(b,h){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',b,h)}static GZa(b,h,v,D){v=v?String.format('Title="{0}"',G.a.yf(v)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',G.a.yf(b||""),G.a.yf(h||""),v,D)}}qg.hQi="MenuMru";qg.I1m=
"MenuLoading";qg.Bsm="MenuHeader";qg.J1h="MenuFooter";qg.bRi=cm.a.yC("\n","&#10;");Object(n.a)(qg,"NewAndOpenXmlUtilities",null,[]);class Yk{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(n.a)(Yk,"HostInformation",null,[]);var Wl=c(189);class kg{constructor(b,h,v,D,P,ca){this.wwd=this.Gw=this.ofd=null;this.Zud=this.PSe=!1;this.S6g=0;this.uSe=this.PGe=!1;this.WAa=b;this.ltc=h;this.jWa=new Gg.a(()=>new bm.a(v.value,Object(z.a)(this,this.WEb,"getMoreInfoEventReceived")));
this.Ybk=D;this.ybb=P;this.ukk=ca;this.lBc=this.Fie;2===this.u0.lxa&&(this.uSe=!0);w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.LBl()}get q7(){switch(this.u0.lxa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}LBl(){Qg.a.instance.Vb(new qf.a(5,1,0,()=>{this.getTemplateListJson()}))}Tb(){const b=this.u0.rec;b.qa(Wa.a.newDocument,ud.a.frame,
Object(z.a)(this,this.newDocument,"newDocument"));b.qa(Wa.a.bae,ud.a.frame,Object(z.a)(this,this.bae,"populateNewMenu"))}newDocument(b,h,v,D,P){if(1===v)return 32;if(2===v&&P){if(w.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&P.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),w.AFrameworkApplication.va.processAction(Wa.a.KGn,2);if(P.MenuItemId&&P.SourceControlId)return"NewDocumentHome"===P.SourceControlId&&Xe.a("NewDocumentFromHomeTab"),
this.IIc(P.MenuItemId,P.SourceControlId)}return 8}IIc(b,h){var v=this.K5d.uMh;if(null===v)return 8;var D=w.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(w.AFrameworkApplication.ykb&&D){u.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const P={};P[H.a.template]=b;P[H.a.q7]=this.q7;P[H.a.lcid]=w.AFrameworkApplication.lcid.toString();P[H.a.reason]=Si.a.sbf;P[H.a.uiCulture]=w.AFrameworkApplication.uiCulture;
P[H.a.dataCulture]=w.AFrameworkApplication.dataCulture;w.AFrameworkApplication.MO().execute(ca=>{ca.sendMessage(L.a.IIc,P)})}else D=(new Date).getTime(),h=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",v,G.a.Tj(this.iGa),G.a.Tj(b),G.a.Tj(this.q7),G.a.Tj(w.AFrameworkApplication.lcid.toString()),G.a.Tj(D.toString()),G.a.Tj(h),G.a.Tj(w.AFrameworkApplication.canary),w.AFrameworkApplication.im),(v=w.AFrameworkApplication.K.jb("ScenarioId"))&&
""!==v&&(h+="&wdscenarioid="+G.a.Tj(v)),h+="&"+w.AFrameworkApplication.rSd(),w.AFrameworkApplication.i3a&&(h+="&"+w.AFrameworkApplication.TQd()),(v=this.Gw?this.Gw.Sca:null)?h+="&DestinationUrl="+G.a.Tj(v):u.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),Dd.a.om(h,"_blank",void 0,"CreateNewDocument");2!==this.u0.lxa&&3!==this.u0.lxa||u.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:kj.a[this.u0.lxa],
["Template"]:b});w.AFrameworkApplication.K&&w.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.u0.lxa&&("blank"===b?Xe.b("ConsumerTemplateNewBlank"):(b=[Object.assign(new na.a,{name:"TemplateId",string:b})],Xe.b("ConsumerTemplateNew",null,0,!0,0,b)));return 32}o8m(b){let h=Number.MAX_VALUE,v=Number.MIN_VALUE;const D=window.performance;if(D&&"undefined"!==typeof D.getEntriesByName){for(let ca=0;ca<b.length;ca++){var P=D.getEntriesByName(b[ca]);
P&&0<P.length&&(P=P[0],h=Math.min(parseInt(String(P.fetchStart)),h),v=Math.max(parseInt(String(P.responseEnd)),v))}v>h&&u.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:v-h,["MinFetchStart"]:h,["MaxResponseEnd"]:v})}}bae(b,h,v,D,P){if(1===v)return this.uSe&&(w.AFrameworkApplication.epa("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.uSe=!1),32;2!==v||this.PGe||(this.S6g=(new Date).getTime(),u.ULS.sendTraceTag(5849602,
202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.Fie,["CachedNewMenuXmlExists"]:!!this.ofd,["ShouldCallGetMoreInfo"]:this.u0.n7a}));w.AFrameworkApplication.ue("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");w.AFrameworkApplication.ue("WordConsumerTemplates-tf;WordConsumerTemplates-cf");return this.rFn(P)}rFn(b){b&&(this.ofd?b.PopulationXML=this.ofd:(this.u0.n7a&&!this.Gw&&this.yhn.ek("Opened New menu",!0),b.PopulationXML=this.qLl(this.getTemplateListJson())));
return 32}qBi(){return!this.u0.n7a||!!this.Gw&&3===this.Gw.state&&!!this.Gw.j7a&&!!this.Gw.Sca}ARm(){return w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.yQa?!0:this.qBi()}getTemplateListJson(){if(!this.Fie||!this.ARm())return null;if(this.lBc&&!this.Zud){var b="9";w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(b="21");const h=w.AFrameworkApplication.K.appSettings;"NumberOfTemplatesInBackstage"in
h&&(b=h.NumberOfTemplatesInBackstage);let v=this.q7;"TemplateCollectionId"in h&&(v=h.TemplateCollectionId);w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordConsumerTemplates",!1)&&(v="WordConsumerWAC",b="23");b=String.format(this.u0.vRa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",G.a.Tj(w.AFrameworkApplication.lcid.toString()),G.a.Tj(v),b);Boolean.parse(h.AppendOriginQueryParam||"false")&&(b+="&org=backstage");Boolean.parse(h.BackstagePremiumTemplateExperienceEnabled||
"false")&&"TemplateTier"in h&&(b+="&templateTier="+h.TemplateTier);b+="&"+w.AFrameworkApplication.rSd();w.AFrameworkApplication.i3a&&(b+="&"+w.AFrameworkApplication.TQd());this.u0.YZc.xj(b,1,null,null,!1,2,D=>{this.u0.YQa("CreateNewActor.GetTemplateListJson",D.data);this.vJo(D.data.ve)},D=>{this.u0.YQa("CreateNewActor.GetTemplateListJson",D.data);this.uJo()},null,void 0,void 0,void 0,void 0,"5");this.lBc=!1}return this.wwd}vJo(b){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",
!1)?this.wwd=this.JCl(b):this.wwd=b;this.lBc=!1;this.c4c();if(w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.yQa&&Rh.c()){b=w.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const h=w.AFrameworkApplication.ykb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.wwd,!0,b&&h))}}uJo(){this.Zud=this.lBc=!0;this.c4c();w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.yQa&&Rh.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",
!1,!1));va.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}JCl(b){b=JSON.parse(b);const h=new Fb.a;h.add("TM00002102");h.add("TM00002101");h.add("TM16392939");const v=Wl.a.spg(b,D=>h.contains(D.AssetId));b=b.slice(0,9);b.splice.apply(b,[2,0].concat(v));return JSON.stringify(b)}lvf(b){var h=0;for(var v=0;v<b.length;v++)if("ST"===b[v].ImageType){h=v;break}const D=b.length?b[h]:null;b=D?D.Url||"":"";var P;let ca=v=h=!1;if(D&&(P=D.AspectRatio))P=
parseFloat(P),1>P?h=!0:1.5<P?v=!0:1===P&&(ca=!0);else switch(u.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:b}),this.u0.lxa){case 3:h=!0;break;case 2:v=!0;break;case 5:ca=!0}return{returnValue:b,xwm:h?"95by123":v?"123by69":ca?"100by100":"123by95"}}qLl(b){b=({mie:h}=this.POk(b,this.K5d,this.K5d.NFc||"1056925771")).returnValue;if(h){this.ofd=b;var h=(new Date).getTime()-this.S6g;u.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",
{["ElapsedMsSinceMenuOpened"]:h})}return b}WEb(b,h){u.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Gw||3!==b.state?2===b.state&&(u.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.PSe=!0,this.c4c()):(this.Gw=b,h||this.c4c(),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.yQa&&Rh.c()&&Rh.d("setFileMenuHostInformation")&&(b=Object.assign(new Yk,{hostUrl:this.Gw.Sca,hostName:this.Gw.j7a,folderUrl:w.AFrameworkApplication.breadcrumbFolderUrl,
folderName:w.AFrameworkApplication.breadcrumbFolderName}),u.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b))))}POk(b,h,v){let D;D=!1;const P=this.qBi();let ca="";this.u0.n7a&&(this.PSe?(ca=qg.Nyh(h),this.PSe=!1,u.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Gw?P?ca=qg.SOk(h,this.Gw):this.Gw.iEm?(D=!0,this.lBc=!1,ca=qg.QOk(h,this.Gw),u.ULS.sendTraceTag(5849607,
202,50,"Rendering File>New with personal storage instantiation message")):(D=!0,ca=qg.Nyh(h),u.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Gw.Sca,["StorageServiceDisplayNameIsSet"]:!!this.Gw.j7a})):(ca=qg.ROk(h.labelText),u.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));P&&(ca+=qg.OOk(h,v,!ca)+({mie:D}=this.KPk(b,v)).returnValue);return{returnValue:qg.ivl(ca),
mie:D}}KPk(b,h){let v;v=!1;if(!this.Fie)return v=!0,u.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",mie:v};let D="",P="",ca="MenuTemplate";if(this.Zud)D=qg.bzh(),this.Zud=!1,u.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const ta=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);D=this.JPk(ta,h);u.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");w.AFrameworkApplication.cRi&&
"OneDrive"===this.iGa&&(P=qg.MOk(this.zhn,w.AFrameworkApplication.cRi))}catch(ta){u.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),D=qg.bzh()}v=!0}else ca="MenuLoading",D=qg.LPk(),u.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:qg.MPk(ca,D)+P,mie:v}}JPk(b,h){let v="";const D=[];for(let ca=0;ca<b.length;ca++){var P=b[ca];let ta="";if(P){const Ra=P.Title,mb=P.AssetId;P=P.Thumbnails;
mb&&Ra&&P&&({xwm:P,returnValue:ta}=this.lvf(P),v+=qg.FFc("jbtnNewTemplate"+ca,Ra,null,P,null,ta,h,mb))}D[ca]=ta}b=new qf.a(4,1,5E3,()=>{this.o8m(D)},106);this.u0.F5d.Vb(b);return v}c4c(){this.PGe=!0;this.u0.TQi.MIa(this.K5d.KMc);this.PGe=!1}get u0(){return this.WAa.value}get K5d(){return this.ltc.value}get yhn(){return this.jWa.value}get zhn(){return this.Ybk.value}get iGa(){return this.ybb.value}get Fie(){return this.ukk.value}}Object(n.a)(kg,"CreateNewActor",null,[]);class Hd{constructor(){this._initialized=
!1;this.$Te={}}QD(b){this.rXh();return this.get(b)}contains(b){this.rXh();return b.toString()in this.$Te}rXh(){this._initialized||(this.Uvk(),this._initialized=!0)}Fdb(b,h){this.$Te[b.toString()]=h}get(b){return this.$Te[b.toString()]}}Object(n.a)(Hd,"AIntlHelper",null,[]);class Ad extends Hd{constructor(){super()}Uvk(){this.Fdb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.Fdb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.Fdb(2,CommonUIStrings.l_Open);this.Fdb(3,CommonUIStrings.l_OpenMenuRecentDocuments);
this.Fdb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.Fdb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Ad._instance||(Ad._instance=new Ad)}static Yxn(b){return Ad.instance.QD(b)}}Ad._instance=null;Object(n.a)(Ad,"MruActorIntlHelper",Hd,[]);var wf;(function(b){b[b.success=0]="success";b[b.failure=1]="failure";b[b.spinner=2]="spinner";b[b.none=3]="none"})(wf||(wf={}));Object(n.b)("DisplayState",wf);class eg{constructor(b,h,v,D,P,ca,ta,Ra){this.Rue=null;this.KXe=!0;this.nfd="";
this.unk=0;this.ZWb=null;this.tIe=3;this.Fa=Ra;this.WAa=b;this.ita=h;this.u3j=v;this.FYj=D;this.EYj=P;this.jWa=new Gg.a(()=>new bm.a(ca.value,null));this.j5j=new Gg.a(()=>new bm.a(ta.value,Object(z.a)(this,this.qgn,"mruEventResultReceived")));this.Fa.$("WacInTabOpenMRUIsEnabledForUiHost");this.Fa.$("UiHostSupportsDocRebootFeatures")}qgn(b,h){this.ZWb=b;h||this.a9i()}nYn(){this.QM.rec.eb(Wa.a.d_f,ud.a.frame,Object(z.a)(this,this.d_f,"populateMruMenu"),96)}d_f(b,h,v,D,P){return 1!==v&&P?this.pFn(P):
32}pFn(b){this.Svl();this.Rvl();b.PopulationXML=qg.jvl(this.nfd+this.Rue);return 32}Svl(){var b=3;let h=!1;if(this.nfd&&this.unk===this.ZWb.jLo)u.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.tIe;else{u.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var v=this.QM.iq();this.ZWb=this.pgn.ek("File Open opened",!0);this.nfd&&2!==this.tIe&&3!==this.ZWb.state?
h=!0:(b=this.$cm(this.ZWb),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.yQa&&Rh.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0)),this.nfd=({qhn:b}=this.rLl(this.ZWb)).returnValue);v=this.QM.iq()-v;u.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:v})}2!==b&&(v={["DisplayState"]:wf[b]},1!==b&&(v.IsStale=h),u.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",v));this.tIe=
b}$cm(b){let h;try{h=E.c(b.pOf)}catch(v){h=null,u.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",v)}return h}Rvl(){this.KXe?(u.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.Rue=({s4o:this.KXe}=this.B$m()).returnValue):u.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");u.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.KXe,
["NotDisplayingLink"]:!this.Rue})}rLl(b){let h;1===b.state||0===b.state?(u.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),b=2,h=qg.Jyh(this.E1a(2),this.E1a(5))):3===b.state&&b.pOf?(h=this.NOk(b.pOf),b=0):(u.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),h=qg.KFc(this.E1a(1),this.E1a(2)),b=1);return{returnValue:h,qhn:b}}NOk(b){let h;const v=this.oZc.NFc||"2155708348";if(b.length){h=qg.JFc("lblRecentDocuments",this.E1a(3));
let D=0;for(let P=0;P<b.length;P++){const ca=b[P];"FileName"in ca&&"DocumentUrl"in ca&&"Path"in ca&&(h+=qg.FFc("MruButton"+P,ca.FileName.toString(),ca.Path.toString(),null,this.oZc.c2a,this.oZc.XRc,v,ca.DocumentUrl.toString()),ca.IsPinned&&D++)}h=qg.GZa("RecentDocumentsMenuSection",qg.hQi,this.E1a(2),h);u.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:D})}else h=qg.KFc(this.E1a(0),this.E1a(2)),u.ULS.sendTraceTag(5849664,
202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return h}B$m(){let b;b=!0;let h=this.WMk;var v=this.VMk;if(h&&v||!this.QM.n7a)b=!1;else{const D=this.ZQd.ek("File Open",!1);3===D.state&&(h=D.Sca,v=D.j7a,b=!1)}v=v?String.format(this.E1a(4),v):null;return{returnValue:qg.CNk(this.oZc.NFc,v,h),s4o:b}}a9i(){this.QM.TQi.MIa(this.oZc.KMc)}get QM(){return this.WAa.value}get E1a(){return this.ita.value}get oZc(){return this.u3j.value}get WMk(){return this.FYj.value}get VMk(){return this.EYj.value}get ZQd(){return this.jWa.value}get pgn(){return this.j5j.value}}
Object(n.a)(eg,"MruRenderer",null,[]);var tg=c(1558);class ce{constructor(b,h,v,D,P,ca,ta){this.Gw=null;this.Ieh=!1;this.csa=this.Q1=0;this.ock=b;this.zXb=h;this.Dpd=v;this.ltc=D;this.ybb=P;this.WAa=ca;this.jWa=new Gg.a(()=>new bm.a(ta.value,Object(z.a)(this,this.WEb,"getMoreInfoEventReceived")))}IIc(){!this.Gw&&this.PQf.n7a?this.ZQd.ek("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}WEb(b){if(!this.Gw&&3===b.state)this.Gw=b;else if(2===b.state){this.Ieh?u.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.ZQd.ek("NewDocumentFromStream",!0),this.Ieh=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.Q1=(new Date).getTime();var b=this.ZBl.uMh;if(null===b)this.zXb(null);else{var h=this.Dpd.menuItemId,v=this.Dpd.THa,D=this.Dpd.ZEo,P=this.Dpd.gCl;this.csa="streamBase64"===D?P.length/1024:0;u.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.q7,this.csa);var ca=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
b,G.a.Tj(this.iGa),G.a.Tj(h),G.a.Tj(this.q7),G.a.Tj(w.AFrameworkApplication.lcid.toString()),G.a.Tj(ca.toString()),G.a.Tj(v),G.a.Tj(w.AFrameworkApplication.canary),w.AFrameworkApplication.im,G.a.Tj(D));b+="&"+w.AFrameworkApplication.rSd();w.AFrameworkApplication.i3a&&(b+="&"+w.AFrameworkApplication.TQd());(h=this.Gw?this.Gw.Sca:null)&&(b+="&DestinationUrl="+G.a.Tj(h));this.PQf.YZc.xj(b,2,P,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(z.a)(this,this.thn,"newDocumentFromStreamSuccessHandler"),
Object(z.a)(this,this.shn,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}thn(b){if(b&&b.data&&b.data.ve)if(({av:h}=E.d(b.data.ve)).returnValue)if(b=h,b.StatusCode!==pa.a.My&&b.StatusCode!==pa.a.VIc)u.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.q7,this.csa,b.StatusCode),this.zXb(null);else if(b.NewDocumentUrl&&""!==b.NewDocumentUrl){var h=(new Date).getTime()-this.Q1;u.ULS.sendTraceTag(35156359,
202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.q7,this.csa,h);this.ock(b.NewDocumentUrl)}else u.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.q7,this.csa),this.zXb(null);else u.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.q7,this.csa,{["ResponseData"]:tg.a.Aad(b.data.ve)}),this.zXb(null);else u.ULS.sendTraceTag(24904473,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.q7,this.csa),this.zXb(null)}shn(b){b&&b.data&&u.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.q7,this.csa,b.data.status);this.zXb(null)}get q7(){switch(this.PQf.lxa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get ZBl(){return this.ltc.value}get iGa(){return this.ybb.value}get PQf(){return this.WAa.value}get ZQd(){return this.jWa.value}}
Object(n.a)(ce,"NewDocumentFromStreamOperation",null,[]);class jd{constructor(b,h,v,D){this.ltc=b;this.ybb=h;this.WAa=v;this.i5j=D}create(b,h,v){return new ce(b,h,v,this.ltc,this.ybb,this.WAa,this.i5j)}}Object(n.a)(jd,"NewDocumentFromStreamOperationFactory",null,[789]);var gk=c(129);class Ch{get name(){return"Common.App.NewAndOpen.UX"}xc(b){b.register(jd,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").singleInstance().Rd(()=>
new jd(new Gg.a(()=>w.AFrameworkApplication.ta.Nb.iqf()),new Gg.a(()=>w.AFrameworkApplication.iGa),new Gg.a(()=>b.Na("Common.INewAndOpenCommonHelpers")),new Gg.a(()=>b.Na("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){w.AFrameworkApplication.K.Po(()=>{this.l2a()})}l2a(){const b=zb.a.zp(Ea.a.instance.Sa("Common.INewAndOpenCommonHelpers")),h=zb.a.zp(Ea.a.instance.Sa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));w.AFrameworkApplication.iGa&&gk.Task.WAA.call(null,b,h).continueWith(()=>
{const v=new kg(new Gg.a(()=>b.result),new Gg.a(()=>w.AFrameworkApplication.ta.Nb.iqf()),new Gg.a(()=>h.result),new Gg.a(()=>w.AFrameworkApplication.ta.Nb.jqf().NFc||"1959943459"),new Gg.a(()=>w.AFrameworkApplication.iGa),new Gg.a(()=>w.AFrameworkApplication.dPm));v.Tb();v.c4c()});if(w.AFrameworkApplication.g3f){const v=zb.a.zp(Ea.a.instance.Sa("Common.IEventEmitter<Common.IMruResult>"));gk.Task.WAA.call(null,b,h,v).continueWith(()=>{const D=new eg(new Gg.a(()=>b.result),new Gg.a(()=>Ad.Yxn),new Gg.a(()=>
w.AFrameworkApplication.ta.Nb.jqf()),new Gg.a(()=>w.AFrameworkApplication.Xxn),new Gg.a(()=>w.AFrameworkApplication.Wxn),new Gg.a(()=>h.result),new Gg.a(()=>v.result),w.AFrameworkApplication.K);D.nYn();D.a9i()})}}dispose(){}}Object(n.a)(Ch,"UXPackageManager",null,[1,2,10]);var ug=c(175);class ul extends ug.StandardDialog{constructor(){super();this.Ad=0;this.Ee(1,CommonUIStrings.l_DialogClose)}rO(b){this.nx(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}Qff(b){this.nx(b,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(n.a)(ul,"ErrorDialog",ug.StandardDialog,[784]);var th=c(457);class fg{G4h(){u.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new th.a;b.Bg("api.onedrive.com");return b.task}}Object(n.a)(fg,"OneDriveConsumerEndpointHelper",null,[747]);var ag=c(50);class Ek{constructor(b,h,v,D){this.bwb=this.qGa=null;this.gSe=this.iSe=!1;this.KXb=null;this.Fa=b;this.MSb=h;this.mvb=v;this.fH=D}get Gsh(){return this.MSb}get K(){return this.Fa}t8b(){this.KXb||
(this.KXb=this.zfc?Ua.a.create(this.zfc,null,null,null,!1):null);return this.KXb}setup(b){this.bwb=b;this.iSe||this.gSe?this.iSe&&this.bwb&&this.bwb(!0):(b=this.t8b())?(this.gSe=!0,b.T3a.continueWith(h=>{this.csn(h)}),kb.a.pX(b)):(u.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.bwb(!1))}PUf(b){u.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.")}csn(b){this.gSe=
!1;if(b.Ai)this.PUf(b),this.bwb(!1);else try{this.iSe=!0,u.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Xzf(),u.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.bwb(!0)}catch(h){u.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",h.toString()),this.bwb(!1)}}D9c(b){this.qGa=b;this.mvb?u.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(u.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(z.a)(this,this.QSf,"onApiReady")))}QSf(b){b?this.e1d():this.xp()}xp(){this.fH().rO(ag.a.gxn)}onSuccess(b){u.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.qGa&&this.qGa(!0,b)}dispose(){this.KXb&&this.KXb.dispose()}}Object(n.a)(Ek,"AOneDriveFilePickerApiManager",null,[795,10]);class ze extends Ek{constructor(b,h,v,D,P,ca){super(h,v,D,ca);this.Tm=null;this.eta=b;this.Ckk=P}get zfc(){return this.K.jb("OneDriveApiUrl")}start(b,h){this.Tm=
b;this.D9c(h)}Xzf(){WL.init(1===this.Gsh||2===this.Gsh?{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}D9c(b){this.qGa=b;!this.mvb&&this.eta.FTc?(u.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(z.a)(this,this.QSf,"onApiReady"))):(u.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.Ckk())}e1d(){try{u.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.Tm).then(Object(z.a)(this,this.onSuccess,"onSuccess"),Object(z.a)(this,this.onFailure,"onFailure"))}catch(b){u.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.xp()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){u.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}u.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",b.error.code,
b.error.message)}else u.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.qGa&&this.qGa(!1,b);this.xp()}}Object(n.a)(ze,"OneDriveFilePickerApiManagerV5",Ek,[]);class Kf extends Ek{constructor(b,h,v,D,P){super(b,h,v,D);this.Kkd=this.b$g=null;this.H2j=P;this.options={};this.options.clientId=this.K.jb("OneDriveApiV7ClientId");this.options.cancel=Object(z.a)(this,this.pme,"toggleHostDivVisibility")}get zfc(){return this.K.jb("OneDriveApiV72Url")}start(b,h){this.Kkd=h;const v=
this.H2j.G4h();v.continueWith(()=>{u.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.b$g=v.result;this.D9c((D,P)=>{this.pme();b(D,P)})},3);v.continueWith(()=>{u.ULS.sendTraceTag(24134242,352,15,v.exception.message);this.pme()},5)}Xzf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.b$g;this.options.advanced.iframeParentDiv=this.Kkd}e1d(){try{u.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.pme(),OneDrive.open(this.options)}catch(b){u.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.xp()}}onFailure(b){this.qGa&&this.qGa(!1,b);this.xp()}pme(){this.Kkd.style.visibility="hidden"===this.Kkd.style.visibility?"":"hidden"}}Object(n.a)(Kf,"OneDriveFilePickerApiManagerV7",Ek,[]);class rj extends Ek{constructor(b,
h,v,D){super(b,h,v,D);this.UWj=b;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.K.jb("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get zfc(){return this.K.jb("OneDriveApiV72Url")}start(b,h,v,D){this.options.advanced.iframeParentDiv=v;this.options.advanced.endpointHint=D;this.options.cancel=h;this.UWj.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.D9c(b)}D9c(b){this.qGa=b;this.mvb?u.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(u.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(z.a)(this,this.QSf,"onApiReady")))}Xzf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)}}e1d(){try{u.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){u.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.xp()}}PUf(b){u.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.");kb.a.a1n(this.zfc);this.KXb=null}xp(){this.fH().Qff(ag.a.Qao)}onFailure(b){this.qGa&&this.qGa(!1,b)}}Object(n.a)(rj,"OneDriveFilePickerApiManagerV72",
Ek,[]);class Ij{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(n.a)(Ij,"IExtraData",null,[]);class ai extends rj{constructor(b,h,v,D){super(b,h,v,D);this.options.advanced.filter=b.jb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=w.AFrameworkApplication.Ush;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.jb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new Ij(w.AFrameworkApplication.userSessionId))}get zfc(){return this.K.jb("OneDriveApiV72Url")}e1d(){try{u.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",w.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){u.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.xp()}}}Object(n.a)(ai,"OneDriveFilePickerApiOpenManagerV72",rj,[]);class gg{constructor(b){this.$p=null;this.Xf=b;this.yQe=3}G4h(){this.$p=new th.a;u.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.v$f();return this.$p.task}v$f(b=null){const h=String.format("GetMoreInfoHandler.ashx?{0}",w.AFrameworkApplication.PBb);this.Xf.mzb(h,1,null,b,["PersonalFileStorageUrl",
"X-NewKey"],2,Object(z.a)(this,this.A4l,"getMoreInfoSucceeded"),Object(z.a)(this,this.y4l,"getMoreInfoFailed"),void 0,void 0,void 0,void 0,"21")}y4l(b){if(b.data.Qe===pa.a.via&&"X-NewKey"in b.data.Bj){u.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const h={};h["X-Key"]=b.data.Bj["X-NewKey"];this.v$f(h)}else 0<this.yQe?(u.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.yQe),this.yQe--,this.v$f()):(u.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.$p.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}A4l(b){"PersonalFileStorageUrl"in b.data.Bj&&""!==b.data.Bj.PersonalFileStorageUrl?(u.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.$p.Bg(b.data.Bj.PersonalFileStorageUrl)):(u.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),
this.$p.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(n.a)(gg,"OneDriveForBusinessEndpointHelper",null,[747]);var ol=c(744);class oi{constructor(){this.W=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}xc(b){this.W=b;this.W.register(ze,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").singleInstance().Rd(()=>new ze(ol.a.instance,w.AFrameworkApplication.K,
w.AFrameworkApplication.c8,w.AFrameworkApplication.bpa,w.AFrameworkApplication.Xeg,()=>new ul));w.AFrameworkApplication.gIb?this.W.register(747,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Rd(()=>new fg):this.W.register(747,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Rd(()=>new gg(w.AFrameworkApplication.Ne));this.W.register(Kf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").singleInstance().Rd(()=>new Kf(w.AFrameworkApplication.K,
w.AFrameworkApplication.c8,w.AFrameworkApplication.bpa,()=>new ul,this.W.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.W.register(rj,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").singleInstance().Rd(()=>new rj(w.AFrameworkApplication.K,w.AFrameworkApplication.c8,w.AFrameworkApplication.bpa,()=>new ul));this.W.register(ai,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").singleInstance().Rd(()=>new ai(w.AFrameworkApplication.K,
w.AFrameworkApplication.c8,w.AFrameworkApplication.bpa,()=>new ul))}static main(){N.a.instance.Fc(new oi)}}Object(n.a)(oi,"PackageManager",null,[1,2]);class Hm{constructor(b,h,v,D,P,ca){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=h;this.PolicyCookie=v;this.PolicyCookieTTL=D;this.WasServiceDown=P;this.AffinitizedUrl=ca}}Object(n.a)(Hm,"SafeLinksData",null,
[]);class An{constructor(b,h){this.Ble=b;this.WA=h}}Object(n.a)(An,"SafeLinksGetUrlReputationRequestData",null,[]);class vg{constructor(b,h,v,D){this.Fa=b;this.Xf=h;this.D5j=v;vg.ge=D}wmc(b,h,v){try{var D=null;vg.ge&&(D=vg.ge.Zf("WebServiceCall","SafeLinksGetUrlReputation"));const P=new An(h,D);D={};D.AffinitizedUrl=b;D.TargetUrl=h;D.PolicyCookie=v;const ca=E.c(D);this.Xf.xj(this.D5j,2,ca,null,!1,2,Object(z.a)(this,this.Jpn,"onGetUrlReputationSuccessCallback"),Object(z.a)(this,this.Ipn,"onGetUrlReputationFailureCallback"),
P,void 0,void 0,3E3,3E3,"36");return!0}catch(P){u.ULS.sendTraceTag(588788033,378,10,P.message)}return!1}Jpn(b){let h="OnGetUrlReputationSuccessCallback: ",v=10;const D=b.data.state;try{const P=E.b(b.data.ve).reputationResults[0],ca=P.navigateUrl.length,ta=D.Ble.length,Ra=P.navigateUrl===D.Ble;P.navigateUrl&&0<P.navigateUrl.length&&(D.Ble=P.navigateUrl);h+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",b.data.Qe,P.verdict,
ta.toString(),ca.toString(),Ra.toString());v=50}catch(P){h+=String.format("Exception {0}",P.message)}this.Rli(D,h,v)}Ipn(b){let h="OnGetUrlReputationFailureCallback: ";const v=b.data.state;try{h+=String.format("HttpStatus {0}",b.data.Qe)}catch(D){h+=String.format("Exception {0}",D.message)}this.Rli(v,h,10)}Rli(b,h,v){b.WA&&(b.WA.stop(),b.WA=null);u.ULS.sendTraceTag(588788034,378,v,h);Dd.a.om(b.Ble,void 0,"noopener,noreferrer","SafeLinksNav")}}vg.ge=null;Object(n.a)(vg,"SafeLinksNavigationHelper",
null,[]);var sk;(function(b){b[b.enabledByPolicy=0]="enabledByPolicy";b[b.disabledByPolicy=1]="disabledByPolicy";b[b.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";b[b.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(sk||(sk={}));Object(n.b)("SafeLinksNavigationState",sk);class Ti{constructor(b,h,v,D=!1,P=null,ca=null){this.Stb=this.Rtb=0;this.zUc=this.dkd=!1;this.Sbb=null;this.IWb=!0;this.uud=null;u.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");
this.Fa=b;this.Xf=h;this.Yda=v;Ti.ge=ca;this.upk=D?this.Fa.jb("SafeLinksHandlerWebServiceBase"):this.Fa.jb("WebServiceBase");this.Ook=this.Fa.jb("SafeLinksHashedUserId");this.y8o=this.Fa.jb("SafeLinksWorkloadIdHeaderValue");this.Pod=this.Fa.mc("SafeLinksMaxGetPolicyBootRetries",2);this.Qod=this.Fa.mc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.vmd=this.qSm();this.tmd=this.pSm();Ti.Xkh=this.Fa.jb("UserPrincipalName")||"";Ti.iCc=this.Fa.jb("TenantId")||"";u.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",
this.vmd,this.tmd);if(this.vmd&&this.tmd){h=(b=this.thb())?b.IsSafeLinksEnabled.toLowerCase():"";v=this.xFf();u.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",h,v);var ta=!b||"unknown"===h||b.WasServiceDown||v,Ra=hb.a.iG();Ra&&(Ra.set("shouldGetSafeLinksDataFromServer",ta.toString()),Ra.set("isSafeLinksEnabledCacheValue",h.toString()));P?(this.IWb=!1,P.execute(mb=>{mb.isFeatureEnabled("MsoUrlreputation",!0).then(Jb=>{this.IWb=Jb;Ra.set("isUserLicensedForSafeLinks",
this.IWb.toString());va.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ra);this.IWb&&ta&&this.kSd(!0);return null})})):(va.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ra),ta&&this.kSd(!0))}}get appName(){return this.Yda}get wpe(){return this.upk}get userId(){return this.Ook}get xji(){try{if(""===Ti.xCe){const b={};b["X-AppName"]=this.appName;b["X-AppVersion"]=w.AFrameworkApplication.buildVersion;b.OS=this.Fa.jb("PlatformNameAndVersion")||"";const h=
JSON.stringify(b);Ti.xCe=window.self.btoa(h)}}catch(b){u.ULS.sendTraceTag(508909765,378,10,"GetUrlReputationAdditionalProperties Error: {0}",b.message)}return Ti.xCe}get u9l(){const b=this.wpe?this.wpe+"/":"",h=new eb.QueryStringBuilder("SafeLinksHandler.ashx");h.ze("app",this.appName);this.Fa.$("SafeLinksUseDebugHeader")&&h.ze("action","debug");this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.ze("s2satpop","1");this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&h.ze("s2se03","1");return String.format("{0}{1}&{2}",b,h.toString(),w.AFrameworkApplication.im)}get Gim(){const b=this.wpe?this.wpe+"/":"",h=new eb.QueryStringBuilder("SafeLinksHandler.ashx");h.ze("app",this.appName);this.Fa.$("SafeLinksUseDebugHeader")&&h.ze("action","debug");this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.ze("s2satpop","1");this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.ze("s2saat","1");this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&h.ze("s2se03","1");this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&h.ze("sladpar",this.xji);h.ze("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",b,h.toString(),w.AFrameworkApplication.im)}get Xgn(){Ti.jRe||(Ti.jRe=new vg(this.Fa,this.Xf,this.Gim,Ti.ge));return Ti.jRe}wmc(b){if(!b)return u.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var h=this.JMm(b);u.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",
h,this.vmd,this.tmd,this.IWb);if(!(h&&this.vmd&&this.tmd&&this.IWb))return!1;h=0;const v=({state:h}=this.Dvo()).returnValue;u.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",sk[h]);const D=hb.a.iG();D&&D.set("SafeLinksNavigationState",sk[h]);va.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",D);if(!v)return 2!==h&&3!==h||va.Health.instance.recordKpiFailure("SafeLinksNavigations",sk[h],!1,!0,null),!1;u.ULS.sendTraceTag(26019601,
378,50,"Using safelinks to navigate hyperlink");if(this.awo())return this.xFf()?!1:this.Xgn.wmc(this.uMl(),b,this.vei());if(!this.xFf())return this.hDj(b),!0;this.Sbb=b;u.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.zUc=!1;this.kSd();return!0}JMm(b){b=b.toLowerCase();const h=this.Fa.LC("SafeLinksUnsupportedProtocols");if(h)for(let v=0;v<h.length;v++)if(b.startsWith(h[v]))return!1;return!0}kSd(b=!1){var h=hb.a.iG();h&&h.set("isOnBootRequest",b.toString());
va.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",h);va.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",h);h=this.laf("SafeLinksGetPolicy");this.Xf.xj(this.u9l,1,null,null,!0,2,Object(z.a)(this,this.Rbm,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(z.a)(this,this.Qbm,"getSafeLinksDataFromServer_OnFailureCallback"),h,void 0,void 0,void 0,void 0,"23");this.zUc=b;this.dkd=!0;b?this.Rtb++:this.Stb++}Rbm(b){let h=pa.a.Jin,
v="";try{this.dkd=this.zUc=!1;var D=b.data.state;const Ac=({WA:D}=this.tke(D)).returnValue,Lc=Object.assign(new Bb.a,{durationMs:Ac});va.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",Lc);u.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",b.data.Qe,b.data.ve.length,Ac);if(b.data.Qe!==pa.a.My)v="Unexpected httpStatus: "+b.data.Qe.toString();else{D=null;try{D=E.b(b.data.ve)}catch(id){v="Exception:"+
id.toString()+" deserializing response";return}if(D){var P=D.IsSafeLinksEnabled;if(void 0===P||null===P||0>=P.length)v="Invalid isSafeLinksEnabledString";else{u.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",P);var ca=Ti.DYf(P);if(void 0===D.WebAffinitizedUrl||null===D.WebAffinitizedUrl||0>=D.WebAffinitizedUrl.length)v="Invalid WebAffinitizedUrl";else if(void 0===D.PolicyCookie||null===D.PolicyCookie||0>=D.PolicyCookie.length)v="Invalid PolicyCookie";else if(void 0===D.PolicyCookieTTL||
null===D.PolicyCookieTTL)v="Invalid PolicyCookieTTL";else{var ta=D.WebAffinitizedUrl,Ra=D.PolicyCookie,mb=D.AffinitizedUrl,Jb=new Date;Jb.setMinutes(Jb.getMinutes()+(5<D.PolicyCookieTTL?D.PolicyCookieTTL-5:0));var Ub=Jb.getTime(),cc=new Hm(P,ta,Ra,Ub,!1,mb);this.Ckj(cc);h=b.data.Qe;this.Sbb&&(ca?(this.hDj(this.Sbb),this.Stb=this.Rtb=0):(u.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),va.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",
!0,!0,null),Dd.a.EDb(this.Sbb)),this.Sbb=null)}}}else v="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Ac){v="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Ac.toString()}finally{h!==pa.a.My&&this.Qli(h,v)}}Qbm(b){this.dkd=!1;let h=500,v="";try{let D=b.data.state;const P=({WA:D}=this.tke(D)).returnValue,ca=Object.assign(new Bb.a,{durationMs:P});h=b.data.Qe;va.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+h.toString(),
!1,!0,ca);v="Request Failed, Status="+Tg.a[b.data.status]+" Duration: "+P}catch(D){v="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+D.toString()}finally{this.Qli(h,v)}}Qli(b,h=""){try{if(u.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,h),this.Rtb<this.Pod&&this.Stb<this.Qod)this.kSd(this.zUc);else{this.zUc=!1;u.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.Rtb,this.Stb,b,h);h=null;const v=hb.a.iG();v&&(v.set("HttpStatus",b.toString()),h=Object.assign(new Bb.a,{extendedProperties:v}));va.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,h);const D=new Hm("false","","",0,!0,"");this.Ckj(D);this.Sbb&&(u.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),va.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),Dd.a.EDb(this.Sbb),this.Sbb=null)}}catch(v){u.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",v.toString())}}hDj(b){const h=this.vei(),v=this.Tjm(),D={};D.Url=b;D.SafeLinksCookie=h;D.CorrelationId=ub.a.create().toString();D.WorkloadId=this.y8o;D.UserAgentInfo=aa.a.eG+"|"+this.appName;this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&(D.User=Ti.Xkh,D.TenantId=Ti.iCc,D.AdditionalProperties=this.xji);u.ULS.sendTraceTag(23900187,
378,50,"Validating hyperlink with request correlation: {0}",D.CorrelationId);Dd.a.o_f(Dd.a.kra(4),v,D)}qSm(){const b=this.Fa.jb("IsSafeLinksEnabledForUser");return b?Ti.DYf(b):!1}pSm(){const b=this.Fa.LC("SafeLinksDisabledBrowsers");if(aa.a.e4){if(this.Fa.Sw("SafeLinksForTeamsIsEnabled")&&this.Fa.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,aa.a.eG))return!1;return"officecomhwa"===(this.Fa.jb(w.AFrameworkApplication.yja)||"").toLowerCase()?
!1:!0}awo(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&aa.a.cVc?!0:aa.a.e4}Dvo(){let b;b=0;const h=this.thb(),v=h?h.IsSafeLinksEnabled:"";if(""!==v)return h.WasServiceDown?(u.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===v.toLowerCase()?(u.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):
{returnValue:Ti.DYf(v),state:b};if(this.dkd)return b=3,u.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.Rtb>=this.Pod||this.Stb>=this.Qod)return b=2,u.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.Rtb,this.Pod,this.Stb,this.Qod),{returnValue:!1,state:b};u.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",
this.Pod+this.Qod-(this.Rtb+this.Stb));return{returnValue:!0,state:b}}vei(){const b=this.thb();return b?b.PolicyCookie:""}Tjm(){const b=this.thb();return b?b.WebAffinitizedUrl:""}uMl(){const b=this.thb();return b?b.AffinitizedUrl:""}MWl(){const b=new Date;try{const h=this.thb();b.setTime(h?h.PolicyCookieTTL:0)}catch(h){u.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",h)}return b}xFf(){const b=this.MWl();return!!b&&b.getTime()<Date.now()}thb(){if(!this.uud){const b=
$a.a.instance.getItem(this.userId);if(!b||""===b)return null;this.uud=JSON.parse(b)}return this.uud}Ckj(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.uud=b;b.WasServiceDown||this.N8o(b)}N8o(b){b=JSON.stringify(b);$a.a.instance.setItem(this.userId,b)}laf(b){return void 0!==Ti.ge&&null!==Ti.ge?Ti.ge.Zf("WebServiceCall",
b):null}tke(b){if(void 0!==b&&null!==b){const h=b.si;b.stop();return{returnValue:h,WA:null}}return{returnValue:null,WA:b}}static DYf(b){return"false"!==b.toLowerCase()?!0:!1}}Ti.ge=null;Ti.jRe=null;Ti.iCc="";Ti.Xkh="";Ti.xCe="";Object(n.a)(Ti,"SafeLinksManager",null,[783]);const Tf=b=>{switch(b){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},dm=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";
default:return"Unknown"}};class je{constructor(){this.W=null}get name(){return"Common.App.SafeLinks"}xc(b){this.W=b}init(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.Po(Object(z.a)(this,this.Px,"onFullAppSettingsReady"))}dispose(){}Px(){w.AFrameworkApplication.K.$("WACSafeLinksIsEnabled")&&(this.W.register(Ti,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").singleInstance().Rd(()=>new Ti(w.AFrameworkApplication.K,w.AFrameworkApplication.Ne,String.format("{0}-{1}",
Tf(w.AFrameworkApplication.ta.Nb.Tl),dm(w.AFrameworkApplication.ta.Nb.Wha)),!1,this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),w.AFrameworkApplication.ta.Hq)),this.W.Na("Common.App.SafeLinks.ISafeLinksManager"))}static main(){N.a.instance.Fc(new je)}}Object(n.a)(je,"SafeLinksPackage",null,[1,2]);var Xi=c(227);class Fk{constructor(b){this.ra=new Mc.a;this.Jh=b}Jdb(b){this.ra.addHandler(Fk.Bya,b)}S4c(b){this.ra.removeHandler(Fk.Bya,b)}fZa(b){this.ra.addHandler(Fk.bUa,b)}hNb(b){this.ra.removeHandler(Fk.bUa,
b)}a0e(b){this.ra.addHandler(Fk.Wlc,b)}reg(){this.ra.raiseEvent(Fk.Bya)}Hxf(){return Xi.a.instance.BQa(w.AFrameworkApplication.az)}}Fk.Bya="SE";Fk.Z6c="SEP";Fk.bUa="SER";Fk.Wlc="TRP";Object(n.a)(Fk,"NullSessionExpirationManager",null,[479,480]);class wg{constructor(){this.eBc=this.Ecb=!1;const b=w.AFrameworkApplication.az;0>=b||(this.az=b,u.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.az,["NowGetTime"]:(new Date).getTime(),["BootTime"]:w.AFrameworkApplication.VW}),
Xi.a.instance.frh(Object(z.a)(this,this.pfc,"onSessionExpiredDetected")),Xi.a.instance.erh(Object(z.a)(this,this.u0c,"onSessionExpiringDetected")))}pfc(){Xi.a.instance.Vbj(Object(z.a)(this,this.pfc,"onSessionExpiredDetected"));u.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.axf()}u0c(){Xi.a.instance.O2n(Object(z.a)(this,this.u0c,"onSessionExpiringDetected"));this.eBc||this.Ecb||(u.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.eBc=!0,
this.Zeg())}axf(){this.Ecb||(w.AFrameworkApplication.ZM(ag.a.Y6c),this.Ecb=!0,this.pje())}}Object(n.a)(wg,"ASessionExpirationManager",null,[]);var bg=c(174),vh=c(273);class Ej{constructor(b,h,v,D){this.rjg="";this.Wdd=b;this.wfh=v;this.sfh=D;this.Q0g=h;b=(new Date(this.Wdd)).format(w.AFrameworkApplication.Vpj);this.rjg=this.Q0g?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}Vic(b){1===b?this.wfh&&this.wfh(this.Q0g):0===b&&w.AFrameworkApplication.va.Qb(Wa.a.close,
2,vh.g)}dispose(){this.sfh&&this.sfh()}}Ej.id="SessionExpirationDialog";Object(n.a)(Ej,"SessionExpirationDialogSharedProperties",null,[]);class im{}im.Yg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(n.a)(im,"SessionExpirationDialogHtml",null,[]);class Nd extends bg.a{constructor(b,h,v,D){super(h);const P={};this.jYa=new Ej(b,h,v,D);this.wg=Ej.id;w.AFrameworkApplication.dBh?(this.Ad=1,
this.Ee(0,CommonUIStrings.l_DialogClose)):(this.Ad=0,this.Et=!1);h||1===w.AFrameworkApplication.ta.mode?this.Ee(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Ee(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Yg=im.Yg;P.WACSessionExpirationText=this.jYa.rjg;this.Wh(CommonUIStrings.l_DefaultDialogTitle,Object(z.a)(this,this.Vic,"sessionExpirationDialogHandler"),P);this.h5(this.mj("WACSessionExpirationText"))}Vic(b){this.jYa.Vic(b)}ayf(){this.hide()}dispose(){super.dispose();
this.jYa&&this.jYa.dispose()}}Object(n.a)(Nd,"LegacySessionExpirationDialog",bg.a,[557]);class Qn extends ug.StandardDialog{constructor(b,h,v,D){super(h);this.jYa=new Ej(b,h,v,D);this.wg=Ej.id;w.AFrameworkApplication.dBh?(this.Ad=1,this.Ee(0,CommonUIStrings.l_DialogClose)):(this.Ad=0,this.Et=!1);h||1===w.AFrameworkApplication.ta.mode?this.Ee(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Ee(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Ou(CommonUIStrings.l_DefaultDialogTitle,
this.jYa.rjg,0,Object(z.a)(this,this.Vic,"sessionExpirationDialogHandler"))}Vic(b){this.jYa.Vic(b)}ayf(){this.hide()}dispose(){super.dispose();this.jYa&&this.jYa.dispose()}}Object(n.a)(Qn,"SessionExpirationDialog",ug.StandardDialog,[557]);const Cd=(b,h,v,D)=>w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.mF&&w.AFrameworkApplication.K.$("ReactStandardSessionExpirationDialogIsEnabled")?new Qn(b,h,v,D):new Nd(b,h,v,D);var pl=c(198);class Xf extends wg{constructor(b){super();this.Xud=this.DZb=
!0;this.JZ=null;this.ra=new Mc.a;this.Jh=b}Jdb(b){this.ra.addHandler(Xf.Bya,b)}S4c(b){this.ra.removeHandler(Xf.Bya,b)}fZa(b){this.ra.addHandler(Xf.bUa,b)}hNb(b){this.ra.removeHandler(Xf.bUa,b)}a0e(b){this.ra.addHandler(Xf.Wlc,b)}Hxf(){return Xi.a.instance.BQa(w.AFrameworkApplication.az)}reg(b){this.DZb=b}Zeg(){if(!this.JZ&&!pl.a.mM){if(this.Xud){const b=Object(z.a)(this,this.j5b,"disposeCallback");this.JZ=Cd(this.az,!1,Object(z.a)(this,this.Wic,"sessionExpirationHandler"),b)}this.ra.raiseEvent(Xf.Z6c)}}pje(){this.JZ&&
(this.JZ.zha&&this.JZ.ayf(),this.JZ=null);if(this.DZb){const b=Object(z.a)(this,this.j5b,"disposeCallback");this.JZ=Cd(this.az,!0,Object(z.a)(this,this.Wic,"sessionExpirationHandler"),b)}this.ra.raiseEvent(Xf.Bya)}j5b(){this.JZ=null}Wic(b){(b||this.Jh.LBd())&&this.Jh.refreshDocument(null)}}Xf.Bya="SE";Xf.Z6c="SEP";Xf.bUa="SER";Xf.Wlc="TRP";Object(n.a)(Xf,"SessionExpirationManager",wg,[479,480]);class yg{}yg.aqk="Aborting";yg.$yd="ActivityDuration";yg.error="Error";yg.Sif="Errors";yg.failed="Failed";
yg.uDb="FirstActivity";yg.initialized="Initialized";yg.kickedOut="KickedOut";yg.nYm="LastActivity";yg.jfj="RetryOverride";yg.see="RequestGroups";yg.Pnb="Requests";yg.Fee="Responses";yg.mge="SessionDuration";yg.status="Status";yg.success="Success";yg.NFo="Successful";yg.tokens="Tokens";yg.OZf="PollingDuration";Object(n.a)(yg,"SessionExpirationStrings",null,[]);class cb{constructor(b){this.iC={};this.Rja={};this.vXa={};this.rKi=15;this.J2g=!1;this.rjk=new Date;this.Lnd=new Date;this.Gb=b;this.SN=new qf.a(2,
2,6E4*this.rKi,Object(z.a)(this,this.qMj,"writeMeasures"),135,"SL",!1);this.Gb.Vb(this.SN);this.pAm()}qMj(){u.ULS.sendTraceTag(41964821,217,50,u.ULS.XWc({["Aggregate"]:this.Rja,["Current"]:this.iC}))}pAm(){this.Rja[yg.see]=0;this.Rja[yg.Pnb]=0;this.Rja[yg.Fee]=0;this.Rja[yg.status]=yg.initialized;this.Rja[yg.uDb]=new Date;this.Rja[yg.mge]=0;this.Rja[yg.$yd]=0;this.Rja[yg.mge]=0;this.iC[yg.mge]=0;this.Rja[yg.$yd]=0;this.iC[yg.$yd]=0}get FEn(){this.vXa[yg.OZf]=+new Date-+this.vXa[yg.uDb];return this.vXa}Dzf(b,
h){var v=b[h];v=v?v:0;v++;b[h]=v;this.lbg(b)}lbg(b){const h=new Date;b[yg.$yd]=+h-+this.Lnd;this.Lnd=h;b[yg.mge]=+this.Lnd-+this.rjk;b[yg.nYm]=this.Lnd}R9(b,h){this.iC[b]=h;this.lbg(this.iC)}Bag(b,h){this.iC[b]=h;this.lbg(this.iC)}v$b(b){this.Dzf(this.iC,b);this.Dzf(this.Rja,b);this.Dzf(this.vXa,b)}flush(){this.J2g||(this.Rja[yg.status]=this.iC[yg.status],this.qMj(this.SN),this.Gb.O0(this.SN,6E4*this.rKi))}K6n(){const b=this.iC[yg.status];b&&(this.Rja[yg.status]=b);this.iC={}}a7n(){this.vXa={};this.vXa[yg.OZf]=
0;this.vXa[yg.uDb]=new Date}stop(){u.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.J2g=!0;this.Gb.Xe(this.SN)}}Object(n.a)(cb,"SessionLogger",null,[475]);class Hb{constructor(b,h){this.Xwd=b;this.rAa=h}get tokens(){return this.Xwd}get errors(){return this.rAa}}Object(n.a)(Hb,"TokenRefreshArgs",null,[516]);var bc=c(397);class Cc extends Sys.EventArgs{constructor(b,h,v,D,P,ca,ta){super();this.vXa=b;this.wEn=h;this.see=D;this.failed=P;this.Pnb=ca;this.Fee=
ta}}Object(n.a)(Cc,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Kc=c(34);class kd{constructor(b,h=null,v=null){this.eBc=this.Ecb=!1;this.Xud=this.DZb=!0;this.ra=new Mc.a;this.gBc=this.gwc=this.Jsd=!1;this.Fwb=null;this.Zah=10;this.Ymd=!1;this.NVe=b;this.yHe=w.AFrameworkApplication.pWm;this.Gb=Qg.a.instance;u.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:w.AFrameworkApplication.az,["NowGetTime"]:(new Date).getTime(),["BootTime"]:w.AFrameworkApplication.VW});
this.ye=h||new cb(Qg.a.instance);this.vla=v;Xi.a.instance.frh(Object(z.a)(this,this.Upk,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));Xi.a.instance.erh(Object(z.a)(this,this.rYe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));bc.SessionStatusManager.instance.Y_e(Object(z.a)(this,this.rYe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));bc.SessionStatusManager.instance.zzk(Object(z.a)(this,this.yGn,"preemptiveTokenRefresh"));this.c4g=new Date;w.AFrameworkApplication.oWm&&
(Xi.a.instance.A6e=Object(z.a)(this,this.EUn,"refreshAccessTokenWhenSessionExpired"));b=!1;w.AFrameworkApplication.K&&(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.Zah=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),b=w.AFrameworkApplication.K.$("WopiTokenRefreshWhenNetworkResumed"));
b?bc.SessionStatusManager.instance.Y_e(Object(z.a)(this,this.Vpk,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):bc.SessionStatusManager.instance.Y_e(Object(z.a)(this,this.rYe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}Jdb(b){this.ra.addHandler(kd.Bya,b)}S4c(b){this.ra.removeHandler(kd.Bya,b)}fZa(b){this.ra.addHandler(kd.bUa,b)}hNb(b){this.ra.removeHandler(kd.bUa,b)}a0e(b){this.ra.addHandler(kd.Wlc,b)}Hxf(){return Xi.a.instance.BQa(w.AFrameworkApplication.az)}EUn(){this.PQc(!1);
return!Xi.a.instance.BQa(w.AFrameworkApplication.az)}Upk(b,h){Xi.a.instance.R_d?this.pfc(b,h):this.yHe?(this.gwc=!1,this.PQc(!1)):(this.Ecb||u.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.pfc(b,h))}Vpk(b,h){Xi.a.instance.Q_d?this.u0c(b,h):(Kc.b(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.gwc=!1,this.PQc(!0))}rYe(b,h){Xi.a.instance.Q_d?this.u0c(b,h):this.PQc(!0)}PQc(b){if(!this.Jsd&&!this.gwc)if(this.vla&&
this.vla.zo)this.gBc=!0,this.ye.R9(yg.status,yg.kickedOut),this.ye.flush(),this.ye.stop();else if(u.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.gBc),this.gBc)this.pje();else{this.ye.flush();this.ye.K6n();this.ye.v$b(yg.see);this.Jsd=!0;this.Ymd||(this.ye.a7n(),this.Ymd=!0,this.D9k());const h=this.NVe.YUn(b);h.continueWith(()=>{if(this.NVe.DKn(h))this.ye.v$b(yg.NFo),this.ye.R9(yg.status,yg.success),this.Xud=!1,this.yHe&&(this.DZb=!1),this.gwc=!1,this.c4g=
new Date,this.BEo(),this.ra.raiseEvent(kd.bUa,new Hb(h.result.tokens,null));else{const v=h.result.errors;this.ye.v$b(yg.failed);this.ye.R9(yg.status,yg.failed);b||(this.gBc=this.NVe.xVc(v));this.gBc&&(this.ye.R9(yg.aqk,JSON.stringify(v)),u.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.gwc=!0;this.ra.raiseEvent(kd.bUa,new Hb(null,v))}this.ye.flush();this.Jsd=!1})}}pfc(){this.yHe||Xi.a.instance.Vbj(Object(z.a)(this,this.pfc,"onSessionExpiredDetected"));u.ULS.sendTraceTag(39408094,
217,50,"SessionExpiredDetected");this.axf(Xi.a.instance.R_d)}u0c(){this.eBc||this.Ecb||(u.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.eBc=!0,this.Zeg(Xi.a.instance.Q_d))}axf(b){if(!this.Ecb){var h=b?ag.a.Ago:ag.a.Y6c;const v=Object.assign(new Bb.a,{extendedProperties:new Map});v.extendedProperties.set("ErrorCode",String.format("{0}",h));w.AFrameworkApplication.ZM(h,void 0,["SessionExpired"],v);b||(b=new Date,h=new Date(w.AFrameworkApplication.VW),u.ULS.sendTraceTag(51642974,
217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",h,b,+b-+h),864E5>+b-+h&&va.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,v),2592E5>+b-+h&&va.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,v));this.Ecb=!0;this.pje()}}BEo(){this.Ymd&&(this.Gb.Xe(this.Fwb),this.Ymd=!1)}D9k(){this.Fwb=new qf.a(2,2,1E3*this.Zah,Object(z.a)(this,this.fMo,"tokenRefreshPolling"),
135);this.Gb.Vb(this.Fwb)}fMo(){const b=this.ye.FEn;u.ULS.sendTraceTag(555255521,217,50,"{0}",E.c(b));this.ra.raiseEvent(kd.Wlc,new Cc(b,b[yg.OZf],b[yg.uDb],b[yg.see],b[yg.failed],b[yg.Pnb],b[yg.Fee]))}yGn(){3E5<+new Date-+this.c4g?(u.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.PQc(!1)):u.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}kd.Bya="SE";kd.Z6c="SEP";kd.bUa="SER";kd.Wlc="TRP";Object(n.a)(kd,
"ASessionExpirationManagerWithRefresh",null,[]);class Wd extends kd{constructor(b,h,v=null,D=null){super(h,v,D);this.JZ=null;this.Jh=b}reg(b){this.DZb=b}Zeg(b){if(!this.JZ&&!pl.a.mM){if(b){var h=Object(z.a)(this,this.j5b,"disposeCallback");this.JZ=Cd(w.AFrameworkApplication.cob,!1,Object(z.a)(this,this.Wic,"sessionExpirationHandler"),h)}else if(this.Xud){if(this.Jsd)return;h=Object(z.a)(this,this.j5b,"disposeCallback");this.JZ=Cd(w.AFrameworkApplication.az,!1,Object(z.a)(this,this.Wic,"sessionExpirationHandler"),
h)}u.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",kd.Z6c,b);this.ra.raiseEvent(kd.Z6c)}}pje(){this.JZ&&(this.JZ.zha&&this.JZ.ayf(),this.JZ=null);if(this.DZb){this.ye.stop();if(this.vla&&this.vla.zo)return;const b=Object(z.a)(this,this.j5b,"disposeCallback");this.JZ=Cd(w.AFrameworkApplication.az,!0,Object(z.a)(this,this.Wic,"sessionExpirationHandler"),b)}u.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",kd.Bya);this.ra.raiseEvent(kd.Bya)}j5b(){this.JZ=null}Wic(b){(b||
this.Jh.LBd())&&this.Jh.refreshDocument(null)}}Object(n.a)(Wd,"SessionExpirationManagerWithRefresh",kd,[479,480]);class ve{constructor(b,h,v=null,D=null){this.Fkh=!1;this._instance=null;this._frame=b;this.Gm=h;this.ye=v||new cb(Qg.a.instance);this.vla=D}create(){this.Fkh=w.AFrameworkApplication.C3a;if(!this.Fkh)return new Xf(this._frame);w.AFrameworkApplication.Dn("WOPITokenRefreshIsEnabled");u.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this._instance)switch(w.AFrameworkApplication.g5o){case 1:u.ULS.sendTraceTag(39408090,
217,50,"Creating new NullSessionExpirationManager");this._instance=new Fk(this._frame);break;case 2:u.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new Wd(this._frame,this.Gm,this.ye,this.vla);break;default:u.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new Xf(this._frame)}u.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());
return this._instance}}Object(n.a)(ve,"SessionExpirationManagerFactory",null,[478]);class Ie{}Object(n.a)(Ie,"Error",null,[]);class yf{}Object(n.a)(yf,"NamedResult",null,[]);class gc extends yf{}Object(n.a)(gc,"ErrorInfo",yf,[]);var ff=c(1070);class Gk{constructor(b,h,v,D=null,P=!1,ca=null,ta=!1,Ra=!1){this.qBa=0;this.yMa=this.uo=null;this.Xwd=new Fb.a;this.rAa=new Fb.a;this.$p=null;this.Ovc=!1;this.uCc=this.vCc=null;this.Gb=b;this.dbh=h;this.dbh.execute(mb=>{mb.TB(L.a.Cyf,Object(z.a)(this,this.Zpn,
"onHostResponseReceived"))});this.I2=v;this.mjh=new ff.a("WebServiceCall","TokenRefresh");this.ye=D||new cb(b);this.kjk=P;this.$e=ca?ca:bc.SessionStatusManager.instance;this.aUg=ta;this.Gid=Ra}Zpn(b){if(b.MessageId!==L.a.Cyf)Kc.b(39408099,306,15,"Unexpected message.");else{var h=new Fb.a,v=new Fb.a;this.ye.v$b(yg.Fee);var D=b.Values[H.a.ckj];if(!D||0>=D.length)Kc.b(40122317,306,15,"Found no tokens in the dictionary"),D=b.Values;Kc.b(40122318,306,100,"The Tokens array contains {0} tokens",D.length);
this.ye.R9("Correlation",b.CorrelationId);var P="";for(let Ra=0;Ra<D.length;Ra++){this.ye.Bag(yg.tokens,D.length);var ca=D[Ra],ta=ca;if(!ta||!ta.Name)continue;this.ye.v$b(ta.Name);const mb=ca;if(mb&&mb.Value)Kc.b(39408128,306,100,"Received token with name: {0}",mb.Name),h.add(mb),this.Xwd.add(mb),this.Gid||this.ye.R9(yg.status,yg.success),this.aUg&&this.$e&&this.$e.s7n();else if(ca=this.bcm(ca),Kc.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",ta.Name,
JSON.stringify(ca),this.yMa),v.add(ca),this.Gid||(this.rAa.add(ca),P=JSON.stringify(ca),this.ye.R9(yg.error,JSON.stringify(ca)),this.ye.R9(yg.status,yg.failed)),this.aUg)for(const Jb of ca.Errors)ta=this.BWl(Jb),this.$e&&this.$e.Awk(ta)}this.Gid?(0<v.count?this.uCc?this.uCc(new Hb(h,v)):Kc.b(512267295,306,15,"Received errors but the promise has completed"):this.vCc?this.vCc(new Hb(h,v)):Kc.b(512267294,306,15,"Received valid tokens but the promise has completed"),Kc.b(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
h.count,v.count,b.CorrelationId,this.yMa)):(0<v.count&&""!==P?(D=Object.assign(new Bb.a,{extendedProperties:new Map}),D.extendedProperties.set("Errors",P),D.extendedProperties.set("RetryCount",this.qBa.toString()),D.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),D.extendedProperties.set("IsTokenExpiring",this.Ovc.toString()),va.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,D)):va.Health.instance.recordKpiSuccess("WACTokenRefresh",null),
Kc.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,v.count,b.CorrelationId,this.yMa),0<v.count&&!this.xVc(v)?(b=this.I2.Pfi(v),b!==this.I2.Thc&&(this.ye.Bag(yg.jfj,b),this.Gb.O0(this.uo,b))):(this.ye.flush(),this.uo&&(Kc.b(39408131,306,100,"Deleting task {0} from task manager",this.uo.name),this.Gb.Xe(this.uo)),this.$p&&!this.$p.task.isCompleted?this.$p.Bg(new Hb(h,v)):Kc.b(512267293,306,15,"Received results but the task has completed")))}}bcm(b){if(!b)return null;
const h=Object.assign(new gc,{Name:b.Name,Errors:[]});for(const v of b.Errors)b=new Ie,b.Id=v.Id,b.Details=sa.a.R8b(v.Details,500),h.Errors.push(b);return h}requestTokensOnce(){this.Tdj()}Tdj(){w.AFrameworkApplication.ue("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.qBa>=this.I2.s4d?(Kc.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.yMa),this.oal(this.$p)):(va.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.kjj())}kjj(){const b=
{};b[H.a.ckj]=this.I2.tokens;const h=ub.a.create().toString();Kc.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.I2.tokens),this.qBa+1,h,this.yMa);this.dbh.execute(v=>{v.sendMessage(L.a.v1e,b,h)});this.qBa++;this.ye.v$b(yg.Pnb)}oal(b){const h=new Fb.a;for(let v=0;v<this.I2.tokens.length;v++){const D=Object.assign(new gc,{Name:this.I2.tokens[v],Errors:[Object.assign(new Ie,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});
h.add(D);this.rAa.add(D)}this.Gb.Xe(this.uo);this.ye.R9(yg.Sif,JSON.stringify(this.rAa));this.ye.R9(yg.status,yg.failed);b&&!b.task.isCompleted&&b.Bg(new Hb(new Fb.a,this.rAa))}YUn(b){this.mjh.start();this.Ovc=b;this.yMa=ub.a.create().toString();Kc.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.yMa,this.Ovc);this.qBa=0;this.rAa.clear();this.Xwd.clear();this.$p=new th.a;this.Gid?this.Udj(this.I2.s4d).then(h=>{this.$p&&!this.$p.task.isCompleted&&this.$p.Bg(h);this.uCc=
this.vCc=null;this.ye.R9(yg.Sif,JSON.stringify(this.rAa));this.ye.R9(yg.status,yg.success);this.ye.flush()}).catch(h=>{this.$p&&!this.$p.task.isCompleted&&this.$p.Bg(Object(Na.a)(516,h));this.uCc=this.vCc=null;this.ye.R9(yg.Sif,JSON.stringify(this.rAa));this.ye.R9(yg.status,yg.failed);this.ye.flush()}):(this.uo=new qf.a(this.I2.priority,2,this.I2.Thc,Object(z.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,L.a.v1e,!0),this.kjk&&this.Tdj(),this.Gb.Vb(this.uo));return this.$p.task}Udj(b){const h=
this,v=new Promise((Ra,mb)=>{h.vCc=Ra;h.uCc=mb;va.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);h.kjj()}),D=this,P=new Promise((Ra,mb)=>{window.setTimeout(()=>{mb(D.ELh("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},D.I2.Thc)});let ca=b;const ta=this;return new Promise((Ra,mb)=>{ca--;Promise.race([v,P]).then(Jb=>{va.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ra(Jb)}).catch(Jb=>{var Ub=ta.I2.Thc;if(Object(rb.a)(516,Jb)&&
(Jb=Object(Na.a)(516,Jb),0<Jb.errors.count)){ta.y3m(Jb.errors);ta.doh(Jb.errors);if(ta.xVc(Jb.errors)){mb(Jb);return}const cc=ta.I2.Pfi(Jb.errors);cc!==ta.I2.Thc?(ta.ye.Bag(yg.jfj,cc),Ub=cc):ta.OUm(Jb.errors)&&(Ub=0)}ca?window.setTimeout(()=>{ta.Udj(ca).then(Ra).catch(mb)},Ub):(Ub=ta.ELh("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),ta.doh(Ub.errors),mb(Ub),Kc.b(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
ta.yMa))})})}doh(b){for(let h of b)this.rAa.add(h)}OUm(b){if(!b.count)return!1;b=b.J(b.count-1);return b.Errors.length?"TIMEOUT"==b.Errors[0].Id:!1}ELh(b,h){const v=new Fb.a;for(let D=0;D<this.I2.tokens.length;D++){const P=this.pal(this.I2.tokens[D],b,h);v.add(P)}return new Hb(new Fb.a,v)}pal(b,h,v){return Object.assign(new gc,{Name:b,Errors:[Object.assign(new Ie,{Id:h,Details:v})]})}y3m(b){if(b.count){b=b.J(b.count-1);b=JSON.stringify(b);var h=Object.assign(new Bb.a,{extendedProperties:new Map});
h.extendedProperties.set("Errors",b);h.extendedProperties.set("RetryCount",this.qBa.toString());h.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());h.extendedProperties.set("IsTokenExpiring",this.Ovc.toString());va.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,h);this.ye.R9(yg.error,b);this.ye.R9(yg.status,yg.failed)}}DKn(b){this.mjh.stop();const h=this.$qm(b.result.errors);u.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!h,this.yMa,this.Ovc,this.qBa,this.rAa.count,0<b.result.errors.count?b.result.errors.J(0).Name:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Id:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Details:"");return h?!1:this.CKn(b.result.tokens)}xVc(b){return this.I2.xVc(b)}CKn(b){for(let h=0;h<b.count;h++){const v=b.J(h);if(v.Name===H.a.accessToken){const D=(new Date).getTime();v.Expiry>w.AFrameworkApplication.az?
(u.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:v.Expiry,["NowGetTime"]:D,["BootTime"]:w.AFrameworkApplication.VW},"PreviousAccessTokenTtl",w.AFrameworkApplication.az),w.AFrameworkApplication.accessToken=v.Value,w.AFrameworkApplication.az=Math.floor(v.Expiry),w.AFrameworkApplication.wpg=D,w.AFrameworkApplication.KMa=Math.floor(v.Expiry)):u.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:v.Expiry,
["NowGetTime"]:D,["BootTime"]:w.AFrameworkApplication.VW},"PreviousAccessTokenTtl",w.AFrameworkApplication.az)}}return!0}$qm(b){let h=!1;for(let v=0;v<b.count;v++){h=!0;const D=b.J(v);u.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",D.Name,JSON.stringify(D.Errors),this.yMa)}return h}BWl(b){let h=ag.a.Y6c;b=parseInt(b.Id);if(isNaN(b))h=ag.a.sLj;else{switch(b){case 401:h=ag.a.xpg;break;case 403:h=ag.a.qLj;break;case 500:h=ag.a.rLj;break;case 503:h=ag.a.uLj}h===
ag.a.Y6c&&(h=500<b?ag.a.tLj:ag.a.pLj)}return h}}Object(n.a)(Gk,"TokenRefreshManager",null,[477]);class Sh{constructor(){this.Thc=w.AFrameworkApplication.j5o;this.s4d=w.AFrameworkApplication.h5o;this.tokens=w.AFrameworkApplication.glm();this.priority=w.AFrameworkApplication.k5o;this.Adh=this.xno();this.XXe=w.AFrameworkApplication.flm()}xVc(b){b=JSON.stringify(b);if(this.XXe&&0<this.XXe.length)for(const h of this.XXe)if(0<h.length&&0<=b.indexOf(h))return!0;return!1}Pfi(b){try{if(b)for(let h of b)if(h.Errors)for(const v of h.Errors)if(v.Id in
this.Adh)return Number.parseInvariant(this.Adh[v.Id].toString())}catch(h){u.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.Thc}xno(){const b={};try{if(!w.AFrameworkApplication.vTd()||0>=w.AFrameworkApplication.vTd().length||""===w.AFrameworkApplication.vTd()[0])return b;for(const h of w.AFrameworkApplication.vTd())0<h.length&&(b[h]=w.AFrameworkApplication.i5o)}catch(h){u.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
h.toString())}return b}}Object(n.a)(Sh,"TokenRefreshPolicy",null,[476]);class jm{constructor(){this.W=null}get name(){return"Common.App.SessionExpiration"}init(){w.AFrameworkApplication.K.Po(()=>{this.l2a()})}l2a(){this.W.resolve("Common.ISessionExpirationManagerFactory");this.W.resolve("Common.ISessionExpirationManager");this.W.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}xc(b){this.W=b;b.register(475,"Common.App.SessionExpiration.ISessionLogger").singleInstance().Rd(()=>new cb(Qg.a.instance));
b.register(476,"Common.App.SessionExpiration.ITokenRefreshPolicy").singleInstance().Rd(()=>new Sh);b.register(477,"Common.App.SessionExpiration.ITokenRefreshManager").singleInstance().Rd(()=>new Gk(Qg.a.instance,w.AFrameworkApplication.MO(),b.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),w.AFrameworkApplication.K.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Na("Common.ISessionStatus"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1),w.AFrameworkApplication.K.$("WopiTokenRefreshSyncMessageWithTimeout")));b.register(478,"Common.ISessionExpirationManagerFactory").singleInstance().Rd(()=>new ve(w.AFrameworkApplication.ta,b.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),b.Na("Common.ISessionStatus")));b.register(479,"Common.ISessionExpirationManagerWithDialog").singleInstance().Rd(()=>b.resolve("Common.ISessionExpirationManagerFactory").create());b.register(480,
"Common.ISessionExpirationManager").singleInstance().Rd(()=>b.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){N.a.instance.Fc(new jm)}}Object(n.a)(jm,"SessionExpirationPackage",null,[1,2]);var Jj=c(747),Yd=c(399),ih=c(335),mg=c(205);class Do extends mg.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(n.a)(Do,"PersonaButtonProps",mg.a,[]);class Eo{j4b(b,h){if(b&&!(1>b.length)&&h){var v=Object.assign(new ih.a,{ExternalId:"msPresenceOuter",
ControlList:[]});this.Eal(b,v.ControlList);h.push(v)}}Eal(b,h){const v=Object.assign(new Jj.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Yd.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(h,v);h=Object.assign(new ih.a,{Title:"",ControlList:[]});Array.add(v.Menu.MenuSectionList,h);this.ydl(b,h.ControlList)}ydl(b,h){for(let v=0;v<b.length;v++){const D=Object.assign(new Do,{ExternalId:String.format("CoauthorPersona_{0}",
v),Command:"336231556",DisplayName:b[v].userName,LabelText:b[v].userName,ImageBackColor:b[v].color,PersonaId:b[v].email,IsAnonymous:b[v].isAnonymous});Array.add(h,D)}}}Object(n.a)(Eo,"PresenceContextMenuSectionBuilder",null,[515]);var Da=c(97);class nb{constructor(b,h,v,D){this.Oza=this.qt=this.uo=this.$h=this.pJa=null;this.bvd=b;this.zkk=D;this.bvd.FTc&&(this.uo=new qf.a(3,2,5E3,Object(z.a)(this,this.ZIk,"authenticationCheckTask"),2),w.AFrameworkApplication.nc.Vb(this.uo),this.Tb(h,v));this.bvd.jxk(()=>
{this.sKb()});this.bvd.Vph(()=>{this.tKb()})}get hM(){return this.qt||(this.qt=Ea.a.instance.Na("CommonUI.IBusinessBar"))}get ozh(){return this.Oza||(this.Oza=Ea.a.instance.Na("CommonUI.IBusinessBarEntryFactory"))}Tb(b,h){const v=w.AFrameworkApplication.va;v.eb(Wa.a.hwh,ud.a.frame,b,96);v.eb(Wa.a.iwh,ud.a.frame,h,96);v.qa(Wa.a.ABh,ud.a.frame,Oc.ActionManager.IQ);v.qa(Wa.a.BBh,ud.a.frame,Oc.ActionManager.IQ);v.qa(Wa.a.ZIf,ud.a.frame,Oc.ActionManager.IQ)}sKb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);
w.AFrameworkApplication.va.processAction(Wa.a.hwh,2)}tKb(){this.fJo();w.AFrameworkApplication.va.processAction(Wa.a.iwh,2)}ZIk(){this.bvd.authenticationCheck()}fJo(){this.$h&&(this.$h.hide(),this.$h.dispose(),this.$h=null);this.pJa&&this.hM&&(w.AFrameworkApplication.Nk||this.hM.removeEntry(this.pJa),this.pJa.dispose(),this.pJa=null)}showDialog(b){Da.a.YB(this.$h);this.$h=new ug.StandardDialog;this.zkk||(this.$h.Et=!1,this.$h.Ad=0);this.$h.Ee(1,CommonUIStrings.l_SignIn);this.$h.cV(CommonUIStrings.l_DefaultDialogTitle,
b,Object(z.a)(this,this.pba,"dialogHandler"))}pba(b){1===b?(ol.a.z$d(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),w.AFrameworkApplication.va.processAction(Wa.a.ZIf,2)):(this.pwo(),w.AFrameworkApplication.va.processAction(Wa.a.BBh,2))}pwo(){this.hM&&this.ozh&&(this.pJa=this.ozh.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.pJa.closeable=!0,this.pJa.addButton(CommonUIStrings.l_SignIn,nb.teb,""),this.pJa.qma=
Object(z.a)(this,this.kQk,"businessBarEntryCloseHandler"),this.hM.lA(this.pJa,!1))}kQk(){this.Hol();w.AFrameworkApplication.va.processAction(Wa.a.ABh,2)}Hol(){this.uo&&(w.AFrameworkApplication.nc.Xe(this.uo),this.uo=null)}dispose(){this.uo=this.$h=this.pJa=null}static teb(){ol.a.z$d();w.AFrameworkApplication.va.processAction(Wa.a.ZIf,2)}}Object(n.a)(nb,"SignOutResponseUI",null,[10]);class nc{get name(){return"Common.App.UI"}xc(b){b.register(Eo,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").singleInstance()}init(){}dispose(){Da.a.YB(nc.eta);
nc.eta=null}static main(){N.a.instance.Fc(new nc)}static Gym(b,h,v){nc.bwo()&&(nc.eta=new nb(ol.a.instance,b,h,v))}static bwo(){return w.AFrameworkApplication.B5d&&!w.AFrameworkApplication.nha}}nc.eta=null;Object(n.a)(nc,"CommonAppUIPackage",null,[1,2]);class Hc{get name(){return"Common.App.DialogWithLinkToResource"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new Hc)}}Object(n.a)(Hc,"CommonAppDialogWithLinkToResourcePackage",null,[1,2]);var bd=c(66);class ee{constructor(b){this.iy=b;this.Zx=
Array.indexOf(this.iy,this.zga)}dispose(){this.iy=null}get y3(){return this.iy[this.Zx]}Ly(b){this.g7c(b,!1);return!0}Z6b(b){this.g7c(b,!0)}g7c(b,h){b&&(this.y3!==b||h)&&(b.tabIndex=0,bd.FocusManager.YJ(b));Array.contains(this.iy,b)&&(this.Zx=Array.indexOf(this.iy,b))}get O3i(){let b=this.Zx;do if(b)if(0<b&&b<this.iy.length)b--;else break;else b=this.iy.length-1;while(!Ee.DOMFocusListing.c0a(this.iy[b])&&b!==this.Zx);return this.iy[b]}get jRi(){let b=this.Zx;do if(b===this.iy.length-1)b=0;else if(0<=
b&&b<this.iy.length-1)b++;else break;while(!Ee.DOMFocusListing.c0a(this.iy[b])&&b!==this.Zx);return this.iy[b]}get zga(){let b=0;for(;!Ee.DOMFocusListing.c0a(this.iy[b])&&b<this.iy.length;)b++;return Ee.DOMFocusListing.c0a(this.iy[b])?this.iy[b]:null}get Ncc(){let b=this.iy.length-1;for(;!Ee.DOMFocusListing.c0a(this.iy[b])&&0<b;)b--;return Ee.DOMFocusListing.c0a(this.iy[b])?this.iy[b]:null}}Object(n.a)(ee,"DialogFocusListing",null,[92]);var ic=c(54);class af extends ug.StandardDialog{constructor(b,
h,v,D=null){super();this.Pea=this.Mw=this.R$a=null;this.iy=[];this.qrd=h;this.sk=b;this.t6j=v;this.pud=D;this.hm=new ff.a("LoadResource","LoadPrintablePdf")}IDa(){this.Ad=5;this.width=40;const b=document.createElement("span");b.id=this.mj("DirectPrintHeaderContent");const h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(h,"DirectPrintHeader");this.Pea=document.createElement("iframe");this.Pea.name="pdfObjectFrame";this.Pea.title=
CommonUIStrings.l_DirectPrintDialogIFrame;this.Pea.onload=Object(z.a)(this,this.rIn,"printablePdfLoaded");if(this.pud&&0<this.pud.count){var v=ia.a.Xsf(this.qrd,this.pud);const D=ia.a.C5f(this.qrd,this.pud);this.Mw=document.createElement("form");this.Mw.id="printPreviewPostForm";this.Mw.method="POST";this.Mw.target=this.Pea.name;this.Mw.action=D;for(let P of v)v=document.createElement("input"),v.type="hidden",v.name=P.key,v.value=P.value,this.Mw.appendChild(v)}else this.Pea.setAttribute("src",this.qrd);
Sys.UI.DomElement.addCssClass(this.Pea,pl.a.L8g);this.t6j?(Sys.UI.DomElement.addCssClass(this.Pea,"DirectPrintPdfObjectHidden"),h.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,cf.a.hr(this.Pea,cf.a.mA,cf.a.lp)):(Sys.UI.DomElement.addCssClass(this.Pea,"DirectPrintPdfObject"),this.iy.push(this.Pea));b.appendChild(h);b.appendChild(document.createElement("br"));b.appendChild(this.Pea);this.Mw&&b.appendChild(this.Mw);b.appendChild(document.createElement("br"));b.appendChild(this.W4k(this.Mw?
"#":this.qrd));this.hm.start();this.ylb(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.h5(this.mj("DirectPrintHeaderContent"));this.Mw&&this.Mw.submit();this.Fal();u.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}W4k(b){const h=document.createElement("span");var v=document.createElement("span");v.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;h.appendChild(v);w.AFrameworkApplication.K&&(2===w.AFrameworkApplication.ta.Nb.Tl&&w.AFrameworkApplication.K.$("PPTDisableDirectPrintDialogDownloadPDFLink")||
1===w.AFrameworkApplication.ta.Nb.Tl&&w.AFrameworkApplication.K.$("XLODisableDirectPrintDialogOpenPDFLink"))?(b=document.createElement("span"),2===w.AFrameworkApplication.ta.Nb.Tl?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===w.AFrameworkApplication.ta.Nb.Tl&&(b.innerText=CommonUIStrings.l_InternalError_Directive,u.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.R$a=b,h.appendChild(document.createElement("br")),h.appendChild(b)):(v=
document.createElement("a"),v.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,v.href=b,v.target="_blank",v.id="PrintPDFLink",v.className="AllowBrowserClick",this.R$a=v,h.appendChild(document.createElement("br")),h.appendChild(v),this.Mw&&Le.a.addHandler(v,"click",Object(z.a)(this,this.Bvn,"onSubmit")),this.sk.nb(Ed.a.click,this.R$a,Object(z.a)(this,this.FUh,"downloadPDFLinkClicked"),null));this.iy.push(this.R$a);return h}Bvn(b){this.Mw&&(this.Mw.target="_blank",this.Mw.submit());b.preventDefault()}Fal(){if(0<
this.iy.length){const b=new ee(this.iy),h=bd.FocusManager.instance().Ts();h&&(this.R$a.focus(),h.fk=b,h.oR=!0)}}FUh(){u.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}rYc(){u.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}rIn(){u.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.hm&&this.hm.stop()}dispose(){this.R$a&&(this.sk.sc(Ed.a.click,this.R$a,Object(z.a)(this,this.FUh,"downloadPDFLinkClicked")),
this.R$a=null);ic.a.lx(this.Pea);this.Pea=null;super.dispose()}}Object(n.a)(af,"DirectPrintDialog",ug.StandardDialog,[555]);class Vc{constructor(b){this.sk=b}nVl(b,h,v=null){return new af(this.sk,b,h,v)}}Object(n.a)(Vc,"DirectPrintDialogFactory",null,[541]);class Mg{constructor(b,h){this._url=b;this.yek=h}pTh(){this.yek?Dd.a.downloadFile(this._url):Dd.a.om(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(n.a)(Mg,"OpenUrlInTabDialogDownloadBehavior",null,
[558,10]);class We extends ug.StandardDialog{constructor(b,h=!0,v=!1,D=null,P=null,ca=!1,ta=null){super();this.wVb=this.vVb=this.Mw=this.B2=null;var Ra=this.Mjg?this.Mjg:CommonUIStrings.l_DefaultDialogTitle;We.Q9b=ca;this.eZj=ta;this.wze=D||new Mg(b,!0);const mb=[],Jb=[];We.AL&&(this.gAd&&this.gAd.forEach(cc=>{Array.add(mb,cc)}),this.urh&&this.urh.forEach(cc=>{Array.add(Jb,cc)}));h?v?this.DYd?(this.Ad=12,this.Ee(1,this.buttonText),this.Ee(2,CommonUIStrings.l_DownloadACopyDialog_CopyALinkButton),this.Ee(3,
CommonUIStrings.l_DialogClose)):this.PYd?(this.Ad=12,this.Ee(1,this.buttonText),this.Ee(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),this.Ee(3,CommonUIStrings.l_DialogClose)):(this.Ad=4,this.Ee(1,this.buttonText),this.Ee(2,CommonUIStrings.l_DialogClose)):(this.Ad=6,this.Ee(0,CommonUIStrings.l_DialogClose)):this.Ad=5;ca=document.createElement("span");this.WIc&&(ca.className=this.WIc);D=document.createElement("a");D.innerText=this.ddc;D.href=b;D.target="_blank";D.id=this.XXc;D.className=
Ne.AFrame.X0e;if(ta=!aa.a.e4&&!!P&&0<P.count){const cc=ia.a.Xsf(b,P);P=ia.a.C5f(b,P);D.href="#";D.target="_self";this.Mw=document.createElement("form");this.Mw.id="printPreviewPostForm1";this.Mw.method="post";this.Mw.target="_blank";this.Mw.action=P;for(var Ub of cc)P=document.createElement("input"),P.type="hidden",P.name=Ub.key,P.value=Ub.value,this.Mw.appendChild(P)}else this.Mw=null;this.Mw||We.Q9b?We.Q9b||Array.add(Jb,{["type"]:"AppLinkProps",["id"]:this.XXc,["text"]:this.ddc,["onExecute"]:()=>
{this.q7i()}}):Array.add(Jb,{["type"]:"AppLinkProps",["id"]:this.XXc,["text"]:this.ddc,["handler"]:{["href"]:ta?"#":b,["target"]:ta?"_self":"_blank"}});this.q4a&&Array.add(mb,this.q4a);v?(b=document.createElement("span"),b.innerText=this.q4a.replace("{0}",""),ca.appendChild(b)):this.OOi?(b=document.createElement("span"),b.id=this.mj("message"),Ub=document.createElement("span"),P=document.createElement("span"),ta=this.q4a.split("{0}"),Ub.innerText=ta[0],P.innerText=ta[1],b.appendChild(Ub),b.appendChild(D),
b.appendChild(P),ca.appendChild(b)):(b=document.createElement("span"),b.innerText=this.q4a,ca.appendChild(b),ca.appendChild(document.createElement("br")),ca.appendChild(document.createElement("br")),ca.appendChild(D),We.Q9b||Array.add(mb,"{0}"));this.Mw&&ca.appendChild(this.Mw);We.AL&&(this.Ukb&&(this.DXc?this.goh(this.Ukb,this.DXc):(Array.add(mb,"{0}"),Array.add(Jb,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.Ukb,["onExecute"]:()=>{}}))),this.KDc(mb,Jb));this.ylb(Ra,null,this.Nyf,
null,Object(z.a)(this,this.pba,"dialogHandler"),We.AL?null:ca);this.h5(this.mj("message"));!We.AL&&this.DXc&&this.Ukb&&(Ra=document.createElement("div"),Ra.className="WACDialogLearnMoreLinkContainer",this.B2=document.createElement("a"),this.B2.innerText=this.Ukb,this.B2.href=this.DXc,this.B2.target="_blank",this.B2.id=this.mj("LearnMoreLinkId"),this.B2.className=Ne.AFrame.X0e,Ra.appendChild(this.B2),h?this.Hc.insertBefore(Ra,this.Hc.lastChild):this.Hc.appendChild(Ra),this.h5(String.format("{0} {1}",
this.mj("message"),this.mj("LearnMoreLinkId"))));this.rsc=D;v?this.W0(this.$G):this.W0(this.rsc);this.DKf();w.AFrameworkApplication.ta.k1.nb(Ed.a.click,this.rsc,Object(z.a)(this,this.EUh,"downloadLinkClicked"),null);this.B2&&w.AFrameworkApplication.ta.k1.nb(Ed.a.click,this.B2,Object(z.a)(this,this.hGi,"learnMoreLinkClicked"),null);this.OV=!1}get Nyf(){return null}get Mjg(){return null}get q4a(){return null}get OAh(){return this.eZj}get DXc(){return null}get Ukb(){return null}get OOi(){return!1}get buttonText(){return CommonUIStrings.l_Open}get WIc(){return null}get gAd(){return null}get urh(){return null}get DYd(){return!1}get PYd(){return!1}X$e(){}IVh(){}bma(){this.Mw&&
(this.vVb||(this.vVb=Object(z.a)(this,this.Xkn,"onActionButtonClicked"),this.Mq.nb(Ed.a.click,this.$G,this.vVb)),this.wVb||(this.wVb=Object(z.a)(this,this.Ykn,"onActionButtonKeyUp"),this.ae.nb(Ed.a.uh,this.$G,this.wVb)));super.bma()}Xkn(b){this.jYh(b);return!0}Ykn(b){return this.$Wc(b,Object(z.a)(this,this.jYh,"executeDismissActionButtonFromArgs"))}jYh(b){this.Mw&&this.Mw.submit();this.$Cb(b.xf)}rYc(){}EUh(){this.EKf();this.Mw?this.Mw.submit():this.wze.pTh();return!0}hGi(){return!1}dispose(){this.wze.dispose();
this.rsc&&(w.AFrameworkApplication.ta.k1.sc(Ed.a.click,this.rsc,Object(z.a)(this,this.EUh,"downloadLinkClicked")),this.rsc=null);this.B2&&(w.AFrameworkApplication.ta.k1.sc(Ed.a.click,this.B2,Object(z.a)(this,this.hGi,"learnMoreLinkClicked")),this.B2=null);this.Mq&&this.vVb&&(this.Mq.sc(Ed.a.click,this.$G,this.vVb),this.vVb=null);this.ae&&this.wVb&&(this.ae.sc(Ed.a.uh,this.$G,this.wVb),this.wVb=null);super.dispose()}q7i(){this.Mw&&(document.body.appendChild(this.Mw),this.Mw.submit(),document.body.removeChild(this.Mw))}pba(b){1===
b?(this.rYc(),this.Mw?We.AL&&this.q7i():this.wze.pTh()):2===b&&(this.DYd?this.X$e():this.PYd&&this.IVh());this.dispose()}static get AL(){return w.AFrameworkApplication.ta.Nb.mF&&w.AFrameworkApplication.ta.Nb.mBi}static get Q9b(){return We.EYg}static set Q9b(b){We.EYg=b}}We.EYg=!1;Object(n.a)(We,"ADialogWithLinkToResource",ug.StandardDialog,[]);class Jh extends We{constructor(b,h,v=null,D=!0,P=!1){super(b,!0,!(Jh.Bqb&&D),new Mg(b,h),v,P);Jh.Bqb=Jh.Bqb&&D;if(Jh.Bqb){h=document.createElement("iframe");
D=null;P=this.ORh;h.name="pdfObjectFrame";h.id="pdfObjectIFrame";if(v&&0<v.count){const ca=ia.a.Xsf(b,v);b=ia.a.C5f(b,v);D=document.createElement("form");D.id="printPreviewPostForm";D.method="POST";D.target=h.name;D.action=b;for(let ta of ca)b=document.createElement("input"),b.type="hidden",b.name=ta.key,b.value=ta.value,D.appendChild(b)}else h.src=b;P.appendChild(h);D&&(P.appendChild(D),D.submit());Sys.UI.DomElement.addCssClass(h,"DirectPrintPdfObjectHidden");cf.a.hr(h,cf.a.mA,cf.a.lp)}}get Nyf(){return"Print_32x32x32"}get Mjg(){return Jh.Bqb?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get q4a(){return Jh.Bqb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get gAd(){const b=[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(We.Q9b){let h=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==w.AFrameworkApplication.ta.Nb.UOh&&(h=w.AFrameworkApplication.ta.Nb.UOh);Array.add(b,h)}return Jh.Bqb?b:null}get ddc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get XXc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get WIc(){return w.AFrameworkApplication.P_a?
"UIFontDialogTextLarge":null}DKf(){u.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}EKf(){w.AFrameworkApplication.Qm.h2a(9540);u.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}rYc(){u.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get Bqb(){return!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.mF&&w.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(aa.a.e4||aa.a.Gt||aa.a.lj||aa.a.pca)&&!w.AFrameworkApplication.EWc&&
w.AFrameworkApplication.K.$("ShouldHostDefaultToNativeBrowserPrintExperience")}static set Bqb(b){}}Object(n.a)(Jh,"PrintDialogWithLinkToPdf",We,[]);class pi{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");this.dRm=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.HNm=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.GPb=(b.DirectPrintSupportedMimeTypes||"").split(pi.jff);this.xpb=(b.DirectPrintSupportedPlugins||"").split(pi.jff);this.Jwm=(b.DirectPrintImmersivePreviewPlugins||
"").split(pi.jff);this.Ywi=Boolean.parse(b.DirectPrintEnabledForEdge||"false");this.WHm=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.ZXk=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.zNf=14;this.aPi=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const h=b.split(".");2===h.length?(this.zNf=parseInt(h[0]),this.aPi=parseInt(h[1])):u.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else u.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}pi.jff=",";Object(n.a)(pi,"DirectPrintBrsSettings",null,[]);class Yj{constructor(b,h){this.shg=b;this.xpb=h}}Object(n.a)(Yj,"DirectPrintProbeResults",null,[]);class Zk{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb){this.Uxd=null;this.D1j=b;this.Kxc=h;this.eLe=v;this.Z8j=D;this.d$j=P;this.Bzc=new Gg.a(Object(z.a)(this,this.m$l,"getProbeResults"));this.Trc=ca;this.c5g=mb;this.ZS=ta;this.Mvc=Ra;this.y$j=Jb}get GQ(){return this.D1j}start(){}OIn(){this.GQ.dRm&&
this.$6m()}DNn(){const b=Array(this.GQ.GPb.length);if(void 0!==this.Kxc&&null!==this.Kxc)for(let h=0;h<this.GQ.GPb.length;h++)b[h]=this.GQ.GPb[h]in this.Kxc&&this.Z8j(this.Kxc[this.GQ.GPb[h]]);return b}ENn(){const b=Array(this.GQ.xpb.length),h=!(void 0===this.eLe||null===this.eLe);for(let v=0;v<this.GQ.xpb.length;v++){const D=this.GQ.xpb[v];b[v]=h&&D in this.eLe?!0:this.d$j(D)}return b}afm(){const b=this.DNn(),h=Array(b.length);for(let v=0;v<b.length;v++)h[v]=b[v]?this.pAl(this.Kxc[this.GQ.GPb[v]]):
null;return h}pAl(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}$6m(){u.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.Bzc.value.shg,this.Bzc.value.xpb)}m$l(){var b=this.afm();const h=this.ENn(),v={},D={};for(let P=0;P<this.GQ.GPb.length;P++)v[this.GQ.GPb[P]]=b[P];for(b=0;b<this.GQ.xpb.length;b++)D[this.GQ.xpb[b]]=h[b];return new Yj(v,D)}Uvo(){return this.y$j||!this.GQ.isEnabled||w.AFrameworkApplication.EWc?!1:this.aGo()}$vo(){if(null!=
this.Uxd)return this.Uxd;const b=Zk.Xwi(this.GQ);return this.Uxd=this.GQ.Ywi&&b||this.VHm()}VHm(){return aa.a.Aq&&this.GQ.WHm&&aa.a.YXk>=this.GQ.ZXk?!0:!1}aGo(){if(!this.Mvc(this.GQ))return!1;var b=jb.a.CFb(this.Bzc.value.shg);for(const h of b)if(void 0!==h&&null!==h)return!0;b=jb.a.CFb(this.Bzc.value.xpb);for(const h of b)if(h)return!0;return!1}jrm(){const b=jb.a.CFb(this.Bzc.value.shg);for(const h of b)if(Wl.a.contains(this.GQ.Jwm,h))return!0;return!1}ryo(b,h=null){w.AFrameworkApplication.ta&&w.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")?
this.c5g(b,h):this.Uvo()?this.Lpl(b,this.jrm()&&!0,h):this.c5g(b,h)}Lpl(b,h,v=null){const D=this.ZS.Zf("UserAction","OpenDirectPrintDialog");this.Trc.nVl(b,h,v).IDa();D.stop()}static QTm(b){try{return new ActiveXObject(b),!0}catch(h){u.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static LKm(b){return void 0===b||null===b?!1:!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const h=new pi(w.AFrameworkApplication.K.appSettings);let v=
null;try{v=window.navigator.mimeTypes}catch(Jb){u.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let D=null;try{D=window.navigator.plugins}catch(Jb){u.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const P=Zk.LKm,ca=Zk.QTm;b=b.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const ta=w.AFrameworkApplication.ta.Hq,Ra=Zk.STm,mb=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.mF&&!w.AFrameworkApplication.K.$("PrintDialogFallbackLinkEnabled");
return new Zk(h,v,D,P,ca,b,ta,Ra,(Jb,Ub)=>new Jh(Jb,!1,Ub,!0,mb),w.AFrameworkApplication.nha)}static STm(b){return aa.a.Aq||aa.a.Gt&&b.HNm||b.Ywi&&Zk.Xwi(b)?!0:!1}static Xwi(b){var h=aa.a.D5b;if(h){var v=h.split(".");if(2===v.length)return h=parseInt(v[0]),v=parseInt(v[1]),h>b.zNf||h===b.zNf&&v>=b.aPi}return!1}}Object(n.a)(Zk,"DirectPrintManager",null,[512]);class sj{constructor(){this.Ssb=this.W=null}get name(){return"Common.App.DirectPrint"}xc(b){this.W=b;b.register(Vc,"Common.App.DirectPrint.DirectPrintDialogFactory").singleInstance().Rd(()=>
new Vc(w.AFrameworkApplication.ta.k1));b.register(512,"Common.App.DirectPrint.IDirectPrintManager").singleInstance().Rd(()=>Zk.create(this.W))}init(){this.Ssb=this.W.resolve("Common.App.DirectPrint.IDirectPrintManager");this.Ssb.start()}dispose(){}}Object(n.a)(sj,"PackageManager",null,[1,2]);class tk{constructor(b,h=3E4){this.ckg=9E5;this.ekg=1E4;this.dMi=this.Fdc=null;this.OLf=0;this.Hfb=Date.now;this.fhm=b;this.C7a=h;this.bOd()}Vii(b=!0){const h=this.Hfb();if(h<this.OLf+this.ckg)return h>this.OLf+
this.ekg&&this.bOd(),this.dMi;b&&this.bOd();return null}getToken(b=!0){return(b=this.Vii(b))?Promise.resolve(b):this.bOd()}bOd(){return this.Fdc=this.Fdc||new Promise(b=>{this.fhm().then(h=>{this.Fdc=null;""!==h&&h&&(this.dMi=h,this.OLf=this.Hfb(),b(h));b(null)}).catch(()=>{this.Fdc=null;b(null)});window.setTimeout(()=>{this.Fdc=null;b(null)},this.C7a)})}}Object(n.a)(tk,"OAuthCacheManager",null,[]);var Qm=c(112),Li=c(287);class km{constructor(){this.f9=null;this.iUg={};this.Ulc=new Ia.a(Va.a.Fh())}getToken(b,
h){if(this.Ulc.mb(h))return this.Ulc.J(h).getToken();const v=new tk(()=>this.Wii(b,h));this.Ulc.Z(h,v);return v.getToken()}ehm(b,h){if(this.Ulc.mb(h))return this.Ulc.J(h).Vii();const v=new tk(()=>this.Wii(b,h));this.Ulc.Z(h,v);return null}Wii(b,h){if(!this.f9)try{this.f9=Ea.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(v){u.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+v)}return this.f9?new Promise(v=>{const D=Date.now();this.f9.PY(b,h).then(P=>{const ca=P.Token;
!P.IsSuccess||this.RUm(ca)?(this.Hic("GetTokenInternalImplicitJS",!1,Date.now()-D,b,P.ErrorCode,P.ErrorMessage,h),v(null)):(this.Hic("GetTokenInternalImplicitJS",!0,Date.now()-D,b,P.ErrorCode,P.ErrorMessage,h),v(ca))}).catch(P=>{P=P?E.c(P):"";this.Hic("GetTokenInternalImplicitJS",!1,Date.now()-D,b,"Caught Exception",P,h);v(null)})}):new Promise(v=>{this.Hic("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");v(null)})}Hic(b,h,v,D,P="",ca="",ta=""){var Ra="Search"===D;const mb=
[];b=Qm.a.r8(Ra?"Event":"EventName",b,2);D=Qm.a.r8("AppName",D,2);Array.add(mb,b);Array.add(mb,D);Ra&&(D=Qm.a.r8("LatencyType","FetchToken",2),Array.add(mb,D));P&&""!==P&&(P=Qm.a.r8("ErrorCode",P,2),Array.add(mb,P));ca&&""!==ca&&(ca=Qm.a.r8("ErrorMessage",ca,2),Array.add(mb,ca));ta&&""!==ta&&(ca=!(ta in this.iUg),this.iUg[ta]=ca,ca=Qm.a.r8("WarmUpCall",ca.toString(),1),Array.add(mb,ca),ta=Qm.a.r8("Service",this.ddm(ta),2),Array.add(mb,ta));Ra=Ra?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";
h=Object.assign(new Li.a,{name:Ra,samplingPolicy:2,dataFields:mb,succeeded:h,durationMs:v});fa.a.sendActivityEvent(h)}ddm(b){return b===w.AFrameworkApplication.zLf?"Loki":b===w.AFrameworkApplication.khg?"Substrate":w.AFrameworkApplication.K&&b===w.AFrameworkApplication.K.jb("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}RUm(b){return!b||!b.length}}Object(n.a)(km,"SearchOAuthManager",null,[470]);class Kg{constructor(){this.W=null}get name(){return"Common.App.SearchOAuthManager"}xc(b){this.W=
b;this.W.register(470,"Common.App.SearchCommon.ISearchOAuthManager").singleInstance().Rd(()=>new km)}init(){}dispose(){}static main(){N.a.instance.Fc(new Kg)}}Object(n.a)(Kg,"SearchOAuthPackage",null,[1,2]);var sf=c(221),he=c(5),oe=c(18),$e=c(17),fe=c(8);class El{constructor(b,h,v){this.WLe=this.fxb=this.TLe=this.exb=this.JIe=null;this.Fnm=D=>{try{this.Enm(D)}catch(P){D=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",P.message,P.stack),u.ULS.sendTraceTag(5285580,
334,10,D)}};this.Wp=b;this.p2j=h;this.hb=v;this.init()}init(){this.p2j.nb(this.Fnm);this.exb=new fc.a;this.TLe=new fc.a;this.fxb=new fc.a;this.WLe=new sf.a}Y4(b){this.exb.add(b.key,b)}ohc(b){this.fxb.add(b.key,b)}Enm(b){let h;const v=this.hb.gb.kb;({Kcf:h}=El.bQo(v)).returnValue&&(b=El.RSl(b,this.JIe,h),this.gJn(b,h,v),this.JIe=h)}gJn(b,h,v){b=this.yMl(b,h,v);let D;({notification:D}=El.SPo(b)).returnValue&&this.Wp.sendNotification(D,!1)}yMl(b,h,v){const D=new fc.a;D.Z(1,new sf.a);D.Z(0,new sf.a);
b.forEach(P=>{3===P?(El.Fdg(h.node)||this.r6n(h,v),this.c8l(D,h)):P||this.nTl(D,h);return!0});return D}r6n(b,h){this.exb.forEach((v,D)=>{D.reset(b,h);return!0})}nTl(b,h){let v=new fc.a;El.Fdg(h.node)||(v=this.lTl(h.cpBegin));this.mTl(b,this.TLe,v,El.Vij(this.JIe,h));this.TLe=v}lTl(b){const h=new fc.a;this.exb.forEach((v,D)=>{v=null;({WF:v}=D.xIa(b)).returnValue&&h.Z(D.key,v);return!0});return h}mTl(b,h,v,D){const P=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;h.forEach((ca,ta)=>{const Ra=
this.exb.J(ca).Uw||ta.title;let mb;({value:mb}=v.Dc(ca)).returnValue?D&&mb.contentObject!==ta.contentObject&&(Ra&&b.J(1).add(Ra),ca=this.exb.J(ca).Uw,ca=String.format(P,mb.title,ca),mb.description&&(ca+=", "+mb.description),b.J(0).add(ca)):Ra&&b.J(1).add(Ra);return!0});v.forEach((ca,ta)=>{h.mb(ca)||(ca=this.exb.J(ca).Uw,ca=String.format(P,ta.title,ca),ta.description&&(ca+=", "+ta.description),b.J(0).add(ca));return!0})}c8l(b,h){h=this.tem(h.node);h=this.H0k(h);this.uem(b,this.WLe,h);this.WLe=h}tem(b){const h=
new he.GraphIterator;h.set(b);if(!h.zb(1))return null;const v=new sf.a;for(;1!==h.We;)this.fxb.forEach((D,P)=>{let ca;({yma:ca}=P.tmc(h)).returnValue&&v.add(ca);return!0}),h.wc();v.reverse();return v}H0k(b){b=b.toArray();let h=0;for(;h<b.length-1;){var v=b[h];if(v.MG===b[h+1].MG&&(this.fxb.J(v.MG),({K0k:v}={returnValue:!1,K0k:null}).returnValue)){b.splice(h,2,v);continue}h++}return new sf.a(b)}uem(b,h,v){var D;for(D=0;D<Math.min(v.length,h.length)&&v.J(D).contentId.equals(h.J(D).contentId);D++){var P=
this.fxb.J(v.J(D).MG).nEb(v.J(D),h.J(D));P&&(v.J(D).description&&(P+=", "+v.J(D).description),b.J(0).add(P))}for(P=D;P<v.length;P++){let ca=this.fxb.J(v.J(P).MG).nEb(v.J(P),null);ca&&(v.J(P).description&&(ca+=", "+v.J(P).description),b.J(0).add(ca))}for(v=D;v<h.length;v++)(D=this.fxb.J(h.J(v).MG).Uw)&&b.J(1).add(D)}static RSl(b,h,v){const D=new sf.a;(b=b||El.Xdo(h,v))?(D.add(3),D.add(0)):El.Vij(h,v)&&D.add(0);return D}static Xdo(b,h){return!b||!b.node.id.equals(h.node.id)}static Vij(b,h){return!b||
!b.equals(h)}static bQo(b){let h=null;if(!b||!($e.SelectionEditor.Sl(b)||(b=$e.SelectionEditor.Cj(b,!0,!1),$e.SelectionEditor.Sl(b)||b.Oa&&El.Fdg(b.Oa.node))))return{returnValue:!1,Kcf:h};h=b.Oa;return{returnValue:!!h,Kcf:h}}static SPo(b){const h=new sf.a;b.J(1).forEach(v=>{v=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,v);h.add(v);return!0});b.J(0).forEach(v=>{v=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,v);h.add(v);return!0});b=h.toArray().join(" ");
return{returnValue:0<h.length,notification:b}}static Fdg(b){return oe.ImageReader.Ju(b)||fe.ParagraphReader.vua(b)}}Object(n.a)(El,"AccessibilityContextManager",null,[469]);class Im{constructor(b,h){this.q2g=!1;this.KAc=null;this.mud=this.Kxd=!1;this.FTg=null;this.mAd=(v,D)=>{(D.$R||D.mqa)&&this.mjn(D.$R,D.mqa)};this.Gb=b;this.wN=h}get $rm(){return!!this.KAc}nb(b){this.q2g||(this.wN.mqh(this.mAd),this.q2g=!0);this.FTg=b}mjn(b,h){this.$rm&&this.Gb.Xe(this.KAc);this.Kxd=this.Kxd||b;this.mud=this.mud||
h;this.KAc=new qf.a(5,1,Im.nyl,()=>{this.FTg(this.Kxd,this.mud);this.reset()},126);this.Gb.Vb(this.KAc)}reset(){this.KAc=null;this.mud=this.Kxd=!1}}Im.nyl=100;Object(n.a)(Im,"EditingViewOnAfterValidateEventsConsolidator",null,[468]);var Yh=c(46);class Kk{constructor(){this.W=null}get name(){return"Box4.Accessibility"}init(){Xa.App.ovh&&this.W.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}xc(b){this.W=b;b.ha("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",
()=>new Im(w.AFrameworkApplication.nc,b.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").singleInstance();b.ha("Box4.Accessibility.AccessibilityContextManager",()=>new El(b.resolve("Common.Utils.IAriaNotifier"),b.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),Yh.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").singleInstance()}static main(){N.a.instance.Fc(new Kk)}}Object(n.a)(Kk,
"Box4AccessibilityPackage",null,[1,2]);var bf=c(186),tf=c(1054),Ep=c(1648),Lk=c(888),hj=c(168),uk=c(1534),eh=c(43),Og=c(23),Re=c(98),we=c(28),Gb=c(3);class Ui extends uk.a{get vwa(){return null!=this.aDg?this.aDg:this.aDg=Ea.a.instance.Na("Box4.IInternalLinkManager")}get P2i(){return null!=this.$Fg?this.$Fg:this.$Fg=Ea.a.instance.Na("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy")}get QC(){return!0}get commandId(){return Gb.a.hJk}Vma(b){hj.a.mark(7012);const h=new eh.GraphTransaction(15);h.Cb(b);
var v=this.GG,D=this.p0,P=fe.ParagraphReader.text(b),ca=P.substring(v,D);const ta=({a_c:Ra}=G.a.Tgg(ca)).returnValue;ca!==ta&&(v+=Ra,D=v+ta.length);ca=we.a.createTextRange(b,v,D);var Ra=P.substring(v,D);Ui.ANm(P,v,D)&&(this.Kd.replaceTextRange(we.a.createTextRange(b,v-1,D+1),Ra,!0,!1),--v,--D,ca=we.a.createTextRange(b,v,D),v=Og.SelectionFactory.pe(b,D),Yh.a.instance.setSelection(v));v=Re.a.lPa(Ra);Ui.hyperlinkEditor.kG(ca,v,!1);P=Ra="";D=!1;this.vwa&&({R4f:Ra,MDb:P}=this.vwa.Ykg(v)).returnValue&&
(v=Ra,D=!0,Ra=Re.a.zA(ca,!1),Ui.hyperlinkEditor.HR(Ra[0].paragraph,Ra[0].hyperlink),""!==P&&(this.Kd.replaceTextRange(ca,P,!0,!1),ca=we.a.createTextRange(b,this.GG,this.GG+P.length),b=Og.SelectionFactory.pe(b,this.GG+this.GG+P.length),Yh.a.instance.setSelection(b)),Ui.hyperlinkEditor.kG(ca,v,!1));h.dispose();!D&&this.P2i&&this.P2i.WFn(ca,v);hj.a.mark(7013)}set QC(b){super.QC=b}static get hyperlinkEditor(){return null!=Ui.aBg?Ui.aBg:Ui.aBg=Ea.a.instance.resolve("Box4.IHyperlinkEditor")}static ANm(b,
h,v){v=v!==b.length&&('"'===b.charAt(v)||"\u201d"===b.charAt(v));return!!h&&('"'===b.charAt(h-1)||"\u201c"===b.charAt(h-1))&&v}}Object(n.a)(Ui,"HyperlinkAction",uk.a,[]);class dp{constructor(b){this.Kd=b}ibl(b,h,v){return new Ui(null,b,h,v,this.Kd)}}Object(n.a)(dp,"HyperlinkActionFactory",null,[467]);var qi=c(233);class Fl{constructor(){this.W=null}get name(){return"Box4.AutoCorrect"}xc(b){this.W=b;b.ha("Box4.AutoCorrect.AutoCorrectRules",()=>new Ep.a(b.resolve("Box4.IHyperlinkActionFactory"),b.resolve("Box4.ICharacterPropertiesEditor"),
qi.a.instance,w.AFrameworkApplication.va,w.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>new tf.a(b.resolve("Box4.IRoamingServiceRequestManager"),w.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectScheduler",()=>new Lk.a(b.resolve("Box4.IAutoCorrectRules"),
Yh.a.instance,bf.a.instance,w.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").singleInstance();b.ha("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new dp(b.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").singleInstance()}init(){this.W.resolve("Box4.IAutoCorrectRules").L0m();const b=
w.AFrameworkApplication.K;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.W.resolve("Box4.IAutoCorrectOptionsInfo").fOl()}dispose(){}static main(){N.a.instance.Fc(new Fl)}}Object(n.a)(Fl,"Box4AutoCorrectPackage",null,[1,2]);class $k{get name(){return"Box4.Clipboard"}init(){}dispose(){}xc(){}static main(){N.a.instance.Fc(new $k)}}Object(n.a)($k,"Box4ClipboardPackage",null,[1,2]);class bn{get name(){return"Box4.ImageEditors"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new bn)}}
Object(n.a)(bn,"Box4ImageEditorsPackage",null,[1,2]);var yq=c(611),zq=c(870),yr=c(704),Aq=c(820),Hn=c(1146);class Fp{constructor(){this.ChangeStateList=this.Revision=null}static construct(b,h,v,D,P){const ca=new Fp;ca.DocumentId=P;ca.UserId=v;ca.WACSessionId=D;ca.Revision=b;ca.ChangeStateList=Hn.a.Qjj(h);return ca}}Object(n.a)(Fp,"LocalUnsavedChange",null,[]);class In{constructor(){this.M2d=null}hoe(b){return new Promise((h,v)=>{this.mLh().then(D=>{const P=D.transaction(In.lYc,"readwrite");P.objectStore(In.lYc).put(b);
P.oncomplete=()=>h();P.onerror=()=>v(P.error.message)}).catch(v)})}$Dd(b,h,v){return new Promise((D,P)=>{this.mLh().then(ca=>{const ta=ca.transaction(In.lYc,"readwrite");ta.objectStore(In.lYc).delete([b,h,v]);ta.oncomplete=()=>D();ta.onerror=()=>P(ta.error.message)}).catch(P)})}static isSupported(){return"indexedDB"in window}mLh(){return new Promise((b,h)=>{if(In.isSupported())if(this.M2d)b(this.M2d);else{var v=window.indexedDB.open(In.N1m,In.O1m);v.onsuccess=()=>{this.M2d=v.result;b(v.result)};v.onerror=
()=>{h(v.error.message)};v.onupgradeneeded=()=>{const D=v.result,P=D.createObjectStore(In.lYc,{keyPath:["DocumentId","UserId","WACSessionId"]});P.createIndex("DocumentId, UserId",["DocumentId","UserId"],{unique:!1});P.createIndex("UserId",["UserId"],{unique:!1});this.M2d=D;b(D)}}else h("This browser does not support IndexedDB.")})}}In.N1m="LocalUnsavedChangeDatabase";In.O1m=1;In.lYc="LocalUnsavedChange";Object(n.a)(In,"LocalUnsavedChangeStore",null,[]);class vk{constructor(b,h,v,D,P,ca){this.wJi=
b;this.Uee=h;this.Xci=v;this.YPd=D;this.AVk=P;this.rya=ca}initialize(){const b=zq.a.Ntf(this.Xci());this.JHd=this.ZIc=b;this.rya.Zyk(this.AXi.bind(this));this.rya.$yk(this.BXi.bind(this))}dispose(){this.rya.u2n(this.AXi.bind(this));this.rya.v2n(this.BXi.bind(this))}AXi(b,h){this.QXo(h.QSa)}BXi(b,h){this.zUo(h.QSa)}zUo(b){b.equals(this.ZIc)||(this.ZIc=b,b.equals(this.JHd)?this.$Dd():this.hoe())}QXo(b){b.equals(this.JHd)||(this.JHd=b,b.equals(this.ZIc)?this.$Dd():this.hoe())}acl(){const b=new Aq.a(this.JHd,
this.ZIc,this.Xci(),this.YPd().vr,this.YPd().Fnb,this.YPd().contextId,this.ZIc.id,this.Uee,yr.FolderReader.Ljb(this.YPd()),!1);return Fp.construct(b,this.AVk.dOc(),vk.userId,vk.sessionId,vk.documentId)}hoe(){const b=this.acl();this.wJi.hoe(b).then(()=>{u.ULS.sendTraceTag(509366736,306,50,"Successfully updated local unsaved change with LatestRevision: {0}",b.Revision.Id)}).catch(h=>{u.ULS.sendTraceTag(509366735,306,10,"Failed to update local unsaved change because {0}",h)})}$Dd(){this.wJi.$Dd(vk.documentId,
vk.userId,vk.sessionId).then(()=>{u.ULS.sendTraceTag(509366734,306,50,"Successfully clear local unsaved change.")}).catch(b=>{u.ULS.sendTraceTag(509366733,306,10,"Failed to clear local unsaved change because {0}",b)})}static isSupported(){return In.isSupported()&&null!=this.documentId&&null!=this.userId&&null!=this.sessionId}static get documentId(){return null!=vk.myg?vk.myg:vk.myg=w.AFrameworkApplication.sessionStartInfoSettings.ServerDocId}static get userId(){return null!=vk.zJg?vk.zJg:vk.zJg=w.AFrameworkApplication.K.jb("LoggableUserId")}static get sessionId(){return null!=
vk.EGg?vk.EGg:vk.EGg=w.AFrameworkApplication.K.jb("SessionId")}}Object(n.a)(vk,"LocalUnsavedChangeManager",null,[466]);class go{get name(){return"Box4.LocalUnsavedChange"}init(){this.Fwi()&&vk.isSupported()&&(this.oKf=this.container.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeManager"),this.oKf.initialize())}dispose(){this.oKf&&this.oKf.dispose()}xc(b){this.container=b;if(this.Fwi()){b.ha("Box4.LocalUnsavedChange.LocalUnsavedChangeStore",()=>new In).singleInstance();var h=(v,D,P)=>new yq.a(v,
D,P);b.ha("Box4.LocalUnsavedChange.LocalUnsavedChangeManager",()=>new vk(b.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeStore"),h,()=>Xa.App.xa.ib.Uc.od,()=>Xa.App.xa.ib.Uc,b.resolve("Box4.CatchUpActivity.IChangeStateManager"),b.resolve("Box4.Revision.RevisionSequenceNumberManager"))).singleInstance()}}static main(){N.a.instance.Fc(new go)}Fwi(){return w.AFrameworkApplication.K.$("DisconnectedScenarioIsEnabled")}}Object(n.a)(go,"LocalUnsavedChangePackage",null,[1,2]);class lj{get name(){return"Box4.NotebookLevelEditors"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new lj)}}
Object(n.a)(lj,"Box4NotebookLevelEditorsPackage",null,[1,2]);var tj=c(1545);class fi{get name(){return"Box4.Search"}xc(b){b.ha("Box4.Search.FindManagerHelper",()=>tj.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").singleInstance()}init(){}dispose(){}}Object(n.a)(fi,"PackageManager",null,[1,2]);class lb{get name(){return"Box4.TableEditors"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new lb)}}Object(n.a)(lb,"Box4TableEditorsPackage",null,[1,2]);class vc{get name(){return"Box4.TextLevelEditors"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new vc)}}
Object(n.a)(vc,"Box4TextLevelEditorsPackage",null,[1,2]);var fd=c(113),Md=c(353),Wc=c(153),Cf=c(606),$c=c(1559);class fh{constructor(b,h,v){this.aw=this.hKa=this.tMa=null;this.mE=this.Oxe=this.yJa=0;this.Lka=this.Fmd=this.eWa=this.dWa=!1;this.pld=this.GZg=this.JZg=0;this.GAa=b;this.ga=h;this.Vm=v}YO(b){return!Xa.App.xa.ib.isEditingAllowed||bc.SessionStatusManager.instance.Gj?!1:""!==this.EOc(b.xf)}mL(b){if(!this.YO(b))return!1;this.Cko(b);this.mE=this.GAa.J7b();this.rno(b);this.sno();({Sac:this.Fmd,
pcc:this.Lka}=this.inj(this.Oxe));this.tno();this.tMa=b.ZH;this.aw=new Sys.UI.Point(0,0);[this.JZg,this.GZg]=this.GAa.getDimensions();u.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}FU(b){this.hKa=b.ZH;this.dRk();this.pld=$c.b(this.aw.x,this.aw.y,this.JZg,this.GZg,this.Fmd,this.Lka,this.pld,w.AFrameworkApplication.K.$("SmoothImageHelperGetScaleIsEnabled"));this.GAa.kng(this.pld,this.Fmd,this.Lka);return!0}$D(){this.setSize();u.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}rY(){this.GAa.I7f();
u.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}Cko(b){this.GAa=fd.a.Db(b.xf,Cf.a)}sno(){this.Oxe=(Math.floor((this.mE+22)/45)%8+this.yJa)%8}inj(b){let h,v;if(this.mE&&90!==this.mE&&180!==this.mE&&270!==this.mE&&360!==this.mE||this.ENm(b))return{Sac:!0,pcc:!0};h=v=!1;switch(b){case 1:case 5:h=!0;break;case 3:case 7:v=!0}return{Sac:v,pcc:h}}tno(){this.eWa=this.dWa=!1;switch(this.Oxe){case 0:this.eWa=this.dWa=!0;break;case 1:case 2:this.eWa=!0;break;case 7:case 6:this.dWa=!0}}ENm(b){return!(b%
2)}EOc(b){var h=b.classList.toString();-1===h.indexOf("WACImageResizeHandle")&&b.parentNode&&(h=b.parentNode.classList.toString());b=h.split(" ");for(h=0;h<b.length;h++){const v=b[h].toString();if(v.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==v)return v}return""}rno(b){switch(this.EOc(b.xf)){case "WACImageResizeHandleNW":this.yJa=0;break;case "WACImageResizeHandleN":this.yJa=1;break;case "WACImageResizeHandleNE":this.yJa=2;break;case "WACImageResizeHandleE":this.yJa=3;break;case "WACImageResizeHandleSE":this.yJa=
4;break;case "WACImageResizeHandleS":this.yJa=5;break;case "WACImageResizeHandleSW":this.yJa=6;break;case "WACImageResizeHandleW":this.yJa=7}}dRk(){var b=1;this.Vm.instance&&(b=this.Vm.instance.jj);const h=(this.hKa.x-this.tMa.x)/b;b=(this.hKa.y-this.tMa.y)/b;this.aw.x=this.dWa?-h:h;this.aw.y=this.eWa?-b:b}setSize(){const b=new Md.DictionaryPropertySet;b.setValue(Wc.a.oSc,100*this.pld);b.setValue(Wc.a.Xpi,!0);if(90===this.mE||270===this.mE){let h,v;({Sac:h,pcc:v}=this.inj(this.yJa));b.setValue(Wc.a.jzf,
h);b.setValue(Wc.a.kzf,v)}else b.setValue(Wc.a.jzf,this.Fmd),b.setValue(Wc.a.kzf,this.Lka);this.ga.Qb(Gb.a.l$b,2,b)}}Object(n.a)(fh,"ImageResizeDragAdapter",null,[141]);var Df=c(124),sd=c(875);class Ug{constructor(b,h,v,D){this.sEe=this.hKa=this.tMa=this.Htd=null;this.Fqd=this.qyd=0;this.Fb=null;this.ga=b;this.hb=h;this.Vm=v;this.q5g=this.tBa=0;this.fd=D}YO(b){return Xa.App.xa.ib.isEditingAllowed&&!bc.SessionStatusManager.instance.Gj&&b&&this.jSm(b.xf)?(this.Htd=this.hb.tg)?!0:!1:!1}LMd(){}Ptf(){return null}mL(b){if(!this.YO(b))return!1;
this.GAa=fd.a.Db(b.xf,Cf.a);if(!this.GAa)return!1;this.eud=this.GAa.L9;if(!this.eud)return!1;this.Htd=this.hb.tg;this.Fb=oe.ImageReader.Ym(this.Htd);if(!this.Fb)return!1;this.tMa=this.TOa(b);this.sEe=Sys.UI.DomElement.getBounds(this.eud);this.qyd=0<oe.ImageReader.gQd(this.Fb)?oe.ImageReader.gQd(this.Fb):0;this.Fqd=oe.ImageReader.crf(this.Fb);return!0}FU(b){this.hKa=this.TOa(b);this.lRk();if(this.GAa)return this.GAa.toe(this.tBa,this.q5g),!0;u.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");
return!1}$D(){this.qyd=this.tBa=$c.c(this.tBa);this.l5()}rY(){this.GAa.toe(this.Fqd,0)}jSm(b){return b.classList.contains(sd.c)||b.classList.contains(sd.b)||b.classList.contains(sd.a)||!!b.parentElement&&b.parentElement.classList.contains(sd.a)}TOa(b){return this.fd.Bd.O0a(b)}lRk(){var b=1;this.Vm&&this.Vm.instance&&(b=this.Vm.instance.jj);var h=new Sys.UI.Point(this.sEe.x+this.eud.clientWidth/2*b,this.sEe.y+this.eud.clientHeight/2*b);b=$c.a(this.tMa,h);h=$c.a(this.hKa,h);this.tBa=Math.round(Df.a.iOn(h-
b));0<this.qyd&&(this.tBa+=this.qyd-this.Fqd);this.q5g=this.tBa;this.tBa+=this.Fqd}l5(){const b=new Md.DictionaryPropertySet;b.setValue(Wc.a.lSc,0);b.setValue(Wc.a.sJ,this.tBa);this.ga.Qb(Gb.a.imageRotate,2,b)}}Object(n.a)(Ug,"ImageRotateDragAdapterSimplified",null,[459,141]);class Kj{constructor(){this.W=null}get name(){return"Box4.Images"}xc(b){this.W=b;this.W.ha("Box4.Images.ImageResizeDragAdapter",()=>new fh(null,w.AFrameworkApplication.va,Ea.a.instance.Sa("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").singleInstance();
this.W.ha("Box4.Images.ImageRotateDragAdapterUpdated",()=>new Ug(w.AFrameworkApplication.va,Yh.a.instance,Ea.a.instance.Sa("Common.IZoomManager"),Pb.InteractiveViewManager.instance)).as("Box4.Images.IImageRotateDragAdapter").singleInstance()}init(){this.W.resolve("Box4.Images.IImageResizeDragAdapter");this.W.resolve("Box4.Images.IImageRotateDragAdapter")}dispose(){}static main(){N.a.instance.Fc(new Kj)}}Object(n.a)(Kj,"Box4ImagesPackage",null,[1,2]);var nh=c(310),Hh=c(118),Bc=c(6),Pg=c(677),yh=c(453),
bi=c(566),Yi=c(250),ij=c(257),Vd=c(1776),le=c(1829),ci=c(1199);class uj extends le.a{constructor(b,h,v){super(b,h,v);this.Frd=this.jdb=null}get MR(){return w.AFrameworkApplication.ta.Hq}wPd(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}$oe(b){return uj.rza(b,this.Cji())}Cji(){return uj.mXe}rza(b,h=null){b=this.$oe(b);return 0!==b?(h&&h.pzd(),2===b&&(h=this.wPd(b),this.xp(this.U8h(b),h)),!1):
!0}BOa(b,h){u.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.JWf=h;hj.a.mark(5576);this.Frd=this.MR.Zf("LoadResource","PictureUploadTime");this.fXd()?this.kee(b):this.y0c()}xp(b,h){const v=new ug.StandardDialog;v.Ad=0;v.nx(b,CommonUIStrings.l_ImageUploadFailedTitle,h,null)}y0c(){u.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.y0c();this.Frd&&(this.Frd.stop(),this.Frd=null)}X6a(){this.jdb=(new ci.a).create();this.jdb.message=CommonUIStrings.l_ImageUploadWait;
this.jdb.Ad=5;this.jdb.Et=!1;this.jdb.tL(null,null,null)}d3b(){this.jdb&&(this.jdb.close(),this.jdb=null)}static osm(b,h){b=G.a.Ug(b);for(let v=0;v<h.length;++v)if(b.endsWith(h[v]))return!0;return!1}static rza(b,h=null){h||(h=uj.mXe);return b?uj.osm(b,h)?0:2:1}}uj.mXe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(n.a)(uj,"PictureUploader",le.a,[]);var Gl=c(352),Eh;(function(b){b[b.validPicture=0]="validPicture";b[b.noPictureSpecified=1]="noPictureSpecified";b[b.invalidExtension=2]="invalidExtension";
b[b.pictureTooLarge=3]="pictureTooLarge"})(Eh||(Eh={}));Object(n.b)("PictureValidationResult",Eh);var Ef=c(53),lf=c(16),Vi=c(42);class Bq{constructor(){this.JT=null}}Object(n.a)(Bq,"ImageData",null,[]);var lm=c(51),Yg=c(1777),Ye=c(1617),vf=c(1653);class mm extends bg.a{constructor(b,h=!0){super(!1,!1,mm.AL);this.zYb=null;this.rVg=!1;this.iy=[];this.Es=null;this.ldb=b;this.yjk=h;this.N$=this.jih=!1;this.LYa=null;this.ZAe=!1;this.Yg=this.xnl;this.wg="InsertFileDialog";this.Ee(1,this.Hyd);mm.AL?(this.zYb=
{["id"]:this.wg,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:Object(z.a)(this,this.Ewn,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(z.a)(this,this.vpn,"onFrameReady")},this.Wh(this.titleText,Object(z.a)(this,this.WWd,"insertDialogHandler"),this.zYb),this.OV=!0):(this.showDialog(this.titleText,Object(z.a)(this,this.WWd,"insertDialogHandler")),h&&this.Fpo(),(b=this.mOd(1))&&this.iy.push(b),
(b=this.mOd(0))&&this.iy.push(b),this.WGj(),this.OV=!1)}get NIj(){return this.ldb}validate(){this.Es.JT||u.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Es.JT.value?!0:(mm.nx(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}vpn(b){this.yjk&&(this.Es=this.moj(b,this.ldb))}Ewn(){this.Es&&this.Es.JT&&(this.rVg||(this.Es.GXn(Object(z.a)(this,this.ZTf,"onFileChosen")),this.rVg=!0),this.Es.RZh())}ZTf(b){this.zYb.uploadStatusLabel=b;this.L5(this.titleText,Object(z.a)(this,
this.WWd,"insertDialogHandler"),this.zYb)}WWd(b){1===b&&this.isEnabled()?mm.AL&&this.Es.JT&&!this.Es.JT.value?(this.zYb.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.L5(this.titleText,Object(z.a)(this,this.WWd,"insertDialogHandler"),this.zYb)):(this.GVd(),this.ldb.BOa(this.Es,Object(z.a)(this,this.dispose,"dispose"))):0===b&&this.hide()}Fpo(){this.ZAe=!1;this.Es=this.moj(document.getElementById("uploadFrameContainer"),this.ldb);w.AFrameworkApplication.K.$("InsertPictureDialogFocusLoopFixIsEnabled")&&
(this.LYa=Object(z.a)(this,this.KWf,"onUploadFrameLoad"),Le.a.addHandler(this.Es.iFrame,"load",this.LYa));this.Es.JT||u.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.y4i()}KWf(){this.y4i()}y4i(){if(this.Es&&!this.ZAe){var b=this.Es.JT;b&&(Le.a.addHandler(b,Ed.a.ai,Object(z.a)(this,this.onKeyDown,"onKeyDown")),b=[b],this.iy=b.concat.apply(b,this.iy),this.WGj(),this.ZAe=!0)}}dispose(){if(this.Es&&!mm.AL){const b=this.Es.JT;b&&Le.a.removeHandler(b,Ed.a.ai,Object(z.a)(this,
this.onKeyDown,"onKeyDown"));this.LYa&&Le.a.removeHandler(this.Es.iFrame,"load",this.LYa)}this.Es=null;super.dispose()}WGj(){if(0<this.iy.length){const b=new ee(this.iy),h=bd.FocusManager.instance().Ts();h&&(this.iy[0].focus(),h.fk=b,h.oR=!0)}}onKeyDown(b){4!==bd.FocusManager.instance().C4i(b)&&b.preventDefault()}static get AL(){return w.AFrameworkApplication.ta.Nb.mF&&w.AFrameworkApplication.ta.Nb.oBi}static nx(b){const h=document.getElementById("errorText");h.innerText=b;h.style.display="inline-block"}}
Object(n.a)(mm,"InsertFileDialog",bg.a,[]);class Zn{static get Yg(){return bg.a.vA(Zn.Km,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}Zn.Km="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(n.a)(Zn,"InsertImageDialogHtml",null,[]);class kn extends mm{constructor(b,
h=!0){super(b,h)}get Hyd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get xnl(){return Zn.Yg}validate(){this.Es.JT||u.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(Na.a)(uj,this.NIj);const h=b.$oe(this.Es.JT.value);return 0!==h?(b=b.wPd(h),mm.nx(b),!1):!0}}Object(n.a)(kn,"InsertImageDialog",mm,[]);class pk extends kn{constructor(b){super(b)}moj(b,h){const v=w.AFrameworkApplication.ta.Nb.mF&&w.AFrameworkApplication.ta.Nb.oBi;
return new vf.a(b,Object(z.a)(h,h.vfc,"onUploadFrameInitialized"),Object(z.a)(h,h.jza,"uploadResponseReceived"),w.AFrameworkApplication.K,!v)}isEnabled(){return pk.QO.Jfa(this.NIj.context)}static get QO(){return null!=pk.lBg?pk.lBg:pk.lBg=Ea.a.instance.resolve("Box4.Images.IImageEditor")}}Object(n.a)(pk,"Box4InsertImageDialog",kn,[]);class ep{e7k(b){return new Promise((h,v)=>{this.f7k(b).then(D=>{h(D)},D=>{v(D)})})}kJh(b){return new Promise((h,v)=>{const D=new FileReader;D.addEventListener("load",
()=>{h(D.result)},!1);D.addEventListener("error",()=>{v("FileReader exception ("+D.error.name+")")});D.readAsDataURL(b)})}f7k(b){return new Promise((h,v)=>{this.kJh(b).then(D=>{this.F$e(D,"image/jpeg").then(P=>{h(P)},P=>{v(P)})},D=>{v(D)})})}F$e(b,h){return new Promise((v,D)=>{const P=new Image;P.addEventListener("load",()=>{const ca=document.createElement("canvas"),ta=ca.getContext("2d");ca.width=P.width;ca.height=P.height;ta.drawImage(P,0,0);v(ca.toDataURL(h))});P.addEventListener("error",()=>{D("Image failed to load")});
P.src=b})}}Object(n.a)(ep,"ImageFormatConverter",null,[]);var vm=c(393);const wm=["ImageInsertFailed"];class oc extends uj{constructor(b,h,v,D,P,ca,ta=!0){super(b,h,v);this.DAa=this.Nl=this.ZG=this.Fe=null;this.SLd="wwpicturesfc";this.kpiName="ImageFileExtension";this.bwc="LocalDeviceUpload";this.Bha=new Map;this.XZh=0;this.kdb=null;this.XAe="";this.csa=0;this.Wp=null;this.Quc="";this.t6g=50;this.SWg=this.atc=this.yBc=this.Zxc=!1;this.pbk=19922944;this.G8g=0;this.aBe=[];this.qVg=[];this.H8g=0;this.EVf=
Ra=>{u.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(Ra){var mb={},Jb=this.ZG?this.ZG.properties.Rc.toString():this.Fe.Rc.toString();mb[yh.a.nodeId]=this.ZG?this.ZG.id.toString():this.Fe.id.toString();mb[yh.a.classId]=Jb;this.Wg.hasProperty(Bc.a.imageType)&&(mb[Pg.a.imageType]=this.Wg.getValue(Bc.a.imageType));this.Wg.hasProperty(Bc.a.iU)&&(mb[Pg.a.iU]=this.Wg.getValue(Bc.a.iU));this.Wg.hasProperty(Hh.a.kga)&&(mb[Pg.a.kga]=this.Wg.getValue(Hh.a.kga));this.Wg.hasProperty(Bc.a.jlb)&&
(mb[Pg.a.jlb]=this.Wg.getValue(Bc.a.jlb));Ye.d(Ra,this.Fe,this.Nl,mb)&&(this.R9c(Ra),oc.Fec++)}else u.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")};this.dpn=Ra=>{if(!this.HAf){var mb=this.n9h(this.Es);mb&&(this.XAe=mb.name,this.csa=mb.size);if(!this.rza(Ra,this.Es)||!this.xog(mb,this.Es)){mb=Object.assign(new Bb.a,{extendedProperties:new Map});mb.extendedProperties.set("type",this.rza(Ra,this.Es)?"Image too large":"FileType invalid");this.f3d(mb);this.b3d();return}}this.BOa(this.Es,
null)};this.Wg=D;this.Im=P;this.ga=ca;this.pg=Gl.a.getInstance(vm.a);this.r5g=v.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.K6g=v.mc("ImageUploadMaxByteSize",Number.MAX_VALUE);ta&&this.showDialog();Xa.App.Flc.addHandler(this)}get Uyi(){return this.K.$("JfifImageInsertIsEnabled")}get aP(){return this.bwc}get fileExtension(){return this.XAe}get fileSize(){return this.csa}get MIj(){return this.kdb}get zu(){return this.Wp||(this.Wp=Ea.a.instance.resolve("Common.Utils.IAriaNotifier"))}get HAf(){return this.aP===
this.bwc}showDialog(){Ye.a(this.K)?(this.a5b=!1,this.Es=new vf.a(document.body,Object(z.a)(this,this.vfc,"onUploadFrameInitialized"),Object(z.a)(this,this.jza,"uploadResponseReceived"),this.K,!1,void 0,!0)):Ye.b()||this.aKb&&aa.a.OH?(this.a5b=!1,this.Es=new vf.a(document.body,Object(z.a)(this,this.vfc,"onUploadFrameInitialized"),Object(z.a)(this,this.jza,"uploadResponseReceived"),this.K,!1)):(this.a5b=!0,this.Es=(new pk(this)).Es)}U8h(b){switch(b){case Eh.noPictureSpecified:return lm.a.noPictureSpecified;
case Eh.invalidExtension:return lm.a.rDm;case Eh.pictureTooLarge:return lm.a.iKf}return ag.a.unknown}kee(b){this.HAf||(this.Fe.Vi()?(u.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),Yg.a.instance.Lng(this.Fe.Vi()),this.Fe.Vi().contentReplicator.forceOutbound(this.EVf,Object(z.a)(this,this.aMb,"processFailure"),b)):this.aMb(b,157))}QQm(){return Ye.c(this.Fe)}R9c(b){b.R9c();this.kdb=b.kdb}jza(b){this.XZh=+new Date-+this.MIj;this.b3d();u.ULS.sendTraceTag(36783364,322,50,
"Box4PictureUploader.UploadResponseReceived");Ye.e(this,b,this.Fe)}r0o(){u.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.y0c();oc.Fec--;this.ga.processAction(Wa.a.e8a,2);this.Fe?Yg.a.instance.Xmc(this.Fe.Vi(),0):u.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");this.zu.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}aMb(b,h){var v;if(this.l9n(b))u.ULS.sendTraceTag(16798870,352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",
this.retryCount,h.toLocaleString());else{b=Object.assign(new Bb.a,{extendedProperties:new Map});b.extendedProperties.set("result",h.toLocaleString());(null===(v=w.AFrameworkApplication.K)||void 0===v?0:v.$("ShouldLogPicturesExtendedHealthKpis"))?this.pg.logKpiFailure({kpiName:vm.c.VEa,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:{name:vm.c.j$b,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,
isSessionEndingError:!1,additionalValues:b}}):va.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",wm,!1,!0,!1,!1,b);v=this.Rif(h);u.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,h.toLocaleString());b=this.Fe.GH();var D=new eh.GraphTransaction(15,Gb.a.bR);D.Cb(this.Fe);oc.QO.eTa(this.Wg,v);oc.QO.D5f(this.Fe,this.ZG);oe.ImageReader.$lj(this.Wg);D.dispose();this.Fsj(v);this.Im.b3b(b,!1);this.y0c();oc.Fec--;Yg.a.instance.Xmc(this.Fe.Vi(),
h)}}Fsj(b){const h=new ug.StandardDialog;h.Ad=0;h.nx(lm.a.invalidImageFile,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}Rif(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}GPj(){if(this.Quc&&0<this.Quc.length){const b=new Md.DictionaryPropertySet;b.setValue(Wc.a.iP,this.Quc);b.setValue(Wc.a.g4,!0);this.ga.Qb(Gb.a.c_,2,b)}this.cxo()}cxo(){let b="";this.SWg?b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.Zxc&&
this.atc&&this.yBc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.Zxc&&this.atc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.Zxc&&this.yBc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:this.yBc&&this.atc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.yBc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.atc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.Zxc&&
(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.Fsj(b),this.tQj())}qwk(b){this.Quc+=String.format('<img src="{0}"></img>',b);this.H8g++}N4m(){this.yBc=!0;u.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new Bb.a,{extendedProperties:new Map});b.extendedProperties.set("type","Image too large");this.f3d(b)}L4m(){this.atc=!0;u.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");const b=Object.assign(new Bb.a,{extendedProperties:new Map});
b.extendedProperties.set("type","Filetype invalid");this.f3d(b)}gKi(b){this.SWg=!0;u.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",b)}XCo(b){const h=new ep;if(this.$oe(b.name)===Eh.validPicture)return h.kJh(b);if(uj.rza(b.name,vf.a.nXe)===Eh.validPicture)return h.e7k(b)}n7k(b){return new Promise(h=>{const v=this.XCo(b);void 0===v&&(this.gKi("Failed starting conversion work"),h());v.then(D=>{D.length>this.pbk?this.N4m():this.qwk(D);h()},D=>{this.gKi(D);
h()})})}BVm(b){return this.$oe(b.name)===Eh.validPicture||uj.rza(b.name,vf.a.nXe)===Eh.validPicture}FCm(){const b=[];if(this.Es.JT.files){this.G8g=this.Es.JT.files.length;this.Es.JT.files.length>this.t6g&&(this.Zxc=!0);this.X6a();for(let h=0;h<this.Es.JT.files.length&&this.t6g;h++){const v=this.Es.JT.files[h];this.aBe.push(v.name);this.qVg.push(v.size);v&&(this.BVm(v)?b.push(this.n7k(v)):this.L4m())}}Promise.all(b).then(()=>{this.d3b();this.GPj()});return!0}tDm(){this.Nl=ub.a.create();this.Wg||(this.Wg=
new Md.DictionaryPropertySet);this.r5g&&this.DAa&&this.Wg.setValue(Hh.a.uJi,this.DAa);var b=480;let h=320;const v=this.context.view.rh.editingElement.clientWidth;0<v&&v<b&&(h=Math.floor(1*v/b*h),b=v,this.Wg.setValue(Hh.a.kga,v));this.Wg.setValue(lf.a.Eha,Ef.a.Vl(b,0));this.Wg.setValue(lf.a.Dha,Ef.a.Vl(h,1));this.Wg.setValue(Vi.a.R_,1);this.Wg.setValue(Wc.a.g4,!0);this.Wg.setValue(Bc.a.jlb,Box4Intl.Box4Strings.l_Picture);b=oc.QO.tTh(this.context,this.Wg,this.Nl);if(!b)return!1;this.Fe=b.node;this.Wg=
(this.ZG=b.blob)?this.ZG.properties:this.Fe.properties;Xa.App.rd.Qo&&Xa.App.rd.Tp.VF(this.Fe);return!0}fXd(){return this.HAf?this.FCm():this.tDm()}tQj(){var b;this.Bha.set("FileExtensions",this.aSl());this.Bha.set("FileSizeInBytes",this.qVg.toString());this.Bha.set("Source",this.aP);this.Bha.set("NumberOfImagesAttemptedToInsert",this.G8g.toString());this.Bha.set("NumberOfImagesPasted",this.H8g.toString());(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?
(this.Bha.set("ErrorLevel","warning"),b=Object.assign(new Bb.a,{extendedProperties:this.Bha}),this.pg.logKpiFailure({kpiName:vm.c.VEa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})):va.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.SLd,this.Bha)}aSl(){let b="";for(let h=0;h<this.aBe.length;++h)b=b+this.m9h(this.aBe[h])+",";return b}BOa(b,h){this.r5g&&(this.DAa=new Bq,this.DAa.JT=b.JT);super.BOa(b,h)}vfc(b){this.Es=b;if(!this.a5b){if(this.Loe){if(Ye.a(this.K)||
this.aKb&&aa.a.OH){b.oJd(this.dpn);return}const h=b.oJd(null),v=this.n9h(b);v&&(this.XAe=v.name,this.csa=v.size);if(!this.rza(h,b)||!this.xog(v,b)){b=Object.assign(new Bb.a,{extendedProperties:new Map});b.extendedProperties.set("type",this.rza(h,this.Es)?"Image too large":"FileType invalid");this.f3d(b);this.b3d();return}}this.BOa(b,null)}}wVd(){return!!oc.Fec}b3d(){var b;this.Bha.set("FileExtension",this.m9h(this.fileExtension));this.Bha.set("Source",this.aP);this.Bha.set("FileSizeInBytes",this.fileSize.toString());
this.Bha.set("RequestTimeInMs",this.XZh.toString());(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?this.pg.logKpiUsage({kpiName:vm.c.VEa,kpiType:0,optionalProperties:{extendedProperties:this.Bha}}):va.Health.instance.recordKpiUsage(this.kpiName,0,this.SLd,this.Bha)}m9h(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}Cji(){return this.Uyi?vf.a.alh:uj.mXe}n9h(b){return(b=b.JT)?b.files[0]:null}xog(b,h){return b&&b.size>this.K6g?
(h&&h.pzd(),b=this.wPd(Eh.pictureTooLarge),this.xp(this.U8h(Eh.pictureTooLarge),b),!1):!0}wPd(b){switch(b){case Eh.noPictureSpecified:return CommonUIStrings.l_ImageUploadNoFileSpecified;case Eh.invalidExtension:return this.Uyi?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case Eh.pictureTooLarge:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.K6g/1E6));default:return""}}f3d(b){var h;(null===(h=w.AFrameworkApplication.K)||
void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:vm.c.j$b,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","info"),this.pg.logKpiFailure({kpiName:vm.c.VEa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:h})):va.Health.instance.recordQosError("PictureFromLocalInvalid",wm,!0,!0,!1,!1,b)}static get QO(){return null!=
oc.kBg?oc.kBg:oc.kBg=Ea.a.instance.resolve("Box4.Images.IImageEditor")}}oc.Fec=0;Object(n.a)(oc,"Box4PictureUploader",uj,[550,551]);var To=c(827),Ic=c(132);class Uo{constructor(){this.Gr=this.Kp=this.Kwb=this.Wih=this.Oed=this.JZj=null;this.rQe=0;this.Tra=this.FLe=this.Zwb=null;this.gQg=0;this.Jte=this.Tea=this.bIe=null;this.a0g=!1;this.Qse=this.Mse=this.Rse=null}get assetId(){return this.Oed}get thumbnailUrl(){return this.Wih}get gIn(){return this.Kwb}get displayName(){return this.Tra}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,
this.Kp,this.Gr)}get FAk(){if(this.Mse&&this.Qse&&this.Rse){const b=document.createElement("a");b.setAttribute("href",this.Rse);b.setAttribute("target","_blank");b.innerText=this.Qse;return b}return null}get trh(){return this.Mse}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.gQg)}get ZPn(){const b=document.createElement("span");var h=0;if(this.Zwb&&0<this.Zwb.length){var v=this.Zwb.indexOf("."),D=0>v?this.Zwb:this.Zwb.substring(0,v);for(D=Number.parseInvariant(D);h<
D&&5>h;h++)b.appendChild(Xc.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Ic.a.vg("box42.png"),"","",!0,""));0<v&&(v=Number.parseInvariant(this.Zwb.substr(v+1)),3>v?b.appendChild(Xc.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Ic.a.vg("box42.png"),"","",!0,"")):8>v?b.appendChild(Xc.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",Ic.a.vg("box42.png"),"","",!0,"")):b.appendChild(Xc.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Ic.a.vg("box42.png"),
"","",!0,"")),h++)}for(;5>h;h++)b.appendChild(Xc.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Ic.a.vg("box42.png"),"","",!0,""));this.FLe&&(h=document.createElement("span"),h.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.FLe),b.appendChild(h));return b}get H7n(){return 0<this.rQe?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.rQe):""}get VIk(){if(this.a0g){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;
return b}if(this.Jte&&this.Tea)return Uo.Rbl(this.Jte,this.Tea);b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.bIe){const h=this.bIe.split(",");b=Array(h.length);for(let v=0;v<h.length;v++)b[v]=h[v].trim()}else b=[];return b}static GJl(b){const h=new Uo;for(let v=0;v<b.childNodes.length;v++){const D=b.childNodes[v];if(1===D.nodeType)try{const P=D.firstChild.nodeValue;switch(D.nodeName){case "src":h.JZj=P;break;case "assetid":h.Oed=
P;break;case "thumb":"64x64"===D.attributes.getNamedItem("size").nodeValue?h.Wih=Uo.gCj(P):"192x192"===D.attributes.getNamedItem("size").nodeValue&&(h.Kwb=Uo.gCj(P));break;case "imagedim":if(P){const ta=P.indexOf("x");0<ta&&ta<P.length&&(h.Kp=P.substr(0,ta),h.Gr=P.substr(ta+1))}break;case "resolution":h.rQe=Number.parseInvariant(P);break;case "rating":h.Zwb=P;break;case "numofratings":h.FLe=P;break;case "displayname":h.Tra=P;break;case "contentlength":h.gQg=Number.parseInvariant(P)/1024;break;case "subject":h.bIe=
P;break;case "provider":h.Tea=P;break;case "attributionlink":h.Jte=P;break;case "iscsc":h.a0g=1===Number.parseInvariant(P);break;case "additional":const ca=D.firstChild;if(D.hasChildNodes()&&ca&&"id"===ca.nodeName&&1===Number.parseInvariant(ca.text))for(let ta=0;ta<D.childNodes.length;ta++){const Ra=D.childNodes[ta];switch(Ra.nodeName){case "caption":h.Mse=Ra.text;break;case "value":h.Rse=Ra.text;break;case "string":h.Qse=Ra.text}}}}catch(P){}}return h}static Rbl(b,h){const v=document.createElement("a");
v.setAttribute("href",b);v.setAttribute("target","_blank");v.innerText=h;return v}static gCj(b){let h;return b&&0<(h=b.indexOf("://"))?b.substr(h+1):b}}Object(n.a)(Uo,"ClipArtSearchResult",null,[]);class ek{static get Yg(){return bg.a.vA(ek.Km,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}ek.Km="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(n.a)(ek,"InsertClipartDialogHtml",null,[]);class sn extends bg.a{constructor(b){super();this.BAa=this.kub=0;this.tbh=null;this.HOe=!1;this.lYb=this.CXa=this.IN=null;this.QXi=h=>{const v=this.xW.value;v&&0<v.trim().length&&(this.search(this.xW.value),this.oqa(1,!1));h.preventDefault();h.stopPropagation()};this.Lun=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.QXi(h),h.preventDefault(),h.stopPropagation())};this.RXi=h=>{100<=this.xW.value.length&&(h.preventDefault(),h.stopPropagation())};
this.etn=h=>{h=Number.parseInvariant(h.target.parentNode.id.substr(4));this.L3i(h);this.Oag(h)};this.onScroll=()=>{if(this.Ir&&this.Ir.children&&!(2>this.Ir.children.length)){var h=this.Ir.children[0].children[0],v=this.Ir.clientHeight-(h.clientHeight-h.children[0].clientHeight+2)+this.Ir.scrollTop,D=h.clientHeight+2,P=parseInt(String(this.Ir.scrollTop/D));h=parseInt(String(v/D));var ca=parseInt(String(this.Ir.clientWidth/D));h<v/D&&h<parseInt(String(this.IN.length/ca))&&h++;for(v=P;v<h;v++)for(D=
0;D<ca;D++){var ta=v*ca+D;P=this.IN[ta];(ta=document.getElementById("clip"+ta))&&!ta.childNodes.length&&(P=this.PNh(P),ta.appendChild(P))}}};this.Uvn=h=>{h.target.setAttribute("src",Ic.a.vg("phthumb.64x64x32.png"))};this.ftn=h=>{h.target.setAttribute("src",Ic.a.vg("phpreview.96x96x32.png"))};this.qVi=h=>{Dd.a.om(h.target.attributes.getNamedItem("href").value,h.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");h.stopPropagation();h.preventDefault()};this.fqn=h=>{(h?h.keyCode:
window.event.keyCode)===Sys.UI.Key.enter&&this.qVi(h)};this.KVi=h=>{const v=h.target.innerText;this.xW&&(this.xW.value=v);this.search(v);h.stopPropagation();h.preventDefault();this.oqa(1,!1)};this.Tqn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.KVi(h)};this.TXi=h=>{this.IN&&(this.Nco(this.IN[this.kub]),h.stopPropagation(),h.preventDefault(),this.xW.value="",this.oqa(1,!1))};this.Mun=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.TXi(h)};this.onKeyDown=h=>{if(h.keyCode>=
Sys.UI.Key.left&&h.keyCode<=Sys.UI.Key.down){let v=0;switch(h.keyCode){case Sys.UI.Key.up:v=-5;break;case Sys.UI.Key.down:v=5;break;case Sys.UI.Key.left:v=-1;break;case Sys.UI.Key.right:v=1}this.BAa=this.BAa+v<this.Ir.children.length-1?0>this.BAa+v?0:this.BAa+v:this.Ir.children.length-1;this.Oag(this.BAa);h.preventDefault();h.stopPropagation()}else h.keyCode===Sys.UI.Key.enter?(h=Number.parseInvariant(h.target.id.substr(4)),0<=h&&h<this.Ir.children.length&&this.Eij(h)):h.keyCode===Sys.UI.Key.tab&&
(this.BAa=h.shiftKey?Math.max(0,this.BAa-1):Math.min(this.BAa+1,this.Ir.children.length-1))};this.onError=()=>{this.Ir&&(this.Ir.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.R4i=h=>{if(this.Ir)if(h.data.Hia){var v=h.data.Hia.lastChild.childNodes;this.IN||(this.IN=[]);for(h=0;h<v.length&&100>this.IN.length;h++){var D=v[h];1===D.nodeType&&"image"===D.nodeName&&(D=Uo.GJl(D),this.IN.push(D))}this.$Sh();this.IN.length||(this.Ir.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(h.data.ve){h=
G.a.Jwj(h.data.ve);try{v=parseInt(h)}catch(P){v=14}this.Ir.innerText=26===v?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.$Sh=()=>{if(this.IN){ic.a.f_(this.Ir);this.CXa&&(this.CXa.dispose(),this.CXa=null);this.Ir.focus();this.Ir.classList.remove("ClipartSearchInProgress");for(let v=0;v<this.IN.length;v++){var h=document.createElement("a");h.setAttribute("href","#");h.id="itab"+v;const D=document.createElement("span");D.id="clip"+v;D.classList.add("ClipartImageContainer");
h.appendChild(D);this.Ir.appendChild(h);v<parseInt(String(this.Ir.clientHeight/D.clientHeight))*parseInt(String(this.Ir.clientWidth/D.clientWidth))&&(h=this.PNh(this.IN[v]),D.appendChild(h))}this.HOe&&(this.Eij(this.kub),this.Oag(this.kub))}};this.WBm=h=>{1===h&&this.IN&&sn.QO.Jfa(this.fPg.context)&&(h=this.IN[this.kub])&&this.fPg.XHa(h)};this.fPg=b;this.Yg=ek.Yg;this.wg="InsertClipartDialog";this.Ee(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.WBm);this.Ir=document.getElementById("clipartsearchresults");this.$td=this.onKeyDown;Le.a.addHandler(this.Ir,"keydown",this.$td);this.Ztd=this.onScroll;Le.a.addHandler(this.Ir,"scroll",this.Ztd);this.xW=document.getElementById("textInput");this.zwd=this.Lun;Le.a.addHandler(this.xW,"keydown",this.zwd);this.Awd=this.RXi;Le.a.addHandler(this.xW,"keypress",this.Awd);this.Bwd=this.RXi;Le.a.addHandler(this.xW,"paste",this.Bwd);this.Bpc=document.getElementById("btnSearch");this.Bpc.setAttribute("src",
Ic.a.vg("search.16x16x32.png"));this.Ytd=this.QXi;Le.a.addHandler(this.Bpc,"click",this.Ytd);this.yUb=document.getElementById("clipartpreviewimage");this.aze=document.getElementById("clipartattributedisplayname");this.A$a=document.getElementById("clipartseesimilar");this.$ye=document.getElementById("clipartdimensions");this.gsc=document.getElementById("clipartadditionalvalue");this.bze=document.getElementById("clipartratingvalue");this.KVa=document.getElementById("clipartattributionvalue");this.LVa=
document.getElementById("clipartkeywords");this.Yye=document.getElementById("clipartadditionalname");this.cze=document.getElementById("clipartratingname");this.Zye=document.getElementById("clipartattributionname");this.JOe=this.etn;this.tVe=this.Uvn;this.Ukd=this.qVi;this.Vkd=this.fqn;this.$He=this.KVi;this.aIe=this.Tqn;this.bud=this.TXi;this.cud=this.Mun;this.xW.focus();this.oqa(1,!1)}dispose(){this.Ir&&this.hEh();this.Ir&&this.$td&&(Le.a.removeHandler(this.Ir,"keydown",this.$td),this.$td=null);
this.Ir&&this.Ztd&&(Le.a.removeHandler(this.Ir,"scroll",this.Ztd),this.Ztd=null);this.Ir=null;this.xW&&this.zwd&&(Le.a.removeHandler(this.xW,"keydown",this.zwd),this.zwd=null);this.xW&&this.Awd&&(Le.a.removeHandler(this.xW,"keypress",this.Awd),this.Awd=null);this.xW&&this.Bwd&&(Le.a.removeHandler(this.xW,"paste",this.Bwd),this.Bwd=null);this.xW=null;this.Bpc&&this.Ytd&&(Le.a.removeHandler(this.Bpc,"click",this.Ytd),this.Bpc=this.Ytd=null);this.Zye=this.cze=this.Yye=this.LVa=this.KVa=this.bze=this.gsc=
this.$ye=this.A$a=this.aze=this.yUb=this.cud=this.bud=this.aIe=this.$He=this.Vkd=this.Ukd=this.lYb=this.tVe=this.JOe=null;this.CXa&&(this.CXa.dispose(),this.CXa=null);super.dispose()}vL(){super.vL();document.getElementById(this.mj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.cOb(b,!1,this.R4i)}cOb(b,h,v){this.BAa=this.kub=0;this.hEh();if(this.IN&&b===this.tbh&&this.HOe===h)window.setTimeout(this.$Sh,500);else{this.IN&&(Array.clear(this.IN),this.IN=null);this.tbh=b;this.HOe=
h;var D=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');D.append("<query>");D.append(G.a.yf(b));D.append("</query>");D.append("<mediatype>Illustration</mediatype>");D.append("<mediatype>Photo</mediatype>");D.append("<filetype>jpg</filetype>");D.append("<filetype>jpeg</filetype>");D.append("<filetype>gif</filetype>");D.append("<filetype>bmp</filetype>");D.append("<filetype>tif</filetype>");D.append("<filetype>tiff</filetype>");D.append("<filetype>png</filetype>");D.append("</search>");
b=w.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let P=b.length;4>P;P++)b="0"+b;w.AFrameworkApplication.Ne.xj(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",Xa.App.webServiceBase,b,Pg.a.Izo,h.toString()),2,D.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,v,this.onError,null)}}Nco(b){this.cOb(b.assetId,!0,this.R4i);this.IN||(this.IN=[],this.IN.push(b))}PNh(b){const h=document.createElement("img");h.classList.add("ClipartThumbImage");h.setAttribute("src",
b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;h.setAttribute("title",b);h.setAttribute("alt",b);Le.a.addHandler(h,"click",this.JOe);Le.a.addHandler(h,"error",this.tVe);return h}oll(b){1===b.childNodes.length&&(b=b.childNodes[0],Le.a.removeHandler(b,"click",this.JOe),Le.a.removeHandler(b,"error",this.tVe))}L3i(b){const h=this.IN[b];var v=h.gIn;this.fEh();this.lYb=this.ftn;var D=document.createElement("img");D.setAttribute("src",v);if(h.displayName)v=
String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,h.displayName);else{v=new Sys.StringBuilder;for(let P=0;P<h.keywords.length&&5>P;P++)P&&v.append(", "),v.append(h.keywords[P]);v=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,v.toString())}D.setAttribute("title",v);D.setAttribute("alt",v);Le.a.addHandler(D,"error",this.lYb);this.yUb.appendChild(D);D=document.getElementById("clip"+this.kub);D.classList.remove("ClipartSelectedImage");D=document.getElementById("clip"+
b);D.classList.add("ClipartSelectedImage");this.kub=b;h.displayName&&(this.aze.innerText=h.displayName);b=document.createElement("a");b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');Le.a.addHandler(b,"click",this.bud);Le.a.addHandler(b,"keydown",this.cud);this.A$a.appendChild(b);this.$ye.innerText=String.format("{0} | {1} | {2}",h.dimensions,h.H7n,h.fileSize);(b=h.FAk)&&h.trh?(this.gsc.parentNode.style.display="block",this.Yye.innerText=h.trh,this.gsc.appendChild(b)):
this.gsc.parentNode.style.display="none";this.bze.appendChild(h.ZPn);ic.a.f_(this.KVa);if(b=h.VIk)this.KVa.appendChild(b),"a"===b.nodeName.toLowerCase()&&(Le.a.addHandler(b,"click",this.Ukd),Le.a.addHandler(b,"keydown",this.Vkd));this.LVa.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<h.keywords.length;b++)D=h.keywords[b],v=document.createElement("a"),v.innerText=D,v.setAttribute("href",'""'),Le.a.addHandler(v,"click",this.$He),Le.a.addHandler(v,"keydown",this.aIe),this.LVa.appendChild(v),
b<h.keywords.length-1&&(D=document.createElement("span"),D.innerText=", ",this.LVa.appendChild(D));this.cze.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.Zye.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.oqa(1,!0)}fEh(){this.yUb&&1===this.yUb.childNodes.length&&(this.lYb&&(Le.a.removeHandler(this.yUb.childNodes[0],"error",this.lYb),this.lYb=null),ic.a.f_(this.yUb));this.KVa&&0<this.KVa.childNodes.length&&"a"===this.KVa.childNodes[0].nodeName.toLowerCase()&&(this.Ukd&&Le.a.removeHandler(this.KVa.childNodes[0],
"click",this.Ukd),this.Vkd&&Le.a.removeHandler(this.KVa.childNodes[0],"keydown",this.Vkd));this.A$a&&0<this.A$a.children.length&&"a"===this.A$a.children[0].nodeName.toLowerCase()&&(this.bud&&Le.a.removeHandler(this.A$a.children[0],"click",this.bud),this.cud&&Le.a.removeHandler(this.A$a.children[0],"keydown",this.cud),ic.a.f_(this.A$a));if(this.LVa){for(let b=0;b<this.LVa.childNodes.length;b++){const h=this.LVa.childNodes[b];"a"===h.nodeName.toLowerCase()&&(Le.a.removeHandler(h,"click",this.$He),Le.a.removeHandler(h,
"keydown",this.aIe))}ic.a.f_(this.LVa)}this.aze.innerText="";this.$ye.innerText="";ic.a.f_(this.gsc);ic.a.f_(this.bze);ic.a.f_(this.KVa);this.LVa.innerText="";this.Yye.innerText="";this.cze.innerText="";this.Zye.innerText=""}Eij(b){if(!(this.Ir.children.length<=b||0>b)){var h=this.Ir.children[b],v=this.Ir.children[0];v=v.clientHeight-v.children[0].clientHeight+2;this.Ir.scrollTop+this.Ir.clientHeight<h.offsetTop+h.clientHeight?this.Ir.scrollTop=h.offsetTop-3*h.clientHeight-v:this.Ir.scrollTop>h.offsetTop&&
(this.Ir.scrollTop=h.offsetTop-v/2);this.L3i(b)}}validate(){return!0}hEh(){if(bd.FocusManager.bK()){var b=bd.FocusManager.instance().getRegion(this.UK);b&&b.fk.Ly(this.xW)}else this.xW.focus();for(b=0;b<this.Ir.childNodes.length;b++){const h=this.Ir.childNodes[b];1===h.childNodes.length&&this.oll(h.childNodes[0])}ic.a.f_(this.Ir);this.fEh();this.oqa(1,!1);this.CXa=new To.a(Box4Intl.Box4Strings.l_ClipartSearching);this.CXa.mCi=!1;this.Ir.appendChild(this.CXa.element);this.Ir.classList.add("ClipartSearchInProgress")}Oag(b){this.BAa=
b;b=this.Ir.children[this.BAa];bd.FocusManager.bK()?bd.FocusManager.instance().getRegion(this.UK).fk.Ly(b):b.focus()}static get QO(){return sn.Uj=sn.Uj||Ea.a.instance.resolve("Box4.Images.IImageEditor")}}sn.Uj=null;Object(n.a)(sn,"InsertClipartDialog",bg.a,[]);class ho extends oc{constructor(b,h,v,D,P,ca){super(b,h,v,D,P,ca,!1);this.Nsn=ta=>{if(this.QQm()){var Ra=this.Fe.Vi(),mb=Ra.contentReplicator.Ht.toString(),Jb=new Sys.Net.WebRequest;Jb.set_url("ClipArtUpload.ashx");Jb=new Sys.StringBuilder(Jb.getResolvedUrl());
this.KW(Jb,Pg.a.assetId,ta.assetId,!0);this.KW(Jb,yh.a.lcid,w.AFrameworkApplication.lcid.toString());this.KW(Jb,yh.a.nodeId,this.ZG?this.ZG.id.toString():this.Fe.id.toString());this.KW(Jb,yh.a.cellId,Ra.nm.toString());this.KW(Jb,yh.a.fileId,Ra.vr);this.KW(Jb,yh.a.$ta,mb);this.KW(Jb,yh.a.jX,this.Nl.toString());ta=this.Fe.ia(Hh.a.EJ,ij.a.Jt);this.KW(Jb,yh.a.EJ,ta.toString());this.KW(Jb,yh.a.Nqb,"1");Ra.DH&&this.KW(Jb,yh.a.DH,Ra.DH);this.KW(Jb,yh.a.classId,this.ZG?this.ZG.properties.Rc.toString():this.Fe.Rc.toString());
this.Wg.hasProperty(Bc.a.imageType)&&this.KW(Jb,Pg.a.imageType,this.Wg.getValue(Bc.a.imageType).toString());Yi.a.instance.zwk(Jb);w.AFrameworkApplication.Ne.xj(Jb.toString(),2,"",{},!1,2,this.s0o,this.uploadFailed,null);oc.Fec++}};this.s0o=ta=>{if(({group:Ra}=bi.a.q1(ta.data.ve)).returnValue){var Ra=Ra.Responses[0];Ra.Nnb=ta.data.KH;Ra.Lr=ta.data.Bj?ta.data.Bj[nh.a.N7]:"";this.jza(Ra)}else this.uploadFailed(null)};this.uploadFailed=()=>{const ta=new Vd.a;ta.StatusCode=14;this.jza(ta)};new sn(this)}XHa(b){this.fXd()&&
this.Fe.Vi().contentReplicator.forceOutbound(this.Nsn,null,b)}KW(b,h,v,D){b.append(D?"?":"&");b.append(G.a.Tj(h));b.append("=");b.append(G.a.Tj(v))}Rif(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.Rif(b)}}jza(b){super.jza(b);oc.Fec--}}Object(n.a)(ho,"ClipartUploader",oc,[]);var sc=c(12);class hq{constructor(b,h,v){this.XBm=(D,P,ca,ta,Ra)=>{if(!this.Uj||!this.Uj.value)return u.ULS.sendTraceTag(524109267,
306,15,"ImageEditor not available"),8;D=this.Uj.value.Jfa(P);return 2===ca&&D?(new ho(P,Qg.a.instance,w.AFrameworkApplication.K,Ra,this.Im,this.ga),32):1===ca?D&&Xa.App.ZEh?32:8:2};this.Uj=b;this.Im=h;this.ga=v}Tb(){this.ga.eb(Gb.a.fsi,sc.a.view,this.XBm,260)}}Object(n.a)(hq,"ClipArtActor",null,[]);class wk{constructor(){this.W=null}get name(){return"Box4.ClipArt"}xc(b){this.W=b;b.ha("Box4.ClipArt.ClipArtActor",()=>new hq(b.Ue("Box4.Images.IImageEditor"),b.resolve("Box4.IUndoManager"),w.AFrameworkApplication.va)).singleInstance()}init(){this.W.resolve("Box4.ClipArt.ClipArtActor").Tb();
const b=Xa.App.xa;b&&b.updateCommandUI()}dispose(){}}Object(n.a)(wk,"ClipartPackage",null,[1,2]);class Sg{constructor(b){this.ZXa=this.KXa=this.cYa=this.bYa=null;this.fYg=this.OSg=this.gYg=this.W3g=this.Zh=this.X$=!1;this.gQe=this.C4g=null;this.m4g=0;this.Fa=this.x4g=null;this.nea=b;this.sN=3;this.hWb=!0}initialize(b,h,v){this.bYa=this.Xtf(b,h);this.cYa=CommonUIStrings.l_SavingStatus;this.KXa=CommonUIStrings.l_ReadOnlyStatus;this.ZXa=CommonUIStrings.l_ReviewModeStatus;this.nea&&this.nea.execute(D=>
{D.Idb(Object(z.a)(this,this.zbd,"updateToSavingStatus"))});this.Zh=!0;this.Fa=v;this.OSg=this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}zqb(b,h){this.X$=b;this.sN=h;this.oUa(this.hWb)}oUa(b){!this.hWb&&b&&(this.x4g=new Date);this.hWb=b;this.fYg=!1;b=null;3===this.sN&&(b=this.hWb?this.bYa:this.cYa);this.Cpl(b)}Xtf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,
h):CommonUIStrings.l_SavedStatus}zbd(){this.oUa(!1)}j4l(){switch(this.sN){case 1:return this.KXa;case 2:return this.ZXa;default:return null}}i4l(){if(3!==this.sN)switch(this.sN){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.fYg?"FailedToSave":this.hWb?"Saved":"Saving"}cKm(b){return this.W3g===this.X$&&this.m4g===this.sN&&this.C4g===b}Eff(b){appChrome.getHeaderApi().then(h=>{h.updateDocumentTitleStatus(this.X$,b,this.j4l(),this.x4g,this.hWb,this.OSg?h.getHeaderSaveStatusIconProps(this.i4l()):
null);this.gYg=!0;return null});this.gQe=null}Cpl(b){this.Zh&&Rh.c()&&!this.cKm(b)&&(!this.gYg&&this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.Eff(b):Dd.a.uee()?(this.gQe&&u.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.gQe=window.requestIdleCallback(()=>{this.Eff(b)})):window.requestAnimationFrame(()=>{this.Eff(b)}),this.W3g=this.X$,this.C4g=b,this.m4g=this.sN)}}Object(n.a)(Sg,"ReactSaveStatusUIHandler",
null,[530]);class Vo{constructor(b,h){this.OX=null;this.bYa=CommonUIStrings.l_SavedStatus;this.cYa=CommonUIStrings.l_SavingStatus;this.KXa=CommonUIStrings.l_ReadOnlyStatus;this.ZXa=CommonUIStrings.l_ReviewModeStatus;this.rab=h;this.nea=b;this.sN=3;this.xcb=!0}UB(){this.nea&&this.nea.execute(b=>{b.Idb(Object(z.a)(this,this.zbd,"updateToSavingStatus"))});this.rab.execute(b=>{this.OX=b})}zqb(b,h){this.sN=h;3===h?this.oUa(this.xcb):2===h?this.ulg(this.ZXa):this.ulg(this.KXa)}zbd(){this.oUa(!1)}oUa(b){this.xcb=
b;this.ulg(this.xcb?this.bYa:this.cYa)}ulg(b){this.OX&&this.OX.sendMessage(L.a.tRo,this.g5k(b))}g5k(b){const h={};h.StatusText=b;return h}}Object(n.a)(Vo,"SaveStatusPostMessageHandler",null,[530]);var tn=c(214),hd=c(137);class Rm{constructor(b,h,v,D){this.ZXa=this.KXa=this.cYa=this.bYa=null;this.Cvb=0;this.IZ=this.oRe=this.Drb=this.vte=this.GVe=null;this.ng=b;this.lab=h;this.nea=v;this.fm=D;this.$0g=!0;this.X$=!1;this.sN=3;this.xcb=!0}initialize(b,h){if(!this.ng)return!1;this.bYa=this.Xtf(b,h);this.cYa=
CommonUIStrings.l_SavingStatus;this.KXa=CommonUIStrings.l_ReadOnlyStatus;this.ZXa=CommonUIStrings.l_ReviewModeStatus;this.UB();return!0}Xtf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}UB(){this.lab&&this.lab.execute(b=>{b.kzk(Object(z.a)(this,this.wNh,"createStatusAndModeElements"));b.Vyk(Object(z.a)(this,this.Dxo,"showHideSaveStatusElement"));b.yMo&&this.wNh(null,
null)});this.nea&&this.nea.execute(b=>{b.Idb(Object(z.a)(this,this.zbd,"updateToSavingStatus"))})}K5(){this.IZ&&this.ng&&this.ng.dza(this.IZ)}Dxo(b,h){this.zqb("true"===h,this.sN)}zqb(b,h){this.X$=b;this.sN=h;this.vte&&(this.vte.style.display=this.X$||3===this.sN||!this.GVe?"none":"");this.Drb&&(this.Drb.style.display=this.X$||3===this.sN?"none":"",this.Drb.innerText=1===this.sN?this.KXa:this.ZXa,this.Drb.title=1===this.sN?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);
this.oRe&&(this.oRe.style.display=this.X$||1===this.sN||!this.GVe&&!this.Drb?"none":"");this.IZ&&(this.IZ.style.display=this.X$||1===this.sN?"none":"",this.oUa(this.xcb),this.IZ.title=CommonUIStrings.l_SaveStatusTooltip)}wNh(b,h){b=document.getElementById(tn.CuiHelper.Csm);h&&h.$4o||!b||""===this.bYa||""===this.cYa||""===this.KXa||""===this.ZXa||(this.GVe=document.getElementById(tn.CuiHelper.U4e),this.vte=tn.CuiHelper.MGd(b,"BreadcrumbAppModeDash","-"),this.Drb=tn.CuiHelper.MGd(b,"BreadcrumbAppModeStatus",
1===this.sN?this.KXa:this.ZXa),this.cGj(this.Drb),this.oRe=tn.CuiHelper.MGd(b,"BreadcrumbSaveStatusDash","-"),this.IZ=tn.CuiHelper.MGd(b,"BreadcrumbSaveStatus",this.bYa),this.cGj(this.IZ),this.zqb(this.X$,this.sN))}zbd(){this.oUa(!1)}oUa(b){this.xcb=b;this.KZo(this.xcb?this.bYa:this.cYa)}KZo(b){!this.IZ||3!==this.sN&&2!==this.sN||(this.$0g&&!this.xcb?(this.Cvb=this.IZ.offsetWidth<this.Cvb?this.Cvb:this.IZ.offsetWidth,this.mUo(this.cYa),this.$0g=!1):this.IZ.innerText=b)}cGj(b){b.style.direction=this.fm?
"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.fm?"right":"left";b.style.display=this.X$?"none":"";b.setAttribute("Unselectable","on")}mUo(b){this.IZ&&(this.IZ.style.width="",this.IZ.innerText=b,this.Cvb=this.IZ.offsetWidth<this.Cvb?this.Cvb:this.IZ.offsetWidth,b=hd.a.vB(this.IZ),this.IZ.style.width=this.Cvb-ic.a.VM(b.paddingLeft)-ic.a.VM(b.paddingRight)+1+"px")}}Object(n.a)(Rm,"SaveStatusUIHandler",null,[530]);var Fo=c(93);class Wp{constructor(){this.pRe=this.tPe=this.iMa=this.W=null}get name(){return"Common.App.SaveStatus"}xc(b){this.W=
b;w.AFrameworkApplication.K.$("PostMessageEmbedded")&&w.AFrameworkApplication.MX?this.W.register(Vo,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Rd(()=>new Vo(this.W.Sa("Common.App.HostNotification.EditNotificationEventSource"),this.W.Sa("Postmessage.IHostPostmessenger"))):w.AFrameworkApplication.ta.Nb.LGf||(w.AFrameworkApplication.ta.Nb.xJ?this.W.register(Sg,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Rd(()=>
new Sg(this.W.Sa("Common.App.HostNotification.EditNotificationEventSource"))):this.W.register(Rm,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Rd(()=>new Rm(Fo.EventHandlerManager.instance,this.W.Sa("Common.App.Header.HeaderEventSource"),this.W.Sa("Common.App.HostNotification.EditNotificationEventSource"),w.AFrameworkApplication.isRtl)))}init(){w.AFrameworkApplication.K.Po(Object(z.a)(this,this.Px,"onFullAppSettingsReady"))}Px(){const b=
w.AFrameworkApplication.K,h=!!w.AFrameworkApplication.ta.Nb&&4===w.AFrameworkApplication.ta.Nb.Tl;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||h&&b.$("SimplifiedReactRibbonUxIsEnabled")||b.$("ExcelSaveStatusInHeaderEnabled")||b.$("VisioSaveStatusInHeaderEnabled"))w.AFrameworkApplication.K.$("PostMessageEmbedded")&&w.AFrameworkApplication.MX?(this.pRe=this.W.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.pRe.UB():w.AFrameworkApplication.ta.Nb.LGf||
b.$("PreventSaveStatusInitializationWithHiddenHeader")&&w.AFrameworkApplication.hideHeader||(w.AFrameworkApplication.ta.Nb.xJ?(this.tPe=this.W.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.tPe.initialize(b.$("IsSkyDrive"),b.jb("HostNameToIncludeInSavedStatus"),w.AFrameworkApplication.K):(this.iMa=this.W.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.iMa.initialize(b.$("IsSkyDrive"),b.jb("HostNameToIncludeInSavedStatus")))}dispose(){this.iMa&&this.iMa.K5()}}Object(n.a)(Wp,
"PackageManager",null,[1,2]);var Nl=c(1656);class Xp{get name(){return"Common.App.EventsCachePackage"}xc(){}init(){Nl.a.instance.init()}dispose(){}static main(){N.a.instance.Fc(new Xp)}}Object(n.a)(Xp,"EventsCachePackage",null,[1,2]);var Sk=c(131),Zj=c(160),al=c(87),Hl=c(615),If=c(306),ik=c(442),vj=c(283),nf=c(25),ph=c(239),Cg=c(24);class Ci{constructor(b){this.g0g=!1;this.aed=this.qm=null;this.vse=!1;this.qE=b}get control(){return this.qE}get Qd(){return this.control.Qd}get root(){return this.control.root}get WH(){return this.control.WH}get UYa(){return this.control.UYa}get vk(){return this.control.vk}get XE(){return this.control.XE}LI(){}initialize(){}Yw(b,
h,v){this.control.uql(b,h,v)}xm(){nf.c(this.control.Eh.Command)||this.ou(this.control.Eh.Command,null,null)}ou(b,h,v){let D=0;this.root&&(D=this.root.Mpa(b,h,v));this.control.enabled=0<(D&1);return D}g8a(){let b=this.control.visible;this.root.JTa&&(b=this.Qd[ph.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.pec=!0));return b}Umg(){const b=Cg.a.hra(this.Qd[ph.a.labelText],this.control.Eh.LabelText);this.hhe(b)}hhe(b){this.control.labelText!==b&&(this.XE.forEach(h=>{h.hhe(b)}),
this.control.labelText=b,this.root.w4a=!0)}dRb(){const b=Cg.a.hra(this.Qd[ph.a.alt],this.control.Eh.Alt);this.Ajc(b)}Ajc(b){this.control.tooltip!==b&&(this.XE.forEach(h=>{h.Ajc(b)}),this.control.tooltip=b)}Dja(){const b=Cg.a.hra(this.Qd[Hl.a.Image16by16Class],this.control.Eh.Image16by16Class),h=Cg.a.hra(this.Qd[Hl.a.Image32by32Class],this.control.Eh.Image32by32Class);var v=Cg.a.hra(this.Qd[Hl.a.Image48by48Class],this.control.Eh.Image48by48Class);v=nf.b(v)?h:v;this.IEc(this.XE.small,b);this.IEc(this.XE.medium,
b);this.IEc(this.XE.large,h);this.IEc(this.XE.DAo,b);this.IEc(this.XE.Lcc,v)}IEc(b,h){!b||nf.c(b.JQ)||nf.c(h)||b.JQ.className===h||(b.JQ.className=h)}ZVo(b){if(!nf.b(b)&&this.root.whg){for(const h of this.control.v9e){const v=h.zT===b;v&&(this.control.NYe=h);this.control.visible&&(h.YA=v)}this.control.visible&&(this.root.w4a=!0)}}YAk(){if(this.XE.Lcc&&this.XE.Lcc.uO&&this.XE.Lcc.kgb){const b=this.XE.Lcc.uO,h=Cg.a.hra(this.Qd[If.a.Description],this.control.Eh.Description);nf.b(h)&&(b.style.position=
"relative",b.style.top=(b.parentNode.offsetHeight-b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.vk;Object(rb.a)(ik.a,b)?this.WH.tqb(b):this.root.jBb=this.control;return!1}onBlur(){const b=this.vk;this.control.iIb()&&Cg.a.Aw(b.Nc,"cui-ctl-menu-hovered-without-focus");this.root.jBb=null;return!1}gP(b){if(this.control.iIb()){var h=this.WH.Fqa;const v=h===this.root.NJb-1;h=v?null:this.root.XC[h+1];this.p8e(!1);v||this.control===h||Cg.a.Aw(h.TIb,vj.MenuLauncher.mZc);this.control.enabled&&
this.control.Fu?v?this.control.FY():(Cg.a.Yf(this.vk.Nc,"cui-ctl-menu-hovered-without-focus"),h.lga=this.control.Fu):v?this.WH.setFocus(b.lg):(h.lga=this.WH.Nc,this.WH.cqa())}return!1}IJ(){this.control.iIb()&&Cg.a.Aw(this.vk.Nc,"cui-ctl-menu-hovered-without-focus");return!1}onKeyDown(b){let h=!1;if(!nf.c(b.Hb)&&!nf.c(b.Hb.rawEvent)){const v=b.Hb.keyCode;b=b.Hb.rawEvent.shiftKey;v===Sys.UI.Key.enter&&(h=!0);if(Object(rb.a)(ik.a,this.vk)){const D=this.WH;if(!nf.c(D)){const P=D.Fqa,ca=0===this.root.h1,
ta=!nf.c(this.control.iBn);if(v!==Sys.UI.Key.tab&&v!==Sys.UI.Key.left&&v!==Sys.UI.Key.right&&v!==Sys.UI.Key.up&&v!==Sys.UI.Key.down&&v!==Sys.UI.Key.esc)return h;Dd.a.R7e();v!==Sys.UI.Key.tab||b?v===Sys.UI.Key.tab&&b?(D.SK(1),h=!0):v===Sys.UI.Key.left&&ca||v===Sys.UI.Key.right&&!ca?(ta?D.SK(2):0<P&&this.root.a_a(P,!0,!1),h=!0):v===Sys.UI.Key.right&&ca||v===Sys.UI.Key.left&&!ca?(ta&&D.SK(4),h=!0):v===Sys.UI.Key.up?(D.SK(5),h=!0):v===Sys.UI.Key.down?(D.SK(6),h=!0):v===Sys.UI.Key.esc&&(this.root.a_a(P,
!0,!1),h=!0):(D.SK(0),h=!0)}}}return h}Dy(b){let h=!1;if(!nf.c(b.Hb)&&!nf.c(b.Hb.rawEvent)){const v=b.Hb.keyCode;Xb.KeyInputManager.cni(b)||v!==Sys.UI.Key.enter&&v!==Sys.UI.Key.space||(h=this.Jwf(b),h||(this.Yw(b.xf,1,b.Hb),h=!0))}return h}ZC(b){this.k9e();if(this.UYa){let h=!0;2===b.lg&&(h=b.Cca===Sys.UI.MouseButton.leftButton);h&&this.vk&&this.Tyd(this.vk.Nc)}(b.Hb.type.toLowerCase()!==Ed.a.yP||this.UYa)&&b.Hb.preventDefault();return!1}get pCf(){return this.g0g}Rul(){this.g0g=!0}k9e(){this.pCf&&
this.control.root.Yeb()}Axa(b){Object(rb.a)(ik.a,this.vk)&&!this.UYa&&2===b.lg&&b.Cca===Sys.UI.MouseButton.leftButton?(this.Yw(b.xf,b.lg,b.Hb),b=!0):b=this.control.Rua(b);return b}onClick(b){let h=!1;Object(rb.a)(ik.a,this.vk)&&!this.UYa&&3===b.lg&&(this.Yw(b.xf,b.lg,b.Hb),h=!0);return aa.a.ti?!1:h}Dmb(b){return this.v6d(b)}CGa(b){this.Rua(b);return!1}v6d(b){return nf.c(this.qm)?!1:(this.$$f(Dd.a.p_d(this.fnh,b.clientPoint)),!0)}$ec(b){let h=!1;this.Rua(b)&&(h=!0);3!==b.lg&&(b=!0,!this.root&&Ci.URf&&
(u.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),b&&this.root.r3(),h=!0);return h}cfc(b){return this.Rua(b)}afc(b){return this.v6d(b)}bfc(b){return this.Rua(b)}Yec(b){return 3===b.lg?(this.root.r3(),!0):!1}Zec(){return!1}get fnh(){!nf.c(this.qm)&&nf.c(this.aed)&&(this.aed=Dd.a.getElementBounds(this.qm));return this.aed}$$f(b){this.vse!==b&&(this.vse=b,this.OYe(this.vse))}OYe(b){nf.c(this.qm)||Cg.a.F5(this.qm,al.Control.Wyd,b)}Tyd(b){this.control.enabled&&(this.qm=b,this.root.GDc=this.control,
this.$$f(!0),this.root.Dfa(this.control,!1))}Rua(b){if(!nf.c(this.qm)){this.$$f(!1);let h=!!this.root;if(Ci.URf){const v=Oc.ActionManager.Gaa(parseInt(this.control.Eh.Command))||"";u.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",h,v)}h&&this.root.tba(this.control,!1);nf.c(b)||Dd.a.p_d(this.fnh,b.clientPoint)&&this.Yw(this.qm,b.lg,b.Hb);h=!!this.root;Ci.URf&&u.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",h);h&&(this.root.GDc=null);this.aed=this.qm=null;return!0}return!1}SK(b){return Object(rb.a)(ik.a,
this.vk)&&2!==b&&4!==b&&!Dd.a.W$b(this.control.Fu)?this.FY():!1}FY(){try{if(this.control.visible){const b=this.control.Fu;if(!nf.c(b))return b.focus(),!0}}catch(b){}return!1}p8e(b){const h=this.WH;nf.c(h)||this.root.a_a(h.Fqa+1,b)}spa(){}Jwf(){return!1}EX(b){let h=null;b&&b.rawEvent&&(h={},h[Ci.triggerTime]=b.rawEvent.timeStamp);return h}static get URf(){null==Ci.ALe&&(Ci.ALe=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return Ci.ALe}}
Ci.triggerTime="TriggerTime";Ci.ALe=null;Object(n.a)(Ci,"ControlBehavior",null,[545]);var nm=c(179);class jr extends Ci{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.Eh}LI(b){const h=b.Lm;b=b.zT;nf.c(h)||(Yf.a.instance.nb(Ed.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus")),Yf.a.instance.nb(Ed.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur")),Zj.a.instance.nb(Ed.a.pointerOver,h,Object(z.a)(this,this.gP,"onPointerOver")),Zj.a.instance.nb(Ed.a.pointerOut,
h,Object(z.a)(this,this.IJ,"onPointerOut")),Xb.KeyInputManager.instance.eE(Ed.a.ai,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"),b),Xb.KeyInputManager.instance.eE(Ed.a.ju,h,Object(z.a)(this,this.HG,"onKeyPress"),b),Xb.KeyInputManager.instance.eE(Ed.a.uh,h,Object(z.a)(this,this.Dy,"onKeyUp"),b),Zj.a.instance.nb(Ed.a.pointerDown,h,Object(z.a)(this,this.ZC,"onPointerDown")),Zj.a.instance.nb(Ed.a.WM,h,Object(z.a)(this,this.Axa,"onPointerUp")),Th.a.instance.nb(Ed.a.click,h,Object(z.a)(this,this.onClick,
"onClick")),nm.a.instance.nb(Ed.a.xP,h,Object(z.a)(this,this.Dmb,"onTouchMove")),nm.a.instance.nb(Ed.a.XJ,h,Object(z.a)(this,this.CGa,"onTouchEnd")))}Yw(b,h,v){this.control.enabled&&(b=null,this.vk&&this.vk.$Uc()&&this.WH&&(b=this.root.XC[this.WH.Fqa])&&!this.pCf&&(b.WSa(this.button),b=null),this.executeCommand(this.control.Eh.Command,h,!0,v),b&&b.WSa(this.button))}executeCommand(b,h,v,D){if(!nf.c(b)){const P=this.Qd;P.CommandValueId=this.button.fEb();P.MenuItemId=this.button.Eh.MenuItemId;P.SourceControlId=
this.control.id;this.root.executeCommand(b,P,this.vk,h,v,null,this.EX(D))}}xm(){nf.c(this.control.Eh.Command)||0<(this.ou(this.properties.Command,this.properties.QueryCommand,this.Qd)&2)&&this.g8a()&&this.lUa()}lUa(){this.Umg();this.dRb();this.Dja()}onFocus(b){super.onFocus(b);this.qgg();return!1}onBlur(b){super.onBlur(b);this.Thf();return!1}onKeyDown(b){let h=super.onKeyDown(b);nf.c(b.Hb)||this.kdg(b.Ro,b.Hb.keyCode)&&(h=!1);return h}HG(b){let h=!1;nf.c(b.Hb)||nf.c(b.Hb.rawEvent)||(this.kdg(b.Ro,
b.Hb.rawEvent.keyCode)?(this.Yw(b.xf,b.lg,b.Hb),h=!0):b.Hb.preventDefault());return h}kdg(b,h){if(aa.a.Gt&&h===Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}Dy(b){let h=!1;nf.c(b.Hb)||this.kdg(b.Ro,b.Hb.keyCode)||(h=super.Dy(b));return h}qgg(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}Thf(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(n.a)(jr,
"ButtonBehavior",Ci,[]);var ka=c(978);class db{}db.Color="Color";db.IndexColorSelected="ColorSelected";Object(n.a)(db,"ColorPickerCommandProperties",null,[]);class yb extends Ci{constructor(b){super(b);this.UAc=this.yv=-1}get colorPicker(){return this.control}get xNa(){return this.colorPicker.g1k.xNa}get properties(){return this.colorPicker.Eh}Yw(b,h,v){if(this.control.enabled){const D=this.Qd;D.Color=yb.bRd(b)[ka.ColorPicker.HEd];b=null;Cg.a.Vr(this.properties.Stateful)&&this.vk&&this.vk.$Uc()&&
this.WH&&(b=this.root.XC[this.WH.Fqa]);this.root.executeCommand(this.properties.Command,D,this.vk,h,!0,null,this.EX(v));b&&b.WSa(this.colorPicker)}}xm(){var b=this.Qd;b.SourceControlId=this.properties.Id;if(0<(this.ou(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,db.IndexColorSelected in this.Qd&&(b=this.Qd[db.IndexColorSelected]),b!==this.UAc)){const h=this.xNa;0<=b&&b<h.length&&this.rFj(h[b],!0);0<=this.UAc&&this.UAc<h.length&&this.rFj(h[this.UAc],!1);this.UAc=b}}rFj(b,h){h?
Cg.a.Yf(b,"cui-colorpicker-selected"):Cg.a.Aw(b,"cui-colorpicker-selected")}LI(b){for(let h=0;h<b.sYe.length;++h){const v=b.sYe[h];Yf.a.instance.nb(Ed.a.focus,v,Object(z.a)(this,this.nTf,"onCellFocus"));Yf.a.instance.nb(Ed.a.blur,v,Object(z.a)(this,this.Lmn,"onCellBlur"));Xb.KeyInputManager.instance.nb(Ed.a.ai,v,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Xb.KeyInputManager.instance.nb(Ed.a.uh,v,Object(z.a)(this,this.Dy,"onKeyUp"));Th.a.instance.nb(Ed.a.click,v,Object(z.a)(this,this.Mmn,"onCellClick"));
Zj.a.instance.nb(Ed.a.WM,v,Object(z.a)(this,this.pTf,"onCellPointerUp"));Zj.a.instance.nb(Ed.a.pointerOver,v,Object(z.a)(this,this.oTf,"onCellPointerOver"));Zj.a.instance.nb(Ed.a.pointerDown,v,Object(z.a)(this,this.Nmn,"onCellPointerDown"))}}nTf(b){b=yb.bRd(b.xf);this.WH.tqb(this.vk);this.Une(b,!0);return!0}Lmn(b){this.Une(yb.bRd(b.xf),!1);return!0}Une(b,h){h?(this.yv=parseInt(b.getAttribute("arrayPosition")),Cg.a.Yf(b,"cui-colorpicker-hoveredOver"),this.qgg(b)):(this.yv=-1,this.Thf(b),Cg.a.Aw(b,
"cui-colorpicker-hoveredOver"))}Mmn(b){3===b.lg&&this.Yw(b.xf,b.lg,b.Hb);return!0}pTf(b){3!==b.lg&&this.Yw(b.xf,b.lg,b.Hb);return!0}oTf(b){this.p8e(!1);b=parseInt(yb.bRd(b.xf).getAttribute("arrayPosition"));this.m7c(b);return!0}Nmn(){return!1}qgg(b){if(this.control.enabled){const h=this.properties.CommandPreview;if(!nf.b(h)){const v=this.Qd;v.Color=b[ka.ColorPicker.HEd];this.root.executeCommand(h,v,this.vk,0,!1)}}}Thf(b){if(this.control.enabled){const h=this.properties.CommandRevert;if(!nf.b(h)){const v=
this.Qd;v.Color=b[ka.ColorPicker.HEd];this.root.executeCommand(h,v,this.vk,0,!1)}}}SK(b){b=al.Control.Flf(this.yv,this.colorPicker.width,this.xNa.length,b);if(b!==this.yv&&this.m7c(b))return!0;this.Une(this.xNa[this.yv],!1);return!1}FY(){return this.m7c(0)}m7c(b){return this.xNa&&this.xNa.length>b&&(b=this.xNa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}spa(){-1!==this.yv&&this.Une(this.xNa[this.yv],!1)}static bRd(b){return yb.S4l(b)}static S4l(b){var h=["td"];const v=h.length;if(!b)return null;
for(var D=0;D<v;D++)if(b.tagName.toLowerCase()===h[D].toLowerCase())return b;for(b=b.parentNode;b;){for(D=0;D<v;D++)if(b.tagName.toLowerCase()===h[D].toLowerCase())return b;b=b.parentNode}return null}}Object(n.a)(yb,"ColorPickerBehavior",Ci,[]);var Zb=c(336),tc=c(291),Pc=c(1681),Od=c(684),ke=c(371),od=c(1122);class Pe{constructor(b,h){this.Tmk=b;this.T_g=h}Qge(b,h,v,D){if(nf.c(b)||nf.c(h))return null;const P=new od.a;const ca=D.x;var ta=D.y;const Ra=D.width;var mb=D.height;let Jb;Pe.b5b(h,"flyoutWidth");
D=Pe.b5b(h,"flyoutRealHeight");const Ub=Pe.b5b(h,"viewportWidth");var cc=Pe.b5b(h,"viewportHeight"),Ac=Pe.b5b(h,"viewableLeft");const Lc=Pe.b5b(h,"viewableTop"),id=this.Tmk;let vd=!1,xe=!1;const Ld=1===v,Qd=4===v,Zd=this.T_g;b.style.maxHeight="none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";Jb=this.hOi(b);P.xKj=cc;P.Pog=Ub;if(Ld)id?h=ca+Ra:(h=ca-Jb,P.Rkb=!0),mb=ta;else{var te="";Ra>Jb&&(Jb=Ra,te=(Jb-2*ke.Menu.z4d).toString());id?h=ca:(h=ca+Ra-Jb,P.Rkb=!0);mb=ta+mb;""!==te&&
(b.style.minWidth=te+"px")}Zd&&(mb+=Lc,h+=Ac);b.style.top=mb+"px";b.style.left=h+"px";let Qf=!1;te=!1;Jb<=Ub?h+Jb>Ac+Ub?(Ld&&id&&ca-Jb>Ac||Qd&&ca-Jb>Ac?(h=ca-Jb,Zd&&(h+=Ac),te=P.Rkb=!0):(h=Ac+Ub-Jb,vd=!0),Qf=!0):h<Ac&&(Ld&&!id&&ca+Ra+Jb<Ac+Ub?(h=ca+Ra,Zd&&(h+=Ac),P.Rkb=!1,te=!0):(h=Ac,xe=!0,P.Rkb=!0),Qf=!0):id?(h=Ac,Qf=!0,P.Rkb=!0):(h=Ac+Ub-Jb,Qf=!0,P.Rkb=!1);Qf&&(b.style.left=h+"px");P.O6b=mb;mb+D<=Lc+cc&&3!==v||(P.cJf=!0,{vhn:v,WGl:ta,ALm:cc,ySm:Ac}=this.flf(v,mb,D,ta,Lc,cc),mb!==v&&(b.style.top=
v+"px",P.O6b=v),-1<ta&&(b.style.maxHeight=ta+"px"),cc&&(b.style.bottom="0px",b.style.height="auto"),Ac&&this.D$m(b,id,Ld,te,xe,vd,Ub,ca,Ra));P.LMc=h;P.Clf=Jb;P.zlf=D;return P}flf(b,h,v,D,P,ca){let ta,Ra,mb;ta=-1;mb=Ra=!1;const Jb=h,Ub=P+ca-h;h=D-v;const cc=this.T_g;let Ac=!1;0>h&&(h=P);cc||(D-=P);v<=D&&1!==b||(4===b||1===b?v<ca?(h=ca-v,Ra=!0):(h=P,Ac=mb=Ra=!0):(D<Ub&&3!==b?(h=Jb,Ra=!0):ta=D,mb=!0));cc&&(Ra=!1,Ac?ta=ca:h+=P);return{vhn:h,WGl:ta,ALm:Ra,ySm:mb}}D$m(b,h,v,D,P,ca,ta,Ra,mb){b.style.overflowY=
"scroll";b.style.width="auto";if(h){if(ca||D)b.style.left="",b.style.right=(ca?0:ta-Ra)+"px"}else P||D||(b.style.left="",b.style.right=(v?ta-Ra:ta-Ra-mb)+"px")}lVl(b){const h={};if(nf.c(b))return h;h.viewportWidth=ic.a.EFb();h.viewportHeight=ic.a.FX();nf.c(h.viewportWidth)&&(h.viewportWidth=document.documentElement.clientWidth,h.viewportHeight=document.documentElement.clientHeight);nf.c(h.viewportWidth)&&(h.viewportWidth=document.body.clientWidth,h.viewportHeight=document.body.clientHeight);h.viewableTop=
window.pageYOffset;h.viewableLeft=window.pageXOffset;nf.c(h.viewableTop)&&(h.viewableTop=document.documentElement.scrollTop,h.viewableLeft=document.documentElement.scrollLeft);nf.c(h.viewableTop)&&(h.viewableTop=document.body.scrollTop,h.viewableLeft=document.body.scrollLeft);h.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*ke.Menu.z4d:b.scrollHeight;const v=b.style.overflowY;b.style.overflowY="visible";h.flyoutWidth=this.hOi(b);b.style.overflowY=v;return h}hOi(b){return b.offsetWidth}static b5b(b,
h){return nf.c(b)?0:b[h]}}Object(n.a)(Pe,"MenuPositioner",null,[]);var Se=c(505),ng=c(597),Dg=c(1124),gi=c(1123),qh=c(1120),ym=c(1121),Ol=c(1126),ah=c(384),bk=c(976);class bj extends Ci{constructor(b){super(b);this.wKe=0;this.Q3g=null;this.TNe=-1;this.nid=null;this.NZf=this.PXg=!1;this.Jbk=new Pe(0===this.root.h1,Cg.a.Vr(this.root.properties.DivSyndicated))}get xOi(){return this.Jbk}get Nu(){return this.control}get properties(){return this.control.Eh}get menu(){return this.Nu.menu}set menu(b){this.Nu.menu=
b}get iL(){return this.Nu.iL}set iL(b){this.Nu.iL=b}get vwh(){nf.c(this.nid)&&(this.nid=bj.dbl());return this.nid}get crj(){let b=!this.root.uzf;Object(rb.a)(379,this.root)&&1===this.root.NJb&&(b=!0);return b}Yw(b,h){Object(rb.a)(379,this.root)&&this.root.lif();this.Nu.f0(h)}f0(b){if(this.Nu.enabled&&!this.iL){var h=bf.a.instance.yp(Wa.a.f0);h.properties.add("Id",this.Nu.Eh.Id);h.properties.add("InputMethod",Zb.a[b]);h.end();hj.a.mark(10326);Dd.a.w4d(this.Nu.Eh.Id,"MenuOpen");this.Nu.Fu&&(this.Nu.lga=
Dd.a.lhb(this.Nu.Fu.ownerDocument));this.wKe=b;this.w2i(b);this.fge();this.Nu.Y7a(this.Nu.Fu,!0)}}fge(){nf.c(this.properties.PopulateAsyncTriggerCommand)||this.PXg||(this.ejn(),this.PXg=!0)}ejn(){const b={};b[Pc.a.Callback]=Object(z.a)(this,this.Z8i,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.vk,0,!1)}Z8i(){this.Nu.rSa()}rSa(){this.iL&&this.w2i(this.wKe,!0)}w2i(b,h=!1){var v=!0;if(Cg.a.Vr(this.properties.PopulateDynamically)){v=!1;const D=this.P1c(b);
D!==this.Q3g&&(v=this.c_f(D,h));v=v||!this.iL}v&&(h=w.AFrameworkApplication.ta.Hq,v=null,h&&(v=h.Zf("LoadResource","Menu Initialization")),this.$Ea(b),v&&v.stop(),this.I7d())}$Ea(b){if(!nf.c(this.menu)){if(this.Nu.b5a){var h=this.Nu.vk;if(h&&h.keytip){var v=h.keytip.key.toLocaleLowerCase();this.menu.Gmo(String.format("{0} {1}",this.Nu.b5a,h.keytip.rhf),this.Nu.XRa&&""!==this.Nu.XRa?String.format("{0}-{1}",this.Nu.XRa,v):v)}}this.menu.fna();Cg.a.Yf(this.menu.Nc,this.Nu.u0e);Cg.a.F5(this.menu.Nc,"cui-touch",
3===b||this.root.Eme);if(this.menu.hasItems()){this.menu.LI();h=this.vk;h.RWh();h.URc=!0;h.Af(this.menu);h.URc=!1;this.menu.s2i();v=Object(rb.a)(bk.a,this.root);var D=null,P=!1;v&&(D=this.root,P=D.O6a,D.O6a=!1);var ca=this.menu.Nc;ca.style.visibility="hidden";ca.style.position="absolute";ca.style.top="0px";ca.style.left="0px";aa.a.Gt&&!aa.a.Vjb&&(ca.style.maxHeight="100px",ca.style.overflowY="scroll");document.body.appendChild(ca);this.bBk();this.LFn(ca);Sys.Browser.agent===Sys.Browser.InternetExplorer&&
this.nrk();Cg.a.Yf(this.Nu.TIb,vj.MenuLauncher.mZc);var ta=this.root.NJb;this.jto&&this.root.Dfa(this.control,!0);ca.style.zIndex=String(w.AFrameworkApplication.ta.Fta);this.root.Vtk(this.Nu);this.menu.Fqa=ta;ca.style.visibility="visible";ta=this.g6h();if(Object(rb.a)(ym.a,this.menu)){ca.style.position="fixed";const Ra=this.root.XC[0];Ra&&Ra.menu&&Ra.menu.Nc?100!==Dd.a.kPc(this.root.XC[0].menu.Nc)&&tc.a.Jeg(ca,ta,Object(z.a)(this,this.F0e,"afterShowMenu")):tc.a.Jeg(ca,ta,Object(z.a)(this,this.F0e,
"afterShowMenu"))}else tc.a.Jeg(ca,ta,Object(z.a)(this,this.F0e,"afterShowMenu"));this.iL=!0;this.menu.bJf=!0;!aa.a.ti&&this.Nu.Feo&&this.menu.setFocus(b);v&&(D.O6a=P);v=this.properties.CommandMenuOpen;nf.b(v)||this.root.executeCommand(v,null,h,b,!1)}}hj.a.mark(10327)}I7d(){}nrk(){this.TNe=Cg.a.BAb(this.TNe);this.TNe=window.setTimeout(Object(z.a)(this,this.ork,"addAndPositionBackFrameInternal"),50)}ork(){this.menu&&this.menu.Nc&&(document.body.appendChild(this.vwh),this.HFn())}HFn(){const b=this.vwh;
var h=this.menu.Nc;b.style.position="absolute";b.style.visibility="hidden";b.style.left=h.style.left;b.style.right=h.style.right;b.style.top=h.style.top;b.style.bottom=h.style.bottom;let v=h.offsetWidth;h=h.offsetHeight;aa.a.Vjb&&(v-=4,h-=4);b.style.width=v.toString()+"px";b.style.height=h.toString()+"px";b.style.visibility="visible"}get jto(){return this.root.NJb?!1:!0}F0e(b){b.element&&(b.element.style.filter="",b.element.style.opacity="",this.menu&&this.menu.Nc===b.element&&Object(rb.a)(qh.a,this.menu)&&
tc.a.QCk(this.g6h()))}g6h(){const b=this.menu.children,h=[];if(Object(rb.a)(qh.a,this.menu))for(let v=0;v<b.count;v++){const D=b.J(v);Array.add(h,D.separator);for(let P=0;P<D.children.count;P++){const ca=D.children.J(P);Array.add(h,ca.Nc)}}return h}bBk(){var b=this.menu.children;for(let v=0;v<b.count;v++){const D=b.J(v).children;for(let P=0;P<D.count;P++){var h=D.J(P);if(Object(rb.a)(ik.a,h)){const ca=h;if("Menu32"===ca.zT||"Menu48"===ca.zT)h=h.control,h.behavior&&(Object(rb.a)(ng.a,h)||Object(rb.a)(gi.a,
h))&&h.behavior.YAk()}}}0<b.count&&(b=b.J(0),nf.c(b.separator)||(b.separator.style.display="none"),nf.c(b.ime)||Cg.a.Yf(b.ime,"cui-menusection-titleAtTop"))}LFn(b){if(!nf.c(b)){b.style.top="0px";b.style.left="0px";b.style.bottom="";b.style.right="";b.style.width="";b.style.minWidth="";var h=Od.a.create();try{const v=this.xOi.lVl(b),D=this.UOc();let P=this.root.Qge(b,v,this.Nu.A4d,D);P||(P=this.xOi.Qge(b,v,this.Nu.A4d,D));this.root.yOi=P}finally{h&&h.dispose()}}}UOc(){const b=Dd.a.getElementBounds(this.Nu.TIb);
var h=this.WH;nf.c(h)||nf.c(h.Nc)||(h=Dd.a.getElementBounds(h.Nc),b.x=h.x+ke.Menu.z4d,b.width=h.width-2*ke.Menu.z4d);Object(rb.a)(ah.a,this.Nu.i1d)&&(b.height=0);return b}mua(){if(this.Nu.iL){u.ULS.sendTraceTag(6688860,207,50,"Menu closing {0}",{["Id"]:this.Nu.Eh.Id});this.menu.spa();this.yaj();this.iL=!1;this.menu.bJf=!1;this.root.tba(this.control,!0);this.crj?w.AFrameworkApplication.ta.I5c(this.Nu.lga,this.wKe):this.p8n();this.Nu.lga=null;var b=this.Nu.TIb;Cg.a.Aw(b,vj.MenuLauncher.mZc);this.Nu.Y7a(this.Nu.Fu,
!1);Cg.a.Aw(b,"cui-ctl-menu-hovered-without-focus");this.menu.cqa();nf.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.vk,0,!1);this.xaj()}}p8n(){const b=this.Nu.lga;if(b)try{b.focus()}catch(h){}}xaj(){ic.a.lx(this.menu.Nc);ic.a.lx(this.nid);Cg.a.dza(this.menu.Nc)}P1c(b){if(this.NZf&&Cg.a.Vr(this.properties.PopulateOnlyOnce)||nf.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const h=this.Nu.Fof();return 0<(this.root.Mpa(this.properties.PopulateQueryCommand,
this.properties.PopulateQueryCommand,h,b)&1)?h.PopulationXML:null}c_f(b,h=!1){if(this.NZf&&Cg.a.Vr(this.properties.PopulateOnlyOnce))return!0;let v=null;this.Q3g=b;nf.c(b)||(v=this.lcl(b));nf.c(v)||(this.NZf=!0);if(h){this.root.jZk(this.Nu);if(nf.c(v)||!v.hasItems())return this.mua(),!1;this.yaj();this.xaj()}this.Klo(v);return!0}IUi(){}lcl(b){b=Se.Builder.KJh(b);if(!nf.c(b)){const h=new Ol.a;h.gFh=!0;h.parentId=this.control.id;let v;v=Object(rb.a)(Dg.a,this.control);return this.root.eO.FZa(b,h,v)}return null}Klo(b){nf.c(b)||
(nf.c(this.menu)||this.menu.dispose(),this.menu=b,this.IUi())}yaj(){const b=this.menu.parent;b?(b.URc=!0,b.removeChild(this.menu.id),b.URc=!1):u.ULS.sendTraceTag(572330335,207,10,"Parent not found for the Menu component {0}",this.menu.id)}onKeyDown(b){let h=!1;nf.c(b.Hb)||nf.c(b.Hb.rawEvent)||Object(rb.a)(ik.a,this.vk)||!b.Hb.rawEvent.altKey||b.Hb.keyCode!==Sys.UI.Key.down||(this.Yw(b.xf,1,b.Hb),h=!0);h||(h=super.onKeyDown(b));return h}ZC(b){this.k9e();2===b.lg&&b.Cca!==Sys.UI.MouseButton.leftButton||
this.Yw(b.xf,b.lg,b.Hb);b.Hb.preventDefault();return!1}Jwf(b){if(!this.WH||!this.WH.inKeytipMode||!this.Nu.VVi)return!1;this.Nu.VVi(this.vk,b);return!0}static dbl(){const b=Cg.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(n.a)(bj,"MenuLauncherBehavior",Ci,[556,545]);var Il=c(916);class yj extends bj{constructor(b){super(b)}get kt(){return this.AKc.properties}get AKc(){return this.control}get dOa(){return this.AKc.dOa}LI(){Zj.a.instance.nb(Ed.a.pointerDown,
this.dOa.Lm,Object(z.a)(this,this.ZC,"onPointerDown"));Xb.KeyInputManager.instance.nb(Ed.a.ai,this.dOa.Lm,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Xb.KeyInputManager.instance.nb(Ed.a.uh,this.dOa.Lm,Object(z.a)(this,this.Dy,"onKeyUp"))}xm(){const b=this.Qd[Il.a.SelectedItemId];if(0<(this.ou(this.kt.Command,this.kt.QueryCommand,this.Qd)&2)){const h=this.Qd[Il.a.SelectedItemId];nf.c(h)||b===h||this.AKc.E6c(h)||(this.Qd[Il.a.SelectedItemId]=null)}}}Object(n.a)(yj,"DropDownBehavior",bj,[]);var Jm=
c(518),Bh=c(694);class Pl extends yj{constructor(b){super(b);this.UVa=null;this.fLe=this.zub=this.UAa=!1;this.czc=null;this.azc=-1}get s3(){return this.control}get uQ(){return this.s3.uQ}get vH(){return this.s3.vH}get eZd(){return this.Qd[Jm.a.IsFreeForm]}set eZd(b){this.Qd[Jm.a.IsFreeForm]=b}LI(b){Zj.a.instance.nb(Ed.a.pointerDown,b.Lm,Object(z.a)(this,this.ZC,"onPointerDown"));const h=b.ur;Yf.a.instance.nb(Ed.a.focus,h,Object(z.a)(this,this.omb,"onInputFocus"));Yf.a.instance.nb(Ed.a.blur,h,Object(z.a)(this,
this.wxa,"onInputBlur"));Xb.KeyInputManager.instance.nb(Ed.a.ai,h,Object(z.a)(this,this.xqn,"onInputKeyDown"));Xb.KeyInputManager.instance.nb(Ed.a.ju,h,Object(z.a)(this,this.yqn,"onInputKeyPress"));xf.a.instance.nb(Ed.a.Eca,h,Object(z.a)(this,this.CUf,"onInputMouseUp"));Zj.a.instance.nb(Ed.a.pointerDown,h,Object(z.a)(this,this.Aqn,"onInputPointerDown"));Zj.a.instance.nb(Ed.a.pointerDown,b.vVh,Object(z.a)(this,this.aVf,"onMenuButtonPointerDown"))}xm(){0<(this.ou(this.vH.Command,this.vH.QueryCommand,
this.Qd)&2)&&(this.zub||this.BIj(),this.BWo())}IUi(){this.s3.menuItems=null;var b;var h=b=null;if(!nf.c(this.menu)){this.sge();for(let D of this.menu.children)for(let P of D.children)if(Object(rb.a)(ik.a,P)){var v=P;v=v.control;Object(rb.a)(553,v)&&(b=v,b=b.Eh.MenuItemId);Object(rb.a)(538,v)&&(h=v,h=h.C1a());nf.c(b)||nf.c(h)||(this.s3.menuItems[h]=b,b=h=null)}}}Aqn(b){Object(rb.a)(379,this.root)&&2===b.lg&&(this.UVa=Dd.a.lhb(this.control.Fu.ownerDocument),this.control.Fu.focus());return!1}ZC(b){this.k9e();
let h=!1;3===b.lg&&(h=super.ZC(b),this.sge());h&&b.Hb.preventDefault();return!1}aVf(b){let h=!1;if(2!==b.lg||b.Cca===Sys.UI.MouseButton.leftButton)this.Yw(b.xf,b.lg,b.Hb),this.sge(),h=!0;h&&b.Hb.preventDefault();return!1}xqn(b){let h=!1;if(!nf.c(b.Hb)&&!nf.c(b.Hb.rawEvent)){const v=b.Hb.keyCode;b=b.Hb.rawEvent.shiftKey;Cg.a.Vr(this.vH.AutoComplete);if(v===Sys.UI.Key.enter)this.mT(),this.V7f(),Object(rb.a)(Bh.Ribbon,this.root)&&this.root.r_(),h=!0;else if(v===Sys.UI.Key.tab){if(this.mT(),this.V7f(),
Object(rb.a)(Bh.Ribbon,this.root)&&(h=this.root.Vpe(this.vk.Nc,!b)),Object(rb.a)(379,this.root))return!0}else v===Sys.UI.Key.backspace||v===Sys.UI.Key.del?this.control.enabled?(this.x6e(),this.czc=null):h=!0:v===Sys.UI.Key.esc?(this.Z7f(),this.V7f(),Object(rb.a)(Bh.Ribbon,this.root)&&this.root.r_(),h=!0):v===Sys.UI.Key.down&&(this.f0(1),this.sge(),h=!0)}return h}yqn(b){if(!this.control.enabled)return!0;!nf.c(b.Hb)&&b.Hb.charCode&&this.Djl();return!1}CUf(){return this.UAa?!1:this.UAa=!0}uyl(){this.azc=
-1;const b=this.uQ.ur,h=b.value,v=this.LXl(h);if(v){b.value=v.key;if(b.setSelectionRange)b.setSelectionRange(h.length,b.value.length);else if(b.createTextRange){const D=b.createTextRange();D.moveStart("character",h.length);D.moveEnd("character",b.value.length);D.select()}this.czc=v.value}else this.czc=null}LXl(b){const h=this.s3.menuItems;for(let v in h){const D={key:v,value:h[v]};if(D.key.toLowerCase().startsWith(b.toLowerCase()))return D}return null}Djl(){Cg.a.Vr(this.vH.AutoComplete)&&-1===this.azc&&
(this.fLe&&(this.P1c(0),this.fLe=!1),this.azc=window.setTimeout(Object(z.a)(this,this.uyl,"executeAutoComplete"),this.s3.cJk))}x6e(){Cg.a.Vr(this.vH.AutoComplete)&&(this.azc=Cg.a.BAb(this.azc))}omb(b){if(this.iL)return this.menu.setFocus(0),!0;Object(rb.a)(379,this.root)&&(bd.FocusManager.instance().cD("ribbon"),this.root.fRc=!1);this.onFocus(b);this.zub=!0;Cg.a.Yf(this.uQ.Lm,"cui-cb-focus");Cg.a.Vr(this.vH.PopulateDynamically)&&(this.fLe=!0);Dd.a.A6c(this.uQ.ur);nf.c(this.menu)||this.menu.ym();return this.UAa=
!1}wxa(){this.zub=!1;this.mT();Cg.a.Aw(this.uQ.Lm,"cui-cb-focus");return!1}V7f(){Object(rb.a)(379,this.root)&&(void 0!==this.UVa&&null!==this.UVa&&w.AFrameworkApplication.ta.I5c(this.UVa,2),this.UVa=null)}mT(){if(this.control.enabled){this.x6e();var b=this.uQ.ur;if(void 0===this.Qd[Jm.a.Value]||null===this.Qd[Jm.a.Value]||b.value!==this.Qd[Jm.a.Value].toString())if(this.s3.E6c(this.czc))this.eZd=!1,this.Qd[Jm.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.s3.J6c.fEb(),["MenuItemId"]:this.s3.J6c.Eh.MenuItemId},
this.root.executeCommand(this.vH.Command,b,this.vk,0,!1);else{if(!Cg.a.Vr(this.vH.AutoComplete)){var h=this.s3.menuItems[b.value];if(!nf.b(h)&&this.s3.E6c(h)){this.eZd=!1;this.Qd[Jm.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.s3.J6c.fEb(),["MenuItemId"]:h};this.root.executeCommand(this.vH.Command,b,this.vk,0,!1);return}}h=!nf.b(b.value)&&""!==G.a.kya(b.value);this.s3.gsh&&h?(this.eZd=!0,this.Qd[Jm.a.Value]=b.value,this.root.executeCommand(this.vH.Command,{["IsFreeForm"]:!0,["Value"]:b.value},
this.vk,0,!1)):this.Z7f()}}else this.Z7f()}Z7f(){this.x6e();this.czc=null;this.BIj()}BIj(){const b=this.Qd[Jm.a.Value]||"";b!==this.uQ.ur.value&&(this.uQ.ur.value=b);this.s3.E6c(this.s3.menuItems[b])}BWo(){const b=this.Qd[Jm.a.FontStyle]||"normal";b!==this.uQ.ur.style.fontStyle&&(this.uQ.ur.style.fontStyle=b)}sge(){this.control.Fu&&this.menu&&this.control.Fu.setAttribute(cf.a.qvh,this.menu.id)}}Object(n.a)(Pl,"ComboBoxBehavior",yj,[]);class Km extends bj{constructor(b){super(b)}get YFd(){return this.control}UOc(){let b=
0;this.menu&&this.menu.Nc&&2===this.menu.horizontalAlignment&&(b=this.menu.Nc.clientWidth);return new Sys.UI.Bounds(this.YFd.x-b,this.YFd.y,this.YFd.eJf,this.YFd.dJf)}}Object(n.a)(Km,"ContextMenuLauncherBehavior",bj,[]);class Di extends bj{constructor(b){super(b)}get VId(){return this.control}UOc(){return new Sys.UI.Bounds(this.VId.x,this.VId.y,this.VId.eJf,this.VId.dJf)}}Object(n.a)(Di,"DialogMenuLauncherBehavior",bj,[]);var ln=c(596);class Go extends bj{constructor(b){super(b);this.iLe=!1;this.qkk=
!Cg.a.oha(this.kt.ShouldRefreshWhenDropped)}get aEa(){return this.control}get kt(){return this.control.Eh}LI(b){b=b.Lm;nf.c(b)||(Yf.a.instance.nb(Ed.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus")),Yf.a.instance.nb(Ed.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur")),Zj.a.instance.nb(Ed.a.pointerOver,b,Object(z.a)(this,this.gP,"onPointerOver")),Xb.KeyInputManager.instance.nb(Ed.a.ai,b,Object(z.a)(this,this.onKeyDown,"onKeyDown")),Xb.KeyInputManager.instance.nb(Ed.a.uh,b,Object(z.a)(this,this.Dy,
"onKeyUp")),Zj.a.instance.nb(Ed.a.pointerDown,b,Object(z.a)(this,this.ZC,"onPointerDown")))}xm(){nf.c(this.control.Eh.Command)||(this.aEa.iL&&!this.qkk?this.iLe=!0:(0<(this.ou(this.kt.Command,this.kt.QueryCommand,this.Qd)&2)&&this.g8a()&&this.lUa(),Cg.a.Vr(this.kt.RefreshableMenu)&&this.iL&&this.menu.zEn()))}lUa(){this.yWo();this.Dja();this.mXo();this.aEa.dzf=this.Qd[ln.a.ImageIsVisible]}yWo(){const b=Cg.a.hra(this.Qd[ln.a.LabelText],this.kt.LabelText),h=this.Qd[ln.a.LabelTextUserGeneratedPlaceholderReplacements];
if(this.control.labelText!==b||this.kt.LabelTextUserGeneratedPlaceholderReplacements!==h)this.XE.medium&&this.zWo(this.XE.medium.uO,b,h),this.root.w4a=!0,this.control.labelText=b,this.kt.LabelTextUserGeneratedPlaceholderReplacements=h}zWo(b,h,v){const D=b.lastChild;Cg.a.alj(b,h+" ",v);h=nf.c(D);u.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",h?"":D.nodeType.toString());h||b.appendChild(D)}mXo(){const b=this.Qd[ln.a.ImageBackColor];this.XE.forEach(h=>
{Go.YEk(h.JQ,b)})}f0(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&(w.AFrameworkApplication.epa("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),w.AFrameworkApplication.va.processAction(Wa.a.ZId,2));"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||w.AFrameworkApplication.va.processAction(Wa.a.ZId,2);Object(rb.a)(ik.a,this.vk)&&(this.iL||this.p8e(!0),this.control.enabled&&
this.FY());super.f0(b)}mua(){super.mua();this.iLe&&(this.iLe=!1,this.xm())}gP(b){return this.control.iIb()?(this.aEa.iL?(this.root.vBh(),Cg.a.Yf(this.aEa.TIb,vj.MenuLauncher.mZc),this.aEa.lga=this.control.Fu):(super.gP(b),this.Yw(b.xf,b.lg,b.Hb)),!1):super.gP(b)}onKeyDown(b){let h=!1;if(!nf.c(b.Hb)&&!nf.c(b.Hb.rawEvent)){if(Object(rb.a)(ik.a,this.vk)){const v=b.Hb.rawEvent,D=b.Hb.keyCode,P=0===this.root.h1;v.shiftKey||v.ctrlKey||!(D===Sys.UI.Key.right&&P||D===Sys.UI.Key.left&&!P)||(h=this.Jwf(b),
h||(this.Yw(b.xf,1,b.Hb),h=!0))}h||(h=super.onKeyDown(b))}return h}static YEk(b,h){nf.c(b)||nf.c(h)||b.style.backgroundColor===h||(b.style.backgroundColor=h)}}Object(n.a)(Go,"FlyoutAnchorBehavior",bj,[]);var ri=c(945);class kr extends Ci{constructor(b){super(b)}get h7b(){return this.control}get properties(){return this.h7b.properties}get Pfa(){return this.h7b.Pfa}LI(b){b=b.KCb;Yf.a.instance.nb(Ed.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Yf.a.instance.nb(Ed.a.blur,b,Object(z.a)(this,this.onBlur,
"onBlur"));Zj.a.instance.nb(Ed.a.pointerOver,b,Object(z.a)(this,this.gP,"onPointerOver"));Zj.a.instance.nb(Ed.a.pointerOut,b,Object(z.a)(this,this.IJ,"onPointerOut"));Xb.KeyInputManager.instance.nb(Ed.a.ai,b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Xb.KeyInputManager.instance.nb(Ed.a.uh,b,Object(z.a)(this,this.Dy,"onKeyUp"));Zj.a.instance.nb(Ed.a.pointerDown,b,Object(z.a)(this,this.ZC,"onPointerDown"));Zj.a.instance.nb(Ed.a.WM,b,Object(z.a)(this,this.Axa,"onPointerUp"));nm.a.instance.nb(Ed.a.xP,
b,Object(z.a)(this,this.Dmb,"onTouchMove"));nm.a.instance.nb(Ed.a.XJ,b,Object(z.a)(this,this.CGa,"onTouchEnd"))}xm(){const b=this.Qd[ri.a.On],h=this.Qd[ri.a.IsRtl];this.gIj();if(0<(this.ou(this.properties.Command,this.properties.QueryCommand,this.Qd)&2)){var v=!nf.c(this.Qd[ri.a.InnerHTML])||!nf.c(this.properties.InnerHTML),D=!nf.c(this.properties.Image);v||D||(this.control.enabled=!1);D=this.Pfa.KCb;if(!nf.c(D)){if(v){v=Cg.a.hra(this.Qd[ri.a.InnerHTML],this.properties.InnerHTML);if(null===D.innerHTML||
null===v||G.a.Ug(D.innerHTML)!==G.a.Ug(v))D.innerHTML=v;""===v&&(this.control.enabled=!1)}v=D.title;const P=Cg.a.hra(this.Qd[ri.a.Alt],this.properties.Alt);P===v||this.control.wdg||(D.title=P)}D=this.Qd[ri.a.IsRtl];b===this.Qd[ri.a.On]&&h===D||this.control.ZKb()}}gIj(){const b=this.Qd;b[ri.a.CommandValueId]=this.control.fEb();b.MenuItemId=this.control.Eh.MenuItemId;b.SourceControlId=this.properties.Id}Yw(b,h,v){if((b=this.vk)&&this.control.enabled){const D=this.root;if(w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.$("ExcelBorderMenuCompactionEnabled")&&b.$Uc()&&this.WH){const P=D.XC[this.WH.Fqa];P?P.WSa(this.h7b):u.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.gIj();this.Qd[ri.a.On]||(this.Qd[ri.a.On]=!0,this.control.ZKb());"Menu"===b.zT&&Cg.a.Aw(this.Pfa.Lm,"cui-gallerybutton-focused");D.executeCommand(this.properties.Command,this.Qd,b,h,!0,null,this.EX(v))}}onFocus(b){super.onFocus(b);Cg.a.Yf(this.Pfa.Lm,
"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);Cg.a.Aw(this.Pfa.Lm,"cui-gallerybutton-focused");return!1}}Object(n.a)(kr,"GalleryButtonBehavior",Ci,[]);var Sm=c(1127),jq=c(1392),Mk=c(634);class Sq extends Ci{constructor(b){super(b);this.gXa=-1}get I$b(){return this.control}get properties(){return this.I$b.Eh}get jHc(){return this.I$b.jHc}get yyf(){var b=null;if(this.vk&&(b=this.vk.parent,!Object(rb.a)(Mk.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get LGb(){return this.I$b.iXd.LGb}get N0c(){return this.I$b.iXd.N0c}Yw(b,
h,v){if(this.control.enabled){b=this.grf(this.w7b(b));const D=this.yOd(b);this.jHc[jq.a.Rows]=this.hSd(b)+1;this.jHc[jq.a.Columns]=D+1;this.root.executeCommand(this.properties.Command,this.jHc,this.vk,h,!0,null,this.EX(v))}}LI(b){var h=b.Lm;const v=b.iCh;b=b.cells;Zj.a.instance.nb(Ed.a.pointerOut,h,Object(z.a)(this,this.Pnn,"onControlPointerOut"));nm.a.instance.nb(Ed.a.xP,h,Object(z.a)(this,this.Rnn,"onControlTouchMove"));nm.a.instance.nb(Ed.a.XJ,h,Object(z.a)(this,this.Qnn,"onControlTouchEnd"));
for(h=0;h<b.length;++h)this.AIk(v[h],b[h])}AIk(b,h){Yf.a.instance.nb(Ed.a.focus,b,Object(z.a)(this,this.nTf,"onCellFocus"));Zj.a.instance.nb(Ed.a.pointerOver,h,Object(z.a)(this,this.oTf,"onCellPointerOver"));Zj.a.instance.nb(Ed.a.WM,h,Object(z.a)(this,this.pTf,"onCellPointerUp"));Xb.KeyInputManager.instance.nb(Ed.a.ai,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Xb.KeyInputManager.instance.nb(Ed.a.uh,h,Object(z.a)(this,this.Dy,"onKeyUp"));nm.a.instance.nb(Ed.a.yP,h,Object(z.a)(this,this.Omn,"onCellTouchStart"))}grf(b){return parseInt(b.id.substr(this.I$b.id.length+
1))}Tli(b){this.Sli(this.grf(b))}hSd(b){return Math.floor(b/Sm.a.o_c)}yOd(b){return b%Sm.a.o_c}Sli(b){if(b!==this.gXa){var h=this.yOd(b),v=this.hSd(b),D=-1;let P=-1;-1!==this.gXa&&(D=this.hSd(this.gXa),P=this.yOd(this.gXa));for(;D!==v||P!==h;)if(D<v)this.onj(++D,P,!0);else D>v?(this.onj(D,P,!1),D--):P<h?this.Okj(++P,D,!0):P>h&&(this.Okj(P,D,!1),P--);this.yyf?this.yyf.eoj(this.R5h(v+1,h+1)):(v=(h=this.control.v9e)&&0<h.length?h[0]:null,D=this.vk,u.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",
{["CtrlComps"]:!!h,["FirstComp"]:!!v,["FirstCompPar"]:!!v&&!!v.parent,["DispComp"]:!!D,["DispCompPar"]:!!D&&!!D.parent}));this.gXa=b}}onj(b,h,v){for(let D=0;D<=h;D++)this.Gkj(b,D,v)}Okj(b,h,v){for(let D=0;D<=h;D++)this.Gkj(D,b,v)}Gkj(b,h,v){h=b*Sm.a.o_c+h;b=this.LGb[h];h=this.N0c[h];v?(b.className="cui-it-activeCell",h.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",h.className="cui-it-inactiveCellOuter")}pTf(b){this.Yw(b.xf,b.lg,b.Hb);return!0}w7b(b){for(;b.hasChildNodes();)b=
b.childNodes[0];return nf.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}foj(b){const h=this.grf(b);b.childNodes[0].childNodes[0].title=this.R5h(this.hSd(h)+1,this.yOd(h)+1)}R5h(b,h){let v=this.properties.Alt;nf.c(v)&&(v=this.properties.MenuSectionTitle);return v=String.format(v,h.toString(),b.toString())}Ghc(){if(this.vk){for(var b=0;b<Sm.a.Cec;b++)this.LGb[b].className="cui-it-inactiveCell",this.N0c[b].className="cui-it-inactiveCellOuter";this.gXa=-1;b=this.properties.MenuSectionInitialTitle;
nf.c(b)&&(b="");this.yyf.eoj(b)}}oTf(b){this.control.enabled&&(b=this.w7b(b.xf),this.m7c(b),this.Xff(b));return!1}Xff(b){this.foj(b);this.Tli(b)}nTf(b){if(!this.control.enabled)return!1;b=this.w7b(b.xf);this.foj(b);this.Tli(b);return!1}Pnn(b){Dd.a.wFf(this.I$b.iXd.Lm,b.clientPoint)||this.Ghc();return!1}Omn(b){if(!this.control.enabled)return!1;b=this.w7b(b.xf);this.Xff(b);return!0}Rnn(b){if(!this.control.enabled)return!1;b=Dd.a.pPd(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=
this.w7b(b))?this.Xff(b):this.Ghc();return!0}Qnn(b){if(!this.control.enabled)return!1;var h=Dd.a.pPd(b.clientPoint);if(!h||"table"===h.tagName.toLowerCase())return this.Ghc(),!0;(h=this.w7b(h))?this.Yw(h,3,b.Hb):this.Ghc();return!0}SK(b){b=al.Control.Flf(this.gXa,Sm.a.o_c,Sm.a.Cec,b);if(b!==this.gXa)return this.LGb[b].firstChild.focus(),this.Sli(b),!0;this.Ghc();this.gXa=-1;return!1}FY(){const b=this.LGb[0];if(nf.c(b))return!1;b.firstChild.focus();return!0}m7c(b){if(nf.c(b))return!1;b.firstChild.firstChild.focus();
return!0}spa(){this.Ghc()}}Object(n.a)(Sq,"InsertTableBehavior",Ci,[]);class mn extends bj{constructor(b){super(b)}xm(){this.control.enabled=!!this.menu}Yw(b,h,v){w.AFrameworkApplication.va.Qb(Wa.a.SQa,2,h,this.EX(v))}}Object(n.a)(mn,"JewelMenuLauncherBehavior",bj,[]);var cn=c(1062);class $n extends Ci{constructor(b){super(b)}get properties(){return this.control.Eh}xm(){0<(this.ou(this.properties.Command,this.properties.QueryCommand,this.Qd)&2)&&this.g8a()&&this.lUa()}lUa(){this.E_o();this.Dja();
this.dRb()}E_o(){const b=this.control.labelText;let h=this.Qd[cn.a.Value];nf.c(h)&&(h=this.properties.LabelText,nf.c(h)&&(h=""));h!==b&&this.hhe(h)}LI(b){b=b.Lm;nf.c(b)||(Zj.a.instance.nb(Ed.a.pointerDown,b,Object(z.a)(this,this.ZC,"onPointerDown")),Zj.a.instance.nb(Ed.a.pointerOver,b,Object(z.a)(this,this.gP,"onPointerOver")),Zj.a.instance.nb(Ed.a.pointerOut,b,Object(z.a)(this,this.IJ,"onPointerOut")))}}Object(n.a)($n,"LabelBehavior",Ci,[]);var om=c(867),ao=c(210),Rr=c(299);class fs extends bj{constructor(b){super(b);
this.tEe=this.cwe=!1;this.SVb=this.xSb=null;if(this.vWb=w.AFrameworkApplication.K.$("TellMeRedesignIsEnabled"))this.xSb=this.pu.Kia.LightImage16by16Class,this.SVb=this.pu.Kia.DarkImage16by16Class}get pu(){return this.control}X5d(b,h,v,D){h&&(this.pu.lga=v,w.AFrameworkApplication.ta.y6a());if(Object(rb.a)(ao.a,b)&&D){v=new om.a;v.CommandLocation=this.root.J9;v.InvocationMethod=0;const P={};(b=b.control)&&b.Eh&&(P.CommandId=b.Eh.Command,P.ControlId=b.Eh.Id,P.CloseAllMenus=h,b.WH&&b.WH.parent&&b.WH.parent.id&&
(P.ParentControlId=b.WH.parent.id.split("-")[0]),this.root.xF&&this.root.xF.sOa(D,P,v))}}mua(){this.pu.lga||(this.pu.lga=this.pu.uy);!this.pu.yfn&&this.vWb&&(Cg.a.Aw(this.pu.uy,"cui-sb-focus"),Cg.a.Aw(this.pu.p1,"cui-sb-focus"),Cg.a.Aw(this.pu.yya,this.xSb),Cg.a.Yf(this.pu.yya,this.SVb));this.cwe=!0;super.mua();this.cwe=!1;this.O2f()}get crj(){return!this.pu.dSa}I7d(){this.pu.I7d()}Fce(){this.tEe||this.cwe||(this.tEe=!0,this.pu.raiseEvent(Rr.a.y2a,null))}O2f(){this.iL||this.pu.uAf||(this.tEe=!1,this.pu.raiseEvent(Rr.a.cHb,
null))}AUf(b){Cg.a.Aw(this.pu.uy,"cui-sb-focus");Cg.a.Aw(this.pu.p1,"cui-sb-focus");this.vWb&&!this.pu.iL&&(Cg.a.Aw(this.pu.yya,this.xSb),Cg.a.Yf(this.pu.yya,this.SVb));this.pu.raiseEvent(Rr.a.blur,b);this.O2f();this.pu.lga=this.pu.uy;return!1}BUf(b){Cg.a.Yf(this.pu.uy,"cui-sb-focus");Cg.a.Yf(this.pu.p1,"cui-sb-focus");this.vWb&&(Cg.a.Aw(this.pu.yya,this.SVb),Cg.a.Yf(this.pu.yya,this.xSb));this.pu.raiseEvent(Rr.a.focus,b);this.Fce();return!1}cWf(){this.vWb&&(Cg.a.Yf(this.pu.p1,"cui-sb-hover"),Cg.a.Yf(this.pu.uy,
"cui-sb-hover"),Cg.a.Aw(this.pu.yya,this.SVb),Cg.a.Yf(this.pu.yya,this.xSb));return!1}bWf(){this.vWb&&(Cg.a.Aw(this.pu.p1,"cui-sb-hover"),Cg.a.Aw(this.pu.uy,"cui-sb-hover"),this.pu.iL||this.pu.uAf||(Cg.a.Aw(this.pu.yya,this.xSb),Cg.a.Yf(this.pu.yya,this.SVb)));return!1}}Object(n.a)(fs,"SearchBoxBehavior",bj,[547,545]);class Jn{}Jn.Value="value";Jn.MinValue="MinValue";Jn.MaxValue="MaxValue";Jn.Text="Text";Object(n.a)(Jn,"SliderCommandProperties",null,[]);class Cq extends Ci{constructor(b){super(b)}get ufg(){return this.control}get r5(){return this.ufg.r5}get properties(){return this.control.Eh}initialize(){}Yw(){}LI(b){b=
b.ur;Yf.a.instance.nb(Ed.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Yf.a.instance.nb(Ed.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Yf.a.instance.nb(Ed.a.change,b,Object(z.a)(this,this.Ica,"onChange"));Yf.a.instance.nb(Ed.a.input,b,Object(z.a)(this,this.Ica,"onChange"))}onFocus(b){this.r5.Lm&&Sys.UI.DomElement.addCssClass(this.r5.Lm,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.r5.Lm&&Sys.UI.DomElement.removeCssClass(this.r5.Lm,"cui-sldr-onfocus");return super.onBlur(b)}Ica(){this.j3k(this.r5.ur.value);
return!0}j3k(b){this.Qd[Jn.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Qd,this.vk,0,!1)}xm(){const b=this.Qd[Jn.Value],h=this.Qd[Jn.MaxValue],v=this.Qd[Jn.Text];var D=this.ou(this.properties.Command,this.properties.QueryCommand,this.Qd);this.r5&&this.r5.ur&&(this.r5.ur.disabled=!this.control.enabled);if(0<(D&2)){D=this.Qd[Jn.Value];const P=this.Qd[Jn.MaxValue],ca=this.Qd[Jn.Text];(P!==h||D!==b||v!==ca)&&this.r5&&this.r5.ur&&(this.r5.ur.setAttribute(cf.a.oBd,String.format("{0}",
P)),this.r5.ur.setAttribute("max",String.format("{0}",P)),this.r5.ur.value=D,this.r5.uO.innerText=this.Qd[Jn.Text])}}}Object(n.a)(Cq,"SliderBehavior",Ci,[]);var mj=c(1386);class Ms extends Ci{constructor(b){super(b);this.Xpd=0;this.hdb=null;this.ond=!1;this.clh=null;this.pTe=!1;this.Zsd=this.srd=-1;this.UAa=!1}get spinner(){return this.control}get OG(){return this.spinner.OG}get properties(){return this.control.Eh}initialize(){const b=this.spinner.sog;this.clh=this.sSo(b);this.Xpd=b[0].min;this.hdb=
b[0];this.ond=!1}Yw(){}LI(b){const h=b.ur,v=b.O5b;b=b.LKc;Yf.a.instance.nb(Ed.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));Yf.a.instance.nb(Ed.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur"));Xb.KeyInputManager.instance.nb(Ed.a.ai,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Xb.KeyInputManager.instance.nb(Ed.a.ju,h,Object(z.a)(this,this.HG,"onKeyPress"));Xb.KeyInputManager.instance.nb(Ed.a.uh,h,Object(z.a)(this,this.Dy,"onKeyUp"));Yf.a.instance.nb(Ed.a.change,h,Object(z.a)(this,this.Ica,
"onChange"));xf.a.instance.nb(Ed.a.Eca,h,Object(z.a)(this,this.CUf,"onInputMouseUp"));Zj.a.instance.nb(Ed.a.pointerDown,v,Object(z.a)(this,this.wTi,"onArrowPointerDown"));Zj.a.instance.nb(Ed.a.pointerDown,b,Object(z.a)(this,this.wTi,"onArrowPointerDown"));Zj.a.instance.nb(Ed.a.WM,v,Object(z.a)(this,this.xTi,"onArrowPointerUp"));Zj.a.instance.nb(Ed.a.WM,b,Object(z.a)(this,this.xTi,"onArrowPointerUp"));nm.a.instance.nb(Ed.a.xP,v,Object(z.a)(this,this.zTi,"onArrowTouchMove"));nm.a.instance.nb(Ed.a.xP,
b,Object(z.a)(this,this.zTi,"onArrowTouchMove"));nm.a.instance.nb(Ed.a.XJ,v,Object(z.a)(this,this.yTi,"onArrowTouchEnd"));nm.a.instance.nb(Ed.a.XJ,b,Object(z.a)(this,this.yTi,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);Cg.a.Yf(this.OG.Lm,"cui-spn-focus");this.control.enabled&&Dd.a.A6c(this.OG.ur);return this.UAa=!1}onBlur(b){super.onBlur(b);Cg.a.Aw(this.OG.Lm,"cui-spn-focus");return!1}onKeyDown(b){let h=!1;if(!nf.c(b.Hb)&&!nf.c(b.Hb.rawEvent)){const v=b.Hb.keyCode,D=b.Hb.rawEvent.shiftKey;if(v===
Sys.UI.Key.up||v===Sys.UI.Key.down)this.root.JCf(this.control)||this.Mvj(v===Sys.UI.Key.up,b.lg),h=!0;else if(v===Sys.UI.Key.enter)this.mT(),Object(rb.a)(Bh.Ribbon,this.root)&&this.root.r_(),h=!0;else if(v===Sys.UI.Key.tab)this.mT(),Object(rb.a)(Bh.Ribbon,this.root)&&(h=this.root.Vpe(this.vk.Nc,!D));else if(v===Sys.UI.Key.esc)this.Ihc(),Object(rb.a)(Bh.Ribbon,this.root)&&this.root.r_(),h=!0;else if(v===Sys.UI.Key.backspace||v===Sys.UI.Key.del)h=!this.control.enabled}return h}HG(){return!this.control.enabled}Dy(){this.cil();
return!1}Ica(){this.mT();return!1}CUf(){return this.UAa?!1:this.UAa=!0}wTi(b){var h=!1;let v=!0;2===b.lg&&(v=b.Cca===Sys.UI.MouseButton.leftButton);v&&(h=b.xf,this.Mvj(h===this.OG.O5b||h===this.OG.GVh||h===this.OG.FVh,b.lg),h=!0);return h}xTi(b){return this.Rua(b)}zTi(b){return this.v6d(b)}yTi(b){return this.Rua(b)}$wm(b){if(this.control.enabled){var h=!1;if(!this.ond){var v=this.g0l(b);v=b?v+this.hdb.step:v-this.hdb.step;v=Math.min(v,this.hdb.max);v=Math.max(v,this.hdb.min);v!==this.Xpd&&(this.j9e(v,
this.hdb),this.root.executeCommand(this.properties.Command,this.Qd,this.vk,0,!1),h=!0)}h||(h=this.properties.SpinCommand,v=this.Qd,v.Increment=b,nf.c(h)||this.root.executeCommand(h,v,this.vk,0,!1))}}g0l(b){const h=Math.pow(10,w.AFrameworkApplication.numberFormat.d6d),v=Math.round(this.hdb.step*h);let D=Math.round(this.Xpd*h)/v;D=b?Math.floor(D):Math.ceil(D);return D*v/h}Mvj(b,h){if(this.control.enabled){this.mT();const v=b?this.OG.O5b:this.OG.LKc;switch(h){case 2:case 3:this.pTe=b;this.Tyd(v);break;
case 1:this.pTe=b,this.Rqk(v)}}}rwj(){this.wBh();this.oUk()}rQh(){-1===this.srd&&(this.srd=window.setTimeout(Object(z.a)(this,this.p4n,"repeatSpin"),500))}wBh(){this.srd=Cg.a.BAb(this.srd)}p4n(){this.wBh();-1===this.Zsd&&(this.Zje(),this.Zsd=window.setInterval(Object(z.a)(this,this.Zje,"spin"),50))}oUk(){this.Zsd=Cg.a.kUk(this.Zsd)}Zje(){this.$wm(this.pTe)}Rqk(b){this.root.Dfa(this.control,!1);Cg.a.Yf(b,al.Control.Wyd);this.Zje();this.rQh()}cil(){this.root.tba(this.control,!1);this.rwj();Cg.a.Aw(this.OG.O5b,
al.Control.Wyd);Cg.a.Aw(this.OG.LKc,al.Control.Wyd)}kjc(b){this.OG.ur.value!==b&&(this.OG.ur.value=b)}Ihc(){this.kjc(this.Qd[mj.a.Text])}dlj(b){this.kjc(b);this.Qd[mj.a.Text]=b;this.ond=!0}pio(b,h,v){this.kjc(v);this.Qd[mj.a.Text]=v;this.Qd[mj.a.Number]=b;this.Qd[mj.a.UnitType]=h.type;this.Xpd=b;this.hdb=h;this.OG.ur.setAttribute(cf.a.M2e,v);this.OG.ur.setAttribute(cf.a.xvh,String.format("{0}",h.min));this.OG.ur.setAttribute(cf.a.oBd,String.format("{0}",h.max));this.ond=!1}ZGh(b){var h;if(({Iin:h}=
this.wTm(b)).returnValue)this.dlj(h);else{({number:b,T7a:h}=G.a.L0i(b,this.clh,w.AFrameworkApplication.numberFormat));let v=this.Gne(h);0===h&&nf.c(v)&&(v=this.Gne(this.Qd[mj.a.UnitType]));this.j9e(b,v)}}j9e(b,h){b=this.zRf(b,h);if(isNaN(b)||nf.c(h))this.Ihc();else{const v=w.AFrameworkApplication.numberFormat;let D;D=G.a.eEa(b,h.type,v);D=D.replace(6===h.type?v.e6d:v.bZf,"");this.pio(b,h,D)}}wTm(b){let h,v=!1;h="";b=b.trim();const D=this.spinner.KJj;if(!nf.c(D))for(let P=0;P<D.length;P++)if(D[P].toLowerCase()===
b.toLowerCase()){h=D[P];v=!0;break}return{returnValue:v,Iin:h}}zRf(b,h){return isNaN(b)||nf.c(h)?Number.NaN:h.zRf(b)}Gne(b){let h=null;const v=this.spinner.sog;for(let D=0;D<v.length;D++)if(v[D].type===b){h=v[D];break}return h}sSo(b){const h=b.length,v=Array(h);for(let D=0;D<h;D++)v[D]=b[D].type;return v}mT(){if(this.control.enabled){const b=this.Qd[mj.a.Text],h=this.OG.ur.value;h!==b&&(this.ZGh(h),this.Qd[mj.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Qd,this.vk,0,!1))}else this.Ihc()}xm(){var b=
this.Qd[mj.a.Text],h=this.Qd[mj.a.Number];const v=this.Qd[mj.a.UnitType],D=this.Qd[mj.a.MaxValue];if(0<(this.ou(this.properties.Command,this.properties.QueryCommand,this.Qd)&2)){const P=this.Qd[mj.a.Text],ca=this.Qd[mj.a.Number],ta=this.Qd[mj.a.UnitType],Ra=this.Qd[mj.a.MaxValue];Ra!==D&&(this.Gne(ta).max=Ra,this.OG.ur.setAttribute(cf.a.oBd,String.format("{0}",Ra)));P!==b?""===P?this.dlj(P):this.ZGh(P):isNaN(ca)||ca===h&&ta===v||this.j9e(ca,this.Gne(ta));b=this.OG.Lm.title;h=Cg.a.hra(this.Qd[mj.a.Alt],
this.properties.Alt);h!==b&&(this.OG.ur.title=h,this.OG.O5b.title=h,this.OG.LKc.title=h)}}OYe(b){super.OYe(b);b?(this.Zje(),this.rQh()):this.rwj()}}Object(n.a)(Ms,"SpinnerBehavior",Ci,[546,545]);var zm=c(405),wh=c(881);class wi extends bj{constructor(b){super(b);this.tXb=!0;this.Srb=!1}get u5(){return this.control}get kt(){return this.u5.properties}LI(b){const h=b.Lm,v=b.jgb;b=b.NKc;Yf.a.instance.nb(Ed.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));Yf.a.instance.nb(Ed.a.blur,h,Object(z.a)(this,
this.onBlur,"onBlur"));Xb.KeyInputManager.instance.nb(Ed.a.ai,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Xb.KeyInputManager.instance.nb(Ed.a.uh,h,Object(z.a)(this,this.Dy,"onKeyUp"));aa.a.iu&&16>this.WVl()&&(Zj.a.instance.nb(Ed.a.pointerDown,h,Object(z.a)(this,this.mYi,"onSplitbuttonPointerDownPointerUp")),Zj.a.instance.nb(Ed.a.WM,h,Object(z.a)(this,this.mYi,"onSplitbuttonPointerDownPointerUp")));Zj.a.instance.nb(Ed.a.pointerOver,v,Object(z.a)(this,this.zmn,"onButtonPointerOver"));Zj.a.instance.nb(Ed.a.pointerOut,
v,Object(z.a)(this,this.ymn,"onButtonPointerOut"));Zj.a.instance.nb(Ed.a.pointerDown,v,Object(z.a)(this,this.OTi,"onButtonPointerDown"));Zj.a.instance.nb(Ed.a.WM,v,Object(z.a)(this,this.PTi,"onButtonPointerUp"));nm.a.instance.nb(Ed.a.xP,v,Object(z.a)(this,this.Bmn,"onButtonTouchMove"));nm.a.instance.nb(Ed.a.XJ,v,Object(z.a)(this,this.Amn,"onButtonTouchEnd"));Zj.a.instance.nb(Ed.a.pointerDown,b,Object(z.a)(this,this.aVf,"onMenuButtonPointerDown"));Zj.a.instance.nb(Ed.a.pointerOver,b,Object(z.a)(this,
this.xrn,"onMenuButtonPointerOver"));Zj.a.instance.nb(Ed.a.pointerOut,b,Object(z.a)(this,this.wrn,"onMenuButtonPointerOut"))}Yw(b,h,v){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.Srb&&(this.u5.on=!this.u5.on,b=this.Qd,b.CommandValueId=this.control.fEb(),this.root.executeCommand(this.kt.Command,b,this.vk,h,!0,null,this.EX(v))):this.tXb&&super.Yw(b,h,v)}Dy(b){const h=b.Hb.keyCode;return h===Sys.UI.Key.enter||h===Sys.UI.Key.space?(b=this.Qd,b.CommandValueId=this.control.fEb(),this.root.executeCommand(this.kt.Command,
b,this.vk,1,!0),!0):super.Dy(b)}xm(){const b=this.root.Mpa(this.kt.Command,this.kt.QueryCommand,this.Qd),h=0<(b&1);let v=!0;v=nf.c(this.kt.CommandMenuOpen)?h:0<(this.root.Mpa(this.kt.CommandMenuOpen,null,null)&1);if(v!==this.tXb||h!==this.Srb||(v||h)!==this.control.enabled)this.control.enabled=v||h,h!==this.Srb&&this.Non(h),v!==this.tXb&&this.Oon(v),this.tXb=v,this.Srb=h;if(0<(b&2)){this.Dja();const D=Cg.a.hra(this.Qd[wh.a.LabelText],this.kt.LabelText);this.Qd[wh.a.ApplyLabelTextToControlOnly]?this.u5.V6b(P=>
{P.Lm.title=D;P.jgb.removeAttribute("title");P.NKc.removeAttribute("title")}):this.u5.V6b(P=>{P.jgb.title=D});this.Qd[wh.a.EnsureControlRoleIsButton]&&this.u5.V6b(P=>{cf.a.hr(P.Lm,cf.a.qh,cf.a.j3)});nf.c(this.Qd[wh.a.Visible])||this.g8a()&&this.lUa()}this.u5.setState(this.u5.on&&h)}lUa(){this.Umg();this.dRb();this.Dja()}Oon(b){this.u5.V6b(h=>{Cg.a.uob(h.NKc,b)});this.y4c();this.tXb=b}Non(b){this.u5.V6b(h=>{Cg.a.uob(h.jgb,b)});this.y4c();this.Srb=b}y4c(){const b=this.u5.Ehb();nf.c(b)||(Cg.a.Aw(b.childNodes[0],
"cui-ctl-split-hovered-primary"),Cg.a.Aw(b.childNodes[0],"cui-ctl-split-hovered-secondary"),Cg.a.Aw(b.childNodes[1],"cui-ctl-split-hovered-primary"),Cg.a.Aw(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}mYi(b){if(0!==zm.a(b.Hb))return!1;let h=!1;b.eventName===Ed.a.pointerDown?h=this.OTi(b):b.eventName===Ed.a.WM&&(h=this.PTi(b));return h}OTi(b){let h=!1;const v=b.lg;switch(v){case 3:this.Xvo()?this.Yw(this.vk.Nc,v,b.Hb):this.Tyd(this.u5.cTh);h=!0;break;case 2:b.Cca===Sys.UI.MouseButton.leftButton&&
(this.Tyd(this.u5.cTh),h=!0)}h&&b.Hb.preventDefault();return!1}Xvo(){const b=this.vk.zT;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}PTi(b){return this.Rua(b)}Bmn(b){return this.v6d(b)}Amn(b){return this.Rua(b)}onFocus(b){super.onFocus(b);this.myf(!0,!0);return!1}onBlur(b){super.onFocus(b);this.y4c();return!1}zmn(){this.control.enabled&&this.Srb&&this.myf(!0,this.u5.on);return!1}ymn(){this.control.enabled&&this.Srb&&this.y4c();return!1}aVf(b){let h=!1;if(2!==b.lg||b.Cca===Sys.UI.MouseButton.leftButton)this.Yw(b.xf,
b.lg,b.Hb),h=!0;h&&b.Hb.preventDefault();return!1}xrn(){this.control.enabled&&this.tXb&&this.myf(this.u5.on,!0);return!1}wrn(){this.y4c();return!1}myf(b,h){const v=this.control.Ehb();nf.c(v)||(Cg.a.Yf(v.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),Cg.a.Yf(v.childNodes[1],h?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}WVl(){var b=aa.a.D5b;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(n.a)(wi,"SplitButtonBehavior",bj,[]);
var Kn=c(1391);class vl extends Ci{constructor(b){super(b);this.zub=this.UAa=!1;this.U2j=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("ExcelTableRenameEnabled")}get textBox(){return this.control}get Gda(){return this.textBox.Gda}get Eig(){return this.textBox.Eh}LI(b){b=b.ur;Yf.a.instance.nb(Ed.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Yf.a.instance.nb(Ed.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Xb.KeyInputManager.instance.nb(Ed.a.ai,b,Object(z.a)(this,this.onKeyDown,
"onKeyDown"));Xb.KeyInputManager.instance.nb(Ed.a.ju,b,Object(z.a)(this,this.HG,"onKeyPress"));Xb.KeyInputManager.instance.nb(Ed.a.uh,b,Object(z.a)(this,this.Dy,"onKeyUp"));Yf.a.instance.nb(Ed.a.change,b,Object(z.a)(this,this.Ica,"onChange"));xf.a.instance.nb(Ed.a.Eca,b,Object(z.a)(this,this.IRa,"onMouseUp"))}onFocus(b){super.onFocus(b);this.zub=!0;Cg.a.Yf(this.Gda.Lm,"cui-tb-focus");this.control.enabled&&Dd.a.A6c(this.Gda.ur);return this.UAa=!1}onBlur(b){this.zub=!1;super.onBlur(b);Cg.a.Aw(this.Gda.Lm,
"cui-tb-focus");return!1}onKeyDown(b){let h=super.onKeyDown(b);if(!nf.c(b.Hb)&&!nf.c(b.Hb.rawEvent)){const v=b.Hb.keyCode,D=b.Hb.rawEvent.shiftKey;v===Sys.UI.Key.tab?(this.mT(),Object(rb.a)(Bh.Ribbon,this.root)&&(h=this.root.Vpe(this.vk.Nc,!D))):v===Sys.UI.Key.enter?this.U2j&&(this.mT(),Object(rb.a)(Bh.Ribbon,this.root)&&this.root.r_(),h=!0):v===Sys.UI.Key.esc?(this.Ihc(),Object(rb.a)(Bh.Ribbon,this.root)&&this.root.r_(),h=!0):v===Sys.UI.Key.backspace||v===Sys.UI.Key.del?h=!this.control.enabled:b.pua&&
(Le.a.tBh(b.Hb),h=!1)}return h}HG(){return!this.control.enabled}Dy(){return!1}Ica(){this.mT();return!1}IRa(){return this.Gda.isEditable?this.UAa?!1:this.UAa=!0:(Dd.a.A6c(this.Gda.ur),!0)}kjc(b){this.Gda.ur.value!==b&&(this.Gda.ur.value=b)}Ihc(){this.kjc(this.Qd[Kn.a.Text])}mT(){if(this.control.enabled&&this.Gda.isEditable){const b=this.Gda.ur.value;b!==this.Qd[Kn.a.Text]&&(this.Qd[Kn.a.Text]=b,this.root.executeCommand(this.Eig.Command,this.Qd,this.vk,0,!1))}else this.Ihc()}xm(){const b=this.Qd[Kn.a.Text];
if(0<(this.ou(this.Eig.Command,this.Eig.QueryCommand,this.Qd)&2)&&!this.zub){const h=this.Qd[Kn.a.Text];h!==b&&this.kjc(h)}}}Object(n.a)(vl,"TextBoxBehavior",Ci,[544,545]);var Ho=c(385);class kq extends Ci{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.Eh}Yw(b,h,v){this.control.enabled&&(Cg.a.oha(this.properties.TogglesWhenExecuted)||this.toggle(),this.Qd.CommandValueId=this.toggleButton.fEb(),this.Qd.MenuItemId=this.toggleButton.Eh.MenuItemId,
this.Qd.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Qd,this.vk,h,!Cg.a.oha(this.properties.CloseMenuWhenExecuted),D=>{Cg.a.Vr(this.properties.UpdateHtmlPostToggle)&&(32===D?this.tAj():this.rAj())},this.EX(v)))}rAj(){this.Qd[If.a.On]=!this.Qd[If.a.On]}tAj(){this.toggleButton.setState(this.Qd[If.a.On]);(this.toggleButton.lza&&this.toggleButton.Poe||Cg.a.Vr(this.properties.UpdateHtmlPostToggle))&&this.lUa()}toggle(){this.rAj();Cg.a.Vr(this.properties.UpdateHtmlPostToggle)||
this.tAj()}onKeyDown(b){const h=super.onKeyDown(b);if(!h&&!nf.c(b.Hb)&&this.WH){const v=b.Hb.keyCode;v!==Sys.UI.Key.enter&&v!==Sys.UI.Key.space||b.Hb.preventDefault()}return h}xm(){nf.c(this.properties.MenuItemId)||(this.Qd.MenuItemId=this.properties.MenuItemId);0<(this.ou(this.properties.Command,this.properties.QueryCommand,this.Qd)&2)&&this.g8a()&&this.lUa()}lUa(){this.toggleButton.setState(this.Qd[If.a.On]);this.ZVo(Cg.a.hra(this.Qd[If.a.DisplayMode],""));this.Umg();this.Dja();this.KXo();If.a.Alt in
this.Qd&&this.dRb()}KXo(){const b=this.XE.Lcc;if(b&&b.kgb){var h=Cg.a.hra(this.Qd[If.a.Description],this.properties.Description);h!==b.kgb.innerText&&(b.kgb.innerText=h,b.uO&&!Object(rb.a)(Ho.Jewel,this.root)&&(h=!nf.b(h),Cg.a.F5(b.uO,"UIFontBold",h),Cg.a.F5(b.uO,"cui-ctl-mediumlabel-nodescription",!h)))}}LI(b){b=b.Lm;Yf.a.instance.nb(Ed.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Yf.a.instance.nb(Ed.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Zj.a.instance.nb(Ed.a.pointerOver,b,Object(z.a)(this,
this.gP,"onPointerOver"));Zj.a.instance.nb(Ed.a.pointerOut,b,Object(z.a)(this,this.IJ,"onPointerOut"));Xb.KeyInputManager.instance.nb(Ed.a.ai,b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Xb.KeyInputManager.instance.nb(Ed.a.uh,b,Object(z.a)(this,this.Dy,"onKeyUp"));Zj.a.instance.nb(Ed.a.pointerDown,b,Object(z.a)(this,this.ZC,"onPointerDown"));Zj.a.instance.nb(Ed.a.WM,b,Object(z.a)(this,this.Axa,"onPointerUp"));Th.a.instance.nb(Ed.a.click,b,Object(z.a)(this,this.onClick,"onClick"));nm.a.instance.nb(Ed.a.xP,
b,Object(z.a)(this,this.Dmb,"onTouchMove"));nm.a.instance.nb(Ed.a.XJ,b,Object(z.a)(this,this.CGa,"onTouchEnd"))}}Object(n.a)(kq,"ToggleButtonBehavior",Ci,[]);class sp{constructor(b){this.p_j=b;this.PAe={["Button"]:h=>new jr(h),["FileMenuButton"]:h=>new jr(h),["ColorPicker"]:h=>new yb(h),["ComboBox"]:h=>new Pl(h),["ContextMenuControl"]:h=>new Km(h),["ContextMenuLauncher"]:h=>new Km(h),["DialogMenuLauncher"]:h=>new Di(h),["DropDown"]:h=>new yj(h),["FlyoutAnchor"]:h=>new Go(h),["GalleryButton"]:h=>new kr(h),
["StatefulColorFlyoutAnchor"]:h=>new Go(h),["JewelMenuLauncher"]:h=>new mn(h),["Label"]:h=>new $n(h),["Placeholder"]:h=>new Ci(h),["SearchBox"]:h=>new fs(h),["Separator"]:h=>new Ci(h),["SplitButton"]:h=>new wi(h),["StatefulColorSplitButton"]:h=>new wi(h),["StatefulImageSplitButton"]:h=>new wi(h),["TextBox"]:h=>new vl(h),["ToggleButton"]:h=>new kq(h)}}dWh(){this.PAe[al.Control.Osi]=b=>new Sq(b)}Khf(){this.PAe[al.Control.Kuj]=b=>new Ms(b)}uOl(b){const h=this.PAe[b.controlType];(b=h?h(b):null)&&this.p_j&&
b.Rul();return b}static get instance(){return sp._instance||(sp._instance=new sp(!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("CUICommitChangeFixIsEnabled")))}}sp._instance=null;Object(n.a)(sp,"ControlBehaviorFactory",null,[511]);var lq=c(977),nn=c(146);class ck extends vj.MenuLauncher{constructor(b,h,v,D){super(b,h,v,D);this.T4g=null;this.JMa=this.pDc=0;this.xF=null;this.Dwc=this.Cwc=0;this.ih("Menu");this.enabled=!0}get x(){return this.pDc}get y(){return this.JMa}get dJf(){return this.Cwc}get eJf(){return this.Dwc}get controlType(){return"DialogMenuLauncher"}A6a(){}Y7a(){}Fof(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.kt.DialogMoveCommand;b.DialogCloseCommand=this.kt.DialogCloseCommand;return b}XYm(b,h){this.pDc=b.x;this.JMa=b.y;this.Cwc=b.height;this.Dwc=b.width;this.f0(h)}AQ(b){this.T4g=Cg.a.createElement("span");return new nn.a(b,this.T4g)}get kt(){return this.Eh}uua(b,h,v){return new ck(b,this.id,h,v)}}Object(n.a)(ck,"DialogMenuLauncher",vj.MenuLauncher,[]);var jk=c(812);class Hi extends lq.a{constructor(b,h){super(b,h);this.b9a=null}get RYe(){return this.b9a}get NRh(){return this.properties}get J9(){return 20}ym(){super.ym();
nf.c(this.Nc)&&this.GC();this.Nc=Cg.a.ASa(this.Nc);this.QW(this.Nc);this.dirty=!1}wO(b){if(!Object(rb.a)(jk.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}Haf(b,h,v,D){v=new ke.Menu(this,h,v,D,null);b||(b={});b.CommandMenuOpen=this.NRh.CommandMenuOpen;b.CommandMenuClose=this.NRh.CommandMenuClose;b=new ck(this,h,b,v);this.LBb[h]=b;h=new jk.a(this,"dock"+h);h.Af(b.BQ("Menu"));this.Af(h);this.refresh()}qeg(b,h,v,D){const P=this.LBb[b];if(nf.c(P))throw Error.create('The dialog menu "'+
b+'" does not exist');P.XYm(new Sys.UI.Bounds(h,v,0,0),D);this.b9a=P.menu}q8e(b){b=this.LBb[b];nf.c(b)||(b.mua(),this.b9a=null)}J7d(){this.b9a=null}dispose(){const b=this.LBb;for(let h in b)b[h].dispose();super.dispose()}}Object(n.a)(Hi,"DialogMenuRoot",lq.a,[]);class Uh{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(n.a)(Uh,"RootProperties",null,[]);class en extends Uh{constructor(){super()}}Object(n.a)(en,"StandaloneRootProperties",Uh,[]);class mq extends en{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(n.a)(mq,"DialogMenuRootProperties",en,[]);class og{constructor(){const b=new mq;b.ImageSideArrow=w.AFrameworkApplication.Ws;b.ImageSideArrowClass=Xc.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=w.AFrameworkApplication.isRtl?"rtl":"ltr";this.Ed=new Hi("DialogMenuRootId",b);this.Ed.xF=this;this.Ed.refresh();w.AFrameworkApplication.va.eb(Wa.a.VZf,ud.a.frame,Object(z.a)(this,this.VZf,"populateDialogMenu"),96)}get l1(){return this.Ed}sOa(b,h,v,D,P=null){b=parseInt(b);D=w.AFrameworkApplication.va;
v&&(D.xC=v.CommandLocation,D.X_=v.InvocationMethod);h=D.Qb(b,2,h,P);this.Ed.refresh();return 32===h}FFa(b){return b?32===w.AFrameworkApplication.va.processAction(parseInt(b),1):!0}ou(){this.l1.root.xm()}Haf(b,h,v){const D={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};D.DialogMoveCommand=h;D.DialogCloseCommand=v;this.l1.Haf(D,b,"","")}qeg(b,h,v,D){this.l1.qeg(b,h,v,D)}q8e(b){this.l1.q8e(b)}VZf(b,h,v,D,P){if(1===v)return 32;b=new Sys.StringBuilder;
b.append('<Menu Id="dialogMenu">');b.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');b.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',P.DialogMoveCommand,CommonUIStrings.l_DialogMove));b.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',P.DialogCloseCommand,CommonUIStrings.l_DialogClose));b.append("</Controls></MenuSection>");b.append("</Menu>");P.PopulationXML=b.toString();return 32}dispose(){this.Ed&&
(this.Ed.dispose(),this.Ed=null)}}Object(n.a)(og,"DialogMenuRootUser",null,[332,10,461]);class Tq{constructor(b,h,v){this.zsb=this.svd=this.Fxc=this.vl=null;this.zEe=this.Iud=!1;this.Gtc=b;this.ae=h;this.hs=v;this.uWb=w.AFrameworkApplication.isRtl}get vzf(){return this.zEe}Bxl(b){b?(this.vl=b,this.zEe=!0,this.Iud=!1,this.ae.capture(Object(z.a)(this,this.CXm,"keyEventHandler"),null),this.hs.nb(Ed.a.pointerDown,this.Gtc,Object(z.a)(this,this.mgc,"pointerDownHandler")),this.Fxc||this.vcl(),this.vl.appendChild(this.Fxc),
this.Czm()):u.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}ojf(){this.zEe=!1;this.svd=this.zsb=null;this.B0n();this.T4f();this.vl=null}T4f(){this.ae.releaseCapture();this.hs.sc(Ed.a.pointerDown,this.Gtc,Object(z.a)(this,this.mgc,"pointerDownHandler"))}Czm(){if(this.vl.style.left.endsWith("px")&&this.vl.style.right.endsWith("px"))this.zsb=new Sys.UI.Point(hd.a.xY(this.uWb?this.vl.style.right:this.vl.style.left),hd.a.xY(this.vl.style.top));else{const b=this.uWb?this.Gtc.offsetWidth-
(this.vl.offsetLeft+this.vl.offsetWidth+hd.a.xY(this.vl.style.marginRight)):this.vl.offsetLeft-hd.a.xY(this.vl.style.marginLeft),h=this.vl.offsetTop-hd.a.xY(this.vl.style.marginTop);this.Lnj(b,h);this.zsb=new Sys.UI.Point(b,h)}this.svd=this.zsb}vcl(){this.Fxc=Xc.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}B0n(){this.Fxc.parentNode===this.vl&&this.vl.removeChild(this.Fxc)}CXm(b){if(!this.vzf)return!1;b.Hb.preventDefault();if(b.eventName===Ed.a.ai){const h=b.Hb.ctrlKey?
1:10;let v;switch(b.Hb.keyCode){case Ve.a.P5:this.iec(0,-1*h);break;case Ve.a.Oda:this.iec(0,1*h);break;case Ve.a.gnc:v=this.uWb?1:-1;this.iec(v*h,0);break;case Ve.a.Hqb:v=this.uWb?-1:1;this.iec(v*h,0);break;case Ve.a.PIa:this.JPi(this.svd.x,this.svd.y);this.Iud=!0;break;case Ve.a.Fs:this.Iud=!0}}b.eventName===Ed.a.uh&&this.Iud&&this.ojf();return!0}mgc(b){if(!this.vzf)return!1;b.Hb.preventDefault();this.ojf();return!0}iec(b,h){this.JPi(this.zsb.x+b,this.zsb.y+h)}JPi(b,h){b=this.cBk(b,h);this.Lnj(b.x,
b.y);this.zsb=b}Lnj(b,h){this.uWb?this.vl.style.right=b+"px":this.vl.style.left=b+"px";this.vl.style.top=h+"px"}cBk(b,h){const v=this.uWb?hd.a.xY(this.vl.style.marginRight):hd.a.xY(this.vl.style.marginLeft),D=hd.a.xY(this.vl.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-v,b),this.Gtc.offsetWidth-this.vl.offsetWidth-v),Math.min(Math.max(-D,h),this.Gtc.offsetHeight-this.vl.offsetHeight-D))}}Object(n.a)(Tq,"KeyMoveAdapter",null,[462]);var Yp=c(1116),Io=c(557);class kh{get name(){return"CUI.Behavior"}xc(b){w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&(b.register(461,"Common.UI.IDialogMenuRootUser").singleInstance().Rd(()=>new og),b.register(462,"Common.IKeyMoveAdapter").singleInstance().Rd(()=>new Tq(w.AFrameworkApplication.ta.xna(),Xb.KeyInputManager.instance,Zj.a.instance)));b.register(Io.a,"CommandUI.RootManager").as("Common.IRootManager").singleInstance().Rd(()=>Io.a.instance)}init(){Yp.a.B$e=sp.instance;const b=Io.a.instance.bgj;for(let h=0;h<b.length;++h){const v=Object(Na.a)(463,
b[h]);v&&v.mOa()}Sk.a.get_instance().$H(6)}dispose(){}static main(){N.a.instance.Fc(new kh,5)}}Object(n.a)(kh,"CuiBehaviorPackage",null,[1,2]);class Uq{constructor(b){const h=new en;h.ImageUpArrow=h.ImageDownArrow=h.ImageSideArrow=h.ImageCheckMark=h.ImageUncheckMark=h.ImageDownArrow8by8=h.ImageUpArrow8by8=b;h.ImageUpArrowClass=Xc.getImageClass("RibbonUpArrow_5x3x32");h.ImageDownArrowClass=Xc.getImageClass("SplitButtonArrow_5x3x32");h.ImageUpArrow8by8Class=Xc.getImageClass("RibbonUpArrow_8x8x32");
h.ImageDownArrow8by8Class=Xc.getImageClass("SplitButtonArrow_8x8x32");h.ImageSideArrowClass=Xc.getImageClass("SubmenuFlyoutArrow_13x13x32");h.ImageCheckMarkClass=Xc.getImageClass("CheckboxChecked_16x16x32");h.ImageUncheckMarkClass=Xc.getImageClass("CheckboxUnchecked_16x16x32");h.TextDirection=w.AFrameworkApplication.isRtl?"rtl":"ltr";this.Pcb=lq.a.Uel(h);this.Pcb.refresh()}get sda(){return this.Pcb}dispose(){this.Pcb.dispose()}}Object(n.a)(Uq,"StandaloneRootController",null,[849,10]);var Am=c(1143),
Ii=c(159);class Zp{constructor(b){this.bAc=b}create(b,h){const v=new Sys.StringBuilder;this.PIc(v,b,h);this.dbf(v,b);return v.toString()}vfb(b,h){const v=[];this.Pbf(v,b,h);this.ebf(v,b);return v}PIc(b,h,v){switch(h.errorType){case 0:b.append(this.bAc.build());break;case 1:case 2:b.append(this.i5e(h,v))}}Pbf(b,h,v){switch(h.errorType){case 0:b.push(this.bAc.Uyh());break;case 1:case 2:b.push(this.UNk(h,v))}}dbf(b,h){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');
b.append(Ii.a("btnIgrnoreSpellingError",(2===h.errorType?Gb.a.GIa:Gb.a.iwa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null));b.append("</Controls></MenuSection>")}ebf(b,h){const v=Object.assign(new ih.a,{ControlList:[]});h=2===h.errorType?"UnknownSpellingError":"IgnoreSpellingError";v.ControlList.push(Object.assign(new mg.a,{ExternalId:h}));b.push(v)}i5e(b,h){b=this.YKl(b.suggestions,h);return 0<b.length?Ii.g("msUnknownWord",Ii.d(null,b),"Menu16"):Ii.g("msUnknownWord",Ii.d(null,[Ii.a("btnNoSuggestions",
Gb.a.GIa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}YKl(b,h){const v=[];if(b){const D=Math.min(h.length,b.length);for(let P=0;P<D;++P)b[P]&&v.push(Ii.a("btnCorrectWord"+P,h[P].toString(),b[P]))}return v}UNk(b,h){const v=Object.assign(new ih.a,{Id:"Suggestions",ControlList:[]});this.XKl(b.suggestions,h,v.ControlList);0>=v.ControlList.length&&(b=Object.assign(new mg.a,{ExternalId:"NoSuggestions"}),v.ControlList.push(b));return v}XKl(b,h,v){if(b){const D=Math.min(h.length,b.length);
for(let P=0;P<D;++P){if(!b[P])continue;const ca=Object.assign(new mg.a,{ExternalId:"btnCorrectWord"+P,Command:h[P].toString(),LabelText:b[P]});v.push(ca)}}}}Object(n.a)(Zp,"DefaultProofingContextMenuCreator",null,[]);var pg=c(699);class Ln{constructor(b,h){this.HRg=b;this.ITg=h;this.yla=[Gb.a.Npb,Gb.a.Opb,Gb.a.Ppb,Gb.a.$Pb,Gb.a.aQb]}create(b,h){return h?Object(rb.a)(pg.a,h)?this.ITg.create(b,h,this.yla):this.HRg.create(h,this.yla):""}j4b(b,h){return h?Object(rb.a)(pg.a,h)?this.ITg.vfb(b,h,this.yla):
this.HRg.vfb(h,this.yla):null}}Object(n.a)(Ln,"ProofingContextMenuSectionFactory",null,[684]);class Mo{build(){const b=[Ii.a("btnDeleteRepeatedWord",Gb.a.ADa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return Ii.g("msRepeatedWord",Ii.d(null,b),"Menu16")}Uyh(){const b=Object.assign(new ih.a,{ControlList:[]}),h=Object.assign(new mg.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(h);return b}}Object(n.a)(Mo,"ProofingRepeatedWordSectionBuilder",null,[683]);class ws{static get Yg(){return bg.a.vA(ws.Km,
Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}ws.Km="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(n.a)(ws,"AutoCorrectOptionsDialogHTML",null,[]);class Dq{static get Yg(){return bg.a.vA(Dq.Km,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}Dq.Km="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(n.a)(Dq,"AutoCorrectOptionsDialogHTML2",null,[]);class un extends bg.a{constructor(b,h){super();this.lho=(v,D)=>{1!==v?u.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):D.ReplaceTextAsYouType!==this.AV.CSa||D.CapitalizeFirstLetterOfSentences!==this.AV.VCd||D.ReplaceOrdianalsWithSuperscript!==this.AV.fee||D.ReplaceHyphensWithDash!==this.AV.c5c||D.ReplaceFractionsWithFractionCharacter!==this.AV.eee||this.Vea&&D.ReplaceQuoteWithSmartQuote!==
this.AV.W6f?(v={},v.ReplaceTextAsYouType=D.ReplaceTextAsYouType,v.CapitalizeFirstLetterOfSentences=D.CapitalizeFirstLetterOfSentences,v.ReplaceOrdianalsWithSuperscript=D.ReplaceOrdianalsWithSuperscript,v.ReplaceHyphensWithDash=D.ReplaceHyphensWithDash,v.ReplaceFractionsWithFractionCharacter=D.ReplaceFractionsWithFractionCharacter,this.Vea&&(v.ReplaceQuoteWithSmartQuote=D.ReplaceQuoteWithSmartQuote),this.AV.Vao(v),u.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:D.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:D.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:D.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:D.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:D.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.Vea,["ReplaceQuoteWithSmartQuote"]:this.Vea&&D.ReplaceQuoteWithSmartQuote}),Xa.App.xa.updateCommandUI(!0)):u.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes.")};this.AV=b;this.Vea=h;this.wg="AutoCorrectOptionsDialog"}Ieg(){u.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.Yg=this.Vea?Dq.Yg:ws.Yg;const b={};b.ReplaceTextAsYouType=this.AV.CSa;b.CapitalizeFirstLetterOfSentences=this.AV.VCd;b.ReplaceOrdianalsWithSuperscript=this.AV.fee;b.ReplaceHyphensWithDash=this.AV.c5c;b.ReplaceFractionsWithFractionCharacter=this.AV.eee;this.Vea&&(b.ReplaceQuoteWithSmartQuote=
this.AV.W6f);this.Wh(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.lho,b)}}Object(n.a)(un,"AutoCorrectOptionsDialog",bg.a,[682]);class Rn{static get Yg(){return bg.a.vA(Rn.Km,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Rn.Km="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(n.a)(Rn,"AltTextDialogWithDescriptionHtml",null,[]);class Sn{static get Yg(){return bg.a.vA(Sn.Km,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Sn.Km="<div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(n.a)(Sn,"AltTextDialogWithDescriptionNoTitleHtml",null,[]);class io extends bg.a{constructor(b=!1,h=!1){super(!1,!1,b);this.poi=!1;h?(this.poi=!0,this.Yg=Sn.Yg):this.Yg=Rn.Yg;this.wg=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}kaf(b){this.Wh(CommonUIStrings.l_AlternativeTextDialogTitle,Object(z.a)(this,this.ECk,"altTextDialogHandler"),this.Gpf(b));b=document.getElementById(io.a1e)||document.getElementById(io.yAd);b.focus();b.select()}Gpf(b){const h={};this.poi||(h[io.a1e]=this.Cnf(b));
h[io.yAd]=this.VUl(b)||"";return h}Wua(b){return b.xf.id===io.yAd?!1:super.Wua(b)}}io.a1e="titleText";io.yAd="descriptionText";Object(n.a)(io,"BaseAltTextDialogWithDescription",bg.a,[]);var cj=c(32);class $p extends io{constructor(b,h,v,D,P){super();this.yk=h;this.vn=v;this.Us=D;this.Ld=P;this.Lpb=this.qT=null;this.kaf(b)}VUl(b){this.qT=b.node;this.Lpb=cj.TableReader.Zhi(b);return cj.TableReader.Nuf(this.Lpb)}Cnf(b){this.qT=b.node;this.Lpb=cj.TableReader.Zhi(b);return cj.TableReader.Ouf(this.Lpb)}ECk(b,
h){if(1===b){b=cj.TableReader.Ouf(this.Lpb);const v=cj.TableReader.Nuf(this.Lpb),D=h[io.a1e];h=h[io.yAd];this.hide();const P=this.Us.Oc(15);try{P.Cb(this.qT),this.yk.acg(this.Lpb,D),this.yk.Qnj(this.Lpb,h)}finally{P&&P.dispose()}D===b&&h===v||this.Ld.Ns(16)}this.vn.Qo&&this.vn.Tp.VF(this.qT)}}Object(n.a)($p,"TableAltTextDialog",io,[]);class gs{constructor(b,h,v){this.iA=b;this.Ic=h;this.Sd=v}create(b){return new $p(b,this.iA,Xa.App.rd,this.Ic,this.Sd)}}Object(n.a)(gs,"TableAltTextDialogFactory",null,
[]);const jo=()=>{Xa.App.ish=!0;return 32},vn=(b,h,v,D,P)=>{if(1===v)return 32;if(!({point:b,Kx:h}=Ud(P)).returnValue)return 16;Xa.App.xa.Yjc(b,h);return 32},Tm=(b,h,v,D,P)=>{if(1===v)return 32;if(!({point:b,Kx:h}=Ud(P)).returnValue)return 16;Xa.App.xa.dja(b,h);return 32},Ud=b=>{let h=null,v=0;if(!b)return{returnValue:!1,point:h,Kx:v};b=b.split(",");if(3>b.length)return{returnValue:!1,point:h,Kx:v};h=new Sys.UI.Point(parseInt(b[0]),parseInt(b[1]));v=parseInt(b[2]);return{returnValue:!0,point:h,Kx:v}};
var Jo=c(1830);class lr extends Sys.EventArgs{constructor(b,h,v,D,P,ca=0,ta=0,Ra=null){super();this.controlId=b;this.commandId=D;this.time=P;this.commandSurface=ca;this.Kx=ta;this.contentType=Ra}}Object(n.a)(lr,"CommandClickEventArgs",Sys.EventArgs,[]);class Tn{constructor(b,h){this.ksa=b.qpf();this.Wqc=b;this.W8a=h}sOa(b,h,v,D=null,P=null){v&&(this.W8a.xC=v.CommandLocation,this.W8a.X_=v.InvocationMethod,this.W8a.ANa=v.CommandTabName);b=parseInt(b);let ca=this.Wqc.Y8h(b,h,v);ca.vQf&&(ca=this.Wqc.Y8h(ca.aM,
h,v));if(void 0!==ca.b0a&&null!==ca.b0a)return ca.b0a;if(ca.cGb)P=32;else{var ta=null;this.ksa&&this.ksa.p_f&&(ta=this.ksa.p_f(ca,P));ca.xha||ca.JVc?ca.TDa?P=16:(P=this.W8a.Qb(ca.aM,ca.Fbc?2:1,ca.xd,P),2===P&&(P=32)):ca.TDa?P=this.W8a.Qpa(null,ca.aM,ca.xd,Ra=>{D&&D(Ra.response)},P):(P=this.W8a.Qb(ca.aM,2,ca.xd,P),D&&D(P));this.ksa&&this.ksa.k_f&&this.ksa.k_f(ca,P,ta);if(h&&v&&-1!==v.InvocationMethod&&v.InvocationMethod){v=h.LegacyId;if(void 0===v||null===v)v="";ta=h.ParentMenuId;void 0!==ta&&null!==
ta||!h.MenuId||(ta=h.MenuId);let Ra=h.SqmControlId;void 0!==Ra&&null!==Ra||!h.SourceControlId||(Ra=h.SourceControlId);(void 0!==Ra&&null!==Ra||void 0!==ta&&null!==ta)&&Jo.a.wOn(new lr(Ra,v,ta,Oc.ActionManager.Gaa(b),Date.now()))}}ca.xha&&32===P&&this.ksa&&this.ksa.oCa&&this.ksa.oCa(ca,h);ca.JVc&&32===P&&this.ksa&&this.ksa.qZa&&this.ksa.qZa(ca,h);return 32===P||1===P}FFa(b,h=null){if(w.AFrameworkApplication.Nk||Qg.a.instance.Nv)return!1;null!=h&&null!=h.UILocation&&(this.W8a.xC=h.UILocation);const v=
parseInt(b);if(!b||v===Oc.ActionManager.Chf)return!0;b=this.Wqc.O8h(v,h);b.vQf&&(b=this.Wqc.O8h(b.aM,h));if(void 0!==b.b0a&&null!==b.b0a)return b.b0a;v===Wa.a.z0b&&h&&(b.xd=h);return 32===this.W8a.Qb(b.aM,1,b.xd)}clearCache(){this.Wqc.clearCache()}}Object(n.a)(Tn,"GeneralCuiUser",null,[331,332]);var cl=c(193),dl=c(101),fk=c(56),Un=c(1399);class Eq{get lE(){return null!=this.IJg?this.IJg:this.IJg=Ea.a.instance.resolve("Box4.Styles.IWACStyleEditor")}constructor(b,h,v,D){this.YSg="DocumentProofingFailed";
this.jVe=b;this.Cih=h;this.Ved=v;this.vI=D}lcm(){const b=this.vI.t$l(this.jVe);return{returnValue:this.vI.vEa(this.jVe),cLn:b}}JXo(b,h){const v=dl.a.Pr();if(v){var D=new cl.ScriptSharpLegacyMap;D.add(lf.a.gL,b);D.add(Bc.a.noProof,h);b=new eh.GraphTransaction(15);b.Cb(v);this.lE.sRa(fk.StyleReader.wordStyleIdNormal,D,v)?Un.a.MBj():(u.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),Un.a.recordQosError(this.YSg,[Un.a.Fzc],"Style could not be modified"));b.dispose()}else u.ULS.sendTraceTag(555775182,
375,10,"PageContentNode not found"),Un.a.recordQosError(this.YSg,[Un.a.Fzc],"PageContentNode not found")}Kio(b,h){this.JXo(b,h)}Uno(b,h){if(this.Cih){var v=new Md.DictionaryPropertySet;this.Ved.execute(D=>{D.gLc(b)});v.setValue(lf.a.gL,b);v.setValue(Bc.a.noProof,h);h=new eh.GraphTransaction(15);h.set(Xa.App.Xj.zl);this.Cih.j5(v);h.dispose()}}gf(){return $e.SelectionEditor.gf(this.jVe)}}Object(n.a)(Eq,"LanguageEditor",null,[464]);var Gp=c(598),Ko=c(243),pm=c(104);class tp{constructor(b=!1,h=0){this.languages=
tp.$gi(ok.a.LTl());this.ood=new Ko.a;this.mSa=[];this.BYb=new Gp.a;this.M7i=b;this.tch=0>=h?7:h;this.sch=this.BPe=0;this.ZXg=!1;b&&(this.LAm(),w.AFrameworkApplication.cI(()=>{this.r7m()}))}LAm(){for(var b of this.languages)this.ood.Z(b.LCID,b);b=[];try{const D=$b.a.get("RecentlyUsedLcids");if(D&&""!==D){const P=decodeURIComponent(D).split(",").slice(0,this.tch);for(const ca of P){let ta;({value:ta}=this.ood.Dc(parseInt(ca),ta)).returnValue&&b.push(ta)}}}catch(D){u.ULS.sendTraceTag(38385057,324,15,
"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",D.message),Array.clear(b)}if(b.length)for(var h of b){var v=h.LCID;this.BYb.contains(v)||(this.mSa.push(h),this.BYb.add(v))}else h=w.AFrameworkApplication.lcid,({value:v}=this.ood.Dc(h,v)).returnValue&&(this.mSa.push(v),this.BYb.add(h));this.fhj()}fhj(){const b=pm.toArray(pm.select(pm.asEnumerable(this.mSa),h=>h.LCID)).join(",");$b.a.oTa("RecentlyUsedLcids",b,180)}w1l(b){let h,v=-1,D=null;var P=tp.$gi(this.mSa);this.M7i&&
0<P.length&&(D=pm.toArray(pm.Si(pm.asEnumerable(P),(Ra,mb)=>{b===Ra.LCID&&-1===v&&(v=mb);return{["key"]:mb,["text"]:Ra.displayName,["value"]:Ra.LCID.toString()}})));let ca=0;D&&(ca=D.length);P=ca;const ta=pm.toArray(pm.Si(pm.asEnumerable(this.languages),(Ra,mb)=>{b===Ra.LCID&&-1===v&&(v=ca+mb);return{["key"]:ca+mb,["text"]:Ra.displayName,["value"]:Ra.LCID.toString()}}));h=v;return 0<ca?{returnValue:D.concat.apply(D,ta),selectedIndex:h,$uj:P}:{returnValue:ta,selectedIndex:h,$uj:P}}Sko(b,h){if(this.M7i&&
({value:v}=this.ood.Dc(b,v)).returnValue){h=b!==h;if(this.BYb.contains(b))b=Array.indexOf(this.mSa,v),0<=b&&(Array.removeAt(this.mSa,b),this.mSa.push(v)),h&&this.BPe++;else{this.BYb.add(b);this.mSa.push(v);if(this.mSa.length>this.tch){var v=this.mSa.shift();this.BYb.remove(v.LCID)}h&&this.sch++}this.fhj()}}r7m(){const b=this.BPe+this.sch;!this.ZXg&&0<b&&(u.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.BPe/b),this.ZXg=!0)}static $gi(b){b=Array.clone(b);b.sort((h,
v)=>h.displayName.localeCompare(v.displayName));return b}}Object(n.a)(tp,"LanguageListHelper",null,[465]);var nq=c(190);class Bn extends nq.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(n.a)(Bn,"NumberButtonProps",nq.a,[]);var em=c(211);class Zi{static get s5(){return null!=Zi.ZGg?Zi.ZGg:Zi.ZGg=Ea.a.instance.Na("Box4.ISpacingCommands")}static get Xg(){return em.ContextSetEditor.instance}static get PFa(){return null!=Zi.QDg?Zi.QDg:Zi.QDg=Ea.a.instance.Na("Box4.ILineSpacingHelper")}static get Sqj(){return!!Zi.s5}static Tb(){const b=
w.AFrameworkApplication.va;b.qa(Gb.a.sgc,sc.a.view,Zi.sgc);b.Vc(Gb.a.sgc,1124);b.qa(Gb.a.sgc,sc.a.paragraph,Zi.RXo)}static sgc(b,h,v,D,P){if(1===v||!Zi.Sqj)return Zi.Sqj?32:8;if(!Zi.Dzi){var ca=[];ca.push(Object.assign(new Bn,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));ca.push(Object.assign(new Bn,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));ca.push(Object.assign(new Bn,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));ca.push(Object.assign(new Bn,{ExternalId:"LineSpacing2_00",Number:2,
Type:0}));ca.push(Object.assign(new Bn,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));ca.push(Object.assign(new Bn,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));P.MenuItems=Ii.e(ca);Zi.Dzi=!0}u.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");h=h.view.lb;ca=null;h&&h.gb.kb&&(ca=h.gb.kb);h=Zi.Xg.e3h(ca.Oa);w.AFrameworkApplication.va.Mf(h,b,v,!0,D,P);return 32}static RXo(b,h){let v=b=!0;h=Zi.PFa.yEa(h.node);var D=h.beforeSpacing;let P=!1;1===D.unit&&(P=!0);if(P||0<D.value)b=!1;
h=h.afterSpacing;D=!1;1===h.unit&&(D=!0);if(D||0<h.value)v=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Zi.Pvk,!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Zi.n1n,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Zi.Ovk,!v));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Zi.m1n,v));return 32}}Zi.Pvk="AddSpaceBeforeParagraph";Zi.Ovk="AddSpaceAfterParagraph";Zi.n1n="RemoveSpaceBeforeParagraph";Zi.m1n="RemoveSpaceAfterParagraph";
Zi.Dzi=!1;Object(n.a)(Zi,"LineSpacingRibbonMenu",null,[]);var el=c(176),Cn=c(1686),Lo=c(1381),xk=c(133);const qm=(b,h,v)=>{if(1===v)return 32;b=Xa.App.xa.notificationBar.Dma("Automation test",!1);b.image=3;Xa.App.xa.notificationBar.lA(b);return 32},Wo=(b,h,v,D,P)=>{let ca;if(!({cJj:ca}=oq(P)).returnValue)return 16;el.UISurfaces.vM().then(ta=>{let Ra=null;var mb=Object.assign(new Cn.a,{label:"OK",onExecute:()=>{Ra&&ta.removeNotification(Ra)}});mb=Object.assign(new Lo.a,{target:"#"+xk.AppFrame.J8f,
content:"Here's the text for the callout",title:"Your title",primaryButtonProps:mb,useTeachingStyles:ca});mb=ta.callout(mb);Ra=ta.addNotification(mb);return null},ta=>{u.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",ta);return null});return 32},oq=b=>{let h=!1;if(!b)return{returnValue:!1,cJj:h};h=Boolean.parse(b);return{returnValue:!0,cJj:h}};var Fq=c(1465);let Xo,Hp,zj,kk,fp;class fl{constructor(){this.W6=new Fb.a;this.p2g=!1}bZa(b){const h=this.W6.indexOf(b);let v=
!0;if(-1!==h){v=!1;if(!h)return v;this.W6.removeAt(h)}this.W6.insert(0,b);u.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",b);11===this.W6.count&&(u.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.W6.J(10)),this.W6.removeAt(10));this.qZo();return v}uoe(b){let h="#";for(let D=0;D<this.W6.count;D++){var v="#"+this.W6.J(D).substring(4,6)+this.W6.J(D).substring(2,4)+this.W6.J(D).substring(0,2);v=Object.assign(new Fq.a,{Color:this.W6.J(D),
Alt:v,DisplayColor:v});if(v.DisplayColor.toLowerCase()===b.toLowerCase()){h=v.Color;break}}for(const D of fl.pch)appChrome.api.dispatch(appChrome.actions.updateColorPickerSelectedColor(D,h))}qZo(){u.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let v=0;v<this.W6.count;v++){var h="#"+this.W6.J(v).substring(4,6)+this.W6.J(v).substring(2,4)+this.W6.J(v).substring(0,2);h=Object.assign(new Fq.a,{Color:this.W6.J(v),Alt:h,DisplayColor:h});
b.push(appChrome.api.colorPickerCell(h.Color,h.DisplayColor,h.Alt))}for(const v of fl.pch)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(v,b));this.p2g||this.nYo();this.p2g=!0}nYo(){for(const b of Object.keys(fl.T6g)){u.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const h=fl.T6g[b],v=[];for(const D of h)v.push(appChrome.api.menuSection([D],D in fl.yKe?fl.yKe[D].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,v,fl.yKe[b].toString()))}}}
fl.T6g={["FontColor"]:(fp=new Fb.a,fp.add("AutomaticFontColor"),fp.add("ThemeFontColorPickerMCU"),fp.add("ThemeFontColorPicker"),fp.add("StandardFontColorPicker"),fp.add("RecentFontColorPicker"),fp.add("MoreFontColors"),fp),["CellShading"]:(kk=new Fb.a,kk.add("ThemeShadingColorPickerMCU"),kk.add("ThemeShadingColorPicker"),kk.add("StandardShadingColorPicker"),kk.add("RecentCellShadingColorPicker"),kk.add("ClearShadingColor"),kk.add("MoreCellShadingColors"),kk),["PictureBorders"]:(zj=new Fb.a,zj.add("ThemePictureBorderColorPickerMCU"),
zj.add("ThemePictureBorderColorPicker"),zj.add("StandardPictureBorderColorPicker"),zj.add("RecentPictureBorderColorPicker"),zj.add("MorePictureBorderColors"),zj.add("NoPictureBorder"),zj.add("PictureBorderWeightOptions"),zj.add("PictureBorderStyleOptions"),zj),["PageColor"]:(Hp=new Fb.a,Hp.add("ThemePageColorPickerMCU"),Hp.add("ThemePageColorPicker"),Hp.add("StandardPageColorPicker"),Hp.add("RecentPageColorPicker"),Hp.add("NoPageColor"),Hp.add("MorePageColors"),Hp)};fl.yKe={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,
["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardPageColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPageColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["FontColor"]:Box4Intl.Box4Strings.L_FontColor,
["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:"Picture Border",["PageColor"]:"Page Color"};fl.pch=(Xo=new Fb.a,Xo.add("RecentFontColorPicker"),Xo.add("RecentCellShadingColorPicker"),Xo.add("RecentPictureBorderColorPicker"),Xo.add("RecentPageColorPicker"),Xo);Object(n.a)(fl,"RecentColorsSectionHandler",null,[]);var Xl=c(1409),up=c(1050);class bh{constructor(b){this.nfk=b}H4(){}F4(b){this.nfk.ajn(b)}}Object(n.a)(bh,"DataBuddyActionListener",
null,[31]);class uo{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(n.a)(uo,"DataBuddyTaskPaneProps",null,[]);class vo{constructor(b){this.isVisible=!1;this.VY=new Fb.a;this.pse=null;this.V2=b;this.hB=new Xl.a;this.Ub=bd.FocusManager.instance()}initialize(){this.pse=new bh(this);this.V2.QNa();this.hB.qL(this.Wuk());this.hB.qL(this.Yrk())}toggle(){this.isVisible?this.hide():this.show()}ajn(b){if(2===b.behavior){const h=Oc.ActionManager.Gaa(b.actionId)||
b.actionId.toString();h.startsWith("Query")||(this.VY.add(h+": "+vo.OLl(b.response)),this.Cm())}}hide(){el.UISurfaces.Gu().then(b=>{b.hideTaskPane(vo.$B,2);return null})}show(){el.UISurfaces.Gu().then(b=>{b.showTaskPane(vo.$B,this.pA());return null});this.isVisible&&el.UISurfaces.Gu().then(b=>{b.setSelectedTaskPane(vo.$B);return null})}Wuk(){return b=>{b.actions=this.VY.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}Yrk(){return b=>{b.onClearClick=()=>{this.VY.clear();
this.Cm()}}}Tb(){w.AFrameworkApplication.va.AY(this.pse)}V7a(){w.AFrameworkApplication.va.PQb(this.pse)}pA(){const b=new uo;this.hB.Cob(b);return Object.assign(new up.a,{title:"Data Buddy",hideHeader:!1,width:vo.width,location:2,contentProps:b,onOpen:()=>{this.O9();this.Tb();this.isVisible=!0;w.AFrameworkApplication.ta.updateCommandUI()},onClose:()=>{this.mda();this.V7a();this.isVisible=!1;this.Cm();w.AFrameworkApplication.ta.updateCommandUI()},isModernPane:!0})}Cm(){el.UISurfaces.Gu().then(b=>{b.updateTaskPane(vo.$B,
this.pA());return null})}O9(){this.Ub.mg(vo.$B)}mda(){this.v3a()&&this.Ub.mg(this.Ub.vT)}v3a(){return!!this.Ub.currentScope&&this.Ub.currentScope.name===vo.$B}static OLl(b){switch(b){case 0:return"Unattempted";case 1:return"In Progress";case 2:return"Not Handled";case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}vo.$B="DataBuddyTaskPane";vo.width=300;Object(n.a)(vo,"Box4DataBuddyTaskPane",null,
[460]);class Mn{constructor(b){this.Jh=b}JIa(b){this.Jh&&this.Jh.WG(b)}fbd(){this.Jh&&this.Jh.ubd(void 0)}}Object(n.a)(Mn,"RibbonButtonUpdater",null,[458]);var Nh=c(368);class Um{constructor(){this.uTe=this.W=null}get name(){return"Box4.UI"}xc(b){this.W=b;b.ha("Box4.IGeneralCuiUser",()=>new Tn(b.resolve("Box4.UI.CuiActionBridge"),w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.UI.TableAltTextDialogFactory",()=>new gs(b.resolve("Box4.ITableEditor"),new Nh.a,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();
b.ha("Box4.UI.ILanguageEditor",()=>new Eq(Yh.a.instance.tg,b.Na("Box4.ITextFormattingCommands"),b.Sa("Box4.IAutoCorrectRules"),b.resolve("Box4.ILanguageReader")));b.ha("CommandUI.StandaloneRootController",()=>new Uq(w.AFrameworkApplication.Ws)).as("Common.IStandaloneRootController").singleInstance();b.ha("Box4.UI.IAutoCorrectOptionsDialog",()=>new un(b.resolve("Box4.IAutoCorrectOptionsInfo"),w.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ha("Box4.UI.LanguageListHelper",()=>
new tp(w.AFrameworkApplication.K.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").singleInstance();b.register(Mo,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").singleInstance();b.ha("Box4.UI.DefaultProofingContextMenuCreator",()=>new Zp(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).singleInstance();b.ha("Box4.UI.ProofingContextMenuSectionFactory",()=>new Ln(b.resolve("Box4.UI.DefaultProofingContextMenuCreator"),
b.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").singleInstance();b.ha("Box4.RibbonButtonUpdater",()=>new Mn(this.W.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").singleInstance();b.ha("Box4.UI.RecentColorsSectionHandler",()=>new fl).singleInstance();b.ha("Common.IDataBuddyTaskPane",()=>new vo(Am.a.instance)).singleInstance()}init(){var b=Xa.App.xa;const h=b.Nb;nc.Gym(Object(z.a)(h,h.sKb,"onAuthenticationLost"),Object(z.a)(h,
h.tKb,"onAuthenticationRestored"),b.ZTk);b=w.AFrameworkApplication.va;b.qa(Gb.a.VHn,sc.a.application,jo);b.eb(Gb.a.Gwo,sc.a.application,vn,96);b.eb(Gb.a.nxo,sc.a.application,Tm,96);b=w.AFrameworkApplication.va;b.eb(Gb.a.azo,sc.a.application,qm,96);b.eb(Gb.a.wwo,sc.a.application,Wo,96);Zi.Tb();this.SAm();this.uTe=this.W.resolve("Common.IStandaloneRootController")}SAm(){this.W.Sa("Box4.IGeneralCuiUser").execute(b=>{this.W.Sa("Common.IStandaloneRootController").execute(h=>{h.sda.xF=b})})}dispose(){this.uTe.dispose();
this.uTe=null}static main(){N.a.instance.Fc(new Um,6)}}Object(n.a)(Um,"Box4UIPackage",null,[1,2]);var No=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},on=c(1845);class wo{get name(){return"Box4.Insights"}init(){}dispose(){}xc(b){b.ha("Box4.Insights.Box4InsightsSelection",
()=>new on.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance()}}Object(n.a)(wo,"Box4InsightsPackage",null,[1,2]);const rm=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+b)};var $i=c(400),di=c(534),Mi=c(1814);class bo{Ilb(){return!1}reset(){}update(){}}Object(n.a)(bo,"NullTaskYieldStrategy",null,[441]);var ko=c(1413);class qk{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=
this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(n.a)(qk,"CatchUpConfiguration",null,[]);class fm{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=
this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(n.a)(fm,"SharedControllerFactoryParameters",null,[]);var Jl=c(156),Nc=c(15);class xo{constructor(b,h,v,D){this.cwn=(P,ca)=>{(this.Xld=!this.Xld)&&ca.gk&&ca.gk.contextId===sc.a.Tc&&this.nDh(ca.gk.node,ca.gk.wj);return 32};this.Xx=b;this.Wp=h;this.ga=v;this.Ub=D;this.Mnd=this.Nnd=null;this.Xld=!1;this.ga.qa(Nc.a.cAj,sc.a.view,this.cwn);this.Ub.fe(Ne.AFrame.rp).bindAction(Xb.KeyInputManager.jc(Ve.a.poc,
6),Nc.a.cAj)}uY(b,h){this.Xld&&this.Wp&&h&&h.ol&&h.ol.kb&&h.ol.kb.Oa&&h.ol.kb.Oa.node&&h.ol.kb.Oa.contextId===sc.a.Tc&&this.nDh(h.ol.kb.Oa.node,h.ol.kb.Oa.wj)}nDh(b,h){b&&(this.ERi(b)?(this.Nnd&&this.Nnd.id.equals(b.id)||(this.Wp.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.Nnd=b),this.A$m(b,h)):this.Mnd=this.Nnd=null)}ERi(b){return 0<this.Xx.XEb(b).count}A$m(b,h){if(b){var v=-1,D=null,P=null;for(let ca=0;ca<b.pa.length;ca++){const ta=b.pa.J(ca);
if(!(null==P||ta.changeStart&&ta.changeStart.equals(D))&&h>=v&&h<=ta.cp&&!D.equals(this.Mnd))if(this.Xx.IHb(D)){(b=this.Xx.kNc(D,b.id))&&0<b.actors.length&&b.displayTimestamp&&(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.Wp.sendNotification(b,!1),this.Mnd=D);break}else this.Mnd=null;ta.changeStart&&!ta.changeStart.equals(D)&&(v=ta.cp,D=ta.changeStart);P=ta.changeStart}}}}Object(n.a)(xo,
"ActivityAnnouncementManager",null,[]);var Z=c(1382),ma=c(528),qb=c(757),ec=c(583);class uc{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(n.a)(uc,"Activity",null,[]);var Zc=c(391);class rd extends uc{constructor(){super();this.Fv=this.objectId=null}static TG(b){const h=new ec.a(new Zc.a);if(b.Fv)for(const v of b.Fv)h.add(v);return h}}Object(n.a)(rd,"RevisionSetActivity",uc,[]);class Jd{constructor(b,
h,v,D=!1){this.Lwe=null;this.dismiss=()=>{this.YRi.then(P=>{P.removeNotification(this.Lwe);return this.Lwe=null})};this.YW=b;this.pc=h;this.YRi=v;this.obc=D}wQo(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:this.pc.Qb(Wa.a.A4a,2,null);break;default:this.fjn()}else u.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}fjn(){this.YRi.then(b=>{var h=Object.assign(new Lo.a,{target:'[data-unique-id~="CatchUpWithChanges"]',
showCloseIcon:!0,content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new Z.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});h=b.callout(h);const v=Object.assign(new ma.a,{expirationOptions:Object.assign(new qb.a,{displayTimeoutSeconds:10,onExpire:this.dismiss})});this.Lwe=b.addNotification(h,v)})}doesContentExist(b){if(!b)return u.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!b.navigationId)return u.ULS.sendTraceTag(593049025,
3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const h={};h.NavigationId=atob(b.navigationId);if(8===this.pc.Qb(Wa.a.IJd,2,h))return!1;break;case 1:return this.Zql(b)}return!0}Zql(b){b=rd.TG(b);return b?0<this.YW.XPd(b).count:(u.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(n.a)(Jd,"ActivityContentManager",null,[566]);var Me=c(1480),xg=c(2040),gf=c(390),Bg=c(691);class Uf{constructor(){this.Fv=this.NX=null}compare(b){if(!b)return!1;
if(this.NX&&b.NX){if(this.NX.count!==b.NX.count)return!1;for(const h of this.NX)if(!b.NX.contains(h))return!1}else if(!b.NX&&this.NX||!this.NX&&b.NX)return!1;if(b.Fv&&this.Fv){if(b.Fv.count!==this.Fv.count)return!1;for(const h of this.Fv)if(!b.Fv.contains(h))return!1}else if(!this.Fv&&b.Fv||!b.Fv&&this.Fv)return!1;return!0}}Object(n.a)(Uf,"ActivityHighlightableObject",null,[]);class hg extends Me.a{constructor(b,h){super();this.MOe=this.oYb=null;this.eed=b;this.Xx=h;this.s2=[new xg.a(gf.a.WBh,gf.a.VBh),
new xg.a(gf.a.TBh,gf.a.SBh),new xg.a(gf.a.$Cd,gf.a.aDd),new xg.a(gf.a.bDd,gf.a.H6e)]}get Nib(){return 1}get a2a(){return this.s2}get Vba(){return!0}u1a(b,h){if(b=Object(Na.a)(Uf,b))if(b.NX)for(const v of b.NX)h.add(v);else u.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}yGa(b,h){if(this.Hu.oDa){var v=this.eed.r6a,D=this.eed.Pib,P=!!v&&v.compare(D),ca=this.Hu.oDa,ta=ca.action,Ra=this.nto(ca,b),mb=!1;2!==ta&&ta&&(mb=(mb=this.Hu.oXc)?1===mb.type:!!v||!!D);h=h.TGa("*");
for(let Jb=0,Ub=h.length;Jb<Ub;Jb++){const cc=h[Jb],Ac=this.iWl(cc,gf.a.iGc);if(Ac&&Ac.du)if(this.d0n(cc),1===ca.type)switch(ta){case 0:Ra&&v.Fv.contains(Ac.du)&&this.YAd(cc,2,Ac,!1);break;case 2:Ra&&D.Fv.contains(Ac.du)&&this.YAd(cc,P?2:1,Ac,!1);break;default:this.T9b(b,cc,Ac,!1)}else mb?this.T9b(b,cc,Ac,!1):this.T9b(b,cc,Ac,!0)}this.oYb&&(this.oYb.classList.add(gf.a.bDd),this.MOe=this.oYb=null)}}iWl(b,h){return fd.a.Db(b,h)}nto(b,h){if(b&&b.FA){const v=b.FA,D=b.action;if(1===b.type&&(2===D||!D)&&
v.NX)return v.NX.contains(h);if(v.Fv)for(const P of v.Fv){b=this.Xx.COc(P);for(const ca of b)if(ca===h)return!0}}return!1}T9b(b,h,v,D){const P=this.eed.r6a,ca=this.eed.Pib;P&&P.Fv.contains(v.du)&&(!P.NX||P.NX.contains(b))?this.YAd(h,2,v,D):ca&&ca.Fv.contains(v.du)&&(!ca.NX||ca.NX.contains(b))&&this.YAd(h,1,v,D)}YAd(b,h,v,D){b&&Bg.a(b)&&(b.classList.add(this.e_l(2===h,D)),this.gko(b,v,D))}gko(b,h,v){this.oYb?-1!==h.cpEnd&&this.MOe.cpEnd!==h.cpBegin&&(this.oYb.classList.add(v?gf.a.H6e:gf.a.bDd),b.classList.add(v?
gf.a.aDd:gf.a.$Cd)):b.classList.add(v?gf.a.aDd:gf.a.$Cd);b.classList.add(gf.a.UBh);this.oYb=b;this.MOe=h}d0n(b){this.Hu.wSa(b);this.XZn(b)}XZn(b){b.classList.remove(gf.a.$Cd,gf.a.aDd,gf.a.UBh,gf.a.bDd,gf.a.H6e)}e_l(b,h){return h?b?gf.a.SBh:gf.a.VBh:b?gf.a.TBh:gf.a.WBh}}Object(n.a)(hg,"ActivityHighlightActor",Me.a,[]);var gh=c(2041),rg=c(163);class Bf{constructor(b,h,v,D,P,ca,ta,Ra){this.XV=b;this.RN=h;this.Xx=v;this.ifk=P;this.hb=ca;this.Wp=Ra;this.Ub=ta;this.RN.t_d=!1}VXi(b,h,v){b?this.Otm(b,h,v):
this.RN.r6a&&(b=Object.assign(new gh.a,{action:1,type:1,FA:null,LJ:this.RN.r6a}),this.RN.r6a=null,this.XV.zF(b))}Otm(b,h,v){if(h){b=new ec.a(new Zc.a);for(P of h){var D=this.Xx.JNc(P);for(let ca=0;ca<D.length;ca++){const ta=D[ca];this.Xx.IHb(ta)&&b.add(ta)}}var P=this.Xx.XPd(b);P=this.FKh(P,b);D=this.RN.r6a;this.RN.r6a=P;P=Object.assign(new gh.a,{action:0,type:1,FA:this.RN.r6a,LJ:D});this.XV.zF(P);v&&!this.wco(h.J(0),b)||this.keo(h.J(0),b)}else u.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",
b.activityId)}wco(b,h){if(!b)return u.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return u.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;h=this.pTl(b,h);return this.ifk.USa(b.id,h)?this.setSelection(b,h)?!0:!1:(u.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}keo(b,h){b=this.f_l(b,h);h=new Sys.StringBuilder;for(let v=
0;v<b.count;v++)h.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,v+1,b.count,b.J(v)));this.Wp.sendNotification(h.toString(),!0)}setSelection(b,h){if(!b||!fe.ParagraphReader.Wb(b))return u.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>h)return u.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.RN.t_d=!0;b=we.a.Qc(b,h);b=new rg.Selection([b],!0);this.hb.setSelection(b);bd.FocusManager.bK()&&
this.Ub.mg(Ne.AFrame.Pn);return!0}pTl(b,h){if(h&&0<h.count)for(let v=0;v<b.pa.length;v++){const D=b.pa.J(v);if(D.changeStart&&h.contains(D.changeStart))return D.cp}u.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}f_l(b,h){const v=new Fb.a;if(h&&0<h.count&&b){let D=-1;for(let P=0;P<b.pa.length;P++){const ca=b.pa.J(P);if(-1!==D&&ca.isChangeEnd)if(ca.changeStart&&h.contains(ca.changeStart))continue;else v.add(b.characterData.substring(D,
ca.cp)),D=-1;ca.changeStart&&h.contains(ca.changeStart)&&(D=ca.cp)}}return v}bXi(b,h){if(b)switch(b.type){case 1:if(h){b=new ec.a(new Zc.a);for(var v of h){h=this.Xx.JNc(v);for(let D=0;D<h.length;D++){const P=h[D];this.Xx.IHb(P)&&b.add(P)}}}else b=rd.TG(b);h=this.Xx.XPd(b);this.RN.Pib=this.FKh(h,b);v=Object.assign(new gh.a,{action:2,type:1,FA:this.RN.Pib,LJ:null});this.XV.zF(v)}else this.RN.Pib&&(v=Object.assign(new gh.a,{action:3,type:1,FA:null,LJ:this.RN.Pib}),this.RN.Pib=null,this.XV.zF(v))}FKh(b,
h){var v=null;if(b){v=new Ga.a;for(const D of b)12===D.type&&v.add(D)}b=new Uf;b.NX=v;b.Fv=h?h:this.Y4l(v);return b}Y4l(b){const h=new ec.a(new Zc.a);if(!b)return h;for(const v of b)for(const D of this.Xx.XEb(v))h.add(D);return h}}Object(n.a)(Bf,"ActivityHighlightManager",null,[]);var Oh=c(499),ki=c(458),lk=c(1478),Vm=c(105),Dn=c(59);class Lm{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(n.a)(Lm,"CreateIndicatorTooltipParameters",null,[]);class Vq{constructor(){this.clearSticky=
!1}}Object(n.a)(Vq,"DismissIndicatorTooltipParameters",null,[]);class Oo{constructor(){this.target=null;this.isSticky=!1}}Object(n.a)(Oo,"UpdateIndicatorTooltipParameters",null,[]);class hs extends Sys.EventArgs{constructor(b,h,v){super();this.uDb=b;this.Kqi=h;this.tuo=v}}Object(n.a)(hs,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class mr{constructor(){this.Lqi=new Map;this.Mqi=new Set}pNo(b,h){this.Mqi.add(b);this.Lqi.set(b,h)}mNm(b){return Dd.a.exi(b.htmlElement)}Jjm(){const b=new Set;for(const h of this.Mqi){const v=
this.Lqi.get(h);v&&this.lNm(v)&&b.add(h)}return b}lNm(b){return b.parentElement&&Dd.a.exi(b.parentElement)}}Object(n.a)(mr,"IndicatorVisibilityTracker",null,[]);class Ql extends lk.a{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub){super();this.ra=new Mc.a;this.xub=this.T$=null;this.Cpm=(cc,Ac,Lc,id,vd)=>{if(!vd)return u.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;Ac=rd.TG(vd.Activity);cc=null;if(vd.NodeId&&(vd=Vm.b(vd.NodeId),!W.a.eq(vd,W.a.nil)&&(vd=this.Xx.k$h(vd),
this.nlg(vd,!1))))return 32;for(const xe of Ac)if(this.Xx.IHb(xe)){vd=this.Xx.R7b(xe);if(this.nlg(vd,!0))return 32;vd&&!cc&&(cc=vd)}if(this.nlg(cc,!1))return 32;u.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8};this.Apm=(cc,Ac,Lc,id,vd)=>{u.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");vd&&Ac&&Ac.hl&&(cc=Ac.node)&&((cc=this.Joc.kQd(cc))?this.Syd(cc,!1,!1):u.ULS.sendTraceTag(595126289,
377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.czo=cc=>{(cc=this.Joc.kQd(cc.customData))&&this.Syd(cc,!1,!1)};this.onMouseEnter=cc=>this.gWi(cc.Qw,!0);this.tpa=cc=>{cc=cc.Qw;if(cc===this.T$)return!0;this.U$i(cc);return!0};this.oGa=cc=>{this.xub=null;return this.gWi(cc.Qw,!1)};this.w0=()=>{this.kfg();this.YDd(!0);return!1};this.Zs=()=>{this.T_i()};this.M9d=()=>{this.T$&&this.EGj(this.T$);this.xub&&this.U$i(this.xub);this.sqn()};this.T_i=()=>{this.T$?
this.EGj(this.T$):this.J7e()};this.Xx=b;this.Ase=h;this.$Zg=v;this.C7j=D;this.ul=P;this.u6=null;this.Gb=ta;this.Joc=Ra;this.DEe=new mr;this.ux=mb;this.vK=Jb;this.uI=Ub;this.lf&&(this.lf.Pla(this.M9d),this.lf.Kqh(this.T_i));ca&&ca.execute(cc=>{cc.M0(this.Zs)})}get lf(){return this.ul&&this.ul.Wi?this.ul:(u.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}lDa(b,h,v){if(this.T$){var D=Dn.a(this.T$);if(b===D)return this.T$}const P=b.fh.ownerDocument;D=Oh.a.createElement(P,ki.a.div);
D.className=gf.a.cDd;D.style.left=h+"px";D.style.top=v+"px";h=Oh.a.createElement(P,ki.a.div);h.className=this.ux?gf.a.bCh:gf.a.XBh;D.style.cursor="pointer";h.style.cursor="pointer";this.uI&&(h.style.backgroundColor=this.vK.ZPl(),h.style.outlineWidth="1px",h.style.outlineStyle="solid",h.style.outlineColor=this.vK.$Pl());D.appendChild(h);xf.a.instance.nb(Ed.a.rR,D,this.onMouseEnter);xf.a.instance.nb(Ed.a.jL,D,this.tpa);Th.a.instance.nb(Ed.a.click,D,this.oGa);xf.a.instance.nb(Ed.a.contextMenu,D,this.w0);
u.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.Q4m(b);h=this.R5l(b);this.DEe.pNo(h,D);this.DEe.mNm(b)&&this.wVi(h);return D}Tob(b){return this.jso(b)}sfb(b){const h=this.MRk(b),v=[];v.push(this.lDa(b.O4,h,b.snc[0].y-b.bca[0].y));return v}MRk(b){let h=gf.a.Lxm+(0>b.EXc?-b.EXc:0);const v=Ef.a.Ji(b.leftMargin,0)/2;1>=v&&u.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");h=h>v?v:h;h=h<gf.a.YBh?gf.a.YBh:h;return w.AFrameworkApplication.isRtl?
b.bca[0].width/this.zoom+h:-h}dqj(b){if(b&&393230===b.Rc||393251===b.Rc){const h=this.Xx.XEb(b);if(h)for(const v of h)if(b===this.Xx.R7b(v))return!0}return!1}jso(b){for(const h of fe.ParagraphReader.tw(b.Bb,!0,!1))if(this.dqj(h))return!0;return!1}Tb(b){b.qa(Nc.a.Qrj,sc.a.Tc,this.Apm);b.qa(Nc.a.Eeg,sc.a.Tc,this.Cpm)}nlg(b,h){if(!b)return!1;const v=this.Joc.kQd(b);if(v)return this.Syd(v,!1,!0),!0;if(!h){let D;this.F3c((D=new Fb.a,D.add(b),D),!1,!0,!0);h=new qf.a(3,1,0,this.czo,181);h.customData=b;this.Gb.Vb(h);
return!0}return!1}qbl(b,h=!1){h&&this.YDd(!0);if(b&&b.parentNode){var v=this.Yuf(b);v=this.ZLl(v);this.u6||(this.u6=document.createElement("Div"),document.getElementById(w.AFrameworkApplication.u1b).appendChild(this.u6));this.Ase.createActivityIndicatorTooltip(Object.assign(new Lm,{target:b,container:this.u6,activityIds:v,isSticky:h,dirHint:9}));h&&(this.T$=b)}else u.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}Gvl(b){b&&
b.classList.add(gf.a.dDd)}gWi(b,h){return this.Syd(b,h,!1)}Syd(b,h,v){if(h&&b===this.T$)return!0;const D=this.Yuf(b);h||this.kfg();this.qbl(b,!h);this.Gvl(b.getElementsByClassName(this.ux?gf.a.bCh:gf.a.XBh)[0]);this.F3c(D,h,!0,v);this.nKi(D,h?1:2);this.C7j.v3d();h&&(this.xub=b);return!0}YDd(b=!1){this.Ase.dismissActivityIndicatorTooltips(Object.assign(new Vq,{clearSticky:b}));this.xub=null;b&&(this.T$=null)}vtj(b){b&&b.classList.remove(gf.a.dDd)}kfg(){this.T$&&this.vtj(this.T$.getElementsByClassName(gf.a.dDd)[0])}U$i(b){const h=
this.Yuf(b);this.F3c(h,!0,!1,!1);this.vtj(b.getElementsByClassName(gf.a.dDd)[0]);this.YDd(!1);this.xub=null}Yuf(b){let h=null;(b=(b=Dn.a(b))?b.Bb:null)&&11===b.type&&(h=fe.ParagraphReader.tw(b,!0,!1));return h}J7e(){const b=!!this.xub;if(this.T$||b)this.kfg(),this.YDd(!0),this.F3c(null,!1,!1,!1),this.F3c(null,!0,!1,!1)}Ywk(b){this.ra.addHandler(Ql.nnh,b)}Zwk(b){this.ra.addHandler(Ql.onh,b)}F3c(b,h,v,D){let P=null;if(v&&b){for(const ca of b)if(v=this.Xx.JNc(ca))for(let ta=0;ta<v.length;ta++){const Ra=
v[ta];if(this.Xx.IHb(Ra)){P=this.Xx.kNc(Ra,ca.id);break}}if(!P){u.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}h?this.ra.raiseEvent(Ql.nnh,new hs(P,b,!1)):this.ra.raiseEvent(Ql.onh,new hs(P,b,D))}ZLl(b){const h=[];if(b)for(const D of b){var v=this.Xx.XEb(D);for(const P of v)(v=this.Xx.kNc(P,D.id))&&h.push(v.activityId)}!h.length&&b&&b.count&&u.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");
return h}EGj(b){b&&b.parentNode?(this.Ase.updateActivityIndicatorTooltip(Object.assign(new Oo,{target:b,isSticky:!0})),this.T$=b):u.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}sqn(){const b=this.DEe.Jjm();for(const h of b)this.wVi(h)}wVi(b){this.$Zg.mKi(b,3)}R5l(b){return(b=fe.ParagraphReader.tw(b.Bb,!0,!1))&&b.count?b.J(0).id:null}Q4m(b){b=fe.ParagraphReader.tw(b.Bb,!0,!1);this.nKi(b,0)}nKi(b,
h){b&&b.count&&this.P4m(b.J(0).id,h)}P4m(b,h){this.$Zg.mKi(b,h)}}Ql.nnh="ActivityIndicatorPreviewed";Ql.onh="ActivityIndicatorSelected";Object(n.a)(Ql,"ActivityIndicatorActor",lk.a,[]);var hf=c(36);class Cl{constructor(b,h,v){this.Xx=b;this.Twd=h;this.ul=v}get lf(){return this.ul&&this.ul.Wi?this.ul:(u.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}kQd(b){u.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");
const h=this.kai(b);if(!h){u.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.Xx.XEb(b);for(const v of b)if(b=this.Xx.R7b(v),b=this.kai(b))return b}return h}kai(b){if(!b||12!==b.type)return u.ULS.sendTraceTag(539779146,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return u.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),
null;var h=this.Twd.dQc(b);if(!h||11!==h.type)return u.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;h=h.De(this.lf.fc);if(!h||!h.htmlElement)return u.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),null;var v=ic.a.KNc(h.htmlElement,Cl.mnh);if(v)return v;h=h.Dkf();if(!h)return u.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),
null;h=ic.a.NQl(h,Cl.mnh);if(!h)return u.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(v=0;v<h.length;v++){const D=Dn.a(h[v]),P=hf.OutlineElementNavigator.Gl(b);if(D&&D.Bb&&P&&D.Bb.id.equals(P.id))return h[v]}u.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}t0l(b){b=this.Xx.k$h(b);if(!b||12!==b.type)return u.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),
W.a.nil;b=this.kQd(b);if(!b)return u.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),W.a.nil;b=Dn.a(b);return b?b.Bb.id:(u.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),W.a.nil)}}Cl.mnh="CatchUpActivityIndicatorContainer";Object(n.a)(Cl,"ActivityIndicatorHelper",null,[]);var Ip=c(1687);class Wm{constructor(b,h,v,D,P,ca,ta){this.k2a=
b;this.pageContentNode=h;this.WYe=v;this.pc=D;this.YW=P;this.Re=ca;this.jYd=ta;this.hEi=!1;this.Aan=(Ra,mb,Jb)=>{if(1===Jb)return this.Dxf?32:8;2===Jb&&(this.Dxf&&(this.WYe.J7e(),this.zYk()),u.ULS.sendTraceTag(38138719,377,50,E.c({["MarkAsRead invoked"]:!0})));Xa.App.xa.updateCommandUI();return 8};this.k2a.G5a(this.WYe)}initialize(){this.pc.qa(Nc.a.iNi,ud.a.frame,this.Aan)}get Dxf(){return!!this.YW.sR&&0<this.YW.sR.count||!!this.YW.sec&&0<this.YW.sec.count}get xWm(){return this.hEi}SWf(b){const h=
b&&b.wywaActivities?b.wywaActivities.length:0;if(!this.jYd||0<h||!b){const v=new Map;v.set("activityCount",h.toString());this.Re.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:v})}b?(this.aln(b.wywaActivities),this.hEi=!0):(u.ULS.shipAssertTag(36538305,377,!1),this.jYd||Object(Ip.a)(),this.Re.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}aln(b){b?(u.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),
this.Cqo(b),b=this.YW.swk(b),this.Dqo(b)):u.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}Cqo(b){if(b){var h=new Fb.a;for(const v of b)switch(v.type){case 2:case 3:case 4:case 10:b=4===v.type?v.A0i:v.contentId,h.add(b),this.YW.sec.add(b)}0<h.count&&(u.ULS.sendTraceTag(51196435,377,50,"{0}",h.count),this.pc.Qb(Wa.a.UQi,2,h.toArray()))}}Dqo(b){const h=new ec.a(new Zc.a),v=new eh.GraphTransaction(3);try{v.Cb(this.pageContentNode);for(const D of b){const P=this.YW.R7b(D);P&&this.WYe.dqj(P)&&
(h.add(P.id),this.k2a.P$b(P,!0))}}finally{v&&v.dispose()}0<b.count&&Xa.App.xa.updateCommandUI();b={};b.highlightedNodeCount=h.count;u.ULS.sendTraceTag(36509257,377,50,"{0}",E.c(b))}zYk(){u.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.YW.sec.count&&(this.pc.Qb(Wa.a.MSh,2,this.YW.sec.toArray()),this.YW.sec.clear());const b=this.y_k(this.YW.sR);this.RZn(b)}RZn(b){u.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");
const h=new eh.GraphTransaction(3);try{h.Cb(this.pageContentNode);for(const v of b){this.YW.sR.remove(v);for(const D of this.YW.COc(v))this.k2a.P$b(D,!0)}this.YW.ZDh()}finally{h&&h.dispose()}}y_k(b){const h=new ec.a(new Zc.a);for(const v of b)h.add(v);return h}}Object(n.a)(Wm,"ActivityIndicatorManager",null,[]);class Sr{constructor(){this.Pib=this.r6a=null;this.isFirstDocumentOpen=this.t_d=!1}}Object(n.a)(Sr,"ActivityStateManager",null,[565]);class zr{constructor(b,h){this.Afd={};this.lTb=b;this.wK=
h;this.sec=new Fb.a}get sR(){return this.lTb.sR}XEb(b){const h=new ec.a(new Zc.a);if(!b)return h;b=this.lTb.qOd(b);for(let v=0;v<b.length;v++){const D=b[v];this.IHb(D)&&h.add(D)}return h}COc(b){return this.lTb.COc(b)}XPd(b){const h=new Fb.a;if(b)for(const v of b)h.addRange(this.COc(v));return h}swk(b){const h=new ec.a(new Zc.a);if(b)for(const v of b)if(1===v.type&&(b=v))for(const D of b.Fv){h.add(D);this.sR.add(D);const P=D.toString();this.Afd[P]||(this.Afd[P]=new Fb.a);this.Afd[P].add(b)}this.ZDh();
return h}IHb(b){return this.sR&&b?this.sR.contains(b):!1}kNc(b,h){if(b&&(b=this.Afd[b.toString()])&&0<b.count){for(const v of b)if(v.objectId.equals(h))return v;return b.J(0)}return null}R7b(b){return this.lTb.R7b(b)}ZDh(){this.lTb.lYk()}JNc(b){return this.lTb.JNc(b)}k$h(b){if(!this.wK)return null;const h=this.wK.Kc;return h?h.Db(b):null}}Object(n.a)(zr,"ChangeIdCache",null,[]);var wn=c(151),Gq=c(102);class Ar extends wn.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=
null;this.H_=Object.assign(new Gq.a,{T_:Ar.getTypeName(),B_:Ar.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(n.a)(Ar,"ChangeSummariesResponse",wn.a,[]);var gp=c(439);class pq extends gp.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new Gq.a,{T_:pq.getTypeName(),B_:pq.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(n.a)(pq,"ChangeSummariesRequest",gp.a,[]);var lo=c(329),ei=c(367),Nk=c(236),Ja=c(330);class Eb{constructor(){this.phc=this.A5c=null}}Object(n.a)(Eb,"ActionPair",null,[]);class jc{constructor(b,h,v,D){this.yvl=P=>{P=P.customData;const ca=this.s$i(P);ca&&(u.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.fsf(P)),ca.phc("Request timeout"))};this.jA=b;this.xV=h;this.Se=v;this.Gb=D;this.FEe=null;this.WOe=
new ac.a;this.kdh=new ac.a}GFo(b){const h=Object.assign(new lo.a,{parentPath:["Signal",pq.getTypeName()],items:[Object.assign(new ei.a,{body:b})]});return this.initialize().then(()=>{const v=new Promise((D,P)=>{this.WOe.Z(b.requestId,Object.assign(new Eb,{A5c:D,phc:P}))});this.kdh.Z(b.requestId,new Date);u.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",jc.requestTimeoutMs);this.xV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ja.a,
{operation:h}));this.pno(b.requestId);return v})}initialize(){this.FEe||(this.FEe=this.jA.Mk().then(()=>{this.Se.nb(this,Ar.getTypeName())}));return this.FEe}EA(b,h){if(b&&Nk.a.getTypeNameFor(b.content)===Ar.getTypeName())if(b=b.content){var v=this.s$i(b.correspondingRequest);v?h!==lo.a.getTypeName()?v.phc("Invalid operation type"):(u.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.fsf(b.correspondingRequest)),
v.A5c(b)):u.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.fsf(b.correspondingRequest))}else u.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else u.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}pno(b){const h=new qf.a(3,1,jc.requestTimeoutMs,
this.yvl,176);h.Fyd=0;h.customData=b;this.Gb.Vb(h)}s$i(b){if(!b)return null;let h;if(!({value:h}=this.WOe.Dc(b,h)).returnValue)return null;this.WOe.remove(b);return h}fsf(b){if(!b)return-1;let h;return({value:h}=this.kdh.Dc(b,h)).returnValue?(new Date).getTime()-h.getTime():-1}static get requestTimeoutMs(){return w.AFrameworkApplication.K.mc("ChangeSummariesRequestTimeoutMs",5E3)}}Object(n.a)(jc,"ChangeSummariesAugloopProvider",null,[359]);class Fc{constructor(){this.activityGroups=null}}Object(n.a)(Fc,
"FeaturedActivityGroupPayload",null,[]);class gd{constructor(b,h,v,D,P){this.Uhk=b;this.EXj=h;this.wZj=v;this.b2j=D;this.qrb=P}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.b2j.Rwb.then(()=>this.dXl(b)):gd.Dhf}Xmm(b,h,v){if(!h)return u.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;rm("TranslateFeaturedActivityGroups");v=this.wZj.aOo(b,h,v.wywaActivities);u.ULS.sendTraceTag(542942800,377,
50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",0<b.activityChanges.length,0<h.inferences.length,0<v.length);this.qrb.set(h.correspondingRequest,v);return Object.assign(new Fc,{activityGroups:v})}dXl(b){rm("BuildFeaturedActivityGroupRequest");const h=this.Uhk.JNk();if(!h||!h.documentContent||!h.activityChanges)return u.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),
gd.Dhf;if(!h.documentContent.length||!h.activityChanges.length)return gd.Dhf;u.ULS.sendTraceTag(578954499,377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+h.requestId);rm("SubmitFeaturedActivityGroupRequest");return this.EXj.GFo(h).then(v=>this.Xmm(h,v,b))}}gd.Dhf=Promise.resolve(Object.assign(new Fc,{activityGroups:[]}));Object(n.a)(gd,"ChangeSummariesDataProvider",null,[564]);class ae{constructor(b,h){this.Xx=b;this.Fmk=h}JNk(){const b=new Fb.a,
h=new Fb.a,v=new ec.a(new Zc.a);var D=this.Xx.sR;if(!D||!D.count)return ae.Ghf;D=this.Xx.XPd(D);if(!D||!D.count)return u.ULS.sendTraceTag(592056450,377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),ae.Ghf;for(const P of D)v.contains(P.id)||(v.add(P.id),this.RJn(P,b,h));return h.count&&b.count?Object.assign(new pq,{activityChanges:h.toArray(),documentContent:b.toArray(),requestId:Vm.a(W.a.create())}):ae.Ghf}RJn(b,h,v){if(fe.ParagraphReader.Wb(b)){var D=
fe.ParagraphReader.plainText(b);if(D&&D.length){h.add(D);D=this.Xx.XEb(b);D=this.fmm(D);for(const P of D){D=new Fb.a;const ca=this.getTextRanges(b,P);for(const ta of ca)D.add({changeEnd:ta.endIndex,changeSpanId:ta.ugo,changeStart:ta.startIndex,contentIndex:h.count-1,locationId:Vm.a(b.id)});(D=this.p9k(P,D.toArray()))&&v.add(D)}}else u.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else u.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}fmm(b){const h=
new ac.a;for(const v of b)(b=this.kei(v))?(h.mb(b)||h.Z(b,new ec.a(new Zc.a)),h.J(b).add(v)):u.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return h.values}p9k(b,h){const v=[];let D=null;for(const P of b)if(b=this.Xx.kNc(P,W.a.nil)){if(!D){const ca=this.kei(P);if(!ca||!ca.length){u.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}D=
ca}v.push(b)}else u.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");return v.length?D?h.length?{activityId:v[0].activityId,changes:h,personId:D,timestamp:v[0].displayTimestamp.toISOString()}:(u.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(u.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),
null):(u.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),null)}kei(b){b=this.Xx.kNc(b,W.a.nil);if(!b)return u.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return u.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),
null;let h=b[0].id;h&&h.length||(h=b[0].email);return h}getTextRanges(b,h){const v=new Fb.a;if(!h||!h.count||!b)return v;let D=-1,P=new ec.a(new Zc.a);for(let ca=0;ca<b.pa.length;ca++){const ta=b.pa.J(ca);if(-1!==D&&ta.isChangeEnd){if(ta.changeStart&&h.contains(ta.changeStart)){P.add(ta.changeStart);continue}v.add({startIndex:D,endIndex:ta.cp,ugo:this.Fmk.Pjj(P)});D=-1;P=new ec.a(new Zc.a)}ta.changeStart&&h.contains(ta.changeStart)&&(D=ta.cp,P.add(ta.changeStart))}return v}}ae.Ghf=Object.assign(new pq,
{activityChanges:[],documentContent:[],requestId:Vm.a(W.a.nil)});Object(n.a)(ae,"ChangeSummariesRequestBuilder",null,[]);class ef{constructor(){this.changes=this.content=null}}Object(n.a)(ef,"ContentChange",null,[]);class Ae{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(n.a)(Ae,"FeaturedActivityGroup",null,[]);class Jf{constructor(){this.end=this.start=0}}Object(n.a)(Jf,"TextRange",null,[]);class Pf{constructor(b){this.Joc=b}aOo(b,h,v){if(!h)return u.ULS.sendTraceTag(588379906,
377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),Pf.kKd;if(!h.inferences)return u.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),Pf.kKd;if(!h.activityClassifications)return u.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),Pf.kKd;if(!h.inferences.length||!h.activityClassifications.length)return u.ULS.sendTraceTag(561111455,
377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),Pf.kKd;const D=[],P=new Ia.a(new Zc.a);for(const ca of h.inferences){const ta=this.$No(ca,b,h,v);if(!ta)continue;const Ra=this.Joc.t0l(Vm.b(ta.locationId));Ra.equals(W.a.nil)?D.push(ta):P.mb(Ra)?P.J(Ra).ranking>ta.ranking&&P.Z(Ra,ta):P.add(Ra,ta)}b=[...Array.from(P.values),...D];b.sort((ca,ta)=>ca.ranking-ta.ranking);return b.slice(0,Pf.Pbn)}$No(b,h,v,D){if(!b||Wl.a.jf(b.activitiesInGroup))return u.ULS.sendTraceTag(588379909,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),null;const P=new Fb.a,ca=new ac.a;let ta=null;for(const mb of b.activitiesInGroup){if(!mb){u.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>mb.activityIndex||mb.activityIndex>=v.activityClassifications.length){u.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");
continue}const Jb=v.activityClassifications[mb.activityIndex];if(!Jb||Wl.a.jf(Jb.contents))u.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Ra=this.UCl(D,Jb.activityId);if(Ra){P.add(Ra);for(const Ub of mb.changes){if(!Ub){u.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Ra=Ub.value;if(0>Ra||Ra>=Jb.contents.length){u.ULS.sendTraceTag(576251592,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");continue}Ra=Jb.contents[Ra];if(!Ra){u.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");continue}const cc=h.documentContent[Ra.contentIndex],Ac=Object.assign(new Jf,{start:Ra.changeStart,end:Ra.changeEnd});if(ca.mb(cc))ca.J(cc).add(Ac);else{let Lc;ca.Z(cc,(Lc=new Fb.a,Lc.add(Ac),Lc))}ta||(ta=Ra.locationId)}}else u.ULS.sendTraceTag(588379913,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!P.count)return u.ULS.sendTraceTag(588379914,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;h=this.Vhm(ca);return h.count?Object.assign(new Ae,{ranking:b.ranking.value,reasons:[1],activities:P.toArray(),contentChanges:h.toArray(),locationId:ta}):(u.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),
null)}UCl(b,h){for(const v of b)if(v&&v.activityId&&v.activityId===h)return v;return null}Vhm(b){const h=new Fb.a;for(const D of b){b=D.key;const P=D.value;P.Sc((ca,ta)=>ca.start-ta.start);var v=P.J(0).start;if(v>Pf.LNi){v-=Pf.LNi;b=b.substring(v,b.length);for(const ca of P)ca.start-=v,ca.end-=v}h.add(Object.assign(new ef,{content:b,changes:P.toArray()}))}return h}}Pf.kKd=[];Pf.LNi=10;Pf.Pbn=4;Object(n.a)(Pf,"ChangeSummariesResponseTranslator",null,[]);class Zg{constructor(){this.qrb=new ac.a;this.fQe=
new ac.a}set(b,h){if(h.length&&b){this.qrb.Z(b,h);for(const v of h)if(v.activities)for(const D of v.activities)D&&D.activityId?this.fQe.Z(D.activityId,b):u.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");else u.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.qrb.mb(b)?this.qrb.J(b):null}C9m(b){return b&&this.fQe.mb(b)?this.fQe.J(b):null}}Object(n.a)(Zg,"FeaturedActivityGroupCache",null,
[]);class $g{constructor(b){this.P2d=(h,v,D,P,ca)=>{if(!ca)return u.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),8;h=ca.Activity;if(!h)return u.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;v=this.qrb.C9m(h.activityId);if(!v)return u.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),
8;D=rd.TG(h);u.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",v,h.activityId,this.Pjj(D));return 32};this.qrb=b;this.wOg=new Map}Tb(b){b.qa(Nc.a.P2d,ud.a.frame,this.P2d)}Pjj(b){let h=0;const v=Array(b.count);for(const D of b)b=this.I6l(D),v[h]=Vm.a(b),h++;return v.join(",")}I6l(b){let h=this.wOg.get(b);if(h&&h!=W.a.nil)return h;h=W.a.create();this.wOg.set(b,h);return h}}Object(n.a)($g,"FeaturedActivityGroupTelemetryActor",
null,[]);var Ka=c(75);class Za extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(n.a)(Za,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class tb{constructor(b,h,v){this.NN=null;this.fOo=D=>{this.QYa.reset();D=this.Mhm(D.customData);let P=null;for(;D.moveNext();){const ca=D.currentNode;if(ca&&(fe.ParagraphReader.Wb(ca)&&this.ra.raiseEvent("OPV",new Za(ca)),this.QYa.update(),this.QYa.Ilb())){P=ca;break}}P?this.Mph(P):this.NN(!0)};this.Gb=b;this.QYa=h;this.wK=v;this.ra=new Mc.a;this.Rwb=new Promise(D=>
{this.NN=D})}Myk(b){this.ra.addHandler("OPV",b)}GKk(){this.Mph(null)}Mph(b){const h=new qf.a(3,1,0,this.fOo,182);h.customData=b;this.Gb.Vb(h)}Mhm(b){if(!b)return Ka.a.Zo(this.wK);b=he.GraphIterator.$a(b);b.zb(7);return Ka.a.Rs(b,this.wK)}}Object(n.a)(tb,"DocumentTraverser",null,[]);class pc{constructor(b){this.pc=b}shouldShowEmptyExperienceButton(){return w.AFrameworkApplication.x0d()}getExplanationText(){return""}getCommandName(){return WordEditorIntl.WordEditorStrings.L_FileHistory}onButtonClick(){this.pc.Qb(Wa.a.wje,
2,null)}onInviteOthersButtonClick(){this.pc.Qb(Wa.a.k8,2,null)}}Object(n.a)(pc,"EmptyCatchUpBehaviorManager",null,[519]);class Ec{constructor(b,h){this.gHl=()=>{const v=document.getElementById("flyoutItem0");v&&(u.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),v.focus())};this.fp=b;this.Ub=h}initialize(){const b=this.Ub.fe(Ne.AFrame.F2b);b.RH=!0;b.parent=Ne.AFrame.rp;b.pfa(this.gHl);this.fp.dT(Ne.AFrame.F2b)}enableF6Focus(){this.fp.FI(Ne.AFrame.F2b)}disableF6Focus(){this.fp.Xw(Ne.AFrame.F2b)}}
Object(n.a)(Ec,"FlyoutFocus",null,[518]);var ad=c(415);class wd{constructor(b,h,v){this.ANg=this.RXg=this.uvc=this.Amd=!1;this.wBe=this.kfd=null;this.mtn=(D,P,ca,ta,Ra)=>{Ra[If.a.Visible]=!0;Ra[If.a.On]=this.uvc&&this.Amd;return 32};this.dwn=(D,P,ca)=>{if(1===ca)return this.Amd?(this.RXg||(this.RXg=!0,u.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.kfd)return u.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),
8;this.ANg=!0;this.kfd();return 32};this.ga=b;this.XVg=h;this.Ub=v}get Blf(){return this.wBe?this.wBe:(u.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set Blf(b){this.wBe=b}initialize(){this.Tb()}registerButtonClickedEvent(b){this.kfd&&u.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.kfd=b.buttonClickedCallback}onFlyoutInitialized(){var b;this.Amd&&u.ULS.sendTraceTag(588129367,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const h=(new Date).getTime()-this.Blf.getTime();u.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",h);this.Amd=!0;(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1))||ad.a.zRa("ribbon","catchUp");Xe.c(Wa.a.LUk,!0,void 0,void 0,void 0,h)}onFlyoutVisibilityChanged(b){this.uvc!==b.flyoutIsVisible&&
(this.uvc=b.flyoutIsVisible,Xa.App.xa&&Xa.App.xa.updateCommandUI(!0),this.uvc&&this.ANg&&this.Ub.mg(Ne.AFrame.F2b),this.uvc||this.XVg&&this.XVg.H2m())}logFlightTriggers(b){b.hasFlyoutData&&w.AFrameworkApplication.ue("WoCha187;WoCha187cf")}Tb(){this.ga.qa(Wa.a.gAj,ud.a.frame,this.dwn);this.ga.eb(Wa.a.c6i,ud.a.frame,this.mtn,96)}}Object(n.a)(wd,"FlyoutRibbonButton",null,[517]);var Td=c(148);class Je{constructor(b,h){this.sR=null;this.OXd=this.GAi=!1;this.YW=b;this.Re=h;this.tjb=new Td.a;this.uXd=new Map;
this.tjb.Z(1,new ec.a(new Zc.a));this.tjb.Z(0,new ec.a(new Zc.a));this.tjb.Z(2,new ec.a(new Zc.a));this.tjb.Z(3,new ec.a(new Zc.a));this.uXd.set(3,"CatchUpIndicatorVisible");this.uXd.set(1,"CatchUpIndicatorPreviewed");this.uXd.set(2,"CatchUpIndicatorSelected");this.aee=0}mKi(b,h){if(this.tjb.J(h).add(b)){this.R4m(h);switch(h){case 0:u.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:u.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");
break;case 2:u.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:u.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.iDh()}}Csn(b){this.Mwl();b=this.YW.XEb(b);for(const h of b)if(this.sR.remove(h)){this.aee++;break}}Mwl(){if(!this.sR){this.sR=new ec.a(new Zc.a);for(const b of this.YW.sR)this.sR.add(b)}}hCk(){u.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.aee);this.iDh()}iDh(){this.aee&&
(this.zWk(),this.kWk())}zWk(){!this.GAi&&.5<=this.tjb.J(0).count/this.aee&&(this.GAi=!0,Xe.c(Wa.a.NUk),u.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}kWk(){if(!this.OXd){var b="";1<=this.tjb.J(1).count&&(this.OXd=!0,b="previews");1<=this.tjb.J(2).count&&(this.OXd=!0,b="selections");this.OXd&&(Xe.c(Wa.a.GUk),u.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}R4m(b){(b=this.uXd.get(b))&&this.Re.logKpiUsage(b,0)}}Object(n.a)(Je,"IndicatorTelemetryActor",
null,[]);var Gf=c(477);c(1068);class li{constructor(b,h){this.c8c=b;this.jGc=h}Mjm(){return this.jGc.promise.then(b=>b.getWywaActivitiesResponse)}getActivities(b,h){return Gf.b(this.c8c.requestActivities(b,h))}getRelevantActivities(b,h){return this.jGc.promise.then(v=>v.getWywaActivitiesResponse.WywaWaterline===b?Promise.resolve(v.getRelevantActivitiesResponse):Gf.b(this.c8c.requestRelevantActivities(b,h)))}updateActivityState(b){return Gf.b(this.c8c.updateActivityState(b))}getActivityFeed(){return this.jGc.promise.then(b=>
void 0!==b.activityFeed?Promise.resolve(b.activityFeed):Gf.b(this.c8c.requestActivityFeed()))}updateWaterline(){return Gf.b(this.c8c.e6n())}}Object(n.a)(li,"ActivityRepository",null,[]);var hk=c(1069),Of=c(1578);class $h{constructor(b,h,v,D,P,ca=!1){this.activityContentManager=b;this.pc=h;this.Prl=v;this.Re=D;this.Mxm=P;this.obc=ca}tLf(b){const h=new Map;h.set("activityType",b.type.toString());this.Re.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:h})}GKf(b){this.Re.logKpiFailure("CatchUpNavigateToActivity",
b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}Ngn(b){try{const h=b.activity;this.tLf(b.activity);1==h.type&&this.Mxm.v3d();if(!this.activityContentManager.doesContentExist(h))return this.activityContentManager.wQo(h),this.GKf("Content does not exist"),Promise.resolve(2);const v={};let D=0;switch(h.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:v.ActivityId=h.activityId;v.NavigationId=atob(h.navigationId);D=this.pc.Qb(Wa.a.U8e,2,v);break;case 1:v.Activity=
h,v.NodeId=b.locationId,D=this.pc.Qb(Nc.a.Eeg,2,v),v.NodeId&&this.pc.Qb(Nc.a.P2d,2,v)}8==D&&this.GKf("Action failed")}catch(h){return u.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",h),this.GKf("Exception was thrown"),Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.Prl.Rwb.then(()=>this.Ngn(b))}}Object(n.a)($h,"WordActivityNavigationManager",null,[514]);var Mj;(function(b){b[b.default=0]="default";b[b.D48X48=1]="D48X48";
b[b.D64X64=2]="D64X64";b[b.D96X96=3]="D96X96";b[b.D120X120=4]="D120X120";b[b.D240X240=5]="D240X240";b[b.D360X360=6]="D360X360";b[b.D432X432=7]="D432X432";b[b.D504X504=8]="D504X504";b[b.D648X648=9]="D648X648"})(Mj||(Mj={}));Object(n.b)("ProfilePhotoDimension",Mj);var Sj=c(762),rf=c(1479);class Ue{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(n.a)(Ue,"ActivityFeedEntry",null,[]);const of=(b,h)=>h.LWc?pm.toArray(pm.select(pm.asEnumerable(b),
v=>{if(!v||!v.activityFeedItemPayload)return v;const D=JSON.parse(v.activityFeedItemPayload);var P=D.actor;if(!P||P.pictureUrl)return v;const ca=P.userPrincipalName||P.email;if(!ca)return v;P=h.JBb(ca,P.provider,w.AFrameworkApplication.im,0);if(!P)return v;D.actor.pictureUrl=P;return Object.assign(new Ue,{id:v.id,type:v.type,collectionId:v.collectionId,activityState:v.activityState,activityFeedItemPayload:JSON.stringify(D),timestamp:v.timestamp})})):b,Eg=(b,h)=>{const v=new Map,D=new Map;for(const P of b){if(!P||
!P.activityFeedItemPayload)continue;b=JSON.parse(P.activityFeedItemPayload).actor;if(!b)continue;const ca=b.email||b.userPrincipalName;ca&&!D.has(ca)&&D.set(ca,new Sj.a(ca,null,b.name))}D.forEach(P=>{const ca=h.o9b(P,6);v.set(P.UserId,ca)});return v};var Ag=c(502);class yk{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(n.a)(yk,"ActivityRequestPayload",null,[]);class Ai{constructor(){this.color=
this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(n.a)(Ai,"Person",null,[]);class hi extends uc{constructor(){super();this.relationship=0}}Object(n.a)(hi,"TaskActivity",uc,[]);class gl extends uc{constructor(){super();this.contentId=null}}Object(n.a)(gl,"CommentActivity",uc,[]);class ql extends gl{constructor(){super()}}Object(n.a)(ql,"CommentReplyActivity",gl,[]);class Nn extends gl{constructor(){super();this.A0i=null}}Object(n.a)(Nn,"MentionActivity",gl,[]);class zt{constructor(b,
h,v,D){this.rrb=b;this.NLa=h;this.Czc=v;this.RN=D;this.RN.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.rrb.Mjm().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.rbf("GetWYWAActivities",b);155===b.StatusCode&&(u.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.RN.isFirstDocumentOpen=!0);const h=this.Jkg(b.People);return Object.assign(new yk,{activities:this.Lme(b.Activities,h),actors:h,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,
lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,h){return this.rrb.getActivities(b,h).then(v=>{if(!v||v.StatusCode)throw this.rbf("GetActivities",v);const D=this.Jkg(v.People);return Object.assign(new yk,{activities:this.Lme(v.Activities,D),actors:D,hasMore:!v.RequestedRetrieved,highWaterline:v.HighWaterline,lowWaterline:v.LowWaterline})})}requestRelevantActivities(b){return this.rrb.getRelevantActivities(b,this.RN.isFirstDocumentOpen).then(h=>
{if(!h||h.StatusCode)throw this.rbf("GetRelevantActivities",h);const v=this.Jkg(h.People),D=this.Lme(h.NewActivities,v,2);h=this.Lme(h.OutstandingActivities,v,3);for(const P of h)D.push(P);return Object.assign(new yk,{activities:D,actors:v})})}updateActivityState(b){return this.rrb.updateActivityState(b)}requestActivityFeed(){return this.rrb.getActivityFeed().then(b=>({activityFeedItems:this.sBm(b),personaColorMap:this.aPk(b)}))}Lme(b,h,v=1){const D=[];if(!b)return D;for(const ta of b){var P=null;
b=[];b.push(h[ta.CreatorIndex]);switch(ta.ActivityType){case 1:P=ta;var ca=new rd;ca.Fv=new Fb.a;for(const Ra of P.ChangeIds)ca.Fv.add(Vm.b(Ra));ca.objectId=Vm.b(P.ObjectId);P=ca;break;case 2:P=ta;ca=new gl;ca.contentId=P.ContentId;ca.navigationId=P.NavigationId;P=ca;break;case 4:P=ta;ca=new Nn;b.push(h[P.MentioneeIndex]);ca.A0i=P.ParentContentId;ca.navigationId=P.NavigationId;P=ca;break;case 3:case 10:P=ta;ca=new ql;b.push(h[P.RepliedIndex]);ca.contentId=P.ContentId;ca.navigationId=P.NavigationId;
P=ca;break;case 6:case 7:case 8:case 9:P=ta,ca=new hi,b.push(h[P.MentioneeIndex]),ca.navigationId=P.NavigationId,ca.relationship=P.Relationship,P=ca}P&&(P.actors=b,P.displayTimestamp=new Date(ta.DisplayTimestamp),P.activityId=Vm.b(ta.ActivityId).toString(),P.type=ta.ActivityType,1!==v&&(P.relevancy=v),D.push(P))}return D}V8n(b,h,v){return this.Czc&&this.Czc.LWc?this.Czc.JBb(h,v,w.AFrameworkApplication.im,Mj.default):b}Jkg(b){if(!b)return null;const h=Array(b.length);for(let v=0;v<b.length;v++){if(!b[v])continue;
const D=new Ai;D.id=b[v].Id;D.provider=b[v].Provider;D.displayName=b[v].DisplayName;D.email=b[v].Email;D.imageUrl=this.V8n(b[v].PictureUrl,b[v].Email,b[v].Provider);this.NLa&&(D.color=this.NLa.o9b(new Sj.a(D.email,void 0,D.displayName),rf.a.catchUpFlyout));h[v]=D}return h}rbf(b,h){let v="null";h&&(v=Ag.a[h.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,v))}sBm(b){return this.Czc?of(b,this.Czc):b}aPk(b){return this.NLa?Eg(b,this.NLa):new Map}}Object(n.a)(zt,"WordActivityRequestManager",
null,[513]);class it{constructor(b,h,v){this.Cpd=0;this.Lzc=!1;this.X3g=null;this.updateWaterline=()=>{if(Xa.App.lostSession)u.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.Lzc||3>=this.Cpd){this.Lzc?this.Lzc=!1:this.Cpd++;const D=Math.max(this.Fa.mc("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-(+new Date-+this.X3g),0);u.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",D);gk.Task.delay(D).continueWith(()=>
{this.rrb.updateWaterline().then(()=>{this.Bfe();return null}).catch(()=>{this.Bfe();this.Lzc=!0;this.Cpd=0})})}else this.Bfe()};this.Fa=b;this.rrb=v;h.Wzd(()=>{this.Lzc=!0;this.X3g=new Date;this.Cpd=0})}start(){this.Bfe()}Bfe(){window.setTimeout(this.updateWaterline,6E4)}}Object(n.a)(it,"WordEditorActivityScheduler",null,[]);class Zx{constructor(){this.resolve=null;this.promise=new Promise(b=>{this.resolve=b})}Dho(b){this.resolve(b)}}Object(n.a)(Zx,"CatchUpNetworkRequestWorkerCache",null,[]);class Wq{constructor(b,
h,v){this.mhl=b;this.K=h;this.Re=v}SWf(b){b&&b.authors&&this.K4m(b.authors)}K4m(b){for(const h of b)h&&h.displayName===this.mhl&&(this.Re.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),u.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",h.id===this.K.jb("PresenceUserId"),h.email===this.K.jb("UserPrincipalName")))}}Object(n.a)(Wq,
"WywaAuthorComparator",null,[]);class nr{constructor(b){this.$0=b}v3d(){this.$0&&this.$0.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(n.a)(nr,"IndicatorSurveyActor",null,[]);var Br=c(1042),Ns=c(1034);class At{constructor(){this.OUk={crewAlias:"webasynccollabeng",featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get IUk(){return w.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")}get gCf(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChangeSummariesEnabled",
!1)}get Twi(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get jwi(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",!1)}get QXd(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get jYd(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCatchUpActivitiesReadyTelemetryFixV2Enabled",
!1)}get oVm(){return w.AFrameworkApplication.K.$("IsUserFromDifferentTenant")}get obc(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpMockDataEnabled",!1)}xc(b){rm("Configure");this.container=b;b.ha("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new Zx).singleInstance()}init(){rm("Init");this.IUk&&(N.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").sendMessage(2,
4,w.AFrameworkApplication.rootQuerySignature,Xa.App.webServiceBase+"OneNote.ashx",2,this.QXd)}),rm("HotStore"),Xa.App.C5.m2a.execute(()=>{rm("ChromeReady");Sk.a.get_instance().Ak(7,()=>{rm("ScriptDownload");(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").Uz.loadScript("catchUpActivity")).catch(b=>{u.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",
b)}).then(()=>this.Kmn()).catch(b=>{u.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",b)})})}))}Kmn(){rm("CreateObjectsAndInitializeState");this.L3m();this.A9k();return this.Nzm()}L3m(){u.ULS.sendTraceTag(592217358,377,50,"CatchUpActivity feature enabled successfully");u.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");u.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.gCf&&u.ULS.sendTraceTag(588130079,
3012,50,"ChangeSummaries is enabled");this.Twi&&u.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");this.jwi&&u.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");u.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",this.oVm);this.QXd&&u.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}Nzm(){this.sAm();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").Blf=new Date;rm("InitializeCatchUpApp");return this.E2b.initialize(Object.assign(new qk,
{featuredActivityGroupsEnabled:this.gCf,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.Twi,customDynamicEntryPointEnabled:this.jwi,activityFeedDataEnabled:this.QXd})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}A9k(){this.container.ha("WordEditor.CatchUpActivity.ChangeIdCache",()=>new zr(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),Jl.App.sn.ib.rc.Yc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",
()=>new Br.a(va.Health.instance,new Ns.a,this.OUk)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IActivityStateManager",()=>new Sr).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityContentManager",()=>new Jd(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),w.AFrameworkApplication.va,el.UISurfaces.vM(),this.obc)).as("Common.App.CatchUpActivity.IActivityContentManager").singleInstance();this.container.ha("WordEditor.CatchUpActivity.Network.ActivityRepository",
()=>new li(new hk.a(zb.a.bAj(this.container.Sa("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),()=>w.AFrameworkApplication.rootQuerySignature,Xa.App.webServiceBase+"OneNote.ashx",2,zb.a.bAj(this.container.Sa("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityRequestManager",()=>new zt(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),
this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.obc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new Bf(this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
Jl.App.sn.ib.rc,new Of.a(Jl.App.sn.ib.rc),Yh.a.instance,bd.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.DocumentTraverser",()=>{let b;b=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new Mi.a(50,Dd.a.af):new bo;return new tb(w.AFrameworkApplication.nc,b,Jl.App.sn.ib.rc.Yc)}).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorSurveyActor",
()=>new nr(this.container.Sa("Common.ISystemInitiatedFeedback"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityNavigationManager",()=>new $h(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),w.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),this.obc)).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new wd(w.AFrameworkApplication.va,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),bd.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FlyoutFocus",()=>new Ec($i.a.instance,bd.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",
()=>new Zg).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new Cl(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),Jl.App.sn.ib.rc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",()=>new $g(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IChangeSummariesDataProvider",
()=>new gd(new ae(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new jc(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),w.AFrameworkApplication.nc),new Pf(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),
this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),this.obc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.EmptyCatchUpBehaviorManager",()=>new pc(w.AFrameworkApplication.va)).as("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").singleInstance();this.E2b=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new fm,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),
activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),appColorUpdateIsEnabled:w.AFrameworkApplication.K.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),dataCulture:w.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.QXd?this.container.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),
flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),uiCulture:w.AFrameworkApplication.uiCulture,ulsLogger:new di.a}));this.E2b.setWebpackPublicPath(w.AFrameworkApplication.w5);this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightActor",()=>new hg(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WordEditorActivityScheduler",
()=>new it(w.AFrameworkApplication.K,ko.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new Je(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorActor",()=>new Ql(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
this.E2b.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),Jl.App.sn.ib.rc,this.container.Sa("Common.IZoomManager"),w.AFrameworkApplication.nc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!Xa.App.instance&&Xa.App.instance.Hoa,this.container.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Xa.App.instance&&Xa.App.instance.RC)).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorManager",()=>new Wm(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,Jl.App.sn.ib.rc.Yc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),w.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.jYd)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityAnnouncementManager",
()=>new xo(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("Common.Utils.IAriaNotifier"),w.AFrameworkApplication.va,bd.FocusManager.instance())).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WywaAuthorComparator",()=>new Wq(w.AFrameworkApplication.userName,w.AFrameworkApplication.K,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance()}sAm(){var b=this.container.resolve("Box4.Highlight.IHighlightManager"),
h=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");b.F5a(h);const v=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");b=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const D=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");h=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const P=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),
ca=Yh.a.instance,ta=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");ca.Pw(()=>{P.t_d?P.t_d=!1:(P.r6a&&v.VXi(null,null,!1),P.Pib&&v.bXi(null,null),D.J7e())});ca.Pw(Object(z.a)(h,h.uY,"onSelectionChanged"));this.E2b.getWywaEvent().addListener(Object(z.a)(b,b.SWf,"onWywaActivityReady"));b=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");this.E2b.getWywaEvent().addListener(Object(z.a)(b,b.SWf,"onWywaActivityReady"));const Ra=this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor");
ta.Myk((mb,Jb)=>{Jb&&Ra.Csn(Jb.node)});ta.Rwb.then(()=>{Ra.hCk()});this.E2b.getWywaEvent().addListener(()=>{ta.GKk()});D.Ywk((mb,Jb)=>{Jb&&v.bXi(Jb.uDb,Jb.Kqi)});D.Zwk((mb,Jb)=>{Jb&&v.VXi(Jb.uDb,Jb.Kqi,Jb.tuo)});D.Tb(w.AFrameworkApplication.va);this.gCf&&this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor").Tb(w.AFrameworkApplication.va);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();
this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();this.Eyo()}Eyo(){Rh.c()&&(u.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(n.a)(At,"WordEditorCatchUpActivityPackageManager",null,[1,2]);var Os=c(181),Hq=c(398),qq=c(1510),Xq=c(450),Tr=c(1618),Cr=c(1511),Yq=c(1682),Tk=c(1683),jt=c(632),mu=c(1684),
$x=c(852),nu=c(134),vp=c(1519);class En{constructor(){this.$s=this.annotation=null}}Object(n.a)(En,"AnnotationChangedData",null,[]);class Fu{constructor(b,h,v,D,P,ca,ta,Ra=!1,mb){this.annotationType=b;this.KE=h;this.Fq=v;this.Eke=D;this.Tbd=P;this.L1o=ca;this.ib=ta;this.aqj=Ra;this.K=mb;this.WA=null;this.JAi=!1;this.hd=new Mc.a;this.r_c=0}XF(b){this.hd.addHandler("AnnotationChangedEvent",b)}XH(b){this.hd.removeHandler("AnnotationChangedEvent",b)}register(){return this.Tbd().then(()=>{0===this.r_c&&
(this.aqj&&(this.WA=this.Fq.Zf("WebServiceCall",this.annotationType)),this.KE.nb(this,this.annotationType));this.r_c++})}unregister(){return this.Tbd().then(()=>(new Promise(b=>setTimeout(b,this.K.mc(nu.a.yml,3E3)))).then(()=>{0<this.r_c&&(this.r_c--,0===this.r_c&&this.KE.sc(this,this.annotationType))}))}p7b(){return this.Tbd().then(()=>this.KE.getAnnotationsByType(this.annotationType))}F4h(b){b=Hq.a.uM(b);return(b=this.KE.E4h(b))&&0<b.count?b.toArray().filter(h=>Nk.a.matchesTypesFor(h.content,[this.annotationType])):
[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.L1o(this.ib.Uc.od,b.parentPath):null:(u.ULS.shipAssertTag(575930380,3016,!1),null)}gva(b){b.timestamp||(b.timestamp=Date.now());b=Object.assign(new $x.a,{parentPath:["Signal",Nk.a.getTypeNameFor(b)],items:[Object.assign(new ei.a,{body:b})]});this.Eke.submitOperation(b)}Cul(b,h){b=Object.assign(new lo.a,{parentPath:["Signal",h],items:b});this.Eke.submitOperation(b)}EA(b,h){b?h?(this.aqj&&!this.JAi&&(this.WA.stop(),this.JAi=!0),this.hd.y8&&
(b=new vp.a(Object.assign(new En,{annotation:b,$s:h})),this.hd.raiseEvent("AnnotationChangedEvent",b))):u.ULS.shipAssertTag(575930382,3016,!1):u.ULS.shipAssertTag(575930381,3016,!1)}}Object(n.a)(Fu,"AnnotationManager",null,[572,359]);class $u{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub){this.cJ=b;this.cfe=h;this.KDb=v;this.H0a=D;this.Z7=P;this.mzj=ca;this.n1=ta;this.iQb=Ra;this.t5b=mb;this.iMb=Jb;this.wIo=Ub}}Object(n.a)($u,"AnnotationManagerHolder",null,[571]);class or{constructor(b,h){this.OW=b;this.Tbd=
h}submitOperation(b){return this.Tbd().then(()=>{this.OW.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ja.a,{operation:b}))})}}Object(n.a)(or,"SubmitOperationHelper",null,[]);var uw=c(868),Dv=c(1685),Ev=c(1066),Vg=c(96),Po=c(122),Yo=c(78),Al=c(1086);class Bt{constructor(b,h,v){this.Z7=b;this.Nm=h;this.jLb=v;this.JDa={};this.MTh=!1;this.fmb=(D,P)=>{var ca;P.data.$s!==lo.a.getTypeName()&&P.data.$s!==Al.n.getTypeName()||!P.data.annotation||P.data.annotation.annotationType!==Dv.a.getTypeName()||
(D=P.data.annotation.content)&&null!==(ca=D.documentTypeConfidences)&&void 0!==ca&&ca.length&&(this.LTh=D.documentTypeConfidences[0].documentTypeLabel,u.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.LTh))};this.Z7.XF(this.fmb);this.Z7.register();this.JDa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}lQd(){this.MTh||(this.Z7.gva(new Ev.a),
u.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.MTh=!0);this.agf();this.JDa.docType=this.LTh;this.JDa.characterCount=this.characterCount;this.JDa.paragraphCount=this.AR;this.JDa.imageCount=this.rJ;this.JDa.tableCount=this.e$;this.JDa.listElementsCount=this.AGi;this.JDa.blobsCount=this.pFc;this.JDa.pageCount=this.jLb.l9b();this.JDa.currentPage=this.jLb.Cdi();return this.JDa}agf(){this.AR=this.pFc=this.AGi=this.e$=this.rJ=this.characterCount=0;var b=this.Nm.Jva(Jl.App.sn.ib.rc.Yc,
7,7).currentNode,h=he.GraphIterator.$a(b);for(b=Ka.a.Rs(h,b);b.moveNext();)if(h=b.currentNode)if(oe.ImageReader.Ju(h))this.rJ++;else if(cj.TableReader.xU(h))this.e$++;else if(Vg.ListItemReader.yg(h))this.AGi++;else if(fe.ParagraphReader.Wb(h)){var v=Yo.e(h);for(let D=0;D<v.length;D++)5===v[D].zh?this.rJ++:this.pFc++;v=Po.AParagraphNode.IR(h.characterData);v=v.trim();this.characterCount+=v.length;0<v.length&&!fe.ParagraphReader.f4(h)&&!fe.ParagraphReader.sU(h)&&this.AR++}}}Object(n.a)(Bt,"LoggingDocumentInfo",
null,[568]);class Jp{constructor(){this.ra=new Mc.a}hzk(b){this.ra.addHandler("OnTaskPaneReviewStateChanged",b)}A2n(b){this.ra.removeHandler("OnTaskPaneReviewStateChanged",b)}dyk(b){this.ra.addHandler("BlueDotClickedEvent",b)}f2n(b){this.ra.removeHandler("BlueDotClickedEvent",b)}ryk(b){this.ra.addHandler("OnFormattingMarkedForReview",b)}tyk(b){this.ra.addHandler("OnFormattingReviewCompleted",b)}qyk(b){this.ra.addHandler("OnFormattingAccept",b)}syk(b){this.ra.addHandler("OnFormattingReject",b)}Yyk(b){this.ra.addHandler("OnReviewInvalidated",
b)}Vqh(b){this.ra.addHandler("OnTraigeAction",b)}X_e(b){this.ra.addHandler("OnReviewVisibilityChanged",b)}t2n(b){this.ra.removeHandler("OnReviewVisibilityChanged",b)}ayk(b){this.ra.addHandler("OnBeforeReviewNavigation",b)}Uyk(b){this.ra.addHandler("OnRegisterEnhancement",b)}jzk(b){this.ra.addHandler("onTooltipVisibilityChanged",b)}B2n(b){this.ra.removeHandler("onTooltipVisibilityChanged",b)}I3c(b){b?this.ra.raiseEvent("OnTaskPaneReviewStateChanged",new vp.a(b)):u.ULS.shipAssertTag(575930374,3016,
!1)}cPn(b){b?this.ra.raiseEvent("BlueDotClickedEvent",new vp.a(b)):u.ULS.shipAssertTag(575930375,3016,!1)}fPn(b){b?this.ra.raiseEvent("OnFormattingMarkedForReview",new vp.a(b)):u.ULS.shipAssertTag(575930376,3016,!1)}G6i(b){b?this.ra.raiseEvent("OnFormattingReviewCompleted",new vp.a(b)):u.ULS.shipAssertTag(573850377,3016,!1)}ePn(b){b?this.ra.raiseEvent("OnFormattingAccept",new vp.a(b)):u.ULS.shipAssertTag(575930377,3016,!1)}gPn(b){b?this.ra.raiseEvent("OnFormattingReject",new vp.a(b)):u.ULS.shipAssertTag(575930378,
3016,!1)}hPn(b){b?this.ra.raiseEvent("OnReviewInvalidated",new vp.a(b)):u.ULS.shipAssertTag(575930379,3016,!1)}Q2f(b){b?this.ra.raiseEvent("OnTraigeAction",new vp.a(b)):u.ULS.shipAssertTag(573850378,3016,!1)}H6i(b){b?this.ra.raiseEvent("OnReviewVisibilityChanged",new vp.a(b)):u.ULS.shipAssertTag(573850379,3016,!1)}bPn(b){b?this.ra.raiseEvent("OnBeforeReviewNavigation",new vp.a(b)):u.ULS.shipAssertTag(573687395,3016,!1)}chc(b){b?this.ra.raiseEvent("OnRegisterEnhancement",new vp.a(b)):u.ULS.shipAssertTag(555055117,
3016,!1)}$6i(b){b?this.ra.raiseEvent("onTooltipVisibilityChanged",new vp.a(b)):u.ULS.shipAssertTag(540587343,3016,!1)}}Object(n.a)(Jp,"ReviewEvents",null,[502]);class fn{constructor(b){this.Yt=b;if(!b)throw Os.a.argument("Workspace is null");}get name(){return"WordEditor.Designer.Common"}init(){}xc(b){this.W=b;b.ha("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new or(this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),Hq.a.Mk)).singleInstance();b.ha("WordEditor.Designer.IDesignerControl",
()=>new uw.a(b.resolve("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager"),w.AFrameworkApplication.uiCulture)).singleInstance();b.ha("WordEditor.Designer.Common.Review.IReviewEvents",()=>new Jp).singleInstance();b.ha("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new $u(this.iDa(Cr.DocumentRoleDetectionAnnotation.getTypeName()),this.iDa(Cr.RoleDetectionAnnotation.getTypeName()),this.iDa(qq.FormattingSuggestionsSummaryAnnotation.getTypeName(),!0),this.iDa(qq.FormattingSuggestionsAnnotation.getTypeName()),
this.iDa(Xq.DocumentTypeClassifierAnnotation.getTypeName()),this.iDa(Tk.ThemeExtractorAnnotation.getTypeName()),this.iDa(jt.ThemeGeneratorAnnotation.getTypeName()),this.iDa(Yq.TextToImageAnnotation.getTypeName()),this.iDa(Tr.DocumentPullQuoteAnnotation.getTypeName()),this.iDa(Tr.PullQuoteAnnotation.getTypeName()),this.iDa(mu.TableTypeAnnotation.getTypeName()))).singleInstance();b.ha("WordEditor.Designer.DocumentInfo",()=>new Bt(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Z7,
b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("WordEditor.IPageNumberFinder"))).singleInstance()}dispose(){}iDa(b,h=!1){return new Fu(b,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),Hq.a.Mk,Hq.a.Vhb,this.Yt,h,this.W.resolve("Common.IAppSettingsManager"))}}Object(n.a)(fn,"PackageManager",null,[1,2]);var ou=c(1030),is=c(1503),T=c(1688);class Aa extends Sys.EventArgs{constructor(b,
h){super();this.node=b;this.dRf=h}}Object(n.a)(Aa,"RoleChangeArgs",Sys.EventArgs,[]);class ib{constructor(b){this.Kh=!1;this.Y6=b;this.Y6.Vld++}dispose(){this.Kh||(this.Kh=!0,this.Y6.Vld--)}}Object(n.a)(ib,"InvalidationSuspension",null,[10]);class Tb{constructor(){this.c$c=null;this.role=this.Q4d=0;this.Jzb=this.A_d=this.tha=this.lcc=!1;this.Z3d=this.RYc=this.HOa=null;this.removed=this.placeholder=!1;this.TAd=this.ecf=null;this.SAd=0}get T2a(){return!this.role||!this.HOa||!this.HOa.length}TEm(){this.Jzb=
this.A_d=!0}EVm(){return!!this.role||!!this.HOa||!!this.c$c}}Object(n.a)(Tb,"RoleState",null,[529]);class xc{constructor(b,h,v,D,P){this.Zh=!1;this.CXd=null;this.sMf=new fc.a;this.IYg=0;this.m$n=(ca,ta)=>{ta.data.$s===lo.a.getTypeName()&&(ta=ta.data.annotation,(ca=ta.content)?(ta=this.QYb.getParent(ta))&&this.y7c(ta,is.e(ca.roleType),!1,void 0,null!=ca.listID?ca.listID:0,ca.listItemlevel,ca.listItemPrefix):u.ULS.shipAssertTag(575813856,3016,!1))};this.Arl=(ca,ta)=>{if(ta.data.$s===lo.a.getTypeName())if(ca=
ta.data.annotation.content)for(u.ULS.sendTraceTag(556074199,3016,50,ca.confidence.toString()),this.sMf=new fc.a,ta=0;ca.listInfos&&ta<ca.listInfos.length;ta++){const Ra=ca.listInfos[ta];this.sMf.Z(Ra.listID,Ra)}else u.ULS.shipAssertTag(556323522,3016,!1)};this.Azi=(ca,ta)=>{ca=ca.mN;if(!ca||ca.ia(Bc.a.nB,!1))return!1;ca=ca.getValue(Bc.a.la);if(!ca)return!1;ca=is.f(ca);return 1!=ca&&ca!=ta.role};this.ZIl=(ca,ta)=>{ca=ta.data.annotation;const Ra=this.Pjd.getParent(ca);if(Ra)if(ta.data.$s===lo.a.getTypeName()){const mb=
ta.data.annotation.content;mb?this.oda(Ra,Jb=>{this.CXd&&Jb.ecf&&this.CXd>Jb.ecf&&!Jb.Jzb||Jb.role!==Jb.Q4d||this.Azi(Ra,Jb)?(u.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",this.CXd,Jb.Jzb,Jb.role===Jb.Q4d),Jb.c$c=mb.suggestions):(Jb.HOa=mb.suggestions,Jb.Jzb=!1)}):u.ULS.shipAssertTag(575813859,3016,!1)}else ta.data.$s===ou.a.getTypeName()&&this.oda(Ra,mb=>{mb.HOa=null;mb.c$c=null});else u.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${ca.id} parentPath: ${ca.parentPath}`)};
this.qpn=(ca,ta)=>{(ca=ta.data.paragraphNode)?this.oda(ca,Ra=>{ta.data.uJj?(Ra.TAd=Ra.HOa,Ra.SAd=Ra.role):(Ra.TAd=null,Ra.SAd=0);Ra.tha=!0}):u.ULS.shipAssertTag(575930368,3016,!1)};this.spn=(ca,ta)=>{(ca=ta.data.paragraphNode)?this.oda(ca,Ra=>{Ra.tha=!1;Ra.TAd=null;Ra.SAd=0;5!==ta.data.state&&(Ra.HOa=null)}):u.ULS.shipAssertTag(573850380,3016,!1)};this.opn=(ca,ta)=>{(ca=ta.data.paragraphNode)?this.oda(ca,Ra=>{Ra.tha=!0}):u.ULS.shipAssertTag(575930369,3016,!1)};this.rpn=(ca,ta)=>{(ca=ta.data.paragraphNode)?
this.y7c(ca,1,!0,!0):u.ULS.shipAssertTag(575930370,3016,!1)};this.AWf=(ca,ta)=>{(ca=ta.data.paragraphNode)?this.y7c(ca,ta.data.dRf,!0,!0):u.ULS.shipAssertTag(575484484,3016,!1)};this.Hlm=(ca,ta)=>{if(ta.node){var Ra=ta.node;ca=this.BA(Ra);27==ca.role&&u.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");ca.tha&&27!==ca.role&&28!==ca.role&&this.Xoj(this.HNb-1);ca.T2a||27===ca.role||28===ca.role||this.Qoj(this.inconsistenciesCount-1);this.oda(Ra,mb=>{mb.removed=!0});setTimeout(()=>this.removeNode(Ra),
1E4)}else u.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=ca=>{let ta;({value:ta}=this.tu.Dc(ca.id));(null===ta||void 0===ta?0:ta.removed)&&this.tu.remove(ca.id)};this.Glm=(ca,ta)=>{ta.node?(ca=ta.node,this.pFf(ca)?this.oda(ca,Ra=>{Ra.removed=!1}):this.oda(ca,Ra=>{Ra.Jzb=!1})):u.ULS.shipAssertTag(540672206,3016,!1)};this.Ilm=(ca,ta)=>{ta.node?this.sdg(ta.property,ta.node)&&(ca=ta.node,this.Vld||ca.vae?this.oda(ca,Ra=>{Ra.Jzb=!1}):this.oda(ca,Ra=>{Ra.TEm();Ra.c$c&&(Ra.HOa=Ra.c$c,Ra.role=Ra.Q4d)}).tha&&
this.YXa.hPn(new T.a(ta.node))):u.ULS.shipAssertTag(575930372,3016,!1)};this.Etn=(ca,ta)=>{switch(ta.data.role){case 27:const Ra=ta.data;this.oda(ta.data.paragraphNode,Jb=>{Jb.role=27;Jb.lcc=!0;Jb.placeholder=Ra.placeholder});break;case 28:const mb=ta.data;this.oda(ta.data.paragraphNode,Jb=>{Jb.role=28;Jb.lcc=!0;Jb.placeholder=mb.placeholder;Jb.coa=mb.coa});break;case 2:this.oda(ta.data.paragraphNode,Jb=>{Jb.role=2})}};this.Pjd=b;this.QYb=h;this.kze=v;this.Oq=D;this.YXa=P;this.tu=new fc.a;this.ra=
new Mc.a;this.Vld=this.Atd=this.Ald=0}get oFm(){return this.Vld}wyk(b){this.ra.addHandler(xc.vVi,b)}bzk(b){this.ra.addHandler(xc.FXi,b)}azk(b){this.ra.addHandler(xc.EXi,b)}get inconsistenciesCount(){return this.Ald}Qoj(b){this.Ald!==b&&(this.Ald=b,this.ra.raiseEvent(xc.vVi,new vp.a(this.Ald)))}get HNb(){return this.Atd}Xoj(b){this.Atd!==b&&(this.Atd=b,this.ra.raiseEvent(xc.FXi,new vp.a(this.Atd)))}get kyf(){return this.IYg}pFf(b){return this.tu.mb(b.id)}z3l(b){var h,v;return null===(v=null===(h=this.sMf)||
void 0===h?void 0:h.Dc(b))||void 0===v?void 0:v.value}Tdi(b,h){var v,D,P;const ca=new Map;for(const ta of h)if(h=ta){const Ra=null!==(P=null===(D=null===(v=this.tu.Dc(h.id))||void 0===v?void 0:v.value)||void 0===D?void 0:D.role)&&void 0!==P?P:1;b.has(Ra)&&(ca.has(Ra)?ca.get(Ra).add(h):ca.set(Ra,new Fb.a([h])))}return ca}BA(b){if(!b)return u.ULS.shipAssertTag(575813855,3016,!1),null;let h;return({value:h}=this.tu.Dc(b.id)).returnValue?h:Object.assign(new Tb,{role:1,lcc:!1})}S5n(){this.CXd=new Date;
return new ib(this)}register(){this.Pjd.register();this.QYb.register();this.kze.register()}unregister(){this.Pjd.unregister();this.QYb.unregister();this.kze.unregister()}initialize(){if(!this.Zh){const b=this.Oq.Ze(12);b.Ax(this.Hlm);b.$t(this.Glm);b.Go(this.Ilm);this.Pjd.XF(this.ZIl);this.QYb.XF(this.m$n);this.kze.XF(this.Arl);this.YXa.syk(this.rpn);this.YXa.qyk(this.opn);this.YXa.ryk(this.qpn);this.YXa.tyk(this.spn);this.YXa.Vqh(this.AWf);this.YXa.Uyk(this.Etn);this.Zh=!0}}Nd(){}y7c(b,h,v,D=!1,
P=0,ca=0,ta){let Ra=0,mb=!1;this.oda(b,Jb=>{const Ub=Jb.A_d||!Jb.role||1==Jb.role;v||(Jb.Q4d=h);if(D||Ub)mb=Jb.role!==h,Ra=Jb.role,Jb.role=h,Jb.lcc=v,Jb.A_d=!1,Jb.RYc=P,Jb.Z3d=ca,Jb.listItemPrefix=ta,Jb.ecf=new Date});if(mb){const Jb=h-4;Jb>this.kyf&&8>Jb&&(this.IYg=Jb);1===h&&this.oda(b,Ub=>{Ub.HOa=null});this.ra.raiseEvent(xc.EXi,new vp.a(new Aa(b,h,Ra)))}}oda(b,h){let v;if(({value:v}=this.tu.Dc(b.id)).returnValue){b=v.T2a;const D=v.tha;h(v);if(27!==v.role&&28!==v.role){if(v.removed)return v;b!==
v.T2a&&this.Qoj(this.inconsistenciesCount+(b?1:-1));D!==v.tha&&this.Xoj(this.HNb+(D?-1:1))}}else h(v=new Tb),v.EVm()&&this.tu.add(b.id,v);return v}sdg(b,h){({value:h}=this.tu.Dc(h.id));return 28===(null===h||void 0===h?void 0:h.role)?!(null===h||void 0===h?0:h.placeholder)&&b===lf.a.lo:!(null===h||void 0===h?0:h.placeholder)&&(b===lf.a.lo||b===lf.a.Gn||Array.contains(Po.AParagraphNode.$ga(),b))}}xc.vVi="OnInconsistenciesChanged";xc.FXi="OnRoleReviewCount";xc.EXi="OnRoleChanged";Object(n.a)(xc,"RoleLifecycleManager",
null,[505,506,507]);class ld{constructor(b,h,v,D,P){this.YXa=b;this.QYb=h;this.Se=v;this.Oq=D;this.Y6=P;this.Zh=!1;this.AWf=(ca,ta)=>{(ca=ta.data.paragraphNode)?this.RFj(ca,()=>!0,Ra=>Ra.userSetRole=is.d(ta.data.dRf)):u.ULS.shipAssertTag(557057378,3016,!1)};this.ysn=(ca,ta)=>{0<this.Y6.oFm||this.sdg(ta.property)&&this.RFj(ta.node,Ra=>!(Ra&&Ra.isInvalidated),Ra=>Ra.isInvalidated=!0)}}initialize(){this.Zh||(this.YXa.Vqh(this.AWf),this.Oq.Ze(12).Go(this.ysn),this.Zh=!0)}Nd(){}RFj(b,h,v){if(b=(b=this.QYb.F4h(b))&&
1===b.length&&b[0]){var D=b.content;D=D&&D.M_&&D.M_.customMetadata;h(D)&&(h=new Cr.RoleDetectionCustomMetadata,h.isInvalidated=D&&D.isInvalidated,h.userSetRole=D&&D.userSetRole,v(h),this.Se.pUo(b,h))}}sdg(b){return b===lf.a.lo||b===lf.a.Gn||Array.contains(Po.AParagraphNode.$ga(),b)}}Object(n.a)(ld,"RoleDetectionMetadataUpdater",null,[504]);class Sd{constructor(b,h){this.Eke=b;this.yCb=h;this.S_c=(v,D)=>{v=D.data;if(v.$s==Al.a.getTypeName()||v.$s==Al.n.getTypeName())if(v=v.annotation&&v.annotation.content)this.runId=
v.runId};this.revisionId=0}initialize(){this.yCb.XF(this.S_c)}Nd(){this.yCb.XH(this.S_c)}Vln(){if(void 0===this.runId)Promise.resolve();else{var b=new Cr.RoleDetectionSettings({acceptedRunId:this.runId});b=new Al.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.Eke.submitOperation(b)}}}Object(n.a)(Sd,"RoleDetectionSettingsUpdater",null,[]);class df{constructor(b,h,v){this.fEm=b;this.KE=h;this.Xd=v;this.Ysi=this.initialized=
!1;this.tTi=()=>{this.Dqj()&&(this.yri(),this.KE.Y1n(this.tTi))}}initialize(){this.initialized||(this.iAf(),this.initialized=!0)}Nd(){}iAf(){this.Dqj()?this.yri():this.KE.Pxk(this.tTi)}Dqj(){return!this.Ysi&&(this.Xd.ywi()||this.KE.$$b(Cr.DocumentRoleDetectionAnnotation.getTypeName())||this.KE.$$b(Cr.RoleDetectionAnnotation.getTypeName()))}yri(){for(const b of this.fEm)b.initialize();this.Ysi=!0}}Object(n.a)(df,"RLMInitializer",null,[]);class De{constructor(b,h,v){this.WY=b;this.Yt=h;this.Ied=v;this.W=
null;this.ija=()=>{this.qTc();this.Yt.Knb(this.ija)};if(!b)throw Os.a.argument("AppLifecycleManager is null");if(!h)throw Os.a.argument("Workspace is null");if(!v)throw Os.a.argument("ApplicationInstance is null");}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>this.hn())}xc(b){this.W=b;b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",()=>new Sd(this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),
b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").cJ)).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",()=>new ld(b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").cfe,b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",
()=>new xc(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").H0a,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").cfe,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").cJ,b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",()=>b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).singleInstance();
b.ha("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new df([this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("WordEditor.Designer.IDesignerControl"))).singleInstance()}dispose(){}hn(){this.Ied.xJ?this.WY.Ak(16,()=>this.ESc()):this.ESc()}ESc(){this.Yt.xwa?this.qTc():this.Yt.sfa(this.ija)}qTc(){this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();
this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}Object(n.a)(De,"PackageManager",null,[1,2]);class Ff{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,h){const v=new Ff;v.ContractVersion=b;v.FileName=h;v.Paragraphs=[];return v}}Object(n.a)(Ff,"DocumentSwayPreviewContent",null,[]);class Wg{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static b7k(b,h,v,D){const P=
new Wg;P.RawText=b;P.ParagraphFormatting=h;P.TextRuns=v;P.IsRTL=D;P.ParagraphIndex=0;return P}}Object(n.a)(Wg,"ParagraphContent",null,[]);var Vh=c(92),zk=c(1195);class Wi{constructor(){this.Name=null;this.Size=0}static construct(b,h){const v=new Wi;v.Name=b;v.Size=h;return v}}Object(n.a)(Wi,"FontData",null,[]);class dk{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,h,v,D,P,ca){const ta=new dk;ta.IsBold=b;ta.IsUnderline=
h;ta.IsUppercase=v;ta.Font=D;ta.Alignment=P;ta.LeftIndent=ca;return ta}}Object(n.a)(dk,"TextFormatting",null,[]);class mo{constructor(){this.RunFormatting=this.RawText=null}static construct(b,h){const v=new mo;v.RawText=b;v.RunFormatting=h;return v}}Object(n.a)(mo,"TextRunContent",null,[]);var Kl=c(103),ig=c(40);class Uk{constructor(b,h){this.f$a=null;this.nak=b;this.EN=h||""}get Xzn(){return this.nak.value}hAl(){var b=Date.now();const h=Ff.construct(2,this.EN);h.Paragraphs=this.UMl();b=Date.now()-
b;const v={};v.ExtractionDurationInMs=b.toString();u.ULS.sendTraceTag(25268374,382,50,"{0}",v);return h}UMl(){const b=new Fb.a;var h=0;let v=0,D=!1;var P=new he.GraphIterator;P.set(this.Xzn);P=Ka.a.Zo(P.currentNode);const ca=new fc.a(0);for(;P.moveNext()&&2100>v&&25>h;){var ta=P.currentNode;if(fe.ParagraphReader.Wb(ta)&&!fe.ParagraphReader.f4(ta)){!D&&fe.ParagraphReader.sU(ta)&&(D=!0);let Ra=Po.AParagraphNode.IR(ta.characterData);Ra=Ra.trim();if(0<Ra.length){const mb=this.$T(ta);mb.ParagraphIndex=
h;h++;v+=Ra.length;b.add(mb);this.IXo(ca,fe.ParagraphReader.language(ta))}}}this.f$a=this.KTl(ca);h={};h.documentHasList=D;u.ULS.sendTraceTag(25776736,382,50,"{0}",h);return b.toArray()}KTl(b){let h=-1,v=1033;for(const D of b.keys.toArray())D&&b.J(D)>h&&(h=b.J(D),v=D);return ok.a.sg(v)}IXo(b,h){b.mb(h)?b.Z(h,b.J(h)+1):b.Z(h,1)}$T(b){const h=Po.AParagraphNode.IR(b.characterData),v=this.Y7l(b),D=this.Egm(b);b=this.oQm(b);return Wg.b7k(h,v,D,b)}Y7l(b){const h=fe.ParagraphReader.Rn(b,lf.a.bold,!1),v=
fe.ParagraphReader.Rn(b,lf.a.underline,!1);var D=fe.ParagraphReader.Rn(b,lf.a.fontSize,Vh.a.oM);const P=fe.ParagraphReader.Rn(b,lf.a.font,Vh.a.nG);var ca=fe.ParagraphReader.Gx(b);ca=this.unf(ca);const ta=!!fe.ParagraphReader.Rn(b,Vi.a.capitalization,0);b=(new zk.a).XT(b).value/20;D=Wi.construct(P,D);return dk.construct(h,v,ta,D,ca,b)}Egm(b){const h=new Fb.a;for(let P=0;P<b.pa.length-1;P++){var v=b.pa.J(P),D=b.pa.J(P+1);v.formatting&&(D=Po.AParagraphNode.IR(b.characterData.substr(v.cp,D.cp-v.cp)),
v=this.Fgm(v.formatting),v=mo.construct(D,v),h.add(v))}return h.toArray()}Fgm(b){const h=Kl.FormattingReader.SPc(b,lf.a.bold,!1),v=Kl.FormattingReader.SPc(b,lf.a.underline,!1);var D=Kl.FormattingReader.SPc(b,lf.a.fontSize,Vh.a.oM);const P=Kl.FormattingReader.SPc(b,lf.a.font,Vh.a.nG);D=Wi.construct(P,D);b=!!Kl.FormattingReader.SPc(b,Vi.a.capitalization,0);return dk.construct(h,v,b,D,5,0)}unf(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}oQm(b){const h=
new he.GraphIterator;h.set(b);h.zb(11);return(b=h.jd(11))?ig.OutlineElementReader.$m(b):!1}}Object(n.a)(Uk,"DocumentContentExtractor",null,[457]);class no{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}xc(b){b.ha("WordEditor.DocumentContentExtractor.DocumentContentExtractor",()=>new Uk(new Gg.a(()=>Jl.App.sn.ib.rc.Yc),w.AFrameworkApplication.zs.gz)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").singleInstance()}static main(){N.a.instance.Fc(new no)}}Object(n.a)(no,
"DocumentContentExtractorPackage",null,[1,2]);class pr{}pr.Yg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(n.a)(pr,"EmbedDialogHtml",null,[]);class Ba{constructor(b,h,v,D){this.Cfc=b;this.e2a=h;this.m9d=v;this.value=D}}Object(n.a)(Ba,"OptionInfo",null,[]);class Qa{constructor(b,h,v){this.S9f=b;this.i$b=h;this.e2a=v}}Object(n.a)(Qa,"SectionInfo",null,[]);var Fa=c(271);
class xa extends bg.a{constructor(b,h=!1){super(!1,!1,h);this.Cid=476;this.PUb=288;this.Cye=798;this.ngk=476;this.mgk=288;this.w1c={};this.gob=[];this.RV=this.xXa=this.hwb=this.Rsb=this.Dqd=this.mYb=null;this.Gsc=w.AFrameworkApplication.FRc;this.Kwb=b;this.LMe=Object(z.a)(this,this.ryn,"optionClickHandler");this.zyc=Object(z.a)(this,this.syn,"optionKeyHandler");this.Fte=Object(z.a)(this,this.hIk,"arrowClickHandler");this.QSb=Object(z.a)(this,this.iIk,"arrowKeyHandler");this.ywd=Object(z.a)(this,this.JJo,
"textAreaOnFocusHandler");this.M9j=h;this.Yg=pr.Yg;this.Ad=0;this.wg="EmbedDialog"}get Gr(){return this.PUb}set Gr(b){this.PUb=b}Zsj(b){const h={["id"]:this.wg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:ia.a.kp(this.Kwb,"wdPreview","1"),["initialEmbedUrl"]:this.Gsc,["getEmbedCode"]:xa.M8h,
["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const v of Object.keys(b))h[v]=b[v];this.Ad=1;this.Ee(1,CommonUIStrings.l_CopyAction);this.Ee(0,CommonUIStrings.l_Close);this.Wh(CommonUIStrings.l_Embed,null,h)}akc(){if(this.M9j)this.Zsj({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.mYb=document.getElementById("embedpreviewpane");this.Dqd=document.getElementById("embedoptionpane");this.mYb.style.width=String.format("{0}px",this.ngk);this.xXa=document.createElement("iframe");
this.xXa.className=xa.lgk;this.xXa.frameBorder="0";this.xXa.style.height=String.format("{0}px",this.mgk);this.xXa.tabIndex=-1;this.mYb.appendChild(this.rHd(CommonUIStrings.l_Preview,this.xXa,xa.wbh,xa.vbh,xa.wbh,!0));this.RV=document.createElement("textarea");this.RV.className=xa.v2j;Sys.UI.DomElement.addCssClass(this.RV,Fa.a.Y0e);this.RV.id=xa.RTg;aa.a.ti||(this.RV.readOnly=!0);this.RV.rows=4;this.RV.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.RV.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;
this.RV.setAttribute(cf.a.zfa,String.format("{0} {1}",xa.QTg,xa.PTg));this.mYb.appendChild(this.rHd(CommonUIStrings.l_EmbedCode,this.RV,xa.QTg));Le.a.addHandler(this.RV,"focus",this.ywd);var b=document.createElement("span");b.className=xa.g4j;b.innerText=CommonUIStrings.l_CopyText;b.id=xa.PTg;this.mYb.appendChild(b);this.Rsb=document.createElement("div");this.Rsb.className=xa.C1j;this.Dqd.appendChild(this.rHd(CommonUIStrings.l_Dimensions,this.Rsb));this.hwb=document.createElement("div");this.Dqd.appendChild(this.o$k(xa.m$g,
this.hwb));this.Ad=0;this.Ee(1,CommonUIStrings.l_Close);this.wmg();this.HHj();aa.a.ti||this.RV.focus()}}dispose(){if(this.w1c){var b=this.w1c;for(let h in b){const v=b[h];this.Mq.sc(Ed.a.click,v.Cfc,this.LMe);this.ae.sc(Ed.a.ai,v.Cfc,this.zyc);this.ae.sc(Ed.a.uh,v.Cfc,this.zyc)}this.zyc=this.LMe=this.w1c=null}if(this.gob){for(b=0;b<this.gob.length;++b)this.Mq.sc(Ed.a.click,this.gob[b].i$b,this.Fte),this.ae.sc(Ed.a.ai,this.gob[b].i$b,this.QSb),this.ae.sc(Ed.a.ju,this.gob[b].i$b,this.QSb),this.ae.sc(Ed.a.uh,
this.gob[b].i$b,this.QSb);this.ae=this.Fte=this.gob=null}this.ywd&&this.RV&&(Le.a.removeHandler(this.RV,"focus",this.ywd),this.ywd=null);this.RV=this.xXa=this.hwb=this.Rsb=this.Dqd=this.mYb=null;super.dispose()}Xca(){super.Xca();this.Hc.style.width=String.format("{0}px",this.Cye);this.ICa()}gWo(b,h){const v=ia.a.kp(this.Gsc,b,h);return this.Gsc!==v?(this.Gsc=v,this.Kwb=ia.a.kp(this.Kwb,b,h),!0):!1}wmg(){this.RV&&(this.RV.innerText=xa.M8h(this.Gsc,this.Cid,this.PUb))}HHj(){this.xXa&&this.xXa.contentWindow.location.replace(ia.a.kp(this.Kwb,
"wdPreview","1"))}aoe(b,h){this.gWo(b,h)&&(this.wmg(),this.HHj())}rHd(b,h,v=null,D=null,P=null,ca=!1){const ta=document.createElement("div");ta.className=xa.Vik;D&&(ta.id=D);P&&ta.setAttribute(cf.a.zfa,P);ca&&(ta.tabIndex=0);D=document.createElement("span");D.className=xa.Wik;D.innerText=b;v&&(D.id=v);ta.appendChild(D);ta.appendChild(h);return ta}o$k(b,h){const v=this.rHd(CommonUIStrings.l_Interaction,h),D=this.gj.createElement("div");D.className=xa.jXj;D.id=xa.hMg+b;D.setAttribute(cf.a.qh,cf.a.j3);
D.tabIndex=0;v.insertBefore(D,h);b=Xc.createClusteredImage(16,16,xa.kXj,xa.lXj,!0,"");D.appendChild(b);b=b.childNodes[0];b.className=Xc.getImageClass(xa.gTg);b.title=CommonUIStrings.l_Expand;D.title=CommonUIStrings.l_Expand;h.style.visibility="hidden";h=new Qa(h,D,b);Array.add(this.gob,h);this.Mq.eE(Ed.a.click,D,this.Fte,h);this.ae.eE(Ed.a.ai,D,this.QSb,h);this.ae.eE(Ed.a.ju,D,this.QSb,h);this.ae.eE(Ed.a.uh,D,this.QSb,h);return v}hIk(b){this.qCh(b);return!0}iIk(b){return this.$Wc(b,Object(z.a)(this,
this.qCh,"changeArrowState"))}qCh(b){b=b.Ro;"visible"===b.S9f.style.visibility?(b.S9f.style.visibility="hidden",b.e2a.className=Xc.getImageClass(xa.gTg),b.e2a.title=CommonUIStrings.l_Expand,b.i$b.title=CommonUIStrings.l_Expand):(b.S9f.style.visibility="visible",b.e2a.className=Xc.getImageClass(xa.jok),b.e2a.title=CommonUIStrings.l_Collapse,b.i$b.title=CommonUIStrings.l_Collapse)}aLh(b,h){const v=document.createElement("div");v.className=xa.j$g;v.id=b+xa.k$g;var D=this.gj.createElement("div");D.tabIndex=
0;D.className=xa.BOg;D.id=b+xa.eqc;D.setAttribute(cf.a.qh,cf.a.C2e);D.setAttribute(cf.a.tCa,cf.a.lp);D.setAttribute(cf.a.zfa,b+xa.mUb);v.appendChild(D);v.setAttribute(cf.a.qh,cf.a.fz);var P=Xc.createClusteredImage(16,16,xa.HOg,xa.GOg,!0,"");D.appendChild(P);P=P.childNodes[0];P.id=b+xa.l$g;P.className=Xc.getImageClass(xa.Bve);D=new Ba(v,P,D,1);this.w1c[b]=D;this.Mq.eE(Ed.a.click,v,this.LMe,b);D=document.createElement("span");D.className=xa.mUb;D.innerText=h;D.id=b+xa.mUb;v.appendChild(D);this.ae.eE(Ed.a.ai,
v,this.zyc,b);this.ae.eE(Ed.a.uh,v,this.zyc,b);return v}ryn(b){this.NZi(b);return!0}syn(b){return this.$Wc(b,Object(z.a)(this,this.NZi,"optionHandler"))}NZi(b){const h=this.w1c[b.Ro.toString()];h.value?(h.value=0,h.e2a.className=Xc.getImageClass(xa.zWe),h.m9d.setAttribute(cf.a.tCa,cf.a.fM)):(h.value=1,h.e2a.className=Xc.getImageClass(xa.Bve),h.m9d.setAttribute(cf.a.tCa,cf.a.lp));this.aoe(b.Ro.toString(),h.value.toString())}JJo(){this.RV.select()}static M8h(b,h,v){if(!xa.qLe){const D=String.format('<a target="_blank" href="{0}">{1}</a>',
G.a.a$b("https://office.com"),CommonUIStrings.l_Office),P=String.format('<a target="_blank" href="{0}">{1}</a>',G.a.a$b("https://office.com/webapps"),CommonUIStrings.l_WebAppName);xa.qLe=String.format(CommonUIStrings.l_NoFrames,D,P)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',G.a.a$b(b),h,v,xa.qLe)}}xa.qLe=null;xa.Bve="CheckboxChecked_16x16x32";xa.zWe="CheckboxUnchecked_16x16x32";xa.jok="OutlookSearchChevronUp_16x16x32";xa.gTg="OutlookSearchChevronDown_16x16x32";
xa.HOg="CommentChecked";xa.kXj="UpArrowServer";xa.mUb="EmbedDescription";xa.Vik="EmbedSectionHeader";xa.Wik="EmbedSectionName UIFontBold";xa.g4j="EmbedCodeFooter";xa.GOg="EmbedOptionImage";xa.lgk="EmbedPreviewFrame";xa.v2j="EmbedCodeTextArea";xa.j$g="EmbedOption";xa.C1j="EmbedDimensionSection";xa.lXj="EmbedArrowIcon";xa.jXj="WACGlyph EmbedArrowHolder";xa.BOg="EmbedCheckBoxHolder";xa.k$g="Option";xa.l$g="OptionImage";xa.RTg="EmbedCode";xa.QTg="EmbedCodeHeader";xa.wbh="Preview";xa.vbh="PreviewHeader";
xa.m$g="Options";xa.hMg="Arrow";xa.eqc="Check";xa.PTg="EmbedCodeFooter";Object(n.a)(xa,"EmbedDialog",bg.a,[]);class Ya extends Ba{constructor(b,h,v,D,P){super(b,h,v,D);this.n2a=P}}Object(n.a)(Ya,"OptionInputInfo",Ba,[]);class Cb extends xa{constructor(b,h){super(b,Cb.AL);this.xaa=null;this.Yrc=[];this.rvd=Object(z.a)(this,this.yDo,"startOnOptionClickHandler");this.PZb=Object(z.a)(this,this.zDo,"startOnOptionKeyHandler");this.Vqd=Object(z.a)(this,this.psn,"onPageNumberChanged");this.Oye=Object(z.a)(this,
this.uon,"onDimensionChanged");this.dH=h}akc(){if(Cb.AL){var b=Cb.FQn,h=[];h.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.dH.U3i,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.dH.P8i,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",["checkboxInitialValue"]:!1,["checkboxLabel"]:this.dH.Dvj,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.dH.Evj}});this.Zsj({["dimensionsOptions"]:{["isMultipleChoice"]:!1,
["defaultWidth"]:this.Cid,["defaultHeight"]:this.PUb,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.dH.hLj,["heightLabel"]:this.dH.Yni},["interactionOptions"]:h})}else super.akc(),this.Znh(this.dH.hLj,"EmbedWidthInput",this.Cid),this.Znh(this.dH.Yni,"EmbedHeightInput",this.PUb),this.hwb.appendChild(this.aLh("wdPrint",this.dH.U3i)),this.hwb.appendChild(this.aLh("wdEmbedCode",this.dH.P8i)),this.Trk(this.dH.Dvj),this.ICa(),bd.FocusManager.bK()&&(b=bd.FocusManager.instance(),h=[document.getElementById(xa.RTg),
document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(xa.hMg+xa.m$g),document.getElementById("wdPrint"+xa.eqc),document.getElementById("wdEmbedCode"+xa.eqc),document.getElementById("wdStartOn"+xa.eqc),document.getElementById("wdStartOnText"),document.getElementById(pl.a.Zdd),document.getElementById(xa.vbh)],h=new ee(h),b.Ts().fk=h,aa.a.ti?this.W0(document.getElementById(pl.a.Zdd)):this.RV.select())}dispose(){if(!Cb.AL){if(this.Yrc){for(let b=
0;b<this.Yrc.length;++b)Le.a.removeHandler(this.Yrc[b],"change",this.Oye);this.Yrc=this.Oye=null}this.Vqd&&(Le.a.removeHandler(this.xaa.n2a,"change",this.Vqd),this.Vqd=null);this.rvd&&(this.Mq.sc(Ed.a.click,this.xaa.Cfc,this.rvd),this.rvd=null);this.PZb&&(this.ae.sc(Ed.a.ai,this.xaa.Cfc,this.PZb),this.ae.sc(Ed.a.uh,this.xaa.Cfc,this.PZb),this.PZb=null);this.xaa=null}super.dispose()}Znh(b,h,v){const D=document.createElement("label");D.className="EmbedInputPrefix";D.innerText=b;this.Rsb.appendChild(D);
b=document.createElement("input");b.className=h;b.id=h;b.value=v.toString();b.type="text";b.setAttribute("data-lpignore","true");D.setAttribute("for",h);this.Rsb.appendChild(b);this.Yrc.push(b);Le.a.addHandler(b,"change",this.Oye);this.Rsb.appendChild(document.createElement("br"))}uon(b){"EmbedWidthInput"===b.target.id?this.Cid=this.JKd(b.target,375):this.PUb=this.JKd(b.target,250);this.wmg()}JKd(b,h){let v=parseInt(b.value);if(isNaN(v)||v<h)v=h;b.value=v.toString();return v}psn(b){b=this.JKd(b.target,
1);1===this.xaa.value&&this.aoe("wdStartOn",b.toString())}Trk(b){const h=document.createElement("div");h.className=xa.j$g+" EmbedInlineOption";h.id="wdStartOn"+xa.k$g;const v=this.gj.createElement("div");v.tabIndex=0;v.className=xa.BOg;v.id="wdStartOn"+xa.eqc;v.setAttribute(cf.a.qh,cf.a.C2e);v.setAttribute(cf.a.tCa,cf.a.fM);v.setAttribute(cf.a.zfa,"wdStartOn"+xa.mUb);h.appendChild(v);h.setAttribute(cf.a.qh,cf.a.fz);var D=Xc.createClusteredImage(16,16,xa.HOg,xa.GOg,!0,"");v.appendChild(D);D=D.childNodes[0];
D.id="wdStartOn"+xa.l$g;D.className=Xc.getImageClass(xa.zWe);const P=document.createElement("span");P.className=xa.mUb;P.innerText=b;P.id="wdStartOn"+xa.mUb;h.appendChild(P);this.hwb.appendChild(h);b=document.createElement("input");b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.dH.Evj;b.setAttribute("data-lpignore","true");this.hwb.appendChild(b);Le.a.addHandler(b,"change",this.Vqd);this.xaa=new Ya(h,D,v,0,b);this.aoe("wdStartOn","1");this.Mq.nb(Ed.a.click,h,this.rvd);
this.ae.nb(Ed.a.ai,h,this.PZb);this.ae.nb(Ed.a.uh,h,this.PZb)}yDo(b){this.Bvj(b);return!0}zDo(b){return this.$Wc(b,Object(z.a)(this,this.Bvj,"startOnOptionHandler"))}Bvj(){let b=1;this.xaa.value?(this.xaa.value=0,this.xaa.e2a.className=Xc.getImageClass(xa.zWe),this.xaa.m9d.setAttribute(cf.a.tCa,cf.a.fM)):(this.xaa.value=1,this.xaa.e2a.className=Xc.getImageClass(xa.Bve),b=this.JKd(this.xaa.n2a,1),this.xaa.m9d.setAttribute(cf.a.tCa,cf.a.lp));this.aoe("wdStartOn",b.toString())}static get AL(){return w.AFrameworkApplication.ta.Nb.mF}static FQn(b,
h,v,D=null){if("wdPrint"===h||"wdEmbedCode"===h)return ia.a.kp(b,h,v?"1":"0");if("wdStartOn"===h){let P="1";v&&D&&(D=parseInt(D),!isNaN(D)&&1<=D&&(P=D.toString()));return ia.a.kp(b,h,v?P:"1")}return b}}Object(n.a)(Cb,"WordEmbedDialog",xa,[]);class Kb{constructor(b,h,v,D,P){this.yea=null;this.ga=b;this.rab=h;this.JP=v;this.dH=D;this.Xda=P}Tb(){this.ga.qa(this.JP,ud.a.frame,Object(z.a)(this,this.Ywo,"showEmbedCode"));this.rab.execute(Object(z.a)(this,this.tUf,"onHostPostmessengerCreated"))}tUf(b){u.ULS.shipAssertTag(4994850,
332,!!b);this.yea=b;w.AFrameworkApplication.nha||(this.yea.Dv(L.a.cBh),this.yea.TB(L.a.cBh,Object(z.a)(this,this.akc,"showEmbedDialog")))}akc(b){b=b.Values.HostEmbeddedViewUrl.toString();w.AFrameworkApplication.FRc=b;this.Xda.zhf=b;(new Cb(b,this.dH)).akc()}Ywo(b,h,v){if(2===v)if(w.AFrameworkApplication.FRc)(new Cb(this.Xda.zhf,this.dH)).akc();else return w.AFrameworkApplication.Qm.h2a(Kb.zOj),w.AFrameworkApplication.Sng&&this.yea.sendMessage(L.a.VBl,null)?32:w.AFrameworkApplication.ta.DU(!0,w.AFrameworkApplication.dkf);
return 32}}Kb.zOj=10381;Object(n.a)(Kb,"EmbedActor",null,[]);class Rb{}Object(n.a)(Rb,"WordEmbedDialogStrings",null,[]);var zc=c(218);class Jc extends Kb{constructor(b,h){super(b,h,Nc.a.xeg,Object.assign(new Rb,{hLj:WordEditorIntl.WordEditorStrings.l_Width,Yni:WordEditorIntl.WordEditorStrings.l_Height,U3i:WordEditorIntl.WordEditorStrings.l_PrintOption,P8i:WordEditorIntl.WordEditorStrings.l_ReembedOption,Dvj:WordEditorIntl.WordEditorStrings.l_StartOnOption,Evj:WordEditorIntl.WordEditorStrings.l_StartPage}),
zc.WoncaApp.instance)}}Object(n.a)(Jc,"EmbedActor",Kb,[]);class cd{constructor(){this.W=null}get name(){return"WordEditor.Embed"}xc(b){this.W=b;b.ha("WordEditor.Embed.EmbedActor",()=>new Jc(w.AFrameworkApplication.va,b.Sa("Postmessage.IHostPostmessenger"))).singleInstance()}init(){this.W.resolve("WordEditor.Embed.EmbedActor").Tb()}dispose(){}}Object(n.a)(cd,"EmbedPackage",null,[1,2]);class nd{constructor(b,h,v){this.aw=this.hKa=this.tMa=null;this.WJa=0;this.yWb=this.sWb=this.eWb=this.HWb=this.eWa=
this.dWa=!1;this.Uj=b;this.Vm=v}YO(b){return Xa.App.xa.ib.isEditingAllowed?""!==this.EOc(b.xf):!1}mL(b){if(!this.YO(b))return!1;this.jio(b);this.kio();this.lio();this.tMa=b.ZH;this.aw=new Sys.UI.Point(0,0);u.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}FU(b){this.hKa=b.ZH;this.uRk();this.Uj.BGj(this.aw.x,this.aw.y,this.HWb,this.eWb,this.sWb,this.yWb,!1);return!0}$D(){this.Uj.BGj(this.aw.x,this.aw.y,this.HWb,this.eWb,this.sWb,this.yWb,!0);u.ULS.sendTraceTag(22381024,322,50,
"Image Crop drag succeeded")}rY(){this.Uj.pUk();u.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}kio(){this.yWb=this.sWb=this.eWb=this.HWb=!1;switch(this.WJa){case 1:this.HWb=!0;break;case 5:this.eWb=!0;break;case 3:this.yWb=!0;break;case 7:this.sWb=!0;break;case 0:this.sWb=this.HWb=!0;break;case 2:this.yWb=this.HWb=!0;break;case 6:this.sWb=this.eWb=!0;break;case 4:this.yWb=this.eWb=!0}}lio(){this.eWa=this.dWa=!1;switch(this.WJa){case 0:this.eWa=this.dWa=!0;break;case 1:case 2:this.eWa=
!0;break;case 7:case 6:this.dWa=!0}}EOc(b){var h=b.className;-1===h.indexOf("WACImageCropHandle")&&b.parentNode&&(h=b.parentNode.className);b=h.split(" ");for(h=0;h<b.length;h++){const v=b[h].toString();if(v.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==v)return v}return""}jio(b){switch(this.EOc(b.xf)){case "WACImageCropHandleNW":this.WJa=0;break;case "WACImageCropHandleN":this.WJa=1;break;case "WACImageCropHandleNE":this.WJa=2;break;case "WACImageCropHandleE":this.WJa=3;break;case "WACImageCropHandleSE":this.WJa=
4;break;case "WACImageCropHandleS":this.WJa=5;break;case "WACImageCropHandleSW":this.WJa=6;break;case "WACImageCropHandleW":this.WJa=7}}uRk(){var b=1;this.Vm.instance&&(b=this.Vm.instance.jj);const h=(this.hKa.x-this.tMa.x)/b;b=(this.hKa.y-this.tMa.y)/b;this.aw.x=this.dWa?-h:h;this.aw.y=this.eWa?-b:b}}Object(n.a)(nd,"ImageCropDragAdapter",null,[141]);class qd{constructor(b,h){this.ga=b;this.Vm=h}L_l(b){return new nd(b,this.ga,this.Vm)}}Object(n.a)(qd,"ImageCropDragAdapterFactory",null,[696]);var Gd=
c(295),se=c(237),Pd=c(41),ue=c(437),Fe=c(690),qe=c(84),me=c(61),Rf=c(401),Lf=c(973),jg=c(510),Mf=c(895),Ih=c(139),Nf=c(358),Ni=c(245),Zh=c(859),xh=c(204),Ei=c(81),ch=c(21),Vk=c(279),xj=c(767),Bm=c(373),Rl=c(116);class xi{constructor(b,h,v,D,P,ca,ta,Ra,mb=null){this.Xb=mb;this.hTc=null;this.uK=b;this.nh=h;this.Ic=v;this.Ms=D;this.Kd=P;this.hb=ca;this.Sm=ta;this.zE=Ra}get ZW(){return null!=this.Lwg?this.Lwg:this.Lwg=Ea.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get uc(){return null!=
this.dKg?this.dKg:this.dKg=Ea.a.instance.resolve("Box4.Styles.IWACStyleReader")}get oi(){return Ih.PageReader.instance}uko(b,h,v){const D=this.Ic.Oc(15);D.Cb(h.node);this.eTa(b,v);D.dispose()}tko(b,h,v){const D=this.Ic.Oc(15);D.Cb(h.node);this.pOb(b,v);D.dispose()}eTa(b,h){b.setValue(lf.a.imageAltText,h)}pOb(b,h){b.setValue(Bc.a.RX,h)}Bko(b,h){b.setValue(lf.a.Qib,h)}Zlj(b,h){var v=oe.ImageReader.Ui(b);Xa.App.instance&&Xa.App.instance.h4(v)?(v=b.ia(Pd.a.m6d,null),h=xj.a.bdl(h,v),b.setValue(Pd.a.m6d,
h)):b.setValue(Bc.a.UX,h)}xko(b,h,v,D,P){let ca=0;var ta=0;({width:ca,height:ta}=oe.ImageReader.Nhb(b));ta-=(h+v)/1E5*ta;this.DHa(b,ca-(D+P)/1E5*ca);this.CHa(b,ta);this.rmj(b);b.setValue(Bc.a.dSc,h);b.setValue(Bc.a.aSc,v);b.setValue(Bc.a.bSc,D);b.setValue(Bc.a.cSc,P)}soo(b,h,v,D){const P=this.Ic.Oc(15);P.Cb(h.node);this.Jge(b,v,D);P.dispose()}Jge(b,h,v){this.DHa(b,h);this.CHa(b,v);this.rmj(b);b.removeProperty(Wc.a.J$d);b.removeProperty(Wc.a.H$d)}DHa(b,h){b.setValue(lf.a.Eha,h);b.setValue(Wc.a.UEa,
-1)}CHa(b,h){b.setValue(lf.a.Dha,h);b.setValue(Wc.a.TEa,-1)}gE(b,h){b.setValue(Bc.a.ARc,h);b.setValue(lf.a.Hh,h);b.setValue(lf.a.dr,h)}hpo(b,h){b.setValue(Bc.a.jQb,h)}pho(b,h){b.setValue(Bc.a.K3e,h)}lpo(b){if(!oe.ImageReader.i4(b)&&b.hl){var h=b.node;if(oe.ImageReader.G8(h)){const P=this.Ic.Oc(15);P.Cb(b.node);b=he.GraphIterator.$a(h);b.zb(12);b=b.parentNode;var v=b.properties.Gf(Bc.a.nq),D=h.properties.getValue(Bc.a.runId);h.ia(Bc.a.Lc,ij.a.bS);const ca=b.pa,ta=[Bc.a.ARc,lf.a.Hh,lf.a.dr,Bc.a.K3e,
Bc.a.jQb,Bc.a.lZa];Xa.App.instance&&Xa.App.instance.h4(oe.ImageReader.Ui(h))&&ta.push(Pd.a.xwf,Pd.a.wwf);h.Eg.apply(h,ta);v=this.ipf(D,v,ca);D=we.a.Qc(b,v);this.Ms.iJh(h,D);(h=this.zE.ZI(b,v,v+1))&&this.hb.setSelection(h);this.ZW.pqa(b,v,v+1);P.dispose()}}}eag(b,h){if(b.properties.hasProperty(Bc.a.p7)){const v=b.properties.Gf(Bc.a.p7);v.push(h);b.properties.setValue(Bc.a.p7,Array.clone(v))}else b.properties.setValue(Bc.a.p7,[h])}Vhe(b,h,v=0,D=!1){if(b.hl){var P=this.Ic.Oc(15),ca=b.node;P.Cb(ca);if(oe.ImageReader.i4(b)){const Jb=
this.Xb&&this.Xb.isFeatureEnabled(46)?new Mf.a:new jg.a;Jb.Vw(oe.ImageReader.Ym(b));var ta=ca.pa,Ra=this.LDl(b.cpBegin,ta);this.sHk(b.cpEnd,ta,Ra)&&u.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");ta=ta.J(Ra).blob;Ra=ta.qe;var mb=ca.properties.Gf(Bc.a.nq);mb=this.eQn(mb);Ra=mb[Ra];mb=ca.ia(Bc.a.Lc,ij.a.bS);if(ta=Object(Na.a)(Lf.ImageBlobObject,ta))ta.ROb=!1;this.Kd.replaceTextRange(b,"");ta&&(ta.ROb=!0);Jb.properties.setValue(Bc.a.runId,Ra);Jb.properties.setValue(Bc.a.Lc,
mb);b=he.GraphIterator.$a(ca);b.zb(12);b.Af(Jb,6);this.eag(b.currentNode,Jb.anchor.node.id);ca=Jb}v&&this.gE(ca.properties,v);this.pho(ca.properties,D);this.hpo(ca.properties,h);this.ZW.cjc(ca);(h=this.zE.wq(ca))&&this.hb.setSelection(h);P.dispose()}}y9f(b,h){if(!(0>=h)){var v=Ef.a.Vl(h,0),D=oe.ImageReader.fF(b),P=oe.ImageReader.yG(b);D>v&&(P*=v/D,this.DHa(b,v),this.CHa(b,P),u.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",h))}}sHk(b,h,v){const D=
h.length;if(v>=D||!h.J(v).rf)return!1;const P=new Gp.a;for(;v<D;v++){const ca=h.J(v);if(ca.cp>b||!ca.rf)break;for(let ta=0;ta<ca.rf.length;ta++){if(P.contains(ca.rf.J(ta).ak))return!0;P.add(ca.rf.J(ta).ak)}}return!1}eQn(b){for(var h=0;h<b.length&&!b[h];)h++;if(h===b.length)for(var v=0;v<b.length;)b[v]=v+1,v++;else{var D=b[h];v=h-1;for(var P=D-1;0<=v;)b[v]=P,v--,P--;P=0;for(v=h+1;v<b.length;)(h=b[v])?h<D?(D=h+P,b[v]=D):D=h:(P+=2,D++,b[v]=D),v++}return b}Qkf(b,h){let v=0;for(;v<h.length&&!(b<h[v]);)v++;
return v}ipf(b,h,v){let D=0;const P=this.Qkf(b,h);let ca=0;if(P===h.length)ca=v.length-1;else for(;ca<v.length;){h=v.J(ca);if(h.formatting&&h.formatting.qe===P)break;ca++}ca<v.length?D=v.J(ca).cp:u.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:ca,["RunId"]:b,["CharacterPropertiesArrayLength"]:v.length});return D}LDl(b,h){let v=0;for(;v<h.length&&h.J(v).cp!==b;)v++;v===h.length&&u.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",
{["Index"]:v,["CharacterPropertiesArrayLength"]:h.length});return v}rmj(b){b.setValue(lf.a.Jwa,!0)}sae(b,h,v,D=!1){h&&v?(h=Math.max(h,Fe.a.cPi),v=Math.max(v,Fe.a.cPi)):v=h=Fe.a.OPh;b.setValue(lf.a.Eha,Ef.a.Vl(h,0));b.setValue(lf.a.Dha,Ef.a.Vl(v,1));b.setValue(lf.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(Vi.a.R_,1);b.setValue(Bc.a.sha,D)}eXd(){return null}tTh(b,h,v){let D=null;h=({eKb:D}=this.uTh(b,h,v)).returnValue;D&&b.view.lb.setSelection(D);return h}uTh(b,h,v){var D=
null;if(!this.Jfa(b))return{returnValue:null,eKb:D};var P=b.view;const ca=this.Ic.Oc(15,Gb.a.TGb);ca.Cb(P.Yc);h||(h=new Md.DictionaryPropertySet);h.setValue(Wc.a.psl,!0);let ta=P.lb.tg;var Ra=new Zh.a;if(!$e.SelectionEditor.gf(ta)){if(2===w.AFrameworkApplication.va.processAction(Gb.a.Oma,2))return ca.dispose(),{returnValue:null,eKb:D};ta=P.lb.tg}else if(ta.hl&&fe.ParagraphReader.Wb(ta.node)){Xa.App.rd.Qo&&Xa.App.rd.Tp.VF(ta.node);P=Kl.FormattingReader.Nr(ta);if(!P)return ca.dispose(),{returnValue:null,
eKb:D};P.cache.IB&&(P=P.Df(null),xi.Sn.a5(P));Ra.formatting=P.Wj;Ra.languageId=Kl.FormattingReader.language(P);Ra.Kja=this.uc.No(ta.node)}if(!ta.hl)return ca.dispose(),{returnValue:null,eKb:D};if(!this.RAf(b.gk,h))return ca.dispose(),this.hTc=null,{returnValue:null,eKb:D};b=this.hTc;this.hTc=null;1===b.location?(D=b.node,h=Bm.a.instance.Dvf(D),hf.OutlineElementNavigator.Xr(h,!1,!1)||(xh.OutlineNavigator.Qee(h),this.uK.r7(h,!0,Ra)),hf.OutlineElementNavigator.Ge(h),cj.TableReader.isTable(h)&&(Object(rb.a)(Rl.a,
h)||Object(rb.a)(Nf.a,h)?(Ra=new he.GraphIterator,Ra.set(h.currentNode),ch.moveToCellContent(Ra,0,0),h.set(Ra.currentNode)):ch.moveToCellContent(h,0,0),ig.OutlineElementReader.Nh(h)?hf.OutlineElementNavigator.Ge(h):h=Bm.a.instance.Dvf(D)),D=fe.ParagraphReader.wt(h.currentNode)?this.zE.pe(h.currentNode,0):this.zE.wq(h.currentNode)):b.location||(Ra=b.blob.Ib.cp+1,D=this.zE.ZI(b.node,Ra-1,Ra));ca.ZFa(v,1);ca.jk=Gb.a.TGb;ca.dispose();return{returnValue:b,eKb:D}}RAf(){return!1}Jfa(b){b.contextId===sc.a.view&&
b.view.te&&b.view.lb&&(b=b.view.lb.tg);if(!b)return xi.Jc.Yb(qe.a.kf,{["Reason"]:me.a.noSelection}),!1;if(xi.Wf.k_(b))return xi.Jc.Yb(qe.a.kf,{["Reason"]:me.a.WE}),!1;if(xi.Wf.uha(b))return xi.Jc.Yb(qe.a.kf,{["Reason"]:me.a.usi}),!1;if(this.Sm&&this.Sm.instance&&this.Sm.instance.pU(b))return xi.Jc.Yb(qe.a.kf,{["Reason"]:me.a.externalSelection}),!1;if(this.oi.d4)return xi.Jc.Yb(qe.a.kf,{["Reason"]:me.a.compatMode}),!1;if(b.hl)return Ei.OutlineReader.e_d(b)?(xi.Jc.Yb(qe.a.kf,{["Reason"]:me.a.c$e}),
!1):oe.ImageReader.ZYd(b)?(xi.Jc.Yb(qe.a.kf,{["Reason"]:me.a.V9e}),!1):Vk.c(b)?(xi.Jc.Yb(qe.a.kf,{["Reason"]:me.a.W9e}),!1):Ni.a.CDf(b)?(xi.Jc.Yb(qe.a.kf,{["Reason"]:me.a.U9e}),!1):fe.ParagraphReader.kU(b)||oe.ImageReader.FGm(b)?(xi.Jc.Yb(qe.a.kf,{["Reason"]:me.a.hO}),!1):!0;if(Rf.a.REf(b)){let h=!0;for(let v=0;v<b.length;++v){const D=b.getContext(v);if(!D.hl)return!1;h&&!fe.ParagraphReader.kU(D)&&(h=!1)}return h?(xi.Jc.Yb(qe.a.kf,{["Reason"]:me.a.hO}),!1):!0}return!1}D5f(b,h){const v=this.Ic.Oc(7);
v.Cb(b);if(12===b.type){h=h.Ib.cp;var D=fe.ParagraphReader.textLength(b);D=we.a.mO(h,h+1,h+1===D?!0:!1,b);this.Kd.replaceTextRange(D,"");b=we.a.Qc(b,h);this.hb.setSelection(Og.SelectionFactory.Nn(b))}else this.nh.eHa(b);v.dispose()}static get Sn(){return null!=xi.sAg?xi.sAg:xi.sAg=Ea.a.instance.resolve("Box4.IFormattingEditor")}static get Wf(){return qi.a.instance}static get Jc(){return bf.a.instance}}Object(n.a)(xi,"ImageEditor",null,[449]);class Lg{constructor(b,h,v,D=0){this.node=b;this.blob=h;
this.location=v;this.iU=D}}Object(n.a)(Lg,"InsertPictureResult",null,[]);var Kp=c(815),oo=c(284),po=c(1181);class gm extends xi{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc){super(b,h,v,D,P,ca,ta,Ra,Lc);this.A0j="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");this.b$a="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");
this.iK=this.OKa=this.kAa=null;this.eka=Array(8);this.mld=this.FAa=null;this.PKa=!1;this.lld=this.mEe=null;this.Sgd=this.did=!1;this.ES=this.CS=this.BS=this.FS=this.MV=this.LV=this.KV=this.NV=this.gW=this.hW=0;this.uY=()=>{this.PKa&&this.Rhf()};this.sxa=id=>{this.PKa&&id.Hb.keyCode!==Ve.a.Fs&&this.Rhf(!0);return!1};this.DZg=Ac;ca.Pw(this.uY);this.ae=cc;this.f2=Gd.a.instance;this.ga=w.AFrameworkApplication.va;this.Sd=Jb;this.tq=mb;this.ld=Lc}ahe(b,h,v,D,P){b.hasProperty(Wc.a.XQa)&&b.removeProperty(Wc.a.XQa);
const ca=Array(4);ca[0]=h;ca[1]=v;ca[2]=D;ca[3]=P;b.setValue(Bc.a.Uca,ca)}M_n(b){b.setValue(Bc.a.WEa,0);b.setValue(Bc.a.CLb,"");this.ahe(b,0,0,0,0)}cbg(b,h,v,D,P){b.setValue(Bc.a.dSc,h);b.setValue(Bc.a.aSc,v);b.setValue(Bc.a.bSc,D);b.setValue(Bc.a.cSc,P)}che(b,h,v,D){b.setValue(Bc.a.sJ,h);b.setValue(Bc.a.YQc,v);b.setValue(Bc.a.kRc,D);b.setValue(Wc.a.sJ,-1)}cXd(b,h){b=b.node;const v=he.GraphIterator.$a(b);if(fe.ParagraphReader.Wb(b)&&fe.ParagraphReader.isEmpty(v)){var D=b.properties.Gf(Bc.a.Lc);h.setValue(Bc.a.Lc,
D);h.setValue(Bc.a.runId,1);D=new po.a;h&&D.Vw(h);v.Af(D,6);this.eag(b,D.anchor.node.id);this.ZW.cjc(D);return new Lg(D,null,3)}return null}eXd(b,h){var v=Kp.a.instance.pdd;h&&v.Vw(h);v.setValue(Bc.a.imageType,1);let D=0;D=se.a.uF();v.setValue(Bc.a.iU,D);const P=b.node.Kc.Pu(v,v.id);v=this.Kd.gha(b,ca=>new Lf.ImageBlobObject(ca,P));oo.GraphTransactionManager.instance.$Tf(b.node);if(this.Sd.rg){const ca=new eh.GraphTransaction(15);ca.Cb(b.node);this.tq.wqa(b.node,b.cpBegin,b.cpBegin+1,1,null);ca.dispose()}this.ZW.kNa&&
!h.ia(Bc.a.sha,!1)&&this.ZW.pqa(b.node,b.cpBegin,b.cpBegin+1);return new Lg(b.node,v,0,D)}RAf(b,h){if(!this.Jfa(b))return!1;const v=this.Ic.Oc(7);v.Cb(b.node);w.AFrameworkApplication.K.$("ContentAppIsEnabled")&&h.ia(Bc.a.Cui,!1)?this.hTc=this.cXd(b,h):this.hTc=this.eXd(b,h);v.dispose();return!0}uhc(b,h,v,D){if(!v.Wb(b))return!1;v=this.Ic.Oc(7,Gb.a.Wlm);v.Cb(b);var P=b.properties.ia(lf.a.zm,[]);P.push(0);for(const ca of P)if((P=D.Wnf(b,ca))&&5===P.zh&&P.id.equals(h))return this.Kd.replaceTextRange(we.a.createTextRange(b,
ca,ca+1),""),v.dispose(),!0;v.dispose();u.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}$Zn(b,h,v,D){if(!oe.ImageReader.G8(b))return!1;h.set(b);h.zb(12);const P=h.Xn(12);if(!P)return u.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(v.qVc(P))return u.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),
!1;D(b);v=this.Ic.Oc(7);v.Cb(b);h.xg();v.dispose();return!0}G4n(b,h,v,D){return oe.ImageReader.B2a(b)?this.u4n(b,v):oe.ImageReader.i4(b)?this.J4n(b,h,v,D):null}J4n(b,h,v,D){const P=Kp.a.instance.pdd;v&&P.Vw(v);v=0;v=se.a.uF();P.setValue(Bc.a.iU,v);v=b.node.Kc;b=b.node;D=D.ANc(b,5);for(const ca of D)if(ca.id.equals(h)){this.Kd.replaceTextRange(we.a.createTextRange(b,ca.Ib.cp,ca.Ib.cp+1),"");const ta=v.Pu(P,P.id);h=we.a.Qc(b,ca.Ib.cp);this.Kd.gha(h,Ra=>new Lf.ImageBlobObject(Ra,ta));return P}return null}u4n(b,
h){if(!oe.ImageReader.B2a(b))return null;h.setValue(Bc.a.iU,se.a.uF());b=b.node;var v=b.anchor.node.id;b=he.GraphIterator.$a(b);b.zb(12);const D=b.parentNode;let P;D.properties.hasProperty(Bc.a.p7)?(P=D.properties.Gf(Bc.a.p7),v=W.a.indexOf(P,v),-1!==v&&Array.removeAt(P,v)):P=[];D.properties.setValue(Bc.a.p7,Array.clone(P));b.xg();v=this.ld&&this.ld.isFeatureEnabled(46)?new Mf.a:new jg.a;v.Vw(h);b.Af(v,6);this.eag(D,v.anchor.node.id);return v}S$c(b,h){this.PKa?this.Rhf():this.ZCo(b,h)}Dko(b,h){b.setValue(Wc.a.sJ,
h)}P_l(b){let h=null,v=null;if(!b)return u.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),{returnValue:null,view:h,Aj:v};if(!Pb.InteractiveViewManager.instance.Bd)return u.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:h,Aj:v};const D=b.node;if(!D)return u.ULS.sendTraceTag(22381056,322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),
{returnValue:null,view:h,Aj:v};v=D.Kc;var P=D.De(Pb.InteractiveViewManager.instance.Bd.fc);if(!P)return u.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,view:h,Aj:v};h=P.fh;if(b.hl&&oe.ImageReader.i4(b)){b=oe.ImageReader.rEa(b);if(!b)return u.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),{returnValue:null,view:h,Aj:v};P=b.Rva(h,P);if(!P)return u.ULS.sendTraceTag(22381058,
322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:h,Aj:v};P=P.element}else if(oe.ImageReader.Ju(D))P=P.htmlElement;else return u.ULS.sendTraceTag(22381059,322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:h,Aj:v};return{returnValue:P,view:h,Aj:v}}Hqo(b){for(let D=0;D<this.eka.length;D++){this.eka[D]=b.Lk(ki.a.span);this.eka[D].className="WACImageCropHandles "+
this.A0j[D];if(2>=D){var h=b.Lk(ki.a.span);h.className=this.b$a[0];var v=b.Lk(ki.a.span);v.className=this.b$a[1];this.eka[D].appendChild(h);this.eka[D].appendChild(v)}else 4<D&&(h=b.Lk(ki.a.span),h.className=this.b$a[2],v=b.Lk(ki.a.span),v.className=this.b$a[3],this.eka[D].appendChild(h),this.eka[D].appendChild(v));if(!D||3===D||5===D)h=b.Lk(ki.a.span),h.className=this.b$a[4],v=b.Lk(ki.a.span),v.className=this.b$a[5],this.eka[D].appendChild(h),this.eka[D].appendChild(v);else if(2===D||4===D||7===
D)h=b.Lk(ki.a.span),h.className=this.b$a[6],v=b.Lk(ki.a.span),v.className=this.b$a[7],this.eka[D].appendChild(h),this.eka[D].appendChild(v)}}ZCo(b,h){u.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.PKa)u.ULS.sendTraceTag(22381061,322,100,"Attempted to start Crop Mode when it was already On.");else{var v=null,D=null;if((this.FAa=({view:v,Aj:D}=this.P_l(h)).returnValue)&&v){this.FAa.classList.add("ImageCropMode");this.kAa=v.Lk(ki.a.div);this.kAa.className="WACImageCropMode";
this.OKa=v.Lk(ki.a.f2a);this.OKa.className="WACImageCropBase";this.iK=v.Lk(ki.a.span);this.iK.className="WACImageCropSrcRect";this.Hqo(v);this.kAa.appendChild(this.iK);for(v=0;v<this.eka.length;v++)this.iK.appendChild(this.eka[v]);this.kAa.appendChild(this.OKa);this.OKa.style.visibility="";this.OKa.style.display="";this.FAa.appendChild(this.kAa);this.KFn(b);D=oe.ImageReader.Qva(b,D);v=oe.ImageReader.I5(b,Wc.a.zpa,null);this.OKa.src=v?v:oe.ImageReader.Ohb(D);this.DZg&&this.DZg.execute(P=>{this.mld||
(this.mld=P.L_l(this))});this.did||(this.f2.mP(this.FAa,this.mld),this.did=!0);this.ae&&this.ae.nb(Ed.a.$F,Pb.InteractiveViewManager.instance.editingView.editingElement,this.sxa);this.PKa=!0;this.mEe=b;this.lld=h;this.Sgd=!1;b=new eh.GraphTransaction(4);b.Cb(this.lld.node);this.mEe.setValue(Wc.a.Dwa,this.PKa);b.dispose()}else u.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}KFn(b){const h=Ef.a.vf(oe.ImageReader.fF(b),
0),v=Ef.a.vf(oe.ImageReader.yG(b),1);var D=oe.ImageReader.Hba(b);const P=Math.max(D.top,0),ca=Math.max(D.bottom,0),ta=Math.max(D.left,0);D=Math.max(D.right,0);this.hW=1E5*h/(1E5-(ta+D));this.gW=1E5*v/(1E5-(P+ca));this.NV=Math.floor(P*this.gW/1E5);this.KV=Math.floor(ca*this.gW/1E5);this.LV=Math.floor(ta*this.hW/1E5);this.MV=Math.floor(D*this.hW/1E5);this.iK.style.top=this.NV+"px";this.iK.style.bottom=this.KV+"px";this.iK.style.left=this.LV+"px";this.iK.style.right=this.MV+"px";this.OKa.style.width=
this.hW+"px";this.OKa.style.height=this.gW+"px";oe.ImageReader.wy(b)&&(this.kAa.style.width=this.hW+"px",this.kAa.style.height=this.gW+"px");this.FS=this.NV;this.BS=this.KV;this.CS=this.LV;this.ES=this.MV}Rhf(b=!1){u.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.PKa?(b||this.e3k(),this.OKa?ic.a.wC(this.OKa):u.ULS.sendTraceTag(23961793,322,15,"Unable to clear imageCropBase dom element because it was already null."),this.FAa?(this.kAa?this.kAa.parentNode===this.FAa?this.FAa.removeChild(this.kAa):
u.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):u.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.FAa.classList.remove("ImageCropMode"),this.PKa=!1,b=new eh.GraphTransaction(4),b.Cb(this.lld.node),this.mEe.setValue(Wc.a.Dwa,this.PKa),b.dispose(),this.did&&(this.f2.zP(this.FAa,this.mld),this.did=!1),this.ae&&this.ae.sc(Ed.a.$F,Pb.InteractiveViewManager.instance.editingView.editingElement,
this.sxa),this.FAa=this.kAa=null):u.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):u.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}BGj(b,h,v,D,P,ca,ta){if(v){v=Math.max(this.NV-h,0);const Ra=Math.floor(this.gW)-this.KV-v;5<=Ra?(this.FS=v,this.BS=this.KV):5>Ra&&0<=Ra||0>Ra&&!this.KV?(this.FS=v-(5-Ra),this.BS=this.KV):0>Ra&&5>=Math.abs(Ra)?(this.FS=Math.floor(this.gW)-
this.KV,this.BS=Math.max(this.KV-(v-(this.gW-this.KV))-(5-Math.abs(Ra)),0)):(this.FS=Math.floor(this.gW)-this.KV,this.BS=Math.max(this.KV-(v-(this.gW-this.KV)),0));this.iK.style.top=this.FS+"px";this.iK.style.bottom=this.BS+"px";ta&&(this.NV=this.FS,this.KV=this.BS)}D&&(h=Math.max(this.KV-h,0),D=Math.floor(this.gW)-this.NV-h,5<=D?(this.BS=h,this.FS=this.NV):5>D&&0<=D||0>D&&!this.NV?(this.BS=h-(5-D),this.FS=this.NV):0>D&&5>=Math.abs(D)?(this.BS=Math.floor(this.gW)-this.NV,this.FS=Math.max(this.NV-
(h-(this.gW-this.NV))-(5-Math.abs(D)),0)):(this.BS=Math.floor(this.gW)-this.NV,this.FS=Math.max(this.NV-(h-(this.gW-this.NV)),0)),this.iK.style.top=this.FS+"px",this.iK.style.bottom=this.BS+"px",ta&&(this.NV=this.FS,this.KV=this.BS));P&&(P=Math.max(this.LV-b,0),h=Math.floor(this.hW)-this.MV-P,5<=h?(this.CS=P,this.ES=this.MV):5>h&&0<=h||0>h&&!this.MV?(this.CS=P-(5-h),this.ES=this.MV):0>h&&5>=Math.abs(h)?(this.CS=Math.floor(this.hW)-this.MV,this.ES=Math.max(this.MV-(P-(this.hW-this.MV))-(5-Math.abs(h)),
0)):(this.CS=Math.floor(this.hW)-this.MV,this.ES=Math.max(this.MV-(P-(this.hW-this.MV)),0)),this.iK.style.left=this.CS+"px",this.iK.style.right=this.ES+"px",ta&&(this.LV=this.CS,this.MV=this.ES));ca&&(b=Math.max(this.MV-b,0),ca=Math.floor(this.hW)-this.LV-b,5<=ca?(this.ES=b,this.CS=this.LV):5>ca&&0<=ca||0>ca&&!this.LV?(this.ES=b-(5-ca),this.CS=this.LV):0>ca&&5>=Math.abs(ca)?(this.ES=Math.floor(this.hW)-this.LV,this.CS=Math.max(this.LV-(b-(this.hW-this.LV))-(5-Math.abs(ca)),0)):(this.ES=Math.floor(this.hW)-
this.LV,this.CS=Math.max(this.LV-(b-(this.hW-this.LV)),0)),this.iK.style.left=this.CS+"px",this.iK.style.right=this.ES+"px",ta&&(this.LV=this.CS,this.MV=this.ES));ta&&(this.Sgd=!0,Xa.App.xa.updateCommandUI())}pUk(){this.FS=this.NV;this.BS=this.KV;this.CS=this.LV;this.ES=this.MV;this.iK.style.top=this.FS+"px";this.iK.style.bottom=this.BS+"px";this.iK.style.left=this.CS+"px";this.iK.style.right=this.ES+"px"}e3k(){if(this.Sgd){u.ULS.sendTraceTag(22381066,322,50,"Commiting new Image Cropping Properties.");
var b=Math.floor(1E5*this.NV/this.gW),h=Math.floor(1E5*this.KV/this.gW),v=Math.floor(1E5*this.LV/this.hW),D=Math.floor(1E5*this.MV/this.hW),P=new Md.DictionaryPropertySet;P.setValue(Wc.a.Yib,b);P.setValue(Wc.a.Vib,h);P.setValue(Wc.a.Wib,v);P.setValue(Wc.a.Xib,D);this.ga.Mf(this.lld,Nc.a.Ipi,2,!1,null,P)}else u.ULS.sendTraceTag(23070481,322,50,"No New Cropping Properties To Commit.")}Dwa(){return this.PKa}PTl(){return{top:this.FS,bottom:this.BS,left:this.CS,right:this.ES}}oXo(b,h){if(0>b)u.ULS.sendTraceTag(22552777,
322,15,"Unexpected negative value for new Crop properties.");else{switch(h){case 0:this.NV=this.FS=Math.min(Math.floor(this.gW)-this.BS-5,b);this.iK.style.top=this.FS+"px";break;case 1:this.KV=this.BS=Math.min(Math.floor(this.gW)-this.FS-5,b);this.iK.style.bottom=this.BS+"px";break;case 2:this.LV=this.CS=Math.min(Math.floor(this.hW)-this.ES-5,b);this.iK.style.left=this.CS+"px";break;case 3:this.MV=this.ES=Math.min(Math.floor(this.hW)-this.CS-5,b),this.iK.style.right=this.ES+"px"}this.Sgd=!0}}}Object(n.a)(gm,
"ImageEditor",xi,[448,449]);class qr{constructor(){this.W=null}get name(){return"WordEditor.ImageEditors"}xc(b){this.W=b;this.W.ha("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new qd(w.AFrameworkApplication.va,Ea.a.instance.Sa("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").singleInstance();this.W.ha("WordEditor.ImageEditors.ImageEditor",()=>new gm(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.ISelectionManager"),b.Sa("Box4.IExternalSelectionManager"),b.resolve("Box4.ISelectionFactory"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),Xb.KeyInputManager.instance,b.Sa("WordEditor.IImageCropDragAdapterFactory"),b.Na("Box4.IFeatureHelper"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").singleInstance()}init(){this.W.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){N.a.instance.Fc(new qr)}}
Object(n.a)(qr,"WordEditorImageEditorsPackage",null,[1,2]);class Ur{}Object(n.a)(Ur,"FolderContentEditor",null,[1523]);class wp{}Object(n.a)(wp,"PageEditor",null,[1448]);var Wk=c(172);class sm extends wp{constructor(){super()}get Oh(){return Wk.PageNavigator.instance}}Object(n.a)(sm,"PageEditor",wp,[]);class xs{get name(){return"WordEditor.NotebookLevelEditors"}xc(b){b.ha("Box4.NotebookLevelEditors.FolderContentEditor",()=>new Ur).as("Box4.Folder.IFolderContentEditor").singleInstance();b.ha("WordEditor.NotebookLevelEditors.PageEditor",
()=>new sm).as("Box4.Pages.IPageEditor").singleInstance()}init(){}dispose(){}static main(){N.a.instance.Fc(new xs)}}Object(n.a)(xs,"WordEditorNotebookLevelEditorsPackage",null,[1,2]);class Dr{get YLb(){return w.AFrameworkApplication.privacyUrl}hua(){u.ULS.sendTraceTag(37034014,342,50,"User clicked on the Privacy statement.");Dd.a.om(this.YLb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(n.a)(Dr,"PrivacyLinkHandler",null,[293]);class Iq{constructor(b,h){this.fMe=null;this.mjk=
b;this.ljk=h}showDialog(b){this.fMe=b;this.ljk.create().Wh(Object(z.a)(this,this.znm,"handleDialog"))}znm(b){1===b&&this.mjk.Ejj();this.fMe();this.fMe.prototype}}Object(n.a)(Iq,"SendUsYourFileController",null,[283]);class ys extends ug.StandardDialog{constructor(b,h,v){super();this.rYb=null;this.ig=b;this.Azc=h;this.dH=v}Wh(b){this.Ad=1;this.Ee(1,this.dH.send);this.Ee(0,this.dH.ain);u.ULS.shipAssertTag(37034013,342,!this.rYb,"privacy anchor should be null before initializing it.");const h=this.dialogContent();
this.ylb(this.dH.WDk,null,"CancelRequest_32x32x32",null,b,h);this.h5(this.mj(ys.Njj))}dialogContent(){const b=document.createElement("span");b.innerText=this.dH.PIn;const h=document.createElement("span");h.innerText=this.dH.sJo;h.style.fontWeight=this.dH.F1o;const v=document.createElement("span");v.innerText=this.dH.Yfo;const D=this.h5k(),P=document.createElement("span");P.id=this.mj(ys.Njj);P.appendChild(b);P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));P.appendChild(h);
P.appendChild(document.createElement("br"));P.appendChild(v);P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));P.appendChild(D);return P}h5k(){const b=document.createElement("span"),h=document.createElement("a");h.innerText=this.dH.xIn;h.href=this.Azc.YLb||"";b.appendChild(h);this.rYb=h;this.ig.nb(Ed.a.click,this.rYb,Object(z.a)(this.Azc,this.Azc.hua,"clickHandler"));return b}dispose(){this.rYb&&(this.ig.sc(Ed.a.click,
this.rYb,Object(z.a)(this.Azc,this.Azc.hua,"clickHandler")),this.rYb=null);super.dispose()}}ys.Njj="sendUsYourFileId";Object(n.a)(ys,"SendUsYourFileDialog",ug.StandardDialog,[291]);class rr{create(){return Ea.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(n.a)(rr,"Factory",null,[292]);var Ps=c(580);class Zq extends Ps.a{constructor(){super();this.FileId=null}fl(){return 38}static construct(b){const h=new Zq;h.FileId=b;return h}}Object(n.a)(Zq,"CreateSendUsYourFileRequest",
Ps.a,[]);var js=c(989);class On{constructor(b,h,v){this.W5=b;this.XP=h;this.Zak=v}Ejj(b=!1){if(this.XP){const h=Zq.construct(this.XP()),v=new js.a;v.Eq=h;v.status=1;v.IG="BootErrorReport";b=b?this.W5(null):this.W5(D=>{this.E5c(v,D)});b.HI(v);b.yT();this.Zak()}}E5c(b){5===b.statusCode&&this.Ejj(!0)}}Object(n.a)(On,"SendUsYourFileManager",null,[282]);class Jq{constructor(b,h){this.W=null;this.dH=b;this.XP=h}xc(b){this.W=b;this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.dH).singleInstance();
this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",()=>new ys(Th.a.instance,new Dr,this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new On(h=>this.Gga(0,h),this.XP,()=>{u.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const h=new rr;return new Iq(this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),
h)}).singleInstance()}init(){this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}Object(n.a)(Jq,"SendUsYourFilePackageManager",null,[]);var ks=c(509),Pn=c(1029),pu;(function(b){b[b.none=0]="none";b[b.oneNote=1]="oneNote";b[b.word=2]="word";b[b.wordViewer=3]="wordViewer";b[b.powerPoint=4]="powerPoint"})(pu||(pu={}));Object(n.b)("AppMode",pu);class hp{get WDk(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get ain(){return CommonUIStrings.l_NoThanks}get PIn(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get sJo(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get F1o(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get Yfo(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get xIn(){return CommonUIStrings.l_PrivacyStatement}}
Object(n.a)(hp,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class Ct extends Jq{constructor(){super(new hp,()=>w.AFrameworkApplication.rootQuerySignature)}Gga(b,h){return new Pn.a(b,h,"SendUsYourFile.ashx",pu.word,Xa.App.webServiceBase,ks.a.amIAlone,ks.a.G5c,ks.a.r5c)}get name(){return"WordEditor.SendUsYourFile"}static main(){N.a.instance.Fc(new Ct)}}Object(n.a)(Ct,"PackageManager",Jq,["__INTERFACE__@1js/msoserviceplatform:IPackage","__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);
var Qo=c(536),Hk=c(638),zs=c(1846),xn=c(117),Xg=c(26),Ik=c(150),sh=c(72),rq=c(940),zh=c(144),As=c(999);class Fh{constructor(b,h,v,D,P,ca){this.Y2h=b;this.gallerySectionId=h;this.Ozl=v;this.cCk=D;this.commandId=P;this.queryCommandId=ca}}Object(n.a)(Fh,"BorderStyleMenuPropsArguments",null,[]);class lh{constructor(b,h,v,D,P,ca,ta){this.X1b=b;this.Kwj=h;this.width=v;this.ySi=D;this.height=P;this.vGi=ca;this.altText=ta}}Object(n.a)(lh,"TableBorderStyleProperties",null,[]);class Vf{constructor(){this.wxh=
[new lh(Vf.suj,"","2",1,8,0,"Solid Line"),new lh(Vf.ePh,"5,3","1",1,8,0,"Dashed Line"),new lh(Vf.sUh,"1,1","1",1,8,0,"Dotted Line"),new lh(Vf.uUh,"","1",2,8,3,"Double Line")];this.xxh=[new lh(Vf.Exh,"","1",1,8,0,"0.25pt"),new lh(Vf.Bxh,"","1",1,8,0,"0.5pt"),new lh(Vf.Hxh,"","2",1,8,0,"0.75pt"),new lh(Vf.Cxh,"","2",1,8,0,"1pt"),new lh(Vf.Axh,"","3",1,8,0,"1.5pt"),new lh(Vf.Ixh,"","4",1,8,0,"2.25pt"),new lh(Vf.Gxh,"","4",1,8,0,"3pt"),new lh(Vf.zxh,"","5",1,8,0,"4.5pt"),new lh(Vf.Fxh,"","6",1,8,0,"6pt")]}initialize(){this.y4f()}zKl(){const b=
new Fh("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.wxh,Gb.a.Iob,Gb.a.y2f);return this.z3h(b)}AKl(){const b=new Fh("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",this.xxh,Gb.a.Job,Gb.a.z2f);return this.z3h(b)}r5h(b){switch(b){case Vf.suj:return zh.a.Y1b;case Vf.ePh:return zh.a.meb;case Vf.sUh:return zh.a.yFc;case Vf.uUh:return zh.a.n3;default:return zh.a.aua}}s5h(b){switch(b){case Vf.Exh:return zh.a.Dxh;case Vf.Bxh:return zh.a.q4e;case Vf.Hxh:return zh.a.V1b;
case Vf.Cxh:return zh.a.leb;case Vf.Axh:return zh.a.dma;case Vf.Ixh:return zh.a.zCa;case Vf.Gxh:return zh.a.Ffa;case Vf.zxh:return zh.a.xZa;case Vf.Fxh:return zh.a.yCa;default:return zh.a.dG}}z3h(b){const h=new Yd.a,v=new ih.a,D=Object.assign(new Hk.a,{Id:b.Y2h,ExternalId:b.gallerySectionId,ExternalGalleryId:b.Ozl,Type:4,Width:1,GalleryItems:[]});for(const ca of b.cCk){var P={};const ta={};ta.width=Vf.D_m;ta.height=Vf.C_m;P.root=ta;P=Object.assign(new zs.a,{Id:ca.X1b,ExternalId:String.format("{0}_GalleryButton",
ca.X1b),Icon:ca.X1b,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:ca.X1b,FullIconStyle:P,ShouldSetTitle:"true",Alt:ca.altText});D.GalleryItems.push(P)}v.ControlList=[];h.MenuSectionList=[];v.ControlList.push(D);h.MenuSectionList.push(v);h.UpdateDynamically=!0;return h}y4f(){const b={};for(const h of this.wxh)b[h.X1b]=appChrome.buildBorderStyleIcon(h.Kwj,h.width,h.ySi,h.height,h.vGi);for(const h of this.xxh)b[h.X1b]=appChrome.buildBorderStyleIcon(h.Kwj,h.width,
h.ySi,h.height,h.vGi);appChrome.api.registerIconProvider(()=>b)}yho(b,h,v){if(!b)return u.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==sc.a.A5)return u.ULS.sendTraceTag(577910617,306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),!1;switch(b.border){case 2:this.Y0(xn.a.WT(b),b.node,5,v,h);break;case 0:this.Y0(xn.a.WT(b),b.node,3,v,h);break;case 1:this.Y0(xn.a.WT(b),b.node,4,v,h);break;case 3:this.Y0(xn.a.WT(b),
b.node,0,v,h);break;case 7:this.Y0(xn.a.WT(b),b.node,1,v,h);break;case 8:this.Y0(xn.a.WT(b),b.node,2,v,h);break;case 6:this.Y0(xn.a.WT(b),b.node,1,v,h);this.Y0(xn.a.WT(b),b.node,2,v,h);break;case 5:this.Y0(xn.a.WT(b),b.node,3,v,h);this.Y0(xn.a.WT(b),b.node,5,v,h);this.Y0(xn.a.WT(b),b.node,4,v,h);this.Y0(xn.a.WT(b),b.node,0,v,h);break;case 4:this.Y0(xn.a.WT(b),b.node,3,v,h),this.Y0(xn.a.WT(b),b.node,5,v,h),this.Y0(xn.a.WT(b),b.node,4,v,h),this.Y0(xn.a.WT(b),b.node,0,v,h),this.Y0(xn.a.WT(b),b.node,
1,v,h),this.Y0(xn.a.WT(b),b.node,2,v,h)}return!0}oag(b,h,v,D){if(!h)return u.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(h.contextId!==sc.a.d1)return u.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",h.contextId),!1;var P=h.node;const ca=new he.GraphIterator;ca.set(P);ca.zb(14);P=Xg.TableCellReader.SOa(ca);switch(h.border){case 2:this.$Sa(b,h.node,5,D,v,P);this.vhe(h.node,5,v);this.rge(b,h.K0a(),3,v,D,P);
break;case 0:this.$Sa(b,h.node,3,D,v,P);this.vhe(h.node,3,v);this.rge(b,h.K0a(),1,v,D,P);break;case 1:this.$Sa(b,h.node,4,D,v,P);this.vhe(h.node,4,v);this.rge(b,h.K0a(),0,v,D,P);break;case 3:this.$Sa(b,h.node,0,D,v,P),this.vhe(h.node,0,v),this.rge(b,h.K0a(),2,v,D,P)}return!0}FNn(b,h){if($e.SelectionEditor.rWc(b)&&h)switch(b=Object(Na.a)(Ik.TableNodeBorderContext,b),b.border){case 2:this.JO(b.node,Vf.Ho.xM(5),h);break;case 0:this.JO(b.node,Vf.Ho.xM(3),h);break;case 3:this.JO(b.node,Vf.Ho.xM(0),h);
break;case 1:this.JO(b.node,Vf.Ho.xM(4),h);break;case 7:this.JO(b.node,Vf.Ho.xM(1),h);break;case 8:this.JO(b.node,Vf.Ho.xM(2),h);break;case 5:h=this.JO(b.node,Vf.Ho.xM(5),h);h=this.JO(b.node,Vf.Ho.xM(3),h);h=this.JO(b.node,Vf.Ho.xM(0),h);this.JO(b.node,Vf.Ho.xM(4),h);break;case 6:h=this.JO(b.node,Vf.Ho.xM(1),h);this.JO(b.node,Vf.Ho.xM(2),h);break;case 4:h=this.JO(b.node,Vf.Ho.xM(5),h),h=this.JO(b.node,Vf.Ho.xM(3),h),h=this.JO(b.node,Vf.Ho.xM(0),h),h=this.JO(b.node,Vf.Ho.xM(4),h),h=this.JO(b.node,
Vf.Ho.xM(1),h),this.JO(b.node,Vf.Ho.xM(2),h)}}eMn(b,h){if($e.SelectionEditor.sWc(b)&&h)switch(b=Object(Na.a)(Ik.TableNodeBorderContext,b),b.border){case 2:this.JO(b.node,Vf.Ho.DO(5),h);break;case 0:this.JO(b.node,Vf.Ho.DO(3),h);break;case 3:this.JO(b.node,Vf.Ho.DO(0),h);break;case 1:this.JO(b.node,Vf.Ho.DO(4),h)}}cof(b,h,v){v=null;if(!b)return u.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),v;b.properties.hasProperty(h.size)&&(v=new As.a,v.weight=b.properties.ia(h.size,zh.a.dG),v.style=
b.properties.ia(h.style,zh.a.aua),v.color=b.properties.ia(h.color,0));return v}nag(b,h,v){b?v?(b.properties.setValue(h.size,v.weight),b.properties.setValue(h.style,v.style),b.properties.setValue(h.color,v.color)):u.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):u.ULS.sendTraceTag(575980877,306,15,"Node should not be null")}aNb(b,h){b?(b.properties.removeProperty(h.size),b.properties.removeProperty(h.style),b.properties.removeProperty(h.color)):u.ULS.sendTraceTag(575980879,
306,15,"Node should not be null")}Y0(b,h,v,D,P){P=this.s_o(b,h,v,D,P);this.Yic(h,Vf.Ho.xM(v),P);switch(v){case 5:this.zSa(h,2,D,P);break;case 4:this.zSa(h,1,D,P);break;case 0:this.zSa(h,3,D,P);break;case 3:this.zSa(h,0,D,P);break;case 1:this.zSa(h,7,D,P);break;case 2:this.zSa(h,8,D,P)}}s_o(b,h,v,D,P){if(3!==D){var ca=Vf.Gg.nPd(b,h,v,3);void 0!==ca&&null!==ca&&ca!==zh.a.qQ&&(ca=sh.a.$hc(ca),P.color=Vf.x7a.nua(h,ca))}1!==D&&(ca=Vf.Gg.nPd(b,h,v,1),void 0!==ca&&null!==ca&&ca!==zh.a.cG&&(P.weight=parseFloat(ca)*
zh.a.W1b));2!==D&&(b=Vf.Gg.nPd(b,h,v,2),void 0!==b&&null!==b&&b!==zh.a.cG&&(P.style=b));return P}$Sa(b,h,v,D,P,ca){D&&(P=this.WUo(b,h,ca,v,D,P));this.Yic(h,Vf.Ho.DO(v),P)}WUo(b,h,v,D,P,ca){if(3!==P){var ta="",Ra=Vf.Gg.vEb(b,h,D,!1,!0,v,3);Ra&&(ta=Ra.dAb);void 0!==ta&&null!==ta&&ta!==zh.a.qQ&&(ta=sh.a.$hc(ta),ca.color=Vf.x7a.nua(h,ta))}if(1!==P){ta="";if(Ra=Vf.Gg.vEb(b,h,D,!1,!0,v,1))ta=Ra.dAb;void 0!==ta&&null!==ta&&ta!==zh.a.cG&&(ca.weight=parseFloat(ta)*zh.a.W1b)}if(2!==P){P="";if(b=Vf.Gg.vEb(b,
h,D,!1,!0,v,2))P=b.dAb;void 0!==P&&null!==P&&P!==zh.a.cG&&(ca.style=P)}return ca}pfn(b){let h=0,v=0;({Qen:h,rcn:v}=this.d4l(b.style,h,v));b.weight<h&&(b.weight=h);b.weight>v&&(b.weight=v);return b}d4l(b,h,v){switch(b){case zh.a.Y1b:case zh.a.meb:case zh.a.yFc:h=2;v=48;break;case zh.a.n3:h=2;v=24;break;default:h=2,v=48}return{Qen:h,rcn:v}}rge(b,h,v,D,P,ca){if(h)if(D)for(let ta=0;ta<h.length;ta++)switch(v){case 2:this.$Sa(b,h[ta],5,P,D,ca);break;case 0:this.$Sa(b,h[ta],3,P,D,ca);break;case 1:this.$Sa(b,
h[ta],4,P,D,ca);break;case 3:this.$Sa(b,h[ta],0,P,D,ca)}else u.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else u.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}vhe(b,h,v){const D=new he.GraphIterator;D.set(b);D.zb(14);const P=Xg.TableCellReader.Ona(b);b=Xg.TableCellReader.EO(b);ch.forEachCell(D,P,b,(ca,ta,Ra)=>{ca=ca.currentNode;Xg.TableCellReader.Ur(ca)&&0==Ra&&0<ta&&this.Yic(ca,Vf.Ho.DO(h),v)})}Yic(b,h,v){b?(v=this.pfn(v),b.properties.setValue(h.color,
v.color),b.properties.setValue(h.size,v.weight),b.properties.setValue(h.style,v.style)):u.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}zSa(b,h,v,D){if(b){var P=cj.TableReader.ag(b),ca=cj.TableReader.Zg(b),ta=new he.GraphIterator,Ra=[];for(let mb=0;mb<P;mb++)for(let Jb=0;Jb<ca;Jb++)if(ta.set(b),ch.moveToCell(ta,mb,Jb),ta&&ta.currentNode&&!Xg.TableCellReader.hg(ta))switch(h){case 2:Xg.TableCellReader.pha(ta)&&Ra.push(Ik.TableNodeBorderContext.P7(ta.currentNode,2));break;case 0:Xg.TableCellReader.qha(ta)&&
Ra.push(Ik.TableNodeBorderContext.P7(ta.currentNode,0));break;case 3:Xg.TableCellReader.tEf(b,ta.currentNode)&&Ra.push(Ik.TableNodeBorderContext.P7(ta.currentNode,3));break;case 1:Xg.TableCellReader.uEf(b,ta.currentNode)&&Ra.push(Ik.TableNodeBorderContext.P7(ta.currentNode,1));break;case 7:Xg.TableCellReader.uEf(b,ta.currentNode)||Ra.push(Ik.TableNodeBorderContext.P7(ta.currentNode,1));break;case 8:Xg.TableCellReader.tEf(b,ta.currentNode)||Ra.push(Ik.TableNodeBorderContext.P7(ta.currentNode,3))}for(b=
0;b<Ra.length;b++)switch(h=Ra[b],h.border){case 2:this.u4c(h.node,Vf.Ho.DO(5),v,D);this.ude(h.K0a(),Vf.Ho.DO(0),v,D);break;case 0:this.u4c(h.node,Vf.Ho.DO(3),v,D);this.ude(h.K0a(),Vf.Ho.DO(4),v,D);break;case 1:this.u4c(h.node,Vf.Ho.DO(4),v,D);this.ude(h.K0a(),Vf.Ho.DO(3),v,D);break;case 3:this.u4c(h.node,Vf.Ho.DO(0),v,D),this.ude(h.K0a(),Vf.Ho.DO(5),v,D)}}else u.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}ude(b,h,v,D){if(b)for(let P=0;P<b.length;P++)this.u4c(b[P],h,v,D);else u.ULS.sendTraceTag(578062292,
306,15,"Adjacent cell array should not be null")}u4c(b,h,v,D){if(b){var P=b.ia(h.color,Vf.udf),ca=b.ia(h.size,Vf.wdf),ta=b.ia(h.style,Vf.vdf),Ra=new As.a;Ra.weight=D.weight;Ra.style=D.style;Ra.color=D.color;2!==v||P===Vf.udf&&ca===Vf.wdf?3!==v||ta===Vf.vdf&&ca===Vf.wdf?1!==v||P===Vf.udf&&ta===Vf.vdf?(b.properties.removeProperty(h.color),b.properties.removeProperty(h.size),b.properties.removeProperty(h.style)):(Ra.color=P,Ra.style=ta,this.Yic(b,h,Ra)):(Ra.style=ta,Ra.weight=ca,this.Yic(b,h,Ra)):(Ra.color=
P,Ra.weight=ca,this.Yic(b,h,Ra))}else u.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}JO(b,h,v){var D=b.properties.ia(h.style,zh.a.cG);D!==zh.a.cG&&(v.lineStyle!==zh.a.cG?v.lineStyle!==D&&(v.lineStyle=zh.a.CMk):v.lineStyle=D);D=b.properties.ia(h.size,zh.a.dG);D!==zh.a.dG&&(v.UXc!==zh.a.dG?v.UXc!==D&&(v.UXc=zh.a.uMk):v.UXc=D);b=b.properties.ia(h.color,0);b=sh.a.YE(b);b!==zh.a.qQ&&(v.borderColor!==zh.a.qQ?v.borderColor!==b&&(v.borderColor=zh.a.mMk):v.borderColor=b);return v}static get Ho(){return null!=
Vf.Dwg?Vf.Dwg:Vf.Dwg=zh.a.instance}static get Gg(){return null!=Vf.yKg?Vf.yKg:Vf.yKg=Ea.a.instance.Na("WordEditor.IWACTableStyleReader")}static get x7a(){return null!=Vf.jIg?Vf.jIg:Vf.jIg=rq.a.instance}}Vf.D_m="110px";Vf.C_m="20px";Vf.suj="SolidLineStyle";Vf.ePh="DashedLineStyle";Vf.sUh="DottedLineStyle";Vf.uUh="DoubleLineStyle";Vf.Exh="BorderPointSizeOneQuarter";Vf.Bxh="BorderPointSizeOneHalf";Vf.Hxh="BorderPointSizeThreeQuarters";Vf.Cxh="BorderPointSizeOne";Vf.Axh="BorderPointSizeOneAndHalf";Vf.Ixh=
"BorderPointSizeTwoAndQuarter";Vf.Gxh="BorderPointSizeThree";Vf.zxh="BorderPointSizeFourAndHalf";Vf.Fxh="BorderPointSizeSix";Vf.vdf="single";Vf.wdf=4;Vf.udf=0;Object(n.a)(Vf,"TableBorderManager",null,[456]);var qo=c(844),Bl=c(52),Zo=c(206);class rk{constructor(b,h){this.Ach=this.l8g=null;this.mNa=b;this.I$g=h}get b_i(){return this.I$g}get opa(){return this.l8g}get Y3f(){return this.Ach}fnj(b,h){this.Ach=b;this.l8g=h}tmo(b){this.I$g=b}}Object(n.a)(rk,"CellNodeAndOutlineElementInfoForInsertion",null,
[]);var Ph=c(91),sq=c(202),pn=c(362),Lp=c(143),Xm=c(246),Mp=c(585),Dt=c(76),tq=c(468),aq=c(1045);class nj extends qo.a{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub=null,cc=null){super(b,h,v,cc,Ub);this.O9a=aq.a.instance;this.ra=new Mc.a;this.L6e=[Bc.a.elc,Bc.a.Ipb,Bc.a.XPb,Bc.a.clc,Bc.a.Gpb,Bc.a.VPb,Bc.a.blc,Bc.a.Fpb,Bc.a.UPb,Bc.a.dlc,Bc.a.Hpb,Bc.a.WPb];this.uZj=[Bc.a.ya,Bc.a.ua,lf.a.Hh,lf.a.dr];this.mi=D;this.dyb=P;this.Wc=ca;this.hb=ta;this.t6=Ra;this.$l=mb;this.Ltc=Jb;this.zjh=Ub;this.Dnk=cc;this.TKn=
this.f1f.bind(this)}get Aj(){return this.mi.value}get Ss(){return this.t6?this.t6.instance:null}W_e(b){this.ra.addHandler("OnParagraphDelete",b)}get gh(){return!!this.Ltc.instance&&this.Ltc.instance.gh}dTc(b,h,v,D,P){h.setValue(Bc.a.Lc,se.a.uF());h.setValue(Bc.a.xIm,P);Mp.c(D,h,[Bc.a.f1]);super.dTc(b,h,v,D,P)}SWd(b,h,v,D,P){const ca=this.IQc(h,v,D,P);this.oGd(ca,h,!1);return super.SWd(b,h,v,D,P)}ezd(b,h,v,D,P){const ca=this.IQc(h,v,D,P);this.oGd(ca,h,!0);super.ezd(b,h,v,D,P);return ca}U$e(b,h,v,D){h=
this.IQc(b,h,v,D);this.oGd(h,b,!0);return h}insertRows(b,h,v,D){const P=Bl.a.Bs(b),ca=new he.GraphIterator;ca.Zc(b);const ta=ca.currentNode;ca.Sb(1);let Ra;Ra=h?b.zM(1):b.currentNode;const mb=b.wc();if(!mb)throw Error.create("table row insertion cannot be performed on a null tableNode");const Jb=cj.TableReader.ag(mb),Ub=mb.pT.Gg;let cc=!1;try{mb.qya=1;const Ac=this.O9a.vhb(mb,Ub.hF(mb));this.nTa(b.currentNode);this.cra(b);this.iuk(v,b,Ra,ca,ta,h,D);const Lc=this.O9a.vhb(mb,Ub.hF(mb));this.J6a(mb,
cj.TableReader.ag(mb)+v);cc=!0;this.AXd(mb,Ac,Lc)}finally{mb.qya=0,cc||this.J6a(mb,cj.TableReader.ag(mb)+v)}P+1!==Jb||h?!P&&h&&nj.lBf(mb,v):nj.lBf(mb,P);h=P+v+(h?0:1);h<Jb+v&&this.bui(mb,h);return b.currentNode}iuk(b,h,v,D,P,ca,ta){let Ra=null,mb=null;for(var Jb=0;Jb<b;++Jb){var Ub=Zo.a.instance.createInstance(393251);mb||(mb=Ub);Ra=Ub;this.dTc(h,Ub,v,P,ca)}b=cj.TableReader.Zg(h.currentNode);v=!0;do{v?(h.sj(Ra),v=!1):h.Pf(1);P=Array(b);for(Jb=0;Jb<b;++Jb){Ub=this.SNa();const cc=this.U$e(Ub,D.currentNode,
ca,!0);let Ac=null;cc.hg||(Ac=ta(cc));P[Jb]=new rk(Ub,Ac);P[Jb].fnj(cc,null);D.Pf(1)}for(Jb=0;Jb<b;++Jb)Ub=P[Jb].mNa,h.c3(Ub,1,qo.a.CKa?qo.a.CKa():null),Xg.TableCellReader.Ur(Ub)||(this.Czb(h,Ub,P[Jb].b_i),this.TJh(P[Jb].Y3f,Ub,!0));D.aha(1)}while(h.currentNode!==mb)}insertColumns(b,h,v,D,P){let ca=b.currentNode,ta=!1,Ra=cj.TableReader.Zg(b.currentNode);const mb=Ra;try{this.nTa(b.currentNode);this.cra(b);const Jb=ca.pT.Gg;ca.qya=1;const Ub=this.O9a.vhb(ca,Jb.hF(ca));Ra=cj.TableReader.Zg(b.currentNode);
-1===h&&(h=Ra);this.guk(b,D,v,h,P);ca=b.currentNode;Ra+=D;this.r3f(b,Ra,D,h);ta=!0;const cc=this.O9a.vhb(ca,Jb.hF(ca));this.AXd(ca,Ub,cc)}finally{ca.qya=0,ta||this.r3f(b,Ra,D,h)}h!==mb||v?!h&&v&&nj.kBf(ca,D):nj.kBf(ca,h-1)}guk(b,h,v,D,P){var ca=b.currentNode;D=v?D:D-1;b.Sb(1);var ta=new Fb.a;do{var Ra=b.BG(D,1);b.wc();var mb=Array(h);for(let Ub=0;Ub<h;++Ub){var Jb=this.SNa();const cc=this.S5l(b,Ra,v),Ac=this.U$e(Jb,Ra,v,!1);Jb=new rk(Jb,null);Jb.fnj(Ac,cc);mb[Ub]=Jb}ta.add(mb)}while(b.zi(1));v=ta.toArray();
for(D=0;D<v.length;D++)for(ta=0;ta<h;ta++)Ra=v[D][ta],mb=Ra.Y3f,mb.hg||Ra.tmo(P(mb));b.set(ca);b.Sb(1);P=0;do{for(ca=0;ca<h;++ca)D=v[P][ca],ta=D.mNa,b.PGb(ta,D.opa,1,qo.a.CKa?qo.a.CKa():null),Xg.TableCellReader.Ur(ta)||(this.Czb(b,ta,D.b_i),this.TJh(D.Y3f,ta,!1));P++}while(b.zi(1))}AXd(b,h,v){if(h){var D=2===b.qya,P=[],ca=new he.GraphIterator;ca.set(b);for(var ta=ca.Sb(1);ta;){for(ta=ca.Sb(1);ta;){const Ra=ta.id.toString();Ra in h&&h[Ra]===v[Ra]&&(!D||!Xg.TableCellReader.qha(ca)&&!Xg.TableCellReader.pha(ca))||
P.push(ta);ta=ca.zi(1)}ta=ca.zi(1)}if(0<P.length){h=new eh.GraphTransaction(3);try{h.set(b.qj);for(const Ra of P)Ra.mBf()}finally{h&&h.dispose()}}}}deleteRows(b,h){const v=Bl.a.Bs(b),D=v+h;let P=b.wc();const ca=P.pT.Gg;let ta=!1;u.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",P.id.toString(),P.type,v,h);const Ra=cj.TableReader.ag(P);try{P.qya=2;const mb=this.O9a.vhb(P,ca.hF(P));this.nTa(b.currentNode);
this.cra(b);for(let Ub=D-1;Ub>=v;--Ub){b.BG(Ub,1);let cc=b.Sb(1);for(;cc;)this.M_c(cc,!0),cc=b.zi(1);this.P1a(b);u.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.We);b.xg()}P=b.currentNode;const Jb=this.O9a.vhb(P,ca.hF(P));this.J6a(P,cj.TableReader.ag(P)-h);this.V6d(b);ta=!0;this.AXd(P,mb,Jb)}finally{P.qya=0,ta||(this.J6a(b.currentNode,cj.TableReader.ag(b.currentNode)-h),this.V6d(b))}Ra===D&&0<=v-1&&nj.lBf(P,v-1);v<Ra-h&&this.bui(P,v)}deleteColumns(b,
h,v){b=Object(Na.a)(he.GraphIterator,b);let D=Object(Na.a)(tq.a,b.currentNode),P=cj.TableReader.Zg(b.currentNode);const ca=D.pT.Gg;let ta=!1;u.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",D.id.toString(),D.type,h,v);const Ra=P;try{D.qya=2;const mb=this.O9a.vhb(D,ca.hF(D));this.nTa(b.currentNode);this.cra(b);-1===h&&(h=P-v);b.Sb(1);do for(let Ub=h+v-1;Ub>=h;--Ub)b.BG(Ub,1),this.M_c(b.currentNode,
!1),this.P1a(b),b.xg();while(b.zi(1));P-=v;this.q3f(b,P,h,v);ta=!0;D=Object(Na.a)(tq.a,b.currentNode);const Jb=this.O9a.vhb(D,ca.hF(D));this.AXd(D,mb,Jb);this.U6d(b)}finally{D&&(D.qya=0),ta||(this.q3f(b,P,h,v),this.U6d(b))}Ra===h+v&&0<=h-1&&nj.kBf(D,h-1)}mergeCells(b,h,v){if(b&&(1!==h||1!==v)){var D=new he.GraphIterator;D.Zc(b);D.zb(14);this.pbf(D,h,v);this.DUo(D,h,v);D.wc();D.wc();this.WVi(D)}}Vuj(b,h,v){if(b&&(1!==h||1!==v)){var D=new he.GraphIterator;D.Zc(b);D.zb(14);this.Sel(D,h,v);D.wc();D.wc();
this.lYi(D)}}M_c(b,h){u.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.rnm(b,h,this.TKn)}f1f(b,h){const v=b.currentNode;v.hg=!1;this.oGd(h.currentNode,b.currentNode,!0);v.removeProperty(Bc.a.skippedCell);v.removeProperty(Bc.a.renderCell);1===v.colSpan&&1===v.rowSpan&&v.IGc();qo.a.uK.r7(b,!0,qo.a.odi(h.currentNode));ch.returnToCell(b);this.w8k(h,b)}Mwf(b,h,v){super.Mwf(b,h,v);1===h.controlCell.colSpan&&1===h.controlCell.rowSpan?h.controlCell.IGc():
!v&&h.ffe&&(b.xPa?1<b.colSpan&&(h=new he.GraphIterator,h.set(b),h.zb(15),ch.moveToNextColumn(h),h.currentNode.colSpan=b.colSpan-1):(v=new he.GraphIterator,v.set(h.controlCell),v.zb(15),h=Dt.a(v),v=new he.GraphIterator,v.set(b),v.zb(15),ch.moveToColumnByIndex(v,h),--v.currentNode.colSpan))}IQc(b,h,v,D){const P=super.IQc(b,h,v,D);if(b.hg&&!D){var ca=h.gxa;ca.ffe&&(D=qo.a.x7b(ca.controlCell,D),!ca.yEd&&v||ca.yEd===D-1&&!v?b.colSpan=1:(v=new he.GraphIterator,v.set(ca.controlCell),v.zb(15),ca=Dt.a(v),
v=new he.GraphIterator,v.set(h),v.zb(15),ch.moveToColumnByIndex(v,ca),v.currentNode.colSpan+=1))}P.ia(Bc.a.skippedCell,!1)&&(b.hg=!0,b.r4=!0,b.Yob=!0);return P}V6d(b){this.YQb(b,Bc.a.complexTable)}U6d(b){this.YQb(b,Bc.a.complexTable)}WVi(b){this.YQb(b,Bc.a.complexTable)}lYi(b){this.YQb(b,Bc.a.complexTable)}w8k(b,h){if(b&&h){let v;b=he.GraphIterator.$a(b.currentNode);xh.OutlineNavigator.h9(b)&&(b.Sb(2),b=b.currentNode,12==b.type&&(v=b.Gf(lf.a.Hh)));v&&(b=new he.GraphIterator,b.Zc(h),xh.OutlineNavigator.h9(b)&&
b.Sb(2)&&(h=b.currentNode,12==h.type&&h.$g(lf.a.Hh,v)))}}oGd(b,h,v){b&&(Mp.c(b,h,this.L6e),Mp.c(b,h,[lf.a.wH]),v&&Mp.c(b,h,[Bc.a.tP,Bc.a.NR,Bc.a.dIa,Bc.a.bIa,Bc.a.Mqa,Bc.a.skippedCell,Bc.a.renderCell]))}TJh(b,h,v){b&&(b=he.GraphIterator.$a(b),b.vd(),b.Pd(),h=he.GraphIterator.$a(h),h.vd(),h.Pd(),ig.OutlineElementReader.Nh(b)&&hf.OutlineElementNavigator.Ge(b)&&ig.OutlineElementReader.Nh(h)&&hf.OutlineElementNavigator.Ge(h)&&Mp.c(b.currentNode,h.currentNode,this.uZj),v&&(hf.OutlineElementNavigator.Vd(b),
hf.OutlineElementNavigator.Vd(h),Vg.ListItemReader.yg(b)&&(v=nj.o0m.qw(b),v.VB=Ph.a.rl,{qwa:v}=nj.Un.Vla(v.propertySet,h,v))))}P1a(b){this.gh&&this.$l.CZn(b.currentNode);for(b=sq.a.fq(b);b.moveNext();)if(fe.ParagraphReader.Wb(b.currentNode)){const h=Yo.e(b.currentNode);for(const v of h)v.$ha();this.ra.raiseEvent("OnParagraphDelete",b.currentNode)}else Vg.ListItemReader.yg(b.iterator)&&this.Ss&&this.Ss.Zca(b.iterator)}gE(b,h){let v=null;if(this.zjh.rg){const D=Object(Na.a)(tq.a,b);D&&(v=D.FR())}cj.TableReader.$m(b)&&
(1===h?h=3:3===h&&(h=1));super.gE(b,h);this.zjh.rg&&this.Dnk.$ia(b,v);Object(rb.a)(tq.a,b)&&qo.a.nh.Tnj(Object(Na.a)(tq.a,b),(new pn.a(1,0)).Ot)}xbg(b,h){const v=Array(h),D=this.fii(b)/h;for(let P=0;P<h;P++)v[P]=Math.max(Ef.a.Vl(Lp.a.Bda,0),D);b.setValue(lf.a.Lz,v)}Jmj(b){b.setValue(Bc.a.tableLayout,0)}Crh(b,h,v,D,P){const ca=Array(v);for(var ta=0,Ra=0;ta<D;++ta)ca[ta]=h[ta],Ra+=ca[ta];for(;ta<v;++ta)ca[ta]=0>ta-P?h[0]:h[ta-P],Ra+=ca[ta];ta=this.fii(b.currentNode);if(Ra>ta)for(Ra=ta/Ra,ta=0;ta<v;++ta)ca[ta]=
Math.max(Ef.a.Vl(Lp.a.Bda,0),ca[ta]*Ra);return ca}fii(b){var h=he.GraphIterator.$a(b);b=Ef.a.Vl(Ef.a.Ji(cj.TableReader.Thi(h),0),0);if(h.zb(16))return ch.returnToCell(h),h=Lp.a.amc(h.currentNode),Ef.a.Vl(Ef.a.Ji(h,0),0)-b;h=Xm.a.bad(h);return Ef.a.Vl(Ef.a.Ji(h,0),0)-b}EO(b,h,v){const D=new he.GraphIterator;D.set(b);ch.moveToCell(D,h,v);return D.currentNode.ia(Bc.a.colSpan,1)}ejc(b){var h=Xa.App.xa.ib.yu;if(h.te&&(h=b.De(h.fc))){var v=!1,D=cj.TableReader.Zg(b),P=b.ia(lf.a.Lz,Array(D));for(var ca of P)if(!ca){v=
!0;break}if(v){P=Wl.a.clone(P);ca=b.ia(Bc.a.complexTable,!1);u.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",D,P,ca);v=1;var ta=0;for(let mb=0;mb<D;)if(ca&&(v=this.EO(b,0,mb)),1<v){for(var Ra=0;Ra<v;Ra++)P[mb]||(P[mb]=this.Tbi(0)),mb++;ta+=v-1}else(Ra=h.OTl(mb-ta))||u.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",mb,ta),P[mb]||(P[mb]=this.Tbi(Ra)),mb++;b.setValue(lf.a.Lz,P)}}}Tbi(b){return Ef.a.Vl(Math.max(b,
Lp.a.Bda),0)}nTa(b){b=he.GraphIterator.$a(b);this.ejc(b.currentNode);b.zb(14)&&(ch.returnToContainingTable(b),this.ejc(b.currentNode))}Qnj(b,h){h&&b.setValue(Bc.a.f$,h)}acg(b,h){h&&b.setValue(Bc.a.alc,h)}tEh(b,h){const v=cj.TableReader.Zg(b);qo.a.NYk(b,h,v)}wio(b,h,v){let D;if(!({tableNode:D}=this.bcc(b)).returnValue)return!1;if(h&&v&&h.length===v.length){if(!this.pql(D,h))return!1;for(let P=0;P<h.length;++P){const ca=this.dyb.j7c(b,h[P],v[P]);if(ca)return u.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",
ca),!1}this.$4d(D);return!0}return!1}vEk(b,h){let v;if(!({tableNode:v}=this.bcc(b)).returnValue||cj.TableReader.DB(v))return!1;var D=Object(Na.a)(he.GraphIterator,this.Wc.Vf(v));ch.moveToLastRow(D);var P=cj.TableReader.ag(v);if(h&&0<h.length){this.insertRows(D,!1,h.length,()=>null);D=cj.TableReader.ag(v);var ca=this.Wc.Vf(v);P=this.Ohi(ca,P,D-1);for(D=0;D<P.length;++D){ca=P[D];const ta=h[D];for(let Ra=0;Ra<ca.length;++Ra){let mb;if(mb=ta&&ta[Ra]?this.dyb.j7c(b,ca[Ra],ta[Ra].toString()):this.dyb.j7c(b,
ca[Ra],""))return u.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",mb),!1}}}this.$4d(v);return!0}dEk(b,h){let v;if(!({tableNode:v}=this.bcc(b)).returnValue||cj.TableReader.DB(v))return!1;var D=this.Wc.Vf(v),P=cj.TableReader.Zg(v);if(h&&0<h.length){this.insertColumns(Object(Na.a)(he.GraphIterator,D),P,!1,h[1].length,()=>null);var ca=cj.TableReader.Zg(v);D=this.yfm(D,P,ca-1);for(P=0;P<D.length;++P){ca=h[P];const ta=D[P];for(let Ra=
0;Ra<ta.length;++Ra){let mb;if(mb=ca&&ca[Ra]?this.dyb.j7c(b,ta[Ra],ca[Ra].toString()):this.dyb.j7c(b,ta[Ra],""))return u.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",mb),!1}}}this.$4d(v);return!0}Yjl(b){let h;if(!({tableNode:h}=this.bcc(b)).returnValue)return!1;let v=this.h1a(h);const D=cj.TableReader.ag(h);var P=this.Wc.Vf(h);P=this.Ohi(P,v,D-1);for(let ca=0;ca<P.length;++ca){const ta=P[ca];for(let Ra=0;Ra<ta.length;++Ra){const mb=
this.dyb.h$i(b,ta[Ra]);if(mb)return u.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",mb),!1}}v=v?v:1;b=this.Wc.Vf(h);b.iF(v)&&15===b.We&&this.deleteRows(Object(Na.a)(he.GraphIterator,b),D-v);this.$4d(h);return!0}h1a(b){let h=0;const v=this.Wc.Vf(b);let D=v.Pd();for(;D&&D.ia(Bc.a.ukb,!1);)h++,D=v.Bt();return!h&&fk.StyleReader.QTa.YT(b)&32?1:h}DUo(b,h,v){var D,P;const ca=b.currentNode,ta=new he.GraphIterator;ta.Zc(b);let Ra=null,mb=
null,Jb=null;const Ub=zh.a.instance.DO(3),cc=zh.a.instance.DO(4),Ac=zh.a.instance.DO(5),Lc=zh.a.instance.DO(0);ch.forEachCell(ta,h,v,(id,vd,xe)=>{id=id.currentNode;vd||xe||(Ra=nj.Kz.cof(id,Ub,Ra));vd||xe!==v-1||(mb=nj.Kz.cof(id,cc,mb));0<vd&&!xe&&(Ra?nj.Kz.nag(id,Ub,Ra):nj.Kz.aNb(id,Ub),mb?nj.Kz.nag(id,cc,mb):nj.Kz.aNb(id,cc),nj.Kz.aNb(id,Ac),vd!==h-1&&nj.Kz.aNb(id,Lc));xe||vd!==h-1||(Jb=nj.Kz.cof(id,Lc,Jb))});b=null===(P=null===(D=null===Xa.App||void 0===Xa.App?void 0:Xa.App.xa)||void 0===D?void 0:
D.ib)||void 0===P?void 0:P.yu;mb?(D=Ik.TableNodeBorderContext.P7(ca,1),nj.Kz.oag(xn.a.Np(b),D,mb,0)):nj.Kz.aNb(ca,cc);D=Ik.TableNodeBorderContext.P7(ca,0);if(Ra)nj.Kz.oag(xn.a.Np(b),D,Ra,0);else for(D=Object(Na.a)(Ik.TableNodeBorderContext,D).K0a(),P=0;P<D.length;P++)nj.Kz.aNb(D[P],cc);Jb?nj.Kz.nag(ca,Lc,Jb):nj.Kz.aNb(ca,Lc)}pql(b,h){for(let D=0;D<h.length;++D){var v=this.Wc.Vf(h[D]);if(v.zb(14)&&(v=v.jd(14),b.id===v.id))continue;return!1}return!0}bcc(b){let h=null;if(b&&b.qu.toString()!==b.nz.toString())return{returnValue:!1,
tableNode:h};h=this.Aj.Db(b.qu);return 14===h.type&&this.dyb.bcc(b)?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:h}}Ohi(b,h,v){const D=[];ch.forEachCellInTable(Object(Na.a)(he.GraphIterator,b),(P,ca,ta)=>{if(ca>=h&&ca<=v)ta||D.push([]),Xg.TableCellReader.hg(P)||Array.add(D[ca-h],P.currentNode);else if(ca>v)return!1;return!0});return D}yfm(b,h,v){const D=[];ch.forEachCellInTable(Object(Na.a)(he.GraphIterator,b),(P,ca,ta)=>{ta>=h&&ta<=v&&(ta===h&&D.push([]),Xg.TableCellReader.hg(P)||Array.add(D[ca],
P.currentNode));return!0});return D}$4d(b){if(b&&14===b.type){b=Object(Na.a)(he.GraphIterator,this.Wc.Vf(b));const h=new Fb.a;fe.ParagraphReader.$hb(b,!0,!1,h);b=Og.SelectionFactory.pe(h.J(h.count-1),0);this.hb.setSelection(b)}}static get Kz(){nj.lta||(nj.lta=Ea.a.instance.Na("WordEditor.ITableBorderManager"));return nj.lta}static get o0m(){return null!=nj.cEg?nj.cEg:nj.cEg=Ea.a.instance.resolve("Box4.List.IListReader")}static get Un(){return null!=nj.XDg?nj.XDg:nj.XDg=Ea.a.instance.resolve("Box4.List.IListEditor")}bui(b,
h){const v=new he.GraphIterator;v.set(b);ch.moveToFirstRow(v);ch.moveToRowByIndex(v,h);do v.currentNode.gl(4,!0);while(ch.moveToNextRow(v))}static lBf(b,h){if(b){var v=cj.TableReader.ag(b),D=cj.TableReader.Zg(b);if(!(!Xa.App.xa.ib.yu.te||0>h||h>=v))for(v=new he.GraphIterator,v.set(b),b=0;b<D;b++){b?ch.moveToNextColumn(v):ch.moveToCell(v,h,b);if(!v||!v.currentNode||16!==v.currentNode.type)continue;let P=v.currentNode;Xg.TableCellReader.Ur(P)&&(P=Xg.TableCellReader.xga(P));P&&P.gl(4,!0)}}else u.ULS.sendTraceTag(577868247,
306,15,"Can not invalidate row when there is no table node")}static kBf(b,h){if(b){var v=cj.TableReader.ag(b),D=cj.TableReader.Zg(b),P=new he.GraphIterator;if(!(!Xa.App.xa.ib.yu.te||0>h||h>=D))for(D=0;D<v;D++){P.set(b);ch.moveToCell(P,D,h);if(!P||!P.currentNode)continue;let ca=P.currentNode;Xg.TableCellReader.Ur(ca)&&(ca=Xg.TableCellReader.xga(ca));ca&&ca.gl(4,!0)}}else u.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}nj.lta=null;Object(n.a)(nj,"TableEditor",
qo.a,[454,455]);class Qs{get name(){return"WordEditor.TableEditors"}xc(b){w.AFrameworkApplication.K.$("TableEditorsDelayInitializationEnabled")&&(b.ha("WordEditor.TableEditors.TableEditor",()=>new nj(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("WordEditor.IWACTableStyleReader"),new Gg.a(()=>Xa.App.xa.ib.Uc.od),b.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new Qo.a,Yh.a.instance,b.Sa("WordEditor.IFlatListEditor"),b.resolve("Box4.ContentControl.IContentControlOperator"),
b.Sa("Box4.ContentControlConfigSettings"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").singleInstance(),b.ha("WordEditor.TableEditors.TableBorderManager",()=>new Vf).as("WordEditor.ITableBorderManager").singleInstance())}init(){}dispose(){}static main(){N.a.instance.Fc(new Qs)}}Object(n.a)(Qs,"WordEditorTableEditorsPackage",null,[1,2]);class vw{get name(){return"WordEditor.TextLevelEditors"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new vw)}}
Object(n.a)(vw,"WordEditorTextLevelEditorsPackage",null,[1,2]);var Zw=c(1965);c(465);var $w=c(756),ax=c(217),Et=c(244);class ip{constructor(b){this.Qek=b}gdl(){const b=Zo.a.instance.createInstance(393228);b.setValue(lf.a.oL,ax.a.first);b.setValue(lf.a.axh,0);b.setValue(lf.a.Eha,Ei.OutlineReader.$il);(new $w.OutlineIndentInfo(!0)).ohj(b);return b}r7(b,h,v=null){const D=b.currentNode;if(!b.oJ(1))return this.kjb(b,null,h,v);ig.OutlineElementReader.fL(b)&&hf.OutlineElementNavigator.nOf(b,!0);return ig.OutlineElementReader.Nh(b)?
ip.eg.xz(b,!1,h,v):(b.N5c(D),null)}wTk(b){return Ei.OutlineReader.kFf(b.currentNode)||ig.OutlineElementReader.Nh(b)||ig.OutlineElementReader.fL(b)||Xg.TableCellReader.isTableCell(b)}kjb(b,h=null,v=!1,D=null){if(!this.wTk(b))return null;const P=ip.eg.wfb();this.Lno(P,b);b.PGb(P,h,1,null);b.sj(P);v&&(ip.eg.YI(b,D),hf.OutlineElementNavigator.Vd(b));return P}Lno(b,h){if(h=this.Dbm(h))switch(h.type){case 11:ip.eg.Rgf(h,b,!0);break;case 8:h=ip.oi.isRtl(h),ip.eg.AOb(b,h)}}Dbm(b){return this.Qek.Ebm(b)}zOb(b,
h){b.setValue(lf.a.dr,h?11:9)}Dio(b,h){const v=Et.WordSectionNavigator.instance.GJ(b);return v?Ei.OutlineReader.vX(b)!==h?(v.setValue(Bc.a.Fdf,h),!0):!1:null}static get oi(){return Ih.PageReader.instance}static get eg(){return ip.nh||(ip.nh=Ea.a.instance.resolve("Box4.IOutlineElementEditor"))}static set eg(b){ip.nh=b}}ip.nh=null;ip.Ce=null;Object(n.a)(ip,"OutlineEditor",null,[573]);const bx=b=>{b.ha("Box4.OutlineLevelEditors.OutlineEditor",()=>new ip(b.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").singleInstance();
b.ha("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new Zw.a(b.Ue("Box4.IOutlineEditor"),b.Ue("Box4.List.IListEditor"),b.Ue("Box4.List.IListReader"),b.resolve("Box4.ICreateParagraphStrategy"),b.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),b.resolve("Box4.IBox4GraphWriter"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.Styles.IWACStyleReader"),b.Sa("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IParagraphCollection"))).as("Box4.IOutlineElementEditor").singleInstance()};
class Rs{Mqj(){return{Lqj:!0,jLj:!1}}}Object(n.a)(Rs,"CursorMovementValidator",null,[453]);class Fv{get name(){return"Box4.OutlineLevelEditors"}xc(b){b.ha("Box4.ListEditors.CursorMovementValidator",()=>new Rs).as("Box4.List.ICursorMovementValidator").singleInstance();bx(b)}init(){}dispose(){}static main(){N.a.instance.Fc(new Fv)}}Object(n.a)(Fv,"Box4OutlineLevelEditorsPackage",null,[1,2]);class hm{constructor(b){this.QHd=null;this.QSi=b.jb("OfficeOnlineChromeExtensionId");this.YSi=b.jb("ChromeClipboardAccessExtensionId");
this.EHm=b.$("OfficeOnlineChromeExtensionIsEnabled");this.Wfh=!this.EPm();this.QHd=this.TOb?this.YSi:this.QSi}F6n(){this.QHd===this.QSi&&this.mzi&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.QHd=this.YSi;this.Wfh=!0}get TOb(){return this.Wfh}EPm(){if(this.EHm&&this.mzi){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get mzi(){let b=
!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(h){u.ULS.sendTraceTag(19452045,307,50,h.toString())}return b}}Object(n.a)(hm,"ChromeExtensionHelper",null,[947]);var Gv=c(1448),Hz=c(669),Oy=c(1400);class ww{create(b){return new Oy.a(b)}}Object(n.a)(ww,"Factory",null,[756]);var xp=c(138);class cx{constructor(b,
h,v){this.uok=b;this.we=h;this.AYa=v}Tb(){this.AYa.eb(Gb.a.eae,sc.a.application,this.eae.bind(this),96);this.AYa.qa(Gb.a.Umc,sc.a.view,this.k_o.bind(this));this.AYa.eb(Gb.a.g6i,sc.a.view,this.m_o.bind(this),96)}eae(b,h,v,D,P){if(1===v)return 32;b=Object.assign(new Yd.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});h=[];v=Object.assign(new ih.a,{ControlList:[]});v.ControlList.push(Object.assign(new mg.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));
h.push(v);Array.addRange(b.MenuSectionList,h);P.MenuItems=b;return 32}m_o(b,h,v,D,P){if(1===v)return 32;b=dl.a.Qwj();null==b&&8;b=this.we.UQ(b);P[Hl.a.LabelText]=String.format(G.a.yf(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}k_o(b,h,v){b=dl.a.kIb(h);if(1===v||b)return b?8:32;v=new Map;v.set("Source","StyleContextMenuActor");v.set("Action","UpdateStyle");va.Health.instance.recordKpiUsage(xp.a.xza,0,xp.a.tB,v);this.uok.xng(h)?Kc.b(539842578,3018,50,"User Successfully Updated styles from UI"):
(h=new Map,h.set("Source","StyleContextMenuActor"),h.set("Action","UpdateStyle"),h=Object.assign(new Bb.a,{extendedProperties:h}),va.Health.instance.recordKpiFailure(xp.a.xza,"UpdateStyleFailed",!1,!0,h),Kc.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(n.a)(cx,"StyleContextMenuActor",null,[]);var kt=c(1031),lt=c(1518),ay=c(441),Vr=c(1765);class av extends Vr.a{constructor(b,h,v,D,P,ca,ta=null,Ra=null){super(b,ca,ta,Ra);this._formatting=
null;this.wKa=!1;this.Ctb=w.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.Ovb=0;this.bCc=new Fb.a;Kc.a(8128527,307,ig.OutlineElementReader.Nh(b));this.ZL=h;this.ZL.N1b(this);this.jq=v;this.Un=D;this.Gd=P;this.L4e=Ra;this.QNe=Vg.ListItemReader.yg(this.Ec)}get paragraphEditor(){return null!=this.CFg?this.CFg:this.CFg=Ea.a.instance.resolve("Box4.IParagraphEditor")}get IHd(){return null}get O3b(){return this.QNe&&!this.ZL.uDa}get YBb(){return 0<this.Ovb}Lca(b,h){if(!this.$Y.flg(this.Ec,
h,!0)){Kc.a(8701077,307,fe.ParagraphReader.sh(this.Ec));var v=this.Ec.currentNode,D=we.a.mw(v);this.Ctb&&this._formatting.OQ&&(v=v.pa.last,this.wKa&&(v.formatting=this._formatting.OQ.Df(v),this.wKa=!1),b=this.$Y.Xwf(b,h),this.$Y.S9(this.Ec.currentNode,this._formatting.Rca,h));this.characterPropertiesEditor.replaceTextRange(D,b)}}Kca(){Kc.a(8701078,307,fe.ParagraphReader.sh(this.Ec));const b=we.a.mw(this.Ec.currentNode);this.characterPropertiesEditor.gha(b,h=>new ay.a(h))}Amb(){this.$Y.cxf(this.Ec)}rGa(){this.Ctb&&
(this.wKa=!0)}DRa(){Kc.a(8701079,307,fe.ParagraphReader.sh(this.Ec))}CRa(){Kc.a(8701080,307,fe.ParagraphReader.sh(this.Ec))}aE(b){this.ZL.uDa||(this.Ctb?(this.B1e(b),this._formatting.Wme(this.Ec.currentNode),b&&"P"===b.t9.SVd&&this.L4e.pda(this.Ec.currentNode,this._formatting.BR),this.$Y.S9(this.Ec.currentNode,this._formatting.Rca,b)):this.IKk(b))}pF(){this.ZL.uDa||this.ZKc()}HRa(){}O4a(){}zxa(){Kc.a(8701081,307,ig.OutlineElementReader.Nh(this.Ec)||Ei.OutlineReader.fx(this.Ec)||fe.ParagraphReader.sh(this.Ec)&&
this.ZL.uDa);let b=!1;this.YBb||(b=this.O3b||!0);b||(this.NU+=1);this.Ovb++}xxa(){this.Ovb--;let b=!1;this.YBb||(b=this.O3b||!0,this.Un.vaj(this.bCc));b||--this.NU}wGa(b){Kc.a(8701082,307,ig.OutlineElementReader.Nh(this.Ec)||Ei.OutlineReader.fx(this.Ec)||fe.ParagraphReader.sh(this.Ec)&&this.ZL.uDa);Kc.a(8701083,307,!!b.listStyleType)}yxa(){Kc.a(8701084,307,ig.OutlineElementReader.Nh(this.Ec)||fe.ParagraphReader.sh(this.Ec)&&this.ZL.uDa);this.ZL.uDa||Kc.a(8701085,307,this.Ec.Rr(2))}p9(b){this.ZL.p9(b)}n9(){this.ZL.n9()}oad(b){this.bCc.add(b)}M4(b){this.ZL.M4(b)}o9(){this.ZL.o9()}m9(b){this.ZL.m9(b)}l9(){this.ZL.l9()}IKk(b){this.lec(!1);
(new he.GraphIterator).Zc(this.Ec);b=Vr.a.eg.YI(this.Ec,this.bPc(b));Kc.a(8128534,307,b===this.Ec.currentNode);Kc.a(8128535,307,fe.ParagraphReader.Wb(b))}ZKc(){Kc.a(8128536,307,fe.ParagraphReader.sh(this.Ec));hf.OutlineElementNavigator.Vd(this.Ec)}reset(){this.Ctb&&(super.reset(),this._formatting=this.Bpf(!0))}B1e(b){this.lec(!1);(new he.GraphIterator).Zc(this.Ec);b=Vr.a.eg.YI(this.Ec,this.bPc(b));Kc.a(36577367,307,b===this.Ec.currentNode);Kc.a(36577368,307,fe.ParagraphReader.Wb(b));-1!==this._formatting.vw&&
this.paragraphEditor.gE(b,this._formatting.vw);this._formatting.lineSpacing&&this.L4e.eD(b,this._formatting.lineSpacing);this._formatting.t5&&this.L4e.Khe(b,this._formatting.t5);this.wKa=!0;this._formatting.paragraph=b}static O$e(b,h){let v=0;switch(h){case 3:v=Df.a.Kv(b);break;case 7:v=Ef.a.Fy(b,0);break;case 1:v=Df.a.T6e(b);break;case 5:v=Df.a.Kv(Df.a.GZf(b));break;default:u.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",
b,h)}return v}}Object(n.a)(av,"TextOnlyBox4PasteSteward",Vr.a,[]);class Iz extends av{constructor(b,h,v,D,P,ca,ta,Ra=null,mb=null){super(h,v,D,P,ca,ta,Ra,mb);this.zvc=!1;this.Dub=[];this.Gih=b;h={};h.textOnlyPasteFlags=b;u.ULS.sendTraceTag(509088282,307,50,E.c(h))}reset(){super.reset();this.zvc=!1;this.Dub.length=0;this.Yld=!1}aE(b){this.zvc||(super.aE(b),this.zvc=!0)}pF(){this.Yld?this.Yld=!1:this.Kca(null)}Kca(b){this.Gih&2||super.Kca(b)}zxa(){}xxa(){}wGa(){}yxa(){}p9(){}n9(){}M4(b){this.zvc||(super.M4(b),
this.zvc=!0);this.Dub.push(!1)}o9(){this.Gih&1&&this.Kca(null);0<this.Dub.length?this.Dub.pop():Kc.a(509088281,307,!1)}m9(){var b=this.Dub.length-1;0<=b?this.Dub[b]?(b=we.a.mw(this.Ec.currentNode),this.characterPropertiesEditor.replaceTextRange(b,", ")):this.Dub[b]=!0:Kc.a(509088280,307,!1);this.Yld=!0}l9(){this.Yld=!1}oad(){}}Object(n.a)(Iz,"StrictTextOnlyBox4PasteSteward",av,[]);class Cm{constructor(b,h,v,D){this.YMe=b;this.sK=h;this.Hf=v;this.$Y=D}create(b,h,v,D,P=null,ca=null,ta=null,Ra=null){return 1===
b?null!==Ra&&0!==Ra?new Iz(Ra,h,D,this.YMe,this.sK,this.Hf,P,ca,this.$Y):new av(h,D,this.YMe,this.sK,this.Hf,P,ca,this.$Y):new lt.Box4PasteSteward(h,v,D,this.YMe,this.sK,this.Hf,P,ca,this.$Y,ta)}}Object(n.a)(Cm,"Box4PasteStewardFactory",null,[759]);var Ft=c(185),Hv=c(333),yp=c(1576);class Iv{constructor(b,h,v){this.Ny=null;this.Pvb=0;this.Ec=b;this.yk=v}N1b(b){this.Ny=b}get uDa(){return 0<this.Pvb}p9(b){var h;Kc.a(7869459,307,!!this.Ny);Kc.a(7869460,307,ig.OutlineElementReader.Nh(this.Ec)||Ei.OutlineReader.fx(this.Ec));
Kc.b(38563978,307,50,"Table pasting started");this.Ny.lec(!0);const v=new he.GraphIterator;v.Zc(this.Ec);let D=yp.a.Rum[b.styleId];D||(w.AFrameworkApplication.ue("gdea6103;0df65435"),(null===(h=w.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBorderFixEnabled",!1))&&b.aCf?(u.ULS.sendTraceTag(509125329,3022,50,"onTableStart: Fixed default table style"),D=yp.a.vin):D=yp.a.gQh);h=this.yk.tUn(this.Ec,b.rowCount,b.Teb,D,b.tableLook,this.Ny.bPc(b),
b.aCf);b.Thg&&(Kc.b(573691298,3022,100,"Applying table border properties"),yp.a.Nth(b.Thg,this.Ec,!1,!0));b.EWd&&(Kc.b(573691299,3022,100,"Applying indentation properties"),yp.a.rFk(this.Ec,b.EWd.spaceBefore,b.EWd.spaceAfter));b.zEd&&(Kc.b(573691328,3022,100,"Applying column widths"),yp.a.ZEk(b.zEd,this.Ec,Object(Na.a)(Hv.TableNode,h),b.o3a));this.Ny.aBd(v,!1);this.Pvb++;Vg.ListItemReader.yg(v)&&this.Ny.oad(v.currentNode);Kc.a(7869461,307,cj.TableReader.isTable(this.Ec))}n9(){Kc.a(7869462,307,!!this.Ny);
Kc.a(7869463,307,Bl.a.isTableRow(this.Ec));Kc.b(38563979,307,50,"Table pasting finished");this.Ec.mt(14)&&yp.a.thj(this.Ec.wn);hf.OutlineElementNavigator.Vd(this.Ec);this.Pvb--}M4(b){Kc.a(7869464,307,!!this.Ny);Kc.b(573691329,3022,100,"Table row pasting started");cj.TableReader.isTable(this.Ec)?ch.moveToFirstRow(this.Ec):Bl.a.isTableRow(this.Ec)&&ch.moveToNextRow(this.Ec);b.height&&(Kc.b(573691330,3022,100,"Applying table row height"),yp.a.iGk(this.Ec,b.height));Kc.a(7869465,307,Bl.a.isTableRow(this.Ec))}o9(){Kc.a(7869466,
307,!!this.Ny);Kc.a(7869467,307,Xg.TableCellReader.isTableCell(this.Ec));ch.returnToContainingRow(this.Ec)}m9(b){Kc.a(7869468,307,!!this.Ny);Kc.a(7869469,307,!this.Ny.NU);Bl.a.isTableRow(this.Ec)?ch.moveToFirstColumn(this.Ec):Xg.TableCellReader.isTableCell(this.Ec)?ch.moveToNextColumn(this.Ec):Kc.a(7869471,307,!1);if(this.Ec.currentNode){Kc.b(573691331,3022,100,"Table cell pasting started");var h=Object(Na.a)(Ft.TableCellNode,this.Ec.currentNode);Kc.a(50689760,307,!h&&16!==this.Ec.currentNode.type||
!!h&&16===this.Ec.currentNode.type);if(h){var v=new he.GraphIterator;v.Zc(this.Ec);if(b.Wbc)Kc.b(573691332,3022,100,"Processing skipped cell"),yp.a.qKn(v,b);else{if(1<b.colSpan||1<b.rowSpan){const D=ch.returnToContainingTable(v);if(!D)return;D.setValue(Bc.a.complexTable,!0);v.Zc(this.Ec);Kc.b(573691333,3022,100,"Processing merged cell");yp.a.HJn(v,b);h.rowSpan=b.rowSpan;h.colSpan=b.colSpan}yp.a.oGk(this.Ec,b.shadingColor);yp.a.dHk(this.Ec,b.verticalAlignment);yp.a.MEk(this.Ec,b.lle);yp.a.Nth(b.oja,
this.Ec,!b.colSpan&&!b.rowSpan,!1);(new he.GraphIterator).Zc(this.Ec);ch.forEachCell(v,b.rowSpan,b.colSpan,(D,P,ca)=>{Kc.b(573691334,3022,100,"Setting ghost cell borders");yp.a.Mlj(D,b.oja,P,ca,b.rowSpan,b.colSpan)});yp.a.fHk(this.Ec,b.width,b.o3a);Kc.a(7869472,307,Ei.OutlineReader.fx(this.Ec))}}}}l9(){Kc.a(7869473,307,!!this.Ny);Kc.a(7869474,307,ig.OutlineElementReader.Nh(this.Ec)||Xg.TableCellReader.isTableCell(this.Ec));ch.returnToCell(this.Ec);Kc.a(7869475,307,0>=this.Ny.NU);this.Ny.P7e()}}Object(n.a)(Iv,
"Box4TableSteward",null,[780,269]);class ls{constructor(b,h,v){this.Ny=null;this.Pvb=0;this.Ec=b;this.yk=v}N1b(b){this.Ny=b}get uDa(){return 0<this.Pvb}p9(){this.uDa&&(Kc.a(8787101,307,fe.ParagraphReader.sh(this.Ec)),hf.OutlineElementNavigator.Vd(this.Ec));Kc.a(8701086,307,!!this.Ny);Kc.a(8701087,307,ig.OutlineElementReader.Nh(this.Ec)||Ei.OutlineReader.fx(this.Ec));this.Pvb++}n9(){Kc.a(8701088,307,!!this.Ny);hf.OutlineElementNavigator.Vd(this.Ec);this.Pvb--;if(this.uDa){this.Ny.lec(!0);const b=ls.eg.YI(this.Ec);
Kc.a(8787102,307,b===this.Ec.currentNode);Kc.a(8787103,307,fe.ParagraphReader.sh(this.Ec))}}M4(b){Kc.a(8701089,307,!!this.Ny);this.Ny.lec(!0);const h=new he.GraphIterator;h.Zc(this.Ec);this.Ny.aBd(h,!1);Vg.ListItemReader.yg(h)&&this.Ny.oad(h.currentNode);b=ls.eg.YI(this.Ec,this.Ny.bPc(b));Kc.a(8701090,307,b===this.Ec.currentNode);Kc.a(8701091,307,fe.ParagraphReader.sh(this.Ec))}o9(){Kc.a(8701120,307,!!this.Ny);Kc.a(8701121,307,fe.ParagraphReader.sh(this.Ec));hf.OutlineElementNavigator.Vd(this.Ec)}m9(){Kc.a(8701122,
307,!!this.Ny);Kc.a(8701123,307,fe.ParagraphReader.sh(this.Ec));Kc.a(8701124,307,!this.Ny.NU);var b=this.Ec.currentNode;fe.ParagraphReader.textLength(b)&&(b=we.a.mw(b),this.Ny.characterPropertiesEditor.replaceTextRange(b,", "))}l9(){Kc.a(8701125,307,!!this.Ny);Kc.a(8701126,307,fe.ParagraphReader.sh(this.Ec));Kc.a(8701127,307,0>=this.Ny.NU);this.Ny.P7e()}static get eg(){return null!=ls.REg?ls.REg:ls.REg=Ea.a.instance.resolve("Box4.IOutlineElementEditor")}}Object(n.a)(ls,"TextOnlyBox4TableSteward",
null,[780,269]);class yA{constructor(b,h,v=!1,D=!1){this.sK=b;this.iA=h;this.wfk=v;this.Dfk=D}create(b,h){return 1===b?new ls(h,this.sK,this.iA):new Iv(h,this.sK,this.iA,this.wfk,this.Dfk)}}Object(n.a)(yA,"Box4TableStewardFactory",null,[758]);class Ss{create(){return new Rl.a}}Object(n.a)(Ss,"Factory",null,[754]);class Yl{constructor(b){this.ga=b}Jfn(b){if(4===b)b=Gb.a.NFa;else if(2===b)b=Gb.a.Jia;else if(1===b)b=Gb.a.RQb;else if(3===b)b=Gb.a.Z_a;else return;this.ga.processAction(b,2)}Cgb(){this.ga.processAction(Gb.a.Cgb,
2)}}Object(n.a)(Yl,"SelectionCommands",null,[755]);var jp=c(249),yn=c(1090),Fn=c(136),uq=c(628);class Ts{constructor(){this.QWc=!1;this.Q3o=w.AFrameworkApplication.K.jb("WordEditorVisiFontFileUri");this.S3o=w.AFrameworkApplication.K.jb("WordEditorVisiRtlFontFileUri");this.R3o=w.AFrameworkApplication.K.jb("WordEditorVisiPilcrowFontFileUri");this.N3o=w.AFrameworkApplication.K.jb("WordEditorVisiCarriageReturnFontFileUri");this.P3o=w.AFrameworkApplication.K.jb("WordEditorVisiCarriageReturnRtlFontFileUri")}dMo(){this.QWc=
!this.QWc}cMo(b){this.dMo();let h=b.getElementsByClassName("VisiFontStyle")[0],v=b.getElementsByClassName("VisiFontRtlStyle")[0],D=b.getElementsByClassName("VisiFontPilcrowStyle")[0],P=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],ca=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];h||(h=document.createElement("Style"),h.className="VisiFontStyle",ic.a.Jy(h,""),b.appendChild(h));v||(v=document.createElement("Style"),v.className="VisiFontRtlStyle",ic.a.Jy(v,""),b.appendChild(v));
D||(D=document.createElement("Style"),D.className="VisiFontPilcrowStyle",ic.a.Jy(D,""),b.appendChild(D));P||(P=document.createElement("Style"),P.className="VisiFontCarriageReturnStyle",ic.a.Jy(P,""),b.appendChild(P));ca||(ca=document.createElement("Style"),ca.className="VisiFontCarriageReturnRtlStyle",ic.a.Jy(ca,""),b.appendChild(ca));if(this.QWc)return u.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),this.NEc(h)&&this.NEc(v)&&this.NEc(D)&&this.NEc(P)&&this.NEc(ca);u.ULS.sendTraceTag(593294046,
324,50,"Formatting markers are removed");return this.N4c(h)&&this.N4c(v)&&this.N4c(D)&&this.N4c(P)&&this.N4c(ca)}NEc(b){return""===ic.a.yA(b)?("VisiFontStyle"===b.className?ic.a.Jy(b,this.uOc("WordVisi_MSFontService",this.Q3o)):"VisiFontRtlStyle"===b.className?ic.a.Jy(b,this.uOc("WordVisiRtl_MSFontService",this.S3o)):"VisiFontPilcrowStyle"===b.className?ic.a.Jy(b,this.uOc("WordVisiPilcrow_MSFontService",this.R3o)):"VisiFontCarriageReturnStyle"===b.className?ic.a.Jy(b,this.uOc("WordVisiCarriageReturn_MSFontService",
this.N3o)):"VisiFontCarriageReturnRtlStyle"===b.className&&ic.a.Jy(b,this.uOc("WordVisiCarriageReturnRtl_MSFontService",this.P3o)),!0):!1}N4c(b){return""!==ic.a.yA(b)?(ic.a.Jy(b,""),!0):!1}uOc(b,h){return"@font-face { font-family: "+b+"; src: url('"+h+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(n.a)(Ts,"VisiMarkersOperation",null,[751]);var xw=c(445),Wr=c(375);class Jv extends xw.a{constructor(b,h){super(b,h);this.HEe=-1;this.Atb=0;this.uBe=null;this.PZg=!1;
this.KCe=[];this.Smd=!1;this.S7g=!0;this.kMe=this.Fkd=null;this.preventDismissOnScroll=this.xae=this.Bgc=!1;this.L7=null;this.fxd=!1;this.fRc=!0;this.Ks=!1;this.c1g=w.AFrameworkApplication.K.$("FloatieLightDismissIsEnabled");Jv.Gch||(w.AFrameworkApplication.va.qa(Wa.a.showFloatie,ud.a.frame,Oc.ActionManager.Nf),Jv.Gch=!0)}get R0h(){return this.eO}set R0h(b){this.eO=b}get OAj(){return this.fxd}get rSc(){return this.PZg}set rSc(b){this.PZg=b;this.Atb=0}get YA(){return!0}get cssClass(){return w.AFrameworkApplication.ta&&
w.AFrameworkApplication.ta.Nb.T8?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.Ks}bTa(){for(let b of this.children)if(b.bTa())return!0;return!1}get J9(){return 9}Af(b){this.KCe[this.KCe.length]=b;super.Af(b)}ym(){super.ym();nf.c(this.Nc)&&this.GC();this.Nc=Cg.a.ASa(this.Nc);this.QW(this.Nc);this.dirty=!1}$ec(b){3===b.lg||this.xae||this.dismissFloatie(b);return!1}cfc(){return!1}afc(b){3!==b.lg&&this.fRc&&!this.Bgc&&this.FYo(b);return!1}bfc(){return!1}Yec(b){3===b.lg&&this.dismissFloatie(b);
return!1}Zec(b){void 0!==this.L7&&null!==this.L7||this.preventDismissOnScroll||this.dismissFloatie(b);return!1}ZC(){this.lif();return!1}J7d(){this.rSc=!0}FYo(b){if(b=se.a.l5b(b.clientPoint,this.uBe)){if(this.rSc){if(!this.Atb||b<this.Atb)this.Atb=b;b-=this.Atb}b-=this.HEe;0>b&&(b=0);const h=255-4*b;0>=h&&63.75<=b?this.dismissFloatie():aa.a.setOpacity(this.Nc,Math.max(h/255,0))}else this.rSc=!1,this.Atb=0,aa.a.setOpacity(this.Nc,1)}XWo(b){let h=null;void 0!==this.Fkd&&null!==this.Fkd&&(h=this.Fkd(b));
b=null;for(const v of this.KCe){let D=!this.OAj&&v.tDi;if(!D&&void 0!==h&&null!==h)for(let P=0;P<h.length;P++)if(v.id===h[P]){D=!0;break}v.Nc.style.display=D?"none":"";v.i5b=!D;D||(b=v)}b&&(b.i5b=!1)}J9h(){const b=this.Nc.style.top,h=this.Nc.style.left;this.Nc.style.top="0px";this.Nc.style.left="0px";const v=this.zEb();this.Nc.style.top=b;this.Nc.style.left=h;return v}zEb(){const b=this.Nc.style.visibility,h=this.Nc.style.display;this.Nc.style.visibility="hidden";this.Nc.style.display="";const v=
Dd.a.getElementBounds(this.Nc);this.Nc.style.display=h;this.Nc.style.visibility=b;return v}V8i(b){3===b||this.Eme?(Sys.UI.DomElement.addCssClass(this.Nc,Wr.a.vQb),this.fxd=!0):(Sys.UI.DomElement.removeCssClass(this.Nc,Wr.a.vQb),this.fxd=!1);this.XWo(b)}T6a(b,h,v,D=!1){this.isVisible||(this.L7||!this.S7g&&this.preventDismissOnScroll||(this.S7g=!1,Dd.a.w4d("ShowLegacyFloatie",""),w.AFrameworkApplication.va.processAction(Wa.a.showFloatie,2)),this.V8i(v),this.fRc=!0,this.Atb=0,this.rSc=!1,!this.c1g||
void 0!==this.L7&&null!==this.L7?(this.Smd=!1,this.Dfa(this,!1)):(this.Smd=!0,this.HKk(this)),h=D?b:this.IFn(b,h),this.Nc.style.top=h.y.toString()+"px",this.Nc.style.left=h.x.toString()+"px",this.ou(),this.uBe=this.zEb(),this.HEe=se.a.l5b(b,this.uBe),aa.a.setOpacity(this.Nc,1),this.Nc.style.zIndex=String(w.AFrameworkApplication.ta.Fta),this.Nc.style.display="",this.Ks=!0)}IFn(b,h){const v=this.OAj?30:17,D=this.J9h(),P=ic.a.EFb(),ca=ic.a.FX();b=new Sys.UI.Point(b.x,b.y);1===h?b.y-=D.height:3===h?(b.y-=
D.height,b.x-=D.width):2===h&&(b.x-=D.width);b.x+D.width>P&&(b.x=Math.floor(P-D.width));0>b.x&&(b.x=0);b.y=3===h||1===h?b.y-v:b.y+v;0>b.y&&(b.y=0);b.y+D.height>ca&&(b.y=ca-D.height);return b}JFn(b,h){const v=b.yOi;if(v){this.V8i(h);var D=this.J9h();this.L7=b;b=v.Pog-v.LMc>D.width;var P=v.LMc+v.Clf>D.width,ca=v.O6b>D.height+17,ta=v.xKj-(v.O6b+v.zlf)>D.height+17;D=new Sys.UI.Point(v.LMc,v.O6b);P||b||(P=!0,D.x=v.Pog);b=v.Rkb?v.cJf?ta?P?2:0:P?3:1:ca?P?3:1:P?2:0:v.cJf?ta?b?0:2:b?1:3:ca?b?1:3:b?0:2;if(3===
b||2===b)D.x=v.LMc+v.Clf;if(2===b||0===b)D.y=v.O6b+v.zlf;this.T6a(D,b,h);this.fRc=!1;h=this.L7.RYe.Nc;void 0!==h&&null!==h&&(h.style.zIndex=String(w.AFrameworkApplication.ta.Fta))}}C3(){let b=super.C3();this.dismissFloatie()&&(b=!0);return b}dismissFloatie(b=null){if(!this.isVisible)return!1;void 0!==this.GDc&&null!==this.GDc&&this.GDc.Rua(null);void 0!==this.L7&&null!==this.L7&&this.L7.r3();this.r3();this.c1g&&this.Smd?this.svl(this):this.tba(this,!1);this.Smd=!1;this.HEe=-1;this.L7=null;this.Nc.style.display=
"none";this.Ks=!1;this.kMe&&this.kMe(b);return!0}lif(){void 0!==this.L7&&null!==this.L7&&(this.L7.VYa=null,this.L7.r3(),this.L7=null,this.P4d.style.zIndex=String(w.AFrameworkApplication.ta.aCa),this.Nc.style.zIndex=String(w.AFrameworkApplication.ta.Fta))}VWn(b){this.Fkd=b}HXn(b){this.kMe=b}set YA(b){super.YA=b}}Jv.Gch=!1;Object(n.a)(Jv,"Floatie",xw.a,[535,379,380]);class Jz{constructor(b,h){this.xv=this.tKa=null;this.OLi=b;this.ugj=h}get T0h(){return this.tKa}iqo(b){this.tKa=b}zEb(){return this.xv.zEb()}$_(){return this.xv?
this.xv.isVisible:!1}Mwh(b){this.iqo(b)}showFloatie(b,h){this.T6a(h.location,h.Kx,h.isRtl)}T6a(b,h,v){v=v?this.ugj:this.OLi;this.IKd();this.xv&&this.xv.T6a(b,v,h)}dismissFloatie(){this.xv&&this.xv.dismissFloatie()}IKd(){this.tKa&&!this.xv&&(this.xv=Object(Na.a)(Jv,this.tKa()))}wLd(){}}Object(n.a)(Jz,"AFloatieManager",null,[779]);class vq extends Jz{constructor(){super(1,3);this.Uyj=!1;this.tRh=""}T6a(b,h,v){v=v?this.ugj:this.OLi;this.IKd();this.xv&&(this.xv.isVisible&&this.xv.dismissFloatie(),this.Uyj||
this.xv.xm(),this.xv.T6a(b,v,h,!0))}IKd(){this.T0h&&!this.xv&&(this.xv=this.tKa())}wLd(){if(this.xv&&this.xv.isVisible){const b=Object(Na.a)(al.Control,this.xv.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.Yw(b.Ehb(),1,null)}}Vbg(b){this.tRh=b}i3n(b){b=b.ypf("Menu16",null);Rh.a("renderIcon")&&b&&appChrome.api.renderIcon(vq.r1j,b.firstElementChild)}Tmc(b,h,v){if(this.xv){const D=this.xv.controls[this.tRh];D&&(vq.A0g||(this.i3n(D),vq.A0g=!0),D.Qd[ph.a.labelText]=b,D.Qd[ph.a.alt]=h,v&&D.behavior.xm())}}}
vq.A0g=!1;vq.r1j="Designer_20";Object(n.a)(vq,"PasteFloatieManager",Jz,[]);var Kv=c(1040);class ro{constructor(){this.Md=null}get Uw(){return null}getTitle(){return null}j8h(){return null}reset(b){this.Md=b.node}xIa(b){b=Yo.d(this.Md,b);let h=null;if(!b||b.zh!==this.zh)return{returnValue:!1,WF:h};h=Object.assign(new Kv.a,{MG:this.key,contentObject:b,title:this.getTitle(b),description:this.j8h(b)});return{returnValue:!0,WF:h}}}Object(n.a)(ro,"BlobDetailsProvider",null,[670,671]);class zA extends ro{constructor(){super()}get key(){return"EQUATION"}get zh(){return 11}get Uw(){return Box4Intl.Box4Strings.l_EquationContentTitle}}
Object(n.a)(zA,"EquationDetailsProvider",ro,[]);class IB{constructor(){this.sZg=null}get key(){return"LINK"}get Uw(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.sZg=Re.a.JOc(b.node)}xIa(b){let h=null;for(const v of this.sZg)if(v.cpBegin<=b&&b<v.cpEnd)return h=Object.assign(new Kv.a,{MG:this.key,contentObject:v.hyperlink}),{returnValue:!0,WF:h};return{returnValue:!1,WF:h}}}Object(n.a)(IB,"HyperlinkDetailsProvider",null,[670,671]);var dx=c(1379),Ak=c(897);class Er{constructor(){this.g3g=
!1}get key(){return"IFRAMENODE"}get Uw(){return this.g3g?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}tmc(b){let h=null;b=b?fe.ParagraphReader.dPa(b.currentNode):null;if(!b)return{returnValue:!1,yma:h};h=Object.assign(new dx.a,{MG:this.key,contentId:b.id,contentObject:b});return{returnValue:!0,yma:h}}nEb(b,h){b=b?Object(Na.a)(Ak.a,b.contentObject):null;h=h?Object(Na.a)(Ak.a,h.contentObject):null;let v="";h&&b.id===h.id||(this.g3g=b.z3a,v=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,
b.Uw,this.Uw));return v}}Object(n.a)(Er,"IFrameDetailsProvider",null,[777,671]);class AA extends ro{constructor(){super()}get key(){return"IMAGE"}get zh(){return 5}reset(b,h){super.reset(b,h);this.L9j=!$e.SelectionEditor.Sl(h)}get Uw(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return oe.ImageReader.yX(b.properties)}j8h(b){var h;b=oe.ImageReader.fPa(b.properties);return null!==(h=Xa.App.instance)&&void 0!==h&&h.D0d&&this.L9j?String.format(Box4Intl.Box4Strings.l_ContentSelectedNotificationFormat,
b):b}}Object(n.a)(AA,"ImageDetailsProvider",ro,[]);class JB{get key(){return"IMAGENODE"}get Uw(){return Box4Intl.Box4Strings.l_ImageContentTitle}tmc(b){let h=null;if(!b||!oe.ImageReader.Ju(b.currentNode))return{returnValue:!1,yma:h};h=Object.assign(new dx.a,{MG:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,yma:h}}nEb(b,h){b=b.contentObject;const v=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let D="";h&&b.id===h.contentObject.id||(D=String.format(v,
oe.ImageReader.yX(b.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return D}}Object(n.a)(JB,"ImageNodeDetailsProvider",null,[777,671]);let Py,Kz;class bv{constructor(b,h){this.rUg=null;this.rn=h;this.bPe=b;this.key=bv.keys.J(b);this.Uw=bv.x6k.J(b)}reset(b){this.rUg=this.rn.T3(b.node)}xIa(b){var h=bv.nFl(this.rUg||[],v=>this.eJm(b,v));h=this.F$k(h);return{returnValue:!!h,WF:h}}eJm(b,h){return h.begin<=b&&b<h.end&&(!h.errorDetails||this.bPe===h.errorDetails.proofingType)}F$k(b){return b?Object.assign(new Kv.a,
{MG:this.key,contentObject:b.errorDetails,description:this.Bhb()}):null}Bhb(){return w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static nFl(b,h){for(const v of b)if(h(v))return v;return null}}bv.keys=(Kz=new Td.a,Kz.add(1,"SPELLINGERROR"),Kz.add(2,"GRAMMATICALERROR"),Kz.add(3,"ADVANCEDERROR"),Kz);bv.x6k=(Py=new Td.a,Py.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),Py.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),
Py.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),Py);Object(n.a)(bv,"ProofingDetailsProvider",null,[670,671]);class qu{constructor(){this.tableNode=null;this.xEd=this.efe=this.columns=this.rows=0}}Object(n.a)(qu,"TableInfo",null,[]);class an{get key(){return"TABLE"}get Uw(){return Box4Intl.Box4Strings.l_TableContentTitle}tmc(b){var h=null;if(!Xg.TableCellReader.isTableCell(b))return{returnValue:!1,yma:h};h=new he.GraphIterator;h.Zc(b);b=new qu;b.efe=Bl.a.Bs(h)+1;b.xEd=Dt.a(h)+1;
ch.returnToContainingTable(h);b.tableNode=h.currentNode;b.columns=cj.TableReader.Zg(b.tableNode);b.rows=cj.TableReader.ag(b.tableNode);h=Object.assign(new dx.a,{MG:this.key,contentId:b.tableNode.id,contentObject:b});return{returnValue:!0,yma:h}}nEb(b,h){b=b.contentObject;const v=new sf.a;h||v.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,b.columns,b.rows));h&&h.contentObject.xEd===b.xEd||v.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.xEd));h&&h.contentObject.efe===
b.efe||v.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,b.efe));return v.toArray().join(" ")}}Object(n.a)(an,"TableDetailsProvider",null,[777,671]);class GB{constructor(b,h){this.yKa=b;this.rn=h}get hRb(){return null!=this.pJg?this.pJg:this.pJg=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}n4f(){this.yKa.execute(b=>{b.Y4(new IB);this.hRb||(b.Y4(new bv(1,this.rn)),b.Y4(new bv(2,this.rn)));b.Y4(new bv(3,this.rn));
b.Y4(new zA);b.Y4(new AA);b.ohc(new an);b.ohc(new JB);b.ohc(new Er)})}}Object(n.a)(GB,"AccessibilityActor",null,[]);class Qq{constructor(b,h,v){this.rxn=(D,P,ca)=>{if(1===ca)return 32;this.NXj().Ieg();return 32};this.AYa=b;this.NXj=v}Tb(){this.AYa.eb(Gb.a.mZi,sc.a.view,this.rxn,1028)}}Object(n.a)(Qq,"AutoCorrectActor",null,[]);var CC=c(1966);class tA{constructor(){this.r4d=!0}vxa(){}Q4a(){}N1b(){}yVf(){}bhe(){}get hgc(){return!1}get Vlb(){return 0}get RNi(){return!1}get jX(){return ub.a.nil}}Object(n.a)(tA,
"TextOnlyBox4ImageSteward",null,[778]);class ft{constructor(b,h,v,D,P,ca,ta=!1){this.QO=b;this.taskManager=h;this.Pg=v;this.zwm=D;this.notificationBar=P;this.Xb=ca;this.g2m=ta}create(b,h,v,D){return 1===b?new tA:new CC.a(h,this.QO,this.taskManager,this.Pg,this.Xb,this.zwm,this.notificationBar,this.g2m,v,D)}}Object(n.a)(ft,"Box4ImageStewardFactory",null,[752]);var Co=c(37);class Ly{constructor(b){this.l_d=b}cQm(b){if(!b||!b.yB||1>b.yB.count)return!1;const h=[Co.a.oOh,Co.a.nOh];return!!this.xOd(b.yB,
1,v=>this.DFd(v,h))}Uwi(b){return!b||!b.yB||1>b.yB.count?!1:!!this.xOd(b.yB,1,h=>this.DFd(h,[Co.a.sG]))}dNm(b){return!b||!b.yB||1>b.yB.count?!1:!!this.xOd(b.yB,2,h=>this.DFd(h,[Co.a.OXc]))}sh(b){return!b||!b.yB||1>b.yB.count?!1:!!this.xOd(b.yB,1,h=>this.DFd(h,[Co.a.Cpa]))}dZd(b){if(!b||!b.yB)return!1;b=b.yB;for(let h=0;h<b.count;++h)if(!b.J(h)||0<b.J(h).UIk)return!1;return!0}Yxl(b,h){return this.Uwi(h)||this.dNm(h)?"":b}xOd(b,h,v){if(b&&0<b.count)for(let D=b.count-1;0<=D;--D){if(v(b.J(D)))return b.J(D);
if(b.count-D>=h)break}return null}DFd(b,h){b=b&&b.Xoi?b.Xoi.split(" "):null;if(!b)return!1;for(const v of h)if(0<=Array.indexOf(b,v))return!0;return!1}}Object(n.a)(Ly,"Box4PasteStewardUtils",null,[750]);var Eu=c(719);class Vp{constructor(){this.Fmc=0;this.hdc=Array(9)}}Object(n.a)(Vp,"FullListMetadata",null,[]);class HB{constructor(b,h,v){this.Fmc=this.level=0;this.kZh=null;this.agc=!1;this.level=b;this.Npe=h;this.yyn=v}}Object(n.a)(HB,"ListItemMetadata",null,[]);var nk=c(1580);class Qe{constructor(){this.level=
0;this.tagName="UL";this.Blb=null;this.ignore=!1;this.Zjn=0;this.listStyle="BulletListStyle1";this.dlb=new nk.a;this.font=this.levelText=""}}Object(n.a)(Qe,"ListLevelMetadata",null,[]);class hr{constructor(){}}Object(n.a)(hr,"LevelLists",null,[]);class xt{constructor(b){this.nodes=b;this.VNa=0;this.lists={};this.dlb=[];this.oFi=null;this.bhl=[];this.bhl[0]=new hr}}Object(n.a)(xt,"WordConverterArguments",null,[]);var Yn=c(584);class Xk{}Xk.Vhl="data-ccp-timestamp";Xk.$Hd="data-clipservice-ccpid";Xk.Yhl=
"data-shapeids";Xk.wlm="docs-internal-guid-";Xk.ixn="SCXO";Xk.iGn="SCXP";Xk.$5o="SCXW";Xk.ygn="MsoListParagraphCxSpFirst";Xk.zgn="MsoListParagraphCxSpLast";Xk.idf="data-pkey";Xk.jdf="data-clipservice-type";Xk.gdf="data-clipservice-count";Xk.hdf="data-clipservice-dc";Xk.jJc="data-clipservice-client";Xk.kdf="data-clipservice-version";Object(n.a)(Xk,"HtmlContentMetadataConstants",null,[]);class Vx{constructor(){this.y=this.x=0;this.top=this.left=null}}Object(n.a)(Vx,"AbsolutePosition",null,[]);var cp=
c(851);class Ki{constructor(b,h,v="",D=0){this.vx=!1;this.fZg=this.gZg=null;let P=!1;Ki.pMm(b)&&(P=!0,this.gZg=b);Ki.HMm(h)&&(this.fZg=h);this.H6j=v;this.uXj=D;this.vx=P&&this.SVd?!0:!1}get isValid(){return this.vx}get $oi(){return this.gZg}get SVd(){return this.fZg}get Xoi(){return this.H6j}get UIk(){return this.uXj}static pMm(b){return b?-1===b.indexOf(" ")&&0<b.length:!0}static HMm(b){return b?-1===b.indexOf(" ")&&0<b.length:!1}}Object(n.a)(Ki,"HtmlElementInfo",null,[]);class zn{constructor(b){this.next=
null;this.data=b}}Object(n.a)(zn,"StackNode",null,[]);class Yu{constructor(){this.Sq=null;this.fj=0}get count(){return this.fj}get isEmpty(){return!this.count||!this.Sq}push(b){b=new zn(b);b.next=this.Sq;this.Sq=b;this.fj=this.count+1}QA(){return this.count&&this.Sq?this.Sq.data:null}pop(){if(!this.count||!this.Sq)return null;const b=this.Sq;this.Sq=b.next;this.fj=this.count-1;return b.data}clear(){this.Sq=null;this.fj=0}toArray(){const b=Array(this.count);let h=this.Sq;for(let v=this.count-1;0<=
v&&h;v--)b[v]=h.data,h=h.next;return b}}Object(n.a)(Yu,"Stack",null,[]);class Dj{constructor(b){this.Xi=b;this.Etc=this.fqd=null;this.lid=!1}get IHd(){return this.Etc.QA()}reset(){this.Xi.reset();this.fqd=new Yu;this.Etc=new Yu;this.Etc.push(this.Xi.sJc);this.lid=!1}B6d(){this.lid=!1}OJ(b){this.lid||(this.fqd.push(null),this.lid=!0);this.fqd.push(b)}onClose(){for(;;){const b=this.fqd.pop();if(!b)break;b()}}Klj(){return!1}tjn(){this.jv(()=>!0)}jv(b){const h=this.IHd.clone();return b(h)?(this.Etc.push(h),
this.Xi.rGa(h),this.OJ(Object(z.a)(this,this.ppn,"onFormattingEnd")),!0):!1}Hwf(b){return b.style?this.jv(h=>this.Klj(h,b))?1:2:2}ppn(){this.Etc.pop();this.Xi.rGa(this.IHd)}Lca(){}u6d(){return 2}xSf(){return 2}ySf(){return 2}CSf(){return 2}RSf(){return 3}TSf(){}A6d(){return 2}USf(){}VSf(){}WSf(){return 2}D6d(){return 2}E6d(){return 2}jTf(){return 2}F6d(){}lTf(){return 2}G6d(){return 2}H6d(){return 2}K6d(){return 2}L6d(){return 2}xTf(){}yTf(){return 2}S6d(){return 2}T6d(){return 2}W6d(){return 2}X6d(){return 2}Z6d(){return 2}$6d(){return 2}b7d(){return 2}d7d(){return 2}YTf(){return 2}k7d(){return 2}eUf(){return 2}gUf(){}hUf(){return 2}n7d(){return 2}o7d(){return 2}p7d(){return 2}q7d(){return 2}r7d(){return 2}s7d(){return 2}oUf(){return 3}t7d(){}vUf(){return 2}u7d(){return 2}xUf(){return 3}x7d(){}DUf(){}y7d(){return 2}JUf(){return 3}A7d(){return 2}C7d(){return 2}E7d(){return 2}F7d(){return 2}VUf(){}ZUf(){return 3}H7d(){return 2}onMenuOpen(){return 2}cVf(){}lVf(){return 2}mVf(){return 2}oVf(){return 3}T7d(){return 2}qVf(){return 2}U7d(){return 2}Y7d(){return 2}xVf(){}e8d(){return 2}IVf(){return 2}m8d(){return 2}n8d(){return 2}$Vf(){return 3}gWf(){return 2}v8d(){return 2}w8d(){return 2}y8d(){return 2}z8d(){return 2}kWf(){return 3}A8d(){return 2}D8d(){return 2}F8d(){return 2}nWf(){return 2}w0c(){return 2}qWf(){return 2}rWf(){return 2}I8d(){return 2}sWf(){return 2}vWf(){return 3}N8d(){return 2}O8d(){return 2}P8d(){return 2}Q8d(){return 2}U8d(){return 2}R8d(){return 2}static Wga(b){return b&&
-1!==b.indexOf("px")&&(b=parseInt(G.a.substring(b,0,b.indexOf("px"))),!isNaN(b))?b:0}static cfi(b){if(!b||""===b)return-1;const h=G.a.Ug(b);if(-1!==h.indexOf("pt")){if(b=parseFloat(G.a.substring(b,0,h.indexOf("pt"))),!isNaN(b))return b}else if(-1!==h.indexOf("px")&&(b=parseFloat(G.a.substring(b,0,h.indexOf("px"))),!isNaN(b)))return 3*b/4;return-1}static Rbi(b){b=Dj.cfi(b);return-1===b?0:0>b?(u.ULS.sendTraceTag(508925786,307,50,"Negative margin in px or pt"),0):b}static Edm(b){return Dj.cfi(b)}static zei(b){return b&&
""!==b?Dj.Wga(b):null}static cE(b){let h=null,v=null,D=null,P=null;b&&b.pf&&(h=Dj.RQ(b.pf,"id"),v=Dj.RQ(b.pf,"lang"),D=b.pf.tagName,b.JEk&&(P=Object.assign(new Vx,{x:Dj.Wga(b.pf.style.left),y:Dj.Wga(b.pf.style.top),left:Dj.zei(b.pf.style.left),top:Dj.zei(b.pf.style.top)})),void 0===h&&(h=""),void 0===v&&(v=""));return new cp.a(new Ki(h,D),b.yB,null,v,P)}static RQ(b,h){return b[h]}}Object(n.a)(Dj,"AHtmlTranslator",null,[276]);class ds extends cp.a{constructor(b,h,v,D=0,P=0,ca=null){super(ca?ca.t9:
null,ca?ca.yB:null,ca?ca.Ixa:null,ca?ca.cultureName:null,ca?ca.YBa:null);this.width=D;this.height=P}}Object(n.a)(ds,"AugmentationSemanticArgs",cp.a,[]);class Ww{constructor(b,h,v,D,P,ca,ta){this.ccpId=b;this.pKey=h;this.type=v;this.count=D;this.dc=P;this.client=ca;this.version=ta}}Object(n.a)(Ww,"ClipServiceArgs",null,[]);var ow;(ow||(ow={})).Chart="chart";Object(n.b)("ClipServiceDataType",ow);var uA;(uA||(uA={})).ExcelOnline="XLO";Object(n.b)("ClipServiceClientApp",uA);class Gu{constructor(){this.stop=
this.color=null}}Object(n.a)(Gu,"ColorStopPair",null,[]);var kp=c(1972);class Xj{constructor(){this.direction=null;this.eHc=new nk.a}Tmi(){return!!this.direction&&0<this.direction.length}}Object(n.a)(Xj,"LinearGradient",null,[]);class Xw{constructor(){this.uac=!1}}Object(n.a)(Xw,"HtmlTranslatorContext",null,[]);var es=c(1849);class ml{constructor(b,h){this.spaceBefore=b;this.spaceAfter=h}}Object(n.a)(ml,"IndentationProperties",null,[]);var rp=c(1385);class yt extends cp.a{constructor(b,h,v,D,P=null,
ca=0,ta=null,Ra=null,mb=!1,Jb=!1,Ub=69905,cc=null){super(cc?cc.t9:null,cc?cc.yB:null,cc?cc.Ixa:null,cc?cc.cultureName:null,cc?cc.YBa:null);this.colSpan=b;this.rowSpan=h;this.width=v;this.Wbc=Jb;this.height=D;this.o3a=mb;this.shadingColor=P;this.verticalAlignment=ca;this.oja=ta;this.lle=Ra;this.C7=Ub}}Object(n.a)(yt,"TableCellSemanticArgs",cp.a,[]);class Wx extends cp.a{constructor(b,h=null){super(h?h.t9:null,h?h.yB:null,h?h.Ixa:null,h?h.cultureName:null,h?h.YBa:null);this.height=b}}Object(n.a)(Wx,
"TableRowSemanticArgs",cp.a,[]);class Us extends cp.a{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb=null,Ub=-1,cc=null){super(cc?cc.t9:null,cc?cc.yB:null,cc?cc.Ixa:null,cc?cc.cultureName:null,cc?cc.YBa:null);this.zEd=null;this.rowCount=b;this.Teb=h;this.width=v;if(P)for(this.zEd=Array(P.length),b=0;b<P.length;++b)this.zEd[b]=P[b];this.aCf=ca;this.Thg=Ra;this.xHm=ta;this.o3a=D;this.EWd=mb;this.styleId=Jb;this.tableLook=Ub}}Object(n.a)(Us,"TableSemanticArgs",cp.a,[]);var Xr=c(1401);let Lv;class tm extends Dj{get KLm(){if(null!=
this.qDg)var b=this.qDg;else{var h;w.AFrameworkApplication.ue("FontFamilyFix;FontFamilyFixCf");b=this.qDg=null===(h=w.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.FontFamilyFixIsEnabled",!1)}return b}constructor(b,h,v=new Xw,D=null){super(b);this.settings=h;this.context=v;this.fYc=D;this.qvb=null;this.Kak=jb.a.D5("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,
"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.fmo=new Set(["DIV","P"])}get SGi(){return this.Kak}ybi(b,h){var v;if((v=b.style?b.style.listStyleType:"")&&""!==v&&(v=this.SGi[G.a.Ug(v)])||(v=Dj.RQ(b,"type"))&&""!==v&&(v=this.SGi[v]))return v;if((v=b.tagName.toLowerCase())&&("ol"===v||"ul"===v)&&(b=b.className))if("ul"===v)switch(b=tm.gTd(b,"BulletListStyle"),b){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;
case "BulletListStyle3":return 5}else if("ol"===v)switch(b=tm.gTd(b,"NumberListStyle"),b){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return h}rbi(b){let h=-1,v=b.tagName.toLowerCase();if("ol"===v||"ul"===v){b=ic.a.t9h(b,"li");if(!b)return h;v="li"}if("li"===v){h=(h=this.gOd(b,"data-aria-level",0))?h:-1;if(0<h)return h-1;if(b=ic.a.t9h(b,"p"))return tm.y2l(b)-1}return h}gOd(b,
h,v){b=b.getAttribute(h);b=parseInt(b);return isNaN(b)||0>b?v:b}ern(){this.qvb.pop();this.Xi.xxa()}JQc(b,h){this.jv(P=>P.pda(0,0));const v=this.ybi(b.pf,h?6:2);let D=1;h&&(D=this.gOd(b.pf,"start",1));h=!1;h=b.pf.getAttribute("data-pasteFromRc");(h=!!h&&"true"===h)&&b.pf.removeAttribute("data-pasteFromRc");(aa.a.k4||aa.a.lj)&&tm.aEd(b.pf);b=new rp.a(v,D,Dj.cE(b),0,-1,h);this.qvb.push(b);this.Xi.zxa(b);this.OJ(Object(z.a)(this,this.ern,"onListElementClose"));return 1}Yel(b,h,v){return(h=h.getAttribute(v))?
b.Sbf(h):!1}reset(){super.reset();this.qvb=new Yu}static get uVc(){if(null!=tm.wDg)var b=tm.wDg;else{var h;w.AFrameworkApplication.ue("ghdeg324;j91ib322");b=null===(h=w.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isPastedHtmlRenderingInIframeEnabled",!1);b=tm.wDg=b}return b}Klj(b,h){var v,D,P,ca;let ta=!1;try{var Ra=h.getAttribute("xml:lang")||Dj.RQ(h,"lang")}catch(Ub){Ra=null}Ra&&""!==Ra&&(ta=b.jbg(Ra)||ta);(Ra=Dj.RQ(h,"dir"))&&(ta=b.zjc(Ra)||
ta);if(this.settings.cto(this.context)&&h.getAttribute)for(Ra=0;Ra<tm.Mwj.length;Ra++)ta=this.Yel(b,h,tm.Mwj[Ra])||ta;Ra=h.style;var mb=0;Xr.a.wQa&&(mb=window.performance.now());const Jb=tm.uVc?getComputedStyle(h):null;Xr.a.wQa&&(Xr.a.Bme+=window.performance.now()-mb,Xr.a.P5d+=1);if(Ra){if(Ra.fontWeight){mb=G.a.XA(Ra.fontWeight);const Ub=parseInt(mb);isNaN(Ub)?"BOLD"===mb?ta=b.sL(!0)||ta:"NORMAL"===mb&&(ta=b.sL(!1)||ta):ta=600<=Ub?b.sL(!0)||ta:b.sL(!1)||ta}this.settings.rqj&&Ra.fontSize&&(mb=null!==
(v=null===Jb||void 0===Jb?void 0:Jb.fontSize)&&void 0!==v?v:Ra.fontSize,v=Dj.Edm(mb),0<v&&(ta=b.Tge(Math.floor(2*v))||ta));(null===(D=w.AFrameworkApplication.K)||void 0===D?0:D.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&this.fmo.has(h.tagName)&&(D=Dj.Rbi(null!==(P=null===Jb||void 0===Jb?void 0:Jb.marginTop)&&void 0!==P?P:Ra.marginTop),P=Dj.Rbi(null!==(ca=null===Jb||void 0===Jb?void 0:Jb.marginBottom)&&void 0!==ca?ca:Ra.marginBottom),ta=b.pda(D,P)||
ta);this.settings.gto(this.context)&&(this.settings.vqj&&h.getAttribute?(ca=h.getAttribute("data-indent"))&&0<ca.length&&(ca=Ef.a.Ji(parseInt(ca),0)+"px",ta=b.Rhe(ca)||ta):Ra.textIndent&&(ta=b.Rhe(Ra.textIndent)||ta));this.settings.bto(this.context)&&Ra.marginLeft&&(this.settings.vqj&&h.getAttribute?(ca=h.getAttribute("data-margin"))&&0<ca.length&&(ta=b.Via(Ra.marginLeft)||ta):"TABLE"!==h.tagName&&(ta=b.Via(Ra.marginLeft)||ta));if(this.settings.eto(this.context)&&(ca=h.getAttribute("style"))&&""!==
ca)for(ca=ca.split(";"),P=0;P<ca.length;P++)D=ca[P].trim(),D.startsWith("tab-stops")&&(ta=b.$bg(D.replace("tab-stops:",""))||ta);this.settings.ato(this.context)&&Ra.lineHeight&&(ta=b.eD(Ra.lineHeight)||ta);this.settings.Yso&&(ca=Ra.textTransform?G.a.Ug(Ra.textTransform):null,P=Ra.fontVariantCaps?G.a.Ug(Ra.fontVariantCaps):null,D=Ra.fontVariant?G.a.Ug(Ra.fontVariant):null,"uppercase"===ca?ta=b.O7c("uppercase")||ta:"small-caps"===P||D&&0<=D.indexOf("small-caps")?ta=b.O7c("small-caps")||ta:this.settings.xUk&&
"none"===ca&&(ta=b.O7c("none")||ta));this.settings.fto(this.context)&&Ra.textAlign&&(ta=b.HOb(G.a.Ug(Ra.textAlign))||ta);Ra.fontStyle&&(ca=G.a.XA(Ra.fontStyle),"ITALIC"===ca||"OBLIQUE"===ca?ta=b.xob(!0)||ta:"NORMAL"===ca&&(ta=b.xob(!1)||ta));ca=tm.ygm(h);if(Ra.textDecoration||ca)P=G.a.Ug(Ra.textDecoration||""),ca=G.a.Ug(ca||""),h.parentNode&&h.parentNode.tagName&&"a"===G.a.Ug(h.parentNode.tagName)?(D=(h.querySelector(".TextRun")||h).className)&&-1<D.indexOf("Underlined")&&(ta=b.m5(!0)||ta):Ra.gpp||
tm.isUnderline(P)||tm.isUnderline(ca)?ta=b.m5(!0)||ta:this.settings.Drj&&(ta=b.m5(!1)||ta),Ra.fpp||tm.fzi(P)||tm.fzi(ca)?ta=b.Yia(!0)||ta:this.settings.Drj&&(ta=b.Yia(!1)||ta);if(Ra.verticalAlign){ca=G.a.XA(Ra.verticalAlign);P=this.XQn(ca);if("SUB"===ca||this.settings.uqj(this.context)&&h.className&&-1<h.className.indexOf("Subscript")||0>P&&this.settings.$qj)ta=b.GHa(!0)||ta;else if("SUPER"===ca||this.settings.uqj(this.context)&&h.className&&-1<h.className.indexOf("Superscript")||0<P&&this.settings.$qj)ta=
b.vqa(!0)||ta;this.settings.rqj&&("SUB"===ca||"SUPER"===ca)&&h.getAttribute&&(ca=parseFloat(h.getAttribute("data-fontsize")),isNaN(ca)||(ta=b.Tge(Math.floor(2*ca))||ta))}ca=!1;w.AFrameworkApplication.K&&(ca=w.AFrameworkApplication.K.$("CopyAndPasteFontTelemetryIsEnabled"));this.settings.$so&&Ra.fontFamily&&(this.settings.ito&&h.getAttribute?(P=h.getAttribute("data-usefontface"))&&"true"===P&&(ca&&u.ULS.sendTraceTag(524038490,307,50,"Customized fontface"),ta=this.Ilj(b,Ra.fontFamily,ta)):ta=this.Ilj(b,
Ra.fontFamily,ta));P=null;this.settings.Zso&&Ra.color&&(P=kp.a.zua(Ra.color));D=!!P;this.settings.hto(this.context)&&h.getAttribute&&(P=h.getAttribute("data-scheme-color"),P=null!==P?P:"",D=""!==P||!this.context.uac||tm.JUm(h));D&&(ta=b.Uv(P)||ta);this.settings.Wso&&Ra.backgroundColor&&(h.tagName&&tm.uIo.contains(G.a.XA(h.tagName))||(ta=b.Dya(kp.a.zua(Ra.backgroundColor))||ta));if(this.settings.Xso&&Ra.backgroundImage&&h.className&&-1<h.className.indexOf("Highlight")&&(Ra=tm.pjm(Ra.backgroundImage))&&
0<Ra.eHc.count){P=Ra.eHc.J(0).color;D=!0;for(v=0;v<Ra.eHc.count&&(D=D&&P===Ra.eHc.J(v).color,D);v++);D&&(ca&&u.ULS.sendTraceTag(524038491,307,50,"Paste text with highlight"),ta=b.Dya(kp.a.zua(P))||ta)}}this.settings.tqj(this.context)&&h.getAttribute&&(Ra=h.getAttribute("data-ccp-props"))&&(ta=b.S9(Ra)||ta);h.getAttribute&&((Ra=h.getAttribute("data-ccp-charstyle"))&&this.settings.Wob&&(ta=b.yge(Ra)||ta),(h=h.getAttribute("data-ccp-parastyle"))&&this.settings.Wob&&(ta=b.Che(h)||ta));return ta}evo(b){if(this.settings.fvo)for(b=
b.parentNode;b&&b.tagName;){if(b.className&&Object.getType(b.className)===String&&-1<G.a.XA(b.className).indexOf("MSOCOM"))return!0;if("DIV"===G.a.XA(b.tagName))break;b=b.parentNode}return!1}Ilj(b,h,v){if(this.KLm){h=tm.JMl(h);let P=!1;if(!h)return v;for(var D of h)if(P=b.cTa(D,this.settings.kxj))break;return P||v}D=tm.N9h(h);return b.cTa(D,this.settings.kxj)||v}XQn(b){let h=0;b&&b.length&&(b=parseInt(b),isNaN(b)||(h=b));return h}Lca(b,h){"\u200b"===b&&(b="\u00a0");h&&h.pf&&this.evo(h.pf)&&(b="");
this.Xi.Lca(b,Dj.cE(h))}u6d(b){const h=Dj.RQ(b.pf,"href");return h&&""!==h?(this.Xi.DRa(h,Dj.cE(b)),this.OJ(Object(z.a)(this.Xi,this.Xi.CRa,"onAnchorEnd")),1):2}A6d(){return this.jv(b=>b.sL(!0))?1:2}D6d(){return this.jv(b=>b.Cwf())?1:2}E6d(b){this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.pF,"onParagraphEnd"));return 1}F6d(b){this.Xi.Kca(Dj.cE(b))}G6d(b){this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.pF,"onParagraphEnd"));return 1}K6d(){return this.jv(b=>b.xob(!0))?1:2}H6d(b){this.jv(h=>
h.HOb("center"));this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.pF,"onParagraphEnd"));return 1}L6d(){return this.jv(b=>b.cTa("consolas"))?1:2}T6d(){return this.jv(b=>b.Yia(!0))?1:2}S6d(b){return this.JQc(b,!1)}W6d(){return this.jv(b=>b.xob(!0))?1:2}X6d(b){return this.JQc(b,!1)}Z6d(b){var h=b.pf.getAttribute("data-render-src");const v=b.pf.getAttribute("data-render-method");if(h&&""!==h&&v&&""!==v){const ta=b.pf.getAttribute("data-render-fallback");let Ra=0,mb=0;if(b.pf.currentStyle){var D=
b.pf.currentStyle.width,P=b.pf.currentStyle.height;D&&-1!==D.indexOf("px")&&(D=parseInt(G.a.substring(D,0,D.indexOf("px"))),isNaN(D)||(Ra=D));P&&-1!==P.indexOf("px")&&(P=parseInt(G.a.substring(P,0,P.indexOf("px"))),isNaN(P)||(mb=P))}b=new ds(h,v,ta,Ra,mb,Dj.cE(b));this.Xi.Q4a(b);return 2}(aa.a.k4||aa.a.lj)&&(h=b.pf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")))&&h.length&&tm.aEd(b.pf);const ca=b.pf.getAttribute("align");this.jv(ta=>ta.HOb(ca));this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.pF,
"onParagraphEnd"));return 1}$6d(b){this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.pF,"onParagraphEnd"));return 1}b7d(b){this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.pF,"onParagraphEnd"));return 1}d7d(){return this.jv(b=>b.xob(!0))?1:2}k7d(b){return this.jv(h=>{var v=tm.N9h(b.pf.getAttribute("face"));v=h.cTa(v);h=h.Uv(kp.a.zua(b.pf.getAttribute("color")));return v||h})?1:2}n7d(b){this.jv(h=>this.settings.Wob?h.zob(1):h.Bob(1));this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,
this.Xi.pF,"onParagraphEnd"));return 1}o7d(b){this.jv(h=>this.settings.Wob?h.zob(2):h.Bob(2));this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.pF,"onParagraphEnd"));return 1}p7d(b){this.jv(h=>this.settings.Wob?h.zob(3):h.Bob(3));this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.pF,"onParagraphEnd"));return 1}q7d(b){this.jv(h=>this.settings.Wob?h.zob(4):h.Bob(4));this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.pF,"onParagraphEnd"));return 1}r7d(b){this.jv(h=>this.settings.Wob?
h.zob(5):h.Bob(5));this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.pF,"onParagraphEnd"));return 1}s7d(b){this.jv(h=>this.settings.Wob?h.zob(6):h.Bob(6));this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.pF,"onParagraphEnd"));return 1}t7d(b){this.Xi.Kca(Dj.cE(b))}x7d(b){var h=b.pf;const v=h.src,D=h.alt,P=h.ckp,ca=h.getAttribute("data-external-content-url");let ta=0,Ra=0;h.style&&(ta=Dj.Wga(h.style.width),Ra=Dj.Wga(h.style.height));ta&&Ra||(ta=h.width,Ra=h.height);let mb=0,Jb=0;b.pf.currentStyle&&
(ta||Ra||(ta=Dj.Wga(b.pf.currentStyle.width),Ra=Dj.Wga(b.pf.currentStyle.height)),mb=Dj.Wga(b.pf.currentStyle.maxWidth),Jb=Dj.Wga(b.pf.currentStyle.maxHeight));let Ub=null;const cc=h.getAttribute(Xk.$Hd);if(cc&&(u.ULS.sendTraceTag(524038492,307,50,"Chart paste from xlo"),w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("ChartsPasteFromXLOIsEnabled"))){const Ac=h.getAttribute(Xk.idf),Lc=h.getAttribute(Xk.jdf),id=h.getAttribute(Xk.gdf),vd=h.getAttribute(Xk.hdf),xe=h.getAttribute(Xk.jJc);h=h.getAttribute(Xk.kdf);
Ac&&vd&&(Ub=new Ww(cc,Ac,Lc,id,vd,xe,h))}b=new es.a(v,D,ta,Ra,Dj.cE(b),mb,Jb,P,null,ca,Ub);this.Xi.vxa(b)}u7d(){return this.jv(b=>b.xob(!0))?1:2}y7d(){return this.jv(b=>b.m5(!0))?1:2}A7d(){return this.jv(b=>b.cTa("consolas"))?1:2}C7d(b){this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.pF,"onParagraphEnd"));return 1}E7d(b){this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.pF,"onParagraphEnd"));return 1}F7d(b){let h;const v=this.ybi(b.pf,0);let D=this.gOd(b.pf,"value",0);0<this.qvb.count?
h=this.qvb.QA():(h=new rp.a(2,1,Dj.cE(b)),D||(D=1));var P=tm.K2l(b.pf,rp.a.RDj);3!==P&&(h.Wr=P);P=h.listLevel;let ca=h.listId;this.settings.sqj?(P=this.rbi(b.pf),P=0>P&&0>h.listLevel&&0<this.qvb.count?h.listLevel=this.qvb.count-1:h.listLevel=0<=P?P:h.listLevel,this.fYc&&this.fYc.b<P&&(this.fYc.b=P)):0>P&&(P=h.listLevel=this.rbi(b.pf));1>ca&&(ca=h.listId=this.gOd(b.pf,rp.a.ZXc,0));b.pf.getAttribute(rp.a.C1d)&&(h.levelText=b.pf.getAttribute(rp.a.C1d));var ta=b.pf.getAttribute(rp.a.NJf);ta&&(h.font=
ta);ta=!1;w.AFrameworkApplication.K&&(ta=w.AFrameworkApplication.K.$("FollowDestinationThemePasteIsEnabled"));if(ta){var Ra=b.pf.getAttribute("data-charcodes");ta=[];if(Ra&&""!==Ra)if(-1<Ra.indexOf(",")){Ra=Ra.split(",");for(var mb=0;mb<Ra.length;mb++)ta.push(parseInt(Ra[mb]))}else ta.push(parseInt(Ra));if(ta&&0<ta.length){Ra=Array(ta.length);for(mb=0;mb<ta.length;mb++)Ra[mb]=ta[mb];h.f7e=Ra}(ta=b.pf.getAttribute("data-buAutoNum"))&&0<ta.length&&(h.buAutoNum=parseInt(ta))}(P=0<=P&&0<ca)&&tm.aEd(b.pf);
h.LFk(v,D,P);h.MJf=this.k2l(b.pf);this.Xi.wGa(h.clone());this.OJ(Object(z.a)(this.Xi,this.Xi.yxa,"onListItemEnd"));return 1}k2l(b){var h=b.getAttribute(rp.a.BGi);if(!h)return null;b=void 0;try{b=JSON.parse(h)}catch{u.ULS.sendTraceTag(524038493,307,15,"getListDefnPropsFromElement for CCP - Cannot parse list definition properties from element attribute.")}if(!b)return null;h=new Md.DictionaryPropertySet;for(const v in b)h.uoj(+v,b[v]);return h}onMenuOpen(b){return this.JQc(b,!1)}H7d(b){if(this.jv(h=>
h.njc(!0))){const h=b.pf.getAttribute("OuterHtml");this.Xi.HRa(h,Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.O4a,"onMathEnd"))}return 1}T7d(b){return this.JQc(b,!0)}U7d(b){this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.pF,"onParagraphEnd"));return 1}Y7d(b){const h=b.pf.getAttribute("align");this.jv(D=>D.HOb(h));const v=b.pf.parentNode;v&&v.tagName.toLowerCase().startsWith("li")&&tm.aEd(b.pf,aa.a.k4||aa.a.lj);this.Xi.aE(Dj.cE(b));this.OJ(Object(z.a)(this.Xi,this.Xi.pF,"onParagraphEnd"));
return 1}e8d(){this.jv(b=>b.cTa("consolas"));this.Xi.vmb();this.OJ(Object(z.a)(this.Xi,this.Xi.umb,"onPreFormattedTextEnd"));return 1}m8d(){return this.jv(b=>b.Yia(!0))?1:2}n8d(){return this.jv(b=>b.cTa("consolas"))?1:2}v8d(){return this.jv(b=>b.ifg())?1:2}w8d(b){var h=b.pf.attributes.getNamedItem("style"),v="";h&&h.value&&(v=h.value);h=kp.a.NBn(v);if(0<h&&this.settings.CBm){for(v=0;v<h;v++)this.Xi.Amb(Dj.cE(b));return 3}return 2}y8d(){return this.jv(b=>b.Yia(!0))?1:2}z8d(){return this.jv(b=>b.sL(!0))?
1:2}A8d(){return this.jv(b=>b.GHa(!0))?1:2}D8d(){return this.jv(b=>b.vqa(!0))?1:2}F8d(b){this.jv(Ub=>Ub.clearFormatting()&&Ub.E7f());kp.a.NUd(b.pf,this);const h=kp.a.Tji(b.pf),v=kp.a.N5h(b.pf),D=kp.a.nJ(b.pf),P=kp.a.$K(b.pf),ca=!parseInt(Dj.RQ(b.pf,"border")),ta=kp.a.jUm(b.pf);let Ra=-1,mb="";var Jb=-1;b.pf.attributes.hasOwnProperty("style")&&-1!==(Jb=b.pf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?Ra=parseInt(b.pf.attributes.getNamedItem("style").value.substr(Jb+17)):b.pf.attributes.hasOwnProperty(Yn.a.aId.toString())&&
(Ra=parseInt(b.pf.attributes.getNamedItem(Yn.a.aId.toString()).value));Jb=-1;b.pf.attributes.hasOwnProperty("class")&&-1!==(Jb=b.pf.attributes.getNamedItem("class").value.indexOf("Mso"))?mb=b.pf.attributes.getNamedItem("class").value.substr(Jb).split(" ")[0]:b.pf.attributes.hasOwnProperty(Yn.a.kJc.toString())&&(mb=b.pf.attributes.getNamedItem(Yn.a.kJc.toString()).value);this.Xi.p9(new Us(0,0,h.value,h.uBi,null,ca,ta,v,new ml(D.value,P.value),mb,Ra,Dj.cE(b)));this.OJ(Object(z.a)(this.Xi,this.Xi.n9,
"onTableEnd"));w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");return 1}w0c(b){const h=kp.a.A$h(b.pf),v=kp.a.Tji(b.pf);if(!v.value&&v.gZd&&(w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.settings.U0i))return 3;let D=parseInt(Dj.RQ(b.pf,"colSpan"));if(void 0===D||null===D||""===D+"")D=v.value?1:0;let P=parseInt(Dj.RQ(b.pf,"rowSpan"));if(void 0===P||null===P||""===P+"")P=h.value?
1:0;let ca=!1;b.pf.attributes.hasOwnProperty("style")&&(ca=-1!==b.pf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==b.pf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!ca&&b.pf.attributes.hasOwnProperty("class")&&(ca=-1!==b.pf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let ta=69905;if(b.pf.attributes.hasOwnProperty(Yn.a.fdf.toString())){var Ra=parseInt(b.pf.attributes.getNamedItem(Yn.a.fdf.toString()).value);
isNaN(Ra)||(ta=Ra)}Ra=kp.a.zua(b.pf.style.backgroundColor);const mb=kp.a.tjm(b.pf);this.jv(cc=>cc.pda(0,0));kp.a.NUd(b.pf,this);const Jb=kp.a.N5h(b.pf),Ub=this.settings.xCn?kp.a.eQl(b.pf):null;b=new yt(D,P,v.value,h.value,Ra,mb,Jb,Ub,v.uBi,ca,ta,Dj.cE(b));this.Xi.m9(b);this.OJ(Object(z.a)(this.Xi,this.Xi.l9,"onTableCellEnd"));this.tjn();return 1}I8d(b){const h=this.w0c(b);if(3===h)return h;this.jv(v=>{const D=v.sL(!0);v=v.HOb("center");return D||v});kp.a.NUd(b.pf,this);return 1}N8d(b){kp.a.NUd(b.pf,
this);const h=kp.a.A$h(b.pf);if(h.gZd&&!h.value&&(w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.settings.U0i))return 3;this.Xi.M4(new Wx(h.value,Dj.cE(b)));this.OJ(Object(z.a)(this.Xi,this.Xi.o9,"onTableRowEnd"));return 1}O8d(){return this.jv(b=>b.cTa("consolas"))?1:2}P8d(){return this.jv(b=>b.m5(!0))?1:2}Q8d(b){return this.JQc(b,!1)}R8d(){return 2}U8d(){return this.jv(b=>b.m5(!0))?1:2}static bWl(b){return b?b.split(",")[0]:null}static IMl(b){return b?
b.split(","):null}static dCj(b){if(!b)return null;b=G.a.Q5f(b.trim(),'"');return b=G.a.Q5f(b,"'")}static N9h(b){if(!b)return null;b=tm.bWl(b);return b=tm.dCj(b)}static JMl(b){var h;if(!b)return null;b=null===(h=tm.IMl(b))||void 0===h?void 0:h.map(v=>tm.dCj(v));h=null===b||void 0===b?void 0:b.filter(v=>!!v);return null!==h&&void 0!==h?h:null}static wph(b,h){h=h.trim();var v=h.match(RegExp("^-?[0-9]+deg$"));if(v&&0<v.length){if(b.Tmi())return!1;b.direction=h;return!0}if((v=h.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&
0<v.length){if(b.Tmi())return!1;b.direction=h;return!0}var D=(v=h.match(RegExp("^rgb\\(.*\\)")))&&0<v.length?h.indexOf(")")+1:h.indexOf(" ");v=-1===D?h:kp.a.zua(h.substr(0,D).trim());if(!v||""===v)return!1;h=-1===D?"":h.substr(D).trim();D=new Gu;D.color=v;D.stop=h;b.eHc.add(D);return!0}static pjm(b){try{if(!b)return null;b=b.trim();if(!b.startsWith("linear-gradient(")||!b.endsWith(")"))return null;let h=b.substr(16);h=h.substr(0,h.lastIndexOf(")"));const v=new Xj;for(;0<h.trim().length;){let D=h.indexOf(",");
const P=h.indexOf("(");if(0<P&&P<D){const ca=h.indexOf(")");if(ca<P)return null;D=h.indexOf(",",ca)}if(-1===D){if(!tm.wph(v,h))return null;h=""}else{const ca=h.substr(0,D);h=h.substr(D+1);if(!tm.wph(v,ca))return null}}return v}catch(h){return null}}static gTd(b,h){b=b.split(" ");if(0<b.length)for(let v=0;v<b.length;v++)if(0<=b[v].indexOf(h))return b[v];return""}static aEd(b,h=!1){b&&3!==b.nodeType&&(b.style.margin="",h&&tm.sEh(b,h))}static sEh(b,h){if(b)for(b=b.firstChild;b;)3!==b.nodeType&&(b.style&&
(b.style.margin=""),h&&tm.sEh(b,h)),b=b.nextSibling}static y2l(b){if("p"!==b.tagName.toLowerCase())return-1;if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf("mso-list")){b=b.split(";");for(let v=0;v<b.length;v++){var h=b[v].split(":");if(2===h.length&&"mso-list"===h[0].trim()&&(h=h[1].trim().split(" "),3===h.length))return Number.parseInvariant(h[1].substr(5))}}return-1}static K2l(b,h){if(!b)return 3;switch(b.getAttribute(h)){case "default":return 0;case "numbered":return 1;case "bullet":return 2;
default:return 3}}static JUm(b){return!(void 0===b.className||null===b.className)&&b.className.startsWith("TextRun")}static ygm(b){b=b.style.textDecorationLine;return void 0===b||null===b?null:b}static fzi(b){return 0<=b.indexOf("line-through")}static isUnderline(b){return 0<=b.indexOf("underline")}}tm.uIo=(Lv=new Fb.a,Lv.add("TABLE"),Lv.add("THEAD"),Lv.add("TBODY"),Lv.add("TFOOT"),Lv.add("TR"),Lv.add("TH"),Lv.add("TD"),Lv);tm.Mwj=["data-ccp-charstyle-defn","data-ccp-parastyle-defn","data-ccp-charstyle-linked-defn",
"data-ccp-parastyle-linked-defn"];Object(n.a)(tm,"DefaultHtmlTranslator",Dj,[]);var gq=c(1552);class dn{constructor(b=null){this.Y2=b||gq.a.Yji("");this.d8g=Number.parseInvariant((new Date).format("HHmmss"))}get Gc(){return this.Y2}process(b,h){if(b&&b.querySelectorAll){const ca=b.querySelectorAll("p");if(ca&&0<ca.length){for(var v=0,D=!1,P=ca[0].parentNode;5>v&&P&&P!==b;){v++;const ta=P.id.toLowerCase();if(ta&&ta.length&&-1!==ta.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(P,"WACEditing")&&
Sys.UI.DomElement.containsCssClass(P,"EditingSurfaceBody")){D=!0;break}P=P.parentNode}if(D&&P!==b){v=b.firstChild;for(D=!1;0<P.children.length&&P.children[0]!==v;)b.insertBefore(P.children[0],v),D=!0;if(D)for(;v;)P=v.nextSibling,b.removeChild(v),v=P}b=new Eu.a(h,Object(z.a)(this,this.KJn,"processNodesDiscovery"),new xt(ca));b.Jl("Word Converter Operation");b.Gh=!h||h.Gh;b.run()}}}KJn(b,h){const v=h.nodes[h.VNa];var D=dn.t2l(v);if(D){let ca=D.Npe.replace(RegExp("level[0-9]"),"").trim();ca=ca&&ca.length?
ca:D.Npe;let ta=h.lists[ca];ta||(ta=new Vp,ta.Fmc=this.d8g++);let Ra=ta.hdc[D.level-1];Ra||(Ra=new Qe,Ra.level=D.level);var P=v.parentNode;if(P&&"li"===P.tagName.toLowerCase()){if(P=P.parentNode)!(P=P.tagName.toUpperCase())||"OL"!==P&&"UL"!==P||(Ra.tagName=P)}else Ra.Blb=dn.f9h(v,5),Ra.Blb&&Ra.Blb.length||(Ra.Blb=dn.Juf(v,5)),Ra.ignore=!Ra.Blb||!Ra.Blb.length,Ra.tagName=dn.e9h(Ra.Blb),"UL"===Ra.tagName&&(Ra.font=this.Q9h(v,5));D.Fmc=ta.Fmc;Ra.Zjn++;Ra.ignore||"li"===v.parentNode.tagName.toLowerCase()||
(P=(P=dn.Juf(v,5))?P:Ra.Blb)&&P.length&&(D.kZh=P,(P=dn.Blo(v,P,Ra.listStyle,D.level-1))&&P.length&&(Ra.listStyle=P));h.dlb[h.dlb.length]=D;Ra.dlb.contains(D)||Ra.dlb.add(D);if(void 0===ta.hdc[D.level-1]||null===ta.hdc[D.level-1]||ta.hdc[D.level-1]!==Ra)ta.hdc[D.level-1]=Ra;h.lists[ca]&&h.lists[ca]===ta||(h.lists[ca]=ta);h.oFi=v}else if((D=h.oFi)&&dn.iam(v)===D&&v.tagName===D.tagName&&v.className===D.className){D.appendChild(D.ownerDocument.createElement("BR"));for(D.appendChild(D.ownerDocument.createElement("BR"));v.firstChild;)D.appendChild(v.firstChild);
v.parentNode.removeChild(v)}h.VNa++;if(h.nodes.length<=h.VNa){if(!h.dlb.length)return!1;h.VNa=0;b.hi(Object(z.a)(this,this.JJn,"processNodeConvert"))}return!0}JJn(b,h){b=h.dlb[h.VNa];var v=b.yyn,D=b.Npe.replace(RegExp("level[0-9]"),"").trim();D=D&&D.length?D:b.Npe;D=h.lists[D];var P=D.hdc[b.level-1],ca=v.parentNode.tagName.toLowerCase();if(!P.ignore&&v.parentNode&&"li"!==ca){if(ca=dn.Ubl(v,P)){dn.eEh(v,5);const ta=v.ownerDocument.createElement("LI");ta.setAttribute("data-aria-level",String.format("{0}",
b.level));ta.setAttribute(rp.a.ZXc,String.format("{0}",D.Fmc));"UL"===P.tagName&&(ta.setAttribute(rp.a.C1d,String.format("{0}",b.kZh)),ta.setAttribute(rp.a.NJf,String.format("{0}",P.font)));for(;v.firstChild;)ta.appendChild(v.firstChild);ca.appendChild(ta);v.parentNode.removeChild(v);"UL"===P.tagName?this.Gc.b++:this.Gc.c++}}else"li"===ca&&(P=P.tagName,v=v.parentNode,b.agc&&(b=v.parentNode)&&b.tagName.toUpperCase()===P&&b.setAttribute("data-pasteFromRc","true"),v.setAttribute(rp.a.ZXc,String.format("{0}",
D.Fmc)),"UL"===P?this.Gc.b++:this.Gc.c++);h.VNa++;return h.VNa<h.dlb.length}Q9h(b,h){let v=null;for(let D=0;!v&&D<b.childNodes.length;D++){const P=b.childNodes[D];v=dn.rYl(P);!v&&1===P.nodeType&&1<h&&(v=this.Q9h(P,h-1))}return v}static Ubl(b,h){b=dn.Sbl(b,h.tagName);return dn.D7k(b,h)}static D7k(b,h){if(h.tagName!==b.tagName){for(h=b.ownerDocument.createElement(h.tagName);b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static Sbl(b,
h){h=b.ownerDocument.createElement(h?h:"UL");var v=b.getAttribute("start");v&&0<v.length&&(h.setAttribute("start",v),b.removeAttribute("start"));(v=b.className)&&0<v.length&&(v="OL"===h.tagName?tm.gTd(v,"NumberListStyle"):tm.gTd(v,"BulletListStyle"),0<v.length&&(Sys.UI.DomElement.addCssClass(h,v),Sys.UI.DomElement.removeCssClass(b,v)));b.parentNode.insertBefore(h,b);return h}static eEh(b,h){for(let v=0;v<b.childNodes.length;v++){const D=b.childNodes[v];1===D.nodeType&&1<h&&dn.eEh(D,h-1);if(dn.FKm(D)||
dn.qyi(D))b.removeChild(D),v--}}static t2l(b){if(1===b.nodeType){var h=dn.Euf(b,"mso-list");if(h&&0<h.length)try{var v=h.split(" ");if(3===v.length){const D=Number.parseInvariant(v[1].substr(5)),P=new HB(D,h,b);P.agc=!0;return P}}catch(D){}else if((v=b.parentNode)&&"li"===v.tagName.toLocaleLowerCase()&&(h=v.getAttribute("data-"+cf.a.mBd),v=v.getAttribute(rp.a.ZXc),h&&v&&0<h.length&&0<v.length))return b=new HB(Number.parseInvariant(h),v+" level"+h,b),b.agc=!1,b}return null}static Blo(b,h,v,D){if("p"===
b.tagName.toLowerCase()&&h&&h.length){if("UL"===dn.e9h(h))return v=dn.vPl(h),Sys.UI.DomElement.addCssClass(b,v),v;var P=h.match(RegExp("^[0-9]+"));return P&&P.length?(v="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,v),b.setAttribute("start",P[0]),v):(P=h.match(RegExp("^[a-zA-Z]+")))&&P.length&&(P=P[0],D=(h=P.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&h.length?dn.nbm(v,D):1,1!==D&&((v=dn.eGd(b,P,RegExp("^[ivxlcdm]+"),G.a.sJh,"NumberListStyle3"))||(v=dn.eGd(b,P,RegExp("^[IVXLCDM]+"),G.a.sJh,"NumberListStyle5")))||
D&&((v=dn.eGd(b,P,RegExp("^[a-z]+"),G.a.qJh,"NumberListStyle2"))||(v=dn.eGd(b,P,RegExp("^[A-Z]+"),G.a.qJh,"NumberListStyle4"))))?v:"NumberListStyle1"}return null}static vPl(b){switch(b){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static nbm(b,h){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=0;break;default:b=-1}if(0>b)switch(h%3){case 0:b=0;break;
case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static eGd(b,h,v,D,P){return(h=h.match(v))&&h.length?(D=D(h[0]),D=1>D?1:D,Sys.UI.DomElement.addCssClass(b,P),b.setAttribute("start",D+""),P):null}static e9h(b){return dn.FHm(b)?"UL":"OL"}static FHm(b){return!b||"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static Juf(b,h){let v=null;var D;let P,ca;for(let ta=-1;!v&&ta<b.childNodes.length;ta++){const Ra=-1===ta?b:b.childNodes[ta];
if(Ra)if((D=Ra.innerHTML)&&0<D.length){if(P=D.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=P&&(ca=D.indexOf("\x3c!--[endif]--\x3e"),0<=ca)){D=D.substring(P,ca+14);Ra.innerHTML=Ra.innerHTML.replace(D,"");if(D.length){b=b.ownerDocument.createElement("span");b.innerHTML=D;v=b.innerText.trim();break}v&&v.length||(v="o")}}else 0<=ta&&1===Ra.nodeType&&1<h&&(v=dn.Juf(Ra,h-1))}return v}static rYl(b){let h=null;1===b.nodeType&&((h=dn.P9h(b,"font-family"))||(h=dn.P9h(b,"mso-ascii-font-family")));return h}static P9h(b,
h){return(b=dn.Euf(b,h))&&0<b.length?b.trim():null}static f9h(b,h){let v=null;for(let D=0;!v&&D<b.childNodes.length;D++){const P=b.childNodes[D];dn.qyi(P)?(v="string"===typeof P.innerText?P.innerText.trim():P.textContent.trim(),v.length||(v="o"),P.parentNode.removeChild(P)):1===P.nodeType&&1<h&&(v=dn.f9h(P,h-1))}return v}static qyi(b){return 1===b.nodeType&&(b=dn.Euf(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static FKm(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static Euf(b,
h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let v=0;v<b.length;v++){const D=b[v].split(":");if(2===D.length&&D[0].trim()===h)return D[1].trim()}}return null}static iam(b){do b=b.previousSibling;while(b&&dn.jxi(b));return b}static jxi(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(dn.Dak,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:dn.jxi(b.firstChild):!0}}dn.Dak=RegExp("[\n|\r]","gi");Object(n.a)(dn,
"WacAndRichClientWordConverter",null,[267]);class Bv{constructor(){}create(b=null){return new dn(b)}}Object(n.a)(Bv,"Box4WordConverterFactory",null,[749]);var Bz=c(1768);class Xx{constructor(b,h,v,D,P){this.kUg=0;this.r4o=ca=>{let ta=!0;const Ra=this.cfa.Pwl;null!=Ra?(ca.ypa=Ra,ta=!1):Date.now()-this.kUg>this.Lve&&(u.ULS.sendTraceTag(18354843,307,50,null),this.ud.Yb(qe.a.kna,{["Reason"]:me.a.KZi}),ta=ca.ypa=!1);return ta};this.ud=b;this.Te=h;this.Lve=P;this.cfa=v;this.pMa=D}AXk(b,h,v){u.ULS.sendTraceTag(9037318,
307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",h,v,this.Te.eG);b.Gh&&this.Te.Aq&&window.chrome&&u.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",h);this.cfa.nLc(!!(h&16));this.pMa.create(b,this.r4o,null).Jl("ClipboardPreProcess");this.kUg=Date.now()}p7n(){this.cfa.reset()}}Object(n.a)(Xx,"ClipboardOperationClipboardAccessHelper",null,[748]);var ir=c(338);class pw{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,
Lc,id,vd){this.yWa=null;this.ga=b;this.ud=h;this.$z=v;this.nh=D;this.hb=P;this.cfa=ca;this.fb=ta;this.Ie=Ra;this.Kn=mb;this.Wc=Jb;this.Kbb=Ub;this.RPe=cc;this.zE=Ac;this.lk=id;this.RVb=Lc?Lc.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.Xmd=Lc?Lc.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.ld=vd;this.pg=Gl.a.getInstance(ir.a.NZa)}get eg(){return this.nh}get Jc(){return this.ud}get aUc(){if(null==this.yWa)if(this.ld)if(this.ld.Pp.isCompleted)this.yWa=this.ld.isFeatureEnabled(3);else return!1;
else this.yWa=!1;return this.yWa}k4o(b){b.nN();return!0}WJh(b,h){b=h.yx;u.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&256){let D=!1,P;aa.a.Pwa&&w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");this.aUc&&h.he&&h.he.rh&&(D=this.lk.Boh(h.he.rh.editingElement));P=this.lk.fxf(h.he.rh.editingElement,!1);var v=h.he.rh.editingElement;this.lk.yBf(v,!1,1);this.RVb&&aa.a.Pwa?(v=h.he.rh.editingElement,this.lk.T6f(v,"data-src","data-srcurl"),b=this.cfa.copy(),
this.lk.T6f(v,"data-srcurl","data-src")):this.Xmd&&h.he&&h.he.rh?(v=this.lk.X6e(h.he.rh.editingElement,h.he.oB,!0),b=this.cfa.copy(),v&&this.lk.X6e(h.he.rh.editingElement,h.he.oB,!1)):(this.lk.lbj(h.he.rh.editingElement),b=this.cfa.copy());this.aUc&&D&&this.lk.p1n(h.he.rh.editingElement);P&&this.lk.fxf(h.he.rh.editingElement,!0);v=h.he.rh.editingElement;this.lk.yBf(v,!1,0);if(!b)return u.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),b=new Map,b.set("ErrorLevel","info"),this.pg.logKpiFailure({kpiName:ir.a.hDd,
errorName:"SystemClipboardCopyFailed",optionalProperties:{additionalValues:{extendedProperties:b}}}),this.Jc.Yb(qe.a.hDb,{["Reason"]:me.a.Phg}),h.yR&&h.yR.fail("SystemClipboard did not copy",!1),h.failed=!0,!1}return!0}W$e(b,h){const v=h.he;u.ULS.shipAssertTag(18130961,307,!!(h.yx&16));h.cAo?this.$z.AEh():this.$z.vGd(v,b);return!0}NQh(b,h){var v=h.context,D=h.xd;const P=h.I9;var ca=!1;b=this.hb.gb.kb.Pc;if(this.fb.lm(b)||this.Ie.Hk(b)){const ta=this.Wc.Vf(b.node),Ra=ta.vd();u.ULS.shipAssertTag(18130962,
307,Ra);this.Kn.Vd(ta);this.Kbb.Wjb(ta)&&(ca=!0)}D=h.yx&64?new Md.DictionaryPropertySet:D||new Md.DictionaryPropertySet;D.setValue(Wc.a.kKc,!1);v=this.ga.Mf(v,Gb.a.AH,2,!0,P,D);8===v&&(u.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Jc.Yb(qe.a.kna,{["Reason"]:me.a.MQh}),h.yR&&h.yR.fail("DeleteKey failed",!1),this.pg.logKpiFailure({kpiName:ir.a.K6e,errorName:"DeleteForCutFailed"}),h.failed=!0);32===v&&this.pg.logKpiSuccess({kpiName:ir.a.K6e});32===v&&ca&&(h=this.hb.gb.kb,this.Ie.Sl(h)&&
h.Oa.node===b.node&&!this.fb.textLength(h.Oa.node)&&(h=this.Wc.Vf(h.Oa.node),b=this.Ie.ru(h),u.ULS.shipAssertTag(18130964,307,b),this.Kn.Vd(h),this.Kbb.VYd(h)||(b=this.RPe.create(),b.Zc(h),this.Kn.t0(b,!1,!1),ca=this.Kn.Ge(b),this.fb.Wb(ca)&&(this.Kn.Vd(b),this.eg.merge(b,h,!1,!1),this.hb.setSelection(this.zE.pe(ca,this.fb.textLength(ca)))))));return!0}}Object(n.a)(pw,"ClipboardOperationCutCopy",null,[774]);class qw{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id,vd){this.ga=b;this.ud=h;this.$z=
v;this.cfa=ca;this.hb=P;this.nh=D;this.fb=ta;this.Ie=Ra;this.Kn=mb;this.Wc=Jb;this.Kbb=Ub;this.RPe=cc;this.zE=Ac;this.Fa=Lc;this.lk=id;this.ld=vd}create(){return new pw(this.ga,this.ud,this.$z,this.nh,this.hb,this.cfa,this.fb,this.Ie,this.Kn,this.Wc,this.Kbb,this.RPe,this.zE,this.Fa,this.lk,this.ld)}}Object(n.a)(qw,"Factory",null,[745]);var Cz=c(1690);class ju{constructor(b,h){this.rgd=null;this.q8k=(v,D)=>{if(!Object(rb.a)(101,D.xd))return!1;const P=Object(Na.a)(101,D.xd);if(!P.hasProperty(Wc.a.gwf))return!1;
const ca=P.getValue(Wc.a.gwf),ta=D.he,Ra=ta.lb;this.$z.eJj();Ra.NNb(()=>{Ra.setSelection(ca,void 0,!0);this.$z.vGd(ta,v)},!0);return!0};this.$z=b;this.c6=h;this.oI=0}process(b,h){this.oI||(this.rgd=[this.q8k,Object(z.a)(this.c6,this.c6.qCn,"pasteGlossaryPlaceholder")]);let v=!0;this.oI<this.rgd.length&&(v=this.rgd[this.oI++](b,h));return v?this.oI<this.rgd.length:!1}}Object(n.a)(ju,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[773]);class My{constructor(b){this.Dsb=null;this.R1=
b;this.oI=-1}process(b,h){-1===this.oI&&(this.Hhl(b,h),this.oI=0);let v=!1;this.oI<this.Dsb.length&&(v=this.Dsb[this.oI++](b,h));return v?this.oI<this.Dsb.length:!1}Hhl(b,h){aa.a.m4||h.yx&512?(this.Dsb=[Object(z.a)(this.R1,this.R1.W$e,"copyInternal")],u.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!b.Gh&&h.yx&256?(this.Dsb=[Object(z.a)(this.R1,this.R1.k4o,"waitBeforeCopy"),Object(z.a)(this.R1,this.R1.WJh,"copyExternal"),Object(z.a)(this.R1,
this.R1.W$e,"copyInternal")],u.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.Dsb=[Object(z.a)(this.R1,this.R1.WJh,"copyExternal"),Object(z.a)(this.R1,this.R1.W$e,"copyInternal")],u.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));h.yx&32&&(b=Object(z.a)(this.R1,this.R1.NQh,"deleteForCut"),this.Dsb.push(b),u.ULS.sendTraceTag(18158337,307,
50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));ir.a.Y2m(h)}}Object(n.a)(My,"ClipboardOperationCutCopyProcessor",null,[772]);class DC{constructor(b,h,v,D){this.upd=null;this.t8k=(P,ca)=>{ca=ca.he;this.$z.Y0o();this.$z.vGd(ca,P);return!0};this.FZc=(P,ca)=>{ca=new rg.Selection([ca.xd],!0);this.hb.setSelection(ca,P);return!0};this.$z=b;this.hb=h;this.R1=v;this.c6=D;this.oI=0}process(b,h){this.oI||(this.upd=[this.t8k,Object(z.a)(this.R1,this.R1.NQh,"deleteForCut"),this.FZc,
Object(z.a)(this.c6,this.c6.Z0i,"pasteInternal"),Object(z.a)(this.c6,this.c6.znj,"setSelectionAfterPaste")]);let v=!0;this.oI<this.upd.length&&(v=this.upd[this.oI++](b,h));return v?this.oI<this.upd.length:!1}}Object(n.a)(DC,"ClipboardOperationMoveProcessor",null,[771]);var Qr=c(1689);class Dz{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id,vd,xe,Ld){this.$z=b;this.ga=h;this.gqc=v;this.ud=D;this.Ie=P;this.Te=ca;this.Ic=ta;this.Lfd=Ra;this.OZj=mb;this.wTb=Jb;this.Zve=Ub;this.Upc=cc;this.pMa=Ac;
this.xD=Lc;this.Sd=id;this.Im=vd;this.DZ=xe;this.efa=Ld}create(b,h,v,D,P,ca,ta,Ra,mb=!0){const Jb=this.Lfd.create(D,Object(Na.a)(101,Ra));var Ub=this.OZj.create();const cc=new ju(this.$z,Jb),Ac=new DC(this.$z,Yh.a.instance,Ub,Jb);Ub=new My(Ub);D=new Qr.a(w.AFrameworkApplication.K,Gv.a.instance,D,bf.a.instance,Jb,this.wTb);return new Cz.a(b,h,v,P,ca,ta,Ra,this.gqc,this.ga,this.ud,this.Ie,this.Te,this.Ic,cc,Ac,Ub,D,this.wTb,this.Zve,this.Upc,this.pMa,this.xD,this.Sd,this.Im,this.DZ,this.efa,w.AFrameworkApplication.eeg(),
mb)}}Object(n.a)(Dz,"Factory",null,[744]);var Zu=c(256);class Yx{constructor(b,h){this.MFb=b.Jqf(h);this.faf=b.sTl(h);this.LAb=b.yof(h);this.geb=b.Xnf(h)}static eF(b){return Yx.Mr(b)}static Mr(b){return new Yx(uq.a.instance,b)}}Object(n.a)(Yx,"CpUsageHelper",null,[]);class Ez{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc){this.N2=!1;this.ud=b;this.$z=h;this.Zyc=v;this.xta=D;this.hb=P;this.ga=ca;this.KDe=ta;this.AWe=mb;this.NNe=Ra;this.nze=Jb;this.Xve=Ub;this.Sd=cc;this.pg=Gl.a.getInstance(ir.a.NZa);
this.N2=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis")}get Pg(){return this.AWe.value}get fra(){return this.xta}get Jc(){return this.ud}get YRa(){return this.NNe.YRa}paste(b,h){const v=this.Sd.wZa();try{const D=h.he,P=h.yx;this.hb&&this.hb.gb&&this.hb.gb.kb&&Zu.TableBorderSelectionCache.lqo(this.hb.gb.kb.uw||this.hb.gb.kb.qIb);yp.a.foo(this.hb);u.ULS.shipAssertTag(18131010,307,!!(P&1));Object(rb.a)(101,h.xd)&&h.xd.setValue(Hh.a.kga,D.rh.editingElement.clientWidth);
this.Xve.UQo(b,h);let ca;if(!({TFd:ca}=this.KDe.value.JCj()).returnValue)return this.vYc(h,"HTML import strategy failed",!1),this.N2?this.pg.logKpiFailure({kpiName:ir.a.lNa,errorName:"HtmlImportStrategyFailed",optionalVeto:{name:ir.a.Zmb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):va.Health.instance.recordQosError("HtmlImportStrategyFailed",[ir.a.Zmb],!1,!0,!0,!1,null),!1;this.Pg.kF();let ta=!0,Ra=null;const mb=this.nze.create(ca),Jb=h.bJj;if(!D||!D.lb)return this.vYc(h,
"Fail to set selection.",!1),this.N2?this.pg.logKpiFailure({kpiName:ir.a.lNa,errorName:"SetSelectionFailed",optionalVeto:{name:ir.a.Zmb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):va.Health.instance.recordQosError("SetSelectionFailed",[ir.a.Zmb],!1,!0,!0,!1,null),!1;D.lb.NNb(()=>{Jb&&2===this.ga.processAction(Gb.a.Oma,2)?ta=!1:(Ra=Jb?this.hb&&this.hb.gb&&this.hb.gb.kb?this.hb.gb.kb.Oa:null:h.xd)?(u.ULS.shipAssertTag(18158338,307,$e.SelectionEditor.gf(Ra)),this.CKi(Ra,
"paste")):u.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Jb)},this.NNe.IAi);if(!ta)return this.vYc(h,"fail to deleteForReplace.",!0),!1;if(!Ra)return this.vYc(h,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Ra.node||!Ra.node.isConnected)return this.vYc(h,"node is null or not connected in ip context.",!0),!1;D.editingView.disable(!0,25);mb.restore();this.Zyc.kCn(ca,Ra,b);return!0}finally{v&&v.dispose()}}vYc(b,h,v){b.failed=!0;b.yR&&b.yR.fail(h,v)}qCn(b,
h){const v=Object(Na.a)(101,h.xd).getValue(Wc.a.Hki);u.ULS.shipAssertTag(20492440,307,$e.SelectionEditor.gf(v));if(!this.EDh(v,h))return!1;this.Pg.kF();h=(new Nh.a).Oc(15);h.Cb(this.$z.sja);this.Zyc.Dti(v,b);this.$z.AEh();h.dispose();return!0}Z0i(b,h){const v=this.hb.gb.kb.Oa;if(!this.EDh(v,h))return!1;this.Pg.kF();this.ga.processAction(Gb.a.Oma,2);this.CKi(v,"intPaste");this.Zyc.Dti(v,b);return!0}EDh(b,h){if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("AbortClipboardOperationForInvalidIpContext")){if(!b||
!b.isValid)return u.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!h&&h.yWc),h.yR&&(h.yR.fail("Invalid ipContext before InternalPasteAtIp",!0),h.failed=!0),h=new Map,h.set("ErrorLevel","warning"),this.pg.logKpiFailure({kpiName:ir.a.lNa,errorName:"InvalidIpContextBeforeInternalPasteAtIp",optionalProperties:{additionalValues:{extendedProperties:h}}}),!1;if(!$e.SelectionEditor.gf(b))return u.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",
!!h&&h.yWc,b.contextId,!!b.node,!!b.node&&!!b.node.anchor),b=new Map,b.set("ErrorLevel","warning"),this.pg.logKpiFailure({kpiName:ir.a.lNa,errorName:"InternalPasteIPContextIsNotInsertionPoint",optionalProperties:{additionalValues:{extendedProperties:b}}}),h.yR&&(h.yR.fail("ipContext is not insertion point in InternalPasteAtIp",!0),h.failed=!0),!1}return!0}CKi(b,h){h=Yx.eF(h);this.fra.YRn(h,b.node,b.cpBegin);this.fra.$2m(h.faf);this.fra.NKf(h.MFb);this.fra.BKf(h.LAb);this.fra.xKf(h.geb)}znj(b,h){if(!h.bJj)return!1;
h.yx&64&&this.$z.dJj();if(!h.v0a)return u.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Jc.Yb(qe.a.s1,{["Reason"]:me.a.ujb}),h.yR&&h.yR.fail("No selection after paste",!1),h.failed=!0,!1;this.NNe.p0o(h);this.Pg.kF();return!1}}Object(n.a)(Ez,"ClipboardOperationPaste",null,[769]);class vA{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub){this.ud=b;this.$z=h;this.Zyc=v;this.xta=D;this.hb=P;this.ga=ca;this.AWe=Ra;this.Bfk=ta;this.nze=mb;this.Xve=Jb;this.Sd=Ub}create(b,h){h=this.Bfk.create(this.hb,
h);return new Ez(this.ud,this.$z,this.Zyc,this.xta,this.hb,this.ga,b,h,this.AWe,this.nze,this.Xve,this.Sd)}}Object(n.a)(vA,"Factory",null,[743]);var fq=c(1620);class $q{constructor(b,h){this.nFo=b;this.lBn=h}}Object(n.a)($q,"ParagraphFormatStore",null,[]);class Mv{constructor(b,h,v){this.hb=b;this.fb=h;this.we=v}UQo(b,h){if(h.vbc){h=b.ypa;var v=this.hb.gb.kb.Oa.node,D=null;this.fb.Wb(v)&&(D=this.we.No(v),v=this.fb.t1a(v),D=new $q(D,v));h=new fq.a(h.context,h.yx,h.yR,h.I9,h.xd,D);b.ypa=h}}}Object(n.a)(Mv,
"ClipboardOperationPasteOvertypeStrategy",null,[742]);class by{constructor(b){this.AJe=null;this.hb=b;b.NNb(h=>{this.AJe=h},!1)}get IAi(){return!1}p0o(b){b=this.D0e(b);this.setSelection(this.hb,b)}D0e(b){let h=b.v0a;(b.tUa||b.Pia)&&b.jke&&(h=Og.SelectionFactory.oz(b.jke,h.Oa));return h}setSelection(b,h){b.setSelection(h)}}Object(n.a)(by,"AClipboardOperationPasteStrategy",null,[786]);class Fr extends by{constructor(b){super(b)}get YRa(){return this.AJe}}Object(n.a)(Fr,"ClipboardOperationPasteToLiveSelectionStrategy",
by,[]);class mk extends by{constructor(b,h){super(b);this.EXe=null;this.Nbk=h;b.NNb(v=>{this.EXe=v},!0)}get IAi(){return!0}get YRa(){return this.EXe}D0e(b){let h=super.D0e(b);b.xd.setValue(Wc.a.d1i,h);return h=this.Nbk.bci(this.AJe.kb,this.EXe.kb,h)}}Object(n.a)(mk,"ClipboardOperationPasteToVirtualSelectionStrategy",by,[]);class mh{constructor(b){this.DXe=b.$("EnableVirtualSelectionInSelectionManager")}create(b,h){return h&&h.ia(Wc.a.tUa,!1)&&this.DXe?new mk(b,this.K3o):new Fr(b)}get K3o(){return null!=
this.HJg?this.HJg:this.HJg=Ea.a.instance.Na("Box4.Actors.IVirtualSelectionMerger")}}Object(n.a)(mh,"ClipboardOperationPasteStrategyFactory",null,[741]);class Np{constructor(b,h,v,D){this.Jc=b;this.lb=h;this.vn=v;this.Wf=D}bHn(b){(b&1||b&32)&&this.vn.Qo&&this.lb.i0b()}bIm(b,h){return b&1&&this.Wf.k_(h,!0)?(this.Jc.Yb(qe.a.kf,{["Reason"]:me.a.WE}),!1):!0}}Object(n.a)(Np,"ClipboardOperationWordStrategy",null,[]);class Ro{constructor(){}O7k(b,h){if(h)if(h=h.sheet)if(h=h.cssRules){var v=Array.clone(h);
v.reverse();var D=h=0,P=0,ca=0;for(const Ra of v){v=Ra.style;var ta=Ra.selectorText;v=v?v.cssText:null;ta=ta?ta.split(","):null;if(v&&ta&&Ra.type===Ra.STYLE_RULE){ca+=ta.length;for(const mb of ta){0<=mb.indexOf("#")&&h++;0<=mb.indexOf(".")&&D++;0>mb.indexOf("#")&&0>mb.indexOf(".")&&P++;ta=null;try{ta=b.querySelectorAll(mb)}catch(Jb){u.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",mb,Jb.message)}if(ta)for(let Jb=0;Jb<ta.length;Jb++)ta[Jb].setAttribute("style",
v+(ta[Jb].getAttribute("style")||""))}}}u.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",ca,h,D,P)}else this.iLi();else this.iLi()}iLi(){u.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",aa.a.eG)}}Object(n.a)(Ro,"ExternalPasteCssConverter",null,[740]);class lp{constructor(b){this.VNa=0;this.YEh=null;this.node=b}}Object(n.a)(lp,
"ChartConverterArguments",null,[]);class ru{constructor(b=null){this._imgNodesConverted=0;this.Y2=b||gq.a.a6h("")}get Gc(){return this.Y2}process(b,h){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&(b=new Eu.a(h,this.aAl.bind(this),new lp(b[0])),b.Jl("Chart Converter Operation"),b.Gh=!h||h.Gh,b.run())))}aAl(b,h){var v=h.node;if(1<h.VNa)return!1;if(1===v.nodeType&&"DIV"===v.tagName){const D=v.getAttribute(Xk.$Hd);if(D){const P=v.getAttribute(Xk.idf),ca=
v.getAttribute(Xk.jdf),ta=v.getAttribute(Xk.gdf),Ra=v.getAttribute(Xk.hdf),mb=v.getAttribute(Xk.jJc);v=v.getAttribute(Xk.kdf);P&&Ra&&ca&&"chart"===ca&&mb&&"XLO"===mb&&(h.YEh=new Ww(D,P,ca,ta,Ra,mb,v))}}b.hi(this.ifn.bind(this));return!0}ifn(b,h){var v=h.node;if(b=h.YEh)1===v.childElementCount&&1===v.firstChild.nodeType&&"IMG"===v.firstChild.tagName?(v=v.firstChild,v.setAttribute(Xk.$Hd,b.ccpId),v.setAttribute(Xk.idf,b.pKey),v.setAttribute(Xk.jdf,b.type),v.setAttribute(Xk.hdf,b.dc),v.setAttribute(Xk.jJc,
b.client),b.version&&v.setAttribute(Xk.kdf,b.version),b.count&&v.setAttribute(Xk.gdf,b.count),this._imgNodesConverted++):u.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.Y2._imgNodesConverted=this._imgNodesConverted;h.VNa++;return!1}}Object(n.a)(ru,"ChartConverter",null,[]);class Hu{constructor(b,h=null,v=null){this.nf=b;this.Y2=h||gq.a.Bgi("");this.qmk=v||gq.a.Cgi("")}get Gc(){return this.Y2}get pig(){return this.qmk}p9(b){this.pig.b++;this.nf.p9(b)}n9(){this.nf.n9()}M4(b){this.pig.c++;
this.nf.M4(b)}o9(){this.nf.o9()}m9(b){this.pig.d++;this.nf.m9(b)}l9(){this.nf.l9()}reset(){this.nf.reset()}get sJc(){return this.nf.sJc}Lca(b,h){this.Gc.b++;this.nf.Lca(b,h)}Kca(b){this.Gc.c++;this.nf.Kca(b)}Amb(b){this.Gc.b++;this.nf.Amb(b)}vxa(b){this.Gc.d++;this.nf.vxa(b)}rGa(b){this.Gc.f++;this.nf.rGa(b)}DRa(b,h){this.Gc.g++;this.nf.DRa(b,h)}CRa(){this.nf.CRa()}aE(b){this.Gc.h++;this.nf.aE(b)}pF(){this.nf.pF()}vmb(){this.nf.vmb()}umb(){this.nf.umb()}HRa(b,h){this.Gc.i++;this.nf.HRa(b,h)}O4a(){this.nf.O4a()}zxa(b){this.Gc.j++;
this.nf.zxa(b)}xxa(){this.nf.xxa()}wGa(b){this.Gc.k++;this.nf.wGa(b)}yxa(){this.nf.yxa()}Q4a(b){this.Gc.l++;this.nf.Q4a(b)}}Object(n.a)(Hu,"SemanticEventUsageCollector",null,[268,269]);class BA{constructor(b,h=null,v=null,D=null){this.t_j="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");this.nf=b;this.Y2=h||gq.a.K$h(aa.a.eAb,"");this.wv=v;this.jkk=D?D.$("ParseStyleForHtmlTagEventIsEnabled"):!1;this.kkk=D?D.$("ParseStyleForUncommonHtmlTagEventIsEnabled"):
!1;this.OPg=new ec.a(Va.a.Fh());for(const P of this.t_j)this.OPg.add(P)}get Gc(){return this.Y2}get Fl(){return this.wv}Ah(b){return b?b+1:1}reset(){this.nf.reset()}B6d(){this.nf.B6d()}Hwf(b){if(b&&this.Fl&&(b.getAttribute&&(b.getAttribute(Xk.Vhl)&&(this.Fl.A2h=!0),b.getAttribute(Xk.$Hd)&&(this.Fl.aJl=!0),b.getAttribute(Xk.jJc)&&(this.Fl.h8e=b.getAttribute(Xk.jJc)),b.getAttribute(Xk.Yhl)&&(this.Fl.B2h=!0)),b.id&&b.id.startsWith&&b.id.startsWith(Xk.wlm)&&(this.Fl.C2h=!0),b.className&&b.className.split))for(const h of b.className.split(" ")){h.startsWith(Xk.ixn)&&
(this.Fl.G2h=!0);h.startsWith(Xk.iGn)&&(this.Fl.H2h=!0);h.startsWith(Xk.$5o)&&(this.Fl.I2h=!0);if(h.startsWith(aa.a.W4e)&&h.length===aa.a.W4e.length+1){const v=parseInt(G.a.substring(h,h.length-1,h.length));isNaN(v)||(this.Fl.eIc=v)}if(h===Xk.ygn||h===Xk.zgn)this.Fl.TMc=!0}return this.nf.Hwf(b)}onClose(){this.nf.onClose()}wPm(b){for(const h of b)if("\n"!==h)return!0;return!1}Lca(b,h){this.Fl&&(this.Fl.cJl=!0);this.Fl&&!this.Fl.vmf&&b&&(this.Fl.vmf=this.wPm(b));this.Gc.d=this.Ah(this.Gc.d);this.nf.Lca(b,
h)}u6d(b){this.Fl&&(this.Fl.E2h=!0);this.Gc.e=this.Ah(this.Gc.e);this.ji(b);return this.nf.u6d(b)}xSf(b){this.Gc.f=this.Ah(this.Gc.f);this.ji(b);return this.nf.xSf(b)}ySf(b){this.Gc.g=this.Ah(this.Gc.g);this.ji(b);return this.nf.ySf(b)}CSf(b){this.Gc.h=this.Ah(this.Gc.h);this.ji(b);return this.nf.CSf(b)}RSf(b){this.Gc.i=this.Ah(this.Gc.i);this.ji(b);return this.nf.RSf(b)}TSf(b){this.Gc.j=this.Ah(this.Gc.j);this.ji(b);this.nf.TSf(b)}A6d(b){this.Gc.k=this.Ah(this.Gc.k);this.ji(b);return this.nf.A6d(b)}USf(b){this.Gc.l=
this.Ah(this.Gc.l);this.ji(b);this.nf.USf(b)}VSf(b){this.Gc.m=this.Ah(this.Gc.m);this.ji(b);this.nf.VSf(b)}WSf(b){this.Gc.n=this.Ah(this.Gc.n);this.ji(b);return this.nf.WSf(b)}D6d(b){this.Gc.o=this.Ah(this.Gc.o);this.ji(b);return this.nf.D6d(b)}E6d(b){this.Gc.p=this.Ah(this.Gc.p);this.ji(b);return this.nf.E6d(b)}jTf(b){this.Gc.q=this.Ah(this.Gc.q);this.ji(b);return this.nf.jTf(b)}F6d(b){this.Gc.r=this.Ah(this.Gc.r);this.ji(b);this.nf.F6d(b)}lTf(b){this.Gc.s=this.Ah(this.Gc.s);this.ji(b);return this.nf.lTf(b)}G6d(b){this.Gc.t=
this.Ah(this.Gc.t);this.ji(b);return this.nf.G6d(b)}H6d(b){this.Gc.u=this.Ah(this.Gc.u);this.ji(b);return this.nf.H6d(b)}K6d(b){this.Gc.v=this.Ah(this.Gc.v);this.ji(b);return this.nf.K6d(b)}L6d(b){this.Gc.w=this.Ah(this.Gc.w);this.ji(b);return this.nf.L6d(b)}xTf(b){this.Gc.x=this.Ah(this.Gc.x);this.ji(b);this.nf.xTf(b)}yTf(b){this.Gc.y=this.Ah(this.Gc.y);this.ji(b);return this.nf.yTf(b)}S6d(b){this.Gc.z=this.Ah(this.Gc.z);this.ji(b);return this.nf.S6d(b)}T6d(b){this.Gc.ba=this.Ah(this.Gc.ba);this.ji(b);
return this.nf.T6d(b)}W6d(b){this.Gc.bb=this.Ah(this.Gc.bb);this.ji(b);return this.nf.W6d(b)}X6d(b){this.Gc.bc=this.Ah(this.Gc.bc);this.ji(b);return this.nf.X6d(b)}Z6d(b){this.Gc.bd=this.Ah(this.Gc.bd);this.ji(b);return this.nf.Z6d(b)}$6d(b){this.Gc.be=this.Ah(this.Gc.be);this.ji(b);return this.nf.$6d(b)}b7d(b){this.Gc.bf=this.Ah(this.Gc.bf);this.ji(b);return this.nf.b7d(b)}d7d(b){this.Gc.bg=this.Ah(this.Gc.bg);this.ji(b);return this.nf.d7d(b)}YTf(b){this.Gc.bh=this.Ah(this.Gc.bh);this.ji(b);return this.nf.YTf(b)}k7d(b){this.Gc.bi=
this.Ah(this.Gc.bi);this.ji(b);return this.nf.k7d(b)}eUf(b){this.Gc.bj=this.Ah(this.Gc.bj);this.ji(b);return this.nf.eUf(b)}gUf(b){this.Gc.bk=this.Ah(this.Gc.bk);this.ji(b);this.nf.gUf(b)}hUf(b){this.Gc.bl=this.Ah(this.Gc.bl);this.ji(b);return this.nf.hUf(b)}n7d(b){this.Gc.bm=this.Ah(this.Gc.bm);this.ji(b);return this.nf.n7d(b)}o7d(b){this.Gc.bm=this.Ah(this.Gc.bm);this.ji(b);return this.nf.o7d(b)}p7d(b){this.Gc.bm=this.Ah(this.Gc.bm);this.ji(b);return this.nf.p7d(b)}q7d(b){this.Gc.bm=this.Ah(this.Gc.bm);
this.ji(b);return this.nf.q7d(b)}r7d(b){this.Gc.bm=this.Ah(this.Gc.bm);this.ji(b);return this.nf.r7d(b)}s7d(b){this.Gc.bm=this.Ah(this.Gc.bm);this.ji(b);return this.nf.s7d(b)}oUf(b){this.Gc.bn=this.Ah(this.Gc.bn);return this.nf.oUf(b)}t7d(b){this.Gc.bo=this.Ah(this.Gc.bo);this.ji(b);this.nf.t7d(b)}vUf(b){this.Gc.bp=this.Ah(this.Gc.bp);return this.nf.vUf(b)}u7d(b){this.Gc.bq=this.Ah(this.Gc.bq);this.ji(b);return this.nf.u7d(b)}xUf(b){this.Gc.br=this.Ah(this.Gc.br);this.ji(b);return this.nf.xUf(b)}x7d(b){this.Fl&&
(this.Fl.D2h=!0);this.ji(b);this.Gc.bs=this.Ah(this.Gc.bs);this.nf.x7d(b)}DUf(b){this.Gc.bt=this.Ah(this.Gc.bt);this.ji(b);this.nf.DUf(b)}y7d(b){this.Gc.bu=this.Ah(this.Gc.bu);this.ji(b);return this.nf.y7d(b)}JUf(b){this.Gc.bv=this.Ah(this.Gc.bv);this.ji(b);return this.nf.JUf(b)}A7d(b){this.Gc.bw=this.Ah(this.Gc.bw);this.ji(b);return this.nf.A7d(b)}C7d(b){this.Gc.bx=this.Ah(this.Gc.bx);this.ji(b);return this.nf.C7d(b)}E7d(b){this.Gc.by=this.Ah(this.Gc.by);this.ji(b);return this.nf.E7d(b)}F7d(b){this.Fl&&
(this.Fl.TMc=!0);this.Gc.bz=this.Ah(this.Gc.bz);this.ji(b);return this.nf.F7d(b)}VUf(b){this.Gc.ca=this.Ah(this.Gc.ca);this.ji(b);this.nf.VUf(b)}ZUf(b){this.Gc.cb=this.Ah(this.Gc.cb);this.ji(b);return this.nf.ZUf(b)}H7d(b){this.Fl&&(this.Fl.bJl=!0);this.Gc.cc=this.Ah(this.Gc.cc);this.ji(b);return this.nf.H7d(b)}onMenuOpen(b){this.Gc.cd=this.Ah(this.Gc.cd);this.ji(b);return this.nf.onMenuOpen(b)}cVf(b){this.Gc.ce=this.Ah(this.Gc.ce);this.nf.cVf(b)}lVf(b){this.Gc.cf=this.Ah(this.Gc.cf);this.ji(b);return this.nf.lVf(b)}mVf(b){this.Gc.cg=
this.Ah(this.Gc.cg);this.ji(b);return this.nf.mVf(b)}oVf(b){this.Gc.ch=this.Ah(this.Gc.ch);this.ji(b);return this.nf.oVf(b)}T7d(b){this.Fl&&(this.Fl.TMc=!0);this.Gc.ci=this.Ah(this.Gc.ci);this.ji(b);return this.nf.T7d(b)}qVf(b){this.Gc.cj=this.Ah(this.Gc.cj);this.ji(b);return this.nf.qVf(b)}U7d(b){this.Gc.ck=this.Ah(this.Gc.ck);this.ji(b);return this.nf.U7d(b)}Y7d(b){this.Gc.cl=this.Ah(this.Gc.cl);this.ji(b);return this.nf.Y7d(b)}xVf(b){this.Gc.cm=this.Ah(this.Gc.cm);this.ji(b);this.nf.xVf(b)}e8d(b){this.Gc.cn=
this.Ah(this.Gc.cn);this.ji(b);return this.nf.e8d(b)}IVf(b){this.Gc.co=this.Ah(this.Gc.co);this.ji(b);return this.nf.IVf(b)}m8d(b){this.Gc.cp=this.Ah(this.Gc.cp);this.ji(b);return this.nf.m8d(b)}n8d(b){this.Gc.cq=this.Ah(this.Gc.cq);this.ji(b);return this.nf.n8d(b)}$Vf(b){this.Gc.cr=this.Ah(this.Gc.cr);return this.nf.$Vf(b)}gWf(b){this.Gc.cs=this.Ah(this.Gc.cs);this.ji(b);return this.nf.gWf(b)}v8d(b){this.Gc.ct=this.Ah(this.Gc.ct);this.ji(b);return this.nf.v8d(b)}w8d(b){this.Gc.cu=this.Ah(this.Gc.cu);
this.ji(b);return this.nf.w8d(b)}y8d(b){this.Gc.cv=this.Ah(this.Gc.cv);this.ji(b);return this.nf.y8d(b)}z8d(b){this.Gc.cw=this.Ah(this.Gc.cw);this.ji(b);return this.nf.z8d(b)}kWf(b){this.Gc.cx=this.Ah(this.Gc.cx);return this.nf.kWf(b)}A8d(b){this.Gc.cy=this.Ah(this.Gc.cy);this.ji(b);return this.nf.A8d(b)}D8d(b){this.Gc.cz=this.Ah(this.Gc.cz);this.ji(b);return this.nf.D8d(b)}F8d(b){this.Fl&&(this.Fl.sna=!0);this.Gc.da=this.Ah(this.Gc.da);this.ji(b);return this.nf.F8d(b)}nWf(b){this.Fl&&(this.Fl.sna=
!0);this.Gc.db=this.Ah(this.Gc.db);this.ji(b);return this.nf.nWf(b)}w0c(b){this.Fl&&(this.Fl.sna=!0);this.Gc.dc=this.Ah(this.Gc.dc);this.ji(b);return this.nf.w0c(b)}qWf(b){this.Gc.dd=this.Ah(this.Gc.dd);this.ji(b);return this.nf.qWf(b)}rWf(b){this.Gc.de=this.Ah(this.Gc.de);this.ji(b);return this.nf.rWf(b)}I8d(b){this.Fl&&(this.Fl.sna=!0);this.Gc.df=this.Ah(this.Gc.df);this.ji(b);return this.nf.I8d(b)}sWf(b){this.Fl&&(this.Fl.sna=!0);this.Gc.dg=this.Ah(this.Gc.dg);this.ji(b);return this.nf.sWf(b)}vWf(b){this.Gc.dh=
this.Ah(this.Gc.dh);this.ji(b);return this.nf.vWf(b)}N8d(b){this.Fl&&(this.Fl.sna=!0);this.Gc.di=this.Ah(this.Gc.di);this.ji(b);return this.nf.N8d(b)}O8d(b){this.Gc.dj=this.Ah(this.Gc.dj);this.ji(b);return this.nf.O8d(b)}P8d(b){this.Gc.dk=this.Ah(this.Gc.dk);this.ji(b);return this.nf.P8d(b)}Q8d(b){this.Fl&&(this.Fl.TMc=!0);this.Gc.dl=this.Ah(this.Gc.dl);this.ji(b);return this.nf.Q8d(b)}U8d(b){this.Gc.dm=this.Ah(this.Gc.dm);this.ji(b);return this.nf.U8d(b)}R8d(b){this.Gc.dn=this.Ah(this.Gc.dn);this.mwi&&
this.ji(b);return this.nf.R8d(b)}get mwi(){if(null!=this.mDg)var b=this.mDg;else{var h;b=this.mDg=null===(h=w.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForUnknownElementsEnabled",!1)}return b}m3m(b){var h,v,D;w.AFrameworkApplication.ue("ec3e8394;h715g427");null!==(h=this.Fl)&&void 0!==h&&h.fxi&&(h=b.cssText)&&(b=h.match(/[0-9]+em;/g),h=h.match(/[0-9]+rem;/g),this.Fl.oRf+=null!==(v=null===b||void 0===b?void 0:b.length)&&void 0!==v?
v:0,this.Fl.pRf+=null!==(D=null===h||void 0===h?void 0:h.length)&&void 0!==D?D:0)}ji(b){const h=b.pf;if(h&&this.Fl){var v=h.tagName.toLowerCase();this.m3m(h.style);if(this.jkk&&this.Ivi(v)||this.kkk&&!this.Ivi(v)||this.Fl.lwi)if("font"===v&&this.ZBn(b),h.style&&(b=h.style))for(const D of b)D&&0<D.length&&this.Fl.BWd(h.tagName,D)}}ZBn(b){if((b=b.pf)&&"font"===b.tagName.toLowerCase()&&this.Fl){var h=b.getAttribute("face");h&&0<h.length&&this.Fl.BWd(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&
0<h.length&&this.Fl.BWd(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.Fl.BWd(b.tagName,"font-attr-size")}}Ivi(b){return this.OPg.contains(b)}}Object(n.a)(BA,"HtmlEventUsageCollector",null,[276]);class Yr{constructor(b,h,v=!1){this.pf=b;this.yB=h;this.JEk=v}}Object(n.a)(Yr,"TagEventParam",null,[]);class KB{constructor(b,h=null){this.Yhd=this._prunedElements=this.oWe=this._voidElements=null;this.qd=b;this.Y2=h||gq.a.L$h("");this.Epo()}get Gc(){return this.Y2}Gjn(b,h,v){this.oWe[h]?
this.kSi():(this.Gc.e++,(h=this.Yhd[h])&&h(new Yr(b,v,!1)),this.Gc.b++)}kSi(){this.Gc.d++}Bjn(){this.Gc.c++}njn(b,h,v){if(this.oWe[h])this.kSi();else{if(h=this.Yhd[h])return this.Gc.b++,h(new Yr(b,v,!1));this.Gc.f++;if(this.qd.mwi)return this.qd.R8d(new Yr(b,null))}return 2}Epo(){this._voidElements=jb.a.D5("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.oWe=jb.a.D5("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,
"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=jb.a.D5("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.qd,h=this.qd,v=this.qd,D=this.qd,P=this.qd,ca=this.qd,ta=this.qd,Ra=this.qd,mb=this.qd,Jb=this.qd,Ub=this.qd,cc=this.qd,Ac=this.qd,Lc=
this.qd,id=this.qd,vd=this.qd,xe=this.qd,Ld=this.qd,Qd=this.qd,Zd=this.qd;this.Yhd=jb.a.D5("A",Object(z.a)(this.qd,this.qd.u6d,"onAOpen"),"ABBR",Object(z.a)(this.qd,this.qd.xSf,"onAbbrOpen"),"ACRONYM",Object(z.a)(this.qd,this.qd.ySf,"onAcronymOpen"),"ADDRESS",Object(z.a)(this.qd,this.qd.CSf,"onAddressOpen"),"APPLET",Object(z.a)(this.qd,this.qd.RSf,"onAppletOpen"),"AREA",Object(z.a)(this.qd,this.qd.TSf,"onAreaTag"),"B",Object(z.a)(this.qd,this.qd.A6d,"onBOpen"),"BASE",Object(z.a)(this.qd,this.qd.USf,
"onBaseTag"),"BASEFONT",Object(z.a)(this.qd,this.qd.VSf,"onBasefontTag"),"BDO",Object(z.a)(this.qd,this.qd.WSf,"onBdoOpen"),"BIG",Object(z.a)(this.qd,this.qd.D6d,"onBigOpen"),"BLOCKQUOTE",Object(z.a)(this.qd,this.qd.E6d,"onBlockquoteOpen"),"BODY",Object(z.a)(this.qd,this.qd.jTf,"onBodyOpen"),"BR",Object(z.a)(this.qd,this.qd.F6d,"onBrTag"),"BUTTON",Object(z.a)(this.qd,this.qd.lTf,"onButtonOpen"),"CAPTION",Object(z.a)(this.qd,this.qd.G6d,"onCaptionOpen"),"CENTER",Object(z.a)(this.qd,this.qd.H6d,"onCenterOpen"),
"CITE",Object(z.a)(this.qd,this.qd.K6d,"onCiteOpen"),"CODE",Object(z.a)(this.qd,this.qd.L6d,"onCodeOpen"),"COL",Object(z.a)(this.qd,this.qd.xTf,"onColTag"),"COLGROUP",Object(z.a)(this.qd,this.qd.yTf,"onColgroupOpen"),"DD",Object(z.a)(this.qd,this.qd.S6d,"onDdOpen"),"DEL",Object(z.a)(this.qd,this.qd.T6d,"onDelOpen"),"DFN",Object(z.a)(this.qd,this.qd.W6d,"onDfnOpen"),"DIR",Object(z.a)(this.qd,this.qd.X6d,"onDirOpen"),"DIV",Object(z.a)(this.qd,this.qd.Z6d,"onDivOpen"),"DL",Object(z.a)(this.qd,this.qd.$6d,
"onDlOpen"),"DT",Object(z.a)(this.qd,this.qd.b7d,"onDtOpen"),"EM",Object(z.a)(this.qd,this.qd.d7d,"onEmOpen"),"FIELDSET",Object(z.a)(this.qd,this.qd.YTf,"onFieldsetOpen"),"FONT",Object(z.a)(this.qd,this.qd.k7d,"onFontOpen"),"FORM",Object(z.a)(this.qd,this.qd.eUf,"onFormOpen"),"FRAME",Object(z.a)(this.qd,this.qd.gUf,"onFrameTag"),"FRAMESET",Object(z.a)(this.qd,this.qd.hUf,"onFramesetOpen"),"H1",Object(z.a)(this.qd,this.qd.n7d,"onH1Open"),"H2",Object(z.a)(this.qd,this.qd.o7d,"onH2Open"),"H3",Object(z.a)(this.qd,
this.qd.p7d,"onH3Open"),"H4",Object(z.a)(this.qd,this.qd.q7d,"onH4Open"),"H5",Object(z.a)(this.qd,this.qd.r7d,"onH5Open"),"H6",Object(z.a)(this.qd,this.qd.s7d,"onH6Open"),"HEAD",Object(z.a)(this.qd,this.qd.oUf,"onHeadOpen"),"HR",Object(z.a)(this.qd,this.qd.t7d,"onHrTag"),"HTML",Object(z.a)(this.qd,this.qd.vUf,"onHtmlOpen"),"I",Object(z.a)(this.qd,this.qd.u7d,"onIOpen"),"IFRAME",Object(z.a)(this.qd,this.qd.xUf,"onIframeOpen"),"IMG",Object(z.a)(this.qd,this.qd.x7d,"onImgTag"),"INPUT",Object(z.a)(this.qd,
this.qd.DUf,"onInputTag"),"INS",Object(z.a)(this.qd,this.qd.y7d,"onInsOpen"),"ISINDEX",Object(z.a)(this.qd,this.qd.JUf,"onIsindexOpen"),"KBD",Object(z.a)(this.qd,this.qd.A7d,"onKbdOpen"),"LABEL",Object(z.a)(this.qd,this.qd.C7d,"onLabelOpen"),"LEGEND",Object(z.a)(this.qd,this.qd.E7d,"onLegendOpen"),"LI",Object(z.a)(this.qd,this.qd.F7d,"onLiOpen"),"LINK",Object(z.a)(this.qd,this.qd.VUf,"onLinkTag"),"MAP",Object(z.a)(this.qd,this.qd.ZUf,"onMapOpen"),"MATH",Object(z.a)(this.qd,this.qd.H7d,"onMathOpen"),
"MENU",Object(z.a)(this.qd,this.qd.onMenuOpen,"onMenuOpen"),"META",Object(z.a)(this.qd,this.qd.cVf,"onMetaTag"),"NOFRAMES",Object(z.a)(this.qd,this.qd.lVf,"onNoframesOpen"),"NOSCRIPT",Object(z.a)(this.qd,this.qd.mVf,"onNoscriptOpen"),"OBJECT",Object(z.a)(this.qd,this.qd.oVf,"onObjectOpen"),"OL",Object(z.a)(this.qd,this.qd.T7d,"onOlOpen"),"OPTGROUP",Object(z.a)(this.qd,this.qd.qVf,"onOptgroupOpen"),"OPTION",Object(z.a)(this.qd,this.qd.U7d,"onOptionOpen"),"P",Object(z.a)(this.qd,this.qd.Y7d,"onPOpen"),
"PARAM",Object(z.a)(this.qd,this.qd.xVf,"onParamTag"),"PRE",Object(z.a)(this.qd,this.qd.e8d,"onPreOpen"),"Q",Object(z.a)(this.qd,this.qd.IVf,"onQOpen"),"S",Object(z.a)(this.qd,this.qd.m8d,"onSOpen"),"SAMP",Object(z.a)(this.qd,this.qd.n8d,"onSampOpen"),"SCRIPT",Object(z.a)(this.qd,this.qd.$Vf,"onScriptOpen"),"SELECT",Object(z.a)(this.qd,this.qd.gWf,"onSelectOpen"),"SMALL",Object(z.a)(b,b.v8d,"onSmallOpen"),"SPAN",Object(z.a)(h,h.w8d,"onSpanOpen"),"STRIKE",Object(z.a)(v,v.y8d,"onStrikeOpen"),"STRONG",
Object(z.a)(D,D.z8d,"onStrongOpen"),"STYLE",Object(z.a)(P,P.kWf,"onStyleOpen"),"SUB",Object(z.a)(ca,ca.A8d,"onSubOpen"),"SUP",Object(z.a)(ta,ta.D8d,"onSupOpen"),"TABLE",Object(z.a)(Ra,Ra.F8d,"onTableOpen"),"TBODY",Object(z.a)(mb,mb.nWf,"onTbodyOpen"),"TD",Object(z.a)(Jb,Jb.w0c,"onTdOpen"),"TEXTAREA",Object(z.a)(Ub,Ub.qWf,"onTextareaOpen"),"TFOOT",Object(z.a)(cc,cc.rWf,"onTfootOpen"),"TH",Object(z.a)(Ac,Ac.I8d,"onThOpen"),"THEAD",Object(z.a)(Lc,Lc.sWf,"onTheadOpen"),"TITLE",Object(z.a)(id,id.vWf,"onTitleOpen"),
"TR",Object(z.a)(vd,vd.N8d,"onTrOpen"),"TT",Object(z.a)(xe,xe.O8d,"onTtOpen"),"U",Object(z.a)(Ld,Ld.P8d,"onUOpen"),"UL",Object(z.a)(Qd,Qd.Q8d,"onUlOpen"),"VAR",Object(z.a)(Zd,Zd.U8d,"onVarOpen"))}}Object(n.a)(KB,"AHtmlProcessor",null,[]);class Kq{constructor(b,h){this.childNodes=b.childNodes;this.yB=h;this.ucf=0;this.GYd=!1}}Object(n.a)(Kq,"HtmlProcessorArguments",null,[]);class su extends KB{constructor(b,h=null){super(b,h);this.BGe=null}get zQm(){null==this.BGe&&(this.BGe=w.AFrameworkApplication.K?
w.AFrameworkApplication.K.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.BGe}process(b,h=null){b&&(this.qd.reset(),this.n4i(new Kq(b,new nk.a),h))}n4i(b,h){b.childNodes.length&&(b=new Eu.a(h,Object(z.a)(this,this.eJn,"processChild"),b),b.Jl("HTML Processing Operation"),h||(b.Gh=!0),b.run())}eJn(b,h){const v=h.childNodes[h.ucf];if(3===v.nodeType)return this.qd.B6d(),this.qd.Lca(v.nodeValue,new Yr(v,h.yB.x7h())),su.Amc(h);if(1!==v.nodeType)return su.Amc(h);if(!h.GYd){const P=G.a.XA(v.tagName);
if(!su.Hqm(v))if(this._prunedElements[P])this.Bjn();else{su.wan(v);this.qd.B6d();var D=v.id;const ca=v.tagName,ta=h.yB.x7h(),Ra=v.getAttribute?v.getAttribute("class"):null;D=new Ki(D,ca,Ra?Ra:"",v.attributes?v.attributes.length:0);D.isValid&&ta.add(D);if(this._voidElements[P])return this.Gjn(v,P,ta),su.Amc(h);D=!1;switch(this.njn(v,P,ta)){case 1:D=!0;break;case 3:return su.Amc(h)}switch(this.qd.Hwf(v)){case 1:D=!0}h.GYd=D;this.n4i(new Kq(v,ta),b);if(!b.Gh)return!0}}if(h.GYd){if(this.zQm&&!this.Yhd[G.a.XA(v.tagName)])return su.Amc(h);
this.qd.onClose()}return su.Amc(h)}static wan(b){3!==b.nodeType&&fd.a.Kl(b,"alreadyPasted",!0)}static Hqm(b){return 3!==b.nodeType&&fd.a.Db(b,"alreadyPasted")}static Amc(b){b.ucf++;b.GYd=!1;return b.ucf<b.childNodes.length}}Object(n.a)(su,"HtmlProcessor",KB,[]);var ex=c(2035),CA=c(630);const Qy={["font-size"]:0,["box-sizing"]:1,["font-family"]:2,["color"]:3,["padding"]:4,["margin"]:5,["border-bottom-width"]:6,["border-left-width"]:7,["border-top-width"]:8,["border-right-width"]:9,["border-bottom-style"]:10,
["border-left-style"]:11,["border-top-style"]:12,["border-right-style"]:13,["line-height"]:14,["border-bottom-color"]:15,["border-left-color"]:16,["border-top-color"]:17,["border-right-color"]:18,["border-image-repeat"]:19,["border-image-source"]:20,["border-image-width"]:21,["border-image-outset"]:22,["border-image-slice"]:23,["margin-bottom"]:24,["font-weight"]:25,["background-color"]:26,["font-style"]:27,["margin-top"]:28,["padding-top"]:29,["padding-right"]:30,["padding-left"]:31,["padding-bottom"]:32,
["vertical-align"]:33,["margin-left"]:34,["margin-right"]:35,["white-space"]:36,["width"]:37,["position"]:38,["text-align"]:39,["display"]:40,["font-variant-ligatures"]:41,["font-variant-caps"]:42,["outline-style"]:43,["outline-width"]:44,["outline-color"]:45,["font-variant-numeric"]:46,["font-stretch"]:47,["font-variant-east-asian"]:48,["height"]:49,["background-clip"]:50,["background-repeat-x"]:51,["background-repeat-y"]:52,["background-position-y"]:53,["background-position-x"]:54,["background-image"]:55,
["background-size"]:56,["background-origin"]:57,["background-attachment"]:58,["text-indent"]:59,["overflow-x"]:60,["overflow-y"]:61,["text-decoration-color"]:62,["text-decoration-style"]:63,["letter-spacing"]:64,["text-transform"]:65,["overflow-wrap"]:66,["float"]:67,["-webkit-text-stroke-width"]:68,["word-spacing"]:69,["orphans"]:70,["widows"]:71,["top"]:72,["border-top-right-radius"]:73,["border-top-left-radius"]:74,["border-bottom-right-radius"]:75,["border-bottom-left-radius"]:76,["text-decoration-line"]:77,
["left"]:78,["unicode-bidi"]:79,["clear"]:80,["max-width"]:81,["list-style-type"]:82,["min-height"]:83,["text-shadow"]:84,["bottom"]:85,["list-style-position"]:86,["list-style-image"]:87,["right"]:88,["-webkit-font-smoothing"]:89,["visibility"]:90,["cursor"]:91,["resize"]:92,["max-height"]:93,["word-break"]:94,["font-attr-size"]:95,["font-attr-face"]:96,["user-select"]:97,["min-width"]:98,["transition-duration"]:99,["transition-property"]:100,["transition-timing-function"]:101,["transition-delay"]:102,
["clip"]:103,["transform"]:104,["opacity"]:105,["-webkit-tap-highlight-color"]:106,["align-items"]:107,["flex-direction"]:108,["font-attr-color"]:109,["direction"]:110,["flex-shrink"]:111,["box-shadow"]:112,["text-rendering"]:113,["z-index"]:114,["flex-grow"]:115,["text-size-adjust"]:116,["flex-basis"]:117,["transform-origin"]:118,["quotes"]:119,["caption-side"]:120,["border-collapse"]:121,["counter-reset"]:122,["font-kerning"]:123,["text-overflow"]:124,["-webkit-text-stroke-color"]:125,["-webkit-user-drag"]:126,
["-webkit-box-flex"]:127,["font-variant"]:128,["font-feature-settings"]:129,["-webkit-border-horizontal-spacing"]:130,["-webkit-border-vertical-spacing"]:131,["justify-content"]:132,["margin-inline-start"]:133,["speak"]:134,["caret-color"]:135,["flex-wrap"]:136,["animation-duration"]:137,["animation-name"]:138,["animation-timing-function"]:139,["animation-fill-mode"]:140,["animation-delay"]:141,["animation-iteration-count"]:142,["animation-direction"]:143,["animation-play-state"]:144,["pointer-events"]:145,
["grid-column-end"]:146,["grid-column-start"]:147,["break-inside"]:148,["counter-increment"]:149,["touch-action"]:150,["word-wrap"]:151,["hyphens"]:152,["zoom"]:153,["break-after"]:154,["content"]:155,["break-before"]:156,["margin-block-start"]:157,["margin-block-end"]:158,["padding-inline-start"]:159,["-webkit-box-align"]:160,["tab-size"]:161,["-webkit-appearance"]:162,["table-layout"]:163,["transform-style"]:164,["-webkit-box-orient"]:165,["writing-mode"]:166,["-webkit-box-pack"]:167,["-webkit-box-direction"]:168,
["order"]:169,["text-decoration"]:170,["--darkreader-inline-color"]:171,["empty-cells"]:172,["backface-visibility"]:173,["object-fit"]:174,["--transition-duration"]:175,["clip-path"]:176,["margin-inline-end"]:177,["grid-template-columns"]:178,["--darkreader-inline-bgcolor"]:179,["-webkit-print-color-adjust"]:180,["-webkit-box-decoration-break"]:181,["filter"]:182,["perspective-origin"]:183,["fill"]:184,["align-content"]:185,["align-self"]:186,["column-count"]:187,["outline-offset"]:188,["--czi-counter-name"]:189,
["--czi-counter-reset"]:190,["--czi-list-style-type"]:191,["-webkit-line-clamp"]:192,["--darkreader-inline-border-bottom"]:193,["--darkreader-inline-border-left"]:194,["--darkreader-inline-border-right"]:195,["--darkreader-inline-border-top"]:196,["--saf-0"]:197,["will-change"]:198,["grid-row-start"]:199,["padding-inline-end"]:200,["padding-block-end"]:201,["padding-block-start"]:202,["grid-row-end"]:203,["-webkit-box-ordinal-group"]:204,["column-gap"]:205,["object-position"]:206,["image-rendering"]:207,
["-webkit-user-modify"]:208,["column-width"]:209,["text-decoration-skip-ink"]:210,["line-break"]:211,["grid-template-rows"]:212,["perspective"]:213,["justify-self"]:214,["page"]:215,["--language-font-face"]:216,["mix-blend-mode"]:217,["-webkit-text-fill-color"]:218,["grid-template-areas"]:219,["--darkreader-inline-bgimage"]:220,["--darkreader-inline-outline"]:221,["-webkit-hyphenate-character"]:222,["row-gap"]:223,["scroll-behavior"]:224,["text-align-last"]:225,["stroke"]:226,["column-fill"]:227,
["--chat-message-background-color"]:228,["--message-border-radius-bottom-left"]:229,["--message-border-radius-bottom-right"]:230,["--message-border-radius-top-left"]:231,["--message-border-radius-top-right"]:232,["-webkit-mask-image"]:233,["--ehixd-mediumheight"]:234,["--ehixd-mediumpadding"]:235,["--czi-content-line-height"]:236,["--chat-default-message-background-color"]:237,["overscroll-behavior-x"]:238,["overscroll-behavior-y"]:239,["contain"]:240,["-webkit-user-select"]:241,["border"]:242,["justify-items"]:243,
["-webkit-border-image"]:244,["column-rule-color"]:245,["column-rule-style"]:246,["column-rule-width"]:247,["--avatar-size"]:248,["--chat-message-align"]:249,["--chat-message-link-color"]:250,["--chat-message-max-width"]:251,["--black"]:252,["--blacktranslucent40"]:253,["--flaggedmessage"]:254,["--headerbackground"]:255,["--headerbackgroundsearch"]:256,["--headerbadgebackground"]:257,["--headerbadgetext"]:258,["--headerbrandtext"]:259,["--headerbuttonsbackground"]:260,["--headerbuttonsbackgroundhover"]:261,
["--headerbuttonsbackgroundsearch"]:262,["--headerbuttonsbackgroundsearchhover"]:263,["--headersearchboxbackground"]:264,["--headersearchboxicon"]:265,["--headersearchbuttonbackground"]:266,["--headersearchbuttonbackgroundhover"]:267,["--headersearchbuttonicon"]:268,["--headersearchfilters"]:269,["--headersearchfiltershover"]:270,["--headersearchicon"]:271,["--headersearchplaceholdertext"]:272,["--headertexticons"]:273,["--neutraldark"]:274,["--neutrallight"]:275,["--neutrallighter"]:276,["--neutrallighteralt"]:277,
["--neutralprimary"]:278,["--neutralprimaryalt"]:279,["--neutralquaternary"]:280,["--neutralquaternaryalt"]:281,["--neutralsecondary"]:282,["--neutraltertiary"]:283,["--neutraltertiaryalt"]:284,["--reddark"]:285,["--richusercontentbackground"]:286,["--searchboxbackground"]:287,["--themedark"]:288,["--themedarkalt"]:289,["--themedarker"]:290,["--themelight"]:291,["--themelighter"]:292,["--themelighteralt"]:293,["--themeprimary"]:294,["--themesecondary"]:295,["--themetertiary"]:296,["--white"]:297,
["--whitetranslucent40"]:298,["--whitetranslucent90"]:299,["--button-width"]:300,["fill-opacity"]:301,["--mousedown-x"]:302,["--mousedown-y"]:303,["--height"]:304,["--purple"]:305,["-webkit-line-break"]:306,["grid-auto-flow"]:307,["overflow-anchor"]:308,["backdrop-filter"]:309,["--spritesheet-position"]:310,["-webkit-mask-position-x"]:311,["-webkit-mask-position-y"]:312,["No Style Present"]:313,["OTHERS"]:314},Nv={["a"]:1,["b"]:2,["big"]:3,["blockquote"]:4,["br"]:5,["caption"]:6,["center"]:7,["cite"]:8,
["code"]:9,["col"]:10,["colgroup"]:11,["dd"]:12,["del"]:13,["dfn"]:14,["area"]:15,["base"]:16,["basefont"]:17,["frame"]:18,["hr"]:19,["img"]:20,["input"]:21,["link"]:22,["meta"]:23,["param"]:24,["abbr"]:25,["acronym"]:26,["address"]:27,["bdo"]:28,["body"]:29,["button"]:30,["fieldset"]:31,["form"]:32,["frameset"]:33,["html"]:34,["noframes"]:35,["noscript"]:36,["optgroup"]:37,["q"]:38,["select"]:39,["textarea"]:40,["applet"]:41,["head"]:42,["iframe"]:43,["isindex"]:44,["map"]:45,["object"]:46,["script"]:47,
["style"]:48,["title"]:49,["dir"]:50,["div"]:51,["dl"]:52,["dt"]:53,["em"]:54,["font"]:55,["h"]:56,["i"]:57,["ins"]:58,["kbd"]:59,["label"]:60,["legend"]:61,["li"]:62,["math"]:63,["menu"]:64,["ol"]:65,["option"]:66,["p"]:67,["pre"]:68,["s"]:69,["samp"]:70,["small"]:71,["span"]:72,["strike"]:73,["strong"]:74,["sub"]:75,["sup"]:76,["tables"]:77,["tbody"]:78,["td"]:79,["text"]:80,["tfoot"]:81,["th"]:82,["thead"]:83,["tr"]:84,["tt"]:85,["u"]:86,["ul"]:87,["var"]:88,["OTHERS"]:89};class EC{constructor(){this.yx=
0;this.eIc=6;this.aJl=this.A2h=!1;this.h8e=null;this.I2h=this.H2h=this.G2h=this.C2h=this.B2h=!1;this.progId=null;this.vmf=this.E2h=this.D2h=this.sna=this.TMc=this.bJl=this.cJl=!1;this.h1i=this.wLb=0;this.gXf=this.platform=null;this.evi=this.nHf=!1;this.pRf=this.oRf=0;this.jlk={["Excel Online"]:1,["Word Online"]:2,["PowerPoint Online"]:3,["OneNote Online"]:4,["Google Docs"]:5,["Excel"]:6,["Word"]:7,["PowerPoint"]:8,["OneNote"]:9,["Other"]:10};this.Vff=[1,3,4,2,5];this.iub={}}get uJm(){if(null!=this.lDg)var b=
this.lDg;else{var h;b=this.lDg=null===(h=w.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent2Enabled",!1)}return b}get lwi(){if(null!=this.kDg)var b=this.kDg;else{var h;b=this.kDg=null===(h=w.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent1Enabled",!1)}return b}get fxi(){if(null!=this.pDg)var b=this.pDg;else{var h;b=this.pDg=null===(h=w.AFrameworkApplication.K)||
void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isEmRemLoggingInPasteEnabled",!1)}return b}get Pje(){if(null!==this.h8e)switch(this.h8e){case "XLO":return"Excel Online"}if(this.I2h)return"Word Online";if(this.H2h||this.B2h)return"PowerPoint Online";if(this.A2h)return"Excel Online";if(this.C2h)return"Google Docs";if(this.G2h)return"OneNote Online";switch(this.progId){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}tT(b,
h){const v=new na.a;v.name=b;"number"===typeof h?v.int64=h:v.bool=h;return v}bge(b,h,v){const D=new CA.a;D.name=b;D.dataFields=h;D.dnmInterval=v;D.dnmAllowedPartA=this.Vff;fa.a.sendDirectNumericEvent(D)}y4m(){const b=this.xOk();if(this.uJm){var h=[];const v=[this.tT("isUserConsumer",this.nHf),this.tT("isDocumentBlank",this.evi),this.tT("FoundText",this.vmf),this.tT("FoundTable",this.sna),this.tT("FoundImage",this.D2h),this.tT("FoundList",this.TMc),this.tT("FoundLink",this.E2h),this.tT("Browser",this.wLb),
this.tT("SourceApp",this.jlk[this.Pje])];for(const D of v)h.push(D);this.bge("Office.DNM.Word.Online.ExternalPasteEvent2",h,2)}this.fxi&&(h=[this.tT("NumberOfEm",this.oRf),this.tT("NumberOfRem",this.pRf)],Object(Xe.a)("NoOfTimesEmRemAppeared_PerPaste",!0,void 0,h));u.ULS.sendTraceTag(51406241,307,50,JSON.stringify(b))}kLh(b,h){var v,D;const P=[];b=this.tT("tag",null!==(v=Nv[b])&&void 0!==v?v:Nv.OTHERS);h=this.tT("style",null!==(D=Qy[h])&&void 0!==D?D:Qy.OTHERS);D=this.tT("IsUserConsumer",this.nHf);
P.push(b);P.push(h);P.push(D);this.bge("Office.DNM.Word.Online.ExternalPasteEvent1",P,2)}z4m(){const b=this.iub;for(const v in b){var h=v;const D=b[v];if(this.lwi){0===Object.keys(D).length&&this.kLh(h,"No Style Present");for(const P of Object.keys(D))this.kLh(h,P)}D&&(D.SourceApp=this.Pje,D.Browser=ex.a[this.wLb],D.TagName=h,D.OperationId=this.gXf,u.ULS.sendTraceTag(51406242,307,50,JSON.stringify(D)))}}BWd(b,h){b&&b.length&&h&&h.length&&(b=b.toLowerCase(),h=h.toLowerCase(),b in this.iub||(this.iub[b]=
{}),this.iub[b][h]=this.yem(b,h)+1)}yem(b,h){if(!(b&&b.length&&h&&h.length&&this.iub&&b in this.iub))return 0;b=b.toLowerCase();h=h.toLowerCase();return(b=this.iub[b])&&h in b?b[h]:0}xOk(){const b={};b.ActionIdFlags=this.yx;b.SourceApp=this.Pje;b.CopySourceBrowser=this.eIc;b.PasteBrowser=this.wLb;b.IsSameBrowserPaste=this.rSm(this.eIc,this.wLb);b.IsCrossBrowserPaste=this.iJm(this.eIc,this.wLb);b.IsUncategorizedBrowserPaste=this.eVm(this.eIc,this.wLb);b.Platform=this.platform;b.OperationId=this.gXf;
return b}rSm(b,h){return 5===b||6===b?!1:b===h}iJm(b,h){return 6===b?!1:b!==h}eVm(b,h){return 5===b&&5===h}}Object(n.a)(EC,"HtmlContentMetadata",null,[]);var Ov=c(241),Aj=c(1446),cy=c(1055),Iu=c(374),qn=c(141),so=c(1691),ui=c(48),Ry=c(215);class co{get Fn(){return null!=this.pHg?this.pHg:this.pHg=Ea.a.instance.Na("Box4.Styles.StyleSettings")}constructor(b,h,v,D,P,ca,ta){this.y6b=ta;this.C2g=!1;this.AAj=this.KFe=null;this.oCn=Ra=>{hj.a.mark(5568);this.rYh(Ra);let mb=this.Tcn;if(this.Ezi){const Jb=
this.rrj();Jb&&(mb=this.$mb);u.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",Jb)}Ra.hi(mb);return!0};this.Tcn=Ra=>{hj.a.mark(5569);var mb=new he.GraphIterator;this.k5a.restore(mb);var Jb=new he.GraphIterator;this.Jlf.restore(Jb);this.Jlf=null;u.ULS.shipAssertTag(6305489,307,ig.OutlineElementReader.Nh(mb));u.ULS.shipAssertTag(6305490,307,ig.OutlineElementReader.Nh(Jb));hf.OutlineElementNavigator.Ge(mb);var Ub=fe.ParagraphReader.sh(mb)?fe.ParagraphReader.textLength(mb.currentNode):
0;hf.OutlineElementNavigator.Vd(mb);hf.OutlineElementNavigator.Ge(Jb);u.ULS.shipAssertTag(6305491,307,fe.ParagraphReader.sh(Jb));var cc=fe.ParagraphReader.textLength(Jb.currentNode);hf.OutlineElementNavigator.Vd(Jb);let Ac=this.p8c;var Lc=new Rl.a;Lc.Zc(mb);hf.OutlineElementNavigator.Xr(Lc,!1,!1);var id=Lc.currentNode===Jb.currentNode,vd=!!this.Bi&&!!(this.Bi.yx&8192);let xe=!1;if(!vd&&this.Bi.xd&&Object(rb.a)(Md.DictionaryPropertySet,this.Bi.xd)){var Ld=this.Bi.xd.Gf(Wc.a.xLb);vd=Ld&&""!==Ld?!0:
!1}Ld=!1;this.Bi.xd instanceof Ov.APropertySet&&(Ld=this.Bi.xd.ia(Wc.a.g4,!1));if(id){Ub=he.GraphIterator.$a(mb.currentNode);fe.ParagraphReader.wt(hf.OutlineElementNavigator.Ge(Ub))||(mb=Jb);mb.currentNode.id!==Jb.currentNode.id&&(u.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",Vg.ListItemReader.yg(mb),Vg.ListItemReader.yg(Jb)),vd=co.eg.merge(mb,Jb,!0,vd),u.ULS.shipAssertTag(6305492,307,vd));Jb=mb;var Qd=!0}else{id=!!(this.Bi.yx&
4);Qd=this.Ld.rg&&id&&this.Bi.P2a;var Zd=!!(this.Bi.yx&262144);this.LYf&&this.Bi&&!id&&!Zd&&(this.LYf.omi(mb,!1),this.LYf.omi(Jb,!0));hf.OutlineElementNavigator.Ge(Lc);id=fe.ParagraphReader.sh(Lc)?fe.ParagraphReader.textLength(Lc.currentNode):0;hf.OutlineElementNavigator.Vd(Lc);ui.a.rr&&this.Bi.yx&65536||this.ZGk(Lc,mb,Jb);Zd=new Rl.a;Zd.Zc(Lc);hf.OutlineElementNavigator.Xr(Zd,!1,!1);Zd.currentNode.id===Jb.currentNode.id&&(this.C2g=!0);if(this.ZW.kNa||this.dto)if(Zd.wn.id!==Jb.wn.id){for(;Lc.currentNode.id!==
Jb.currentNode.id;)hf.OutlineElementNavigator.Ge(Lc,!1),this.ZW.AHa(we.a.create(Lc.currentNode)),Lc.wc(),hf.OutlineElementNavigator.Xr(Lc,!1,!1);Lc.Zc(mb);hf.OutlineElementNavigator.Xr(Lc,!1,!1)}else xe=!0;this.hZ&&({p8c:Ac,uva:Lc}=this.hZ.G0f(mb,Jb,Ac,Lc));Ry.a.j8&&this.y6b&&(Lc=this.y6b.G0f(mb,Jb,Lc));if(this.Bi.iee&&(u.ULS.shipAssertTag(6305493,307,this.Bi.vbc),Zd=new he.GraphIterator,Zd.Zc(Lc),Zd=hf.OutlineElementNavigator.Ge(Zd))){var te=this.Bi.iee.Df(Zd.pa.J(0));Zd.pa.J(0).formatting=te}Zd=
0;vd&&this.ONe&&(Zd=1);te=this.Eto(mb,Lc,Zd);this.Bi.jke=null;if(this.Bi.Pia||this.Bi.tUa)this.Bi.jke=this.eem(te?mb.currentNode:Lc.currentNode,te);var Qf=!1;te&&(Qf=Vg.ListItemReader.yg(mb),u.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Qf,Vg.ListItemReader.yg(Jb)),this.KFe=Qf=co.eg.merge(mb,Lc,!0,vd,Jb,void 0,xe,Qd,this.ONe),this.Fto(mb,Zd)&&this.qdn(mb,Jb,Zd,vd));Zd=co.CCn.CAm(mb,Lc,Jb,Ub,Qf,this.mUc);var Jg=!1;if(Ac){const Ml=
new Rl.a;Ml.Zc(Jb);hf.OutlineElementNavigator.t0(Ml,!1,!1);Jg=Vg.ListItemReader.yg(Ml);const Fm=Vg.ListItemReader.yg(Jb),qp=Ld;u.ULS.sendTraceTag(509661707,307,50,"preserve EOP formatting : {0}",qp);Qd=co.eg.merge(Ml,Jb,!0,vd,void 0,!0,void 0,Qd,this.ONe,qp);u.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",Jg,Fm,Qd?"True":"False, will cause IP to reset to zero.");Jb=(Jg=Qd)?Ml:Jb}else Qd=!1,u.ULS.sendTraceTag(51463189,
307,50,"No merge, will cause IP to reset to zero.");this.ZW.kNa&&xe&&(te&&!this.xLm(Zd,Qf)?(Lc=new he.GraphIterator,Lc.Zc(mb),mb=hf.OutlineElementNavigator.Ge(Lc),this.ZW.pqa(mb,Ub,Ub+id)):Ac&&!this.bOm(Zd,Jg)?(mb=new he.GraphIterator,mb.Zc(Lc),mb=hf.OutlineElementNavigator.Ge(mb),this.ZW.pqa(mb,0,id)):(mb=new he.GraphIterator,mb.Zc(Lc),mb=hf.OutlineElementNavigator.Ge(mb),this.ZW.AHa(we.a.create(mb))));this.ZFn(Zd);this.isProgressiveStyleEnabled&&!vd&&this.FH.ZJn(Zd)}u.ULS.shipAssertTag(6305494,
307,Jb.isValid);vd=hf.OutlineElementNavigator.Ge(Jb);cc=Qd?fe.ParagraphReader.textLength(vd)-cc:0;this.Bi.v0a=Ld?Og.SelectionFactory.ZI(vd,cc-1,cc):Og.SelectionFactory.pe(vd,cc);this.Bi&&this.Bi.vbc&&fe.ParagraphReader.Wb(vd)&&this.Bi.o9d&&((cc=this.Bi.o9d.nFo)&&this.lE.RJ(cc,vd,!0),(cc=this.Bi.o9d.lBn)&&this.paragraphEditor.ruh(vd,cc));Ra.hi(this.$mb);return!0};this.doo=Ra=>{const mb=he.GraphIterator.$a(this.AAj);mb.oJ(1);this.Bi.v0a=Og.SelectionFactory.ho(mb.currentNode,!1);Ra.hi(this.$mb);return!0};
this.$mb=()=>{var Ra=void 0===this.Bi.yx||null===this.Bi.yx?"not available":Object(Aj.a)(so.a,this.Bi.yx);u.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.Bi.yx,Ra);u.ULS.shipAssertTag(6305497,307,!!this.Bi.v0a);this.mUc?Object(Xe.a)("ExternalPasteAction",!0):Object(Xe.a)("InternalPasteAction",!0);this.k5a&&(Ra=new he.GraphIterator,this.k5a.restore(Ra),this.k5a=null,this.Upm(Ra));this.transaction.dispose();Xr.a.wQa&&Xr.a.I6m();Ra=this.Yt.yu;if(!Ra.te||!Ra.editingView.Oj)return!1;
Ra.editingView.cJo();return!1};this.qFa=b;this.Jlf=this.k5a=null;this.Bi=h;this.transaction=v;this.hZ=D;this.Yt=P;this.x6=ca}get K(){return w.AFrameworkApplication.K}get ONe(){return!!this.K&&this.K.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get FH(){return null!=this.dAg?this.dAg:this.dAg=Ea.a.instance.resolve("Box4.IFontStylesGalleryCache")}get isProgressiveStyleEnabled(){return this.Fn&&this.Fn.isProgressiveStyleEnabled}get lE(){return null!=this.MJg?this.MJg:this.MJg=Ea.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get uc(){return null!=
this.oKg?this.oKg:this.oKg=Ea.a.instance.resolve("Box4.Styles.IWACStyleReader")}get paragraphEditor(){return null!=this.JFg?this.JFg:this.JFg=Ea.a.instance.resolve("Box4.IParagraphEditor")}get Gd(){return null!=this.pEg?this.pEg:this.pEg=Ea.a.instance.resolve("Box4.List.IListReader")}get Un(){return null!=this.bEg?this.bEg:this.bEg=Ea.a.instance.resolve("Box4.List.IListEditor")}get XQ(){return null!=this.OAg?this.OAg:this.OAg=Ea.a.instance.resolve("Box4.IBox4GraphWriter")}get b9c(){return null!=this.UGg?
this.UGg:this.UGg=Ea.a.instance.Na("Box4.List.ISingleLevelListEditor")}get nj(){return null!=this.CIg?this.CIg:this.CIg=Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Ch(){return null!=this.cJg?this.cJg:this.cJg=Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}get Ld(){return null!=this.LIg?this.LIg:this.LIg=Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get ZW(){return null!=this.Mwg?this.Mwg:this.Mwg=Ea.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get LYf(){return null!=
this.VFg?this.VFg:this.VFg=Ea.a.instance.Na("Box4.IPastedParagraphSpaceHandler")}get p1i(){return!1}sYh(){}get mUc(){return!1}b1i(b){var h=void 0===this.Bi.yx||null===this.Bi.yx?"not available":Object(Aj.a)(so.a,this.Bi.yx);u.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.Bi.yx,h);u.ULS.shipAssertTag(6305487,307,$e.SelectionEditor.gf(this.qFa));if(this.W5d)return u.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.Bi.v0a=Og.SelectionFactory.Nn(this.qFa),b.hi(this.$mb),!0;if(!this.qFa.node)return u.ULS.sendTraceTag(572330334,
307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;h=new he.GraphIterator;h.set(this.qFa.node);$e.SelectionEditor.ru(h);hf.OutlineElementNavigator.Vd(h);this.AAj=h.origin;if(this.p1i)return h.mt(10),this.sYh(h,b),b.hi(this.doo),!0;this.hZ&&this.hZ.nmn(this.qFa);if(!this.pCo(this.qFa))return this.Bi.yR&&(this.Bi.yR.fail("SplitLine Failed",!0),this.Bi.failed=!0),this.Bi.v0a=Og.SelectionFactory.Nn(this.qFa),b.hi(this.$mb),!0;const v=new Rl.a;v.Zc(h);hf.OutlineElementNavigator.Xr(v,
!1,!1);this.k5a=new cy.a(h);this.Jlf=new cy.a(v);b.hi(this.oCn);return!0}rrj(){return!1}get Ezi(){return this.K.$("PptCcpFix2IsEnabled")}get dto(){return this.K.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}xLm(b,h){return!h&&!!b&&ig.OutlineElementReader.Nh(b.uva)&&ig.OutlineElementReader.dfb(b.uva)}bOm(b,h){return!h&&!!b&&ig.OutlineElementReader.Nh(b.Mkb)&&ig.OutlineElementReader.dfb(b.Mkb)}ZFn(b){co.X2i&&b&&co.X2i.VJn(b)}Eto(b,h,v){var D;Vg.ListItemReader.yg(b)?(null===(D=this.b9c)||void 0===
D?void 0:D.Jzf(b),h=Vg.ListItemReader.yg(h)?this.Kqj:!0):ig.OutlineElementReader.isEmpty(b,!0)&&!v?(co.eg.U_a(b),h=!1):h=!0;this.hZ&&(h=this.hZ.rXk(b,h));return h}Fto(b,h){return Vg.ListItemReader.yg(b)||1===h?!0:!1}qdn(b,h,v,D){const P=Vg.ListItemReader.yg(b);if(P){if(D=new Rl.a,D.Zc(b),hf.OutlineElementNavigator.Xr(D,!1,!1),D.wn.id!==h.wn.id){v=this.Gd.qw(b);this.Gd.eP(b);var ca=b.currentNode.ia(Bc.a.listID,0);b.wc();var ta=this.Gd.$tj,Ra=!0;for(v.VB=Ph.a.rl;D.currentNode.id!==h.currentNode.id;){if(!ta||
!ig.OutlineElementReader.kvo(D))if(!Vg.ListItemReader.yg(D))qn.a.getInstance().Lv?(ig.OutlineElementReader.iRc(D)||({qwa:v}=this.Un.Vla(v.propertySet,D,v)),this.Un.k$()):{qwa:v}=this.Un.Vla(v.propertySet,D,v),Ra=!1;else if(P){Ra=this.Gd.Jrf(D);var mb=this.Gd.Hx(b.currentNode,ca,Ra);mb=mb?Iu.a.Q7(mb,null):v;Ra=Iu.a.n_(mb.listType,v.listStyle,null,0,Ra,"","");Ra.Ylb=b.currentNode;this.Un.Lmo(Ra);this.Un.phe(D,!0);Ra=!1}hf.OutlineElementNavigator.Xr(D,!1,!1)}ta&&Ra&&this.Un.jJk()}}else if(1===v)for(v=
new Rl.a,v.Zc(b),hf.OutlineElementNavigator.Ge(v),b=fe.ParagraphReader.sh(v)?v.currentNode:null,ca=this.uc.zuf(v),hf.OutlineElementNavigator.Vd(v),hf.OutlineElementNavigator.Xr(v,!1,!1);v.currentNode.id!==h.currentNode.id;)hf.OutlineElementNavigator.Ge(v),ta=fe.ParagraphReader.sh(v)?v.currentNode:null,hf.OutlineElementNavigator.Vd(v),ta&&b&&D&&(ca&&this.lE.RJ(ca,ta,!0),this.x6.JOi(b,ta,P),this.x6.bGa(b,ta,1,!0)),hf.OutlineElementNavigator.Xr(v,!1,!1)}ZGk(b,h,v){var D=!1;if(this.Ld.rg)if(ui.a.rr)D=
!0;else{var P=!1;this.hZ&&(P=h.currentNode,P=this.hZ.CQm(P)||this.hZ.tFf(P));P?this.Ld.f5a=4:D=!0}if(D){for(;b.currentNode!==v.currentNode;){hf.OutlineElementNavigator.Ge(b,!1);D=this.Ch.o9c(we.a.create(b.currentNode));let ca;({type:ca}=D.hTd()).returnValue&&this.Ld.Ns(ca);for(P=0;P<D.length;P++){let ta;const Ra=({m0d:ta}=D.getContext(P)).returnValue;ta&&(co.hyperlinkEditor.Rlb(Ra,1),this.nj.Lob(Ra,1,null,!0))}b.wc();hf.OutlineElementNavigator.Xr(b,!1,!1)}b.Zc(h);hf.OutlineElementNavigator.Xr(b,!1,
!1)}}eem(b,h){b=he.GraphIterator.$a(b);hf.OutlineElementNavigator.Ge(b);return fe.ParagraphReader.Wb(b.currentNode)?(h=h?fe.ParagraphReader.textLength(b.currentNode):0,Og.SelectionFactory.pe(b.currentNode,h)):cj.TableReader.xU(b.currentNode)?Og.SelectionFactory.wq(b.currentNode):null}Upm(b){if(b){if(this.mUc&&cj.TableReader.ex(b)&&this.C2g){if(null!=this.KFe&&0==this.KFe){var h=new Rl.a;h.Zc(b);hf.OutlineElementNavigator.Xr(h,!1,!1);b.Zc(h)}h=yp.a.Q4n(b);const v=fe.ParagraphReader.Vk(h);h&&v&&(this.Bi.v0a=
Og.SelectionFactory.pe(v,0),b=he.GraphIterator.$a(h))}else co.yQm&&yp.a.wCn(b);b&&cj.TableReader.ex(b)&&ch.returnToContainingCell(b)&&yp.a.RAk(b.currentNode)}else u.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}dso(b,h){const v=new he.GraphIterator;v.Zc(b);b=hf.OutlineElementNavigator.Ge(v);h=fe.ParagraphReader.Wb(b)&&h===fe.ParagraphReader.textLength(b);u.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",h);return h}pCo(b){var h;u.ULS.shipAssertTag(6305498,
307,$e.SelectionEditor.gf(b));if(null===(h=this.XQ)||void 0===h?0:h.splitParagraph)return!!this.XQ.splitParagraph(b.node,b.cpBegin,{EJl:!0,Eb:b.Eb,Rb:b.Rb});h=he.GraphIterator.$a(b.node);var v=h.vd();hf.OutlineElementNavigator.Vd(h);v&&b.isValid||u.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:v,["ipContextNodeType"]:b.node.type,["isValidIpContext"]:b.isValid});if(!ig.OutlineElementReader.Nh(h)&&(u.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),
this.K.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;v=co.eg.noa(h,!0);const D=this.dso(h,b.cpBegin);co.eg.Z9(h,v,b,!1,!1,!0,D);return!0}static get hyperlinkEditor(){return null!=co.WAg?co.WAg:co.WAg=Ea.a.instance.resolve("Box4.IHyperlinkEditor")}static get oi(){return Ih.PageReader.instance}static get eg(){return null!=co.VEg?co.VEg:co.VEg=Ea.a.instance.resolve("Box4.IOutlineElementEditor")}static get Vn(){return qn.a.getInstance()}static get Xb(){return null!=co.lzg?co.lzg:co.lzg=
Ea.a.instance.Na("Box4.IFeatureHelper")}static get X2i(){return null!=co.aGg?co.aGg:co.aGg=Ea.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste")}static get CCn(){return null!=co.UFg?co.UFg:co.UFg=Ea.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper")}static get yQm(){null==this.AGe&&(w.AFrameworkApplication.ue("PasteTableBelowTableNewExperience;PasteTableBelowTableNewExperienceCf"),this.AGe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBelowTableNewExperienceIsEnabled",
!1):!1);return this.AGe}}co.AGe=null;Object(n.a)(co,"APasteExecutionManager",null,[]);class Lz{constructor(b){this.Rj=b}reset(){this.Rj.reset()}get sJc(){return this.Rj.sJc}Lca(b,h){this.Rj.Lca(b,h)}Kca(b){this.Rj.Kca(b)}Amb(b){this.Rj.Amb(b)}vxa(b){this.Rj.vxa(b)}rGa(b){this.Rj.rGa(b)}DRa(b,h){this.Rj.DRa(b,h)}CRa(){this.Rj.CRa()}aE(b){this.Rj.aE(b)}pF(){this.Rj.pF()}vmb(){this.Rj.vmb()}umb(){this.Rj.umb()}zxa(b){this.Rj.zxa(b)}xxa(){this.Rj.xxa()}wGa(b){this.Rj.wGa(b)}yxa(){this.Rj.yxa()}Q4a(b){this.Rj.Q4a(b)}p9(b){this.Rj.p9(b)}n9(){this.Rj.n9()}M4(b){this.Rj.M4(b)}o9(){this.Rj.o9()}m9(b){this.Rj.m9(b)}l9(){this.Rj.l9()}HRa(b,
h){this.Rj.HRa(b,h)}O4a(){this.Rj.O4a()}}Object(n.a)(Lz,"AHtmlNormalizer",null,[268,269]);class cv extends Lz{constructor(b){super(b);this.MJ=!1}Lca(b,h){this.MJ?this.XM.qM(()=>{this.T0f(b,h)}):this.T0f(b,h)}T0f(b,h){this.Rj.Lca(b,h)}Kca(b){this.MJ?this.XM.qM(()=>{this.w0f(b)}):this.w0f(b)}w0f(b){this.Rj.Kca(b)}vxa(b){this.MJ?this.XM.qM(()=>{this.s2c(b)}):this.s2c(b)}s2c(b){this.Rj.vxa(b)}rGa(b){this.MJ?this.XM.qM(()=>{this.u0f(b)}):this.u0f(b)}u0f(b){this.Rj.rGa(b)}DRa(b,h){this.MJ?this.XM.qM(()=>
{this.p0f(b,h)}):this.p0f(b,h)}p0f(b,h){this.Rj.DRa(b,h)}CRa(){this.MJ?this.XM.qM(Object(z.a)(this,this.o0f,"processAnchorEnd")):this.o0f()}o0f(){this.Rj.CRa()}aE(b){this.MJ?this.XM.qM(()=>{this.F0f(b)}):this.F0f(b)}F0f(b){this.Rj.aE(b)}pF(){this.MJ?this.XM.qM(Object(z.a)(this,this.E0f,"processParagraphEnd")):this.E0f()}E0f(){this.Rj.pF()}vmb(){this.MJ?this.XM.qM(Object(z.a)(this,this.I0f,"processPreFormattedTextStart")):this.I0f()}I0f(){this.Rj.vmb()}umb(){this.MJ?this.XM.qM(Object(z.a)(this,this.H0f,
"processPreFormattedTextEnd")):this.H0f()}H0f(){this.Rj.umb()}zxa(b){this.MJ?this.XM.qM(()=>{this.A0f(b)}):this.A0f(b)}A0f(b){this.Rj.zxa(b)}xxa(){this.MJ?this.XM.qM(Object(z.a)(this,this.x0f,"processListEnd")):this.x0f()}x0f(){this.Rj.xxa()}wGa(b){this.MJ?this.XM.qM(()=>{this.z0f(b)}):this.z0f(b)}z0f(b){this.Rj.wGa(b)}yxa(){this.MJ?this.XM.qM(Object(z.a)(this,this.y0f,"processListItemEnd")):this.y0f()}y0f(){this.Rj.yxa()}p9(b){this.MJ?this.XM.qM(()=>{this.S0f(b)}):this.S0f(b)}S0f(b){this.Rj.p9(b)}n9(){this.MJ?
this.XM.qM(Object(z.a)(this,this.P0f,"processTableEnd")):this.P0f()}P0f(){this.Rj.n9()}M4(b){this.MJ?this.XM.qM(()=>{this.R0f(b)}):this.R0f(b)}R0f(b){this.Rj.M4(b)}o9(){this.MJ?this.XM.qM(Object(z.a)(this,this.Q0f,"processTableRowEnd")):this.Q0f()}Q0f(){this.Rj.o9()}m9(b){this.MJ?this.XM.qM(()=>{this.O0f(b)}):this.O0f(b)}O0f(b){this.Rj.m9(b)}l9(){this.MJ?this.XM.qM(Object(z.a)(this,this.N0f,"processTableCellEnd")):this.N0f()}N0f(){this.Rj.l9()}HRa(b,h){this.MJ?this.XM.qM(()=>{this.C0f(b,h)}):this.C0f(b,
h)}C0f(b,h){this.Rj.HRa(b,h)}O4a(){this.MJ?this.XM.qM(Object(z.a)(this,this.G4i,"processMathEnd")):this.G4i()}G4i(){this.Rj.O4a()}}Object(n.a)(cv,"AQueuingHtmlNormalizer",Lz,[]);var DA=c(1975);class dy{constructor(){this.lPe=new DA.a}qM(b){this.lPe.enqueue(b)}flush(b=!1){for(b&&this.Fge();!this.lPe.isEmpty;)this.lPe.dequeue()();b&&this.yee()}Fge(){}yee(){}}Object(n.a)(dy,"QueuedEventManager",null,[]);class ey extends dy{constructor(b){super();this.id=void 0;this.Icf=null;this.zZd=!1;this.Epa="";this.yZd=
this.r_d=!1;this.ycf=this.x4b=null;this.WZc=0;this.WUc=this.CWc=this.iHf=!1;this.table=null;this.KQf=0;this.BZ=b}get tEc(){return!!this.table}Fge(){this.BZ.Gfc.push(this.BZ.currentState);this.BZ.currentState=this}yee(){this.BZ.currentState=this.BZ.Gfc.pop()}}ey.nextId=void 0;Object(n.a)(ey,"ContentState",dy,[]);class Sy{constructor(b,h,v){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.o3a=b.o3a;this.shadingColor=b.shadingColor;this.verticalAlignment=b.verticalAlignment;
this.oja=b.oja;this.lle=b.lle;this.Wbc=b.Wbc;this.C7=b.C7;this.contents=v;this.llm=h}}Object(n.a)(Sy,"TableCell",null,[]);var Ty=c(1692),EA=c(1693);class Gt extends dy{constructor(b,h){super();this.BZ=b;this.qih=new nk.a;this.dka=new nk.a;this.zKe=[];this.Itd=[];this.RJa=-1;this.sVa=0;this.F8j=h.aCf;this.E8j=h.xHm;this.gmk=h.Thg;this.Kp=h.width;this.r2g=h.o3a;this.K5j=new cp.a(new Ki(h.t9.$oi,h.t9.SVd),h.yB,h.Ixa,h.cultureName,h.YBa);this.y7j=h.EWd;this.jwd=h.styleId;this.lmk=h.tableLook}get Rj(){return this.BZ.Rj}sHn(b){this.RJa++;
this.qih.add(b);this.Itd[this.RJa]=b.height;this.sVa=0}get Vgl(){for(;this.sVa>=this.dka.count;)this.dka.add(Array(this.RJa+1));return this.dka.J(this.sVa)}Prk(b,h,v,D,P,ca,ta){if(0>this.RJa)return!1;for(;this.zKe[this.sVa]>=this.RJa;)this.sVa++;b=new Sy(b,new cp.a(h,v,D,P,ca),ta);this.Vgl[this.RJa]=b;if(1<b.rowSpan)for(h=this.RJa+b.rowSpan-1,D=this.sVa,v=this.sVa+b.colSpan-1;D<=v;D++)this.zKe[D]>=h||(this.zKe[D]=h);this.sVa+=b.colSpan;this.Itd[this.RJa]<b.height&&(this.Itd[this.RJa]=b.height);return!0}Fge(){this.BZ.currentState.table=
this}yee(){this.BZ.currentState.table=null}d1h(){w.AFrameworkApplication.ue("fd8b6402;j6e17681");this.flush(!0);const b=this.RJa+1;var h=Array(b);for(var v=0;v<b;v++)h[v]=Array(this.dka.count);v=!0;var D=0;for(var P=0;P<this.dka.count;P++){var ca=this.dka.J(P),ta=!0;for(var Ra=0;Ra<b;Ra++){var mb=ca[Ra];mb&&(ta=!1,h[Ra][P+D]=new yt(mb.colSpan,mb.rowSpan,mb.width,mb.height,void 0,void 0,void 0,void 0,mb.o3a,mb.Wbc))}ta?(this.dka.removeAt(P),P--,++D):v=!1}if(!v){(h=this.r2g?this.BZ.HAh(h,this.Kp/100):
this.BZ.HAh(h,1,this.Kp))&&h.length!==this.dka.count&&(h=null);this.BZ.vgb(!0);this.BZ.rEd();this.Rj.p9(new Us(b,this.dka.count,this.Kp,this.r2g,h,this.F8j,this.E8j,this.gmk,this.y7j,this.jwd,this.lmk,this.K5j));for(h=0;h<b;h++){v=this.qih.J(h);this.Rj.M4(new Wx(this.Itd[h],new cp.a(v.t9,v.yB,v.Ixa,v.cultureName,v.YBa)));for(v=0;v<this.dka.count;v++){D=this.dka.J(v)[h];var Jb=!!this.jwd&&""!==this.jwd&&"Custom"!==this.jwd;P=D?D.colSpan:0;ca=D?D.rowSpan:0;D&&(P=Math.min(D.colSpan,this.dka.count-v),
ca=Math.min(D.rowSpan,b-h));ta=D?D.width:0;Ra=D?D.height:0;mb=D?D.C7:0;const Ub=D?D.o3a:!1,cc=D&&(65536&mb||!Jb)?D.shadingColor:"",Ac=D?D.verticalAlignment:0,Lc=D?D.Wbc:!1;Jb=D?this.BZ.Z5l(D.oja,v,h,this.dka,Jb,D.C7):new Ty.a;const id=D?D.lle:new EA.a,vd=D?D.llm:null;this.Rj.m9(new yt(P,ca,ta,Ra,cc,Ac,Jb,id,Ub,Lc,mb,new cp.a(vd?vd.t9:null,vd?vd.yB:null,vd?vd.Ixa:null,vd?vd.cultureName:null,vd?vd.YBa:null)));D&&!D.Wbc&&(D.contents.Fge(),D.contents.flush(),this.BZ.vgb(!1),this.BZ.rEd(),D.contents.yee());
this.Rj.l9()}this.Rj.o9()}this.Rj.n9();this.BZ.currentState.WUc=!1;this.BZ.jXh(!1)}}}Object(n.a)(Gt,"NormalizedTable",dy,[]);class dv{constructor(b=!1,h=!1){this.o9j=b;this.sla=h}get qNm(){return this.o9j}get d7a(){return this.sla}}Object(n.a)(dv,"HtmlNormalizerSettings",null,[274]);class ev extends cv{constructor(b,h=null){super(b);this.tHe=null;this.Gfc=new Yu;this.PVb=h||new dv}reset(){super.reset();this.currentState=new ey(this);this.Gfc.clear();this.MJ=!1}get XM(){return this.currentState&&this.currentState.tEc?
this.currentState.table:this.currentState}MKd(b=!1){this.currentState.zZd||(this.rEd(),this.Rj.aE(this.currentState.Icf),this.currentState.zZd=!0,this.currentState.WUc=!1);b||!this.currentState.x4b||this.currentState.yZd||(this.Rj.DRa(this.currentState.x4b,this.currentState.ycf),this.currentState.yZd=!0)}mLc(){this.currentState.yZd&&(this.Rj.CRa(),this.currentState.yZd=!1)}Qwl(){this.currentState.zZd&&(this.Rj.pF(),this.currentState.zZd=!1,this.currentState.Epa="")}jXh(b){this.currentState.CWc&&(this.currentState.WUc?
b||(this.Rj.aE(null),this.Rj.pF(),this.Rj.yxa(),this.currentState.CWc=!1):(this.Rj.yxa(),this.currentState.CWc=!1,this.currentState.WUc=!0))}vgb(b){this.mLc();this.Qwl();this.jXh(b)}Zxn(b){this.Rj.zxa(new rp.a(2,1,b));this.currentState.WZc++;this.currentState.iHf=!0}rEd(){!this.currentState.CWc&&this.currentState.iHf&&(this.Rj.xxa(),this.currentState.WZc--,this.currentState.iHf=!1)}T0f(b,h){b=this.Hin(b);if(""!==b)if(this.MKd(),this.currentState.r_d)this.U0f(b,h);else{b=b.split(ev.KQk);for(let v=
0;v<b.length-1;v++)this.U0f(b[v],h),this.Rj.Amb(h);this.U0f(b[b.length-1],h)}}C0f(b,h){""!==b&&(this.MKd(),this.Rj.HRa(b,h))}w0f(b){this.PVb.d7a||this.mLc();this.MKd(!0);this.Rj.Kca(b)}u0f(b){this.currentState.tEc||this.Rj.rGa(b)}s2c(b){this.currentState.x4b&&(b.href=this.currentState.x4b);super.s2c(b)}p0f(b,h){this.mLc();this.currentState.x4b=b;this.currentState.ycf=h}o0f(){this.mLc();this.currentState.x4b=null;this.currentState.ycf=null}F0f(b){this.currentState.Icf=b;this.vgb(!0)}E0f(){this.currentState.Icf=
null;this.vgb(!0)}I0f(){this.currentState.r_d=!0}H0f(){this.currentState.r_d=!1}A0f(b){this.vgb(!1);this.rEd();this.Rj.zxa(b);this.currentState.WZc++}x0f(){this.vgb(!1);this.Rj.xxa();this.currentState.WZc--}z0f(b){this.vgb(!1);this.currentState.WZc||this.Zxn(b);this.Rj.wGa(b);this.currentState.CWc=!0;this.currentState.WUc=!0}y0f(){this.vgb(!1)}p9(b){this.currentState.tEc||(this.MJ=!0,this.currentState.table=new Gt(this,b))}S0f(){}n9(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=
null;this.Gfc.isEmpty?(this.MJ=!1,b.d1h()):this.XM.qM(Object(z.a)(b,b.d1h,"flushTable"))}}P0f(){}M4(b){this.currentState.tEc&&this.currentState.table.sHn(b)}R0f(){}o9(){}Q0f(){}m9(b){let h=!1;if(this.currentState.tEc){const v=new ey(this);this.currentState.table.Prk(b,new Ki(b.t9.$oi,b.t9.SVd),b.yB,b.Ixa,b.cultureName,b.YBa,v)?(this.Gfc.push(this.currentState),this.currentState=v):h=!0}else h=!0;h&&this.currentState.KQf++}O0f(){}l9(){0<this.currentState.KQf?this.currentState.KQf--:this.currentState=
this.Gfc.pop()}N0f(){}HAh(b,h=1,v=0){if(!b)return null;const D=b.length;if(!D)return null;const P=b[0].length;for(var ca=1;ca<D;ca++)if(b[ca].length!==P)return null;ca=Array(P+1);ca[0]=0;const ta=Array(P+1);for(var Ra=0;Ra<ta.length;Ra++)ta[Ra]=!1;const mb=new Fb.a;Ra=0;for(let Ub=0;Ub<P;Ub++){for(var Jb=0;Jb<D;Jb++){const cc=b[Jb][Ub];if(cc&&0<cc.width){const Ac=Math.min(Ub+cc.colSpan,P);ca[Ac]=ca[Ub]+cc.width*(cc.o3a?h:1);ta[Ac]=!0}}if(ta[Ub+1]){Jb=ca[Ub+1]-ca[Ub];if(0>=Jb)return null;mb.add(Jb)}else ca[Ub+
1]=ca[Ub],0<v&&this.PCi&&(mb.add(-1),Ra++)}b=mb.toArray();if(0<Ra&&0<v&&this.PCi)for(u.ULS.sendTraceTag(509125462,3022,50,"CalculateTableWidths: All Table Column width not set"),v=(v-ca[ca.length-1])/Ra,h=0;h<b.length;h++)-1===b[h]&&(b[h]=v);return b}get PCi(){null==this.tHe&&(w.AFrameworkApplication.ue("2i46g603;2fc7g589"),this.tHe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1):!1);return this.tHe}fbn(b,
h){1&h||(b.borderTopStyle=12);16&h||(b.borderRightStyle=12);256&h||(b.borderBottomStyle=12);4096&h||(b.borderLeftStyle=12);return b}Z5l(b,h,v,D,P,ca){if(!b)return null;P&&(b=this.fbn(b,ca));if(0>v||0>h||h>D.count-1)return b;0<=h-1&&v<=D.J(h-1).length-1&&1===b.borderLeftStyle&&(P=D.J(h-1)[v])&&1!==P.oja.borderRightStyle&&(b.borderLeftStyle=P.oja.borderRightStyle,b.borderLeftColor=P.oja.borderRightColor,b.borderLeftWidth=P.oja.borderRightWidth);0<=v-1&&v<=D.J(h).length-1&&1===b.borderTopStyle&&(h=D.J(h)[v-
1])&&1!==h.oja.borderBottomStyle&&(b.borderTopStyle=h.oja.borderBottomStyle,b.borderTopColor=h.oja.borderBottomColor,b.borderTopWidth=h.oja.borderBottomWidth);return b}Hin(b){this.currentState.r_d||(b=this.PVb.qNm?b.replace(ev.cvm," "):b.replace(ev.bvm," "));b.startsWith(" ")&&(this.currentState.Epa.endsWith(" ")||""===this.currentState.Epa)&&(b=G.a.substring(b,1,b.length));return b}U0f(b,h){""!==b&&(this.Rj.Lca(b,h),this.currentState.Epa+=b)}}ev.bvm=RegExp("[ \t\f\u200b\r\n]+","g");ev.cvm=RegExp("[ \f\u200b\r\n]+",
"g");ev.KQk="\t";Object(n.a)(ev,"DefaultHtmlNormalizer",cv,[]);class ar extends ev{constructor(b,h,v){super(b,v);this.sYg=!1;this.nub=h}static MJm(b){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&b?(b=ar.dml.exec(b))&&0<b.length:!1}s2c(b){this.nub.hgc&&(w.AFrameworkApplication.bpa?this.sYg||(b=new ug.StandardDialog,b.Ad=0,b.Ee(1,CommonUIStrings.l_DialogClose),b.Ou(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,
1,null),this.sYg=!0):this.nub.RNi?this.nub.r4d=!0:b.src&&""!==b.src?ia.a.getOrigin(b.src)!==ia.a.getOrigin(window.location.href)||ar.MJm(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?w.AFrameworkApplication.va.processAction(Gb.a.k1i,2):b.src.startsWith("webkit-fake-url")?w.AFrameworkApplication.va.processAction(Gb.a.j1i,2):(this.mLc(),this.MKd(!0),this.Rj.vxa(b)):w.AFrameworkApplication.va.processAction(Gb.a.m1i,2):w.AFrameworkApplication.va.processAction(Gb.a.l1i,2))}}ar.dml=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");
Object(n.a)(ar,"Box4HtmlNormalizer",ev,[]);class FC{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub){this.htmlProcessor=b;this.lzf=h;this.JVk=v;this.zLj=D;this.YIl=P;this.beo=ca;this.ceo=ta;this.RVd=Ra;this.Vum=mb;this.Yum=Jb;this.fYc=Ub}}Object(n.a)(FC,"ExecutePasteArguments",null,[]);class mt extends co{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id,vd,xe){super(h,v,D,Jb,cc,id,xe);this.Hka=null;this.Ain=Ld=>{this.Rkd.$Ei(this.iaa)&&w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordRemoveSpacesAfterEndFragmentSettings");
this.rkk&&this.Rkd.SOo(this.iaa);Ld.hi(this.xHn);return!0};this.xHn=Ld=>{if(this.Fjk){const Qd=this.iaa.getElementsByTagName("style");if(Qd&&0<Qd.length){u.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let Zd=0;Zd<Qd.length;Zd++)this.JAe.O7k(this.iaa,Qd[Zd]),Qd[Zd]&&(Qd[Zd].parentNode.removeChild(Qd[Zd]),Zd--)}}Ld.hi(this.d8k);return!0};this.d8k=(Ld,Qd)=>{this.YXe.value.create(Qd.zLj).process(this.iaa,Ld);(Qd=Ea.a.instance.Na("Box4.IFeatureHelper"))&&
Qd.isFeatureEnabled(11)?Ld.hi(this.g7k):Ld.hi(this.A4i);return!0};this.g7k=(Ld,Qd)=>{(new ru(Qd.JVk)).process(this.iaa,Ld);Ld.hi(this.A4i);return!0};this.A4i=(Ld,Qd)=>{var Zd;if(tm.uVc&&!document.getElementById("FrameContainingPastedDOM")){var te=window.performance.now(),Qf=document.createElement("iframe");Qf.style.display="none";Qf.setAttribute("sandbox","allow-same-origin");Qf.id="FrameContainingPastedDOM";document.body.appendChild(Qf);Xr.a.wQa&&(Xr.a.fcf=window.performance.now()-te)}Qf=null;tm.uVc&&
(Qf=document.getElementById("FrameContainingPastedDOM"));tm.uVc&&Qf instanceof HTMLIFrameElement?(te=0,Xr.a.wQa&&(te=window.performance.now()),Qf=null===(Zd=Qf.contentDocument)||void 0===Zd?void 0:Zd.querySelector("body"),null===Qf||void 0===Qf?void 0:Qf.appendChild(this.iaa),Xr.a.wQa&&(Xr.a.Jcj=window.performance.now()-te),Zd=null===Qf||void 0===Qf?void 0:Qf.children,1!==(null===Zd||void 0===Zd?void 0:Zd.length)&&u.ULS.sendTraceTag(508913473,307,15,"Found Multiple Pasted Container in iframe element"),
Qd.htmlProcessor.process(1===(null===Zd||void 0===Zd?void 0:Zd.length)?Zd[0]:this.iaa,Ld)):Qd.htmlProcessor.process(this.iaa,Ld);Ld.hi(Qd.lzf&&Qd.lzf.hgc?this.pNb:this.vWh);return!0};this.pNb=(Ld,Qd)=>{if(Qd=Qd.lzf){let te=!1,Qf=!1,Jg=!1,Ml=!1;var Zd=-1;const Fm=new Md.DictionaryPropertySet,qp=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');Object(rb.a)(101,this.Bi.xd)?(te=this.Bi.xd.ia(Bc.a.sha,!1),Zd=this.Bi.xd.ia(Wc.a.iP,""),Jg=this.Bi.xd.ia(Wc.a.g4,!1),Ml=this.Bi.xd.ia(lf.a.Jwa,!1),
qp.test(Zd)&&(Qf=!0),Zd=this.Bi.xd.ia(Hh.a.kga,-1)):this.Bi.yx&256&&this.iaa&&(te=!0,qp.test(this.iaa.innerHTML)&&(Qf=!0));Fm.setValue(Bc.a.sha,te);Fm.setValue(Wc.a.IWc,Qf);Fm.setValue(Wc.a.g4,Jg);Fm.setValue(Hh.a.kga,Zd);Fm.setValue(lf.a.Jwa,Ml);Qd.bhe(Fm);Qd.yVf();Qd.Vlb&&(this.Bi.LUc=!0,this.Bi.Ezf=Qd.jX,this.Bi.aSf=Qd.Vlb,te&&!Jg&&Xe.c(Gb.a.Uzl),w.AFrameworkApplication.va.processAction(Gb.a.pNb,2))}Ld.hi(this.vWh);return!0};this.vWh=(Ld,Qd)=>{var Zd;Ld=0;Xr.a.wQa&&(Ld=window.performance.now());
if(tm.uVc){var te=document.getElementById("FrameContainingPastedDOM");te instanceof HTMLIFrameElement&&(te=null===(Zd=te.contentDocument)||void 0===Zd?void 0:Zd.querySelector("body"),null===te||void 0===te?void 0:te.removeChild(te.firstElementChild))}Xr.a.wQa&&(Xr.a.Ybj=window.performance.now()-Ld);gq.a.m9m(Qd.zLj);gq.a.B4m(Qd.Yum);gq.a.N7m(Qd.beo);gq.a.O7m(Qd.ceo);gq.a.i5m(Qd.fYc);Zd="Others";Qd.RVd&&(Qd.RVd.y4m(),Qd.RVd.z4m(),Zd=Qd.RVd.Pje);gq.a.A4m(Qd.Vum,Zd);gq.a.d4m(Qd.YIl,Zd);return!1};this.iaa=
b;this.Aue=P;this.qEe=ca;this.KUe=ta;this.YXe=Ra;this.wuc=mb;this.PVb=Lc;this.Fa=Ub;this.jZg=Object.assign(new Xw,{uac:2===this.Bi.Q3b||3===this.Bi.Q3b});this.JAe=Ac;this.Rkd=vd;this.yZb=Ub.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.Fjk=Ub.$("ParseStyleFromRawHtmlHeadIsEnabled");this.rkk=Ub.$("RemoveSpacesAfterEndFragmentIsEnabled")}get W5d(){return!1}get mUc(){return!0}rYh(b){this.Hka=new he.GraphIterator;this.k5a.restore(this.Hka);u.ULS.shipAssertTag(6305550,307,ig.OutlineElementReader.Nh(this.Hka));
this.Bi.yR&&this.Bi.yR.s1b("external");var h=this.Bi.yx&8192?1:0,v=this.qEe.value.create(h,this.Hka,this.Bi.UGc,this.Bi.Wnb);const D=this.KUe.value.create(h,this.Hka),P=gq.a.a6h(w.AFrameworkApplication.userSessionId),ca=gq.a.Yji(w.AFrameworkApplication.userSessionId),ta=gq.a.Cqf(aa.a.eAb,this.Bi.UGc),Ra=gq.a.Bgi(w.AFrameworkApplication.userSessionId),mb=gq.a.Cgi(w.AFrameworkApplication.userSessionId),Jb=this.yZb?this.fAm():null,Ub=gq.a.K$h(aa.a.eAb,this.Bi.UGc),cc=gq.a.L$h(w.AFrameworkApplication.userSessionId),
Ac=this.wuc.sqj?gq.a.a3l(w.AFrameworkApplication.userSessionId):null;h=this.Aue.value.create(h,this.Hka,v,D,null,ta,this.NCk,this.Bi.Rle);h=new Hu(h,Ra,mb);h=new ar(h,v,this.PVb);h=new tm(h,this.wuc,this.jZg,Ac);h=new BA(h,Ub,Jb,this.Fa);h=new su(h,cc);v=new FC(h,v,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac);v=new Eu.a(b,this.Ain,v);v.Jl("paste and request pictures");v.Gh=!b||b.Gh;v.run()}get NCk(){return this.iaa.getElementsByTagName("a").length}fAm(){const b=new EC;b.wLb=aa.a.eAb;this.Bi&&(b.yx=this.Bi.yx,b.gXf=
this.Bi.UGc,this.Bi.xd&&(b.progId=this.Bi.xd.ia(Wc.a.i1i,"")));this.iaa&&this.iaa.innerHTML&&(b.h1i=this.iaa.innerHTML.length,Xr.a.wQa&&(Xr.a.f1i=b.h1i));w.AFrameworkApplication.sessionStartInfoSettings&&(b.platform=w.AFrameworkApplication.sessionStartInfoSettings.Platform,b.nHf=w.AFrameworkApplication.K.$("IsO365ConsumerHost"),b.evi=fe.ParagraphReader.$la(Xa.App.xa.ib.rc.Yc));return b}get Kqj(){return!0}get p8c(){u.ULS.shipAssertTag(6305551,307,!!this.Hka);if(this.wuc.tqj(this.jZg)){let b=!1;ig.OutlineElementReader.Nh(this.Hka)&&
(this.Hka.J_(),b=!0);const h=fe.ParagraphReader.sh(this.Hka)&&!this.Hka.currentNode.ia(Wc.a.nxi,!1);b&&this.Hka.wc();return h}return fe.ParagraphReader.sh(this.Hka)}}Object(n.a)(mt,"ExternalPasteExecutionManager",co,[]);class yw{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc){this.y6b=cc;this.Aue=b;this.qEe=h;this.KUe=v;this.YXe=D;this.wuc=P;this.hZ=ca;this.Fa=ta;this.JAe=Ra;this.PVb=mb;this.x6=Jb;this.Rkd=Ub}create(b,h,v,D){return new mt(b,h,v,D,this.Aue,this.qEe,this.KUe,this.YXe,this.wuc.value,this.hZ,
this.Fa,Xa.App.xa.ib,this.JAe,this.PVb,this.x6,this.Rkd,this.y6b)}}Object(n.a)(yw,"Factory",null,[739]);class fy{$Ei(b){if(!b||!b.childNodes)return!1;const h=b.childNodes.length;return 2>h?!1:this.NKm(b.childNodes[h-2])&&this.kWm(b.childNodes[h-1])}SOo(b){this.$Ei(b)&&(b.removeChild(b.lastChild),u.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}rIm(b){return!!b&&8===b.nodeType}FUm(b){return!!b&&3===b.nodeType}NKm(b){return this.rIm(b)&&"EndFragment"===b.nodeValue}kWm(b){if(!this.FUm(b))return!1;
b=b.nodeValue;return!!b&&!b.trim().length}}Object(n.a)(fy,"HtmlNormalizerHelper",null,[738]);var Bs=c(1964),GD=c(631);class GC extends co{constructor(b,h,v,D,P,ca,ta,Ra,mb){super(b,h,v,P,ca,Ra,mb);this.$z=D;this.xI=ta}get ul(){return this.xI.value}get W5d(){return this.$z.W5d()}get p1i(){const b=this.$z;return b.d$e&&!b.wti()}sYh(b,h){u.ULS.shipAssertTag(6305616,307,Ei.OutlineReader.fx(b));const v=GD.a(b.currentNode);if(Ei.OutlineReader.isEmpty(b)){var D=we.a.create(b.currentNode);b.mt(8);w.AFrameworkApplication.va.Mf(D,
Gb.a.AH,2,!0,null,null)}else b.mt(8);(D=b.oJ(1))&&b.wc();this.$z.X0i(this.Bi.he,b.currentNode,D,-1,v,h)}rYh(b){const h=new he.GraphIterator;this.k5a.restore(h);u.ULS.shipAssertTag(6305618,307,ig.OutlineElementReader.Nh(h));this.Bi.yR&&this.Bi.yR.s1b("internal");let v=-1;if(Object(rb.a)(101,this.Bi.xd))v=this.Bi.xd.ia(Hh.a.kga,-1);else{const D=this.oUl(h.currentNode);v=D?D.clientWidth:v}this.$z.X0i(this.Bi.he,h.parentNode,h.currentNode,v,null,b);this.Ezi&&(this.k5a.restore(h),ig.OutlineElementReader.Nh(h)&&
this.$z.MCi(h)&&(b=hf.OutlineElementNavigator.Ge(h)))&&(this.Bi.v0a=Og.SelectionFactory.pe(b,0))}oUl(b){return b?(b=b?b.De(this.ul.fc):null)?b.htmlElement:null:null}rrj(){const b=new he.GraphIterator;this.k5a.restore(b);return this.$z.MCi(b)}get Kqj(){return!0}get p8c(){return!this.$z.mva&&!this.$z.d$e}}Object(n.a)(GC,"InternalPasteExecutionManager",co,[]);class LB{constructor(b,h,v,D,P){this.y6b=P;this.$z=b;this.hZ=h;this.xI=v;this.x6=D}create(b,h,v){return new GC(b,h,v,this.$z,this.hZ,Xa.App.xa.ib,
this.xI,this.x6,this.y6b)}}Object(n.a)(LB,"Factory",null,[737]);var Ll;(function(b){b[b.unknown=0]="unknown";b[b.differentBox4App=1]="differentBox4App";b[b.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";b[b.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(Ll||(Ll={}));Object(n.b)("CopySource",Ll);class Vn{constructor(b,h,v,D){this.$z=b;this.C_g=h;this.b3j=v;this.Jk=D}kCn(b,h,v){u.ULS.shipAssertTag(6305620,307,!!b);u.ULS.shipAssertTag(6305621,307,$e.SelectionEditor.gf(h));u.ULS.shipAssertTag(6305622,
307,!!v);u.ULS.shipAssertTag(6305623,307,Object(rb.a)(fq.a,v.ypa));const D=v.ypa;D.Q3b=this.$z.z7h(b);this.S4m(b,D);let P=!1;ui.a.RFd&&this.Jk.uha(h,Ra=>P=Ra)&&(D.yx|=8192,ui.a.SFd&&(D.Rle=1,P||(D.Rle|=2)));const ca=this.GNm(D);var ta=new eh.GraphTransaction(7,Gb.a.paste);ta.Cb(h.node);h.node.GH().jF.z7(8);ca?(u.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",D.yx,D.browserName),b=this.C_g.create(h,D,ta)):(u.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",
D.yx,D.Q3b,D.browserName),Vn.I4m(b),b=this.b3j.create(b,h,D,ta));v=new Eu.a(v,Object(z.a)(b,b.b1i,"pasteSetup"),null);v.Jl("Paste");v.run()}GNm(b){return!this.AQm(b)&&3===b.Q3b}AQm(b){return 1===(b.yx&8192?1:0)}Dti(b,h){u.ULS.shipAssertTag(6305624,307,$e.SelectionEditor.gf(b));u.ULS.shipAssertTag(6305625,307,!!h);u.ULS.shipAssertTag(6305626,307,Object(rb.a)(fq.a,h.ypa));const v=new eh.GraphTransaction(7,Gb.a.wXd);v.Cb(b.node);b=this.C_g.create(b,h.ypa,v);h=new Eu.a(h,Object(z.a)(b,b.b1i,"pasteSetup"),
null);h.Jl("InternalPasteAtIp");h.run()}S4m(b,h){if(b){let v=!1,D=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?D=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(v=!0);(v||D)&&u.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",Ll[h.Q3b],v,D)}}static I4m(b){b&&Vn.vpk.test(b.innerText)&&u.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}Vn.vpk=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");
Object(n.a)(Vn,"PasteCoordinator",null,[]);class tu{constructor(b,h,v,D,P){this.uva=b;this.Mkb=h;this.BCn=v;this.ACn=D;this.mUc=P}}Object(n.a)(tu,"PastedContentsPostProcessorParams",null,[]);class MB{CAm(b,h,v,D,P,ca){b=this.XXl(b,h,P);v=this.I1l(v);if(!b||!v)return null;D=this.X8l(b,D,P);P=this.W8l(v);return new tu(b,v,D,P,ca)}XXl(b,h,v){b=v?b:h;if(!ig.OutlineElementReader.Nh(b))return null;h=new Rl.a;h.Zc(b);return h}I1l(b){if(!ig.OutlineElementReader.Nh(b))return null;const h=new Rl.a;h.Zc(b);
hf.OutlineElementNavigator.t0(h,!1,!1);return h}X8l(b,h,v){hf.OutlineElementNavigator.Ge(b);let D=-1;fe.ParagraphReader.sh(b)&&(D=v?h:0);hf.OutlineElementNavigator.Vd(b);return D}W8l(b){hf.OutlineElementNavigator.Ge(b);const h=fe.ParagraphReader.sh(b)?fe.ParagraphReader.textLength(b.currentNode):-1;hf.OutlineElementNavigator.Vd(b);return h}}Object(n.a)(MB,"PastedContentsPostProcessorHelper",null,[]);var oD=c(787),oh=c(1083),Gh=c(1082);class Uy{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac=null){this.Fpa=
b;this.w9=h;this.xo=v;this.G3i=D;this.ta=P;this.c5a=ca;this.K=ta;this.pCn=Ra;this.Qca=mb;this.NFb=Jb;this.yua=Ub;this.lb=cc;this.yha=Ac;this.lPh=100;this.jcc=!1;this.yxe=null;this.jGe=!1;this.nrd=null;this.ynd=this.YKa=!1;this.wGl=(Lc,id)=>{this.dismissFloatie(id.QCl)};this.oxo=(Lc,id)=>{this.Cal(Lc,id)};this.tY=(Lc,id)=>{id.property===lf.a.lastModifiedTime?(u.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.NFb.Fcf.contains(Gb.a.jng)||this.L2f(id)):u.ULS.sendTraceTag(520734532,
307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")};this.SKb=(Lc,id)=>{this.L2f(id)};this.bia=(Lc,id)=>{id.PCf||this.L2f(id)};this.pWi=()=>{oD.a.instance.keyCode===Ve.a.pza&&this.w9.A6i()};this.fDo()}fDo(){this.w9.Rqh(this.oxo);this.w9.yqh(this.wGl)}Cal(b,h){var v,D,P;(null===(D=null===(v=this.lb.gb)||void 0===v?void 0:v.kb)||void 0===D?0:D.sUc)?u.ULS.sendTraceTag(512313220,307,50,"Box4 Paste floatie not created because Loop component was pasted."):
(this.c5a.jBf(),1===this.pCn.Qal(h.E1c)?u.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId):this.showFloatie(b,h)?(this.YKa?this.YKa=!1:this.fZn(),this.e4c(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",Gb.a.ZT(h.yY)||"Unknown",h.correlationId),u.ULS.sendTraceTag(40379588,307,50,b),Xe.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new na.a,{name:"PasteCommand",int64:Gb.a.ZT(h.yY)||"Unknown"}),Object.assign(new na.a,
{name:"CorrelationId",string:null===(P=h.correlationId)||void 0===P?void 0:P.toString()})]),this.UQb()):u.ULS.sendTraceTag(575255108,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId))}dismissFloatie(b){var h;!this.jGe&&(this.YKa||(this.yha?null===(h=this.yua)||void 0===h?0:h.$_:this.Fpa.$_()))&&(b&&(this.c5a.jBf(),this.xEj(),u.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.nrd)),this.YKa=!b,this.Kne(),this.yha?
w.AFrameworkApplication.va.processAction(Gb.a.jGb,2):this.Fpa.dismissFloatie())}fZn(){this.ynd||(this.yxe=this.xo.Bd,Le.a.addHandler(this.yxe.container,"scroll",Object(z.a)(this,this.VNb,"scrollHandler")),this.ta.WZ(Object(z.a)(this,this.Gia,"resizeHandler")),this.ynd=!0)}xEj(){this.ynd&&(Le.a.removeHandler(this.yxe.container,"scroll",Object(z.a)(this,this.VNb,"scrollHandler")),this.ta.ada(Object(z.a)(this,this.Gia,"resizeHandler")),this.ynd=!1)}UQb(){if(this.yha)this.yua.$_&&w.AFrameworkApplication.va.processAction(Gb.a.jGb,
2),w.AFrameworkApplication.va.processAction(Gb.a.O8c,2),this.jcc=!1;else{const b=new Gh.a(0,w.AFrameworkApplication.isRtl);b.location=this.c5a.bPa();this.c5a.DLm(b.location)?this.showFloatie(null,b):this.w9.XGa(new oh.a(!1))}}Gia(){this.yha?(w.AFrameworkApplication.va.processAction(Gb.a.jGb,2),this.mJc()):this.UQb()}VNb(){this.yha?(w.AFrameworkApplication.va.processAction(Gb.a.jGb,2),this.mJc()):this.UQb()}e4c(){this.G3i.yyk(this.pWi);this.w9.Dqh(Object(z.a)(this.Fpa,this.Fpa.wLd,"expandFloatie"));
this.w9.Nqh(Object(z.a)(this,this.e1i,"pastedFloatieStatusChange"));this.Qca.$t(this.bia);this.Qca.Ax(this.SKb);this.Qca.Go(this.tY)}Kne(){this.G3i.n2n(this.pWi);this.w9.Gbj(Object(z.a)(this.Fpa,this.Fpa.wLd,"expandFloatie"));this.w9.Obj(Object(z.a)(this,this.e1i,"pastedFloatieStatusChange"));this.Qca.SU(this.bia);this.Qca.bqa(this.SKb);this.Qca.TU(this.tY)}e1i(b,h){this.jGe=h.rUc;h.yY&&(this.nrd=h.yY);h.Ydg&&this.Fpa.$_()&&this.UQb()}L2f(b){b.node.loading||this.w9.XGa(new oh.a(!0))}showFloatie(b,
h){h||(h=new Gh.a(0,w.AFrameworkApplication.isRtl));h.location||(h.location=this.c5a.bPa());if(!h.location)return!1;this.YKa&&(this.YKa=!1,this.e4c());this.yha?w.AFrameworkApplication.va.processAction(Gb.a.O8c,2):this.Fpa.showFloatie(b,h);return!0}mJc(){if(!this.jcc){const b=new qf.a(3,1,this.lPh,()=>{this.UQb()},215);Qg.a.instance.Vb(b);this.jcc=!0}}}Object(n.a)(Uy,"PasteFloatieEventManager",null,[]);class Ng{constructor(b,h){this.lk=b;this.kI=h}Qal(b){return pm.any(pm.where(pm.asEnumerable(Ng.cGo),
h=>this.kI.TVc(h)))?(b=this.lk.Xmb(b))&&(b=b.innerText)&&0<b.trim().length?0:1:1}}Ng.cGo=[Gb.a.reformatPastedContent.toString(),Gb.a.qSa.toString(),Gb.a.dya.toString()];Object(n.a)(Ng,"PasteFloatieFeatureSetBuilder",null,[]);class fx{constructor(){this.Nxa=null;this.cgc=0}}Object(n.a)(fx,"PasteFloatieAnchorData",null,[]);class Gr{constructor(b,h,v,D,P,ca=!1){this.ywb=null;this.hb=b;this.ota=h;this.fd=v;this.N4j=D;this.LNe=P;this.KGe=ca}jBf(){this.ywb=null}bPa(){const b=this.sqf(this.ywb)||this.tAh();
if(!b){let h="null",v="null";if(this.ywb&&this.ywb.Nxa){if(!this.fd.Bd)return u.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;h=Object.getType(this.ywb.Nxa).getName();const D=this.fd.Bd.Fj(this.ywb.Nxa);D&&(v=Object.getType(D).getName())}u.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",h,v)}return b}DLm(b){if(!b)return!1;const h=this.LNe.zEb(),v=this.N4j(this.fd.Bd.container);b=new Sys.UI.Bounds(b.x,
b.y,h.width,h.height);return b.y>=v.y&&b.y+b.height<=v.y+v.height}tAh(){if(!this.hb||!this.hb.gb||!this.hb.gb.kb)return u.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var b=this.hb.gb.kb.Oa,h=!b.cpBegin&&!b.cpEnd;let v=b.node;if(v&&h){do v=this.Kei(v);while(v&&Object(rb.a)(Po.AParagraphNode,v)&&!v.characterData.trim().length)}let D="";const P=Object(Na.a)(Po.AParagraphNode,v);P&&(D=P.characterData.length===b.cpBegin||h?P.characterData.trimEnd():
P.characterData.substring(0,b.cpBegin).trimEnd());h=P?D.length:b.cpBegin;b=Object.assign(new fx,{Nxa:Object(Na.a)(137,(P?Object(Na.a)(137,P):Object(Na.a)(137,v))||b.node),cgc:h});return this.sqf(b)}Kei(b){const h=new he.GraphIterator;if(!b.anchor)return null;h.set(b);if(!h.vd())return null;h.jd(11);return h.pJ()?h.Sb(2):null}sqf(b){if(!b||!b.Nxa)return null;this.ywb=b;const h=this.fd.Bd;if(!h)return u.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;
b=this.M$h(b,h);if(!b)return null;w.AFrameworkApplication.isRtl&&this.LNe.$_()&&(b.x-=this.LNe.zEb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}M$h(b,h){h=h.De(b.Nxa);if(!h)return null;let v=null;if(Object(rb.a)(Po.AParagraphNode,b.Nxa)){const D=Object(Na.a)(86,h);if(!D)return null;try{v=this.ota.b_(b.cgc,D,0<b.cgc,!1,!1,!1),v.height+=this.KGe?Gr.qQn:Gr.zGl}catch(P){u.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",P),v=null}}else Object(rb.a)(Hv.TableNode,
b.Nxa)&&(v=Object(Na.a)(191,h).Suf());v||(v=h.getBounds());return v}}Gr.zGl=2;Gr.qQn=60;Object(n.a)(Gr,"PasteFloatiePositionProvider",null,[]);class ms{constructor(b,h){this.Urc=b;this.KZj=h}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get y2h(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get bdf(){return CommonUIStrings.l_ClipboardCut}get kMf(){return CommonUIStrings.l_ClipboardCut_Mac}get Z$e(){return CommonUIStrings.l_ClipboardCopy}get jMf(){return CommonUIStrings.l_ClipboardCopy_Mac}get IYf(){return CommonUIStrings.l_ClipboardPaste}get lMf(){return CommonUIStrings.l_ClipboardPaste_Mac}get x9(){return CommonUIStrings.l_ClipboardPasteText}get mMf(){return CommonUIStrings.l_ClipboardPasteText_Mac}get i8e(){return this.KZj}get $Eh(){return CommonUIStrings.l_ClipboardExtensionLink}get Qeb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}JYh(){u.ULS.sendTraceTag(8716421,
307,50,null);Dd.a.om(this.i8e,"_blank",void 0,"ClipboardAccessExtensionLink")}dda(b,h){let v=aa.a.Wk;w.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(v=aa.a.ti||v);return v?String.format(h,"\u2318"):b}dispose(){this.Urc=null}a3f(b){this.bKh(b)}c_m(b){this.bKh(b)}bKh(b){this.Urc&&this.Urc(b)}}ms.id="CopyPasteShortcutDialog";ms.Xyj="CopyPasteText";Object(n.a)(ms,"ACopyPasteShortcutDialog",null,[10]);class NB extends ms{constructor(b,h,v){super(b,h);b=document.createElement("span");
b.className="WACCopyPasteShortcutDialogTextPanel";h=document.createElement("span");h.id=ms.Xyj;var D=document.createElement("span");D.innerText=this.y2h;var P=document.createElement("span");P.className="UIFontBold";P.innerText=this.dda(this.bdf,this.kMf);const ca=document.createElement("span");ca.className="UIFontBold";ca.innerText=this.dda(this.Z$e,this.jMf);const ta=document.createElement("span");ta.className="UIFontBold";ta.innerText=this.dda(this.IYf,this.lMf);h.appendChild(D);h.appendChild(document.createElement("br"));
h.appendChild(P);h.appendChild(ca);h.appendChild(ta);v.$("PasteTextOnlyShortcutDialogIsEnabled")&&(aa.a.Aq||aa.a.lj)&&(v=document.createElement("span"),v.className="UIFontBold",v.innerText=this.dda(this.x9,this.mMf),h.appendChild(v));b.appendChild(h);this.i8e?(u.ULS.sendTraceTag(8716420,307,50,null),v=document.createElement("span"),h=document.createElement("a"),h.href="#",h.innerText=this.$Eh,Le.a.addHandler(h,"click",Object(z.a)(this,this.JYh,"extensionLinkHandler")),v.appendChild(h),P=this.Qeb.indexOf("{0}"),
-1!==P&&(D=this.Qeb.substring(0,P),P=this.Qeb.substring(P+3,this.Qeb.length),D=document.createTextNode(D),P=document.createTextNode(P),v.insertBefore(D,h),v.appendChild(P)),b.appendChild(document.createElement("br")),b.appendChild(v)):u.ULS.sendTraceTag(8716422,307,50,null);v=new ug.StandardDialog;v.Ad=0;v.wg=ms.id;v.Ou(this.titleText,null,0,Object(z.a)(this,this.c_m,"legacyCopyPasteShortcutDialogHandler"),b);v.h5(ms.Xyj)}}Object(n.a)(NB,"CopyPasteShortcutDialog",ms,[]);class FA extends ms{constructor(b,
h){super(b,h);h={};b=this.eEm;h.extensionStartText=this.Jzl;h.extensionLink=null;h.extensionEndText=null;h.shortcutsMessageText=this.Nro;h.cutText=this.dda(this.bdf,this.kMf);h.copyText=this.dda(this.Z$e,this.jMf);h.pasteText=this.dda(this.IYf,this.lMf);4!==w.AFrameworkApplication.ta.Nb.Tl&&(h.pasteTextOnly=this.dda(this.x9,this.mMf));h={["id"]:"CopyPasteInstallDialog",["bodyControls"]:h};const v=new bg.a(!1,!1,!0);v.wg="CopyPasteInstallDialog";v.Ad=0;v.Ee(1,this.dEm);v.$U(1);v.Wh(b,Object(z.a)(this,
this.a3f,"reactCopyPasteShortcutDialogHandler"),h)}get Nro(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get dEm(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get eEm(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get Jzl(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static Yvo(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(n.a)(FA,"ReactCopyPasteInstallDialog",ms,[]);class HC extends ms{constructor(b){super(b,null);this.gGi="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var h={};b=this.Shn;var v="";let D="";this.messageText&&(v=this.messageText.split(" {")[0],D=this.messageText.split("} ")[1]);h.startText=v;h.endText=D;h.cutText=this.Ihl;h.copyText=this.s8k;h.pasteText=this.sCn;
h.cutShortcutText=this.dda(this.Jhl,this.p$m);h.copyShortcutText=this.dda(this.C8k,this.o$m);h.pasteShortcutText=this.dda(this.vCn,this.r$m);h.imageSrc=Id.a.dba("NoClipboardAccessDialogImage.svg");h.imageAltText=this.imageAltText;h.primaryButtonLabel=this.nIn;this.gGi&&(u.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),h.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.Ukb,["onExecute"]:()=>{this.XZm()}});h={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:h};
v=new bg.a(!1,!1,!0);v.Ad=0;v.wg="CopyPasteNoClipboardAccessDialog";v.Wh(b,Object(z.a)(this,this.a3f,"reactCopyPasteShortcutDialogHandler"),h)}get Shn(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get Ukb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get nIn(){return CommonUIStrings.l_DialogOk}get Ihl(){return CommonUIStrings.l_CutString}get Jhl(){return CommonUIStrings.l_CutShortcut}get p$m(){return CommonUIStrings.l_CutShortcut_Mac}get s8k(){return CommonUIStrings.l_CopyString}get C8k(){return CommonUIStrings.l_CopyShortcut}get o$m(){return CommonUIStrings.l_CopyShortcut_Mac}get sCn(){return CommonUIStrings.l_PasteString}get vCn(){return CommonUIStrings.l_PasteShortcut}get r$m(){return CommonUIStrings.l_PasteShortcut_Mac}XZm(){u.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Dd.a.om(this.gGi,"_blank",void 0,"learnMoreLink")}}Object(n.a)(HC,"ReactCopyPasteNoClipboardAccessDialog",ms,[]);class Cs extends ms{constructor(b,h,v){super(b,h);b={};b.forwardElementText=this.y2h;b.cutText=this.dda(this.bdf,this.kMf);b.copyText=this.dda(this.Z$e,this.jMf);b.pasteText=this.dda(this.IYf,this.lMf);v.$("PasteTextOnlyShortcutDialogIsEnabled")&&(aa.a.Aq||aa.a.lj)&&(b.pasteTextOnly=this.dda(this.x9,this.mMf));this.i8e?(u.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.$Eh,["onExecute"]:D=>{this.JYh(D)}},v=this.Qeb.indexOf("{0}"),-1!==v&&(b.suggestionPrefixElement=this.Qeb.substring(0,v),b.suggestionSuffixElement=this.Qeb.substring(v+3,this.Qeb.length))):u.ULS.sendTraceTag(40726915,307,50,null);v={["id"]:ms.id,["bodyControls"]:b};b=new bg.a(!1,!1,!0);b.Ad=0;b.wg=ms.id;b.Wh(this.titleText,Object(z.a)(this,this.a3f,"reactCopyPasteShortcutDialogHandler"),v)}}Object(n.a)(Cs,"ReactCopyPasteShortcutDialog",
ms,[]);class zw{constructor(){this.ZKa=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.mF}Aaf(b,h,v=!1){u.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.ZKa,v));this.ZKa?v?new FA(b,h):new Cs(b,h,w.AFrameworkApplication.K):new NB(b,h,w.AFrameworkApplication.K)}static get instance(){return zw._instance||(zw._instance=new zw)}}zw._instance=null;Object(n.a)(zw,"CopyPasteShortcutDialogFactory",null,[1194]);class Vy{constructor(b,h,v,D,
P,ca,ta,Ra){this.fgh=this.u1g=this.PTe=!1;this.Zlk=b;this.fd=h;this.Yt=v;this.Ub=D;this.Ae=P;this.gg=ca;this.Te=ta;Ra&&(this.fgh=Ra.$("ShouldLogExecCommandCopySuccess"))}get NTa(){return this.Zlk}get e3a(){return this.u1g}set e3a(b){this.u1g=b;this.gg.ignoreClipboardEvents=b}nLc(b){this.NTa.nLc(b);b||this.x$c(!0)}get Pwl(){return this.NTa.a8f}prepareForPaste(b){this.e3a=!0;this.NTa.prepareForPaste(b,this.vig)}reset(){this.e3a=!1}paste(){var b=null;let h=null;if(!this.NTa.MRb){(b=this.fd.Bd)&&this.Ub.mg(b.hJ);
var v=this.Yt.yu;if(!v.te||!v.editingView.Oj)return null;h=v.editingView;b=this.Ae.ow();this.e3a=!0;v.n8a()}v=null;try{h&&h.ZGn(),v=b=this.NTa.CLc(this.vig,b)}catch(D){u.ULS.shipAssertTag(6305672,307,!1),this.Cli()}this.e3a=!1;return v}copy(){var b=this.fd.Bd;b&&this.Ub.mg(b.hJ);b=this.Yt.yu;if(!b.te||1!==b.editingView.mode)return!1;this.e3a=!0;let h;try{const v=new Map;v.set("View","ContentEditableView");va.Health.instance.recordKpiUsage(ir.a.K2b,0,ir.a.jDd,v);const D=this.NTa.hjf(this.vig);h=!0;
this.fgh&&u.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",D,this.Te.eG);if(!D){const P=Object.assign(new Bb.a,{extendedProperties:v});va.Health.instance.recordKpiFailure(ir.a.K2b,ir.a.J6e,!0,!0,P)}}catch(v){u.ULS.shipAssertTag(6305673,307,aa.a.lj),u.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",aa.a.eG),h=!1}this.e3a=!1;return h?!0:!1}x$c(){if(this.PTe)return!0;var b=this.Yt.yu;if(!b.te||!b.editingView.Oj)return!1;
const h=b.editingView;b=this.Ae.ow();this.e3a=!0;const v=new Oy.a(b);let D=!1;try{D=this.NTa.x$c(b,()=>{h.dEd()},()=>{h.uHa()})}catch(P){}v.restore();this.e3a=!1;D?this.PTe=!0:(u.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",aa.a.eG),this.Cli());return D}Cli(){this.PTe=!1;if(w.AFrameworkApplication.$3o)zw.instance.Aaf(null,null);else{const b=new ug.StandardDialog;b.Ad=0;b.cV(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,
null)}}get vig(){const b=this.Ae.Fhb();return b?b.Qn:null}}Object(n.a)(Vy,"SystemClipboard",null,[736]);class Mm{constructor(b,h,v){this.Txd=!1;this.ryd=this.NS=this.l4g=this.Wve=this.Kfd=null;this.CFn=D=>{1===D?(u.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.Kve)),this.R_b&&(u.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.R_b)),Dd.a.om(this.DCe+this.RLe,"_blank",void 0,"ChromeCCPInstallDialog"))):D||u.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",
this.Kve))};this.Kve=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");this.DCe=b.jb("ChromeClipboardAccessExtensionLink");this.O$a=h;this.lk=v;this.RLe=b.jb("ChromeClipboardAccessExtensionId");this.Dok=b.$("UseGetClipboardDataIsEnabled");this.vch=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.R_b=!1;b.$("CcpInstallDialogIsEnabled")&&w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.mF&&(this.R_b=FA.Yvo()||b.$("IgnoreDomainCheckCcpInstallDialog"),u.ULS.sendTraceTag(587314304,
307,50,"_useInstallDialog: {0}",this.R_b));this.$sc=null}nLc(b){b?this.NS=!0:(this.NS=null,chrome.runtime&&chrome.runtime.sendMessage?(this.$sc=this.O$a.QHd,this.O$a.TOb?(this.Txd=this.Dok,this.fDh()):(this.Txd=!0,this.fDh(),u.ULS.sendTraceTag(19256732,307,50,W.a.create().toString()))):(this.mPb(),this.NS=!1))}get a8f(){return this.NS}get MRb(){return this.ryd}x$c(){return!0}hjf(b){u.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");(b=Dd.a.aDb(b,"copy"))||u.ULS.sendTraceTag(24402116,307,10,
String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)));return b}Aof(b){if(!b)return null;var h=b.img;const v=b.text;b=b.html;const D=this.lk.wij(!!h,!!v,b);let P=null;if(3===D){if(!b)return null;h=this.lk.TYh(b);(h=this.lk.$Yh(h))&&(b+=h);P=this.lk.Xmb(b)}else 2===D?P=this.lk.BYf(v,!0):1===D&&(P=this.lk.Xmb(h));return P}CLc(b,h){if(this.MRb)h=this.Aof(this.Wve),this.Wve=null;else{if(!this.Kfd)return h;b=document.implementation.createHTMLDocument("doc");
b.body.innerHTML=this.Kfd;h=b.body;this.Kfd=null}return h}prepareForPaste(b){const h=W.a.create();this.l4g=h;this.O$a.TOb?u.ULS.sendTraceTag(7377737,307,50,h.toString()):u.ULS.sendTraceTag(19256735,307,50,h.toString());const v={};v.command=this.MRb?"getClipboardData":"paste";chrome.runtime.sendMessage(this.$sc,v,D=>{h.equals(this.l4g)?this.MRb?this.Wve=D:this.Kfd=D:u.ULS.sendTraceTag(7385868,307,50,null);u.ULS.sendTraceTag(7377738,307,50,h.toString());chrome.runtime.lastError&&(this.Qsl(),this.O$a.TOb?
u.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):u.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));b()})}mPb(){u.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.R_b?b=this.DCe+this.RLe:this.Kve&&(b=this.DCe+this.$sc);zw.instance.Aaf(this.CFn,b,this.R_b)}Qsl(){this.O$a.F6n();this.mPb()}Kjj(b,h){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},h)}VVk(){const b=W.a.create();this.O$a.TOb?u.ULS.sendTraceTag(592491466,307,50,b.toString()):u.ULS.sendTraceTag(591984031,
307,50,b.toString());chrome.runtime.sendMessage(this.$sc,{command:"getAvailableCommands"},h=>{u.ULS.sendTraceTag(592491467,307,50,b.toString());h?Object(rb.a)(Array,h)?(u.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",h),this.ryd=-1!==Array.indexOf(h,"getClipboardData")):(u.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",h),this.ryd=!1):(u.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:
null),this.ryd=!1)})}fDh(){const b=W.a.create();this.O$a.TOb?u.ULS.sendTraceTag(7726105,307,50,b.toString()):u.ULS.sendTraceTag(591984032,307,50,b.toString());this.Txd&&this.VVk();this.Kjj(this.$sc,h=>{u.ULS.sendTraceTag(7726106,307,50,b.toString());h&&"ping"===h?this.NS=!0:(h?"ping"!==h&&u.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:null):u.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",
chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.mPb(),this.NS=!1);this.Txd&&!this.MRb&&u.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}qKi(b,h){const v={};v.OfficeOnlineExtensionInstallationStatus=b;v.OfficeClipboardExtensionInstallationStatus=h;u.ULS.sendTraceTag(51144839,307,50,JSON.stringify(v));this.vch&&(b&&va.Health.instance.recordKpiSuccess(Mm.U8g,null),h&&va.Health.instance.recordKpiSuccess(Mm.R8g,null))}E3m(){this.vch&&(va.Health.instance.recordKpiUsage(Mm.U8g,
1,Mm.GUg,null),va.Health.instance.recordKpiUsage(Mm.R8g,1,Mm.GUg,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.O$a.TOb;this.Kjj(this.RLe,h=>{this.qKi(b,!!h)})}else this.qKi(!1,!1)}}Mm.U8g="OfficeOnlineExtensionInstallationStatus";Mm.R8g="OfficeClipboardExtensionInstallationStatus";Mm.GUg="wwccp";Object(n.a)(Mm,"ChromeSystemClipboardAccessManager",null,[765]);class Ju{constructor(b,h){this.NS=null;this.Te=b;this.Fa=h;this.dYj=!this.Fa.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&
this.Fa.$("BlockCopyCutOnFirefoxIsEnabled");this.xjk=h.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}nLc(b){this.dYj&&b&&this.Te.lj?(this.mPb(),this.NS=!1):this.NS=!0}get a8f(){return this.NS}get MRb(){return!1}hjf(b){return Dd.a.aDb(b,"copy")}CLc(b,h){Dd.a.aDb(b,"paste");return h}prepareForPaste(b){b()}x$c(b,h,v){if(this.Te.e4)return this.xjk&&(this.NS=!1),!1;h();v();b=this.CLc(b.ownerDocument,b);h=b.innerHTML;b.innerHTML=ub.a.create().toString();v();b=this.CLc(b.ownerDocument,b);return this.NS=
b=h===b.innerHTML}mPb(){zw.instance.Aaf(null,null)}}Object(n.a)(Ju,"DefaultSystemClipboardAccessManager",null,[765]);class OB{constructor(b,h,v){this.NS=this.R$=this.dYb=this.Yka=this.sXa=this.Gfd=null;this.lk=h;this.BXa=v;this.tbk=b.mc("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.bkk=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}nLc(b){this.bkk&&b&&(this.NS=!0)}get a8f(){return this.NS}get MRb(){return!1}hjf(b){return b?Dd.a.aDb(b,
Ed.a.copy):!1}CLc(b,h){this.sXa&&(h=this.sXa,this.sXa=null);return h}prepareForPaste(b,h=null){if(b&&h){this.Gfd=b;this.dYb=h;$addHandler(this.dYb,Ed.a.paste,Object(z.a)(this,this.JWi,"onPasteEvent"));this.R$=this.Yka=null;if(this.pDj(this.dYb)){if(this.R$&&0<this.R$.length&&(!this.Yka||this.lk.Moe(this.Yka))){this.BXa.tJh(this.R$,Object(z.a)(this,this.iqn,"onImageConverted"));this.sXa&&!this.sXa.hasChildNodes()&&u.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.Yka&&
this.Yka.innerHTML&&((this.sXa=this.bpi(this.Yka.innerHTML))&&!this.sXa.hasChildNodes()&&u.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),ic.a.wC(this.Yka))}this.j0h()}else b&&b()}x$c(b){return this.NS=b=this.pDj(b.ownerDocument)}JWi(b){try{b&&b.rawEvent&&((this.Yka=b.rawEvent.target)&&this.Yka.id&&-1<this.Yka.id.indexOf("Paste")?(u.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.Yka.id),this.Yka=null):this.R$=this.I_l(b.rawEvent))}catch(h){u.ULS.sendTraceTag(22073952,
307,15,"Exception while processing context menu paste event: "+h.toString())}}iqn(b){b&&(this.BXa.Rqj&&(b=String.format('<img src="{0}">',b)),this.sXa=this.bpi(b));this.j0h()}j0h(){this.dYb&&($removeHandler(this.dYb,Ed.a.paste,Object(z.a)(this,this.JWi,"onPasteEvent")),this.dYb=null);this.Gfd&&(this.Gfd(),this.Gfd=null)}I_l(b){let h=null;(b=this.lk.u6h(b))&&({bzf:h}=this.lk.QCj(b,this.tbk,this.BXa.INi));return h}pDj(b){return Dd.a.aDb(b,Ed.a.paste)}bpi(b){const h=document.implementation.createHTMLDocument("doc");
h.body.innerHTML=b;return h.body}mPb(){}}Object(n.a)(OB,"EdgeSystemClipboardAccessManager",null,[765]);class Aw{constructor(b,h,v,D){this.Fa=b;this.AZj=h;this.lk=v;this.Te=D}create(){let b=null;w.AFrameworkApplication.aeg()&&this.Te.Aq&&window.chrome?(u.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new Mm(this.Fa,this.AZj,this.lk),this.Fa.$("LogChromeExtensionInstallationStatusIsEnabled")&&b.E3m()):this.Fa.$("EdgeContextMenuPasteFixIsEnabled")&&this.Te.iu?(u.ULS.sendTraceTag(22073953,
307,50,"EdgeSystemClipboardAccessManager"),b=new OB(this.Fa,Ea.a.instance.resolve("Box4.IClipboardDataHelper"),Ea.a.instance.resolve("Box4.IProcessImageStrategy"),Ea.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(u.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new Ju(this.Te,this.Fa));return b}}Object(n.a)(Aw,"SystemClipboardAccessManagerFactory",null,[735]);class IC{ryl(b){return b}}Object(n.a)(IC,"DeleteTableSegmentStrategy",null,[733]);
var fv=c(586),Ds=c(1032);class gv{get jq(){return kt.a.dFb}get paragraphEditor(){return null!=this.BFg?this.BFg:this.BFg=Ea.a.instance.resolve("Box4.IParagraphEditor")}get F0(){return this.paragraphEditor.jq}get Jc(){return bf.a.instance}get OA(){return null!=this.MFg?this.MFg:this.MFg=Ea.a.instance.resolve("Box4.IParagraphIndentationReader")}MEc(b,h,v,D,P,ca,ta){let Ra=2;if(!b.te)return 2;const mb=b.lb;if(!mb)return this.Jc.Yb(qe.a.kf,{["Reason"]:me.a.Gca}),8;if(w.AFrameworkApplication.K.$("Box4PartialPromoteDemoteIsEnabled")){b=
this.jBh(h===Gb.a.KG,v,!0);if(1===D)return b?32:8;b&&(Ra=Ds.a.fgc(h,v,D,P,ca,ta))}else Ra=Ds.a.fgc(h,v,1,P,ca,ta),1!==D&&32===Ra?(b.lb.r8d(),b=new eh.GraphTransaction(15),b.Cb(v.view.Yc),Ra=this.jBh(h===Gb.a.KG,v,!1)?Ds.a.fgc(h,v,D,P,ca,ta):8,b.dispose()):1!==D&&8===Ra&&(b.lb.r8d(),this.K3k(h,v,mb));return Ra}jBh(b,h,v){h=h.view.lb;if(!h||!h.gb.kb)return this.Jc.Yb(qe.a.kf,{["Reason"]:me.a.iKb}),!1;if(h.gb.wJ)return this.Jc.Yb(qe.a.kf,{["Reason"]:me.a.c$e}),!1;h=fv.OutlineElementGeneralizer.tna(h.gb,
!1);if(!h)return this.Jc.Yb(qe.a.kf,{["Reason"]:me.a.HLd}),!1;let D=!1;for(let P=0;P<h.length;P++){const ca=h.getContext(P),ta=new he.GraphIterator;ta.set(ca.node);$e.SelectionEditor.ru(ta);if(!ig.OutlineElementReader.Nh(ta))if(v)continue;else return this.Jc.Yb(qe.a.kf,{["Reason"]:me.a.zCb}),!1;if(b?!this.jq.zAb(ta):!this.jq.u2b(ta))if(v)continue;else return this.Jc.Yb(qe.a.m5b,{["Reason"]:me.a.B6e}),!1;D=!0}return v?D:!0}K3k(b,h,v){const D=new eh.GraphTransaction(15);try{D.Cb(h.view.Yc);h=!0;const P=
fv.OutlineElementGeneralizer.tna(v.gb,!1);for(let ca=0;ca<P.length;ca++){const ta=P.getContext(ca),Ra=new he.GraphIterator;Ra.set(ta.node);$e.SelectionEditor.ru(Ra);if(!ig.OutlineElementReader.Nh(Ra))h=!1;else if(b===Gb.a.KG?this.jq.zAb(Ra):this.jq.u2b(Ra))switch(h=!1,b){case Gb.a.KG:this.jq.eSa(Ra,-1,0);break;case Gb.a.pO:this.jq.DJc(Ra,1)}}if(h){const ca=v.gb.kb;for(v=0;v<ca.length;v++){const ta=ca.J(v);if(ta.hl){const Ra=this.OA.Qhb(ta.node),mb=Ra.vda;if(b===Gb.a.KG?Ra.AB>mb:Ra.AB<18*mb){const Jb=
new he.GraphIterator;Jb.set(ta.node);this.F0.Fya(Jb,1,b===Gb.a.KG?Ra.AB>=2.5*mb?Ra.AB-2*mb:mb:Ra.AB<16*mb?Ra.AB+2*mb:18*mb)}}}}}finally{D&&D.dispose()}}}Object(n.a)(gv,"IndentationActorExtension",null,[734]);var pD=c(739),Mz=c(1212);class PB{constructor(b,h){this.Zn=new Md.DictionaryPropertySet;this.bsd=new Md.DictionaryPropertySet;this.Jub=!1;this.iBa=this.ksb=null;this.v6=b;this.gWg=h}get Spb(){return null!=this.YHg?this.YHg:this.YHg=Ea.a.instance.Na("Box4.ITextFormattingCommands")}get Sn(){return null!=
this.qAg?this.qAg:this.qAg=Ea.a.instance.resolve("Box4.IFormattingEditor")}get uc(){return null!=this.hKg?this.hKg:this.hKg=Ea.a.instance.resolve("Box4.Styles.IWACStyleReader")}W5a(){this.Jub||(0<this.YPa.kM()&&(this.bsd=this.Zn.clone()),this.Zn.b5f(),this.ksb=null,this.p0n())}B8k(b){var h;const v=null!==(h=Kl.FormattingReader.Nr(b))&&void 0!==h?h:Kl.FormattingReader.JPd(b.node,b.cpBegin,-1);!v.cache.IB&&(b=v.yn)&&(h=new Md.DictionaryPropertySet,h.Vw(b),h.Vw(this.Zn),h.hasProperty(Vi.a.kw)&&(this.ksb=
v.paragraph.Kc),this.Zn=h)}hasProperty(b){return this.Zn.hasProperty(b)}cRc(){return 0<this.Zn.kM()}get YPa(){return this.Zn}freeze(){this.Jub=!0}iIa(){this.Jub=!1}zG(b,h){return this.YPa.ia(b,h)}UA(b){this.Zn.setValue(lf.a.fontSize,this.Sn.z3b(b));this.X0();Vh.a.G3f(this.bsd,this.Zn)}fontSize(){return this.Zn.ia(lf.a.fontSize,Vh.a.oM)}Sge(b){this.Zn.setValue(lf.a.font,b);this.gWg&&this.gWg.execute(h=>{null==h?u.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):
h.Sge(this.Zn)});this.v6&&this.v6.enabled&&(Kc.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.v6.Ojo(this.Zn,b));this.X0();Vh.a.G3f(this.bsd,this.Zn)}fcg(b){this.Zn.setValue(Bc.a.He,b);this.v6&&this.v6.enabled&&(Kc.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.v6.ipo(this.Zn,b));this.X0()}Uv(b){b=rq.a.instance.nua(Yh.a.instance.gb.kb.Oa.node,b);this.Zn.setValue(lf.a.fontColor,b);this.X0();Vh.a.G3f(this.bsd,this.Zn)}Lfa(){this.Zn.setValue(lf.a.fontColor,
sh.a.auto);this.X0()}fontColor(){return this.Zn.ia(lf.a.fontColor,sh.a.nil)}Dya(b){this.Zn.setValue(lf.a.highlight,parseInt(b,16));this.X0()}WDd(){this.Zn.setValue(lf.a.highlight,sh.a.auto);this.X0()}isBold(){return this.Zn.ia(lf.a.bold,!1)}sL(b){this.Zn.setValue(lf.a.bold,b);this.X0()}isItalic(){return this.Zn.ia(lf.a.italic,!1)}setItalic(b){this.Zn.setValue(lf.a.italic,b);this.X0()}isUnderline(){return this.Zn.ia(lf.a.underline,!1)}m5(b){this.Zn.setValue(lf.a.underline,b);this.Zn.setValue(lf.a.underlineType,
b?Vh.a.LQb:Vh.a.nV);this.X0()}underlineType(){return this.Zn.ia(lf.a.underlineType,Vh.a.nV)}aja(b){b<Vh.a.LQb||b>Vh.a.nV||(this.Zn.setValue(lf.a.underline,b!==Vh.a.nV),this.Zn.setValue(lf.a.underlineType,b),this.X0())}isSuperscript(){return this.Zn.ia(lf.a.superscript,!1)}vqa(b){this.Zn.setValue(lf.a.superscript,b);b&&this.isSuperscript()&&this.Zn.setValue(lf.a.subscript,!1);this.X0()}isSubscript(){return this.Zn.ia(lf.a.subscript,!1)}GHa(b){this.Zn.setValue(lf.a.subscript,b);b&&this.isSubscript()&&
this.Zn.setValue(lf.a.superscript,!1);this.X0()}isStrikethrough(){return this.Zn.ia(lf.a.strikethrough,!1)}Yia(b){this.Zn.setValue(lf.a.strikethrough,b);this.X0()}isDoubleStrikethrough(){return this.Zn.ia(Vi.a.zt,!1)}Mge(b){this.Zn.setValue(Vi.a.zt,b);this.X0()}$5h(){return this.Zn.ia(Vi.a.kw,null)}M6a(b,h){this.Zn.b5f();this.Zn.setValue(Vi.a.kw,b.id);this.ksb=h.Kc;this.X0()}j5(b){let h=lf.a.gL;const v=pD.a.q1d(b);switch(v){case 1:h=Bc.a.Jcc;break;case 2:h=Bc.a.Kcc}this.Zn.setValue(Bc.a.H3a,v);this.Zn.setValue(h,
b);this.X0()}language(){let b=lf.a.gL;switch(this.Zn.ia(Bc.a.H3a,0)){case 1:b=Bc.a.Jcc;break;case 2:b=Bc.a.Kcc}return this.Zn.ia(b,0)}amo(b){this.Zn.setValue(Bc.a.noProof,b);this.X0()}KHb(){return this.Zn.ia(Bc.a.noProof,!1)}qPm(){return this.Zn.hasProperty(Bc.a.noProof)}YNm(){return this.Zn.hasProperty(lf.a.gL)||this.Zn.hasProperty(Bc.a.Jcc)||this.Zn.hasProperty(Bc.a.Kcc)}X0(){if(aa.a.Xkc){var b=Yh.a.instance.gb.kb.Oa,h=b.node;if(h===this.iBa)this.iBa.gl(16,!0);else{this.iBa=h;h=this.iBa.NY();try{this.iBa.u_(b.cpBegin).Fwa=
!0}finally{h&&h.dispose()}}}}p0n(){if(aa.a.Xkc&&this.iBa){var b=0,h=this.iBa.NY();try{for(let v=this.iBa.pa.length-1;0<=v;v--){const D=this.iBa.pa.J(v);D.Fwa&&(D.Fwa=!1,b++,D.isEmpty&&this.iBa.pa.removeAt(v))}}finally{h&&h.dispose()}this.iBa=null}}A6k(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.pa.Mh(b.cpBegin);return!!b&&b.Fwa}R1e(b){if(this.Spb){this.freeze();var h=new eh.GraphTransaction(7);h.Cb(b.node);this.Spb.Uge(b);this.iIa();this.W5a();h.dispose()}}fuf(b){const h=fe.ParagraphReader.text(b.node);
return b.cpBegin&&b.cpBegin!==h.length&&!G.a.Mv(h.charCodeAt(b.cpBegin))&&Mz.a.instance.e1a(h,b.cpBegin-1)!==b.cpBegin&&$e.SelectionEditor.pkb(b)?(b=$e.SelectionEditor.w_(b,!1))?1<b.length||$e.SelectionEditor.nl(b.Oa)?b:null:null:null}}Object(n.a)(PB,"InsertionPointFormatting",null,[732]);class QB{constructor(b){this.ga=b}get pc(){return this.ga}iQk(b,h,v=null){const D=new Md.DictionaryPropertySet;D.setValue(Wc.a.JA,b);D.setValue(Wc.a.VQa,h);v&&D.Vw(v);D.CommandSource="autobulleting";this.pc.Qb(Gb.a.jD,
2,D)}numbering(b,h,v,D,P){const ca=new Md.DictionaryPropertySet;ca.setValue(Wc.a.JA,b);ca.setValue(Wc.a.VQa,h);ca.setValue(Wc.a.R3a,v);P&&ca.setValue(Hh.a.pQ,P);D&&ca.setValue(Bc.a.ov,D);qn.a.dY&&(ca.setValue(Hh.a.cpa,"autocorrect"),P&&ca.setValue(Hh.a.Fha,P));ca.CommandSource="autonumbering";return 32===this.pc.Qb(Gb.a.wL,2,ca)}}Object(n.a)(QB,"ListCommands",null,[731]);var gy=c(292);class Dm extends gy.a{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub){super();this.vYb=this.sm=this.PJa=null;this.kJn=(cc,
Ac)=>{Ac=this.Ssa.Hae(this.PJa,Ac);cc.hi(this.DJl);return Ac};this.DJl=(cc,Ac)=>{if(this.sm.moveNext())return cc=this.sm.currentNode,12!==cc.type||cc===this.PJa.node?!0:this.Ssa.u2c(cc,Ac);this.zPk();cc.hi(this.FJl);return!0};this.FJl=(cc,Ac)=>{if(this.sm.moveNext()){const Lc=this.sm.currentNode;return 12!==Lc.type?!0:Lc===this.PJa.node?(cc.hi(this.lJn),!0):this.Ssa.u2c(Lc,Ac)}return!1};this.lJn=(cc,Ac)=>{this.Ssa.Iae(this.PJa,Ac);return!1};this.init(b);this.Jl(Ub);this.ejb(Ra,h,D,P,ca);this.GL=ca;
this._context=v;this.hb=mb;this.Ie=Jb;this.Ssa=ta;this.cA=0}run(){this.n7e();this.cA||this.Xqo();1===this.cA&&this.rKn();2===this.cA&&this.eJo();3===this.cA&&this.aFl()}n7e(){this.hb.gb&&this.hb.gb.kb?1===this.behavior&&(this.Ssa.n7e(this._context)?this.pr=32:this.pr=2,this.cA=3):(u.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.pr=2,this.cA=3)}Xqo(){this.cPk();this.Ssa.Icg(this.PJa)?(this.vOk(),this.cA=1):(this.pr=8,this.cA=3)}rKn(){this.vC||new Eu.a(this,this.kJn,this.GL);
do if(this.vC.run(),this.vC.inProgress&&!this.Gh)return;while(this.vC.inProgress);this.SDd();this.cA=2}eJo(){this.Ssa.Hig(this)?this.pr=32:this.pr=8;this.cA=3}aFl(){this.tqa()}cPk(){let b=this.hb.gb.kb;if(b=this.Ie.Cj(b,!0,!1))this.PJa=b.Oa;this.PJa&&this.PJa.node&&(this.vYb=this.Ssa.$ei(this.PJa.node))}vOk(){if(!this.vYb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Rl.a;b.set(this.PJa.node);b.zb(this.vYb.type);this.sm=sq.a.Rs(b,this.vYb);this.sm.mo(Object(z.a)(this.Ssa,
this.Ssa.wkc,"spellErrorFilter"),null)}zPk(){if(!this.vYb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Rl.a;b.set(this.vYb);this.sm=sq.a.fq(b);this.sm.mo(Object(z.a)(this.Ssa,this.Ssa.wkc,"spellErrorFilter"),null)}}Object(n.a)(Dm,"ProofingWholeDocumentOperation",gy.a,[]);var Nz=c(275);class RB extends en{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(n.a)(RB,"ContextMenuRootProperties",en,[]);var SB=c(1366);class GA{constructor(b){const h=new RB;
h.ImageSideArrow=w.AFrameworkApplication.Ws;h.ImageSideArrowClass=Xc.getImageClass("SubmenuFlyoutArrow_13x13x32");h.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;h.CommandMenuOpen=Gb.a.cae.toString();this.Oih=new SB.ContextMenuRoot("ContextMenuRootName",h);b.execute(v=>{this.l1.xF=v});this.l1.refresh();w.AFrameworkApplication.va.qa(Wa.a.showContextMenu,ud.a.frame,Oc.ActionManager.Nf);w.AFrameworkApplication.va.qa(Wa.a.Zjc,ud.a.frame,Oc.ActionManager.Nf)}get l1(){return this.Oih}dispose(){this.l1&&
(this.l1.dispose(),this.Oih=null)}showContextMenu(b,h){this.Zob(b,h.clientPoint,h.lg)}U3b(b,h,v,D,P){this.l1.U3b(b,h,v,D,P)}R6a(b,h,v){Dd.a.w4d(this.l1.VYa?"ShowLegacyContextMenuAndFloatie":"ShowLegacyContextMenu","");Xa.App.xa.wIl();this.ou();this.l1.R6a(b,h,v);this.l1.VYa?w.AFrameworkApplication.va.processAction(Wa.a.Zjc,2):w.AFrameworkApplication.va.processAction(Wa.a.showContextMenu,2)}Zob(b,h,v){this.R6a(b,new Sys.UI.Bounds(h.x,h.y,0,0),v)}ou(){this.l1.root.xm()}C3(){return this.l1.C3()}Zjc(b,
h,v,D){const P=this.l1;let ca=!1;v=Object(Na.a)(Jv,v);P.VYa=v;D.Hya(b,h);P.RYe?v&&(v.JFn(P,h),ca=!0):(u.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",D.ihl()),P.VYa=null);return ca}}Object(n.a)(GA,"AContextMenuController",null,[764,10]);class hv{}hv.Igc="faProofing";hv.hVh="EditorMenuSection";Object(n.a)(hv,"ContextMenuControlId",null,[]);var Wn=c(524);class Ku{constructor(b){this.Ie=b}n7e(b){b=Object(Na.a)(Wn.a,b);return!!b&&!!b.view&&b.view.te}Icg(){return!0}Hae(){return!0}u2c(){return!0}Iae(){}Hig(){return!0}wkc(b){if(b.Sr)return!0;
b=b.role;return 1===b||2===b||3===b||4===b||5===b}$ei(b){if(!b||!this.Ie)return b;const h=new Rl.a;h.set(b);if(this.Ie.ru(h)){for(;!h.Sr;)h.wc();return h.currentNode}return b}}Object(n.a)(Ku,"SimpleProofingWholeDocumentCallBacks",null,[522]);class oj{constructor(b){this.value=b}}Object(n.a)(oj,"RefBool",null,[]);class iv{constructor(){this.wLc=this.gKb=null;this.aEj=new oj(!1)}}Object(n.a)(iv,"FindNextErrorOperationParam",null,[]);class Wy{constructor(){this.Priority=0;this.Context=null;this.Length=
this.StartInContext=this.Start=0;this.Metadata=Wy.Kul;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}Wy.Kul=[];Object(n.a)(Wy,"Critique",null,[]);class JC{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(n.a)(JC,
"Suggestion",null,[]);var Zl=c(594);class TB extends Sys.EventArgs{constructor(b,h,v,D,P,ca){super();this.Q5j=b;this.W7j=h;this.X7j=v;this.ose=D;this.Pz=P;this.X8a=ca}}Object(n.a)(TB,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var UB=c(334);class nt{constructor(b,h,v){this.pAe=b;this.Jn=h;this.ra=v}uJh(b){const [h,v,D]=this.Dji(b);return this.V8h(h,v,D)}gJm(b){return Nk.a.getTypeNameFor(b.content)===UB.a.getTypeName()}V8h(b,h,v){if(v&&this.gJm(v)){if(this.g1b(v.content))return null;const P=
v.content;var D=new Wy;D.ExplanationTitle=P.explanationTitle;D.Suggestions=this.Vem(v);D.CategoryTitle=P.categoryName;D.TypeId=P.typeId;D.CritiqueActions=P.critiqueActions;D.Priority=P.priority;v=this.pAe.create(D);D=P.context;v.token=D.substring(P.range.start,P.range.start+P.range.length);v.lcid=ok.a.sg(P.language).LCID;v.originalText=D;return new Zl.a(b,h,v)}return null}Vem(b){var h=b.content.suggestions;b=[];for(const v of h)h=new JC,h.Action=v.suggestionActions,h.Text=v.text,h.Description=v.description,
b.push(h);return b}g1b(b){if(!b)return!0;if(!b.M_||!b.M_.state)return!1;b=b.M_.state;return 60===b||70===b}Dji(b){const h=this.Jn.ROc(b,0),v=b.cpBegin,D=b.cpEnd,P=$e.SelectionEditor.gf(b);b=fe.ParagraphReader.text(b.node,0);for(const ca of h)if(P){if(ca.begin<=v&&ca.end>=D)return[ca.begin,ca.end,ca.intent]}else if(ca.begin<=v&&ca.end>=v&&G.a.AIh(b,ca.end,D))return[ca.begin,ca.end,ca.intent];return[null,null,null]}static BB(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",
!1)}Iwf(b,h,v){const [D,P,ca]=this.Dji(b);ca&&this.ra.raiseEvent(nt.dwh,new TB(b,D,P,h,ca,v))}Txk(b){this.ra.addHandler(nt.dwh,b)}zBl(b,h,v){b=this.Jn.qQd(b,0,0,b.characterData.length);for(let D=0;D<b.count;D++){const P=b.J(D);if(P.intent){const ca=P.intent;if(ca.content&&(0==ca.content.priority||1==ca.content.priority)&&P.begin>=h&&(!v||v(P.intent)))return this.V8h(P.begin,P.end,P.intent)}}return null}}nt.dwh="augloopProofingContextMenuActionEventKey";Object(n.a)(nt,"AugLoopProofingErrorDetailHelper",
null,[]);class gx extends Ku{constructor(b,h,v,D){super(h);this.rn=b;this.jBc=v;this.CXj=D}Hae(b,h){return!this.qKf(b.node,b.cpBegin,h)}u2c(b,h){return!this.qKf(b,0,h)}Iae(b,h){this.qKf(b.node,0,h);Object(Na.a)(iv,h)}qKf(b,h,v){v=Object(Na.a)(iv,v);if(fe.ParagraphReader.Wb(b)&&!b.vJ)if(Kl.FormattingReader.Nr(we.a.Qc(b,h)).cache.KHb)v.aEj.value=!0;else{if(nt.BB())return h=this.CXj.zBl(b,h,this.jBc),null!=h?(v.gKb=h,v.wLc=b,!0):!1;const D=this.rn.T3(b);for(let P=0;P<D.length;P++){const ca=D[P];if(ca.begin>=
h&&!ca.errorDetails.Z2a()&&(!this.jBc||this.jBc(ca.errorDetails)))return v.gKb=ca,v.wLc=b,!0}return!1}}}Object(n.a)(gx,"FindNextErrorCallbackSteps",Ku,[]);var Nm=c(302);class Pv{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id,vd){this.G0k=(xe,Ld,Qd,Zd,te)=>{Ld=this.hb.gb.kb;if(!Ld)return this.ud.Yb(qe.a.kf,{["Reason"]:me.a.noSelection}),2;Ld=this.Ie.Cj(Ld,!0,!1);return this.ga.Mf(Ld.Oa,xe,Qd,!1,Zd,te)};this.Txn=(xe,Ld,Qd)=>{if(1===Qd)return this.ga.processAction(Gb.a.j5,1);this.S$j().Ieg();return 32};
this.ADa=(xe,Ld,Qd)=>{if(1===Qd)return 32;hj.a.mark(4670);Qd=this.rn.Ana(Ld);if(this.ene(Qd))return 8;Ld=Ld.node;const Zd=this.Ic.Oc(15);let te=Qd.begin;" "===fe.ParagraphReader.text(Ld).charAt(te-1)&&te--;Zd.Cb(Ld);const Qf=this.Kd.replaceTextRange(we.a.createTextRange(Ld,0<Qd.begin?Qd.begin-1:0,Qd.end),"",!0,!1);this.hb.setSelection(Og.SelectionFactory.pe(Ld,Qf+te));Zd.dispose();Qd.errorDetails.dqb(xe);hj.a.mark(4671);return 32};this.iwa=(xe,Ld,Qd)=>{if(1===Qd)return 32;u.ULS.sendTraceTag(7660830,
324,50,"Ignore spelling error triggerred");if(nt.BB())return this.n9a.Iwf(Ld,null,Nm.b.IgnoreOnce),32;hj.a.mark(4670);Qd=this.rn.Ana(Ld);if(this.ene(Qd))return 8;Ld=Ld.node;const Zd=this.Ic.Oc(15);Zd.Cb(Ld);this.rn.Jnb(Ld,[Qd],!0);Ld.setValue(lf.a.Z9e,!0);Zd.dispose();Qd.errorDetails.dqb(xe);hj.a.mark(4671);u.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.s7m(Qd);this.FXa.Api(Qd,Ld,!0);return 32};this.P8k=(xe,Ld,Qd)=>{var Zd,te=!this.Jk.M8(Ld);this.Sm&&this.Sm.instance&&
this.Sm.instance.pU(Ld)&&(te=!1);if(1===Qd||!te)return te?32:8;this.ga.processAction(Gb.a.Oqa,2);hj.a.mark(4670);te=this.hTl(xe);if(0>te)return 8;if(nt.BB())return this.n9a.Iwf(Ld,te,Nm.b.Apply),32;Qd=this.rn.Ana(Ld);if(this.ene(Qd))return 8;Ld=Ld.node;var Qf=Qd.errorDetails.suggestions;if(!Qf)return this.ud.Yb(qe.a.hDb,{["Reason"]:"NoSuggestionsFound"}),hj.a.mark(4671),8;te=te<Qf.length?Qf[te]:null;if(!te)return this.ud.Yb(qe.a.hDb,{["Reason"]:"RequestedSuggestionIsNull"}),hj.a.mark(4671),8;(null===
(Zd=Xa.App.rd)||void 0===Zd?0:Zd.Qo)&&Xa.App.rd.Tp.VF(Ld);te=te.replace("  "," \u00a0");Zd=this.Ic.Oc(15);Zd.Cb(Ld);Qf=this.Kd.replaceTextRange(we.a.createTextRange(Ld,Qd.begin,Qd.end),te,!0,!1,Gb.a.Oqa);this.hb.setSelection(Og.SelectionFactory.pe(Ld,Qd.begin+te.length+Qf));Zd.dispose();Qd.errorDetails.dqb(xe);hj.a.mark(4671);this.d2m(Qd);return 32};this.peo=(xe,Ld)=>{Ld=this.rn.Ana(Ld);if(this.ene(Ld))return 8;Ld.errorDetails.dqb(xe);return 32};this.fEl=(xe,Ld,Qd,Zd,te)=>{if(!Ld.view.te)return 2;
const Qf=Ld.view;if(!this.hb.gb.kb)return this.ud.Yb(qe.a.kf,{["Reason"]:me.a.noSelection}),2;if(1===Qd)return 32;const Jg=new iv,Ml=new gx(this.rn,this.Ie,this.jBc,this.n9a);Ld=new Dm(null,xe,Ld,Qd,Zd,Jg,Ml,this.ga,this.hb,this.Ie,null);Ld.Gh=!0;Ld.run();if(Ld.isCompleted&&Jg.gKb){if(Ld=Og.SelectionFactory.pe(Jg.wLc,Jg.gKb.begin),Ld=Og.SelectionFactory.oz(Ld,we.a.Qc(Jg.wLc,Jg.gKb.end)),!this.Rbh.instance||!this.Rbh.instance.GHn(Jg.gKb,Ld,Qf)){this.hb.setSelection(Ld);let Fm=0;te&&(Fm=te.Kx);Qf.Aie=
!1;Qg.a.instance.Vb(new qf.a(1,1,1,()=>{this.tco(Qf,Fm,Jg.wLc,Jg.gKb)}))}}else{const Fm=new ug.StandardDialog;Fm.Ad=0;Xa.App.iN.iWc?Fm.eja(CommonUIStrings.l_DefaultDialogTitle,Jg.aEj.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(Fm.eja(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),Xa.App.iN.Dzd(()=>{Fm.zha&&(Fm.hide(),this.ga.processAction(xe,2))}))}return 32};this.cae=(xe,Ld,Qd)=>
{if(1===Qd)return 32;this.hea&&this.hea.l1&&(xe=this.hea.l1.Ovf(hv.Igc))&&!xe.iL&&(xe.f0(0),xe.menu.SK(0));return 32};this.ga=h;this.rn=b;this.S$j=v;this.Kd=D;this.Ic=P;this.hb=ca;this.Sm=ta;this.Ie=Ra;this.ejk=mb;this.Jk=Jb;this.ud=Ub;this.n9a=vd;this.hea=Object(Na.a)(GA,cc);this.tWb=Ac.GVc;this.Rbh=Lc;this.FXa=id;this.uoc=new Map;this.uoc.set(1,Gb.a.Ufg);this.uoc.set(2,Gb.a.nwf);this.uoc.set(3,Gb.a.Ugg);this.Wzc=new Map;this.Wzc.set(1,Gb.a.Vfg);this.Wzc.set(2,Gb.a.owf);this.Wzc.set(3,Gb.a.Vgg)}Tb(){const b=
this.ga,h=this.P8k,v=this.G0k;b.eb(Gb.a.d9d,sc.a.view,this.Txn,1028);b.qa(Gb.a.ADa,sc.a.Tc,this.ADa);b.qa(Gb.a.iwa,sc.a.Tc,this.iwa);b.qa(Gb.a.Npb,sc.a.Tc,h);b.qa(Gb.a.Opb,sc.a.Tc,h);b.qa(Gb.a.Ppb,sc.a.Tc,h);b.qa(Gb.a.$Pb,sc.a.Tc,h);b.qa(Gb.a.aQb,sc.a.Tc,h);b.qa(Gb.a.ADa,sc.a.view,v);b.qa(Gb.a.iwa,sc.a.view,v);b.qa(Gb.a.Npb,sc.a.view,v);b.qa(Gb.a.Opb,sc.a.view,v);b.qa(Gb.a.Ppb,sc.a.view,v);b.qa(Gb.a.$Pb,sc.a.view,v);b.qa(Gb.a.aQb,sc.a.view,v);b.Vc(Gb.a.ADa,1028);b.Vc(Gb.a.iwa,1028);b.Vc(Gb.a.Npb,
1028);b.Vc(Gb.a.Opb,1028);b.Vc(Gb.a.Ppb,1028);b.Vc(Gb.a.$Pb,1028);b.Vc(Gb.a.aQb,1028);b.qa(Gb.a.Oqa,ud.a.frame,Oc.ActionManager.Nf);this.tWb&&b.eb(Gb.a.cae,sc.a.view,this.cae,1124);b.eb(Gb.a.b_c,sc.a.view,this.fEl,1028);b.eb(Gb.a.g1f,sc.a.Hd,this.peo,1124);this.tXn([Gb.a.Yje,Gb.a.Ufg,Gb.a.Vfg,Gb.a.BTd,Gb.a.nwf,Gb.a.owf,Gb.a.Ake,Gb.a.Ugg,Gb.a.Vgg,Gb.a.f5i,Gb.a.vQi,Gb.a.Iuj])}tXn(b){for(let h=0;h<b.length;h++)this.ga.eb(b[h],sc.a.view,Oc.ActionManager.IQ,1028)}HYn(b){this.jBc=b}ene(b){return b?b.errorDetails?
!1:(u.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.ud.Yb(qe.a.hDb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),hj.a.mark(4671),!0):(u.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.ud.Yb(qe.a.hDb,{["Reason"]:"RequestedErrorRangeNotFound"}),hj.a.mark(4671),!0)}s7m(b){b=b.errorDetails.proofingType;if(this.Wzc.has(b)){const h=this.Wzc.get(b);this.ga.processAction(h,2);u.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",
h,b)}}hTl(b){switch(b){case Gb.a.Npb:return 0;case Gb.a.Opb:return 1;case Gb.a.Ppb:return 2;case Gb.a.$Pb:return 3;case Gb.a.aQb:return 4;default:return-1}}d2m(b){b=b.errorDetails.proofingType;if(this.uoc.has(b)){const h=this.uoc.get(b);this.ga.processAction(h,2);u.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}tco(b,h,v,D){b.e5();(b=v.De(b.fc))?(D=Nz.a.Tq(b,w.AFrameworkApplication.isRtl?D.begin:D.end),this.ejk.Hya(new Sys.UI.Point(D.x,D.y+D.height),
h)):u.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(n.a)(Pv,"ProofingActor",null,[]);var jv=c(408),Hr=c(1561),Oz=c(1852),yo=c(531);class Bw{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub){this.Pkc=null;this.GGl="StyleUsageActivity";this.HGl="StylesFloodgateSurveyIsEnabled";this.ZMa=(cc,Ac,Lc,id)=>{cc=this.xem(cc);return 0>cc||cc>this.Pkc.length?2:(cc=this.Pkc[cc])?w.AFrameworkApplication.va.Mf(Ac,Gb.a.applyStyle,Lc,!0,id,cc):2};this.MLb=(cc,Ac,Lc,id,vd)=>{cc=!0;Ac.contextId!==
sc.a.paragraph&&Ac.contextId!==sc.a.Hd&&Ac.contextId!==sc.a.Tc&&(cc=!1);if(1===Lc||!cc)return cc?32:8;if(2===Lc&&!vd)return 8;Ac=this.uc.NC(Ac.node);vd.MenuItems=jv.a.C4l(Ac);return 32};this.ANn=(cc,Ac,Lc,id,vd)=>{cc=!0;Ac.contextId!==sc.a.paragraph&&(cc=!1);if(1===Lc&&!cc)return 8;Ac=Ac.node;Lc=this.uc.No(Ac);if(!Lc||!vd)return u.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",vd,Ac,Lc),8;vd.GTa.Vw(Lc.xl());return 32};this.yGk=(cc,Ac,Lc,id,vd)=>{if(Ac.contextId!==
sc.a.paragraph)return 8;if(this.Wf.n3a(Ac,!1))return this.Jc.Yb(qe.a.fn,{["Reason"]:me.a.WE}),8;if(1===Lc)return 32;const xe=Ac.node;if(fe.ParagraphReader.vua(xe)||!vd)return 8;const Ld=this.Duf(vd,xe);if(!Ld)return this.Jc.Yb(qe.a.s1,{["Reason"]:me.a.iDb}),8;if(2!==this.uc.AG(Ld))return 2;Lc=new eh.GraphTransaction(15);this.Fn&&this.Fn.isProgressiveStyleEnabled&&this.FH.ikc(vd);Lc.Cb(xe);this.tj.W5a();const Qd=[];cc!=Gb.a.clearFormatting&&Qd.push(Pd.a.UIa);this.y5.RJ(Ld,xe,!1,void 0,void 0,void 0,
ui.a.Vj?new Oz.a(Qd,!1,!0):null);(cc=this.uc.NC(xe))&&this.uc.je(Ld,cc)&&Kc.b(593078098,3017,50,"Custom linked style applied by user");xe.xr&&(cc=[Object.assign(new na.a,{name:"Source",string:"ApplyStyle"})],Xe.a("TOCFormatting",!0,void 0,cc));Lc.dispose();vd=G.a.XW(vd);id.xs=vd>>>16^vd&65535;id&&Hr.a.Qpb&&(id.zC|=Hr.a.zhb(Ac.node));return 32};this.BNn=(cc,Ac,Lc,id,vd)=>{cc=!0;Ac.contextId!==sc.a.Hd&&(cc=!1);if(1===Lc&&!cc)return 2;Ac=Kl.FormattingReader.Nr(Ac);Ac=Kl.FormattingReader.Sna(Ac);if(!Ac)return 2;
if(!vd)return 8;vd.GTa.Vw(Ac.xl());return 32};this.zGk=(cc,Ac,Lc,id,vd)=>{if(Ac.contextId!==sc.a.Hd)return 8;this.Wf.n3a(Ac);if(1===Lc)return 32;cc=Ac;ui.a.RFd&&(Ac=this.Co.FRd(cc))&&(cc=Ac);Ac=cc.node;if(!vd)return 8;const xe=this.Duf(vd,cc.node);if(!xe)return this.Jc.Yb(qe.a.s1,{["Reason"]:me.a.iDb}),8;if(1!==this.uc.AG(xe))return 2;Lc=this.uc.NC(Ac);if(!Lc)return this.Jc.Yb(qe.a.s1,{["Reason"]:me.a.gZh}),8;if(!Lc.Di(this.uc.kg(xe)))return this.Jc.Yb(qe.a.s1,{["Reason"]:me.a.iDb}),8;const Ld=new eh.GraphTransaction(7);
try{if(this.Fn&&this.Fn.isProgressiveStyleEnabled&&this.FH.ikc(vd),Ld.Cb(Ac),this.y5.vng(Ac,Lc),this.Sqa.YZ(cc,Qd=>{this.Sn.Kfa(Qd);this.Sn.M6a(Qd,xe)}),Ac.xr){const Qd=[Object.assign(new na.a,{name:"Source",string:"ApplyStyle"})];Xe.a("TOCFormatting",!0,void 0,Qd)}}finally{Ld&&Ld.dispose()}Lc&&this.uc.je(xe,Lc)&&Kc.b(593078097,3017,50,"Custom linked style applied by user");vd=G.a.XW(vd);id.xs=vd>>>16^vd&65535;id&&Hr.a.Qpb&&(id.zC|=Hr.a.zhb(cc.node));return 32};this.zNn=(cc,Ac,Lc,id,vd)=>{cc=!0;Ac.contextId!==
sc.a.Tc&&(cc=!1);if(1===Lc&&!cc)return 2;Ac=this.y5.Dem(Ac);if(!Ac)return 2;if(!vd)return 8;vd.GTa.Vw(Ac.xl());return 32};this.xGk=(cc,Ac,Lc,id,vd)=>{if(Ac.contextId!==sc.a.Tc)return 8;if(this.Wf.n3a(Ac,!1))return this.Jc.Yb(qe.a.fn,{["Reason"]:me.a.WE}),8;if(1===Lc)return 32;var xe=Ac.node;if(!vd)return 8;Lc=this.Duf(vd,Ac.node);if(!Lc)return this.Jc.Yb(qe.a.s1,{["Reason"]:me.a.iDb}),8;const Ld=this.uc.AG(Lc);if(1!==Ld&&2!==Ld)return 2;(Ac=this.tj.fuf(Ac))?(Ac=Yh.a.ABb(Ac),cc=w.AFrameworkApplication.va.Mf(Ac,
cc,2,!1,id,vd)):(cc=new eh.GraphTransaction(7),this.Fn&&this.Fn.isProgressiveStyleEnabled&&this.FH.ikc(vd),cc.Cb(xe),this.y5.Hoo(Lc,xe),cc.dispose(),cc=32);xe.xr&&(Ac=[Object.assign(new na.a,{name:"Source",string:"ApplyStyle"})],Xe.a("TOCFormatting",!0,void 0,Ac));(xe=this.uc.NC(xe))&&this.uc.je(Lc,xe)&&Kc.b(593078096,3017,50,"Custom linked style applied by user");vd=G.a.XW(vd);id.xs=vd>>>16^vd&65535;return cc};this.CNn=(cc,Ac,Lc,id,vd)=>{const xe=this.dcd.Ipa(cc,Ac,Lc,id,vd,null,0);return 2!==xe?
xe:this.dcd.Ipa(cc,Ac,Lc,id,vd,null,12)};this.AGk=(cc,Ac,Lc,id,vd)=>{var xe;const Ld={};Ld[this.dcd.XIa]=6168;Ld[this.dcd.WIa]=6169;let Qd=12;if(!Ac.view.te)return 2;var Zd=Ac.view.lb,te=Zd?Zd.tg:null;if(!te)return this.Jc.Yb(qe.a.kf,{["Reason"]:me.a.noSelection}),8;if(this.Xg.cDa(oe.ImageReader.B2a,te))return this.Jc.Yb(qe.a.kf,{["Reason"]:me.a.GHc}),8;if(this.Xg.sza(fe.ParagraphReader.kU,te))return this.Jc.Yb(qe.a.kf,{["Reason"]:me.a.hO}),8;if(this.Wf.tac(te,!1))return this.Jc.Yb(qe.a.kf,{["Reason"]:me.a.WE}),
8;te=this.uc.Qr();if(vd&&te){const Qf=te.Di(vd);if(Qf){(null===(xe=w.AFrameworkApplication.K)||void 0===xe?0:xe.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&yo.a.instance.M5a("Style");xe=this.uc.Lva(Qf,te);let Jg=this.uc.AG(Qf);xe&&(Zd=Zd.gb.J(0),Zd.Cx&&Zd.Oa.contextId===sc.a.Hd||2===Zd.length&&Zd.Oa.contextId===sc.a.Hd&&Zd.Pc.contextId===sc.a.endOfParagraph)&&(Jg=1,vd=xe.getValue(Vi.a.ka));1===Jg?Qd=0:3===Jg&&(Qd=14);!this.uc.je(Qf,te)&&this.uc.Fd(Qf)&&(Zd=this.uc.kg(Qf),
Kc.b(562317522,3017,50,String.format("{0}: style applied by user",Zd)));this.Wqa(this.GGl,this.HGl)}}return this.dcd.Ipa(cc,Ac,Lc,id,vd,Ld,Qd)};this.Vu=h;this.Ce=v;this.xN=D;this.Yz=P;this.Jk=ca;this.ud=ta;this.wW=Ra;this.hpk=mb;this.we=Jb;this.Co=Ub}get Fn(){return null!=this.tHg?this.tHg:this.tHg=Ea.a.instance.Na("Box4.Styles.StyleSettings")}get y5(){return this.Vu}get Xg(){return this.xN}get tj(){return this.Yz}get Sn(){return this.Ce}get Wf(){return this.Jk}get Jc(){return this.ud}get Sqa(){return this.wW}get dcd(){return this.hpk}get uc(){return this.we}Tb(){const b=
w.AFrameworkApplication.va,h=Xa.App.WTa.oLh(12);b.qa(Gb.a.applyStyle,sc.a.Hd,this.zGk);b.qa(Gb.a.VGa,sc.a.Hd,this.BNn);b.qa(Gb.a.applyStyle,sc.a.Tc,this.xGk);b.qa(Gb.a.VGa,sc.a.Tc,this.zNn);b.qa(Gb.a.applyStyle,sc.a.paragraph,this.yGk);b.qa(Gb.a.applyStyle,sc.a.view,this.AGk);b.Vc(Gb.a.applyStyle,1036);b.qa(Gb.a.VGa,sc.a.view,this.CNn);b.qa(Gb.a.VGa,sc.a.paragraph,this.ANn);b.Vc(Gb.a.VGa,99);b.qa(Gb.a.MLb,sc.a.view,h);b.qa(Gb.a.MLb,sc.a.paragraph,this.MLb);b.Vc(Gb.a.MLb,1127);b.eb(Gb.a.b2e,sc.a.view,
this.ZMa,4);b.eb(Gb.a.c2e,sc.a.view,this.ZMa,4);b.eb(Gb.a.d2e,sc.a.view,this.ZMa,4);b.eb(Gb.a.e2e,sc.a.view,this.ZMa,4);b.eb(Gb.a.f2e,sc.a.view,this.ZMa,4);b.eb(Gb.a.g2e,sc.a.view,this.ZMa,4);b.eb(Gb.a.h2e,sc.a.view,this.ZMa,4);b.eb(Gb.a.Auh,sc.a.view,this.ZMa,4);b.eb(Gb.a.Buh,sc.a.view,this.ZMa,4);b.eb(Gb.a.Cuh,sc.a.view,this.ZMa,4);this.Pkc=Array(10);fk.StyleReader.Knj(this.Pkc)}xem(b){switch(b){case Gb.a.b2e:return 0;case Gb.a.c2e:return 1;case Gb.a.d2e:return 2;case Gb.a.e2e:return 3;case Gb.a.f2e:return 4;
case Gb.a.g2e:return 5;case Gb.a.h2e:return 6;case Gb.a.Auh:return 7;case Gb.a.Buh:return 8;case Gb.a.Cuh:return 9;default:return-1}}Wqa(b,h){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const v=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");v&&v.execute(D=>{D.logActivity(b,h)})},Bw.zDa)}Duf(b,h){if(b&&h&&fe.ParagraphReader.Wb(h))h=this.uc.NC(h);else return null;return h.Di(b)}get FH(){return null!=this.eAg?this.eAg:this.eAg=Ea.a.instance.resolve("Box4.IFontStylesGalleryCache")}}
Bw.zDa=5E3;Object(n.a)(Bw,"StyleActor",null,[]);var wq=c(1974);class bq{constructor(b){this.ga=b}get pc(){return this.ga}Uge(b,h=!1){this.pc.Mf(b,Gb.a.YPa,2,!0,null,h)}j5(b){this.pc.Qb(Gb.a.j5,2,b)}}Object(n.a)(bq,"TextFormattingCommands",null,[730]);class yi{constructor(b,h,v,D){this.bWe=this.vjh=!1;this.MMo=(P,ca,ta)=>{if(2!==ta)return 2;this.vjh||(this.vjh=!0);w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");
return 32};this.yJn=(P,ca,ta,Ra,mb)=>{if(2!==ta)return 2;this.B4i(mb,!0);return 32};this.xJn=(P,ca,ta,Ra,mb)=>{if(2!==ta)return 2;this.B4i(mb,!1);return 32};this.sKn=(P,ca,ta)=>{if(2!==ta)return 2;if(!this.jab)return 8;this.jab.ptm();return 32};this.rJn=(P,ca,ta)=>{if(2!==ta)return 2;if(!this.jab)return 8;this.jab.q8n();return 32};this.upa=(P,ca)=>{3===ca.Kx&&$e.SelectionEditor.Sl(ca.ol.kb)&&(Xe.c(Gb.a.HMo),w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordExtendPageHeightInTouchSettings"),
this.bWe=!0)};this.ga=b;this.Fa=h;this.jab=v;this.hb=D}get LMo(){return this.bWe}Tb(){var b;this.ga.eb(Wa.a.yP,sc.a.view,this.MMo,4);this.ga&&this.Fa&&(this.Fa.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.eb(Gb.a.tkg,sc.a.view,this.yJn,4),this.ga.eb(Gb.a.vkg,sc.a.view,this.xJn,4)),this.ga.eb(Wa.a.Hvj,sc.a.application,this.sKn,4),this.ga.eb(Wa.a.Whf,sc.a.application,this.rJn,4),Fo.EventHandlerManager.instance.NXn(()=>{this.kwn()}));(null===(b=Xa.App.xa.ib.rc)||void 0===b?0:b.te)&&Xa.App.xa.ib.rc.Pla(()=>
{this.xco()});this.hb&&this.hb.Pw(this.upa)}WPn(){Xe.c(Gb.a.KMo);this.bWe=!0}xco(){const b=window.performance.now();yi.SIe&&250>b-yi.SIe&&1E3<b-yi.y4g&&(Xe.c(Gb.a.JMo),yi.y4g=b);this.jab&&yi.Xb&&yi.Xb.GB(116)&&this.jab.showFloatie()}TFm(b,h){if(h){var v=null;aa.a.UJ&&b&&(v=b.getSelection());b=null;v&&"Caret"===v.type&&(b=v.getRangeAt(0))&&this.jab&&this.jab.VWo(b.getBoundingClientRect(),h)}}kwn(){yi.SIe=window.performance.now()}B4i(b,h){if(b)for(b=b.firstChild;b;){if("SPAN"===b.tagName&&b.classList.contains(yi.vwm)){for(b=
b.firstChild;b;)this.XAk(b,h),b=b.nextSibling;break}b=b.nextSibling}}XAk(b,h){if(b.classList.contains(yi.Upi)){const v="WACImageResizeHandleTouch"+this.yZl(b);h?b.classList.add(yi.Vpi,v):b.classList.remove(yi.Vpi,v)}}yZl(b){for(const h of b.className.split(" "))if(h.startsWith("WACImageResizeHandle")&&h!==yi.Upi)return G.a.substring(h,20,h.length);return""}static get Xb(){return null!=yi.$yg?yi.$yg:yi.$yg=Ea.a.instance.Na("Box4.IFeatureHelper")}}yi.Upi="WACImageResizeHandles";yi.Vpi="WACImageResizeHandlesTouch";
yi.vwm="WACImgSelection";yi.SIe=0;yi.y4g=0;Object(n.a)(yi,"TouchInputActor",null,[729]);class uu{get XIa(){return Ds.a.XIa}get WIa(){return Ds.a.WIa}get rnc(){return Ds.a.rnc}Ipa(b,h,v,D,P,ca,ta){return Ds.a.Ipa(b,h,v,D,P,ca,ta)}fgc(b,h,v,D,P,ca){return Ds.a.fgc(b,h,v,D,P,ca)}static get instance(){uu._instance||(uu._instance=new uu);return uu._instance}}uu._instance=null;Object(n.a)(uu,"ViewActionHandlerProxy",null,[728]);class to{constructor(b,h){this.kpiName="VisiMarkersUsage";this.h8="wwaengidc";
this.Hkb=new Map;this.tzo=(v,D,P,ca,ta)=>{if(1===P)return 32;if(!ta)return 2;this.Hkb.set("Source",Zb.a[this.ga.X_]);this.FXe.QWc?this.Hkb.set("Action","Removed"):this.Hkb.set("Action","Applied");va.Health.instance.recordKpiUsage(this.kpiName,1,this.h8,this.Hkb);v=document.getElementsByTagName("head")[0];if(!this.FXe.cMo(v))return u.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;Xa.App.xa.WG({ShowVisiMarkers:"ToggleButtonModel"});return 32};this.SMn=(v,D,P,ca,ta)=>{if(1===
P)return 32;ta[If.a.On]=this.FXe.QWc;return 32};this.ga=b;this.FXe=h}Tb(){this.ga.eb(Gb.a.xje,sc.a.application,this.tzo,1);this.ga.eb(Gb.a.Z5i,sc.a.application,this.SMn,96)}}Object(n.a)(to,"VisiMarkersActor",null,[]);var Tx=c(109);class VB{constructor(b,h,v,D,P){this.Un=b;this.ukn=h;this.nj=v;this.Ld=D;this.characterPropertiesEditor=P}get FSi(){return this.ukn.value}execute(b,h,v,D){const P=bf.a.instance.yp(Gb.a.plo);ig.OutlineElementReader.isEmpty(b,!1)?this.Uyl(b):this.Vyl(b,h,v,D);P.end()}Uyl(b){this.FSi.j6e(b,
-1)?this.FSi.eSa(b,-1,0):this.Un.fHa(b,{laj:!0})}Vyl(b,h,v,D){h=D(b,h,v);b=fe.ParagraphReader.Vk(b.currentNode);!this.Un.uPb&&this.YUm(b)&&this.Bwk(h);this.Un.k$();(null===b||void 0===b?0:b.pa)&&!b.pa.last.formatting&&this.characterPropertiesEditor.j0a(b)}YUm(b){return b.Ii&&!b.Ez.hasProperty(Bc.a.listID)}Bwk(b){hf.OutlineElementNavigator.Ge(b);b=b.currentNode;const h=new Tx.a;b.Kc.Pu(h);this.nj.aV(b,h,this.Ld.rg)}}Object(n.a)(VB,"ListNewLineStrategy",null,[]);var Vs=c(865),xr=c(469);class zv{xc(b){b.ha("Box4.Actors.Box4PasteStewardFactory",
()=>new Cm(kt.a.dFb,b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").singleInstance();b.ha("Box4.Actors.Box4PasteStewardUtils",()=>new Ly(w.AFrameworkApplication.K.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").singleInstance();b.ha("Box4.Actors.ClipboardActor",()=>new Bz.ClipboardActor(b.Ue("Box4.Actors.IClipboardOperationFactory"),b.resolve("Box4.Actors.ISystemClipboard"),
bf.a.instance,b.resolve("Box4.IClipboardDataHelper"),Yh.a.instance,w.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),w.AFrameworkApplication.K,bd.FocusManager.instance(),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),w.AFrameworkApplication.eeg(),w.AFrameworkApplication.Irj(),b.resolve("Box4.Actors.PasteFloatiePositionProvider"),Ea.a.instance.resolve("Common.IReactContextualUILauncher"),
!!Xa.App.instance&&Xa.App.instance.yha)).singleInstance();b.ha("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new hm(w.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Clipboard.ISystemClipboardAccessManagerFactory",()=>new Aw(w.AFrameworkApplication.K,b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Box4.IClipboardDataHelper"),Gv.a.instance)).singleInstance();b.ha("Box4.Clipboard.ISystemClipboardAccessManager",()=>b.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).singleInstance();
b.ha("Box4.Actors.ISystemClipboard",()=>new Vy(b.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),Pb.InteractiveViewManager.instance,Xa.App.xa.ib,bd.FocusManager.instance(),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),Gv.a.instance,w.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IDeleteTableSegmentStrategy",()=>new IC).singleInstance();b.ha("Box4.ISelectionFactory",()=>new yn.a).singleInstance();b.ha("Box4.IRenderOrderGraphIteratorFactory",()=>
new Ss).singleInstance();b.ha("Common.IDomElementContentStateFactory",()=>new ww).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",()=>new Mv(Yh.a.instance,b.resolve("Box4.IParagraphReader"),b.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();b.ha("Box4.Actors.PastedContentsPostProcessorHelper",()=>new MB).singleInstance();b.ha("Box4.Actors.PasteFloatiePositionProvider",()=>new Gr(Yh.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Pb.InteractiveViewManager.instance,
Dd.a.getElementBounds,b.resolve("Box4.UI.PasteFloatieManager"),!!Xa.App.instance&&Xa.App.instance.yha)).singleInstance();b.ha("Box4.Actors.PasteFloatieFeatureSetBuilder",()=>new Ng(b.resolve("Box4.IClipboardDataHelper"),Xa.App.Ev.NI)).singleInstance();b.ha("Box4.Actors.PasteFloatieEventManager",()=>new Uy(b.resolve("Box4.UI.PasteFloatieManager"),b.resolve("Box4.IPasteFloatieEventSource"),Pb.InteractiveViewManager.instance,Hz.a.instance(),w.AFrameworkApplication.ta,b.resolve("Box4.Actors.PasteFloatiePositionProvider"),
b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Xa.App.Xj.zl.Ze(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),!!Xa.App.instance&&Xa.App.instance.yha)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteFactory",()=>new vA(bf.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.PasteCoordinator"),uq.a.instance,Yh.a.instance,w.AFrameworkApplication.va,
b.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),b.Ue("Box4.IUndoManager"),b.resolve("Common.IDomElementContentStateFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();b.ha("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new qw(w.AFrameworkApplication.va,bf.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.IOutlineElementEditor"),Yh.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),
b.resolve("Box4.IParagraphReader"),jp.a.instance,b.resolve("Box4.IOutlineElementNavigator"),b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("Box4.IOutlineElementReader"),b.resolve("Box4.IRenderOrderGraphIteratorFactory"),b.resolve("Box4.ISelectionFactory"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.IClipboardDataHelper"),b.Na("Box4.IFeatureHelper"))).singleInstance();b.ha("Box4.Actors.IClipboardOperationClipboardAccessHelper",()=>new Xx(bf.a.instance,Gv.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),
b.resolve("Common.ISimpleOperationFactory"),w.AFrameworkApplication.K.appSettings.ChromeClipboardAccessOperationTimeout)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteStrategyFactory",()=>new mh(w.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IClipboardOperationFactory",()=>new Dz(b.resolve("Box4.Actors.InternalClipboard"),w.AFrameworkApplication.va,w.AFrameworkApplication.aeg(),bf.a.instance,jp.a.instance,Gv.a.instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.Actors.ClipboardOperationWordStrategy"),b.resolve("Box4.ICannotCutDialog"),b.resolve("Common.ISimpleOperationFactory"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.IPasteFloatieEventSource"),
b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new yw(b.Ue("Box4.Actors.IBox4PasteStewardFactory"),b.Ue("Box4.Actors.IBox4ImageStewardFactory"),b.Ue("Box4.Actors.IBox4TableStewardFactory"),b.Ue("Box4.Actors.IBox4WordConverterFactory"),b.Ue("HtmlImport.IHtmlTranslatorSettings"),b.Na("Box4.IContentControlCopyPasteHelper"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.IExternalPasteCssConverter"),b.resolve("HtmlImport.IHtmlNormalizerSettings"),
b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Actors.IHtmlNormalizerHelper"),b.resolve("Box4.IFieldCopyPasteHelper"))).singleInstance();b.ha("Box4.Actors.InternalClipboard",()=>new Bs.a(b.resolve("Box4.Images.IImageEditor"),b.Ue("Box4.ITableEditor"),b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.List.IListEditor"),Xa.App.Xj,b.resolve("Box4.IParagraphIndentationReader"),w.AFrameworkApplication.K,b.resolve("Box4.Graph.IGraphNodeFactory"),
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.Na("Box4.IContentControlCopyPasteHelper"),b.resolve("Box4.ITableCellReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IConstantsProvider").Ojj,b.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();b.ha("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new LB(b.resolve("Box4.Actors.InternalClipboard"),b.Na("Box4.IContentControlCopyPasteHelper"),new Gg.a(()=>Xa.App.xa.ib.rc),b.resolve("Box4.IFormattingPropertyTransitStrategy"),
b.resolve("Box4.IFieldCopyPasteHelper"))).singleInstance();b.ha("Box4.List.IListCommands",()=>new QB(w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.List.ListNewLineStrategy",()=>new VB(b.resolve("Box4.List.IListEditor"),b.Ue("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.ICharacterPropertiesEditor"))).singleInstance();b.ha("Box4.Actors.PasteCoordinator",
()=>new Vn(b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),b.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),qi.a.instance)).singleInstance();b.ha("Box4.Actors.Box4ImageStewardFactory",()=>new ft(b.resolve("Box4.Images.IImageEditor"),w.AFrameworkApplication.nc,b.resolve("Box4.IUndoManager"),b.Na("Box4.Actors.IImageStewardBridge"),Xa.App.xa.notificationBar,b.Na("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").singleInstance();
b.ha("Box4.Actors.Box4TableStewardFactory",()=>new yA(Ea.a.instance.resolve("Box4.List.IListEditor"),Ea.a.instance.resolve("Box4.ITableEditor"),b.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),b.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").singleInstance();b.ha("Box4.Actors.ClipboardOperationWordStrategy",()=>new Np(bf.a.instance,Yh.a.instance,Xa.App.rd,qi.a.instance)).singleInstance();b.ha("Box4.Actors.Box4WordConverterFactory",
()=>new Bv(w.AFrameworkApplication.K)).as("Box4.Actors.IBox4WordConverterFactory").singleInstance();b.ha("Box4.Actors.IExternalPasteCssConverter",()=>new Ro(w.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IHtmlNormalizerHelper",()=>new fy).singleInstance();b.ha("Box4.ISelectionCommands",()=>new Yl(w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.ITextFormattingCommands",()=>new bq(w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.Actors.AccessibilityActor",()=>new GB(b.Sa("Box4.Accessibility.IAccessibilityContextManager"),
b.resolve("Box4.Proofing.IErrorRangeEditor"))).singleInstance();b.ha("Box4.Actors.InsertionPointFormatting",()=>new PB(b.Na("Box4.IFontSlotProvider"),b.Sa("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").singleInstance();b.ha("Box4.UI.PasteFloatieManager",()=>new vq).as("Box4.UI.IFloatieManager").singleInstance();b.ha("Box4.Actors.ProofingActor",()=>new Pv(Ea.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),w.AFrameworkApplication.va,()=>Ea.a.instance.resolve("Box4.UI.ILanguageDialog"),
Ea.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ea.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Yh.a.instance,Ea.a.instance.Sa("Box4.IExternalSelectionManager"),jp.a.instance,Ea.a.instance.resolve("Box4.ISelectionContextMenuProvider"),qi.a.instance,bf.a.instance,Ea.a.instance.resolve("Box4.IContextMenuController"),Ea.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Ea.a.instance.Sa("Box4.Actors.IProofingErrorPresenter"),Ea.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),
Ea.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();b.ha("Box4.Actors.StyleActor",()=>new Bw(Ea.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ea.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Ea.a.instance.resolve("Box4.IFormattingEditor"),em.ContextSetEditor.instance,Ea.a.instance.resolve("Box4.IInsertionPointFormatting"),qi.a.instance,bf.a.instance,Ea.a.instance.resolve("Box4.TextFormattingHelper"),uu.instance,Ea.a.instance.resolve("Box4.Styles.IWACStyleReader"),
Ea.a.instance.resolve("Box4.IContentControlChpHelper"))).singleInstance();b.ha("Box4.Actors.StyleContextMenuActor",()=>new cx(Ea.a.instance.resolve("Box4.IUpdateStyleManager"),Ea.a.instance.resolve("Box4.Styles.IWACStyleReader"),w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.Actors.TextFormattingActor",()=>new wq.a(b.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),b.resolve("Box4.IBox4GraphWriter"),b.Na("Box4.IFontSlotProvider"),b.Na("Box4.IContentControlChpHelper"),
Ea.a.instance.resolve("Box4.IFormattingEditor"),Ea.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ea.a.instance.resolve("Box4.IParagraphEditor"),Ea.a.instance.resolve("Box4.ILineSpacingHelper"),Ea.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ea.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Ea.a.instance.resolve("Box4.IOutlineElementEditor"),Ea.a.instance.resolve("Box4.List.IListFormattingEditor"),Ea.a.instance.resolve("Box4.IParagraphIndentationReader"))).singleInstance();b.ha("Box4.Actors.AutoCorrectActor",
()=>new Qq(w.AFrameworkApplication.va,bf.a.instance,()=>Ea.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).singleInstance();b.ha("Box4.Actors.TouchInputActor",()=>new yi(w.AFrameworkApplication.va,w.AFrameworkApplication.K,Fn.GrippersManager.instance,Yh.a.instance)).as("Box4.ITouchInputActor").singleInstance();b.register(Ts,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").singleInstance();b.ha("Box4.Actors.VisiMarkersActor",()=>new to(w.AFrameworkApplication.va,b.resolve("Box4.IVisiMarkersOperation"))).singleInstance();
b.ha("Box4.Actors.IndentationActorExtension",()=>new gv).as("Box4.Actors.IIndentationActorExtension").singleInstance();Vs.a.oVc&&b.ha("Box4.Actors.PageColorActor",()=>new Vs.a(xr.a.instance,new Gg.a(()=>Xa.App.xa.ib.rc.Yc),rq.a.instance,Nh.a.instance,Ea.a.instance.Na("Box4.UI.RecentColorsSectionHandler"))).singleInstance()}}Object(n.a)(zv,"Box4ActorsComponentConfiguration",null,[2]);var sA=c(220),Qv=c(1084);const Av=()=>{const b=Pr;w.AFrameworkApplication.va.qa(Gb.a.Cgf,sc.a.embeddedFile,b);w.AFrameworkApplication.va.qa(Gb.a.Cgf,
sc.a.N6b,b);w.AFrameworkApplication.va.qa(Gb.a.Bgf,sc.a.embeddedFile,KC);w.AFrameworkApplication.va.qa(Gb.a.Bgf,sc.a.N6b,KC)},Pr=(b,h,v)=>Xa.App.cJd?8:2===v?(b=new ug.StandardDialog,b.Ad=4,b.$U(1),b.Ee(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.Ee(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.Teg(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,Ux),32):2,Ux=b=>{1===b&&w.AFrameworkApplication.va.processAction(Gb.a.Bgf,2)},
KC=(b,h,v)=>{if(Xa.App.cJd)return 8;if(1===v)return h.node.hasProperty(lf.a.embeddedFileContainer)?32:2;if(2===v&&(h.contextId===sc.a.view&&h.view.lb&&(h=h.view.lb.tg),sA.isEmbeddedFileOrFloatingEmbeddedFileContext(h))){b=Qv.a.pXl(h.node);$b.a.Xpo();try{hy(b)}catch(D){u.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",D)}}return 32},hy=b=>{Dd.a.om(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};var vu=c(770),Xy=c(944),HA=c(985);class Zr{constructor(b){this.MAa=this.FV=null;this.eia=
(h,v,D,P,ca)=>{if(1===D)return 32;w.AFrameworkApplication.va.Qb(Gb.a.t5a,2,ca);h=ca&&0<=ca.fontColor&&16777215>=ca.fontColor?ca.fontColor:0;Xa.App.xa.dismissFloatie();(new Xy.a(Zr.dHc,Gb.a.sqa)).Xjc(h);return 32};this.LLb=(h,v,D,P,ca)=>{if(1===D)return 32;if(2===D&&!ca)return 8;h=Zr.oi.nRd(v);v=new vu.a;D=null;32===w.AFrameworkApplication.va.Qb(Gb.a.t5a,2,v)&&v&&(D=v.fontColor);P="";D&&!v.R6b&&(P=sh.a.YE(D)||"");this.v1h.$Nb=P;this.OVc&&this.recentColors.uoe(P);h=this.v1h.aNc(h,Xa.App.TAb);if(!h)return 8;
ca.MenuItems=h;u.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.uKe=b}get v1h(){this.FV||(this.FV=new HA.a(Zr.dHc),this.$Ea(this.FV));return this.FV}$Ea(b){b.LW(1,Gb.a.Lfa);b.LW(3,Gb.a.Uv);b.LW(4,Gb.a.Uv);b.LW(5,Gb.a.sqa);b.LW(6,Gb.a.eia);b.ozb(this.uKe,1)}Tb(){const b=w.AFrameworkApplication.va;b.qa(Gb.a.eia,sc.a.view,this.eia);b.qa(Gb.a.LLb,sc.a.view,this.LLb);b.Vc(Gb.a.LLb,1127)}static nYl(){return new Zr(xr.a.instance)}static get instance(){return null!=
Zr.aCg?Zr.aCg:Zr.aCg=Zr.nYl()}get recentColors(){return null!=this.iGg?this.iGg:this.iGg=Ea.a.instance.Na("Box4.UI.RecentColorsSectionHandler")}static get oi(){return Ih.PageReader.instance}get OVc(){null==this.MAa&&(w.AFrameworkApplication.ue("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.MAa=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.MAa}}Zr.dHc="Font";Object(n.a)(Zr,
"FontColorActor",null,[]);class Cw{constructor(b){this.eia=(h,v,D,P,ca)=>{if(1===D)return 32;w.AFrameworkApplication.va.Qb(Gb.a.t5a,2,ca);h=ca&&0<=ca.highlight&&16777215>=ca.highlight?ca.highlight:0;Xa.App.xa.dismissFloatie();(new Xy.a("Highlighter",Gb.a.P9)).Xjc(h);return 32};this.ga=b}Tb(){this.ga.qa(Gb.a.BZi,sc.a.view,this.eia)}static g_l(){return new Cw(w.AFrameworkApplication.va)}static get instance(){return null!=Cw.LCg?Cw.LCg:Cw.LCg=Cw.g_l()}}Object(n.a)(Cw,"HighlighterColorActor",null,[]);
var ns=c(372),Dp=c(86);class Rv{static get Yg(){return bg.a.vA(Rv.Km,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}Rv.Km="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(n.a)(Rv,"InsertLinkDialogHtml",null,[]);class Xn extends bg.a{constructor(b){super();this.G7d=()=>{const h=document.getElementById("txtLink");this.oqa(1,!h||!h.value.length||Re.a.x3a(h.value))};this.IAf=(h,v)=>{if(this.mh.lv){var D=this.mh.lb.gb.kb;if(D)if(D.equals(this.xx)&&0!==h){h=new eh.GraphTransaction(15);h.Cb(this.WS[0].node);for(D=0;D<this.WS.length;D++)this.WS[D].node.GH().jF.z7(4);D=v.txtLink.trim();v=this.Zjl();D=this.BCm(D);(v||D)&&Xn.Ld.Ns(7);this.hide();h.dispose()}else this.mh.z5()}};
this.WS=b;this.mh=Pb.InteractiveViewManager.instance.Bd;this.xx=this.mh.lb.gb.kb;this.Ykf=b[0].cpBegin;this.tIf=b[b.length-1].cpEnd;this.wg="InsertMultiParagraphLinkDialog";b=this.qWo();this.showDialog("",b)}showDialog(b,h){u.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.Yg=Rv.Yg;""===h.trim()&&this.Ee(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.Wh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.IAf,{["txtLink"]:h,["txtDisplay"]:b});document.getElementById("txtLink").focus();
document.getElementById("txtDisplay").disabled=!0;Xn.YDf&&(b=document.getElementById("txtLink"),Le.a.addHandler(b,Ed.a.input,this.G7d),Le.a.addHandler(b,Ed.a.change,this.G7d))}hide(){if(Xn.YDf){const b=document.getElementById("txtLink");b&&(Le.a.removeHandler(b,Ed.a.change,this.G7d),Le.a.removeHandler(b,Ed.a.input,this.G7d))}super.hide()}Wua(b){return Xn.YDf?this.yPl(this.xrc)?super.Wua(b):!1:super.Wua(b)}qWo(){let b;var h="";const v=this.WS.length,D=Re.a.zA(this.WS[0],!1);0<D.length&&({cpBegin:P,
cpEnd:b}=Xn.P_.Rga(this.WS[0],D[0]),P<=this.WS[0].cpBegin&&(h=D[0].hyperlink.url),this.Ykf=Math.min(this.Ykf,P));var P=Re.a.zA(this.WS[v-1],!1);0<P.length&&({cpBegin:P,cpEnd:b}=Xn.P_.Rga(this.WS[v-1],P[P.length-1]),this.tIf=Math.max(this.tIf,b));this.sPo(this.Ykf,this.tIf);return h}sPo(b,h){const v=this.WS.length;if(b!==this.WS[0].cpBegin||h!==this.WS[v-1].cpEnd){b=we.a.Qc(this.WS[0].node,b);b=Og.SelectionFactory.Nn(b);h=we.a.Qc(this.WS[v-1].node,h);h=Og.SelectionFactory.oz(b,h);b=this.Dii(h.Oa.clone());
const D=this.Dii(h.Pc.clone());b&&D&&(this.WS[0]=b,this.WS[v-1]=D,this.mh.lb.setSelection(h),this.xx=h)}}BCm(b){if(!b)return!1;b=Re.a.lPa(b);for(let v=0;v<this.WS.length;v++){var h=this.WS[v];if(Xn.Ita&&$e.SelectionEditor.nl(h)&&(h=$e.SelectionEditor.Tkg(h),!$e.SelectionEditor.nl(h)))continue;h=we.a.createTextRange(this.WS[v].node,h.cpBegin,h.cpEnd);this.VOo(h);Xn.hyperlinkEditor.kG(h,b,!1)}return!0}VOo(b){Dp.a.instance.J(1)&&Xn.Ld.jCj(b)}Dii(b){return fe.ParagraphReader.lm(b)&&!$e.SelectionEditor.K8(b)&&
fe.ParagraphReader.textLength(b.node)?we.a.createTextRange(b.node,0,fe.ParagraphReader.textLength(b.node)):$e.SelectionEditor.nl(b)?b:null}Zjl(){let b=!1;for(const h of this.WS){const v=Re.a.zA(h,!1);v&&(b=Xn.P_.iaj(h,v)||b)}return b}static get P_(){return null!=Xn.hBg?Xn.hBg:Xn.hBg=Ea.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Ld(){return null!=Xn.MIg?Xn.MIg:Xn.MIg=Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get hyperlinkEditor(){return null!=
Xn.ZAg?Xn.ZAg:Xn.ZAg=Ea.a.instance.resolve("Box4.IHyperlinkEditor")}static get Ita(){null==Xn.o$&&(Xn.o$=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Xn.o$}static get YDf(){null==Xn.XFe&&(Xn.XFe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return Xn.XFe}}Xn.o$=null;Xn.XFe=null;Object(n.a)(Xn,"InsertMultiParagraphLinkDialog",bg.a,[]);var IA;(function(b){b.Heading="Heading";b.Bookmark="Bookmark";
b.Url="Url";b.RecentLinks="RecentLinks"})(IA||(IA={}));Object(n.b)("InsertLinkUserActivitySource",IA);class WB{constructor(b,h,v,D,P){this.linkurl=b;this.isHeading=h;this.startCp=v;this.endCp=D;this.paragraphNode=P}}Object(n.a)(WB,"HeadingDataForLinkDialog",null,[]);class JA{constructor(b,h){this.linkurl=b;this.isHeading=h}}Object(n.a)(JA,"BookmarkDataForLinkDialog",null,[]);class XB{constructor(b,h,v,D,P,ca){this.key=b;this.name=h;this.startIndex=v;this.count=D;this.level=P;this.isCollapsed=ca}}
Object(n.a)(XB,"GroupHeaderDataForLinkDialog",null,[]);class Ht{constructor(b,h){this.selectedIndex=b;this.selectedGroupId=h}}Object(n.a)(Ht,"SelectedItemFromLinkDialogGroupedList",null,[]);class kv{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub){this.gr=b;this.xd=h;this.orl=v;this.bookmarkManager=D;this.P_=P;this.hyperlinkEditor=ca;this.characterPropertiesEditor=ta;this.Ld=Ra;this.nj=mb;this.Kk=Jb;this.vwa=Ub;this.MDb=null;this.Gwi=!1;this.IAf=(Lc,id)=>{var vd;if(this.he.lv){var xe=Re.a.NPc(this.gr),Ld=
this.he.lb.gb.kb;if(Ld){Ld=Ld.Oa;fe.ParagraphReader.lm(Ld)&&(Ld=we.a.createTextRange(Ld.node,0,fe.ParagraphReader.textLength(Ld.node)));var Qd=$e.SelectionEditor.EQb(Ld);$e.SelectionEditor.nl(Qd)&&(Ld=Qd);if(0!==Lc&&32===w.AFrameworkApplication.va.Mf(Ld,Gb.a.insertHyperlink,1,!0,null,null)&&this.gr.equals(Ld)){hj.a.mark(5562);(null===(vd=Xa.App.rd)||void 0===vd?0:vd.Qo)&&this.he.lb.i0b();Lc=new eh.GraphTransaction(15);Lc.Cb(this.gr.node);this.gr.node.GH().jF.z7(4);vd=id.txtDisplay;Ld=!1;if(null!=
id.linkurl)if(Ld=!0,id.isHeading){l(this.xd,"Heading");Qd=id.paragraphNode;const Zd=id.startCp,te=id.endCp;id=this.bookmarkManager.QOl(Qd);this.bookmarkManager.MDc(id,Zd,te,Qd,Qd,!1)}else l(this.xd,"Bookmark"),id=id.linkurl;else l(this.xd,"Url"),id=id.txtLink.trim();this.insertLink(vd,id,xe,Ld);Lc.jk=Gb.a.insertHyperlink;Lc.dispose();hj.a.mark(5563);this.gr.node.xgb()}else this.he.z5()}else u.ULS.sendTraceTag(509372371,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}};
this.he=Pb.InteractiveViewManager.instance.Bd;this.gr=b;v=$e.SelectionEditor.EQb(this.gr);$e.SelectionEditor.nl(v)&&(this.gr=v);const cc=new bg.a(!1,!1,!0);v=this.qZl();D={["displayTextLabel"]:Box4Intl.Box4Strings.l_InsertLinkDisplayText,["addressLabel"]:Box4Intl.Box4Strings.l_InsertLinkAddress,["insertInternalLinkEnabled"]:!0,["enterLinkTabLabel"]:Box4Intl.Box4Strings.l_EnterLinkText,["thisDocumentTabLabel"]:Box4Intl.Box4Strings.l_ThisDocumentText,["groupedList"]:v};P=this.MDb="";P=fe.ParagraphReader.text(this.gr.node);
ta=this.gr.cpBegin;Ra=this.gr.cpEnd;({f$f:P,pjf:ta,qjf:Ra,Lyf:ca}=this.ZUl(P));if((h="object"===typeof h?h:null)&&(h.Source&&"CommandingInterface"===h.Source||h.Url&&h.DisplayText))this.insertLink(h.DisplayText,h.Url,ca);else{ca[0]&&this.qzl(ta,Ra,ca[0].paragraph);h=""===P.trim()?Box4Intl.Box4Strings.l_InsertLinkButtonText:CommonUIStrings.l_DialogOk;cc.Ee(1,h);(null===P||void 0===P?0:P.startsWith(G.a.heb))?(h=this.rcm(P,v))?v.selectedItem=h:D.txtLink=P:D.txtLink=P;D.txtDisplay=this.MDb;1>=ca.length&&
this.P_.x5k(b,ca[0],1===ca.length)&&(this.Gwi=!0,D.textDisplayDisabled=!0);var Ac={["id"]:"InsertLinkDialog",["bodyControls"]:D};this.Kk.ie(()=>{cc.Wh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.IAf,Ac)},"RILD:IAS")}}ZUl(b){const h=Re.a.NPc(this.gr);let v=this.gr.cpBegin,D=this.gr.cpEnd,P="";if(!h.length)return this.MDb=b.substring(this.gr.cpBegin,this.gr.cpEnd),{returnValue:!0,f$f:P,pjf:v,qjf:D,Lyf:h};if(h[0].hyperlink){let ca,ta=0,Ra=Math.max(0,b.length-1),mb=0;for(let Jb=0;Jb<h.length;Jb++)h[Jb].cpBegin>=
ta&&({cpBegin:ca,cpEnd:ta}=this.P_.Rga(this.gr,h[Jb]),Ra=Math.min(ca,Ra),mb=Math.max(ta,mb));v=Math.min(Ra,v);D=Math.max(mb,D);this.MDb=b.substring(v,D);v===Ra&&(P=h[0].hyperlink.url);return{returnValue:!0,f$f:P,pjf:v,qjf:D,Lyf:h}}return{returnValue:!1,f$f:P,pjf:v,qjf:D,Lyf:h}}qzl(b,h,v){if(h!==this.gr.cpEnd||b!==this.gr.cpBegin)b=Og.SelectionFactory.ZI(v,b,h),this.he.lb.setSelection(b),this.gr=$e.SelectionEditor.EQb(b.Oa.clone())}lNo(b,h,v,D,P,ca=!1){D?(D=we.a.createTextRange(this.gr.node,this.gr.cpBegin,
this.gr.cpBegin+b.length),this.hyperlinkEditor.qtl(D,v,h),b=Og.SelectionFactory.pe(this.gr.node,this.gr.cpBegin+b.length)):(this.hyperlinkEditor.Rlb(this.gr,2),this.nj.Lob(this.gr,2),v=we.a.Qc(this.gr.node,this.gr.cpEnd),this.characterPropertiesEditor.replaceTextRange(v,b,!0),D=we.a.createTextRange(this.gr.node,this.gr.cpEnd,this.gr.cpEnd+b.length),this.hyperlinkEditor.kG(D,h,P,!1,!0,ca),b=Og.SelectionFactory.pe(this.gr.node,this.gr.cpEnd+b.length));b&&this.he.lb.setSelection(b)}insertLink(b,h,v,
D=!1){var P=null;b||(b=h,w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(h&&(!v.length||h!==v[0].hyperlink.url)&&!D){h=Re.a.lPa(h);var ca="";this.vwa&&({R4f:ca}=this.vwa.Ykg(h)).returnValue&&(h=ca)}this.Gwi||(b=this.hyperlinkEditor.V4n(b));ca=!1;if(h){P=0<v.length;const ta=fe.ParagraphReader.text(this.gr.node).substring(this.gr.cpBegin,this.gr.cpEnd)!==b,Ra=this.Ld.rg;if(Ra&&1===v.length&&!v[0].hyperlink.DG&&
!(v[0].cpBegin>this.gr.cpBegin&&v[0].cpEnd<=this.gr.cpEnd)){this.lNo(b,h,v[0].hyperlink,!ta,P,D);return}if(P)for(let mb=0;mb<v.length;mb++)v[mb].hyperlink.DG&&(ca=!0),this.hyperlinkEditor.HR(this.gr.node,v[mb].hyperlink,!1);ta?this.characterPropertiesEditor.replaceTextRange(this.gr,b,!ca):Ra&&!ca&&this.nj.Lob(this.gr,1);v=we.a.createTextRange(this.gr.node,this.gr.cpBegin,this.gr.cpBegin+b.length);this.hyperlinkEditor.kG(v,h,P,ca,!0,D);P=Og.SelectionFactory.pe(this.gr.node,this.gr.cpBegin+b.length)}else 0<
v.length&&(b=v[0],b.hyperlink.DG&&(ca=!0),this.hyperlinkEditor.HR(b.paragraph,b.hyperlink));ca&&this.Ld.Ns(ca?2:7);P&&this.he.lb.setSelection(P);Xa.App.IOo()}rcm(b,h){h=h.items;const v=b.substring(G.a.heb.length),D=this.bookmarkManager.Hdi(v);b=-1;let P=0;for(let ca=0;ca<h.length;ca++)if(h[ca].isHeading&&0!=D.count&&h[ca].paragraphNode.id==D.J(0).id){b=ca;break}else if(!h[ca].isHeading&&h[ca].linkurl==v){b=ca;P=1;break}h=new Ht(b,P);return-1!=b?h:null}qZl(){const b={};let h=[],v=0,D=0;var P=this.orl.TZl();
P&&(v=P.count,h=h.concat(this.YZl(P)));if(P=this.bookmarkManager.YNd(!1))D=P.count,h=h.concat(this.UOl(P));b.groups=this.LZl(v,D);b.items=h;return b}LZl(b,h){const v=[],D=new XB("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,b,0,!0);v.push(D);b=new XB("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,b,h,0,!0);v.push(b);return v}YZl(b){const h=[],v=/\uFFFC/;for(const D of b)b=D.characterData.replace(v," "),b=new WB(b,!0,D.begin,D.end,D.paragraphNode),h.push(b);
return h}UOl(b){const h=[];for(const v of b)b=v.Gf(Bc.a.ut).toString(),b=new JA(b,!1),h.push(b);return h}}Object(n.a)(kv,"ReactInsertLinkDialog",null,[]);class jf{static get Wf(){return qi.a.instance}static get dX(){return null!=jf.nxg?jf.nxg:jf.nxg=Ea.a.instance.Na("Box4.IContentControlChpHelper")}static get P_(){return null!=jf.iBg?jf.iBg:jf.iBg=Ea.a.instance.resolve("Box4.IHyperlinkStrategy")}static Zw(){return jf.Sm||(jf.Sm=Ea.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Ld(){return null!=
jf.YIg?jf.YIg:jf.YIg=Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Ch(){return null!=jf.eJg?jf.eJg:jf.eJg=Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Xg(){return em.ContextSetEditor.instance}static get Jc(){return bf.a.instance}static get LZc(){null==jf.jrb&&(jf.jrb=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return jf.jrb}static get Ita(){null==jf.o$&&(jf.o$=
w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return jf.o$}static get hyperlinkEditor(){return null!=jf.eBg?jf.eBg:jf.eBg=Ea.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=jf.axg?jf.axg:jf.axg=Ea.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get l3a(){jf.uGe||(jf.uGe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("IsO365CommercialHost")||w.AFrameworkApplication.K.$("IsO365ConsumerHost"):
!1);return jf.uGe}static get OKo(){jf.Zih||(jf.Zih=w.AFrameworkApplication.K?w.AFrameworkApplication.K.mc("WordRecentLinksTimeInMsBetweenTwoMruCalls",6E4):6E4);return jf.Zih}static Tb(){const b=w.AFrameworkApplication.va;b.qa(Gb.a.insertHyperlink,sc.a.view,jf.tGb);b.qa(Gb.a.insertHyperlink,sc.a.Tc,jf.insertLink);b.qa(Gb.a.insertHyperlink,sc.a.Hd,jf.insertLink);b.Vc(Gb.a.insertHyperlink,1028);b.qa(Gb.a.F5b,sc.a.view,jf.tGb);b.qa(Gb.a.F5b,sc.a.Tc,jf.insertLink);b.qa(Gb.a.F5b,sc.a.Hd,jf.insertLink);
b.Vc(Gb.a.F5b,1028);b.qa(Gb.a.HR,sc.a.view,jf.tGb);b.qa(Gb.a.HR,sc.a.Tc,jf.saj);b.qa(Gb.a.HR,sc.a.Hd,jf.saj);b.Vc(Gb.a.HR,1028);b.qa(Gb.a.Nfe,sc.a.view,jf.tGb);b.qa(Gb.a.Nfe,sc.a.Tc,jf.Aij);b.qa(Gb.a.Nfe,sc.a.Hd,jf.Aij);b.qa(Gb.a.S4a,sc.a.view,jf.tGb);b.qa(Gb.a.S4a,sc.a.Tc,jf.EZi);b.qa(Gb.a.S4a,sc.a.Hd,jf.EZi);b.qa(Gb.a.S4a,sc.a.image,jf.$Wf);b.qa(Gb.a.S4a,sc.a.yDb,jf.$Wf);b.qa(Gb.a.S4a,sc.a.anchoredObject,jf.$Wf);b.qa(Gb.a.NGc,sc.a.application,jf.NGc);b.qa(Gb.a.tGd,sc.a.view,jf.tGb);jf.l3a&&(b.eb(Wa.a.B5a,
sc.a.view,this.tGb.bind(this),1028),b.qa(Wa.a.B5a,sc.a.Tc,this.B5a.bind(this)),b.qa(Wa.a.B5a,sc.a.Hd,this.B5a.bind(this)),b.Vc(Wa.a.B5a,1028),b.qa(Wa.a.JAf,sc.a.Tc,this.B5a.bind(this)),b.qa(Wa.a.JAf,sc.a.Hd,this.B5a.bind(this)),b.Vc(Wa.a.JAf,1028),b.qa(Wa.a.e_f,sc.a.view,this.e_f.bind(this)),b.qa(Wa.a.ZZf,sc.a.view,this.ZZf.bind(this)),b.eb(Wa.a.ljb,sc.a.Tc,this.ljb.bind(this),1028),b.eb(Wa.a.ljb,sc.a.Hd,this.ljb.bind(this),1028))}static NGc(){return 32}static B5a(b,h,v){if(!jf.l3a)return 2;b=jf.SJj(h);
if(32!=b)return b;if(!jf.IQa(h,!0).returnValue||jf.D3b(h))return 8;1!==v||jf.v0h||(jf.qoe(!0),jf.v0h=!0);return 32}static e_f(b,h,v,D,P){if(!jf.l3a)return 2;if(1===v)return 32;jf.Xce(jf.Zfk,jf.$fk,jf.rch);ns.a.instance.ie(()=>{jf.qoe();P.MenuItems=Object.assign(new Yd.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const ca=this.cNh();ca?(u.ULS.sendTraceTag(526242130,324,50,"Recent Links data load success in ribbon"),P.MenuItems.MenuSectionList.push(ca)):jf.A2i(P,jf.rch)},"HA:PRLF");
return 32}static ZZf(b,h,v,D,P){if(!jf.l3a)return 2;if(1===v)return 32;jf.Xce(jf.Xfk,jf.Yfk,jf.qch);ns.a.instance.ie(()=>{jf.qoe();P.MenuItems=Object.assign(new Yd.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],UpdateDynamically:!0});P.MenuItems.MenuSectionList.push(this.ubl());const ca=this.cNh(!0);ca?(u.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),P.MenuItems.MenuSectionList.push(ca)):jf.A2i(P,jf.qch)},"HA:PILF");return 32}static A2i(b,h){u.ULS.sendTraceTag(524911777,
324,50,"Recent Links could not load in "+h);jf.Xce(jf.Ack,jf.Bck,h);b.MenuItems.MenuSectionList.push(this.Tdl());jf.qoe(!0)}static Tdl(){const b=this.Ebf("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new mg.a,{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));return b}static ubl(){const b=this.Ebf("InsertLinkSection");b.ControlList.push(Object.assign(new mg.a,{ExternalId:"InsertLink"}));return b}static cNh(b=!1){if(Rk.instance.Hsd){var h=
this.Ebf("RecentLinksSection",b);b=JSON.parse(Rk.instance.Hsd);this.Gsd.clear();b.forEach((v,D)=>{this.Gsd.set(D,[v.FileName,v.DocumentUrl]);const P=jf.jam(v.FileName);var ca=jf.NYl(v.TimeStamp),ta=h.ControlList,Ra=ta.push,mb=Object,Jb=mb.assign,Ub=new mg.a,cc=Wa.a.ljb,Ac=Wa.a.ljb;ca=P!==v.FileName?v.FileName+"\n"+ca:ca;var Lc=v.FileName;let id="SaveAsWordDocx_32";switch(v.App){case "Word":id="SaveAsWordDocx_32";break;case "PowerPoint":id="SaveAsPowerPointPptx_32";break;case "Excel":id="SaveAsExcelXlsx_32"}Ra.call(ta,
Jb.call(mb,Ub,{ExternalId:D,Command:cc,CommandValueId:Ac,LabelText:P,Alt:ca,AriaDescription:Lc,ExternalImageId:id,KeyTip:v.FileName}))});return h}}static Ebf(b,h=!1){return Object.assign(new ih.a,{Title:h?Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+b,ControlList:[]})}static ljb(b,h,v,D,P){if(!jf.l3a)return 2;if(!P||P.CommandValueId!=Wa.a.ljb)return 32;jf.Xce(jf.O7j,jf.P7j,jf.mhk);v=h;h=new eh.GraphTransaction(15);h.jk=b;h.Cb(v.node);
D=jf.IQa(v,!0).hyperlink;v=$e.SelectionEditor.EQb(v);if(D)jf.M5f(v),b=Og.SelectionFactory.ZI(v.node,Math.min(v.cpBegin,D.cpBegin),Math.max(v.cpEnd,D.cpEnd)),Yh.a.instance.setSelection(b),v=b.Oa;else if($e.SelectionEditor.gf(v)){var ca;$e.SelectionEditor.pkb(v)&&(ca=$e.SelectionEditor.w_(v,!1));ca||(ca=this.Gsd.get(P.SourceControlId)[0],jf.characterPropertiesEditor.replaceTextRange(v,ca,!0,void 0,b),ca=Og.SelectionFactory.ZI(v.node,v.cpBegin,v.cpBegin+ca.length));if(ca&&(Yh.a.instance.setSelection(ca),
v=ca.Oa,jf.D3b(v)))return jf.Ld.lPb(!1),8}try{jf.hyperlinkEditor.kG(v,this.Gsd.get(P.SourceControlId)[1],0<Re.a.NPc(v).length);const ta=Og.SelectionFactory.pe(v.node,v.cpEnd);ta&&Yh.a.instance.setSelection(ta);l(P,"RecentLinks")}finally{h&&h.dispose()}u.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static tGb(b,h,v,D,P){if(jf.LZc)return jf.lvm(b,h,v,D,P);if(!h.view.te)return 2;var ca=h.view.lb;if(!ca||!ca.gb||!ca.gb.length)return 8;var ta=ca.gb.kb;let Ra=ta.Oa.clone();if(2===
ta.length){if(ta=ta.J(1),!$e.SelectionEditor.nl(Ra)||!$e.SelectionEditor.Hk(ta)||Ra.node!==ta.node)return 8}else if(2<ta.length)return 8;if(ca.gb.wJ)return 8;if(jf.Xg.sza(fe.ParagraphReader.kU,ca.tg))return jf.Jc.Yb(qe.a.kf,{["Reason"]:me.a.hO}),8;fe.ParagraphReader.lm(Ra)&&!$e.SelectionEditor.K8(Ra)&&(ca=Ra.node,Ra=we.a.createTextRange(ca,0,fe.ParagraphReader.textLength(ca)));return b===Gb.a.tGd?jf.aKh(h,Ra,v,D):w.AFrameworkApplication.va.Mf(Ra,b,v,!0,D,P)}static lvm(b,h,v,D,P){if(!h.view.te)return 2;
var ca=h.view.lb;if(!ca||!ca.gb||!ca.gb.length||ca.gb.wJ)return 8;var ta=ca.gb.kb;if(ca=jf.uGf(ta))ta=jf.evf(ta.Oa.clone(),!0);else{let Ra=ta.J(0).clone(),mb=1;for(;mb<ta.length&&(!fe.ParagraphReader.textLength(Ra.node)||$e.SelectionEditor.Hk(Ra)||jf.Ita&&Yo.l(Ra));)Ra=ta.J(mb).clone(),mb++;ta=jf.evf(Ra,!1)}return jf.Ita&&$e.SelectionEditor.nl(ta)&&Yo.l(ta)||!$e.SelectionEditor.nl(ta)&&!ca?8:b===Gb.a.tGd?jf.aKh(h,ta,v,D):w.AFrameworkApplication.va.Mf(ta,b,v,!0,D,P)}static uGf(b){if(1===b.length)return!0;
if(2===b.length){const h=b.Oa.clone();b=b.J(1);return $e.SelectionEditor.nl(h)&&$e.SelectionEditor.Hk(b)&&h.node===b.node?!0:!1}return!1}static sHh(b){let h=null;const v=[];for(let D=0;D<b.length;D++){const P=jf.evf(b.J(D).clone(),!1);if($e.SelectionEditor.nl(P))jf.Ita&&Yo.l(P)||v.push(P);else if(!$e.SelectionEditor.Hk(P)&&!fe.ParagraphReader.lm(P))return{returnValue:!1,kfb:h}}h=v;return{returnValue:!jf.Ita||0<h.length?!0:!1,kfb:h}}static insertLink(b,h,v,D,P){if(jf.LZc)return jf.JCm(h,v,P);D=jf.SJj(h);
if(32!==D)return D;let ca;if(!({hyperlink:ca}=jf.IQa(h,!0)).returnValue||jf.D3b(h)||!ca&&b==Gb.a.F5b)return 8;if(1===v)return 32;if(!ca&&$e.SelectionEditor.gf(h)&&$e.SelectionEditor.pkb(h)&&(b=$e.SelectionEditor.w_(h,!1))&&(Yh.a.instance.setSelection(b),h=b.Oa,jf.D3b(h)))return jf.Ld.lPb(!1),8;ca&&u.ULS.sendTraceTag(593875799,324,50,"Edit link");a(h,P);return 32}static SJj(b){return!jf.h6e()||!jf.MCd(b)||b.node.xr||Yh.a.instance.gb.wJ?8:$e.SelectionEditor.i4(b)||Ni.a.EDf(b)?2:32}static JCm(b,h,v){var D=
Yh.a.instance.gb.kb;const P=jf.uGf(D);if(P)b=[b];else if(!({kfb:b}=jf.sHh(D)).returnValue)return 8;if(!jf.h6e())return 8;for(D=0;D<b.length;D++)if(!jf.MCd(b[D]))return 8;if(Yh.a.instance.gb.wJ)return 8;D=Array(b.length);let ca=null;for(let ta=0;ta<b.length;ta++)if(D[ta]=b[ta],!({hyperlink:ca}=jf.IQa(D[ta],!0)).returnValue||jf.D3b(D[ta]))return 8;if(1===h)return 32;if(!ca&&1===D.length&&P&&$e.SelectionEditor.gf(D[0])&&$e.SelectionEditor.pkb(D[0])&&(h=$e.SelectionEditor.w_(D[0],!1))&&(Yh.a.instance.setSelection(h),
D[0]=h.Oa,jf.D3b(D[0])))return jf.Ld.lPb(!1),8;P?a(D[0],v):new Xn(D,v);return 32}static saj(b,h,v){if(jf.LZc)return jf.q0n(b,h,v);if(!jf.MCd(h)||$e.SelectionEditor.i4(h))return 2;let D;if(!({hyperlink:D}=jf.IQa(h,!1)).returnValue)return 2;if(2===v){v=new eh.GraphTransaction(15);try{v.jk=b,v.Cb(D.paragraph),jf.M5f(h)}finally{v&&v.dispose()}D.hyperlink.DG&&jf.Ld.Ns(2)}return 32}static q0n(b,h,v){var D=Yh.a.instance.gb.kb;if(jf.uGf(D))h=[h];else if(!({kfb:h}=jf.sHh(D)).returnValue)return 8;if(!jf.h6e())return 8;
for(D=0;D<h.length;D++)if(!jf.MCd(h[D]))return 8;if(1===v&&!jf.IQa(h[0],!1).returnValue)return 2;if(2===v){for(v=0;v<h.length;v++)if(!jf.IQa(h[v],!0).returnValue)return 2;v=new eh.GraphTransaction(15);try{const P=h[0];v.jk=b;v.Cb(P.node);for(b=0;b<h.length;b++)jf.M5f(h[b])}finally{v&&v.dispose()}jf.Ld.Ns(7)}return 32}static M5f(b){const h=Re.a.NPc(b);let v=0;for(let D=0;D<h.length;D++)if(h[D].cpBegin>=v){const P=({cpEnd:v}=jf.P_.Rga(b,h[D])).returnValue;jf.P_.iaj(b,P)}}static Aij(b,h,v){if(oe.ImageReader.C2a(h)||
!({hyperlink:b}=jf.IQa(h,!1)).returnValue)return 2;if(2===v){const {cpBegin:D,cpEnd:P}=jf.P_.Rga(h,b);Yh.a.instance.setSelection(Og.SelectionFactory.ZI(b.paragraph,D,P))}return 32}static EZi(b,h,v){if(({hyperlink:b}=jf.HVm(h)).returnValue)u.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:b}=jf.IQa(h,!1)).returnValue)return 2;2===v&&Xa.App.Xgb(b.hyperlink.url);return 32}static $Wf(b,h,v){b=oe.ImageReader.Rga(h.node);if(!b)return 2;2===v&&Xa.App.Xgb(b);
return 32}static aKh(b,h,v,D){if(oe.ImageReader.C2a(h)||!Pb.InteractiveViewManager.instance.editingView.Oj)return 2;let P;if(!({hyperlink:P}=jf.IQa(h,!1)).returnValue)return 2;if(1===v)return 32;const {cpBegin:ca,cpEnd:ta}=jf.P_.Rga(h,P);Yh.a.instance.setSelection(Og.SelectionFactory.ZI(P.paragraph,ca,ta));h=Pb.InteractiveViewManager.instance.SCa.ownerDocument.createElement("span");h.innerText=P.hyperlink.url;h.style.backgroundColor="rgb(255, 255, 255)";return w.AFrameworkApplication.va.Mf(b,Gb.a.sGd,
2,!0,D,h)}static IQa(b,h){if($e.SelectionEditor.nl(b)){const v=Yo.g(b),D=Wl.a.all(v,P=>6===P.zh);if(0<v.length&&(!jf.Ita||!D)||jf.Wf.gh&&jf.dX&&0<jf.dX.OOd(b).count)return{returnValue:!1,hyperlink:null}}return jf.wVm(b,h)}static HVm(b){let h=null;return oe.ImageReader.C2a(b)&&(h=Re.a.c8b(b))?{returnValue:!0,hyperlink:h}:{returnValue:!1,hyperlink:h}}static wVm(b,h){let v=null;const D=Re.a.NPc(b);return D.length?D[0].hyperlink?(v=D[0],b.cpBegin<D[0].cpBegin?{returnValue:h,hyperlink:v}:{returnValue:!0,
hyperlink:v}):{returnValue:!1,hyperlink:v}:{returnValue:h,hyperlink:v}}static D3b(b){if(Dp.a.instance.J(1)){b=jf.Ch.mPa(b.node,b.cpBegin,b.cpEnd);for(let h=0;h<b.count;++h)if(2===b.J(h).Jd.changeType)return!0}return!1}static h6e(){return Dp.a.instance.J(1)?!0:!Dp.a.instance.J(1)||!Xa.App.Ev.AQb}static MCd(b){return jf.Wf.k_(b)||jf.Wf.uha(b)||jf.Zw()&&jf.Zw().instance&&jf.Zw().instance.pU(b)?!1:!0}static evf(b,h){return fe.ParagraphReader.lm(b)&&!$e.SelectionEditor.K8(b)&&(fe.ParagraphReader.textLength(b.node)||
h)?we.a.createTextRange(b.node,0,fe.ParagraphReader.textLength(b.node)):b}static jam(b){return b&&b.length<=jf.L7i?b:b.substring(0,jf.L7i)+"..."}static NYl(b){try{const h=new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,h.toLocaleString(void 0,{weekday:"long"}),h.toLocaleString(void 0,{hour:"numeric",minute:"numeric"}))}catch(h){return""}}static qoe(b=!1){const h=Date.now();if(b||h-jf.kFi>jf.OKo)Rk.instance.F$m(),jf.kFi=h}static Xce(b,h,v){const D=new Map;D.set("Source",
v);D.set("Action",h);va.Health.instance.recordKpiUsage(b,0,this.bWa,D)}}jf.Sm=null;jf.jrb=null;jf.o$=null;jf.Gsd=new Map;jf.uGe=null;jf.L7i=35;jf.kFi=Date.now();jf.v0h=!1;jf.bWa="wwaengidc";jf.mhk="RecentLinks";jf.rch="RecentLinksRibbonOptions";jf.qch="RecentLinksContextMenuOptions";jf.Zfk="PopulateRecentLinksRibbon";jf.$fk="PopulateRecentLinksRibbonAction";jf.Xfk="PopulateRecentLinksContextMenu";jf.Yfk="PopulateRecentLinksContextMenuAction";jf.Ack="PopulateRecentLinksContextMenu";jf.Bck="PopulateRecentLinksContextMenuAction";
jf.O7j="InsertRecentLinks";jf.P7j="InsertRecentLinksAction";Object(n.a)(jf,"HyperlinkActor",null,[]);class Yy{}Yy.Fkb=Object.freeze({xxm:"WordIndentationShortcutUsage"});Yy.tB="wwaengidc";Object(n.a)(Yy,"IndentationConstants",null,[]);class Em{static get jq(){return kt.a.dFb}static get Xg(){return em.ContextSetEditor.instance}static get Wf(){return qi.a.instance}static get Jc(){return bf.a.instance}static get xo(){return Pb.InteractiveViewManager.instance}static Zw(){return Em.Sm||(Em.Sm=Ea.a.instance.Sa("Box4.IExternalSelectionManager"))}static get wxm(){return null!=
Em.pBg?Em.pBg:Em.pBg=Ea.a.instance.resolve("Box4.Actors.IIndentationActorExtension")}static Tb(){const b=w.AFrameworkApplication.va;b.qa(Gb.a.KG,sc.a.view,Em.MEc);b.qa(Gb.a.KG,sc.a.outlineElement,Em.xuh);b.Vc(Gb.a.KG,1036);b.qa(Gb.a.pO,sc.a.view,Em.MEc);b.qa(Gb.a.pO,sc.a.outlineElement,Em.xuh);b.Vc(Gb.a.pO,1036)}static SSn(b){const h=new Map;b=b?b.ia(Hh.a.Aqi,"Unknown"):"tab";h.set("actionCallSource",b);va.Health.instance.recordKpiUsage(Yy.Fkb.xxm,1,Yy.tB,h)}static MEc(b,h,v,D,P){const ca=h.view;
if(!ca.te)return 2;var ta=ca.lb;if(!ta)return Em.Jc.Yb(qe.a.kf,{["Reason"]:me.a.Gca}),8;ta=ta.tg;if(!ta)return Em.Jc.Yb(qe.a.kf,{["Reason"]:me.a.noSelection}),8;if(Ni.a.rha(h))return 8;if(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Em.Wf.tac(ta))return Em.Jc.Yb(qe.a.kf,{["Reason"]:me.a.WE}),8;if(1===v)return 32;if(Em.Xg.cDa(Em.f1e,ta))return Em.Jc.Yb(qe.a.kf,{["Reason"]:me.a.GHc}),8;if(Em.Xg.sza(fe.ParagraphReader.kU,ta))return Em.Jc.Yb(qe.a.kf,
{["Reason"]:me.a.hO}),8;if(!w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Em.Wf.tac(ta))return Em.Jc.Yb(qe.a.kf,{["Reason"]:me.a.WE}),8;if(Em.Zw()&&Em.Zw().instance&&Em.Zw().instance.pU(ta))return Em.Jc.Yb(qe.a.kf,{["Reason"]:me.a.externalSelection}),8;ta={};ta[Ds.a.XIa]=5794;ta[Ds.a.WIa]=5795;return Em.wxm.MEc(ca,b,h,v,D,P,ta)}static xuh(b,h,v,D,P){var ca,ta;if(h.contextId!==sc.a.outlineElement)return 2;var Ra=h.clone().Qfg();if(cj.TableReader.QCi(Ra)){if(Em.Wf.RCi(Ra))return Em.Jc.Yb(qe.a.fn,
{["Reason"]:me.a.WE}),8}else if(Em.Wf.n3a(Ra))return Em.Jc.Yb(qe.a.fn,{["Reason"]:me.a.WE}),2;Ra=new he.GraphIterator;Ra.set(h.node);$e.SelectionEditor.ru(Ra);if(!ig.OutlineElementReader.Nh(Ra))return 2;let mb;switch(b){case Gb.a.KG:mb=Em.jq.zAb(Ra);break;case Gb.a.pO:mb=Em.jq.u2b(Ra);break;default:return 2}if(1===v||!mb)return mb?32:8;v=0;b===Gb.a.pO&&P&&P.ia(Wc.a.nwh,!1)&&(v|=2);if(ig.OutlineElementReader.yQ(Ra))return Em.Jc.Yb(qe.a.fn,{["Reason"]:me.a.hO}),2;(null===(ta=null===(ca=Em.xo)||void 0===
ca?void 0:ca.Bd)||void 0===ta?0:ta.qU)&&Em.xo.editingView&&(Em.xo.editingView.bI=!0);switch(b){case Gb.a.KG:Em.jq.eSa(Ra,-1,v);break;case Gb.a.pO:Em.jq.DJc(Ra,1)}D&&Hr.a.Qpb&&(D.xs|=Hr.a.zhb(h.node,!0));Em.SSn(P);return 32}}Em.Sm=null;Em.f1e=oe.ImageReader.B2a;Object(n.a)(Em,"IndentationActor",null,[]);var Gn=c(1581);class hl{static get paragraphEditor(){return null!=hl.zFg?hl.zFg:hl.zFg=Ea.a.instance.resolve("Box4.IParagraphEditor")}static get yk(){return null!=hl.QHg?hl.QHg:hl.QHg=Ea.a.instance.resolve("Box4.ITableEditor")}static get Wf(){return qi.a.instance}static get Jc(){return bf.a.instance}static Zw(){return hl.Sm||
(hl.Sm=Ea.a.instance.Sa("Box4.IExternalSelectionManager"))}static Tb(){const b=w.AFrameworkApplication.va;b.qa(Gb.a.Vyj,sc.a.view,(h,v)=>Ni.a.rha(v)?8:32);b.qa(Gb.a.leftJustify,sc.a.view,Gn.a.gw);b.qa(Gb.a.leftJustify,sc.a.paragraph,hl.nCa);b.qa(Gb.a.leftJustify,sc.a.table,hl.i2e);b.Vc(Gb.a.leftJustify,1036);b.qa(Gb.a.centerJustify,sc.a.view,Gn.a.gw);b.qa(Gb.a.centerJustify,sc.a.paragraph,hl.nCa);b.qa(Gb.a.centerJustify,sc.a.table,hl.i2e);b.Vc(Gb.a.centerJustify,1036);b.qa(Gb.a.rightJustify,sc.a.view,
Gn.a.gw);b.qa(Gb.a.rightJustify,sc.a.paragraph,hl.nCa);b.qa(Gb.a.rightJustify,sc.a.table,hl.i2e);b.Vc(Gb.a.rightJustify,1036);b.qa(Gb.a.fullJustify,sc.a.view,Gn.a.gw);b.qa(Gb.a.fullJustify,sc.a.paragraph,hl.nCa);b.Vc(Gb.a.fullJustify,1036);b.qa(Gb.a.fKc,sc.a.view,Gn.a.gw);b.qa(Gb.a.fKc,sc.a.paragraph,hl.nCa);b.Vc(Gb.a.fKc,1036);b.qa(Gb.a.FIb,sc.a.view,Gn.a.gw);b.qa(Gb.a.FIb,sc.a.paragraph,hl.nCa);b.Vc(Gb.a.FIb,1036);b.qa(Gb.a.P7c,sc.a.view,Gn.a.gw);b.qa(Gb.a.P7c,sc.a.paragraph,hl.nCa);b.Vc(Gb.a.P7c,
1036);b.qa(Gb.a.bdc,sc.a.view,Gn.a.gw);b.qa(Gb.a.bdc,sc.a.paragraph,hl.nCa);b.Vc(Gb.a.bdc,1036);b.qa(Gb.a.N2b,sc.a.view,Gn.a.gw);b.qa(Gb.a.N2b,sc.a.paragraph,hl.nCa);b.Vc(Gb.a.N2b,1036);b.qa(Gb.a.bic,sc.a.view,Gn.a.gw);b.qa(Gb.a.bic,sc.a.paragraph,hl.nCa);b.Vc(Gb.a.bic,1036);b.qa(Gb.a.g7b,sc.a.view,Gn.a.gw);b.qa(Gb.a.g7b,sc.a.paragraph,hl.nCa);b.Vc(Gb.a.g7b,1036)}static i2e(b,h,v,D){let P=!0;if(!h)return 8;cj.TableReader.QCi(h)?hl.Wf.RCi(h)?(hl.Jc.Yb(qe.a.fn,{["Reason"]:me.a.WE}),P=!1):hl.Zw()&&hl.Zw().instance&&
hl.Zw().instance.pU(h)&&(hl.Jc.Yb(qe.a.fn,{["Reason"]:me.a.externalSelection}),P=!1):(hl.Jc.Yb(qe.a.fn,{["Reason"]:me.a.vgf}),P=!1);if(1===v||!P)return P?32:8;h=h.node;switch(b){case Gb.a.leftJustify:hl.yk.gE(h,1);break;case Gb.a.centerJustify:hl.yk.gE(h,2);break;case Gb.a.rightJustify:hl.yk.gE(h,3)}D&&Hr.a.Qpb&&(D.xs|=2);return 32}static nCa(b,h,v,D,P){let ca=!0;h.contextId!==sc.a.paragraph?ca=!1:hl.Wf.n3a(h)?(hl.Jc.Yb(qe.a.fn,{["Reason"]:me.a.WE}),ca=!1):hl.Zw()&&hl.Zw().instance&&hl.Zw().instance.pU(h)&&
(hl.Jc.Yb(qe.a.fn,{["Reason"]:me.a.externalSelection}),ca=!1);if(1===v||!ca)return ca?32:8;h=h.node;v=fe.ParagraphReader.Gx(h);switch(b){case Gb.a.leftJustify:case Gb.a.bdc:hl.paragraphEditor.gE(h,1===v&&hl.j0d(P)?6:1);break;case Gb.a.centerJustify:case Gb.a.N2b:hl.paragraphEditor.gE(h,2===v&&hl.j0d(P)?1:2);break;case Gb.a.rightJustify:case Gb.a.bic:hl.paragraphEditor.gE(h,3===v&&hl.j0d(P)?1:3);break;case Gb.a.fullJustify:case Gb.a.g7b:hl.paragraphEditor.gE(h,6===v&&hl.j0d(P)?1:6);break;case Gb.a.FIb:hl.paragraphEditor.gE(h,
11);break;case Gb.a.fKc:hl.paragraphEditor.gE(h,7);break;case Gb.a.P7c:hl.paragraphEditor.gE(h,13)}D&&Hr.a.Qpb&&(D.xs|=Hr.a.zhb(h));return 32}static j0d(b){let h=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(h=b.InContextSet);return!h}}hl.Sm=null;Object(n.a)(hl,"JustificationActor",null,[]);const KA=()=>{const b=w.AFrameworkApplication.va;b.qa(Gb.a.save,ud.a.frame,LA);b.qa(Gb.a.sync,ud.a.frame,LC)},LC=(b,h,v)=>{if(1===v)return 32;w.AFrameworkApplication.va.processAction(Gb.a.B2b,
2);Xa.App.Xj.gle();return 32},LA=(b,h,v)=>{if(1===v)return 2===Xa.App.xa.mode?32:8;w.AFrameworkApplication.va.processAction(Gb.a.B2b,2);if(2!==Xa.App.xa.mode)return 32;Xa.App.Xj.chj(null,null);return 32};class hx{constructor(){this.activateRibbonTab=(b,h,v,D,P)=>{Xa.App.Ev.NI.Wee(P.toString());return 32};this.mZm=(b,h,v,D,P)=>{w.AFrameworkApplication.epa("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");Xa.App.Ev.NI.CEi(1,P.toString());return 32};this.hwn=(b,h)=>{if(h.contextId!==
ud.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}Tb(){const b=w.AFrameworkApplication.va;b.qa(Gb.a.activateRibbonTab,sc.a.view,this.activateRibbonTab);b.Vc(Gb.a.activateRibbonTab,5);b.qa(Gb.a.DEi,sc.a.view,this.mZm);b.qa(Gb.a.$jg,ud.a.frame,this.hwn)}static get instance(){return null!=hx.RBg?hx.RBg:hx.RBg=hx.Rl()}static Rl(){return new hx}}Object(n.a)(hx,"RibbonActor",null,[]);var os=c(558);class lv{constructor(b,h){this.Im=null;this.bSo=(v,D,P,ca,ta)=>{let Ra;ca=D.view;if(!ca.te)return lv.Jc.Yb(qe.a.kf,
{["Reason"]:me.a.iKb}),8;Ra=v===Gb.a.undo?this.Pg.KX:this.Pg.zPa;if(1===P)return Ni.a.rha(D)&&Ni.a.Jac()?8:Ra?32:8;if(!Ra)return u.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",v===Gb.a.undo?"undo":"redo"),this.CJa.value.dEj(),lv.Jc.Yb(qe.a.kf,{["Reason"]:me.a.XRo}),2;D=new eh.GraphTransaction(3);D.Cb(ca.Yc);D.tge();v=v===Gb.a.undo?this.Pg.undo():this.Pg.redo();D.dispose();ta&&Fn.GrippersManager.instance.eRb(ta.Kx);if(v)return 32;lv.Jc.Yb(qe.a.m5b,{["Reason"]:me.a.vRi});
return 8};this.Gla=b;this.CJa=h}get Pg(){return this.Im||(this.Im=this.Gla())}Tb(){const b=w.AFrameworkApplication.va,h=this.bSo;b.eb(Gb.a.undo,sc.a.view,h,1028);b.eb(Gb.a.redo,sc.a.view,h,1028)}static get instance(){return null!=lv.BBg?lv.BBg:lv.BBg=lv.Rl()}static Rl(){const b=Ea.a.instance;return new lv(()=>b.resolve("Box4.IUndoManager"),b.Ue("Box4.ICoauthCashTelemetry"))}static get Jc(){return bf.a.instance}}Object(n.a)(lv,"UndoActor",null,[]);class MA{constructor(){this.W=null}get name(){return"Box4.Actors"}xc(b){this.W=
b;(new zv).xc(b)}init(){var b=this.W.resolve("Box4.Actors.ClipboardActor");Vs.a.oVc&&this.W.resolve("Box4.Actors.PageColorActor").Tb();b.Tb();b.Z4();Av();Zr.instance.Tb();jf.Tb();Em.Tb();hl.Tb();this.W.resolve("Box4.Actors.TouchInputActor").Tb();Cw.instance.Tb();this.W.resolve("Box4.ISelectAllHandlers").Tb();KA();this.W.resolve("Box4.Actors.ProofingActor").Tb();hx.instance.Tb();(b=this.W.Na("Box4.IFeatureHelper"))?b.Pp.continueWith(()=>{this.R9i()}):this.R9i();os.a.Tb(Xa.App.WTa);this.W.resolve("Box4.Actors.TextFormattingActor").Tb();
lv.instance.Tb();this.W.resolve("Box4.Actors.AccessibilityActor").n4f();this.W.resolve("Box4.IClipboardCommands");this.W.resolve("Box4.Actors.PasteFloatieEventManager");Xa.App.xa.updateCommandUI()}R9i(){this.W.resolve("Box4.Actors.StyleContextMenuActor").Tb();this.W.resolve("Box4.Actors.StyleActor").Tb()}dispose(){}static main(){N.a.instance.Fc(new MA)}}Object(n.a)(MA,"Box4ActorsPackage",null,[1,2]);class Xh extends Ku{constructor(b,h,v,D){super(b);this.hna=v;this.f6a=D;this.Zpg=0;this.WA=h.hRa("UserAction",
"WordOnlineAddToDictionary")}Icg(b){this.ZKd=this.hna.Ana(b);if(!this.hWk())return!1;const h=this.ZKd.errorDetails.token;this.f6a.Sph(h);if(!this.f6a.y$c(h))return u.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;u.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");this.WA.start();this.transaction=new eh.GraphTransaction(15);this.transaction.Cb(b.node);return!0}Hae(b){this.bMb(b.node);return!0}u2c(b){this.bMb(b);
return!0}Iae(b){this.bMb(b.node)}Hig(b){this.transaction.dispose();this.ZKd.errorDetails.dqb(b.actionId);this.f6a.w9f("unused corelation id.");this.WA.stop();u.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.Zpg,this.WA.si,this.ZKd.errorDetails.proofingType));return!0}wkc(b,h){const v=b.role;return super.wkc(b,h)||9===v||10===v||13===v||7===v||8===v}bMb(b){if(b){var h=this.hna.T3(b,v=>this.f6a.y$c(v.errorDetails.token));
this.hna.Jnb(b,h,!0);this.Zpg+=h.length}}hWk(){var b,h;return null!==(h=null===(b=this.ZKd)||void 0===b?void 0:b.errorDetails)&&void 0!==h&&h.token?!0:(u.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(n.a)(Xh,"AddToDictionaryCallbackSteps",Ku,[]);class Sv{constructor(b,h,v,D,P,ca,ta){this.pc=b;this.lb=h;this.T0=v;this.hna=D;this.Fq=P;this.f6a=ca;this.YKn=ta;this.Amm=(Ra,mb,Jb,Ub,cc,Ac)=>{const Lc=new Xh(this.T0,this.Fq,this.hna,
this.f6a);return new Dm(Ra,mb,Jb,Ub,cc,Ac,Lc,this.pc,this.lb,this.T0,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Tb(){this.pc.cT(Gb.a.addToDictionary,sc.a.view,this.Amm,1124);this.YKn.zYn(this.f6a)}}Object(n.a)(Sv,"PersonalDictionaryOrchestrator",null,[]);class Lq{get name(){return"Box4.PersonalDictionary"}xc(b){this.container=b;b.register(Sv,"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").singleInstance().Rd(()=>new Sv(w.AFrameworkApplication.va,Yh.a.instance,jp.a.instance,
b.resolve("Box4.Proofing.IErrorRangeEditor"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("IRoamingDictionary"),b.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").Tb()}dispose(){}static main(){Sk.a.get_instance().Ak(7,()=>{N.a.instance.Fc(new Lq)})}}Object(n.a)(Lq,"PersonalDictionaryPackage",null,[1,2]);class It{constructor(b,h,v,D,P,ca){this.MAa=this.I9a=this.FV=null;this.mGc=(ta,
Ra,mb,Jb,Ub)=>this.gCi(Ra,mb,Ub,!1)?32:8;this.wH=(ta,Ra,mb,Jb,Ub)=>{if(!({ly:ta}=this.lqj(Ra,mb,Ub,!0)).returnValue)return ta;u.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");Ub=this.bnk.nua(Ra.node,Ub);this.hDn(Ra.node,Ub);this.HP();return 32};this.NAb=(ta,Ra,mb,Jb,Ub)=>{if(!({ly:ta}=this.lqj(Ra,mb,Ub,!1)).returnValue)return ta;this.dDn(Ra.node);return 32};this.fMn=(ta,Ra,mb,Jb,Ub)=>{if(1===mb)return 32;if(!Ra||!Ra.view.te)return 2;ta=Ra.view.lb;if(!ta)return 2;
ta=ta.tg;if(!ta)return 2;ta=It.Xg.PQ(ta,16);if(!ta||!ta.length)return 2;Ra=null;for(mb=0;mb<ta.length;mb++){Jb=ta.getContext(mb);if(!Jb||Jb.contextId!==sc.a.tableCell)return 2;const cc={};this.imi(Jb,cc);if(cc.CellShading)if(Ra&&Ra!==cc.CellShading){Ra=null;break}else Ra=cc.CellShading;else{Ra=null;break}}Ub.CellShading=Ra;return 32};this.mMb=(ta,Ra,mb,Jb,Ub)=>1===mb?32:this.imi(Ra,Ub);this.JLb=(ta,Ra,mb,Jb,Ub)=>{if(1===mb)return 32;ta=Ra.contextId===sc.a.view?this.fBa.nRd(Ra):this.Nsf(Ra);mb={};
Ra=null;32===w.AFrameworkApplication.va.Qb(Gb.a.mMb,2,mb)&&mb&&(Ra=mb.CellShading);mb="";Ra&&(mb=sh.a.YE(Ra)||"");this.kpj.$Nb=mb;this.OVc&&this.recentColors.uoe(mb);ta=this.kpj.aNc(ta,Xa.App.TAb);if(!ta)return 8;Ub.MenuItems=ta;u.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32};this.eia=(ta,Ra,mb,Jb,Ub)=>{if(1===mb)return 32;Xa.App.xa.dismissFloatie();w.AFrameworkApplication.va.Qb(Gb.a.mMb,2,Ub);this.I9a=new Xy.a("Shading",Gb.a.bjc);this.I9a.Xjc(Ub&&Ub.CellShading?
Ub.CellShading:0);return 32};this.cVk=(ta,Ra,mb,Jb,Ub)=>{if(1===mb)return 32;w.AFrameworkApplication.va.Qb(Gb.a.N9,2,Ub);this.recentColors.bZa(Ub)||u.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32};this.ga=b;this.bnk=h;this.uKe=v;this.fBa=D;this.Sd=P;this.tq=ca}get recentColors(){return null!=this.hGg?this.hGg:this.hGg=Ea.a.instance.Na("Box4.UI.RecentColorsSectionHandler")}get kpj(){this.FV||(this.FV=new HA.a("Shading"),this.$Ea(this.FV));
return this.FV}$Ea(b){b.LW(2,Gb.a.NAb);b.LW(3,Gb.a.N9);b.LW(4,Gb.a.N9);b.ozb(this.uKe,1)}Tb(){this.ga.qa(Gb.a.JLb,sc.a.view,this.JLb);this.ga.qa(Gb.a.JLb,sc.a.tableCell,this.JLb);this.ga.Vc(Gb.a.JLb,1126);this.ga.qa(Gb.a.mGc,sc.a.view,os.a.fNc);this.ga.qa(Gb.a.mGc,sc.a.tableCell,this.mGc);this.ga.Vc(Gb.a.mGc,1028);this.ga.qa(Gb.a.N9,sc.a.view,os.a.fNc);this.ga.qa(Gb.a.N9,sc.a.tableCell,this.wH);this.ga.Vc(Gb.a.N9,1028);this.ga.qa(Gb.a.NAb,sc.a.view,os.a.fNc);this.ga.qa(Gb.a.NAb,sc.a.tableCell,this.NAb);
this.ga.Vc(Gb.a.NAb,1028);this.ga.qa(Gb.a.mMb,sc.a.view,this.fMn);this.ga.qa(Gb.a.mMb,sc.a.tableCell,this.mMb);this.ga.Vc(Gb.a.mMb,1124);this.ga.qa(Gb.a.bjc,sc.a.view,os.a.fNc);this.ga.qa(Gb.a.bjc,sc.a.tableCell,this.cVk);this.ga.Vc(Gb.a.bjc,1028);this.ga.qa(Gb.a.cXf,sc.a.view,this.eia);this.ga.Vc(Gb.a.cXf,1028)}HP(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");
b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}lqj(b,h,v,D){return this.gCi(b,h,v,D)?{returnValue:2===h,ly:32}:(2==h&&os.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],me.a.IAl),{returnValue:!1,ly:8})}gCi(b,h,v,D){return b.contextId!==sc.a.tableCell||2===h&&(D&&!v||!b.node)?!1:!0}hDn(b,h){const v=new eh.GraphTransaction(15);v.Cb(b);this.Snj(b);b.properties.setValue(lf.a.wH,h);v.dispose()}dDn(b){const h=
new eh.GraphTransaction(15);h.Cb(b);this.Snj(b);b.properties.removeProperty(lf.a.wH);h.dispose()}Nsf(b){return b.contextId!==sc.a.tableCell?null:(b=It.Oh.Ys(b.node))?b:null}Snj(b){if(this.Sd&&this.Sd.rg&&(b=Object(Na.a)(Ft.TableCellNode,b))){const h=b.FR();this.tq.N7c(b,h)}}imi(b,h){if(b.contextId!==sc.a.tableCell)return 8;(b=b.node)&&b.hasProperty(lf.a.wH)&&(h.CellShading=b.getValue(lf.a.wH));return 32}static kQl(){return new It(w.AFrameworkApplication.va,rq.a.instance,xr.a.instance,Ih.PageReader.instance,
Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Oh(){return Wk.PageNavigator.instance}static get Xg(){return null!=It.Mxg?It.Mxg:It.Mxg=em.ContextSetEditor.instance}static get instance(){return null!=It.WCg?It.WCg:It.WCg=It.kQl()}get OVc(){null==this.MAa&&(w.AFrameworkApplication.ue("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.MAa=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",
!1):!1);return this.MAa}}Object(n.a)(It,"CellShadingActor",null,[]);class NA{constructor(){this.W=null}get name(){return"Box4.CellShading"}xc(b){this.W=b}init(){const b=this.W.Na("Box4.IFeatureHelper");b?b.Pp.continueWith(()=>{this.hn()}):this.hn()}hn(){It.instance.Tb();Xa.App.xa.updateCommandUI()}dispose(){}}Object(n.a)(NA,"CellShadingPackage",null,[1,2]);var Jt;(function(b){b[b.none=0]="none";b[b.style1=1]="style1";b[b.style2=2]="style2";b[b.style3=3]="style3";b[b.style4=4]="style4";b[b.style5=
5]="style5";b[b.bullet=6]="bullet";b[b.invalid=42]="invalid"})(Jt||(Jt={}));Object(n.b)("ListStyle",Jt);const Pz={[Jt.style1]:{[1]:"disc",[0]:"decimal"},[Jt.style2]:{[1]:"circle",[0]:"lower-alpha"},[Jt.style3]:{[1]:"square",[0]:"lower-roman"},[Jt.style4]:{[0]:"upper-alpha"},[Jt.style5]:{[0]:"upper-roman"},[Jt.bullet]:{[1]:"bullet"}};var ix;(function(b){b[b.number=0]="number";b[b.bullet=1]="bullet";b[b.lim=13]="lim";b[b.nil=14]="nil";b[b.any=15]="any";b[b.noList=16]="noList";b[b.invalid=42]="invalid"})(ix||
(ix={}));Object(n.b)("ListType",ix);var Qz=c(1621);class Op{constructor(b,h){this.NB=this.LXc=null;this.levelText=b;this.font=h}get yae(){return this.levelText}get listStyle(){return 6}get vw(){return"left"}}Object(n.a)(Op,"ListMarkerBullet",null,[498]);class mi{static get Un(){return null!=mi.UDg?mi.UDg:mi.UDg=Ea.a.instance.resolve("Box4.List.IListEditor")}static get Gd(){return mi.Hf||(mi.Hf=Ea.a.instance.resolve("Box4.List.IListReader"))}static set Gd(b){mi.Hf=b}static get tj(){return null!=mi.uBg?
mi.uBg:mi.uBg=Ea.a.instance.resolve("Box4.IInsertionPointFormatting")}static Zw(){return mi.Sm||(mi.Sm=Ea.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Xg(){return em.ContextSetEditor.instance}static get Wf(){return qi.a.instance}static get Jc(){return bf.a.instance}static get Vn(){return qn.a.getInstance()}static get b9c(){return null!=mi.TGg?mi.TGg:mi.TGg=Ea.a.instance.Na("Box4.List.ISingleLevelListEditor")}static Tb(){const b=w.AFrameworkApplication.va;b.qa(Gb.a.jD,sc.a.view,mi.GEc);
b.qa(Gb.a.jD,sc.a.outlineElement,mi.Vla);b.Vc(Gb.a.jD,1036);b.qa(Gb.a.wL,sc.a.view,mi.GEc);b.qa(Gb.a.wL,sc.a.outlineElement,mi.Vla);b.Vc(Gb.a.wL,1036);b.qa(Gb.a.Fca,sc.a.view,mi.GEc);b.qa(Gb.a.Fca,sc.a.outlineElement,mi.Vla);b.Vc(Gb.a.Fca,1036);b.qa(Gb.a.W1e,sc.a.view,Oc.ActionManager.Nf);b.qa(Gb.a.CEh,sc.a.view,Oc.ActionManager.Nf);b.qa(Gb.a.joinList,sc.a.view,mi.v6n);b.qa(Gb.a.G1e,sc.a.view,Oc.ActionManager.Nf);b.qa(Gb.a.X1e,sc.a.view,Oc.ActionManager.Nf);b.qa(Gb.a.Ihg,sc.a.view,Oc.ActionManager.Nf);
b.qa(Gb.a.Exj,sc.a.view,Oc.ActionManager.Nf);b.qa(Gb.a.vne,sc.a.view,Oc.ActionManager.Nf)}static v6n(){Qz.a.jej();return 32}static GEc(b,h,v,D,P){var ca,ta,Ra;if(!h.view.te)return 2;const mb=mi.Jc.yp(Gb.a.GEc);D.xs=42;D.zC=42;const Jb={[Ds.a.XIa]:5796,[Ds.a.WIa]:5797};var Ub=h.view;if(mi.Xg.cDa(mi.Wvm,Ub.lb.tg))return mi.Jc.Yb(qe.a.kf,{["Reason"]:me.a.$9e}),mb.end(),8;if(mi.Xg.cDa(mi.f1e,Ub.lb.tg))return mi.Jc.Yb(qe.a.kf,{["Reason"]:me.a.GHc}),mb.end(),8;if(mi.Xg.sza(fe.ParagraphReader.kU,Ub.lb.tg))return mi.Jc.Yb(qe.a.kf,
{["Reason"]:me.a.hO}),mb.end(),8;if(mi.Wf.tac(Ub.lb.tg))return mi.Jc.Yb(qe.a.kf,{["Reason"]:me.a.WE}),mb.end(),8;if(null===(ta=null===(ca=mi.Zw())||void 0===ca?void 0:ca.instance)||void 0===ta?0:ta.pU(h))return mi.Jc.Yb(qe.a.kf,{["Reason"]:me.a.externalSelection}),mb.end(),8;if(1===v)return mb.end(),32;P||(P=new Md.DictionaryPropertySet);ca=null;if(2===v){ca=new eh.GraphTransaction(15);ca.Cb(h.view.Yc);mi.pWc=!1;ta=fv.OutlineElementGeneralizer.tna(Ub.lb.gb,!1);if(!ta)return ca.dispose(),mi.Jc.Yb(qe.a.kna,
{["Reason"]:me.a.HLd}),mb.end(),8;1<ta.length&&P.setValue(Wc.a.wQi,null);const cc=P.ia(Wc.a.BJ,-1),Ac=P.ia(Wc.a.JA,-1);null===(Ra=mi.b9c)||void 0===Ra?void 0:Ra.CXk(ta);if(Ra=mi.aso(cc,Ac,ta))P.setValue(Wc.a.JA,16),P.setValue(Wc.a.VQa,0);if(!$e.SelectionEditor.gf(Ub.lb.tg)&&!Ra&&0<ta.length&&cc){Ub=new he.GraphIterator;Ra=Array(ta.length);for(let Lc=0;Lc<ta.length;Lc++)Ub.set(ta.getContext(Lc).node),Ra[Lc]=mi.Gd.qw(Ub);mi.$ro(Ra,P)&&(Ub=new Md.DictionaryPropertySet,Ub.setValue(Wc.a.JA,16),Ub.setValue(Wc.a.VQa,
0),qn.a.dY&&(Ub.setValue(Hh.a.cpa,"clean-list-before-apply-new-list-style"),Ub.setValue(Hh.a.Fha,P.ia(Hh.a.cpa,"unknown")+"@"+P.ia(Hh.a.Fha,"undefined"))),Ds.a.Ipa(b,h,v,D,Ub,Jb,11),w.AFrameworkApplication.va.processAction(Gb.a.Exj,2),u.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),mi.pWc=!0)}Ub=new he.GraphIterator;Ub.set(ta.getContext(0).node);Ub=mi.Gd.qw(Ub);mi.h5m(cc,Ac,Ub,ta.length)}b=Ds.a.Ipa(b,h,v,D,P,Jb,11);32===b&&P.ia(Wc.a.nwh,!1)&&(b=Ds.a.Ipa(Gb.a.pO,
h,v,D,P,Jb,11));ca&&ca.dispose();mb.end();return b}static $ro(b,h){let v=null;var D=!1;for(let P=b.length-1;0<=P&&(v?(D=b[P],D=-1!==h.ia(Wc.a.BJ,-3)?D?v.listType!==D.listType||v.listStyle!==D.listStyle:!0:D?v.listType!==D.listType:!0):v=b[P],!D);P--);return v&&(b=!1,D||(b=h.ia(Wc.a.JA,42),h=h.ia(Wc.a.BJ,-3),b=b!==v.listType||0<h),D||b)?!0:!1}static h5m(b,h,v,D){0>=D||mi.pWc||(b?v?(v=v.listType,-1===b&&h===v?(w.AFrameworkApplication.va.processAction(Gb.a.vne,2),u.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):
0<b&&(!h||1===h)&&(w.AFrameworkApplication.va.processAction(h?Gb.a.G1e:Gb.a.X1e,2),u.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering"))):(w.AFrameworkApplication.va.processAction(h?Gb.a.G1e:Gb.a.X1e,2),mi.JOo(),u.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering")):(w.AFrameworkApplication.va.processAction(Gb.a.vne,2),u.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static aso(b,
h,v){if(-1!==b&&b||!v.length)return!1;b=new he.GraphIterator;let D=null;for(let P=v.length-1;0<=P&&!(b.set(v.getContext(P).node),D=mi.Gd.qw(b));P--);return D&&h===D.listType?!0:!1}static Vla(b,h,v,D,P){var ca;if(h.contextId!==sc.a.outlineElement)return 2;var ta=h.clone().Qfg();if(mi.Wf.n3a(ta))return mi.Jc.Yb(qe.a.fn,{["Reason"]:me.a.WE}),2;const Ra=new he.GraphIterator;Ra.set(h.node);$e.SelectionEditor.ru(Ra);if(!ig.OutlineElementReader.Nh(Ra))return 2;if(1===v)switch(b){case Gb.a.jD:return 32;case Gb.a.wL:return 32;
case Gb.a.Fca:return 32;default:return 2}if(ig.OutlineElementReader.yQ(Ra))return mi.Jc.Yb(qe.a.fn,{["Reason"]:me.a.hO}),2;h=mi.Gd.qw(Ra);var mb;qn.a.dY&&(mb=Object.freeze(null===h||void 0===h?void 0:h.clone()));let Jb=P;if(!Jb)return 8;b===Gb.a.wL||b===Gb.a.jD||b===Gb.a.Fca?(Jb=mi.Un.oLc(b,Jb),ta=Iu.a.n_(Jb.getValue(Wc.a.JA),Jb.getValue(Wc.a.VQa))):ta=null;mi.l0(b,Jb);mi.zlo(ta,Jb);let Ub=!1;b===Gb.a.jD&&Jb&&(Jb.hasProperty(Bc.a.ov)&&(ta.levelText=Jb.ia(Bc.a.ov,"")),Jb.hasProperty(lf.a.font)&&(ta.font=
Jb.ia(lf.a.font,"")),Jb.hasProperty(Wc.a.bmf)&&(Ub=Jb.ia(Wc.a.bmf,!1)));mi.gno(Jb,Ra);ta=mi.Un.Vla(Jb,Ra,ta,Ub);if(!ta.returnValue)return mi.Jc.Yb(qe.a.fn,{["Reason"]:me.a.QJf}),2;ta=ta.qwa;qn.a.dY&&mi.YSn(P,mb,ta);2===v&&(v=P.ia(Wc.a.JA,-1),ta&&-1!==v&&((mb=P.ia(Bc.a.Wr,"Invalid MultiLevel Type"),b===Gb.a.wL&&u.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===P||void 0===P?void 0:P.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,
["listStyle"]:Jt[null==(null===h||void 0===h?void 0:h.listStyle)?null===ta||void 0===ta?void 0:ta.listStyle:null===h||void 0===h?void 0:h.listStyle],["listType"]:ix[null==(null===h||void 0===h?void 0:h.listType)?null===ta||void 0===ta?void 0:ta.listType:null===h||void 0===h?void 0:h.listType],["cleared"]:16===(null===ta||void 0===ta?void 0:ta.listType)})),h)?ta.listType&&1!==ta.listType||mi.pWc||(w.AFrameworkApplication.va.processAction(Gb.a.Ihg,2),u.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",
v?"Bullet":"Numbering",mb)):16===ta.listType?(w.AFrameworkApplication.va.processAction(Gb.a.CEh,2),u.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",v?"Bullet":"Numbering",mb)):ta.listType&&1!==ta.listType||mi.pWc||(w.AFrameworkApplication.va.processAction(Gb.a.W1e,2),u.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",v?"Bullet":"Numbering",mb))),(b=bd.FocusManager.instance())&&b.currentScope&&b.currentScope.name===xk.AppFrame.hqa&&b.cD(Ne.AFrame.Pn));
D.xs=ta.listType;D.zC=ta.listStyle;(null===(ca=w.AFrameworkApplication.K)||void 0===ca?0:ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&yo.a.instance.M5a("List");return 32}static YSn(b,h,v){var D,P,ca,ta,Ra,mb,Jb,Ub;const cc=new Map;cc.set("actionCallSource",b.ia(Hh.a.cpa,"unknown"));cc.set("actionCallSourceTrigger",b.ia(Hh.a.Fha,"undefined"));cc.set("fromListType",ix[null!==(D=null===h||void 0===h?void 0:h.listType)&&void 0!==D?D:16]);cc.set("fromListStyle",Jt[null!==
(P=null===h||void 0===h?void 0:h.listStyle)&&void 0!==P?P:0]);cc.set("fromListMarkerType",null!==(Ra=k(null!==(ca=null===h||void 0===h?void 0:h.listStyle)&&void 0!==ca?ca:0,null!==(ta=null===h||void 0===h?void 0:h.listType)&&void 0!==ta?ta:16))&&void 0!==Ra?Ra:"undefined");cc.set("fromLevelText",(null===h||void 0===h?0:h.Yna)?h.levelText:"undefined");cc.set("toListType",null!==(mb=ix[null===v||void 0===v?void 0:v.listType])&&void 0!==mb?mb:"undefined");cc.set("toListStyle",null!==(Jb=Jt[null===v||
void 0===v?void 0:v.listStyle])&&void 0!==Jb?Jb:"undefined");cc.set("toListMarkerType",null!==(Ub=k(null===v||void 0===v?void 0:v.listStyle,null===v||void 0===v?void 0:v.listType))&&void 0!==Ub?Ub:"undefined");cc.set("toLevelText",(null===v||void 0===v?0:v.Yna)?v.levelText:"undefined");va.Health.instance.recordKpiUsage(Ph.a.Fkb.w0m,0,Ph.a.tB,cc)}static gno(b,h){var v=new he.GraphIterator;v.Zc(h);(h=v.Sb(2))&&fe.ParagraphReader.Wb(h)&&(v=Yh.a.instance.gb.kb)&&v.Oa&&v.Oa.node===h&&$e.SelectionEditor.L_d(v)&&
(mi.Njo(b),mi.Ljo(b))}static zlo(b,h){h.hasProperty(Bc.a.Wr)&&b.rhe(h.getValue(Bc.a.Wr));h.hasProperty(Hh.a.pQ)&&(b.pQ=h.getValue(Hh.a.pQ));h.hasProperty(Bc.a.ov)&&(b.levelText=h.getValue(Bc.a.ov));b.BJ=h.ia(Wc.a.BJ,-1);let v=null;b.Poa&&(v=mi.A2l(b,h));b.Poa&&v?mi.bno(b,v):(b.Poa?u.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",b.BJ,b.Wr,b.zz):u.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),
mi.Bio(b))}static Bio(b){if(b.zz)b.lVd&&-1===b.BJ||(b.levelText="%1.",b.propertySet.hasProperty(lf.a.C4)||b.Q9(0,1));else if(1===b.listType)b.lVd&&-1===b.BJ||(b.font=Ph.a.qJc,b.levelText=Ph.a.fId,b.propertySet.hasProperty(lf.a.C4)||b.Q9(1,6));else return;b.vw="left"}static bno(b,h){1===b.Wr?mi.Tlo(b,h):mi.lko(b,h)}static Tlo(b,h){(b.NB=h.NB)?b.J5=h.NB.J5:h.NB||u.ULS.sendTraceTag(588022422,393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",
b.BJ,b.Wr,b.zz)}static lko(b,h){b.levelText=h.levelText;b.zz?b.Q9(0,h.listStyle):(b.font=h.font,b.Q9(1,1));b.vw=h.vw}static A2l(b,h){let v=null;2===b.Wr?v=b.zz?Ea.a.instance.Na("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Ea.a.instance.Na("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===b.Wr&&(v=Ea.a.instance.Na("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let D=v.eJb.value;const P=b.BJ+"";P in D||(D=v.Z8,u.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",
P,b.Wr,b.zz));if(!(P in D)){u.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",P,b.Wr,b.zz);if(h.hasProperty(lf.a.font))return u.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",P,b.Wr,b.zz),b=h.ia(lf.a.font,""),new Op(G.a.fromCharCode(parseInt(P)),b);u.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",
P,b.Wr,b.zz)}return D[P]}static Ljo(b){mi.tj.hasProperty(lf.a.fontColor)&&b.setValue(lf.a.fontColor,mi.tj.fontColor())}static Njo(b){mi.tj.hasProperty(lf.a.fontSize)&&b.setValue(lf.a.fontSize,mi.tj.fontSize())}static l0(b,h){b=b===Gb.a.jD?0:b===Gb.a.wL?1:b===Gb.a.Fca?2:-1;h=h.ia(Wc.a.BJ,-1);u.ULS.sendTraceTag(22923024,324,50,"ListType: {0}, ListStyleId: {1}",b,h)}static JOo(){const b=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");if(b){var h=w.AFrameworkApplication.K.mc("WordDefaultToEditFloodgateDelayInMilliseconds",
6E4);b.execute(v=>{window.setTimeout(()=>{v.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},h)})}else u.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}mi.Wvm=oe.ImageReader.IUc;mi.f1e=oe.ImageReader.B2a;mi.Hf=null;mi.Sm=null;mi.pWc=!1;Object(n.a)(mi,"ListActor",null,[]);class Pp{constructor(){this.eJb=new Gg.a(()=>this.ibf());this.Z8={}}O3h(b){return b}}Object(n.a)(Pp,"AListMarkerGalleryLoader",null,[500]);var Tv=c(1383),
Dw=c(438);class mp extends Pp{constructor(){super();this.rvb=new ec.a(Va.a.Fh())}O3h(b){mp.rQ||this.Aho();b in mp.rQ&&(b=mp.rQ[b]);return b}ibf(){const b={};b["0"]=new Op(Box4Intl.Box4Strings.L_ListStyleNone,Tv.a.Nti);b["1"]=new Op(String.fromCharCode(61623),"Symbol");b["2"]=new Op(String.fromCharCode(111),"Courier New");b["3"]=new Op(String.fromCharCode(61607),"Wingdings");b["4"]=new Op(String.fromCharCode(9643),"Courier New");b["5"]=new Op(String.fromCharCode(61611),"Wingdings");b["6"]=new Op(String.fromCharCode(61614),
"Symbol");b["7"]=new Op(String.fromCharCode(61483),"Symbol");b["8"]=new Op(String.fromCharCode(61485),"Symbol");b["9"]=new Op(String.fromCharCode(9830),"Courier New");b["10"]=new Op(String.fromCharCode(61664),"Symbol");b["11"]=new Op(String.fromCharCode(61558),"Wingdings");b["12"]=new Op(String.fromCharCode(61656),"Wingdings");b["13"]=new Op(String.fromCharCode(61514),"Wingdings");b["14"]=new Op(String.fromCharCode(61516),"Wingdings");b["15"]=new Op(String.fromCharCode(61692),"Wingdings");b["16"]=
new Op(String.fromCharCode(61691),"Wingdings");b["17"]=new Op(String.fromCharCode(61553),"Wingdings");return b}goe(b){b&&b.length&&this.m5e(b)}C_f(){if(this.Z8){var b=Dw.a(this.Z8),h=b.length;for(let v=0;v<h;v++){const D=this.Z8[b[v]];this.rvb.add(D.levelText+"_"+D.font)}}}m5e(b){this.C_f();for(const h of b)if(h&&!h.zz&&h.Yna&&h.XQc&&(b=h.levelText+"_"+h.font,!this.rvb.contains(b))){const v=Dw.a(this.Z8).length+Dw.a(this.eJb.value).length+"";this.Z8[v]=new Op(h.levelText,h.font);this.rvb.add(b)}}Aho(){mp.rQ=
{};mp.rQ["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;mp.rQ["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;mp.rQ["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;mp.rQ["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;mp.rQ["Wingdings 0x00ab"]=Box4Intl.Box4Strings.L_Star;mp.rQ["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;mp.rQ["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;mp.rQ["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;mp.rQ["Courier New 0x2666"]=
Box4Intl.Box4Strings.L_BlackDiamond;mp.rQ["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;mp.rQ["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;mp.rQ["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;mp.rQ["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;mp.rQ["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;mp.rQ["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;mp.rQ["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;mp.rQ["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}
mp.rQ=null;Object(n.a)(mp,"ListMarkerBulletLoader",Pp,[]);class br{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(n.a)(br,"InfoAtLevel",null,[]);class Ir{constructor(b){this.NB=b}get font(){return"Calibri"}get listStyle(){return 42}get vw(){return"left"}get yae(){return this.NB?this.aIn():this.cIn()}get LXc(){return this.NB?this.bIn():null}get levelText(){return""}OXl(b){switch(b){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}aIn(){let b=
"";for(let h=0;3>h;h++)b+=this.APc(h);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Ir.npf(),b)}bIn(){const b=[];for(let h=0;3>h;h++)b.push(Object.assign(new br,{textAtLevel:this.Iei(h),styleAtLevel:this.Aem(h)}));return b}cIn(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Ir.opf(),Box4Intl.Box4Strings.L_ListStyleNone)}Iei(b){b=this.NB.MXc[b];for(let h=0;9>h;h++)b=G.a.replaceAll(b,"%"+(h+1),this.OXl(this.NB.hJb[h]));return b}Aem(b){const h=
{};h.fontFamily=6===this.NB.hJb[b]?this.NB.dEa[b]:this.font;return h}APc(b){const h=this.Iei(b),v=new Sys.StringBuilder;6===this.NB.hJb[b]&&v.append(String.format("font-family:{0};",this.NB.dEa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
b,v.toString(),h)}static npf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static opf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(n.a)(Ir,"ListMarkerMultilevel",null,[498]);var Zy=c(1395);class OA extends Pp{constructor(){super()}ibf(){const b=new Zy.a,h={};h["0"]=new Ir(null);h["1"]=new Ir(b.Daf());h["2"]=new Ir(b.wbf("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));h["3"]=new Ir(b.VKh([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return h}goe(){}}Object(n.a)(OA,"ListMarkerMultilevelLoader",Pp,[]);var cq=c(135);class np{constructor(b,h){this.NB=null;this.levelText=b;this.vod=h}get font(){return"Calibri"}get listStyle(){return this.vod}get vw(){switch(this.vod){case 3:case 5:return"right";default:return"left"}}get yae(){switch(this.vod){case 1:return this.Cgc("1",
"2","3");case 2:return this.Cgc("a","b","c");case 3:return this.Cgc("i","ii","iii");case 4:return this.Cgc("A","B","C");case 5:return this.Cgc("I","II","III");case 0:return this.dIn();default:return this.Cgc("1","2","3")}}get LXc(){const b=[],h={};h.fontFamily=cq.FontUtils.gDa(this.font);switch(this.vod){case 1:return b.push(Object.assign(new br,{textAtLevel:this.DX("1"),styleAtLevel:h})),b.push(Object.assign(new br,{textAtLevel:this.DX("2"),styleAtLevel:h})),b.push(Object.assign(new br,{textAtLevel:this.DX("3"),
styleAtLevel:h})),b;case 2:return b.push(Object.assign(new br,{textAtLevel:this.DX("a"),styleAtLevel:h})),b.push(Object.assign(new br,{textAtLevel:this.DX("b"),styleAtLevel:h})),b.push(Object.assign(new br,{textAtLevel:this.DX("c"),styleAtLevel:h})),b;case 3:return b.push(Object.assign(new br,{textAtLevel:this.DX("i"),styleAtLevel:h})),b.push(Object.assign(new br,{textAtLevel:this.DX("ii"),styleAtLevel:h})),b.push(Object.assign(new br,{textAtLevel:this.DX("iii"),styleAtLevel:h})),b;case 4:return b.push(Object.assign(new br,
{textAtLevel:this.DX("A"),styleAtLevel:h})),b.push(Object.assign(new br,{textAtLevel:this.DX("B"),styleAtLevel:h})),b.push(Object.assign(new br,{textAtLevel:this.DX("C"),styleAtLevel:h})),b;case 5:return b.push(Object.assign(new br,{textAtLevel:this.DX("I"),styleAtLevel:h})),b.push(Object.assign(new br,{textAtLevel:this.DX("II"),styleAtLevel:h})),b.push(Object.assign(new br,{textAtLevel:this.DX("III"),styleAtLevel:h})),b;case 0:return null;default:return b.push(Object.assign(new br,{textAtLevel:this.DX("1"),
styleAtLevel:h})),b.push(Object.assign(new br,{textAtLevel:this.DX("2"),styleAtLevel:h})),b.push(Object.assign(new br,{textAtLevel:this.DX("3"),styleAtLevel:h})),b}}Cgc(b,h,v){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',np.npf(),this.APc(b),this.APc(h),this.APc(v))}dIn(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',np.opf(),Box4Intl.Box4Strings.L_ListStyleNone)}APc(b){b=this.DX(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}DX(b){return G.a.replaceAll(this.levelText,"%1",b)}static npf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static opf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(n.a)(np,"ListMarkerNumbering",null,[498]);class Ew extends Pp{constructor(){super();this.rvb=new ec.a(Va.a.Fh())}nTm(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}ibf(){const b=
{};b["0"]=new np(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new np("%1.",5);b["2"]=new np("%1.",4);b["3"]=new np("%1.",1);b["4"]=new np("%1.",2);b["5"]=new np("%1.",3);b["6"]=new np("%1)",5);b["7"]=new np("%1)",4);b["8"]=new np("%1)",1);b["9"]=new np("%1)",2);b["10"]=new np("%1)",3);b["11"]=new np("(%1)",5);b["12"]=new np("(%1)",4);b["13"]=new np("(%1)",1);b["14"]=new np("(%1)",2);b["15"]=new np("(%1)",3);return b}goe(b){b&&b.length&&this.m5e(b)}C_f(){if(this.Z8){var b=Dw.a(this.Z8),h=b.length;
for(let v=0;v<h;v++){const D=this.Z8[b[v]];this.rvb.add(D.levelText+"_"+D.listStyle)}}}m5e(b){this.C_f();for(const h of b)if(h&&h.zz&&h.Yna&&this.nTm(h.levelText)&&h.listStyle&&(b=Tv.a.Nmf(h.levelText))){const v=b+"_"+h.listStyle;if(!this.rvb.contains(v)){const D=Dw.a(this.Z8).length+Dw.a(this.eJb.value).length+"";this.Z8[D]=new np(b,h.listStyle)}this.rvb.add(v)}}}Object(n.a)(Ew,"ListMarkerNumberingLoader",Pp,[]);class sr{constructor(){this.W=null}get name(){return"Box4.ListMarker"}init(){mi.Tb()}dispose(){}xc(b){this.W=
b;this.W.ha("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new mp).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new Ew).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new OA).singleInstance()}static main(){N.a.instance.Fc(new sr)}}Object(n.a)(sr,"Box4ListMarkerPackage",null,[1,2]);class jx{static get Yg(){return bg.a.vA(jx.Km,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,
"")}}jx.Km="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(n.a)(jx,"DefineNewBulletDialogHtml",null,[]);class Es extends bg.a{constructor(b,h,v,D){super();this.Jwc=this.vJe=this.XWb=this.QWb=null;this.Yvb=0;this.cFc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.hri=!0;this.yjl=P=>{if(this.QWb&&P.target!==this.QWb){const ca=this.focusManager.Ts();ca&&ca.fk&&(ca.fk.Ly(P.target),this.QWb=P.target)}this.Qun(P.target.id)};this.g0m=P=>{P=P.xf;if(!this.UDi(P))return!1;this.focusManager.Ts().fk.Ly(P);P.focus();return!0};this.h0m=P=>{var ca=
P.xf;if(!this.UDi(ca))return!1;var ta=ca.id;ta=parseInt(ta.substr(ta.lastIndexOf("_")+1))-this.Yvb;if(P.Hb.ctrlKey||P.Hb.altKey||P.Hb.keyCode>=Ve.a.jSb&&P.Hb.keyCode<=Ve.a.kSb)return!1;const Ra=P.Hb.keyCode;if(P.eventName===Ed.a.ai){P=-1;if(Ra===Sys.UI.Key.enter)return this.focusManager.Ts().fk.Ly(ca),ca.focus(),this.AVi(ca.id),this.hide(),!0;Ra===Sys.UI.Key.up?P=ta-17:Ra===Sys.UI.Key.down?P=ta+17:Ra===Sys.UI.Key.left?P=w.AFrameworkApplication.isRtl?ta+1:ta-1:Ra===Sys.UI.Key.right&&(P=w.AFrameworkApplication.isRtl?
ta-1:ta+1);0<=P&&(ca=this.tbi(Es.R4b+"_"+(P+this.Yvb)))&&ca.focus()}return!0};this.xjl=P=>{1===P&&this.AVi(this.XWb);this.hide()};this.wu=b;this.focusManager=h;this.ga=v;this.rS=!1;D&&(b=D.indexOf(","),-1!==b&&(D=D.substring(0,b)));this.fontName=D;this.wg="DefineNewBulletDialog";this.Yg=jx.Yg;this.Ee(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ee(0,CommonUIStrings.l_DialogClose);this.Wh(Box4Intl.Box4Strings.L_SymbolSingle,this.xjl,null);this.N$=!1;this.$Ga();document.getElementById(Es.eNd).focus()}$Ga(){this.focusManager.Ts().scope.jr(bd.FocusManager.instance().uW);
this.focusManager.Ts().scope.jr(bd.FocusManager.instance().vW);this.focusManager.Ts().scope.bindAction(bd.FocusManager.instance().uW,Gb.a.rId);this.focusManager.Ts().scope.bindAction(bd.FocusManager.instance().vW,Gb.a.qId)}k9(){this.lCd(Es.eNd,"DefineNewBulletFontPlaceholder",Gb.a.pId.toString(),Gb.a.qMb.toString(),Gb.a.T1c.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.WNk()}vL(){super.vL();document.getElementById(this.mj("WACDialogPanel")).style.width="auto"}lCd(b,h,v,D,P,ca,ta){v=Ii.c(b,
v,!0,!0,D,P,G.a.yf(ca),!0,ta);this.TGd(b,h,v,"Medium")}WNk(){const b=document.getElementById(Es.R4b);b&&(b.innerHTML=this.f8h(),this.C9i(b))}C9i(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let h=0;h<b.length;h++)Le.a.addHandler(b[h],Ed.a.focus,this.yjl)}AWo(){var b=document.getElementById(Es.R4b);if(b){let h=this.fontName;const v=Tv.a.TBf(this.fontName);v&&61472!==this.Yvb||!v&&32!==this.Yvb?(b.innerHTML=this.f8h(),this.C9i(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&
h&&(h=this.cph(h),b[0].style.fontFamily=h)}}Qun(b){this.Cmj(this.XWb,!1);this.XWb=b;this.Cmj(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.XWb){let h=parseInt(this.XWb.substr(this.XWb.lastIndexOf("_")+1));-1!==h&&(h-=61472===this.Yvb?61440:0,b.innerText=G.a.XI(h,4))}}Cmj(b,h){(b=this.tbi(b))&&(h?b.setAttribute("selected","true"):b.removeAttribute("selected"))}tbi(b){const h=document.getElementById(Es.R4b);return h?h.querySelector("#"+b):null}bma(){const b=document.getElementById(Es.R4b);
b&&(this.vJe||(this.vJe=this.g0m,this.Mq.nb(Ed.a.click,b,this.vJe)),this.Jwc||(this.Jwc=this.h0m,this.ae.nb(Ed.a.ai,b,this.Jwc),this.ae.nb(Ed.a.ju,b,this.Jwc),this.ae.nb(Ed.a.uh,b,this.Jwc)));super.bma()}UDi(b){return b.classList.contains("DefineNewBulletTableCell")}AVi(b){if(b){b=b.split("_");const h=new Md.DictionaryPropertySet;h.setValue(Wc.a.BJ,parseInt(b[1]));h.setValue(lf.a.font,this.fontName);h.setValue(Wc.a.JA,1);qn.a.dY&&(h.setValue(Hh.a.cpa,"command-ui"),h.setValue(Hh.a.Fha,"define-new-bullet-dialog"));
this.ga.Qb(Gb.a.jD,2,h)}this.focusManager.pL(this.UK,!0)}f8h(){const b=new Sys.StringBuilder,h=Tv.a.TBf(this.fontName);let v=this.fontName;v=this.cph(v);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',v));h?(this.Yvb=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.Yvb=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}cph(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}TGd(b,h,v,D){h=document.getElementById(h);this.wu.YYa(b,v);v=this.wu.rEb(b,D);h.appendChild(v);this.wu.Npa(b)}dispose(){this.rS||(this.wu.BY(Es.eNd),this.rS=!0);super.dispose()}}Es.eNd="DefineNewBulletFontStyleComboBox";Es.R4b="DefineNewBulletTableContainer";Object(n.a)(Es,"DefineNewBulletDialog",bg.a,[]);class Ws{WOc(){return Gb.a.c0m}zPc(){return Gb.a.$Zf}}Object(n.a)(Ws,"ListMarkerGalleryBulletCommands",
null,[574]);class kx{WOc(){return Gb.a.e0m}zPc(){return Gb.a.jFn}}Object(n.a)(kx,"ListMarkerGalleryMultilevelCommands",null,[574]);class $r{WOc(){return Gb.a.f0m}zPc(){return Gb.a.a_f}}Object(n.a)($r,"ListMarkerGalleryNumberingCommands",null,[574]);class Uv{constructor(b,h,v,D,P){this.iAa=this.hLa=null;this.kQh=ca=>{if(!this.iAa)return 2;if(this.iAa.focusManager.Ts().fk.y3.id.startsWith(Es.R4b)){let ta=null;ca===Gb.a.rId?ta=this.iAa.DZa:ca===Gb.a.qId&&(ta=document.getElementById(Es.eNd));if(!ta)return 2;
this.iAa.focusManager.Ts().fk.Ly(ta);ta.focus()}else if(ca===Gb.a.rId)this.iAa.focusManager.Ts().jec();else if(ca===Gb.a.qId)this.iAa.focusManager.Ts().hec();else return 2;return 32};this.MGi=(ca,ta)=>{ca=null;ta.view.te&&(ca=ta.view);return ca&&ca.lb?32:(Kc.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",ta.toString()),8)};this.VYm=(ca,ta,Ra)=>{var mb;return 1===Ra?32:2===Ra?((null===(mb=w.AFrameworkApplication.K)||
void 0===mb?0:mb.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&yo.a.instance.M5a("ListDefine"),ca=this.S8b(ta),ca=Kl.FormattingReader.Nr(ca).cache.tG,this.iAa=new Es(this.plk,bd.FocusManager.instance(),w.AFrameworkApplication.va,ca),32):8};this.T1c=(ca,ta,Ra,mb,Jb)=>{if(1===Ra)return 32;if(2===Ra&&!Jb)return 8;if(this.iAa.hri){for(ca=0;ca<Tv.a.cFc.length;ca++)cq.FontUtils.CDj(Tv.a.cFc[ca]);this.iAa.hri=!1}Vh.a.OWd(ta);Jb.PopulationXML=cq.FontUtils.t3h(Vh.a.Gie,Vh.a.pmf,
Gb.a.pId);return 32};this.iFn=(ca,ta,Ra,mb,Jb)=>{ca=ta.contextId===sc.a.outlineElement;if(1===Ra||!ca)return ca?32:8;if(2===Ra&&!Jb)return 8;Jb.MenuItems=this.Gak.E2l();return 32};this.wjl=(ca,ta,Ra,mb,Jb)=>{if(1===Ra)return 32;if(2===Ra){ca=Object(Na.a)(29,Jb);if(!ca||!ca.xd)return 8;this.iAa.fontName=ca.xd.fontName;this.iAa.AWo();return 32}return 8};this.ga=b;this.Hf=D.resolve("Box4.List.IListReader");this.I6=h;this.plk=v;switch(this.I6){case 0:b=D.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");
this.hLa=new Ws;break;case 1:b=D.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");this.hLa=new $r;break;case 2:b=D.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.hLa=new kx;break;default:b=D.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),this.hLa=new Ws}P=this.Hf?this.Hf.r2l(P):null;b.goe(P);this.Gak=new Tv.a(h,b,P,!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.fIb)}Tb(){this.ga.qa(this.hLa.zPc(),sc.a.view,Xa.App.WTa.oLh(11));this.ga.qa(this.hLa.zPc(),
sc.a.outlineElement,this.iFn);this.ga.Vc(this.hLa.zPc(),1124);this.I6||(this.ga.eb(Gb.a.SIf,sc.a.view,this.VYm,1028),this.ga.eb(Gb.a.T1c,sc.a.view,this.T1c,1124),this.ga.eb(Gb.a.pId,sc.a.view,this.wjl,1028),this.ga.eb(Gb.a.rId,ud.a.frame,this.kQh,64),this.ga.eb(Gb.a.qId,ud.a.frame,this.kQh,64));this.ga.qa(this.hLa.WOc(),sc.a.view,this.MGi);this.ga.qa(this.hLa.WOc(),sc.a.outlineElement,this.MGi);this.ga.Vc(this.hLa.WOc(),1124)}S8b(b){return this.zOd(b).Oa}zOd(b){let h=null;b=b.view;return b?h=$e.SelectionEditor.Cj(b.lb.gb.J(0),
!1,!1):h}}Object(n.a)(Uv,"ListMarkerGalleryActor",null,[452]);class lx{constructor(){this.Fe=this.W=null}get name(){return"Box4.ListMarkerGallery"}init(){if(Pb.InteractiveViewManager.instance){var b=Pb.InteractiveViewManager.instance;b.editingView&&(this.Fe=b.editingView.Yc,this.qXn())}}dispose(){}xc(b){this.W=b}qXn(){(new Uv(w.AFrameworkApplication.va,1,this.W.resolve("Common.IStandaloneRootController").sda,this.W,this.Fe)).Tb();(new Uv(w.AFrameworkApplication.va,0,this.W.resolve("Common.IStandaloneRootController").sda,
this.W,this.Fe)).Tb();(new Uv(w.AFrameworkApplication.va,2,this.W.resolve("Common.IStandaloneRootController").sda,this.W,this.Fe)).Tb()}static main(){N.a.instance.Fc(new lx)}}Object(n.a)(lx,"Box4ListMarkerGalleryPackage",null,[1,2]);var Vv=c(425),mx=c(486),MC=c(446),Fs=c(125);const nx=b=>{b.element.style.top=""};var mv=c(702);class PA{constructor(b,h,v){this.sH=!1;this.k$a=0;this.iea=this.x$g=null;this.vl=b;this.tmk=h;this.qt=v;this.A6=b.ownerDocument.createElement("div");this.htmlElement.className=
"WACBusinessBar";(this.Lw=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.yJ)&&!this.qt.Mff&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";aa.a.lj&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.A6}get visible(){return this.sH}set_visible(b){if(this.sH!==b)return(this.sH=b)?this.Y2e():this.HJc(),b}dispose(){this.visible&&this.HJc();ic.a.f_(this.htmlElement);this.vl=this.A6=null}csj(b,h){const v=
b.htmlElement||b.createElement();h===this.htmlElement.childNodes.length?this.htmlElement.appendChild(v):this.htmlElement.insertBefore(v,this.htmlElement.childNodes[h]);b.xej();this.k$a+=b.htmlElement.clientHeight;var D=this.htmlElement.childNodes,P=b.psh,ca=Object(z.a)(this,this.vln,"onAfterShowEntry");Fs.WacAirSpace.YU(v,"Shared_BasicClass");var ta=new MC.a(v);ta.Pta(0,1);const Ra=new mx.a(v);Ra.kCa(v.clientTop-30,v.clientTop);P?(Fs.WacAirSpace.Dlb(ta,null,null),Fs.WacAirSpace.Dlb(Ra,null,ca)):(Fs.WacAirSpace.animate(ta,
null,null),Fs.WacAirSpace.animate(Ra,null,ca));for(h+=1;h<D.length;h++)ca=D[h],Fs.WacAirSpace.YU(ca,"Shared_BasicClass"),ta=new mx.a(ca),ta.kCa(ca.clientTop-v.clientHeight,ca.clientTop),P?Fs.WacAirSpace.Dlb(ta,null,null):Fs.WacAirSpace.animate(ta,null,null);b.$wo();this.set_visible(!0)}ioi(b){const h=b.htmlElement;if(ic.a.$ac(h)){this.k$a-=b.htmlElement.clientHeight;var v=h.parentNode.children;b=b.psh;var D=Object(z.a)(this,this.oln,"onAfterHideEntry");Fs.WacAirSpace.YU(h,"Shared_BasicClass");var P=
new Vv.a(h);P.Pta(1,0);b?Fs.WacAirSpace.Dlb(P,null,D):Fs.WacAirSpace.animate(P,null,D);D=!1;for(P=0;P<v.length;P++){if(D){const ca=v[P];Fs.WacAirSpace.YU(ca,"Shared_BasicClass");const ta=new mx.a(ca);ta.kCa(ca.clientTop,-h.clientHeight);b?Fs.WacAirSpace.Dlb(ta,null,nx):Fs.WacAirSpace.animate(ta,null,nx)}D||v[P]!==h||(D=!0)}}}vln(b){b.element.style.top="";w.AFrameworkApplication.ta.n_c()}oln(b){b.element.parentNode.removeChild(b.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);w.AFrameworkApplication.ta.n_c()}Y2e(){""===
this.vl.style.top.trim()&&(this.vl.style.top=this.vl.offsetTop+"px");this.htmlElement.style.left=this.vl.style.left;this.htmlElement.style.top=this.vl.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.x$g=this.vl.style.top;this.k$a=b.height;this.woe();w.AFrameworkApplication.ta.WZ(Object(z.a)(this,this.onResize,"onResize"));Le.a.addHandler(this.htmlElement,Ed.a.Qfe,Le.a.A2b);this.iea=Object(z.a)(this,
this.eDa,"contextMenuHandler");w.AFrameworkApplication.ta.Vya.nb(this.htmlElement,this.iea,null);if(bd.FocusManager.bK()){var h=bd.FocusManager.instance();b=h.fe(mv.a.gNa);b.parent=Ne.AFrame.rp;const v=new Ee.DOMFocusListing(()=>this.htmlElement);v.Wm(1);v.Wm(2);v.Wm(8);h.hma(()=>this.htmlElement,b,v);h=h.getRegion(mv.a.gNa);h.vSa();h.oR=!0;h.f_a=!0;const D=w.AFrameworkApplication.ta.ox;b.ZYa(()=>{D.Xw(mv.a.gNa)});D.dT(mv.a.gNa);(v.zga||w.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled"))&&D.FI(mv.a.gNa)}}HJc(){this.Frj()&&
(this.vl.style.top=this.x$g);this.htmlElement.style.visibility="hidden";w.AFrameworkApplication.ta&&(bd.FocusManager.bK()&&bd.FocusManager.instance().N5a(mv.a.gNa),this.iea&&(w.AFrameworkApplication.ta.Vya.sc(this.htmlElement,this.iea),this.iea=null));Le.a.removeHandler(this.htmlElement,Ed.a.Qfe,Le.a.A2b)}woe(){if(this.Frj()&&this.visible){var b=this.vl,h=this.k$a+this.tmk;const v=ic.a.VM(b.style.top);Fs.WacAirSpace.YU(b,"Shared_BasicClass");b=new mx.a(b);b.kCa(v,h);Fs.WacAirSpace.animate(b,null,
null)}}Frj(){return!this.Lw&&!this.qt.Mff}onResize(){const b=this.qt.entries.length,h=Sys.UI.DomElement.getBounds(this.htmlElement).height;let v;for(let D=0;D<b;++D)v=this.qt.entries[D],v.htmlElement&&v.xej();this.k$a=Sys.UI.DomElement.getBounds(this.htmlElement).height;h!==this.k$a&&this.woe()}eDa(){return!0}}Object(n.a)(PA,"BusinessBarDom",null,[1213,10]);var Lu;(function(b){b[b.none=0]="none";b[b.corruptPage=1]="corruptPage";b[b.currentPageStatus=2]="currentPageStatus";b[b.documentMarkedAsFinal=
3]="documentMarkedAsFinal";b[b.documentSigned=4]="documentSigned";b[b.fileAccess=5]="fileAccess";b[b.kickoutWithDataLoss=6]="kickoutWithDataLoss";b[b.lostSession=7]="lostSession";b[b.malformedHyperlinkUris=8]="malformedHyperlinkUris";b[b.odt=9]="odt";b[b.readonlyRecommended=10]="readonlyRecommended";b[b.saveReplaySuccess=11]="saveReplaySuccess";b[b.saveReplayFailed=12]="saveReplayFailed";b[b.unsupportedObjects=13]="unsupportedObjects";b[b.word11Compat=14]="word11Compat";b[b.unsupportedBrowser=15]=
"unsupportedBrowser";b[b.applicationNotification=16]="applicationNotification";b[b.skypeDocChatFailed=17]="skypeDocChatFailed";b[b.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";b[b.sessionExpired=19]="sessionExpired";b[b.irmPolicyDescription=20]="irmPolicyDescription";b[b.policyWarningMessage=21]="policyWarningMessage";b[b.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";b[b.gdprPrivacyNotice=23]="gdprPrivacyNotice";b[b.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";
b[b.graphMergePrompt=25]="graphMergePrompt";b[b.readOnlyDocument=26]="readOnlyDocument";b[b.dictationSilence=27]="dictationSilence";b[b.autoSensitivityLabel=28]="autoSensitivityLabel";b[b.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";b[b.dictationDebugInfo=30]="dictationDebugInfo";b[b.oneNoteCovid19Message=31]="oneNoteCovid19Message";b[b.citationStylePrompt=32]="citationStylePrompt";b[b.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";b[b.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";
b[b.oneNotePagePrintReady=35]="oneNotePagePrintReady";b[b.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";b[b.mandatoryLabel=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.minorVersionLimit=39]="minorVersionLimit";b[b.testEntry1=40]="testEntry1";b[b.testEntry2=41]="testEntry2";b[b.testEntry3=42]="testEntry3";b[b.testEntry4=43]="testEntry4";b[b.testEntry5=44]="testEntry5";b[b.testEntry6=45]="testEntry6";b[b.testEntry7=46]="testEntry7"})(Lu||(Lu={}));Object(n.b)("BusinessBarId",
Lu);class ot{constructor(b,h=0,v=null,D=null){this.n2g=this.NSg=!1;this.pYb=null;this.aB=[];this.YUa=D||new PA(b,h,this);this.DAm(v)}DAm(b){if(b){this.pYb={};b=b.ranking;for(let h=0;h<b.length;h++)this.pYb[Lu[b[h]]]=h}}dispose(){this.YUa.dispose();Da.a.f9f(this.aB);this.aB=null}get htmlElement(){return this.YUa.htmlElement}get visible(){return this.YUa.visible}get Mff(){return this.NSg}set Mff(b){this.NSg=b}get MFf(){return this.n2g}set MFf(b){this.n2g=b}get entries(){return this.aB}set entries(b){this.aB=
b}bY(b){for(let h=0;h<this.aB.length;h++)if(this.aB[h].id===b)return!0;return!1}lA(b,h=!1,v=null,D=null,P=null){b.hM=this;let ca=this.l0l(b.id);h&&!this.pYb&&(ca=0);ca<ot.LJb&&(this.YUa.csj(b,ca),this.aB.length>=ot.LJb&&this.YUa.ioi(this.aB[ot.LJb-1]),this.YUa.woe());Array.insert(this.aB,ca,b);u.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",Lu[b.id],void 0===b.g_a||null===b.g_a?"":b.g_a);b.errorCode&&w.AFrameworkApplication.ZM(b.errorCode,v,D,P)}removeEntry(b){const h=
Array.indexOf(this.aB,b);-1!==h&&h<ot.LJb&&(this.aB.length>ot.LJb&&this.YUa.csj(this.aB[ot.LJb],ot.LJb),this.YUa.ioi(b),this.YUa.woe());Array.remove(this.aB,b);b.hM=null;b.dispose()}l0l(b){if(!this.pYb||0===b)return this.aB.length;b=this.pYb[Lu[b]];if(void 0===b||null===b)return this.aB.length;for(let h=0;h<this.aB.length;h++)if(b<this.pYb[Lu[this.aB[h].id]])return h;return this.aB.length}}ot.LJb=2;Object(n.a)(ot,"BusinessBar",null,[1201,10,1202]);class ox{create(b,h,v){return new Lh.a(b,h,v)}}Object(n.a)(ox,
"Factory",null,[1212]);class QA{static r4k(b,h){b.register(ot,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").singleInstance().Rd(()=>new ot(h.value,0,b.Na("CommonUI.IBusinessBarRankProvider")));b.register(ox,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").singleInstance()}}Object(n.a)(QA,"CommonUIComponentConfiguration",null,[]);var RA=c(1E3);class Kt extends RA.a{constructor(){super()}static get instance(){return Kt._instance||Kt.kAf()}static kAf(){Kt._instance=
new Kt;return Kt._instance}}Kt._instance=null;Object(n.a)(Kt,"ReactRootManager",RA.a,[348,349]);class ps extends mg.a{constructor(){super()}get ControlType(){return 3}}Object(n.a)(ps,"CompoundButtonProps",mg.a,[]);class Lt{constructor(b,h,v,D,P,ca,ta){this.nW=h;this.bAc=b;this.C0g=h.dKm;this.tWb=h.GVc;this.$Fe=ca;this.jld=D;this.kld=P;this.dld=v;this.oK=ta;this.xab=new Td.a;this.xab.Z(1,"SpellingIssue_16x16x32");this.xab.Z(2,"GrammarIssue_16x16x32");this.xab.Z(3,"WritingIssue_16x16x32");this.xab.Z(4,
null);this.xab.Z(0,null)}create(b,h,v){h=Object(Na.a)(pg.a,h);if(!h)return u.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const D=new Sys.StringBuilder;b=this.Vai(b);this.PIc(D,h,v,b);this.dbf(D,h);this.Jdl(D,h,b);return D.toString()}vfb(b,h,v){const D=Object(Na.a)(pg.a,h);if(!D)return u.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];h=[];b=this.Vai(b);this.Pbf(h,D,v,b);this.ebf(h,D);this.Kdl(h,D,b);for(v=0;v<h.length;v++)h[v].Id=`${hv.hVh}_${v}`;
return h}PIc(b,h,v,D=null){h.errorType?1===h.errorType&&(this.g6b(h)||b.append(this.i5e(h,v,D))):b.append(this.bAc.build())}Pbf(b,h,v,D=null){h.errorType?1===h.errorType&&(this.g6b(h)||b.push(this.TNk(h,v,D))):b.push(this.bAc.Uyh())}dbf(b,h){const v=new Sys.StringBuilder;this.Ysj(h)?v.append(Ii.a("btnIgnoreAllSpellingError",(2===h.errorType?Gb.a.GIa:Gb.a.boa).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.g6b(h)||v.append(Ii.a("btnIgrnoreSpellingError",this.R$h(h.errorType).toString(),
Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.dtj(h)&&(this.nW.Hwi&&v.append(Ii.a("btnDoNotCheckForThisIssue",Gb.a.uCb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),v.append(Ii.a("btnGrammarOptions",Gb.a.Fmb.toString(),G.a.yf(Box4Intl.Box4Strings.l_GrammarOptions),null)));v.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),b.append(v.toString()),b.append("</Controls></MenuSection>"))}ebf(b,h){const v=Object.assign(new ih.a,
{ControlList:[]});if(this.Ysj(h)){var D=nt.BB()?Object.assign(new mg.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:Gb.a.boa,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new mg.a,{ExternalId:2===h.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});v.ControlList.push(D)}else this.g6b(h)||(D=Object.assign(new mg.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.R$h(h.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),v.ControlList.push(D));
this.dtj(h)&&(this.nW.Hwi&&(h=Object.assign(new mg.a,{ExternalId:"DoNotCheckForThisIssue"}),v.ControlList.push(h)),h=Object.assign(new mg.a,{ExternalId:"GrammerSettingsContext"}),v.ControlList.push(h));b.push(v)}Vai(b){if(!this.oK)return null;b=this.oK.language(this.oK.Nr(b.Oa));return ok.a.sg(b)?ok.a.sg(b).name:null}R$h(b){return 2===b?Gb.a.GIa:this.nW.RMm?Gb.a.Ivm:Gb.a.iwa}Jdl(b,h,v=null){if(this.idg(h)){var D=G.a.yf(h.yt.CategoryTitle);D=Ii.m(hv.Igc,Wa.a.Sla,this.xab.J(h.proofingType),""!==D?D:
Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[b.toString()],this.jld,this.kld);D=Ii.d("cgProofingOuter",[D]);b.clear();b.append(Ii.g("msProofingOuter",D,"Menu16",void 0,void 0,v,"ariaLabelledById"));u.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}Kdl(b,h,v=null){if(this.idg(h)){var D=G.a.yf(h.yt.CategoryTitle);v=Object.assign(new Jj.a,{ExternalId:String.format("{0}_{1}",hv.Igc,h.proofingType),Command:Wa.a.Sla.toString(),
Image16by16Class:this.xab.J(h.proofingType),LabelText:""!==D?D:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:v,Menu:Object.assign(new Yd.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.XNl(h),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});v.Menu.MenuSectionList.push(...b);Array.clear(b);D=Object.assign(new ih.a,{ControlList:[]});D.ControlList.push(v);b.push(D);u.ULS.sendTraceTag(39188234,375,
50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}i5e(b,h,v=null){const D=this.qWl(b);var P=[];let ca=!1;var ta=b.yt.Suggestions;if(ta)if(ta=ta.slice(0,Math.min(3,ta.length)),this.C0g&&(ca=!Wl.a.any(ta,Ra=>!Ra||!Ra.Description)),1!==ta.length||ta[0].Action){let Ra=0,mb=null;ca&&(mb="font-weight: bold;");for(const Jb of ta){if(!Jb)continue;ta=null;let Ub="";const cc=G.a.yf(Jb.Text);ca&&(ta=this.A5h(Jb.Description),Ub=this.z5h(Jb.Description));P.push(Ii.a("btnCorrectWord"+
Ra,h[Ra].toString(),cc,null,null,null,null,null,mb,null,ta,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,D,cc),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.DJh(b.token)),"ariaDescribedById",Ub));Ra++}}else h=G.a.yf(ta[0].Text),P.push(Ii.a("btnCorrectWord0",Gb.a.GIa.toString(),h,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,
D,h)));h="Menu16";0<P.length?ca&&(h="Menu16DescriptionEnabled"):P=[Ii.a("btnNoSuggestions",Gb.a.GIa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return Ii.g("msUnknownWord",Ii.d(null,P),h,D,this.K3l(b),v,"ariaLabelledById")}TNk(b,h,v=null){var D=1!==b.proofingType&&0!==b.proofingType?b.yt.ExplanationTitle:"";D=Object.assign(new ih.a,{Title:D,Lang:v,ControlList:[]});let P=!1;var ca=b.yt.Suggestions;if(ca)if(ca=ca.slice(0,Math.min(3,ca.length)),this.C0g&&(P=!Wl.a.any(ca,ta=>!ta||!ta.Description)),
1!==ca.length||ca[0].Action){let ta=0;for(const Ra of ca){if(!Ra)continue;ca=null;let mb="";P&&(ca=this.A5h(Ra.Description),mb=this.z5h(Ra.Description));if(ta>=h.length)break;ca?(ca=Object.assign(new ps,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",ta,b.proofingType),Command:h[ta].toString(),LabelText:Ra.Text,Description:ca,Lang:v,AriaDescription:mb}),D.ControlList.push(ca)):(ca=Object.assign(new mg.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",ta,b.proofingType),
Command:h[ta].toString(),LabelText:Ra.Text,Lang:v,RoleInMenu:"menuitem"}),D.ControlList.push(ca));ta++}}else b=ca[0],b=Object.assign(new mg.a,{ExternalId:"NoSuggestion",Command:Gb.a.GIa.toString(),LabelText:b.Text}),D.ControlList.push(b);0>=D.ControlList.length&&D.ControlList.push(Object.assign(new mg.a,{ExternalId:"btnNoSuggestions",Command:Gb.a.GIa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return D}qWl(b){return G.a.yf(0!==b.proofingType?b.yt.ExplanationTitle:"")}K3l(b){return this.idg(b)?
null:this.xab.J(b.proofingType)}idg(b){return this.tWb&&2!==b.errorType&&(1!==b.errorType||!this.g6b(b))}Ysj(b){return this.$Fe&&!!b.errorType&&1===b.proofingType&&!this.g6b(b)}XNl(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.DJh(b.token)):""}dtj(b){return this.nW.u_d&&this.tWb&&1===b.errorType&&(2===b.proofingType||3===b.proofingType)}g6b(b){return!!b.errorType&&!!this.dld&&this.dld.contains(b.token,b.lcid)}A5h(b){return""===
b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):b}z5h(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,b):""}DJh(b){let h="";if(b){let v;for(v=0;v<b.length-1;v++)h=h+b.charAt(v)+",";h+=b.charAt(v)}return h}}Object(n.a)(Lt,"EditorServiceProofingContextMenuCreator",null,[]);class iy{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(n.a)(iy,
"BusinessBarRankProvider",null,[445]);class px{constructor(){this.W=null}get name(){return"Wonca.UI"}xc(b){this.W=b;b.ha("CommonUI.IBusinessBarRankProvider",()=>new iy).singleInstance();QA.r4k(b,new Gg.a(()=>Xa.App.xa.jga));b.ha("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new Lt(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.Proofing.IIgnoreAllKeywords"),w.AFrameworkApplication.Wba,w.AFrameworkApplication.Ws,
w.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),b.resolve("Box4.IFormattingReader"))).singleInstance();b.ha("CommandUI.ReactRootManager",()=>Kt.instance).as("Common.IReactRootManager").singleInstance()}init(){this.W.resolve("Wonca.IRibbonUserFactory");this.W.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){N.a.instance.Fc(new px)}}Object(n.a)(px,"WoncaUIPackage",null,[1,2]);class Mq{constructor(b){this.yN=this.hyc=null;this.pn=b}get key(){return"BOOKMARK"}get Uw(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get z3(){return this.yN}reset(b){this.yN=
b.node}xIa(b){let h=null;w.AFrameworkApplication.ue("bookmarks-core-ex;bookmarks-core-ex-cf");if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)){if(this.hyc&&this.pn.ewi(b,this.z3,this.hyc))return h=Object.assign(new Kv.a,{MG:this.key,contentObject:this.hyc}),{returnValue:!0,WF:h};this.hyc=null;if(!this.z3.hasBookmark)return{returnValue:!1,WF:h};const v=new he.GraphIterator;v.set(this.z3.Vi());this.pn.IZc(v);if(this.pn.sHm(v)){let D=
v.Pd();for(;D;){if(this.pn.ewi(b,this.z3,D))return this.hyc=D,h=Object.assign(new Kv.a,{MG:this.key,contentObject:D,description:this.Bhb()}),{returnValue:!0,WF:h};D=v.Lj()}}}return{returnValue:!1,WF:h}}Bhb(){return null}}Object(n.a)(Mq,"BookmarkDetailsProvider",null,[670,671]);class Rz{constructor(b,h,v,D,P=null){this.$_g=this.Zh=!1;this.ypd=this.$qd=null;this.LTi=(ca,ta)=>{ca=ta.node;1074135152!==ca.Rc?u.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",ca.Rc):(u.ULS.sendTraceTag(24155019,
324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.NWh(!0))};this.dA=v;this.ri=D;this.wx=h;this.bNg=b;this.eS=P}get ix(){return this.wx.value}initialize(){this.t4f();this.Zh=!0}NWh(b=!1){if(!this.Zh)return u.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.$_g)return!0;let h=!1;this.ri.ie(()=>{this.$qd={};this.ypd={};if(this.ix){const v=new he.GraphIterator;v.set(this.ix);if(this.bgn(v)){if(v.Sb(1)){do this.kuk(v.currentNode);while(v.Pf(1))
}h=this.$_g=!0}}},"BGM:EBGL");return h}zva(b){return this.NWh()?b in this.ypd?this.ypd[b]:null:null}dispose(){this.Zh?this.SSo():u.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}bgn(b){if(this.dA.fP(b))return(b=b.Sb(30))||u.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),b;u.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}t4f(){u.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.bNg.Lqh(this.LTi)}SSo(){u.ULS.sendTraceTag(24691924,
324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.bNg.Kbj(this.LTi)}kuk(b){var h,v,D,P;b?(this.Loh(null!==(v=this.eS.keb.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==v?v:W.a.nil,b),this.Loh(null!==(P=this.eS.S1b.get(null===(D=b.id)||void 0===D?void 0:D.toString()))&&void 0!==P?P:W.a.nil,b),(h=b.properties.ia(Bc.a.ut,null))&&(this.ypd[h]=b)):u.ULS.sendTraceTag(24155022,324,50,"Node is null")}Loh(b,h){b===W.a.nil?u.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=
b.toString(),b in this.$qd||(this.$qd[b]=new Fb.a),b=this.$qd[b],b.contains(h)||b.add(h))}}Object(n.a)(Rz,"BookmarkGraphManager",null,[710]);var SA=c(800),TA=c(1113);class Tj{create(){return new TA.a}}Object(n.a)(Tj,"BookmarkContainerNodeFactory",null,[598]);class pt{constructor(b,h,v,D=null){this.zsn=(P,ca)=>{this.pn.DWi(ca)};this.vVf=(P,ca)=>{var ta=this.k_h(ca.clone);P=ca.original.Kc;const Ra=new ac.a;for(const mb of ta)ta=mb.jn.toString(),Ra.mb(ta)||(Ra.add(ta,!0),(ta=P.Db(mb.jn))&&!ta.anchor&&
(ta=this.pn.$Db(mb.jn)),ta?ta.anchor?this.u8k(ta,ca.clone):u.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",ta.id,ta.ia(Bc.a.bAb,-1))):u.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.wVf=(P,ca)=>{P=ca.clone;ca=this.k_h(P);this.pn.t4c(P,ca)};this.iA=h;this.pn=v;this.iYj=D||new Tj}init(){SA.a.mVn(Object(z.a)(this.pn,this.pn.ESf,"onAfterFullBookmarkRangeDeleted"));this.iA.W_e(this.zsn);Bs.a.V_e(this.vVf);Bs.a.Vzd(this.wVf)}k_h(b){const h=
new Fb.a;for(let v=0;v<b.pa.length;v++){const D=b.pa.J(v);if(D.Dh)for(let P=0;P<D.Dh.length;P++)h.add(D.Dh.J(P))}return h}u8k(b,h){var v=h.Vi().od;v=Mp.b(b,v,!0);h=he.GraphIterator.$a(h);this.Pvl(h);h.Sb(30);h.c3(v,1,b.id);h.sj(v)}Pvl(b){if(b.zb(25)&&b.jd(25)&&!b.Rr(30)){const h=this.iYj.create(1074135152);b.Af(h,30)}}}Object(n.a)(pt,"BookmarksEventHandler",null,[]);var Jr=c(201),op=c(248),Mt=c(447),qx=c(1170),Wv=c(127),rx=c(1057);class Fw{create(){return new rx.a}}Object(n.a)(Fw,"BookmarkNodeFactory",
null,[598]);class wu{constructor(b,h){this.Taa=b;this.tYj=h}get HMb(){return this.tYj}}Object(n.a)(wu,"FoundBookmarkRangeObject",null,[487]);class Nt{constructor(b,h,v,D,P,ca,ta,Ra=null,mb,Jb=null){this.r2="_";this.eNg=40;this.llk=" ";this.wx=b;this.dA=h;this.Kd=v;this.gJe=D;this.Ic=P;this.fb=ca;this.hb=ta;this.sYj=Ra||new Fw;this.eS=Jb}rPc(b,h){return b?this.eS.keb.get(null===h||void 0===h?void 0:h.toString()):this.eS.S1b.get(null===h||void 0===h?void 0:h.toString())}get ix(){return this.wx.value}get ZIa(){return this.gJe.value}cZe(b,
h){if(!h||!h.Oa||!h.Pc)return u.ULS.sendTraceTag(36471765,3029,15,"There is no selection"),!1;const v=h.Oa.node,D=h.Pc.node,P=Jr.a.Chb(h,!0);h=Jr.a.Chb(h,!1);return this.MDc(b,P,h,v,D)}MDc(b,h,v,D,P,ca=!1){u.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",ca));const ta=this.zva(b);if(ta)if(ca)this.C$i(ta);else return u.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!D||!P)return u.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),
!1;ca=this.Ic.Oc(15);ca.Cb(this.ZIa);b=this.Frk(b);if(!b)return!1;this.Brk(D,h,b,P,v);ca.dispose();return!0}zva(b){u.ULS.shipAssertTag(34936482,3029,!!b);return this.n_h(h=>b===h.properties.ia(Bc.a.ut,null))}$Db(b){return b&&b!==W.a.nil?this.n_h(h=>b.equals(h.id)):(u.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}ESf(b){const h=this.$Db(b);h?(u.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",b.toString())),this.B$i(h),this.s4c(h)):
u.ULS.sendTraceTag(36569436,3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}Ava(b,h){var v;const D=null!==(v=this.rPc(h,b.id))&&void 0!==v?v:W.a.nil;if(D===W.a.nil)return u.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new wu(null,2);v=this.ix.od.Db(D);return v?v.isConnected?this.getBookmarkRange(v,b,h):(u.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new wu(null,3)):(u.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),
new wu(null,2))}DWi(b){const h=this.DEl(b);h[Symbol.iterator]().next().done||this.Zfn(b,h)}t4c(b,h){const v=new Fb.a;let D=0,P=!1;for(const ca of h)ca&&ca.Ib.Dh?(D++,ca.Ib.Dh.remove(ca),0<=ca.qe&&ca.qe<b.xe.length&&(ca.Ib.cp||(P=!0),v.add(ca.qe))):u.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.$pa(v);u.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",D,v.count));P&&!b.xe.length&&b.xe.append(op.CharacterPropertiesEditor.MM,
1024)}YNd(b=!1){u.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",b);const h=new Fb.a,v=he.GraphIterator.$a(this.ix);if(null!==this.IZc(v)){var D=v.Mp();u.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",D);if(0<D)for(D=v.Pd();null!==D;){const P=D.ia(Bc.a.ut,"");G.a.jf(P)||(b?h.add(D):P.startsWith(this.r2)||h.add(D));D=v.Lj()}}!b&&0<h.count&&u.ULS.sendTraceTag(556889755,3029,50,"User Bookmarks count: {0}",h.count);return h}Jqm(){return this.ix?this.y5k():!1}y5k(){u.ULS.sendTraceTag(524321506,
3029,50,"Finding bookmarks with includeHidden: {0}",!1);const b=he.GraphIterator.$a(this.ix);if(null!==this.IZc(b)&&0<b.Mp())for(var h=b.Pd();null!==h;){h=h.ia(Bc.a.ut,"");if(!G.a.jf(h)&&!h.startsWith(this.r2))return!0;h=b.Lj()}return!1}Hdi(b){var h=this.zva(b);const v=new Fb.a;if(h){b=this.rPc(!0,h.id);h=this.rPc(!1,h.id);var D=this.ix.od.Db(b);D&&v.add(D);if(b.equals(h))return v;b=D;do(b=D=this.fb.jg(b,!1,!1,!0))&&v.add(D);while(D&&!D.id.equals(h))}else u.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist with the {0}",
b);return v}A$i(b){if(null===b)return u.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.$Db(b);return this.C$i(b)}QOl(b){let h="";const v=b.id;b=b.characterData.split(this.llk);for(let D=0;3>D&&D<b.length;D++)h+=this.r2+b[D];h.length>this.eNg&&(h=h.substring(0,this.eNg));return this.BNj(h,v)}BNj(b,h){const v=this.YNd(!0),D=[];let P;for(let ta=0;ta<v.count;ta++){var ca=v.J(ta);P=ca.ia(Bc.a.ut,"");ca=this.rPc(!0,ca.id);P.startsWith(b)&&!h.equals(ca)&&D.push(P)}return 0<
D.length?(D.sort((ta,Ra)=>ta.localeCompare(Ra,void 0,{numeric:!0})),(h=D[D.length-1].substring(b.length+1))?b+this.r2+(parseInt(h)+1):b+this.r2+1):b}Jki(b){G.a.jf(b)?u.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(b=this.zva(b),null===b?u.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(b=this.Ava(b,!0))?(b=Og.SelectionFactory.pe(b.Taa.paragraph,b.Taa.Ib.cp))&&this.hb.setSelection(b):u.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}C$i(b){if(!b)return u.ULS.sendTraceTag(559228888,
3029,15,"Could not find bookmark node with given id"),!1;u.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",b.id));const h=this.Ic.Oc(15);h.Cb(this.ZIa);this.B$i(b);this.s4c(b);h.dispose();return!0}tPd(b,h){if(!b||0>h)return u.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;let v=null;const D=new Fb.a,P=new Fb.a;var ca=b.pa;for(var ta=0;ta<ca.length;ta++){var Ra=ca.J(ta);if(Ra.cp>h||Ra.cp===h&&0<D.count)break;if(Ra.Dh){var mb=
Ra.Dh;if(2===mb.length&&mb.J(0).jn.equals(mb.J(1).jn)&&Ra.cp===h){D.add(mb.J(0).jn.toString());break}for(let Jb=0,Ub=mb.length;Jb<Ub;Jb++){Ra=mb.J(Jb);const cc=b.Kc.Db(Ra.jn).ia(Bc.a.ut,"");G.a.jf(cc)||cc.startsWith(this.r2)||(Ra.Mc?D.add(Ra.jn.toString()):D.contains(Ra.jn.toString())?D.remove(Ra.jn.toString()):P.add(Ra.jn.toString()))}}}0<D.count&&(v=b.Kc.Db(W.a.Ef(D.J(D.count-1))));if(!v)for(h=fe.ParagraphReader.jg(b,!0);h&&!v;){for(ca=0;ca<h.pa.length;ca++)if(ta=h.pa.J(ca),ta.Dh){ta=ta.Dh;for(let Jb=
0,Ub=ta.length;Jb<Ub;Jb++)mb=ta.J(Jb),Ra=b.Kc.Db(mb.jn).ia(Bc.a.ut,""),G.a.jf(Ra)||Ra.startsWith(this.r2)||(mb.Mc?P.contains(mb.jn.toString())?P.remove(mb.jn.toString()):D.add(mb.jn.toString()):D.contains(mb.jn.toString())?D.remove(mb.jn.toString()):P.add(mb.jn.toString()))}0<D.count?v=h.Kc.Db(W.a.Ef(D.J(D.count-1))):h=fe.ParagraphReader.jg(h,!0)}return v}BUo(b,h){if(null===b)return u.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.tHm(h)||this.Zrl(h))return!1;const v=this.Ic.Oc(15);
v.Cb(this.ZIa);this.AUo(b,h);v.dispose();return!0}n_h(b){if(!this.ix)return u.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const h=new he.GraphIterator;h.set(this.ix);if(!this.IZc(h))return u.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!h.Sb(1))return null;do{const v=h.currentNode;if(b(v))return v}while(h.Pf(1));return null}getBookmarkRange(b,h,v){for(let D=0;D<b.pa.length;D++){const P=b.pa.J(D);if(P.Dh)for(let ca=0;ca<P.Dh.length;ca++){const ta=
P.Dh.J(ca);if(ta.jn.equals(h.id)&&v===ta.Mc)return new wu(ta,0)}}u.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,h.ia(Bc.a.bAb,-1),v,h.id,b.pa.length,this.uM(b));return new wu(null,1)}IZc(b){if(this.dA.fP(b))return b=b.Sb(30),u.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;u.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");return null}DEl(b){const h=new ac.a;
for(let v=0;v<b.pa.length;v++){const D=b.pa.J(v);if(D.Dh)for(let P=0;P<D.Dh.length;P++){const ca=D.Dh.J(P),ta=ca.jn.toString();h.mb(ta)?(u.ULS.shipAssertTag(36218379,3029,ca.Mc!==h.J(ta).Mc),h.remove(ta)):h.add(ta,ca)}}return h.values}Zfn(b,h){this.t4c(b,h);this.Cfn(b,h)}Cfn(b,h){let v=fe.ParagraphReader.jg(b,!1,!0);b=fe.ParagraphReader.jg(b,!0,!0);v||b?(v||this.oxh(h,!0)&&u.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),b||
this.oxh(h,!1)&&u.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),v=v||b,b=b||v,this.CPi(v,h,0,!0),this.CPi(b,h,b.pa.last.cp,!1)):u.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}oxh(b,h){for(const v of b)if(h===v.Mc)return!0;return!1}CPi(b,h,v,D){const P=new Fb.a;v=this.xof(b,v);for(const ca of h)ca.Mc===D&&(v?(h=this.Hrk(b,D,v,ca.jn))&&P.add(h):u.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",D));
P.count&&(b.Yl(),this.Hng(b,P),u.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",P.count,D)))}Hrk(b,h,v,D){const P=this.$Db(D);return P?this.dZe(b,h,v,P):(u.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",D)),null)}dZe(b,h,v,D){var P;if(!D)return u.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!v)return u.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),
null;v.Dh||(v.Dh=new Mt.a(v));const ca=new qx.a(v,null,D.id,h);v.Dh.add(ca);(h?this.eS.keb:this.eS.S1b).set(null===(P=D.id)||void 0===P?void 0:P.toString(),b.id);return ca}Hng(b,h){if(h){u.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",h.count);h.Sc((v,D)=>v.qe-D.qe);for(let v=0;v<h.count;v++){const D=h.J(v);D.qe?b.xe.VX(D.qe-1,1024):b.xe.loa(D.qe,1024);b.xe.nq.Z(D.qe,op.CharacterPropertiesEditor.MM);b.xe.ft.Z(D.qe,op.CharacterPropertiesEditor.tR)}}else u.ULS.shipAssertTag(36218383,
3029,!1,"Null BookmarksToUpdate.")}xof(b,h){if(!b||!b.pa||!b.pa.last)return null;u.ULS.shipAssertTag(36471766,3029,h<=b.pa.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.pa.last.cp===h){var v=b.pa.length-1;if(!b.pa.J(v).formatting)for(var D=v-1;0<=D;D--){var P=b.pa.J(D);if(P.formatting){this.Kd.LY(b,v,h,P.formatting);break}}return b.pa.last}v=null;for(D=0;D<b.pa.length;D++){P=b.pa.J(D);if(P.cp>=h){if(P.cp>h||!P.formatting)this.Kd.LY(b,D,h,v),P=b.pa.J(D);P.Dh||(P.Dh=new Mt.a(P));
u.ULS.shipAssertTag(36471768,3029,P!==b.pa.last);return P}P.formatting&&(v=P.formatting)}return null}Frk(b){const h=new he.GraphIterator;h.set(this.ix);if(!this.IZc(h))return u.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;b=this.X9k(b);h.c3(b,1,null);h.sj(b);return b}X9k(b){const h=this.sYj.create(1074135153);h.setValue(Bc.a.ut,b);h.setValue(Bc.a.bAb,se.a.uF());return h}s4c(b){if(b&&b.anchor){u.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",
b.ia(Bc.a.bAb,-1),b.id);var h=new he.GraphIterator;h.set(b);h.zb(64);h.xg()}}uM(b){const h=[];let v=0;for(;b.anchor.hq&&7!==b.type;)h[v]=Wv.a[b.type],b=b.anchor.hq.zr.node,v++;h[v]=Wv.a[b.type];return h.join(" ")}AUo(b,h){b.setValue(Bc.a.ut,h)}B$i(b){const h=this.Ava(b,!0).Taa;b=this.Ava(b,!1).Taa;if(h&&b&&h.paragraph===b.paragraph){let v;this.t4c(h.paragraph,(v=new Fb.a,v.add(h),v.add(b),v))}else{if(h){let v;this.t4c(h.paragraph,(v=new Fb.a,v.add(h),v))}if(b){let v;this.t4c(b.paragraph,(v=new Fb.a,
v.add(b),v))}}}Brk(b,h,v,D,P){if(h=this.dZe(b,!0,this.xof(b,h),v)){b.Yl();var ca;this.Hng(b,(ca=new Fb.a,ca.add(h),ca));(v=this.dZe(D,!1,this.xof(D,P),v))?(D.Yl(),this.Hng(b,(ca=new Fb.a,ca.add(v),ca))):u.ULS.sendTraceTag(520646733,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else u.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}Idi(b,h){var v;if(!b)return null;h=null!==(v=this.rPc(h,
b.id))&&void 0!==v?v:W.a.nil;return b.Kc.Db(h)?b.Kc.Db(h):null}sHm(b){return!!b&&64===b.We}fYf(b){var h;if(0===b.a$)return!1;for(let v=0;v<(null===(h=b.pa)||void 0===h?void 0:h.length);v++){const D=b.pa.J(v);if(null!=D.Dh)for(let P=0;P<D.Dh.length;P++){const ca=D.Dh.J(P),ta=b.Kc.Db(ca.jn).POa();if(!G.a.jf(ta)&&!ta.startsWith(this.r2)&&ca.Mc)return!0}}return!1}p5h(b){var h;const v=[];if(0===b.a$)return v;for(let D=0;D<(null===(h=b.pa)||void 0===h?void 0:h.length);D++){const P=b.pa.J(D);if(null!=P.Dh)for(let ca=
0;ca<P.Dh.length;ca++){const ta=P.Dh.J(ca),Ra=b.Kc.Db(ta.jn),mb=Ra.POa();G.a.jf(mb)||mb.startsWith(this.r2)||!ta.Mc||v.push(Ra)}}return v}gvo(b){return b.ia(Bc.a.EG,!1)}tHm(b){return G.a.jf(b)?(u.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty"),!0):!1}Zrl(b){return null!==this.zva(b)?(u.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}o5h(b,h,v){return this.getBookmarkRange(b,h,v).Taa}ewi(b,h,v){if(this.gvo(v)||this.AMm(v))return!1;
const D=this.Idi(v,!0),P=this.Idi(v,!1);if(D&&P&&this.fb.rVc(h,D,P)){if(h!==D&&h!==P)return!0;const ca=this.o5h(D,v,!0);if(ca&&(D!==h||ca.Ib.cp<=b)&&(v=this.o5h(P,v,!1))&&(P!==h||v.Ib.cp>=b))return!0}return!1}AMm(b){b=null===b||void 0===b?void 0:b.ia(Bc.a.ut,"");return!G.a.jf(b)&&b.startsWith(this.r2)?!0:!1}}Object(n.a)(Nt,"FullBookmarkManager",null,[446]);class nv{constructor(){this.sue=this.Oq=this.W=null}get name(){return"WordEditor.Bookmark"}xc(b){this.W=b;this.Oq=this.W.resolve("Box4.INotebookManager").zl;
const h=new Nt(new Gg.a(()=>Xa.App.xa.ib.Uc),Wk.PageNavigator.instance,this.W.resolve("Box4.ICharacterPropertiesEditor"),new Gg.a(()=>Xa.App.xa.ib.rc.Yc),Nh.a.instance,this.W.resolve("Box4.IParagraphReader"),this.W.resolve("Box4.SelectionManager"),null,null,this.W.resolve("Box4.BookmarkParagraphMapping"));this.W.ha("WordEditor.Bookmark.FullBookmarkManager",()=>h).as("WordEditor.Bookmark.IBookmarkManager").singleInstance();this.W.ha("WordEditor.Bookmark.BookmarksEventHandler",()=>new pt(this.Oq.Ze(12),
this.W.resolve("WordEditor.ITableEditor"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).singleInstance();Jl.App.OLj&&(this.sue=new Rz(this.Oq.Ze(64),new Gg.a(()=>Xa.App.xa.ib.Uc),Wk.PageNavigator.instance,ns.a.instance,this.W.resolve("Box4.BookmarkParagraphMapping")),this.W.ha("WordEditor.Bookmark.BookmarkGraphManager",()=>this.sue).as("WordEditor.Bookmark.IBookmarkGraphManager").singleInstance())}init(){this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>{this.hn()})}dispose(){this.sue.dispose()}hn(){u.ULS.sendTraceTag(36209186,
324,50,"Registering paragraph events");this.W.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();u.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.sVn(this.W.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("WordEditor.Bookmark.FullBookmarkManager"))}sVn(b,h){b&&b.execute(v=>{v.Y4(new Mq(h))})}static main(){N.a.instance.Fc(new nv)}}Object(n.a)(nv,"BookmarkPackage",null,[1,2]);var cr=c(871),Xv=c(1049),$o=c(1547),Mu=c(1407);class YB extends Mu.a{constructor(b){super();
this.kok=b}get index(){return 3}run(){this.kok()}SJ(){this.qY()}}Object(n.a)(YB,"FootnoteEndnoteGraphUpdateTracker",Mu.a,[]);class ov{constructor(){this.kkd=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}xc(){}init(){ov.Xb.Pp.continueWith(()=>{this.hn()})}hn(){cr.a.Zgb=$o.a.instance;this.qyf()}dispose(){}qyf(){this.kkd=new YB(()=>{$o.a.instance.Tu()});Xv.a.kde(Object(z.a)(this.kkd,this.kkd.SJ,"setUpdateNeeded"));oo.GraphTransactionManager.instance.nqa(this.kkd,3)}static get Xb(){return Ea.a.instance.resolve("Box4.IFeatureHelper")}}
Object(n.a)(ov,"PackageManager",null,[1,2]);var Ot=c(759),Sz=c(199),jy=c(526),sx=c(467),$y=c(1651);class az extends ro{constructor(){super()}get Uw(){return null}getTitle(b){b=b.Dna();if(!b||!jy.a.instance.xoa(b))return"";const h=new Sys.StringBuilder,v=jy.a.instance.V3(b);h.append(1===v?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);h.append(" ");h.append(jy.a.instance.U7b(b));return h.toString()}}Object(n.a)(az,"FootnoteEndnoteBaseDetailsProvider",
ro,[]);class bz extends az{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get zh(){return 7}}Object(n.a)(bz,"FootnoteEndnoteDetailsProvider",az,[]);var Pt=c(1602),cz=c(1622),UA=c(1696);class Xs extends az{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get zh(){return 10}}Object(n.a)(Xs,"FootnoteEndnoteRefMarkDetailsProvider",az,[]);class Qt{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id,vd,xe,Ld){this.nsi=(Qd,Zd,te,Qf,Jg)=>{Qf=Zd.view;if(!Qf.features.Qke||this.pD.$vi)return 8;
const Ml=Qf.lb.tg;if(!Ml)return 2;if(this.Jk.k_(Ml))return 8;Qf=Qd===Nc.a.insertFootnote?1:0;var Fm=this.zOd(Zd);if(!Fm)return u.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;Zd=!0;Fm=Fm.Oa;Jg&&Jg.Lbc&&Jg.qFa&&(Fm=Jg.qFa,Zd=!Jg.keepCurrentFocus);if(1===te&&Ni.a.rha(Ml)||!Fm||!$e.SelectionEditor.gf(Fm)||this.cQg.instance&&this.cQg.instance.ONm(Fm)||Re.a.Gwa(Fm,!0))return 8;if(1===te)return 32;2===te&&(te=this.ZS.Zf("UserAction","InsertFootnoteEndnote"),Qd=this.h4j.RCm(Fm,Qf,Qd),
Jg&&Jg.Lbc&&(Jg.TRi=Qd),Zd&&this.c9d(Qd,!0,!0),te.stop(),this.Sd.Ns(6));return 32};this.vec=(Qd,Zd,te)=>{const Qf=Zd.view;if(Qd===Nc.a.V6a||Qd===Nc.a.$ob){if(!Qf.features.Qke)return 8}else if(!Qf.features.yhg)return 8;if(!Qf.lb.tg)return 2;Zd=this.S8b(Zd);return Zd?Qd!==Nc.a.V6a&&Qd!==Nc.a.$ob||this.vKa.erm(Zd.node,Qd===Nc.a.V6a?1:0)?1===te?32:2===te&&32===this.ga.Qb(Nc.a.D3,2,!0)?(this.ga.Qb(Nc.a.zQf,2,Qd),32):8:8:2};this.UHl=(Qd,Zd,te,Qf,Jg)=>{if(1===te)return 32;if(2===te){Qd=this.Lcm(Zd);if(!Qd)return 8;
te=Zd=null;switch(Jg){case Nc.a.w5d:te=Qd.Pc;Zd=this.tVb.ATd(te,1);break;case Nc.a.v5d:te=Qd.Pc;Zd=this.tVb.ATd(te,0);break;case Nc.a.y5d:te=Qd.Oa;Zd=this.tVb.Zki(te,1);break;case Nc.a.x5d:te=Qd.Oa;Zd=this.tVb.Zki(te,0);break;case Nc.a.V6a:te=Qd.Oa;(Zd=this.tVb.ATd(te,1,!0))||(Zd=this.vKa.u9h(te.node,1));break;case Nc.a.$ob:te=Qd.Oa,(Zd=this.tVb.ATd(te,0,!0))||(Zd=this.vKa.u9h(te.node,0))}if(Zd)this.c9d(Zd);else{if(!this.Yt.rc)return 8;(Jg=Yo.d(te.node,te.cpBegin))&&7===Jg.zh&&this.vKa.yij(Jg)}}return 32};
this.rxo=(Qd,Zd,te,Qf,Jg)=>1===te?32:2===te?(u.ULS.shipAssertTag(4520066,308,!!Jg),u.ULS.shipAssertTag(4520067,308,!!Jg.k_a),Qd=Jg.k_a,u.ULS.shipAssertTag(4520068,308,this.uE.xoa(Qd)),this.c9d(Qd,Jg.oie)?32:8):32;this.sxo=(Qd,Zd,te,Qf,Jg)=>{if(1===te)return 32;2===te&&(Qd=Jg.footnoteEndnoteNode,Jg=Jg.XHl)&&(this.gsa.c6b(),Zd=this.uE.Mjb(Qd),Jg.title=this.uE.LYl(Qd)+(Zd?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};
this.R4a=(Qd,Zd,te,Qf,Jg)=>2===te?(u.ULS.shipAssertTag(4520069,308,!!Jg),u.ULS.shipAssertTag(4520070,308,!!Jg.k_a),u.ULS.shipAssertTag(4520071,308,fe.ParagraphReader.Wb(Jg.k_a)),Qd=this.uE.d1a(Jg.k_a),this.c9d(Qd,Jg.oie)?32:8):32;this.wjo=(Qd,Zd,te)=>{2===te&&this.pD.FY();return 32};this.gpl=(Qd,Zd,te,Qf,Jg)=>{if(1===te)return 32;if(2===te)return void 0!==Jg&&null!==Jg?this.pD.yff(Jg,Jg):this.pD.yff(),32;u.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};
this.hZm=(Qd,Zd,te)=>{Qd=this.S8b(Zd);return Qd&&$e.SelectionEditor.gf(Qd)?1===te?32:2===te?(te=0<this.Xo.U3(Qd.node).Ot,this.pD.Naf(),this.pD.dialog.Cib=te,32):8:(u.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.SHl=(Qd,Zd,te)=>1===te?32:2===te?(this.pD.dialog.Cib=!1,32):8;this.pMn=(Qd,Zd,te,Qf,Jg)=>this.Q1h(Qd,te,Jg);this.nMn=(Qd,Zd,te,Qf,Jg)=>1===te?32:this.pD.dialog&&this.pD.dialog.fontName?(Jg[Jm.a.Value]=this.pD.dialog.fontName,32):this.B0j.sOa(Gb.a.qMb.toString(),
Jg,null)?32:8;this.RHl=(Qd,Zd,te)=>1===te?32:2===te?(this.pD.dialog.Cib=!0,32):8;this.oMn=(Qd,Zd,te,Qf,Jg)=>this.Q1h(Qd,te,Jg);this.PHl=(Qd,Zd,te)=>{if(1===te)return 32;if(2===te){Qd=this.S8b(Zd);if(!Qd)return u.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;Zd=this.uE.d1a(Qd.node);this.uE.xoa(Zd)&&(te=this.Ic.Oc(15),te.Cb(Zd),this.iGj(Qd),this.vKa.Zth(Zd,this.pD.dialog),te.dispose());this.pD.w5c();return 32}return 8};this.OHl=(Qd,Zd,te)=>{if(1===te)return 32;if(2===te){Qd=
this.S8b(Zd);if(!Qd)return u.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;Zd=this.uE.d1a(Qd.node);this.uE.xoa(Zd)&&(te=this.Ic.Oc(15),te.Cb(Zd),this.iGj(Qd),this.vKa.nFk(Zd,this.pD.dialog),te.dispose());this.pD.w5c();return 32}return 8};this.QHl=(Qd,Zd,te)=>1===te?32:2===te?(this.pD.w5c(),32):8;this.MHl=(Qd,Zd,te,Qf,Jg)=>{if(1===te)return 32;if(2===te){Qd=Object(Na.a)(29,Jg);if(!Qd||!Qd.xd)return 8;this.pD.dialog.fontName=Qd.xd.fontName;return 32}return 8};this.NHl=(Qd,
Zd,te,Qf,Jg)=>{if(1===te)return 32;if(2===te){Qd=Object(Na.a)(29,Jg);if(!Qd||!Qd.xd)return 8;this.pD.dialog.sVb=Qd.xd;return 32}return 8};this.ga=b;this.Yt=h;this.B0j=v;this.fd=D;this.uE=P;this.h4j=ca;this.vKa=ta;this.gsa=Ra;this.pD=mb;this.Xo=Jb;this.tVb=Ub;this.Ic=cc;this.Jk=Ac;this.Gb=Lc;this.ZS=id;this.Sd=vd;this.rVj=xe;this.cQg=Ld}iGj(b){(b=Kl.FormattingReader.Nr(b))?(this.pD.dialog.fontName||(this.pD.dialog.fontName=b.cache.tG),-1===this.pD.dialog.fontSize&&(this.pD.dialog.sVb=b.cache.fontSize)):
u.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}Q1h(b,h,v){return 1===h&&this.pD.dialog?32:2===h&&this.pD.dialog?(v[ri.a.On]=b===Nc.a.Q1f?this.pD.dialog.Cib:!this.pD.dialog.Cib,32):8}Tb(){var b;(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.PageViewFootnoteEndnoteNavigationBugFix",!1))&&Xa.App.instance.ypi([Nc.a.w5d,Nc.a.v5d,Nc.a.y5d,Nc.a.x5d,Nc.a.zQf,Nc.a.V6a,Nc.a.$ob,Nc.a.D3]);this.ga.eb(Nc.a.insertFootnote,
sc.a.view,this.nsi,4);this.ga.eb(Nc.a.insertEndnote,sc.a.view,this.nsi,4);this.ga.qa(Nc.a.w5d,sc.a.view,this.vec);this.ga.qa(Nc.a.zQf,sc.a.view,this.UHl);this.ga.qa(Nc.a.v5d,sc.a.view,this.vec);this.ga.qa(Nc.a.y5d,sc.a.view,this.vec);this.ga.qa(Nc.a.x5d,sc.a.view,this.vec);this.ga.qa(Nc.a.V6a,sc.a.view,this.vec);this.ga.qa(Nc.a.$ob,sc.a.view,this.vec);this.ga.qa(Nc.a.msj,sc.a.view,this.rxo);this.ga.eb(Nc.a.O1h,sc.a.view,this.RHl,4);this.ga.eb(Nc.a.Q1f,sc.a.view,this.oMn,100);this.ga.eb(Nc.a.P1h,sc.a.view,
this.SHl,4);this.ga.eb(Nc.a.J5i,sc.a.view,this.pMn,100);this.ga.qa(Nc.a.nsj,sc.a.view,this.sxo);this.ga.eb(Nc.a.R4a,sc.a.view,this.R4a,96);this.ga.eb(Nc.a.jNd,sc.a.view,this.wjo,96);this.ga.qa(Nc.a.D3,sc.a.view,this.gpl);this.ga.eb(Nc.a.OFi,sc.a.view,this.hZm,4);this.ga.eb(Nc.a.L1h,sc.a.view,this.PHl,4);this.ga.eb(Nc.a.M1h,sc.a.view,this.OHl,4);this.ga.eb(Nc.a.N1h,sc.a.view,this.QHl,4);this.ga.eb(Nc.a.hNd,sc.a.view,this.MHl,4);this.ga.eb(Nc.a.I5i,sc.a.view,this.nMn,100);this.ga.eb(Nc.a.iNd,sc.a.view,
this.NHl,4);this.ga.eb(Nc.a.W1c,sc.a.view,Qt.W1c,100);this.ga.eb(Nc.a.X1c,sc.a.view,Qt.X1c,100)}m4f(){this.rVj.execute(b=>{b.Y4(new bz);b.Y4(new Xs)})}S8b(b){b=this.zOd(b);return b?b.Oa:(u.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}zOd(b){let h=null;b=b.view;if(!b)return u.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),h;b=b.lb;if(!b)return u.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),h;b=b.gb;if(!b||
!b.length)return u.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),h;b=b.J(0);if(!b)return u.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),h;(h=$e.SelectionEditor.Cj(b,!1,!1))||u.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return h}Lcm(b){return(b=b.view)?b.lb.gb.J(0):null}c9d(b,h=!0,v=!1){if(b){this.gsa.c6b();var D=b.pna;if(D){var P=D.Ib,ca=Og.SelectionFactory.ZI(P.paragraph,P.cp,P.cp+1);P=this.Yt.rc;
if(!P)return!1;this.fd.rda(P,ca);P.dob=150;P.e5();b=new sx.a(b,h);ca=Sz.a.b8b(D,P);D=D.Rva(P,ca);if(!D)return u.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;v||D.element?this.pD.neg(b):(this.pD.neg(new sx.a(b.k_a,!1)),h&&(h=new qf.a(2,1,10,()=>{this.pD.FY()}),this.Gb.Vb(h)));return!0}}return!1}static CYl(){return new Qt(w.AFrameworkApplication.va,Xa.App.xa.ib,Ea.a.instance.resolve("Box4.IGeneralCuiUser"),Pb.InteractiveViewManager.instance,jy.a.instance,cz.a.instance,Pt.a.instance,
$o.a.instance,$y.FootnoteEndnoteControlManager.instance,Ea.a.instance.resolve("Box4.IParagraphIndentationReader"),UA.a.instance,new Nh.a,qi.a.instance,Qg.a.instance,w.AFrameworkApplication.ta.Hq,Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ea.a.instance.Sa("Box4.Accessibility.IAccessibilityContextManager"),Ea.a.instance.Sa("Box4.IContentControlReader"))}static BYl(){return Qt.CYl()}static W1c(b,h,v,D,P){if(1===v)return 32;if(2===v&&!P)return 8;Vh.a.OWd(h);P.PopulationXML=
cq.FontUtils.t3h(Vh.a.Gie,Vh.a.pmf,Nc.a.hNd);return 32}static X1c(b,h,v,D,P){if(1===v)return 32;if(2===v&&!P)return 8;P.PopulationXML=cq.FontUtils.u3h(Nc.a.iNd);return 32}}Object(n.a)(Qt,"FootnoteEndnoteActor",null,[577]);class NC extends Mu.a{constructor(b){super();this.TWe=b}get index(){return 1}run(){this.TWe()}SJ(){this.qY()}}Object(n.a)(NC,"FootnoteEndnoteControlUpdateTracker",Mu.a,[]);var ky=c(349);class Tz extends ky.a{constructor(b,h,v,D,P,ca,ta,Ra){super(b,h,v,D);this.Zs=()=>{this.ebd(this.Bb)};
this.lI=b.container;this.Yv=document.createElement("div");b.container.appendChild(this.Yv);this.NG(this.Yv);this.Thk=P;this.wo.execute(mb=>{mb.M0(this.Zs)});this.zKa=ca;this.vK=ta;this.uI=Ra;this.zKa.execute(mb=>{mb.Hcg(this.oc,this.lI)});this.uI&&(this.lI.style.backgroundColor=this.vK.y8b())}dispose(){super.dispose();this.wo.instance&&this.wo.instance.Q5a(this.Zs)}get wo(){return null!=this.HAg?this.HAg:this.HAg=Ea.a.instance.Sa("Common.IZoomManager")}eC(b){this.lI.classList.add("FootnoteEndnoteViewElement");
this.ebd(b.currentNode)}ebd(b){this.wo.instance&&(this.wo.instance.Hcd(this.Yv),this.Yv.style.width=Math.round(100/this.wo.instance.jj)+"%");this.Thk(b)}}Object(n.a)(Tz,"FootnoteEndnoteViewElement",ky.a,[]);class Oi{constructor(){this._initialized=!1;this.Fgd=this.ABe=this.W=null;this.ZHl=(b,h,v,D)=>b.X2a?new Tz(b,h,v,D,P=>{$y.FootnoteEndnoteControlManager.instance.H5n(P)},this.W.Sa("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),
!!Xa.App.instance&&Xa.App.instance.RC):null}get name(){return"WordEditor.FootnoteEndnote"}xc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>{this.hn()})}hn(){Et.WordSectionNavigator.instance.CQf=Object(z.a)(Pt.a.instance,Pt.a.instance.Vgn,"navigateToWordSectionNodeWithFootnoteEndnote");Ot.a.wcg(this.ZHl);$y.FootnoteEndnoteControlManager.instance.bind(Xa.App.xa.kD);this.ABe=Qt.BYl();this.ABe.Tb();this.ABe.m4f();Xa.App.xa.updateCommandUI();this.qyf();this._initialized=
!0}dispose(){this._initialized&&(this._initialized=!1,$y.FootnoteEndnoteControlManager.instance.dispose())}qyf(){this.Fgd=new NC(()=>{$y.FootnoteEndnoteControlManager.instance.fbd()});Xv.a.kde(Object(z.a)(this.Fgd,this.Fgd.SJ,"setUpdateNeeded"));oo.GraphTransactionManager.instance.nqa(this.Fgd,3)}}Object(n.a)(Oi,"PackageManager",null,[1,2]);class gn{constructor(b,h,v,D){this.hb=h;this.Fea=D}get bookmarkManager(){return this.Fea.value}FNm(b){return Jl.App.OLj?b.startsWith(G.a.heb):!1}nom(b){try{this.oom(b)}catch(h){u.ULS.sendTraceTag(24691935,
324,10,String.format("Error parsing bookmark url. Error: {0}",h.message))}}Ykg(b){return{returnValue:!1,R4f:b,MDb:""}}oom(b){if(this.bookmarkManager){b=b.split("/");var h=this.bookmarkManager.zva(b[b.length-1]);h&&h.anchor?(b=this.bookmarkManager.Ava(h,!0).Taa,h=this.bookmarkManager.Ava(h,!1).Taa,b||h?b?this.Bnj(b):(u.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.Bnj(h)):(u.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.GEi(!1))):(u.ULS.sendTraceTag(35992275,
324,15,"Cannot find bookmark node"),this.GEi(!0))}}GEi(b){b=Og.SelectionFactory.ho(Xa.App.xa.ib.Uc.apf(),b);this.hb.setSelection(b)}Bnj(b){b.paragraph&&b.Ib?(b=Og.SelectionFactory.pe(b.paragraph,b.Ib.cp),b.jvi=!0,this.hb.setSelection(b)):u.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(n.a)(gn,"InternalLinkManager",null,[451]);class qs{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}xc(b){b.ha("WordEditor.InternalLinks.InternalLinkManager",
()=>new gn(new Gg.a(()=>b.Na("WordEditor.Bookmark.IBookmarkGraphManager")),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.IFeatureHelper"),new Gg.a(()=>b.Na("WordEditor.Bookmark.IBookmarkManager")),b.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").singleInstance()}static main(){N.a.instance.Fc(new qs)}}Object(n.a)(qs,"WordEditorInternalLinksPackage",null,[1,2]);class Zf{constructor(b){this.dLa=null;this.checkAndDeleteEphemeralOutline=h=>{h=h.customData;if(h.anchor){hj.a.mark(4763);
var v=he.GraphIterator.$a(h);if(v.zb(8)&&v.jd(8)&&v.ZCj(h)===h){if(Ei.OutlineReader.isEmpty(v)){let D=!1;for(let P=0;P<Yh.a.instance.gb.length;P++){const ca=Yh.a.instance.gb.J(P);for(let ta=0;ta<ca.length;ta++)if(ca.J(ta).node===h){D=!0;break}}D||this.RQh(v)}hj.a.mark(4764)}}};Zf.uK=b}gHd(b){if(!Zf.oi.j_d(b))return null;b.Sb(1)&&(b.currentNode.gl(8,!0),b.wc());const h=Zf.uK.gdl();Zf.oi.isRtl(b.currentNode)?h.setValue(lf.a.dr,11):h.setValue(lf.a.dr,9);b.Af(h,1);b.sj(h);return h}Vko(b){if(this.dLa&&
b!==this.dLa){const h=new qf.a(2,1,0,this.checkAndDeleteEphemeralOutline,120);h.customData=this.dLa;w.AFrameworkApplication.nc.Vb(h)}this.dLa=b}RQh(b){this.dLa===b.currentNode&&(this.dLa=null);const h=new eh.GraphTransaction(7);h.Lt(b);b.xg();h.dispose()}XDh(){if(this.dLa&&this.dLa.anchor){const b=he.GraphIterator.$a(this.dLa);b.Bp()&&Ei.OutlineReader.lUc(b)&&this.RQh(b);this.dLa=null}}static get oi(){return Ih.PageReader.instance}}Zf.uK=null;Object(n.a)(Zf,"PageContentEditor",null,[1449]);var OC=
c(1166),xq=c(629);class VA extends Rs{constructor(){super()}Mqj(b,h,v,D,P){let ca=!1,ta=!0;$e.SelectionEditor.gf(P)&&(h=Vg.ListItemReader.yg(b)&&h,P=ig.OutlineElementReader.HA(b,P,!1)&&!ig.OutlineElementReader.HA(b,P,!0),h&&v.j6e(b,D)&&(ca=!0),Xa.App.rd.Qo&&(P||h&&!ca)&&(ta=!1));return{Lqj:ta,jLj:ca}}}Object(n.a)(VA,"CursorMoveValidator",Rs,[]);class eo{constructor(b,h,v,D,P){this.XD=P;this.ANe=b;this.t6=D;this.esa=h;this.nh=v}get Ld(){return null!=this.KIg?this.KIg:this.KIg=Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get nj(){return null!=
this.uIg?this.uIg:this.uIg=Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get uc(){return null!=this.mKg?this.mKg:this.mKg=Ea.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Ss(){return this.t6.value}get eg(){return this.nh.value}get yq(){return this.esa}hmm(b){const h=window.performance.now(),v=new cl.ScriptSharpLegacyMap,D=new Gp.a,P=new cl.ScriptSharpLegacyMap;if(b&&b.$w){var ca=null;for(let ta=0;ta<b.length;ta++){const Ra=b.getContext(ta);ca=ca||eo.Oh.Ys(Ra.node);
let mb;if(!({groupId:mb}=this.NPo(Ra.node,ca)).returnValue)continue;let Jb;v.mb(mb)||(Jb=[],v.add(mb,Jb));Jb=v.J(mb);Jb.push(Ra)}for(const ta of pm.toArray(v.keys))b=v.J(ta),ca=new he.GraphIterator,ca.set(b[0].node),({Rej:b,ku:ca}=this.esa.kPo(ca)).returnValue?(v.Z(ta,b),P.add(ta,ca)):D.add(ta)}u.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-h));return{returnValue:v,kmm:D,jmm:P}}zAb(b){return this.NTk(b)}u2b(b){return this.kTk(b)}OCd(b,
h,v=!0){return he.GraphIterator.vba(()=>{var D=!1;if(Vg.ListItemReader.yg(b))return this.j6e(b,h,v);D||(hf.OutlineElementNavigator.Ge(b),D=fe.ParagraphReader.sh(b)||cj.TableReader.isTable(b),hf.OutlineElementNavigator.Vd(b),D=D&&this.LTk(b,h));return D})}j6e(b,h,v=!0){return he.GraphIterator.vba(()=>{const D=ig.OutlineElementReader.tEa(b),P=Ei.OutlineReader.vX(b.currentNode);if(v?!this.ePm(b,h):!this.fPm(b,h))return!1;var ca=he.GraphIterator.$a(b.currentNode);if(0<h&&ca.zb(14)){ca.jd(16);var ta=ca.currentNode;
const Ra=Xg.TableCellReader.Quf(ca);ca.jd(14);const mb=ca.currentNode;ca=Lp.a.yM(ta,mb,Bc.a.tP,Bc.a.za,0);ta=Lp.a.yM(ta,mb,Bc.a.NR,Bc.a.Aa,0);ca=Ef.a.Fy(ca,0);ta=Ef.a.Fy(ta,0);return D+P<Ra-ca-ta}return!0})}LTk(b,h){const v=ig.OutlineElementReader.tEa(b);var D=ig.OutlineElementReader.xG(b);if(0<h){h=Ei.OutlineReader.vX(b.currentNode);D=0;const {Ao:Ra,marginLeft:mb,marginRight:Jb}=eo.lRd(b.currentNode);var P=he.GraphIterator.$a(b.currentNode);hf.OutlineElementNavigator.Ge(b);if(cj.TableReader.isTable(b)){D=
cj.TableReader.Iga(b);var ca=0;for(var ta of D)ca+=ta;D=Ef.a.Fy(Ef.a.vf(ca,0),0)}hf.OutlineElementNavigator.Vd(b);return P.zb(14)?(P.jd(16),ta=P.currentNode,b=Xg.TableCellReader.Quf(P),P.jd(14),ca=P.currentNode,P=Lp.a.yM(ta,ca,Bc.a.tP,Bc.a.za,0),ta=Lp.a.yM(ta,ca,Bc.a.NR,Bc.a.Aa,0),P=Ef.a.Fy(P,0),ta=Ef.a.Fy(ta,0),v+h<b-P-ta-D):v+h<Ra-mb-Jb-D}return 0<v-D}eSa(b,h){this.c_i(b,-1*Math.abs(h))}DJc(b,h){this.c_i(b,Math.abs(h))}$ml(b,h,v,D,P){let ca=eo.YOi;if(h>=eo.YOi){ca=h-=v;const ta=D*P,Ra=Math.abs(ta),
mb=Math.abs(h)%Ra;mb&&(ca=0>ca?0>D?ca+mb:ca-(Ra-mb):0<D?ca-mb:ca+(Ra-mb));ca+=ta;ca+=v;eo.W9d&&(v=ig.OutlineElementReader.U3(b),ca=eo.W9d.v6h(b.currentNode,h+v,ca+v,P,ca<h)-v)}return ca}JTk(b,h,v){if(!b||!b.length)return!1;h=v?h?-1:1:this.i8h(b[0].node,h);return this.KTk(b,h,v)}Yyn(b,h,v){if(!b)return u.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return u.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),
8;if(!v)return u.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!v.length)return u.ULS.shipAssertTag(589592459,338,!1,"The listIds are empty which are sent for indentation."),8;const D=b[0].node;h=this.i8h(D,h);if(!this.jfn(D,v[0],h)||!this.gfn(b,h))return 8;this.Ss.k$();return 32}gfn(b,h){for(let v=0;v<b.length;v++){const D=new he.GraphIterator;D.set(b[v].node);let P=null;hf.OutlineElementNavigator.Ge(D);if(fe.ParagraphReader.sh(D)){if(P=D.currentNode,
!P)return u.ULS.shipAssertTag(589592461,338,!P,"The paraNode is null for the list OE node"),!1}else if(!fe.ParagraphReader.sh(D)&&!cj.TableReader.isTable(D))return u.ULS.shipAssertTag(589592460,338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;D.wc();if(P){if(this.krm(P)){const ca=P.ND(),ta=ig.OutlineElementReader.tEa(D);this.eg.Fya(D,1,ta+h);ca&&this.nj.aV(P,ca,this.Ld.rg)}qn.a.getInstance().Lv||P.setValue(lf.a.kR,new Date)}}return!0}jfn(b,h,v){for(let D=0;D<Ph.a.Rha;D++){const P=
this.esa.Hx(b,h,D);if(!P)return u.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",h),!1;const ca=P.getValue(Bc.a.$d);ca&&P.setValue(Bc.a.$d,ca+v)}return!0}krm(b){return b.hasProperty(Bc.a.$d)||b.hasProperty(Bc.a.gt)||b.hasProperty(Bc.a.NA)}kTk(b){return this.OCd(b,1,!0)}NTk(b){return this.OCd(b,-1,!0)}i8h(b,h){var v=new he.GraphIterator;v.set(b);const D=ig.OutlineElementReader.tEa(v),P=ig.OutlineElementReader.xG(v),ca=ig.OutlineElementReader.U3(v);v=Ei.OutlineReader.vX(b);
eo.lRd(b);b=(P?D-P:ca)%v;return h?-1*(b?b:v):v-b>eo.PPh?eo.PPh:v-b}NPo(b,h){let v;const D=new he.GraphIterator;D.set(b);b=D.Sb(4).getValue(Bc.a.listID);return({id:v}=this.esa.smc(b,h)).returnValue?{returnValue:!0,groupId:v}:{returnValue:!1,groupId:v}}KTk(b,h,v){var D=!1;for(let P=0;P<b.length;P++){D=b[P];const ca=new he.GraphIterator;ca.set(D.node);$e.SelectionEditor.ru(ca);if(!ig.OutlineElementReader.Nh(ca))return eo.Jc.Yb(qe.a.kf,{["Reason"]:me.a.zCb}),!1;if(this.OCd(ca,h,v))D=!0;else return eo.Jc.Yb(qe.a.m5b,
{["Reason"]:me.a.B6e}),!1}return D}c_i(b,h){if(this.OCd(b,h,!0)){var v=!1;if(Vg.ListItemReader.yg(b)){var D=new he.GraphIterator;D.Zc(b);this.yq.eP(D);var P=D.currentNode;D.wc();v=!0;const {listId:ta,listLevel:Ra}=Vg.ListItemReader.IQd(b);var ca=this.vem(ta,Ra+h);if(ca)hf.OutlineElementNavigator.Ge(D),fe.ParagraphReader.sh(D)&&eo.lE.RJ(ca,D.currentNode,!1),D.wc();else{ca=null;let mb;hf.OutlineElementNavigator.Ge(D);fe.ParagraphReader.sh(D)&&(ca=D.currentNode);D.wc();mb=ca?ca.ND():null;ca||(hf.OutlineElementNavigator.Ge(D),
fe.ParagraphReader.sh(D)&&(ca=D.currentNode),D.wc());ca&&(ca.hasProperty(Bc.a.$d)&&ca.removeProperty(Bc.a.$d),ca.hasProperty(Bc.a.gt)&&ca.removeProperty(Bc.a.gt));qn.a.getInstance().VC||this.XD.ZQb(P,Ra+h);qn.a.getInstance().Lv&&this.XD.ZQb(ca,Ra+h);qn.a.getInstance().VC||P.removeProperty(Bc.a.i0);ca&&mb&&(this.nj.aV(ca,mb,this.Ld.rg),this.Ss.k$());this.dHo(b,P)}}v||(v=ig.OutlineElementReader.tEa(b),D=ig.OutlineElementReader.xG(b),P=Ei.OutlineReader.vX(b.currentNode),h=this.$ml(b,v,D,h,P),this.eg.Fya(b,
1,h))}}fPm(b,h){const v=ig.OutlineElementReader.tEa(b),D=ig.OutlineElementReader.xG(b),P=ig.OutlineElementReader.U3(b),{Ao:ca,marginLeft:ta,marginRight:Ra}=eo.lRd(b.currentNode);if(0<h){if(b=ca-ta-Ra,P&&P+h+Xa.App.wza>b||v+h+Xa.App.wza>b)return!1}else if(P&&0>v+h||0>v-D+h)return!1;return!0}ePm(b,h){var v=this.Ss.wB(b);const D=v.level+h;if(ax.a.IYm<D||D<ax.a.AFl)return!1;v=this.yq.Hx(b.currentNode,v.listID,D);if(!v)return u.ULS.shipAssertTag(590700875,338,!!v),!1;if(0<h&&v.hasProperty(Bc.a.$d)){h=
v.getValue(Bc.a.$d);const {Ao:P,marginLeft:ca,marginRight:ta}=eo.lRd(b.currentNode);if(h+Xa.App.wza>P-ca-ta)return!1}return!0}vem(b,h){const v=this.uc.Qr();for(let D=0;D<v.kO;D++){const P=v.FEa(D);if(this.yq.ACb(P)&&P.ia(Bc.a.listID,this.Ss.X8+1)===b&&P.ia(Bc.a.listLevel,-1)===h)return P}return null}dHo(b,h){hf.OutlineElementNavigator.Ge(b);if(fe.ParagraphReader.sh(b)&&b.currentNode.hasProperty(Bc.a.$d)&&(h=this.yq.j8b(h))){if(h.hasProperty(Bc.a.gt)){var v=h.getValue(Bc.a.gt);this.ANe.vob(b.currentNode,
v)}h.hasProperty(Bc.a.$d)&&(v=h.getValue(Bc.a.$d),this.ANe.Fya(b,1,v));h.hasProperty(Bc.a.NA)&&(h=h.getValue(Bc.a.NA),this.ANe.lda(b.currentNode,h))}hf.OutlineElementNavigator.Vd(b)}static get lE(){return null!=eo.NJg?eo.NJg:eo.NJg=Ea.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get W9d(){return null!=eo.QFg?eo.QFg:eo.QFg=Ea.a.instance.Na("WordEditor.ParagraphIndentationUtility")}static get paragraphEditor(){return eo.Ms||(eo.Ms=Ea.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(b){eo.Ms=
b}static get Jc(){return bf.a.instance}static get Sf(){return Xm.a.instance}static get Oh(){return Wk.PageNavigator.instance}static lRd(b){var h=Et.WordSectionNavigator.instance.GJ(b);b=eo.Sf.At(h);const v=eo.Sf.nJ(h);h=eo.Sf.$K(h);return{Ao:b,marginLeft:v,marginRight:h}}}eo.PPh=Df.a.Kv(.25);eo.Ms=null;eo.YOi=Df.a.Kv(-11);Object(n.a)(eo,"OutlineElementIndentationEditor",null,[686,687]);var WA=c(230),Yv;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";b[b.table=
3]="table"})(Yv||(Yv={}));Object(n.b)("StyleTargetType",Yv);var Zv=c(213);class Uz{constructor(b,h){this.GW=null;this.sK=h;this.Hf=b}get paragraphEditor(){return null!=this.yFg?this.yFg:this.yFg=Ea.a.instance.resolve("Box4.IParagraphEditor")}get FH(){return null!=this.bAg?this.bAg:this.bAg=Ea.a.instance.resolve("Box4.IFontStylesGalleryCache")}get Fn(){return null!=this.wHg?this.wHg:this.wHg=Ea.a.instance.Na("Box4.Styles.StyleSettings")}get Sn(){return null!=this.tAg?this.tAg:this.tAg=Ea.a.instance.resolve("Box4.IFormattingEditor")}get uc(){return null!=
this.pKg?this.pKg:this.pKg=Ea.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Tda(){return this.GW||(this.GW=new xq.WACStyleSet)}set Tda(b){this.GW=b}get Xb(){return null!=this.Gzg?this.Gzg:this.Gzg=Ea.a.instance.Na("Box4.IFeatureHelper")}get Un(){return this.sK.value}get tj(){return null!=this.xBg?this.xBg:this.xBg=Ea.a.instance.Na("Box4.IInsertionPointFormatting")}get H1d(){return this.Hf||(this.Hf=Ea.a.instance.resolve("Box4.List.IListReader"))}get characterPropertiesEditor(){return null!=
this.cxg?this.cxg:this.cxg=Ea.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Ld(){return null!=this.bJg?this.bJg:this.bJg=Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get nj(){return null!=this.BIg?this.BIg:this.BIg=Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get XQ(){return null!=this.NAg?this.NAg:this.NAg=Ea.a.instance.resolve("Box4.IBox4GraphWriter")}Dem(b){const h=b.node;var v=this.tj?this.tj.$5h():null;if(v&&!v.equals(W.a.nil)){b=
h.Kc;if(!b)return null;v=b.Db(v);if(!v||(v=new Zv.a(v),1!==this.uc.AG(v)))return null}else v=Kl.FormattingReader.Nr(b),v=Kl.FormattingReader.Sna(v);return v}Hoo(b,h){const v=this.uc.NC(h);v&&v.Di(this.uc.kg(b))&&(this.vng(h,v),this.tj&&(this.tj.W5a(),this.tj.M6a(b,h)))}NEk(b,h){if(h)if(h.LDb&&0<h.LDb.length){let P=new Ga.a;for(var v of h.LDb)P.add(v);if(h.LEi){v=Kl.FormattingReader.l4h(b);const ca=[];for(var D of v)D.formatting&&D.formatting.yn&&ca.push(D.formatting.yn);if(0<ca.length){D=Ov.APropertySet.Fai(ca);
v=new Ga.a;for(const ta of P)(!D.hasProperty(ta)||h.uXm&&ta===Pd.a.UIa)&&v.add(ta);P=v}}this.paragraphEditor.$2b(b,!0,P)}else this.paragraphEditor.$2b(b,!0);else Kc.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}RJ(b,h,v,D=!1,P=!1,ca=!1,ta=null,Ra=!1){var mb,Jb;(null===(mb=w.AFrameworkApplication.K)||void 0===mb?0:mb.$("RefactorListCodeIsEnabled"))||(Ra=!1);if(fe.ParagraphReader.Wb(h))if(b)if(this.uc.iY(b.xl()))if(2!==this.uc.AG(b))u.ULS.shipAssertTag(593506381,
324,!1);else{var Ub=this.uc.NC(h);if(Ub)if(mb=this.uc.kg(b),!mb)u.ULS.shipAssertTag(593506377,324,!1);else{if(Ub.Di(mb)){var cc=null,Ac=Dp.a.instance.J(1)&&!D?h.ND():null;v||(ta&&ta.bTk&&this.Xb&&this.Xb.isFeatureEnabled(100)?(this.NEk(h,ta),ui.a.Vj&&1==ta.LDb.length&&ta.LDb[0]==Pd.a.UIa?cc=this.Un.I7i(cc,h):this.eYo(h,b,ta)):(cc=this.Un.I7i(cc,h),this.paragraphEditor.$2b(h,!0)));this.vng(h,Ub);P&&Ac&&Ac.hasProperty(Vi.a.paragraphStyle)&&Ac.removeProperty(Vi.a.paragraphStyle);(null===(Jb=this.XQ)||
void 0===Jb?0:Jb.S9)?this.XQ.S9(h,Vi.a.paragraphStyle,b.id):h.properties.setValue(Vi.a.paragraphStyle,b.id);ui.a.Vj&&(Ra||this.H1d.MC(h))&&this.Xb&&this.Xb.isFeatureEnabled(100)&&this.ZFj(h,b,ta);h.mN=b;h.ZHa=null;for(v=0;v<h.pa.length;v++)h.pa.J(v).formatting&&h.pa.J(v).formatting.O$b();this.H1d.ACb(b)&&(cc||(cc=new he.GraphIterator,cc.set(h),cc.vd(),hf.OutlineElementNavigator.Vd(cc)),Ra||Vg.ListItemReader.yg(cc)||(h.Eg(Bc.a.$d,Bc.a.UM,Bc.a.NA,Bc.a.D0,Bc.a.URa,Bc.a.xw),this.$Ad(cc,b)));this.Fn&&
this.Fn.isProgressiveStyleEnabled&&null!=this.FH&&this.FH.ikc(mb);D||!Ac||ca||this.nj.aV(h,Ac,this.Ld.rg)}}else u.ULS.shipAssertTag(593506379,324,!1)}else u.ULS.shipAssertTag(593506382,324,!1);else u.ULS.shipAssertTag(593506383,324,!1);else u.ULS.shipAssertTag(593506384,324,!1)}eYo(b,h,v){const D=this.H1d.MC(b),P=this.H1d.ACb(h);D&&(this.ZFj(b,h,v),P||D.removeProperty(Bc.a.i0))}ZFj(b,h,v){const D=b.Kc;if(b=this.characterPropertiesEditor.j0a(b)){var P=null==b.yn?new WA.a:b.yn.clone();dl.a.lZo(P,h,
v&&!v.LEi&&v.LDb?v.LDb:null);P.HFa?h=D.GR(P,!0):(D.Pu(P,null),h=P);b.Wj=h.id}else u.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}$Ad(){}M7c(b,h){if(h){u.ULS.shipAssertTag(593506371,324,h.isConnected,"paragraphNode not connected");var v=this.uc.NC(h);v?(b=v.GEa(b))?this.uc.iY(b.xl())?this.RJ(b,h,!1,void 0,void 0,void 0,null):u.ULS.shipAssertTag(593506368,324,this.uc.iY(b.xl())):u.ULS.shipAssertTag(593506369,324,!!b):u.ULS.shipAssertTag(593506370,324,!1,
"StyleReader.GetStyleSetFromParagraphNode==null")}else u.ULS.shipAssertTag(593506372,324,!1)}U7e(b,h=!1,v=!1){const D=this.uc.NC(b).Di(fk.StyleReader.wordStyleIdNormal);this.RJ(D,b,h,void 0,v)}vng(b,h){(b=Uz.Oh.Ys(b))&&h.vjc(b)}JQh(b){var h=null;if(this.Xb&&this.Xb.isFeatureEnabled(36)){if(!b||!b.count)return u.ULS.sendTraceTag(592221652,3018,10,"No style IDs provided for delete."),!1;if(!h&&(h=dl.a.Pr(),!h))return u.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var v=
this.Tda.VQ(h);if(!v)return u.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var D=new Map;D.set("NumberOfStyles",b.count.toString());D.set("Source","DeleteStyleAPI");va.Health.instance.recordKpiUsage(xp.a.Epe,0,xp.a.tB,D);D=0;const ta=(new Date).getTime();var P=null;let Ra=null,mb=null,Jb=null;const Ub=this.Xb.isFeatureEnabled(35)&&!0;Ub&&(P=new Fb.a,Ra=new Fb.a,mb=new Fb.a,Jb=new Fb.a);for(var ca of b){if(!ca)return u.ULS.sendTraceTag(592221655,3018,
50,"Style ID is null."),!1;const cc=v.Di(ca);if(!cc||!this.uc.je(cc,v))return u.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!cc,!!cc&&this.uc.je(cc,v)),!1;const Ac=this.uc.AG(cc);if(2!==Ac&&1!==Ac)return u.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",Ac),!1;const Lc=this.uc.Lva(cc,v);let id=0;if(Lc){if(!this.uc.je(Lc,v))return u.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),
!1;id=this.uc.AG(Lc);if(2!==id&&1!==id)return u.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",Ac,id),!1}else u.ULS.sendTraceTag(592221658,3018,50,"Provided style's linked style is null.");let vd=this.kCb(cc,v);if(!vd)return!1;D++;Ub&&(1===Ac?(Ra.add(ca),Jb.add(cc.id)):(P.add(ca),mb.add(cc.id)));if(Lc){vd=this.kCb(Lc,v);if(!vd)return!1;D++;Ub&&(1===id?(Ra.add(this.uc.kg(Lc)),Jb.add(Lc.id)):(P.add(this.uc.kg(Lc)),mb.add(Lc.id)))}}jv.a.vTc();
v=dl.a.Buf(v);ca=new eh.GraphTransaction(15);ca.Cb(h);Ub&&this.r1n(P,Ra,mb,Jb,h);h.setValue(Vi.a.lja,v);Kc.b(572302817,3018,50,String.format("Style Object Ids - {0}",v));ca.Kge();ca.dispose();h=(new Date).getTime();P=new Map;P.set("Source","DeleteStyleAPI");P.set("NumberOfStyles",b.count.toString());P.set("TrueStyleCount",D.toString());P.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new Bb.a,{extendedProperties:P,durationMs:h-ta});va.Health.instance.recordKpiSuccess(xp.a.Epe,b);return!0}return!1}r1n(b,
h,v,D,P){if(b&&b.count||h&&h.count)if(P){var ca=(new Date).getTime();if(P=this.JVl(P)){for(;P.moveNext();){if(!fe.ParagraphReader.sh(P.iterator))continue;const ta=P.currentNode;this.b1n(ta,b,v);this.c1n(ta,h,D)}v=(new Date).getTime();u.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",v-ca));D=new Map;D.set("Source","DeleteStyleRemoveStylesReferences");D.set("NumberOfStyles",(b.count+h.count).toString());b=Object.assign(new Bb.a,{extendedProperties:D,durationMs:v-
ca});va.Health.instance.recordKpiSuccess(xp.a.Epe,b)}}else Kc.b(577520338,3018,50,"PageContentNode not provided.");else Kc.b(577520337,3018,50,"No style IDs provided")}b1n(b,h,v){if(h&&h.count&&b){var D=b.Ez;D&&D.hasProperty(Vi.a.paragraphStyle)&&v.contains(D.getValue(Vi.a.paragraphStyle))&&(D.removeProperty(Vi.a.paragraphStyle),b.Ez=D,b.ND()&&this.nj.aV(b,b.ND(),this.Ld.rg));(v=this.uc.No(b))&&(v=this.uc.kg(v))&&h.contains(v)&&this.U7e(b,!0,!0)}}c1n(b,h,v){if(b&&b.pa&&b.pa.length&&h&&h.count)for(let ta=
0;ta<b.pa.length;ta++){var D=b.pa.J(ta);if(D&&D.formatting&&(D=D.formatting)&&D.Ib){var P=Kl.FormattingReader.Sna(D);P&&(P=this.uc.kg(P))&&h.contains(P)&&this.Sn.L7e(D);if(P=D.Ib.Wn){var ca=P.yn;ca&&(ca=ca.clone(),ca.hasProperty(Vi.a.kw)&&v.contains(ca.getValue(Vi.a.kw))&&this.n_n(b,ca,P,D));Dp.a.instance.J(1)&&(ca=ta===b.pa.length-1?b.characterData.length:b.pa.J(ta+1).cp,this.nj.nOb(b,D.Ib,D.Ib.cp,ca,P,D,this.Ld.rg))}}}}n_n(b,h,v,D){b&&h&&v&&D&&(b=b.Kc)&&(h.removeProperty(Vi.a.kw),h.HFa?h=b.GR(h,
!0):b.Pu(h,null),v.Wj=h.id,D.Ib.Wn=v)}JVl(b){if(!b)return null;b=he.GraphIterator.$a(b);return b.Bp()?Ka.a.Rs(b,b.origin):null}kCb(b,h){if(!b)return u.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var v=b.xl();return this.uc.iY(v)?h.q1n(b)?!0:(v=new Map,v.set("Source","DeleteStyle"),v.set("StyleType",Yv[this.uc.AG(b)]),v.set("IsCustomStyle",this.uc.je(b,h).toString()),v.set("IsLinkedStyle",(!!this.uc.Lva(b,h)).toString()),b=Object.assign(new Bb.a,{extendedProperties:v}),
va.Health.instance.recordKpiFailure(xp.a.Epe,"UnableToDeleteStyle",!1,!0,b),u.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(u.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),!1)}sRa(b,h,v,D){if(this.Xb&&this.Xb.isFeatureEnabled(81)){if(!b)return u.ULS.sendTraceTag(591138959,3018,15,"No style IDs provided for delete."),!1;if(!v&&(v=dl.a.Pr(),!v))return u.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const ca=
this.Tda.VQ(v);if(!ca)return u.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;b=ca.Di(b);if(!b)return u.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var P=this.uc.AG(b);if(2!==P&&1!==P)return u.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",P),!1;va.Health.instance.recordKpiUsage(xp.a.Lpg,0,xp.a.tB,new Map([["Source","ModifyStyleAPI"]]));P=Date.now();const ta=new eh.GraphTransaction(15);let Ra,mb;try{ta.Cb(v);
if(!(D&&0!=D.length||h&&0!=h.count))return!1;if(D&&0!=D.length&&(Ra=dl.a.JQd(b),!ca.ill(b,D)))return this.cxa("ModifyStyleAPI",b,ca,P,"UnableToDeleteStyleProperties"),!1;if(h&&0!=h.count){const Lc=ca.j_o(b,h);mb=dl.a.JQd(b);if(!Lc)return this.cxa("ModifyStyleAPI",b,ca,P,"UnableToModifyStyle"),!1}this.lfn(b,v,mb,Ra);jv.a.vTc();const Jb=dl.a.Buf(ca);v.setValue(Vi.a.lja,Jb);Kc.b(572302818,3018,50,String.format("Style Object Ids - {0}",Jb));const Ub=Date.now(),cc=new Map([["Source","ModifyStyleAPI"]]),
Ac=Object.assign(new Bb.a,{extendedProperties:cc,durationMs:Ub-P});va.Health.instance.recordKpiSuccess(xp.a.Lpg,Ac);return!0}finally{ta&&ta.dispose()}}return!1}lfn(b,h,v,D){var P,ca;if(null!==b){var ta;D&&((ta=null===(P=this.Un)||void 0===P?void 0:P.loe(h,D,b,!0))||Kc.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));v&&((ta=null===(ca=this.Un)||void 0===ca?void 0:ca.loe(h,v,b,!1))||Kc.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}cxa(b,
h,v,D,P){const ca=Date.now();b=new Map([["Source",b],["StyleType",Yv[this.uc.AG(h)]],["IsCustomStyle",this.uc.je(h,v).toString()],["IsLinkedStyle",(!!this.uc.Lva(h,v)).toString()]]);D=Object.assign(new Bb.a,{extendedProperties:b,durationMs:ca-D});va.Health.instance.recordKpiFailure(xp.a.Lpg,P,!1,!0,D)}static get Oh(){return Wk.PageNavigator.instance}}Object(n.a)(Uz,"WACStyleEditor",null,[1259]);class XA extends Uz{constructor(b,h,v){super(b,v);this.t6=h}get Ss(){return this.t6.value}$Ad(b,h){this.Ss.$Ad(b,
h)}}Object(n.a)(XA,"WACStyleEditor",Uz,[]);class rs{F6a(b,h){b.properties.setValue(Bc.a.marginTop,h)}D6a(b,h){b.properties.setValue(Bc.a.marginBottom,h)}Via(b,h){b.properties.setValue(Bc.a.marginLeft,h)}E6a(b,h){b.properties.setValue(Bc.a.marginRight,h)}Bbg(b,h){b.properties.setValue(Bc.a.Ao,h)}Abg(b,h){b.properties.setValue(Bc.a.qv,h)}mmj(b,h){b.properties.setValue(Bc.a.XEi,h)}jOb(b,h){b.properties.setValue(Pd.a.UE,h)}Uho(b,h){b.properties.setValue(Pd.a.sma,h)}ejc(b,h){b.properties.setValue(Pd.a.hG,
h)}loo(b,h){b.properties.setValue(Pd.a.separator,h)}}Object(n.a)(rs,"WordSectionEditor",null,[450]);class $v{get name(){return"WordEditor.OutlineLevelEditors"}xc(b){b.ha("WordEditor.OutlineLevelEditors.WordSectionEditor",()=>new rs).as("Box4.IWordSectionEditor").singleInstance();w.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ha("Box4.OutlineLevelEditors.PageContentEditor",()=>new Zf(b.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").singleInstance(),
b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new eo(kt.a.jPa,b.resolve("WordEditor.List.IFlatListReader"),b.Ue("Box4.IOutlineElementEditor"),b.Ue("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("Box4.IOutlineElementIndentationEditor"),b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new eo(kt.a.jPa,b.resolve("WordEditor.List.IFlatListReader"),b.Ue("Box4.IOutlineElementEditor"),b.Ue("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),
b.ha("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new VA).as("Box4.List.ICursorMovementValidator").singleInstance(),b.ha("Box4.Styles.WACStyleReader",()=>new OC.a(new xq.WACStyleSet)).as("Box4.Styles.IWACStyleReader").singleInstance(),b.ha("WordEditor.OutlineLevelEditors.WACStyleEditor",()=>new XA(b.resolve("Box4.List.IListReader"),b.Ue("WordEditor.IFlatListEditor"),b.Ue("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").singleInstance())}init(){}dispose(){}static main(){N.a.instance.Fc(new $v)}}
Object(n.a)($v,"WordEditorOutlineLevelEditorsPackage",null,[1,2]);var YA=c(1197),ly=c(209);class Ym{constructor(b,h){this.Gd=b;this.nh=h;this.MLa=null}ohe(b){var h=b.propertySet.ia(Bc.a.listID,0);const v=b.propertySet.ia(Bc.a.listLevel,-1);if(0<h&&0<=v)this.MLa=b;else{let D=1;const P=b.listStyle;42!==P&&0<P&&(D=P);this.MLa=Iu.a.n_(b.listType,D,null,h,v,void 0,"")}h=new Zy.a;switch(b.J5){case 0:this.MLa.NB=h.Daf();break;case 2:this.MLa.NB=h.VKh(h.gzh,h.fzh);break;case 1:this.MLa.NB=h.wbf(h.eSf,h.fSf)}}Lmo(b){b&&
(this.MLa=b)}iMh(b){const h=bf.a.instance.yp(Gb.a.createList);ig.OutlineElementReader.Nh(b)||(u.ULS.sendTraceTag(508904658,393,15,"PossiblyIncorrectListCreation - createList called with a non OE iterator"),bf.a.instance.Yb("PossiblyIncorrectListCreation",{["Reason"]:me.a.zCb}));Vg.ListItemReader.yg(b)&&(u.ULS.sendTraceTag(508904657,393,15,"PossiblyIncorrectListCreation - createList called when OE already has list"),bf.a.instance.Yb("PossiblyIncorrectListCreation",{["Reason"]:me.a.D5k}));const v=ig.OutlineElementReader.$T(b);
v&&!v.hasProperty(Bc.a.endOfParagraphFormatting)&&u.ULS.sendTraceTag(560563602,393,50,"Paragraph has null EOP formatting during creation of list node.");const D=this.Wbl();b.Af(D,4);v&&(v.VI=D);h.end();return D}Wbl(){return Zo.a.instance.createInstance(393234)}Zca(b){const h=bf.a.instance.yp(Gb.a.Zca);ig.OutlineElementReader.Nh(b)||bf.a.instance.Yb("PossiblyIncorrectListRemoval",{["Reason"]:me.a.zCb});Vg.ListItemReader.yg(b)&&(qn.a.getInstance().Lv?this.fHa(b):this.Aaj(b));h.end()}Aaj(b){this.Gd.eP(b);
b.xg()}Vla(b,h,v,D=!1){const P=bf.a.instance.yp(Gb.a.UEk);this.knj(b,v,D);const ca=b.hasProperty(Wc.a.wQi);var ta=b.ia(Wc.a.kYd,!1);let Ra=!1;1===v.Wr&&v.Poa&&!v.BJ&&(Ra=!0);const mb=v.propertySet.ia(Bc.a.ov,null);mb&&mb===Box4Intl.Box4Strings.L_ListStyleNone&&(1===v.listType?Ra=v.Poa&&!v.BJ:v.listType||(Ra=!v.listStyle));if(ta)Ra&&(v.Q9(16,0),b.setValue(Wc.a.JA,16),b.setValue(Wc.a.VQa,0));else{ta=this.Gd.qw(h);this.xrj(v,ta,ca,Ra)&&(P.properties.Z("ToggledOff","true"),v.Q9(16,0),this.Clo(b));if(!this.x$d(b,
h,v,D))return P.end(),u.ULS.sendTraceTag(578331472,393,15,"Failed in performing auto correct numbering."),{returnValue:!1,qwa:v};!v.listType&&b.hasProperty(Wc.a.R3a)&&(v.VB=b.getValue(Wc.a.R3a),b.removeProperty(Wc.a.R3a))}if(ca&&(P.properties.Z("MultipleOESelection","true"),({qwa:v}=this.ivo(h,v)).returnValue))return P.end(),u.ULS.sendTraceTag(578331473,393,15,"Multiple OE selected and OE is empty as well."),{returnValue:!1,qwa:v};this.NAk(h,v,b,D);Qz.a.jej();b.hasProperty(Hh.a.pQ)&&Qz.a.F9k(b.getValue(Hh.a.pQ),
h,this.Gd);b.setValue(Wc.a.kYd,!0);P.end();return{returnValue:!0,qwa:v}}xrj(b,h,v,D){if(D)return!0;if(h){D=b.listType===h.listType;const P=!b.listStyle&&b.VB===Ph.a.rl;let ca=b.listStyle===h.listStyle&&b.VB===h.VB;b=(!b.Poa||this.i9f(h,b))&&!v;ca=ca&&b;return D&&(P||ca)}return!1}Clo(b){b.setValue(Wc.a.JA,16);b.setValue(Wc.a.VQa,0)}i9f(){return!0}knj(){}x$d(){return!0}ivo(b,h){return{returnValue:16!==h.listType&&ig.OutlineElementReader.isEmpty(b,!0),qwa:h}}KGc(b){const h=bf.a.instance.yp(Gb.a.KGc);
fe.ParagraphReader.Wb(b)||bf.a.instance.Yb("ClearingListFromNonParagraph",{["Reason"]:me.a.ugf});const v=new he.GraphIterator;v.set(b);v.vd();v.mt(12);hf.OutlineElementNavigator.Vd(v);this.fHa(v);h.end()}merge(b,h,v){const D=bf.a.instance.yp(Gb.a.i0m);ig.OutlineElementReader.Nh(h)||bf.a.instance.Yb("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});ig.OutlineElementReader.Nh(b)||bf.a.instance.Yb("PossibleIncorrectMergeOfOEs",{["Reason"]:"DestIsNotOE"});Vg.ListItemReader.yg(h)&&(D.properties.Z("UseSourceListWithNonlistDestination",
v.toString()),v&&Vg.ListItemReader.yg(b)&&this.Zca(b),Vg.ListItemReader.yg(b)&&!v?this.H4i(h,b):v&&(v=this.qbi(h),1===v.Wr&&v.w7e(!0),this.JEc(b,v),D.properties.Z("MoveListInfoFromSrcToDestOE","true")),this.Zca(h),D.properties.Z("RemoveListFromSrcOE","true"));D.end();return!0}H4i(){}qbi(b){return this.Gd.qw(b)}oLc(b,h){h.hasProperty(Wc.a.JA)||(b===Gb.a.jD?h.setValue(Wc.a.JA,1):(b===Gb.a.wL||b===Gb.a.Fca)&&h.setValue(Wc.a.JA,0));h.hasProperty(Wc.a.VQa)||h.setValue(Wc.a.VQa,0);return h}I1b(b,h,v,D,
P,ca,ta,Ra){const mb=bf.a.instance.yp(Gb.a.I1b),Jb=this.Gd.qw(h);v=Iu.a.n_(0,v,void 0,void 0,void 0,ta);v.VB=D;v.pQ=ca;Jb&&v.zxf(Jb)&&v.VB===Jb.Ku||(D=new eh.GraphTransaction(15),D.Lt(h),Ra.numbering(v.listType,v.listStyle,v.VB,v.levelText,v.pQ)&&(Ym.characterPropertiesEditor.replaceTextRange(P,""),fe.ParagraphReader.Wb(b)&&ly.a.Aoa(b)&&(h=this.Gd.MC(b))&&Ym.characterPropertiesEditor.jwl(b,h)),D.dispose());mb.end()}loe(b,h,v,D=!1){if(null===v||null===b||null===h)return!1;b=this.Gd.Hx(b,h.listId,h.listLevel);
if(!b)return u.ULS.sendTraceTag(523069061,393,15,"List def not exist when trying to update pStyle Property."),!1;if(D){if(b.hasProperty(Vi.a.paragraphStyle)){b.getValue(Vi.a.paragraphStyle)instanceof W.a||u.ULS.sendTraceTag(512267811,393,15,"StyleObject ID already in list def is not ExtendedGuid.");if(!W.a.eq(b.getValue(Vi.a.paragraphStyle),v.id))return u.ULS.sendTraceTag(523069062,393,15,"List def has different pStyle than what we are expecting to remove, thus not removing it."),!1;b.removeProperty(Vi.a.paragraphStyle);
return!0}}else{v=v.id;v instanceof W.a||u.ULS.sendTraceTag(512267810,393,15,"StyleObject ID to be set on list def is not extendedGuid");if(b.hasProperty(Vi.a.paragraphStyle))return u.ULS.sendTraceTag(523069063,393,15,"List def has different pStyle than what we are expecting to set, thus not setting it."),!1;b.setValue(Vi.a.paragraphStyle,v);return!0}return!1}static get S6b(){return null!=Ym.Yzg?Ym.Yzg:Ym.Yzg=Ea.a.instance.Na("Box4.IFontSlotProvider")}static get characterPropertiesEditor(){return null!=
Ym.Vwg?Ym.Vwg:Ym.Vwg=Ea.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Vn(){return qn.a.getInstance()}}Object(n.a)(Ym,"ListEditor",null,[725]);var dz=c(805),aw=c(315);class as{constructor(b,h,v,D,P,ca){this.Hf=P;this._pageContent=v;this.Rvb=Array(as.Rha);this.NZb=Array(as.Rha);this.ihh=Array(as.Rha);this.tQe=Array(as.Rha);this.udh=Array(as.Rha);this.K2=D;this.WCc=ca;for(D=0;D<as.Rha;D++){var ta=this.kbi(b,D,v,P);ta?(ca=ta.ia(lf.a.k0,Ph.a.rl),ta=ta.ia(Bc.a.H5c,Ph.a.rl)):ta=ca=Ph.a.rl;
this.NZb[D]=ca!==Ph.a.rl?ca:Ph.a.vJc;this.tQe[D]=ta===Ph.a.rl?D-1:ta-1;as.a9(h)&&(this.ihh[D]=Ph.a.rl,this.udh[D]=Ph.a.rl);this.Rvb[D]=this.NZb[D]}}kbi(b,h,v,D){D.I3(v);return qn.a.getInstance().RTc&&this.WCc?this.Hf.Qrf(b,h,this.K2,v):this.Hf.XOc(b,h,v.Kc,v)}restart(b){this.Rvb[b]=this.NZb[b]}lRi(b){for(var h=0;h<b;h++)this.Rvb[h]===this.NZb[h]&&this.Rvb[h]++;for(h=b+1;h<as.Rha;h++)this.tQe[h]>=b&&this.restart(h);return this.Rvb[b]++}static a9(b){return!!b&&b.isFeatureEnabled(71)}}as.Rha=9;Object(n.a)(as,
"AWordList",null,[43]);class Gw{constructor(b,h,v,D){this.jbb=new cl.ScriptSharpLegacyMap;this.Hf=b;this.wK=h;this.K2=v;this.WCc=D}qw(b,h){this.jbb.mb(b)||this.jbb.Z(b,new as(b,h,this.wK,this.K2,this.Hf,this.WCc));return this.jbb.J(b)}lRf(b,h,v){return this.qw(b,v).lRi(h)}}Object(n.a)(Gw,"AListNumberingMap",null,[1505]);class ZA extends as{constructor(b,h,v,D,P,ca){super(b,h,v,D,P,ca)}k7l(b,h,v,D){D.I3(v);return qn.a.getInstance().RTc&&this.WCc?this.Hf.Q2l(b,h,this.K2):this.Hf.P2l(b,h,this._pageContent.Kc)}TFj(b,
h,v){var D=this.k7l(b,h,this._pageContent,this.Hf);D?(b=D.ia(lf.a.k0,Ph.a.vJc),D=D.ia(Bc.a.H5c,Ph.a.rl),this.Rvb[h]=this.ihh[h]=this.NZb[h]=b,D!==Ph.a.rl&&(this.udh[h]=this.tQe[h]=D-1)):v&&(D=this.kbi(b,h,this._pageContent,this.Hf),b=Ph.a.vJc,D&&(b=D.ia(lf.a.k0,Ph.a.vJc)),this.Rvb[h]=this.NZb[h]=b)}}Object(n.a)(ZA,"WordList",as,[]);class ez extends Gw{constructor(b){super(b.Gd,b.pageContentNode,b.QSa,b.$Ij);this.Obh=new Fb.a}q2l(b,h,v){let D;qn.a.getInstance().hY?{value:D}=this.Hf.AJ.Dc(b,D):{value:D}=
this.Hf.h0.Dc(b,D);this.jbb.mb(D)||this.jbb.Z(D,new ZA(b,v,this.wK,this.K2,this.Hf,this.WCc));if(!this.Obh.contains(b))for(this.Obh.add(b);h<Ph.a.Rha;h++)this.jbb.J(D).TFj(b,h,!1);else if(!h)for(h+=1;h<Ph.a.Rha;h++)this.jbb.J(D).TFj(b,h,!0);return this.jbb.J(D)}lRf(b,h,v){return as.a9(v)?this.q2l(b,h,v).lRi(h):super.lRf(b,h,v)}}Object(n.a)(ez,"ListNumberingMap",Gw,[]);class my{constructor(){this.ARa=0;this.OKj=!1}}Object(n.a)(my,"LastNumber",null,[]);var fz=c(829),ZB=c(605),gz=c(885);class Vz{constructor(){this.startAt=
this.MSa=0}}Object(n.a)(Vz,"WordListRestartInfo",null,[]);class dq{constructor(b,h,v,D){this.T5d=!1;this.Ss=b;this.Vyi=v;this.Y$b=D;this.zw=this.Ss.wB(h);this.outlineElement=new he.GraphIterator;this.outlineElement.Zc(h)}static get Gd(){return dq.Hf||(dq.Hf=Ea.a.instance.resolve("Box4.List.IListReader"))}static set Gd(b){dq.Hf=b}static get Vn(){return qn.a.getInstance()}static RDl(b,h,v,D=!1,P=!1){var ca=h.currentNode;let ta=null,Ra=!1,mb=!1;h=h.qRb();const Jb=Ka.a.Zo(h);Jb.moveNext();for(h=Jb.iterator;h.currentNode!==
ca;){let cc=mb=Ra=!1;var Ub=dq.esl(h);if(ig.OutlineElementReader.Nh(h)&&!Ub){Ub=!1;if(h.Rr(4))if(dq.GSi(h,v,!0,D,P)){if(cc=!0,ta=new dq(b,h,!1,!1),Jb.moveNext(),Jb.iterator===ca&&(Ra=!0),D)break}else ig.OutlineElementReader.isEmpty(h,!1)||(Ub=!0),mb=!0;else!ig.OutlineElementReader.isEmpty(h,!1)&&h.Bib(12)&&(ig.OutlineElementReader.yQ(h)||(Ub=!0));!D&&Ub&&ta&&(v.propertySet.hasProperty(Bc.a.listLevel)?ta.zw.level=0:ta=null)}cc||Jb.moveNext();h=Jb.iterator}ta&&(ta.Y$b=Ra);if(!ta&&h.Pf(1))for(ca=!0;h.currentNode;){if(ig.OutlineElementReader.Nh(h)){if(h.Rr(4)&&
dq.GSi(h,v,!1,D,P)){ta=new dq(b,h,!0,ca);break}if(!ig.OutlineElementReader.isEmpty(h,!1))break}if(!h.Pf(1))break;ca=!1}ta&&(ta.T5d=mb);return ta}static esl(b){var h=b.Sb(2);if(!h)return!1;h=fe.ParagraphReader.sh(b)&&dq.nQm(h);b.wc();return h}static nQm(b){return Yo.a(b,8)}static GSi(b,h,v,D=!1,P=!1){if(!Vg.ListItemReader.yg(b)&&(u.ULS.sendTraceTag(508913603,393,15,"Trying to call oeMatchesInfo for non list item"),Vg.ListItemReader.Dp))return!1;if(Vg.ListItemReader.Dp)var ca=Vg.ListItemReader.Iba(b);
else dq.Gd.eP(b),ca=b.currentNode,b.wc();const ta=dq.Gd.BX(ca);(b=h.zz===ta.zz)&&h.listStyle&&1!==h.Wr&&(b=h.listStyle===ta.listStyle);b&&(h.Poa&&1!==h.Wr||h.d7b||P)&&(b=dq.jOm(h,ta),h.zz||(b=b&&h.font===ta.font));if(1===h.Wr)if(1===ta.Wr&&ta.propertySet.hasProperty(Hh.a.glb))b=h.J5===ta.J5;else return!1;b&&h.zz&&h.VB!==Ph.a.rl&&(b=ta.Ku,v&&(D&&1===h.VB&&1===b||b++),b=h.VB===b);b&&(D||h.d7b)&&(h=Vg.ListItemReader.m2l(h).listId,ca=Vg.ListItemReader.E_(ca,{gCb:0}).listId,0<h&&0<ca&&(b=h===ca));return b}static jOm(b,
h){h=h.DJf;b.Poa&&(h=h.replace(RegExp("%\\d"),"%1"));return h.toLocaleLowerCase()===b.DJf.toLocaleLowerCase()}static SDl(b,h,v){var D=h.currentNode;let P=null;const ca=new he.GraphIterator,ta=b.Nna(D,v);var Ra=!1;let mb=!1;ca.Zc(h);ca.wc();for(ca.Sb(1);ca.currentNode!==D;)mb=Ra=!1,ig.OutlineElementReader.Nh(ca)&&ca.Rr(4)&&(h=b.wB(ca),dq.HSi(h,v,!0)?(P=new dq(b,ca,!1,!1),Ra=!0):(mb=!0,h.listID===v.listID&&h.level<=ta.MSa&&(P=null))),ca.Pf(1);P&&(P.Y$b=Ra);if(!P&&ca.Pf(1))for(D=!0;ca.currentNode;){if(ig.OutlineElementReader.Nh(ca)&&
ca.Rr(4)){Ra=b.wB(ca);if(Ra.listID===v.listID&&Ra.level<=ta.MSa)break;if(dq.HSi(Ra,v,!1)){P=new dq(b,ca,!0,D);break}}if(!ca.Pf(1))break;D=!1}P&&(P.T5d=mb);return P}static HSi(b,h,v){let D=b.listID===h.listID&&b.level===h.level;D&&h.Ku!==Ph.a.rl&&(b=b.Ku,v&&b++,D=h.Ku===b);return D}}dq.Hf=null;Object(n.a)(dq,"JoinTargetInfo",null,[]);class ss{constructor(b,h){this.zw=null;this.action=b;h&&(this.zw=h)}static zec(){return new ss(0)}static PGi(){return new ss(1)}static K_m(b){return new ss(3,b)}static a0m(b){return new ss(2,
b)}static N_m(b){return new ss(4,b)}}Object(n.a)(ss,"ApplyListInfoResult",null,[]);class $A{constructor(b,h,v){this.Ckc=v;this.xyn=h;this.H$=v-h.Ku;this.K0c=h.listID}get delta(){-1!==this.H$&&(this.H$=this.Ckc-this.xyn.Ku);return this.H$}set delta(b){this.H$=b}}Object(n.a)($A,"ListTransferInfo",null,[]);class zp extends Ym{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac){super(b,v,mb);this.XD=Ac;this.Ngh=!1;this.zrc=this.yhd=this.jUb=null;this.Bje=(Lc,id)=>id.listID===Lc.listID&&id.level===Lc.level;
this.Bzo=(Lc,id,vd)=>id.listID!==Lc.listID&&id.listID!==vd.K0c||id.level!==Lc.level?!1:!0;this.sbn=(Lc,id,vd)=>id.listID===Lc.listID||vd&&id.listID===vd.K0c?!0:!1;this.ztj=(Lc,id,vd,xe,Ld)=>{const Qd=Lc.ia(Ym.Vn.tV,-1);this.ytj(Lc,id,Qd+vd,xe,Ld)};this.ytj=(Lc,id,vd,xe,Ld)=>{qn.a.getInstance().VC||this.XD.yqb(Lc,xe);id=Vg.ListItemReader.Dp?id:Lc;Lc=this.VEb(id);id=he.GraphIterator.$a(id);id.vd();id.wc();this.dIl(id,Lc,this.sbn,this.FFo,Ld)};this.Czo=(Lc,id,vd,xe,Ld)=>{const {zw:Qd,iterator:Zd}=this.n5b(id,
()=>{qn.a.getInstance().VC||this.XD.yqb(Lc,xe);qn.a.getInstance().Lv&&this.XD.yqb(id,xe);var te=Vg.ListItemReader.Dp?id:Lc;const Qf=this.VEb(te);te=he.GraphIterator.$a(te);te.vd();te.wc();return{zw:Qf,iterator:te}});this.oNd(Zd,Qd,this.Wwj,this.Cke,Ld)};this.DFo=(Lc,id,vd,xe,Ld)=>{this.m7i(Lc,id,vd,xe,Ld)};this.Cke=(Lc,id,vd,xe)=>{vd.listID=id.listID;xe.Sb(4);const Ld=this.yq.UEb(xe.currentNode);this.n5b(Ld,()=>{this.KEc(xe.currentNode,vd,Ld);xe.wc()})};this.FFo=(Lc,id,vd,xe)=>{Vg.ListItemReader.yg(xe)&&
(Lc=new he.GraphIterator,Lc.Zc(xe),Lc.vd(),this.Gd.eP(Lc),this.Vti(xe.currentNode,Lc.currentNode))};this.EFo=(Lc,id,vd,xe,Ld)=>{vd.listID=id.listID;this.m7i(Lc,id,vd,xe,Ld);this.Cke(Lc,id,vd,xe,Ld)};this.Vwj=(Lc,id)=>id.listID===Lc.listID;this.CFo=(Lc,id)=>id.level<=Lc.level;this.Wwj=(Lc,id,vd)=>id.listID===vd.K0c;this.Xo=P;this.esa=b;this.Cld=h;this.Ic=D;this.JYf={};this.Eak=ca;this.Sd=ta;this.tq=Ra;this.ld=Jb;this.Xy=Ub;this.Vu=cc}get a9(){return this.esa.vha}get uPb(){return this.Ngh}set uPb(b){this.Ngh=
b}get yq(){return this.esa}get y5(){return this.Vu}get uc(){return this.Xy}get ku(){return this.yq.ku}get Cq(){return this.yq.Cq}get Eta(){return this.yq.Eta}get X8(){return this.yq.X8}set X8(b){this.yq.X8=b}get OQa(){return this.yq.OQa}set OQa(b){this.yq.OQa=b}get b9c(){return null!=this.SGg?this.SGg:this.SGg=Ea.a.instance.Na("Box4.List.ISingleLevelListEditor")}NAk(b,h,v,D){u.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const P=v.ia(Wc.a.kYd,!1);let ca=!1,ta=-1;
!P||h.listStyle&&1!==h.Wr||(ca=!v.ia(Wc.a.LHf,!1),ta=v.ia(Wc.a.CJf,-1));b=this.JEc(b,h,{Oqi:ca,n_m:ta,nIl:D,propertySet:v});P||v.setValue(Wc.a.LHf,2===b.action);3===b.action&&!v.hasProperty(Wc.a.CJf)&&b.zw&&v.setValue(Wc.a.CJf,b.zw.level)}merge(b,h,v,D=null){const P=Vg.ListItemReader.yg(b)||Vg.ListItemReader.yg(h);b=super.merge(b,h,v,D);P&&this.k$();return b}H4i(b,h){this.DUk(b,h)}DUk(b,h){b=this.Gd.Jrf(b);const v=this.Gd.Jrf(h);-1!==b&&-1!==v&&(b-=v,0<b?this.Cld.value.DJc(h,b):0>b&&this.Cld.value.eSa(h,
b,0))}Aaj(b){this.Gd.eP(b);b.xg();Dp.a.instance.J(1)&&this.k$()}GNo(b,h,v,D){var P=he.GraphIterator.$a(v);P=this.wB(P);this.HNo(P,b,h,v,D)}wB(b){if(!Vg.ListItemReader.yg(b)&&(u.ULS.sendTraceTag(508924048,393,15,"Trying to fetch list Ref info for non list item"),Vg.ListItemReader.Dp))return null;let h;Vg.ListItemReader.Dp?h=Vg.ListItemReader.Iba(b):(this.Gd.eP(b),h=b.currentNode,b.wc());return this.VEb(h)}Imj(b,h){this.Gd.eP(b);const v=b.currentNode;b.wc();qn.a.getInstance().VC||this.XD.yqb(v,h);b=
ig.OutlineElementReader.$T(b);qn.a.getInstance().Lv&&this.XD.yqb(b,h);return this.VEb(Vg.ListItemReader.Dp?b:v)}VEb(b){var h;const v=new dz.a;Vg.ListItemReader.Dp&&(b&&fe.ParagraphReader.Wb(b)||u.ULS.sendTraceTag(509141474,393,15,`Paragraph node not sent in getListRefInfoNode. Node sent: ${null===(h=null===b||void 0===b?void 0:b.constructor)||void 0===h?void 0:h.name}`));h=Dp.a.instance.J(1)?Vg.ListItemReader.Dp?Vg.ListItemReader.E_(b)||Vg.ListItemReader.PRd(b):this.Gd.HO(b,!1,!0):Vg.ListItemReader.E_(b,
{gCb:0,hId:-1});v.listID=h.listId;v.level=h.listLevel;v.i0=Vg.ListItemReader.yxf(b);h=this.OQd(b);v.Jjo(h);v.Ku=Vg.ListItemReader.nkm(b);v.tKc=Vg.ListItemReader.lkm(b);return v}qhe(b,h,v=!1){const D=v?null:ig.OutlineElementReader.$T(b);b=qn.a.getInstance().VC?null:this.iMh(b);this.KEc(b,h,D,v);return b}KEc(b,h,v=null,D=!1){b||bf.a.instance.Yb("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});!qn.a.getInstance().Lv||D||v||Kc.b(509364259,393,15,"Apply list info called without para node");h||bf.a.instance.Yb("CrashWhenApplyingList",
{["Reason"]:"RefInfoIsNull"});qn.a.getInstance().Lv&&v&&!D&&this.XD.mhe(v,h.listID,h.level);qn.a.getInstance().VC||(this.XD.mhe(b,h.listID,h.level),h.i0&&b.setValue(Bc.a.i0,!0),qn.a.getInstance().Lv||null==h.levelText||b.setValue(Bc.a.ov,h.levelText))}VGj(b){this.yq.I3(b);b=zp.Oh.Ys(b);let h=b.ia(Bc.a.Cq,null);h=h?Array.clone(h):[];b.setValue(Bc.a.Cq,h);this.yq.Q$b()}qFo(b){switch(b){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}w2l(b){b=
b.view;if(!b.lb||!b.lb.gb)return null;b=fv.OutlineElementGeneralizer.tna(b.lb.gb,!1);if(1!==b.length)return null;b=he.GraphIterator.$a(b.getContext(0).node);if(!Vg.ListItemReader.yg(b))if(14===b.Pd().type){const h=this.yq.qlm(b.currentNode);h&&b.set(h)}else Kc.b(589177753,393,15,"Encountered an OE of non list type."),b.wc();b.vd();return b}Bcl(b,h,v,D){const P=b.GH(),ca=new dz.a;ca.listID=this.BMh(b);this.a9?(ca.y1d=Ym.Vn.hY?this.CMh(b):this.sMh(b),this.p8i(b,ca.listID,ca.y1d)):this.r8i(b,ca.listID);
ca.umj(h.propertySet,this.KXc(v));this.CKd(b);v=this.obi(b,h);for(let Ra=0;9>Ra;Ra++){const mb=new Tx.a;P.od.Pu(mb);this.q8i(b,this.a9?W.a.nil:mb.id,this.a9?mb.id:W.a.nil);this.Hsk(mb,h.zz,Ra);this.Uoh(mb,v,Ra);var ta=D.hJb[Ra];ta=6===ta?Iu.a.n_(1,1):Iu.a.n_(0,ta);ta.Gha&&mb.setValue(lf.a.C4,ta.Gha);h.VB!==Ph.a.rl&&Ra===ca.level&&mb.setValue(lf.a.k0,h.VB);D.dEa&&D.dEa[Ra]&&mb.setValue(lf.a.font,D.dEa[Ra]);ta=D.MXc[Ra];u.ULS.shipAssertTag(22127636,338,!!ta);mb.setValue(Bc.a.ov,ta);mb.setValue(Bc.a.yca,
D.J0d[Ra]);aw.a.aie(D.J5,mb)}return ca}zcl(b,h,v){const D=b.GH(),P=new dz.a;P.listID=this.BMh(b);this.a9?(P.y1d=Ym.Vn.hY?this.CMh(b):this.sMh(b),this.p8i(b,P.listID,P.y1d)):this.r8i(b,P.listID);P.umj(h.propertySet,this.KXc(v));if(!h.listStyle)switch(P.level%3){case 0:h.Q9(h.listType,1);break;case 1:h.Q9(h.listType,2);break;case 2:h.Q9(h.listType,3)}this.CKd(b);v=this.obi(b,h);for(let ca=0;9>ca;ca++){const ta=new Tx.a;D.od.Pu(ta);this.q8i(b,this.a9?W.a.nil:ta.id,this.a9?ta.id:W.a.nil);this.Gsk(ta,
h.zz,ca);this.Uoh(ta,v,ca);2===ca%3&&h.zz?ta.setValue(Bc.a.yca,"right"):ta.setValue(Bc.a.yca,"left");ca===P.level&&(h.Gha&&ta.setValue(lf.a.C4,h.Gha),h.VB!==Ph.a.rl&&ta.setValue(lf.a.k0,h.VB),h.zz?this.ymj(h,ta,ca):(zp.vmj(h,ta),zp.xmj(h,ta)),zp.wmj(h,ta),h.d7b&&ta.MNa(h.propertySet,Bc.a.listID,Bc.a.listLevel))}return P}ymj(b,h,v){b.Poa?(b=b.levelText,b=G.a.replaceAll(b,"%1","%"+(v+1))):b=b.DTc||b.Yna?b.levelText:"%"+(v+1)+".";u.ULS.shipAssertTag(22127638,338,!!b);h.setValue(Bc.a.ov,b)}xrj(b,h,v,
D){if(b.DTc)return!1;if(1===b.Wr)return D;if(D)return!0;if(h){D=b.listType===h.listType;const P=!b.listStyle&&b.VB===Ph.a.rl;let ca=b.listStyle===h.listStyle&&b.VB===h.VB;b=(!b.Poa||this.i9f(h,b))&&!v;ca=ca&&b;return D&&(P||ca)}return!1}CKd(b){this.jUb||(this.jUb=b.ia(Bc.a.Qil,null));this.yhd||(this.yhd=b.ia(Bc.a.Pil,null));this.zrc||(this.zrc=b.ia(Bc.a.Ril,null))}KXc(b){720>b&&(b=0);return Math.max(0,Math.min(Math.floor(b/720),8))}i0l(b){return b?this.Xo.XT(b).Ot-this.Xo.xG(b).Ot:-1}r8i(b,h){const v=
b.ia(Bc.a.ku,null),D=v?v.length:0,P=Array(D+1);let ca=0;for(;ca<D;ca++)P[ca]=v[ca];P[ca]=h;b.setValue(Bc.a.ku,P);this.yq.Q$b()}p8i(b,h,v){this.JZe(Bc.a.ku,b,h);if(Ym.Vn.hY){this.JZe(Pd.a.B4a,b,v);var D=this.yq.LQd(b);D.add(h,v);b.setValue(Pd.a.AJ,ZB.b(YA.a.Slc(D)))}else this.JZe(Bc.a.Eta,b,v),D=this.yq.KQd(b),D.add(h,v),b.setValue(Bc.a.h0,ZB.b(YA.a.Slc(D)))}q8i(b,h,v){this.a9?(this.Joh(Bc.a.Cq,b,v),this.Joh(Bc.a.s9,b,h)):(v=(v=b.ia(Bc.a.Cq,null))?Array.clone(v):[],v.push(h),b.setValue(Bc.a.Cq,v),
this.yq.Q$b())}JZe(b,h,v){const D=h.ia(b,null),P=D?D.length:0,ca=Array(P+1);let ta=0;for(;ta<P;ta++)ca[ta]=D[ta];ca[ta]=v;h.setValue(b,ca)}Joh(b,h,v){let D=h.ia(b,null);D=D?Array.clone(D):[];D.push(v);h.setValue(b,D)}Gsk(b,h,v){var D=v%3+1;const P=h?this.zrc:this.yhd;P&&v<P.length?b.setValue(Bc.a.gt,P[v]):b.setValue(Bc.a.gt,360);D=Iu.a.n_(h?0:1,this.qFo(D),null,0,v);b.Vw(D.propertySet);b.setValue(Bc.a.z3e,h?-1:-2);h?b.setValue(Bc.a.ov,"%"+(v+1)+"."):(b.setValue(lf.a.font,this.NUl(v)),b.setValue(Bc.a.ov,
String.fromCharCode(this.DUl(v))));aw.a.mjc(2,b)}Hsk(b,h,v){const D=h?this.zrc:this.yhd;D&&v<D.length?b.setValue(Bc.a.gt,D[v]):b.setValue(Bc.a.gt,360);b.setValue(Bc.a.z3e,h?-1:-2);aw.a.mjc(1,b)}DUl(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}NUl(b){switch(b%3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}BMh(b){if(this.a9)this.X8<Ph.a.$Xc&&this.yq.I3(b),this.X8=this.mci(this.ku,this.X8,Ph.a.$Xc);
else{if(this.X8<Ph.a.$Xc&&(this.yq.I3(b),this.ku&&this.Cq)){b=this.ku.length;for(let h=0;h<b;h++)this.ku[h]>=this.X8&&(this.X8=this.ku[h])}this.X8+=1}return this.X8}sMh(b){this.OQa<Ph.a.Byd&&this.yq.I3(b);return this.OQa=this.mci(this.Eta,this.OQa,Ph.a.Byd)}CMh(b){var h;this.yq.I3(b);do b=Math.floor(Math.random()*(zp.Ybn-zp.dPi))+zp.dPi;while(null===(h=this.yq.kKb)||void 0===h?0:h.includes(b));return b}mci(b,h,v){if(h<v&&b){v=b.length;for(let D=0;D<v;D++)b[D]>h&&(h=b[D])}h++;return h}n4n(b,h){this.U1h(b,
h,1,this.Bje,this.ztj,null,!1)}m4n(b,h,v){this.eIl(b,h,v,this.Bje,this.ytj)}jJk(){this.k$()}k$(b=null){var h,v;if(Dp.a.instance.J(1)){var D=new he.GraphIterator;if(b)if(8===b.type)D.set(b);else{u.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else D.set(Xa.App.xa.ib.Uc),zp.Oh.mlg(D),b=zp.Oh.Ys(D.currentNode);if(D.zb(7)||D.jd(7)){D=Ka.a.Rs(D,D.origin);var P=new ez({Gd:this.yq,pageContentNode:b,QSa:null,$Ij:!1});for(b=new ez({Gd:this.yq,
pageContentNode:b,QSa:null,$Ij:!1});D.moveNext();){var ca=D.iterator;let Ra;if(!qn.a.getInstance().VC){if(!ca.Rr(4)&&!ca.Rr(31))continue;this.Gd.YJb(ca);Ra=ca.currentNode;ca.wc();if(!Ra){u.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",ca.isValid);continue}}const mb=Vg.ListItemReader.Dp?Vg.ListItemReader.Iba(ca)||Vg.ListItemReader.Nei(ca):Ra;if(!this.a9&&!Vg.ListItemReader.DFf(mb)&&this.Gd.BX(mb).listType)continue;var ta=void 0;if(Vg.ListItemReader.Dp){if(!mb){u.ULS.sendTraceTag(509141473,
393,50,"Skipping updating list numbers because paraNode not found");continue}ta=Vg.ListItemReader.E_(mb)}else ta=this.Gd.HO(Ra,!1,!1);if(this.a9&&ta&&this.Gd.BZd(ta.listId)){u.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",ta.listId);continue}const Jb=Vg.ListItemReader.Dp?mb:ig.OutlineElementReader.$T(ca);Jb&&(Jb.pa?(null==Jb.pa.last&&u.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),this.a9&&this.yq.I3(ca.currentNode),
12===Jb.type&&(Jb.Ii&&Jb.Ez.hasProperty(Bc.a.listID)||null===(h=Jb.pa.last)||void 0===h||!h.ej)&&((ca=Vg.ListItemReader.Dp?Vg.ListItemReader.PRd(mb)||Vg.ListItemReader.E_(mb):this.Gd.HO(Ra,!0,!0))?this.Amj(Ra,mb,b,Ym.Vn.boc,ca):u.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",Ra.type)),!ta||null!==(v=Jb.pa.last)&&void 0!==v&&v.ei||!this.Amj(Ra,mb,P,Ym.Vn.tV,ta)||(ta=Ra.getValue(Ym.Vn.tV),this.a9&&this.Gd.BX(mb).listType||Ra.setValue(Ym.Vn.Wda,ta))):
u.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else u.ULS.shipAssertTag(593234060,376,7===D.We,"Couldnt reach to page manifest node")}}Amj(b,h,v,D,P){D||u.ULS.shipAssertTag(571757918,393,!!D,"Prop definition is null");v=v.lRf(P.listId,P.listLevel,this.ld);P=-1;b.hasProperty(D)&&(P=b.getValue(D));return v===P||this.a9&&!Vg.ListItemReader.DFf(h)&&this.Gd.BX(h).listType&&(D!==Ym.Vn.boc||1!==this.Gd.BX(h).listType)?!1:(b.setValue(D,v),!0)}XMm(b,h){let v=
!1,D=!0,P=0;const ca=this.wB(b),ta=b.currentNode;b=b.qRb();b=Ka.a.Zo(b);for(b.mo(gz.a.dYc,null);b.moveNext();){var Ra=b.iterator.currentNode;if(Ra===ta)break;Vg.ListItemReader.yg(Ra)&&(Ra=this.wB(b.iterator),Ra.listID===ca.listID&&(Ra.level>ca.level?(v=!0,P++):Ra.level===ca.level?(D=!1,P=0):Ra.level<=h.MSa&&(D=!0,P=0)))}return v&&D&&!0}tCh(b,h){this.Gd.eP(b);const v=b.currentNode;b.wc();const D=this.wB(b);D&&this.yq.cYc(v,D.listID,D.level)&&this.m4n(b.currentNode,D,h)}qbi(b){const h=this.Gd.qw(b);
h.d7b=!0;this.Gd.eP(b);const v=b.currentNode.ia(Bc.a.listID,0);h.propertySet.setValue(Bc.a.listID,v);b.jd(11);return h}xIf(b,h,v){const D=new he.GraphIterator,P=h.currentNode;let ca;var ta=Ph.a.rl;let Ra=!1,mb=!1,Jb=!1,Ub=null;var cc=h.qRb();cc=Ka.a.Zo(cc);for(cc.mo(gz.a.dYc,null);cc.moveNext();){D.Zc(cc.iterator);if(D.currentNode===P)break;Ra=!1;D.Rr(4)&&(ca=this.wB(D),ca.listID===b.listID&&(ca.level===b.level?(this.Gd.eP(D),ta=D.currentNode,D.wc(),ta=ta.ia(Ym.Vn.tV,Ph.a.rl),Ra=!0,Ub=D.$mc(1),mb=
!0):ca.level>b.level?Jb=!0:ca.level<=v.MSa&&(ta=Ph.a.rl,Jb=mb=!1)))}!mb&&Jb&&(ta=v.startAt);Ra&&(Ra=h.$mc(1)===Ub);b=new my;b.ARa=ta;b.OKj=Ra;return b}i4n(b,h){var v=Vg.ListItemReader.Iba(b);if(zp.KRm)this.XXo(v,h);else{b=this.VEb(v);const ca=this.Nna(v,b),ta=this.yq.l1a(v,b);var D=new he.GraphIterator;const Ra=ta.zz;let mb=ca.startAt,Jb=!1,Ub=!1;u.ULS.shipAssertTag(22127639,338,ta.Yna,"Info does not have a level Text.");D.set(v);if(D.vd()&&(v=D.OSa()))for(v=Ka.a.Zo(v),v.mo(gz.a.dYc,b);v.moveNext();){D=
v.iterator.currentNode;if(!Vg.ListItemReader.yg(D))continue;var P=this.wB(v.iterator);P.listID===h&&(P=this.Imj(v.iterator,b.listID));if(P.listID!==b.listID)continue;const cc=v.iterator.Sb(4);cc&&v.iterator.wc();P.level>b.level?(this.yq.cYc(cc,b.listID,P.level)&&this.Vti(D,cc),Ub=!0):(P.level<=ca.MSa?(mb=ca.startAt,Ub=Jb=!1):(P=v.iterator,this.Gd.eP(P),Ym.Vn.Lv||P.currentNode.setValue(Bc.a.ov,ta.DJf),{Zco:Jb,ARa:mb}=this.l4n(Ra,Ub,Jb,P,mb,D)),zp.QEm(v))}}}XXo(b,h){const v=this.VEb(b),D=new he.GraphIterator;
D.set(b);if(D.vd()&&(b=D.OSa())){b=Ka.a.Zo(b);for(b.mo(gz.a.dYc,v);b.moveNext();)Vg.ListItemReader.yg(b.iterator.currentNode)&&this.wB(b.iterator).listID===h&&this.Imj(b.iterator,v.listID);u.ULS.sendTraceTag(509200585,393,50,"Single level List is inflated successfully.")}}Vti(b,h){u.ULS.shipAssertTag(22819227,338,!!b&&!!h);h.setValue(ue.a.JGi,W.a.create().toString())}l4n(b,h,v,D,P,ca){b?(h&&!v&&P++,hf.OutlineElementNavigator.Vd(D),this.tCh(D,P),P++,v=!0,D.Sb(2),fz.a.EEf(D.currentNode)&&D.currentNode.gl(4,
!0)):(D.currentNode.removeProperty(Ym.Vn.tV),hf.OutlineElementNavigator.Vd(D));ca.gl(4,!0);(b=D.Xn(16))&&b.gl(8,!0);return{Zco:v,ARa:P}}Nna(b,h){const v=bf.a.instance.yp(Gb.a.Nna),D=new Vz;(b=this.yq.Hx(b,h.listID,h.level))?(D.MSa=b.ia(Bc.a.H5c,h.level-1),D.startAt=b.ia(lf.a.k0,1)):bf.a.instance.Yb("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});v.end();return D}Gel(b){const h=Zo.a.instance.createInstance(1074135151);b.Af(h,31)}i1n(b){b.Sb(31)&&b.xg()}HNo(b,h,v,D,P){const ca=this.qhe(h,
b,!0);h=this.yq.l1a(h.currentNode,b);h.listType||(ca.setValue(Ym.Vn.tV,b.Ku),ca.setValue(Ym.Vn.Wda,b.tKc),this.Lcj(ca,b,v?D:P));switch(h.listType){case 0:v="Numbering";break;case 1:v="Bullet";break;default:v="Invalid List Type"}w.AFrameworkApplication.va.processAction(Gb.a.joinList,2);u.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",v);qn.a.getInstance().VC||this.XD.mhe(ca,b.listID,b.level)}uaj(b){var h=this.uc.No(b);h?this.uc.kg(h)===fk.StyleReader.wordStyleIdListParagraph&&(h=
this.uc.NC(b),this.y5.RJ(h.Di(fk.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.uPb)):u.ULS.shipAssertTag(8271188,315,!1)}xlo(b){if(this.uc.kg(this.uc.No(b))===fk.StyleReader.wordStyleIdNormal){const h=this.uc.NC(b);this.y5.RJ(h.Di(fk.StyleReader.wordStyleIdListParagraph),b,!0,!0,void 0,void 0,void 0,!0)}b.Eg(Bc.a.$d,Bc.a.UM,Bc.a.NA,Bc.a.D0,Bc.a.gt,Bc.a.kia);b.setValue(Bc.a.URa,0)}tVk(b,h){const v=b.getValue(Bc.a.listID),D=b.getValue(Bc.a.listLevel);for(let ca=0;9>ca;ca++){const ta=this.yq.Hx(b,v,
ca);if(!ta)return bf.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var P=h.hJb[ca];P=6===P?Iu.a.n_(1,1):Iu.a.n_(0,P);P.Gha&&ta.setValue(lf.a.C4,P.Gha);ta.hasProperty(lf.a.font)&&ta.removeProperty(lf.a.font);h.dEa&&h.dEa[ca]&&ta.setValue(lf.a.font,h.dEa[ca]);P=h.MXc[ca];u.ULS.shipAssertTag(22127641,338,!!P);ta.setValue(Bc.a.ov,P);ta.setValue(Bc.a.Wr,aw.a.nec);aw.a.aie(h.J5,ta);ta.setValue(Bc.a.yca,h.J0d[ca]);ta.Eg(Bc.a.H5c,lf.a.k0);this.VGj(b)}b=new dz.a;b.listID=v;
b.level=D;return b}rVk(b,h,v,D){if(D)return this.tVk(b,D);D=b.getValue(Bc.a.listID);const P=b.getValue(Bc.a.listLevel),ca=this.yq.Hx(b,D,P);if(!ca)return bf.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),h&&u.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",h.listStyle,h.listType,D,P),null;h.d7b&&(ca instanceof Ov.APropertySet?ca.MNa(h.propertySet,Bc.a.listID,Bc.a.listLevel):u.ULS.sendTraceTag(527991759,393,
15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===ca||void 0===ca?void 0:ca.constructor.name));var ta=ca.ia(Bc.a.Wr,null);ta&&ta===aw.a.nec&&this.qVk(b,D);if(!h.listStyle){ta=0;if(-1!==v){for(ta+=P-v;0>ta;)ta+=3;ta%=3}switch(ta){default:v=1;break;case 1:v=2;break;case 2:v=3}h.Q9(h.listType,v)}h.Gha&&ca.setValue(lf.a.C4,h.Gha);h.zz?(this.ymj(h,ca,P),ca.hasProperty(lf.a.font)&&ca.removeProperty(lf.a.font)):(zp.vmj(h,ca),zp.xmj(h,ca));zp.wmj(h,ca);ca.Eg(Bc.a.H5c,
lf.a.k0,Bc.a.AVc);this.VGj(b);b=new dz.a;b.listID=D;b.level=P;return b}qVk(b,h){let v;for(let D=0;9>D;D++){v=this.yq.Hx(b,h,D);if(!v){u.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",h,D);break}v.setValue(Bc.a.Wr,aw.a.VVd);v.removeProperty(Hh.a.glb)}}phe(b,h){const v=bf.a.instance.yp(Gb.a.phe);this.Cld.value||bf.a.instance.Yb("PossibleIncorrectListIndentation",{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.MLa?(v.properties.Z("PendingListInfo","true"),
Vg.ListItemReader.yg(b)&&(v.properties.Z("RemoveCurrentListInfo","true"),this.uPb=!0,this.fHa(b),this.Cld.value.eSa(b,-1,0),this.uPb=!1),16!==this.MLa.listType&&this.JEc(b,this.MLa,{Oqi:!0,OJl:!0}),this.MLa=null):h||(v.properties.Z("CurrentlyUnderPastedList","true"),this.fHa(b,{laj:!0}));v.end()}kie(b,h){var v;if(Vg.ListItemReader.yg(b))return!1;b.Sb(2);var D=Ep.a.KJk;const P=[!0,!1].map(ca=>fe.ParagraphReader.jg(b.currentNode,ca,void 0,!1));b.wc();for(let ca=0;ca<P.length;ca++){const ta=P[ca];if(ta&&
!ly.a.Aoa(ta))for(const Ra of D)if(Ra.test(ta.characterData))return D=null===(v=Ra.exec(ta.characterData))||void 0===v?void 0:v[0],this.pTn(h,ca?"nextPara":"prevPara",D),!1}return!0}pTn(b,h,v){const D=new Map;D.set("CurrentAutoListPreventedAutoListText",b);D.set("UndoAutoListPreferenceFoundIn",h);D.set("UndoAutoListPreferenceAutoListText",v);va.Health.instance.recordKpiUsage(Ph.a.Fkb.LZn,0,Ph.a.tB,D)}yvo(b,h){return b&&h}vaj(b){for(let h=0;h<b.count;h++){const v=he.GraphIterator.$a(b.J(h));v.Bp();
this.Zca(v)}b.clear()}k4n(b){Vg.ListItemReader.yg(b)&&this.k$()}I7i(b,h){b=new he.GraphIterator;b.set(h);b.vd();hf.OutlineElementNavigator.Vd(b);b.Aib(h)||bf.a.instance.Yb("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.fHa(b);return b}clo(b,h,v){this.nh.Fya(b,h,v,!0)}klo(b){b.Q9(1,1)}$Ad(b,h){const v=bf.a.instance.yp(Gb.a.HFk);if(this.uc.iY(h.xl())){if(Vg.ListItemReader.yg(b)&&this.fHa(b),h=this.yq.wbi(h)){v.properties.Z("EarlyReturn","False");this.yq.l1a(b.currentNode,
h);var D=dq.SDl(this,b,h);if(D)D=this.zmj(b,D,!0);else{D=this.iMh(b);var P=this.oNd(b,h,this.Vwj,this.DFo);if(P){const ca=this.wB(P);if(ca.listID===h.listID&&ca.level<h.level&&this.Gd.qw(P).zz){const ta=this.Nna(P.currentNode,ca);ca.Ku===(ta.startAt===Ph.a.rl?1:ta.startAt)&&(ca.tKc=ca.Ku,this.Lcj(D,ca,P.currentNode))}}P=this.Nna(D,h);b=this.xIf(h,b,P);b=b.ARa!==Ph.a.rl?b.ARa+1:P.startAt===Ph.a.rl?1:P.startAt;qn.a.getInstance().VC||this.KEc(D,h,null,!0);D.setValue(Ym.Vn.tV,b);D.setValue(Ym.Vn.Wda,
b)}qn.a.getInstance().VC||D.setValue(Bc.a.i0,!0);v.end()}}else bf.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"StyleContainerNotValid"})}Lcj(b,h,v){this.yq.cYc(b,h.listID,h.level)&&this.n4n(v,h)}TFk(b,h,v){if(!Vg.ListItemReader.yg(h)&&(u.ULS.sendTraceTag(508952674,393,15,"Iterator sent is not pointing to a List OE: applyNewListDefinition"),Vg.ListItemReader.Dp))return;const D=h.Sb(4);h.wc();(h=ig.OutlineElementReader.$T(h))||Kc.b(509386772,393,15,"Encountered a list node but paragraph node is not present");
b=this.AMh(b,v,0,null);this.KEc(D,b,h);return b}AMh(b,h,v,D=null){b=D?this.Bcl(b,h,v,D):this.zcl(b,h,v);Ym.Vn.Lv||(h.Yna?(h=h.levelText,D||(h=h.replace("%1","%"+(b.level+1))),b.levelText=h):(u.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),b.levelText=""));return b}Vmg(b,h,v,D=null){if(Vg.ListItemReader.yg(b)){var P=b.Sb(4);b.wc();var ca=ig.OutlineElementReader.$T(b);this.n5b(ca,()=>{this.KEc(P,h.zw,ca,v);this.rTh(P,h,v,D)})}else u.ULS.sendTraceTag(587747659,
393,15,"List node received is null : skipping join list action.")}zmj(b,h,v,D=null){const P=ig.OutlineElementReader.$T(b);return this.n5b(P,()=>{const ca=this.qhe(b,h.zw,v);this.rTh(ca,h,v,D);return ca})}rTh(b,h,v,D=null){if(this.yq.l1a(b,h.zw).zz){const P=new he.GraphIterator;P.set(b);P.vd();P.wc();const ca=this.kGl(P,h,D);b=this.bGl(P,b,h,v,D,ca);this.hGl(h,v,D,ca,b)}}kGl(b,h,v){if(h.Vyi)h=h.outlineElement;else{let D,P;v?(D=this.Wwj,P=this.Cke):h.Y$b?(D=this.Vwj,P=this.Cke):(D=this.CFo,P=this.EFo);
h=this.oNd(b,h.zw,D,P,v)}!h&&v&&(v=new he.GraphIterator,v.Zc(b),v.rQc()&&Vg.ListItemReader.yg(v)&&(h=v));return h}bGl(b,h,v,D,P,ca){D?(P?b=P.Ckc:(ca=this.Nna(h,v.zw),v=this.xIf(v.zw,b,ca),b=v.ARa!==Ph.a.rl?v.ARa+1:ca.startAt===Ph.a.rl?1:ca.startAt),h.setValue(Ym.Vn.tV,b),h.setValue(Ym.Vn.Wda,b)):(b=Ph.a.rl,this.cmo(h,ca,v));return b}hGl(b,h,v,D,P){if(D){var ca=!1,ta=this.wB(D),Ra=ta.level===b.zw.level,mb=!!v&&ta.listID===v.K0c;(ta.listID===b.zw.listID||mb)&&Ra&&(Ra=this.Nna(D.currentNode,ta),mb=Ra.startAt===
Ph.a.rl?1:Ra.startAt,ta.Ku===mb+1&&(ca=h?P===mb:this.XMm(D,Ra)));if(!ca||v)v?(h=v.delta,P=this.Bzo,ca=this.Czo):(h=1,P=this.Bje,ca=this.ztj),ta=new he.GraphIterator,ta.set(D.currentNode),ta.vd(),this.Gd.eP(ta),ta.wc(),this.U1h(D.currentNode,b.zw,h,P,ca,v)}}cmo(b,h,v){let D=null;h&&(D=this.wB(h));if(D&&D.listID===v.zw.listID&&D.level===v.zw.level){const P=this.Gd.qw(h),ca=P.Ku;b.setValue(Ym.Vn.tV,ca);b.setValue(Ym.Vn.Wda,ca);P.propertySet.setValue(Bc.a.listID,D.listID);P.propertySet.setValue(Bc.a.listLevel,
D.level);if(!v.Y$b||v.T5d)v.Vyi&&!v.T5d&&(this.Gd.eP(h),b=h.currentNode,hf.OutlineElementNavigator.Vd(h)),b.setValue(Ym.Vn.Wda,b.getValue(Ym.Vn.tV))}else h=v.zw.Ku+1,b.setValue(Ym.Vn.tV,h),b.setValue(Ym.Vn.Wda,h)}JEc(b,h,{Oqi:v=!1,n_m:D=-1,nIl:P=!1,OJl:ca=!1}={}){return h&&16!==h.listType?he.GraphIterator.vba(()=>{if(!ig.OutlineElementReader.Nh(b))return u.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),ss.zec();const ta=ig.OutlineElementReader.$T(b);return ta&&
Yo.a(ta,8)?(u.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),ss.zec()):Dp.a.instance.J(1)&&(null===ta||void 0===ta?0:ta.pa.last.ei)?(u.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),ss.zec()):this.n5b(ta,()=>{var Ra=zp.Oh.Ys(b.currentNode);const mb=h.NB,Jb=this.infoAtLevel(b,h);var Ub=b.Sb(4);if(Ub)return b.wc(),Ra=this.iuh(Jb,Ub,D,mb),Ra.zw=this.wB(b),Ra;this.i1n(b);Ub=h.propertySet.ia(Bc.a.listID,-1);const cc=this.p2l(Ub,
ca),Ac=this.i0l(ta),Lc=this.g1l(h,b,Jb,ca,P,v);this.Kjo(Lc,Jb);ta&&this.xlo(ta);return null==Lc||P||Jb.zz!==this.Gd.l1a(b.currentNode,Lc.zw).zz?this.dsl(Jb,cc,Lc,b.currentNode)?this.JFk(b,Jb,cc,Ac,mb):this.IFk(b,Jb,Ra,Ac,mb,cc,Ub):(Jb.listStyle||(Lc.Y$b=!0),this.KFk(cc,Lc,b))})}):(h||u.ULS.sendTraceTag(509650391,393,15,"applyListInfo was called with info = "+h),this.fHa(b))}JFk(b,h,v,D,P){v=this.S2l(h,v,D);b=this.qhe(b,v);return this.iuh(h,b,-1,P)}g1l(b,h,v,D,P,ca){var ta;P=b.Ylb?new dq(this,he.GraphIterator.$a(b.Ylb),
!1,!0):dq.RDl(this,h,v,D,P);if(!P)return null;ca?(P.zw.level=this.u0l(h,v,D),this.OFl(h,P)):P.zw&&(null===(ta=b.propertySet)||void 0===ta?0:ta.hasProperty(Bc.a.listLevel))&&(P.zw.level=b.propertySet.getValue(Bc.a.listLevel));return P}p2l(b,h){return h&&0<b&&b+""in this.JYf?this.JYf[b+""]:-1}S2l(b,h,v){var D,P;const ca=new dz.a;ca.listID=h;ca.level=null!==(P=null===(D=b.propertySet)||void 0===D?void 0:D.Gf(Bc.a.listLevel))&&void 0!==P?P:this.KXc(v);b.propertySet&&b.Yna&&!Ym.Vn.Lv&&(ca.levelText=b.levelText.replace("%1",
"%"+(ca.level+1)));return ca}iuh(b,h,v,D){b=this.rVk(h,b,v,D);return ss.K_m(b)}KFk(b,h,v){let D=null;0<b&&(D=new $A(0,h.zw,-1),D.K0c=b,D.delta=-1);this.zmj(v,h,!1,D);return ss.a0m(h.zw)}IFk(b,h,v,D,P,ca,ta){const Ra=ig.OutlineElementReader.U3(b);0<Ra&&(D+=Ra);v=this.AMh(v,h,D,P);this.WXo(ca,ta,v);b=this.qhe(b,v);Ym.Vn.VC||h.listType||(h=h.VB,h===Ph.a.rl&&(h=1),b.setValue(Ym.Vn.tV,h),b.setValue(Ym.Vn.Wda,h));return ss.N_m(v)}fHa(b,{laj:h=!1}={}){return he.GraphIterator.vba(()=>{if(!ig.OutlineElementReader.Nh(b))return u.ULS.sendTraceTag(509678220,
393,15,"Iterator not pointing to OE in remove list info word."),ss.zec();const v=ig.OutlineElementReader.$T(b);if(Dp.a.instance.J(1)&&(null===v||void 0===v?0:v.pa.last.ei))return u.ULS.sendTraceTag(509678219,393,15,"User tried to remove list from para with deleted EOP."),ss.zec();const D=b.Sb(4);return D?v?this.n5b(v,()=>{var P;this.uaj(v);this.s0n(v);v.VI=null;this.Gd.BZd(Vg.ListItemReader.Dp?Vg.ListItemReader.E_(v,{gCb:0}).listId:D.ia(Bc.a.listID,0))?(D.z8c=!1,b.xg(),qn.a.getInstance().Lv&&this.XD.Zca(v)):
b.wc();h||this.Aio(b);b.Sb(4)&&(D.z8c=!1,b.xg(),qn.a.getInstance().Lv&&this.XD.Zca(v));(this.Sd.rg&&!this.uPb||!this.Sd.rg&&v.Ii)&&(!v.Ii||(null===(P=v.Ez)||void 0===P?0:P.hasProperty(Bc.a.listID)))&&this.Gel(b);return ss.PGi()}):(u.ULS.sendTraceTag(509211404,393,15,"OutlineElement has listNode but no paraNode during removeListInfo"),D.z8c=!1,b.xg(),ss.PGi()):ss.zec()})}Aio(b){const h=zp.Oh.Ys(b.currentNode),v=ig.OutlineElementReader.tEa(b),D=ig.OutlineElementReader.xG(b),P=ig.OutlineElementReader.U3(b);
this.CKd(h);this.nh.Fya(b,1,Math.max(0,v+(P||-1*D)-this.zrc[0]))}n5b(b,h){let v=null;Dp.a.instance.J(1)&&b&&(v=b.ND());h=h();Dp.a.instance.J(1)&&!this.uPb&&(b&&v&&this.tq.aV(b,v,this.Sd.rg),this.k$());return h}s0n(b){b.hasProperty(Bc.a.$d)&&b.removeProperty(Bc.a.$d);b.hasProperty(Bc.a.NA)&&b.removeProperty(Bc.a.NA);b.hasProperty(Bc.a.gt)&&b.removeProperty(Bc.a.gt)}infoAtLevel(b,h){if(!h)return null;const v=h.NB;if(1===h.Wr){if(h.Poa&&!h.BJ||!h.w7e(!1))return h;b=ig.OutlineElementReader.tEa(b);const D=
this.KXc(b),P=v.hJb[D];b=Iu.a.Q7(h.propertySet,h.propertySet);6===P?b.Q9(1,1):b.Q9(0,P);b.rhe("multilevel");b.levelText=v.MXc[D];v.dEa&&v.dEa[D]&&(b.font=v.dEa[D]);b.vw=v.J0d[D];b.J5=v.J5;b.z1d=h.z1d}else b=h;return b}Kjo(b,h){null!==b&&void 0!==b&&b.zw&&(h.levelText=b.zw.levelText,h.zz||(h.font=b.zw.font))}u0l(b,h,v){let D=ig.OutlineElementReader.tEa(b);const P=ig.OutlineElementReader.U3(b);0<P?D+=P:(b=ig.OutlineElementReader.xG(b),0<b&&(D-=b));h=h.propertySet.ia(Bc.a.listLevel,-1);return v&&0<=
h?h:this.KXc(D)}OFl(b,h){if(!this.yq.l1a(b.currentNode,h.zw).listType){const v=this.Nna(b.currentNode,h.zw);b=this.xIf(h.zw,b,v);h.zw.tKc=h.zw.Ku=b.ARa===Ph.a.rl?v.startAt-1:b.ARa;h.Y$b=b.OKj}}WXo(b,h,v){0>=b?this.JYf[h+""]=v.listID:v.listID=b}dsl(b,h,v,D){if(0>=h)return!1;const P=(ca,ta)=>ca.length!==ta.length||ca.some((Ra,mb)=>Ra!==ta[mb]);if(v)return h=this.Gd.l1a(D,v.zw),b.zz!==h.zz||P(b.Gha,h.Gha);v=b.propertySet.ia(Bc.a.listLevel,-1);return 0<=v&&(h=this.yq.Hx(D,h,v))&&(h=h.ia(lf.a.C4,null))&&
b.Gha?P(h,b.Gha):!1}r0n(b,h){var v,D;const P=!!h&&fe.ParagraphReader.Wb(h);let ca=0,ta=0;P&&(ca=this.Xo.XT(Vg.ListItemReader.Dp?h:this.Gd.Prf(b)).Ot,ta=this.Xo.xG(h).Ot);P&&this.uaj(h);null!==(v=qn.a.getInstance())&&void 0!==v&&v.VC||(b.Sb(4),b.xg());(null===(D=qn.a.getInstance())||void 0===D?0:D.Lv)&&this.XD.Zca(h);P&&this.nh.Fya(b,1,ca-ta)}hba(b,h,v,D=-1,P=!1,ca=null,ta=!1){u.ULS.sendTraceTag(17622211,324,50,"'Continue Existing List' is selected from Context Menu.");const Ra=bf.a.instance.yp(Gb.a.hba),
mb=this.Ic.Oc(15);mb.Lt(b);let Jb=null,Ub=0;({bXm:Jb,Ojn:Ub,returnValue:D}=this.rEl(b,h,D,Jb,Ub,P,ca));if(!Jb||ta&&(1===v||0>v-Jb.zw.Ku||2<v-Jb.zw.Ku))return mb.dispose(),Ra.end(),!1;for(;0<Ub;)b.rQc(),Ub--;this.SXo(b,h,D,Jb);mb.dispose();Ra.end();return!0}SXo(b,h,v,D){for(;b.rQc();){var P=Vg.ListItemReader.Iba(b);if(P&&(P=this.VEb(P),P.listID===h.listID)){h=new $A(0,h,v);qn.a.getInstance().Lv?this.Vmg(b,D,P.i0,h):this.Vmg(b,D,!0,h);break}}}rEl(b,h,v,D,P,ca=!1,ta=null){for(var Ra;b.zTd();){if(b.Rr(4)){const mb=
this.wB(b),Jb=this.Gd.qw(b);if(Jb.listType!==ta.listType){P++;continue}if(ca&&Jb.listStyle!==ta.listStyle||!ca&&h.level<mb.level){P++;continue}-1===v&&(v=mb.Ku+1);D=null;if(h.level===mb.level||ca)null===(Ra=this.b9c)||void 0===Ra?void 0:Ra.Jzf(b),D=new dq(this,b,!1,!1);ca&&mb.level!==h.level&&b.Rr(4)&&(b.Sb(4).setValue(Bc.a.listLevel,mb.level),b.wc());break}P++}return{returnValue:v,bXm:D,Ojn:P}}R2l(b){b=Vg.ListItemReader.Iba(b);return this.OQd(b)}OQd(b){let h;Dp.a.instance.J(1)&&(h=Vg.ListItemReader.Dp?
Vg.ListItemReader.E_(b)||Vg.ListItemReader.PRd(b):this.Gd.HO(b,!1,!0));return this.Gd.Hx(b,h.listId,h.listLevel)}startNewList(b,h,v){u.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(h){var D=bf.a.instance.yp(Gb.a.startNewList),P=this.Ic.Oc(15);P.Lt(b);var ca=Iu.a.n_(0,h.listStyle,null,0,h.propertySet.ia(Bc.a.listLevel,-1));if(Vg.ListItemReader.Dp)({listId:ta,listLevel:Ra}=Vg.ListItemReader.IQd(b,{gCb:0,hId:-1}));else{b.Sb(4);var ta=b.currentNode.ia(Bc.a.listID,
0);var Ra=b.currentNode.ia(Bc.a.listLevel,-1);b.wc()}ca.z1d=ta;var mb=h.propertySet.ia(Bc.a.$d,0);0<mb&&ca.propertySet.setValue(Bc.a.$d,mb);-1===ca.propertySet.ia(Bc.a.listLevel,-1)&&ca.propertySet.setValue(Bc.a.listLevel,Ra);1===h.Wr&&((Ra=new Zy.a,ta=h.rji(b.currentNode,ta),ta)?1===ta&&(ca.rhe(aw.a.nec),ca.NB=Ra.wbf(Ra.eSf,Ra.fSf),ca.J5=ca.NB.J5):(ca.rhe(aw.a.nec),ca.NB=Ra.Daf(),ca.J5=ca.NB.J5));h.Hna()&&1>v&&(v=1);ca.VB=v;ta=new Md.DictionaryPropertySet;ta=this.oLc(Gb.a.wL,ta);Ra=ig.OutlineElementReader.$T(b);
h=this.wB(b);if(mb=this.R2l(b))ca.levelText=mb.ia(Bc.a.ov,""),ca.BJ=42,ca.vw=mb.ia(Bc.a.yca,"left");this.r0n(b,Ra);({qwa:ca}=this.Vla(ta,b,ca,!0));b.Sb(4);22!==b.currentNode.type&&63!==b.currentNode.type&&u.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);qn.a.getInstance().VC||this.XD.ZQb(b.currentNode,h.level);qn.a.getInstance().Lv&&this.XD.ZQb(Ra,h.level);b.wc();ca=new dq(this,b,!1,!1);v=new $A(1,h,v);this.Vmg(b,ca,!!qn.a.getInstance().Lv,v);P.dispose();
D.end()}else u.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}nFf(b){if(!b)return!1;const h=b.Sb(2);h&&b.wc();return Dp.a.instance.J(1)&&h&&12===h.type&&h.pa&&h.pa.last&&h.pa.last.ei?!0:!1}x$d(b,h,v,D){return this.Eak.x$d(b,h,v,D)}i9f(b,h){if(!b||!h)return!1;const v=b.propertySet.ia(Bc.a.ov,null);h=h.propertySet.ia(Bc.a.ov,null);if(!v||!h)return!1;const D=b.propertySet.ia(lf.a.font,null);b=b.propertySet.ia(lf.a.font,null);return v===h&&D===b}knj(b,h,v){v||h.listType||
(h.VB=b.ia(lf.a.k0,Ph.a.rl))}obi(b,h){if(!h)return null;const v=Array(9),D=h.z1d;if(!this.qOm(h,b)||1>D)return null;for(h=0;9>h;h++){const P=this.Gd.Hx(b,D,h);if(null===P||void 0===P?0:P.hasProperty(Bc.a.$d))v[h]=P.getValue(Bc.a.$d);else return null}return v}qOm(b,h){if(!b)return!1;const v=b.propertySet.ia(Bc.a.listLevel,-1);b=b.propertySet.ia(Bc.a.$d,-1);if(0>v||0>b)return!1;this.CKd(h);return b!==this.jUb[v]}Uoh(b,h,v){b&&b.setValue(Bc.a.$d,h?h[v]:this.jUb&&v<this.jUb.length?this.jUb[v]:720*(v+
1))}U1h(b,h,v,D,P,ca=null,ta=!1){const Ra=new he.GraphIterator,mb=this.Nna(b,h);Ra.set(b);Ra.vd();b=sq.a.Rs(Ra,Ra.qRb());b.mo(gz.a.dYc,null);let Jb=-1;for(;b.moveNext();){if(!Vg.ListItemReader.yg(Ra))continue;const Ub=this.wB(Ra),cc=ig.OutlineElementReader.$T(Ra);this.Gd.eP(Ra);const Ac=Ra.currentNode;Ra.wc();if(D!==this.Bje||Ub.listID===h.listID){if(ta){if(-1!==Jb&&Jb>Ub.level)break;if(-1===Jb)Jb=Ub.level;else if(Ub.level!==Jb)continue}else{if(Ub.level<=mb.MSa)break;if(!D(h,Ub,ca))continue}P(Ac,
cc,v,h.listID,ca)}}}eIl(b,h,v,D,P){const ca=new he.GraphIterator,ta=this.Nna(b,h);ca.set(b);ca.vd();if(Vg.ListItemReader.yg(ca)){b=this.wB(ca);var Ra=ig.OutlineElementReader.$T(ca);this.Gd.eP(ca);var mb=ca.currentNode;ca.wc();b.level<=ta.MSa||D(h,b,null)&&P(mb,Ra,v,h.listID,null)}}dIl(b,h,v,D,P=null){const ca=new he.GraphIterator;ca.Zc(b);D(b,h,this.wB(ca),ca,0);this.oNd(b,h,v,D,P)}oNd(b,h,v,D,P=null){let ca=new he.GraphIterator;const ta=this.Nna(b.currentNode,h);let Ra=null,mb=0;var Jb=new he.GraphIterator;
Jb.Zc(b);Jb.zb(10);const Ub=Ka.a.Rs(Jb,Jb.origin);for(Ub.moveNext();Ub.moveNext();)if(Ra=null,ca=Ub.iterator,1===ca.role&&(Ra=Ub.currentNode,ca.Rr(4)&&(Jb=this.wB(ca),v(h,Jb,P))))if(Jb.level>h.level)D(b,h,Jb,ca,mb),mb++;else if(Jb.level===h.level||Jb.level<=ta.MSa)break;return Ra?ca:null}m7i(b,h,v,D,P){b=this.Nna(b.currentNode,v);b.MSa>=h.level&&this.tCh(D,b.startAt+P)}static get KRm(){null==zp.Osd&&(w.AFrameworkApplication.K?(w.AFrameworkApplication.ue("i75ig452;a229j208"),zp.Osd=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveRedundantRenumberingForListActions",
!1)):zp.Osd=!1);return zp.Osd}static get Oh(){return Wk.PageNavigator.instance}static vmj(b,h){h.setValue(lf.a.font,b.Poa||b.DTc||b.XQc?b.font:"Symbol")}static xmj(b,h){b=b.Poa||b.DTc||b.Yna?b.levelText:Ph.a.fId;u.ULS.shipAssertTag(22127637,338,!!b);h.setValue(Bc.a.ov,b)}static wmj(b,h){b=b.propertySet.ia(Bc.a.yca,"left");h.setValue(Bc.a.yca,b)}static QEm(b){b=b.iterator.parentNode;const h=he.GraphIterator.$a(b);b&&ig.OutlineElementReader.iFf(h,null)&&b.gl(8,!0)}}zp.Ybn=2147450879;zp.dPi=1;zp.Osd=
null;Object(n.a)(zp,"FlatListEditorCssVersion",Ym,[724,725]);class hz{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac){this.yq=b;this.Zyn=h;this.eg=v;this.Us=D;this.OA=P;this.G_m=ca;this.Ld=ta;this.nj=Ra;this.T_m=mb;this.Xb=Jb;this.uc=Ub;this.lE=cc;this.XD=Ac}create(){return new zp(this.yq,this.Zyn,this.eg,this.Us,this.OA,this.G_m,this.Ld,this.nj,this.T_m,this.Xb,this.uc,this.lE,this.XD)}}Object(n.a)(hz,"FlatListEditorFactory",null,[]);class iz{constructor(){this.startAt=this.listLevel=this.listId=
0;this.Ylb=null}}Object(n.a)(iz,"ListAutoCorrectionRefInfo",null,[]);class Rt{constructor(b,h){this.dak=b;this.Hf=h}x$d(b,h,v,D){if(!b.hasProperty(Wc.a.R3a))return!0;h=he.GraphIterator.$a(h.currentNode);$e.SelectionEditor.ru(h);let P=!0;if(!v.listType&&!D){23===h.We&&h.oJ(1);D=b.ia(Wc.a.R3a,1);if(1<D){var ca=new he.GraphIterator;ca.Zc(h);ca.zb(10);ca=Ka.a.Zo(ca.origin);D=this.qEl(ca,D,v,h.currentNode);v.Ylb||(P=!1)}b.setValue(Wc.a.R3a,D)}return P}qEl(b,h,v,D){const P=new Fb.a;for(;b.moveNext()&&b.iterator.currentNode!==
D;){const ca=b.iterator;if(!ca.Rr(4))continue;const ta=this.dak.value.wB(ca),Ra=this.Hf.qw(ca);this.WLn(P,ta);Ra.listType===v.listType&&Ra.listStyle===v.listStyle&&(0>h-ta.Ku||2<h-ta.Ku||P.add(Object.assign(new iz,{listId:ta.listID,listLevel:ta.level,Ylb:ca.currentNode,startAt:ta.Ku+1})))}0<P.count&&(h=P.J(P.count-1).startAt,v.Ylb=P.J(P.count-1).Ylb);return h}WLn(b,h){let v=0;for(;v<b.count;){const D=b.J(v);D.listId===h.listID&&D.listLevel>=h.level?b.removeAt(v):v++}}}Object(n.a)(Rt,"ListAutoCorrector",
null,[694]);class bs{constructor(b,h,v,D,P){this.g7a=(ca,ta,Ra)=>{var mb;ca=this.FIc(ta);if(!ca||Vg.ListItemReader.Dp&&!Vg.ListItemReader.yg(ca)||this.Ss.nFf(ca))return 8;ta=this.Ss.wB(ca);if(1===ta.Ku||this.QUc(ta.level))return 8;ta=null===(mb=this.Gd)||void 0===mb?void 0:mb.qw(ca);if(!ta||this.izi(ta))return 8;if(1===Ra)return 32;this.Ss.startNewList(ca,ta,1);return 32};this.f7a=(ca,ta,Ra)=>{ca=this.FIc(ta);if(!ca||Vg.ListItemReader.Dp&&!Vg.ListItemReader.yg(ca)||this.Ss.nFf(ca))return 8;ta=this.Ss.wB(ca);
if(this.QUc(ta.level))return 8;const mb=this.Gd.qw(ca);if(!mb||this.izi(mb))return 8;if(1===Ra)return 32;this.MJc.d5l(ca.currentNode,ta.Ku,this.Gd,this.Ss,this.XTa);return 32};this.hba=(ca,ta,Ra)=>{ca=this.FIc(ta);if(!ca||Vg.ListItemReader.Dp&&!Vg.ListItemReader.yg(ca)||this.Ss.nFf(ca))return 8;ta=this.Ss.wB(ca);if(1!==ta.Ku||this.QUc(ta.level))return 8;if(1===Ra)return 32;Ra=this.Gd.qw(ca);return this.Ss.hba(ca,ta,Ra.VB,-1,!1,Ra)?32:8};this.opb=(ca,ta,Ra,mb,Jb)=>{ca=this.FIc(ta);if(!ca||Vg.ListItemReader.Dp&&
!Vg.ListItemReader.yg(ca))return 8;ta=this.Ss.wB(ca);if(this.QUc(ta.level))return 8;if(1===Ra)return 32;Ra=this.Gd.qw(ca);this.Ss.startNewList(ca,Ra,Jb);return 32};this.lfb=(ca,ta,Ra,mb,Jb)=>{ca=this.FIc(ta);if(!ca||Vg.ListItemReader.Dp&&!Vg.ListItemReader.yg(ca))return 8;ta=this.Ss.wB(ca);return this.QUc(ta.level)?8:1===Ra?32:this.Ss.hba(ca,ta,ta.Ku,Jb)?32:8};this.pc=b;this.Gd=v;this.Ss=D;this.MJc=P}QUc(b){return 0>b}Tb(){this.pc.qa(Gb.a.g7a,sc.a.outlineElement,this.g7a);this.pc.qa(Gb.a.g7a,sc.a.Tc,
this.g7a);this.pc.qa(Gb.a.g7a,sc.a.view,this.g7a);this.pc.Vc(Gb.a.g7a,12);this.pc.qa(Gb.a.f7a,sc.a.outlineElement,this.f7a);this.pc.qa(Gb.a.f7a,sc.a.Tc,this.f7a);this.pc.qa(Gb.a.f7a,sc.a.view,this.f7a);this.pc.Vc(Gb.a.f7a,12);this.pc.qa(Gb.a.hba,sc.a.outlineElement,this.hba);this.pc.qa(Gb.a.hba,sc.a.Tc,this.hba);this.pc.qa(Gb.a.hba,sc.a.view,this.hba);this.pc.Vc(Gb.a.hba,12);this.pc.qa(Gb.a.opb,sc.a.outlineElement,this.opb);this.pc.qa(Gb.a.opb,sc.a.Tc,this.opb);this.pc.qa(Gb.a.opb,sc.a.view,this.opb);
this.pc.Vc(Gb.a.opb,12);this.pc.qa(Gb.a.lfb,sc.a.outlineElement,this.lfb);this.pc.qa(Gb.a.lfb,sc.a.Tc,this.lfb);this.pc.qa(Gb.a.lfb,sc.a.view,this.lfb);this.pc.Vc(Gb.a.lfb,12)}get XTa(){return Ea.a.instance.resolve("Common.IStandaloneRootController").sda}FIc(b){return this.Ss.w2l(b)}izi(b){return 1===(null===b||void 0===b?void 0:b.listType)}}Object(n.a)(bs,"ListContextMenuSectionActor",null,[]);var Ok=c(588);class jz{static get R_m(){return bg.a.vA(jz.Km,Box4Intl.Box4Strings.l_StartNewListDialog,
Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}jz.Km="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(n.a)(jz,"ListSetStartValueDialogHtml",null,[]);class bw extends bg.a{constructor(b,h,v,D,P){super();this.gqd=this.Uwe=this.yqd=this.yTe=null;this.Pye=!0;this.rS=!1;this.tbb=0;this.Juj=[Gb.a.obg,Gb.a.Xfg,Gb.a.Y1f];this.yoo=(ca,ta)=>{ca=ta[mj.a.Number];this.E$=Number.isInteger(ta[mj.a.Number])&&ca>=this.tbb?ca:this.tbb};this.Rdm=(ca,ta)=>{this.E$=this.E$>=this.tbb?this.E$:this.tbb;ta[mj.a.Number]=this.E$;ta[mj.a.UnitType]=0};this.Alo=(ca,ta)=>{if(1===ca){var Ra=ta.ListRadioStartNew,mb=ta.ListRadioContinue,
Jb=he.GraphIterator.$a(this.Fe);Jb.vd();ta=this.Ss.wB(Jb);ca=this.Hf.qw(Jb);if(Ra)this.Ss.startNewList(Jb,ca,this.E$);else if(mb)if(this.Pye)this.Ss.hba(Jb,ta,this.PMe,-1,!1,ca);else{Ra=!0;for(mb=null;Jb.pJ();)if(Jb.Rr(4)){mb=new dq(this.Ss,Jb,!1,!1);break}if(!mb||this.Ss.wB(Jb).Ku>=this.E$)Ra=!1;Ra?(Jb=he.GraphIterator.$a(this.Fe),Jb.vd(),this.Ss.hba(Jb,ta,this.PMe,this.E$,!1,ca)):(this.dispose(),this.BHa(CommonUIStrings.l_ErrorDialogMessage,this.Q_m))}}};this.Q_m=()=>{new bw(this.Fe,this.PMe,this.Hf,
this.Ss,this.Ed)};this.vvn=()=>{document.getElementById(bw.QGi).style.visibility="visible"};this.Mnn=()=>{document.getElementById(bw.QGi).style.visibility="hidden"};this.wg="ListSetStartValueDialog";this.Yg=jz.R_m;this.Fe=b;this.E$=h;this.Hf=v;this.PMe=h;this.t6=D;h=new he.GraphIterator;b?(h.set(b),h.vd(),ig.OutlineElementReader.Nh(h)||hf.OutlineElementNavigator.Vd(h),Vg.ListItemReader.yg(h)&&(h.Sb(4),b=h.currentNode,22===b.type&&(this.Hf.BX(b).Hna()?this.tbb=1:this.tbb=0))):this.tbb=1;this.Ed=P;
this.Wh(Box4Intl.Box4Strings.l_SetNumberingValueList,this.Alo,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.Pye&&(this.yTe=document.getElementById("ListRadioStartNew"),this.yqd=this.vvn,this.Uwe=document.getElementById("ListRadioContinue"),this.gqd=this.Mnn,Le.a.addHandler(this.yTe,"click",this.yqd),Le.a.addHandler(this.Uwe,"click",this.gqd));for(const ca of this.Juj)Object(Ok.a)(ca,this.yoo,this.Rdm);this.Ed.xm()}get Ss(){return this.t6}dispose(){if(!this.rS){for(const b of this.Juj)Object(Ok.b)(b);
this.Pye&&(this.yqd&&Le.a.removeHandler(this.yTe,"click",this.yqd),this.gqd&&Le.a.removeHandler(this.Uwe,"click",this.gqd));this.Ed.BY("ListStartSpinner");super.dispose();this.rS=!0}}FOk(){const b=Ii.l("none",this.tbb+"","100","1");return Ii.j(bw.RGi,Gb.a.obg,Gb.a.Y1f,Box4Intl.Box4Strings.l_SetValueTo,[b],null,Gb.a.Xfg)}Ozb(b){const h=document.getElementById(bw.RGi);this.Ed.YYa("ListStartSpinner",b);b=this.Ed.rEb("ListStartSpinner","Medium");h.appendChild(b)}k9(){const b=this.FOk();this.Ozb(b)}}bw.RGi=
"SetListStartSpinnerContainer";bw.QGi="ListStartAtSpinnerBox";Object(n.a)(bw,"ListSetStartValueDialog",bg.a,[]);class Hw{d5l(b,h,v,D,P){new bw(b,h,v,D,P)}static get instance(){return Hw._instance||(Hw._instance=new Hw)}}Hw._instance=null;Object(n.a)(Hw,"ListDialogFactory",null,[685]);class aB{constructor(b,h,v){this.t6=b;this.Hf=h;this.Ic=v}Jzf(b){u.ULS.shipAssertTag(40420184,393,ig.OutlineElementReader.Nh(b));if(Vg.ListItemReader.yg(b)){const h=this.Hf.qw(b);h.Wr||this.Nxm(b,h)}}CXk(b){for(let h=
0;h<b.length;h++){const v=new he.GraphIterator;v.set(b.getContext(h).node);this.Jzf(v)}}Nxm(b,h){const v=Wk.PageNavigator.instance.Ys(b.currentNode),D=this.t6.wB(b),P=this.Ic.Oc(15);P.Lt(b);h=this.t6.TFk(v,b,h);this.t6.i4n(b,D.listID);P.dispose();this.Hf.l1a(b.currentNode,h)}}Object(n.a)(aB,"SingleLevelListEditor",null,[688]);var bB=c(307);class cB{r4i(b,h,v,D,P,ca){return b?w.AFrameworkApplication.va.Mf(b,h,v,!0,P,ca):8}}Object(n.a)(cB,"ListContextManager",null,[1480]);class Gs extends cB{constructor(b){super();
Gs.Suc=b}r4i(b,h,v,D,P,ca){if(!b||!b.length)return 8;let ta;const Ra=({kmm:b,jmm:ta}=Gs.jq.hmm(b)).returnValue;let mb=1;for(const Ub of Ra.keys){var Jb=b.contains(Ub);const cc=Ra.J(Ub);Gs.jq.JTk(Ra.J(Ub),this.yGc(h),Jb)?Jb?(u.ULS.sendTraceTag(575213851,393,50,"List Actions: {0} lists, with change in level",this.yGc(h)?"Promote":"Demote"),Jb=w.AFrameworkApplication.va.Mf(bB.a.mDa(cc),h,v,D,P,ca)):(u.ULS.sendTraceTag(575213852,393,50,"List Actions: {0} lists, without change in level",this.yGc(h)?"Promote":
"Demote"),Jb=Gs.jq.Yyn(Ra.J(Ub),this.yGc(h),ta.J(Ub))):(u.ULS.sendTraceTag(575213850,393,50,"List Actions: Tried to {0} lists, but unable to indent",this.yGc(h)?"Promote":"Demote"),Jb=8);mb=Oc.ActionManager.sZc(mb,Jb)}return mb}yGc(b){return b===Gb.a.KG?!0:!1}static get jq(){return Gs.Suc||(Gs.Suc=Ea.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}Gs.Suc=null;Object(n.a)(Gs,"WordEditorListContextManager",cB,[]);class tr{get name(){return"WordEditor.ListEditors"}xc(b){w.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&
(b.ha("WordEditor.ListEditors.IListAutoCorrector",()=>new Rt(b.Ue("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"))).singleInstance(),b.ha("WordEditor.IFlatListEditor",()=>(new hz(b.resolve("WordEditor.List.IFlatListReader"),b.Ue("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.IOutlineElementEditor"),new Nh.a,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ListEditors.IListAutoCorrector"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.List.IListFormattingEditor"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.List.ListItemEditor"))).create()).singleInstance(),b.ha("Box4.List.IListEditor",()=>b.resolve("WordEditor.IFlatListEditor")).singleInstance(),b.ha("Box4.List.ISingleLevelListEditor",()=>new aB(b.resolve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"),
b.resolve("Box4.Graph.IGraphTransactionFactory"))).singleInstance(),b.ha("Box4.ListEditors.WordEditorListContextManager",()=>new Gs(b.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new bs(w.AFrameworkApplication.va,new Qo.a,tr.Gd,tr.Ss,Hw.instance)).Tb();const b=w.AFrameworkApplication.va;b.eb(Gb.a.Y1f,sc.a.view,Ok.d,96);b.eb(Gb.a.Xfg,sc.a.view,Ok.c,96);b.eb(Gb.a.obg,sc.a.view,Ok.c,96)}dispose(){}static get Gd(){return null!=
tr.jEg?tr.jEg:tr.jEg=Ea.a.instance.resolve("Box4.List.IListReader")}static get Ss(){return null!=tr.Rzg?tr.Rzg:tr.Rzg=Ea.a.instance.resolve("WordEditor.IFlatListEditor")}static main(){N.a.instance.Fc(new tr)}}Object(n.a)(tr,"WordEditorListEditorsPackage",null,[1,2]);var $B=c(1697),cw=c(500),ny=c(2042);class dw extends dc.a{constructor(b,h,v,D,P,ca){super(b,h);this.styleId=null;this.Bh=0;this.UQa=null;this.characterData=v;this.paragraphNode=D;this.listMarker=P;this.z8=ca}}Object(n.a)(dw,"HeadingText",
dc.a,[]);var tx=c(346);class St{constructor(b,h,v,D,P,ca,ta){this.XZg=!0;this.e6g=0;this.xkh=8;this.jia=null;this.Ssm=Ra=>{if(Ra.Sr)return!0;Ra=Ra.role;return 1===Ra||2===Ra||4===Ra};this.Y$j=b;this.dA=h;this.we=v;this.Hf=D;this.MF=P;this.W5=ca;this.fJe=ta}get ix(){return this.Y$j.value}get Azf(){return this.XZg}set Azf(b){this.XZg=b}get wJb(){return this.e6g}set wJb(b){this.e6g=b}get fRb(){return this.xkh}set fRb(b){this.xkh=b}async SZl(){var b=this.fJe.value;if(!isNullOrUndefined(b)&&b.vy)return b=
await this.v7l(),this.B_f(b,!0);b=this.jia;return isNullOrUndefined(b)?null:Promise.resolve(this.B_f(b,!0))}TZl(){return this.B_f([],!1)}B_f(b,h){const v=window.performance.now(),D=this.y$h();if(!D)return null;const P=new Fb.a;let ca=0;for(;D.moveNext();){var ta=D.iterator;if(11===ta.We){const Ra=this.Hf.Prf(ta),mb=hf.OutlineElementNavigator.Ge(ta,!0);h&&b[ca]&&b[ca].ParaId===fe.ParagraphReader.TQ(mb)&&ca++;hf.OutlineElementNavigator.Vd(ta);if(!mb||!fe.ParagraphReader.Wb(mb)||mb.xr||""===mb.characterData||
"\ufffc"===mb.characterData)continue;const Jb=this.ZPd(mb);Jb&&(Ra&&(Jb.listMarker=this.MF.hlb(Ra,!1).Y8,ta=this.Hf.qw(ta),1===ta.listType&&ta.XQc&&(Jb.UQa=ta.font)),h&&(b[ca-1]&&b[ca-1].ParaId===fe.ParagraphReader.TQ(mb)?Jb.Bh=ca:Jb.Bh=ca+1),P.add(Jb))}}u.ULS.sendTraceTag(591963592,3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",window.performance.now()-v));return P}v7l(){const b=new th.a;var h=ny.a.eba(w.AFrameworkApplication.rootQuerySignature,null);const v=new js.a;v.Eq=h;v.status=
1;this.Cek=window.performance.now();h=this.W5.Gga(0,()=>{if(2!=v.statusCode||null==v.Ij||0==v.Ij.length||null==v.Ij[0]){const D=String.format("GetPageEndsOperation Failed with status code: {0};",v.statusCode);b.setException(Error.create(D));u.ULS.sendTraceTag(543802465,3019,10,D)}else b.Bg(v.Ij[0].PageEnds),u.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.Cek))});h.HI(v);h.yT();return Gf.b(b.task)}PZl(){const b=this.y$h();if(!b)return-1;
let h=0;for(;b.moveNext();){const v=b.iterator;if(11===v.We){const D=hf.OutlineElementNavigator.Ge(v,!0);hf.OutlineElementNavigator.Vd(v);D&&fe.ParagraphReader.Wb(D)&&!D.xr&&""!==D.characterData&&"\ufffc"!==D.characterData&&this.ZPd(D)&&h++}}return h}y$h(){if(!this.ix)return u.ULS.sendTraceTag(591000526,3019,10,"PageNode is null"),null;var b=this.dA.LO(this.ix);if(!b)return u.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=he.GraphIterator.$a(b);if(!b.Bp())return u.ULS.sendTraceTag(591963594,
3019,10,"Failed to root at PageContent."),null;b=Ka.a.Rs(b,b.origin);b.mo(this.Ssm,null);return b}ZPd(b){var h;return null!==(h=this.Xjm(b))&&void 0!==h?h:this.O7l(b)}Xjm(b){if(!ui.a.Vj)return this.Yjm(b);if(!this.lWm(b))return null;var h=Object(tx.c)(9);h=Object(tx.a)(h);h=[...fe.ParagraphReader.pkf(b,h)];if(0===h.length)return null;const v=fe.ParagraphReader.Ina(b)+1;return this.XHh(b,h,v)}O7l(b){var h,v,D,P;if(!ui.a.Vj)return this.MZl(b);var ca=Object(tx.c)(9);ca=Object(tx.a)(ca);const ta=fe.ParagraphReader.FPc(b),
Ra=this.we.NC(b),{Usm:mb,wFl:Jb}=this.kfm(ta,Ra,ca);ca=null!==(P=null!==(v=null===(h=Jb.linkedStyle)||void 0===h?void 0:h.z8)&&void 0!==v?v:null===(D=Jb.kw)||void 0===D?void 0:D.z8)&&void 0!==P?P:10;return this.NHb(ca-1)?this.XHh(b,mb,ca):null}XHh(b,h,v){var D;if(!this.NHb(v-1))return null;const {oCj:P,nCj:ca}=this.TOo(b,h);return 0===P.length?null:(h=null===(D=fe.ParagraphReader.USd(b,P))||void 0===D?void 0:D.trim())&&""!=h?new dw(ca.yd,ca.endCp,h,b,null,v):null}kfm(b,h,v){const D=[];let P={linkedStyle:null,
kw:null},ca=null,ta=null;for(const Ra of b)if(ca=Ra.chp.formatting?this.OZl(h,Ra.chp):ca,b=v(Ra)){if(!ta&&b){ta=ca;if(!ta)break;P=ca}else if(!this.wMm(ca,ta))break;D.push(Ra)}return{Usm:D,wFl:P}}TOo(b,h){var v;let D=-1,P;for(P=0;P<h.length;P++){var ca=h[P],ta=b.characterData.substring(ca.chp.cp,ca.cpEnd),Ra=null===ta||void 0===ta?void 0:ta.trimStart();if(Ra){D=ca.chp.cp+(ta.length-Ra.length);break}}if(-1===D)return{oCj:[],nCj:{yd:-1,endCp:-1}};ca=-1;for(ta=h.length;0<ta;ta--){Ra=h[ta-1];const mb=
b.characterData.substring(Ra.chp.cp,Ra.cpEnd),Jb=null===mb||void 0===mb?void 0:mb.trimEnd();if(Jb){ca=Ra.cpEnd-(mb.length-Jb.length);break}}return{oCj:null!==(v=h.slice(P,ta))&&void 0!==v?v:[],nCj:{yd:D,endCp:ca}}}wMm(b,h){return null==b&&null==h&&b===h?!0:null==b||null==h?!1:h.linkedStyle&&b.linkedStyle&&h.linkedStyle.z8===b.linkedStyle.z8||h.kw&&b.kw&&h.kw.ICh==b.kw.ICh?!0:!1}OZl(b,h){h=Kl.FormattingReader.Sna(h.formatting);b=this.RZl(b,h);h=this.NZl(h);return b||h?{linkedStyle:b,kw:h}:null}RZl(b,
h){b=this.we.Lva(h,b);if(!b)return null;h=b.ia(Bc.a.Gi,9);return this.t8c(h)?{Wjp:b.id,z8:h+1}:null}NZl(b){var h;b=this.we.kg(b);if(!b||!dl.a.s0d(b))return null;const v=null!==(h=dl.a.a8b(b))&&void 0!==h?h:"0";h=Number.parseInvariant(v);return this.NHb(h-1)?{ICh:b,z8:h}:null}Yjm(b){const h=fe.ParagraphReader.Ina(b);if(this.t8c(h))return new dw(0,b.characterData.length,b.characterData,b,null,h+1);if(this.NHb(h)){var v=this.we.No(b);v=this.we.kg(v);if(dl.a.wIb(v))return new dw(0,b.characterData.length,
b.characterData,b,null,h+1)}return null}MZl(b){var h;let v=h=null,D=-1;var P=-1,ca=this.we.NC(b);for(let Ra=0;Ra<b.pa.length;Ra++)if(h=b.pa.J(Ra),h.formatting){var ta=Kl.FormattingReader.Sna(h.formatting);const mb=this.we.kg(ta);if(!v&&(v=mb,P=(P=dl.a.a8b(v))?Number.parseInvariant(P):0,!this.NHb(P-1)))break;ta=(ta=this.we.Lva(ta,ca))?ta.ia(Bc.a.Gi,9):9;D=-1===D?ta:D;if(!(this.t8c(ta)&&D===ta||dl.a.s0d(mb)&&v===mb))break}h=h.cp;ca=b.characterData.substring(0,h);return this.t8c(D)?new dw(0,h,ca,b,null,
D+1):dl.a.s0d(v)?new dw(0,h,ca,b,null,P):null}lWm(b){const h=fe.ParagraphReader.Ina(b);if(!this.NHb(h))return!1;if(this.t8c(h))return!0;b=this.we.No(b);b=this.we.kg(b);return dl.a.wIb(b)?!0:!1}t8c(b){return this.Azf&&this.NHb(b)}NHb(b){return b>=this.wJb&&b<=this.fRb}}Object(n.a)(St,"StyleBasedDocumentHeadings",null,[579]);var kz=c(1011);class oy{constructor(){this.startTime=0}}Object(n.a)(oy,"TocCallbackData",null,[]);class qt{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub){this.yng=(cc,Ac,Lc)=>{const id=
Ac.node;if(!id)return u.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),2;if(12!==id.type)return u.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!id.xr)return 2;if(1===Lc)return bc.SessionStatusManager.instance.Gj?8:32;this.ld&&this.ld.isFeatureEnabled(120)?this.tCc.tWo(id).then(vd=>{vd||this.wIj(id)}):this.wIj(id);return 32};this.R_o=cc=>{cc=window.performance.now()-cc.startTime;u.ULS.sendTraceTag(574408796,
3019,50,String.format("UpdateTOC Duration: {0} ms;",cc));cc=Object.assign(new Bb.a,{durationMs:cc});va.Health.instance.recordKpiSuccess(qt.eMj,cc);qt.L7a()};this.Psi=(cc,Ac,Lc,id,vd)=>{if(fe.ParagraphReader.Wb(Ac.node)&&Ac.node.xr)return 2;if(1===Lc)return bc.SessionStatusManager.instance.Gj?8:32;if(Ac.contextId!==sc.a.Tc||this.Jk.M8(Ac)||!fe.ParagraphReader.Wb(Ac.node))return 32;this.Sd.Ns(17);(null===vd||void 0===vd?0:vd.resolve)?this.tCc.fLh(Ac,vd.resolve):this.tCc.fLh(Ac);return 32};this.T5f=
(cc,Ac,Lc)=>{cc=Ac.node;if(!cc)return u.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==cc.type)return u.ULS.sendTraceTag(39358979,324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),2;if(!cc.xr)return 2;if(1===Lc)return bc.SessionStatusManager.instance.Gj?8:32;Lc=null;cc.isConnected&&(Lc=kz.a.s8b(cc,!0),Lc.emc(cc));Ac=new he.GraphIterator;Ac.set(cc);Ac.zb(8);Ac.jd(8);const id=this.Ic.Oc(15);id.Lt(Ac);this.tCc.S_n(cc)?(id.dispose(),
Lc&&Lc.normalize(),qt.L7a()):(Lc&&Lc.cancel(),id.dispose(),u.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.Yed=h;this.Wc=D;this.Ic=P;this.Jk=ca;this.tCc=ta;this.Sd=Ra;this.ld=mb;this.LWg=Jb;this.yI=Ub}Tb(){this.ga.qa(Gb.a.bRb,sc.a.paragraph,this.yng);this.ga.qa(Gb.a.bRb,sc.a.Hd,this.yng);this.ga.qa(Gb.a.bRb,sc.a.Tc,this.yng);this.ga.Vc(Gb.a.bRb,1028);this.ga.qa(Nc.a.VAf,sc.a.Tc,this.Psi);this.ga.Vc(Nc.a.VAf,1028);this.ga.qa(Nc.a.J4c,sc.a.paragraph,this.T5f);
this.ga.qa(Nc.a.J4c,sc.a.Hd,this.T5f);this.ga.qa(Nc.a.J4c,sc.a.Tc,this.T5f);this.ga.Vc(Nc.a.J4c,1028)}wIj(b){va.Health.instance.recordKpiUsage(qt.eMj,1,qt.tB,null);const h=this.hOl(b),v=new oy;v.startTime=window.performance.now();this.Yed.Fjj(h,Bc.a.Bmg,this.zim(this.L7l(b)),this.R_o,null,v);this.tCc.gWk()}uQj(b){if(null!=b&&b.xr)if(null==this.LWg.instance)u.ULS.sendTraceTag(539628835,3019,10,"Page Number Finder instance is null.");else{var h=this.LWg.instance.Cdi();b=this.jEl(b);var v=!1;1===this.yI.fu&&
(v=!0);0!=b&&h!=b&&(h=[Object.assign(new na.a,{name:"TOCPageNo",string:b}),Object.assign(new na.a,{name:"HeadingPageNo",string:h}),Object.assign(new na.a,{name:"isPageView",string:v})],Xe.a("TOCPageNoMismatch",!0,void 0,h))}}jEl(b){for(let h=0;h<b.pa.length;h++){const v=b.pa.J(h);if(null!=v.ed)for(let D=0;D<v.ed.length;D++){const P=v.ed.J(D);if(1===P.zg&&P.instruction.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(v.cp,b.characterData.length-v.cp))}}return 0}L7l(b){return b?b.ia(Bc.a.kN,
null):(u.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}hOl(b){return this.Wc.Jva(b,7,7).Sb(35)}zim(b){const h=[];h.push(b+",TOC,0");return h}static L7a(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},qt.zDa)}}qt.zDa=5E3;qt.eMj="WordUpdateTOC";qt.tB="wwaengidc";
Object(n.a)(qt,"TableOfContentsActor",null,[578]);class Iw{}Object(n.a)(Iw,"FieldData",null,[]);class Wz extends Iw{constructor(){super();this.Ypb=null}}Object(n.a)(Wz,"TOCFieldData",Iw,[]);class dB{constructor(b,h,v,D,P,ca=null){this.Wsm=b;this.ut=h;this.Bh=v;this.Owj=D;this.listMarker=P;this.UQa=ca}}Object(n.a)(dB,"TOCHeadingData",null,[]);class ux{constructor(b,h){this.OVa=b;this.pn=h}async z$h(b){this.OVa.Azf=b.Bzf;this.OVa.wJb=b.wJb;this.OVa.fRb=b.fRb;return this.OVa.SZl()}SOl(b){if(b=this.ROl(b))return this.pn.zva(b)}ROl(b){const h=
b.pa.length;for(let v=0;v<h;v++){const D=b.pa.J(v);if(D.hyperlink&&D.hyperlink.gca&&D.hyperlink.url.startsWith(G.a.heb))return D.hyperlink.url.substr(D.hyperlink.url.indexOf("_Toc"))}return null}xde(b){(b=this.SOl(b))&&this.pn.ESf(b.id)}lfm(){return this.OVa.PZl()}u3i(b,h){const v=new Wz,D=new Fb.a;for(const P of b){b=this.jfm(P,h);if(!b)return null;D.add(b)}v.Ypb=D;return v}jfm(b,h){let v;if(h&&(v=this.V9k(b),!v))return u.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),
null;h=Po.AParagraphNode.IR(b.characterData.trim());const D=this.bhm(b.z8);return new dB(h,v,b.Bh,D,b.listMarker,b.UQa)}V9k(b){const h=String.format("{0}{1}","_Toc",se.a.uF());return this.pn.MDc(h,b.begin,b.end,b.paragraphNode,b.paragraphNode)?h:null}bhm(b){return String.format("toc {0}",b)}}Object(n.a)(ux,"TOCDataManager",null,[496]);class kl{Neg(){const b=Object.assign(new ug.StandardDialog,{Et:w.AFrameworkApplication.hca,Ad:0,NHa:!1});b.$U(1);b.eja(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,
WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=kl.ECg?kl.ECg:kl.ECg=new kl}}Object(n.a)(kl,"TOCDialogHelper",null,[]);var aC=c(182),PC=c(491),Nu=c(267),Ou=c(147);class hh{constructor(b,h,v,D,P,ca,ta){this.Oeg=b;this.Qjb=h;this.Bzf=v;this.wJb=D;this.fRb=P;this.izb=ca;this.$ad=[];this.instruction=ta}toString(){return"showPageNumber:"+this.Oeg+"  isHyperlink:"+this.Qjb+" includeOutlineLevels:"+this.Bzf+" lowerOutlineLevel:"+this.wJb+" upperOutlineLevel:"+
this.fRb+" addContentControl:"+this.izb+" unsupportedSwitches:"+this.$ad.toString()}}Object(n.a)(hh,"TOCSettings",null,[]);class Bi{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id,vd,xe,Ld,Qd){this.z_g="TOC";this.$jf=this.Hxe=this.KVe=null;this.z7a=b;this.nh=h;this.sD=v;this.Vu=D;this.Xy=P;this.Jk=ca;this.hb=ta;this.Kd=Ra;this.kjh=mb;this.Ce=Jb;this.IVe=Ub;this.Wo=Ac;this.CI=Lc;this.Kn=id;this.Ic=vd;this.Gb=xe;this.zd=Ld;this.fb=Qd}static get iWo(){if(null!=Bi.Fxd)return Bi.Fxd;w.AFrameworkApplication.ue("i430a979-t;a1f4j306-c");
Bi.Fxd=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateEmptyTOCFormattingRunId",!1);return Bi.Fxd}get kTc(){return this.z_g}set kTc(b){this.z_g=b}get Zpb(){this.KVe||(this.KVe=this.e8h());return this.KVe}e8h(){return new hh(!0,!0,!0,0,8,!0,this.WGn())}async fLh(b,h){Xe.a(Bi.zfl);const v=window.performance.now();if(this.fb.Wb(b.node))if(this.Jk.M8(b))u.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),
Bi.$Qa("IP is in locked range");else{var D=await this.z7a.z$h(this.Zpb);if(D){var P=new qf.a(2,1,0,()=>{this.Bfl(b,D,this.Zpb.Qjb,v);h&&h()});this.Gb.Vb(P)}else u.ULS.sendTraceTag(592233795,3019,10,"Failed to create table of contents."),Bi.$Qa("Failed to get TOC data")}else u.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),Bi.$Qa("Context should be paragraph")}Bfl(b,h,v,D=0){let P;try{if(0==D&&(D=window.performance.now()),this.HZh(b.node)){var ca=
new he.GraphIterator;ca.set(b.node);ca.zb(7);ca.jd(7);P=this.Ic.Oc(15);P.Lt(ca);var ta=this.z7a.u3i(h,v);ta||Bi.$Qa("Failed to prepare TOC Field data");var Ra=ta.Ypb?ta.Ypb.count:0;if(Ra){h=null;var mb;for(v=0;v<Ra;v++){const Ac=ta.Ypb.J(v);if(!({TBb:mb}=this.Msi(b,h,v,Ra,Ac,Ub?Ub.toString():void 0)).returnValue){Bi.$Qa("Failed to populate new TOC paragraph");return}if(0==v){var Jb=mb.currentNode;var Ub=fe.ParagraphReader.TQ(Jb)}h=mb}if(this.Zpb.izb&&!this.waf(Jb.id,h.wn.id))Bi.$Qa("Failed to add content control block");
else{var cc=window.performance.now()-D;Xe.a(Bi.Ybf,!0,cc)}}else if(this.IVe.Neg(),this.kal(b)){const Ac=window.performance.now()-D;Xe.a(Bi.Ybf,!0,Ac)}}else Bi.$Qa("Failed to fetch style set")}catch(Ac){Bi.$Qa(String.format("{0} {1}",Ac.message,Ac.stack))}finally{P&&P.dispose()}}HZh(b){this.Hxe=this.Xy.NC(b);return this.Hxe?!0:(u.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static XFa(b){b=[Object.assign(new na.a,{name:Bi.P_o,string:b})];Xe.a(Bi.Ang,!1,void 0,b)}static oLf(b){b=
[Object.assign(new na.a,{name:Bi.x1n,string:b})];Xe.a(Bi.dbj,!1,void 0,b)}static $Qa(b){b=[Object.assign(new na.a,{name:Bi.Afl,string:b})];Xe.a(Bi.Ybf,!1,void 0,b)}async tWo(b){const h=this.Mhi(b);if(null==h)Bi.XFa("Cannot update TOC when firstTocPara = null");else{var v=this.nfm(h);if(0<v.$ad.length)return this.Q8m(v.$ad),!1;Xe.a(Bi.O_o);var D=window.performance.now(),P=await this.z7a.z$h(v);if(!P)return u.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),Bi.XFa("Failed to fetch TOC data"),
!1;b=new qf.a(1,1,0,()=>{this.Q_o(h,P,v,D)});this.Gb.Vb(b);return!0}}Q_o(b,h,v,D=0){let P;try{if(null==b)Bi.XFa("Attempt to update TOC when firstTocPara = null");else{0==D&&(D=window.performance.now());var ca=new he.GraphIterator;ca.set(b);ca.zb(7);ca.jd(7);P=this.Ic.Oc(15);P.Lt(ca);var ta=this.z7a.u3i(h,v.Qjb);if(null==ta)Bi.XFa("Attempt to update TOC when tocFieldData = null");else{var Ra;if(({I6e:Ra}=this.Baj(b,v)).response){u.ULS.sendTraceTag(559018207,3019,50,String.format("Attempting to update TOC with settings: {0}",
v.toString()));var mb=ta.Ypb?ta.Ypb.count:0;if(this.HZh(b)){var Jb;this.vAi(b)&&(this.cbj(b),(b=this.fb.jg(b,!1,!0))&&(Jb=b.ia(Bc.a.Lc,null).toString()));var Ub=b.ia(Bc.a.kN,null);h=Ub;Jb=null!==Jb&&void 0!==Jb?Jb:Ub;if(mb){for(var cc=0,Ac;b.xr&&h==Ub&&cc<mb;){const vd=ta.Ypb.J(cc);v.Qjb&&this.z7a.xde(b);if(!this.r_o(b,cc,mb,vd,v)){u.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");Bi.XFa("Failed to update TOC paragraph");return}b.setValue(Bc.a.kN,Jb);cc++;Ac=b;b=this.fb.jg(Ac,
!1,!0);if(!b){h=null;break}this.CAi(b)&&this.bbj(b);h=b.ia(Bc.a.kN,null)}h==Ub&&this.I5f(b);var Lc;if(({AIf:Lc}=this.avk(ta,cc,mb,Ac,Jb)).response)if(v.izb&&!this.waf(Ra,Lc.id))Bi.XFa("Failed to add content control block");else{var id=window.performance.now()-D;Xe.a(Bi.Ang,!0,id)}else Bi.XFa("Failed to add new paragraph")}else this.IVe.Neg(),this.L_o(b,v.izb,Ra,v.instruction,Jb)&&(cc=window.performance.now()-D,Xe.a(Bi.Ang,!0,cc))}else Bi.XFa("Failed to fetch style set")}else Bi.XFa("Failed to remove Content Control")}}}catch(vd){Bi.XFa(String.format("{0} {1}",
vd.message,vd.stack))}finally{P&&P.dispose()}}avk(b,h,v,D,P){let ca=new he.GraphIterator;for(ca.set(D);h<v;){D=b.Ypb.J(h);if(!({TBb:D}=this.Msi(null,ca,h,v,D,P)).returnValue)return{AIf:ca.currentNode,response:!1};ca=D;h++}return{AIf:ca.currentNode,response:!0}}Baj(b,h){var v,D,P;let ca,ta;const Ra=null===(v=null===b||void 0===b?void 0:b.pa)||void 0===v?void 0:v.first.Jb;if(Ra&&0<Ra.length)if(b=b.pa.first.Jb.J(0),b.If){v=b.contentControlNode.getValue(Bc.a.Tw);ca=ui.a.Hj?this.zd.zq(b.contentControlNode.id,
!0):this.zd.Qs.get(null===(D=b.contentControlNode.id)||void 0===D?void 0:D.toString());ta=ui.a.Hj?this.zd.zq(b.contentControlNode.id,!1):this.zd.xt.get(null===(P=b.contentControlNode.id)||void 0===P?void 0:P.toString());if(0!=this.Wo.YMb(v))return u.ULS.sendTraceTag(558952907,3019,10,"Failed to release content control"),{response:!1,I6e:ca,gCh:ta};h.izb=!0}else u.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),h.izb=!1;else h.izb=!1;return{response:!0,I6e:ca,gCh:ta}}L_o(b,
h,v,D,P){u.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.z7a.xde(b);const ca=this.SOd(b);if(!this.B2i(ca,h,v,D))return Bi.XFa("Failed to populate empty TOC."),!1;if(h=this.fb.jg(b,!1,!0))v=b.ia(Bc.a.kN,null),D=h.ia(Bc.a.kN,null),v==D&&this.I5f(h);b.setValue(Bc.a.kN,P);return!0}B2i(b,h,v,D){this.Kd.replaceTextRange(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.SPi(b);const P=b.pa.first;this.Ce.sL(P.formatting,!0);this.Jaf(b,0,1,D);Bi.iWo&&P.bdg&&b.xe.nq.Z(P.formatting.qe,
op.CharacterPropertiesEditor.MM);return h&&v&&!this.waf(v,b.id)?!1:!0}SOd(b){b.pa.reset();b.rNa();const h=new aC.a(b,0);h.formatting=new Ou.a(h,W.a.nil);h.Rh=!0;b.pa.add(h);return we.a.createTextRange(b,0,b.characterData.length)}vAi(b){if(fe.ParagraphReader.NO(b)){var h=b.pa.last.ed;if(!h||!h.length)return!1;if(4<=h.length){b=0===h.J(h.length-4).zg;const v=1===h.J(h.length-3).zg&&h.J(h.length-3).instruction.trim().startsWith(this.kTc),D=2===h.J(h.length-2).zg;h=5===h.J(h.length-1).zg;return b&&v&&
D&&h}}return!1}CAi(b){if(fe.ParagraphReader.NO(b)){var h=b.pa.first.ed;if(!h||!h.length)return!1;if(2<=h.length)return b=4===h.J(0).zg,h=3===h.J(1).zg,b&&h}return!1}cbj(b){const h=b.pa.last.ed,v=h.J(h.length-4),D=h.J(h.length-3),P=h.J(h.length-2),ca=h.J(h.length-1);h.remove(v);h.remove(D);h.remove(P);h.remove(ca);b.removeProperty(Bc.a.kN)}bbj(b){const h=b.pa.first.ed,v=h.J(0),D=h.J(1);h.remove(v);h.remove(D);b.removeProperty(Bc.a.kN)}I5f(b){if(b){var h=b.ia(Bc.a.kN,null),v=b.ia(Bc.a.Lc,null).toString(),
D=h;v==h&&this.vAi(b)&&(this.cbj(b),(b=this.fb.jg(b,!1,!0))&&(D=b.ia(Bc.a.kN,null)));v=new he.GraphIterator;v.set(b);v.zb(8);u.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var P;b&&b.xr&&D==h&&P!=b;){if(this.CAi(b)){this.bbj(b);break}this.z7a.xde(b);this.Kn.Vd(v);D=this.Kn.Xr(v,!1,!0);this.nh.eHa(b);if(!D)return null;P=b;v.Sb(2);D=(b=v.currentNode)?b.ia(Bc.a.kN,null):null}return b}}nfm(b){var h=b.pa,v=h?h.length:0,D=null;b=new hh(!0,!1,!1,0,8,!0,void 0);for(let P=
0;P<v&&(D=this.mfm(h.J(P)),b.instruction=D,D=this.hcm(D),D[0]!==this.kTc);P++);h=D?D.length:0;for(v=1;v<h;v++)switch(D[v]){case "\\h":b.Qjb=!0;break;case "\\u":b.Bzf=!0;break;case "\\o":this.vmo(D[v+1],b)&&v++;break;case "\\z":break;case "\\n":b.Oeg=!1;b.$ad.push(D[v]);break;default:b.$ad.push(D[v])}return b}vmo(b,h){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&3===b.length?(h.wJb=Number.parseInvariant(b[1])-1,h.fRb=Number.parseInvariant(b[2])-1,!0):!1}S_n(b){try{Xe.a(Bi.w1n);const h=window.performance.now(),
v=this.Mhi(b);if(null==v){Bi.oLf("Attempt to remove TOC when firstTocPara = null");return}let D,P,ca;const ta=this.e8h();if(!({I6e:D,gCh:P}=this.Baj(v,ta)).response)return Bi.oLf("Failed to remove content control"),!1;if(void 0==D&&void 0==P)ca=this.I5f(v);else{ca=v.Kc.Db(D);const mb=new he.GraphIterator;mb.set(ca);mb.zb(8);b=!1;let Jb;for(;!b&&ca&&Jb!=ca;){ca.id.equals(P)&&(b=!0);ca&&ca.xr&&this.z7a.xde(ca);this.Kn.Vd(mb);const Ub=this.Kn.Xr(mb,!1,!0);this.nh.eHa(ca);if(!Ub){ca=null;break}mb.Sb(2);
Jb=ca;ca=mb.currentNode}}ca&&this.FZc(ca);const Ra=window.performance.now()-h;Xe.a(Bi.dbj,!0,Ra)}catch(h){Bi.oLf(String.format("{0} {1}",h.message,h.stack))}return!0}FZc(b){b=we.a.Qc(b,0);b=new rg.Selection([b],!0);this.hb.setSelection(b)}waf(b,h){return this.Wo.Nla(b,h,null,Bi.JTh,!0).returnValue?(u.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),!1):!0}gWk(){this.z7a.lfm()||this.IVe.Neg()}Mhi(b){if(!b.xr)return u.ULS.sendTraceTag(528320659,3019,
15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ia(Bc.a.kN,null);return this.CI.V7l(b)}Q8m(b){b.length&&(b=[Object.assign(new na.a,{name:"UnsupportedSwitches",string:b.toString()})],Xe.a("UnsupportedTocInstruction",void 0,void 0,b))}mfm(b){const h=(b=b.ed)?b.length:0;for(let v=0;v<h;v++)if(1===b.J(v).zg&&b.J(v).instruction.trim().startsWith(this.kTc))return b.J(v).instruction.trim();return null}hcm(b){const h=[];if(!b)return h;b=b.split(" ");return b.length?b:h}kal(b){b=this.DMh(b,
null,!0,void 0).returnValue;if(!b)return Bi.$Qa("Failed to create paragraph"),!1;const h=we.a.Qc(b,0);if(!this.B2i(h,!0,b.id,this.Zpb.instruction))return Bi.$Qa("Failed to populate empty TOC"),!1;u.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}DMh(b,h,v,D){let P,ca;v&&b?(P=this.Bal(b),ca=P.currentNode,D=fe.ParagraphReader.TQ(ca).toString()):h&&(P=this.f5l(h),ca=this.nh.YI(P));if(!ca)return u.ULS.sendTraceTag(592233798,3019,15,"Failed to insert paragraph for table of contents"),
{returnValue:null,TBb:P};ca.setValue(Bc.a.kN,D);return{returnValue:ca,TBb:P}}WGn(){const b=new Sys.StringBuilder(this.kTc);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}kHn(b){const h=new Sys.StringBuilder("PAGEREF ");h.append(b);this.Zpb.Qjb&&h.append(" \\h");return h.toString()}f5l(b){b.vd();this.Kn.Vd(b);return this.nh.noa(b,!1)}Bal(b){const h=new he.GraphIterator;h.set(b.node);h.vd();this.Kn.Vd(h);let v=this.nci(h);const D=!b.cpBegin;if(ig.OutlineElementReader.isEmpty(h,!0))return this.wsi(v);
if(D)return this.nh.xz(v,!0,!1),this.nh.Z9(h,v,b,!1,!1,!1),b=this.nci(v),this.wsi(b);v=this.nh.noa(h);this.nh.Z9(h,v,b,!1,!1,!0);b=this.nh.noa(h);this.nh.AOb(b.currentNode,!1);this.nh.YI(b);this.Kn.Ge(b);return b}nci(b){const h=new he.GraphIterator;h.Zc(b);h.vd();return h}wsi(b){this.nh.xz(b,!0,!0);this.nh.AOb(b.currentNode,!1);this.Kn.Ge(b);return b}SPi(b){const h=b.pa;1===h.length&&(h.first.Rh=!1,b.AKd().Rh=!0)}r_o(b,h,v,D,P){const ca=this.SOd(b);this.Kd.replaceTextRange(ca,"");this.F2i(b,D,P);
this.Jaf(b,h,v,P.instruction);return P.Qjb&&!this.kG(b,D.ut)?!1:!0}Msi(b,h,v,D,P,ca){h=({TBb:b}=this.DMh(b,h,0==v,ca)).returnValue;if(!h)return{returnValue:!1,TBb:b};this.F2i(h,P,this.Zpb);this.Jaf(h,v,D,this.Zpb.instruction);return this.Zpb.Qjb&&!this.kG(h,P.ut)?{returnValue:!1,TBb:b}:{returnValue:!0,TBb:b}}F2i(b,h,v){this.uCm(b,h.Wsm,h.listMarker,h.Owj,h.UQa);this.kjh.VDm(b,b.characterData.length);v.Oeg&&this.nDm(b,h);this.SPi(b);this.Noo(b,h.Owj)}F2l(b,h){if(!b)return 0;const v=Bi.chm();return 4<
b.length?v.J(h)+.5*Math.floor(b.length/3):v.J(h)}uCm(b,h,v,D,P){v&&this.KCm(b,v,D);v=we.a.Qc(b,b.characterData.length);this.Kd.replaceTextRange(v,h);P&&(b=b.pa.Mh(0),this.Ce.Uia(b.formatting,P))}KCm(b,h,v){v=this.F2l(h,v);const D=we.a.Qc(b,0);this.Kd.replaceTextRange(D,h);this.kjh.LCm(b,h.length,v)}nDm(b,h){var v=we.a.Qc(b,b.characterData.length);this.Kd.replaceTextRange(v,h.Bh.toString());v=b.pa.Mh(b.characterData.length-h.Bh.toString().length);h=this.kHn(h.ut);this.RPa(b,v,0,2,h);this.RPa(b,v,1,
2,h);this.RPa(b,v,2,2,h);v=b.pa.Mh(b.characterData.length);this.RPa(b,v,3,2,h)}Noo(b,h){h=this.Hxe.Di(h);this.Vu.RJ(h,b,!0)}Jaf(b,h,v,D){const P=b.pa.first,ca=b.pa.last;h?this.RPa(b,P,4,1,D):(this.RPa(b,P,0,1,D),this.RPa(b,P,1,1,D),this.RPa(b,P,2,1,D));h===v-1?this.RPa(b,ca,3,1,D):this.RPa(b,ca,5,1,D)}RPa(b,h,v,D,P=null){v=new PC.a(h,null,v,D,!0,!1,!1,P);h.ed||(h.ed=new Nu.a(h));h.ed.add(v);b.Yl();this.ggl(v,b)}ggl(b,h){b.qe?h.xe.VX(b.qe-1,2):h.xe.loa(b.qe,2);h.xe.nq.Z(b.qe,op.CharacterPropertiesEditor.MM);
h.xe.ft.Z(b.qe,op.CharacterPropertiesEditor.tR)}kG(b,h){b=we.a.createTextRange(b,0,b.characterData.length);return this.sD.kG(b,h,!1,!1,!1,!0)?!0:(u.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static chm(){Bi.tta||(Bi.tta=new ac.a,Bi.tta.Z("toc 1",1),Bi.tta.Z("toc 2",1.5),Bi.tta.Z("toc 3",2),Bi.tta.Z("toc 4",2.5),Bi.tta.Z("toc 5",3),Bi.tta.Z("toc 6",3.5),Bi.tta.Z("toc 7",4),Bi.tta.Z("toc 8",4.5),Bi.tta.Z("toc 9",5));return Bi.tta}}Bi.tta=null;
Bi.JTh="Table of Contents";Bi.zfl="CreateTocClient";Bi.Ybf="CreateTocSuccess";Bi.Afl="CreateTocFailureCause";Bi.O_o="UpdateTocClient";Bi.Ang="UpdateTocSuccess";Bi.P_o="UpdateTocFailureCause";Bi.w1n="RemoveTocClient";Bi.dbj="RemoveTocSuccess";Bi.x1n="RemoveTocFailureCause";Bi.Fxd=null;Object(n.a)(Bi,"TOCField",null,[494,495]);var Tt=c(633);class eB{constructor(b,h){this.fAa=b;this.lJa=h}VDm(b,h){if(fe.ParagraphReader.Wb(b)&&!(0>h)){var v=Xm.a.q2b(b);v=new Tt.a(v,4,1,1);this.fAa.UWd(b,v);b=we.a.Qc(b,
h);this.lJa.hXd(b)}}LCm(b,h,v){var D=Vh.a.oM/2;const P=b.pa.Ihb(h);D=Kl.FormattingReader.Rn(P.formatting,lf.a.fontSize,2*D)/2;v=new Tt.a(Df.a.Kv(D/36)*v,1,0,1);this.fAa.UWd(b,v);b=we.a.Qc(b,h);this.lJa.hXd(b)}}Object(n.a)(eB,"TOCTabUtility",null,[493]);class QC{constructor(){this.W=null}get name(){return"WordEditor.TableOfContents"}xc(b){this.W=b;this.W.ha("WordEditor.AutoSaveParamsUpdateService",()=>new $B.a(this.W.resolve("Box4.Graph.IGraphIteratorFactory"),cw.a.NQ)).singleInstance();this.W.ha("WordEditor.TableOfContents.StyleBasedDocumentHeadings",
()=>new St(new Gg.a(()=>Xa.App.xa.ib.Uc),Wk.PageNavigator.instance,this.W.resolve("Box4.Styles.IWACStyleReader"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IListMarkerUtility"),new ks.a,new Gg.a(()=>Xa.App.xa.ib.rc))).as("WordEditor.TableOfContents.IDocumentHeadings").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCDataManager",()=>new ux(this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").singleInstance();
this.W.ha("WordEditor.TableOfContents.TOCTabUtility",()=>new eB(this.W.resolve("WordEditor.ICustomTabStopUtility"),this.W.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCField",()=>new Bi(this.W.resolve("Box4.ITOCDataManager"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.IHyperlinkEditor"),this.W.resolve("Box4.Styles.IWACStyleEditor"),this.W.resolve("Box4.Styles.IWACStyleReader"),qi.a.instance,
this.W.resolve("Box4.ISelectionManager"),this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("WordEditor.TableOfContents.ITOCTabUtility"),this.W.resolve("Box4.IFormattingEditor"),kl.instance,this.W.resolve("Box4.IFeatureHelper"),this.W.resolve("WordEditor.ContentControl.IContentControlManager"),this.W.Na("WordEditor.ParagraphWordIdMapping"),this.W.resolve("Box4.IOutlineElementNavigator"),Nh.a.instance,w.AFrameworkApplication.nc,this.W.resolve("Box4.ContentControlParagraphMapping"),b.resolve("Box4.IParagraphReader"))).as("WordEditor.TableOfContents.ITOCField").singleInstance();
this.W.ha("WordEditor.TableOfContents.TableOfContentsActor",()=>new qt(w.AFrameworkApplication.va,this.W.resolve("WordEditor.AutoSaveParamsUpdateService"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.Graph.IGraphIteratorFactory"),Nh.a.instance,qi.a.instance,this.W.resolve("WordEditor.TableOfContents.ITOCField"),this.W.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.W.resolve("Box4.IFeatureHelper"),this.W.Sa("WordEditor.IPageNumberFinder"),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").singleInstance()}init(){this.W.resolve("WordEditor.TableOfContents.ITableOfContentsActor").Tb()}dispose(){}}
Object(n.a)(QC,"PackageManager",null,[1,2]);class ap{constructor(b,h,v,D,P,ca,ta,Ra){this.kSa=(mb,Jb,Ub,cc,Ac)=>{if(!({ly:mb}=this.Uob(Jb,Ub,Ac,!0,!0)).returnValue)return mb;this.kwd.OLh(Ac,Jb.node);return 32};this.$xa=(mb,Jb,Ub,cc,Ac)=>this.vmi(Jb,Ub,cc,Ac,!0);this.NLb=(mb,Jb,Ub,cc,Ac)=>{if(!({ly:mb}=this.Uob(Jb,Ub,Ac,!1,!0)).returnValue)return mb;this.kwd.mcl(Ac,Jb.node);u.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.Yla=(mb,Jb,Ub,cc,Ac)=>{if(!({ly:cc}=this.Uob(Jb,Ub,Ac,!1,
!0)).returnValue)return 2==Ub&&8==cc&&os.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],me.a.iDb),cc;const Lc=Jb.node;let id=null;(id=mb===Gb.a.Yla?this.kwd.FRb(Ac[If.a.SourceControlId],Lc):this.jy.$8b(Lc,Ac))?(this.w$d(Lc,()=>{this.kyd.L6a(id,Lc)}),this.HP(),cc=32):(os.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],me.a.iDb),cc=8);mb===Gb.a.Yla&&32===cc&&u.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");u.ULS.shipAssertTag(0,
324,32===cc);return cc};this.Tta=(mb,Jb,Ub,cc,Ac)=>this.vmi(Jb,Ub,cc,Ac,!1);this.vle=(mb,Jb,Ub,cc,Ac)=>Ds.a.Ipa(mb,Jb,Ub,cc,Ac,{},14);this.PAb=(mb,Jb,Ub,cc,Ac)=>{if(!({ly:mb}=this.Uob(Jb,Ub,Ac,!1,!1)).returnValue)return mb;const Lc=Jb.node;this.w$d(Lc,()=>{this.kyd.NZk(Lc)});return 32};this.jy=b;this.kwd=h;this.ga=v;this.kyd=D;this.Ic=P;this.Yz=ca;this.i$j=Ra}Tb(){this.lhc(Xa.App.WTa.pLh())}lhc(b){this.ga.qa(Gb.a.kSa,sc.a.view,b);this.ga.qa(Gb.a.kSa,sc.a.table,this.kSa);this.ga.Vc(Gb.a.kSa,1127);
this.ga.qa(Gb.a.Yla,sc.a.view,this.vle);this.ga.qa(Gb.a.Yla,sc.a.table,this.Yla);this.ga.Vc(Gb.a.Yla,1030);this.ga.qa(Gb.a.applyStyle,sc.a.table,this.Yla);this.ga.qa(Gb.a.Tta,sc.a.view,this.vle);this.ga.qa(Gb.a.Tta,sc.a.table,this.Tta);this.ga.Vc(Gb.a.Tta,1038);this.ga.qa(Gb.a.$xa,sc.a.view,b);this.ga.qa(Gb.a.$xa,sc.a.table,this.$xa);this.ga.Vc(Gb.a.$xa,1127);this.ga.qa(Gb.a.NLb,sc.a.view,b);this.ga.qa(Gb.a.NLb,sc.a.table,this.NLb);this.ga.Vc(Gb.a.NLb,1126);this.ga.qa(Gb.a.PAb,sc.a.view,this.vle);
this.ga.qa(Gb.a.PAb,sc.a.table,this.PAb);this.ga.Vc(Gb.a.PAb,1028)}HP(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}vmi(b,h,v,D,P){if(!({ly:ca}=this.Uob(b,h,D,P,!0)).returnValue)return 2==h&&8==ca&&os.a.recordQosError("TableStyleOptionButtonClickNoResponse",
["TableInteractionFailed"],me.a.JAl),ca;b=b.node;h=this.jy.YT(b);var ca=D[If.a.On];const ta=ap.Gfm(D.MenuItemId);P?D[If.a.On]=ap.Duo(h,ta):(this.EGk(h,ta,ca,b),v.xs=ta,v.zC=ca?0:1,u.ULS.shipAssertTag(0,324,!!ta));return 32}w$d(b,h){const v=this.Ic.Oc(15);try{v.Cb(b),this.Yz.W5a(),h()}finally{v&&v.dispose()}}Uob(b,h,v,D,P){return this.uUm(b,h,v,D,P)?{returnValue:D||2===h,ly:32}:{returnValue:!1,ly:8}}uUm(b,h,v,D,P){if(b.contextId!==sc.a.table)return!1;if(D||2===h)if(P&&!v||!Object(rb.a)(Hv.TableNode,
b.node)||this.i$j(b.node))return!1;return!0}EGk(b,h,v,D){const P=(512===h||1024===h?!v:v)?b|h:b&~h;P!==b&&this.w$d(D,()=>{this.kyd.nda(P,D)})}static lD(){ap.Tcb[ap.qFl]=32;ap.Tcb[ap.hFl]=128;ap.Tcb[ap.xYm]=64;ap.Tcb[ap.pYm]=256;ap.Tcb[ap.iKk]=512;ap.Tcb[ap.hKk]=1024}static Duo(b,h){b=!!(b&h);if(512===h||1024===h)b=!b;return b}static Gfm(b){let h=0;b in ap.Tcb&&(h=ap.Tcb[b]);return h}}ap.qFl="buttonFirstRow";ap.hFl="buttonFirstColumn";ap.xYm="buttonLastRow";ap.pYm="buttonLastColumn";ap.iKk="buttonBandedRow";
ap.hKk="buttonBandedColumn";ap.Tcb={};Object(n.a)(ap,"TableStyleActor",null,[]);ap.lD();var lz=c(765),rn=c(402);class vx extends rn.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(n.a)(vx,"TableGalleryButtonProps",rn.a,[]);class Jw extends vx{constructor(){super()}get Type(){return 6}}Object(n.a)(Jw,"TableStyleGalleryButtonProps",vx,[]);class Kw{}Kw.Min=2147483647;Object(n.a)(Kw,"TableStyleUtil",null,[]);class ur{constructor(b,h,v){this.X7e="Clear";this.fDb=
null;this.omk=b;this.we=h;this.jy=v;this.Wba=w.AFrameworkApplication.Wba;this.Ws=w.AFrameworkApplication.Ws}i0a(){}ntk(b,h){this.i0a(b);const v=this.v4h(b),D=v.length;if(!(0>=D)){var P=Kw.Min,ca=null;for(let mb=0;mb<D;mb++){var ta=v[mb],Ra=this.jy.Ufm(ta);P!==Ra&&(P=Object.assign(new ih.a,{Id:"msMoreTableStyles"+Ra,Title:this.Vfm(Ra),ControlList:[]}),ca=Object.assign(new Hk.a,{Type:6,Id:"galleryMoreTableStyles"+Ra,ExternalGalleryId:"TableStylesGallery",Width:ur.$gg,ElementDimensions:"Size64by48",
GalleryItems:[]}),this.fDb&&(ca.ExternalId=this.fDb[Ra.toString()]),P.ControlList.push(ca),h.MenuSectionList.push(P),P=Ra);Ra=this.we.UQ(ta);ta=ur.nig+mb;Ra=Object.assign(new Jw,{Id:ta,ExternalId:ta,Command:Gb.a.Yla.toString(),QueryCommand:Gb.a.kSa.toString(),LabelText:Ra?G.a.yf(Ra):"",Alt:Ra,VerticalCenterAlign:"true"});Ra.TableCellStyles=this.ISd(ta,b);Ra.TableStyles=this.VPc(ta,b);ca&&ca.GalleryItems.push(Ra)}}}mtk(b){const h=Object.assign(new ih.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",
ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),v=Object.assign(new mg.a,{Id:"fseaClearTableFormatting",Command:Gb.a.PAb.toString(),LabelText:G.a.yf(this.X7e),Alt:G.a.yf(this.X7e),Image16by16:this.Ws,Image16by16Class:Xc.getImageClassWithCluster(this.Wba,ur.MZk),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});h.ControlList.push(v);b.MenuSectionList.push(h)}OLh(b,h){this.i0a(h);const v=b[If.a.SourceControlId];var D=this.FRb(v,h);if(D){var P=this.jy.hF(h);P=P?this.we.kg(P):null;var ca=
this.we.UQ(D);D=this.we.kg(D);b[ri.a.Alt]=ca;b[ri.a.On]=D===P;h=Object.assign(new Jw,{Id:v,ExternalId:v,Command:Gb.a.Yla.toString(),QueryCommand:Gb.a.kSa.toString(),TableCellStyles:this.ISd(v,h),TableStyles:this.VPc(v,h),Alt:ca});b[ri.a.GalleryButtonProps]=h}else b[ri.a.InnerHTML]=null,b[ri.a.Alt]=null,b[ri.a.On]=!1,b[ri.a.GalleryButtonProps]=null}ISd(b,h){this.i0a(h);return(b=this.FRb(b,h))?this.omk.T5h(b,h):null}VPc(b,h){this.i0a(h);return this.FRb(b,h),null}mcl(b,h){b.MenuItems=this.D4l(h)}D4l(b){const h=
Object.assign(new Yd.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.ntk(b,h);this.mtk(h);return h}FRb(b,h){return b?b.startsWith(ur.nig)?this.Zvf(parseInt(b.substr(ur.nig.length)),h):this.S7n(parseInt(b.substr(ur.oIo.length)),h):null}}ur.nig="buttonTableStyleMenu";ur.oIo="buttonTableStyleRibbon";ur.$gg=7;ur.MZk="ClearTableStyle_16x16x32";Object(n.a)(ur,"ATableStyleRibbonControl",null,[491]);class fB extends ur{constructor(b,h,v){super(null,h,v);this.sih=b}OLh(b,h){this.i0a(h);const v=b[If.a.SourceControlId];
var D=this.FRb(v,h);if(D){var P=this.jy.hF(h);P=P?this.we.kg(P):null;var ca=this.we.UQ(D);D=this.we.kg(D);b[ri.a.Alt]=ca;b[ri.a.On]=D===P;h=Object.assign(new Jw,{Id:v,ExternalId:v,Command:Gb.a.Yla.toString(),QueryCommand:Gb.a.kSa.toString(),TableCellStyles:this.ISd(v,h),TableStyles:this.VPc(v,h),Alt:ca});b[ri.a.GalleryButtonProps]=h}else b[ri.a.InnerHTML]=null,b[ri.a.Alt]=null,b[ri.a.On]=!1,b[ri.a.GalleryButtonProps]=null}ISd(b,h){this.i0a(h);return(b=this.FRb(b,h))?this.sih.T5h(b,h,5,5):null}VPc(b,
h){this.i0a(h);return this.FRb(b,h),null}}Object(n.a)(fB,"ATableStyleRibbonControlVariableSizePreviews",ur,[]);var RC=c(1468),SC=c(1102);class wx{constructor(b,h,v,D){this.hPl=(P,ca)=>this.getBorder(P,this.P1.xM(ca));this.gPl=(P,ca)=>this.getBorder(P,this.P1.DO(ca));this.Xy=b;this.Xu=h;this.eyb=v;this.P1=D;this.xYj=new Gg.a(()=>this.fPl());this.w9a=new Gg.a(()=>this.ePl())}fPl(){const b={},h=w.AFrameworkApplication.isRtl;b.top="border-top";b.left=h?"border-right":"border-left";b.bottom="border-bottom";
b.right=h?"border-left":"border-right";b.insideHorizontal="border-bottom";b.insideVertical=h?"border-left":"border-right";return b}ePl(){const b={};b[zh.a.ACa]=zh.a.neb;b[zh.a.neb]=zh.a.neb;b[zh.a.yZa]=zh.a.yZa;return b}u$k(b,h,v,D){const P=new SC.a;P.rowCount=v;P.Teb=D;P.ITa=this.eyb.bfm(b);P.Ia=b.ia(Bc.a.Ia,1);P.Ha=b.ia(Bc.a.Ha,1);P.tableLook=h;P.ple=1;return P}T5h(b,h,v,D){if(!this.Xy.kg(b)||!Object(rb.a)(30,b)||!Object(rb.a)(tq.a,h))return null;const P=this.Xu.YT(h);v=this.u$k(b,P,v,D);D=[];for(v.rowIndex=
0;v.rowIndex<v.rowCount;v.rowIndex++)this.tvk(b,h,v,D);return D}VPc(){return null}D8(){}tvk(b,h,v,D){v.o$b=!v.rowIndex;for(v.cellIndex=0;v.cellIndex<v.Teb;v.cellIndex++)this.Qrk(b,h,v,D)}Qrk(b,h,v,D){h=this.eyb.E3k(v,this.eyb.Nof(v),h,b);const P={};var ca=this.Xu.Dof(b,h,lf.a.fontColor,!0,xn.a.TK(),"None");P.color=ca?ca:"inherit";ca=this.Xu.Dof(b,h,lf.a.wH,!0,xn.a.TK(),"None");P["background-color"]=ca?ca:"inherit";this.Vvk(v,b,h,P);D.push(P)}Vvk(b,h,v,D){b=this.eyb.SOa(b);this.mzd(5,b,h,v,D);this.mzd(3,
b,h,v,D);this.mzd(0,b,h,v,D);this.mzd(4,b,h,v,D)}mzd(b,h,v,D,P){h=this.$Vl(b,h,v,D);h!==zh.a.cG&&(P[this.xYj.value[RC.a[b]]]=h)}$Vl(b,h,v,D){let P=zh.a.cG;if(({ema:P}=this.zIa(D,b,1,h,this.gPl,P)).returnValue)return P;({ema:P}=this.zIa(v,b,3,h,this.hPl,P));return P}zIa(b,h,v,D,P,ca){return this.P1.nqj(v,h,D)&&(ca=P(b,h))!==zh.a.cG||!h&&({ema:ca}=this.zIa(b,1,v,D,P,ca)).returnValue||4===h&&({ema:ca}=this.zIa(b,2,v,D,P,ca)).returnValue?{returnValue:!0,ema:ca}:{returnValue:ca!==zh.a.cG,ema:ca}}getBorder(b,
h){let v="",D,P;({borderStyle:D,borderWidth:P}=this.jPl(b,h));if(D===zh.a.yZa)return v;v=String.format(zh.a.YBd,P,D,this.kOd(b,h));return v.trim()}kOd(b,h){if(!h)return zh.a.qQ;b=this.Xu.ULc(b,h.color,sh.a.auto);return b!==sh.a.auto?sh.a.YE(b):zh.a.qQ}jPl(b,h){var v=zh.a.aua;let D=zh.a.dG+zh.a.a2b;if(!h)return{borderStyle:v,borderWidth:D};v=this.Xu.ULc(b,h.style,zh.a.yZa);b=this.Xu.ULc(b,h.size,zh.a.dG);D=this.iPl(v,b)+zh.a.a2b;v=this.$Ol(v);return{borderStyle:v,borderWidth:D}}iPl(b,h){let v=2;b===
zh.a.Y1b&&h<zh.a.dma&&(v=1);return v}$Ol(b){return this.w9a.value[b]||zh.a.Z1b}static Xfm(){return new wx(Ea.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ea.a.instance.resolve("WordEditor.IWACTableStyleReader"),aq.a.instance,zh.a.instance)}static get instance(){return null!=wx.OBg?wx.OBg:wx.OBg=wx.Xfm()}}Object(n.a)(wx,"TableStylePreviewGenerator",null,[492]);var Lw;(function(b){b[b.bep=0]="background1";b[b.dpp=1]="text1";b[b.cep=2]="background2";b[b.epp=3]="text2";b[b.accent1=4]="accent1";b[b.accent2=
5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.yhp=11]="followedHyperlink";b[b.qfp=12]="dark1";b[b.Pjp=13]="light1";b[b.rfp=14]="dark2";b[b.Qjp=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(Lw||(Lw={}));Object(n.b)("ThemeColor",Lw);class rt{constructor(b){this.wLa=b}gNl(b,h,v){let D;({i7i:h,Awh:D}=this.$$l(h));b=[];const P=[];for(let ta=0;16>ta;ta++){if(!(Lw[ta]in v.nyb))continue;const Ra=ta,
mb=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,WoncaIntl.WoncaStrings[D[Ra]],this.t1l(ta));var ca=h[Ra];ca=ca&4278190080|(ca&255)<<16|ca&65280|(ca&16711680)>>>16;P.push(Object.assign(new Fq.a,{Color:Ra.toString(),DisplayColor:"#"+G.a.XI(ca,6),Alt:G.a.yf(mb)}));b[b.length]=ta}return{returnValue:P,sKo:b}}t1l(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;
case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}$$l(b){let h=null,v=null;b=this.wLa(b);if(!b)return{i7i:h,Awh:v};h=b.properties.ia(Bc.a.themeColors,null);v=b.properties.getValue(Bc.a.$le).split(" ");return{i7i:h,Awh:v}}static Zfm(){return new rt(Object(z.a)(rt.Oh,
rt.Oh.Ys,"navigateToPageContentNode"))}static get Oh(){return Wk.PageNavigator.instance}static get instance(){return null!=rt.gCg?rt.gCg:rt.gCg=rt.Zfm()}}Object(n.a)(rt,"TableStyleThemeHelper",null,[526]);var Ys=c(860);class Nj{constructor(b,h){this.LUe={};this.nyb={};this.we=b;this.jy=h}Fif(b,h){const v=this.LUe[Lw[h]];return v&&v.length?v:this.$Kl(b,h)}jai(b,h,v){if(h=this.Fif(h,v))for(b=this.we.kg(b),v=0;v<h.length;v++)if(this.we.kg(h[v])===b)return v;return-1}D8(){this.LUe={};this.nyb={}}$Kl(b,
h){const v=[];this.nyb={};b=this.jy.jib(b);this.PAd(v,this.nyb,0,h,b);this.PAd(v,this.nyb,1,h,b);this.PAd(v,this.nyb,2,h,b);this.PAd(v,this.nyb,3,h,b);return this.LUe[Lw[h]]=v}PAd(b,h,v,D,P){const ca=P.kO;for(let ta=0;ta<ca;ta++){const Ra=P.FEa(ta);if(3!==this.we.AG(Ra))continue;const mb=this.jy.Tfm(Ra),Jb=this.jy.PSd(Ra);h[Lw[Jb]]=!0;mb!==v||Jb!==D&&16!==Jb||this.we.kg(Ra)===Ys.a.Wpg||(b[b.length]=Ra)}}static Ljm(){return new Nj(Ea.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ea.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static $fl(){return Nj.Ljm()}}
Object(n.a)(Nj,"WACTableStyleRibbonList",null,[525]);class Hs extends fB{constructor(b,h,v,D,P){super(b,h,v);this.YTb=4;this.Gwd=[];this.jFm=()=>{this.Y_b.D8();this.sih.D8()};this.pmk=P;this.Y_b=D;this.X7e=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.$En()}p$k(b,h){b.MenuItems=this.hKl(h)}$En(){this.fDb={};this.fDb["0"]="CustomTableStyles";this.fDb["1"]="PlainTableStyles";this.fDb["2"]="GridTableStyles";this.fDb["3"]="ListTableStyles"}hKl(b){const h=Object.assign(new Yd.a,{Id:"menuTableTheme"});
h.MenuSectionList=[];if(this.ITm(b))return h;const v=Object.assign(new ih.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),D=Object.assign(new lz.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:Nc.a.Tdb.toString(),QueryCommand:Nc.a.CMb.toString(),Width:Hs.tKo});D.Colors=({sKo:this.Gwd}=this.pmk.gNl(this.Gwd,b,this.Y_b)).returnValue;v.ControlList.push(D);h.MenuSectionList.push(v);return h}i0a(b){if(b=this.jy.hF(b))b=this.jy.PSd(b),16!==b&&
(this.YTb=b)}v4h(b){return this.Y_b.Fif(b,this.YTb)}Zvf(b,h){h=this.Y_b.Fif(h,this.YTb);return 0>b||b>=h.length?null:h[b]}S7n(b,h){var v=this.jy.hF(h);v=this.Y_b.jai(v,h,this.YTb);v=-1!==v?Math.floor(v/ur.$gg)*ur.$gg:0;return this.Zvf(v+b,h)}Vfm(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;
default:return""}}ITm(b){this.i0a(b);return 0>=this.v4h(b).length}J_o(b,h){if(!b||!h)return null;b=parseInt(b[db.Color]);var v=this.jy.hF(h);const D=this.jy.PSd(v);if(D===b)return null;if(16===D)return this.YTb=b,null;v=this.Y_b.jai(v,h,D);this.YTb=b;return this.Zvf(v,h)}fnl(b){b=this.jy.hF(b);b=this.jy.PSd(b);if(16!==b)for(let h=0;h<this.Gwd.length;h++)if(this.Gwd[h]===b)return h;return-1}ozb(b){b.fZe(this.jFm,2)}static Yfm(){return new Hs(wx.instance,Ea.a.instance.resolve("Box4.Styles.IWACStyleReader"),
Ea.a.instance.resolve("WordEditor.IWACTableStyleReader"),Nj.$fl(),rt.instance)}static get instance(){return null!=Hs.KCg?Hs.KCg:Hs.KCg=Hs.Yfm()}}Hs.tKo=4;Object(n.a)(Hs,"TableStyleRibbonControls",fB,[490,491]);var TC=c(1562);class Pu extends ap{constructor(b,h,v,D,P,ca,ta,Ra){super(b,h,v,D,P,ca,ta,Ra);this.tgc=(mb,Jb,Ub,cc,Ac)=>{if(!({ly:mb}=this.Uob(Jb,Ub,Ac,!1,!0)).returnValue)return mb;this.oig.p$k(Ac,Jb.node);return 32};this.Tdb=(mb,Jb,Ub,cc,Ac)=>{if(!({ly:mb}=this.Uob(Jb,Ub,Ac,!1,!0)).returnValue)return 2==
Ub&&8==mb&&os.a.recordQosError("TableStyleColorButtonClickNoResponse",["TableInteractionFailed"],me.a.KAl),mb;const Lc=Jb.node,id=this.oig.J_o(Ac,Lc);id&&this.w$d(Lc,()=>{this.kyd.L6a(id,Lc)});return 32};this.CMb=(mb,Jb,Ub,cc,Ac)=>{if(!({ly:mb}=this.Uob(Jb,Ub,Ac,!0,!0)).returnValue)return mb;Ac[db.IndexColorSelected]=this.oig.fnl(Jb.node);return 32}}lhc(b){super.lhc(b);this.ga.qa(Nc.a.Tdb,sc.a.view,this.vle);this.ga.qa(Nc.a.Tdb,sc.a.table,this.Tdb);this.ga.Vc(Nc.a.Tdb,1030);this.ga.qa(Nc.a.tgc,sc.a.view,
b);this.ga.qa(Nc.a.tgc,sc.a.table,this.tgc);this.ga.Vc(Nc.a.tgc,1126);this.ga.qa(Nc.a.CMb,sc.a.view,b);this.ga.qa(Nc.a.CMb,sc.a.table,this.CMb);this.ga.Vc(Nc.a.CMb,1127)}get oig(){return this.kwd}static Sfm(){return new Pu(Ea.a.instance.resolve("WordEditor.IWACTableStyleReader"),Hs.instance,w.AFrameworkApplication.va,TC.a.instance,new Nh.a,Ea.a.instance.resolve("Box4.IInsertionPointFormatting"),Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(z.a)(qi.a.instance,
qi.a.instance.vkb,"isTableNodeInLockedRange"))}static get instance(){return null!=Pu.VBg?Pu.VBg:Pu.VBg=Pu.Sfm()}}Object(n.a)(Pu,"TableStyleActor",ap,[]);var Mw=c(1623);class eq{constructor(){this.W=null}get name(){return"WordEditor.TableStyle"}xc(b){this.W=b;this.W.ha("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>wx.instance).singleInstance();this.W.ha("Box4.TableEditors.ITableStyleEditor",()=>Mw.a.instance).singleInstance();this.W.ha("Box4.TableEditors.IWACTableStyleEditor",()=>
TC.a.instance).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>{this.hn()})}hn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(111)&&(Pu.instance.Tb(),Hs.instance.ozb(xr.a.instance),Xa.App.xa.updateCommandUI())}dispose(){}}Object(n.a)(eq,"TableStylePackage",null,[1,2]);var UC=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",
ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},
children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},
{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",
LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",
attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",MenuItemId:"HeaderToolbarButtonFirstPage",
Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",
MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",MenuItemId:"HeaderToolbarButtonRemovePageNumbers",
Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},gB=c(1461);class Xz{constructor(b,
h){this.JKa=b;this.aAa=h}JXn(b){this.JKa.Uzd(b)}ZCa(b){this.aAa.ZCa(b)}XOb(b,h){return this.aAa.XOb(b,h)}WOb(b,h){return this.aAa.WOb(b,h)}Nme(b,h,v){this.aAa.Nme(b,h,v)}}Object(n.a)(Xz,"ClientPaginationHeaderFooterBridge",null,[625]);class il{constructor(b,h){this.em=b;this.ga=h;this.eaa=new Ko.a;this.faa=new Ko.a}ZCa(b){b=he.GraphIterator.$a(b);if(b.Bp()&&b.Mp()){b.Pd();do 10===b.We&&this.XZf(b.currentNode),b.Bt();while(8!==b.We)}}XOb(b,h){var v=this.sFb(h);if(!this.eaa.mb(v))return u.ULS.sendTraceTag(573400388,
3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+v),!1;h=this.eaa.J(v);u.ULS.shipAssertTag(573400389,336,this.faa.mb(v),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");v=this.faa.J(v);return this.Sxf(h,b,v)}WOb(b,h){var v=this.sFb(h);if(!this.eaa.mb(v))return u.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+v),!1;h=
this.eaa.J(v);u.ULS.shipAssertTag(573400391,336,this.faa.mb(v),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");v=this.faa.J(v);return this.Plf(h,b,v)}Nme(b,h,v){h=this.$uf(h,v);this.ga.Qb(b?Nc.a.kpe:Nc.a.ecd,2,h)}$uf(b,h){h=this.em.AEb(h);if(!h)return u.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;h=this.em.Yga(h);const v=1===b;b=!(b%2);return 1===h?1:2===h?v?2:1:3===h?b?3:4:
v?2:b?3:4}XZf(b){if(10===b.type){var h=new Ko.a,v=this.em.AEb(b);u.ULS.shipAssertTag(573400393,336,!!v,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var D=this.em.Yga(v);b=this.sFb(b);this.rng(b,D);this.qng(b,h);v=he.GraphIterator.$a(v);if(v.Mp()){v.Pd();do b=v.currentNode,D=this.em.GOc(b),b=this.em.Sni(b),h.add(D,b),v.Bt();while(36===v.We)}}}rng(b,h){this.faa.mb(b)?this.faa.Z(b,h):this.faa.add(b,h)}qng(b,h){this.eaa.mb(b)?
this.eaa.Z(b,h):this.eaa.add(b,h)}sFb(b){u.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ia(Bc.a.Oia,0)}Sxf(b,h,v){const D=1===h;h=!(h%2);switch(v){case 2:if(D){if(b.mb(2))return b.J(2)}else if(b.mb(0))return b.J(0);break;case 3:if(h){if(b.mb(1))return b.J(1)}else if(b.mb(0))return b.J(0);break;case 4:if(D){if(b.mb(2))return b.J(2)}else if(h){if(b.mb(1))return b.J(1)}else if(b.mb(0))return b.J(0);break;case 1:if(b.mb(0))return b.J(0)}return!1}Plf(b,
h,v){const D=1===h;h=!(h%2);switch(v){case 2:if(D){if(b.mb(5))return b.J(5)}else if(b.mb(3))return b.J(3);break;case 3:if(h){if(b.mb(4))return b.J(4)}else if(b.mb(3))return b.J(3);break;case 4:if(D){if(b.mb(5))return b.J(5)}else if(h){if(b.mb(4))return b.J(4)}else if(b.mb(3))return b.J(3);break;case 1:if(b.mb(3))return b.J(3)}return!1}}Object(n.a)(il,"ClientPaginationPageAdornmentContentManager",null,[624]);class py{constructor(b,h,v,D,P,ca){this.z4k=ta=>{1===ta&&this.qE.vE&&(ta=this.Wc.Jva(this.qE.vE,
8,8),this.em.gTk(ta)?this.Ikl(ta):this.xwo())};this.ORo=ta=>{1===ta&&this.ga.Qb(Gb.a.openInClient,2,!1)};this.qE=b;this.em=h;this.Wc=v;this.Ic=D;this.euc=P;this.ga=ca}Mwo(){const b=new ug.StandardDialog;b.Ad=1;b.Ee(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);b.$U(0);b.Ou(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.z4k)}Ikl(b){b.jd(8);const h=this.Ic.Oc(15);h.set(b.wn.qj);this.euc.VZn(b);this.qE.dismiss();
h.dispose();u.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}xwo(){const b=new ug.StandardDialog;b.Ad=1;b.Ee(1,Box4Intl.Box4Strings.L_OpenInWord);b.Ee(0,CommonUIStrings.l_Close);b.$U(0);b.Ou(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,0,this.ORo);u.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(n.a)(py,"DeleteHeaderFooterDialog",null,[]);class bC{constructor(b,h,v,D,P){this.em=
b;this.Wc=h;this.Ic=v;this.euc=D;this.ga=P}create(b){return new py(b,this.em,this.Wc,this.Ic,this.euc,this.ga)}}Object(n.a)(bC,"DeleteHeaderFooterDialogFactory",null,[623]);class Kh{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb){this.M$=null;this.Yjg=(Ub,cc,Ac,Lc,id)=>{var vd=this.awf(cc);return vd?1===Ac?32:(Ac=this.control)?(cc=this.Ic.Oc(15),cc.Cb(vd),cc.jk=Ub,Ac.rba?this.ga.processAction(Nc.a.xT,2):(vd=this.pXh(vd),Lc.xs=vd?1:0,Lc=Ub!==Nc.a.ecd,(Ub=this.Nqf(Ub,id))&&Ac.Cya(Ub),this.ga.Qb(Nc.a.mJd,2,Lc)),
cc.dispose(),32):8:8};this.Qdf=(Ub,cc,Ac)=>{if(1===Ac)return 32;this.l1j.create(this.control).Mwo();return 32};this.AMn=(Ub,cc,Ac,Lc,id)=>1===Ac?32:(Ub=this.control)?(id[If.a.On]=Ub.rba,32):8;this.Kob=(Ub,cc,Ac,Lc,id)=>{if(1===Ac||!this.control.rba)return 32;cc=this.x$h(Ub,id);Ac=Kh.aki(this.control.vE);Lc=this.Ic.Oc(15);Lc.Cb(Ac);Lc.jk=Ub;Ub=this.Wc.Bk();Ub.set(Ac);this.KKa.Dif(Ub.currentNode,cc);this.em.WJb(Ub);this.euc.Wnj(Ub,cc);Lc.dispose();return 32};this.Cya=(Ub,cc,Ac,Lc,id)=>{if(1===Ac)return 32;
Ub=this.Nqf(Ub,id);this.control.rba&&this.control.Cya(Ub);return 32};this.pge=(Ub,cc,Ac,Lc,id)=>{if(1===Ac)return 32;Ub=this.pgi(Ub,id);Lc.xs=Ub;cc=this.awf(cc);if(!cc)return 8;Lc=this.Wc.Bk();Lc.set(cc);Lc.zb(8);Lc.mt(8);if(!this.Sk.ign(Lc,Ub))return 8;this.em.WJb(Lc);this.control.rga(Lc.currentNode);return 32};this.YZf=(Ub,cc,Ac,Lc,id)=>{if(1===Ac)return 32;Ub=this.xnk.yel(this.awf(cc));id.PopulationXML=Ub;return 32};this.cce=(Ub,cc,Ac,Lc,id)=>{Ub=this.x$h(Ub,id);cc=this.control.vE;Ac=this.em.Yga(cc);
id[If.a.On]=Ub===Ac;1===Ub&&(id[If.a.LabelText]=this.eli(cc)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.hbe=(Ub,cc,Ac,Lc,id)=>{if(1===Ac||!this.control.rba)return 32;cc=this.control.vE;void 0!==cc&&null!==cc&&(cc=this.em.Yga(cc),Ub=this.Nqf(Ub,id),Ac=this.control.$Tb,id[If.a.Visible]=this.tJo(Ub,cc),id[If.a.On]=Ub===Ac);return 32};this.PMn=(Ub,cc,Ac,Lc,id)=>{if(1===Ac||!this.control.rba)return 32;Ub=this.control.vE;
void 0!==Ub&&null!==Ub&&this.vFn(Ub,id);return 32};this.aMn=(Ub,cc,Ac,Lc,id)=>{if(1===Ac||!this.control.rba)return 32;Ub=this.pgi(Ub,id);cc=this.control.vE;Ac=0;void 0!==cc&&null!==cc&&(Ac=cc.getValue(Bc.a.Oia));id[If.a.On]=Ub===Ac;return 32};this.xT=(Ub,cc,Ac)=>{if(1===Ac)return 32;this.control.dismiss();return 32};this.AVd=()=>32;this.mJd=(Ub,cc,Ac,Lc,id)=>{if(1===Ac)return 32;this.control.show(id);return 32};this.Qkb=(Ub,cc,Ac,Lc,id)=>{if(1===Ac)return 32;if(!id)return 8;cc=id.k_a;if(!cc||!cc.isConnected)return 8;
Ub=this.em.OZc(cc);if(!({isHeader:Ac,Zig:cc}=this.em.wii(cc)).returnValue)return 8;this.control.rga(Ub);this.control.Cya(cc);this.control.show(Ac,id.oie);return 32};this.ga=b;this.em=h;this.euc=v;this.KKa=D;this.Sk=P;this.Wc=ca;this.Ic=ta;this.xnk=Ra;this.I5j=mb;this.l1j=Jb}get control(){return this.M$}set control(b){this.M$=b}Tb(){this.ga.qa(Nc.a.XWd,sc.a.view,this.Yjg);this.ga.eb(Nc.a.V1f,sc.a.application,this.AMn,96);this.ga.qa(Nc.a.kpe,sc.a.view,this.Yjg);this.ga.qa(Nc.a.ecd,sc.a.view,this.Yjg);
this.ga.eb(Nc.a.AVd,sc.a.view,this.AVd,64);this.ga.qa(Nc.a.mJd,sc.a.view,this.mJd);this.ga.eb(Nc.a.xT,sc.a.application,this.xT,96);this.ga.eb(Nc.a.Qkb,sc.a.application,this.Qkb,96);this.ga.eb(Nc.a.Ngo,sc.a.view,this.Cya,96);this.ga.qa(Nc.a.gkj,sc.a.view,this.Cya);this.ga.qa(Nc.a.ikj,sc.a.view,this.Cya);this.ga.qa(Nc.a.hkj,sc.a.view,this.Cya);this.ga.qa(Nc.a.jkj,sc.a.view,this.Cya);this.ga.eb(Nc.a.dko,sc.a.view,this.Kob,100);this.ga.eb(Nc.a.Rlj,sc.a.view,this.Kob,4);this.ga.eb(Nc.a.Qlj,sc.a.view,this.Kob,
4);this.ga.eb(Nc.a.Olj,sc.a.view,this.Kob,4);this.ga.eb(Nc.a.Plj,sc.a.view,this.Kob,4);this.ga.qa(Nc.a.pge,sc.a.view,this.pge);this.ga.qa(Nc.a.bag,sc.a.view,this.pge);this.ga.eb(Nc.a.YZf,sc.a.view,this.YZf,96);this.ga.eb(Nc.a.Qdf,sc.a.view,this.Qdf,4);this.ga.eb(Nc.a.u5i,sc.a.view,this.hbe,97);this.ga.eb(Nc.a.w5i,sc.a.view,this.hbe,97);this.ga.eb(Nc.a.v5i,sc.a.view,this.hbe,97);this.ga.eb(Nc.a.x5i,sc.a.view,this.hbe,97);this.ga.eb(Nc.a.N5i,sc.a.view,this.cce,97);this.ga.eb(Nc.a.M5i,sc.a.view,this.cce,
97);this.ga.eb(Nc.a.K5i,sc.a.view,this.cce,97);this.ga.eb(Nc.a.L5i,sc.a.view,this.cce,97);this.ga.eb(Nc.a.uMn,sc.a.view,this.PMn,97);this.ga.eb(Nc.a.r1f,sc.a.view,this.aMn,97)}pXh(b){const h=this.em.AEb(b),v=this.em.Yga(h);b=this.KKa.Dif(b,v);this.control.rga(h);return b}x$h(b,h){switch(b){case Nc.a.Rlj:case Nc.a.N5i:b=1;break;case Nc.a.Qlj:case Nc.a.M5i:b=2;break;case Nc.a.Olj:case Nc.a.K5i:b=3;break;case Nc.a.Plj:case Nc.a.L5i:b=4;break;default:b=h}return b}Nqf(b,h){switch(b){case Nc.a.gkj:case Nc.a.u5i:b=
1;break;case Nc.a.ikj:case Nc.a.w5i:b=2;break;case Nc.a.hkj:case Nc.a.v5i:b=3;break;case Nc.a.jkj:case Nc.a.x5i:b=4;break;case Nc.a.kpe:case Nc.a.ecd:b=h;break;case Nc.a.XWd:b=0;break;default:b=h}return b}pgi(b,h){return b===Nc.a.bag||b===Nc.a.r1f?parseInt(h.MenuItemId):h}awf(b){return this.Sk.v8(b.gk)}tJo(b,h){switch(h){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}vFn(b,h){const v=this.eli(b);if(h[ln.a.Visible]=v)b=this.Sk.bki(this.I5j(b)),
b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),h[ln.a.LabelText]=b}eli(b){const h=this.Wc.Bk();h.set(b);h.zb(8);h.mt(8);return 1<this.Sk.wvf(h)}static aki(b){const h=new he.GraphIterator;h.set(b);h.zb(10);return Et.WordSectionNavigator.u9n(h)}}Object(n.a)(Kh,"HeaderFooterActor",null,[]);var Nw=c(786),mz=c(698);class ts{constructor(b,h,v,D,P){this.Eck=b;this.em=h;this.Sk=v;this.Wc=D;this.ga=P}bXh(b,h){this.em.WJb(b);h=this.xwl(b,h);b.wc();return h}Dif(b,h){b=
this.Wc.Jva(b,8,8);let v=!1;this.Sk.FOa(b,D=>{const P=this.Wc.Bk();P.set(D);v=(D=this.bXh(P,h))||v;return D});return v}xwl(b,h){if(3!==this.ga.mode)return!1;let v=!1;h=mz.a.Gef(h);for(let D=0;D<h.length;++D)v=this.Eck.wwl(b,h[D])||v;return v}}ts.ojl=1;Object(n.a)(ts,"HeaderFooterInserter",null,[618]);class Kd{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub){this.Dfh=this.PSg=!1;this.vE=null;this.TFe=!1;this.$Tb=0;this.zKb=()=>{this.TFe=!0};this.g6=b;b.bind(this);this.RWe=D;this.L1j=mb;this.p9g=P;this.xdk=
ca;this.gab=ta;this.header=h;this.footer=v;this.header.Dfl();this.g6.Fz();this.YUe=ts.ojl;this.KKa=Ra;Kd.ga=Jb;this.wN=Ub}get rba(){return this.PSg}show(b=!0,h=!0){this.rba||(this.rIj(),this.nlj(!0),this.header.ZUn(),this.L1j(),this.tDo(),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Noa&&(Rh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new Nw.a,{state:0,disablePopover:!0}))):u.ULS.sendTraceTag(509384032,3023,15,"Showing header/footer overlay and appChrome is not ready")));
(this.Dfh=h)&&this.p9g(b)}dismiss(b=!1){this.rba&&(this.xdk(b),this.nlj(!1),this.qCb(),this.$Tb=0,this.AEo(),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Noa&&(Rh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new Nw.a,{disablePopover:!1}))):u.ULS.sendTraceTag(509384031,3023,15,"Dismissing header/footer overlay and appChrome is not ready")))}nlj(b){this.PSg=b;Kd.ga.processAction(Gb.a.lmf,2);this.g6.V0(b);this.header.V0(b);this.footer.V0(b);this.RWe()}rga(b){this.vE!==
b&&(this.vE=b,this.header.rga(b),this.footer.rga(b),this.$Tb=0,this.Kob(this.gab.Yga(b)))}qCb(){this.vE&&(this.header.Rfb(),this.footer.Rfb(),this.vE=null)}update(){this.rba&&this.XQb()}XQb(){this.vE&&(this.gab.asl(this.vE)&&this.gab.Gsm(this.vE)?this.rIj():this.dismiss())}rIj(){const b=this.gab.Yga(this.vE);b!==this.YUe&&this.Kob(b)}Kob(b){this.YUe=b;this.Cya(this.vgm(b))}vgm(b){switch(b){case 2:return 2;case 3:return 3;case 4:return 2}return 1}Cya(b,h=!0){this.$Tb!==b&&(this.KKa.Dif(this.vE,this.YUe),
this.header.fkj(b),this.header.Pvh(xk.AppFrame.Tba),this.footer.fkj(b),this.footer.Pvh(xk.AppFrame.Aba),this.$Tb=b,this.rba&&this.Dfh&&this.dxl(h))}dxl(b){this.p9g(b);b?this.header.setInitialSelection():this.footer.setInitialSelection()}dispose(){this.g6.j$();this.header.dispose();this.footer.dispose()}tDo(){this.wN.dEc(this.zKb);this.TFe=!1}AEo(){this.wN.Pde(this.zKb);this.TFe&&Kd.ga.processAction(Nc.a.AVd,2)}static lpl(){Kd.ga.Qb(Wa.a.Jib,2,!0);Kd.ga.processAction(Nc.a.D3,2)}}Kd.ga=null;Object(n.a)(Kd,
"HeaderFooterControl",null,[665,10]);class qy{constructor(b,h,v,D,P){this.RWe=b;this.gab=h;this.KKa=v;this.ga=D;this.wN=P}create(b,h,v,D,P){return new Kd(b,h,v,this.RWe,D,P,this.gab,this.KKa,Kd.lpl,this.ga,this.wN)}}Object(n.a)(qy,"Factory",null,[622]);class Fi{constructor(){this.M$=null}get control(){return this.M$}set control(b){this.M$=b}Vmf(b){return this.Wmf(this.control.vE,this.control.$Tb,b.isHeader,b)}Wmf(b,h,v,D){return()=>{if(!b.isConnected)return null;this.control.rga(b);this.control.Cya(h);
this.control.show(v);return D}}dismiss(){this.M$.rba&&this.M$.dismiss()}}Object(n.a)(Fi,"HeaderFooterControlLauncher",null,[]);var cC=c(1154),VC=c(646),zo=c(270),Yz=c(809);class pv{constructor(b,h,v){this.Xlc=null;const D=h?"Header":"Footer";this.Er=b.ownerDocument.createElement("div");this.Er.id=h?"HeaderPane":"FooterPane";this.Er.classList.add(pv.Jsm,D);this.Nyb=(new Yz.a(this.Er,"WACViewPanel_"+D)).gI;this.Er.appendChild(this.Nyb);b.appendChild(this.Er);h&&(this.Xlc=b.ownerDocument.createElement("div"),
this.Xlc.classList.add(pv.Osm),this.Er.appendChild(this.Xlc));this.ILg=v.G7l(this.Er)}bind(){}V0(b){b?this.ILg.PCk():this.ILg.RCk()}fLk(b){b.Xzb(this.Nyb)}}pv.Osm="HeaderToolbarContainer";pv.Jsm="HeaderFooterPane";Object(n.a)(pv,"PaneControlDom",null,[693]);class Qu{constructor(b,h,v,D,P){this.qE=this.Pq=null;this.vWi=()=>{this.qE.dismiss(!0);if(this.bVb){const ca=new oh.a(!0);this.bVb.XGa(ca)}return!0};this.OB=ca=>{ca.Hb.preventDefault();return!1};this.Er=b.ownerDocument.createElement("div");this.Er.id=
Qu.eJh;this.Er.className=Qu.eJh;this.DZ=D;this.bVb=P;this.Qni=new pv(this.Er,!0,h);this.idl(this.Er);this.K1h=new pv(this.Er,!1,h);this.V0(!1);b.appendChild(this.Er)}idl(b){this.Pq=b.ownerDocument.createElement("div");this.Pq.id=Qu.lzn;this.Pq.className=Qu.jzn;this.Pq.tabIndex=0;this.Pq.setAttribute(cf.a.qh,cf.a.j3);this.Pq.setAttribute(cf.a.yfa,WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);b.appendChild(this.Pq)}bind(b){this.qE=b}V0(b){if(!b&&this.DZ){var h=new oh.a(!0);this.DZ.XGa(h)}!b&&
this.bVb&&(h=new oh.a(!0),this.bVb.XGa(h));this.Er.style.display=b?"":"none";this.Qni.V0(b);this.K1h.V0(b)}xjo(){this.Pq.focus()}Fz(){Th.a.instance.nb(Ed.a.click,this.Pq,this.vWi);xf.a.instance.nb(Ed.a.Ox,this.Er,this.OB)}j$(){Th.a.instance.sc(Ed.a.click,this.Pq,this.vWi);xf.a.instance.sc(Ed.a.Ox,this.Er,this.OB)}}Qu.eJh="HeaderFooterControl";Qu.lzn="HeaderFooterOverlay";Qu.jzn="EditingSurfaceOverlay HeaderFooterOverlay";Object(n.a)(Qu,"HeaderFooterControlDom",null,[661]);class st{constructor(b,h,
v,D,P,ca,ta,Ra,mb,Jb){this.g6=null;this.ra=new Mc.a;this.qE=this.Wtd=null;this.qUf=Ub=>{this.O9(Ub);this.ra.raiseEvent("OnShowEventKey")};this.pUf=Ub=>{this.lf&&(this.Wtd=new cC.a(this.lf));this.Ub.lJc(xk.AppFrame.Tba);this.Ub.lJc(xk.AppFrame.Aba);this.mda(Ub);this.ra.raiseEvent("OnDismissEventKey")};this.M9d=()=>{this.Wtd&&(this.Wtd.dispose(),this.Wtd=null)};this.Ub=b;this.fp=h;this.bah=v;this.j6j=D;this.ofk=P;this.ga=ca;this.pQg=VC.a.create();this.lUg=Xb.KeyInputManager.jc(Ve.a.Fs,0);this.tZ=Xb.KeyInputManager.jc(Ve.a.A1,
0);this.mlk=Xb.KeyInputManager.jc(Ve.a.QIa,0);this.xI=ta;this.Fa=Ra;this.DZ=mb;this.bVb=Jb;this.lf&&this.lf.Pla(this.M9d)}Qqh(b){this.ra.addHandler("OnShowEventKey",b)}w2n(b){this.ra.removeHandler("OnShowEventKey",b)}Uzd(b){this.ra.addHandler("OnDismissEventKey",b)}Ebj(b){this.ra.removeHandler("OnDismissEventKey",b)}get lf(){const b=this.xI.value;return b?b.Wi?b:(u.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(u.ULS.sendTraceTag(25474003,
317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.qE}get T6k(){return this.pQg}bind(b){this.qE=this.a5k(b);this.pQg.instance=this.qE}a5k(b){this.g6=new Qu(b,this.ofk.value,this.Fa,this.DZ,this.bVb);b=this.bah.value.create(this.ga,this.g6.Qni,!0,xk.AppFrame.Tba);const h=this.bah.value.create(this.ga,this.g6.K1h,!1,xk.AppFrame.Aba);this.qE=this.j6j.value.create(this.g6,b,h,this.qUf,this.pUf);this.fAf();this.dT();return this.control}fAf(){var b=3===this.ga.mode?
xk.AppFrame.JD:xk.AppFrame.hhc;const h=this.Ub.fe(xk.AppFrame.Tba);h.parent=b;this.Ub.sZe(xk.AppFrame.Tba);const v=this.Ub.fe(xk.AppFrame.Aba);v.parent=b;this.Ub.sZe(xk.AppFrame.Aba);b=this.Ub.fe(zo.a.gGb);b.parent=Ne.AFrame.rp;b.pfa(()=>{this.g6.xjo()});b.bindAction(this.lUg,Nc.a.xT);b.bindAction(this.tZ,Nc.a.xT);b.bindAction(this.mlk,Nc.a.xT);h.bindAction(this.tZ,Nc.a.xT);v.bindAction(this.tZ,Nc.a.xT)}dT(){this.fp.dT(xk.AppFrame.Tba);this.fp.dT(zo.a.V1a);this.fp.dT(xk.AppFrame.Aba);this.fp.dT(zo.a.gGb)}O9(b){this.fp.FI(xk.AppFrame.Tba);
this.fp.FI(zo.a.V1a);this.fp.FI(xk.AppFrame.Aba);this.fp.FI(zo.a.gGb);this.fp.Xw(Ne.AFrame.Pn);this.Ub.CDc(xk.AppFrame.Tba);this.Ub.CDc(xk.AppFrame.Aba);b?this.Ub.mg(xk.AppFrame.Tba):this.Ub.mg(xk.AppFrame.Aba)}mda(b){this.fp.Xw(xk.AppFrame.Tba);this.fp.Xw(zo.a.V1a);this.fp.Xw(xk.AppFrame.Aba);this.fp.Xw(zo.a.gGb);this.fp.FI(Ne.AFrame.Pn);(b||this.Ub.currentScope&&(this.Ub.currentScope.name===xk.AppFrame.Tba||this.Ub.currentScope.name===zo.a.V1a||this.Ub.currentScope.name===xk.AppFrame.Aba||this.Ub.currentScope.name===
zo.a.gGb))&&this.Ub.mg(Ne.AFrame.Pn)}dispose(){const b=this.Ub.fe(zo.a.gGb);b.jr(this.lUg);b.jr(this.tZ);this.Ub.fe(xk.AppFrame.Tba).jr(this.tZ);this.Ub.fe(xk.AppFrame.Aba).jr(this.tZ);this.lf&&this.lf.Rde(this.M9d);this.control.dispose()}}Object(n.a)(st,"HeaderFooterControlOwner",null,[620,621]);var xx=c(1100);class bp{constructor(b,h,v,D,P,ca,ta,Ra){this.Aaa=b;this.jmk=h;this.ove=v;this.fm=D;this.Rek=P;this.Gkk=ca;this.Z5j=ta;bp.nh=Ra}jCm(b,h){this.jmk(b,1,3,null,!1);this.Aaa.FOb(Ys.a.Wpg,1696,
b.currentNode);this.ove(b,0,this.fm?3:1,h);this.ove(b,1,2,h);this.ove(b,2,this.fm?1:3,h);this.Rek(b);this.Gkk(b,!1,!0,null);this.Z5j(b,h)}static get lE(){return null!=bp.KJg?bp.KJg:bp.KJg=Ea.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get paragraphEditor(){return null!=bp.HFg?bp.HFg:bp.HFg=Ea.a.instance.resolve("Box4.IParagraphEditor")}static Iho(b,h,v){ch.moveToCellContent(b,0,h);hf.OutlineElementNavigator.Ge(b);bp.lE.M7c(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);bp.paragraphEditor.gE(b.currentNode,
v);h||bp.paragraphEditor.jq.Fya(b,1,-115);2===h&&bp.paragraphEditor.jq.qOb(b.currentNode,1,-115);ch.returnToContainingTable(b)}static bko(b,h){hf.OutlineElementNavigator.Ge(b);bp.lE.M7c(h?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,b.currentNode);hf.OutlineElementNavigator.Vd(b)}static jQl(){return(b,h,v)=>{bp.Iho(b,h,v)}}static uZl(){return(b,h)=>{bp.bko(b,h)}}static Dfm(b){return(h,v,D,P,ca)=>b.nDa(h,v,D,P,ca)}static xdm(){return(b,h,v,D,P)=>bp.nh.xz(b,h,v,D,P)}}
bp.nh=null;Object(n.a)(bp,"HeaderFooterDefaultTableInserter",null,[619]);class ry{constructor(b,h,v,D){this.em=b;this.Tqd=h;this.Wc=v;this.Sk=D}Wnj(b,h){b.wn.properties.setValue(Bc.a.rxf,2===h||4===h);b.zb(8);b.Jbd(8).properties.setValue(Bc.a.iVd,3===h||4===h)}VZn(b){this.Sk.FOa(b,h=>{const v=this.Wc.Bk();v.set(h);this.em.WJb(v);this.Wnj(v,1);this.WZn(v);return!0})}WZn(b){for(;b.Pd();)b.xg()}}Object(n.a)(ry,"HeaderFooterEditor",null,[617]);var qv=c(1106);class hB extends Mu.a{constructor(b){super();
this.TWe=b}get index(){return 0}run(){this.TWe()}Fsm(b,h){h.property===Bc.a.rxf&&this.SJ()}Gzn(b,h){h.property===Bc.a.iVd&&this.SJ()}SJ(){this.qY()}}Object(n.a)(hB,"ControlUpdateNeededTracker",Mu.a,[]);class yx{constructor(b,h,v,D,P,ca){this.T9a=null;this.k6j=v;this.ykd=h;this.IVb=b;this.efk=D;this.HLa=ca}start(){this.IVb.bind(Xa.App.xa.kD);this.ykd.control=this.IVb.control;this.ykd.Tb();this.k6j.control=this.IVb.control;this.efk.value.create(this.IVb.control,Object(z.a)(this.ykd,this.ykd.pXh,"ensureSectionHeaderFooterAttachedToControl")).Tb();
this.hum()}hum(){this.T9a=new hB(()=>{this.IVb.control.update()});const b=Xa.App.Xj.zl;b.Ze(35).Go(Object(z.a)(this.T9a,this.T9a.Fsm,"headerFooterContainerNodePropertyChanged"));b.Ze(8).Go(Object(z.a)(this.T9a,this.T9a.Gzn,"pageContentNodePropertyChanged"));qv.a.kde(Object(z.a)(this.T9a,this.T9a.SJ,"setUpdateNeeded"));oo.GraphTransactionManager.instance.nqa(this.T9a,3)}dispose(){this.IVb.dispose();this.HLa.JSh()}}Object(n.a)(yx,"HeaderFooterManager",null,[]);class zx{constructor(b,h,v,D){this.Sk=
b;this.em=h;this.Dck=v;this.aye=D}wwl(b,h){let v=!1;const D=mz.a.tsf(h);b.Rr(D)||(this.tCm(b,h),this.aye.iCm(b.currentNode,h),v=!0);return v}tCm(b,h){const v=this.Dck.create(1074135123),D=b.currentNode.ia(Bc.a.Oia,0);v.properties.setValue(Bc.a.Oia,D);v.properties.setValue(Bc.a.L9b,h);h=mz.a.tsf(h);b.Af(v,h)}}Object(n.a)(zx,"HeaderFooterNodeLevelInserter",null,[614]);var Zz=c(223),Ax=c(386);class ew extends Zz.a{constructor(b,h,v){super(b,h,"","");this.lwb=null;this.aoi=ew.NPh;this.qRc=[];this.sDe=
v}get YA(){return!0}get cssClass(){return"cui-herodock"}ym(){this.SUn();super.ym()}mOa(){for(const b of this.qRc)b.zKd();super.mOa()}nCo(){let b,h,v;b=[];h=[];v=[];for(let D=0;D<this.qRc.length;D++){const P=this.qRc[D];P.visible?b.length<this.aoi?b.push(P):Object(rb.a)(Ax.FlyoutAnchor,P)?Array.addRange(h,P.bTl()):h.push(P):v.push(P)}return{uMo:b,hzn:h,qFm:v}}hdl(b){if(!b||!b.length)return null;const h=new ke.Menu(this.root,this.id+"OverflowMenu",null,null,null),v=new Mk.a(this.root,this.id+"OverflowMenuSection",
null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},h);for(const D of b)v.Af(D.BQ("Menu20"));h.Af(v);return h}SUn(){this.Ade();this.Nc=Cg.a.ASa(this.Nc);this.GC();var b;({uMo:v,hzn:b,qFm:D}=this.nCo());for(var h of v){var v=h.BQ("Medium20");v.enabled=!0;this.q0b(v,this.children.count);this.Nc.appendChild(v.Nc);v.fna()}if(b=this.hdl(b))this.lwb?this.lwb.menu=b:(h=this.id+"OverflowMenuLauncher",v={},v.Image20by20=this.sDe.OverflowMenuImage20by20,v.Image20by20Class=this.sDe.OverflowMenuImage20by20Class,
v.PopulateDynamically="false",v.HideDefaultArrow="true",v.Alt=this.sDe.OverflowMenuTooltip,v.Command="798637440",v.Id=h,this.lwb=new Ax.FlyoutAnchor(this.root,h,v,b)),b=this.lwb.BQ("Small20"),b.enabled=!0,this.q0b(b,this.children.count),this.Nc.appendChild(b.Nc),b.fna();if(w.AFrameworkApplication.K.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const P of D){var D=P.BQ("Medium20");this.Af(D);D.fna()}}dispose(){this.lwb&&(this.lwb.dispose(),this.lwb=null);for(const b of this.qRc)b.dispose();
this.Ade();super.dispose()}set YA(b){super.YA=b}}ew.NPh=4;Object(n.a)(ew,"HeroDock",Zz.a,[]);var rv=c(595);class $z extends rv.a{constructor(){super();this.Pke=this.JPm=this.cEo=!1;this.Jbn=w.AFrameworkApplication.NEf?1:ew.NPh}}Object(n.a)($z,"ToolbarBuildOptions",rv.a,[]);var Pi=c(45),aA=c(866),dC=c(706);class sy extends Zz.a{constructor(b,h,v){super(b,h,"","");this.Soc=v.Alignment;this.uTg=v.ScalingDirection===Pi.a.$Oj}ym(){this.nva();this.QW(this.Nc);super.ym()}QW(b){for(let h of this.children){h.GC();
switch(this.Soc){case Pi.a.Nqe:Cg.a.Yf(h.Nc,"cui-toolbar-button-left");break;case Pi.a.J8a:Cg.a.Yf(h.Nc,"cui-toolbar-button-center");break;case Pi.a.cSb:Cg.a.Yf(h.Nc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.Soc);}h.visible&&b.appendChild(h.Nc);h.fna()}}wO(b){if(!Object(rb.a)(ao.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");}get cssClass(){switch(this.Soc){case Pi.a.Nqe:return"cui-toolbar-buttondock alignleft";case Pi.a.J8a:return"cui-toolbar-buttondock aligncenter";
case Pi.a.cSb:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.Soc);}}get YA(){return!0}get alignment(){return this.Soc}p9b(){let b=0;if(this.alignment===Pi.a.J8a)for(let h of this.children){const v=h;v.visible&&(b+=v.Nc.offsetWidth)}else b=this.Nc.offsetWidth;return b}xSd(){let b=null;if(this.alignment===Pi.a.J8a)for(let h of this.children){if(h.visible){b=Sys.UI.DomElement.getBounds(h.Nc);break}}else b=Sys.UI.DomElement.getBounds(this.Nc);return b?0===this.root.h1?
b.x:b.x+b.width:0}uPd(){let b=null;if(this.alignment===Pi.a.J8a){if(0<this.children.count){const h=this.children.vPd(this.children.count-1);for(;h.t4a();){const v=h.get_current();if(v.visible){b=Sys.UI.DomElement.getBounds(v.Nc);break}}}}else b=Sys.UI.DomElement.getBounds(this.Nc);return b?0===this.root.h1?b.x+b.width:b.x:0}xif(){for(let b of this.children){const h=b;if(!Object(rb.a)(ao.a,h)||h.control.visible)h.visible=!0}}Gbo(b){const h=this.children.toArray(),v=new dC.a;let D=this.uTg?0:h.length-
1;const P=this.children.count,ca=this.root.JTa;for(;this.p9b()>=b&&!(D>=P||0>D);){const ta=h[D];ca&&Object(rb.a)(ao.a,ta)&&ta.control.visible&&(v.add(ta),ta.buh());D+=this.uTg?1:-1}for(let ta of v)ta.haj(),ta.visible=!1}set YA(b){super.YA=b}}Object(n.a)(sy,"ButtonDock",Zz.a,[]);class Bx extends bk.a{constructor(b,h,v,D,P,ca,ta=!1){super(b,h,ca);this.Xra=this.dZ=this.ula=null;this.ZKe=!1;this.t3a=D;this.Pke=P;this.Ywd=0;nf.c(h.Size)||(h.Size===Pi.a.vtg||v.options.JPm?this.Ywd=0:h.Size===Pi.a.mSj&&
(this.Ywd=1));this.ynk=ta}get JTa(){return!0}Af(b){super.Af(b);Object(rb.a)(sy,b)&&!this.ZKe&&(b.alignment===Pi.a.Nqe?(this.ula&&this.wbg(),this.ula=b):b.alignment===Pi.a.J8a?(this.dZ&&this.wbg(),this.dZ=b):b.alignment===Pi.a.cSb&&(this.Xra&&this.wbg(),this.Xra=b))}wbg(){this.ZKe=!0;this.Xra=this.dZ=this.ula=null}sob(b,h){b=this.YNc(b);nf.c(b)||b.visible===h||(b.visible=h,this.refresh())}ym(){super.ym();this.W8i(!0)}W8i(b){const h=this.root.jBb;nf.c(this.Nc)&&this.Efl();this.Nc=Cg.a.ASa(this.Nc);
this.rRc&&this.Nc.appendChild(this.rRc);for(let v of this.children)v.visible&&(v.GC(),this.Nc.appendChild(v.Nc),v.fna());this.dZ&&b&&this.Uvl();h&&h.FY();this.dirty=!1}Uvl(){if(this.dZ.visible&&this.dZ.children.count&&(this.nuh(0,0),this.$rl(this.ula,this.dZ,this.Xra))){let b=0,h=0;const v=this.ula?this.ula.p9b():0,D=this.Xra?this.Xra.p9b():0;if(0<D||0<v)D>v?(b=0,h=D-v):(b=v-D,h=0);this.nuh(b,h)}}$rl(b,h,v){let D=!1;0===this.root.h1?(b&&(D=b.uPd()>h.xSd()),!D&&v&&(D=h.uPd()>v.xSd())):(b&&(D=b.uPd()<
h.xSd()),!D&&v&&(D=h.uPd()<v.xSd()));return D}nuh(b,h){0===this.h1?(this.dZ.Nc.style.marginLeft=b+"px",this.dZ.Nc.style.marginRight=h+"px"):(this.dZ.Nc.style.marginRight=b+"px",this.dZ.Nc.style.marginLeft=h+"px")}Efl(){this.GC()}ou(){this.CTh(()=>{xw.a.prototype.ou.call(this)})}Npa(b){b=this.YNc(b);nf.c(b)||this.CTh(Object(z.a)(b,b.xm,"pollForStateAndUpdate"))}CTh(b){this.pec=this.w4a=!1;b();if(this.w4a||this.pec)this.ynk||this.refresh(),this.scale()}wO(b){if(!Object(rb.a)(ew,b)&&!Object(rb.a)(sy,
b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(rb.a)(sy,b)&&b.alignment===Pi.a.J8a)for(let h of this.children)if(h.alignment===Pi.a.J8a)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b="cui-toolbar-toolbar ";0===this.Ywd?(b+="cui-toolbar-onerow ",w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.T8||(b+="UITextTranformUpperCase ")):1===this.Ywd&&(b+="cui-toolbar-singledock ");
return b+super.cssClass}get ava(){return"div"}get J9(){return 26}get wAj(){return this.eO}set wAj(b){this.eO=b}c$k(b){b=b[Pi.a.Ew];return new sy(this.root,b.Id,b)}GC(){super.GC();this.Nc.setAttribute("role","toolbar");this.properties.Title&&this.Nc.setAttribute("title",this.properties.Title)}MIa(b){return this.root&&this.root.khc(b)?!0:!1}Ajo(){this.bTa()}scale(){super.scale();if(!Cg.a.Vr(this.properties.Scale)||this.ZKe)return!1;nf.c(this.ula)||(this.ula.visible=!0,this.ula.xif());nf.c(this.dZ)||
(this.dZ.visible=!0,this.dZ.xif());nf.c(this.Xra)||(this.Xra.visible=!0,this.Xra.xif());this.W8i(!1);const b=this.Nc.offsetWidth,h=nf.c(this.ula)?0:this.ula.p9b(),v=nf.c(this.dZ)?0:this.dZ.p9b(),D=nf.c(this.Xra)?0:this.Xra.p9b();D+v+h>=b&&(D+h>=b?(this.foi(this.dZ),D>=b?(this.foi(this.ula),this.x9f(this.Xra,b)):this.x9f(this.ula,b-D)):this.x9f(this.dZ,b-D-h));this.w4a=!1;this.ym();return!1}foi(b){b&&(b.visible=!1)}x9f(b,h){b&&b.Gbo(h)}}Object(n.a)(Bx,"Toolbar",bk.a,[838]);class bA extends Bx{constructor(b,
h,v,D,P=!1){super(b,h,v,!1,!1,D,P);this.S4g=!0}get J9(){return 7}get cssClass(){return bA.dEo+" "+super.cssClass}static get dEo(){let b="cui-statusbar";w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.T8||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(n.a)(bA,"StatusBar",Bx,[]);var nz=c(478);class Cx extends nz.a{constructor(){super();this.toolbar=null;this.U_d=!1}}Object(n.a)(Cx,"ToolbarBuildContext",nz.a,[]);class tt extends Se.Builder{constructor(b,h,v,D){super(b,h,gk.Task.P3(v),
D);if(nf.c(h))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}Dcg(b){this.root=b}get ikg(){return this.options}RPk(){const b=new Cx,h=new aA.a;h.id="toolbar";h.z3c=1;h.handler=Object(z.a)(this,this.gun,"onReturnToolbarData");h.data=b;this.Qua.sfe(h)}gun(b){this.Dcg(this.TPk(b.U2c,b.RHc));this.toolbar.wAj=this;this.toolbar.ym();this.placeholder.appendChild(this.toolbar.Nc);Cg.a.Yf(this.placeholder,"loaded");this.bua.continueWith(()=>{this.bua.result.xKb(this.toolbar)},
11)}TPk(b,h){var v=Pi.a.Oga(b,Pi.a.ZSj);nf.c(v)&&(v=Pi.a.Oga(b,Pi.a.tSj),h.U_d=!0);if(nf.c(v))throw Error.create("No toolbar element was present in the data");b=new Pi.a(v);v=w.AFrameworkApplication.K.$("ToolbarScalingRedundancyEliminationIsEnabled");h.U_d?this.Dcg(new bA(b.attributes[Pi.a.id],b.attributes,this,this.raa,v)):this.Dcg(new Bx(b.attributes[Pi.a.id],b.attributes,this,this.ikg.cEo,this.ikg.Pke,this.raa,v));this.toolbar.jua=this.options.jua;this.toolbar.Ioe=!0;this.toolbar.ym();b=Pi.a.rw(Pi.a.Oga(b.node,
Pi.a.IOj));h=this.vNk(b,h);for(const D of h)this.toolbar.Af(D);return this.toolbar}vNk(b,h){const v=[];for(let D=0;D<b.length;D++)this.sQa(b[D])||Array.add(v,this.ZNk(b[D],h));return v}ZNk(b,h){const v=Pi.a.hPc(b);let D=null;v===Pi.a.iNj?D=this.ENk(b,h):v===Pi.a.pPj&&(D=this.wOk(b,h));return D}wOk(b,h){var v=new Pi.a(b);v=new ew(this.root,v.attributes[Pi.a.id],b[Pi.a.Ew]);v.aoi=this.ikg.Jbn;b=Pi.a.Oga(b,Pi.a.Zqb);b=Pi.a.rw(b);const D=[];for(let ca=0;ca<b.length;ca++){var P=b[ca];this.sQa(P)||(P=this.Hfa(P,
h),Array.add(D,P))}v.qRc=D;return v}ENk(b,h){new Pi.a(b);const v=this.toolbar.c$k(b);b=Pi.a.Oga(b,Pi.a.Zqb);b=Pi.a.rw(b);for(let D=0;D<b.length;D++){if(this.sQa(b[D]))continue;const P=this.SPk(b[D],h);v.Af(P)}return v}SPk(b,h){var v=new Pi.a(b);const D=v.name;v=v.attributes[Pi.a.Snc];let P;P=h.U_d?"Small14":"Small";switch(D){case Pi.a.button:return b=this.Hfa(b,h),b.BQ(nf.b(v)?P:v);case Pi.a.aEa:return P=h.U_d?"Medium14":"Medium",b=this.Hfa(b,h),b.BQ(nf.b(v)?P:v);case Pi.a.label:return b=this.Hfa(b,
h),b.BQ(nf.b(v)?P:v);case Pi.a.separator:return b=this.Hfa(b,h),b.BQ("Small");case Pi.a.toggleButton:return b=this.Hfa(b,h),b.BQ(nf.b(v)?P:v);default:throw Error.create("Invalid control type.");}}}Object(n.a)(tt,"ToolbarBuilder",Se.Builder,[]);var ty=c(1473);class oz{constructor(b,h,v,D,P,ca){this.emb=()=>{this.toolbar.xm()};this.lI=b;b=new tn.CuiHelper(Ic.a.BZa,WordEditorIntl.WordEditorStrings,null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);D=new $z;D.UG={};ca=3!==ca.mode;D.UG.HeaderToolbarControlsRight=
ca;D.UG.HeaderToolbarButtonDockRight=ca;D.UG.HeaderToolbarButtonRemovePageNumbers=ca;P=new tt(D,this.lI,this,P);P.Qua=new ty.a(oz.Psm,b);P.RPk();this.Fla=P.toolbar;v.execute(ta=>{this.toolbar.xF=ta});this.toolbar.refresh();this.toolbar.xm();this.Jh=h;h.eZa(this.emb)}get toolbar(){return this.Fla}dispose(){this.Jh.yhc(this.emb);this.toolbar&&(this.toolbar.dispose(),this.Fla=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.Ajo()}kpl(){this.toolbar.C3()}xKb(){}}oz.Psm="WordEditorHeaderToolbarData";
Object(n.a)(oz,"HeaderFooterToolbar",null,[128,659]);class xu{constructor(b,h,v,D,P){this.Jh=b;this.pxe=h;this.ld=v;this.raa=D;this.ga=P}create(b){return new oz(b,this.Jh,this.pxe,this.ld,this.raa,this.ga)}}Object(n.a)(xu,"Factory",null,[615]);class pz{constructor(b,h){this.Wc=b;this.Sk=h}yel(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+this.xel(b)+"</Controls></MenuSection></Menu>"}eZl(b){const h=
this.Wc.Bk();h.set(b);h.zb(8);h.jd(8);return h}xel(b){if(!b)return"";let h="";b=this.eZl(b);this.Sk.FOa(b,v=>{const D=this.Sk.bki(v);v=v.getValue(Bc.a.Oia);h+=Ii.k(v.toString(),v.toString(),Nc.a.bag.toString(),Nc.a.r1f.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,D));return!0});return h}}Object(n.a)(pz,"HeaderFooterToolbarGenerator",null,[613]);var cA=c(123);class iB extends ky.a{constructor(b,h,v,D,P,ca,ta,Ra){super(b,h,v,D);this.Zs=()=>{this.ebd(this.Bb)};
this.lI=b.container;this.Yv=document.createElement("div");this.NG(this.Yv);this.lBa=P;this.zKa=ca;this.wo.execute(mb=>{mb.M0(this.Zs)});this.vK=ta;if(this.uI=Ra)this.lI.style.backgroundColor=this.vK.y8b()}dispose(){super.dispose();this.wo.instance&&this.wo.instance.Q5a(this.Zs)}get wo(){return null!=this.DAg?this.DAg:this.DAg=Ea.a.instance.Sa("Common.IZoomManager")}eC(b){this.lI.classList.add("HeaderFooterViewElement");this.Yv.classList.add("HeaderFooterViewContent");this.ebd(b.currentNode)}Mda(b){this.Yv.parentNode&&
this.Yv.parentNode===this.lI||(this.lI.appendChild(this.Yv),this.zKa.instance&&this.zKa.instance.Hcg(this.oc,this.lI));super.Mda(b)}WQb(b){cA.a.ie(()=>{cA.a.prototype.WQb.call(this,b);this.HFj();this.zKa.instance&&this.zKa.instance.OEj(this.oc,this.Yv.style.paddingLeft,this.Yv.style.paddingTop)},"HFVE:UFO")}ebd(b){this.wo.instance&&this.wo.instance.Hcd(this.Yv);this.HFj();b=this.lBa.U8b(b);this.Yv.style.paddingLeft=b.K3b+"px";this.Yv.style.width=b.QHc+"px";this.zKa.instance&&this.zKa.instance.OEj(this.oc,
this.Yv.style.paddingLeft,this.Yv.style.paddingTop)}HFj(){if(this.wo.instance){this.Yv.style.paddingTop="";var b=hd.a.vB(this.Yv);b.paddingTop&&(b=ic.a.VM(b.paddingTop),this.Yv.style.paddingTop=Math.round(b/this.wo.instance.jj)+"px")}}}Object(n.a)(iB,"HeaderFooterViewElement",ky.a,[]);class dA{constructor(b,h,v,D){this.lBa=b;this.zKa=h;this.vK=v;this.uI=D}create(b,h,v,D){return new iB(b,h,v,D,this.lBa,this.zKa,this.vK,this.uI)}}Object(n.a)(dA,"Factory",null,[611]);var Dx=c(347),jB=c(192),kB=c(970),
Ow=c(574);class eA extends Dx.a{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id,vd,xe,Ld){super(h,ca,ta,Ra,mb,jB.a.cpi,Jb,Ub,cc,Ac,Lc,id,vd,xe,Ld);this.isHeader=this.isHeader=b;this.RXa=P;this.RXa.q$c=this;D(this);this.Agd=v;this.qAa=document.createElement("div");this.qAa.setAttribute("Unselectable","on");this.qAa.setAttribute("hideselection","hideselection");this.qAa.setAttribute("style","outline:none;");this.qAa.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;
this.qAa.tabIndex=0;this.features.orj=!0;this.features.p6e=!0}get UDf(){return!0}Vvf(){const b=this.Agd.Vmf(this);return kB.ViewReference.eF(this,b)}Bff(b){Object(rb.a)(eA,b)||this.Agd.dismiss()}get Wxf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}MPc(){return Ow.a.pPi}onResize(){super.onResize();this.RXa.oXh()}ME(b,h=null){this.qAa.parentNode&&this.qAa.parentNode.removeChild(this.qAa);super.ME(b,h);this.RXa.aXh(this.Yc.qj)}detach(){this.RXa.nXh();super.detach();this.qAa.parentNode||
this.container.insertBefore(this.qAa,this.container.firstChild)}H7c(){this.lv?super.H7c():this.qAa.focus()}tNd(){this.onResize()}}Object(n.a)(eA,"HeaderFooterView",Dx.a,[608,192,193,82,10,104,194,195,196]);class Is{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id,vd){this.Agd=b;this.kpk=h;this.jpk=v;this.Yt=D;this.fd=P;this.Gla=ca;this.ga=ta;this.tWa=Ra;this.pta=mb;this.Z6=Jb;this.Qpk=Ub;this.Rt=cc;this.Oy=Ac;this.Of=Lc;this.xh=id;this.sgd=vd}create(b,h){return new eA(b,h,this.Agd,this.kpk,this.jpk(),
this.Yt,this.fd,this.Gla,this.ga,this.tWa,this.pta,this.Z6,this.Qpk,this.Rt,this.Oy,this.Of,this.xh,this.sgd)}}Object(n.a)(Is,"Factory",null,[612]);class vi{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id,vd,xe,Ld){this.W$g=!1;this.Ygh="SourceControlId";this.KKo=1;this.LKo=1E3;this.Ebe=(Qd,Zd,te,Qf,Jg)=>{if(1===te)return 32;this.ckd(Jg[this.Ygh]);Jg[ri.a.Text]=this.sNe.Wzn(this.Obb.CGb);return 32};this.zMn=(Qd,Zd,te,Qf,Jg)=>{if(1===te)return 32;Jg[If.a.On]=this.Obb.CGb;return 32};this.dxm=(Qd,
Zd,te,Qf,Jg)=>{if(1===te)return 32;this.Obb.vXo(Jg[If.a.On]);return 32};this.Eaj=(Qd,Zd,te)=>{if(1===te)return 32;if(this.M$){Zd=vi.Oh.Ys(Zd.view.Yc);te=he.GraphIterator.$a(Zd);const Qf=this.Sd.wZa();try{const Jg=this.Ic.Oc(15);try{Jg.Cb(Zd),Jg.jk=Qd,Xm.a.instance.FOa(te,Ml=>{this.XXb.F4c(Ml,this.ZTl,this.Nko);return!0})}finally{Jg&&Jg.dispose()}}finally{Qf&&Qf.dispose()}}return 32};this.Y1c=(Qd,Zd,te,Qf,Jg)=>{if(1===te)return 32;Jg.MenuItems=this.gfk.value;this.W$g?this.Obb.L6n():this.W$g=!0;return 32};
this.oDm=(Qd,Zd,te,Qf,Jg)=>{if(1===te)return 32;const Ml=this.ckd(Jg[this.Ygh]);if(this.M$){Zd=vi.Oh.Ys(Zd.view.Yc);te=he.GraphIterator.$a(Zd);Qf=this.Ic.Oc(15);try{Qf.Cb(Zd);Qf.jk=Qd;let Fm=null;const qp=this.ge.Zf("UserAction","InsertPageNumber");Xm.a.instance.FOa(te,wv=>{this.M$.rba||this.J2j(wv);Fm=this.rNe.mDm(wv,Ml,this.Obb.CGb)||Fm;return!0});qp.stop();if(!Fm)return 8;this.yxo(Fm,Ml)}finally{Qf&&Qf.dispose()}this.Sd.Ns(12)}return 32};this.Vzn=()=>32;this.gyo=(Qd,Zd,te,Qf,Jg)=>{if(1===te)return 32;
2===te&&this.HLa.showCallout(Jg);return 32};this.fyo=(Qd,Zd,te,Qf,Jg,Ml)=>this.ISe.create(Qd,Zd,te,Qf,Jg,Ml);this.npl=(Qd,Zd,te)=>{if(1===te)return 32;this.HLa.JSh();return 32};this.swo=Qd=>{w.AFrameworkApplication.va.Qpa(null,Nc.a.Usj,Qd.customData,null)};this.ZTl=Qd=>{const Zd=Yh.a.instance.gb.kb;let te=-1;for(const Qf of Zd)if(Qf.node===Qd){te=Qf.cpBegin;break}return{returnValue:te,FZd:$e.SelectionEditor.Sl(Zd)}};this.Nko=(Qd,Zd)=>{Qd=Og.SelectionFactory.pe(Qd,Zd);Yh.a.instance.setSelection(Qd)};
this.ga=b;this.Ic=h;this.Gb=v;this.Obb=D;this.M$=P;this.em=ca;this.sNe=ta;this.rNe=Ra;this.XXb=mb;this.HLa=Jb;this.hb=Ub;this.ISe=cc;this.ge=Ac;this.Sd=Lc;this.ckd=id;this.J2j=Ld;this.gfk=new Gg.a(()=>this.Obb.A7l())}Tb(){this.ga.eb(Nc.a.Y1c,sc.a.view,this.Y1c,100);this.ga.eb(Nc.a.M_i,sc.a.view,this.Vzn,68);this.ga.eb(Nc.a.Csi,sc.a.view,this.oDm,4);this.ga.eb(Nc.a.CGb,sc.a.view,this.dxm,4);this.ga.eb(Nc.a.F4c,sc.a.view,this.Eaj,4);this.ga.eb(Nc.a.P0n,sc.a.view,this.Eaj,4);this.ga.eb(Nc.a.T1f,sc.a.application,
this.zMn,97);this.ga.eb(Nc.a.Ebe,sc.a.application,this.Ebe,97);this.ga.eb(Nc.a.Tsj,sc.a.view,this.gyo,4);this.ga.cT(Nc.a.Usj,sc.a.view,this.fyo,100);this.ga.eb(Nc.a.mpl,sc.a.view,this.npl,4)}yxo(b,h){const v=b.Ib.paragraph;if(v){var D=this.em.OZc(v);D&&this.M$.rga(D)}D=this.M$.rba;this.M$.show(4>h);v&&this.cko(v)&&(this.eoo(b,v),this.dwk(b,D))}cko(b){let h;if(!({isHeader:h,Zig:b}=this.em.wii(b)).returnValue)return!1;this.M$.Cya(b,h);return!0}eoo(b,h){b=Og.SelectionFactory.pe(h,b.Ib.cp);this.hb.setSelection(b)}dwk(b,
h){h=new qf.a(2,1,h?this.KKo:this.LKo,this.swo);h.customData=b;this.Gb.Vb(h)}static get Oh(){return Wk.PageNavigator.instance}}Object(n.a)(vi,"PageNumbersActor",null,[658]);class Ex{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac){this.ga=b;this.Gb=h;this.Obb=v;this.sNe=D;this.rNe=P;this.XXb=ca;this.HLa=ta;this.ISe=Ra;this.em=mb;this.Sd=Jb;this.ckd=Ub;this.tok=cc;this.ifa=Ac}create(b,h){return new vi(this.ga,new Nh.a,this.Gb,this.Obb,b,this.em,this.sNe,this.rNe,this.XXb,this.HLa,Yh.a.instance,this.ISe,
Xa.App.xa.Hq,this.Sd,this.ckd,this.tok,this.ifa,h)}}Object(n.a)(Ex,"Factory",null,[610]);var Pw=c(1968),qz;(function(b){b[b.small=0]="small";b[b.mediumSmall=1]="mediumSmall";b[b.medium=2]="medium";b[b.large=3]="large"})(qz||(qz={}));Object(n.b)("ModalCalloutSize",qz);var Fx;(function(b){b[b.topCenter=0]="topCenter";b[b.topJustified=1]="topJustified";b[b.topLeft=2]="topLeft";b[b.topRight=3]="topRight";b[b.bottomCenter=4]="bottomCenter";b[b.bottomLeft=5]="bottomLeft";b[b.bottomRight=6]="bottomRight"})(Fx||
(Fx={}));Object(n.b)("BeakLocation",Fx);class Kr{constructor(b,h,v){this.JKo=1;this.LPe=!1;this.mZb=null;this.wWn=()=>{this.hb.Pw(this.Rpa);this.LPe=!0;this.mZb=null};this.Rpa=(D,P)=>{if(D=P.ol.kb)1<D.length||!D.length?D=!0:(D=D.Oa,D=D.cpEnd-D.cpBegin,D=1<D||!D),D&&this.J1j()};this.Gb=b;this.hb=h;this.J1j=v}Fz(){this.cwk()}j$(){this.LPe?(this.hb.CY(this.Rpa),this.LPe=!1):this.mZb&&(this.Gb.Xe(this.mZb),this.mZb=null)}cwk(){this.mZb=new qf.a(2,1,this.JKo,this.wWn);this.Gb.Vb(this.mZb)}}Object(n.a)(Kr,
"CalloutDismissManager",null,[]);class Gx{constructor(b,h,v,D){this.dismiss=()=>{this.ax&&(this.bsc.j$(),this.AZc.dismiss())};this.AZc=b;this.Wp=D;this.bsc=new Kr(h,v,this.dismiss)}get ax(){return this.AZc.ax}show(){if(!this.ax){const b=document.createElement("div");b.classList.add(Gx.Uzn);b.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.AZc.content=b;this.AZc.show();this.Wp&&this.Wp.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.bsc.Fz()}}dispose(){this.dismiss();
this.AZc.dispose()}static scl(b,h){h=Pw.a.qMh(Dd.a.getElementBounds(b.targetElement),h,Xa.App.xa.kD,qz.small);h.Cfa=Gx.qof(b);h.Et=!1;return h}static qof(b){let h=Fx.bottomCenter;Object(rb.a)(608,b.view)&&b.view.isHeader&&(h=Fx.topCenter);return h}}Gx.Uzn="PageNumbersCalloutControl";Object(n.a)(Gx,"PageNumbersCallOutControl",null,[607]);class Qw{constructor(b,h,v){this.IS=null;this.zS=!1;this.dismiss=()=>{this.ax&&this.IS&&el.UISurfaces.vM().then(D=>{this.bsc.j$();D.removeNotification(this.IS);this.zS=
!1;return null},D=>{u.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",D);return null})};this.vl=b;this.bsc=new Kr(h,v,this.dismiss)}get ax(){return this.zS}show(){this.ax||el.UISurfaces.vM().then(b=>{const h=b.callout(Object.assign(new Lo.a,{target:this.vl,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),v=Object.assign(new ma.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.zS=!0},expirationOptions:Object.assign(new qb.a,{displayTimeoutSeconds:7,
onExpire:()=>{this.dismiss()}})});this.IS=b.addNotification(h,v);this.bsc.Fz();return null},b=>{u.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(n.a)(Qw,"ReactPageNumbersCallOutControl",null,[607]);class uy{constructor(b,h,v){this.hb=h;this.Gb=b;this.Wp=v}create(b,h){if(w.AFrameworkApplication.ta.Nb&&w.AFrameworkApplication.ta.Nb.zQa)return new Qw(h.targetElement,this.Gb,this.hb);b=Gx.scl(h,b);return new Gx(b,this.Gb,this.hb,this.Wp,w.AFrameworkApplication.ta.wP)}}
Object(n.a)(uy,"Factory",null,[591]);class fA{constructor(b,h){this.qE=null;this.ffk=b;this.Ri=h}get control(){return this.qE}showCallout(b){this.control&&this.control.ax&&this.control.dismiss();this.qE=this.lHn(b);this.control.show()}JSh(){this.control&&(this.control.dismiss(),this.qE=null)}lHn(b){const h=this.Ri.xna();this.qE=this.ffk.value.create(h,b);return this.control}}Object(n.a)(fA,"PageNumbersCalloutControlManager",null,[590]);var lB=c(753);class gA extends rn.a{constructor(){super();this.Text=
null}get Type(){return 7}}Object(n.a)(gA,"PageNumberGalleryButtonProps",rn.a,[]);const Ru=(b,h,v)=>{b=b.Bk();b.set(v);h.WJb(b);return b};class Ut{constructor(b,h,v){this.CEe=!1;this.ifa=h;this.fm=v}get CGb(){return this.CEe}A7l(){const b=Object.assign(new Yd.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.Jtk());b.MenuSectionList.push(this.zuk());b.MenuSectionList.push(this.bvk());return b}vXo(b){this.CEe=b;this.U8i()}L6n(){this.CEe=!1;const b={};b[Ut.sqi]="CheckboxModel";
this.ifa(b);this.U8i()}Jtk(){const b=Object.assign(new ih.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:G.a.yf(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new lB.a,{Id:Ut.exm,Command:Nc.a.CGb.toString(),QueryCommand:Nc.a.T1f.toString(),LabelText:G.a.yf(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:G.a.yf(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,
UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(h);return b}zuk(){const b=Object.assign(new ih.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),h=Object.assign(new Hk.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.fm){for(var v=3;1<=v;v--)h.GalleryItems.push(this.Gqf(v));for(v=6;4<=v;v--)h.GalleryItems.push(this.Gqf(v))}else for(v=
1;6>=v;v++)h.GalleryItems.push(this.Gqf(v));b.ControlList.push(h);return b}bvk(){const b=Object.assign(new ih.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new mg.a,{Id:"btnRemovePageNumber",Command:Nc.a.F4c.toString(),LabelText:G.a.yf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:G.a.yf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:w.AFrameworkApplication.Ws,Image16by16Class:Xc.getImageClass("WordRemovePageNumbers_16x16x32"),
KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(h);return b}Gqf(b){const h=Ut.KXf+b.toString();var v=Object,D=v.assign,P=new gA,ca=Nc.a.Csi.toString(),ta=Nc.a.Ebe.toString(),Ra=G.a,mb=Ra.yf;let Jb="";switch(b){case 1:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;
break;case 5:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Jb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return D.call(v,P,{Id:h,Command:ca,QueryCommand:ta,Alt:mb.call(Ra,Jb)})}U8i(){const b={};for(let h=1;6>=h;h++)b[Ut.KXf+h.toString()]="PageNumberGalleryButtonModel";b[Ut.sqi]="CheckboxModel";this.ifa(b)}static B7l(b){return b?parseInt(b.substr(Ut.KXf.length)):1}}Ut.exm="btnIncludePageCount";Ut.sqi="IncludePageCount";Ut.KXf="btnPageNumbersPosition";
Object(n.a)(Ut,"PageNumbersControl",null,[589]);class sv{constructor(b,h,v,D,P=null,ca=null,ta=null,Ra=null){this.HZl=(mb,Jb)=>{const Ub=new sf.a;mb=4>mb;switch(Jb){case 1:case 2:Ub.add(mb?0:3);break;case 3:case 4:Ub.add(mb?0:3),Ub.add(mb?1:4)}return Ub};this.FSl=(mb,Jb,Ub)=>{var cc=Ru(this.Wc,this.em,mb);this.em.XJb(cc,Ub);let Ac=this.c0j(cc,Jb);if(Ac)this.XXb.fbj(Ac);else{cc=Ru(this.Wc,this.em,mb);this.em.XJb(cc,Ub);cc.Pd();if(ig.OutlineElementReader.Nh(cc)&&(hf.OutlineElementNavigator.Ge(cc),fe.ParagraphReader.sh(cc))){cc=
cc.currentNode;const Lc=this.Bii(Jb);fe.ParagraphReader.Gx(cc)===Lc&&this.XXb.fbj(cc)&&(Ac=cc)}Ac||(cc=Ru(this.Wc,this.em,mb),this.em.XJb(cc,Ub),this.nL.kjb(cc,null,!0),Ac=hf.OutlineElementNavigator.Ge(cc),this.gE(Jb,Ac))}return Ac};this.GSl=(mb,Jb)=>{let Ub=null;mb.Sb(1);if(ig.OutlineElementReader.Nh(mb)&&(mb.Sb(2),cj.TableReader.isTable(mb))){var cc=mb.currentNode;if(3===cj.TableReader.Zg(cc)){let Ac=0;cc=cj.TableReader.$m(cc);switch(Jb){case 1:case 4:Ac=cc?2:0;break;case 2:case 5:Ac=1;break;case 3:case 6:Ac=
cc?0:2}ch.moveToCellContent(mb,0,Ac);mb.currentNode&&ig.OutlineElementReader.Nh(mb)&&(mb=hf.OutlineElementNavigator.Ge(mb),fe.ParagraphReader.Wb(mb)&&(Ub=mb))}}return Ub};this.sMm=(mb,Jb)=>{const Ub=Ru(this.Wc,this.em,mb);mb=Ub.currentNode.ia(Bc.a.Oia,0);this.em.XJb(Ub,Jb);Jb=Ub.currentNode.ia(Bc.a.Oia,0);return mb===Jb};this.Wc=b;this.hfk=h;this.XXb=v;this.em=D;this.fuc=P||this.HZl;this.d0j=ca||this.FSl;this.c0j=ta||this.GSl;this.i9j=Ra||this.sMm}get nL(){return null!=this.JEg?this.JEg:this.JEg=
Ea.a.instance.resolve("Box4.IOutlineEditor")}mDm(b,h,v){var D=Ru(this.Wc,this.em,b).wn;D=this.em.Yga(D);D=this.fuc(h,D);let P=null;for(let ta=0;ta<D.length;ta++){var ca=D.$f(ta);this.i9j(b,ca)&&(ca=this.d0j(b,h,ca),P=this.hfk.yuk(ca,v)||P)}return P}gE(b,h){sv.y5.M7c(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,h);sv.paragraphEditor.gE(h,this.Bii(b))}Bii(b){let h=1;switch(b){case 1:case 4:h=1;break;case 2:case 5:h=2;break;case 3:case 6:h=3}return h}static get paragraphEditor(){return null!=
sv.FFg?sv.FFg:sv.FFg=Ea.a.instance.resolve("Box4.IParagraphEditor")}static get y5(){return null!=sv.hHg?sv.hHg:sv.hHg=Ea.a.instance.resolve("Box4.Styles.IWACStyleEditor")}}Object(n.a)(sv,"PageNumbersInserter",null,[588]);var Vt=c(878),mB=c(886);class Wt{constructor(b,h,v=null,D=null,P=null){this.z9k=(ca,ta)=>{ca=we.a.Qc(ca,fe.ParagraphReader.textLength(ca));const Ra=ca.node.Kc;return Ra?Wt.characterPropertiesEditor.gha(ca,mb=>{mb=mB.a.getInstance(mb);this.JGd(mb,15,Ra,ta);this.JGd(mb,47,Ra,ta);this.JGd(mb,
16,Ra);this.JGd(mb,17,Ra);return mb}):null};this.QDm=(ca,ta)=>{ca=we.a.Qc(ca,fe.ParagraphReader.textLength(ca));Wt.characterPropertiesEditor.replaceTextRange(ca,ta)};this.Ic=b;this.Uqd=v||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.kxe=D||this.z9k;this.Iih=P||this.QDm}yuk(b,h){const v=this.Ic.Oc(15);v.Cb(b);var D=fe.ParagraphReader.text(b),P=!1;0<D.length&&" "!==D.charAt(D.length-1)&&(P=!0);if(h){h=String.format(this.Uqd,"#","$");P&&(h=" "+h);P=h.indexOf("#");D=h.indexOf("$");
u.ULS.shipAssertTag(4256717,309,-1!==P,"{0}",{["PageNumberIndex"]:P});u.ULS.shipAssertTag(4256718,309,-1!==D,"{0}",{["PageCountIndex"]:D});u.ULS.shipAssertTag(4256719,309,P!==D,"{0}",{["PageNumberIndex"]:P,["PageCountIndex"]:D});let Ra;let mb;if(P<D){var ca=P;Ra=D;var ta=Vt.a.qOc(0);mb=Vt.a.qOc(1)}else ca=D,Ra=P,ta=Vt.a.qOc(1),mb=Vt.a.qOc(0);this.WAf(b,h,0,ca);ta=this.kxe(b,ta);this.WAf(b,h,ca+1,Ra);ca=this.kxe(b,mb);this.WAf(b,h,Ra+1,h.length);b=P<D?ta:ca}else P&&this.Iih(b," "),b=this.kxe(b,Vt.a.qOc(0));
v.dispose();return b}JGd(b,h,v,D=null){const P=new Tx.a;P.setValue(lf.a.g$,!0);P.setValue(Bc.a.nDb,1);P.setValue(Bc.a.jt,h);switch(h){case 15:P.setValue(Bc.a.EQa,!0);P.setValue(Bc.a.fieldInstruction,D);break;case 47:P.setValue(Bc.a.fieldInstruction,D);break;case 17:P.setValue(Bc.a.lIb,!0)}h=v.Pu(P,W.a.create());this.wvk(b,h)}wvk(b,h){b.Jta(h,W.a.nil,Po.AParagraphNode.DC,null)}WAf(b,h,v,D){h=h.substring(v,D);0<h.length&&this.Iih(b,h)}static get characterPropertiesEditor(){return Wt.Kd||(Wt.Kd=Ea.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(b){Wt.Kd=
b}}Wt.Kd=null;Object(n.a)(Wt,"PageNumbersNodeLevelInserter",null,[587]);class vy{Wzn(b){return vy.U9l(b)}static U9l(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,vy.A_i,vy.A_i)}}vy.A_i="1";Object(n.a)(vy,"PageNumbersPositionPreviewGenerator",null,[586]);class wy{constructor(){this.SPg=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");
this.x_j=this.SPg.length}dsm(b){let h=b.characterData.lastIndexOf("\ufffc");return-1!==h&&h+1===fe.ParagraphReader.textLength(b)?{returnValue:!0,a2c:h}:{returnValue:!1,a2c:-1}}Nqm(b){let h=b.characterData.lastIndexOf(this.SPg);return-1!==h&&h+this.x_j===fe.ParagraphReader.textLength(b)?{returnValue:!0,a2c:h}:{returnValue:!1,a2c:-1}}Drm(b){return Yo.a(b,9)?!0:!1}}Object(n.a)(wy,"PageNumbersReader",null,[585]);class hA{constructor(b,h,v,D,P,ca=null,ta=null){this.O0n=(Ra,mb,Jb,Ub)=>{Ra=Ru(this.Wc,this.em,
Ra);this.em.XJb(Ra,mb);mb=sq.a.fq(Ra);for(Ra=!1;mb.moveNext();){const cc=mb.currentNode;if(fe.ParagraphReader.Wb(mb.currentNode)&&Yo.a(mb.currentNode,9)){Ra=!0;let Ac;const Lc=({FZd:Ac}=Jb(cc,Ac)).returnValue;let id=Lc;id=this.t_n(cc,id);id=this.j1n(cc,id);-1<Lc&&(id===Lc&&Ac||Ub(cc,id))}}Ra&&this.Sd.Ns(12)};this.Wc=b;this.em=h;this.tNe=v;this.Sd=D;this.dAc=P;this.fuc=ca||mz.a.Gef;this.whk=ta||this.O0n;this.Uqd=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.xWg=String.format(this.Uqd,
"#","$");this.A7j=this.xWg.indexOf("#");this.z7j=this.xWg.indexOf("$");this.JBe=String.format(this.Uqd,"\ufffc","\ufffc");this.qWg=this.JBe.length}F4c(b,h,v){var D=Ru(this.Wc,this.em,b).wn;D=this.em.Yga(D);D=this.fuc(D);for(const P of D)this.whk(b,P,h,v)}fbj(b){if(this.tNe.Drm(b)){let h=-1;if(({a2c:h}=this.tNe.Nqm(b)).returnValue&&this.UCh(b,h)||({a2c:h}=this.tNe.dsm(b)).returnValue&&this.QVk(b,h))return!0}return!1}j1n(b,h){var v=b.pa.length;for(let P=0;P<v;P++){var D=b.pa.J(P);D.blob&&9===D.blob.zh&&
(D=D.cp,v=we.a.createTextRange(b,D,D+1),this.dAc(v,""),v=b.pa.length,P--,h=this.Frh(h,D,1))}return h}t_n(b,h){let v=b.characterData.indexOf(this.JBe);for(;-1!==v;)this.UCh(b,v)&&(h=this.Frh(h,v,this.qWg)),v=b.characterData.indexOf(this.JBe);return h}QVk(b,h){const v=b.pa.Mh(h);return v&&v.blob&&9===v.blob.zh?(b=we.a.createTextRange(b,h,h+1),this.dAc(b,""),!0):!1}UCh(b,h){const v=b.pa.Mh(h+this.A7j),D=b.pa.Mh(h+this.z7j);return v&&v.blob&&9===v.blob.zh&&D&&D.blob&&9===D.blob.zh?(b=we.a.createTextRange(b,
h,h+this.qWg),this.dAc(b,""),!0):!1}Frh(b,h,v){-1<b&&b>h&&(h=b-h,b=h>v?b-v:b-h);return b}}Object(n.a)(hA,"PageNumbersRemover",null,[584]);class Hg{constructor(b,h){this.Crb=this.Brb=null;this.Er=b;this.Gb=h}PCk(){this.Er.style.display="";this.Brb||(this.Crb&&(this.Gb.Xe(this.Crb),this.Crb=null),this.Brb=new qf.a(0,1,10,()=>{this.Er.classList.add("Displayed");this.Brb=null}),this.Gb.Vb(this.Brb))}RCk(){this.Er.classList.remove("Displayed");this.Crb||(this.Brb&&(this.Gb.Xe(this.Brb),this.Brb=null),
this.Crb=new qf.a(0,1,200,()=>{this.Er.style.display="none";this.Crb=null}),this.Gb.Vb(this.Crb))}}Object(n.a)(Hg,"PaneControlAnimationHelper",null,[604]);class pj{constructor(b){this.Gb=b}G7l(b){return new Hg(b,this.Gb)}}Object(n.a)(pj,"PaneControlAnimationHelperFactory",null,[583]);class Xt{constructor(b,h,v,D,P,ca,ta,Ra,mb=!1){this.QKg=this.Fla=this.zkd=null;this.Ism=()=>{this.zu.sendNotification(this.QKg+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)};this.ga=
b;this.g6=h;this.g6.bind(this);this.SFe=v;this.Vsa=P;this.OVe=ta;this.Ub=Ra;this.Wld=mb;this.sea=ca.value.create(v,D);this.g6.fLk(this.sea);this.tZ=Xb.KeyInputManager.jc(Ve.a.A1,0)}get zu(){return null!=this.twg?this.twg:this.twg=Ea.a.instance.resolve("Common.Utils.IAriaNotifier")}V0(b){this.g6.V0(b);this.Fla&&!b&&this.Fla.kpl()}rga(b){this.zkd!==b&&(this.Rfb(),this.zkd=b)}fkj(b){if(this.zkd){var h=this.Vsa.g1a(this.zkd,mz.a.GZl(b,this.SFe));this.Wld?(this.QKg=this.$3h(b,this.SFe),this.sea.mOb(cf.a.jBd)):
this.aUo(b);h&&this.Z2e(h)}}Pvh(b){this.Wld&&this.Ub&&(b=this.Ub.fe(b))&&b.m7(this.Ism)}$3h(b,h){let v="";switch(b){case 1:v=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:v=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:
WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:v=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;
break;case 4:v=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return v}aUo(b){this.sea.rlj(this.$3h(b,this.SFe),cf.a.jBd)}setInitialSelection(){this.sea.H7c()}Z2e(b){this.Rfb();this.sea.ME(b,b.qj)}Rfb(){this.sea.detach()}Dfl(){this.Fla=
this.OVe.value.create(this.g6.Xlc);this.cro(this.Fla)}cro(b){if(this.Ub){const h=this.Ub.fe(zo.a.V1a);h.parent=Ne.AFrame.rp;h.pfa(()=>{b.setFocus();this.opo()});h.bindAction(this.tZ,Nc.a.xT)}}opo(){if(this.Ub){var b=this.Ub.fe(zo.a.V1a);const h=new Ee.DOMFocusListing(()=>this.g6.Xlc);h.Zpa=!0;h.Wm(1);this.Ub.kAb(this.g6.Xlc,b,h);b=this.Ub.getRegion(zo.a.V1a);b.vSa();b.oR=!0;h.zga&&h.Ly(h.zga)}}dispose(){void 0!==this.Fla&&null!==this.Fla&&(this.Ub.fe(zo.a.V1a).jr(this.tZ),this.Fla.dispose())}ZUn(){void 0!==
this.Fla&&null!==this.Fla&&this.Fla.refresh()}}Object(n.a)(Xt,"PaneControl",null,[603]);class Ao{constructor(b,h,v,D){this.em=b;this.m6j=h;this.OVe=v;this.Ub=D}create(b,h,v,D){return new Xt(b,h,v,D,this.em,this.m6j,this.OVe,this.Ub,w.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(n.a)(Ao,"Factory",null,[582]);var rz=c(1098);class ut extends gy.a{constructor(b,h,v,D,P,ca,ta,Ra,mb){super();this.init(b);this.Jl("ShowCalloutForPageNumberOperation");this.AVj=Ra;
this.ejb(this.AVj,h,D,P,ca);this.cA=0;this.Nbb=ca;this.HLa=ta;this.Jh=mb;1===this.behavior&&(this.pr=32,this.tqa())}run(){var b=this.Jh.ib.yu;if(!this.cA){var h=Sz.a.b8b(this.Nbb,b);this.Nbb.bRc(b,h)&&this.Nbb.Rva(b,h).element&&(this.cA=1)}1===this.cA&&(h=Sz.a.b8b(this.Nbb,b),h=this.Nbb.Rva(b,h),b=new rz.a(h.element,b),this.HLa.showCallout(b),this.cA=2);2===this.cA&&(this.pr=32,this.tqa())}}Object(n.a)(ut,"ShowCalloutForPageNumberOperation",gy.a,[]);class sz{constructor(b,h,v){this.HLa=b;this.ga=
h;this.uSb=v}create(b,h,v,D,P,ca){return new ut(b,h,v,D,P,ca,this.HLa,this.ga,this.uSb)}}Object(n.a)(sz,"Factory",null,[488]);class fw{get nL(){return null!=this.HEg?this.HEg:this.HEg=Ea.a.instance.resolve("Box4.IOutlineEditor")}xc(b){b.ha("WordEditor.HeaderFooter.HeaderFooterManager",()=>new yx(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),b.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),b.Ue("WordEditor.HeaderFooter.IPageNumbersActorFactory"),
b.resolve("WordEditor.IHeaderFooterViewElementFactory"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new Is(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),gB.a.G9e,()=>b.resolve("WordEditor.SectionAlignedViewRepositioner"),Xa.App.xa.ib,Pb.InteractiveViewManager.instance,()=>b.resolve("Box4.IUndoManager"),w.AFrameworkApplication.va,b.resolve("Box4.IInteractiveEventNotifier"),
b.Sa("Box4.ITextMetricsAdapter"),b.resolve("Box4.IRotatingCoordinateConverter"),b.Sa("Common.IZoomManager"),b.Na("Box4.IContentControlViewElementManager"),b.Na("Box4.CpConversionManagerImpl"),b.Na("Box4.ContentControlConfigSettings"),b.Na("Box4.IContentControlReader"),b.Na("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new dA(b.resolve("Box4.SectionAlignedViewPositionProvider"),
b.Sa("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),b.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Xa.App.instance&&Xa.App.instance.RC)).as("WordEditor.IHeaderFooterViewElementFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new xu(Jl.App.sn,b.Sa("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),Jl.App.sn,w.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").singleInstance();b.ha("WordEditor.HeaderFooter.PaneControl.Factory",
()=>new Ao(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.Ue("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),b.Ue("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),bd.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new qy(()=>{Xa.App.xa.updateCommandUI()},b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),w.AFrameworkApplication.va,
b.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new Ex(w.AFrameworkApplication.va,Qg.a.instance,b.resolve("WordEditor.HeaderFooter.PageNumbersControl"),b.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),b.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),
b.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ut.B7l,Object(z.a)(Xa.App.xa,Xa.App.xa.ubd,"updateRibbonControl"),Object(z.a)(Xa.App.xa,Xa.App.xa.WG,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new Fi).singleInstance();b.ha("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",
()=>new pj(Qg.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlOwner",()=>new st(bd.FocusManager.instance(),Xa.App.xa.ox,b.Ue("WordEditor.HeaderFooter.IPaneControlFactory"),b.Ue("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),b.Ue("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),w.AFrameworkApplication.va,new Gg.a(()=>Xa.App.xa.ib.rc),w.AFrameworkApplication.K,b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").singleInstance();
b.ha("WordEditor.HeaderFooter.HeaderFooterEditor",()=>new ry(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Ih.PageReader.instance,new Qo.a,Xm.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new pz(new Qo.a,Xm.a.instance));b.ha("WordEditor.HeaderFooter.HeaderFooterActor",()=>new Kh(w.AFrameworkApplication.va,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),
Xm.a.instance,new Qo.a,new Nh.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),Kh.aki,b.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",()=>new bp(TC.a.instance,bp.Dfm(b.resolve("Box4.ITableEditor")),bp.jQl(),w.AFrameworkApplication.isRtl,hf.OutlineElementNavigator.Vd,bp.xdm(),bp.uZl(),b.resolve("Box4.IOutlineElementEditor")));b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",
()=>new xx.a(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Qo.a,h=>this.nL.kjb(h,null,xx.a.xdg),w.AFrameworkApplication.isRtl,Object(z.a)(b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.IOutlineElementEditor").AOb,"setRtlSimple"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter"),b.resolve("Box4.Styles.IWACStyleEditor")));b.ha("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new zx(Xm.a.instance,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
b.resolve("WordEditor.HeaderFooterNodeFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).singleInstance();b.ha("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new bC(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Qo.a,new Nh.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new ts(b.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),
b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Xm.a.instance,new Qo.a,w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersControl",()=>new Ut(Object(z.a)(Xa.App.xa,Xa.App.xa.ubd,"updateRibbonControl"),Object(z.a)(Xa.App.xa,Xa.App.xa.WG,"updateRibbonControls"),w.AFrameworkApplication.isRtl)).singleInstance();b.register(vy,"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",
()=>new Wt(new Nh.a,b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersInserter",()=>new sv(new Qo.a,b.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersReader",()=>new wy).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersRemover",()=>new hA(new Qo.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
b.resolve("WordEditor.HeaderFooter.PageNumbersReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(z.a)(fw.characterPropertiesEditor,fw.characterPropertiesEditor.replaceTextRange,"replaceTextRange"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new fA(b.Ue("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),Xa.App.xa)).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",
()=>new uy(Qg.a.instance,Yh.a.instance,b.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").singleInstance();b.ha("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new sz(b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),w.AFrameworkApplication.va,Xa.App.xa)).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").singleInstance();b.ha("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",
()=>new il(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),w.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").singleInstance();b.ha("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new Xz(b.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),b.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").singleInstance()}static get characterPropertiesEditor(){return null!=
fw.Uwg?fw.Uwg:fw.Uwg=Ea.a.instance.resolve("Box4.ICharacterPropertiesEditor")}}Object(n.a)(fw,"HeaderFooterComponentConfiguration",null,[2]);class Rw{constructor(){this.Bkd=this.W=null}get name(){return"WordEditor.HeaderFooter"}xc(b){this.W=b;(new fw).xc(b)}init(){this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>{this.hn()})}hn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(111)&&(this.Bkd=this.W.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.Bkd.start(),this.W.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.Bkd&&
this.Bkd.dispose()}static main(){N.a.instance.Fc(new Rw)}}Object(n.a)(Rw,"PackageManager",null,[1,2]);var vr=c(361),eC=c(492);class nB{constructor(b,h){this.Of=b;this.$l=h}create(){return new eC.a(this.Of.instance,this.$l.instance)}}Object(n.a)(nB,"ContentControlNodeFactory",null,[598]);var qD=c(1698),xy=c(383),fC=c(1056);class yy{create(){return new fC.a}}Object(n.a)(yy,"ContentControlContainerNodeFactory",null,[598]);var Qp=c(183),Hx=c(389),WC=c(224),oB=c(1112);const Ix=b=>b?(b=b.ia(Bc.a.JNa,null))&&
b.includes(Qp.a.$Ph):!1;class gC{constructor(b,h,v,D,P,ca,ta){this.Una=b;this.eg=h;this.characterPropertiesEditor=v;this.Vfa=D;this.Sqa=P;this.Sn=ca;this.$5k=ta;this.cmn=(Ra,mb)=>{ui.a.r3a&&(Ra=mb.node,mb=he.GraphIterator.$a(Ra),mb.zb(7)&&(mb=mb.jd(54)))&&(mb=mb.getValue(Bc.a.contentControlNode),Ra=Ra.id,1==(null===mb||void 0===mb?void 0:mb.length)&&Ra.equals(mb[0])&&(Ra=this.Una.a8h(),this.XQh(Ra)))};this.JTf=(Ra,mb)=>{if(ui.a.r3a)for(const Jb of mb.gPh)Ix(Jb.contentControlNode)||(Ra=Jb.contentControlNode.ia(Bc.a.JNa,
null),this.XQh(Ra))}}get MCf(){return w.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled")}init(){this.Vfa.r9i(this.JTf);this.$5k.nQ(this.cmn)}XQh(b){const h=this.Una.NEb();h&&b&&this.Una.IFb(h,b)&&(b=new eh.GraphTransaction(7),b.Lt(h),h.xg(),b.dispose())}zIc(){const b=new oB.a;b.setValue(Bc.a.nlm,!0);var h=(h=ub.a.create())?h.toString().replace(RegExp("-","g"),"").toUpperCase():null;b.setValue(Bc.a.q9b,h);b.setValue(Bc.a.T5k,this.MCf);h=ub.a.create();b.setValue(Bc.a.Gki,
h);return b}nPk(b){const h=b.currentNode.getValue(Bc.a.Gki);b.Af(new Hx.a,1);b.J_();b.currentNode.setValue(Bc.a.KTh,h);b.Af(this.eg.wfb(),1);b.J_();return this.eg.YI(b)}Ioo(b){var h=this.Una.qrf();h.zb(7);if(h.wc()&&h.pPa(0,D=>8==D.type)){h=h.currentNode;const D=(new xq.WACStyleSet).VQ(h);if(D){var v=D.Di(Qp.a.AZf);if(!v&&(v=this.Muk(h),u.ULS.sendTraceTag(508952736,368,50,`Placeholder text style is not in document. Adding new style succeeded: ${!!v}`),!v))return;b=we.a.createTextRange(b,0,fe.ParagraphReader.textLength(b));
this.Sqa.YZ(b,P=>{this.Sn.Kfa(P);this.Sn.M6a(P,v)})}}}Dcl(b){var h=this.Una.qrf();const v=this.zIc();h.Af(v,29);h.J_();h=this.nPk(h);this.characterPropertiesEditor.replaceTextRange(we.a.Qc(h,0),b,!1,!1);this.Ioo(h);return v}E_k(b){const h=this.Una.NEb();this.Una.IFb(h,b);b=this.zIc();const v=this.Una.qrf();v.Af(b,29);v.sj(b);Mp.a(h.currentNode,v.currentNode,!1);return b}cZo(b,h){const {S9d:v,vni:D}=this.Una.VXl(b);if(v){var P=we.a.createTextRange(v,0,fe.ParagraphReader.textLength(v));this.characterPropertiesEditor.replaceTextRange(P,
h,!1,!1);D&&this.dll(b);this.NXo(b)}}dll(b){const h=this.Una.NEb();if(h&&b&&this.Una.IFb(h,b))for(h.Pd(),b=h.Mp(),--b;0<b;b--)h.iF(b),h.xg()}NXo(b){const h=this.Una.NEb();this.Una.IFb(h,b)&&h.currentNode.setValue(lf.a.kR,new Date)}Muk(b){const h=new Zv.a(new WC.a);h.setValue(Vi.a.ka,"Placeholder Text");h.setValue(Vi.a.ma,1);h.setValue(Bc.a.la,"PlaceholderText");h.setValue(Pd.a.na,99);h.setValue(Bc.a.oa,"Default Paragraph Font");h.setValue(Bc.a.kn,!0);h.setValue(lf.a.fontColor,8421504);return dl.a.RDc([h],
b)?h:null}}Object(n.a)(gC,"GlossaryEditor",null,[699]);class XC{constructor(b,h,v,D,P){this.Vfa=b;this.IIh=h;this.gBb=v;this.KJ=D;this.nj=P;this.R5k=new yy;this.emn=(ca,ta)=>{this.KJ.ie(()=>{if(ta){ta.Mo.selectedContentControls||(ta.Mo.selectedContentControls={});var Ra=ta.Mo.selectedContentControls,mb=ta.XSa;if(mb&&mb.length){var Jb=mb[0];mb=mb[mb.length-1];Jb=this.Vfa.$of(we.a.Qc(Jb.node,Jb.wj),we.a.Qc(mb.node,mb.Yo),!1);for(const Ub of Jb)ui.a.Dx&&Ub.contentControlNode.ia(Bc.a.nU,!1)||(Ra[Ub.contentControlNode.id.toString()]=
!0)}}},"CC:OnBeforeCopy")};this.vVf=(ca,ta)=>{this.KJ.ie(()=>{if(ta){var Ra=ta.clone,mb=ta.original;try{const Jb=ta.Mo.selectedContentControls,Ub=this.Vfa.kof(mb,0,mb.characterData.length,!0,!0,!1);for(const cc of Ub){const Ac=cc.ke.toString();Jb[Ac]?cc.qp&&!this.l8k(cc.contentControlNode,Ra,Jb)&&(u.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",Ac)),this.i5f(Ra,cc.ke)):this.i5f(Ra,cc.ke)}}catch(Jb){u.ULS.sendTraceTag(521171974,307,
10,"onParagraphCopy operation failed: {0}",Jb.toString()),this.IIh.TZn(Ra)}}},"CC:onParagraphCopy")};this.wVf=(ca,ta)=>{this.KJ.ie(()=>{if(ta){var Ra=ta.clone,mb=ta.original;try{const Jb=this.Vfa.kof(Ra,0,mb.characterData.length);ta.Mo.ccObjectIdMapping||(ta.Mo.ccObjectIdMapping={});const Ub=ta.Mo.ccObjectIdMapping;for(let cc=0;cc<Jb.count;cc++){const Ac=Jb.J(cc),Lc=Ac.ke.toString();if(this.DRm(Ac))if(Ac.Mc){const id=mb.Vi().od.Db(Lc),vd=this.V8l(Ac),xe=this.v_k(id,vd.z0i,vd.Zri,Ra.Vi().od);Ub[Lc]=
xe.id;this.gBb.GFj(Ub[Lc],Ra.id,null);this.nj.Idc(xe)}else this.gBb.GFj(Ub[Lc],null,Ra.id);Ub[Lc]?(Ac.ke=Ub[Lc],Ac.ev=null):this.i5f(Ra,Ac.ke)}}catch(Jb){u.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",Jb.toString())}}},"CC:onParagraphPaste")}}init(){Bs.a.mxk(this.emn);Bs.a.V_e(this.vVf);Bs.a.Vzd(this.wVf)}bRl(b){if(!b.zb(25)||!b.jd(25))return null;if(!b.Rr(25)){const h=this.R5k.create(1074135144);b.Af(h,25)}return b.Sb(25)}l8k(b,h,v){var D=b.ia(Bc.a.J7,null);const P=
he.GraphIterator.$a(h);h=h.Vi().od;v=D&&v[D.toString()]?h.Db(D):this.bRl(P);if(!v)return u.ULS.sendTraceTag(521172765,368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;D=Mp.b(b,h,!0);he.GraphIterator.$a(v).c3(D,26,b.id);54!==v.type&&D.setValue(Bc.a.J7,v.id);ui.a.Dx&&xy.a.$Af(null,D);return D}i5f(b,h){this.IIh.skl(new Fb.a([b]),h)}DRm(b){var h=b.Ib.paragraph.Kc;if(!h)return u.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",
b.ke.toString())),!1;h=h.Db(b.ev);if(!h)return u.ULS.sendTraceTag(520152149,368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.ke.toString())),!1;b=h.getValue(Bc.a.jt);return 38===b||39==b}IPl(b,h){var v,D=b.pa.J(b.pa.length-1);let P=b.characterData.length;D=(null===(v=null===D||void 0===D?void 0:D.Jb)||void 0===v?void 0:v.length)||0;b.id.equals(h.Ib.paragraph.id)&&(P=h.Ib.cp,D=h.Ib.Jb.lJ(h.ke,h.Mc));return this.Vfa.lof(b,0,P,0,D)}V8l(b){let h=null,v=b.Ib.paragraph;
const D={};for(;v;){const P=this.IPl(v,b);for(let ca=P.count-1;0<=ca;ca--){const ta=P.J(ca);if(!ta.qp)continue;const Ra=ta.ke.toString();if(ta.Mc){if(!D[Ra])return{z0i:ta.contentControlNode,Zri:h}}else D[Ra]=!0,h||(h=ta.contentControlNode)}v=fe.ParagraphReader.jg(v,!0,!0)}return{z0i:null,Zri:h}}v_k(b,h,v,D){let P;h?P=this.gBb.Eva(h):(P=this.gBb.Fva(),h=P.currentNode);D=Mp.b(b,D,!0);D.$g(Bc.a.Tw,se.a.uF());54!==h.type&&D.setValue(Bc.a.J7,h.id);P.JH(D,v,26);ui.a.r3a&&!Ix(b)&&this.gBb.B_k(b,D);return D}}
Object(n.a)(XC,"ContentControlCCP",null,[]);var pB=c(712);class hC{constructor(b,h,v,D){this.Kd=b;this.Of=h;this.fb=v;this.zd=D}get YX(){return!!this.Of.instance&&this.Of.instance.YX}get oHb(){return!!this.Of.instance&&this.Of.instance.oHb}Hta(b,h,v,D,P,ca=Qp.a.fCb,ta=Qp.a.M4b,Ra=null,mb=Qp.a.ydf,Jb=-1){(b=this.lPc(b,v))?(b.Jb||(b.Jb=new vr.a(b)),this.vsk(h,b.Jb,D,P,ca,ta,Ra,mb,Jb)):u.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}HQh(b,h,v){if(b){new Fb.a;
for(let P=0;P<b.count;P++){var D=this.Wof(b.J(P),h,!1);for(const ca of D)this.u_n(ca,v)}}}rkl(b,h){this.HQh(b,h,!0)}skl(b,h){this.HQh(b,h,!1)}replaceTextRange(b,h,v){this.Kd.replaceTextRange(b,h,v===Gb.a.G8c)}lPc(b,h){var v=we.a.Qc(b,h);this.Kd.c7a(v);for(v=0;v<b.pa.length;v++){const D=b.pa.J(v);if(D.cp>h)break;if(D.cp===h)return D}return null}vsk(b,h,v,D,P=Qp.a.fCb,ca=Qp.a.M4b,ta=null,Ra=Qp.a.ydf,mb=-1){const Jb=h.Ib.paragraph;b=new pB.a(h.Ib,!0,!0,!0,null,b,D,v,P,ca,ta,Ra,null,this.zd);if(!this.YX||
-1>=mb||mb>h.length)mb=h.length;h.insert(b,mb);Jb.Yl();b.qe?Jb.xe.VX(b.qe-1,512):Jb.xe.loa(b.qe,512);Jb.xe.nq.Z(b.qe,op.CharacterPropertiesEditor.MM);Jb.xe.ft.Z(b.qe,op.CharacterPropertiesEditor.tR)}Wof(b,h,v){const D=new Fb.a;for(let P=0;P<b.pa.length;P++){const ca=b.pa.J(P);if(ca.Jb)for(let ta=0;ta<ca.Jb.length;ta++)if(ca.Jb.J(ta).ke.equals(h)&&(D.add(ca.Jb.J(ta)),v))return D}return D}bbd(b,h,v){if(this.oHb&&b){var D=b.node,P=b.wj,ca=b.Yo,ta=this.g7h(D,P,h,!0);h=this.g7h(D,ca,h,!1);v?-1!==ta&&ta++:
-1!==h&&h++;P||-1===ta||(ta=Math.max(ta,this.fb.Jv(D)));ca===this.fb.textLength(D)&&-1!==h&&(h=Math.min(h,this.fb.fv(D)));b.Eb=ta;b.Rb=h}}g7h(b,h,v,D){return(b=(b=b.pa.Mh(h))?b.Jb:null)&&b.length?b.lJ(v,D):-1}u_n(b,h){b&&b.Ib.Jb&&(h?b.Ib.Jb.remove(b):b.Ib.Jb.aqa(b),h=b.Ib.paragraph,0<=b.qe&&b.qe<h.xe.length&&(b.Ib.cp||1!==h.xe.length||(h.xe.VX(0,512),h.xe.nq.Z(1,op.CharacterPropertiesEditor.MM),h.xe.ft.Z(1,op.CharacterPropertiesEditor.tR)),h.xe.removeAt(b.qe,512)),h.Yl())}TZn(b){const h=b.pa;if(h){var v=
new Fb.a;for(let D=0;D<h.length;D++){const P=h.J(D);if(P&&P.Jb){for(let ca=0;ca<P.Jb.length;ca++)v.add(P.Jb.J(ca).qe);P.Jb=null}}b.$pa(v)}}pSo(b,h,v){if(!(0>h||0>v))for(this.Kd.c7a(we.a.Qc(b,h)),this.Kd.c7a(we.a.Qc(b,v)),h=b.pa.Sga(h),v=b.pa.Sga(v),--v;v>h;v--){const D=b.pa.J(v);D.kDf?b.pa.removeAt(v):D.formatting=null}}}Object(n.a)(hC,"ContentControlChpManager",null,[707]);class iC{constructor(b,h,v,D,P){this.fb=b;this.Co=h;this.xh=v;this.ld=D;this.zd=P}Ynf(b){if(!b||!$e.SelectionEditor.gf(b))return null;
if(!b.cpBegin){const h=this.k5h(b.node,b.Eb,!0);if(h)return h}return b.cpBegin===this.fb.textLength(b.node)?this.k5h(b.node,b.Eb-1,!1):null}JOl(b,h){b=this.dMh(b,h);return this.Ynf(b)}k5h(b,h,v){return b.pa&&b.pa.length?(b=v?b.pa.first.Jb:b.pa.last.Jb)&&0<=h&&h<b.length&&b.J(h).If&&b.J(h).Mc===v&&this.vCf(b.J(h))?b.J(h):null:null}krf(b){if(!b||!$e.SelectionEditor.mv(b))return null;var h=this.Co.POd(b,b);b=0<h.count?h.J(h.count-1):null;return b&&!b.If&&this.vCf(b)?(h=1<h.count?h.J(h.count-2):null)&&
!h.If&&this.vCf(h)?null:b:null}vCf(b){if(!b)return!1;var h=this.Fdi(b);if(!h)return!1;if(b.Mc)var v=b;else v=h,h=b;var D=this.fb.textLength(b.Ib.paragraph);if(v.Ib.cp||h.Ib.cp!==D||!v.qp||v.Swa||!h.qp||h.Swa)return!1;v=v.Ib.Jb;h=h.Ib.Jb;for(D=0;D<v.length&&!v.J(D).ke.equals(b.ke);D++)if(!v.J(D).Mc)return!1;for(v=h.length-1;0<=v&&!h.J(v).ke.equals(b.ke);v--)if(h.J(v).Mc)return!1;return!0}Kad(b){b=this.Ynf(b);this.dGd(b,!1)}GDj(b,h){b=this.dMh(b,h);this.Kad(b)}AIa(b){b=this.krf(b);return this.dGd(b,
!0)?b:null}pHm(b,h){b=this.Ynf(b);return!!b&&b.ke.equals(h)}iac(b,h,v){b=this.JOl(b,h);return!!b&&b.ke.equals(v)}eEf(b,h){b=this.krf(b);return!!b&&b.ke.equals(h)}dGd(b,h){if(!b)return!1;const v=this.Fdi(b);return this.nJh(b,h)&&(!v||this.nJh(v,h))}nJh(b,h){if(!b||b.If===h)return!1;var v=this.Co.nne(b.Ib.paragraph,b.Mc);const D=b.Ib.Jb;-1!==v||b.Mc||(v=D.length);const P=h===b.Mc?1:-1;v+=h?P:0;b=D.lJ(b.ke,b.Mc)+P;if(v===b||0<P!==b>v)return u.ULS.shipAssertTag(24933847,368,v!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",
v,b,P),u.ULS.shipAssertTag(24933848,368,0<P===b>v,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",v,b,P),!1;for(var ca=v;ca!==b;ca+=P){var ta=D.J(ca);D.aqa(ta);ta.If=h;D.ZDm(ta,ca);this.zXo(D.J(ca))}if(this.Z_)for(D.Ib.paragraph.Yl(),ca=v;ca!==b;ca+=P)ta=D.J(ca),ta.paragraph.xe.nq.Z(ta.qe,op.CharacterPropertiesEditor.MM),ta.paragraph.xe.ft.Z(ta.qe,op.CharacterPropertiesEditor.tR);h||this.d_o(D,v,b,P);u.ULS.sendTraceTag(24933849,368,
50,"Converted {0} content control(s) to {1}",Math.abs(b-v),h?"block":"inline");return!0}DRd(b){var h,v;return b.Mc&&(ui.a.Hj?this.zd.zq(b.contentControlNode.id,!0):this.zd.Qs.get(null===(h=b.contentControlNode.id)||void 0===h?void 0:h.toString())).equals(b.Ib.paragraph.id)?38:!b.Mc&&(ui.a.Hj?this.zd.zq(b.contentControlNode.id,!1):this.zd.xt.get(null===(v=b.contentControlNode.id)||void 0===v?void 0:v.toString())).equals(b.Ib.paragraph.id)?39:b.If&&b.Mc?40:b.If&&!b.Mc?41:!b.If&&b.Mc?38:39}zXo(b){const h=
b.Ib.paragraph.Kc;if(h){var v=h.Db(b.ev),D=b.contentControlNode;if(v){v=v.clone();v.setValue(Bc.a.NGf,b.If);const P=this.DRd(b);v.setValue(Bc.a.jt,P);h.Pu(v,null);b.ev=v.id}D&&D.setValue(Bc.a.J8,b.If)}}Fdi(b){if(b.Ib.cp&&b.Ib.cp!==this.fb.textLength(b.Ib.paragraph)||!b.Ib.paragraph.pa||!b.Ib.paragraph.pa.length)return null;const h=b.Mc?b.Ib.paragraph.pa.last:b.Ib.paragraph.pa.first;if(!h.Jb)return null;b=h.Jb.lJ(b.ke,!b.Mc);return-1===b?null:h.Jb.J(b)}d_o(b,h,v,D){var P,ca,ta,Ra,mb=b.J(h).contentControlNode;
if(mb){var Jb=b.J(h).Mc,Ub=Jb?this.zd.Qs:this.zd.xt;mb=ui.a.Hj?this.zd.zq(mb.id,Jb):null!==(ca=Ub.get(null===(P=mb.id)||void 0===P?void 0:P.toString()))&&void 0!==ca?ca:W.a.nil;if(!mb.equals(W.a.nil))if(b.Ib&&b.Ib.paragraph&&b.Ib.paragraph.id.equals(mb)){for(h+=D;h!==v;h+=D){P=b.J(h).contentControlNode;if(!P)return;ui.a.Hj?this.zd.kE(P.id,mb,Jb):Ub.set(null===(ta=P.id)||void 0===ta?void 0:ta.toString(),mb)}0<=v&&v<b.length&&b.J(v).If&&this.BGf(b.J(v))&&(b=b.J(v).contentControlNode)&&(ui.a.Hj?this.zd.kE(b.id,
mb,Jb):Ub.set(null===(Ra=b.id)||void 0===Ra?void 0:Ra.toString(),mb))}else u.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}BGf(b){return b.qp&&!b.Swa}dMh(b,h){if(!b||!this.xh)return null;const v=h?we.a.Qc(b,0):we.a.mw(b);b=this.xh.$q(b,h);v.Rb=v.Eb=b;return v}get Z_(){return this.ld.isFeatureEnabled(31)}}Object(n.a)(iC,"ContentControlConverter",null,[705]);var zy;(function(b){b[b.U9o=0]="BoundingBox";b[b.bcp=
1]="Tags";b[b.bap=2]="Hidden";b[b.Yap=3]="NumberOfContentControlAppearance"})(zy||(zy={}));Object(n.b)("ContentControlAppearance",zy);var iA=c(1624);class qB{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub){this.K$a=this.CBa=this.Nsc=this.IBc=this.Zpd=null;this.Uja=this.$j=this.Yyc=this._id=0;this.zUb=this.Ird=this.lwd=this._title=this.Uza=null;this.Umd=this.Tmd=this.P2g=this.Qsd=this.rvc=this.nvc=this.Thd=!1;this.f4g=null;this.If=!1;this.tgd=null;this.mi=v;this.wx=h;this.Qg=D;this.lr=P;this.$l=ca;this.W1=
ta;this.rea=Ra;this.kfa=mb;this.Wyb=Jb;this.zd=Ub;b?(this.Zpd=b.id,this.tgd=b,this.HT(!1)):this._id=se.a.uF()}get Aj(){return this.mi.value}get id(){this.HT();return this._id}set id(b){this._id=b;this.isValid()&&(this.contentControlNode.setValue(Bc.a.Tw,this._id),this.QY())}get parentId(){this.HT();return this.Yyc}set parentId(b){this.Yyc=b}get title(){this.HT();return this._title}set title(b){this._title=b;this.isValid()&&(this.contentControlNode.setValue(Bc.a.efb,this._title),this.QY(),this.dbd(h=>
{h.title=this._title?this._title:Qp.a.fCb}))}get tag(){this.HT();return this.lwd}set tag(b){this.lwd=b;this.isValid()&&(this.contentControlNode.setValue(Bc.a.hfb,this.lwd),this.QY())}get type(){this.HT();return this.$j}set type(b){this.$j=b;this.isValid()&&(this.contentControlNode.setValue(Bc.a.ifb,iA.a[this.$j]),this.QY())}get appearance(){this.HT();return this.Uja}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.Uja=b;this.isValid()&&
(this.contentControlNode.setValue(Bc.a.ffb,zy[this.Uja].toLowerCase()),this.QY(),this.dbd(h=>{h.appearance=zy[this.Uja].toLowerCase()}))}get color(){this.HT();return this.Uza}set color(b){if(b&&16777215>=b)this.Uza=b,this.isValid()&&(this.contentControlNode.setValue(Bc.a.LHc,this.Uza),this.QY(),this.dbd(h=>{h.color=this.Uza}));else throw Error.argumentOutOfRange("The color value is out of range.");}get placeholderText(){this.HT();return this.Ird}set placeholderText(b){this.Ird=b;ui.a.r3a&&this.Qg.mGj(b,
this.tgd)&&(this.QY(),this.zJ&&this.$l.Gzb(this,!0))}get uJd(){this.HT();return this.zUb}set uJd(b){this.zUb=b;this.isValid()&&(this.contentControlNode.setValue(Bc.a.fBb,this.zUb),this.QY())}get ggf(){this.HT();return this.Thd}set ggf(b){b&&(this.Thd=b,this.isValid()&&(this.contentControlNode.setValue(Bc.a.PFd,this.Thd),this.QY()))}get removeWhenEdited(){this.HT();return this.Qsd}set removeWhenEdited(b){if(b&&!this.mha)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");
this.Qsd=b;this.isValid()&&(this.contentControlNode.setValue(Bc.a.LIh,this.Qsd),this.QY())}get mha(){this.HT();return this.nvc}set mha(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");this.nvc=b;this.isValid()&&(this.contentControlNode.setValue(Bc.a.H3b,this.nvc),this.dbd(h=>{h.PK=this.nvc}),this.QY())}get isEditable(){this.HT();return this.rvc}set isEditable(b){this.rvc=b;this.isValid()&&
(this.contentControlNode.setValue(Bc.a.hBb,this.rvc),this.dbd(h=>{h.editable=this.rvc}),this.QY())}get isSupported(){this.HT();return this.P2g}get IRm(){return this.isSupported&&11!==this.type&&10!==this.type}get QUm(){this.HT();return this.zUb&&"table of contents"===this.zUb.toLowerCase()?!0:!1}get d_d(){this.HT();return this.Tmd}set d_d(b){this.Tmd=b;this.isValid()&&(this.contentControlNode.setValue(Bc.a.OIh,this.Tmd),this.QY())}get ubc(){this.HT();return this.Umd}set ubc(b){this.Umd=b;this.isValid()&&
(this.contentControlNode.setValue(Bc.a.PIh,this.Umd),this.QY())}get zJ(){return this.contentControlNode.ia(Bc.a.K7,!1)}set zJ(b){this.isValid()&&this.contentControlNode.setValue(Bc.a.K7,b)}get qu(){this.HT();return this.IBc}set qu(b){this.IBc=b}get nz(){this.HT();return this.Nsc}set nz(b){this.Nsc=b}get objectId(){return this.Zpd}set objectId(b){this.Zpd=b;this.tgd=this.Aj.Db(this.Zpd)}get start(){this.dIj();return this.CBa}set start(b){this.CBa=b}get end(){this.dIj();return this.K$a}set end(b){this.K$a=
b}get contentControlNode(){return this.tgd}zBn(b){for(let h=0;3>h;++h)if(zy[h].toLowerCase()===b)return h;return 0}QY(){const b=this.start.node;b&&b.setValue(lf.a.kR,new Date)}qbd(){var b,h,v,D;this._id=this.contentControlNode.ia(Bc.a.Tw,0);this.Uja=this.zBn(this.contentControlNode.ia(Bc.a.ffb,null));this.Uza=this.contentControlNode.ia(Bc.a.LHc,null);this._title=this.contentControlNode.ia(Bc.a.efb,null);this.lwd=this.contentControlNode.ia(Bc.a.hfb,null);this.If=this.contentControlNode.ia(Bc.a.J8,
!1);this.nvc=this.contentControlNode.ia(Bc.a.H3b,!1);this.rvc=this.contentControlNode.ia(Bc.a.hBb,!1);this.P2g=this.contentControlNode.ia(Bc.a.Ufa,!1);this.zUb=this.contentControlNode.ia(Bc.a.fBb,null);this.Thd=this.contentControlNode.ia(Bc.a.PFd,!1);ui.a.Hj?(this.IBc=this.zd.zq(this.contentControlNode.id,!0),this.Nsc=this.zd.zq(this.contentControlNode.id,!1)):(this.IBc=null!==(h=this.zd.Qs.get(null===(b=this.contentControlNode.id)||void 0===b?void 0:b.toString()))&&void 0!==h?h:W.a.nil,this.Nsc=
null!==(D=this.zd.xt.get(null===(v=this.contentControlNode.id)||void 0===v?void 0:v.toString()))&&void 0!==D?D:W.a.nil);this.Umd=this.contentControlNode.ia(Bc.a.PIh,!1);this.Tmd=this.contentControlNode.ia(Bc.a.OIh,!1);this.Qsd=this.contentControlNode.ia(Bc.a.LIh,!1);this.$j=Object(iA.b)(this.contentControlNode.ia(Bc.a.ifb,"RichText"));b=null;try{const P=this.contentControlNode.ia(Bc.a.J7,W.a.nil);if(W.a.eq(P,W.a.nil))this.Yyc=0;else if(b=this.Aj.Db(P))this.Yyc=b.ia(Bc.a.Tw,0)}catch(P){this.Yyc=0}this.bZo()}bZo(){if(this.Wyb){var b=
this.contentControlNode.ia(Bc.a.JNa,"");if((b=this.rea.Pji(b))&&0<b.length){this.Ird=this.t4h(b.Oa,b.Pc);return}}this.Ird=(b=this.Qg.Fva())&&b.currentNode?b.currentNode.ia(Bc.a.MHc,null):null}HT(b=!0){if(!b||this.isValid())b=this.contentControlNode.ia(lf.a.lastModifiedTime,new Date(0)),this.f4g!==b?(u.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),this.qbd(),this.f4g=b):u.ULS.sendTraceTag(520734534,368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}c_o(b,
h){var v,D;this.IBc=b;this.Nsc=h;ui.a.Hj?this.zd.kE(this.contentControlNode.id,b,!0):this.zd.Qs.set(null===(v=this.contentControlNode.id)||void 0===v?void 0:v.toString(),b);ui.a.Hj?this.zd.kE(this.contentControlNode.id,h,!1):this.zd.xt.set(null===(D=this.contentControlNode.id)||void 0===D?void 0:D.toString(),h)}dIj(){if(this.contentControlNode){var b=this.qu,h=this.nz;if(!b||!h||b.equals(W.a.nil)||h.equals(W.a.nil))u.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");
else if(b=this.Qg.una(b,!0),h=this.Qg.una(h,!1),b&&h)if(b.isConnected&&h.isConnected||u.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.If)b=we.a.create(b),this.lr.bbd(b,this.objectId,!0),this.start=b,b=we.a.create(h),this.lr.bbd(b,this.objectId,!0),this.end=b;else{let v=h=-1;if(b.pa){for(let D=0;D<b.pa.length&&(-1===h||-1===v);D++){const P=b.pa.J(D);if(P.Jb)for(let ca=0;ca<P.Jb.length&&(-1===h||-1===v);ca++){const ta=P.Jb.J(ca);W.a.eq(ta.ke,this.objectId)&&(ta.Mc?
h=P.cp:v=P.cp)}}0<=h&&0<=v&&(b=we.a.mO(h,v,!1,b),this.lr.bbd(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var h=this.start;const v=this.end;if(!h||!v)return b;this.If?b=this.t4h(h,v):(h=fe.ParagraphReader.text(h.node).substring(h.cpBegin,v.cpEnd),b+=Po.AParagraphNode.IR(h));return b}isValid(){return!!this.contentControlNode&&this.contentControlNode.isConnected}Qhe(b){return this.kfa?this.$l.Znj(this,b)?0:2:2}clear(){return this.kfa?this.$l.Znj(this,"")?0:2:2}m6h(){const b=new Fb.a;
var h=this.contentControlNode.ia(Bc.a.contentControlNode,[]);for(const v of h)if(!W.a.eq(v,W.a.nil)){h=this.mi.value.Db(v);try{b.add(this.W1.uBb(h,this.wx,this.mi,this.Qg,this.lr,this.$l,this.rea,this.kfa,this.Wyb))}catch(D){}}return b}wnf(){const b=new Fb.a;this.k4h(this,b);return b}k4h(b,h){b=b.m6h();if(b.count)for(const v of b)h.add(v),this.k4h(v,h)}dF(b=!1){const h=new Fb.a;if(this.If){var v=this.$l.QT(this.start,this.end);for(var D of v)v=we.a.create(D),this.lr.bbd(v,this.objectId,b),h.add(v)}else D=
this.start.clone(),this.lr.bbd(D,this.objectId,b),h.add(D);return h}dbd(b){const h=this.$l.QT(this.start,this.end);for(let v=0;v<h.count;v++){const D=this.lr.Wof(h.J(v),this.objectId,!1);if(D){for(let P=0;P<D.count;P++)b(D.J(P));h.J(v).hk()}}}t4h(b,h){const v=new Sys.StringBuilder;h=this.$l.QT(b,h);for(const D of h)D.id.equals(b.node.id)||v.append("\r"),v.append(fe.ParagraphReader.plainText(D));return v.toString()}}Object(n.a)(qB,"ContentControl",null,[727]);class YC{constructor(b){this.zd=b}uBb(b,
h,v,D,P,ca,ta,Ra,mb){return new qB(b,h,v,D,P,ca,this,ta,Ra,mb,this.zd)}}Object(n.a)(YC,"ContentControlFactory",null,[706]);class jC{constructor(b,h,v,D,P){this.mi=b;this.lr=h;this.Umk=v;this.wW=D;this.Fa=P}CVo(b,h,v){var D,P;if(!(ui.a.k$e&&b&&h&&v))return!1;const ca=b.contentControlNode;if(!ca)return!1;var ta=ca.ia(Bc.a.iBb,W.a.nil);ta&&!ta.equals(W.a.nil)?b=this.mi.value.Db(ta):(b=this.lr.lPc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0),b=null===(D=null===b||void 0===b?void 0:b.formatting)||
void 0===D?void 0:D.yn,b||(b=new WA.a,this.mi.value.Pu(b,null)),ca.setValue(Bc.a.iBb,b.id));D=this.mi.value.Db(b.id);ta="boolean"===typeof v&&v;const Ra=null===(P=this.Fa)||void 0===P?void 0:P.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);h=this.Umk.Bqf(ca,D,h,v,Ra?null:ta);h=this.wW.Zoe(h);for(const [mb,Jb]of h)b.setValue(mb,Jb);return!0}}Object(n.a)(jC,"ContentControlFormattingManager",null,[704]);var tz=c(926);class Su{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,
Ac){this.wx=b;this.mi=h;this.Wc=v;this.pwb=D;this.U_j=P;this.uK=ca;this.nh=ta;this.fb=Ra;this.frd=mb;this.Sjd=Jb;this.zd=Ub;this.zCe=cc;this.rea=Ac}get Qs(){return this.zd.Qs}get xt(){return this.zd.xt}get ix(){return this.wx.value}Fva(){const b=this.Wc.Bk();b.set(this.ix);this.pwb.fP(b);if(b.Sb(25))return b;this.Sjd.instance&&this.Sjd.instance.woa&&u.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");u.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");
return null}DOc(b,h,v=!1){this.b6b();const D=new Fb.a;let P;if(b){P=b.Sb(26);if(!P)return D;for(;P&&(!h(P)||(D.add(P),!v));){D.addRange(this.DOc(b,h));if(v&&0<D.count)break;P=b.Pf(26)}b.wc()}return D}x7l(){const b=this.Wc.Bk();b.set(this.wx.value);this.pwb.fP(b);return b.currentNode}xQa(b,h,v){let D;D=b.equals(h);D||(D=(b=this.una(b,v))?b.id.equals(h):!1);return D}LOa(b,h){var v,D,P,ca;b=this.gu(b);if(!b)return null;let ta=null;for(;55===b.type;){let Ra;Ra=ui.a.Hj?this.zd.zq(b.id,h):h?null!==(D=this.zd.Qs.get(null===
(v=b.id)||void 0===v?void 0:v.toString()))&&void 0!==D?D:W.a.nil:null!==(ca=this.zd.xt.get(null===(P=b.id)||void 0===P?void 0:P.toString()))&&void 0!==ca?ca:W.a.nil;if(Ra.equals(ta)){b=null;break}else b=this.gu(Ra);ta=Ra}return b}una(b,h){return(b=this.LOa(b,h))?fe.ParagraphReader.Wb(b)?b:h?this.fb.Vk(b):this.fb.PD(b):null}FQh(b,h=!1){this.IUo(b);this.GQh(b,h)}IUo(b){var h,v,D,P,ca,ta,Ra,mb,Jb=this.Eva(b);Jb=this.Eva(Jb.parentNode);Jb=55===Jb.currentNode.type?Jb.currentNode.id:null;let Ub;Ub=this.gu(ui.a.Hj?
this.zd.zq(b.id,!0):null!==(v=this.zd.Qs.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==v?v:W.a.nil);for(h=this.gu(ui.a.Hj?this.zd.zq(b.id,!1):null!==(P=this.zd.xt.get(null===(D=b.id)||void 0===D?void 0:D.toString()))&&void 0!==P?P:W.a.nil);Ub&&55===Ub.type;)Ub=this.gu(ui.a.Hj?this.zd.zq(Ub.id,!0):null!==(ta=this.zd.Qs.get(null===(ca=Ub.id)||void 0===ca?void 0:ca.toString()))&&void 0!==ta?ta:W.a.nil);for(;h&&55===h.type;)h=this.gu(ui.a.Hj?this.zd.zq(h.id,!1):null!==(mb=this.zd.xt.get(null===
(Ra=h.id)||void 0===Ra?void 0:Ra.toString()))&&void 0!==mb?mb:W.a.nil);Ub&&h&&this.FFj(Ub.id,h.id,Jb,cc=>{cc=cc.ia(Bc.a.eX,W.a.nil);return!cc||cc.equals(W.a.nil)||b.id.equals(cc)})}GQh(b,h=!1){var v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc;u.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");const id=this.Eva(b),vd=this.Eva(id.parentNode);let xe=W.a.nil,Ld=W.a.nil;var Qd=vd.currentNode.ia(Bc.a.contentControlNode,[]);const Zd=new Fb.a;for(let Qf=0;Qf<Qd.length;Qf++)Zd.add(Qd[Qf]);
if(h){if(54!==vd.currentNode.type){xe=ui.a.Hj?this.zd.zq(vd.currentNode.id,!0):this.zd.Qs.get(null===(v=vd.currentNode.id)||void 0===v?void 0:v.toString());Ld=ui.a.Hj?this.zd.zq(vd.currentNode.id,!1):this.zd.xt.get(null===(D=vd.currentNode.id)||void 0===D?void 0:D.toString());Qd=this.gu(xe);for(v=this.gu(Ld);Qd&&55===Qd.type;)xe=ui.a.Hj?this.zd.zq(Qd.id,!0):this.zd.Qs.get(null===(P=Qd.id)||void 0===P?void 0:P.toString()),Qd=this.gu(xe);for(;v&&55===v.type;)Ld=ui.a.Hj?this.zd.zq(v.id,!1):this.zd.xt.get(null===
(ca=v.id)||void 0===ca?void 0:ca.toString()),v=this.gu(Ld)}P=this.Eva(b);if(P.Sb(26)){ca=new Fb.a;for(ca.add(P.currentNode);P.Pf(26);)ca.add(P.currentNode);for(var te of ca)this.GQh(te,h)}}else if(xe=ui.a.Hj?this.zd.zq(b.id,!0):this.zd.Qs.get(null===(ta=b.id)||void 0===ta?void 0:ta.toString()),Ld=ui.a.Hj?this.zd.zq(b.id,!1):this.zd.xt.get(null===(Ra=b.id)||void 0===Ra?void 0:Ra.toString()),h=this.o0l(Zd,b.id),te=this.Eva(b),te.Sb(26))for(P=this.Eva(te.currentNode),ca=P.currentNode,Qd=b;ca;)v=te.currentNode,
Zd.insert(h++,v.id),ca=P.Pf(26),D=this.Eva(v),54!==vd.currentNode.type?v.setValue(Bc.a.J7,vd.currentNode.id):v.removeProperty(Bc.a.J7),Mp.h(D,vd,Qd,26),Qd=D.currentNode,ca&&(te.set(ca),te.r1(this.Fva().currentNode));54!==vd.currentNode.type&&(h=ui.a.Hj?this.zd.zq(vd.currentNode.id,!0):null!==(Jb=this.zd.Qs.get(null===(mb=vd.currentNode.id)||void 0===mb?void 0:mb.toString()))&&void 0!==Jb?Jb:W.a.nil,mb=ui.a.Hj?this.zd.zq(vd.currentNode.id,!1):null!==(cc=this.zd.xt.get(null===(Ub=vd.currentNode.id)||
void 0===Ub?void 0:Ub.toString()))&&void 0!==cc?cc:W.a.nil,h.equals(b.id)&&(ui.a.Hj?this.zd.kE(vd.currentNode.id,xe,!0):this.zd.Qs.set(null===(Ac=vd.currentNode.id)||void 0===Ac?void 0:Ac.toString(),xe)),mb.equals(b.id)&&(ui.a.Hj?this.zd.kE(vd.currentNode.id,Ld,!1):this.zd.xt.set(null===(Lc=vd.currentNode.id)||void 0===Lc?void 0:Lc.toString(),Ld)));id.xg();u.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(Zd,b.id);Qd=Array(Zd.count);for(Ub=0;Ub<Zd.count;Ub++)Qd[Ub]=Zd.J(Ub);
vd.currentNode.setValue(Bc.a.contentControlNode,Qd);tz.a.VFa(b.id)}usk(b,h,v,D,P,ca,ta=null){var Ra,mb,Jb,Ub,cc,Ac,Lc,id;let vd,xe;h?(vd=this.gu(h.objectId),xe=this.Eva(vd)):(xe=this.Fva(),vd=xe.currentNode);const Ld=this.U_j.create(1074135145);ta&&Ld.properties.Vw(ta.properties);54!==vd.type&&Ld.setValue(Bc.a.J7,vd.id);ta?xe.PGb(Ld,v,26,ta.id):xe.JH(Ld,v,26);ui.a.contentControlAroundTableFix?(this.eIj(b,Ld.id,P,!0),this.eIj(b,Ld.id,ca,!1)):(ui.a.Hj?this.zd.kE(Ld.id,P,!0):this.zd.Qs.set(null===(Ra=
Ld.id)||void 0===Ra?void 0:Ra.toString(),P),ui.a.Hj?this.zd.kE(Ld.id,ca,!1):this.zd.xt.set(null===(mb=Ld.id)||void 0===mb?void 0:mb.toString(),ca));b.If&&(h&&(v=ui.a.Hj?this.zd.zq(vd.id,!0):null!==(Ub=this.zd.Qs.get(null===(Jb=vd.id)||void 0===Jb?void 0:Jb.toString()))&&void 0!==Ub?Ub:W.a.nil,Jb=ui.a.Hj?this.zd.zq(vd.id,!1):null!==(Ac=this.zd.xt.get(null===(cc=vd.id)||void 0===cc?void 0:cc.toString()))&&void 0!==Ac?Ac:W.a.nil,v.equals(P)&&(ui.a.Hj?this.zd.kE(vd.id,Ld.id,!0):this.zd.Qs.set(null===
(Lc=vd.id)||void 0===Lc?void 0:Lc.toString(),Ld.id)),Jb.equals(ca)&&(ui.a.Hj?this.zd.kE(vd.id,Ld.id,!1):this.zd.xt.set(null===(id=vd.id)||void 0===id?void 0:id.toString(),Ld.id))),this.FFj(P,ca,Ld.id,Qd=>{Qd=Qd.ia(Bc.a.eX,W.a.nil);const Zd=h?h.objectId:null;return!Qd||Qd.equals(W.a.nil)||Qd.equals(Zd)}));P=this.Eva(Ld);ca=Array(D.count);for(cc=D.count-1;0<=cc;cc--)ca[cc]=D.J(cc).objectId,Ac=this.gu(D.J(cc).objectId),Ac=this.Eva(Ac),Ac.currentNode.setValue(Bc.a.J7,Ld.id),Mp.h(Ac,P,null,26);0<ca.length&&
Ld.setValue(Bc.a.contentControlNode,ca);Su.Xb.isFeatureEnabled(38)&&(b.uJd&&Ld.setValue(Bc.a.fBb,b.uJd),b.ggf&&Ld.setValue(Bc.a.PFd,!0));return Ld}eIj(b,h,v,D){12===this.gu(v).type?this.zd.kE(h,v,D):(this.zd.ung(h,v,D),this.zd.kE(h,D?b.start.node.id:b.end.node.id,D))}Cio(b,h,v,D,P){b.setValue(Bc.a.J8,h);b.setValue(Bc.a.H3b,!0);b.setValue(Bc.a.hBb,!0);b.setValue(Bc.a.Tw,v);b.setValue(Bc.a.ffb,zy[0]);b.setValue(Bc.a.Ufa,!0);b.setValue(Bc.a.ifb,iA.a[P]);D&&b.setValue(Bc.a.aqb,D);b.setValue(Bc.a.I3b,
0)}GFj(b,h=null,v=null){h&&(ui.a.Hj?this.zd.kE(b,h,!0):this.zd.Qs.set(b.toString(),h));v&&(ui.a.Hj?this.zd.kE(b,v,!1):this.zd.xt.set(b.toString(),v))}VQh(b){if(!b||!b.count||!b.J(0))return null;const h=this.ptf(b);for(let v=0;v<b.count;v++)this.nh.eHa(b.J(v));return h}ptf(b){if(!b||!b.J(0))return null;const h=this.Wc.Bk();h.set(b.J(0));h.vd();h.wc();return h.pJ()?h.currentNode:null}I8l(b){const h=this.Wc.Bk();h.set(b);h.vd();h.wc();h.wc();return h}Voh(b,h,v){const D=new Fb.a;for(let P=0;P<v;P++){h=
this.uK.kjb(b,h,!0,null);if(!h||!b.Pd())return null;const ca=b.currentNode;b.wc();b.wc();D.add(ca)}return D}k9b(b){const h=this.Wc.Bk();h.set(b);for(h.zb(7);h.wc();)switch(h.currentNode.type){case 8:case 16:case 36:case 40:return h.currentNode.id}return null}sdi(b){const h=this.Wc.Bk();h.set(b);h.vd();return(b=h.OSa())?b.id:null}rrf(b){const h=this.Wc.Bk();h.set(b);return h.zb(7)?h:null}gu(b){return this.mi.value.Db(b)}b6b(){if(!Su.p0g){var b=this.Fva();b&&this.Lkg(b);Su.p0g=!0}}ATa(b){return this.frd.ATa(b)}SAk(b,
h){const v=this.Wc.Bk();v.set(b.node);const D=this.Wc.Bk();D.set(h.node);v.vd();D.vd();const P=this.Wc.Bk();P.set(v.currentNode);const ca=this.Wc.Bk();ca.set(D.currentNode);const ta=ch.returnToLowestCommonTableCell(v,D);return ta?(P.vd(),ca.vd(),{returnValue:({ml:b}=this.KAb(P,!0,ta,b)).returnValue&&({ml:h}=this.KAb(ca,!1,ta,h)).returnValue,z9c:b,XKc:h}):{returnValue:({ml:b}=this.KAb(v,!0,null,b)).returnValue&&({ml:h}=this.KAb(D,!1,null,h)).returnValue,z9c:b,XKc:h}}KAb(b,h,v,D){let P=null,ca=b.jd(16);
for(;ca!==v;){if(h&&Xg.TableCellReader.Gxi(b)||!h&&Xg.TableCellReader.vEf(b))P=b.jd(14);else return{returnValue:!1,ml:D};ca=b.jd(16)}P&&(D=we.a.create(P));return{returnValue:!0,ml:D}}Lkg(b){if(b.Sb(26)){for(this.Lkg(b);b.Pf(26);)this.Lkg(b);b.wc()}}remove(b,h){for(let v=0;v<b.count;v++)if(b.J(v).toString()===h.toString()){b.removeAt(v);break}}Eva(b){const h=this.Wc.Bk();h.set(b);h.r1(this.Fva().currentNode);return h}o0l(b,h){for(let v=0;v<b.count;v++)if(b.J(v).equals(h))return v;return-1}FFj(b,h,
v,D){b=this.nSl(b,h);for(h=0;h<b.count;h++)D(b.J(h))&&(v?b.J(h).setValue(Bc.a.eX,v):b.J(h).removeProperty(Bc.a.eX),this.Sjd.instance&&this.Sjd.instance.Ovi&&b.J(h).gl(16,!0))}nSl(b,h){const v=new Fb.a;var D=this.gu(b);const P=this.gu(h);if(!D||!P)return v;const ca=({HXc:ta}=this.ZNd(D,P)).returnValue;D=ta[ca];if(14===D.type)v.add(D);else if(15===D.type&&1<=ca){const Ra=ta[ca-1];1===cj.TableReader.ag(Ra)&&v.add(Ra)}var ta=he.GraphIterator.$a(ca>=ta.length-1?D:ta[ca+1]);ta.zb(7);for(D=Ka.a.Rs(ta,D);D.moveNext()&&
D.currentNode!==P;)14===D.currentNode.type&&v.add(D.currentNode);if(!W.a.eq(h,b)&&14===P.type)for(ta=he.GraphIterator.$a(P),D=Ka.a.Rs(ta,P);D.moveNext();)14===D.currentNode.type&&v.add(D.currentNode);return v}ZNd(b,h){b=this.nhb(b);h=this.nhb(h);let v=0;for(;v<b.length&&v<h.length&&b[v]===h[v];++v);return{returnValue:0<v?v-1:v,HXc:b,K8f:h}}nhb(b){const h=[];h.push(b);b=he.GraphIterator.$a(b);for(b.zb(7);b.wc();)h.push(b.currentNode);h.reverse();return h}static get Xb(){return null!=Su.Yyg?Su.Yyg:
Su.Yyg=Ea.a.instance.Na("Box4.IFeatureHelper")}zIc(b,h,v=!1){b=this.zCe.instance.Dcl(b);v?(v=Qp.a.ajl,b.setValue(Bc.a.q9b,v)):v=b.ia(Bc.a.q9b,null);h.setValue(Bc.a.JNa,v)}B_k(b,h){this.i2i(b)&&(b=b.ia(Bc.a.JNa,null),b=this.zCe.instance.E_k(b).ia(Bc.a.q9b,null),h.setValue(Bc.a.JNa,b))}mGj(b,h){if(!this.i2i(h))return!1;var v=h.ia(Bc.a.JNa,null);v?Ix(h)?this.zIc(b,h):this.zCe.instance.cZo(v,b):(v=this.rea.a8h())?h.setValue(Bc.a.JNa,v):this.zIc(b,h,!0);return!0}i2i(b){if(!b)return!1;var h=b.getValue(Bc.a.ifb);
if(!h)return!1;h=Object(iA.b)(h);b=b.getValue(Bc.a.fBb);return(0==h||1==h)&&b!==Bi.JTh}}Su.p0g=!1;Object(n.a)(Su,"ContentControlGraphManager",null,[703]);class Yt{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb){this.Jwe=Jb;this.Tja=null;this.QPm=(Ub,cc)=>{if(this.YX)return this.RPm(Ub,cc);if(!Ub||!Ub.count)return u.ULS.sendTraceTag(17356048,368,15,"The GNC list should not be null or empty"),!1;let Ac=!0;switch(cc){case 0:cc=this.XK(Ub.J(0),Ub.J(Ub.count-1),1);if((Ub=this.XK(Ub.J(0),Ub.J(Ub.count-1),3))&&0<
Ub.count){if(!Ub.J(0).isSupported||!Ub.J(0).isEditable){Ac=!1;break}for(Ub=Ub.J(0);Ub;)this.x4c(cc,Ub.id),Ub=this.getById(Ub.parentId)}if(cc)for(var Lc of cc)if(!Lc.isSupported||!Lc.isEditable){Ac=!1;break}break;case 1:if(Ub.J(0).contextId!==sc.a.Tc){u.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");Ac=!1;break}(cc=this.XK(Ub.J(0),Ub.J(0),1))&&0<cc.count&&(Ac=!1);break;case 2:if(Ub.J(0).contextId!==sc.a.Tc){u.ULS.sendTraceTag(17424994,
368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");Ac=!1;break}(cc=this.XK(Ub.J(0),Ub.J(0),3))&&0<cc.count&&(Ac=!1);break;case 3:case 4:cc=this.rQd(Ub.J(0),!0);Lc=this.rQd(Ub.J(Ub.count-1),!1);if(!cc||!Lc){u.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");Ac=!1;break}if((cc=this.XK(cc,cc,3))&&0<cc.count){Ac=!1;break}if((cc=this.XK(Lc,Lc,3))&&0<cc.count){Ac=!1;break}if(cc=
this.$l.XK(Ub.J(0),Ub.J(Ub.count-1),1))for(const id of cc)if(!id.mha){Ac=!1;break}break;default:Ac=!1}return Ac};Yt.wx=b;Yt.mi=h;this.Qg=v;this.lr=D;this.$l=P;this.W1=ca;this.rea=ta;this.Of=Ra;this.Co=mb}get dQa(){return!!this.Of.instance&&this.Of.instance.dQa}get woa(){return!!this.Of.instance&&this.Of.instance.woa}get vYd(){return!!this.Of.instance&&this.Of.instance.vYd}get YX(){return!!this.Of.instance&&this.Of.instance.YX}get yYd(){return!!this.Of.instance&&this.Of.instance.yYd}oHb(){return!!this.Of.instance&&
this.Of.instance.oHb}Nla(b,h,v=null,D=null,P=!1){if(!this.dQa)return{returnValue:2,id:0};b=this.Qg.una(b,!0);h=this.Qg.una(h,!1);if(!b||!h)return{returnValue:2,id:0};b=we.a.create(b);h=we.a.create(h);return this.Hnh(b,h,v,D,P,0,!1)}Ark(b,h,v=0,D=!1){return this.dQa&&b&&h?this.Hnh(b,h,null,null,!1,v,D):{returnValue:2,id:0}}$Ya(b,h=null,v=0,D=!1){let P=0;if(!this.dQa)return{returnValue:2,id:P};const ca=this.W1.uBb(h,Yt.wx,Yt.mi,this.Qg,this.lr,this.$l,this.rea,this.dQa,this.vYd);ca.type=v;ca.start=
b;ca.end=b;ca.qu=b.node.id;ca.nz=b.node.id;ca.If=!1;return this.$l.Ioh(ca,h,D)?(P=ca.id,{returnValue:0,id:P}):{returnValue:2,id:P}}tsk(b,h=null){if(!this.dQa||!this.hMm(b))return{returnValue:2,id:0};var v=b.J(0).contextId===sc.a.endOfParagraph?b.J(1):b.J(0);const D=b.J(b.count-1);if(this.S9e(b,sc.a.paragraph)||this.S9e(b,sc.a.endOfParagraph)){b=v.node.id;let P=D.node.id;const ca=b.equals(P);v=this.$l.Zuj(v,!0);void 0!==v&&null!==v&&(b=v,P=ca?b:P);this.$l.Zuj(D,!1);h.setValue(Bc.a.J8,!0);return this.Nla(b,
P,h)}return v!==D||v.contextId!==sc.a.Hd&&v.contextId!==sc.a.Tc?{returnValue:2,id:0}:(h.setValue(Bc.a.J8,!1),this.$Ya(v,h))}getById(b){if(!this.woa)return null;const h=this.Qg.DOc(this.Qg.Fva(),v=>v.getValue(Bc.a.Tw)===b,!0);return 0<h.count?this.$l.QQ(h.J(0)):null}getByTitle(b){if(!this.woa)return null;const h=this.Qg.DOc(this.Qg.Fva(),D=>D.ia(Bc.a.efb,null)===b,!1),v=new Fb.a;for(const D of h)v.add(this.$l.QQ(D));return v}getByTag(b){if(!this.woa)return null;const h=this.Qg.DOc(this.Qg.Fva(),D=>
D.ia(Bc.a.hfb,null)===b,!1),v=new Fb.a;for(const D of h)v.add(this.$l.QQ(D));return v}XK(b,h,v,D=!1){return this.woa?this.YX?this.$l.wna(b,h,v):this.$l.XK(b,h,v,D):null}QT(b,h){return this.$l.QT(b,h)}GMl(){if(!this.woa)return null;const b=this.Qg.DOc(this.Qg.Fva(),()=>!0,!1),h=new Fb.a;for(const v of b)h.add(this.$l.QQ(v));return h}YMb(b){if(!this.dQa)return u.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),2;b=this.getById(b);return this.$l.hya(b)?
0:2}hkl(b){if(!this.dQa)return 2;b=this.getById(b);return this.$l.deleteContentControl(b)?0:2}Ksk(b){this.$l.r9i(b)}UKk(b){this.Tja=b;this.Tja.OXn(this.QPm)}BSl(b){if(!this.oHb())return null;let h;var v=b.dF();h=this.rQd(v.J(v.count-1),!1);v=this.lr.lPc(v.J(v.count-1).node,h.cpBegin).Jb;b=this.ggm(v,b);if(-1===b)return null;h.Eb=b;h.Rb=h.Eb;return h}RPm(b,h){if(!b||!b.count)return u.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),!1;switch(h){case 0:return this.wKm(b);
case 3:case 4:case 6:return this.TRm(b,6===h);case 1:case 2:case 5:return 1!==b.count||b.J(0).contextId!==sc.a.Tc?(u.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.Eyi(b.J(0),5===h,!1);default:return!1}}wKm(b){const h=this.$l.wna(b.J(0),b.J(b.count-1),3);if(h&&0<h.count){var v=h.J(0);if(!v.isSupported||!v.isEditable)return!1}b=this.$l.wna(b.J(0),b.J(b.count-1),1);for(v=0;h&&v<h.count;v++)this.x4c(b,
h.J(v).id);if(b)for(const D of b)if(!D.isSupported||!D.isEditable)return!1;return!0}TRm(b,h){var v=b.J(0),D=b.J(b.count-1),P=v.wj,ca=D.Yo;if(-1===P||-1===ca)return!1;P=this.Co.q8(v.node,P,v.Eb);ca=this.Co.q8(D.node,ca,D.Rb);var ta=-1,Ra=Math.min(P.count,ca.count);for(--Ra;0<=Ra;Ra--){const mb=P.J(Ra).ke,Jb=ca.J(Ra).ke;if(mb.equals(Jb)){ta=Ra;break}}if(-1<ta&&(Ra=this.$l.QQ(P.J(ta).contentControlNode),!Ra.isEditable||!Ra.isSupported||Ra.zJ&&!this.aKm(Ra,b)))return!1;v=this.$l.wna(v,D,1);for(D=0;D<=
ta;D++)this.x4c(v,this.$l.QQ(P.J(D).contentControlNode).id);for(D=ta+1;D<P.count;D++){Ra=this.$l.QQ(P.J(D).contentControlNode);if(!Ra.isEditable||!Ra.mha||!Ra.isSupported||Ra.zJ)return!1;this.x4c(v,Ra.id)}for(P=ta+1;P<ca.count;P++){ta=this.$l.QQ(ca.J(P).contentControlNode);if(!ta.isEditable||!ta.mha||!ta.isSupported||ta.zJ)return!1;this.x4c(v,ta.id)}if(v)for(const mb of v)if(!mb.isSupported||!mb.mha)return!1;return h&&(b=this.rQd(b.J(0),!0))?this.Eyi(b,!0,!0):!0}aKm(b,h){h=this.Co.E8l(h.J(0),h.J(h.count-
1));return!!b&&!!h&&b.objectId.equals(h.ke)}Eyi(b,h,v){return(b=this.$l.wna(b,b,3))&&0<b.count&&(b=b.J(0),!b.isSupported||!b.isEditable||!this.yYd&&h&&!b.If||!v&&b.zJ||ui.a.CZf&&h&&1===b.type)?!1:!0}rQd(b,h){if(!b)return null;let v=null;switch(b.contextId){case sc.a.paragraph:v=h?we.a.Qc(b.node,0):we.a.mw(b.node);break;case sc.a.endOfParagraph:v=we.a.mw(b.node);break;case sc.a.Hd:v=h?we.a.Qc(b.node,b.cpBegin):we.a.Qc(b.node,b.cpEnd);break;case sc.a.Tc:v=b}v&&(v.Rb=v.Eb=h?b.Eb:b.Rb);return v}x4c(b,
h){if(b)for(const v of b)if(v.id===h){b.remove(v);break}}ggm(b,h){if(!b)return-1;let v=-1;for(let D=0;D<b.length;D++)if(b.J(D).ke.equals(h.objectId)&&!1===b.J(D).Mc){v=D;if(h.If&&0<D&&b.J(D-1).If&&!b.J(D-1).Mc)return-1;break}return v}hMm(b){if(void 0===b||null===b)return!1;for(let h=0;h<b.count;h++){const v=b.J(h).contextId;if(v!==sc.a.paragraph&&v!==sc.a.endOfParagraph&&v!==sc.a.Hd&&v!==sc.a.Tc||0<h&&h<b.count-1&&v===sc.a.Hd&&(b.J(h).cpBegin||b.J(h).cpEnd!==b.J(h).node.characterData.length))return!1}return b.J(0).contextId===
sc.a.endOfParagraph&&1===b.count||this.S9e(b,sc.a.Tc)&&1<b.count?!1:!0}S9e(b,h){for(const v of b)if(v.contextId===h)return!0;return!1}Hnh(b,h,v=null,D=null,P=!1,ca=0,ta=!1){let Ra=0;var mb=h.node;let Jb=we.a.create(b.node);mb=we.a.create(mb);if(ui.a.contentControlAroundTableFix){if(!({z9c:Jb,XKc:mb}=this.Jwe.FDh(Jb,mb)).success)return{returnValue:2,id:Ra}}else if(!({z9c:Jb,XKc:mb}=this.Qg.SAk(Jb,mb)).returnValue)return{returnValue:2,id:Ra};const Ub=this.W1.uBb(v,Yt.wx,Yt.mi,this.Qg,this.lr,this.$l,
this.rea,this.dQa,this.vYd);Ub.type=ca;Ub.start=b;Ub.end=h;Ub.qu=Jb.node.id;Ub.nz=mb.node.id;Ub.If=!0;Ub.uJd=D;Ub.ggf=P;return this.$l.Ioh(Ub,v,ta)?(Ra=Ub.id,{returnValue:0,id:Ra}):{returnValue:2,id:Ra}}}Yt.wx=null;Yt.mi=null;Object(n.a)(Yt,"ContentControlManager",null,[702]);var Tu=c(621),kC=c(142),Zt=c(187);class rB extends Sys.EventArgs{constructor(b){super();this.gPh=b}}Object(n.a)(rB,"ContentControlChangeEventArgs",Sys.EventArgs,[]);var rD=c(1493);class sB{constructor(){this.HRi=0;this.E0i=null}}
Object(n.a)(sB,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",null,[]);const Ap=b=>!(null===b||void 0===b?0:b.length),$t=b=>null==b?!1:[...b].some(h=>h.Mc),us=b=>null==b?!1:[...b].some(h=>!h.Mc);class Js{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id,vd,xe,Ld,Qd,Zd,te,Qf,Jg,Ml,Fm){this.nj=Ml;this.bch=[];this.mPe=[];this.wx=b;this.mi=h;this.Qg=v;this.lr=D;this.W1=P;this.Ce=mb;this.Xy=Jb;this.hb=ca;this.zE=ta;this.fBa=Ra;this.rea=Lc;this.Wyb=id;this.kfa=Ub;this.mI=cc;this.ga=Ac;this.Co=
vd;this.Of=xe;this.xh=Ld;this.fb=Qd;this.Ic=Zd;this.llh=te;this.ld=Qf;this.zd=Jg;this.mI&&(this.mI.addHandler(Tu.a.XMb,Object(z.a)(this,this.dYi,"onShowingPlaceholder")),this.mI.addHandler(Tu.a.Mde,Object(z.a)(this,this.lXi,"onRemoveWhenEdited")),Fm.execute(qp=>{this.xE=qp}))}get ix(){return this.wx.value}get Aj(){return this.mi.value}get YX(){return!!this.Of.instance&&this.Of.instance.YX}get Z_(){return!!this.ld&&this.ld.isFeatureEnabled(31)}dispose(){this.mI&&(this.mI.removeHandler(Tu.a.XMb,Object(z.a)(this,
this.dYi,"onShowingPlaceholder")),this.mI.removeHandler(Tu.a.Mde,Object(z.a)(this,this.lXi,"onRemoveWhenEdited")))}XK(b,h,v,D=!1){if(this.YX)return this.wna(b,h,v);if(!b||!h)return null;const P=this.Qg.una(b.node.id,!0);var ca=this.Qg.una(h.node.id,!1);if(!P||!ca)return null;b=b.contextId===sc.a.endOfParagraph?b:we.a.Qc(P,-1===b.cpBegin?0:b.cpBegin);h=h.contextId===sc.a.endOfParagraph?h:we.a.Qc(ca,-1===h.cpEnd?ca.characterData.length:h.cpEnd);ca=null;switch(v){case 0:ca=this.IWl(b,h);break;case 1:ca=
this.P8l(b,h);break;case 3:ca=this.Xdi(b,h,D);break;case 2:ca=this.khm(b,h);break;case 4:ca=this.$of(b,h,!1)}return ca}wna(b,h,v){if(!b||!h||b.contextId!==sc.a.endOfParagraph&&(b=this.oJh(b,!0),!b)||h.contextId!==sc.a.endOfParagraph&&(h=this.oJh(h,!1),!h))return null;let D=null;switch(v){case 0:D=this.JWl(b,h);break;case 1:D=this.Q8l(b,h);break;case 3:D=this.Ydi(b,h);break;case 2:D=this.lhm(b,h);break;case 4:D=this.$of(b,h,!0)}return D}oJh(b,h){var v=this.Qg.una(b.node.id,h);if(!v)return null;h?(h=
-1===b.cpBegin?0:b.cpBegin,b=b.Eb):(h=-1===b.cpEnd?v.characterData.length:b.cpEnd,b=b.Rb);v=we.a.Qc(v,h);v.Eb=b;v.Rb=b;return v}IWl(b,h){const v=new Fb.a;if(b.contextId===sc.a.endOfParagraph||h.contextId===sc.a.endOfParagraph||b.equals(h))return v;const D=new Gp.a,P=this.cEb(b,b),ca=this.cEb(h,h);for(let ta=0;ta<P.count;ta++)if(P.J(ta).Mc)for(let Ra=0;Ra<ca.count;Ra++)ca.J(Ra).Mc||P.J(ta).ke.equals(ca.J(Ra).ke)&&(!P.J(ta).If||this.Qg.xQa(P.J(ta).ke,b.node.id,!0)&&this.Qg.xQa(ca.J(Ra).ke,h.node.id,
!1))&&this.izd(v,D,P.J(ta).ke);return v}JWl(b,h){const v=new Fb.a;if(b.contextId===sc.a.endOfParagraph||h.contextId===sc.a.endOfParagraph||b.equals(h)&&b.Eb===b.Rb||-1===b.Eb||-1===h.Rb)return v;var D=b.node.pa.Mh(b.cpBegin),P=h.node.pa.Mh(h.cpEnd);D&&D.Jb&&0<D.Jb.length&&b.Eb<=D.Jb.length&&P&&P.Jb&&0<P.Jb.length&&h.Rb<=P.Jb.length&&(b=b.Eb,h=h.Rb,b===D.Jb.length&&b--,0<h&&h--,D=D.Jb.J(b),P=P.Jb.J(h),D.Mc&&!P.Mc&&W.a.eq(D.ke,P.ke)&&D.qp&&P.qp&&(P=D.contentControlNode)&&v.add(this.QQ(P)));return v}P8l(b,
h){const v=new Fb.a,D=new Gp.a,P=this.cEb(b,h);for(let ca=0;ca<P.count;ca++)this.izd(v,D,P.J(ca).ke);b=this.Xdi(b,h,!1,!1);for(const ca of b)D.contains(ca.objectId)||(v.add(ca),D.add(ca.objectId));return v}Q8l(b,h){const v=new Fb.a,D=new Gp.a,P=this.jof(b,h);for(let ca=0;ca<P.count;ca++)this.iZe(v,D,P.J(ca));b=this.Ydi(b,h);for(const ca of b)D.contains(ca.objectId)||(v.add(ca),D.add(ca.objectId));return v}Xdi(b,h,v,D=!0){const P=new Fb.a;b.equals(h)&&(v=!1);const ca=new Gp.a;let ta=!1;b=this.cEb(null,
b,!0,v);h=this.cEb(h,null,v,!0);for(v=b.count-1;0<=v;v--){for(let Ra=0;Ra<h.count&&!(b.J(v).ke.equals(h.J(Ra).ke)&&(b.J(v),this.izd(P,ca,b.J(v).ke)&&(ta=!this.Qg.gu(b.J(v).ke).ia(Bc.a.J7,null),D||ta)));Ra++);if(0<P.count&&(D||ta))break}return P}Ydi(b,h){const v=new Fb.a,D=new Gp.a,P=b.node;var ca=h.node;const ta=h.contextId===sc.a.endOfParagraph?ca.characterData.length:h.cpEnd;b=this.Co.q8(P,b.contextId===sc.a.endOfParagraph?P.characterData.length:b.cpBegin,b.Eb);h=this.Co.q8(ca,ta,h.Rb);ca=b.count>
h.count?h.count:b.count;for(--ca;0<=ca;ca--)b.J(ca).ke.equals(h.J(ca).ke)&&this.iZe(v,D,b.J(ca));return v}khm(b,h){const v=new Fb.a;let D=new Gp.a;const P=this.cEb(b,h);let ca=0,ta=null;if(b.equals(h))return v;for(b=0;b<P.count;b++)!P.J(b).Mc||P.J(b).If&&!this.Qg.xQa(P.J(b).ke,P.J(b).Ib.paragraph.id,!0)?P.J(b).Mc||P.J(b).If&&!this.Qg.xQa(P.J(b).ke,P.J(b).Ib.paragraph.id,!1)||(ca--,0>ca?(ca=0,D=new Gp.a):!ca&&ta&&P.J(b).ke.equals(ta)&&this.izd(v,D,ta)):(ca||(ta=P.J(b).ke),ca++);return v}lhm(b,h){const v=
new Fb.a;if(b.equals(h)&&b.Eb===h.Rb)return v;let D=new Gp.a;b=this.jof(b,h);h=0;let P=null;for(let ca=0;ca<b.count;ca++){const ta=b.J(ca);!ta.Mc||ta.If&&!this.Qg.xQa(ta.ke,ta.Ib.paragraph.id,!0)?ta.Mc||ta.If&&!this.Qg.xQa(ta.ke,ta.Ib.paragraph.id,!1)||(h--,0>h?(h=0,D=new Gp.a):!h&&P&&ta.ke.equals(P.ke)&&this.iZe(v,D,P)):(h||(P=ta),h++)}return v}$of(b,h,v){const D=new Fb.a;b=v?this.jof(b,h):this.cEb(b,h);h=0;for(v=0;v<b.count;v++){var P=b.J(v);P.qp&&(P.Mc?h++:(h--,0>h?h=0:(P=this.QQ(P.contentControlNode))&&
D.add(P)))}return D}cEb(b,h,v=!0,D=!0){const P=new Fb.a,ca=this.QT(b,h);if(!ca.count)return P;let ta,Ra,mb,Jb;for(let Ub=0;Ub<ca.count;Ub++){ta=0;Ra=ca.J(Ub).characterData.length;mb=Jb=!0;if(b&&ca.J(Ub).id.equals(b.node.id)){if(b.contextId===sc.a.endOfParagraph)continue;0<=b.cpBegin&&(ta=b.cpBegin)}h&&ca.J(Ub).id.equals(h.node.id)&&0<=h.cpEnd&&(Ra=h.cpEnd);Ub||(mb=v);Ub!==ca.count-1||h&&h.contextId===sc.a.endOfParagraph||(Jb=D);P.addRange(this.kof(ca.J(Ub),ta,Ra,mb,Jb))}return P}jof(b,h){const v=
new Fb.a,D=this.QT(b,h);let P,ca,ta;for(let mb=0;mb<D.count;mb++){const Jb=D.J(mb);if(Jb.pa.length){var Ra=Jb.pa.J(Jb.pa.length-1);P=0;ca=Jb.characterData.length;ta=0;Ra=Ra&&Ra.Jb?Ra.Jb.length:0;b&&Jb.id.equals(b.node.id)&&(P=b.wj,ta=b.Eb);h&&Jb.id.equals(h.node.id)&&(ca=h.Yo,Ra=h.Rb);v.addRange(this.lof(Jb,P,ca,ta,Ra))}}return v}kof(b,h,v,D=!0,P=!0,ca=!0){const ta=new Fb.a;b=b.pa;for(let Ra=0;Ra<b.length;Ra++){if(b.J(Ra).cp<h)continue;if(b.J(Ra).cp>v)break;const mb=b.J(Ra);if(mb.Jb&&0<mb.Jb.length&&
(mb.cp!==h||D)&&(mb.cp!==v||P))for(let Jb=0;Jb<mb.Jb.length;Jb++){const Ub=mb.Jb.J(Jb);(ca||Ub.Mc)&&ta.add(Ub)}}return ta}lof(b,h,v,D,P){const ca=new Fb.a;b=b.pa;for(let ta=0;ta<b.length;ta++){if(b.J(ta).cp<h)continue;if(b.J(ta).cp>v)break;const Ra=b.J(ta);if(Ra.Jb&&0<Ra.Jb.length){let mb=0,Jb=Ra.Jb.length;Ra.cp===h&&-1!==D&&(mb=D);for(Ra.cp===v&&-1!==P&&(Jb=P);mb<Jb&&mb<Ra.Jb.length;mb++)ca.add(Ra.Jb.J(mb))}}return ca}izd(b,h,v){let D=null;if(h.contains(v)||!(D=this.Aj.Db(v)))return!1;b.add(this.QQ(D));
h.add(v);return!0}iZe(b,h,v){let D=null;!h.contains(v.ke)&&(D=v.contentControlNode)&&(b.add(this.QQ(D)),h.add(v.ke))}DCj(b,h){let v,D=!1;v=({W4a:h,V4a:b,m8c:D}=this.ECj(b,h,!1,D)).returnValue||D;D&&(v=v||({W4a:h,V4a:b,m8c:D}=this.ECj(h,b,!0,D)).returnValue);return{returnValue:v,W4a:h,V4a:b}}ECj(b,h,v,D){var P,ca,ta,Ra;let mb,Jb;if(v)return mb=Jb=null,{returnValue:!1,W4a:Jb,V4a:mb,m8c:!1};let Ub=!1;Jb=b;mb=h;const cc=b.cpBegin,Ac=h.cpEnd;D=!1;var Lc=v?this.o4h(h):this.VMl(b);let id=!1,vd=!1,xe=0,Ld=
0;for(const Qd of Lc)for(Lc=0;Lc<Qd.pa.length;Lc++){const Zd=Qd.pa.J(Lc);!vd&&Qd.id.equals(h.node.id)&&(vd=!0);if(!id&&(Qd.id.equals(h.node.id)&&-1!==Ac&&Zd.cp>Ac||vd&&!Qd.id.equals(h.node.id)))if(id=!0,xe!==Ld)Ub=!0;else return{returnValue:!1,W4a:Jb,V4a:mb,m8c:D};if((!Qd.id.equals(b.node.id)||Zd.cp>=cc||-1===cc)&&Zd.Jb)for(let te=0;te<Zd.Jb.length;te++){const Qf=Zd.Jb.J(te),Jg=this.Aj.Db(Qf.ke);if(!Jg.getValue(Bc.a.J8)||(!Qf.Mc||this.Qg.xQa(ui.a.Hj?this.zd.zq(Jg.id,!0):null!==(ca=this.zd.Qs.get(null===
(P=Jg.id)||void 0===P?void 0:P.toString()))&&void 0!==ca?ca:W.a.nil,Qd.id,!0))&&(Qf.Mc||this.Qg.xQa(ui.a.Hj?this.zd.zq(Jg.id,!1):null!==(Ra=this.zd.xt.get(null===(ta=Jg.id)||void 0===ta?void 0:ta.toString()))&&void 0!==Ra?Ra:W.a.nil,Qd.id,!1))){Qf.Mc?xe++:xe--;if(Ub&&xe===Ld)return{W4a:Jb,V4a:mb}=this.D$k(b.node,Qd,b.cpBegin,Zd.cp),{returnValue:!0,W4a:Jb,V4a:mb,m8c:D};!v&&xe<Ld&&(D=!0,Ld--)}}}return{returnValue:Ub,W4a:Jb,V4a:mb,m8c:D}}D$k(b,h,v,D){let P;h.id.equals(b.id)?b=0<v||D<fe.ParagraphReader.textLength(h)?
P=we.a.createTextRange(h,v,D):P=we.a.create(h):(P=0<v?we.a.createTextRange(b,v,fe.ParagraphReader.textLength(b)):we.a.create(b),b=D<fe.ParagraphReader.textLength(h)?we.a.createTextRange(h,0,D):we.a.create(h));return{W4a:P,V4a:b}}T4l(b){var h,v,D,P;const ca=b.cpBegin,ta=this.o4h(b);for(let mb=ta.count-1;0<=mb;mb--){const Jb=ta.J(mb);for(let Ub=Jb.pa.length-1;0<=Ub;Ub--){const cc=Jb.pa.J(Ub);if((!Jb.id.equals(b.node.id)||cc.cp<=ca||-1===ca&&!cc.cp)&&cc.Jb){var Ra=cc.Jb.length-1;for((cc.cp===ca||-1===
ca&&!cc.cp)&&this.YX&&Jb.id.equals(b.node.id)&&(Ra=b.Eb-1);0<=Ra;Ra--){const Ac=cc.Jb.J(Ra),Lc=this.Aj.Db(Ac.ke);if(Ac.Mc){if(Lc.getValue(Bc.a.J8)&&!this.Qg.xQa(ui.a.Hj?this.zd.zq(Lc.id,!0):null!==(P=this.zd.Qs.get(null===(D=Lc.id)||void 0===D?void 0:D.toString()))&&void 0!==P?P:W.a.nil,Jb.id,!0))continue;return null}if(!Lc.getValue(Bc.a.J8)||this.Qg.xQa(ui.a.Hj?this.zd.zq(Lc.id,!1):null!==(v=this.zd.xt.get(null===(h=Lc.id)||void 0===h?void 0:h.toString()))&&void 0!==v?v:W.a.nil,Jb.id,!1))return this.QQ(Lc)}}}}return null}QQ(b){if(!b)return null;
this.Qg.b6b();return this.W1.uBb(b,this.wx,this.mi,this.Qg,this.lr,this,this.rea,this.kfa,this.Wyb)}QT(b,h){b=this.n4h(b,h,Js.MEb(12));if(!b)return null;h=new Fb.a;for(const v of b)h.add(v);return h}TMl(b,h){const v=Js.b1l();return this.n4h(we.a.create(b.node),we.a.create(h.node),v)}n4h(b,h,v){if(!v||!b&&!h)return null;if(b&&h&&(b.equals(h)||b.node.id.equals(h.node.id))){var D=b.node;if(D&&v(D)){var P;return P=new Fb.a,P.add(D),P}}D=Object.assign(new sB,{HRi:35,E0i:v});b=b?b.node:null;h=h?h.node:
null;P=this.Vbm(b,h);if(!P)return null;h=this.VAk(h,v,Js.xzh,D);return this.PMl(b,h,P,v,Js.xzh,D)}Vbm(b,h){return(b=b?this.Pai(b):this.Pai(h))?b.jd(35):this.Qg.x7l()}VAk(b,h,v,D){if(!b)return null;h(b)||(h=this.QMl(b,h,v,D),h.count&&(b=h.J(h.count-1)));return b}PMl(b,h,v,D,P,ca){b?(b=he.GraphIterator.$a(b),b.zb(7),v=Ka.a.Rs(b,v)):v=Ka.a.Zo(v);P&&v.mo(P,ca);for(P=new Fb.a;v.moveNext()&&(D(v.currentNode)&&P.add(v.currentNode),!h||!v.currentNode.id.equals(h.id)););return P}QMl(b,h,v,D){b=Ka.a.Zo(b);
v&&b.mo(v,D);for(v=new Fb.a;b.moveNext();)h(b.currentNode)&&v.add(b.currentNode);return v}Pai(b){b=he.GraphIterator.$a(b);return b.zb(35)?b:null}kni(b,h){b=this.QT(b,h);for(const v of b)if((b=this.Qg.rrf(v))&&b.aha(4))return!0;return!1}Ioh(b,h=null,v=!1){if(!b)return!1;let D=b.start;var P=b.end;if(!$e.SelectionEditor.mv(D)&&D.contextId!==sc.a.paragraph||!$e.SelectionEditor.mv(P)&&P.contextId!==sc.a.paragraph||!this.YX&&({W4a:D,V4a:P}=this.DCj(b.start,b.end)).returnValue||this.YX&&!({start:D,end:P}=
this.uTk(D,P)).returnValue)return!1;b.start=D;b.end=P;const ca=this.EKm(D,P);if(this.YX){var ta=this.wna(b.start,b.end,3);var Ra=this.wna(b.start,b.end,2)}else ta=this.XK(b.start,b.end,3),Ra=this.XK(b.start,b.end,2);const mb=ta&&0<ta.count?ta.J(0):null,Jb=Ra&&0<Ra.count?Ra.J(0):null;if(v)return this.$Tc(b,0,ta)?!0:!1;if(this.$Tc(b,0,ta)){v=(v=Object(Na.a)(qB,this.T4l(b.start)))?this.Qg.gu(v.objectId):null;Ra=this.Qg.usk(b,mb,v,Ra,b.qu,b.nz,h);this.nj.Idc(Ra);if(b.If)for(P=this.QT(b.start,b.end),v=
0;v<P.count;v++)if(this.YX){ta=mb?mb.objectId:null;const Ub=this.uai(ta,P.J(v),!0);this.lr.Hta(P.J(v),Ra.id,0,!0,!0,void 0,void 0,void 0,void 0,Ub);ta=this.uai(ta,P.J(v),!1);this.lr.Hta(P.J(v),Ra.id,P.J(v).characterData.length,!0,!1,void 0,void 0,void 0,void 0,ta)}else this.lr.Hta(P.J(v),Ra.id,0,!0,!0),this.lr.Hta(P.J(v),Ra.id,P.J(v).characterData.length,!0,!1);else this.YX?(v=-1===D.Eb?0:D.Eb,this.lr.Hta(b.start.node,Ra.id,D.cpBegin,!1,!0,void 0,void 0,void 0,void 0,v),this.lr.Hta(b.end.node,Ra.id,
P.cpEnd,!1,!1,void 0,void 0,void 0,void 0,ca?v+1:P.Rb)):(this.lr.Hta(b.start.node,Ra.id,b.start.cpBegin,!1,!0),this.lr.Hta(b.start.node,Ra.id,b.start.cpEnd,!1,!1));h||this.Qg.Cio(Ra,b.If,b.id,this.Qg.k9b(this.Qg.gu(b.qu)),b.type);1===b.type&&this.lr.pSo(b.start.node,D.wj,D.Yo);b.objectId=Ra.id;h=this.Qg.Fva().currentNode;h.hasProperty(Bc.a.MHc)||h.setValue(Bc.a.MHc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);ui.a.r3a&&this.Qg.mGj(WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,
Ra);mb&&this.wHj(mb.contentControlNode,b);Jb&&this.wHj(Ra,Jb);ca&&this.ga.Qb(Gb.a.G8c,2,b.id);rD.a.JIh()&&this.xE&&this.xE.fireEvent(3,{node:Ra});return!0}return!1}deleteContentControl(b){if(!this.$Tc(b,3))return u.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete"),!1;if(this.nj.Had(b.contentControlNode))return!0;b.zJ&&(b.zJ=!1);const h=this.hb.gb.kb;b=b.dF();const v=new rg.Selection(b.toArray(),!0);let D=!1;this.hb.NNb(()=>{this.hb.setSelection(v);if(32===this.ga.processAction(Gb.a.AH,
2)){if(this.llh.instance){const P=this.llh.instance.bci(h,v,this.hb.gb.kb);this.hb.gUo(new kC.SelectionCollection([P],0))}D=!0}});return D}hya(b,h=!1,v=!1){if(this.$Tc(b,2)){if(b.zJ)return u.ULS.sendTraceTag(528537615,368,15,"Attempting to delete content control showing placeholder"),this.deleteContentControl(b);const D=ui.a.rr?b.contentControlNode:this.Qg.gu(b.objectId);let P=new Fb.a;h&&(P=b.wnf());P.add(b);if(v||!this.nj.Had(b.contentControlNode)){D&&D.anchor&&this.Qg.FQh(D,h);for(const ca of P)b=
this.QT(ca.start,ca.end),this.lr.rkl(b,ca.objectId);this.x6i(P)}u.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");return!0}u.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");return!1}Znj(b,h){if(this.$Tc(b,1)){let Ra=!1;h||(Ra=!0,{Tto:v,returnValue:h}=this.lFb(b),v&&this.Qg.Fva().currentNode.setValue(Bc.a.MHc,h));var v=b.m6h().toArray();for(var D=0;D<v.length;D++)this.hya(v[D],!0);v=this.jCo(h);if(b.If){D=this.QT(b.start,b.end);if(!D.count)return!1;
if(1===D.count&&w.AFrameworkApplication.HD)this.lr.replaceTextRange(we.a.createTextRange(D.J(0),0,D.J(0).characterData.length),h);else{var P=this.Qg.I8l(D.J(0));h=D.J(0).t7b();D=this.Qg.VQh(D);D=this.Qg.Voh(P,D,v.length);for(P=0;P<D.count;P++){this.lr.replaceTextRange(we.a.createTextRange(D.J(P),0,0),v[P]);for(var ca=0;ca<h.count;ca++)this.lr.Hta(D.J(P),h.J(ca),0,!0,!0),this.lr.Hta(D.J(P),h.J(h.count-ca-1),D.J(P).characterData.length,!0,!1)}b.c_o(D.J(0).id,D.J(D.count-1).id);v=this.zE.pe(D.J(0),0);
this.hb.setSelection(v)}}else{P=0;1<v.length&&u.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");h=b.start;D=h.node;for(var ta=0;ta<D.pa.length&&h.contextId===sc.a.Hd;ta++)if(ca=D.pa.J(ta),ca.cp===h.cpBegin&&ca.blob){P++;for(ta+=1;ta<D.pa.length;ta++)if(ca=D.pa.J(ta),ca.cp>h.cpBegin&&ca.cp<=h.cpEnd)if(ca.blob)P++;else break;else if(ca.cp>h.cpEnd)break;break}if(0<P&&P+h.cpBegin<h.cpEnd)D=we.a.createTextRange(h.node,h.cpBegin,
h.cpBegin+P),h=we.a.createTextRange(h.node,h.cpBegin+P,h.cpEnd),this.lr.replaceTextRange(h,v[0]),this.lr.replaceTextRange(D,"");else if(0<P&&P+h.cpBegin===h.cpEnd)for(this.lr.replaceTextRange(b.start,v[0]),v=0;v<D.pa.length;v++){if(P=D.pa.J(v),P.cp===h.cpBegin){P.blob=null;break}}else w.AFrameworkApplication.HD?(v=v.join(" "),this.lr.replaceTextRange(b.start,v)):this.lr.replaceTextRange(b.start,v[0])}this.Gzb(b,Ra);let mb;this.AOn((mb=new Fb.a,mb.add(b),mb));return!0}return!1}Gzb(b,h){const v=this.lr.lPc(b.start.node,
0<=b.start.cpBegin?b.start.cpBegin:0);if(v){const D=this.Qg.gu(b.objectId);if(h){h=this.Xy.NC(b.start.node);let P=h.Di(Qp.a.AZf);P||(P=h.GEa(Qp.a.iEn));P&&(this.Ce.Kfa(v.formatting),this.Ce.M6a(v.formatting,P));D&&(b.zJ=!0)}else D&&b.zJ&&(this.s8n(b,v),b.zJ=!1)}else u.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control")}s8n(b,h){b=this.Qg.gu(b.objectId);let v=null;b&&(v=b.ia(Bc.a.iBb,W.a.nil));this.Ce.Kfa(h.formatting);v&&!v.equals(W.a.nil)&&(b=this.mi.value.Db(v),
h.formatting=b)}lFb(b){let h=!1;b=b.placeholderText;this.HTm(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,h=!0);return{returnValue:b,Tto:h}}AZn(b,h=!0){this.kfa&&(h&&this.wZn(b),this.EZn(b))}BZn(b){if(this.kfa&&(b=this.XK(b,b,4)))for(const h of b)this.hya(h,!1)}Hnn(b,h){if(h&&!b.Mc&&(this.Qg.b6b(),(b=b.Ib.paragraph.Kc.Db(b.ke))&&b.anchor)){this.Qg.FQh(b);b=this.W1.uBb(b,this.wx,this.mi,this.Qg,this.lr,this,this.rea,this.kfa,this.Wyb);let v;this.x6i((v=new Fb.a,v.add(b),v))}}lXi(b,
h){this.Qg.b6b();b=this.Qg.gu(h.ke);const v=this.QQ(b);if(v&&v.isValid()&&v.removeWhenEdited){const D=this.Ic.Oc(7);D.Cb(b);this.hya(v,!1);h.state=2;D.dispose()}}dYi(b,h){this.Qg.b6b();b=this.Qg.gu(h.ke);this.KIm(b)&&(b=b.ia(Bc.a.Tw,0),this.ga&&(this.ga.Qb(Gb.a.G8c,2,b),Js.Ld.Q0e()))}KIm(b){return b&&b.isConnected&&!b.ia(Bc.a.K7,!1)?ui.a.rr?this.xYd(b)&&!b.Ru:this.xYd(b):!1}xYd(b){b=this.W1.uBb(b,this.wx,this.mi,this.Qg,this.lr,this,this.rea,this.kfa,this.Wyb);if(!b.isValid())return!1;if(b.If){if(b.qu.toString()===
b.nz.toString()){var h=this.Qg.gu(b.qu);if(!h)return u.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),!1;if(12===h.type&&1===h.pa.length)return this.Pvi(h.pa.J(0),b.objectId)}}else{h=b.start;if(!h)return u.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),!1;if(h.cpBegin===h.cpEnd)return h=this.Qg.gu(b.qu).pa.Mh(h.cpBegin),this.Pvi(h,b.objectId)}return!1}Pvi(b,h){b=b?b.Jb:null;if(!b)return!1;const v=
b.lJ(h,!0);return-1<v&&v+1<b.length&&b.J(v+1).ke.toString()===h.toString()}r9i(b){this.mPe.push(b)}Zuj(b,h){if(void 0===b||null===b||b.contextId!==sc.a.Hd)return null;b=we.a.Qc(b.node,h?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<fe.ParagraphReader.textLength(b.node)?this.Qg.ATa(b):null}select(b,h){if(b&&!b.equals(W.a.nil)){var v=this.Qg.gu(b);if(v&&55===v.type){v=this.QQ(v);if(v.If)v=this.KOl(v);else{v=v.start;ui.a.Vj&&(v.contextId=sc.a.Hd);if(!v)return;v=this.zE.Nn(v)}if(v&&v.length)return this.Xkj(v.Oa,
b,h,!0,!0),this.Xkj(v.Pc,b,h,!1,!1),this.hb.setSelection(v),v}}}$co(b,h){if(!$e.SelectionEditor.gf(b)||b.Eb!==b.Rb)return!1;const v=b.Eb;return-1===v?!1:(b=this.Co.S0a(b.node,b.cpBegin,v,!h))&&h===b.Mc?(h=this.QQ(b.contentControlNode),this.select(b.ke,!h.isEditable),!0):!1}KOl(b){var h=this.Qg.LOa(b.qu,!0);b=this.Qg.LOa(b.nz,!1);if(!h||!b)return null;h=this.TMl(we.a.create(h),we.a.create(b));if(!h||!h.count)return null;b=new Fb.a;for(let v=0;v<h.count;v++){let D;if(12===h.J(v).type)D=v===h.count-
1?we.a.createTextRange(h.J(v),0,fe.ParagraphReader.textLength(h.J(v))):we.a.create(h.J(v)),this.xh&&(D.Eb=this.xh.$q(D.node,!0),D.Rb=this.xh.$q(D.node,!1));else if(15===h.J(v).type)D=Zt.TableNodeContext.create(h.J(v));else continue;b.add(D)}return new rg.Selection(b.toArray(),!0)}aio(b){if(b&&!b.equals(W.a.nil)&&(this.Qg.b6b(),(b=this.Qg.gu(b))&&55===b.type&&b.isConnected)){var h=b.ia(Bc.a.K7,!1);b.setValue(Bc.a.K7,!1);h&&this.CUn(b)}}CUn(b){var h,v;const D=ui.a.Hj?this.zd.zq(b.id,!0):null!==(v=this.zd.Qs.get(null===
(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==v?v:W.a.nil;D.equals(W.a.nil)||(h=this.Qg.una(D,!0))&&(b=this.lr.Wof(h,b.id,!0))&&0<b.count&&(b=b.J(0),h=b.Ib,h.formatting=b.OQ?b.OQ.Df(h):new Ou.a(h,W.a.nil))}k$i(b){if(b=this.o7h(b))for(const h of b)this.nj.Ycg()&&(h.zJ=!1),this.hya(h,!1)}l7h(b){const h=new Fb.a;if(b=this.o7h(b))for(const v of b)h.add(v.contentControlNode);return h}CZn(b){if(b&&(11===b.type||14===b.type||15===b.type||16===b.type)){var h=this.fb.Vk(b),v=this.fb.PD(b);if(this.xh&&
h&&v){b=this.xh.$q(h,!0);const D=this.xh.$q(v,!1);h=we.a.create(h);v=we.a.create(v);h.Eb=b;v.Rb=D;if(b=this.wna(h,v,4))for(const P of b)this.hya(P,!1)}}}WMl(b){var h,v,D,P;const ca=ui.a.Hj?this.zd.zq(b.id,!0,b.loading):null!==(v=this.zd.Qs.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==v?v:W.a.nil;b=ui.a.Hj?this.zd.zq(b.id,!1,b.loading):null!==(P=this.zd.xt.get(null===(D=b.id)||void 0===D?void 0:D.toString()))&&void 0!==P?P:W.a.nil;if(ca.equals(W.a.nil)||b.equals(W.a.nil))return new Fb.a;
D=this.Qg.una(ca,!0);P=this.Qg.una(b,!1);return D&&P?this.QT(we.a.create(D),we.a.create(P))||new Fb.a:new Fb.a}LOa(b,h){return this.Qg.LOa(b,h)}Zqf(b,h){if(b&&55===b.type&&(b=this.QQ(b),b=h?b.start:b.end)){const v=we.a.Qc(b.node,h?b.wj:b.Yo);v.Eb=v.Rb=(h?b.Eb:b.Rb)+(h?-1:1);return v}return null}ySl(b){return(b=this.QQ(b))?b.start:null}Xkj(b,h,v,D,P){if((b.contextId===sc.a.Hd||b.contextId===sc.a.Tc||b.contextId===sc.a.paragraph)&&(P=b.node.pa.Mh(P?b.wj:b.Yo))&&P.Jb)for(let ca=0;ca<P.Jb.length;ca++){const ta=
P.Jb.J(ca);if(ta.ke.equals(h)&&ta.qp)if(D&&ta.Mc){b.Eb=v?ca:ca+1;break}else if(!D&&!ta.Mc){b.Rb=v?ca+1:ca;break}}}AOn(b){for(let h=0;h<this.bch.length;++h)(0,this.bch[h])(this,new rB(b))}x6i(b){for(let h=0;h<this.mPe.length;++h)(0,this.mPe[h])(this,new rB(b))}EZn(b){b=we.a.create(b);if(b=this.XK(b,b,4))for(const h of b)h.If||this.hya(h,!1)}wZn(b){if(b=b.t7b())for(let v=0;v<b.count;v++){var h=this.Qg.gu(b.J(0));h=this.W1.uBb(h,this.wx,this.mi,this.Qg,this.lr,this,this.rea,this.kfa,this.Wyb);this.hya(h)}}VMl(b){return this.QT(b,
null)}$Tc(b,h,v=null){let D=!0;try{if(!b)return u.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),!1;u.ULS.sendTraceTag(529106508,368,50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",h,b.isSupported,b.mha));if(!ui.a.rr&&this.fBa&&Dp.a.instance.J(1)&&this.fBa.fR(this.wx.value))return u.ULS.sendTraceTag(529106509,368,50,"Content Control Change Invalid because track changes is enabled"),!1;if(this.SPm(h)&&this.TPm(h)&&!this.LIm(b))return!1;if(!v){const ta=
this.D8l(b);ta&&(v=new Fb.a,v.add(ta))}var P=this.Qg.sdi(b.start.node);const ca=this.Qg.sdi(b.end.node);if(P&&ca&&!P.equals(ca)||!P&&ca||P&&!ca)return!1;P=!0;if(v&&0<v.count){if(!v.J(0).isSupported)return!1;P=v.J(0).isEditable}switch(h){case 0:D=this.hGm(b,P);break;case 1:D=(this.Z_||!this.xZd(b))&&b.isSupported&&b.isEditable&&this.Suh(b)&&this.Svi(b);w.AFrameworkApplication.HD||(D=D&&!this.kni(b.start,b.end));break;case 2:const ta=b.QUm?!0:b.isSupported;D=(this.Z_||!this.xZd(b))&&ta&&b.mha&&P;u.ULS.sendTraceTag(529106510,
368,50,"True");break;case 3:D=b.isSupported&&b.mha&&P&&this.Suh(b)&&this.Svi(b)&&!this.kni(b.start,b.end)}}catch(ca){u.ULS.sendTraceTag(17413646,368,15,"Exception was caught in IsContentControlValid. OperationType: "+h+", Exception: "+ca),D=!1}return D}TPm(b){return!(w.AFrameworkApplication.HD&&1===b)}SPm(b){return!(this.YX&&(!b||2===b||3===b))}hGm(b,h){if(ui.a.CZf)return this.iGm(b,h);let v=!0;if(!this.Z_&&this.xZd(b))v=!1;else if(this.YX)this.YX?b.If||$e.SelectionEditor.mv(b.start)||b.start.contextId===
sc.a.endOfParagraph?b.If&&(b.start.contextId!==sc.a.paragraph&&b.start.contextId!==sc.a.endOfParagraph||b.end.contextId!==sc.a.paragraph&&b.end.contextId!==sc.a.endOfParagraph)&&(v=!1):v=!1:v=h?this.hvi(b):!1;else if(!(b.If||-1!==b.start.cpBegin&&-1!==b.end.cpEnd&&b.start.equals(b.end)))v=!1;else if(b.If&&(b.start.contextId!==sc.a.paragraph||b.end.contextId!==sc.a.paragraph||b.start.equals(b.end)&&!fe.ParagraphReader.textLength(b.start.node)))v=!1;else if(b.start.contextId===sc.a.Tc||b.end.contextId===
sc.a.Tc||b.start.contextId===sc.a.endOfParagraph||b.end.contextId===sc.a.endOfParagraph)v=!1;return v}iGm(b,h){return(this.Z_||!this.xZd(b))&&this.jGm(b)&&this.jMm(b)&&h&&!this.BNm(b)&&this.hvi(b)?!0:!1}jMm(b){var h;const v=b.start,D=v.contextId,P=null===(h=b.end)||void 0===h?void 0:h.contextId;return b.If?D!==sc.a.paragraph&&D!==sc.a.endOfParagraph||P!==sc.a.paragraph&&P!==sc.a.endOfParagraph?!1:!0:$e.SelectionEditor.mv(v)||D===sc.a.endOfParagraph?!0:!1}o7h(b){if(!b||!b.length)return null;const h=
b[0];b=b[b.length-1];this.xh&&(this.fb.lm(h)&&12===h.node.type&&(h.Eb=this.xh.$q(h.node,!0)),this.fb.lm(b)&&12===b.node.type&&(b.Rb=this.xh.$q(b.node,!1)));return this.wna(h,b,4)}Suh(b){b=b.wnf();for(const h of b)if(!h.isSupported||!h.mha)return!1;return!0}LIm(b){if(this.DCj(b.start,b.end).returnValue)return!1;const h=this.XK(b.start,b.end,2);if(!h)return!0;for(const v of h)if(!v.objectId.equals(b.objectId)&&(v.If&&(v.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||
v.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===fe.ParagraphReader.textLength(v.end.node)))||!v.If&&(b.start.node.id.equals(v.start.node.id)&&(-1!==b.start.cpBegin?v.start.cpBegin===b.start.cpBegin:!v.start.cpBegin)||b.end.node.id.equals(v.end.node.id)&&(-1!==b.end.cpEnd?v.end.cpEnd===b.end.cpEnd:v.end.cpEnd===fe.ParagraphReader.textLength(b.end.node)))))return!1;return!0}Svi(b){if(b.If){var h=this.Qg.gu(b.qu),v=this.Qg.gu(b.nz);let D=null;if(12===h.type&&12===v.type){h=this.Qg.k9b(h);
h=this.Qg.gu(h);v=this.Qg.k9b(v);v=this.Qg.gu(v);if(!h||!v)return!1;16===h.type&&16===v.type&&h.id.equals(v.id)&&(D=h)}b=this.QT(b.start,b.end);if(!b.count)return!1;for(const P of b)if(b=this.Qg.k9b(P),b=this.Qg.gu(b),!b||!(16!==b.type||D&&b.id.equals(D.id)))return!1}return!0}xZd(b){return b.If?!1:(b=b.start.node)?!b.ia(Bc.a.Njb,!0):!0}jGm(b){return 1!==b.type?!0:b.qu.equals(b.nz)&&fe.ParagraphReader.Wb(b.start.node)&&!this.Orm(b)?!0:!1}Orm(b){const h=b.start;var v=h.node;const D=v.pa;if(b.If){if(v.Vs||
v.bha||v.hasBookmark)return!0;for(var P of D)if(this.pni(P))return!0;return!1}b=h.wj;v=h.Yo;let ca=P=null;for(const ta of D.xEi(b,v))if(!(ta.cp<b))if(ta.cp===b)P=ta;else if(ta.cp===v)ca=ta;else if(this.pni(ta))return!0;return this.Prm(h,P,ca)?!0:!1}pni(b){return Ap(b.Jb)&&Ap(b.rf)&&Ap(b.Dh)&&Ap(b.ed)&&null==b.hyperlink&&!b.Om&&null==b.blob?!1:!0}Prm(b,h,v){if(null==h&&null==v)return!1;const D=b.Eb;b=b.Rb;return null!=h&&(h.Jb&&D<h.Jb.length||null!=h.blob)||null!=v&&v.Jb&&0<b||null!=h&&null!=v&&($t(h.rf)&&
us(v.rf)||$t(h.Dh)&&us(v.Dh)||!Ap(h.ed)&&!Ap(v.ed)&&[...h.ed].some(P=>0===P.zg)&&[...v.ed].some(P=>3===P.zg)||null!=h.hyperlink&&v.Om)?!0:!1}BNm(b){var h,v;return(null!==(v=null===(h=this.XK(b.start,b.end,3))||void 0===h?void 0:h.toArray())&&void 0!==v?v:[]).some(D=>1===D.type)?!0:!1}hvi(b){if(!b.If)return!0;var h=this.Qg.gu(b.qu);b=this.Qg.gu(b.nz);if(Xg.TableCellReader.Twa(h)||Xg.TableCellReader.Twa(b)||Bl.a.Soa(h)||Bl.a.Soa(b))return!1;h=this.Qg.k9b(h);h=this.Qg.gu(h);b=this.Qg.k9b(b);b=this.Qg.gu(b);
return h&&b&&(16!==h.type&&16!==b.type||h.id.equals(b.id))?!0:!1}D8l(b){if(!b)return null;b=this.Qg.gu(b.objectId);if(!b)return null;b=b.ia(Bc.a.J7,W.a.nil);return b.equals(W.a.nil)?null:(b=this.Qg.gu(b))?this.QQ(b):null}o4h(b){return this.QT(null,b)}jCo(b){return(b||"").split(RegExp("\r\n|\r|\n"))}HTm(b){return b&&""!==b?!1:!0}uai(b,h,v){h=h.pa.Mh(v?0:h.characterData.length);if(!h)return u.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!h.Jb||
!h.Jb.length)return 0;if(!b)return v?0:h.Jb.length;for(let D=0;D<h.Jb.length;D++){const P=h.Jb.J(D);if(W.a.eq(P.ke,b)&&P.Mc===v)return v?D+1:D}return v?0:h.Jb.length}uTk(b,h){var v=b.node,D=h.node,P=b.contextId===sc.a.paragraph?0:b.cpBegin,ca=h.contextId===sc.a.paragraph?fe.ParagraphReader.textLength(D):h.cpEnd;v=this.Co.q8(v,P,b.Eb);D=this.Co.q8(D,ca,h.Rb);ca=!v||!v.count;P=!D||!D.count;if(ca&&P)return{returnValue:!0,start:b,end:h};if(ca)return{returnValue:this.mne(b,D.J(D.count-1).ke,!0),start:b,
end:h};if(P)return{returnValue:this.mne(h,v.J(v.count-1).ke,!1),start:b,end:h};if(v.count===D.count)return v=v.J(v.count-1),D=D.J(D.count-1),{returnValue:v.ke.equals(D.ke),start:b,end:h};v=(ca=v.count<D.count)?D.J(D.count-1):v.J(v.count-1);return{returnValue:ca?this.mne(b,v.ke,!0):this.mne(h,v.ke,!1),start:b,end:h}}mne(b,h,v){var D=b.node;let P;if(v){P=b.contextId===sc.a.paragraph?0:b.cpBegin;var ca=b.Eb}else P=b.contextId===sc.a.paragraph?fe.ParagraphReader.textLength(D):b.cpEnd,ca=b.Rb;D=D.pa.Mh(P);
if(-1===ca||!D||!D.Jb||!D.Jb.length)return!1;D=D.Jb;if(v)for(v=ca;v<D.length;v++){ca=D.J(v);if(!ca.Mc)break;if(ca.ke.equals(h))return b.Eb=v+1,!0}else for(v=ca-1;0<=v;v--){ca=D.J(v);if(ca.Mc)break;if(ca.ke.equals(h))return b.Rb=v,!0}return!1}EKm(b,h){return this.wHk(b,h)&&b.Eb===b.Rb&&(b.contextId===sc.a.Tc||b.contextId===sc.a.paragraph&&!b.node.characterData.length)}wHk(b,h){return b.equals(h)&&b.Eb===h.Eb&&b.Rb===h.Rb}wHj(b,h){var v,D,P,ca,ta,Ra;if(b&&h.If){var mb=ui.a.Hj?this.zd.zq(b.id,!0):null!==
(D=this.zd.Qs.get(null===(v=b.id)||void 0===v?void 0:v.toString()))&&void 0!==D?D:W.a.nil;v=this.Qg.una(h.qu,!0);mb.equals(v?v.id:null)&&(ui.a.Hj?this.zd.kE(b.id,h.objectId,!0):this.zd.Qs.set(null===(P=b.id)||void 0===P?void 0:P.toString(),h.objectId));P=ui.a.Hj?this.zd.zq(b.id,!1):null!==(ta=this.zd.xt.get(null===(ca=b.id)||void 0===ca?void 0:ca.toString()))&&void 0!==ta?ta:W.a.nil;ca=this.Qg.una(h.nz,!1);P.equals(ca?ca.id:null)&&(ui.a.Hj?this.zd.kE(b.id,h.objectId,!1):this.zd.xt.set(null===(Ra=
b.id)||void 0===Ra?void 0:Ra.toString(),h.objectId))}}static get Ld(){return null!=Js.JIg?Js.JIg:Js.JIg=Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static MEb(b){return h=>h.type===b}static b1l(){return b=>12===b.type||15===b.type}static xzh(b,h){return b.We===h.HRi||b.parentNode&&h.E0i(b.parentNode)?!1:!0}}Object(n.a)(Js,"ContentControlOperator",null,[700,10,701]);class lC{constructor(b,h,v){this.Wc=b;this.wx=h;this.pwb=v}Pji(b){const h=this.NEb();return h&&b&&this.IFb(h,
b)?this.Fjm(h):null}IFb(b,h,v=!1){if(!b||!h)return!1;do{var D=b.currentNode;if(!D)break;D=D.ia(Bc.a.q9b,null);if(D===h||v&&D&&D.includes(h))return!0}while(b.Pf(29));return!1}Fjm(b){var h=b.Sb(1);b.wc();b=b.oJ(1);if(!h||!b)return null;h=Og.SelectionFactory.Ael(h,b);b=$e.SelectionEditor.Cj(h,!1,!1);return ui.a.r3a&&!b?null:Og.SelectionFactory.oz(h,b.Pc)}NEb(){const b=this.Wc.Bk();b.set(this.wx.value);this.pwb.fP(b);return b.Sb(28)&&b.Sb(29)?b:null}qrf(){const b=this.Wc.Bk();b.set(this.wx.value);this.pwb.fP(b);
return b.Sb(28)?b:null}VXl(b){var h=this.NEb();if(!h||!b||!this.IFb(h,b,!1))return null;h.Pd();b=1<h.Mp();h.Pd();h.Pd();h=h.currentNode;return fe.ParagraphReader.Wb(h)?{S9d:h,vni:b}:{S9d:null,vni:b}}a8h(){const b=this.NEb();return this.IFb(b,Qp.a.$Ph,!0)?b.currentNode.getValue(Bc.a.q9b):null}}Object(n.a)(lC,"GlossaryNavigator",null,[698]);class tB{constructor(b,h,v,D,P,ca){this.lr=b;this.Qg=h;this.$l=v;this.fb=D;this.oh=P;this.kfa=ca}j7c(b,h,v){if(!this.kfa)return 1;if(!({tableNode:P}=this.PGf(b)).returnValue||
!this.oh.LCi(P,h)||this.h$i(b,h))return 2;var D=this.oh.p4h(h);var P=D.J(0).t7b();P&&P.count||(P=new Fb.a,P.add(b.objectId));b=this.Qg.VQh(D);v=v.split("\n");h=Object(Na.a)(he.GraphIterator,this.Qg.rrf(h));h=this.Qg.Voh(h,b,v.length);for(b=0;b<h.count;++b){D=h.J(b);this.lr.replaceTextRange(we.a.createTextRange(D,0,0),v[b]);for(let ca=0;ca<P.count;++ca)this.lr.Hta(D,P.J(ca),0,!0,!0),this.lr.Hta(D,P.J(P.count-ca-1),D.characterData.length,!0,!1)}return 0}h$i(b,h){if(!this.kfa)return 1;let v;if(!({tableNode:v}=
this.PGf(b)).returnValue||!this.oh.LCi(v,h))return 2;h=this.oh.p4h(h);if(0<h.count&&(h=this.$l.XK(we.a.create(h.J(0)),we.a.create(h.J(h.count-1)),2)))for(const D of h)if(D.id!==b.id&&!this.$l.hya(D,!0))return 2;return 0}bcc(b){if(!this.kfa||!({tableNode:v}=this.PGf(b)).returnValue)return!1;b=b.wnf();for(var h of b)if(!h.mha||!h.isSupported)return!1;if(this.oh.BIm(v))return!1;var v=Object(Na.a)(he.GraphIterator,this.Qg.rrf(v));h=new Fb.a;this.fb.$hb(v,!0,!1,h);for(const D of h)if(0<D.ia(Bc.a.nDb,0)||
this.fb.t1a(D).Mx)return!1;return!0}PGf(b){let h=null;return b&&b.qu.toString()===b.nz.toString()&&b.isValid()&&b.isEditable&&b.isSupported?(h=this.Qg.gu(b.qu))&&14===h.type?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:null}:{returnValue:!1,tableNode:h}}}Object(n.a)(tB,"TableContentControlEditor",null,[697]);class Ay{BIm(b){let h=!1;const v=new he.GraphIterator;v.set(b);ch.forEachCellInTable(v,D=>{if(!Xg.TableCellReader.hg(D)){let P=xh.OutlineNavigator.h9(D);for(;P;){if(ig.OutlineElementReader.iRc(D))return h=
!0,!1;P=D.zi(1)}}return!0});return h}LCi(b,h){const v=new he.GraphIterator;v.set(h);return Xg.TableCellReader.Twa(h)&&v.zb(14)&&v.jd(14).id===b.id?!0:!1}p4h(b){const h=new Fb.a,v=new he.GraphIterator;v.set(b);b=new Fb.a;fe.ParagraphReader.$hb(v,!0,!1,b);for(const D of b)h.add(D);return h}}Object(n.a)(Ay,"TableReader",null,[447]);class dj{constructor(){this.$l=null}get name(){return"WordEditor.ContentControl"}init(){w.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled")&&(vr.a.tSa(Object(z.a)(Ea.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),
Ea.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").Hnn,"onContentControlRangeChanged")),this.$l=Ea.a.instance.Na("WordEditor.ContentControl.IContentControlOperator"),Ea.a.instance.resolve("WordEditor.ContentControl.ContentControlCCP").init(),Ea.a.instance.resolve("WordEditor.ContentControl.GlossaryEditor").init())}dispose(){this.$l&&(this.$l.dispose(),this.$l=null)}xc(b){b.ha("WordEditor.ContentControl.Perf.IPerfLogger",()=>new qD.a(Dd.a.af)).singleInstance();b.ha("WordEditor.ContentControl.ContentControlFactory",
()=>new YC(Ea.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").singleInstance();b.ha("WordEditor.ContentControlNodeFactory",()=>new nB(Ea.a.instance.Sa("Box4.ContentControlConfigSettings"),Ea.a.instance.Sa("Box4.ContentControl.IContentControlOperator"))).singleInstance();b.ha("WordEditor.ContentControl.ContentControlGraphManager",()=>new Su(new Gg.a(()=>Xa.App.xa.ib.Uc),new Gg.a(()=>Xa.App.xa.ib.Uc.od),new Qo.a,Wk.PageNavigator.instance,
Ea.a.instance.resolve("WordEditor.ContentControlNodeFactory"),Ea.a.instance.resolve("Box4.IOutlineEditor"),Ea.a.instance.resolve("Box4.IOutlineElementEditor"),Ea.a.instance.resolve("Box4.IParagraphReader"),Ea.a.instance.resolve("WordEditor.IParagraphSplitHelper"),Ea.a.instance.Sa("Box4.ContentControlConfigSettings"),Ea.a.instance.resolve("Box4.ContentControlParagraphMapping"),Ea.a.instance.Sa("WordEditor.ContentControl.GlossaryEditor"),Ea.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"))).as("WordEditor.ContentControl.IContentControlGraphManager").singleInstance();
b.ha("WordEditor.ContentControl.GlossaryNavigator",()=>new lC(new Qo.a,new Gg.a(()=>Xa.App.xa.ib.Uc),Wk.PageNavigator.instance)).as("WordEditor.ContentControl.IGlossaryNavigator").singleInstance();b.ha("WordEditor.ContentControl.ContentControlOperator",()=>new Js(new Gg.a(()=>Xa.App.xa.ib.Uc),new Gg.a(()=>Xa.App.xa.ib.Uc.od),Ea.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ea.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Ea.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),
Yh.a.instance,Ea.a.instance.resolve("Box4.ISelectionFactory"),Ih.PageReader.instance,Ea.a.instance.resolve("Box4.IFormattingEditor"),Ea.a.instance.resolve("Box4.Styles.IWACStyleReader"),w.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"),Ea.a.instance.Na("Box4.IContentControlDataChangedManager"),w.AFrameworkApplication.va,Ea.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),w.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Ea.a.instance.resolve("Box4.IContentControlChpHelper"),
Ea.a.instance.Sa("Box4.ContentControlConfigSettings"),Ea.a.instance.Na("Box4.IContentControlReader"),Ea.a.instance.resolve("Box4.IParagraphReader"),Ea.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Ea.a.instance.Sa("Box4.Actors.IVirtualSelectionMerger"),Ea.a.instance.resolve("Box4.IFeatureHelper"),Ea.a.instance.resolve("Box4.ContentControlParagraphMapping"),Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeEditor"),Ea.a.instance.Sa("WordEditor.Extension.RichApiEventManager"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").singleInstance();
b.ha("WordEditor.ContentControl.ContentControlManager",()=>new Yt(new Gg.a(()=>Xa.App.xa.ib.Uc),new Gg.a(()=>Xa.App.xa.ib.Uc.od),Ea.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ea.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Ea.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ea.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Ea.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),
Ea.a.instance.Sa("Box4.ContentControlConfigSettings"),Ea.a.instance.resolve("Box4.IContentControlChpHelper"),Ea.a.instance.resolve("Box4.IContentControlAroundTableChecker"))).as("WordEditor.ContentControl.IContentControlManager").singleInstance();b.ha("WordEditor.ContentControl.ContentControlChpManager",()=>new hC(Ea.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ea.a.instance.Sa("Box4.ContentControlConfigSettings"),Ea.a.instance.resolve("Box4.IParagraphReader"),Ea.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").singleInstance();
b.ha("WordEditor.ContentControl.GlossaryEditor",()=>new gC(Ea.a.instance.resolve("WordEditor.ContentControl.GlossaryNavigator"),Ea.a.instance.resolve("Box4.IOutlineElementEditor"),Ea.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ea.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ea.a.instance.resolve("Box4.TextFormattingHelper"),Ea.a.instance.resolve("Box4.IFormattingEditor"),Xa.App.Xj.zl.Ze(55))).as("WordEditor.ContentControl.IGlossaryEditor").singleInstance();b.ha("WordEditor.ContentControl.TableContentControlEditor",
()=>new tB(Ea.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Ea.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ea.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ea.a.instance.resolve("Box4.IParagraphReader"),new Ay,w.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").singleInstance();w.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&
b.ha("Box4.ContentControlConverter",()=>new iC(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IContentControlChpHelper"),b.resolve("Box4.IContentControlReader"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").singleInstance();b.ha("WordEditor.ContentControl.ContentControlCCP",()=>new XC(b.resolve("WordEditor.ContentControl.ContentControlOperator"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlGraphManager"),
b.resolve("WordEditor.ContentControl.Perf.IPerfLogger"),b.resolve("Box4.TrackChange.ITrackChangeEditor"))).singleInstance();b.ha("WordEditor.ContentControl.ContentControlFormattingManager",()=>new jC(new Gg.a(()=>Xa.App.xa.ib.Uc.od),Ea.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Ea.a.instance.resolve("Box4.Actors.TextFormattingActor"),Ea.a.instance.resolve("Box4.TextFormattingHelper"),w.AFrameworkApplication.K)).as("WordEditor.ContentControl.IContentControlFormattingManager").singleInstance()}static main(){N.a.instance.Fc(new dj)}}
Object(n.a)(dj,"ContentControlPackage",null,[1,2]);var m=c(1412),C=c(501),O=c(1764),ha=c(772);class e{constructor(b){this.contextualIntentInvocationSource=10;this.contextualIntentInvocationSource=b}}Object(n.a)(e,"UxManagerMenuActionTelemetryData",null,[]);class t extends Sys.EventArgs{constructor(b,h,v){super();this.definition=b;this.source=h;this.k3k=v}}Object(n.a)(t,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class A extends Sys.EventArgs{constructor(b,h){super();this.definition=b;this.source=h}}
Object(n.a)(A,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class R{constructor(b,h,v,D,P,ca,ta=!1,Ra=null,mb=null,Jb=null,Ub=!1,cc=null,Ac=!1,Lc=!0,id=null,vd=!1,xe=10){this.target=this.container=this.menu=null;this.isDismissed=!1;this.Y_c=this.I_c=this.NYh=this.onScroll=this.onResize=this.x0=this.sxa=this.AGa=this.documentElement=this.JR=this.editingElement=null;this.isFocused=!1;this.fJd=null;this.UYf=this.qDf=!1;this.xoe=null;this.kae=0;this.paragraphNode=b;this.cpBegin=h;this.cpEnd=v;this.definition=
D;this.Jqk=P;this.MQa=ca;this.bOa=ta;this.Nrj=Ra;this.Sma=mb;this.hostServices=Jb;this.Pwo=Ub;this.k_i=cc;this.asj=Ac;this.jpl=Lc;this.NYh=id;this.showDictationCommandUx=vd;this.source=xe}}Object(n.a)(R,"UxManagerState",null,[]);var da=c(1625);class ua{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb){this.Ub=b;this.hb=h;this.Sz=v;this.fd=D;this.ae=P;this.Gb=ca;this.Ri=ta;this.sk=Ra;this.DI=mb;this.jTb=Jb;this.KSe=!1;this._state=this.Q1g=null;this.shouldIgnoreFocusEvent=Ub=>{var cc;return this.fd.Bd.vy&&!this.fd.Bd.qU&&
Ub===(null===(cc=this.fd.editingView)||void 0===cc?void 0:cc.editingElement)};this.ra=new Mc.a;this.Wud=new ac.a;this.Rzd((Ub,cc)=>{ua.y5m(v,cc.definition,cc.source)});this.gqh((Ub,cc)=>{ua.x5m(v,cc.definition,cc.source,cc.k3k)});this.Ub.fe(ua.YMd).RH=!0;w.AFrameworkApplication.va.qa(Nc.a.ZJc,sc.a.view,this.ZJc.bind(this))}Rzd(b){this.ra.addHandler(ua.ZMf,b)}b6f(b){this.ra.removeHandler(ua.ZMf,b)}ZOn(b,h){this.ra.raiseEvent(ua.ZMf,new A(b,h))}gqh(b){this.ra.addHandler(ua.YMf,b)}U1n(b){this.ra.removeHandler(ua.YMf,
b)}YOn(b,h,v){this.ra.raiseEvent(ua.YMf,new t(b,h,v))}A_o(b){var h;if(!b.isDismissed&&b.JR){var v=da.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(v&&v.length){v=da.b(v);var D=Dd.a.getElementBounds(b.JR);v.width||v.height?v.x+v.width<D.x||v.x>D.x+D.width||v.y+v.height<D.y||v.y>D.y+D.height?this.dismiss():(D=b.target,D.style.left=v.x+"px",D.style.top=v.y+"px",D.style.width=v.width+"px",D.style.height=v.height+"px",null===(h=b.menu)||void 0===h?void 0:h.updatePosition(),b.menu||u.ULS.sendTraceTag(512255777,
341,50,"Menu is null so can't update position")):(u.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else u.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}p6i(b){b.isDismissed||b.xoe||(b.xoe=new qf.a(2,1,1,()=>{b.xoe=null;this.A_o(b)},147),this.Gb.Vb(b.xoe))}AGa(b,h){!b.isDismissed&&b.jpl&&0<h.QJ.length&&(this.dismiss(),u.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}mCk(b){return!!b&&
b.id===ua.Mqk}sxa(b,h){if(b.isDismissed||!h||!h.Hb)return!1;h=h.Hb;const v=h.keyCode,D=!b.isFocused&&!!b.menu,P=h.altKey||h.ctrlKey||h.shiftKey;let ca=!1;v===Ve.a.A1?(this.dismiss(),u.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),ca=!0):v!==Ve.a.Fs&&v!==Ve.a.Dw||!D||P||!this.mCk(b.definition)?v!==Ve.a.Gqb&&v!==Ve.a.jnc||!D||P||(this.p1f(b),b.menu?(b.menu.focus(),ca=!0,u.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):u.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):
(b.menu.executeDefaultAction(),u.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),ca=!0);ca&&(h.preventDefault(),h.stopPropagation());return ca}I_c(b,h){if(b.isDismissed||!b.menu)return u.ULS.sendTraceTag(512255776,341,50,"Could not Badge ID Invoke. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.invokeBadgeId(h);u.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}Y_c(b,h){if(b.isDismissed||!b.menu)return u.ULS.sendTraceTag(512255775,
341,50,"Could not action from string. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.executeActionFromString(h);u.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}x0(b,h){if(b.isDismissed||!h||!h.Hb||!b.menu)return u.ULS.sendTraceTag(512255774,341,50,"Could not perform onMouseMove. menu is dismissed: {0}, null mouseEvent: {1}, null mouseEvent.innerEvent: {2}, null menu: {3}",b.isDismissed,!h,!(null===h||void 0===
h?0:h.Hb),!b.menu),!1;const v=b.target;b=b.menu.getElementBounds();var D=h.Hb;h=D.clientX;D=D.clientY;v&&ua.l2i(h,D,Dd.a.getElementBounds(v),16)||b&&ua.l2i(h,D,ua.LMk(b),4)||this.dismiss();return!1}Lqo(b){var h=da.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!h||!h.length)return!1;h=da.a(h,"OfficeContextualTarget");if(!h)return!1;b.container=ua.sIc();b.target=h;b.editingElement=this.fd.editingView.editingElement;b.JR=this.fd.Bd.container;b.documentElement=document.documentElement;b.AGa=(v,D)=>{this.AGa(b,
D)};b.sxa=v=>this.sxa(b,v);b.x0=v=>this.x0(b,v);b.onScroll=()=>{this.p6i(b)};b.onResize=()=>{this.p6i(b)};b.showDictationCommandUx&&(b.I_c=v=>this.I_c(b,v),b.Y_c=v=>this.Y_c(b,v),this.jTb&&this.jTb.execute(v=>{v.imo(b.I_c);v.kmo(b.Y_c)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.hb.Pw(b.AGa);this.Ri.WZ(b.onResize);this.ae.nb(Ed.a.$F,b.editingElement,b.sxa);b.bOa&&this.sk.nb(Ed.a.Dca,b.documentElement,b.x0);Le.a.addHandler(b.JR,"scroll",b.onScroll);b.MQa||this.p1f(b);
return!0}OFb(b,h){const v=!!b.menu;this.YOn(b.definition,b.source,h);b.container&&document.body.removeChild(b.container);b.target&&document.body.removeChild(b.target);b.isFocused&&this.Ub.currentScope.name===ua.YMd&&this.Ub.CR(ua.YMd);b.AGa&&this.hb.CY(b.AGa);b.sxa&&b.editingElement&&this.ae.sc(Ed.a.$F,b.editingElement,b.sxa);this.jTb&&this.jTb.execute(D=>{b.showDictationCommandUx&&(D.V6n(),D.W6n());D.jmj(!1,b.showDictationCommandUx)});b.x0&&b.documentElement&&b.bOa&&this.sk.sc(Ed.a.Dca,b.documentElement,
b.x0);b.onScroll&&b.JR&&Le.a.removeHandler(b.JR,"scroll",b.onScroll);b.onResize&&this.Ri.ada(b.onResize);b.menu=null;b.container=null;b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.JR=null;b.AGa=null;b.sxa=null;b.x0=null;b.onScroll=null;b.onResize=null;b.I_c=null;b.Y_c=null;v&&b.Sma&&(b.qDf?b.UYf=!0:b.Sma(b.fJd))}M1a(b,h){var v;if(!h)return!1;switch(h.actionType){case Nm.b.Toggle:if(h.objectFulfillment===ua.RLo)return this.KSe=!this.KSe,this.Ymg(),this.VJc(b),!0;if(h.objectFulfillment===
ua.VLo)return{value:v}=this.Wud.Dc(h.suggestionGroup.type,!1),this.Wud.Z(h.suggestionGroup.type,!v),this.VJc(b),!0;break;case Nm.b.GiveFeedback:if(O.a.OJm(null===(v=h.suggestionGroup)||void 0===v?void 0:v.type)||ha.a.OTm(h.objectName))break;this.focus();this.Ymg();this.VJc(b);return!0;case Nm.b.RevealSuggestions:this.VJc(b)}b.qDf=!0;h=b.Jqk.executeAction(h,b.paragraphNode,b.cpBegin,b.cpEnd);b.qDf=!1;h&&this.VJc(b);b.UYf&&(b.UYf=!1,b.Sma(b.fJd),b.fJd=null);return h}VJc(b){b.x0&&b.documentElement&&
b.bOa&&(this.sk.sc(Ed.a.Dca,b.documentElement,b.x0),b.bOa=!1)}Iuo(b,h){return b.id===C.a.xdb?!1:!(0<=b.positionInSet&&0<b.setSize)&&!h}zDj(b){var h;if(this.Lqo(b)){var v=1;w.AFrameworkApplication.K.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(v=3);var D=!1;0<(null===(h=b.definition.suggestionGroups)||void 0===h?void 0:h.length)&&(D=b.definition.suggestionGroups[0].type,D=this.Wud.mb(D)?this.Wud.J(D):b.Pwo);h=!1;w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",
!1)&&(h=!0);v={containerElement:b.container,targetElement:b.target,definition:b.definition,onAction:P=>this.M1a(b,P),onDismiss:P=>{this.OFb(b,P)},keepCurrentFocus:b.MQa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.KSe,showDescription:D,showEditorButton:b.asj,showEditorBranding:this.Iuo(b.definition,b.asj),hostServices:b.hostServices,maxSuggestionGroupNumber:v,renderFooterIcons:h,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.NYh,showDictationCommandUx:b.showDictationCommandUx,
editingElement:b.editingElement};b.k_i&&b.k_i(v);this.Sz.createContextualUi(v).then(P=>{this.ZOn(b.definition,b.source);b.menu=P;u.ULS.sendTraceTag(512255773,341,50,"Menu was opened");b.Nrj&&b.Nrj();this.jTb&&9!==b.source&&this.jTb.execute(ca=>ca.jmj(!0,b.showDictationCommandUx))}).catch(P=>{this.OFb(b,{Fdp:m.a.Unknown});u.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",P)});0<b.kae&&u.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.kae)}else 5<
++b.kae?(u.ULS.sendTraceTag(50968330,341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.Gb.Vb(new qf.a(2,1,Math.pow(3,b.kae),()=>{b.isDismissed||this.zDj(b)},146))}get VD(){return!!this._state&&!this._state.isDismissed}set fhe(b){this.Q1g=b}get IOm(){return this.Q1g}qmg(b,h){this.VD&&(this._state.cpBegin=b,this._state.cpEnd=h)}get definition(){return this.VD?this._state.definition:null}set definition(b){this.VD&&(this._state.definition=b,this._state.menu&&
this._state.menu.setDefinition(b))}focus(){this.VD&&this._state.menu&&(this._state.isFocused||this.p1f(this._state),this._state.menu.focus())}Ymg(){this.VD&&this._state.menu&&this._state.menu.updatePosition()}p1f(b){this.Ub.pL(ua.YMd,!1);b.isFocused=!0}fja(b,h,v,D,P,ca=null,ta=null,Ra=null,mb=!1,Jb=null,Ub=!1,cc=!0,Ac=null,Lc=!1,id=10){if(!h||this._state&&!this._state.isDismissed)return!1;let vd,xe;if(!({paragraphNode:xe,start:b,end:vd}=ua.mPo(b)).returnValue)return!1;this._state=new R(xe,b,vd,h,
v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id);this.zDj(this._state);return!0}lOb(b){this._state&&(this._state.fJd=b)}ZJc(b,h,v){if(1===v)return this.VD?32:0;this.VD&&this.dismiss();return 32}dismiss(){var b;this._state&&(this._state.isDismissed=!0,null===(b=this._state.menu)||void 0===b?void 0:b.dismiss())}static y5m(b,h,v){v=new e(v);b.logAction({actionType:Nm.b.SessionStart,engagement:Nm.a.Try,objectName:ua.Kyj,objectId:h.id,data:v});if(h.suggestionGroups)for(const D of h.suggestionGroups)b.logAction({actionType:Nm.b.Presented,
engagement:Nm.a.See,objectName:D.type,objectId:D.id,data:v})}static x5m(b,h,v,D){v=new e(v);b.logAction({actionType:Nm.b.SessionEnd,engagement:Nm.a.None,objectName:ua.Kyj,objectId:h.id,data:v},D)}static sIc(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static LMk(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static l2i(b,h,v,D){const P=v.y-D,ca=v.x+v.width+D,ta=v.y+v.height+D;return v.x-D<=b&&b<=ca&&P<=h&&h<=ta}static mPo(b){let h,v;if(!b||!fe.ParagraphReader.Wb(b.node)||
b.contextId!==sc.a.Tc&&b.contextId!==sc.a.Hd&&b.contextId!==sc.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};v=b.node;b.contextId!==sc.a.paragraph?(h=b.cpBegin,b=b.cpEnd):(h=0,b=v.characterData.length);return{returnValue:!0,paragraphNode:v,start:h,end:b}}tdc(){this.DI&&this.DI.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}ua.Mqk="ActionSet";ua.Kyj="IntentGroup";ua.YMd="CanvasContextualUxReact";ua.RLo="Context";ua.VLo="Description";ua.ZMf="MenuDidOpen";ua.YMf="MenuDidClose";
Object(n.a)(ua,"UxManager",null,[]);class Oa{constructor(){this.W=null}get name(){return"WordEditor.CanvasContextualProvider"}xc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>{this.hn()})}hn(){w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");const b=w.AFrameworkApplication.K.$("EditorGoalsEnabled"),h=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AIFeedbackSkittleEnabled",!0)&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",
!1);(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(62)||w.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")||w.AFrameworkApplication.K.$("RewriteIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.W.resolve("Common.IDynamicScriptLoaderProvider").Uz.loadScript("canvasContextual")).then(()=>{this.W.ha("CanvasContextual.ICanvasContextualController",
()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:w.AFrameworkApplication.uiCulture,dataCulture:w.AFrameworkApplication.dataCulture,isRightToLeft:w.AFrameworkApplication.isRtl,ulsLogger:new di.a,dimeCallback:async()=>{this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").launchUpsellExperience("editorinword")},loadUpsellDependencies:async()=>{this.W.Sa("Common.IInProductMessagingUIManager").execute(v=>{v.fHi()})},getSoftPaywallData:()=>this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),
getPremiumPreviewCritiquesList:()=>this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),logSystemInitiatedFeedback:async v=>{this.W.Sa("Common.ISystemInitiatedFeedback").execute(D=>D.logActivity(v,null))}})).singleInstance();this.W.ha("WordEditor.CanvasContextualProvider.UxManager",()=>new ua(bd.FocusManager.instance(),this.W.resolve("Box4.ISelectionManager"),this.W.resolve("CanvasContextual.ICanvasContextualController"),Pb.InteractiveViewManager.instance,Xb.KeyInputManager.instance,
w.AFrameworkApplication.nc,w.AFrameworkApplication.ta,w.AFrameworkApplication.ta.k1,this.W.Sa("Common.ISystemInitiatedFeedback"),this.W.Sa("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).singleInstance();this.W.resolve("CanvasContextual.ICanvasContextualController");this.W.resolve("WordEditor.CanvasContextualProvider.UxManager");b&&(this.W.ha("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:w.AFrameworkApplication.uiCulture,
ulsLogger:new di.a})).singleInstance(),this.W.resolve("CanvasContextual.IEditorInitializer").init(),this.W.ha("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new di.a})).singleInstance(),this.W.resolve("CanvasContextual.ISkittleControllerV2"),h&&(this.W.ha("CanvasContextual.IAIFeedbackSkittleController",()=>canvasContextual.FactoryGlobal.getAIFeedbackSkittleControllerInstance({ulsLogger:new di.a})).singleInstance(),this.W.resolve("CanvasContextual.IAIFeedbackSkittleController")))}).catch(v=>
{u.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",v)})}dispose(){}static main(){N.a.instance.Fc(new Oa)}}Object(n.a)(Oa,"PackageManager",null,[1,2]);class fb{constructor(b,h,v,D){this.GCm=(P,ca,ta)=>{P=null;ca.view.te&&(P=ca.view);if(!P||!P.lb)return 8;if(!this.tI.jEf())return 2;if(1===ta)return 32;this.Kfk.T$k();return 32};this.jNi=(P,ca,ta)=>{let Ra=null;ca.view.te&&(Ra=ca.view);if(!Ra||!Ra.lb)return 8;if(!this.tI.jEf())return 2;
if(1===ta)return 32;if(1!==this.tI.T8b(this.hb.gb,!0).count)return 2;ca=new eh.GraphTransaction(15);try{if(ca.Cb(Ra.Yc),!this.tI.pQo(P===Nc.a.xMf))return 8}finally{ca&&ca.dispose()}return 32};this.ga=b;this.hb=h;this.tI=v;this.Kfk=D}Tb(){this.ga.qa(Nc.a.$Wd,sc.a.view,this.GCm);this.ga.qa(Nc.a.xMf,sc.a.view,this.jNi);this.ga.qa(Nc.a.kNi,sc.a.view,this.jNi)}}Object(n.a)(fb,"IntelligentPlaceholderActor",null,[]);class wb{constructor(){this.vpc=new ac.a;this.Zfd=new ac.a}Erk(b,h){let v;({value:v}=this.vpc.Dc(b,
v)).returnValue||this.vpc.Z(b,v=new Ga.a);v.add(h)}jsk(b,h){this.Zfd.mb(b)&&u.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");this.Zfd.Z(b,h)}Crk(b,h,v){this.Erk(b,h);this.jsk(h,v)}TOl(b){let h;return({value:h}=this.vpc.Dc(b,h)).returnValue?h:null}KRl(b){let h;return({value:h}=this.Zfd.Dc(b,h)).returnValue?h:null}D1n(b){let h;if(({value:h}=this.vpc.Dc(b,h)).returnValue){for(const v of h)this.Zfd.remove(v);this.vpc.remove(b)}else u.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}
Object(n.a)(wb,"IntelligentPlaceholderAtMentionManager",null,[716]);var Wb=c(1679);class wc extends Wb.a{constructor(b,h){super(b,h)}get key(){return"FOLLOW UP"}get Uw(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}prj(b){return!b.ia(Bc.a.EG,!1)}Bhb(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(n.a)(wc,"IntelligentPlaceholderDetailsProvider",Wb.a,[]);var Sc=c(1821),pd=c(2037),Xd=c(1825);class de{constructor(){this.Xza=""}iha(b){this.Xza+=b}Gsi(b){this.Xza+=
b}yAf(b){this.Xza+=b}insertImage(b){this.Xza+=b}osi(b){this.Xza+=b}}Object(n.a)(de,"PlainTextFormatCreator",null,[870]);var Te=c(1615),Af=c(2036);c(360);var Fg=c(1678),dd=c(1514);class Be{constructor(){this.Wrc=new ac.a}contains(b){return this.Wrc.mb(Be.$Hf(b))}add(b){this.Wrc.Z(Be.$Hf(b),b)}remove(b){this.Wrc.remove(Be.$Hf(b))}qSo(b){for(const h of b.Wrc)this.add(h.value)}IYh(){const b=new Fb.a;for(const h of this.Wrc)b.add(h.value.ak);return b}static $Hf(b){return b.ak.toString()}}Object(n.a)(Be,
"CommentRangeSet",null,[]);class zg extends Sys.EventArgs{constructor(b){super();this.commentNode=b}}Object(n.a)(zg,"OnFollowUpEventArgs",Sys.EventArgs,[]);class ti extends zg{constructor(b,h){super(b);this.gEn=h}}Object(n.a)(ti,"OnCreateEventArgs",zg,[]);class Rg extends zg{constructor(b,h){super(b);this.LRm=h}}Object(n.a)(Rg,"OnResolveEventArgs",zg,[]);var jh=c(216);class Fj{}Fj.Tqe="MentionExperienceDegraded";Object(n.a)(Fj,"AtMentionsConstants",null,[]);class bl{constructor(b,h,v,D,P,ca,ta,Ra,
mb,Jb){this.lZc=b;this.zIk=h;this.B$c=v;this.YCd=D;this.lb=P;this.xo=ca;this.rXd=ta;this.nti=Ra;this.zu=mb;this.B1b=Jb;this.ZRa=null;this.Vtn=(Ub,cc,Ac)=>{u.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");Ub=this.rXd.u2a(Ub,Ac.displayName,Ac.email,Ac.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,cc),!0);Ub?u.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.B1b.logKpiFailure("LPPWordEditorKPI",
"FailedToInsertAtMention",{isInternal:!0},{name:Fj.Tqe,isInternal:!0})};this.Hsn=(Ub,cc)=>{u.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");cc&&this.B1b.Pv(Nc.a.wUk);this.rXd.Uom(Ub.id,cc)};this.yon=()=>{this.xo.Bd.vy&&!this.xo.Bd.qU&&this.xo.editingView.Tgf?this.KBh=!0:(this.lZc.reset(),u.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))};this.jvn=()=>{u.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.Guk()};this.Gsn=(Ub,cc,Ac,Lc=
new Map)=>{Lc=Object.assign(new Bb.a,{extendedProperties:Lc});this.B1b.logKpiFailure("LPPWordEditorKPI",Ub,{isIntentional:cc,isInternal:Ac,additionalValues:Lc},{name:Fj.Tqe,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:cc,isInternal:Ac,additionalValues:Lc})};(b=Ea.a.instance.Na("Box4.IEditStateEventManager"))&&b.addHandler(jh.a.Mta,this.v8n.bind(this))}m_d(){return!!this.ZRa}v8n(){this.m_d()&&this.KBh&&(this.ZRa.updateInputText(this.hXc,!1),this.KBh=!1)}ariaNotify(b,h){this.zu.sendNotification(b,
h)}Guk(){const b=this.xo.editingView.editingElement;if(b){var h=b.getAttribute(cf.a.VEc);b.setAttribute(cf.a.VEc,h?h.toString()+" PeoplePickerAutomationID":"PeoplePickerAutomationID")}else u.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}U0n(){const b=this.xo.editingView.editingElement;if(b){var h=b.getAttribute(cf.a.VEc);h?(h=h.toString().split(" "),Array.remove(h,"PeoplePickerAutomationID"),h.length?b.setAttribute(cf.a.VEc,h.join(" ")):b.removeAttribute(cf.a.VEc)):u.ULS.sendTraceTag(51218127,
323,50,"No aria-controls when dismissing picker?")}else u.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}iYk(){this.U0n();this.ZRa&&this.ZRa.updateInputText("a",!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.ZRa=null;this.nti.tlj(!0)}jde(){this.lZc.J4f(()=>{this.iYk()});this.lZc.z4f((b,h)=>{this.hXc=b;if(this.ZRa)1<this.hXc.length&&"@"===this.hXc.trimEnd()?(this.B1b.Pv(Nc.a.vUk),this.lZc.reset()):this.ZRa.updateInputText(this.hXc,!1);else if(this.B1b.logKpiUsage("LPPWordEditorKPI",
0),this.B1b.Pv(Nc.a.vxn),(b=this.z_l(h))&&b.height){h=b.y;const v=b.height,D=document.createElement("div");D.id="PeoplePicker";D.style.position="absolute";D.style.top=h-5+"px";D.style.left=b.x+"px";D.style.height=v+10+"px";document.body.appendChild(D);this.zIk.createPeoplePicker({editingElementId:this.xo.editingView.editingElement.id,containerElement:D,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:this.Vtn,onPermissionsReceivedCallback:this.Hsn,onDismiss:this.yon,onShow:this.jvn,onFailure:this.Gsn}).then(P=>
{P.updateInputText(this.hXc,!1);this.ZRa=P;this.nti.tlj(!1)})}});this.lZc.A4f(b=>{if(this.ZRa)this.ZRa.onKeyDown(b.Hb.rawEvent)})}z_l(b){var h=this.lb.gb;if(!h)return null;h=h.kb;if(!h)return null;h=h.Oa;if(!h)return null;h=h.node;if(!h)return null;h=Object(Na.a)(137,h);if(!h)return null;h=Object(Na.a)(177,h.Fj(this.xo.Bd.fc));if(!h)return null;h=Object(Na.a)(86,h);if(!h)return null;let v=null;try{v=this.B$c.b_(this.YCd.v7b(2,b),h,!1,!1,!1,!1)}catch(D){u.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",
D)}return v}}Object(n.a)(bl,"WordEditorAtMentionsHandler",null,[57]);var aj=c(1506);class uh{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id){this.ga=b;this.Wc=h;this.KLa=v;this.hb=D;this.aq=P;this.Kd=ca;this.sD=ta;this.Mld=Ra;this.Sd=mb;this.tq=Jb;this.oXj=cc;this.mi=Ac;this.Ic=Ub;this.ra=new Mc.a;this.Vg=Lc;this.nMg=id;dd.a.M_e((vd,xe)=>{this.EG(xe.commentNode,!0)&&this.ra.raiseEvent(uh.Q_c)})}wqh(b){this.ra.addHandler(uh.kUi,b)}Wyk(b){this.ra.addHandler(uh.tXi,b)}Cyk(b){this.ra.addHandler(uh.vrn,
b)}M_e(b){this.ra.addHandler(uh.Q_c,b)}EG(b,h){let v=b.ia(Bc.a.EG,!1);h&&(v=v&&!b.ia(Bc.a.bba,!1));return v}kbc(b){return this.aq.kbc(b)}j6l(b){for(const h of b)for(const v of h)if(uh.pHf(v.contextId))return v.node.Kc;return null}pcm(b,h,v){const D=new Be,P=b.Kc;for(let ca=0;ca<b.pa.length;ca++){const ta=b.pa.J(ca);if(ta.cp>=h)break;if(ta.rf&&ta.rf.length)for(let Ra=0;Ra<ta.rf.length;Ra++){const mb=ta.rf.J(Ra);this.EG(P.Db(mb.ak),v)&&(mb.Mc?D.add(mb):D.remove(mb))}}return D}qcm(b,h,v,D){const P=new Be,
ca=b.Kc;for(let ta=0;ta<b.pa.length;ta++){const Ra=b.pa.J(ta);if(Ra.cp>v)break;if(Ra.rf&&Ra.rf.length)for(let mb=0;mb<Ra.rf.length;mb++){const Jb=Ra.rf.J(mb);this.EG(ca.Db(Jb.ak),D)&&(Jb.Mc?Ra.cp<v&&P.add(Jb):Ra.cp<=h&&P.remove(Jb))}}return P}tgi(b,h){let v;const D=b.node;b.contextId!==sc.a.paragraph?(v=b.cpBegin,b=b.cpEnd):(v=0,b=D.characterData.length);return v===b?this.pcm(D,v,h):this.qcm(D,v,b,h)}OPc(b,h){return uh.pHf(b.contextId)?this.tgi(b,h).IYh():new Fb.a}T8b(b,h){const v=new Be;for(const D of b)for(const P of D)uh.pHf(P.contextId)&&
v.qSo(this.tgi(P,h));return v.IYh()}jEf(){var b=this.hb.gb;if(!b||1!==b.length||1!==b.J(0).length)return!1;b=b.J(0).Oa.node;return fe.ParagraphReader.Wb(b)&&!fe.ParagraphReader.vua(b)&&this.aq.Cjb(this.ga,!0)?!0:!1}qsi(b,h){if(!this.jEf())return null;if(this.aq.Uqm())return u.ULS.sendTraceTag(592761861,323,15,"Placeholder insertion failed because of draft comment"),null;let v=!1;var D=this.hb.gb.J(0).Oa;D.contextId===sc.a.Tc?(b=b?$e.SelectionEditor.w_(D,!1):null)&&b.Cx&&b.Oa.contextId===sc.a.Hd?this.hb.setSelection(b):
(this.Kd.replaceTextRange(D,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+" ",!0),this.hb.setSelection(Og.SelectionFactory.ZI(D.node,D.cpBegin,D.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):v=!0;this.Vg.iCb||Sc.a.instance.NSc();b=this.aq.BBb(this.hb.gb.kb);if(!b)return null;this.kbc(b)&&this.nMg.Pv(Wa.a.newComment,{succeeded:!0,Q7a:29});var P=this.Wc.Vf(b);const ca=P.Sb(1);if(!ca||393229!==ca.Rc)return null;P=P.Sb(2);if(!P||
393230!==P.Rc)return null;this.mmg(b.Kc,b.id);this.ra.raiseEvent(uh.kUi,new ti(b,h));v&&(h=D.node,D=D.contextId!==sc.a.paragraph?D.cpEnd:h.characterData.length,this.hb.setSelection(Og.SelectionFactory.ZI(h,D,D)));return b}$Wd(b){return!!this.qsi(!0,b)}$Sc(b,h,v,D,P,ca){if(0>h)return!1;D="@"+D;const ta=D+" ",Ra=new eh.GraphTransaction(15);try{Ra.Cb(b);this.Kd.replaceTextRange(we.a.createTextRange(b,h,v),ta);this.Sd.rg&&(this.tq.$7e(b,h,h+D.length),this.tq.wqa(b,h+D.length,h+ta.length,1));const mb=
this.sD.kG(we.a.createTextRange(b,h,h+D.length),"mailto:"+P,!1,!0,!1);if(!mb)return!1;const Jb=mb.hw;if(!Jb)return u.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),!1;this.hb.setSelection(Og.SelectionFactory.ZI(b,h,h+D.length));const Ub=this.qsi(!1,2);if(!Ub)return!1;ca&&this.Mld.Crk(ca,Jb,Ub.id);this.hb.setSelection(Og.SelectionFactory.pe(b,h+ta.length))}finally{Ra&&Ra.dispose()}return!0}u2a(b,h,v,D){const P=this.hb.tg;return $e.SelectionEditor.gf(P)?this.$Sc(P.node,
P.cpBegin-b,P.cpBegin,h,v,D):!1}t9l(b){if(1===b.length&&b.J(0).Cx&&(b=b.J(0).Oa,b.contextId===sc.a.Tc&&fe.ParagraphReader.Wb(b.node))){const h=b.node;for(let v=0;v<h.pa.length;v++){const D=h.pa.J(v);if(D.cp===b.cpBegin){b=D.KRd(!0,!0);if(0<b.length)return b[0].ak;break}}}return null}qBb(b,h,v){return this.aq.lIc(b,h,v).returnValue}aOd(b,h,v,D,P){let ca=!1;const ta=b.characterData;if(h>=ta.length||v>ta.length||v<h)return{returnValue:!1,IOa:ca};let Ra=h,mb=null;for(let Ub=0;Ub<b.pa.length;Ub++){const cc=
b.pa.J(Ub),Ac=cc.cp;if(!(Ac<h)){if(cc.Om&&mb)try{const Lc=ta.substring(Ra,Ac),id=new pd.a;id.fullName=Lc.startsWith("@")?Lc.substr(1):Lc;Fg.a(mb,id);const vd=new Xd.a;Fg.b(mb,vd);P&&(vd.contentId=this.oXj.Pmf());D.yAf(Lc,id,vd);ca=!0;mb=null;Ra=Ac}catch(Lc){var Jb=Object.assign(new Bb.a,{extendedProperties:new Map});Jb.extendedProperties.set("exception",Lc.message);this.nMg.logKpiFailure("LPPWordEditorKPI","FailedToRenderAtMention",{isInternal:!0,additionalValues:Jb},{name:Fj.Tqe,isInternal:!0,additionalValues:Jb})}Ac<=
v&&!mb&&(Jb=Math.min(Ac,v),Jb>Ra&&D.iha(ta.substring(Ra,Jb)),Ra=Ac);cc.hyperlink&&cc.hyperlink.DG&&(mb=cc.hyperlink);if(Ac>=v)break}}return{returnValue:!0,IOa:ca}}A4h(b,h,v,D,P=-1){var ca=!1,ta=b.Db(h),Ra=b.Db(aj.k(ta));ta=b.Db(aj.h(ta));P=0<P?P:Number.MAX_VALUE;b=this.qBb(Ra,h,!0);h=this.qBb(ta,h,!1);if(-1===b||-1===h)return{returnValue:!1,IOa:ca};if(Ra===ta)return this.aOd(Ra,b,h,v,D);const mb=this.KLa.Fma(Ra,!1,!1);if(!mb)return{returnValue:!1,IOa:ca};Ra=new Fb.a;let Jb=0;do Ra.add(mb.Ww),Jb+=
mb.Ww.characterData.length;while(mb.Ww!==ta&&mb.w8()&&Jb<P);for(P=0;P<Ra.count;P++)if(ca=Ra.J(P),ta=ca.characterData,P)if(P===Ra.count-1){if(!({IOa:ca}=this.aOd(ca,0,h,v,D)).returnValue)return{returnValue:!1,IOa:ca}}else{if(!({IOa:ca}=this.aOd(ca,0,ta.length,v,D)).returnValue)return{returnValue:!1,IOa:ca};v.iha("\n")}else{if(!({IOa:ca}=this.aOd(ca,b,ta.length,v,D)).returnValue)return{returnValue:!1,IOa:ca};v.iha("\n")}return{returnValue:!0,IOa:ca}}$Nd(b,h){const v=new de;return this.A4h(b,h,v,!1,
-1).returnValue?v.Xza:null}uLd(b,h){var v=b.Db(h);if(!v)return null;b=b.Db(aj.h(v));if(!b)return null;h=this.qBb(b,h,!1);if(-1===h)return null;v=b.characterData;if(h>=v.length||!G.a.sca(v.charAt(h))){v=this.Ic.Oc(15);try{v.Cb(b),this.Kd.replaceTextRange(we.a.Qc(b,h)," ")}finally{v&&v.dispose()}}return Og.SelectionFactory.pe(b,h+1)}mmg(b,h){const v=b.Db(h),D=new Te.a;this.A4h(b,h,D,!0).returnValue&&(D.iha("\n"),this.aq.wFj(v,D.H$),this.ra.raiseEvent(uh.Awn))}Qdo(b,h){for(const v of b){if(v.contains(h))return!0;
for(const D of v)for(const P of h)if(D.node===P.node&&D.wj>=P.wj)return!0}return!1}EQh(b,h,v,D,P){const ca=this.hb.gb.clone(),ta=new Wn.a(Xa.App.xa.ib.rc);b=Og.SelectionFactory.pe(b,h);v=we.a.Qc(v,D);b=Og.SelectionFactory.oz(b,v);this.hb.setSelection(b);v=!this.Qdo(ca,b);return 32===this.ga.Mf(ta,Gb.a.AH,2,!0,null,null)?(v?this.hb.HY(ca):P!==W.a.nil&&(P=this.uLd(this.mi.value,P),this.hb.setSelection(P)),!0):!1}B_n(b,h){var v=b.Db(h);const D=b.Db(aj.k(v));b=b.Db(aj.h(v));if(D===b){v=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;
var P=D.characterData.indexOf(v);-1!==P&&this.EQh(D,P,b,P+v.length,h)}}OQh(b,h,v){var D=b.Db(h);if(!D)return!1;const P=b.Db(aj.k(D));b=b.Db(aj.h(D));D=this.qBb(P,h,!0);const ca=this.qBb(b,h,!1);if(-1===D||-1===ca||!this.EQh(P,D,b,ca,W.a.nil))return!1;v&&this.YQh(h);return!0}YQh(b){this.aq.E5f(b,!0)}pQo(b){var h=this.j6l(this.hb.gb);if(!h)return!1;const v=this.T8b(this.hb.gb,!0);if(1!==v.count)return!1;const D=h.Db(v.J(0));if(b)h=this.OQh(h,v.J(0),!1);else{const P=aj.k(D),ca=aj.h(D);W.a.eq(P,ca)||
u.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.C7k(v.J(0));h.Db(P).gl(16,!0);h=!0}h&&(D.setValue(Bc.a.bba,!0),this.ra.raiseEvent(uh.tXi,new Rg(D,b)));return h}Fwh(b,h){b=this.T8b(this.hb.gb,!1);h.Mo[uh.wSh]=!!b.count}CVi(b,h){if(h.Mo[uh.wSh]&&fe.ParagraphReader.Wb(h.clone)&&(h=h.clone,b=h.Kc)&&(h=we.a.createTextRange(h,0,h.characterData.length),h=this.OPc(h,!1),h.count))for(const v of h)(h=b.Db(v))&&h.setValue(Bc.a.EG,!1)}tTl(b,h,v){let D;
const P=({DGc:mb}=this.aq.lIc(h,v,!0)).returnValue;v=({DGc:D}=this.aq.lIc(h,v,!1)).returnValue;let ca=null,ta=-1,Ra=-1;for(;mb<D;mb++){const Jb=h.pa.J(mb);if(Jb.hyperlink&&Jb.hyperlink.DG&&Jb.hyperlink.hw===b){ca=Jb.hyperlink;ta=Jb.cp;break}}if(!ca||ta<P)return{returnValue:!1,yKh:ta,xKh:Ra};for(b=mb;b<h.pa.length;b++){var mb=h.pa.J(b);if(mb.cp>v)break;if(mb.hU){Ra=mb.cp;break}}return{returnValue:-1!==Ra,yKh:ta,xKh:Ra}}A0n(b){var h=this.Mld.KRl(b);if(h){var v=null;Xa.App.xa&&(v=Xa.App.xa.ib.Uc.od);
if(v){var D=v.Db(h);h=v.Db(aj.k(D));var P=v.Db(aj.h(D));if(h!==P)u.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({yKh:b,xKh:P}=this.tTl(b,h,D.id)).returnValue){var ca=new eh.GraphTransaction(7);try{ca.Cb(h);const ta=we.a.createTextRange(h,b,P);this.Kd.replaceTextRange(ta,"");this.mmg(v,D.id)}finally{ca&&ca.dispose()}this.hb.gb&&0<this.hb.gb.length?(v=this.hb.gb.J(0).Oa,v.node===h?u.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",v.cpBegin,b):
u.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):u.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.hb.setSelection(Og.SelectionFactory.pe(h,b))}else u.ULS.sendTraceTag(50954440,323,15,"Unable to compute hyperlink CPs for bookmark")}else u.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else u.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}Uom(b,h){if(!h){h=
this.Mld.TOl(b);if(!h){u.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(const v of h)this.A0n(v)}this.Mld.D1n(b)}LMl(){Sc.a.instance.NSc();const b=new Fb.a;for(const v of this.aq.V0e)if(v.Xq!==Af.a.beingCreated){var h=W.a.Ef(v.objectId);h=this.mi.value.Db(h);this.EG(h,!0)&&b.add(h)}return b}qdo(b){b=this.aq.euf(b);this.hb.setSelection(b)}C7k(b){b?this.mi.value.Db(b).setValue(Bc.a.EG,!1):u.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static pHf(b){return b===
sc.a.Hd||b===sc.a.Tc||b===sc.a.paragraph}}uh.wSh="DisableNestedIntelligentPlaceholder";uh.kUi="CreateIntelligentPlaceholder";uh.tXi="ResolveIntelligentPlaceholder";uh.Awn="UpdateIntelligentPlaceholder";uh.Q_c="DeleteIntelligentPlaceholder";uh.vrn="MentionAddedToFollowUpEventKey";Object(n.a)(uh,"IntelligentPlaceholderEditor",null,[713,714,715]);class Rj{constructor(b,h,v,D){this.vsa=!1;this.Js=!0;this.ae=null;this.cNa=P=>{if(!this.Js||!this.oTk(P,this.hb.gb))return!1;P.Hb.preventDefault();P.Hb.stopPropagation();
this.fd.Bd&&this.fd.Bd.jLc(!1);P=this.uLd(this.hb.gb);if(!P)return!1;this.hb.setSelection(P);return!0};this.fd=b;this.mi=h;this.hb=v;this.D6=D}deb(b,h){this.vsa||(b.xwa?(this.eeb(h),this.vsa=!0):b.sfa(()=>{this.vsa||(this.eeb(h),this.vsa=!0)}))}dispose(){this.ae&&this.ae.sc(Ed.a.$F,this.fd.editingView.editingElement,this.cNa)}eeb(b){this.ae=b;this.fd.Bd.Wi&&this.ae.nb(Ed.a.$F,this.fd.editingView.editingElement,this.cNa)}oTk(b,h){if(b.Hb.keyCode!==Ve.a.Dw&&b.Hb.keyCode!==Ve.a.Fs||1!==h.length||!h.J(0).Cx)return!1;
var v=this.D6.T8b(h,!0);if(1!==v.count)return!1;const D=h.J(0).Oa.node;if(!fe.ParagraphReader.Wb(D))return!1;b=this.D6.qBb(D,v.J(0),!0);v=this.D6.qBb(D,v.J(0),!1);return h.J(0).Oa.cpBegin<b||h.J(0).Oa.cpEnd>v?!1:!0}uLd(b){b=this.D6.T8b(b,!0);if(1!==b.count)return null;b=b.J(0);return this.D6.uLd(this.mi.value,b)}tlj(b){this.Js=b}}Object(n.a)(Rj,"IntelligentPlaceholderKeyboardListener",null,[711,10]);class Gj{constructor(b,h){this.oEm=v=>{1===v&&this.ga.processAction(Wa.a.newComment,2);2===v&&(this.ueh.instance?
this.ueh.instance.wmc("https://go.microsoft.com/fwlink/?linkid=2154656")&&G.a.uU("https://go.microsoft.com/fwlink/?linkid=2154656")&&window.open("https://go.microsoft.com/fwlink/?linkid=2154656","_blank"):u.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));v=[Object.assign(new na.a,{name:"DialogResult",int64:v})];Xe.d(Nc.a.u1h,void 0,void 0,void 0,void 0,void 0,v)};this.ga=b;this.ueh=h}T$k(){const b=new ug.StandardDialog;b.Ad=11;b.Ee(1,WordEditorIntl.WordEditorStrings.L_TryIt);
b.Ee(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.Ou(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,0,this.oEm);Xe.a("FollowUpsPhaseOutDialogShown")}}Object(n.a)(Gj,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var jj=c(1483);class ak{constructor(b,h,v,D,P,ca){this.T6=this.jOe=null;this.L4=()=>{this.T6||(this.T6=new qf.a(3,1,0,()=>{this.T6=null;this.ZUd(this.hb.gb)},130),this.Gb.Vb(this.T6))};this.Ic=b;this.tI=h;
this.hb=v;this.Gb=D;this.CWe=P;this.mi=ca;this.j2=new Zc.a;this.Lq=new jj.a;this.mah=new ec.a(this.j2);this.tI.wqh((ta,Ra)=>{this.Nuk(Ra.commentNode)})}Nuk(b){b=b.id;const h=this.tei(this.mi.value,b);h&&this.Lq.Z(b,h)}tei(b,h){const v=b.Db(h);return!v||this.tI.kbc(v)?null:this.tI.$Nd(b,h)}FNk(b){const h=new jj.a;var v=this.tI.T8b(b,!0);if(!v)return h;b=this.mi.value;for(const D of v)(v=this.tei(b,D))&&h.Z(D,v);return h}E5f(b){if(this.jOe){const h=this.Ic.Oc(15);try{h.Cb(this.CWe()),this.tI.YQh(this.jOe)}finally{h&&
h.dispose()}}this.jOe=b?this.tI.t9l(b):null}vpm(b){const h=this.mi.value;if(b=b?this.FNk(b):new jj.a){var v=new ec.a(this.j2),D=new ec.a(this.j2);ak.wWl(this.Lq,b,v,D);for(var P of v)this.Lq.Z(P,b.J(P));for(const ca of D)if(v=this.Lq.J(ca),D=this.tI.$Nd(h,ca),this.Lq.remove(ca),D&&(b=P=!1,Va.a.oQc().equals(D,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(b=!0,v=!1):v=-1<D.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?P=!0:!Va.a.oQc().equals(v,
D),v||P||b)){D=this.Ic.Oc(15);try{D.Cb(this.CWe()),b?this.tI.OQh(h,ca,!0):(P&&this.tI.B_n(h,ca),v&&this.tI.mmg(h,ca))}finally{D&&D.dispose()}}}}u8l(b){const h=new ec.a(this.j2);for(const v of b)for(const D of v)b=D.node,fe.ParagraphReader.Wb(b)&&h.add(b.id);return h}Pnm(b){var h=this.mi.value;const v=b?this.u8l(b):new ec.a(this.j2);if(v){b=new Fb.a;for(const ca of this.mah)if(!v.contains(ca)){var D=h.Db(ca);if(D){D=D.pa;for(let ta=0;ta<D.length;ta++){const Ra=D.J(ta).rf;if(Ra)for(let mb=0;mb<Ra.length;mb++){var P=
Ra.J(mb);P.Mc&&(P=h.Db(P.ak))&&P.ia(Bc.a.FDi,!1)&&W.a.eq(ca,aj.h(P))&&this.tI.kbc(P)&&b.add(P)}}}}this.mah=v;if(b.count){h=this.Ic.Oc(7);try{h.Cb(this.CWe());for(const ca of b)ca.Eg(Bc.a.FDi)}finally{h&&h.dispose()}}}}ZUd(b){this.E5f(b);this.vpm(b);this.Pnm(b)}zBh(){this.T6&&(this.Gb.Xe(this.T6),this.T6=null)}uKb(){if(this.T6||this.mi.Pxf)this.zBh(),this.ZUd(null)}UB(){this.hb.Pw(this.L4);w.AFrameworkApplication.cI(()=>{this.uKb()})}dispose(){this.hb.CY(this.L4);this.zBh()}static wWl(b,h,v,D){for(const P of h){const ca=
P.key;b.mb(ca)||v.add(ca)}for(const P of b)b=P.key,h.mb(b)||D.add(b)}}Object(n.a)(ak,"IntelligentPlaceholderSelectionCache",null,[10]);var Dh;(function(b){b[b.unknown=0]="unknown";b[b.contextMenu=1]="contextMenu";b[b.atMention=2]="atMention";b[b.hpp=3]="textGesture";b[b.paste=4]="paste";b[b.v8o=5]="workItemIntent";b[b.Mep=6]="characterTrigger"})(Dh||(Dh={}));Object(n.b)("IntelligentPlaceholderCreation",Dh);class xm{constructor(b,h,v,D){this.oAa=b;this.Im=h;this.gTb=v;this.wx=D}vie(b){return b&&b.Kc&&
b.Kc.id.equals(this.wx.value.od.id)?!0:!1}Hqj(b){return this.vie(b)&&b.ia(Bc.a.EG,!1)?!0:!1}E6m(){this.gTb.execute(b=>{b.logAction({actionType:Nm.b.SessionStart,engagement:Nm.a.Offer,objectName:xm.slc})})}a3d(b,h){const v=2==h&&this.vie(b);if(this.Hqj(b)||v){var D=b.getValue(Bc.a.$E);this.gTb.execute(P=>{P.logAction({actionType:Nm.b.Created,engagement:Nm.a.None,objectName:xm.slc,objectId:D.toString(),objectFulfillment:Dh[h]})})}}f3m(b){if(this.Hqj(b)){var h=b.getValue(Bc.a.$E);this.gTb.execute(v=>
{v.logAction({actionType:Nm.b.Deleted,engagement:Nm.a.None,objectName:xm.slc,objectId:h.toString()})})}}x7m(b,h){if(this.vie(b)){var v=b.getValue(Bc.a.$E);this.gTb.execute(D=>{D.logAction({actionType:Nm.b.Resolved,engagement:Nm.a.None,objectName:xm.slc,objectId:v.toString(),objectFulfillment:h?"RemoveText":"KeepText"})})}}E8m(b){b===Nc.a.$Wd&&this.gTb.execute(h=>{h.logAction({actionType:Nm.b.Deleted,engagement:Nm.a.None,objectName:xm.slc,objectFulfillment:xm.nJo})})}w5m(b){if(this.vie(b)){var h=b.getValue(Bc.a.$E);
this.gTb.execute(v=>{v.logAction({actionType:Nm.b.Modified,engagement:Nm.a.None,objectName:xm.slc,objectId:h.toString(),objectFulfillment:"MentionInserted"})})}}EKk(){this.E6m();this.oAa.wqh((b,h)=>{this.a3d(h.commentNode,h.gEn)});this.oAa.Wyk((b,h)=>{this.x7m(h.commentNode,h.LRm)});this.oAa.Cyk((b,h)=>{this.w5m(h.commentNode)});this.Im.S0b((b,h)=>{this.E8m(h.actionId)});dd.a.M_e((b,h)=>{this.f3m(h.commentNode)})}}xm.slc="IntelligentPlaceholder";xm.nJo="Undo";Object(n.a)(xm,"IntelligentPlaceholderTelemetry",
null,[]);class Rd{constructor(){this.D6=this.Gnd=this.lud=this.W=null}get name(){return"WordEditor.IntelligentPlaceholder"}xc(b){this.W=b;b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",()=>new Gj(w.AFrameworkApplication.va,b.Sa("Common.App.SafeLinks.ISafeLinksManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new wb).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").singleInstance();
b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new uh(w.AFrameworkApplication.va,new Qo.a,b.resolve("Box4.IParagraphIteratorFactory"),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.Comments.IWordEditorCommentModel"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.IHyperlinkEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IAtMentionHyperlinkConfigurator"),new Gg.a(()=>Xa.App.xa.ib.Uc.od),b.resolve("WordEditor.Comments.CommentsSettings"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",
()=>new fb(w.AFrameworkApplication.va,b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new ak(b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.ISelectionManager"),
w.AFrameworkApplication.nc,()=>Xa.App.xa.ib.rc.Yc,new Gg.a(()=>Xa.App.xa.ib.Uc.od))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new Rj(Pb.InteractiveViewManager.instance,new Gg.a(()=>Xa.App.xa.ib.Uc.od),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",
()=>new xm(b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.IUndoManager"),b.Sa("CanvasContextual.ICanvasContextualController"),new Gg.a(()=>Xa.App.xa.ib.Uc))).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>{this.hn()})}hn(){const b=this.W.resolve("Box4.IFeatureHelper");this.W.Sa("WordEditor.CanvasContextualProvider.UxManager");this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").Tb();
this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").EKk();this.D6=this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor");Bs.a.oxk(Object(z.a)(this.D6,this.D6.Fwh,"beforeIntelligentPlaceholderPaste"));Bs.a.Vzd(Object(z.a)(this.D6,this.D6.CVi,"onIntelligentPlaceholderPaste"));this.lud=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache");b.isFeatureEnabled(97)||this.lud.UB();this.Gnd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener");
this.Gnd.deb(Xa.App.xa.ib,Xb.KeyInputManager.instance);this.kXn(this.W.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}dispose(){this.lud&&this.lud.dispose();this.Gnd&&this.Gnd.dispose();this.D6&&(Bs.a.L1n(Object(z.a)(this.D6,this.D6.Fwh,"beforeIntelligentPlaceholderPaste")),Bs.a.r2n(Object(z.a)(this.D6,this.D6.CVi,"onIntelligentPlaceholderPaste")))}kXn(b,h,v){b&&b.execute(D=>{D.Y4(new wc(h,
v))})}static main(){N.a.instance.Fc(new Rd)}}Object(n.a)(Rd,"PackageManager",null,[1,2]);var ne=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"NavControls",
DisplayMode:"Medium",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},children:[{name:"Row",
attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",attrs:{Id:"GroupReplaceControls",
IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},
children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",Image16by16:"IMGMAP@we@UpArrow_16x16x32",
LabelText:"STR@L_FindPrevious"}},{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},wj=c(2082),Rq=c(1963),jl=c(2043);class iq{}iq.eCo="Search_16x16x32";iq.XBo="ClosePaneGlyph_16x16x32";Object(n.a)(iq,"SearchBoxIcons",
null,[]);var gt=c(2046),ku=c(2047),Yw=c(2045);class Fz{constructor(){this.yVg=null}get key(){return"FIND_HIT"}get Uw(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.yVg=b.node.cPa()}xIa(b){let h=null;for(const v of this.yVg)if(v.begin<=b&&b<v.end)return h=Object.assign(new Kv.a,{MG:this.key,contentObject:v}),{returnValue:!0,WF:h};return{returnValue:!1,WF:h}}}Object(n.a)(Fz,"FindHitDetailsProvider",null,[670,671]);var wA=c(1650),lu=c(1584),rw=c(1628);class ht{constructor(b,
h,v,D,P,ca,ta,Ra=null,mb=null){this.hm=null;this.find=(Jb,Ub,cc,Ac,Lc)=>1===cc?32:void 0===Lc||null===Lc?8:Lc.length?this.sgg(Lc):(this.v6e(jl.a.initial),32);this.findInDocument=(Jb,Ub,cc,Ac,Lc)=>this.Vsj(Nc.a.apb,Jb,Ub,cc,Ac,Lc);this.ZCl=(Jb,Ub,cc,Ac,Lc)=>this.Vsj(Nc.a.cpb,Jb,Ub,cc,Ac,Lc);this.T_h=(Jb,Ub,cc)=>1===cc?32:this.sgg(this.so.$Oa());this.V2c=(Jb,Ub,cc,Ac,Lc)=>{Jb=!this.so.mG;Lc[wh.a.Image16by16Class]=Jb?Xc.getImageClass(iq.eCo):Xc.getImageClass(iq.XBo);Lc[wh.a.LabelText]=Jb?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:
WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;Lc[wh.a.ApplyLabelTextToControlOnly]=!0;Lc[wh.a.EnsureControlRoleIsButton]=!0;Lc[wh.a.On]=!1;return 32};this.cEl=(Jb,Ub,cc)=>{if(1===cc)return 32;this.Rki(!1);return 32};this.nEl=(Jb,Ub,cc)=>{if(1===cc)return 32;this.Rki(!0);return 32};this.a2f=(Jb,Ub,cc,Ac,Lc)=>{Lc[Hl.a.Visible]=this.so.btj;return 32};this.k2f=(Jb,Ub,cc,Ac,Lc)=>{Lc[Hl.a.Visible]=this.so.btj;return 32};this.wTd=(Jb,Ub,cc,Ac,Lc)=>{if(1===cc)return 32;this.bB.K5c.Xki(Lc);
return 32};this.cancelSearch=(Jb,Ub,cc)=>{if(1===cc)return 32;this.v6e(jl.a.initial);return 32};this.XGc=(Jb,Ub,cc)=>{if(1===cc)return 32;this.v6e(jl.a.initial);this.so.ZB(!1);return 32};this.clearSearch=(Jb,Ub,cc)=>{if(1===cc)return this.YHm(Jb===Wa.a.LEh);this.so.clearSearch();return 32};this.boe=(Jb,Ub,cc)=>{if(1===cc)return 32;switch(Jb){case Wa.a.Ekf:this.so.matchCase=!this.so.matchCase;break;case Wa.a.Ukf:this.so.matchWholeWord=!this.so.matchWholeWord}return this.sgg(this.so.$Oa())};this.nbe=
(Jb,Ub,cc,Ac,Lc)=>{Lc[If.a.On]=this.so.matchCase;return 32};this.pbe=(Jb,Ub,cc,Ac,Lc)=>{Lc[If.a.On]=this.so.matchWholeWord;return 32};this.M1f=(Jb,Ub,cc,Ac,Lc)=>{Jb=this.so.matchCase;Ub=this.so.matchWholeWord;cc="";Jb&&Ub?cc=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):Jb?cc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):
Ub&&(cc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));Lc[cn.a.Value]=cc;Lc[cn.a.Visible]=Jb||Ub;return 32};this.Vgc=(Jb,Ub,cc,Ac,Lc)=>{Jb=this.so.t2;Ub="";switch(this.so.mG){case jl.a.startSearch:Ub=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case jl.a.searching:Ub=Jb?this.Itf(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case jl.a.searchComplete:Ub=
this.Itf(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case jl.a.tooManyResults:Ub=this.Itf(this.so.AFa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);break;case jl.a.noMatchesFound:Ub=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case jl.a.replaceAllInProgress:Ub=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case jl.a.replaceAllComplete:Ub=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}Lc[cn.a.Value]=
Ub;return 32};this.obe=(Jb,Ub,cc,Ac,Lc)=>{Lc&&(Lc.CommandValueId=this.so.$Oa());return 32};this.replace=(Jb,Ub,cc,Ac,Lc)=>{if(1===cc)return this.TFf()?32:8;if(!this.TFf())return 8;Jb=this.so.oFb();"string"===typeof Lc&&Lc&&(Jb=Lc);u.ULS.sendTraceTag(6033813,312,50,"Replace Called");Xe.a("NavigationPaneReplace");Lc=this.jxb.replace(Jb);this.so.hho(Lc);return 32};this.replaceAll=(Jb,Ub,cc,Ac,Lc)=>{if(1===cc)return this.SRm()?32:8;Jb=this.so.oFb();"string"===typeof Lc&&Lc&&(Jb=Lc);Xe.a("NavigationPaneReplace");
this.hm=this.ge.Zf("UserAction","ReplaceAll");this.so.D7(jl.a.replaceAllInProgress);u.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");rw.a.t4n(this.so.$Oa(),this.so.oFb());this.jxb.replaceAll(Jb,this.Ttn);return 32};this.Ttn=(Jb,Ub)=>{this.hm&&(this.hm.stop(),this.hm=null);u.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:Jb,["TotalCount"]:Ub});rw.a.q4n(Jb,Ub);this.so.D7(jl.a.replaceAllComplete)};this.H5i=(Jb,Ub,cc,Ac,Lc)=>{Ub=!1;if(!Lc)return 8;
this.so.ij.isVisible&&(Ub=Jb===Nc.a.o3c===this.so.HPc());Jb!==Nc.a.o3c||this.v2g||(Ub=!1);Lc[If.a.On]=Ub;return 32};this.N1f=(Jb,Ub,cc,Ac,Lc)=>{if(!Lc||!this.so.ij.isVisible)return 32;Lc[If.a.On]=this.so.AFa;return 32};this.P1f=(Jb,Ub,cc,Ac,Lc)=>{if(!Lc)return 32;Lc.currentFindReplaceViewType=this.so.mG;return 32};this.GMn=(Jb,Ub,cc,Ac,Lc)=>{if(1===cc)return 32;Jb=Lc[If.a.On];Lc&&(Lc[If.a.On]=this.so.ij.isVisible);Jb&&!Lc[If.a.On]&&(ht.TBj(),Xe.a("NavigationPaneCrossClick"));return 32};this.A7a=(Jb,
Ub,cc,Ac,Lc)=>{const id=this.so.ij.isVisible;u.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",id);return id?this.XGc(Jb,Ub,cc,Ac,Lc):this.ckc(Jb,Ub,cc,Ac,Lc)};this.ckc=(Jb,Ub,cc,Ac,Lc)=>{if(1===cc)return bc.SessionStatusManager.instance.MH?32:8;if(2===cc){w.AFrameworkApplication.epa("AutoDetectedHeadingsIsEnabled");ht.TBj();this.Z4();wA.FindReplaceUIManager.YQk(Jb,Lc,this.so.ij.isVisible);Ub=!0;Jb===Nc.a.gkc&&void 0!==Lc&&null!==Lc&&(Ub=Lc);this.so.ZB(!0,Ub);Lc=Yw.a.initial;switch(Jb){case Nc.a.dkc:u.ULS.sendTraceTag(42501022,
367,50,"");Lc=Yw.a.headings;break;case Nc.a.apb:Lc=Yw.a.find;break;case Nc.a.cpb:Lc=Yw.a.replace;break;case Nc.a.gkc:Lc=Yw.a.intelligentPlaceholder;break;case Nc.a.A7a:Lc=this.so.E4b,Lc||(u.ULS.sendTraceTag(42501023,367,50,""),Lc=Yw.a.headings)}this.so.Vlo(Lc,Ub);return 32}return 8};this.lGa=()=>{this.so.mG&&!this.so.AFa&&u.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.so=h;this.bB=v;this.jxb=D;this.v2g=P;this.ge=ta;mb&&mb(1,this.lGa,null);this.yKa=Ra}Z4(){}Tb(){this.ga.eb(Nc.a.B2f,
sc.a.view,this.GMn,96);this.ga.qa(Nc.a.A7a,sc.a.view,this.A7a);this.ga.qa(Nc.a.dkc,sc.a.view,this.ckc);this.ga.qa(Nc.a.apb,sc.a.view,this.ckc);this.ga.qa(Gb.a.Hkf,sc.a.view,this.find);this.ga.qa(Wa.a.findInDocument,sc.a.view,this.findInDocument);this.ga.qa(Gb.a.findOnPage,sc.a.view,this.T_h);this.ga.eb(Wa.a.hMn,sc.a.view,this.V2c,97);this.ga.qa(Gb.a.jRf,sc.a.view,this.cEl);this.ga.qa(Gb.a.S_f,sc.a.view,this.nEl);this.ga.eb(Gb.a.a2f,sc.a.view,this.a2f,97);this.ga.eb(Gb.a.k2f,sc.a.view,this.k2f,97);
this.ga.qa(Nc.a.wTd,sc.a.view,this.wTd);this.ga.qa(Gb.a.B2b,sc.a.view,this.cancelSearch);this.ga.qa(Wa.a.clearSearch,sc.a.view,this.clearSearch);this.ga.qa(Wa.a.LEh,sc.a.application,this.clearSearch);this.ga.qa(Nc.a.XGc,sc.a.view,this.XGc);this.ga.qa(Wa.a.Ekf,sc.a.view,this.boe);this.ga.qa(Wa.a.Ukf,sc.a.view,this.boe);this.ga.eb(Wa.a.nbe,sc.a.view,this.nbe,97);this.ga.eb(Wa.a.pbe,sc.a.view,this.pbe,97);this.ga.eb(Nc.a.M1f,sc.a.view,this.M1f,97);this.ga.eb(Nc.a.Vgc,sc.a.view,this.Vgc,97);this.ga.eb(Nc.a.N1f,
sc.a.view,this.N1f,97);this.ga.eb(Nc.a.P1f,sc.a.view,this.P1f,97);this.ga.eb(Nc.a.O1f,sc.a.view,this.H5i,97);Object(lu.b)()&&this.ga.eb(Nc.a.obe,sc.a.view,this.obe,96);this.v2g&&(this.ga.eb(Nc.a.cpb,sc.a.view,this.ckc,1028),this.ga.eb(Nc.a.o3c,sc.a.view,this.H5i,97),this.ga.eb(Nc.a.replace,sc.a.view,this.replace,1028),this.ga.eb(Nc.a.replaceAll,sc.a.view,this.replaceAll,1028),w.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)&&this.ga.eb(Wa.a.Okf,sc.a.view,this.ZCl,1028));this.ga.qa(Nc.a.gkc,sc.a.view,this.ckc)}m4f(){this.yKa&&this.yKa.execute(b=>{b.Y4(new Fz)})}Vsj(b,h,v,D,P,ca){if(1===D)return bc.SessionStatusManager.instance.MH?32:8;if(void 0===ca||null===ca)return 8;this.ckc(b,v,2,P,ca);b=this.so;b.Nag(ca.CommandValueId);Object(lu.b)()&&("MatchCase"in ca&&(b.matchCase=ca.MatchCase),"MatchWholeWord"in ca&&(b.matchWholeWord=ca.MatchWholeWord));return this.T_h(h,v,D,P,ca)}sgg(b){if(void 0===b||null===b||!b.length)return 32;
b=gt.a.createQuery(b,this.lMn);if(void 0===b||null===b)return u.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.bB.find(b);return 32}get lMn(){let b=ku.a.none;this.so.matchCase&&(b|=ku.a.matchCase);this.so.matchWholeWord&&(b|=ku.a.wholeWordOnly);return b}Rki(b){this.so.E4b!==Yw.a.headings&&this.so.t2&&(b?this.bB.K5c.slm():this.bB.K5c.Tki())}v6e(b){this.so.mG&&(this.so.AFa||u.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.bB.LZa(),this.so.D7(b))}YHm(b){return this.so.mG===
jl.a.replaceAllInProgress||b&&!this.so.mG?8:32}Itf(b){return String.format(b,this.so.Zgd,this.so.t2)}TFf(){return this.so.HPc()&&0<this.so.t2}SRm(){return this.TFf()&&this.so.AFa}static TBj(){null!=w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},ht.zDa)}static vXl(b,h,v,D){return new ht(w.AFrameworkApplication.va,
b,h,v,D,bd.FocusManager.instance(),Xa.App.xa.Hq,Ea.a.instance.Sa("Box4.Accessibility.IAccessibilityContextManager"),Object(z.a)(w.AFrameworkApplication.ta.wP,w.AFrameworkApplication.ta.wP.nb,"registerHandler"))}static uXl(b,h,v,D){return ht.vXl(b,h,v,D)}}ht.zDa=5E3;Object(n.a)(ht,"FindReplaceActor",null,[]);var sw=c(896),tw=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.lC},set:function(h){this.lC=h},enumerable:!1,configurable:!0});
Object.defineProperty(b.prototype,"last",{get:function(){return this.HWa},enumerable:!1,configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(h){return this._map.get(h)};b.prototype.insert=function(h,v){this.removeItem(h);v={key:h,zia:this.HWa,next:void 0,data:v};this.first||(this.first=v);this.HWa&&(this.HWa.next=v);this.HWa=v;this._map.set(h,v)};b.prototype.insertAfter=function(h,v,D){h=this._map.get(h);if(!h)return!1;D={key:v,zia:h,next:h.next,data:D};
var P=h.next;P&&(P.zia=D);h.next=D;this._map.set(v,D);return!0};b.prototype.insertBefore=function(h,v,D){h=this._map.get(h);if(!h)return!1;D={key:v,zia:h.zia,next:h,data:D};var P=h.zia;P&&(P.next=D);h.zia=D;this._map.set(v,D);return!0};b.prototype.removeItem=function(h){var v=this._map.get(h);v&&(this.first===v&&(this.first=v.next),this.HWa===v&&(this.HWa=v.zia),v.zia&&(v.zia.next=v.next),v.next&&(v.next.zia=v.zia),this._map.delete(h))};return b}();class Cv{constructor(){this.type="heading"}}Object(n.a)(Cv,
"NavPaneHeadingItem",null,[]);class Gz{constructor(){this.type="bookmark"}}Object(n.a)(Gz,"NavPaneBookmarkItem",null,[]);class xA{constructor(b,h,v,D,P,ca,ta){var Ra,mb;this.fb=b;this.hb=h;this.Ub=v;this.pn=D;this.E0=P;this.MF=ca;this.n6j=ta;this.GXa=0;this.Tpd=new Map;this.wYg=!1;this.Kza=new Map;this.nLg=null===(Ra=w.AFrameworkApplication.K)||void 0===Ra?void 0:Ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneADHToggleDefaultOff",!1);this.Uck=null===(mb=w.AFrameworkApplication.K)||void 0===
mb?void 0:mb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneShowNumberListedHeadings",!1)}get headingsReady(){return this.wYg}set headingsReady(b){this.wYg=b}get jMb(){return this.GXa}get v9(){this.aYb&&0!=this.aYb.length()||(this.aYb=this.eHn());return this.aYb}set v9(b){this.aYb=b}get Dic(){return this.Zik}set Dic(b){this.Dic&&(this.Dic.isSelected=!1);b.isSelected=!0;this.Zik=b}hsf(b,h){return"bookmark"===b.type?b.text:h.id.toString()}eHn(){const b=new tw;if(!this.E0)return b;this.Tpd=
new Map;let h;const v=[];for(const D of this.E0.paragraphs()){const P=this.kci(D,v);null===P||void 0===P?void 0:P.forEach(ca=>{(h=this.bei(ca,v))&&"heading"===h.type&&h.indentLevel<ca.indentLevel&&(1>=h.indentLevel?(h.isCollapsed=!1,ca.isHidden=!1):(h.isCollapsed=!0,ca.isHidden=!0));b.insert(this.hsf(ca,D),ca)})}return b}bei(b,h){return"heading"===b.type?1<h.length?h[h.length-2]:void 0:0<h.length?h[h.length-1]:void 0}$mg(b){var h;let v=fe.ParagraphReader.Ina(b),D=!1;9===v&&this.Kza.has(b.id.toString())&&
(v=this.Kza.get(b.id.toString()),D=!0);const P=null===(h=this.v9.get(b.id.toString()))||void 0===h?void 0:h.data;if(P){if(P.indentLevel===v){h=Po.AParagraphNode.IR(b.characterData.trim());b=this.pn.value.fYf(b);if(h!==P.text||P.hasBookmark!==b)return P.text=h,P.hasBookmark=b,!0;!D&&P.isPurelyADH&&(P.isPurelyADH=!1,--this.GXa);return!1}this.f2c();return!0}if(9===v)return this.JGm(b)?(this.f2c(),!0):!1;this.f2c();return!0}JGm(b){var h;const v=this.pn.value.p5h(b);b=null!==(h=this.Tpd.get(b.id.toString()))&&
void 0!==h?h:0;if(b!==v.length)return!0;for(h=0;h<b;++h)if(!this.v9.get(v[h].POa()))return!0;return!1}Mkl(b){if(this.v9.get(b.id.toString())||this.pn.value.fYf(b))return this.f2c(),!0;this.Kza.has(b.id.toString())&&(this.Kza.delete(b.id.toString()),--this.GXa);return!1}f2c(){const b=new tw;this.GXa=0;if(this.E0){this.Tpd=new Map;var h=[],v,D;for(const P of this.E0.paragraphs()){const ca=this.kci(P,h);null===ca||void 0===ca?void 0:ca.forEach(ta=>{var Ra=this.hsf(ta,P);D=this.bei(ta,h);this.J8n(Ra,
ta,D);b.insert(Ra,ta);"heading"===(null===v||void 0===v?void 0:v.type)&&(Ra=v,Ra.indentLevel>=ta.indentLevel&&(Ra.isCollapsed=void 0));v=ta})}}this.v9=b}J8n(b,h,v){var D,P;if(b=null===(D=this.aYb.get(b))||void 0===D?void 0:D.data)b.isSelected&&(h.isSelected=!0,this.Dic=h),h.isHidden=b.isHidden;if(v){if(D=null===(P=this.aYb.get(this.hsf(v,v.paragraphNode)))||void 0===P?void 0:P.data)v.isCollapsed=D.isCollapsed;v.isCollapsed?h.isHidden=!0:v.isHidden?(v.isCollapsed=!0,h.isHidden=!0):(v.isCollapsed=!1,
h.isHidden=!1)}}kci(b,h){var v=fe.ParagraphReader.Ina(b),D=!this.VDf(b);const P=this.vMm(v)&&D?!0:!1;D=this.Kza.has(b.id.toString())&&D;const ca=[];if(P)ca.push(this.TLh(b,v,!1,h));else if(D)this.GXa+=1,this.ELc&&(v=this.Kza.get(b.id.toString()),ca.push(this.TLh(b,v,!0,h)));else{let ta=0;this.pn.value.p5h(b).forEach(Ra=>{const mb=new Gz;mb.text=Ra.POa();mb.isSelected=!1;mb.bookmarkManager=this.pn;mb.indentLevel=0<h.length?h[h.length-1].indentLevel+1:0;ta+=1;ca.push(mb)});this.Tpd.set(b.id.toString(),
ta)}return ca}TLh(b,h,v,D){var P,ca;const ta=new Cv;ta.text=Po.AParagraphNode.IR(b.characterData.trim());ta.indentLevel=h;ta.paragraphNode=b;ta.isSelected=!1;ta.isPurelyADH=v;this.Uck&&(ta.listMarker=this.ysf(b));ta.hasBookmark=this.pn.value.fYf(b);for(b=null===(P=D[D.length-1])||void 0===P?void 0:P.indentLevel;b&&b>=h;)D.pop(),b=null===(ca=D[D.length-1])||void 0===ca?void 0:ca.indentLevel;(!b||b<h)&&D.push(ta);return ta}VDf(b){return this.fb.Wb(b)&&0===this.fb.textLength(b,9)}gzl(b){(b=this.v9.get(b))&&
(1==b.data.isCollapsed?this.gtj(b):this.Btm(b))}onClickHeading(b){var h;this.Dic=b=null===(h=this.v9.get(b))||void 0===h?void 0:h.data;h=Og.SelectionFactory.pe(b.paragraphNode,0);this.hb.setSelection(h);this.Ub.mg(Ne.AFrame.Pn)}onClickBookmark(b){var h;this.Dic=b=null===(h=this.v9.get(b))||void 0===h?void 0:h.data;this.pn.value.Jki(b.text);this.Ub.mg(Ne.AFrame.Pn)}onShareHeadingClick(b){var h;w.AFrameworkApplication.ue("NavPaneShareHeadingLink-tf;NavPaneShareHeadingLink-cf");Xe.a("CreateHeadingLinkThroughNavPane",
!0,void 0);if(b=null===(h=this.v9.get(b))||void 0===h?void 0:h.data)h=b.paragraphNode.getValue(Bc.a.Lc),this.n6j.value.ULh(h)}gmg(b,h){const v=b.id.toString(),D=this.Kza.has(v);if(!D||this.Kza.get(v)!==h){this.Kza.set(v,h);if(this.ELc)return this.$mg(b);!this.nLg||D||this.v9.get(v)||(this.GXa+=1)}return!1}fkl(b){const h=b.id.toString(),v=this.Kza.has(h);if(v){this.Kza.delete(h);if(this.ELc)return this.$mg(b);this.nLg&&v&&!this.v9.get(h)&&--this.GXa}return!1}OLo(b){this.ELc=b;this.f2c()}Jmg(b){var h;
const v=null===(h=this.v9.get(b.id.toString()))||void 0===h?void 0:h.data;if(!v)return!1;b=this.ysf(b);if(v.listMarker===b)return!1;this.jUo();return!0}DId(b){var h;b=null===(h=this.v9.get(b.id.toString()))||void 0===h?void 0:h.data;if(!b||void 0===b.listMarker)return!1;b.listMarker=void 0;return!0}gtj(b){var h=b.data;1==h.isCollapsed&&(h.isCollapsed=!1);h=h.indentLevel;b=b.next;let v;for(;b&&b.data.indentLevel>h;)v=b,b=v.next,v.data.isHidden=!1,"heading"==v.data.type&&(b=v.data.isCollapsed?this.lAo(v):
this.gtj(v));return b}Btm(b){var h=b.data;h.isCollapsed=!0;h=h.indentLevel;b=b.next;let v;for(;b&&b.data.indentLevel>h;)v=b,b=v.next,v.data.isHidden=!0}lAo(b){const h=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>h;)b=b.next;return b}vMm(b){return 0<=b&&8>=b}jUo(){let b=this.v9.first;for(;b;){if("heading"===b.data.type){const h=b.data;h.listMarker=this.ysf(h.paragraphNode)}b=b.next}}ysf(b){var h;if(b.VI instanceof sw.a)return this.ejm(null===(h=this.MF.hlb(b.VI))||void 0===h?void 0:h.Y8)}ejm(b){for(let h=
0;h<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(h)?void 0:b}}Object(n.a)(xA,"NavPaneHeadingsManager",null,[]);var Ny=c(1585);class d{constructor(){this.jxb=this.bB=this.rtc=this.mjd=this.W=null}get name(){return"WordEditor.FindReplace"}xc(b){this.W=b;const h=new xA(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.ISelectionManager"),bd.FocusManager.instance(),b.Ue("WordEditor.Bookmark.IBookmarkManager"),b.resolve("Box4.IParagraphCollection"),b.resolve("Box4.IListMarkerUtility"),
b.Ue("WordEditor.Actors.HeadingsActor"));this.W.ha("WordEditor.FindReplace.NavPaneHeadingsManager",()=>h).as("WordEditor.FindReplace.NavPaneHeadingsManager").singleInstance()}init(){d.Xb.Pp.continueWith(()=>{this.hn()})}hn(){if(Xa.App.Dpg){const b=Xa.App.Ipe;this.rtc=wA.FindReplaceUIManager.getInstance(b);this.bB=Rq.FindManager.createInstance(this.rtc,wj.a.instance,Ny.a.instance,!0);this.jxb=this.bB.kNb;this.mjd=ht.uXl(this.rtc,this.bB,this.jxb,b);this.mjd.Tb();this.mjd.Z4();this.mjd.m4f();Xa.App.xa.updateCommandUI()}}dispose(){this.rtc&&
this.rtc.dispose()}static get Xb(){return null!=d.Tyg?d.Tyg:d.Tyg=Ea.a.instance.resolve("Box4.IFeatureHelper")}}Object(n.a)(d,"FindReplacePackageManager",null,[1,2]);class r{constructor(){}Pmf(){return"_@_"+ub.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}$Wo(b,h,v,D){h.jho(b,D);h.Xl(b,lf.a.g$,!0);h.Xl(b,Bc.a.EQa,!0);h.Xl(b,Bc.a.fieldInstruction,r.LZh(v));h.Xl(b,Bc.a.jt,15)}HAk(b,h,v,D){const P=b.IGd(D);h.Xl(P,lf.a.g$,!0);h.Xl(P,Bc.a.jt,47);h.Xl(P,Bc.a.fieldInstruction,r.LZh(v));
b=b.IGd(D);h.Xl(b,lf.a.g$,!0);h.Xl(b,Bc.a.jt,16);return[P.Wj,b.Wj]}wKl(b,h,v){b=b.IGd(v);h.Xl(b,lf.a.g$,!0);h.Xl(b,Bc.a.lIb,!0);return b.Wj}static LZh(b){return String.format(' HYPERLINK "{0}"',b)}}Object(n.a)(r,"AtMentionHyperlinkConfigurator",null,[626]);class B{constructor(b,h,v){this.RAa=b;this.hb=h;this.Emi=this.Wui=this.cGe=!1;this.LKb=this.LKb.bind(this);this.MKb=this.MKb.bind(this);this.WKb=this.WKb.bind(this);v&&v.execute(D=>{this.oVa=D});Hq.a.xBd.tpf.then(D=>{this.Emi=!0;this.Wui=D.isSuccess})}jde(){this.RAa.z4f(this.LKb);
this.RAa.A4f(this.MKb);this.RAa.J4f(this.WKb)}m_d(){return!1}LKb(b,h,v){var D,P;h=Date.now();if(this.oVa)if(this.Emi&&!this.Wui)u.ULS.sendTraceTag(512369951,3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");else{var ca=null===(P=null===(D=this.hb.gb)||void 0===D?void 0:D.kb)||void 0===P?void 0:P.Pc;ca?(D=ca.node,fe.ParagraphReader.Wb(D)?(P=fe.ParagraphReader.text(D),0>v||v>P.length?u.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the @ was not within the bounds of the paragraph."):
1<b.length&&"@"===b.trimEnd()?(Xe.c(Nc.a.B6k,!0,void 0,void 0,void 0,void 0),this.RAa.reset()):(this.cGe?this.oVa.CXo():(this.cGe=!0,this.oVa.pzo(ca)),this.oVa.qmg(v,v+b.length),b=P.substring(0,v)+b,this.oVa.bnf(D,b,v,h))):u.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):u.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else u.ULS.sendTraceTag(537776153,
3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}MKb(b){if(this.oVa)this.oVa.onKeyDown(b)}WKb(){this.cGe=!1;this.oVa&&this.oVa.tFh()}}Object(n.a)(B,"ContextIQUserInitHandler",null,[57]);var S=c(1660);class ea{constructor(){this.Sz=null}get name(){return"WordEditor.AtMentions"}xc(b){this.W=b;b.ha("Box4.IAtMentionHyperlinkConfigurator",()=>new r(b.resolve("Box4.IFeatureHelper"))).singleInstance();const h={crewAlias:ea.uNj,featureName:ea.ZOj,topLevelKpiName:ea.$Sj,
vetoPillar:7};b.ha("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new Br.a(va.Health.instance,new Ns.a,h)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>{this.hn()})}dispose(){}hn(){this.W.Sa("Common.App.People.IExternalPeopleAPI").execute(b=>{b.atMentionsEnabledAsync().then(h=>{w.AFrameworkApplication.K.$("ConsumerMentionsHostIsEnabled")&&(h=h&&w.AFrameworkApplication.K.$("WordEditorConsumerCanvasMentionsIsEnabled"));
(h||S.a.ddd())&&this.F0m()})});this.W.resolve("Box4.IAtMentionHyperlinkConfigurator")}F0m(){(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):this.W.resolve("Common.IDynamicScriptLoaderProvider").Uz.loadScript("canvasAtMentions")).then(()=>{w.AFrameworkApplication.K.Po(()=>{this.HVn()})})}HVn(){const b={peopleAPI:this.W.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:w.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},
useLPP:!0,isTestEnv:this.EUm()};this.Sz=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFeatureEnabled("MsoContextIq",!1).then(v=>{v&&S.a.edd()||!v&&S.a.ddd()?(S.a.rCf=!v,this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new B(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.W.resolve("Box4.ISelectionManager"),this.W.Sa("WordEditor.CanvasContextual.ContextIQIntentProvider"))).singleInstance()):
this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new bl(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.Sz,this.W.resolve("Box4.ITextMetricsAdapter"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.ISelectionManager"),Pb.InteractiveViewManager.instance,this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.W.resolve("Common.Utils.IAriaNotifier"),
this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).singleInstance();this.W.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").jde()})})}EUm(){var b,h;const v=null!==(b=w.AFrameworkApplication.sessionStartInfoSettings.Ring)&&void 0!==b?b:"-1";b=null!==(h=w.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==h?h:"";return v===ea.hNj&&b===ea.gNj}}ea.hNj="-4";ea.gNj="DC2";ea.uNj="webasynccollabeng";ea.ZOj="AtMentions";ea.$Sj="AtMentionsFeatureUsage";
Object(n.a)(ea,"PackageManager",null,[1,2]);var Ca=c(1694),gb=c(1396);class Nb{constructor(b,h,v,D){this.ga=b;this.Se=h;this._augLoopRuntimeManager=v;this.Cpk=D;this.sta=0;this.Ayd=this.xZb=!1;this.gOg=this.gdh=this.xKe=this.hdh=0;this.osb=null;this.g2j=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],["ChangePicture",!0]]);this.U0j=[{id:`${hv.Igc}_${1}`},{id:`${hv.Igc}_${2}`},{id:`${hv.Igc}_${3}`},{id:gb.a.XHd},{id:gb.a.qGd},
{id:gb.a.p$d},{id:gb.a.m$d}];this.cWj=[{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"Draw"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"ReviewDesignerSuggestion"}];this.Wfd=new Map;this.p8j=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",!1);this.Cbk=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",
8);this.oZj=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",!1);this.Se.nb(this,Ca.SearchSuggestionAnnotation.getTypeName());(w.AFrameworkApplication.K.$("IsO365CommercialHost")||w.AFrameworkApplication.K.$("IsO365ConsumerHost"))&&this.Wfd.set("InsertLink","InsertLinkFlyout");this.Wfd.set("GraphicsEditor","");this.aFj();this.Tb(this.ga)}qJn(b,h){const v=Date.now();this.xKe&&1250>v-this.xKe||this.kwb||(this.xKe=v,this.osb=b,this.ovd=this.bem(h),this.y7n(),
this.O5n())}EA(b,h){if(b.annotationType===Ca.SearchSuggestionAnnotation.getTypeName()&&b.content&&h===Al.a.getTypeName()&&(h=Date.now(),b=b.content,this.kwb&&this.kwb===b.correlationId)){window.clearTimeout(this.sta);this.kwb=void 0;var v=this.xZb,D=this.L3l(b),P=D&&0<D.length;P&&(this.oYo(D),this.Ayd&&(v=!1));v&&this.Fcj();h={["description"]:"[Zero term context menu] augloop response latency",["correlationId"]:b.correlationId,["requestPreparationTime"]:this.gdh,["canvasContextRetrievalTime"]:this.gOg,
["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,["updateTime"]:Date.now()-h,["latencyMs"]:h-this.hdh,["containsZTM"]:P,["shouldFallBack"]:this.xZb,["fallBack"]:v};u.ULS.sendTraceTag(572057625,1303,50,JSON.stringify(h))}}L3l(b){const h=this.getSuggestions(b.intentSuggestions,Ca.IntentIds.ZeroTermMenu,Ca.ObjectSemantic.GenericSuggestions,Ca.ObjectSchemaType.RankedSuggestion);return 1===h.length?h[0]:b.menuSuggestions}getSuggestions(b,h,v,D){return Array.isArray(b)?b.filter(P=>P.intent===
h&&P.result.semantic===v&&P.result.type===D).map(P=>P.result.value):[]}Tb(b){b.eb(Wa.a.JJi,sc.a.application,this.P5n.bind(this),96)}bem(b){const h=[],v=new Map,D=Date.now();for(const P of b){if(!P)continue;b=[];const ca={itemsMetadata:new ac.a};for(let ta=0;ta<P.ControlList.length;ta++){const Ra=P.ControlList[ta];if(Ra&&!Ra.ExternalId)continue;b.push(Ra.ExternalId);const mb={timeStamp:D,source:"FallbackZeroTermMenu",confidenceScore:-1};ca.itemsMetadata[Ra.ExternalId]=mb;v.set(Ra.ExternalId,mb)}h.push(appChrome.api.menuSection(b,
P.Title,P.Lang,P.Id,ca))}return{sections:h,commands:v}}vBj(b){return this.Wfd.has(b)?this.Wfd.get(b):b}JIa(b){const h={};for(const v of b)b=this.vBj(v.suggestion),appChrome.selectors.isControlDefined(b)&&(h[b]=appChrome.selectors.getModelType(b));Xa.App.xa.wNd(h)}oIm(b){return!appChrome.selectors.isControlDefined(b)||appChrome.selectors.isControlDisabled(b)?!1:this.g2j.has(b)?this.ovd.commands.has(b):!0}$Nh(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,null,null,{menuTargetType:this.osb})}jhb(b=
!1){b=b?Nl.a.instance.otc:Nl.a.instance.jhb();const h=[],v=Date.now();for(const D of b)D.commandId&&h.push({Id:D.commandId,TimeElapsedSinceClick:(v-D.timeStamp)/1E3,ContentType:D.contentType,CommandSurface:D.commandSurface,InputMethod:D.Kx});return h}QNc(){const b=Nl.a.instance.QNc(),h=[],v=Date.now();for(const D of b)D.controlId&&h.push({Id:D.controlId,TimeElapsedSinceClick:(v-D.timeStamp)/1E3,ContentType:D.contentType,CommandSurface:D.commandSurface,InputMethod:D.Kx});return h}sof(){const b={semantic:Ca.ObjectSemantic.CanvasContext,
type:Ca.ObjectSchemaType.WordCanvasContext,value:{contentType:this.osb}};if(this.oZj){const h=Date.now(),v=this.Cpk.sof(Yh.a.instance.gb.kb);v&&v.value.contentType&&(b.value=v.value);this.gOg=Date.now()-h}return b}u7h(){const b=this.QNc(),h=this.jhb(),v=this.jhb(!0),D=[];D.push({semantic:Ca.ObjectSemantic.ControlIdHistory,type:Ca.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Ca.SequenceType.ControlId,Sequence:b}});D.push({semantic:Ca.ObjectSemantic.CommandIdHistory,type:Ca.ObjectSchemaType.CommandExecutionSequence,
value:{SequenceType:Ca.SequenceType.CommandId,Sequence:h}});D.push({semantic:Ca.ObjectSemantic.FilteredCommandIdHistory,type:Ca.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Ca.SequenceType.CommandId,Sequence:v}});D.push(this.sof());return D}aFj(){this._augLoopRuntimeManager.getSession().then(b=>this.Ted=b).catch(()=>{this.Ted=void 0})}O5n(){const b=Date.now(),h=this.u7h(),v=[Ca.IntentIds.ZeroTermMenu,Ca.IntentIds.Logging];this.gdh=Date.now()-b;this.Zwj(v,h,"ContextualMenu")}P5n(b,
h,v){2===v&&(b=this.u7h(),this.Zwj([Ca.IntentIds.Logging],b,"Floatie"));return 32}Zwj(b,h,v){if(0===b.length||0===h.length)u.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated");else{var D=new Ca.SearchSuggestionSignal({correlationId:this.VOd("ACM"),intents:b,contextObjects:h,entryPoint:v});this.xZb=0<=b.indexOf(Ca.IntentIds.ZeroTermMenu);this.hdh=Date.now();this.kwb=D.correlationId;this.sta=window.setTimeout(()=>{this.Ytn(D.correlationId)},750);h=new Al.l({parentPath:["Signal",
Ca.SearchSuggestionSignal.getTypeName()],items:[{id:ub.a.create().toString(),body:D}]});this.Ted&&!this.Ted.isClosed?this.Ted.submitOperation(h):(this._augLoopRuntimeManager.submitOperation({operation:h}),this.aFj());u.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",["correlationId"]:D.correlationId,["shouldFallBack"]:this.xZb,["intents"]:b}))}}VOd(b){const h=ub.a.create().toString();appChrome.api.setOfeCorrelationId(b,
h);return h}Ytn(b){this.kwb&&this.kwb===b&&(this.kwb=void 0,this.xZb&&this.Fcj(),u.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,["shouldFallBack"]:this.xZb})))}Fcj(){const b=this.$Nh(this.ovd.sections);appChrome.api.dispatch(b);this.jHh()}jHh(){this.Ayd=!0}K_n(b){var h,v;const D=[],P=new Map;if(!b||0===b.length)return D;for(const ca of b){if(!ca||!ca.controlIds||0===ca.controlIds.length)continue;b={controlIds:[],
id:ca.id,title:ca.title,lang:ca.lang,data:{itemsMetadata:new ac.a}};const ta="CommandsZTM"===ca.id;for(const Ra of ca.controlIds){if(P.has(Ra))continue;if(ta&&b.controlIds.length>=this.Cbk)break;const mb=null===(v=null===(h=ca.data)||void 0===h?void 0:h.itemsMetadata)||void 0===v?void 0:v[Ra];P.set(Ra,mb);b.controlIds.push(Ra);mb&&(b.data.itemsMetadata[Ra]=mb)}0<b.controlIds.length&&D.push(b)}return D}y7n(){this.Ayd=!1;if(this.p8j){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",
!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}oYo(b){this.Ayd||(b=this.sLl(b),0<b.length&&appChrome.api.dispatch(b))}sLl(b){const h=[];let v=[];var D=this.R8l();D&&0<D.length&&v.push(...D);(D=this.nKl())&&v.push(D);Array.isArray(b)&&0<b.length&&(b=this.Eua(b))&&(b.id="CommandsZTM",v.push(b));(b=this.dKl())&&v.push(b);v=this.K_n(v);if(0===v.length)return[];h.push(this.$Nh(v));this.jHh();return h}R8l(){var b,h;const v=null===(b=this.ovd)||
void 0===b?void 0:b.sections.filter(D=>{var P;return null===(P=D.id)||void 0===P?void 0:P.startsWith(hv.hVh)});for(const D of v)if(null===(h=D.data)||void 0===h?0:h.itemsMetadata)for(const P in D.data.itemsMetadata)D.data.itemsMetadata[P].source="PassThroughZeroTermMenu";return v}nKl(){const b=this.s3h(this.U0j,"DefaultZeroTermMenu");return this.Eua(b)}dKl(){const b=this.s3h(this.cWj,"AdvertizedZeroTermMenu");return this.Eua(b)}s3h(b,h){const v=[];for(const D of b)D&&this.Nuo(D)&&this.ovd.commands.has(D.id)&&
v.push({suggestion:D.id,rankingScore:-1,suggestionSource:h});return v}Nuo(b){if("number"!==typeof(null===b||void 0===b?void 0:b.count))return!0;if(0===b.count)return!1;b.count--;return!0}Eua(b){const h=[],v={itemsMetadata:new ac.a},D=Date.now();this.JIa(b);for(const P of b)b=this.vBj(P.suggestion),this.oIm(b)&&(h.push(b),v.itemsMetadata[b]={timeStamp:D,source:P.suggestionSource,confidenceScore:P.rankingScore});return 0<h.length?appChrome.api.menuSection(h,null,null,null,v):null}}Object(n.a)(Nb,"AugLoopSearchSuggestionManager",
null,[359,444]);class qc{constructor(){this.W=null}get name(){return"WordEditor.ContextualSearch"}xc(b){this.W=b;this.W.ha("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new Nb(w.AFrameworkApplication.va,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.W.resolve("Box4.CanvasContext.ICanvasContextProvider"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>
{Hq.a.Mk().then(()=>{this.start()})})}start(){this.W.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){N.a.instance.Fc(new qc)}}Object(n.a)(qc,"PackageManager",null,[1,2]);var Gc=c(434),ed=c(947);class yd extends ed.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(n.a)(yd,"BootMessage",ed.a,[]);var $d=c(1053);class be{constructor(){this.mQ=null;this.Brn=b=>{if(b.target===this.mQ)if(void 0===b.data||null===b.data)u.ULS.sendTraceTag(50739143,
3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const h=E.a(b.data);this.Mke(h.api)?this.Eed.J(h.api).H4d(h.method,h):u.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(h){u.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",h)}};this.Eed=new Td.a}DHf(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",
!1)}create(b,h){let v=!1;try{this.mQ=new Worker(b);this.mQ.onmessage=this.Brn;const D=Object.assign(new yd,{api:0,method:0,scripts:h,documentUrl:document.URL});this.postMessage(D);this.DHf()&&$d.a.LUj(this.mQ);v=!0}catch(D){u.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",D)}return v}postMessage(b){try{const h=E.c(b);this.mQ.postMessage(h)}catch(h){u.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",h)}}Mke(b){return this.Eed.mb(b)}hrk(b,
h){this.Mke(b)&&u.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",b);this.Eed.Z(b,h)}INl(b){return this.Mke(b)?this.Eed.J(b):null}}Object(n.a)(be,"WebWorker",null,[63]);class Ce{constructor(){this.aqg=[]}cgl(b,h){if(h){var v=w.AFrameworkApplication.Hz(b.Qhj,7),D=[];for(let P=0;P<b.HPb.length;P++){let ca;switch(b.HPb[P].format){case 5:case 6:ca=Gc.a.rFb(b.HPb[P].name);break;default:ca=b.HPb[P].name}D.push(w.AFrameworkApplication.Hz(ca,
b.HPb[P].format))}try{const P=URL.createObjectURL(new Blob(["importScripts('"+v+"');"],{type:"application/javascript"})),ca=new be;if(ca.create(P,D))for(this.aqg.push(ca),v=0;v<b.Lke.length;v++){const ta=h.I9k(ca,b.Lke[v]);ta&&ca.hrk(b.Lke[v],ta)}}catch(P){u.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",P.message)}}else u.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(n.a)(Ce,"WebWorkerCollection",null,
[]);class Ze{constructor(b,h){this.hYe=new Ce;if(b){b=b.create();for(let v=0;v<b.length;v++)this.hYe.cgl(b[v],h)}else u.ULS.sendTraceTag(50442779,3007,10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,h,...v){let D=!1;for(let ca=0;ca<this.hYe.aqg.length;ca++){var P=this.hYe.aqg[ca];P.Mke(b)&&((P=P.INl(b))?D=P.callMethod(h,v)||D:u.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}D||u.ULS.sendTraceTag(50442781,
3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,h)}}Object(n.a)(Ze,"WebWorkerRouter",null,[25]);class Ke extends ed.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(n.a)(Ke,"SettingsMessage",
ed.a,[]);class sg{constructor(b){this.mQ=b}}Object(n.a)(sg,"WebWorkerApiMain",null,[]);class qj extends sg{constructor(b){super(b)}DHf(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}callMethod(b,h){if(!h)return u.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.ESk(h);u.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",
b);return!1}H4d(b,h){switch(b){case 14:this.gom(h);break;default:u.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}ESk(b){if(2!==b.length)return u.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return u.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}",
"object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new Ke,{api:0,method:1,appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:w.AFrameworkApplication.userSessionId,LocalCobaltSessionId:Yi.a.instance.bP,LocalCobaltMachineId:Yi.a.instance.ilb,LocalCobaltClusterId:Yi.a.instance.lJb,LocalCobaltSessionHasBackup:Yi.a.instance.dpa,WaciiEnabledRequests:Yi.a.instance.Lja,SettingsRoutedToServer:Yi.a.instance.Gcg,WacClusterId:w.AFrameworkApplication.Ne.SY});this.mQ.postMessage(b);return!0}gom(b){this.DHf()&&
b&&b.result&&(u.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.u1o())}async u1o(){try{const b=await new $d.a.MUj.WorkerUtilsTestClass(10);await b.Ah(5);15==await b.counter?u.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):u.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){u.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",b.message)}}}Object(n.a)(qj,"InitializeWorkerApiMain",sg,[]);class ll extends ed.a{constructor(){super();
this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=0;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(n.a)(ll,"CatchUpNetworkRequestWorkerRequestMessage",ed.a,[]);class Sl extends sg{constructor(b,h){super(b);this.jGc=h}callMethod(b,h){if(4===b)return b=Object.assign(new ll,{rootQuerySignature:h[0],requestEndpoint:h[1],appMode:h[2],activityFeedIsEnabled:h[3]}),this.mQ.postMessage(b),!0;u.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",
b);return!1}H4d(b,h){switch(b){case 5:u.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.jGc.Dho(h);break;default:u.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}Object(n.a)(Sl,"CatchUpNetworkRequestWorkerExternalApi",sg,[]);class $l extends ed.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=
null}}Object(n.a)($l,"LocalInferenceMessage",ed.a,[]);class hn{constructor(){this.prediction=this.context=null}}Object(n.a)(hn,"LocalInferenceOutput",null,[]);class Rp{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=null}}Object(n.a)(Rp,"TextPredictionConfig",null,[]);class Tl{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=3}}Object(n.a)(Tl,"TextPredictionSettings",null,[]);class rl{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(n.a)(rl,
"TextPredictionDynamicPayload",null,[]);class wl extends sg{constructor(b,h){super(b);this.Jpk=h}callMethod(b,h){if(!h)return u.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),!1;switch(b){case 8:return this.KSk(h);case 7:return this.FSk(h);case 9:return this.JSk(h);case 10:return this.GSk(h);case 13:return this.HSk(h);case 14:return this.ISk(h);default:return u.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",
b),!1}}H4d(b,h){switch(b){case 9:this.lpm(h);break;default:u.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}lpm(b){b&&b.prediction&&(b=Object.assign(new hn,{prediction:b.prediction,context:b.context}),this.Jpk.awh().BJn(b))}FSk(b){if(1>b.length)return u.ULS.sendTraceTag(575959823,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new $l,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.mQ.postMessage(b);return!0}KSk(b){if(1>b.length)return u.ULS.sendTraceTag(575959824,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new $l,{api:4,method:8,paragraphContent:b});this.mQ.postMessage(b);
return!0}JSk(b){if(2>b.length)return u.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;var h=b[0];b=b[1];h=Object.assign(new $l,{api:4,method:9,paragraphContent:b,context:h});this.mQ.postMessage(h);return!0}GSk(b){if(1>b.length)return u.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new $l,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.mQ.postMessage(b);return!0}HSk(b){if(1>b.length)return u.ULS.sendTraceTag(556827920,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new $l,{api:4,method:13,textPredictionConfig:this.E8h(b)});this.mQ.postMessage(b);return!0}ISk(b){if(1>
b.length)return u.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(rb.a)(Object,b[0])),!1;b=b[0];b=Object.assign(new $l,{api:4,method:14,textPredictionConfig:this.E8h(b)});this.mQ.postMessage(b);return!0}getConfig(b=null){return Object.assign(new Rp,{scriptDirectory:w.AFrameworkApplication.w5+"/intelligence/",settings:Object.assign(new Tl,{extendedRankLimit:0}),modelFilesUrl:b})}E8h(b=
null){return Object.assign(new Rp,{scriptDirectory:w.AFrameworkApplication.w5+"/intelligence/",settings:Object.assign(new Tl,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}Object(n.a)(wl,"LocalInferenceWorkerApiMain",sg,[]);class Bk extends sg{constructor(b){super(b);w.AFrameworkApplication.cI(()=>{this.uKb()})}callMethod(b){u.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}H4d(b){u.ULS.sendTraceTag(591689870,
3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}uKb(){const b=Object.assign(new ed.a,{api:3,method:6});this.mQ.postMessage(b)}}Object(n.a)(Bk,"ShutdownWorkerApiMain",sg,[]);class Cj{constructor(b){this.container=b}I9k(b,h){let v=null;switch(h){case 0:v=new qj(b);break;case 2:v=new Sl(b,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));break;case 3:v=new Bk(b);break;case 4:v=new wl(b,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));
break;default:u.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",h)}return v}}Object(n.a)(Cj,"WordWebWorkerApiFactory",null,[443]);var Bj=c(320);class fo{constructor(b,h){this.name=b;this.format=h}}Object(n.a)(fo,"ImportedScript",null,[]);class dr{constructor(){this.Lke=this.HPb=this.Qhj=null}}Object(n.a)(dr,"WebWorkerConfig",null,[]);var uz=c(1452);class vz{constructor(b){this.Xhh=[];this.t9j=b;if(w.AFrameworkApplication.K){b=w.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||
w.AFrameworkApplication.K.$("IsCombinedBundleEnabled");const v=w.AFrameworkApplication.K.jb("ContentBaseUrl")?6:5;var h=w.AFrameworkApplication.K.jb("AppScriptBaseName");const D=b?"":".";if(h){const P=b?"":"{0}";h+=`${D}${P}worker.js`;this.Xhh.push(new fo(`MicrosoftAjax${b?"":"DS"}.${P}js`,v),new fo(h,v))}else u.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else u.ULS.sendTraceTag(558465107,3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=
[],h=Object.assign(new dr,{Qhj:"workerboot",HPb:this.Xhh,Lke:[0,2,3,4]});this.t9j&&this.pKm()&&h.HPb.push(new fo("intelligence/edge-inference-web.js",5));b.push(h);return b}pKm(){return(new Bj.a("arrowFunction",()=>{try{Object(uz.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}}Object(n.a)(vz,"WordWebWorkerConfigFactory",null,[442]);class tv{constructor(){this.Fa=this.W=null}get name(){return"WordEditor.Workers"}init(){const b=this.W.resolve("Box4.Workers.IWebWorkerRouter");
b.sendMessage.apply(b,[0,1].concat([this.Fa.appSettings,w.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}xc(b){this.W=b;this.Fa=this.W.resolve("Common.IAppSettingsManager");const h=this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ha("Box4.Workers.WebWorkerRouter",()=>new Ze(new vz(h),new Cj(b))).as("Box4.Workers.IWebWorkerRouter").singleInstance()}static main(){N.a.instance.Fc(new tv)}}Object(n.a)(tv,"WordEditorWorkersPackage",null,[1,2]);var jA=c(1174);
class By{constructor(){this.ktd=[]}Mfi(b,h){let v=-1,D=null;D=P=>{P?h(this.ktd[v]):(++v,v<this.ktd.length?this.ktd[v].w2b(b,D):h(null))};D(!1)}w2b(b,h){this.Mfi(b,v=>{h(!!v)})}Lhc(b,h,v){this.Mfi(b,D=>{if(!D)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");D.Lhc(b,h,v)})}iph(b){this.ktd.push(b)}}Object(n.a)(By,"CompositeExternalContentURLResolver",null,[718,187]);var Jx=c(1447);class uB extends Jx.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=
null;this.Height=this.Width=0;this.ProviderName=this.IFrameHtml=null}}Object(n.a)(uB,"ExternalContentEmbedResponse",Jx.a,[]);var au=c(1464),mC=c(1851),sD=c(1850),nC=c(1365),oC=c(705),wz=c(496),Sw=c(167),vB=c(856),Lr;(function(b){b[b.autoCorrect=0]="autoCorrect";b[b.externalComponentPaste=1]="externalComponentPaste";b[b.externalHyperlinkPaste=2]="externalHyperlinkPaste";b[b.Igp=3]="externalContentFloatieConversion"})(Lr||(Lr={}));Object(n.b)("ExternalContentConversionContext",Lr);class dh{constructor(){this.OIb=
this.NIb=null;this.Djf=new nC.ExternalContentEmbedRetriever;this.iBc=!0;this.btc=this.jo=this.kpi=this.jpi=this.Nl=this.Hp=null;this.picturePasteRequestSucceeded=()=>{u.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.igc=()=>{u.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=dh.jna&&dh.jna.w7h()}get ROb(){return this.iBc}set ROb(b){this.iBc=b}i6e(b,h){let v=!1;if(b){switch(b.contextId){case sc.a.Tc:v=!h;
break;case sc.a.Hd:v=!0}v&&!vB.a(b.node)&&(v=!1)}return v}VVm(b){const h=b.startsWith(Re.a.Kgc),v=b.startsWith(Re.a.L2c),D=b.startsWith(Re.a.dbe);return(h||v||D)&&Re.a.x3a(b)}l7i(){this.jo=W.a.create();dh.tf.CBb(this.jo,4);dh.tf.X4(this.jo,0,dh.tf.zn());this.SGb(this.NIb,3,this.OIb,!0)}QPa(b,h,v){this.jo=W.a.create();dh.tf.CBb(this.jo,v?0:2);dh.tf.X4(this.jo,0,dh.tf.zn());this.btc();this.SGb(b,v?0:2,h)}o$d(b,h){this.jo=W.a.create();dh.tf.CBb(this.jo,1);dh.tf.X4(this.jo,0,dh.tf.zn());this.SGb(b,1,
h)}ZWd(b,h,v,D){if(!b||!b.isConnected||!oe.ImageReader.Ju(b))return null;const P=new oC.a;P.setValue(Vi.a.d$b,v);P.setValue(Vi.a.KPa,h);P.j_a=this.jpi;P.Uw=this.kpi;P.providerName=D;P.z3a=1===v;he.GraphIterator.$a(b).Af(P,2);this.UYc(P);return P}i9i(b){this.btc=b}Cre(b,h){const v=dh.a1.$4b(h)||0;h=dh.a1.O_a(h)||0;const D=b.Width/b.Height;1<=D?(b.Width=v,b.Height=v/D):(b.Height=h,b.Width=h/D)}asg(b,h,v){if(null!=b&&null!=h&&!G.a.jf(v)){var D=dh.s_c.x8b(v);w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",
!1)?D.Aqa=!1:D.Aqa=!0;D.hideFloatie=!0;this.Cre(b,h.node);this.F$b(b,h,!1,!1,D,v)}}gib(b){return b?b.Qe:0}tog(b,h,v){let D=null;const P=b.node;if(!fe.ParagraphReader.Wb(P)||!P.isConnected)return{returnValue:!1,gra:D};if(v)return{returnValue:!0,gra:b};v=b.cpBegin;const ca=b.cpEnd,ta=fe.ParagraphReader.text(P);if(0<=v&&ca<=ta.length&&ta.substring(v,ca)===h)return{returnValue:!0,gra:b};const Ra=ta.indexOf(h);return 0<=Ra?(D=we.a.createTextRange(P,Ra,Ra+h.length),{returnValue:!0,gra:D}):0<=v&&ca<=ta.length&&
this.J9b(b)?{returnValue:!0,gra:b}:{returnValue:!1,gra:D}}J9b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=we.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Re.a.zA(h,!1);if(1===h.length){h=h[0];const v=fe.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==v)return!0}return!1}tHf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}L7a(b,h){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$(h)&&
window.setTimeout(()=>{const v=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");v&&v.execute(D=>{D.logActivity(b,h)})},dh.zDa)}cqf(b,h){const v=!G.a.G7(h);switch(b){case 1:b=v?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=v?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}SGb(b,
h,v,D=!1){if(this.VVm(v)){var P=dh.s_c.x8b(v);if(P)if(this.tHf(P)){u.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(Na.a)(we.a,b);var ca=!h;this.i6e(b,ca)?this.tUc(v)?(h=1===h,D=this.jYl(b),P.hideFloatie=!0,this.F$b(D,b,ca,h,P,v)):this.z_f(b,h,P,v,D):dh.tf.LQ(this.jo,2,"URL inserted in Non-Embedable context",dh.tf.zn())}else u.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),dh.tf.LQ(this.jo,2,"Size provided is not valid for OEmbed",
dh.tf.zn())}else u.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),dh.tf.LQ(this.jo,2,"URL inserted is not valid for ExternalContent",dh.tf.zn())}jYl(b){const h=new uB;h.Width=dh.a1.$4b(b.node)||0;h.Height=dh.a1.O_a(b.node)||0;h.Title="Fluid Component";h.MediaType="fluid";return h}tUc(b){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=dh.d9&&dh.d9.ECi(b)}z_f(b,h,v,D,P){const ca=
!h,ta=1===h,Ra=dh.a1.$4b(b.node)||0,mb=dh.a1.O_a(b.node)||0,Jb=au.a.O9e(v.Mng,!0,Ra,mb);this.wYc(b,D,h,!0);this.Djf.TCh(Jb,Ub=>{dh.tf.X4(this.jo,4,dh.tf.zn());dh.tf.q7c(this.jo,this.gib(Ub.data));if(Ub=this.F_f(Ub)){u.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var cc=Sw.q(Ub.MediaType);dh.tf.Vce(this.jo,7,cc);cc=b;({gra:cc}=this.tog(b,D,ta)).returnValue?(this.wYc(cc,D,h,!1),null==v.width?0<Ra&&Ub.Width>Ra&&(u.ULS.sendTraceTag(591681426,
324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Ub.Width=Ra):(u.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Ub.Width=this.Xbd(v.width,Ub.Width,Ra)),null==v.height?0<mb&&Ub.Height>mb&&(u.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Ub.Height=mb):(u.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),
Ub.Height=this.Xbd(v.height,Ub.Height,mb)),dh.jna.U9a||P?this.F$b(Ub,cc,ca,ta,v,D):(this.NIb=b,this.OIb=D,this.wIc(D))):(u.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),dh.tf.LQ(this.jo,2,"No conversion as the context is no longer valid for the external content conversion",dh.tf.zn()));ta&&this.VZa(cc.node)}else ta&&this.VZa(b.node),dh.tf.LQ(this.jo,1,"URL not oEmbedable",dh.tf.zn())},Ub=>{dh.tf.X4(this.jo,
4,dh.tf.zn());dh.tf.q7c(this.jo,this.gib(Ub.data));ta&&this.VZa(b.node);u.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Ub.data.ve);dh.tf.LQ(this.jo,2,"ExternalContentEmbedRequest failed",dh.tf.zn())},Ub=>{ta&&this.VZa(b.node);u.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Ub)},this.jo)}Xbd(b,h,v){!b&&0<v&&h>v||b>v?(u.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),
h=v):b>v?h=v:b&&b<v&&(h=b);return h}F$b(b,h,v,D,P,ca){this.Nl=ub.a.create();b.Width=b.Width/b.Height*(b.Height-(wz.a.pRc+wz.a.o3))+2*wz.a.o3;const ta=new eh.GraphTransaction(15);ta.Cb(h.node);ta.jk=Nc.a.QPa;const Ra=this.J9b(h);null!=P.Aqa&&!P.Aqa||D||Ra||(b.Title=""===P.title||P.title?P.title:b.Title,!b.Title&&""!==b.Title)||(h=this.XAf(h,ta,b.Title,ca,v));if(h){D&&(h=this.Vdf(h));var mb=this.$Gd(h,D);if(mb){v=Sw.q(b.MediaType);var Jb=this.WRd(b,v);this.jpi=b.IFrameHtml;this.kpi=b.Title;if(mb=this.GAf(mb,
Jb,ta,D,ca,v,b.ProviderName))ta.ZFa(this.Nl,1),ta.dispose(),this.NIb=h,this.OIb=ca,this.vXf(P,b,mb),this.n_f(ca,D||P.hideFloatie,Ra,v,b.Title)}else ta.dispose(),u.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),dh.tf.LQ(this.jo,2,"Could not create IP context on splitting the paragraph",dh.tf.zn())}else dh.tf.LQ(this.jo,2,"GraphNodeContext is null",dh.tf.zn())}WRd(b,h){const v=new Md.DictionaryPropertySet;dh.QO.sae(v,b.Width,
b.Height);b=this.bqf(h,b.Title);v.setValue(lf.a.imageAltText,b);v.setValue(Bc.a.iU,se.a.uF());v.setValue(Bc.a.imageType,0);return v}GAf(b,h,v,D,P,ca,ta){if(!b)return null;b=dh.QO.cXd(b,h);if(!b)return v.dispose(),u.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),dh.tf.LQ(this.jo,2,"The anchored image could not be inserted",dh.tf.zn()),null;v=b.node;P=this.ZWd(v,P,ca,ta);dh.tf.Pmg(this.jo,P.id);D||this.Fag(v);return v}vXf(b,h,v){G.a.G7(b.thumbnailUrl)||
(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(dh.tf.X4(this.jo,8,dh.tf.zn()),u.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.sJd(v,h.Thumbnail))}n_f(b,h,v,D,P){h||this.wIc(b);this.L7a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");this.r9d("IsHyperlinkWithNonURLDisplayText",v);this.ariaNotify(D,P);dh.tf.X4(this.jo,5,dh.tf.zn())}r9d(b,h){u.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");
fa.a.sendTelemetryEvent(Object.assign(new oa.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new na.a,{name:b,bool:h})]}))}ariaNotify(b,h){this.ROb&&dh.zu&&(b=this.cqf(b,h),dh.zu.sendNotification(b,!0))}XAf(b,h,v,D,P){if(P){if((P=Re.a.zA(b,!1))&&1!==P.length)return h.dispose(),u.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;dh.hyperlinkEditor.HR(P[0].paragraph,P[0].hyperlink)}return this.R6f(b,
v,D)}Vdf(b){const h=b.node,v=fe.ParagraphReader.text(h);return 0<v.length&&!v.trim().length?(b=we.a.createTextRange(h,0,v.length),dh.characterPropertiesEditor.replaceTextRange(b,""),we.a.Qc(h,0)):b}$Gd(b,h){return h?b:this.Yqf(b)}Yqf(b){const h=fe.ParagraphReader.text(b.node),v=he.GraphIterator.$a(b.node);if(v.vd()){b=we.a.Qc(b.node,b.cpEnd);hf.OutlineElementNavigator.Vd(v);const D=dh.eg.noa(v);dh.nh.Z9(v,D,b,!0,!0,!0,!0);""!=h&&dh.nh.xz(v,!1,!0);v.Pd();return we.a.Qc(v.currentNode,0)}return null}F_f(b){if(!({group:b}=
bi.a.q1(b.data.ve)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}R6f(b,h,v){const D=b.cpBegin+h.length;dh.characterPropertiesEditor.replaceTextRange(b,h);b=we.a.createTextRange(b.node,b.cpBegin,D);dh.hyperlinkEditor.kG(b,v,!1);return b}bqf(b,h){const v=!G.a.G7(h);switch(b){case 1:return v?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return v?
String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}sJd(b,h){b.Vi().contentReplicator.forceOutbound(()=>{this.D_f(h,b)},()=>{u.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}UYc(b){b=he.GraphIterator.$a(b);b.zb(12);b.jd(12);b.wn.yQ=!0}VZa(b){b.dgc=null}Fag(b){b=he.GraphIterator.$a(b);b.zb(11)&&(b.jd(11),
b.vd()&&b.Lj()&&b.Pd()&&fe.ParagraphReader.Wb(b.currentNode)&&(b=Og.SelectionFactory.pe(b.currentNode,0),Yh.a.instance.setSelection(b)))}wYc(b,h,v,D){const P=b.cpBegin,ca=b.cpEnd;b=fe.ParagraphReader.text(b.node).trim();P||b!==h&&""!==b?P?ca===b.length?u.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Lr[v],D):0<P&&ca<b.length&&u.ULS.sendTraceTag(590958602,324,
50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Lr[v],D):u.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Lr[v],D):u.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Lr[v],D)}wIc(b){this.g5b();const h=new Gh.a(1,w.AFrameworkApplication.isRtl);h.E1c=b;dh.Fgb.K3c(h)}g5b(){const b=new oh.a(!0);dh.w9.XGa(b)}D_f(b,h){if(b=this.ctf(b,h))h=Array(1),h[0]=b,b=mC.a.construct(h,!1,w.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Hp.vr:null),h=this.Zbf(),this.mob(h,b)}ctf(b,h){if(!h)return u.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Hp=h.Vi();(new he.GraphIterator).set(h);
if(!h.anchor||!h.anchor.hq||!h.anchor.hq.zr)return u.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var v=h.anchor.hq.zr.node;if(!v)return u.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;v=v.ia(Hh.a.EJ,ij.a.Jt);const D=h.getValue(lf.a.MK),P=Ef.a.vf(oe.ImageReader.JC(h.properties),0),ca=Ef.a.vf(oe.ImageReader.HH(h.properties),1);return sD.a.construct(h.id.toString(),
b,h.ia(lf.a.imageAltText,""),P,ca,h.ia(Bc.a.RX,""),v,h.ia(Bc.a.iU,0),h.ia(Bc.a.sha,!1),h.ia(Hh.a.kga,-1),h.ia(Bc.a.jlb,Box4Intl.Box4Strings.l_Picture),h.ia(lf.a.Jwa,!1),D,h.ia(Bc.a.runId,1),h.ia(Bc.a.Lc,0))}mob(b,h){w.AFrameworkApplication.Ne.xj(b,2,E.c(h),{},!1,2,this.picturePasteRequestSucceeded,this.igc,null,void 0,void 0,void 0,void 0,"26");u.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}Zbf(){let b=ia.a.hNc("PicturePaste.ashx");w.AFrameworkApplication.K&&!w.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&
(b=ia.a.fo(b,yh.a.fileId,this.Hp.vr));b=ia.a.fo(b,yh.a.cellId,this.Hp.nm.toString());this.Nl||(this.Nl=ub.a.create(),u.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=ia.a.fo(b,yh.a.jX,this.Nl.toString());b=ia.a.fo(b,yh.a.classId,(393233).toString());this.Hp.DH&&(b=ia.a.fo(b,yh.a.DH,this.Hp.DH));b=ia.a.fo(b,yh.a.Nqb,"1");b=ia.a.fo(b,Pg.a.imageType,"0");b=Yi.a.instance.q_e(b);this.Hp.contentReplicator&&this.Hp.contentReplicator.vIb&&(b=ia.a.fo(b,
yh.a.Y3e,"1"));b=ia.a.fo(b,yh.a.$ta,this.Hp.contentReplicator.Ht.toString());b=ia.a.fo(b,yh.a.bgc,"0");return b=ia.a.fo(b,yh.a.tRb,"1")}static get Fgb(){return null!=dh.Cyg?dh.Cyg:dh.Cyg=Ea.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get jna(){dh.sAa||(dh.sAa=Ea.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return dh.sAa}static get w9(){return null!=dh.SFg?dh.SFg:dh.SFg=Ea.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get zu(){return null!=
dh.vwg?dh.vwg:dh.vwg=Ea.a.instance.resolve("Common.Utils.IAriaNotifier")}static get a1(){return null!=dh.XGg?dh.XGg:dh.XGg=Ea.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get QO(){return null!=dh.nBg?dh.nBg:dh.nBg=Ea.a.instance.resolve("WordEditor.IImageEditor")}static get eg(){return dh.nh||(dh.nh=Ea.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hyperlinkEditor(){return null!=dh.fBg?dh.fBg:dh.fBg=Ea.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=
dh.bxg?dh.bxg:dh.bxg=Ea.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get tf(){return null!=dh.Lyg?dh.Lyg:dh.Lyg=Ea.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}static get s_c(){return null!=dh.EEg?dh.EEg:dh.EEg=Ea.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}static get d9(){return null!=dh.wEg?dh.wEg:dh.wEg=Ea.a.instance.resolve("Fluid.Host.LoopComponentManager")}}dh.nh=null;dh.zDa=5E3;dh.sAa=null;Object(n.a)(dh,"ExternalContentEditor",
null,[161]);var Zm=c(258),tD=c(1210);class uD{constructor(b,h){this.U9a=!0;this.P4a=v=>{if(null!=v.result)return v.result.Value;u.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");return this.U9a};this.sGa=v=>{v.yo||v.Ai?u.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):(this.Hzh(v.result),u.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));
return this.U9a};this.Cv=b;this.AK=h}w7h(){const b=new th.a;this.IBi()&&this.AK?this.AK.H5a(Zm.a.XHc).CWRCo(this.P4a,0).CWRCo(this.sGa,8):b.Bg(this.U9a)}w1(b){this.AK&&this.AK.w1(Zm.a.XHc,new tD.a(Zm.a.XHc,b))}abo(b){this.IBi()&&(this.Cv.bja("saveConvertExternalContentIsEnabled",b.toString()),u.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),this.Hzh(b),this.w1(b))}IBi(){const b=w.AFrameworkApplication.K.$("IsAnonymousUser");if(w.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)u.ULS.sendTraceTag(559437387,
324,50,"User is anonymous ");else return!0;return!1}Hzh(b){this.U9a=b}}Object(n.a)(uD,"ExternalContentSettingInfo",null,[723]);var HD=c(1145);class vD{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(n.a)(vD,"FluidComponentProperties",null,[]);class wD{constructor(){this.loopType=this.Uw=this.j_a=this.url=null;this.mediaType=0;this.ILi=null}}Object(n.a)(wD,"IFrameProps",null,[]);class sl{static get a1(){return null!=
sl.VGg?sl.VGg:sl.VGg=Ea.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get QO(){return sl.Uj||(sl.Uj=Ea.a.instance.resolve("WordEditor.IImageEditor"))}static get zu(){return null!=sl.uwg?sl.uwg:sl.uwg=Ea.a.instance.resolve("Common.Utils.IAriaNotifier")}static get hyperlinkEditor(){return null!=sl.$Ag?sl.$Ag:sl.$Ag=Ea.a.instance.resolve("Box4.IHyperlinkEditor")}static get eg(){return null!=sl.YEg?sl.YEg:sl.YEg=Ea.a.instance.resolve("Box4.IOutlineElementEditor")}static get characterPropertiesEditor(){return null!=
sl.$wg?sl.$wg:sl.$wg=Ea.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static x3a(b){const h=b.startsWith(Re.a.Kgc),v=b.startsWith(Re.a.L2c),D=b.startsWith(Re.a.dbe);return(h||v||D)&&Re.a.x3a(b)}static i6e(b,h){let v=!1;if(b){switch(b.contextId){case sc.a.Tc:v=!h;break;case sc.a.Hd:v=!0}v&&!vB.a(b.node)&&(v=!1)}return v}static J9b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=we.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Re.a.zA(h,!1);if(1===h.length){h=h[0];const v=fe.ParagraphReader.text(b.node).substring(h.cpBegin,
h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==v)return!0}return!1}static bqf(b,h){const v=!G.a.G7(h);switch(b){case 1:return v?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return v?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static UYc(b){b=
he.GraphIterator.$a(b);b.zb(12);b.jd(12);b.wn.yQ=!0}static WRd(b,h,v,D){const P=new Md.DictionaryPropertySet;sl.QO.sae(P,h,b);b=sl.bqf(D,v);P.setValue(lf.a.imageAltText,b);P.setValue(Bc.a.iU,se.a.uF());P.setValue(Bc.a.imageType,0);return P}static ZWd(b,h,v){if(!b||!b.isConnected||!oe.ImageReader.Ju(b))return null;const D=new oC.a;D.setValue(Vi.a.d$b,h.mediaType);D.setValue(Vi.a.KPa,h.url);D.setValue(Wc.a.loopComponentType,h.loopType);D.j_a=h.j_a;D.Uw=h.Uw;D.providerName=v;D.z3a=1===h.mediaType;D.createMode=
h.ILi;he.GraphIterator.$a(b).Af(D,2);sl.UYc(D);return D}static $Gd(b,h){return h?b:sl.Yqf(b)}static Yqf(b){const h=fe.ParagraphReader.text(b.node),v=he.GraphIterator.$a(b.node);if(v.vd()){b=we.a.Qc(b.node,b.cpEnd);hf.OutlineElementNavigator.Vd(v);const D=sl.eg.noa(v);sl.eg.Z9(v,D,b,!0,!0,!0,!0);""!=h&&sl.eg.xz(v,!1,!0);v.Pd();return we.a.Qc(v.currentNode,0)}return null}static Fag(b){b=he.GraphIterator.$a(b);b.zb(11)&&(b.jd(11),b.vd()&&b.Lj()&&b.Pd()&&fe.ParagraphReader.Wb(b.currentNode)&&(b=Og.SelectionFactory.pe(b.currentNode,
0),Yh.a.instance.setSelection(b)))}static cqf(b,h){const v=!G.a.G7(h);switch(b){case 1:b=v?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=v?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,
h){sl.zu&&(b=sl.cqf(b,h),sl.zu.sendNotification(b,!0))}static r9d(b,h,v){u.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");fa.a.sendTelemetryEvent(Object.assign(new oa.a,{name:v,dataFields:[Object.assign(new na.a,{name:b,bool:h})]}))}}Object(n.a)(sl,"ExternalContentHelper",null,[]);var kA=c(727);class uv{constructor(){this.Nl=this.Hp=null}sJd(b,h,v){b.Vi().contentReplicator.forceOutbound(()=>{this.D_f(h,b,v)},()=>{u.ULS.sendTraceTag(592996173,324,
15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}D_f(b,h,v){if(b=this.ctf(b,h))h=Array(1),h[0]=b,v=mC.a.construct(h,v,w.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Hp.vr:null),b=this.Zbf(),this.mob(b,v)}ctf(b,h){if(!h)return u.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Hp=h.Vi();(new he.GraphIterator).set(h);if(!h.anchor||!h.anchor.hq||!h.anchor.hq.zr)return u.ULS.sendTraceTag(592996171,
324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var v=h.anchor.hq.zr.node;if(!v)return u.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;v=v.ia(Hh.a.EJ,ij.a.Jt);const D=h.getValue(lf.a.MK),P=Ef.a.vf(oe.ImageReader.JC(h.properties),0),ca=Ef.a.vf(oe.ImageReader.HH(h.properties),1);return sD.a.construct(h.id.toString(),b,h.ia(lf.a.imageAltText,""),P,ca,h.ia(Bc.a.RX,""),v,h.ia(Bc.a.iU,
0),h.ia(Bc.a.sha,!1),h.ia(Hh.a.kga,-1),h.ia(Bc.a.jlb,Box4Intl.Box4Strings.l_Picture),h.ia(lf.a.Jwa,!1),D,h.ia(Bc.a.runId,1),h.ia(Bc.a.Lc,0))}mob(b,h){w.AFrameworkApplication.Ne.xj(b,2,E.c(h),{},!1,2,this.picturePasteRequestSucceeded.bind(this),this.igc.bind(this),null,void 0,void 0,void 0,void 0,"26");u.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}picturePasteRequestSucceeded(){u.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}igc(){u.ULS.sendTraceTag(592996168,
324,10,"Picture paste request for External Content failed.")}Zbf(){let b=ia.a.hNc("PicturePaste.ashx");w.AFrameworkApplication.K&&!w.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=ia.a.fo(b,yh.a.fileId,this.Hp.vr));b=ia.a.fo(b,yh.a.cellId,this.Hp.nm.toString());this.Nl||(this.Nl=ub.a.create(),u.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=ia.a.fo(b,yh.a.jX,this.Nl.toString());b=ia.a.fo(b,yh.a.classId,(393233).toString());
this.Hp.DH&&(b=ia.a.fo(b,yh.a.DH,this.Hp.DH));b=ia.a.fo(b,yh.a.Nqb,"1");b=ia.a.fo(b,Pg.a.imageType,"0");b=Yi.a.instance.q_e(b);this.Hp.contentReplicator&&this.Hp.contentReplicator.vIb&&(b=ia.a.fo(b,yh.a.Y3e,"1"));b=ia.a.fo(b,yh.a.$ta,this.Hp.contentReplicator.Ht.toString());b=ia.a.fo(b,yh.a.bgc,"0");return b=ia.a.fo(b,yh.a.tRb,"1")}}Object(n.a)(uv,"ExternalContentThumbnailHelper",null,[]);class yu extends uv{constructor(){super(...arguments);this.jo=null}static get tf(){return null!=yu.Kyg?yu.Kyg:
yu.Kyg=Ea.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}fKj(b,h,v){return sl.x3a(h)?sl.i6e(b,v)?!0:(yu.tf.LQ(this.jo,2,"URL inserted in Non-Embedable context",yu.tf.zn()),!1):(u.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),yu.tf.LQ(this.jo,2,"URL inserted is not valid for ExternalContent",yu.tf.zn()),!1)}}Object(n.a)(yu,"AbstractExternalContentEditor",uv,[161]);var zu=c(1172),$E=c(1175);class bu extends yu{constructor(b){super();
bu.UWa=b;this.cKf()}cKf(){this.bog&&$E.a.cKf(bu.UWa.d8h())}static get paragraphEditor(){return null!=bu.wFg?bu.wFg:bu.wFg=Ea.a.instance.resolve("Box4.IParagraphEditor")}Dal(b,h){h=this.Lbi(b,h);this.msi(h,b,5)}QPa(b,h,v){if(this.fKj(b,h,v)){var D=this.Lbi(b,null);D.url=h;this.msi(D,b,v?0:2)}}o$d(b,h){this.QPa(b,h,!1)}msi(b,h,v){this.Nl=ub.a.create();const D=new eh.GraphTransaction(15);D.Cb(h.node);D.jk=Nc.a.qCm;const P=sl.J9b(h),ca=Sw.q(b.mediaType),ta=sl.WRd(b.height,b.width,b.title,ca);h=this.RWo(h,
1==v);(h=sl.Uj.cXd(h,ta))?(h=h.node,sl.ZWd(h,{url:b.url,mediaType:ca,Uw:b.title,loopType:b.type,ILi:v},void 0)||u.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),D.ZFa(this.Nl,1),D.dispose(),this.sJd(h,b.thumbnail,!1),this.bGn(P,ca,b.type)):u.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}RWo(b,h){sl.characterPropertiesEditor.replaceTextRange(b,"");return sl.$Gd(b,h)}bGn(b,h,v){sl.r9d("IsHyperlinkWithNonURLDisplayText",
b,"Office.Word.Online.ExternalContent.FluidComponent");sl.ariaNotify(h,this.YNl(v))}YNl(b){switch(b){case kA.a.CheckList:return"Checklist Component";case kA.a.TaskAssignment:return"Task List Component";case kA.a.Poll:return"Poll Component";default:return"Fluid Component"}}Lbi(b,h){const v=new vD;v.width=sl.a1.$4b(b.node)||0;Sw.j()?v.height=null!=bu.UWa&&bu.UWa.b8h(h)||sl.a1.O_a(b.node)||0:v.height=null!=bu.UWa&&bu.UWa.b8h(h)+2*wz.a.o3||sl.a1.O_a(b.node)||0;v.title="Fluid Component";v.mediaType="fluid";
v.type=h;v.thumbnail=this.kYl();v.url=null!=bu.UWa&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2210.23001/en-us_web/assets/fallback.jpg";return v}kYl(){return bu.UWa.d8h()}get bog(){return null!=this.wJg?this.wJg:this.wJg=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.useUpdatedFluidThumbailEnabledV3",!1)}static tUc(b){w.AFrameworkApplication.ue("2cejb611;b0jjh576");return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1)&&null!=bu.UWa&&bu.UWa.ECi(b)&&zu.a.FXk(b)}}Object(n.a)(bu,"FluidComponentEditor",yu,[]);class Ks{get Nzl(){return null!=this.Byg?this.Byg:this.Byg=Ea.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor")}get RMd(){return null!=this.Tzg?this.Tzg:this.Tzg=Ea.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}WFn(b,h){b&&(bu.tUc(h)?this.RMd.QPa(b,h,!0):this.Nzl.QPa(b,h,!0))}}Object(n.a)(Ks,"PostHyperlinkAutoCorrectStrategy",null,[721]);class Nq{w2b(b,h){h(Nq.gGn.test(b))}Lhc(b,
h){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",960,960,b);b=Object.assign(new uB,{OperationId:0,StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:Nq.thumbnailUrl,Title:"Power BI",IFrameHtml:b});h(b)}}Nq.gGn=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$",
"i");Nq.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(n.a)(Nq,"PowerBIURLResolver",null,[718,187]);class Kx{constructor(b){this.Bkh=b}w2b(b,h){let v=!1;try{if(Kx.YTm(b)){const D=this.Bkh.x8b(b);v=null!=D.width&&null!=D.height&&!!D.thumbnailUrl&&!!D.title&&null!=D.Aqa}}catch(D){}h(v)}Lhc(b,h){var v=this.Bkh.x8b(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",
v.width,v.height,b);v=Object.assign(new uB,{Height:v.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:v.thumbnailUrl,Title:v.title,Width:v.width});h(v)}static YTm(b){for(const h of Kx.jGo)if(b.startsWith(h))return!0;return!1}static O7(){return new Kx(Ea.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}Kx.jGo=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(n.a)(Kx,"WedgeComponentExperimentsURLResolver",null,[718,
187]);var gw=c(872);class $m{static Lsj(b){$m.jzi||$m.addEventListener();const h=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");h&&h.execute(v=>{v.logActivity(b,null)})}static addEventListener(){window.addEventListener($m.RGo,$m.QGo,!0);$m.jzi=!0}static c_k(){const b=window.document.getElementById("LoopComponent");null===b||void 0===b?void 0:b.click()}}$m.$Io="LoopsTeachingCalloutOnInsertTabActivity";$m.F9m="LoopHomeTabFlightActivity";$m.RGo="switchToInsertTabAndClickLoopButtonEvent";$m.jzi=
!1;$m.QGo=()=>{var b,h;appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"));const v=null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.mc("WordLoopsTUIButtonDropdownDelayInMs",50);b=new qf.a(0,1,v,()=>{$m.c_k()});null===(h=w.AFrameworkApplication.nc)||void 0===h?void 0:h.Vb(b)};Object(n.a)($m,"FluidComponentsTUIHelper",null,[]);class qE{constructor(b,h,v){this.ga=b;this.Y3j=h;this.Jk=v;this.K1g=!1;this.b6g=1E3;this.c6g=15E3;this.OSe=this.ESe=!0;this.OSe=!!w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowLoopComponentSurveyEnabled",!1);this.b6g=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.LoopComponentDropdownFocusTime",1E3);this.c6g=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NotUseLoopComponentSurveyTriggerTime",15E3)}Tb(){this.ga.eb(Nc.a.ssi,sc.a.Tc,this.NCm.bind(this),1028);this.ga.eb(Nc.a.aae,sc.a.Tc,
this.aae.bind(this),1028);this.ga.eb(Nc.a.fTc,sc.a.Tc,this.KAf.bind(this),1028);this.ga.eb(Nc.a.TSc,sc.a.Tc,this.KAf.bind(this),1028);this.ga.eb(Nc.a.gXd,sc.a.Tc,this.KAf.bind(this),1028);this.ga.eb(Nc.a.fGi,sc.a.Tc,this.fQj.bind(this),1028)}NCm(){return 32}aae(b,h,v){if(2!==v)return 32;this.OSe&&(this.Xaj(),this.uOo());return 32}KAf(b,h,v){var D,P,ca;if(1===v){if(!this.$Yd(b)||!gw.a.Nxi())return u.ULS.sendTraceTag(508937180,324,50,"Loops feature is disabled as it is not supported"),2;(null===(D=
w.AFrameworkApplication.K)||void 0===D?0:D.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsTUIEnabled",!1))&&$m.Lsj($m.$Io);if(!h.hl||!$e.SelectionEditor.gf(h)||(null===(P=this.Jk)||void 0===P?0:P.k_(h))||(null===(ca=this.Jk)||void 0===ca?0:ca.uha(h)))return 2;if(h&&h.node&&vB.a(h.node))return 32}else if(2===v)return this.Y3j.Dal(h,qE.iYl(b)),this.Xaj(),32;return 2}uOo(){null!=$a.a.instance.getItem("LoopComponentSurveyShowed")&&(this.ESe=!1);if(this.ESe){let b=this.Kbi();window.setTimeout(()=>
{b&&"hidden"!==b.visibility&&(this.K1g=!0)},this.b6g);this.uhk=window.setTimeout(()=>{const h=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");this.K1g&&h&&h.execute(v=>{(b=this.Kbi())&&"hidden"===b.visibility&&(u.ULS.sendTraceTag(508941015,324,50,"Triggering not use loop component survey"),v.QHa("WordLoopFeedbackSurvey",null),this.ESe=!1,$a.a.instance.setItem("LoopComponentSurveyShowed","true"))})},this.c6g)}}Kbi(){var b,h;let v=null;try{const D=document.getElementById("Ribbon-LoopComponentDropdown");
D&&(v=hd.a.vB(null===(h=null===(b=D.parentNode)||void 0===b?void 0:b.parentNode)||void 0===h?void 0:h.parentNode))}catch(D){u.ULS.sendTraceTag(508941014,324,10,"Loop component dropdown get parent and parent get exception "+(null!=D?D.toString():""))}return v}Xaj(){this.OSe&&window.clearTimeout(this.uhk)}$Yd(b){return b===Nc.a.TSc||b===Nc.a.fTc?zu.a.$Yd():!0}fQj(b,h,v){2===v&&G.a.uU("https://go.microsoft.com/fwlink/?linkid=2194838")&&Xa.App.g9f.wmc("https://go.microsoft.com/fwlink/?linkid=2194838");
return 32}static iYl(b){switch(b){case Nc.a.fTc:return kA.a.TaskAssignment;case Nc.a.TSc:return kA.a.CheckList;case Nc.a.gXd:return kA.a.Poll;default:return null}}}Object(n.a)(qE,"FluidComponentsActor",null,[]);class Lj extends yu{constructor(){super();this.OIb=this.NIb=null;this.Djf=new nC.ExternalContentEmbedRetriever;this.btc=null;null!=Lj.jna&&Lj.jna.w7h()}l7i(){this.jo=W.a.create();Lj.tf.CBb(this.jo,4);Lj.tf.X4(this.jo,0,Lj.tf.zn());this.SGb(this.NIb,3,this.OIb,!0)}QPa(b,h,v){this.jo=W.a.create();
Lj.tf.CBb(this.jo,v?0:2);Lj.tf.X4(this.jo,0,Lj.tf.zn());this.btc();this.SGb(b,v?0:2,h)}o$d(b,h){this.jo=W.a.create();Lj.tf.CBb(this.jo,1);Lj.tf.X4(this.jo,0,Lj.tf.zn());this.SGb(b,1,h)}i9i(b){this.btc=b}Cre(b,h){const v=Lj.a1.$4b(h)||0;h=Lj.a1.O_a(h)||0;const D=b.Width/b.Height;1<=D?(b.Width=v,b.Height=v/D):(b.Height=h,b.Width=h/D)}asg(b,h,v){if(null!=b&&null!=h&&!G.a.jf(v)){var D=Lj.s_c.x8b(v);w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",
!1)?D.Aqa=!1:D.Aqa=!0;D.hideFloatie=!0;this.Cre(b,h.node);this.F$b(b,h,!1,!1,D,v)}}gib(b){return b?b.Qe:0}tog(b,h,v){let D=null;const P=b.node;if(!fe.ParagraphReader.Wb(P)||!P.isConnected)return{returnValue:!1,gra:D};if(v)return{returnValue:!0,gra:b};v=b.cpBegin;const ca=b.cpEnd,ta=fe.ParagraphReader.text(P);if(0<=v&&ca<=ta.length&&ta.substring(v,ca)===h)return{returnValue:!0,gra:b};const Ra=ta.indexOf(h);return 0<=Ra?(D=we.a.createTextRange(P,Ra,Ra+h.length),{returnValue:!0,gra:D}):0<=v&&ca<=ta.length&&
sl.J9b(b)?{returnValue:!0,gra:b}:{returnValue:!1,gra:D}}tHf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}L7a(b,h){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const v=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");v&&v.execute(D=>{D.logActivity(b,h)})},Lj.zDa)}SGb(b,h,v,D=!1){if(this.fKj(b,v,!h)){var P=Lj.s_c.x8b(v);P&&(this.tHf(P)?(u.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),
this.z_f(b,h,P,v,D)):(u.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Lj.tf.LQ(this.jo,2,"Size provided is not valid for OEmbed",Lj.tf.zn())))}}z_f(b,h,v,D,P){const ca=!h,ta=1===h,Ra=Lj.a1.$4b(b.node)||0,mb=Lj.a1.O_a(b.node)||0,Jb=au.a.O9e(v.Mng,!0,Ra,mb);this.wYc(b,D,h,!0);this.Djf.TCh(Jb,Ub=>{Lj.tf.X4(this.jo,4,Lj.tf.zn());Lj.tf.q7c(this.jo,this.gib(Ub.data));if(Ub=this.F_f(Ub)){u.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");
var cc=Sw.q(Ub.MediaType);Lj.tf.Vce(this.jo,7,cc);cc=b;({gra:cc}=this.tog(b,D,ta)).returnValue?(this.wYc(cc,D,h,!1),null==v.width?0<Ra&&Ub.Width>Ra&&(u.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Ub.Width=Ra):(u.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Ub.Width=this.Xbd(v.width,Ub.Width,Ra)),null==v.height?0<mb&&Ub.Height>mb&&(u.ULS.sendTraceTag(591681427,
324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Ub.Height=mb):(u.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Ub.Height=this.Xbd(v.height,Ub.Height,mb)),Lj.jna.U9a||P?this.F$b(Ub,cc,ca,ta,v,D):(this.NIb=b,this.OIb=D,this.wIc(D))):(u.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),
Lj.tf.LQ(this.jo,2,"No conversion as the context is no longer valid for the external content conversion",Lj.tf.zn()));ta&&this.VZa(cc.node)}else ta&&this.VZa(b.node),Lj.tf.LQ(this.jo,1,"URL not oEmbedable",Lj.tf.zn())},Ub=>{Lj.tf.X4(this.jo,4,Lj.tf.zn());Lj.tf.q7c(this.jo,this.gib(Ub.data));ta&&this.VZa(b.node);u.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Ub.data.ve);Lj.tf.LQ(this.jo,2,"ExternalContentEmbedRequest failed",Lj.tf.zn())},Ub=>{ta&&this.VZa(b.node);
u.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Ub)},this.jo)}Xbd(b,h,v){!b&&0<v&&h>v||b>v?(u.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=v):b>v?h=v:b&&b<v&&(h=b);return h}F$b(b,h,v,D,P,ca){this.Nl=ub.a.create();b.Width=b.Width/b.Height*(b.Height-(wz.a.pRc+wz.a.o3))+2*wz.a.o3;const ta=new eh.GraphTransaction(15);ta.Cb(h.node);ta.jk=Nc.a.QPa;const Ra=sl.J9b(h);null!=P.Aqa&&!P.Aqa||
D||Ra||(b.Title=""===P.title||P.title?P.title:b.Title,!b.Title&&""!==b.Title)||(h=this.XAf(h,ta,b.Title,ca,v));if(h){D&&(h=this.Vdf(h));var mb=sl.$Gd(h,D);if(mb){v=Sw.q(b.MediaType);var Jb=sl.WRd(b.Height,b.Width,b.Title,v);(mb=this.GAf(mb,Jb,D,{url:ca,j_a:b.IFrameHtml,Uw:b.Title,mediaType:v},b.ProviderName))?(ta.ZFa(this.Nl,1),ta.dispose(),this.NIb=h,this.OIb=ca,this.vXf(P,b,mb),this.n_f(ca,D||P.hideFloatie,Ra,v,b.Title)):ta.dispose()}else ta.dispose(),u.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),
Lj.tf.LQ(this.jo,2,"Could not create IP context on splitting the paragraph",Lj.tf.zn())}else Lj.tf.LQ(this.jo,2,"GraphNodeContext is null",Lj.tf.zn())}GAf(b,h,v,D,P){if(!b)return null;b=Lj.QO.cXd(b,h);if(!b)return u.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),Lj.tf.LQ(this.jo,2,"The anchored image could not be inserted",Lj.tf.zn()),null;b=b.node;D=sl.ZWd(b,D,P);Lj.tf.Pmg(this.jo,D.id);v||sl.Fag(b);return b}vXf(b,h,v){G.a.G7(b.thumbnailUrl)||
(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(Lj.tf.X4(this.jo,8,Lj.tf.zn()),u.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.sJd(v,h.Thumbnail,!1))}n_f(b,h,v,D,P){h||this.wIc(b);this.L7a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");sl.r9d("IsHyperlinkWithNonURLDisplayText",v,"Office.Word.Online.ExternalContent.OEmbedInsertions");sl.ariaNotify(D,P);Lj.tf.X4(this.jo,5,Lj.tf.zn())}XAf(b,h,v,
D,P){if(P){if((P=Re.a.zA(b,!1))&&1!==P.length)return h.dispose(),u.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;sl.hyperlinkEditor.HR(P[0].paragraph,P[0].hyperlink)}return this.R6f(b,v,D)}Vdf(b){const h=b.node,v=fe.ParagraphReader.text(h);return 0<v.length&&!v.trim().length?(b=we.a.createTextRange(h,0,v.length),sl.characterPropertiesEditor.replaceTextRange(b,""),we.a.Qc(h,0)):b}F_f(b){if(!({group:b}=bi.a.q1(b.data.ve)).returnValue)return null;
b=b.Responses[0];return b.StatusCode?null:b}R6f(b,h,v){const D=b.cpBegin+h.length;sl.characterPropertiesEditor.replaceTextRange(b,h);b=we.a.createTextRange(b.node,b.cpBegin,D);sl.hyperlinkEditor.kG(b,v,!1);return b}VZa(b){b.dgc=null}wYc(b,h,v,D){const P=b.cpBegin,ca=b.cpEnd;b=fe.ParagraphReader.text(b.node).trim();P||b!==h&&""!==b?P?ca===b.length?u.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Lr[v],D):0<P&&ca<b.length&&u.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Lr[v],D):u.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Lr[v],D):u.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Lr[v],D)}wIc(b){this.g5b();const h=new Gh.a(1,w.AFrameworkApplication.isRtl);h.E1c=b;Lj.Fgb.K3c(h)}g5b(){const b=new oh.a(!0);Lj.w9.XGa(b)}static get Fgb(){return null!=Lj.Dyg?Lj.Dyg:Lj.Dyg=Ea.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get jna(){Lj.sAa||(Lj.sAa=Ea.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Lj.sAa}static get w9(){return null!=Lj.TFg?Lj.TFg:Lj.TFg=Ea.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get a1(){return null!=
Lj.WGg?Lj.WGg:Lj.WGg=Ea.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get QO(){return null!=Lj.mBg?Lj.mBg:Lj.mBg=Ea.a.instance.resolve("WordEditor.IImageEditor")}static get s_c(){return null!=Lj.DEg?Lj.DEg:Lj.DEg=Ea.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}}Lj.zDa=5E3;Lj.sAa=null;Object(n.a)(Lj,"ExternalContentEditorV2",yu,[]);class rE{constructor(){this.ld=this.W=null}get name(){return"WordEditor.ExternalContent"}get Xb(){return this.ld?
this.ld:this.ld=this.W.resolve("Box4.IFeatureHelper")}xc(b){var h;this.W=b;b.ha("WordEditor.ExternalContent.ExternalContentSizeBehavior",()=>new jA.a(Xm.a.instance,Et.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").singleInstance();b.ha("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new Ks).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").singleInstance();b.ha("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new uD(b.resolve("Box4.IRoamingServiceRequestManager"),
b.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").singleInstance();w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ha("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new Lj).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance(),b.ha("WordEditor.ExternalContent.FluidComponentEditor",()=>new bu(b.resolve("Fluid.Host.LoopComponentManager"))).singleInstance(),
b.ha("WordEditor.ExternalContent.FluidComponentsActor",()=>new qE(w.AFrameworkApplication.va,b.resolve("WordEditor.ExternalContent.FluidComponentEditor"),qi.a.instance)).singleInstance(),(null===(h=w.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsHomeTUIEnabled",!1))&&$m.Lsj($m.F9m)):b.ha("WordEditor.ExternalContent.ExternalContentEditor",()=>new dh).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance()}init(){this.Xb.Pp.continueWith(()=>
{this.hn()});w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&this.W.resolve("WordEditor.ExternalContent.FluidComponentsActor").Tb()}dispose(){}ual(){const b=new By;this.cWh()&&b.iph(Kx.O7());b.iph(new Nq);return b}hn(){null==w.AFrameworkApplication.K||w.AFrameworkApplication.K.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.W.ha("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new HD.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").singleInstance();
this.cWh()&&(this.W.ha("WordEditor.ExternalContent.IWordExternalContentURLResolver",()=>this.ual()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").singleInstance(),this.W.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}cWh(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",!1)}static main(){N.a.instance.Fc(new rE)}}Object(n.a)(rE,"ExternalContentPackage",null,[1,2]);var wB;
(function(b){b[b.invalid=-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.decimal=6]="decimal";b[b.dep=7]="bar";b[b.ARa=8]="num"})(wB||(wB={}));Object(n.b)("TabStopValues",wB);class Bp{}Bp.ZPh=8;Bp.tjl=1;Bp.h8="wwaengidc";Bp.kpiName="WordRuler";Bp.precision=.0625;Bp.WHo=1;Bp.M1o="ShowHideRuler";Object(n.a)(Bp,"Constants",null,[]);var ID=c(752);class Zs{static P8b(b,h){if(!Zs.UVc)return null;switch(b){case "Left":return v=>
{const D=v.rulerCanvasProps;v=v.indents;return{YIb:0,FNb:D.scale-(D.margins[1].value+v[2].value+Math.max(v[0].value,v[1].value)+8*D.precision)}};case "Right":return v=>{const D=v.rulerCanvasProps;v=v.indents;return{YIb:0,FNb:D.scale-(v[2].value+(D.margins[0].value+Math.max(v[0].value,v[1].value))+8*D.precision)}};case "MoveTableColumn":return()=>{let v=0,D=0;if(0===h){var P={};32===Zs.pc.Qb(Gb.a.Xgc,2,P)&&(v=Df.a.Nz(P.MinIndent),D=Df.a.Nz(P.MaxIndent))}else P={vo:h-1},32===Zs.pc.Qb(Gb.a.Wgc,2,P)&&
(v=Df.a.Nz(P.MinResize),D=Df.a.Nz(P.MaxResize));return{YIb:v,FNb:D}};case "Top":return v=>{v=v.rulerCanvasProps;return{YIb:0,FNb:v.scale-(v.margins[1].value+8*v.precision)}};case "Bottom":return v=>{v=v.rulerCanvasProps;return{YIb:0,FNb:v.scale-(v.margins[0].value+8*v.precision)}}}return null}static jSd(b){if(!Zs.UVc)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return h=>{var v=h.rulerCanvasProps,D=h.indents,P=h.ipContextIndex;h=v.margins;var ca=v.scale;v=v.precision;
if("MoveTableColumn"!==h[0].type){P=h[0].value;h=h[1].value+D[2].value;var ta=P;"LeftIndent"===b&&(ta+=Math.max(D[0].value,D[1].value));D=-1*P;v=ca-(ta+h+8*v)}else{ca=0;for(ta=0;ta<=P;ta++)ca+=h[ta].value;ta=0;if("LeftIndent"===b){ta=D[0].value;const Ra=D[1].value;ca+=Math.max(ta,Ra);ta=Math.max(ta,Ra)}h=h[P+1].value;ta+=D[2].value;D=-1*ca;v=h-ta-v}return{YIb:D,FNb:v}};case "RightIndent":return h=>{var v=h.rulerCanvasProps,D=h.indents,P=h.ipContextIndex,ca=v.margins;h=v.scale;v=v.precision;if("MoveTableColumn"!==
ca[0].type){var ta=ca[0].value;ca=ca[1].value;P=D[0].value;var Ra=D[1].value;D=-1*ca;h-=ta+ca+Math.max(P,Ra)+8*v}else{ta=0;for(Ra=0;Ra<=P;Ra++)ta+=ca[Ra].value;ca=ca[P+1].value;P=D[0].value;Ra=D[1].value;D=-1*(h-ta-ca);h=ca-Math.max(P,Ra)-v}return{YIb:D,FNb:h}}}return null}static Mbm(){return b=>{var h=b.rulerCanvasProps,v=b.indents,D=b.ipContextIndex,P=h.margins;b=h.precision;h=h.scale;"MoveTableColumn"!==P[0].type?(D=P[0].value,P=P[1].value+v[2].value,v=Math.min(v[0].value,v[1].value)+b,b=h-(D+
P+b)):(h=v[2].value,P=P[D+1].value,v=Math.min(v[0].value,v[1].value)+b,b=P-(h+b));return{YIb:v,FNb:b}}}static get pc(){return null!=Zs.lwg?Zs.lwg:Zs.lwg=w.AFrameworkApplication.va}static get UVc(){null==this.Uab&&(w.AFrameworkApplication.Kha("WoRul910;WoRul910cf"),this.Uab=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):!1);return this.Uab}}Zs.Uab=null;Object(n.a)(Zs,"RulerPropertyBoundaryHelper",null,[]);var ZC=
c(922),cu=c(1481),JD=c(1052),WF=c(1239),XF=c(1240);class Cy{constructor(b,h,v,D,P,ca){this.Syn="OutlineContainer";this.nok="UpdateCustomTabFailed";this.bxb="ReadRulerPropertiesFailed";this.rok="UpdateIndentFailed";this.qkh="UpdateMarginFailed";this.l8d=ta=>{ta.button===Sys.UI.MouseButton.rightButton&&this.cRe.show(new Sys.UI.Point(ta.clientX,ta.clientY),2)};this.THj=()=>{this.nUa()};this.Vm=b;this.CXb=h;this.ga=v;this.cRe=D;this.Wy=P;this.HS=ca;this.LUb=null;this.Lw=!!w.AFrameworkApplication.ta&&
w.AFrameworkApplication.ta.Nb.yJ;this.uWi=this.W7d.bind(this);this.dZi=this.Zs.bind(this);this.SHj=this.nUa.bind(this)}UB(){this.c_e();this.nph();this.CXb.zl.Ze(10).Go(this.uWi);Le.a.addHandler(this.IXe,Ed.a.scroll,this.THj);this.Vm.execute(h=>{h.M0(this.dZi)});const b=[this.Psf(),document.getElementById(xk.AppFrame.gcd),document.getElementById("PageContentContainer")];this.LUb?this.LUb.register(b,this.SHj):JD.a(cu.a.appChromeLazyReady,()=>{appChrome.getResizeObserver().then(h=>{this.LUb=h.createResizeObserver();
this.LUb.register(b,this.SHj);return null})});Xa.App.xa.GI.registerBoundingWindowRectsChanged("documentPanel",(h,v)=>{"undefined"!==v&&this.d8a([1,0])})}Psf(){return 1===this.HS.fu?this.mfk:this.Lek}get IXe(){return document.getElementById(xk.AppFrame.BUa)}get Lek(){const b=document.getElementsByClassName(this.Syn);return b&&0<b.length?b[0]:null}get mfk(){var b=this.Wy.K6b;if(!b)return null;b=this.Lco(fe.ParagraphReader.TQ(b));return ZC.a.Ddi(b)}Lco(b){return 0<b?document.querySelector("div.PagesContainer p[paraid='"+
b+"']"):null}get zN(){return this.Vm&&this.Vm.instance?this.Vm.instance.jj:Bp.tjl}i8b(){const b={};return 32!==this.ga.Qb(Gb.a.SGa,2,b)?(u.ULS.sendTraceTag(529065947,WF.a.msoulscat_Wac_WordRuler,XF.a.warning,"Unable to read page properties for Ruler"),xl.recordQosError(this.bxb,[xl.Yea],"Unable to read page properties for Ruler"),null):b}dispose(){this.doi();this.CXb.zl.Ze(10).TU(this.uWi);Le.a.removeHandler(this.IXe,Ed.a.scroll,this.THj);this.Vm.execute(b=>{b.Q5a(this.dZi)});this.LUb&&this.LUb.dispose();
Xa.App.xa.GI.unregisterBoundingWindowRectsChanged("documentPanel",(b,h)=>{"undefined"!==h&&this.d8a([1,0])})}get Jzi(){null==Cy.qGe&&(Cy.qGe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&w.AFrameworkApplication.K.$("RulerThemingIsEnabled"):!1);return Cy.qGe}}Cy.qGe=null;Object(n.a)(Cy,"ARuler",null,[395]);var aF=c(289);class vt extends Cy{constructor(b,h,v,
D,P,ca,ta){super(b,h,v,P,ca,ta);this.aP="HorizontalRuler";this.eOj="CustomTabModificationFromRuler";this.HPj="IndentModificationFromRuler";this.Sqe="MarginModificationFromRuler";this.SYg=this.RYg=this._tabStops=null;this.Znn=(Ra,mb,Jb)=>{if(!(Ra>=this._tabStops.length)){Ra=this._tabStops[Ra];var Ub="Modify"===Jb?this.ga.Qb(Nc.a.gec,2,{["tabStop"]:Ra,["value"]:Df.a.Kv(mb)}):this.ga.Qb(Nc.a.K5a,2,Ra);if(32===Ub){mb=1;var cc=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",
Jb,wB[Ra.Ada]);u.ULS.sendTraceTag(591213271,3014,50,cc)}else mb=0,cc=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",Jb,wB[Ra.Ada]),u.ULS.sendTraceTag(591213272,3014,15,cc),xl.recordQosError(this.nok,[xl.Yea],"Unable to modify custom tab using ruler");Xe.a(this.eOj,32===Ub,void 0,[Object.assign(new na.a,{name:"Operation",string:Jb}),Object.assign(new na.a,{name:"TabType",int64:wB[Ra.Ada]})]);Jb=new Map;Jb.set("Command","OnCustomTabChange");Jb.set("Source",this.aP);
Jb.set("Response",cc);va.Health.instance.recordKpiUsage(Bp.kpiName,mb,Bp.h8,Jb)}};this.rqn=(Ra,mb)=>{var Jb=new ID.a;Jb.unit=1;Jb.value=Df.a.Kv(mb);mb=8;switch(Ra){case "FirstLineIndent":mb=this.ga.Qb(Gb.a.J7c,2,Jb);break;case "HangingIndent":mb=this.ga.Qb(Gb.a.K7c,2,Jb);break;case "LeftIndent":mb=this.ga.Qb(Gb.a.j2a,2,Jb);break;case "RightIndent":mb=this.ga.Qb(Gb.a.i2a,2,Jb)}let Ub;32===mb?(Jb=1,Ub=String.format("Indents set using Ruler. Indent: {0}",Ra),u.ULS.sendTraceTag(592517017,3014,50,Ub)):
(Jb=0,Ub=String.format("Unable to set indent using Ruler. Indent: {0}",Ra),u.ULS.sendTraceTag(592496523,3014,15,Ub,Ra),xl.recordQosError(this.rok,[xl.Yea],"Unable to set indent using Ruler."));Xe.a(this.HPj,32===mb,void 0,[Object.assign(new na.a,{name:"Type",string:Ra})]);Ra=new Map;Ra.set("Command","OnIndentChange");Ra.set("Source",this.aP);Ra.set("Response",Ub);va.Health.instance.recordKpiUsage(Bp.kpiName,Jb,Bp.h8,Ra)};this.$Uf=(Ra,mb,Jb)=>{let Ub;Ub="Left"===Ra?this.ga.Qb(Gb.a.Via,2,Df.a.Kv(mb)):
"Right"===Ra?this.ga.Qb(Gb.a.E6a,2,Df.a.Kv(mb)):Jb?this.ga.Qb(Gb.a.nle,2,{["columnIndex"]:Jb-1,["width"]:Df.a.Kv(mb)}):this.ga.Qb(Gb.a.yjc,2,Df.a.Kv(mb));32===Ub?(mb=1,Jb=String.format("Margins set using Ruler. Margin: {0}",Ra),u.ULS.sendTraceTag(592517018,3014,50,Jb)):(mb=0,Jb=String.format("Unable to set margins using Ruler. Margin: {0}",Ra),u.ULS.sendTraceTag(592496524,3014,15,Jb),xl.recordQosError(this.qkh,[xl.Yea],"Unable to set margins using Ruler."));Xe.a(this.Sqe,32===Ub,void 0,[Object.assign(new na.a,
{name:"Type",string:Ra})]);Ra=new Map;Ra.set("Command","OnMarginChange");Ra.set("Source",this.aP);Ra.set("Response",Jb);va.Health.instance.recordKpiUsage(Bp.kpiName,mb,Bp.h8,Ra)};this.gMa=D;this.nr={}}get gU(){return this.RYg}get PEa(){return this.SYg}renderRuler(){this.gU.classList.remove("HideWACHorizontalRulerContainer");this.gU.classList.add("ShowWACHorizontalRulerContainer");var b=this.i8b();if(b){var h=this.$Uf,v=this.rqn,D=this.Znn,P=this.Bad(),ca=this.vCj(),ta=this.uCj();P&&ca&&ta||(this.nr.disabled=
!0);this.nr.onIndentChange=v;this.nr.onMarginChange=h;this.nr.onTabChange=D;this.nUa();b=Ef.a.Ji(b.Ao,0);this.PEa.style.width=(b*this.zN).toString()+"px";return this.gMa().then(Ra=>{Ra.renderRuler(this.PEa,this.nr)})}}uCj(){const b=[];var h={};if(32!==this.ga.Qb(Nc.a.nMb,2,h))return u.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),xl.recordQosError(this.bxb,[xl.Yea],"Unable to read paragraph tabs for Ruler"),!1;var v=h.customTabs;if(!v||0>=v.length)return this.nr.tabs=
b,!0;this._tabStops=v;h="";for(const D of v){switch(D.Ada){case 1:h="LeftTab";break;case 4:h="RightTab";break;case 3:h="CenterTab";break;case 6:h="DecimalTab";break;case 7:h="BarTab"}v=Ef.a.g5a(D.aIa,0);b.push({["type"]:h,["value"]:v,["getRulerPropertyBoundary"]:Zs.Mbm()})}this.nr.tabs=b;return!0}d8a(b){var h;if(this.gU){this.gU.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.nr&&delete this.nr.disabled;for(const v of b)switch(v){case 0:b=this.vCj();const D=this.uCj();b&&D||(this.nr.disabled=
!0);break;case 1:this.Bad()||(this.nr.disabled=!0)}if(null===(h=this.Wy.kb)||void 0===h?0:h.sUc)this.nr.disabled=!0;this.gMa().then(v=>{v.renderRuler(this.PEa,this.nr);return null})}}Bad(){const b={};var h=this.i8b();if(!h)return!1;b.scale=Df.a.Nz(h.Ao);b.precision=Bp.precision;b.rulerType="Horizontal";if(!this.mxn())return this.nr.ipContextIndex=0,this.nr.permittedUnits=Bp.ZPh,h=[{["type"]:"Left",["value"]:Df.a.Nz(h.marginLeft),["getRulerPropertyBoundary"]:Zs.P8b("Left",0)},{["type"]:"Right",["value"]:Df.a.Nz(h.marginRight),
["getRulerPropertyBoundary"]:Zs.P8b("Right",1)}],b.margins=h,this.nr.rulerCanvasProps=b,!0;var v={};h={};var D=this.ga.Qb(Gb.a.v3c,2,v);const P=this.ga.Qb(Gb.a.AMb,2,h);if(32!==D||32!==P)return u.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),xl.recordQosError(this.bxb,[xl.Yea],"Unable to read table properties for Ruler"),!1;v=v.ColumnWidths;D=h.TablePosition;if(!D||!v||0>=v.length)return u.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),
xl.recordQosError(this.bxb,[xl.Yea],"Cannot show table properties on the ruler as they are null"),!1;h=Array(v.length+1);h[0]={["type"]:"MoveTableColumn",["value"]:Df.a.Nz(D.x/this.zN),["getRulerPropertyBoundary"]:Zs.P8b("MoveTableColumn",0)};for(D=0;D<v.length;D+=1)h[D+1]={["type"]:"MoveTableColumn",["value"]:Df.a.Nz(v[D]),["getRulerPropertyBoundary"]:Zs.P8b("MoveTableColumn",D+1)};this.nr.ipContextIndex=this.Afm();this.nr.permittedUnits=Bp.WHo;b.margins=h;this.nr.rulerCanvasProps=b;return!0}vCj(){var b=
{};if(32!==this.ga.Qb(Gb.a.w5a,2,b))return u.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),xl.recordQosError(this.bxb,[xl.Yea],"Unable to read paragraph indentation for Ruler"),!1;const h={type:"FirstLineIndent"};h.getRulerPropertyBoundary=Zs.jSd("FirstLineIndent");const v={type:"HangingIndent"};v.getRulerPropertyBoundary=Zs.jSd("HangingIndent");const D={type:"RightIndent"};D.getRulerPropertyBoundary=Zs.jSd("RightIndent");const P={type:"LeftIndent"};P.getRulerPropertyBoundary=
Zs.jSd("LeftIndent");this.nr.rtl=b.isRtl;b=b.Ft;h.value=1===b.specialIndentType?Df.a.Nz(b.vda+b.AB):2===b.specialIndentType?Df.a.Nz(b.AB-b.vda):Df.a.Nz(b.AB);v.value=Df.a.Nz(b.AB);P.value=Df.a.Nz(b.AB);D.value=Df.a.Nz(b.joa);this.nr.indents=[h,v,D,P];return!0}nph(){Le.a.addHandler(this.gU,Ed.a.Ox,this.l8d)}doi(){this.gU&&(this.gU.classList.remove("ShowWACHorizontalRulerContainer"),this.gU.classList.add("HideWACHorizontalRulerContainer"),Le.a.removeHandler(this.gU,Ed.a.Ox,this.l8d));this.gMa().then(b=>
{b.dispose(this.PEa);return null})}Zs(){this.VHj();this.nUa();this.d8a([1,0])}W7d(b,h){b=h.property;if(b===Bc.a.Ao||b===Bc.a.marginLeft||b===Bc.a.marginRight)this.VHj(),this.nUa(),this.d8a([1])}VHj(){var b=this.i8b();b&&(b=Ef.a.Ji(b.Ao,0),this.PEa.style.width=Math.round(b*this.zN).toString()+"px")}nUa(){window.requestAnimationFrame(()=>{var b=this.Psf();b&&(b=Dd.a.getElementBounds(b),w.AFrameworkApplication.isRtl?this.PEa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+
"px":this.PEa.style.marginLeft=b.x.toString()+"px")})}Afm(){const b=he.GraphIterator.$a(this.Wy.K6b);if(b.zb(14))return b.jd(16),Dt.a(b,!0);u.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");xl.recordQosError(this.bxb,[xl.Yea],"Unable to read table column index for Ruler");return 0}mxn(){let b=!0;const h=this.Wy.kb.nO();if(null===h)return u.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),xl.recordQosError(this.bxb,[xl.Yea],"Unable to get Context Iterator for the Ruler"),
!1;for(;h.moveNext()&&b;){const v=he.GraphIterator.$a(h.current.node);v.vd();b=b&&cj.TableReader.ex(v)}return b}c_e(){if(!this.PEa&&!this.gU){this.RYg=document.createElement("div");this.gU.id=vt.z6j;this.gU.className=vt.y6j;this.gU.setAttribute(cf.a.yfa,WordEditorIntl.WordEditorStrings.L_Ruler);this.gU.setAttribute(cf.a.qh,cf.a.tvh);this.gU.classList.add("HideWACHorizontalRulerContainer");if(this.Jzi){var b=w.AFrameworkApplication.K.jb("ModernUxExperimentPreferenceCookieName");const h=w.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");
$b.a.Dba(b,!h)&&this.gU.classList.add(vt.Vbk)}this.SYg=document.createElement("div");this.PEa.className=vt.x6j;this.PEa.id=vt.A6j;this.gU.appendChild(this.PEa);b=null;this.Lw&&((b=Object(aF.a)("EditorBars"))&&b.appendChild(this.gU),this.gU.classList.add("regionComposer"));b||(b=document.getElementById(xk.AppFrame.gcd),b.insertBefore(this.gU,b.firstChild))}}static ZE(){return new vt(Ea.a.instance.Sa("Common.IZoomManager"),Xa.App.Xj,w.AFrameworkApplication.va,el.UISurfaces.igi,Ea.a.instance.resolve("WordEditor.IRulerContextMenu"),
Jr.a.instance,Ea.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=vt.HCg?vt.HCg:vt.HCg=vt.ZE()}}vt.z6j="WACHorizontalRulerContainer";vt.y6j="WACHorizontalRulerContainer";vt.A6j="WACHorizontalRuler";vt.x6j="WACHorizontalRuler";vt.Vbk="ModernUxWACHorizontalRulerContainer";Object(n.a)(vt,"HorizontalRuler",Cy,[]);var sE=c(948);class du extends Cy{constructor(b,h,v,D,P,ca,ta){super(b,h,v,P,ca,ta);this.aP="VerticalRuler";this.Sqe="MarginModificationFromRuler";this.glh=
this.flh=null;this.$Uf=(Ra,mb)=>{let Jb=8;"Top"===Ra?Jb=this.ga.Qb(Gb.a.F6a,2,Df.a.Kv(mb)):"Bottom"===Ra&&(Jb=this.ga.Qb(Gb.a.D6a,2,Df.a.Kv(mb)));let Ub;32===Jb?(mb=1,Ub=String.format("Margins set using Ruler. Margin: {0}",Ra),u.ULS.sendTraceTag(529065945,3014,50,Ub)):(mb=0,Ub=String.format("Unable to set margins using Ruler. Margin: {0}",Ra),u.ULS.sendTraceTag(529065946,3014,15,Ub),xl.recordQosError(this.qkh,[xl.Yea],"Unable to set margins using Ruler."));Xe.a(this.Sqe,32===Jb,void 0,[Object.assign(new na.a,
{name:"Type",string:Ra})]);Ra=new Map;Ra.set("Command","OnMarginChange");Ra.set("Source",this.aP);Ra.set("Response",Ub);va.Health.instance.recordKpiUsage(Bp.kpiName,mb,Bp.h8,Ra)};this.gMa=D;this.nr={}}get E1(){return this.flh}get VIa(){return this.glh}renderRuler(){this.E1.classList.remove("HideWACVerticalRulerContainer");this.E1.classList.add("ShowWACVerticalRulerContainer");var b=this.i8b();if(b){var h=this.$Uf;this.Bad()||(this.nr.disabled=!0);this.nr.onMarginChange=h;this.nUa();b=Ef.a.Ji(b.qv,
1);this.VIa.style.height=(b*this.zN).toString()+"px";this.gMa().then(v=>{v.renderRuler(this.VIa,this.nr);return null})}}d8a(b){var h;if(this.E1){this.E1.classList.add("ShowWACVerticalRulerContainer");"disabled"in this.nr&&delete this.nr.disabled;for(const v of b)switch(v){case 1:this.Bad()?this.nUa():this.nr.disabled=!0}if(null===(h=this.Wy.kb)||void 0===h?0:h.sUc)this.nr.disabled=!0;this.gMa().then(v=>{v.renderRuler(this.VIa,this.nr);return null})}}Bad(){const b={},h=this.i8b();if(!h)return!1;b.scale=
Df.a.Nz(h.qv);b.precision=Bp.precision;b.rulerType="Vertical";this.nr.ipContextIndex=0;this.nr.permittedUnits=Bp.ZPh;b.margins=[{["type"]:"Top",["value"]:Df.a.Nz(h.marginTop),["getRulerPropertyBoundary"]:Zs.P8b("Top",0)},{["type"]:"Bottom",["value"]:Df.a.Nz(h.marginBottom),["getRulerPropertyBoundary"]:Zs.P8b("Bottom",1)}];this.nr.rulerCanvasProps=b;return!0}nph(){this.c_e();Le.a.addHandler(this.E1,Ed.a.Ox,this.l8d)}doi(){this.E1&&(this.E1.classList.remove("ShowWACVerticalRulerContainer"),this.E1.classList.add("HideWACVerticalRulerContainer"),
Le.a.removeHandler(this.E1,Ed.a.Ox,this.l8d));this.gMa().then(b=>{b.dispose(this.VIa);return null})}Zs(){this.RHj();this.nUa();this.d8a([1])}W7d(b,h){b=h.property;if(b===Bc.a.qv||b===Bc.a.marginTop||b===Bc.a.marginBottom)this.RHj(),this.nUa(),this.d8a([1])}RHj(){var b=this.i8b();b&&(b=Ef.a.Ji(b.qv,1),this.VIa.style.height=Math.round(b*this.zN).toString()+"px")}nUa(){window.requestAnimationFrame(()=>{var b=this.Psf();if(b){const h=Dd.a.getElementBounds(b);this.VIa.style.height=h.height.toString()+
"px";b=this.ohm(b);this.VIa.style.marginTop=b+"px"}})}ohm(b){b=b.getBoundingClientRect().y;const h=this.IXe.getBoundingClientRect().y;return b-h}c_e(){if(!this.VIa&&!this.E1){this.flh=document.createElement("div");this.E1.id=du.epk;this.E1.className=du.dpk;this.E1.setAttribute(cf.a.yfa,WordEditorIntl.WordEditorStrings.L_Ruler);this.E1.setAttribute(cf.a.qh,cf.a.tvh);this.E1.classList.add("HideWACVerticalRulerContainer");if(this.Jzi){var b=w.AFrameworkApplication.K.jb("ModernUxExperimentPreferenceCookieName");
const h=w.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");$b.a.Dba(b,!h)&&Sys.UI.DomElement.addCssClass(this.E1,du.Wbk)}this.glh=document.createElement("div");this.VIa.className=du.cpk;this.VIa.id=du.fpk;this.E1.appendChild(this.VIa);b=document.getElementById(xk.AppFrame.gcd);b.insertBefore(this.E1,b.firstChild)}}static ZE(){return new du(Ea.a.instance.Sa("Common.IZoomManager"),Xa.App.Xj,w.AFrameworkApplication.va,el.UISurfaces.igi,Ea.a.instance.resolve("WordEditor.IRulerContextMenu"),
Jr.a.instance,Ea.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=du.GCg?du.GCg:du.GCg=du.ZE()}}du.epk="WACVerticalRulerContainer";du.dpk="WACVerticalRulerContainer";du.fpk="WACVerticalRuler";du.cpk="WACVerticalRuler";du.Wbk="ModernUxWACVerticalRulerContainer";Object(n.a)(du,"VerticalRuler",Cy,[]);class xl{constructor(b,h,v,D,P,ca,ta,Ra,mb){this.wDe=this.UFe=!1;this.aP="RulerActor";this.neh=null;this.Koa=!1;this.FZj="ClearAllTabStopsFailed";this.zgh="ShowHideRulerFailed";
this.EHe=null;this.QDd=(Jb,Ub,cc)=>{if(1===cc)return 32;Jb=this.ga.processAction(Nc.a.ZMb,2,null);32===Jb?(cc=1,Ub=String.format("Clear all tab stops from ruler"),u.ULS.sendTraceTag(591213266,3014,50,Ub)):(cc=0,Ub=String.format("Unable to clear all tab stop from ruler"),u.ULS.sendTraceTag(591213267,3014,15,Ub),xl.recordQosError(this.FZj,[xl.Yea],Ub));const Ac=new Map;Ac.set("Command","ClearAllTabStops");Ac.set("Source",this.aP);Ac.set("Response",Ub);va.Health.instance.recordKpiUsage(Bp.kpiName,cc,
Bp.h8,Ac);return Jb};this.WSc=(Jb,Ub,cc)=>{if(1===cc)switch(Jb){case Nc.a.x3e:case Nc.a.rdf:return 2;default:return 32}Ub=this.cRe.xam();switch(Jb){case Nc.a.zJf:var Ac=1;break;case Nc.a.L8f:Ac=4;break;case Nc.a.R6e:Ac=3;break;default:return u.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}Jb=new Tt.a(Ub,Ac,0,1);Jb=this.ga.Qb(Nc.a.i7c,2,Jb);32===Jb?(cc=1,Ub=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",wB[Ac],Ub.toString()),u.ULS.sendTraceTag(591213269,
3014,50,Ub)):(cc=0,Ub=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",wB[Ac],Ub.toString()),u.ULS.sendTraceTag(591213270,3014,15,Ub));Ac=new Map;Ac.set("Command","InsertCustomTabStopRuler");Ac.set("Source",this.aP);Ac.set("Response",Ub);va.Health.instance.recordKpiUsage(Bp.kpiName,cc,Bp.h8,Ac);return Jb};this.nPb=(Jb,Ub,cc,Ac,Lc)=>this.UFe||1===cc&&Ni.a.rha(Ub.gk)?8:this.Koa?this.tRc(Jb,Ub,cc,Ac,Lc):this.Fyo(Ub,cc);this.P$n=()=>{this.Koa?u.ULS.sendTraceTag(574128526,
3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),32!==this.ga.processAction(Gb.a.nPb,2)?(u.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),xl.recordQosError(this.zgh,[xl.Yea],"Ruler could not be enabled")):u.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.tRc=(Jb,Ub,cc)=>{if(1===cc||!this.Koa)return 32;this.Koa=!1;this.dRe.ghj(!1);this.qab.dispose();this.y0d()&&this.Tff();this.UHj();u.ULS.sendTraceTag(593351623,
3014,50,"Ruler is disabled");Jb=new Map;Jb.set("Command","HideRuler");Jb.set("Source",this.aP);Jb.set("Response","");va.Health.instance.recordKpiUsage(Bp.kpiName,1,Bp.h8,Jb);return 32};this.Tbe=(Jb,Ub,cc,Ac,Lc)=>{if(1===cc)return 32;Lc&&(Lc[If.a.On]=this.Koa);return 32};this.Cym=Jb=>{this.Koa=Jb.result};this.fGb=()=>{this.UFe=!1};this.Tni=()=>{this.UFe=!0};this.ga=b;this.qab=h;this.vXe=v;this.uSb=D;this.cRe=P;this.dRe=ca;xl.Sk=Ra;this.JKa=ta;this.HS=mb;this.JKa.Qqh(this.Tni);this.JKa.Uzd(this.fGb)}initialize(){this.Tb();
this.neh=this.P$n;window.addEventListener("TurnRulerOnAction",this.neh,!0);return this.dRe.Lbm().continueWith(this.Cym,8)}Tb(){this.ga.qa(Gb.a.nPb,sc.a.view,this.nPb);this.ga.eb(Gb.a.Tbe,sc.a.view,this.Tbe,96);this.ga.qa(Nc.a.x3e,sc.a.view,this.WSc);this.ga.qa(Nc.a.R6e,sc.a.view,this.WSc);this.ga.qa(Nc.a.QDd,sc.a.view,this.QDd);this.ga.qa(Nc.a.rdf,sc.a.view,this.WSc);this.ga.qa(Nc.a.tRc,sc.a.view,this.tRc);this.ga.qa(Nc.a.zJf,sc.a.view,this.WSc);this.ga.qa(Nc.a.L8f,sc.a.view,this.WSc);sE.a.hd.addHandler(sE.a.O7d,
this.z0c.bind(this));this.HS.tzb(this.MWf)}Cri(){this.Koa&&(this.qab.UB(),this.qab.renderRuler(),this.y0d()&&this.Dcj())}Dcj(){this.vXe.UB();this.vXe.renderRuler()}Tff(){this.vXe.dispose()}y0d(){return this.fEi()&&this.isPaginatedView()}fEi(){null==this.EHe&&null!=w.AFrameworkApplication.K&&(this.EHe=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",!1));return this.EHe}gUa(){this.Koa||Ea.a.instance.Sa("Common.ISystemInitiatedFeedback").execute(b=>
{b.logActivity("TurnRulerOnActivity",null)})}$W(){this.JKa.w2n(this.Tni);this.JKa.Ebj(this.fGb);this.Koa&&(this.qab.dispose(),this.y0d()&&this.Tff())}UHj(){if(this.uSb){const b={};b[Bp.M1o]="ToggleButtonModel";this.uSb.WG(b)}}Fyo(b,h){if(!xl.Sk.v8(b.gk))return u.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),xl.recordQosError(this.zgh,[xl.Yea],"Cannot show ruler. Word Section Node not found."),8;if(1===h)return 32;this.Koa=!0;this.dRe.ghj(!0);this.Cri();this.UHj();
u.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;b.set("Command","ShowRuler");b.set("Source",this.aP);b.set("Response","");va.Health.instance.recordKpiUsage(Bp.kpiName,1,Bp.h8,b);return 32}isPaginatedView(){return 1===this.HS.fu}z0c(b,h){switch(h.documentMode){case "View":this.Koa&&(this.ga.processAction(Gb.a.nPb,2),this.wDe=!0);break;case "Edit":this.wDe&&(this.ga.processAction(Gb.a.nPb,2),this.wDe=!1)}}MWf(b,h){if(xl.instance.Koa&&xl.instance.fEi())switch(h.Nlb){case 1:xl.instance.Dcj();
break;case 0:xl.instance.Tff()}}static recordQosError(b,h,v){const D=Object.assign(new Bb.a,{extendedProperties:new Map});v&&D.extendedProperties.set("exception",v);va.Health.instance.recordQosError(b,h,!1,!0,!1,!1,D)}static ZE(){return new xl(w.AFrameworkApplication.va,vt.instance,du.instance,Xa.App.xa,Ea.a.instance.resolve("WordEditor.IRulerContextMenu"),Ea.a.instance.Na("WordEditor.Ruler.IRulerSettingInfo"),Ea.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Xm.a.instance,
Ea.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=xl.JBg?xl.JBg:xl.JBg=xl.ZE()}}xl.Sk=null;xl.Yea="RulerInteractionFailed";Object(n.a)(xl,"RulerActor",null,[]);class lA{constructor(b,h){this.yAc=null;this.P4a=v=>v.result?v.result.Value.toString():"";this.sGa=v=>{v.yo||v.Ai?(u.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.yAc=!1):(v=v.result,""===v&&w.AFrameworkApplication.K&&(v=w.AFrameworkApplication.K.jb("RulerDefaultOn")),
this.yAc="true"===v.toLowerCase(),u.ULS.sendTraceTag(591541279,3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully."));return this.yAc};this.Cv=b;this.AK=h}Lbm(){const b=new th.a;if(null==this.yAc){if(this.MBi())return this.AK.H5a(Zm.a.j6c).CWRCo(this.P4a,0).CWRCo(this.sGa,8);b.Bg(!1)}else b.Bg(this.yAc);return b.task}w1(b){this.AK.w1(Zm.a.j6c,new tD.a(Zm.a.j6c,b))}ghj(b){this.MBi()&&(this.Cv.bja("saveRulerIsEnabled",b.toString()),u.ULS.sendTraceTag(591541276,
3014,50,"Try to save ruler settings value to Roaming Service."));this.w1(b)}MBi(){const b=w.AFrameworkApplication.K.$("IsAnonymousUser");if(w.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)u.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}}Object(n.a)(lA,"RulerSettingInfo",null,[483]);class vv{constructor(){this.l_g=this.W=null}get name(){return"WordEditor.Ruler"}xc(b){this.W=b;u.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.W.ha("WordEditor.Ruler.RulerSettingInfo",
()=>new lA(this.W.resolve("Box4.IRoamingServiceRequestManager"),this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").singleInstance();this.W.resolve("Box4.IFeatureHelper").Pp.continueWith(()=>{this.hn()});this.l_g=xl.instance.initialize();u.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}hn(){this.l_g.continueWith(()=>{xl.instance.Cri();xl.instance.gUa()});u.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){xl.instance.$W();
u.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}Object(n.a)(vv,"PackageManager",null,[1,2]);class xB{constructor(){this.s$b=this.d1b=null}}Object(n.a)(xB,"CreatePickerCustomizationDictionaryOptions",null,[913]);class $C{}$C.Yg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(n.a)($C,"InsertMediaM365DialogHtml",
null,[]);class Tw{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id,vd,xe){this.B3=xe;this.X9a=null;this.uDf=this.wnd=!1;this.Rsj=Ld=>{if(Ld.rawEvent&&(Ld=Ld.rawEvent.data))try{const Qd=Sys.Serialization.JavaScriptSerializer.deserialize(Ld,!0),Zd=Qd.MessageId?Qd.MessageId.toString():null;Qd&&Zd&&(Zd===L.a.insertImage||Zd===L.a.CAf)&&this.uyc.start(Zd===L.a.insertImage?this.Gab:this.w_g)}catch(Qd){}};this.kWo=(Ld,Qd,Zd,te,Qf)=>{if(1===Zd)return 32;this.e2g?Ld=CommonUIStrings.l_OneDriveName:""!==
this.Lkd?Ld=this.Lkd:(Ld=CommonUIStrings.l_HostGeneric,u.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));Qf[Hl.a.LabelText]=Ld;return 32};this.nWo=(Ld,Qd,Zd,te,Qf)=>{if(1===Zd)return 32;if(!w.AFrameworkApplication.hEf())return Qf[Hl.a.Visible]=!1,32;this.e2g?Ld=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.Lkd?Ld=String.format(CommonUIStrings.l_ChangePictureFromHost,this.Lkd):
(Ld=CommonUIStrings.l_ChangePictureFromHostGeneric,u.ULS.sendTraceTag(577835747,352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));Qf[Hl.a.LabelText]=Ld;return 32};this.lWo=(Ld,Qd,Zd,te,Qf)=>{if(1===Zd)return 32;w.AFrameworkApplication.K.$("InsertOnlinePictureEnabled")||(Qf[Hl.a.Visible]=!1);return 32};this.mWo=(Ld,Qd,Zd,te,Qf)=>{if(1===Zd)return 32;w.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled")||(Qf[Hl.a.Visible]=
!1);return 32};this.eje=(Ld,Qd,Zd)=>{var te;Qd=this.Ouc.value.Jfa(Qd);if(1===Zd)return Qd&&this.Fab.uNm?32:8;if(2!==Zd||!Qd)return 8;(null===(te=w.AFrameworkApplication.K)||void 0===te?0:te.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&yo.a.instance.M5a("PictureBing");this.X9a=ub.a.create();u.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");Ld=this.K0l(Ld,this.X9a);Ld=this.mZe(Ld);Ld=this.Hld.QOc(Ld);Ld.correlationId=
this.X9a;Ld.SAf=this.x_g;Ld.lpa=1;return this.cje(Ld,CommonUIStrings.L_PictureInsertTitle,this.Gab)};this.Kxo=(Ld,Qd,Zd)=>{Ld=32===this.ga.Mf(Qd,Gb.a.insertHyperlink,1,!1,null,null);if(1===Zd)return Ld&&this.Fab.Dyi?32:8;if(2!==Zd||!Ld)return 8;u.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.cje(this.v_g.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.w_g)};this.Csj=(Ld,Qd,Zd)=>{Ld=this.Ouc.value.Jfa(Qd);
if(1===Zd)return Ld&&this.Fab.gEf?32:8;if(2!==Zd||!Ld)return 8;u.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.cje(this.v_g.getInstance(),CommonUIStrings.L_PictureInsertTitle,this.Gab)};this.aje=(Ld,Qd,Zd)=>{var te;Qd=this.Ouc.value.Jfa(Qd);if(1===Zd)return Qd&&this.Fab.wNm?32:8;if(2!==Zd||!Qd)return 8;u.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");(null===
(te=w.AFrameworkApplication.K)||void 0===te?0:te.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&yo.a.instance.M5a("PictureStock");this.X9a=ub.a.create();Zd=w.AFrameworkApplication.K.$("StockImagesFreemiumExperienceIsEnabled")&&this.eK.isFreemiumUpsellEnabled();Zd=this.wnd?1:Zd?0:-1;Ld=this.v3l(Ld,this.X9a,Zd);Ld=this.Hld.QOc(Ld);Ld.Yg=$C.Yg;Ld.correlationId=this.X9a;Ld.lpa=2;Ld.SAf=this.x_g;Ld.wfa=this.eK;Ld.qJj=Zd;return this.cje(Ld,CommonUIStrings.L_PictureInsertTitle,
this.Gab)};this.fje=(Ld,Qd,Zd)=>{var te;Qd=this.Ouc.value.Jfa(Qd);Ld=Ea.a.instance.Na("Common.App.SharedFilePicker.ISharedFilePicker");if(1===Zd)return Qd&&!this.Fab.gEf&&Ld&&Ld.qGf()?32:8;if(2!==Zd||!Qd||!Ld)return 8;u.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");(null===(te=w.AFrameworkApplication.K)||void 0===te?0:te.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&yo.a.instance.M5a("PictureOneDrive");this.X9a=
ub.a.create();Zd=Tw.blh;te=!1;w.AFrameworkApplication.iEf()&&(te=this.ILl());Qd=new xB;Qd.d1b=te;Qd.s$b=!0;Zd=Ld.Saf(CommonUIStrings.L_ImageUploadButtonText,"Select Images",!0,!1,!0,Zd,"Insert Media",1,Qd);Ld.DPd(Zd).then(Qf=>{if(null!=Qf&&0<Qf.length){const Jg=[];for(let Ml=0;Ml<Qf.length;Ml++){const Fm=Qf[Ml][H.a.b2i],qp=Qf[Ml][H.a.a2i],wv={};wv.Extension=Fm;wv.OriginalUrl=qp;wv.caption=Fm;Jg.push(wv)}this.Gab.SPa=Gb.a.c_;this.Gab.t2a(Jg)}});return 32};this.dje=(Ld,Qd,Zd)=>{var te;const Qf=this.Ouc.value.Jfa(Qd);
Qd=Ea.a.instance.Na("Common.App.SharedFilePicker.ISharedFilePicker");if(1===Zd)return Qf&&Qd&&Qd.qGf()?32:8;if(2!==Zd||!Qf||!Qd)return 8;Zd=Ea.a.instance.Na("Common.App.PhoneLink.IPhoneLinkManager");null!=Zd&&Zd.BBl(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));u.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");(null===(te=w.AFrameworkApplication.K)||void 0===te?
0:te.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&yo.a.instance.M5a("PictureMobile");this.X9a=ub.a.create();te=Tw.blh;Zd=new xB;Zd.d1b=!0;Zd.s$b=!0;te=Qd.Saf(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,!0,!1,!0,te,"InsertPictureFromMobile",3,Zd);Qd.DPd(te).then(Jg=>{if(null!=Jg&&0<Jg.length){var Ml=[];const Fm=Ld===Gb.a.dXd;let qp=!1;const wv=w.AFrameworkApplication.K.jb("PhoneLinkServiceEndpoint");for(let jD=0;jD<Jg.length;jD++){const CB=
Jg[jD][H.a.b2i],bE=Jg[jD][H.a.a2i],Az={};Az.Extension=CB;Az.OriginalUrl=bE;Az.caption=CB;Ml.push(Az);qp||(qp=-1!==Az.OriginalUrl.indexOf(wv))}this.Gab.SPa=Gb.a.c_;this.Gab.t2a(Ml);Ml={};Ml.InsertImageCount=Jg.length;qp&&Xe.c(Fm?Gb.a.OCm:Gb.a.sVk,void 0,void 0,void 0,void 0,void 0,Ml)}});return 32};this.uyc=D;this.Bqd=P;this.Hld=ta;this.v_g=Ra;this.w2=mb;this.ga=b;this.Ouc=ca;this.e2g=Ac;this.Lkd=id;this.Fab=v;this.Gab=Jb;this.w_g=Ub;this.x_g=vd;(this.eK=cc)&&this.eK.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(Ld=>u.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",Ld)).then(Ld=>{(this.wnd=Ld)||this.eK.gya("MsoPremiumStockImages",()=>{this.wnd=!0;u.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}Tb(){(this.Fab.gEf||this.Fab.Dyi)&&this.Fab.vNm&&this.iHn();this.jXn();this.iXn();this.ga.eb(Gb.a.ACh,sc.a.view,this.Csj,1284);this.ga.eb(Gb.a.B5i,
sc.a.view,this.nWo,1124);this.ga.eb(Gb.a.MAf,sc.a.view,this.Csj,1284);this.ga.eb(Gb.a.W1f,sc.a.view,this.kWo,1124);this.ga.eb(Gb.a.WCm,sc.a.view,this.Kxo,1284)}jXn(){this.ga.eb(Gb.a.insertOnlinePicture,sc.a.view,this.eje,1284);this.ga.eb(Gb.a.aXd,sc.a.view,this.aje,1284);this.ga.Fia("word_insertOnlinePictures",Gb.a.insertOnlinePicture,sc.a.view,this.eje,b=>{Xa.App.xa.Rmc(b,Object(z.a)(new gb.a,(new gb.a).eEb,"getCommandById"))});this.ga.Fia("word_insertOnlinePictures",Gb.a.aXd,sc.a.view,this.aje,
b=>{Xa.App.xa.Rmc(b,Object(z.a)(new gb.a,(new gb.a).eEb,"getCommandById"))});this.ga.eb(Gb.a.$6e,sc.a.view,this.eje,1284);this.ga.eb(Gb.a.b7e,sc.a.view,this.fje,1284);this.ga.Fia("word_insertOnlinePictures",Gb.a.b7e,sc.a.view,this.fje);this.ga.eb(Gb.a.c7e,sc.a.view,this.aje,1284);this.ga.eb(Gb.a.z5i,sc.a.view,this.lWo,1284);this.ga.eb(Gb.a.A5i,sc.a.view,this.mWo,1284);this.ga.Fia("word_insertOnlinePictures",Gb.a.$6e,sc.a.view,this.eje);this.ga.Fia("word_insertOnlinePictures",Gb.a.c7e,sc.a.view,this.aje);
this.ga.eb(Gb.a.OAf,sc.a.view,this.fje,1284);this.ga.Fia("word_insertOnlinePictures",Gb.a.OAf,sc.a.view,this.fje,b=>{Xa.App.xa.Rmc(b,Object(z.a)(new gb.a,(new gb.a).eEb,"getCommandById"))})}iXn(){w.AFrameworkApplication.iEf()&&(this.ga.eb(Gb.a.dXd,sc.a.view,this.dje,1284),this.ga.eb(Gb.a.a7e,sc.a.view,this.dje,1284),this.ga.Fia("mso_insertMobileDevicePictures",Gb.a.dXd,sc.a.view,this.dje,b=>{Xa.App.xa.Rmc(b,Object(z.a)(new gb.a,(new gb.a).eEb,"getCommandById"))}),this.ga.Fia("mso_insertMobileDevicePictures",
Gb.a.a7e,sc.a.view,this.dje,b=>{Xa.App.xa.Rmc(b,Object(z.a)(new gb.a,(new gb.a).eEb,"getCommandById"))}))}iHn(){w.AFrameworkApplication.ta.get_element().appendChild(this.Bqd.q0a);Le.a.addHandler(this.Bqd.q0a.contentWindow,"message",this.Rsj);this.uDf=!0}K0l(b,h){let v=0;w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb&&5===w.AFrameworkApplication.ta.Nb.Tl&&(v=12);const D=ok.a.sg(w.AFrameworkApplication.lcid);return String.format(w.AFrameworkApplication.K.appSettings.WordInsertPictureServiceEndpoint,
b===Gb.a.insertOnlinePicture?1:0,w.AFrameworkApplication.lcid,D?D.name:"en-us",w.AFrameworkApplication.buildVersion,h,v,w.AFrameworkApplication.K.jb("UserId"))}cje(b,h,v){try{return b.bje(h,v,void 0),u.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(D){return u.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",D.toString()),this.xp(lm.a.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,
Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}v3l(b,h,v){if(Gb.a.aXd===b)return b=this.w2.Iyh(w.AFrameworkApplication.K.jb("InsertOnlineM365PictureEndpoint"),h.toString(),1,v),this.mZe(b);b=this.w2.Iyh(w.AFrameworkApplication.K.jb("InsertOnlineM365PictureEndpoint"),h.toString(),0,v);return this.mZe(b)}xp(b,h,v){const D=new ug.StandardDialog(!0);D.Et=w.AFrameworkApplication.hca;D.Ad=0;D.Ee(1,CommonUIStrings.l_DialogClose);D.nx(b,h,v,()=>{})}ILl(){const b=Ea.a.instance.Na("Common.App.PhoneLink.IPhoneLinkManager");
return null!=b?b.LPl():!1}dispose(){this.uDf&&this.Bqd.q0a.contentWindow&&(Le.a.removeHandler(this.Bqd.q0a.contentWindow,"message",this.Rsj),this.uDf=!1)}mZe(b){return this.B3&&this.B3.aJ?(b=new eb.QueryStringBuilder(b),b.ze("theme","4"),b.toString()):b}}Tw.blh=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(n.a)(Tw,"InsertMediaActor",null,[10]);var Dy=c(958);class Oj extends Dy.a{constructor(b,h){super(b,ia.a.getOrigin(h))}Dq(b,h){this.isEnabled()&&this.Iaa(this.t7a)&&(this.Dv(b),this.TB(b,
h))}}Object(n.a)(Oj,"InsertMediaCrossDocumentMessenger",Dy.a,[673,66,10]);class bF{getInstance(b,h){return new Oj(b,h)}}Object(n.a)(bF,"InsertMediaCrossDocumentMessengerFactory",null,[637]);var YF=c(758);class KD{}KD.Yg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(n.a)(KD,"InsertMediaDialogHtml",null,[]);var xD;(function(b){b[b.OK=
0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";b[b.open=3]="open"})(xD||(xD={}));Object(n.b)("HubbleAction",xD);var pC;(function(b){b[b.unknown=0]="unknown";b[b.bing=1]="bing";b[b.M365=2]="M365";b[b.icons=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.hubble=5]="hubble"})(pC||(pC={}));Object(n.b)("InsertMediaProviders",pC);class LD extends bg.a{constructor(b,h,v,D=null,P=!1){super(!1,!1,P);this.Uy=null;this.dtc=!1;this.MYc=this.n0=null;this.L5e="KeepFocusDiv";this.yCd="KeepFocusStartDiv";this.correlationId=
null;this.lpa=0;this.wfa=this.SAf=null;this.qJj=0;this.mJe=null;this.Dqn=()=>{this.n0&&(this.n0.style.visibility="visible",window.setTimeout(()=>{if(this.gj){const ca=this.gj.getElementById(this.yCd);ca&&ca.focus()}},0))};this.uca=ca=>{ca.keyCode===Sys.UI.Key.tab&&(ca.target.id!==this.L5e||ca.shiftKey?ca.target.id===this.yCd&&ca.shiftKey&&(ca.preventDefault(),this.gj.getElementById(this.L5e).focus()):(ca.preventDefault(),this.gj.getElementById(this.yCd).focus()))};this.RTi=()=>{u.ULS.sendTraceTag(17662422,
352,100,"OnCancelDialog : Got message.");this.$Cb(this.DZa);this.nob(1)};this.jUf=()=>{this.Uy&&(u.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.Uy.sendMessage(L.a.glj,{["CustomHeaders"]:""}))};this.gVi=()=>{this.Uy&&(u.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.Uy.sendMessage(L.a.ooo,{["SessionId"]:w.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};this.dVi=()=>{this.Uy&&(u.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),
this.Uy.sendMessage(L.a.Cho,{["CID"]:""}))};this.Zqn=()=>{this.wfa&&(u.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.wfa.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.Ild=b;this.pUb="";this.w2=v;this.$sa=[];this.Nrd=h;this.Yg=D||KD.Yg;this.wg="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}async bje(b,h){this.pUb=
b;this.dtc=!1;this.showDialog(this.pUb,null);this.n0=this.M7b(this.mj("insertmediaframe"));if(!this.n0)throw this.$Cb(this.DZa),Error.invalidOperation("Couldn't get InsertMediaIframe.");b=document.createElement("div");b.setAttribute("Id",this.yCd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.n0.parentNode.insertBefore(b,this.n0.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",this.L5e);
b.setAttribute("tabindex","0");this.n0.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.Hef,"keydown",this.uca);this.n0.src=this.Ild;this.n0.style.width="100%";this.n0.style.height="100%";this.n0.frameBorder="0";w.AFrameworkApplication.K.$("ShowInsertMediaIframeWhenIframeIsReady")&&aa.a.lj?(this.n0.style.visibility="hidden",this.MYc=this.Dqn,Le.a.addHandler(this.n0,"load",this.MYc)):this.n0.style.visibility=
"visible";this.M7b(this.mj("WACDialogButtonPanel")).style.display="none";this.M7b(this.mj("WACDialogTitleText")).style.display="none";2===this.lpa&&(this.M7b(this.mj("WACDialogTitlePanel")).style.display="none",this.M7b(this.mj("WACDialogBodyPanel")).style.padding="0");bd.FocusManager.instance().Ts().scope.RH=!0;this.Uy=this.Nrd.getInstance(this.n0.contentWindow,this.Ild);this.Uy.Iaa("https://osiziwuspersimmon002.blob.core.windows.net");this.Uy.Iaa("https://osizewuspersimmon001.blob.core.windows.net");
this.Uy.Iaa("https://osizpscuspersimmon000.blob.core.windows.net");this.Uy.Iaa("https://cdn.hubblecontent.msit.osi.office.net");this.Uy.Iaa("https://cdn.hubblecontent.osi.office.net");this.Uy.Dq(L.a.yoh,v=>{this.hTi(v,Object(z.a)(h,h.t2a,"insertMediaCallback"))});this.Uy.Dq(L.a.insert,v=>{this.z7d(v,Object(z.a)(h,h.t2a,"insertMediaCallback"))});this.Uy.Dq(L.a.vuk,v=>{this.gsn(v)});this.Uy.Dq(L.a.V7h,this.jUf);this.Uy.Dq(L.a.getSessionId,this.gVi);this.Uy.Dq(L.a.D5h,this.dVi);this.Uy.Dq(L.a.RCd,this.RTi);
2!==this.lpa||this.qJj||(this.Uy.Dq(L.a.nZm,this.Zqn),this.mJe=this.wfa.gya("MsoPremiumStockImages",v=>{u.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");this.Uy.sendMessage(L.a.q0o,{["LicenseTier"]:v.toString()})}));this.nob(3)}dispose(){this.wfa&&this.mJe&&this.wfa.shc("MsoPremiumStockImages",this.mJe);this.Uy&&(this.Uy.dispose(),this.Uy=null);this.MYc&&(Le.a.removeHandler(this.n0,"load",this.MYc),this.MYc=null);super.dispose()}hTi(b,h){u.ULS.sendTraceTag(7135752,
352,100,"OnAddItem : Got message.");if(b=this.w2.OBn(b))this.$sa.push(b),this.dtc&&(h(this.$sa),this.dtc=!1)}xp(){const b=new ug.StandardDialog(!0);b.Et=w.AFrameworkApplication.hca;b.Ad=0;b.Ee(1,CommonUIStrings.l_DialogOk);b.Ou(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}nob(b){if(2===this.lpa){const v=w.AFrameworkApplication.K.jb("InsertMediaDialogAriaTenantNameSpace");if(v&&""!==v){var h=[];h.push(Object.assign(new na.a,{name:"InsertedFiles",
int64:this.$sa.length}));h.push(Object.assign(new na.a,{name:"MediaDetails",string:JSON.stringify(this.$sa)}));h.push(Object.assign(new na.a,{name:"DialogResult",string:xD[b]}));h.push(Object.assign(new na.a,{name:"DialogMode",string:this.Ubi()}));h.push(Object.assign(new na.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new na.a,{name:"Provider",string:pC[this.lpa]||"Unknown"}));fa.a.sendTelemetryEvent(Object.assign(new oa.a,{name:String.format("{0}.{1}",v,this.telemetryEventName),
dataFields:h}))}}}Ubi(){return 3===this.lpa?"Icons":5===this.lpa?"ExternalContent":"Images"}M7b(b){const h=document.getElementById(b);if(!h)throw Error.invalidOperation(String.format("Couldn't get {0}.",b));return h}z7d(b,h){u.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.$Cb(this.DZa);h?this.$sa&&50<this.$sa.length?(this.xp(),this.nob(0),u.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.$sa.length,pC[this.lpa])):this.$sa&&0<
this.$sa.length?(h(this.$sa),this.nob(0),u.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.$sa.length,pC[this.lpa])):(u.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.dtc=!0,h(this.$sa),this.nob(2)):this.nob(2)}gsn(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,u.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),fa.a.sendOtelEvent(Object.assign(new YF.a,{otelEvent:b})))}}
Object(n.a)(LD,"InsertMediaDialog",bg.a,[633,10]);class cF{constructor(b,h){this.QEe=b;this.w2=h}QOc(b,h=!1){return new LD(b,this.QEe,this.w2,KD.Yg,h)}getInstance(){throw Error.notImplemented();}}Object(n.a)(cF,"InsertMediaDialogFactory",null,[632]);class dF{constructor(b,h,v){this.pvi=!1;this.correlationId=null;this.lpa=0;this.SAf=null;this.E6j=b;this.NCc=[];this.Mkd=h;this.Vhh=v.split(";")}async bje(b,h){Array.clear(this.NCc);b=this.E6j.value;b.Iaa(this.Mkd);b.Dv(h.ERc);this.pvi||(b.TB(h.ERc,v=>
{this.z7d(v,h)}),this.pvi=!0);u.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(h.iOh,{["FileExtensionFilterList"]:this.Vhh})}Dwk(b){Array.contains(this.NCc,b)||this.NCc.push(b)}z7d(b,h){u.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=h.K0i(b);const v=[];for(let D=0;D<b.length;D++){const P=b[D];h.TYd(P,this.Vhh)?v.push(P):this.Dwk(h.Nfi(P))}v&&v.length?h.t2a(v):u.ULS.sendTraceTag(20509843,
352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.NCc.length&&(h=this.NCc.join(", "),u.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",h),this.mzo(h))}mzo(b){const h=new ug.StandardDialog;h.Ad=0;h.cV(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,b),null)}dispose(){}}Object(n.a)(dF,"InsertMediaFromHostManager",null,[633,10]);class eF{constructor(b){this.N7j=
b}QOc(){throw Error.notImplemented();}getInstance(){return this.N7j}}Object(n.a)(eF,"InsertMediaFromHostManagerFactory",null,[631,632]);class MD{constructor(){this.q0a=document.createElement("iframe");this.q0a.src="about:blank";this.q0a.style.visibility="hidden";this.q0a.style.position="absolute";this.q0a.style.zIndex="-100"}}Object(n.a)(MD,"InsertMediaFromHostOneDriveHostFrame",null,[630]);class fF extends Dy.a{constructor(b,h){super(b,"*"===h?h:ia.a.getOrigin(h));this.Anh(L.a.insertImage);this.Anh(L.a.CAf)}nee(){}}
Object(n.a)(fF,"InsertMediaFromOneDriveCrossDocumentMessenger",Dy.a,[288,66,10]);class ND{}Object(n.a)(ND,"OnlineMediaSearchResult",null,[]);class aD{Iyh(b,h,v,D){const P=ok.a.sg(w.AFrameworkApplication.lcid).name,ca=w.AFrameworkApplication.buildVersion,ta=G.a.XW(w.AFrameworkApplication.K.jb("UserId")).toString();if(-1!==b.indexOf("exp=")){const Ra=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",!1)?1:0;w.AFrameworkApplication.ue("ShIns226;ShIns226cf");
return String.format(b,w.AFrameworkApplication.lcid,P,ca,h,aD.Nre,ta,D,v,Ra)}return String.format(b,w.AFrameworkApplication.lcid,P,ca,h,aD.Nre,ta,D,v)}OBn(b){if(!b||!b.Values)return null;b=b.Values;if(!b)return null;let h="";"sourceProvider"in b&&(h=b.sourceProvider||"");return Object.assign(new ND,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",ContentProvider:h,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||
"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||"",ProviderName:b.providerName||""})}PBn(b){const h=[];if(!b||!b.Values||!b.Values.Items)return h;b=b.Values.Items;for(let D=0;D<b.length;D++){var v=b[D];v&&(v=Object.assign(new ND,{Type:v.Extension||"",OriginalUrl:v.SourceUrl||"",Caption:v.caption,Height:v.Height||0,Width:v.Width||0}),h.push(v))}return h}CYf(b){const h=[];for(let D=0;D<b.data.files.length;D++){var v=b.data.files[D];
v&&(v=Object.assign(new ND,{ContentType:v.itemType||"",Type:v.extension||"",OriginalUrl:v.urls&&v.urls.open?v.urls.open:"",Height:v.photo?v.photo.height:0,Width:v.photo?v.photo.width:0}),h.push(v))}return h}TYd(b,h){if(!b)return!1;for(let v=0;v<h.length;v++)if(0<=b.toLowerCase().indexOf(h[v]))return!0;return!1}dHn(b){let h="";if(b)for(let v=0;v<b.length;v++){const D=b[v];D&&(h+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',D.OriginalUrl,D.Width,D.Height))}return h}}aD.Nre=0;Object(n.a)(aD,
"InsertMediaHelper",null,[629]);class tE{constructor(b,h,v,D,P){this.uNm=b;this.gEf=h;this.Dyi=v;this.vNm=D;this.wNm=P}}Object(n.a)(tE,"InsertMediaSettingsManager",null,[]);class uE{constructor(b){this.Zuc=Gb.a.insertHyperlink;this.ga=b}get SPa(){return this.Zuc}set SPa(b){this.Zuc=b}t2a(b){try{u.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let h=0;h<b.length;h++)this.ga.Qb(this.SPa,2,b[h]);u.ULS.sendTraceTag(21612192,352,50,
"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length)}catch(h){u.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",h.toString())}}}Object(n.a)(uE,"InsertOneDriveFileHandler",null,[628]);class mA extends uE{constructor(b){super(b)}get iOh(){return L.a.CAf}get ERc(){return L.a.oCm}K0i(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}Nfi(){Kc.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");
return""}TYd(){return!0}L4i(b,h,v){b=v(b);b.length&&(v={},v.Items=b,h.sendMessage(this.ERc,v))}M0i(b){const h=[];for(let v=0;v<b.data.files.length;v++){const D=b.data.files[v];if(D){const P={};P.DisplayText=String.format("{0}{1}",D.name,D.extension);P.Url=this.zFl([D.urls.viewInBrowser,D.urls.open,D.urls.download]);h.push(P)}}return h}zFl(b){for(let h=0;h<b.length;h++)if(b[h]&&""!==b[h])return b[h];u.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(n.a)(mA,
"InsertOneDriveFileHelper",uE,[627,628]);class eu{constructor(b,h,v){this.Zuc=Gb.a.c_;this.Wp=null;this.ga=b;this.w2=h;this.efa=v}get pc(){return this.ga}get zu(){return this.Wp||(this.Wp=Ea.a.instance.resolve("Common.Utils.IAriaNotifier"))}get SPa(){return this.Zuc}set SPa(b){this.Zuc=b}t2a(b){try{u.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",b.length);const h=this.w2.dHn(b);let v=2;if(h&&0<h.length){const D=new Md.DictionaryPropertySet;
D.setValue(Wc.a.iP,h);D.setValue(Wc.a.g4,!0);if(this.efa){const P=this.efa.A9c();P.s1b("insertOnlineImage");D.setValue(Wc.a.kua,P)}v=this.ga.Qb(this.SPa,2,D)}u.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===v,""===h)}catch(h){u.ULS.dD(21612225,352,10,h,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}Object(n.a)(eu,"InsertOnlineImageHandler",null,[628]);class Uj extends eu{constructor(b,
h,v=null){super(b,h,v)}get iOh(){return L.a.insertImage}get ERc(){return L.a.CCm}K0i(b){return this.w2.PBn(b)}Nfi(b){return b.Type}TYd(b,h){return this.w2.TYd(b.Type,h)}M0i(b){return this.w2.CYf(b)}L4i(b,h,v){v=v(b);if(v.length){b=[];for(let D=0;D<v.length;D++){const P=v[D],ca={};ca.Extension=P.Type;ca.SourceUrl=P.OriginalUrl;ca.caption=P.Type;ca.SourceUrl=P.OriginalUrl;ca.Width=P.Width;ca.Height=P.Height;b.push(ca)}v={};v.Items=b;h.sendMessage(this.ERc,v)}}}Object(n.a)(Uj,"InsertOnlineImageHelper",
eu,[627,628]);class gF{constructor(b,h){this.wtb=b;this.Nrd=h}start(b){this.wtb.start({mode:"open",select:"multi",lightbox:"white"},(h,v)=>{this.processResponse(h,v,b)})}processResponse(b,h,v){u.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&h&&h.data&&h.data.files&&0<h.data.files.length?(b=this.Nrd.getInstance(window.frames[0].parent,window.document.URL),v.L4i(h,b,D=>v.M0i(D))):u.ULS.sendTraceTag(22090010,
352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(n.a)(gF,"OneDriveFilePickerHelperV5",null,[484]);class hF{constructor(){this.Gld=this.W=null}get name(){return"Box4.Media"}xc(b){this.W=b;b.ha("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new MD).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").singleInstance();const h=new tE(Boolean.parse(w.AFrameworkApplication.K.appSettings.InsertOnlinePictureEnabled||"false"),w.AFrameworkApplication.hEf(),
!1,w.AFrameworkApplication.beg(),w.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled"));b.ha("Box4.Media.OneDriveFilePickerHelperV5",()=>new gF(b.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").singleInstance();b.ha("Box4.Media.InsertMediaActor",()=>new Tw(w.AFrameworkApplication.va,w.AFrameworkApplication.K,h,b.resolve("Box4.Media.IOneDriveFilePickerHelper"),
b.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new Gg.a(()=>Ea.a.instance.resolve("Box4.Images.IImageEditor")),b.resolve("Box4.Media.IInsertMediaDialogFactory"),b.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Box4.Media.InsertOnlineImageHelper"),b.resolve("Box4.Media.InsertOneDriveFileHelper"),b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),w.AFrameworkApplication.gIb,w.AFrameworkApplication.bpa,
w.AFrameworkApplication.xum,w.AFrameworkApplication.K.appSettings.InsertPictureTelemetryEndpoint,b.resolve("Box4.IDarkModeState"))).singleInstance();b.ha("Box4.Media.InsertMediaDialogFactory",()=>new cF(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").singleInstance();b.ha("Box4.Media.InsertMediaFromHostManagerFactory",()=>new eF(b.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").singleInstance();
b.ha("Box4.Media.InsertMediaFromHostManager",()=>new dF(new Gg.a(()=>{if(w.AFrameworkApplication.beg()){var v=Ea.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").q0a;v=new fF(v.contentWindow,"*")}else v=w.AFrameworkApplication.OX;return v}),w.AFrameworkApplication.beg()?ia.a.getOrigin(window.document.URL):ia.a.getOrigin(w.AFrameworkApplication.RLb),w.AFrameworkApplication.K.appSettings.ImageFetcherSupportedExtensions)).singleInstance();b.register(bF,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").singleInstance();
b.register(aD,"Box4.Media.InsertMediaHelper").singleInstance();b.ha("Box4.Media.InsertOnlineImageHelper",()=>new Uj(w.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Media.InsertOneDriveFileHelper",()=>new mA(w.AFrameworkApplication.va)).singleInstance()}init(){this.Gld=this.W.resolve("Box4.Media.InsertMediaActor");this.Gld.Tb()}dispose(){this.Gld&&this.Gld.dispose()}}Object(n.a)(hF,"MediaPackage",null,
[1,2]);var iF=c(343);class xz{constructor(){this.i$n="getAddinShortcutsPreference";this.j$n="saveAddinShortcutsPreference";this.k$n="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.lMl=6E4;this.M5d=this.Mma=this.X9=null}Vfi(b){return String.format(this.k$n,w.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",b,w.AFrameworkApplication.im)}executeRequest(b,h,v,D,P=null){return xz.tQ.F0b(b,h,P,null,v,D,!1,null,this.lMl)}saveSetting(b,h,v,D,P){return this.hhj(b,h,v,null,D,
P)}startBatchUpdateScope(){this.M5d=[]}saveShortcutInfoArrayBatch(b,h,v){this.pbo(v,b,h)}pbo(b,h,v){const D={action:"",addinId:"",ownerType:0};D.timestamp=(new Date).toUTCString();const P=this.getShortcutInfoArray(h.toString(),v.toString());b?(D.shortcutInfoArray=b,this.lZe(h,v,b)):P&&(D.shortcutInfoArray=P);b={};b[h.toString()]=D;h=new iF.a(v.toString(),b);this.M5d.push(h)}commitBatchUpdateScope(){return this.C8c()?this.rbo().then(()=>{this.h2b();return Promise.resolve(!0)}):this.tbo().then(()=>
{this.h2b();return Promise.resolve(!0)})}rbo(){return this.getSetting().then(b=>{let h=null;if(b&&!({av:h}=E.d(b)).returnValue)return u.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});for(const v of this.M5d){(b=h[v.key])||(b={});const D=v.value;for(const P of jb.a.GO(D))b[P]=D[P];h[v.key]=b}this.X9=h;try{return localStorage.setItem("AddinShortcutPreferenceData",E.c(h)),Promise.resolve(!0)}catch(v){return u.ULS.sendTraceTag(522739853,
0,10,"SaveSettingToLocalStorageBatch failed",v),Promise.resolve(!1)}})}tbo(){return this.pgo().then(b=>this.Afe(b))}pgo(){return this.kuf().then(b=>{let h=null;b&&(({av:h}=E.d(b)).returnValue||u.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));h||(h={});for(const v of this.M5d){(b=h[v.key])||(b={});const D=v.value;for(const P of jb.a.GO(D))b[P]=D[P];h[v.key]=b}this.X9=h;return E.c(h)})}saveShortcutInfoArray(b,h,v){return this.hhj(0,
"","",v,b,h)}hhj(b,h,v,D,P,ca){const ta=this.C8c(),Ra={};Ra.action=v;Ra.addinId=h;Ra.ownerType=b;Ra.timestamp=(new Date).toUTCString();h=this.getShortcutInfoArray(P.toString(),ca.toString());0===b&&D?(Ra.shortcutInfoArray=D,this.lZe(P,ca,D)):h&&(Ra.shortcutInfoArray=h);b={};b[P.toString()]=Ra;P=new iF.a(ca.toString(),b);return ta?this.qbo(P):this.sbo(P)}qbo(b){return this.getSetting().then(h=>{let v=null;if(h&&!({av:v}=E.d(h)).returnValue)return u.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),
Promise.resolve(!1);v||(v={});v[b.key]=b.value;this.X9=v;try{return localStorage.setItem("AddinShortcutPreferenceData",E.c(v)),Promise.resolve(!0)}catch(D){return u.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",D),Promise.resolve(!1)}})}sbo(b){return this.ogo(b).then(h=>this.Afe(h))}ogo(b){return this.kuf().then(h=>{let v=null;h&&(({av:v}=E.d(h)).returnValue||u.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
v||(v={});v[b.key]=b.value;this.X9=v;return E.c(v)})}saveSettings(b){this.X9=E.a(b);this.h2b();return this.C8c()?this.khj(b):this.Afe(b)}khj(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(h){return u.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}}Afe(b){const h={};h.Wac=b;const v=E.c(h);return new Promise(D=>{try{if(void 0===v||null===v||!v.length||1E6<=v.length)D(!1);else{var P=this.executeRequest(this.Vfi(this.j$n),
2,"SaveAddinShortcutsPreferenceRequest","38",v);P.continueWith(()=>{if(P.yo||P.Ai)u.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),D(!1);else{var ca=P.result;void 0!==ca.args&&null!==ca.args&&void 0!==ca.args.data&&null!==ca.args.data&&ca.args.data.Qe===pa.a.My?D(!0):D(!1)}})}}catch(ca){u.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",ca.toString()),D(!1)}})}getSetting(){const b=this.C8c();return this.X9?Promise.resolve(E.c(this.X9)):
b?this.hdm():this.kuf()}C8c(){const b=w.AFrameworkApplication.K.$("IsAnonymousUser"),h=w.AFrameworkApplication.K.$("IsRoamingServiceEnabled");return b||!h}hdm(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return u.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",b),Promise.resolve("")}}kuf(){return new Promise((b,h)=>{try{const v=this.executeRequest(this.Vfi(this.i$n),1,"GetSettingRequest","37");v.continueWith(()=>{if(v.yo||
v.Ai)u.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let P="";var D=v.result;D&&D.args&&D.args.data?D.args.data.Qe!==pa.a.My?u.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",D.args.data.Qe):D.args.data.ve?(D=E.a(D.args.data.ve),D.Wac&&(P=D.Wac)):u.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):u.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(P)}})}catch(v){u.ULS.sendTraceTag(522739866,
0,10,"GetSettingFromRoaming Exception handling request {0}",v.toString()),h("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const h=this.C8c(),v=this;return this.getSetting().then(D=>{let P=null;D&&(P=E.a(D));if(!P)return u.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const ca of jb.a.GO(P)){D=P[ca.toString()];for(const ta of jb.a.GO(D)){const Ra=D[ta];if(Ra.addinId===b)delete D[ta.toString()];else if(0===Ra.ownerType&&
Ra.shortcutInfoArray){const mb=Ra.shortcutInfoArray,Jb=new Fb.a;for(let Ub=0;Ub<mb.length;++Ub)mb[Ub].addinId!==b&&Jb.add(mb[Ub]);Ra.shortcutInfoArray=Jb.toArray()}}jb.a.count(D)||delete D[ca]}v.X9=P;v.y_n(b);return h?v.khj(E.c(P)):v.Afe(E.c(P))})}h2b(){if(this.X9){this.Mma=null;const v=this.X9;for(let D in v){var b=D;const P=v[D];for(let ca in P){var h=ca;const ta=P[ca];ta.shortcutInfoArray&&this.lZe(parseInt(h),parseInt(b),ta.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>
{let h=null;if(b&&!({av:h}=E.d(b)).returnValue)return u.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.X9=h;this.h2b();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,h,v){return this.X9&&(v=this.X9[v])&&(h=v[h])&&h.addinId===b?h:null}getShortcutInfoArray(b,h){return this.X9&&(h=this.X9[h])&&(b=h[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,
h,v){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(h),v)}setShortcutInfoArray(b,h,v){return this.saveShortcutInfoArray(parseInt(b),parseInt(h),v).then(()=>{this.h2b();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,h){if(!this.Mma)return Promise.resolve(!0);var v=this.Mma[b];if(!v)return Promise.resolve(!0);var D=v[h];v=D.modifiers;D=D.keyCode;const P=this.getShortcutInfoArray(v.toString(),D.toString());if(!P||!P.length)return Promise.resolve(!0);let ca=0;for(const ta of P){if(ta.addinId===
b&&ta.action===h)break;++ca}if(ca>=P.length)return Promise.resolve(!0);P.splice(ca,1);return this.saveShortcutInfoArray(v,D,P).then(()=>{this.h2b();return Promise.resolve(!0)})}lZe(b,h,v){this.Mma||(this.Mma={});for(const D of v){v=D.addinId;const P=D.action;let ca=this.Mma[v];ca||(ca={});const ta={};ta.modifiers=b;ta.keyCode=h;ca[P]=ta;this.Mma[v]=ca}}y_n(b){b in this.Mma&&delete this.Mma[b]}isActionCustomized(b,h){return this.Mma&&(b=this.Mma[b])&&b[h]?!!b[h]:!1}getShortcutByCustomizedAction(b,
h){return this.Mma&&(b=this.Mma[b])?b[h]:null}getShortcutsPreferenceMappingTable(){return this.X9}static instance(){xz.p0e||(u.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),xz.p0e=new xz,xz.tQ=w.AFrameworkApplication.Ne);return xz.p0e}}xz.p0e=null;xz.tQ=null;Object(n.a)(xz,"AddinShortcutsPreferenceSettingHelper",null,[]);class jF{constructor(b,h){this.Rgd=null;new Fb.a;this.m1g=!0;this.fkd=b;this.xXg=h}C_e(b){this.xXg.addHandler("GoalChangedEvent",b)}pjn(){this.xXg.raiseEvent("GoalChangedEvent")}GCf(b,
h){return this.Rgd&&this.m1g?b in this.Rgd?this.Rgd[b]:"Formality"===h&&this.fkd.auf().formality?!1:!0:!0}hio(b,h){h===this.fkd.auf().formality&&(this.Rgd=b,this.pjn())}PWo(b){this.m1g=b}}Object(n.a)(jF,"GoalChangeSource",null,[361,362,363]);var bD=c(981),vE=c(918),ZF=c(692);class kF{constructor(b,h,v,D,P,ca){this.DKa=h;this.zAa=v;this.Se=b;this.jA=D;this.Cg=P;this.O5j=ca;this.zAa.xHb()&&this.initialize()}initialize(){return this.jA.Mk().then(()=>{this.Se.nb(this,bD.a.getTypeName());this.Se.addHandler(this,
vE.a.getTypeName())}).catch(b=>{this.Cg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}EA(b,h){if(h===lo.a.getTypeName()||h===ZF.a.getTypeName())if(!b||!b.content)this.Cg.sendTraceTag(528274564,2252,10,"Handled annotation is invalid");else if(Nk.a.getTypeNameFor(b.content)===bD.a.getTypeName()||Nk.a.getTypeNameFor(b.content)===vE.a.getTypeName())if(Nk.a.getTypeNameFor(b.content)===bD.a.getTypeName()){var v=b.content;this.Cg.sendTraceTag(528274565,
2252,50,"Goal annotation received with formality goal: {0}",v.critiqueConfiguration.formalityGoal);this.DKa.hio(v.critiqueConfiguration.mapping,v.critiqueConfiguration.formalityGoal)}else if(Nk.a.getTypeNameFor(b.content)===vE.a.getTypeName())if(b=b.content,b.features){for(v of b.features)if("Goals"===v.featureName){this.O5j.PWo(!!v.supportType);return}this.Cg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.Cg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}
Object(n.a)(kF,"GoalsAnnotationHandler",null,[359]);class lF{constructor(b){this.Fa=b}xHb(){return this.Fa.$("EditorGoalsEnabled")}}Object(n.a)(lF,"GoalsGate",null,[358]);var $F=c(1178),wE=c(1179),xE=c(869);class hw{}hw.gId=0;hw.mId="1.0";hw.settingType="Goals";Object(n.a)(hw,"GoalsConstants",null,[]);var yE=c(1065);class OD{constructor(b,h,v,D,P){this.gYb=null;this.cyi=!1;this.Nah=b;this.hkd=h;this.Cg=v;this.zAa=D;this.ACe=P;this.zAa.xHb()?this.NQn():this.zAa.xHb()&&this.E$f(hw.gId,hw.mId)}NQn(){new Promise(b=>
{this.Nah.iei(hw.settingType,h=>{this.OQn(h)?(this.E$f(this.gYb.formality,this.gYb.version),b(this.gYb)):(this.E$f(hw.gId,hw.mId),b(null))})})}OQn(b){this.cyi=!0;if(!b||!b.Qob)return this.Cg.sendTraceTag(528274529,2252,50,"No persisted goal is registered."),!1;b=b.Qob.properties;var h=b.getValue(Bc.a.Zsi);h=parseInt(h);b=b.getValue(Bc.a.$si);if(!this.hkd.Cog(b))return this.Cg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.gYb=
b=Object.assign(new yE.a,{formality:h,version:b});this.Cg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}E$f(b,h){b=Object.assign(new xE.a,{formality:b,version:h});this.ACe.Hjj(b)}M8o(b){if(this.hkd.Cog(b.version)){var h=$F.a.Xal(b.version,b.formality.toString());this.Nah.Yoh(Object.assign(new wE.a,{Qob:h,settingType:hw.settingType}))?this.gYb=b:this.Cg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.Cg.sendTraceTag(528274560,
2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}$ai(){this.cyi||this.Cg.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");return this.gYb}}Object(n.a)(OD,"GoalsPersistenceHandler",null,[357]);class mF{constructor(b,h,v,D){this.Cg=b;this.BCe=h;this.hkd=v;this.zAa=D;this.gkd=Object.assign(new yE.a,{formality:hw.gId,version:hw.mId});this.ySe=this.zAa.xHb()}auf(){this.ySe&&(this.ySe=!1,this.BCe.$ai()&&(this.gkd=this.BCe.$ai()));
return this.gkd}Vno(b){this.ySe=!1;this.hkd.Cog(b.version)?(this.zAa.xHb()&&this.BCe.M8o(b),this.gkd=b):(this.Cg.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",b.version),this.gkd=Object.assign(new yE.a,{formality:hw.gId,version:hw.mId}))}}Object(n.a)(mF,"GoalsProvider",null,[355,356]);class nA{constructor(b,h,v,D){this.Se=b;this.jA=h;this.xV=v;this.Cg=D}Hjj(b){b=Object.assign(new lo.a,{parentPath:["Signal",xE.a.getTypeName()],items:[Object.assign(new ei.a,{body:b})]});
this.xKd(b)}xKd(b){this.jA.Mk().then(()=>{this.IYe(b)}).catch(h=>{this.Cg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",h)})}IYe(b){this.Se.activateAnnotation(bD.a.getTypeName(),nA.i1b).then(()=>{this.xV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ja.a,{operation:b}))}).catch(h=>{this.Cg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",h)})}}nA.i1b="GoalSelected";Object(n.a)(nA,"GoalsSignalSender",null,[354]);class Ey{constructor(){Ey.uXe=
new RegExp(Ey.$ok)}Cog(b){return!!b.match(Ey.uXe)&&1===b.match(Ey.uXe).length}}Ey.$ok="[0-9]+[.]?[0-9]*";Ey.uXe=null;Object(n.a)(Ey,"GoalsValidator",null,[352]);class yB{constructor(){this.W=null}get name(){return"WordEditor.Goals"}init(){this.W.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}xc(b){this.W=b;this.W.ha("WordEditor.Goals.GoalsValidator",()=>new Ey).as("WordEditor.Goals.IGoalsValidator").singleInstance();this.W.ha("WordEditor.Goals.IGoalsGate",()=>new lF(this.W.resolve("Common.IAppSettingsManager"))).singleInstance();
this.W.ha("WordEditor.Goals.GoalsProvider",()=>new mF(this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").singleInstance();this.W.ha("WordEditor.Goals.GoalChangeSource",()=>new jF(this.W.resolve("WordEditor.Goals.IGoalReader"),new Mc.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").singleInstance();
this.W.ha("WordEditor.Goals.GoalsPersistenceHandler",()=>new OD(this.W.resolve("Box4.PersistenceSettingsManager"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsAnnotationHandler",()=>new kF(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),
this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsSignalSender",()=>new nA(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").singleInstance()}static main(){N.a.instance.Fc(new yB)}}
Object(n.a)(yB,"WordEditorGoalsPackage",null,[1,2]);var yz=c(743),zB=c(409);class AB{constructor(){this.annotation=null;this.languages=new ec.a(Va.a.Fh())}}Object(n.a)(AB,"CritiqueCountWrapper",null,[]);class Uu{constructor(){this.Kra=new ac.a}WOd(){return this.Kra}xqi(b,h,v,D){if(this.Kra.mb(v)){this.Kra.J(v).annotation.count+=h;v=this.Kra.J(v).languages;for(var P of D)v.add(P)}else P=W.a.create().toString(),b=Object.assign(new zB.a,{id:P,categoryName:b,count:h}),this.Kra.add(v,Object.assign(new AB,
{annotation:b,languages:D}))}}Uu.Ci=389;Object(n.a)(Uu,"BaseCritiquesByTypeCounter",null,[335]);class nF extends Uu{constructor(b){super();this.gxb=new Ga.a;this.gxe=new Ga.a;this.jyd=b}Jmm(b){const h=b.annotation;if(h&&yz.a(Nk.a.getTypeNameFor(h.content))){const v=h.content;if(b.opType===lo.a.getTypeName()){this.jyd.F1n(h.parentPath,v);b=v.M_.state;if(60!==b&&70!==b)return this.gxb.contains(h.id)&&this.gxb.remove(h.id),this.oxm(h.id,v),!0;this.gxb.add(h.id)}else if(b.opType===ou.a.getTypeName())if(this.gxb.contains(h.id))this.gxb.remove(h.id);
else return this.qPh(v.typeId,h.id)}return!1}Imm(b){if((b=b.annotation)&&yz.a(Nk.a.getTypeNameFor(b.content))){const h=b.content,v=h.M_.state;if((60===v||70===v)&&!this.gxb.contains(b.id))return this.gxb.add(b.id),this.qPh(h.typeId,b.id)}return!1}oxm(b,h){this.gxe.add(b);b=new ec.a(Va.a.Fh());h.language&&b.add(h.language);this.xqi(h.categoryName,1,h.typeId,b)}qPh(b,h){if(!this.gxe.contains(h))return!1;if(!this.Kra.mb(b))return u.ULS.sendTraceTag(589866503,Uu.Ci,15,"Unable to decrement the count for critique category {0}. Reason : {1}",
b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.Kra.J(b).annotation.count)return u.ULS.sendTraceTag(589866504,Uu.Ci,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.gxe.remove(h);this.Kra.J(b).annotation.count--;return!0}}Object(n.a)(nF,"AlCritiquesByTypeCounter",Uu,[339,335]);var qC=c(1002);class wt extends Mu.a{constructor(b,h,v,D,P,ca,ta,Ra,mb){var Jb;super();this.Se=b;this.jyd=h;this.Wse=
v;this.zSg=D;this.DKa=P;this.Qsa=ca;this.ri=ta;this.W$=this.SQg=!1;this.SLe=new ac.a;this.Uon=(Ub,cc)=>{this.jyd.Knm(cc)&&(this.W$=!0,this.qY())};this.Oln=(Ub,cc)=>{this.Wse.Jmm(cc)&&this.bOb()};this.xUi=()=>{this.bOb()};this.NSf=(Ub,cc)=>{this.Wse.Imm(cc)&&this.bOb()};this.imb=()=>{this.bOb()};this.bOb=()=>{let Ub=!1;this.ri.ie(()=>{var cc=this.yTl();const Ac=new Fb.a;for(const Lc of cc)cc=Object.assign(new qC.a,{id:Lc.id,parentPath:Hq.a.wCb,content:Lc,annotationType:Nk.a.getTypeNameFor(Lc)}),Ac.add(cc),
Ub||(Ub=0<Lc.count);this.Se.gio(Ac)},"CC:SATH");!this.SQg&&Ub&&(fa.a.sendTelemetryEvent({...(new oa.a),name:"Office.Word.Online.Editor.CritiquesAvailable"}),this.SQg=!0)};this.hJm=(Ub,cc,Ac)=>{const Lc=!this.DKa||this.DKa.GCf(Ub,Ac);Ub=this.Qsa&&this.Qsa.instance?this.Qsa.instance.EYd(Ub,Ac,cc.substr(1,cc.length-2)):!0;return Lc&&Ub};null===Ra||void 0===Ra?void 0:Ra.C_e(this.imb);mb.nqa(this,7);null===(Jb=this.Qsa)||void 0===Jb?void 0:Jb.execute(Ub=>{Ub.b0e(this.bOb)})}get index(){return 3}run(){this.W$&&
(this.bOb(),this.W$=!1)}XWi(){this.bOb()}X8k(b){let h=0;if(({value:h}=this.SLe.Dc(b.categoryName,0)).returnValue)if(h!==b.count)this.SLe.Z(b.categoryName,b.count);else return!1;else this.SLe.add(b.categoryName,b.count);return!0}yTl(){const b=new ac.a;var h=this.jyd.WOd();const v=this.Wse.WOd();this.rmg(b,h);this.rmg(b,v);this.zSg&&(h=this.zSg.WOd(),this.rmg(b,h));h=new Fb.a;for(const D of b.values)this.X8k(D)&&h.add(D);return h}rmg(b,h){for(const P of h){h=P.value.annotation;const ca=P.key;var v=
this.ngo(P.value.languages);if(!b.mb(h.categoryName)){var D=W.a.create().toString();D=Object.assign(new zB.a,{id:D,categoryName:h.categoryName,count:0,countsByTypeId:{}});b.add(h.categoryName,D)}this.hJm(ca,v,h.categoryName)&&(v=b.J(h.categoryName),v.count+=h.count,v.countsByTypeId[ca]=(v.countsByTypeId[ca]?v.countsByTypeId[ca]:0)+h.count)}}ngo(b){const h=[];let v=0;for(const D of b)h[v++]=D;return E.c(h)}}Object(n.a)(wt,"CritiquesCounter",Mu.a,[337,338]);class Jk{constructor(b){this.b2=b}WOd(){const b=
new ac.a,h=new ec.a(Va.a.Fh()),v=Object.assign(new zB.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.b2.Qqc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new AB,{annotation:v,languages:h}));return b}}Object(n.a)(Jk,"DictationCritiquesByTypeCounter",null,[336,335]);class zE extends Uu{constructor(b){super();this.C9a=new ac.a;this.Se=b}Knm(b){const h=Hq.a.zRd(b.nodeId);if(!Hq.a.jf(h)){if(b.ygb&&b.ygb.length){let v=null;for(const D of b.ygb)D.errorDetails.Z2a()||
(b=this.H7h(D),Hq.a.jf(b)||(v||(v=new ac.a),v.mb(b)||v.add(b,new Fb.a),v.J(b).add(D)));this.rPh(h);v?this.Zlo(h,v):this.C9a.remove(h)}else{if(!this.C9a.mb(h))return!1;this.rPh(h);this.C9a.remove(h)}return!0}return!1}F1n(b,h){var v;if(({value:v}=this.C9a.Dc(b,v)).returnValue)for(const P of v)if(b=P.value,0<b.count&&this.kpf(b.J(0))===h.categoryName)for(v=b.count-1;0<=v;v--){var D=b.J(v).end-b.J(v).begin;b.J(v).begin===h.range.start&&D===h.range.length&&(D=this.H7h(b.J(v)),this.Kra.mb(D)&&(D=this.Kra.J(D).annotation,
D.count=Math.max(0,D.count-1)),b.removeAt(v))}}rPh(b){if(this.C9a.mb(b))for(const v of this.C9a.J(b)){var h=v.key;b=v.value;this.Kra.mb(h)&&(h=this.Kra.J(h).annotation,h.count=Math.max(0,h.count-b.count))}}Zlo(b,h){const v=new ac.a,D=new ac.a;for(const P of h){h=P.key;D.add(h,new ec.a(Va.a.Fh()));for(const ca of P.value){const ta=ca.end-ca.begin,Ra=this.kpf(ca);this.rWk(b,Ra,ca.begin,ta)?u.ULS.sendTraceTag(589866513,Uu.Ci,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",
h,b,ca.begin,ta):(v.mb(h)||v.add(h,new Fb.a),v.J(h).add(ca),D.J(h).add(this.ATl(ca)))}}this.C9a.Z(b,v);for(const P of this.C9a.J(b))0<P.value.count&&(b=this.kpf(P.value.J(0)),this.xqi(b,P.value.count,P.key,D.J(P.key)))}H7h(b){let h=null;b&&(b=Object(Na.a)(333,b.errorDetails))&&b.yt&&(h=b.yt.TypeId);return h}kpf(b){let h=null;b&&(b=Object(Na.a)(333,b.errorDetails))&&b.yt&&(h=b.yt.CategoryTitle);return h}ATl(b){let h="";b&&b.errorDetails&&(h=ok.a.sg(b.errorDetails.lcid).name);return h}rWk(b,h,v,D){if((b=
this.Se.E4h(b))&&0<b.count)for(const P of b)if(b=Nk.a.getTypeNameFor(P.content),P&&yz.a(b)&&(b=P.content,b.categoryName===h&&b.range.start===v&&b.range.length===D))return!0;return!1}}Object(n.a)(zE,"WacCritiquesByTypeCounter",Uu,[334,335]);class PD{constructor(){this.W=null}get name(){return"WordEditor.CritiqueCounts"}xc(b){this.W=b}init(){var b=this.W.resolve("Common.IAppSettingsManager");if(b.$("AugLoopOperationsAreEnabled")){this.W.ha("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>
new zE(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).singleInstance();this.W.ha("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>new nF(this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("Common.IAppSettingsManager"))).singleInstance();var h=b.$("DictationCorrectionsInEditorPaneIsEnabled");h&&this.W.ha("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",()=>new Jk(this.W.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).singleInstance();
this.W.ha("WordEditor.CritiqueCounts.ICritiquesCounter",()=>new wt(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.W.Na("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.W.Na("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.Sa("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),ns.a.instance,this.W.Na("WordEditor.Goals.IGoalChangeSource"),
this.W.resolve("Box4.Graph.IGraphTransactionManager"))).singleInstance();b=this.W.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");this.W.resolve("Box4.Proofing.IErrorRangeEditor").Cqh(b.Uon);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").Qxk(b.Oln);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").oqh(b.NSf);h&&(h=this.W.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),h.Xph(b.xUi),h.Yph(b.xUi))}}dispose(){}static main(){N.a.instance.Fc(new PD)}}Object(n.a)(PD,
"WordEditorCritiqueCountsPackage",null,[1,2]);class AE{get name(){return"WordEditor.GraphicsEditor"}xc(){}init(){}dispose(){}static main(){N.a.instance.Fc(new AE)}}Object(n.a)(AE,"PackageManager",null,[1,2]);var aG=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},
children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",
Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",
Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",
LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class oF{constructor(b){this.z2j={};this.Ub=b;this.qxb=new fc.a}sOa(b,h){const v=this.Ub.Dgc,D=parseInt(b);return b&&D!==Oc.ActionManager.Chf?this.qxb.mb(v)?(b=this.qxb.J(v).w9b(D,h,2),
32===b||1===b):!1:!1}FFa(b){const h=parseInt(b),v=this.Ub.Dgc;return b&&h!==Oc.ActionManager.Chf?this.qxb.mb(v)?32===this.qxb.J(v).w9b(h,this.z2j,1):!1:!0}U9i(b,h){this.qxb.Z(b,h)}wqj(b){b=parseInt(b);const h=this.Ub.Dgc;return!!h&&!!this.qxb.J(h)&&this.qxb.J(h).nIm(b)}}Object(n.a)(oF,"NonCanvasCuiUser",null,[877,332]);var Fy=c(1205),rC=c(49),sC;(function(b){b[b.UnspecifiedGallery=0]="UnspecifiedGallery";b[b.CharacterCodeGallery=1]="CharacterCodeGallery";b[b.FontStyleGallery=2]="FontStyleGallery";
b[b.InkThicknessGallery=3]="InkThicknessGallery";b[b.IconGallery=4]="IconGallery";b[b.ListGallery=5]="ListGallery";b[b.TableStyleGallery=6]="TableStyleGallery";b[b.PageNumberGallery=7]="PageNumberGallery";b[b.ChangeColorsGallery=8]="ChangeColorsGallery"})(sC||(sC={}));Object(n.b)("GalleryType",sC);class Au{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(n.a)(Au,"CommonGalleryButtonProps",null,[]);class QD extends Au{constructor(){super();this.tableStyles=this.tableCellStyles=
null;this.columns=0}}Object(n.a)(QD,"AdditionalTableStyleGalleryButtonProps",Au,[]);class pF extends QD{constructor(){super()}}Object(n.a)(pF,"AdditionalChangeColorsGalleryButtonProps",QD,[]);class qF extends Au{constructor(){super();this.character=null}}Object(n.a)(qF,"AdditionalCharacterCodeGalleryButtonProps",Au,[]);class tC extends Au{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(n.a)(tC,"AdditionalFontStyleGalleryButtonProps",Au,[]);class Cp{constructor(){this.selectedId=
this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(n.a)(Cp,"AdditionalGalleryProperties",null,[]);class BE extends Au{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(n.a)(BE,"AdditionalIconButtonProperties",Au,[]);class rF extends Au{constructor(){super();this.styleDisplayName=null}}Object(n.a)(rF,"AdditionalInkThicknessGalleryButtonProps",
Au,[]);class sF extends Au{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(n.a)(sF,"AdditionalListGallerButtonProps",Au,[]);class tF extends Au{constructor(){super();this.text=null}}Object(n.a)(tF,"AdditionalPageNumberGalleryButtonProps",Au,[]);var Lx=c(1132);const Mr=(b,h)=>{var v=appChrome.selectors.getActiveControlStates();if(v=Object(Na.a)(Object,v[b])){if((b=Object(Na.a)(String,v.value))&&b===h)return!1;b=Object(Na.a)(String,v.selectedKey);if(!h&&!b)return!1;if(b){v=Array.isArray(v.options)?
v.options:null;let D=null;for(let P=0;P<v.length;P++){const ca=Object(Na.a)(Object,v[P]);if(Object(Na.a)(String,ca.key)===b){D=ca;break}}if(D&&Object(Na.a)(String,D.text)===h)return!1}}return!0},CE=(b,h,v,D)=>{if(0<(D&2)){D=[];switch(h){case "ToggleButtonModel":case "InkButtonModel":D.push(RD(b,v[If.a.On]));break;case "CheckboxModel":D.push(appChrome.actions.toggleCheckbox(b,v[If.a.On]));break;case "ComboBoxModel":if(w.AFrameworkApplication.K&&(w.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1))&&!Mr(b,v[Jm.a.Value]))break;(h=v[Jm.a.Key])?D.push(appChrome.actions.updateComboBoxKey(b,h,v[Jm.a.Value])):D.push(appChrome.actions.updateComboBoxValue(b,v[Jm.a.Value]));break;case "FontPickerModel":D.push(appChrome.actions.updateFontPickerSelectedFont(b,v[Lx.a.SelectedFont]));break;case "SplitButtonModel":D.push(RD(b,v[wh.a.On]));break;case "SpinButtonModel":D.push(appChrome.actions.updateSpinButton(b,
v[mj.a.Number],Df.a.n_a(v[mj.a.UnitType]),v[mj.a.Text],v[mj.a.MaxValue],v[mj.a.Alt]));break;case "ColorPickerModel":D.push(appChrome.actions.updateColorPickerSelectedColor(b,v[db.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":D.push(appChrome.actions.updatePageNumberGalleryButtonText(b,v[ri.a.Text]));break;case "CompoundButtonModel":v[If.a.Description]&&D.push(appChrome.actions.updateCompoundButtonDescription(b,v[If.a.Description]));If.a.On in v&&D.push(RD(b,v[If.a.On]));break;case "SliderModel":v.snapToStep?
D.push(appChrome.actions.updateSliderSelectedValue(b,v[Jn.Value])):D.push(appChrome.actions.updateSliderValue(b,v[Jn.Value],v[Jn.MinValue]||0,v[Jn.MaxValue],v[Jn.Text]));break;case "FlyoutAnchorModel":ln.a.ImageIsVisible in v&&D.push(appChrome.actions.hideFlyoutAnchorIcon(b,!v[ln.a.ImageIsVisible]));If.a.On in v&&D.push(RD(b,v[If.a.On]));break;case "InputBoxModel":D.push(appChrome.actions.updateInputBoxValue(b,v[Kn.a.Text]))}h=D;var P=Object(Na.a)(String,v[ph.a.iconColor]);void 0!==P&&null!==P&&h.push(appChrome.actions.updateIconColor(b,
P));uF(b,v,D);h=D;(P=Object(Na.a)(Object,v[ph.a.IconSet]))&&h.push(appChrome.actions.setControlIconSet(b,P));h=D;P=Object(Na.a)(String,v[ph.a.customTooltip]);void 0!==P&&null!==P&&h.push(appChrome.actions.setControlCustomTooltip(b,P));b=D;(v=Array.isArray(v[ph.a.W3f])?v[ph.a.W3f]:null)&&b.push.apply(b,v);return D}return null},BB=(b,h)=>appChrome.actions.updateControlEnabledDisabledState(b,h),RD=(b,h)=>appChrome.actions.toggleButton(b,h),uF=(b,h,v)=>{h=Object(Na.a)(String,h[ph.a.Icon]);void 0!==h&&
null!==h&&v.push(appChrome.actions.setControlIcon(b,h))};class uC{constructor(b,h,v,D){this.Pl=D;this.Ysa=b;this.eA=h;this.SYb=v;this.Yvc={}}eFn(b,h,v,D,P=null){const ca=b.ExternalGalleryId||b.ExternalId;var ta=b.ExternalId;D.push(ca);if(appChrome.selectors.isControlDefined(ca))b.GalleryStyle&&Rh.d("setGalleryStyles")&&h.push(appChrome.actions.setGalleryStyles(ca,b.GalleryStyle));else{if(4!==b.Type)return;v.push(appChrome.api.createGalleryModel(ca,Object.assign(new Cp,{columns:b.Width,sections:[appChrome.api.gallerySection([],
ta)],styles:b.GalleryStyle,galleryType:"IconGallery"})))}v=0;D=!!w.AFrameworkApplication.K&&(w.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(Rh.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){ta=[];const mb=[],Jb=[],Ub={};for(var Ra of b.GallerySections){ta.push(appChrome.api.gallerySection([],Ra.SectionId,Ra.Title));0===v&&Ra.GalleryButtons&&
0<Ra.GalleryButtons.length&&(v=Ra.GalleryButtons[0].Type);D&&this.yei(Ra.GalleryButtons,P,Ub);const cc=this.vZe(mb,Ra.GalleryButtons,Ub);mb.push.apply(mb,this.jtf(cc,ca,Ra.SectionId,!1,v,P,!0,Ub));Jb.push.apply(Jb,cc)}h.push(appChrome.actions.setGallerySections(ca,ta));h.push.apply(h,mb);h.push.apply(h,this.Hqf(ca,sC[v],Jb,null,5===b.Type,!0,null,Ub))}else b.GalleryItems&&0<b.GalleryItems.length&&(v=b.GalleryItems[0].Type),Ra=D?this.yei(b.GalleryItems,P,null):null,h.push.apply(h,this.jtf(this.vZe(h,
b.GalleryItems,Ra),ca,ta,!1,v,P,!1,Ra))}T9l(b,h){const v=[];let D=null,P=!1;if(!b)return null;const ca=this.Ysa.Q1c(this.eA,b.commandId,h);v.push(BB(b.externalUxCommand,!ca));if(b.previewControlIds){const mb=[];for(let Jb=0;Jb<b.previewControlIds.length;Jb++){var ta={},Ra=b.previewControlIds[Jb];ta.SourceControlId=Ra;const Ub=this.Pl.getCommandByExternalUxId(Ra);this.MRd(Ub||b,ta);ta[ri.a.On]&&(D=ta.SourceControlId,ta[ri.a.HighlightOn]&&(P=!0));uF(Ra,ta,v);if(ta=Object(Na.a)(rn.a,ta[ri.a.GalleryButtonProps]))mb.push(ta),
ca&&(Ra=this.Ysa.Q1c(this.eA,ta.Command,h),ta.IsDisabled=!Ra)}0<mb.length&&v.push.apply(v,this.jtf(this.vZe(v,mb),b.externalUxCommand,b.externalUxCommand,!0,mb[0].Type));v.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,D));P&&(u.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",D),v.push(appChrome.actions.highlightSelectedFontStyle(D)))}return v}vZe(b,h,v=null){const D=[],P=[];for(let ta=0;ta<h.length;ta++){const Ra=h[ta],mb=nf.b(Ra.ExternalId)?
Ra.Id:Ra.ExternalId;D.push(mb);const Jb=v&&v[mb]?v[mb].result:-1;switch(Ra.Type){case 1:var ca=Ra;P.push(appChrome.api.createCharacterCodeGalleryButtonModel(mb,Object.assign(new qF,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,character:ca.Character,style:ca.Style,title:ca.Alt})));break;case 2:ca=Ra;P.push(appChrome.api.createFontStylesGalleryButtonModel(mb,Object.assign(new tC,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,styleDisplayName:ca.LabelText,style:ca.Style,title:ca.Alt,previewStyleLabel:ca.PreviewStyleLabel})));
break;case 3:ca=Ra;P.push(appChrome.api.createInkThicknessGalleryButtonModel(mb,Object.assign(new rF,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,styleDisplayName:ca.LabelText,style:ca.Style,title:ca.Alt})));break;case 4:ca=Ra;P.push(appChrome.api.createIconGalleryButtonModel(mb,Object.assign(new BE,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,icon:[ca.Icon],fullIconStyle:ca.FullIconStyle,previewIconStyle:ca.PreviewIconStyle,largePreviewIconStyle:ca.LargePreviewIconStyle,label:ca.LabelText,title:ca.Alt})));
break;case 5:ca=Ra;P.push(appChrome.api.createListGalleryButtonModel(mb,Object.assign(new sF,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,infoAtLevel:ca.LevelInfo,ariaLabel:ca.Alt})));break;case 6:ca=Ra;P.push(appChrome.api.createTableStyleGalleryButtonModel(mb,Object.assign(new QD,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,tableCellStyles:ca.TableCellStyles,tableStyles:ca.TableStyles,title:ca.Alt,columns:ca.columns})));break;case 8:ca=Ra;P.push(appChrome.api.createChangeColorsGalleryButtonModel(mb,Object.assign(new pF,
{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,tableCellStyles:ca.TableCellStyles,tableStyles:ca.TableStyles,title:ca.Alt})));break;case 7:ca=Ra,P.push(appChrome.api.createPageNumberGalleryButtonModel(mb,Object.assign(new tF,{disabled:-1!==Jb?1>(Jb&1):ca.IsDisabled,text:ca.Text,title:ca.Alt})))}this.Pl.addCommandToMaps(Object.assign(new rC.a(mb,Ra.Command),{queryCommandId:Ra.QueryCommand,menuItemId:Ra.MenuItemId}))}b.push(appChrome.actions.addControls(P));return D}jtf(b,h,v,D,P,ca=null,ta=!1,Ra=null){const mb=
[];D?mb.push(appChrome.actions.populateGalleryItems(h,b)):(this.Yvc[h]=!1,ta||(D=!0,appChrome.selectors.isControlDefined(h)&&(D=appChrome.selectors.getGalleryState(h),D=D.disableIndividualButtons?D.disableIndividualButtons:!0),mb.push.apply(mb,this.Hqf(h,sC[P],b,null,5===P,D,ca,Ra))),mb.push(appChrome.actions.updateGallerySectionItems(h,v,b)));return mb}$Yl(b){return this.Hqf(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?b.disableIndividualButtons:!0)}Hqf(b,
h,v,D,P,ca=!0,ta=null,Ra=null){const mb=[];if(b in this.Yvc){if(this.Yvc[b])return delete this.Yvc[b],mb;this.Yvc[b]=!0}let Jb=null,Ub=-1;if(v)({Z2h:Ub,returnValue:Jb}=this.poh(h,v,mb,ca,ta,Ra));else if(D)for(const cc of D)(v=({Z2h:Ub}=this.poh(h,cc.galleryButtons,mb,ca,null,Ra)).returnValue)&&(Jb=v);mb.push(appChrome.actions.updateGallerySelectedId(b,Jb));ca&&mb.push(BB(b,!1));P&&0<Ub&&mb.push(appChrome.actions.updateListGalleryTextDirection(b,2===Ub));return mb}xei(b,h=null){const v={},D={};D.SourceControlId=
b;D.Location=h;b=this.Pl.getCommandByExternalUxId(b);if(!b)return v.result=-1,v.props=D,v;b=this.MRd(b,D);v.result=b;v.props=D;return v}yei(b,h=null,v=null){v||(v={});for(const D of b)b=nf.b(D.ExternalId)?D.Id:D.ExternalId,v[b]=this.xei(b,h);return v}poh(b,h,v,D,P=null,ca=null){let ta,Ra=null;ta=-1;let mb=!1;for(const Ub of h){var Jb=this.XYl(b);h=ca&&ca[Ub]&&-1!==ca[Ub].result?ca[Ub]:this.xei(Ub,P);const cc=h.result;h=h.props;D&&v.push(BB(Ub,1>(cc&1)));(Jb=CE(Ub,Jb,h,cc))&&v.push.apply(v,Jb);h[ri.a.On]&&
(Ra=Ub,h[ri.a.HighlightOn]&&h[ri.a.HighlightOn]&&(mb=!0));void 0!==h[ph.a.labelText]&&null!==h[ph.a.labelText]&&(Jb=this.Pl.getCommandByExternalUxId(Ub),v.push(appChrome.actions.setControlLabel(Jb.externalUxCommand,h[ph.a.labelText])));h[ri.a.IsRtl]&&0>ta&&(ta=h[ri.a.IsRtl])}mb&&(u.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",Ra),v.push(appChrome.actions.highlightSelectedFontStyle(Ra)));return{returnValue:Ra,Z2h:ta}}XYl(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";
case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}MRd(b,h){h.MenuItemId=b.menuItemId;return this.Ysa.Mpa(this.eA,this.SYb,
b.commandId,b.queryCommandId,h)}}Object(n.a)(uC,"ReactGalleryPoller",null,[]);var yD=c(687),iw=c(653),Vu=c(1703),vF=c(754),$s=c(1704);class vC{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(n.a)(vC,"PopulateFontPickerDataProps",null,[]);var zD=c(281),Wu=c(1867);class Xu{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;
this.shouldTakeFocus=!1}}Object(n.a)(Xu,"CommonOptionalButtonProperties",null,[]);class Gy extends Xu{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(n.a)(Gy,"OptionalButtonProperties",Xu,[]);class DE extends Xu{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(n.a)(DE,"OptionalCompoundButtonProperties",Xu,[]);class jw extends Xu{constructor(){super();
this.onRetryCommandId=this.retryButtonTitle=this.ariaDescription=this.label=null}}Object(n.a)(jw,"OptionalErrorViewProperties",Xu,[]);class cD extends Xu{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(n.a)(cD,"OptionalFlyoutAnchorProperties",Xu,[]);class kw extends Xu{constructor(){super();this.isBanner=null}}Object(n.a)(kw,"OptionalLabelProperties",
Xu,[]);class oA extends Xu{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.details=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}Object(n.a)(oA,"OptionalMultipActionButtonProperties",Xu,[]);class SD extends Gy{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(n.a)(SD,"OptionalPersonaButtonProperties",Gy,[]);class er extends Xu{constructor(){super();this.toggled=
!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(n.a)(er,"OptionalToggleButtonProperties",Xu,[]);var EE=c(1706),wF=c(1705),dD=c(473);class eD{constructor(){this.nGh=this.actions=null;this.SKj=!1}}Object(n.a)(eD,"PopulateActions",null,[]);class Wf{ohi(b,h){switch(h){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);case "ToggleButtonModel":return this.K$l(b);case "InkButtonModel":return this.J$l(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);
case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}K$l(b){const h={};h[If.a.On]=appChrome.selectors.getButtonToggleState(b);return h}J$l(b){const h={};h[If.a.On]=Rh.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);return h}}Object(n.a)(Wf,"ReactStatePropsSelector",null,[]);class fD{constructor(b,h,v,D,P){this.Ysa=b;this.eA=h;this.SYb=v;this.Pl=D;this.dUe={};this.fhk=new Wf;this.axb=P}auj(b){const h=b.populationProps.populateQueryCommandId;
return b.populationProps.populateOnlyOnce&&h in this.dUe}lam(b,h,v=null){const D=[],P={};if(!this.auj(b)){const ca=b.populationProps.populateQueryCommandId,ta={};ta.MenuId=b.externalUxCommand;ta.IsShadowMenuOpen=this.isShadowMenuOpen(v);if(0<(this.Ysa.Mpa(this.eA,this.SYb,ca,ca,ta,this.I0l(v))&1))if("FontPickerModel"===h)this.dUe[ca]=!0,D.push(fD.A9l(b,ta)),P[b.externalUxCommand]="FontPickerModel";else if(ta.MenuItems)switch(this.dUe[ca]=!0,h){case "ComboBoxModel":D.push(fD.y9l(b,ta));P[b.externalUxCommand]=
"ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":D.push.apply(D,this.vji(b.externalUxCommand,h,ta.MenuItems,P,v&&"location"in v?v.location:null))}}return Object.assign(new eD,{actions:D,nGh:P,SKj:this.isShadowMenuOpen(v)})}Wbi(b,h,v,D,P,ca,ta,Ra,mb=null){let Jb=null;const Ub=[];nf.c(b.Title)||(Jb=b.Title);for(let cc=0;cc<b.ControlList.length;cc++){const Ac=Object(Na.a)(nq.a,b.ControlList[cc]);
if(!Ac||Ac.ExternalId)ca&&this.BRl(Ac,ca),h.push.apply(h,this.z9l(Ac,ta,Ub,P,v,D,mb))}return Ra?appChrome.api.menuSection(Ub,Jb,b.Lang):null}vji(b,h,v,D,P=null){const ca=[],ta=[],Ra=[],mb=[];for(var Jb=0;Jb<v.MenuSectionList.length;Jb++){var Ub=Object(Na.a)(ih.a,v.MenuSectionList[Jb]);Ub&&(Ub=this.Wbi(Ub,ca,b,h,mb,D,ta,v.UpdateDynamically,P),v.UpdateDynamically&&Ra.push(Ub))}Jb=null;v.MenuFooterSection&&(Jb=this.Wbi(v.MenuFooterSection,ca,b,h,mb,D,ta,v.UpdateDynamically,P));v.UpdateDynamically&&ca.push(appChrome.actions.updateMenu(b,
Ra,v.Title,v.AriaLabel,v.ShouldAutoOpen,v.AriaRoleDescription,v.MenuTargetDescriptor,Jb));0<ta.length&&ca.splice(0,0,appChrome.actions.addControls(ta));0<mb.length&&Rh.d("setStatefulSplitButtonMruBypassControls")&&ca.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,mb));return ca}BRl(b,h){switch(b.ControlType){case 1:case 3:h[b.ExternalId]=1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:h[b.ExternalId]="ToggleButtonModel";break;case 6:h[b.ExternalId]="CheckboxModel";
break;case 7:h[b.ExternalId]="ColorPickerModel";b=Object(Na.a)(lz.a,b);b.McuLayout&&(h[b.McuExternalId]="ColorPickerModel");break;case 9:h[b.ExternalId]="FlyoutAnchorModel"}}z9l(b,h,v,D,P,ca,ta=null){const Ra=[];switch(b.ControlType){case 14:w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)&&this.hFn(Object(Na.a)(vF.a,b),Ra,h,v);break;case 1:case 3:D=Object(Na.a)(mg.a,b);this.PEn(D,Ra,h,v);D.MenuItemsStatefulData&&Rh.d("setStatefulSplitButtonMenuItemsStatefulData")&&
Ra.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(P,D.MenuItemsStatefulData));break;case 2:this.AFn(Object(Na.a)(dD.a,b),Ra,h,v);break;case 6:this.QEn(Object(Na.a)(lB.a,b),Ra,h,v);break;case 4:this.tFn(Object(Na.a)(Do,b),Ra,h,v);break;case 7:this.SEn(Object(Na.a)(lz.a,b),Ra,h,v);break;case 12:this.ZEn(Object(Na.a)(Vu.a,b),Ra,h,v);break;case 13:this.qFn(Object(Na.a)($s.a,b),Ra,h,v);break;case 9:P=Object(Na.a)(Jj.a,b);this.aFn(P,Ra,h,v);"StatefulSplitButtonModel"===ca&&D.push(P.ExternalId);
break;case 8:this.axb.eFn(Object(Na.a)(Hk.a,b),Ra,h,v,ta)}return Ra}hFn(b,h,v,D){D.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Wu.a(b.IconName)),v.push(appChrome.api.createLabelModel(b.ExternalId,b.LabelText,b.Id,Object.assign(new kw,{isBanner:b.IsBanner,
iconSet:h?h.iconSet:null}))))}PEn(b,h,v,D){D.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&h.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,b.CommandValueId)),this.uAd()&&((v=this.ePa(b))&&0<v.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Wu.a(v)).iconSet)),
b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(b.Description||Object(rb.a)(ps,b)?v.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new DE,{iconSet:(new Wu.a(this.ePa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):(D=b.DismissHostingSurfaceOnExecute,v.push(appChrome.api.createButtonModel(b.ExternalId,b.LabelText,Object.assign(new Gy,
{iconSet:(new Wu.a(this.ePa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,customTooltip:b.LabelText!==b.Alt?b.Alt:null,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==D&&null!==D?D:!0})))),this.Pl.addCommandToMaps(Object.assign(new rC.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));b.Lang&&Rh.d("setControlLanguage")&&
h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}QEn(b,h,v,D){D.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.uAd()&&((v=this.ePa(b))&&0<v.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Wu.a(v)).iconSet)),b.IsChecked&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(v.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new er,{iconSet:(new Wu.a(this.ePa(b))).iconSet,keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.Pl.addCommandToMaps(Object.assign(new rC.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}ZEn(b,h,v,D){D.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?
(b.Label&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.Label)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Wu.a(b.IconName)),v.push(appChrome.api.createErrorViewModel(b.ExternalId,Object.assign(new jw,{label:b.Label,retryButtonTitle:b.RetryButtonTitle,onRetryCommandId:b.OnRetryCommandId,ariaDescription:b.AriaDescription,iconSet:h?h.iconSet:null}))))}qFn(b,h,v,D){D.push(b.ExternalId);
appChrome.selectors.isControlDefined(b.ExternalId)?(v={},b.Label&&(v.label=b.Label),b.SecondaryLabel&&(v.secondaryLabel=b.SecondaryLabel),b.Details&&(v.details=b.Details),b.Description&&(v.description=b.Description),b.iconSet&&(v.iconSet=b.iconSet),b.Links&&(v.links=b.Links),b.CommandValueId&&(v.commandValueId=b.CommandValueId),b.ActionCommandValueId&&(v.actionCommandValueId=b.ActionCommandValueId),b.ActionCommandId&&(v.actionCommandId=b.ActionCommandId),b.CommandId&&(v.commandId=b.CommandId),h.push(appChrome.actions.updateMultiActionButton(b.ExternalId,
v))):v.push(appChrome.api.createMultiActionButtonModel(b.Id,Object.assign(new oA,{label:b.Label,secondaryLabel:b.SecondaryLabel,actionText:b.ActionText,description:b.Description,iconSet:b.iconSet,links:b.Links,details:b.Details,actionId:b.ActionId,commandId:b.CommandId,actionCommandId:b.ActionCommandId||b.ActionId,commandValueId:b.CommandValueId,actionCommandValueId:b.ActionCommandValueId||b.CommandValueId})))}AFn(b,h,v,D){D.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&
h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.uAd()&&((v=this.ePa(b))&&0<v.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Wu.a(v)).iconSet)),w.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(w.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?
v.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new er,{iconSet:(new Wu.a(this.ePa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):v.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new er,{iconSet:(new Wu.a(this.ePa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel}))),
this.Pl.addCommandToMaps(Object.assign(new rC.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}tFn(b,h,v,D){D.push(b.ExternalId);D=this.c9l(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&h.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,D,b.LabelText)):Rh.a("createPersonaButtonModel")&&v.push(appChrome.api.createPersonaButtonModel(b.ExternalId,D,b.LabelText,Object.assign(new SD,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,
iconSet:{["default"]:"doughboywhiteglyph_20"}})))}aFn(b,h,v,D){D.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.uAd()&&((v=this.ePa(b))&&0<v.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Wu.a(v)).iconSet)),void 0!==b.ImageIsVisible&&null!==b.ImageIsVisible&&h.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&
h.push(appChrome.actions.toggleButton(b.ExternalId,b.Toggled)));else{D=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const P=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;v.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new cD,{iconSet:(new Wu.a(this.ePa(b))).iconSet,keytip:b.KeyTip,hideIcon:D,toggled:P,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null})));this.Pl.addCommandToMaps(Object.assign(new rC.a(b.ExternalId,
b.Command),{queryCommandId:b.QueryCommand,populationProps:new yD.a(b.PopulateQueryCommand,b.PopulateOnlyOnce)}))}b.Menu&&h.push.apply(h,this.vji(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}SEn(b,h,v,D){b.McuLayout&&D.push(b.McuExternalId);D.push(b.ExternalId);D=0;appChrome.selectors.isControlDefined(b.ExternalId)?b.McuLayout&&(D=this.fhk.ohi(b.ExternalId,"ColorPickerModel").columnCount):(b.McuLayout&&(v.push(appChrome.api.createColorPickerModel(b.McuExternalId,
b.Width)),this.Pl.addCommandToMaps(Object.assign(new rC.a(b.McuExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),D=b.Width),v.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.Pl.addCommandToMaps(Object.assign(new rC.a(b.ExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));v=[];const P=[];for(let ca=0;ca<b.Colors.length;ca++){const ta=b.Colors[ca];ca<D?v.push(appChrome.api.colorPickerCell(ta.Color,
ta.DisplayColor,ta.Alt)):P.push(appChrome.api.colorPickerCell(ta.Color,ta.DisplayColor,ta.Alt))}0<v.length&&h.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,v));h.push(appChrome.actions.populateColorPickerCells(b.ExternalId,P));b.SelectedColorId&&(0<v.length&&h.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),h.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,b.SelectedColorId)))}ePa(b){return b.Image32by32Class?this.Pl.b9h(b.Image32by32Class):
b.Image16by16Class?this.Pl.b9h(b.Image16by16Class):b.ExternalImageId}c9l(b){return b?Object.assign(new wF.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new EE.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}I0l(b){let h=2;b&&"inputMethod"in b&&b.inputMethod&&(h=b.inputMethod);return h}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}uAd(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static A9l(b,h){return appChrome.actions.populateFontPickerDataAsync(new Promise((v,D)=>{Ea.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(P=>{P.isFeatureEnabled(zD.a.$Ib,!1).then(ca=>{let ta=h.fonts;ca||P.isFreemiumUpsellEnabled()||(ta=Wl.a.spg(ta,Ra=>Ra.fontType!==zD.a.w_f));ca=Object.assign(new vC,{commandId:b.externalUxCommand,fonts:ta,isSubscriber:ca,mruList:h.mruList,initialPinnedFontKeys:h.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
v(ca)}).catch(D)})}))}static y9l(b,h){const v=[];for(let D=0;D<h.MenuItems.MenuSectionList.length;D++){const P=h.MenuItems.MenuSectionList[D];P.Title&&v.push(appChrome.api.comboBoxHeader("Header-"+D.toString(),P.Title));for(let ca=0;ca<P.ControlList.length;ca++){const ta=Object(Na.a)(iw.a,P.ControlList[ca]);ta&&v.push(appChrome.api.comboBoxItem(ta.MenuItemId,ta.LabelText,ta.Styles,ta.CommandValueId,ta.AriaLabel,ta.Data,ta.Disabled))}D<h.MenuItems.MenuSectionList.length-1&&v.push(appChrome.api.comboBoxDivider("Divider-"+
D.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,v)}}Object(n.a)(fD,"ReactPopulateQueryCommandPoller",null,[]);class wC{constructor(b,h,v,D,P){this.Pl=v;this.Ysa=b;this.eA=h;this.SYb=D;this.axb=P}kam(b,h,v){const D=[];if(this.DIm(h))b=this.hem(b,h,v),void 0!==b&&null!==b&&D.push.apply(D,b);else if(b){var P=this.MRd(b,v);ph.a.visible in v&&D.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!v[ph.a.visible]));D.push(BB(b.externalUxCommand,1>(P&1)));
void 0!==v[ph.a.labelText]&&null!==v[ph.a.labelText]&&D.push(appChrome.actions.setControlLabel(b.externalUxCommand,v[ph.a.labelText]));void 0!==h&&null!==h&&(P=CE(b.externalUxCommand,h,v,P),void 0!==P&&null!==P&&D.push.apply(D,P),"PeopleWell"===h&&this.Huk(b.externalUxCommand,v,D))}return D}oWl(b,h,v){const D=[];switch(h){case "FlyoutAnchorModel":var P=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var ca=appChrome.selectors.getSplitButtonState(b);if(ca=this.Pl.getCommandByExternalUxId(ca.command))v=
this.Ysa.Q1c(this.eA,ca.commandId,v),D.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,!v)),D.push(BB(b,!1));return D;default:return null}h=!1;for(ca in P)if(P=this.Pl.getCommandByExternalUxId(ca),nf.c(P))h=!0;else if(v.SourceControlId=P.externalUxCommand,this.Ysa.Q1c(this.eA,P.commandId,v))return D.push(BB(b,!1)),D;D.push(BB(b,!h));return D}hem(b,h,v){switch(h){case "PreviewGalleryModel":return this.axb.T9l(b,v);case "GalleryModel":return this.axb.$Yl(v)}return null}DIm(b){return"GalleryModel"===
b||"PreviewGalleryModel"===b}MRd(b,h){h.MenuItemId=b.menuItemId;return this.Ysa.Mpa(this.eA,this.SYb,b.commandId,b.queryCommandId,h)}Huk(b,h,v){const D=h[ln.a.LabelTextUserGeneratedPlaceholderReplacements];h=h[ln.a.LabelText];D&&0<D.length&&(h=String.format.apply(null,[h].concat(D)));v.push(this.yim(b,h))}yim(b,h){return appChrome.actions.updatePeopleWell(this.iRl(b),h)}iRl(b){const h=[];var v={};b=this.Pl.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.Ysa.Mpa(this.eA,this.SYb,
"1285265560",b,v);v=v.MenuItems;if(!v)return h;v=v.MenuSectionList[0];for(b=0;b<v.ControlList.length;b++){const D=v.ControlList[b],P={};P.name=D.Alt;P.id=D.MenuItemId;P.description=D.Description;P.color=D.ImageBackColor;P.joinTime=D.JoinTimeInMS;P.imageUrl=D.ImageUrl;P.activeStatus=D.ActiveStatus;P.isAnonymous=D.IsAnonymous;P.canJump=D.CanJump;P.upn=D.Upn;h.push(P)}return h}}Object(n.a)(wC,"ReactQueryCommandPoller",null,[]);var xF=c(1119);class TD{constructor(b,h,v){this.Pl=b;this.eA=h;b=new xF.a;
this.wlk=new Wf;this.axb=new uC(b,this.eA,v,this.Pl);this.jch=new fD(b,this.eA,v,this.Pl,this.axb);this.Zbh=new wC(b,this.eA,this.Pl,v,this.axb)}BEa(){const b=[];if(!Rh.c())return b;b.push.apply(b,this.wim());var h=this.pVl();if(0<h.length)b.push.apply(b,h);else if(h=appChrome.selectors.getActiveControlIds(),Object.keys(h).length){const v=this.qVl();for(const D of v)b.push(appChrome.actions.updateControlEnabledDisabledState(D,!0)),delete h[D];b.push.apply(b,this.iTd(h))}return b}R1c(b,h){Rh.c()&&
(b=this.iTd(b,h),appChrome.api.dispatch(b))}TZf(b,h,v=null){if(!nf.c(b)&&b.populationProps&&!this.jch.auj(b)){b=this.jch.lam(b,h,v);if(!b.SKj){let D;(D=b.actions).push.apply(D,this.iTd(b.nGh,Rh.g(v)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}iTd(b,h=0){const v=[],D={};if(Rh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var P of appChrome.selectors.getActiveGroupIds())for(var ca of appChrome.selectors.getVisibleControlsInGroup(P))D[ca]=
!0;for(let ta in b)P=ta,ca=b[ta],0===h&&D[P]&&(h=2),v.push.apply(v,this.vim(P,ca,h));return v}vim(b,h,v=0){const D=[],P=this.Pl.getCommandByExternalUxId(b);let ca={};appChrome.selectors.isControlDefined(b)&&(ca=this.wlk.ohi(b,h));ca[Fy.a.Q7a]=v;nf.c(P)?(ca.ExternalUxId=b,(b=this.Zbh.oWl(b,h,ca))&&0<b.length&&D.push.apply(D,b)):(ca.MenuItemId=P.menuItemId,ca.SourceControlId=b);D.push.apply(D,this.Zbh.kam(P,h,ca));return D}wim(){const b=[],h=!!w.AFrameworkApplication.K&&(w.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),v=appChrome.selectors.getContextualTabIds();let D=[];h&&(D=appChrome.selectors.getActiveContextualTabIds());for(let ca=0;ca<v.length;ca++){var P=this.Pl.Muf(v[ca]);if(P){P=this.eA.FFa(P);let ta=!0;h&&(ta=0<=Array.indexOf(D,v[ca]));h&&ta===P||b.push(appChrome.actions.activateDeactivateContextualTab(v[ca],P))}}return b}pVl(){var b=appChrome.selectors.getSelectedTabId();const h=[],v=this.Pl.Muf(b);
v&&(this.eA.FFa(v)||h.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return h}qVl(){var b=appChrome.selectors.getActiveGroupIds();const h=[];for(const v of b)if(b=this.Pl.rZl(v))for(const D of b)this.eA.FFa(D.commandId)||((b=D.externalUxCommandIds)||(b=appChrome.selectors.getVisibleControlsInGroup(D.externalUxGroupId)),h.push.apply(h,b));return h}}Object(n.a)(TD,"ReactRibbonRootPoller",null,[861]);class zz{constructor(b,h,v=null){this.eA=this.OAa=this.gcb=null;this.yYb=
h;b.QMa(this);this.xF=v}get Yoa(){this.OAa||(this.OAa=new Date,this.OAa.setTime(0));return this.OAa}set Yoa(b){this.OAa=b}get J9(){return 2}get xF(){return this.eA}set xF(b){this.eA=b}get fhc(){this.gcb||(this.gcb=new TD(this.yYb,this.xF,this.J9));return this.gcb}Yeb(){const b=document.activeElement;ic.a.isEditable(b)&&b.blur()}executeCommand(b,h,v,D,P,ca,ta,Ra=2){nf.c(this.xF)||(P=new om.a,P.CommandLocation=Ra,P.InvocationMethod=D,P.CommandTabName=v,h[Fy.a.Q7a]=Ra,this.xF.sOa(b,h,P,ca,ta),this.L2m(b,
h))}BEa(){return nf.c(this.xF)?[]:this.fhc.BEa()}xm(){const b=this.BEa();0<b.length&&(this.Yoa=new Date,appChrome.api.dispatch(b))}obd(){Rh.c()&&this.fhc.R1c({PeopleWell:"PeopleWell"},18)}fbd(){}L2m(b,h){try{const v=Ea.a.instance.Na("Common.ISystemInitiatedFeedback");if(v&&h){const D=h.SourceControlId||h.launcherId||h.LegacyId||h.NewContextId;let P=(D?"_"+D:"")+(h.SqmControlId?"_"+h.SqmControlId:"");P=P.length?P:"_"+b;v.tKf("Ribbon"+P)}}catch(v){u.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+
(v?v.toString():""))}}}Object(n.a)(zz,"ReactRibbonRoot",null,[534,862]);var gD=c(1630);class UD{constructor(b){this.JXe=this.ZCe=!1;this.S9a=null;this.aOg=!1;this.IP=null;this.usa=!1;this.sPe=b;xf.a.instance.nb(Ed.a.Ox,this.XNc(),Object(z.a)(this,this.Lnn,"onContextualUIMouseDown"));(b=Ea.a.instance.Sa("Common.IActionContextProvider"))&&b.execute(h=>{this.IP=h});w.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&w.AFrameworkApplication.ta.Nb.xJ?Sk.a.get_instance().Ak(16,
()=>{this.q4?this.initializeContextualUI(this.XNc()):Sk.a.get_instance().Ak(7,()=>{this.initializeContextualUI(this.XNc())})}):Sk.a.get_instance().Ak(7,()=>{this.initializeContextualUI(this.XNc())})}get $_(){return this.usa}get q4(){return w.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&w.AFrameworkApplication.ta.Nb.xJ?Sk.a.get_instance().isCompleted(16)&&Sk.a.get_instance().isCompleted(7):Sk.a.get_instance().isCompleted(7)}sTk(){if(this.aOg)return!0;try{return Promise.resolve(null),
this.aOg=!0}catch(b){return!1}}Glg(b){if(!this.q4||this.JXe)return this.rLf("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.sTk())return this.rLf("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(w.AFrameworkApplication.HD)return this.rLf("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.JXe=!0;let h=Wa.a.Ig;switch(b){case 1:h=Wa.a.showContextMenu;break;case 0:h=Wa.a.showFloatie;break;case 2:h=
Wa.a.Zjc}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.JXe=!1;Xe.c(h)},0)});return!1}Qji(b){return el.UISurfaces.T0a().then(h=>{if(appChrome.api.isSmallDevice()&&h.getBlockedSmallScreenFloatieGroupList){h=h.getBlockedSmallScreenFloatieGroupList();const v=[];for(const D of b)Array.contains(h,D)||v.push(D);return v}return b})}showFloatie(b,h,v,D=null){this.Glg(0)||this.Qji(h).then(P=>{if(0>=P.length)return null;this.Jcg(P).then(()=>{const ca={};ca.target=b;el.UISurfaces.T0a().then(ta=>
{appChrome.api.dispatch(ta.showFloatie(ca,v,void 0,this.Xrf(),D));this.usa=!0;w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&w.AFrameworkApplication.va&&w.AFrameworkApplication.va.processAction(Wa.a.JJi,2);return null})});return null})}showContextMenu(b,h,v=null,D=null){this.Glg(1)||this.Xrj(b,h,v,D)}Xrj(b,h,v=null,D=null){this.Jcg(null).then(()=>{const P={};P.target=b;D&&(P.directionalHint=D);el.UISurfaces.T0a().then(ca=>{appChrome.api.dispatch(ca.showContextMenu(P,
h,v,void 0,this.Xrf()));return null})})}Yjc(b,h,v,D=null){this.Glg(2)||this.Qji(h).then(P=>{0>=P.length?this.Xrj(b,v,D):this.Jcg(P).then(()=>{const ca={};ca.target=b;const ta={};ta.target=b;el.UISurfaces.T0a().then(Ra=>{appChrome.api.dispatch(Ra.showContextualUI(ca,ta,v,void 0,D,this.Xrf()));this.usa=!0;return null})});return null})}rLf(b){u.ULS.sendTraceTag(561394519,340,15,b)}$Jc(){this.q4&&el.UISurfaces.isLoaded()&&el.UISurfaces.T0a().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}dismissFloatie(){this.q4&&
el.UISurfaces.isLoaded()&&el.UISurfaces.T0a().then(b=>{this.usa=!1;appChrome.api.dispatch(b.hideFloatie());return null})}f5b(){this.q4&&el.UISurfaces.isLoaded()&&el.UISurfaces.T0a().then(b=>{appChrome.api.dispatch(b.hideContextualUI());this.usa=!1;return null})}initializeContextualUI(b){return el.UISurfaces.T0a().then(h=>{this.ZCe||(h.initializeContextualUI(b),this.ZCe=!0);return null})}Jcg(b){if(!this.ZCe)return this.initializeContextualUI(this.XNc()).then(()=>{this.setActiveFloatieGroups(b);return null});
this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&b.length){var h=[];h.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(h);var v=[];el.UISurfaces.T0a().then(D=>{v.push.apply(v,this.sPe.fhc.iTd(D.selectors.getFloatieOnlyControlsMap(),9));0<v.length&&appChrome.api.dispatch(v);return null})}}XNc(){if(this.S9a)return this.S9a;this.S9a=gD.a("div");this.S9a.id="ReactContextualUIDiv";this.S9a.style.position="absolute";this.S9a.style.zIndex=
"1001";document.body.insertBefore(this.S9a,document.body.firstChild);return this.S9a}Lnn(b){b.Hb&&b.Hb.target&&"input"===b.Hb.target.tagName.toLowerCase()&&bd.FocusManager.instance().cD("ribbon");return!1}Xrf(){return this.IP?this.IP.contentType:"Unknown"}}Object(n.a)(UD,"ReactContextualUILauncher",null,[863]);class ii extends rv.a{constructor(){super()}}Object(n.a)(ii,"FloatieBuildOptions",rv.a,[]);class VD extends nz.a{constructor(){super()}}Object(n.a)(VD,"FloatieBuildContext",nz.a,[]);var yF=
c(642);class Vj extends Se.Builder{constructor(b,h,v){super(b,h,v,null);if(nf.c(h))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get floatie(){return this.root}hqo(b){this.root=b}fOk(){const b=new VD,h=new aA.a;h.z3c=1;h.handler=Object(z.a)(this,this.dun,"onReturnFloatieData");h.data=b;this.Qua.sfe(h)}dun(b){this.gOk(b.U2c,b.RHc);this.floatie.R0h=this;this.floatie.ym();this.floatie.Nc.style.display="none";this.placeholder.appendChild(this.floatie.Nc);this.bua.continueWith(()=>
{this.bua.result.xKb(this.floatie)},11);Zj.a.instance.nb(Ed.a.pointerDown,this.floatie.Nc,Object(z.a)(this.floatie,this.floatie.ZC,"onPointerDown"))}gOk(b,h){b=Pi.a.Oga(b,Pi.a.aPj);if(nf.c(b))throw Error.create("No floatie element was present in the data");b=new Pi.a(b);this.hqo(new Jv(b.attributes[Pi.a.id],b.attributes));b=Pi.a.Oga(b.node,Pi.a.Eqe);this.e5e(b,h)}e5e(b,h){b=Pi.a.rw(b);for(let v=0;v<b.length;v++){if(this.sQa(b[v]))continue;const D=this.k5e(b[v],h);this.floatie.Af(D)}}k5e(b,h){var v=
new Pi.a(b);b=new yF.Group(this.floatie,v.attributes[Pi.a.id],v.attributes[Pi.a.PUa],v.attributes[Pi.a.Rnc],v.attributes[Pi.a.KUa],!1,v.name===Pi.a.aTj,!1,v.attributes);v=Pi.a.rw(v.node);for(let D=0;D<v.length;D++)b.Af(this.pCd(v[D],h));return b}pCd(b,h){b=new Pi.a(b);var v=b.attributes[Pi.a.id];b=Pi.a.rw(b.node);var D=2;2===b.length&&(D=3);v=new ah.a(this.floatie,v,D,2,1);for(D=0;D<b.length;D++){const ca=new Pi.a(b[D]);var P=Pi.a.Oga(ca.node,Pi.a.Zqb);P=Pi.a.rw(P);this.q5e(v.gSd(D+1),P,ca.attributes[Pi.a.id],
h)}return v}q5e(b,h,v,D){for(v=0;v<h.length;v++){if(this.sQa(h[v]))continue;const P=new Pi.a(h[v]),ca=this.Hfa(h[v],D);ca&&b.Af(ca.BQ(P.attributes[Pi.a.Snc]))}}}Object(n.a)(Vj,"FloatieBuilder",Se.Builder,[]);class AD{constructor(b,h){this.xv=null;this.O1k=b;this.pxe=h;this.ipn=this.i7d.bind(this)}get floatie(){return this.xv}$eb(b,h,v){h=new tn.CuiHelper(Ic.a.BZa,Box4Intl.Box4Strings,null,null,h);const D=new ii;D.UG=v||{};D.UG.floatieshadingColor=!1;const P=new Vj(D,document.body,this.O1k.Wfj);P.Qua=
new ty.a(b,h);P.fOk();this.pxe.execute(ca=>{P.floatie.xF=ca});P.floatie.HXn(this.ipn);P.floatie.VWn(()=>[]);this.xv=P.floatie;return this.floatie}}Object(n.a)(AD,"AFloatieInitializer",null,[]);class FE extends AD{constructor(b,h,v,D){super(h,v);this.KZf=()=>{this.floatie.xm()};this.Jh=b;this.rI=D}$eb(b,h,v){if(b=super.$eb(b,h,v))b.Bgc=!0,b.xae=!0,b.preventDismissOnScroll=!0;this.Jh.eZa(this.KZf);return b}GSc(b,h,v=null){this.rI.Mwh(()=>this.$eb(b,h,v))}i7d(){this.floatie.Bgc=!0}}Object(n.a)(FE,"PasteFloatieInitializer",
AD,[]);var WD=c(806);class Mx{Hya(b,h){this.VTk&&this.Hwo(b,h,Mx.bNf,Mx.kb)}Hwo(b,h,v,D){switch(v){case 1:case 6:case 2:case 3:case 4:Mx.ahf.show(D,b,h)}}qOi(){switch(Mx.bNf){case 5:case 1:return!0;default:return!1}}ihl(){return Mx.bNf}get VTk(){return 1!==Xa.App.xa.state}static get ahf(){return null!=Mx.syg?Mx.syg:Mx.syg=Ea.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static M3l(b){if(!b)return 0;if(2===Xa.App.xa.mode){const h=b.Oa.node,v=he.GraphIterator.$a(h);v.Bp();return Vk.e(v.currentNode)?
2:w.AFrameworkApplication.wRb||!sA.isEmbeddedFileNode(h)||sA.isInvalid(h)?Ni.a.MMm(b.Oa)||Ni.a.CDf(b.Oa)?6:1:3}return 4}static get kb(){return Yh.a.instance.gb.kb}static get bNf(){return Mx.M3l(Mx.kb)}}Object(n.a)(Mx,"SelectionContextMenuProvider",null,[1389]);var XD=c(1847);class YD{constructor(b,h){this.xae=this.Bgc=!1;this.fRc=!0;this.JL=b;this.Pl=h}get isVisible(){return this.JL.$_}get controls(){return null}dismissFloatie(){this.JL.dismissFloatie();return!0}lif(){}T6a(b,h,v,D,P=null){this.JL.showFloatie(Object.assign(new XD.a,
{x:b.x,y:b.y}),this.pnf(v),v,P)}zEb(){return new Sys.UI.Bounds(0,0,0,0)}C3(){return this.dismissFloatie()}pnf(){return[]}}Object(n.a)(YD,"ReactFloatie",null,[379,380]);class zF{constructor(b){this.Ygd=null;this.JL=b}dispose(){}C3(){this.JL.f5b();return!0}showContextMenu(b,h){this.Zob(b,h.clientPoint,h.lg)}Zob(b,h,v){this.R6a(b,new Sys.UI.Bounds(h.x,h.y,0,0),v);u.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",b)}R6a(b,h,v,D=null){this.Ygd?this.JL.Yjc(Object.assign(new XD.a,
{x:h.x,y:h.y}),this.Ygd.pnf(v),v,b):this.JL.showContextMenu(Object.assign(new XD.a,{x:h.x,y:h.y}),v,b,D);this.Ygd=null}Zjc(b,h,v,D){this.Ygd=Object(Na.a)(YD,v);D.Hya(b,h);return!0}U3b(){}}Object(n.a)(zF,"ReactContextMenuController",null,[764,10]);var AF=c(459);class BF{constructor(){this.Lia=this.text=this.soa=null}}Object(n.a)(BF,"BusinessBarButtonData",null,[]);class GE{constructor(){this.text=this.soa=null}}Object(n.a)(GE,"BusinessBarLinkData",null,[]);var CF=c(240);class ZD{constructor(b,h,v,
D){this.jVg=this.ASg=this.v$a=this.CQg=null;this.qt=b;this.Oza=h;this.ga=v;this.Fa=D}kZf(){this.S2b();this.sGc();this.T2b()}sGc(){}S2b(){const b=Xa.App.xa.ib.Uc;b&&(this.CQg=this.f8a(this.CQg,1,2===Xa.App.xa.mode&&b.CCf,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}YVm(){return w.AFrameworkApplication.ta&&1===w.AFrameworkApplication.ta.mode}T2b(){let b=null;const h=Xa.App.xa.ib.activeSection;if(h){const v=h.M0c;CF.a.cYd(v)?22===v?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===
v||20===v?b=aa.a.ti?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===v?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===v?b=aa.a.ti?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===v&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):CF.a.Gni(h.RYa)||Xa.App.vm||this.YVm()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.jVg=this.f8a(this.jVg,5,!!b,b)}qsj(b,h,v,D){b=
this.Oza.create(null,b,null);b.closeable=!0;b.id=23;b.image=3;b.wzd(h,()=>{Dd.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+v)});D&&(b.qma=D);this.qt.lA(b,!0)}uxo(b,h,v){this.qsj(b,h,v,null)}Gxo(b){b=this.Oza.create(null,b,null);b.closeable=!0;b.id=20;this.qt.lA(b)}Rwo(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,h=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.v$a||(this.v$a=this.Oza.create(b,h,null),this.v$a.closeable=!0,this.v$a.id=27,this.qt.lA(this.v$a))}jtm(){this.v$a&&
(this.v$a=this.f8a(this.v$a,27,!1,""))}teg(b){this.ASg=this.f8a(this.ASg,30,!0,b)}f8a(b,h,v,D,P=!1,ca="",ta=null,Ra=null,mb=null){v?b?b.message=D:(b=this.Oza.create(ca,D,null),b.id=h,b.closeable=P,ta&&b.addButton(ta.text,ta.soa,ta.Lia),Ra&&b.wzd(Ra.text,Ra.soa),mb&&(b.qma=mb),this.qt.lA(b,!1)):b&&(this.qt.removeEntry(b),b=null);return b}eZe(b){this.qt.lA(b,void 0)}}Object(n.a)(ZD,"BusinessBarController",null,[186]);class pA extends ZD{constructor(b,h,v,D){super(b,h,v,D);this.zsa=null}srf(b,h,v=null,
D=null,P=null,ca=2){if(this.zsa)return null;this.zsa=this.Oza.create(h,v||"",null);this.zsa.id=6;this.zsa.image=ca;this.zsa.XZd=!1;b&&(this.zsa.errorCode=b);this.zsa.closeable=!1;h=w.AFrameworkApplication.AF&&this.Fa.$("ShowFeedbackButtonOnKickoutBusinessBar");D?(this.zsa.addButton(D,P,""),h&&this.zsa.rph(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.Bki(b)})):h&&this.zsa.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.Bki(b)},"");this.qt.lA(this.zsa,void 0,null,null,null);return this.zsa}Bki(b){u.ULS.sendTraceTag(36471966,
338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Qb(Wa.a.giveFeedback,2,{["ErrorCode"]:b})}static get oi(){return Ih.PageReader.instance}}Object(n.a)(pA,"BusinessBarController",ZD,[185,186]);class xC{static get ESi(){const b=G.a.Tj(ok.a.sg(w.AFrameworkApplication.lcid).name);return String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}}Object(n.a)(xC,"OdtUtils",null,[]);class $D extends pA{constructor(b,h,v,D){super(b,h,v,D);this.Zrb=this.Xtc=
this.l6g=this.IMa=this.r6g=this.Kgh=null;this.zak="https://go.microsoft.com/fwlink/?linkid=2134357"}kZf(){super.kZf();this.iXk()}sGc(){const b=Xa.App.xa.ib.Uc;if(b){var h=Xa.App.d0;if(Xa.App.us||Xa.App.vm||h&&w.AFrameworkApplication.nv)this.Kgh=this.f8a(this.Kgh,4,pA.oi.dWc(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.r6g=this.f8a(this.r6g,3,pA.oi.lbc(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,!0),this.l6g=this.f8a(this.l6g,8,pA.oi.F5k(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,
!0),pA.oi.SWc(b)?this.IMa||(this.IMa=this.Oza.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.IMa.id=14,this.IMa.closeable=!0,this.IMa.image=3,this.IMa.addButton(Box4Intl.Box4Strings.L_LearnMore,xk.AppFrame.VZm,""),this.qt.lA(this.IMa,!1)):this.IMa&&(this.qt.removeEntry(this.IMa),this.IMa=null)}}iXk(){if(Jl.App.kVc){const b=xC.ESi,h=this.Oza.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,
null);h.id=9;h.closeable=!0;h.Ptk(b);this.qt.lA(h,!0)}}vxo(b,h){if(Xa.App.xa.ib.Uc){const v=new BF;v.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;v.soa=()=>{b()};const D=new GE;D.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;D.soa=()=>{Dd.a.openWindow(4,w.AFrameworkApplication.privacyUrl)};this.Xtc=this.f8a(this.Xtc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,
v,D,()=>{h()})}}rtm(){this.Xtc&&(this.Xtc=this.f8a(this.Xtc,25,!1,""))}zwo(){if(Xa.App.xa.ib.Uc){const b=new GE;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.soa=()=>{Dd.a.openWindow(4,this.zak)};this.Zrb||(this.Zrb=this.Oza.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.Zrb.id=32,this.Zrb.closeable=!0,this.Zrb.image=3,this.Zrb.wzd(b.text,b.soa),this.qt.lA(this.Zrb,!1))}}bY(b){return this.qt.bY(b)}lA(b,
h){this.qt.lA(b,h)}}Object(n.a)($D,"BusinessBarController",pA,[342,185,186]);class hD{constructor(){this.menuTargetType=null}}Object(n.a)(hD,"MenuTargetDescriptor",null,[]);var Nx=c(567);class Wj extends Nx.a{constructor(b,h,v,D=!1,P,ca=null,ta){super();this.V$d=(Ra,mb,Jb,Ub,cc)=>{if(1===Jb)return 32;Ra=cc.Kx;cc=cc.xd;mb=Object.assign(new Yd.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.ncl(mb,Ra,cc.IsShadowMenuOpen);cc.MenuItems=mb;return 32};this.ZKn=h;this.rn=v;this.Icb=
ca;this.zGe=D;this.Tb(b);this.n9a=ta;Wj.fYa[1]=Gb.a.Yje;Wj.fYa[2]=Gb.a.BTd;Wj.fYa[3]=Gb.a.Ake}get utl(){return gb.a.XHd}get ttl(){return gb.a.qGd}get vtl(){return gb.a.p$d}get Zgf(){return gb.a.T0i}Tb(b){b.eb(Gb.a.WZf,sc.a.application,this.V$d,96);b.eb(Gb.a.z2i,sc.a.application,this.V$d,96)}show(b,h,v){let D=null,P=new Sys.UI.Bounds(0,0,0,0);const ca=this.v$l(b);if(ca&&(b=b.Oa.node)&&(b=b.De(Pb.InteractiveViewManager.instance.Bd.fc))){P=Nz.a.Tq(b,ca.end);if(w.AFrameworkApplication.isRtl&&P.x>h.x||
!w.AFrameworkApplication.isRtl&&P.x+P.width<h.x||P.y+P.height<h.y)P=Nz.a.Tq(b,ca.end-1);h.x=P.x+(w.AFrameworkApplication.isRtl?0:P.width);h.y=P.y+P.height;D=6}Nx.a.R6a("ContextMenu",new Sys.UI.Bounds(h.x,h.y,P.width,P.height),v,D)}L_(b,h){return this.U8c(b)||Wj.rGc(Gb.a.mergeCells)||Wj.rGc(Gb.a.VHa)||this.dfg(b)||this.Srj(b,h)||Wj.Hsj()||Wj.vsj(b).returnValue}U8c(b){return 2===Xa.App.xa.mode&&this.bVc(b)}PIc(b,h,v=null){if(nt.BB()&&2===Xa.App.xa.mode){h=this.n9a.uJh(b.Oa);if(!h||!this.dSm()&&!this.zTm(h.errorDetails))return;
h=h.errorDetails}else{if(!this.U8c(b))return;h=this.Yei(b)}var D=ok.a.sg(h.lcid);const P=D?D.name:"UNKNOWN";D=Object(rb.a)(pg.a,h)?h.typeId:"";u.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",h.errorType,h.proofingType,D,P);if(b=this.ZKn.j4b(b,h))v.push.apply(v,b),this.j8m(h,D)}zTm(b){return b&&(1===b.proofingType||2===b.proofingType)}dSm(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",
!1)}j8m(b,h){const v=Wj.fYa[b.proofingType];v&&(w.AFrameworkApplication.va.processAction(v,2),u.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",v,h,b.proofingType,nt.BB()))}Yei(b){return this.rn.Ana(b.Oa).errorDetails}bVc(b){return this.rn.Wfe(b)}N7b(){return null}RGd(){}v$l(b){return this.bVc(b)?this.rn.Ana(b.Oa):(b=this.N7b(b))?new dc.a(b.Lp,b.cpEnd):null}dfg(b){if(2!==Xa.App.xa.mode||!b)return!1;b=bB.a.mDa(b.toArray());
return!!Wj.Xg.iT(b,14)}jtj(b,h){return 2===h||3===h&&!this.bVc(b)}Srj(b,h){return 3!==h||this.bVc(b)}e$k(){const b=[];b.push(Object.assign(new mg.a,{ExternalId:this.utl}));b.push(Object.assign(new mg.a,{ExternalId:this.ttl}));b.push(Object.assign(new mg.a,{ExternalId:this.vtl}));return b}tdl(){const b=[];this.zGe&&b.push(Object.assign(new mg.a,{ExternalId:this.Zgf}));return b}static get Gd(){return null!=Wj.iEg?Wj.iEg:Wj.iEg=Ea.a.instance.resolve("Box4.List.IListReader")}static get Xg(){return em.ContextSetEditor.instance}static get LMm(){null==
Wj.WFe&&(Wj.WFe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return Wj.WFe}static get LZc(){null==Wj.jrb&&(Wj.jrb=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return Wj.jrb}static get Ita(){null==Wj.o$&&(Wj.o$=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Wj.o$}static rGc(b){return 32===w.AFrameworkApplication.va.processAction(b,
1)}static Hsj(){return 2===Xa.App.xa.mode&&!!Xa.App.Ev.NI&&Xa.App.Ev.NI.TVc(Gb.a.d9d.toString())}static Jsj(b){if(1!==b.length||!b.Oa.hl)return!1;b=he.GraphIterator.$a(b.Oa.node);b.zb(11);b.wc();return b.Rr(4)&&!Wj.Gd.qw(b).listType?!0:!1}static vsj(b){let h=!1,v=!1;if(!b)return{returnValue:!1,Eib:h,ORc:v};if(Wj.LZc)return Wj.Fxo(b,v);if(!(b.Cx||Wj.LMm&&2===b.length&&b.Pc.contextId===sc.a.endOfParagraph))return{returnValue:!1,Eib:h,ORc:v};b=b.Oa.clone();h=32===w.AFrameworkApplication.va.Mf(b,Gb.a.S4a,
1,!0,null,null);v=32===w.AFrameworkApplication.va.Mf(b,Gb.a.insertHyperlink,1,!0,null,null);return{returnValue:h||v,Eib:h,ORc:v}}static Fxo(b,h){let v;h=b.Oa.clone();v=Wj.Ita&&Yo.l(h);let D=!v&&32===w.AFrameworkApplication.va.Mf(h,Gb.a.S4a,1,!0,null,null);if(b.Cx||2===b.length&&b.Pc.contextId===sc.a.endOfParagraph)h=!v&&32===w.AFrameworkApplication.va.Mf(h,Gb.a.insertHyperlink,1,!0,null,null);else{h=!0;const P=b.length;for(let ca=0;ca<P;ca++){const ta=b.J(ca).clone();if(ta.contextId===sc.a.paragraph||
ta.contextId===sc.a.Hd)(v=Wj.Ita&&Yo.l(ta))||(h=32===w.AFrameworkApplication.va.Mf(ta,Gb.a.insertHyperlink,1,!0,null,null)&&h);else if(ta.contextId!==sc.a.endOfParagraph)return h=D=!1,{returnValue:!1,Eib:D,ORc:h}}}return{returnValue:D||h,Eib:D,ORc:h}}static XQd(b){const h=Object.assign(new ih.a,{ControlList:[]});for(const v of b)h.ControlList.push(Object.assign(new mg.a,{ExternalId:v}));return h}static uG(b){const h=[];for(const v of b)h.push(Object.assign(new mg.a,{ExternalId:v}));return h}}Wj.WFe=
null;Wj.jrb=null;Wj.o$=null;Wj.fYa=[];Object(n.a)(Wj,"AEditSurfaceContextMenu",Nx.a,[]);var bG=c(589),DF=c(855),iD=c(1773);class aE{static I9l(b,h,v){h=[];v.zHn.j4b(v.XMl(b),h);return h}static iVl(b,h,v){const D=[];if(v.U8c(b))return D;v.K.$("WordEditorIdeasCardsIsEnabled")&&!aa.a.Gt||v.Nef.RGd(b,null,h,D);return D}static Qdm(b,h,v){const D=[];v.PIc(b,h,D);return D}}Object(n.a)(aE,"ContextMenuSectionHelper",null,[]);class Sp{static WUl(b,h,v){h=[];v.Mml(b)&&h.push(Object.assign(new mg.a,{ExternalId:"ReviewDesignerSuggestion",
LabelText:v.Uam(b)}));return h}static V3l(){return Wj.rGc(Gb.a.mergeCells)?Wj.uG(["MergeCells"]):Wj.rGc(Gb.a.cke)?Wj.uG(["SplitCells"]):[]}static yhm(b,h,v){h=[];if(!v.Ch.kIh(b))return h;b=v.Ch.eji(b);h.push(Object.assign(new mg.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,b)}));h.push(Object.assign(new mg.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,
WordEditorIntl.WordEditorStrings.L_RejectChange,b)}));return h}static YPl(b,h,v){return w.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&b&&b.Oa&&b.Oa.node&&v.Jc&&v.Jc.ERi(b.Oa.node)?Wj.uG(["ShowCatchUpActivitiesForParagraph"]):[]}static QVl(b){return Bo.Vwo(b)?Wj.uG(["Draw"]):Bo.zsj(b)?Wj.uG(["EditIllustration"]):[]}static wkm(b){return Bo.uzo(b)?[Object.assign(new Jj.a,{ExternalId:"WrapTextMenu"})]:[]}static XRd(b,h,v){return v.dnl(b)?Wj.uG(["CreatePullQuote"]):[]}static getContentControls(b,
h,v){return v.Lml()?Wj.uG(["RemoveContentControl"]):[]}static HRl(){return Wj.uG(["NewComment"])}static rQl(b){const h=[];!Bo.cfg(b)&&Bo.Geg(b)&&bc.SessionStatusManager.instance.MH&&b.LH&&h.push(Object.assign(new Jj.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return h}static O0l(b,h,v){h=[];!Bo.cfg(b)&&Bo.Geg(b)&&bc.SessionStatusManager.instance.MH&&(u.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.LH&&!w.AFrameworkApplication.K.$("ChangePicturesIsEnabled")?
h.push(...Wj.uG(["ChangePicture"])):h.push(...v.wbl().ControlList),(b=Bo.wai())&&0<b.length&&(v=v.ffl(b),null!=v&&h.push(...v.ControlList)));return h}static s$l(){return Wj.Hsj()?Wj.uG(["SetProofingLanguage"]):[]}static dbm(b,h,v){return v.cSm&&v.Dyo(b)?Wj.uG(["Rewrite"]):[]}static v2l(b){return Wj.Jsj(b)?Wj.uG(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static m8l(){return Bo.Wsj()?Wj.uG(["ParagraphOptions"]):[]}static G_l(b){return Bo.zsj(b)?Wj.uG(["EditIllustration"]):[]}static Idm(b){return Bo.cfg(b)?
Wj.uG(["ShowSmartLookupPane"]):[]}static Jhm(b){return Bo.Nsj(b)?Wj.uG(["ModernTranslatorSplitButton"]):[]}static QZl(b,h,v){h=[];if(b.Cx){const D=b.Oa;if(D.contextId===sc.a.paragraph||D.contextId===sc.a.Tc||D.contextId===sc.a.Hd){b=b.Oa.node;if(!v.$i.Wb(b)||b.xr||""===b.characterData)return h;v.lgf.ZPd(b)&&h.push(...Wj.uG(["CreateHeadingLink"]))}}return h}static getBookmark(b,h,v){h=[];if(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.Cx){const D=
b.Oa;($e.SelectionEditor.gf(D)||$e.SelectionEditor.E2a(D))&&v.cMk.tPd(b.Oa.node,b.Oa.cpBegin)&&(h.push(...Wj.uG(["DeleteBookmarkContextMenu"])),w.AFrameworkApplication.ue("bookmarks-edit-ex;bookmarks-edit-ex-cf"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)&&h.push(...Wj.uG(["EditBookmarkNameContextMenu"])))}return h}static Rga(b){let h=!1,v=!1;const D=[];({Eib:h,ORc:v}=Wj.vsj(b)).returnValue&&(h?v?D.push(...Wj.uG(["EditHyperlink","SelectHyperlink",
"OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):D.push(...Wj.uG(["OpenHyperlink"])):v&&(w.AFrameworkApplication.K.$("IsO365CommercialHost")||w.AFrameworkApplication.K.$("IsO365ConsumerHost")?D.push(...Wj.uG(["InsertLinkFlyout"])):D.push(...Wj.uG(["InsertLink"]))));return D}static cRl(b,h,v){const D=[];if(!v.Srj(b,h))return D;2===Xa.App.xa.mode?(D.push(...v.e$k()),D.push(...v.tdl()),3===h&&v.bVc(b)&&D.push(Object.assign(new mg.a,{ExternalId:"Delete"}))):(!w.AFrameworkApplication.protectFile&&
!w.AFrameworkApplication.LG||w.AFrameworkApplication.QCb)&&D.push(Object.assign(new mg.a,{ExternalId:"Copy"}));return D}static Cnf(b,h,v){return v.dfg(b)&&v.jtj(b,h)?Wj.uG(["EditTableAltText"]):[]}static Aai(b,h,v){return v.Wml(b)?Wj.uG(["ShowIntentSuggestion"]):[]}static Ffm(b,h,v){const D=[];v.dfg(b)&&!v.jtj(b,h)&&(D.push(Object.assign(new Jj.a,{ExternalId:"InsertTableMenu"})),D.push(Object.assign(new Jj.a,{ExternalId:"DeleteTableMenu"})),D.push(Object.assign(new Jj.a,{ExternalId:"SelectTableMenu"})));
return D}static Lfm(b,h,v){return Bo.Xb.isFeatureEnabled(109)&&v.Wyo(b)?Wj.uG(["UpdateTableOfContents"]):[]}static AWl(b){return Bo.axo(b)?Wj.uG(["ShowHideEquationToolsPane"]):[]}}Object(n.a)(Sp,"ContextMenuSectionItemHelper",null,[]);class Bo extends Wj{get $i(){return this.fb}get lgf(){return this.OVa}constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id,vd,xe,Ld,Qd=!1,Zd=null,te=null,Qf,Jg,Ml,Fm){super(b,h,v,Qd,void 0,Zd,Qf);this.QId=Fm;this.AOe=this.IP=null;this.qYg=!1;this.Jfe=new Map;this.fE=
{};this.ulb={};this.ga=b;this.K=D;this.Ch=P;this.nW=Ra;this.vI=mb;this.Jn=Jb;this.Gok=!!Zd;this.Nef=Ub;this.zHn=cc;this.jSg=vd;this.ika=xe;this.cMk=Ld;this.OVa=Ml;this.fb=Jg;id&&id.execute(qp=>{this.Feh=qp});Ac&&Ac.execute(qp=>{this.AOe=qp});this.Jc=ta;this.Qz=Lc;te&&te.execute(qp=>{this.IP=qp});this.tym();this.xFn();this.EBl();this.wFn()}get Zgf(){return this.Gok?gb.a.m$d:super.Zgf}Zuo(){const b=Jl.App.sn.ib.rc.lb.gb.kb;return this.U8c(b)&&2!==this.Yei(b).errorType}L_(b,h){return super.L_(b,h)||
Bo.Wsj()||Wj.Jsj(b)||Bo.Geg(b)||Bo.Nsj(b)}ncl(b,h,v){const D=[];let P=null;try{P=Jl.App.sn.ib.rc.lb.gb.kb}catch(ca){u.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");return}this.lFn(P,h,D,this.SSl(P));b.MenuSectionList.push(...D);this.Llo(b);!v&&this.Feh&&this.Feh.qJn(b.MenuTargetDescriptor.menuTargetType,D)}SSl(b){return Wj.rGc(Gb.a.mergeCells)?Bu.Tug:b.sUc?Bu.wrg:b.LH?Bu.Etg:b.Sbc()?Bu.irg:Bo.aDf&&b.M2a?Bu.brg:Bu.Erg}xbl(b){b=Bo.Lbl(b);return Object.assign(new mg.a,
{ExternalId:"SmartLookupContextMenu",LabelText:b})}gfl(b){return(b=Bo.$Nj(b))?Object.assign(new mg.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}wbl(){const b=Object.assign(new ih.a,{ControlList:[]}),h=Bo.wai();b.ControlList.push(this.xbl(h));return b}ffl(b){const h=Object.assign(new ih.a,{ControlList:[]});if(b&&0<b.length){b=this.gfl(b);if(null==b)return null;h.ControlList.push(b)}return h}ncc(b){return b.LH||2<b.length||!b.length||2===b.length&&!$e.SelectionEditor.Hk(b.Pc)||1===b.length&&
$e.SelectionEditor.Hk(b.Pc)?!1:this.sHf(b.Oa)}sHf(b){return fe.ParagraphReader.Wb(b.node)?""!==fe.ParagraphReader.text(b.node).trim():!1}Wyo(b){var h=he.GraphIterator.$a(b.Oa.node);h=Object(Na.a)(bG.a,h.currentNode);return b.LH?!1:!!h&&h.xr}EBl(){w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.Qz.execute(b=>{b.isFeatureEnabled(DF.a.QQi,
!1).then(h=>{h||u.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.qYg=h;return null})}):u.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}get cSm(){w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");return this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.qYg:!1}Dyo(b){if(!this.ncc(b)||
b.M2a||b.Sbc())return!1;b=b.Oa;if(fe.ParagraphReader.lm(b)||$e.SelectionEditor.gf(b)||$e.SelectionEditor.nl(b)){b=this.vI.vEa(b);b||(b=w.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}Wml(b){if(1!==b.length||aa.a.Gt)return!1;const h=w.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled");if(h&&this.Zuo()||nt.BB()&&!this.n9a.uJh(b.Oa))return!1;const v=Bo.Xb.isFeatureEnabled(62);
return b.J(0).contextId===sc.a.Tc&&(h||v)&&0<this.Jn.ROc(b.J(0),0).count||h&&this.N7b(b)?!0:!1}Mml(b){return 1===b.length&&this.jSg.BA(b.Oa.node).tha}Uam(b){var h,v;const D=null===(h=this.QId)||void 0===h?void 0:h.cU(null===(v=null===b||void 0===b?void 0:b.Oa)||void 0===v?void 0:v.node);return iD.a.Zii(D)}get Iv(){return null!=this.dyg?this.dyg:this.dyg=Ea.a.instance.Na("WordEditor.Designer.IDesignerTaskPane")}dnl(b){if(!this.ika.ywi()||!this.Iv||this.Iv.isVisible||!(1===b.length||2===b.length&&$e.SelectionEditor.Hk(b.Pc))||
b.Akb||!$e.SelectionEditor.nl(b.Oa)&&b.Oa.contextId!==sc.a.paragraph||b.WBi()||this.jSg.BA(b.Oa.node).tha)return!1;const h=fe.ParagraphReader.text(b.Oa.node),v=b.Oa.contextId===sc.a.paragraph?0:b.Oa.cpBegin,D=b.Oa.contextId===sc.a.paragraph?h.length:b.Oa.cpEnd-v;return 1>D||1500<D||G.a.jf(G.a.kya(h.substr(v,D)))||1!=Hr.a.zhb(b.Oa.node)?!1:!0}Lml(){return 32==this.ga.processAction(Gb.a.w4c,1)}N7b(b){return this.Nef.N7b(b)}RGd(b,h,v,D=null){this.U8c(b)||this.Nef.RGd(b,h,v,D)}XMl(b){return this.AOe?
this.AOe.YMl(b):[]}Llo(b){const h=this.IP?this.IP.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new hD,{menuTargetType:h})}static get Xb(){return null!=Bo.pzg?Bo.pzg:Bo.pzg=Ea.a.instance.resolve("Box4.IFeatureHelper")}static get aDf(){if(null!=Bo.nDg)var b=Bo.nDg;else{var h;b=null===(h=w.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1);b=Bo.nDg=b}return b}static Geg(b){return w.AFrameworkApplication.U_&&
!b.M2a&&Ea.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").DVm()}static YRd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=G.a.yz(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}static Lbl(b){let h=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;(b=Bo.YRd(b))&&0<b.length&&(h=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,b));return h}static $Nj(b){b=Bo.YRd(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,
b):null}static wai(){const b=(new on.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static zsj(b){const h=Bo.Xb.isFeatureEnabled(49);return!b.KHc&&h&&!aa.a.Gt&&(b.M2a||h&&!Bo.aDf&&b.LH)}static Vwo(b){const h=Bo.Xb.isFeatureEnabled(49);return!b.KHc&&h&&!aa.a.Gt&&Bo.aDf&&b.LH}static cfg(b){return w.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")&&!b.Sbc()}static Nsj(b){return w.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&!b.M2a&&!b.Sbc()}static axo(b){return b.XBi()&&
w.AFrameworkApplication.ta.Nb.LVc}static Wsj(){return 2===Jl.App.sn.mode}static uzo(b){return b.LH}lFn(b,h,v,D){this.ulb[D].forEach(P=>{const ca=Object.assign(new ih.a,{ControlList:[]}),ta=ca.ControlList;P.forEach(Ra=>{Ra instanceof pp?v.push(...this.Jfe.get(Ra)(b,h,this)):ta.push(...this.fE[Ra](b,h,this))});(null===ta||void 0===ta?0:ta.length)&&v.push(ca)})}wFn(){this.Jfe.set(pp.ZRb,aE.I9l);this.Jfe.set(pp.yqe,aE.iVl);this.Jfe.set(pp.lre,aE.Qdm)}xFn(){this.fE[rh.$qb]=Sp.cRl;this.fE[rh.pre]=Sp.Ffm;
this.fE[rh.qre]=Sp.Lfm;this.fE[rh.xqe]=Sp.WUl;this.fE[rh.Rqe]=Sp.V3l;this.fE[rh.jqe]=Sp.Cnf;this.fE[rh.Kqe]=Sp.O0l;this.fE[rh.ndd]=Sp.Aai;this.fE[rh.Jqe]=Sp.G_l;this.fE[rh.kre]=Sp.Idm;this.fE[rh.sre]=Sp.Jhm;this.fE[rh.Yqe]=Sp.s$l;this.fE[rh.are]=Sp.dbm;this.fE[rh.qdd]=Sp.v2l;this.fE[rh.tdd]=Sp.m8l;this.fE[rh.Zqe]=Sp.XRd;this.fE[rh.Zcd]=Sp.getContentControls;this.fE[rh.Mre]=Sp.wkm;this.fE[rh.zqe]=Sp.QVl;this.fE[rh.qqe]=Sp.rQl;this.fE[rh.rre]=Sp.yhm;this.fE[rh.pqe]=Sp.YPl;this.fE[rh.Xcd]=Sp.getBookmark;
this.fE[rh.Fqe]=Sp.QZl;this.fE[rh.Hqe]=Sp.Rga;this.fE[rh.Yqb]=Sp.HRl;this.fE[rh.ndd]=Sp.Aai;this.fE[rh.Aqe]=Sp.AWl}tym(){const b=[rh.Rqe,rh.jqe,rh.pre];this.ulb[Bu.Tug]=[[rh.$qb],b,[rh.Yqb],[pp.ZRb],[rh.Zcd]];this.ulb[Bu.Etg]=[[rh.$qb],[rh.qqe,rh.zqe,rh.Mre],b,[rh.Yqb],[pp.ZRb]];this.ulb[Bu.irg]=[[rh.Aqe],[rh.qdd,rh.tdd],[rh.Xcd,rh.Yqb],[pp.ZRb]];this.ulb[Bu.Erg]=[[rh.ndd],[rh.xqe],[pp.lre],[pp.yqe],[rh.$qb],[rh.Kqe,rh.Jqe,rh.kre,rh.sre],[rh.Yqe,rh.are,rh.tdd],[rh.qdd],b,[rh.Zcd],[rh.Hqe,rh.Xcd,rh.Fqe,
rh.Yqb],[rh.Zqe],[rh.rre],[rh.pqe],[rh.qre],[pp.ZRb]];this.ulb[Bu.wrg]=[[rh.$qb],[rh.Yqb]];this.ulb[Bu.brg]=[[rh.$qb],[rh.Jqe]];this.ulb[Bu.dQj]=[[rh.ndd],[rh.xqe],[pp.lre],[pp.yqe],[rh.$qb],[rh.qqe],[rh.zqe],[rh.Mre],[rh.Kqe],[rh.kre],[rh.sre],[rh.Yqe],[rh.are],[rh.Aqe],[rh.qdd],[rh.tdd],[rh.Hqe],[rh.Rqe],[rh.jqe],[rh.pre],[rh.Xcd],[rh.Fqe],[rh.Yqb],[rh.Zqe],[rh.Zcd],[rh.rre],[rh.pqe],[rh.qre],[pp.ZRb]]}}Object(n.a)(Bo,"EditSurfaceContextMenu",Wj,[]);var Bu;(function(b){b[b.Tug=1]="TABLE_MULTI_CELL";
b[b.Erg=2]="GENERIC";b[b.Etg=3]="PICTURE";b[b.irg=4]="EQUATION";b[b.dQj=5]="LEGACY";b[b.wrg=6]="FLUID";b[b.brg=7]="DRAWING"})(Bu||(Bu={}));Object(n.b)("Scenarios",Bu);class pp{}pp.ZRb=new pp;pp.yqe=new pp;pp.lre=new pp;Object(n.a)(pp,"Sections",null,[]);var rh;(function(b){b[b.ndd=1]="INTENT_SUGGESTION";b[b.$qb=2]="ESSENTIALS";b[b.Kqe=3]="INSIGHT";b[b.Jqe=4]="ILLUSTRATION";b[b.kre=5]="SMART_LOOKUP";b[b.sre=6]="TRANSLATE";b[b.Yqe=7]="PROOFING";b[b.are=8]="REWRITE_SUGGESTIONS";b[b.qdd=9]="LISTS";b[b.tdd=
10]="PARAGRAPH_OPTIONS";b[b.Rqe=11]="MERGE_SPLIT_CELLS";b[b.jqe=12]="ALT_TEXT";b[b.Hqe=13]="HYPERLINK";b[b.Xcd=14]="BOOKMARK";b[b.Fqe=15]="HEADING_LINK";b[b.Yqb=16]="COMMENT";b[b.Zqe=17]="PULL_QUOTE";b[b.Mre=18]="WRAP_TEXT";b[b.zqe=19]="DRAW";b[b.rre=20]="TRACK_CHANGE";b[b.pqe=21]="CATCHUP_ACTIVITIES";b[b.qre=22]="TABLE_OF_CONTENTS";b[b.xqe=23]="DESIGNER_REVIEW";b[b.pre=24]="TABLE_ITEMS";b[b.qqe=25]="CHANGE_PICTURE";b[b.Aqe=26]="EQUATION_TOOLS";b[b.Zcd=27]="CONTENT_CONTROL"})(rh||(rh={}));Object(n.b)("SectionItem",
rh);class kD extends Nx.a{constructor(b,h,v){super();this.vl=null;this.dae=(D,P,ca,ta,Ra)=>{if(1===ca)return 32;D=[];P=[];this.$uo()&&P.push("InsertTabStopMenuSplitButton");this.Kuo()&&P.push("ClearAllTabStops");P.push("HideRuler");D.push(kD.XQd(P));P=Object.assign(new Yd.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});P.MenuSectionList.push(...D);Ra.MenuItems=P;return 32};this.ga=b;this.Vm=h;this.Wy=v;this.Tb()}get qab(){return document.getElementById("WACHorizontalRuler")}get zN(){return this.Vm&&
this.Vm.instance?this.Vm.instance.jj:1}get target(){return this.vl}show(b,h){this.vl=b;Nx.a.Zob("RulerContextMenu",b,h);u.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",kD.aP);b.set("Response","Ruler Context menu invoked.");va.Health.instance.recordKpiUsage(kD.kpiName,1,kD.h8,b)}xam(){var b=0,h=(this.target.x-Dd.a.eof(this.qab))/this.zN;h=Ef.a.Fy(h,0);var v={},D=this.Wy.K6b,P=he.GraphIterator.$a(D);P.vd();if(!cj.TableReader.ex(P))return 32===
this.ga.Qb(Gb.a.SGa,2,v)&&(b=v.marginLeft),h-b;b={};P={};v=this.ga.Qb(Gb.a.v3c,2,b);var ca=this.ga.Qb(Gb.a.AMb,2,P);if(32!==v||32!==ca)return u.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),h;b=b.ColumnWidths;ca=P.TablePosition;if(!ca||!b||0>=b.length)return u.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),h;v=0;P=he.GraphIterator.$a(D);P.zb(14)&&(P.jd(16),v=Dt.a(P,!0));D=ca.x/this.zN;for(P=0;P<v;P++)D+=b[P];return h-
D}Tb(){this.ga.eb(Nc.a.dae,sc.a.application,this.dae,96)}$uo(){var b={},h={},v=this.ga.Qb(Gb.a.SGa,2,b),D=this.ga.Qb(Gb.a.w5a,2,h);if(32===v&&32===D){D=h.Ft;v=Ef.a.Ji(D.joa,0);D=1===D.specialIndentType?Ef.a.Ji(D.AB,0):Ef.a.Ji(D.AB-D.vda,0);const P=Ef.a.Ji(b.marginLeft,0);b=Ef.a.Ji(b.marginRight,0);const ca=Dd.a.eof(this.qab),ta=Dd.a.t5h(this.qab);h.isRtl?(h=ca+this.zN*Math.max(b,b+v),v=ta-this.zN*Math.max(P,P+D)):(h=ca+this.zN*Math.max(P,P+D),v=ta-this.zN*Math.max(b,b+v));if(this.target.x>=h&&this.target.x<=
v)return!0}return!1}Kuo(){var b={};if(32!==this.ga.Qb(Nc.a.nMb,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static XQd(b){const h=Object.assign(new ih.a,{ControlList:[]});for(const v of b)h.ControlList.push(Object.assign(new mg.a,{ExternalId:v}));return h}}kD.h8="wwaengidc";kD.kpiName="WordRuler";kD.aP="RulerContextMenu";Object(n.a)(kD,"RulerContextMenu",Nx.a,[347]);let DB;class Oq{static get uc(){return null!=Oq.TJg?Oq.TJg:Oq.TJg=Ea.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get lE(){return null!=
Oq.LJg?Oq.LJg:Oq.LJg=Ea.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get tj(){return null!=Oq.vBg?Oq.vBg:Oq.vBg=Ea.a.instance.resolve("Box4.IInsertionPointFormatting")}static c5i(b,h,v){if(1===h)return(b?Oq.MTk(v):Oq.jTk(v))?32:8;(b=Oq.Hem(b,v))&&Oq.WFk(b,v);return 32}static WFk(b,h){const v=new eh.GraphTransaction(15);v.Cb(h);Oq.tj.W5a();Oq.lE.RJ(b,h,!1);v.dispose()}static MTk(b){b=Oq.uc.No(b);return!!b&&Oq.uc.kg(b)!==fk.StyleReader.wordStyleIdHeading1}static jTk(b){b=Oq.uc.No(b);return!!b&&
Oq.uc.kg(b)!==fk.StyleReader.z8a}static Hem(b,h){const v=Oq.uc.No(h);return v?Oq.uc.NC(h).Di(Oq.Fem(b,Oq.uc.kg(v))):null}static Fem(b,h){h=Oq.headingsList.indexOf(h);b=b?h-1:h+1;return 0<=b&&b<Oq.headingsList.count?Oq.headingsList.J(b):null}}Oq.headingsList=(DB=new Fb.a,DB.add(fk.StyleReader.wordStyleIdHeading1),DB.add(fk.StyleReader.wordStyleIdHeading2),DB.add(fk.StyleReader.wordStyleIdHeading3),DB.add(fk.StyleReader.w8a),DB.add(fk.StyleReader.x8a),DB.add(fk.StyleReader.y8a),DB.add(fk.StyleReader.Pqb),
DB.add(fk.StyleReader.Qqb),DB.add(fk.StyleReader.z8a),DB);Object(n.a)(Oq,"NavigationPaneEditor",null,[]);class EF extends Nx.a{constructor(){super();this.y3=null;this.V$d=(b,h,v,D,P)=>{if(1===v)return 32;b=new Sys.StringBuilder;b.append(String.format('<Menu Id="{0}">',"mnuNavPaneWordEditor"));b.append('<MenuSection Id="msWordEditorHeadings" DisplayMode="Menu16"><Controls>');b.append(Nx.a.i3h("promoteHeading",Nc.a.Rae,"LeftArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_PromoteHeadingText));b.append(Nx.a.i3h("demoteHeading",
Nc.a.LId,"RightArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_DemoteHeadingText));b.append("</Controls></MenuSection></Menu>");P.PopulationXML=b.toString();return 32};this.Rae=(b,h,v)=>Oq.c5i(!0,v,this.y3.Bb);this.LId=(b,h,v)=>Oq.c5i(!1,v,this.y3.Bb)}show(b){EF.Zh||(this.U3b(),EF.Zh=!0);Nx.a.showContextMenu("mnuNavPaneWordEditor",b)}U3b(){const b={PopulateDynamically:"true",PopulateOnlyOnce:"false"};b.PopulateQueryCommand=""+Nc.a.H2i;b.Command=""+Wa.a.Sla;Nx.a.A$k(b);w.AFrameworkApplication.va.qa(Nc.a.H2i,
sc.a.application,this.V$d);w.AFrameworkApplication.va.qa(Nc.a.Rae,sc.a.view,this.Rae);w.AFrameworkApplication.va.qa(Nc.a.LId,sc.a.view,this.LId)}}EF.Zh=!1;Object(n.a)(EF,"WordEditorNavigationPaneContextMenu",Nx.a,[346]);var Ox=c(278),yC=c(1475),XL=c(448),YL=c(740),cG=c(1189),RG=c(1702),SG=c(998);class dG{constructor(){this.I8=this.wyi=!1;this.jQb=2;this.vw=0;this.E8a=1}}Object(n.a)(dG,"WrapTextPropertiesData",null,[]);class Ul extends cG.a{constructor(b=null){super(b);this.Leh=new RG.a;this.bmh=new dG;
this.lih=new SG.a;this.WCe=!1;this.zpi=h=>{const v=new Ox.a;v.TDa=!0;v.aM=h;return v};this.S0=()=>{const h=new Ox.a;h.cGb=!1;h.aM=Gb.a.SGa;h.xd=this.Leh;h.Fbc=!0;h.xha=!0;return h};this.a6i=()=>{const h=new Ox.a;h.cGb=this.WCe;this.WCe=!0;h.aM=Gb.a.x5a;h.xd=this.lih;h.Fbc=!0;h.xha=!0;return h};this.Bcd=()=>{const h=new Ox.a;h.cGb=!1;h.aM=Nc.a.ahc;h.xd=this.bmh;h.Fbc=!0;h.xha=!0;return h};this.gWd=(h,v)=>{const D=new Ox.a;D.xd=new Md.DictionaryPropertySet;switch(h){case Nc.a.eSc:D.xd.setValue(Wc.a.Yib,
v[mj.a.Number]);break;case Nc.a.YRc:D.xd.setValue(Wc.a.Vib,v[mj.a.Number]);break;case Nc.a.ZRc:D.xd.setValue(Wc.a.Wib,v[mj.a.Number]);break;case Nc.a.$Rc:D.xd.setValue(Wc.a.Xib,v[mj.a.Number])}return D};this.wMn=()=>{const h=new Ox.a;h.xd=new Md.DictionaryPropertySet;h.xha=!0;return h}}initialize(){super.initialize();this.kd.Z(Nc.a.RIf,yC.a.hjb);this.kd.Z(Nc.a.WIf,yC.a.hjb);this.kd.Z(Nc.a.YIf,yC.a.hjb);this.kd.Z(Nc.a.V1f,Ul.hSa);this.kd.Z(Nc.a.o3c,Ul.hSa);this.kd.Z(Nc.a.O1f,Ul.hSa);this.kd.Z(Wa.a.DMb,
Ul.hSa);this.kd.Z(Gb.a.Bbe,this.S0);this.kd.Z(Gb.a.Abe,this.S0);this.kd.Z(Gb.a.zbe,this.S0);this.kd.Z(Gb.a.Dbe,this.S0);this.kd.Z(Gb.a.Cbe,this.S0);this.kd.Z(Gb.a.ybe,this.S0);this.kd.Z(Gb.a.Kbe,this.S0);this.kd.Z(Gb.a.Jbe,this.S0);this.kd.Z(Gb.a.Ibe,this.S0);this.kd.Z(Gb.a.Fbe,this.S0);this.kd.Z(Gb.a.Gbe,this.S0);this.kd.Z(Gb.a.Hbe,this.S0);this.kd.Z(Gb.a.h2f,this.S0);this.kd.Z(Gb.a.g2f,this.S0);this.kd.Z(Gb.a.x1f,this.S0);this.kd.Z(Gb.a.z1f,this.S0);this.kd.Z(Gb.a.y1f,this.S0);this.kd.Z(Gb.a.w1f,
this.S0);this.kd.Z(Gb.a.G6a,Ul.uan);this.kd.Z(Gb.a.iTa,Ul.bAn);this.kd.Z(Gb.a.rob,Ul.w1k);this.kd.Z(Gb.a.Yla,Ul.hSa);this.kd.Z(Gb.a.NLb,Ul.hSa);this.kd.Z(Gb.a.kSa,Ul.hSa);this.kd.Z(Gb.a.Tta,Ul.hSa);this.kd.Z(Gb.a.$xa,Ul.hSa);this.kd.Z(Nc.a.Y1c,Ul.hSa);this.kd.Z(Nc.a.hNd,yC.a.Llf);this.kd.Z(Nc.a.iNd,this.S3h);this.Mm.Z(Nc.a.W1c,yC.a.aOa);this.Mm.Z(Nc.a.X1c,yC.a.aOa);this.kd.Z(Gb.a.DOb,yC.a.p0a);this.kd.Z(Gb.a.COb,yC.a.p0a);this.kd.Z(Gb.a.Gob,yC.a.p0a);this.kd.Z(Gb.a.t2f,this.tF);this.kd.Z(Gb.a.r2f,
this.tF);this.kd.Z(Gb.a.s2f,this.tF);this.kd.Z(Gb.a.tL,Ul.PKn);this.Mm.Z(Nc.a.lce,Ul.r4c);this.Mm.Z(Nc.a.mce,Ul.r4c);this.Mm.Z(Nc.a.nce,Ul.r4c);this.Mm.Z(Nc.a.jce,Ul.r4c);this.Mm.Z(Nc.a.kce,Ul.r4c);this.kd.Z(Nc.a.lce,this.Bcd);this.kd.Z(Nc.a.mce,this.Bcd);this.kd.Z(Nc.a.nce,this.Bcd);this.kd.Z(Nc.a.jce,this.Bcd);this.kd.Z(Nc.a.kce,this.Bcd);this.kd.Z(Nc.a.Wpe,Ul.Hnc);this.kd.Z(Nc.a.Xpe,Ul.Hnc);this.kd.Z(Nc.a.Ype,Ul.Hnc);this.kd.Z(Nc.a.Zpe,Ul.Hnc);this.kd.Z(Nc.a.$pe,Ul.Hnc);this.kd.Z(Nc.a.aqe,Ul.Hnc);
this.kd.Z(Nc.a.MHa,Ul.a7b);this.kd.Z(Nc.a.osj,Ul.a7b);this.kd.Z(Nc.a.psj,Ul.a7b);this.kd.Z(Nc.a.Yie,Ul.a7b);this.kd.Z(Nc.a.Zie,Ul.a7b);this.kd.Z(Nc.a.I8c,Ul.a7b);this.kd.Z(Nc.a.tnb,this.wMn);this.kd.Z(Nc.a.Z2c,Ul.QNd);this.kd.Z(Nc.a.rbe,Ul.QNd);this.kd.Z(Nc.a.sbe,Ul.QNd);this.kd.Z(Nc.a.tbe,Ul.QNd);this.kd.Z(Nc.a.eSc,this.gWd);this.kd.Z(Nc.a.YRc,this.gWd);this.kd.Z(Nc.a.ZRc,this.gWd);this.kd.Z(Nc.a.$Rc,this.gWd);this.kd.Z(Gb.a.boa,this.zpi);this.kd.Z(Gb.a.uCb,this.zpi);this.kd.Z(Nc.a.rnb,Ul.rnb);this.kd.Z(Nc.a.gje,
yC.a.p0a);this.kd.Z(Gb.a.y2f,this.a6i);this.kd.Z(Gb.a.z2f,this.a6i)}clearCache(){super.clearCache();this.WCe=!1;this.Leh=new RG.a;this.bmh=new dG;this.lih=new SG.a}qpf(){const b=super.qpf();b.oCa=Ul.oCa;b.qZa=Ul.qZa;return b}static get Czn(){return null!=Ul.hFg?Ul.hFg:Ul.hFg=Ea.a.instance.Na("WordEditor.IPageCommandStringBuilder")}static get Kz(){Ul.lta||(Ul.lta=Ea.a.instance.Na("WordEditor.ITableBorderManager"));return Ul.lta}static hSa(b,h){b=new Ox.a;b.xd=h;return b}static w7c(b,h,v){h[If.a.Description]=
b?b.qan(v):null}static oCa(b,h){const v=Object(Na.a)(RG.a,b.xd),D=Object(Na.a)(XL.a,b.xd),P=Object(Na.a)(dG,b.xd),ca=Object(Na.a)(SG.a,b.xd);let ta=!0;const Ra=Ul.Czn;switch(b.Hmb){default:ta=cG.a.oCa(b,h);break;case Gb.a.Bbe:h[ph.a.Icon]=v.Hwa?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";h[If.a.On]=!v.GJb;Ul.w7c(Ra,h,0);break;case Gb.a.Abe:h[ph.a.Icon]=v.Hwa?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";h[If.a.On]=1===v.GJb;Ul.w7c(Ra,h,1);break;case Gb.a.zbe:h[ph.a.Icon]=
v.Hwa?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";h[If.a.On]=2===v.GJb;Ul.w7c(Ra,h,2);break;case Gb.a.Dbe:h[ph.a.Icon]=v.Hwa?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";h[If.a.On]=3===v.GJb;Ul.w7c(Ra,h,3);break;case Gb.a.Cbe:h[ph.a.Icon]=v.Hwa?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";h[If.a.On]=4===v.GJb;Ul.w7c(Ra,h,4);break;case Gb.a.ybe:h[ph.a.Icon]=v.Hwa?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";h[If.a.On]=
5===v.GJb;break;case Gb.a.Kbe:h[If.a.On]=!v.kLb;h[If.a.Description]=Ra?Ra.a1c(0):null;break;case Gb.a.Jbe:h[If.a.On]=1===v.kLb;h[If.a.Description]=Ra?Ra.a1c(1):null;break;case Gb.a.Ibe:h[If.a.On]=2===v.kLb;h[If.a.Description]=Ra?Ra.a1c(2):null;break;case Gb.a.Fbe:h[If.a.On]=3===v.kLb;h[If.a.Description]=Ra?Ra.a1c(3):null;break;case Gb.a.Gbe:h[If.a.On]=4===v.kLb;h[If.a.Description]=Ra?Ra.a1c(4):null;break;case Gb.a.Hbe:h[If.a.On]=5===v.kLb;break;case Gb.a.h2f:h[If.a.On]=!v.Hwa;break;case Gb.a.g2f:h[If.a.On]=
v.Hwa;break;case Gb.a.x1f:h[If.a.On]=1===v.gHc;break;case Gb.a.z1f:h[If.a.On]=2===v.gHc;break;case Gb.a.y1f:h[If.a.On]=3===v.gHc;break;case Gb.a.w1f:h[If.a.On]=0===v.gHc;break;case Gb.a.t2f:h[If.a.On]=D.Ft?!D.Ft.specialIndentType:!1;break;case Gb.a.r2f:h[If.a.On]=D.Ft?1===D.Ft.specialIndentType:!1;h[Hl.a.Image16by16Class]=D.isRtl?Xc.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):Xc.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case Gb.a.s2f:h[If.a.On]=D.Ft?2===D.Ft.specialIndentType:
!1;h[Hl.a.Image16by16Class]=D.isRtl?Xc.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):Xc.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case Nc.a.lce:h[If.a.On]=1===P.E8a;break;case Nc.a.mce:h[If.a.On]=8===P.E8a;break;case Nc.a.nce:h[If.a.On]=9===P.E8a;break;case Nc.a.jce:h[If.a.On]=3===P.E8a;break;case Nc.a.kce:h[If.a.On]=4===P.E8a;break;case Nc.a.tnb:h[If.a.On]=b.xd.ia(Wc.a.Dwa,!1);break;case Nc.a.rnb:h[Jm.a.IsFreeForm]=!0;h[Jm.a.Value]=b.xd[cn.a.Value];break;case Gb.a.y2f:h[ri.a.On]=
Ul.Kz.r5h(h.MenuItemId)===ca.lineStyle;break;case Gb.a.z2f:h[ri.a.On]=Ul.Kz.s5h(h.MenuItemId)===ca.UXc}return ta}static uan(b,h){b=5;switch(h.MenuItemId){case "buttonMarginsNormal":b=0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}h=new Ox.a;h.xd=b;return h}static bAn(b,h){b=5;switch(h.MenuItemId){case "buttonSizeLetter":b=0;break;case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=
2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}h=new Ox.a;h.xd=b;return h}static w1k(b,h){b=0;switch(h.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=2;break;case "buttonThreeColumns":b=3}h=new Ox.a;h.xd=b;return h}static rnb(){const b=new Ox.a;b.aM=Nc.a.rnb;b.xd={};b.xha=!0;b.Fbc=!0;return b}static Hnc(b,h){const v=new Ox.a;v.xd=new Md.DictionaryPropertySet;let D=1;switch(b){case Nc.a.Zpe:D=1;break;case Nc.a.$pe:D=8;break;case Nc.a.aqe:D=9;break;case Nc.a.Xpe:D=
3;break;case Nc.a.Ype:D=4}v.xd.setValue(Wc.a.E8a,D);v.xd.setValue(Wc.a.THa,h[If.a.SourceControlId]);return v}static a7b(b,h,v){b=new Ox.a;b.xd=v.InvocationMethod;return b}static PKn(b,h){b=new Ox.a;b.xd=h;return b}static r4c(){const b=new YL.a;b.aM=Nc.a.ahc;return b}static QNd(){const b=new Ox.a;b.xd=new Md.DictionaryPropertySet;b.JVc=!0;return b}static qZa(b,h){let v=!0;switch(b.Hmb){case Nc.a.Z2c:b=b.xd.ia(Wc.a.Yib,0);h[mj.a.Number]=b;h[mj.a.UnitType]=7;break;case Nc.a.rbe:b=b.xd.ia(Wc.a.Vib,0);
h[mj.a.Number]=b;h[mj.a.UnitType]=7;break;case Nc.a.sbe:b=b.xd.ia(Wc.a.Wib,0);h[mj.a.Number]=b;h[mj.a.UnitType]=7;break;case Nc.a.tbe:b=b.xd.ia(Wc.a.Xib,0);h[mj.a.Number]=b;h[mj.a.UnitType]=7;break;default:v=cG.a.qZa(b,h)}return v}}Ul.lta=null;Object(n.a)(Ul,"CuiActionBridge",cG.a,[]);class TG extends bg.a{constructor(b){super();this.R1k=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.Kro=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;this.TId=this.zxb=this.m6=this.ZWa=this.oSe=null;this.Ub=
b;this.Yg="<div id='AccessibilityHelpDialogBody'></div>";this.wg="AAccessibilityHelpDialog";this.Ad=6;this.Ee(0,CommonUIStrings.l_DialogClose)}get Mef(){return null}get iie(){this.oSe||(this.oSe=this.Gzm());return this.oSe}get MHo(){return 300}get APi(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get zPi(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get C_a(){return this.Ub.Ts()}aTa(b){super.aTa(b);this.WEn()}tTa(){this.showDialog(this.dialogTitle,Object(z.a)(this,this.gqk,
"accHelpDialogResultHandler"));this.$Ga();this.setFocus()}setFocus(){this.m6?(this.zxb=this.m6.tBodies[0].firstChild,this.W0(this.zxb)):this.$G&&"none"!==this.$G.style.display?this.W0(this.$G):this.W0(this.Rz)}bma(){this.ae.nb(Ed.a.ai,this.TId,Object(z.a)(this,this.wmh,"accHelpDialogKeydownHandler"));if(this.m6){this.ae.nb(Ed.a.uh,this.m6,Object(z.a)(this,this.nyj,"tableOnKeyUpHandler"));const b=this.m6.tBodies[0].children;for(let h=0;h<b.length;h++)if(Le.a.addHandler(b[h],Ed.a.focus,Object(z.a)(this,
this.kgj,"rowOnFocusHandler")),Le.a.addHandler(b[h],Ed.a.blur,Object(z.a)(this,this.jgj,"rowOnBlurHandler")),aa.a.Gt){const v=b[h].children;for(let D=0;D<v.length;D++)Le.a.addHandler(v[D],Ed.a.focus,Object(z.a)(this,this.lCh,"cellOnFocusHandler"))}}super.bma()}Qfb(){this.ae&&(this.ae.sc(Ed.a.ai,this.TId,Object(z.a)(this,this.wmh,"accHelpDialogKeydownHandler")),this.m6&&this.ae.sc(Ed.a.uh,this.m6,Object(z.a)(this,this.nyj,"tableOnKeyUpHandler")));if(this.m6){const b=this.m6.tBodies[0].children;for(let h=
0;h<b.length;h++)if(Le.a.removeHandler(b[h],Ed.a.focus,Object(z.a)(this,this.kgj,"rowOnFocusHandler")),Le.a.removeHandler(b[h],Ed.a.blur,Object(z.a)(this,this.jgj,"rowOnBlurHandler")),aa.a.Gt){const v=b[h].children;for(let D=0;D<v.length;D++)Le.a.removeHandler(v[D],Ed.a.focus,Object(z.a)(this,this.lCh,"cellOnFocusHandler"))}}super.Qfb()}$Ga(){this.C_a.scope.jr(this.Ub.uW);this.C_a.scope.jr(this.Ub.vW);this.C_a.scope.bindAction(this.Ub.uW,Wa.a.yDc);this.C_a.scope.bindAction(this.Ub.vW,Wa.a.xDc)}Lpm(b){if(!this.C_a.fk||
!this.C_a.fk.y3)return 2;var h=this.C_a.fk.y3;if(this.m6&&(h===this.Rz&&b===Wa.a.yDc||h===this.ZWa&&b===Wa.a.xDc))this.W0(this.zxb);else if(h.id.startsWith("SelectableTableRow"))h=null,b===Wa.a.yDc?h=this.ZWa:b===Wa.a.xDc&&(h=this.Rz),h&&this.W0(h);else if(b===Wa.a.yDc)this.C_a.jec();else if(b===Wa.a.xDc)this.C_a.hec();else return 2;return 32}kgj(b){b.target.setAttribute(cf.a.Xdb,cf.a.lp);Sys.UI.DomElement.removeCssClass(this.zxb,"inactiveRowSelection");this.zxb=b.target}jgj(b){b.target.removeAttribute(cf.a.Xdb);
Sys.UI.DomElement.addCssClass(b.target,"inactiveRowSelection")}lCh(b){(b=b.target.parentNode)&&b!==this.zxb&&this.W0(b)}nyj(b){return b.Hb.keyCode===Ve.a.Fs?(b.Hb.stopPropagation(),!0):!1}wmh(b){if(!b.Hb)return!1;const h=b.Hb.keyCode;if(b.eventName===Ed.a.ai){b=this.r0l(this.zxb);let v=-1;const D=jb.a.count(this.iie)-1;h===Sys.UI.Key.down?v=b<D?b+1:0:h===Sys.UI.Key.up?v=0<b?b-1:D:h===Sys.UI.Key.home?v=0:h===Sys.UI.Key.end&&(v=D);-1!==v&&this.W0(this.m6.tBodies[0].children[v])}return!0}gqk(){}WEn(){this.TId=
document.getElementById("AccessibilityHelpDialogBody")||this.Xp;this.cfl();this.Iel();this.ucl()}cfl(){if(this.Mef){var b=document.createElement("div");b.className="WACDialogSubtitle";var h=document.createElement("span");h.innerText=this.Mef;b.appendChild(h);this.mka.appendChild(b)}}Iel(){if(this.iie&&!jb.a.isEmpty(this.iie)){this.m6=document.createElement("table");this.m6.className="SelectableDialogTable";var b=document.createElement("thead"),h=document.createElement("tr");h.setAttribute(cf.a.qh,
cf.a.ZEc);b.appendChild(h);var v=ic.a.uIc(14,this.R1k);h.appendChild(v);v=ic.a.uIc(14,this.Kro);h.appendChild(v);this.m6.appendChild(b);b=document.createElement("tbody");h=0;v=this.iie;for(let ca in v){var D=ca,P=v[ca];const ta=document.createElement("tr");ta.tabIndex=0;ta.setAttribute(cf.a.qh,cf.a.ZEc);ta.id="SelectableTableRow"+h++;D=ic.a.uIc(15,D);ta.appendChild(D);P=ic.a.uIc(15,P);ta.appendChild(P);b.appendChild(ta)}b.style.maxHeight=this.MHo+"px";this.m6.appendChild(b);this.TId.appendChild(this.m6)}}ucl(){if(this.zPi&&
this.APi){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.ZWa=document.createElement("a");this.ZWa.innerText=this.zPi;this.ZWa.href=this.APi;this.ZWa.target="_blank";this.ZWa.id=this.mj("AccessibilityHelpDialogLink");this.ZWa.className=Ne.AFrame.X0e;b.appendChild(this.ZWa);this.Hc.insertBefore(b,this.Hc.lastChild)}}r0l(b){return Number.parseInvariant(b.id.substr(18))}SZ(b,h,v,D=null){b&&h&&v&&(v=D?String.format(v,D):v,b[h]=v)}fhi(b,h){return aa.a.Wk?h:b}}Object(n.a)(TG,
"AAccessibilityHelpDialog",bg.a,[953]);class cE extends TG{constructor(b){super(b)}get dialogTitle(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get Mef(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}Gzm(){const b=this.fhi(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),h=this.fhi(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),v={};this.SZ(v,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);
this.SZ(v,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,b);this.SZ(v,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);this.SZ(v,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,h);this.SZ(v,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,b);this.SZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,b);this.SZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,b);this.SZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);this.SZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,
b);this.SZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,b);this.SZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,b);this.SZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,b);this.SZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,b);this.SZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,b);this.SZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstShortcut,b);w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&this.SZ(v,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,
CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);w.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&this.SZ(v,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(cE.Xb&&cE.Xb.isFeatureEnabled(62)||w.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled"))&&this.SZ(v,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);
return v}static get Xb(){return null!=cE.jzg?cE.jzg:cE.jzg=Ea.a.instance.Na("Box4.IFeatureHelper")}}Object(n.a)(cE,"AccessibilityHelpDialog",TG,[]);var UH=c(327);class eG{static get Yg(){return bg.a.vA(eG.Km,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}eG.Km="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";
Object(n.a)(eG,"ApplyStylesDialogHtml",null,[]);class HE extends bg.a{constructor(b,h){super();this.nH=null;this.VBc=!1;this.Kyb=this.o9a=this.pyc=this.syc=this.kCc=null;this.BGk=(v,D)=>{if(this.mh.lv){if(v){v=D.styleList;D=D.styleText;if(-1===v||G.a.Ug(D)!==G.a.Ug(this.nH[v]))v=this.zhi(D);D=this.nH[v];v=this.uc.Qr();D=this.uc.kg(v.GEa(D));w.AFrameworkApplication.va.Mf(this._context,Gb.a.applyStyle,2,!1,new UH.a,D)}this.mh.z5()}};this.Svn=v=>{this.VBc?(this.VBc=!1,this.validate()):"value"===v.rawEvent.propertyName&&
(this.VBc=!0,this.MZ.value!==this.kCc&&(this.kCc=this.MZ.value,this.lwh()))};this.frn=()=>{-1!==this.xla.selectedIndex&&(aa.a.n4&&(this.VBc=!0),this.kCc=this.nH[this.xla.selectedIndex],this.MZ.value=this.nH[this.xla.selectedIndex],this.validate())};this.onKeyDown=v=>{aa.a.UJ?v.keyCode!==Ve.a.fC&&v.keyCode!==Ve.a.z1||this.o9a||this.Kyb||(this.Kyb=new qf.a(0,1,1,this.F2o),w.AFrameworkApplication.nc.Vb(this.Kyb)):aa.a.n4&&v.keyCode===Ve.a.fC&&(this.VBc=!0)};this.HG=()=>{this.o9a||(this.o9a=new qf.a(0,
1,1,this.dJk),w.AFrameworkApplication.nc.Vb(this.o9a));this.Kyb&&(w.AFrameworkApplication.nc.Xe(this.Kyb),this.Kyb=null)};this.dJk=()=>{this.o9a=null;this.lwh()};this.F2o=()=>{this.Kyb=null;this.validate()};this._context=b;this.ld=h;this.wg="ApplyStylesDialog";this.mh=this._context.view;this.Auf();b=this.tFo();h="";this.nH.length>b&&(h=this.nH[b]);h={["styleText"]:h,["styleList"]:b};this.Yg=eG.Yg;this.Wh(WordEditorIntl.WordEditorStrings.l_ApplyStyles,this.BGk,h);this.xla=document.getElementById("styleList");
this.h_f();this.xla.selectedIndex=b;this.MZ=document.getElementById("styleText");this.MZ.focus();this.MZ.select();this.qqd=this.frn;Le.a.addHandler(this.xla,"change",this.qqd);this.pqd=this.onKeyDown;Le.a.addHandler(this.MZ,"keydown",this.pqd);aa.a.n4?(this.syc=this.Svn,Le.a.addHandler(this.MZ,"propertychange",this.syc),this.kCc=this.nH[b]):(this.pyc=this.HG,Le.a.addHandler(this.MZ,"keypress",this.pyc))}get uc(){return null!=this.UJg?this.UJg:this.UJg=Ea.a.instance.resolve("Box4.Styles.IWACStyleReader")}tFo(){var b=
this.mh.lb;if(!b||!b.gb)return Kc.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.gb.kb;if(!b)return Kc.b(579216409,3018,15,"CurrentSelection is null"),0;fe.ParagraphReader.lm(b.Oa)&&(b=$e.SelectionEditor.Cj(b,!0,!1));b=b.Oa;if(!b||!$e.SelectionEditor.mv(b))return Kc.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!b),0;var h=Kl.FormattingReader.Nr(b);(h=Kl.FormattingReader.Sna(h))||(h=this.uc.No(b.node));if(!h)return 0;b=this.uc.UQ(h);b=Array.indexOf(this.nH,
b);0>b&&(b=0);return b}h_f(){const b=this.nH.length;for(let h=0;h<b;h++){const v=document.createElement("OPTION");v.value=h.toString();v.text=this.nH[h];this.xla.add(v,null)}}Auf(){var b=dl.a.Pr();if(b){b=(new xq.WACStyleSet).VQ(b);var h=b.kO,v=this.ld.isFeatureEnabled(111)&&!!this.uc.Gg;this.nH=[];for(let D=0;D<h;D++){const P=b.FEa(D);if(this.uc.isHidden(P))continue;const ca=this.uc.AG(P);if(!v){if(3===ca)continue}else if(3===ca&&this.uc.kg(P)===Ys.a.Wpg)continue;Array.add(this.nH,this.uc.UQ(P))}this.nH.sort(HE.z3k)}else Kc.b(577644352,
3018,15,"Couldn't find PageContentNode")}dispose(){this.syc&&Le.a.removeHandler(this.MZ,"propertychange",this.syc);this.pqd&&Le.a.removeHandler(this.MZ,"keydown",this.pqd);this.qqd&&Le.a.removeHandler(this.xla,"change",this.qqd);this.pyc&&Le.a.removeHandler(this.MZ,"keypress",this.pyc);this.o9a&&w.AFrameworkApplication.nc.Xe(this.o9a);this.o9a=this.pyc=this.xla=this.MZ=this.pqd=this.syc=this.qqd=null;super.dispose()}lwh(){var b=this.MZ.value,h=this.zxm(b);const v=-1===h?b:this.nH[h];b=b.length;const D=
v.length;this.kCc=v;this.MZ.value=v;this.xla.selectedIndex=h;D>b&&(aa.a.UJ?this.MZ.setSelectionRange(b,D):aa.a.n4&&(h=this.MZ.createTextRange(),h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",D-b),h.select()));this.validate();this.MZ.focus()}zxm(b){let h=0,v=this.nH.length,D=-1;for(b=G.a.Ug(b);h<v;){const P=Math.floor((h+v)/2),ca=HE.o9e(b,this.nH[P]);if(!ca){D=P;break}0<ca?h=P+1:v=P}if(D>h)for(;!HE.o9e(b,this.nH[D-1])&&(D--,D!==h););return D}validate(){const b=-1===this.zhi(this.MZ.value),
h=document.getElementById("badStyleError");b?(h.style.display="inline-block",h.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(h.style.display="none",h.innerText="");return!b}zhi(b){b=G.a.Ug(b);const h=this.nH.length;for(let v=0;v<h;v++)if(b===G.a.Ug(this.nH[v]))return v;return-1}static o9e(b,h){const v=Math.min(b.length,h.length);b=G.a.Ug(b);h=G.a.Ug(h);for(let D=0;D<v;D++){const P=G.a.charCodeAt(b,D),ca=G.a.charCodeAt(h,D);if(P!==ca)return P-ca}return b.length<=h.length?0:1}static z3k(b,
h){return HE.o9e(b,h)}}Object(n.a)(HE,"ApplyStylesDialog",bg.a,[]);var IE=c(316);class VH extends ug.StandardDialog{constructor(b){super();this.Cv=b;this.Nwo()}Nwo(){this.Ad=1;this.$U(1);this.Ee(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);this.Ou(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.fef.bind(this))}fef(b){1===b&&this.Cv.bja("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(h=>{h.Ai?Kc.b(524834400,
3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",h.exception,h.exception.stack):(this.u7n(),Kc.b(524834399,3018,50,"User deleted saved styles via UI."))},8)}u7n(){IE.a.Eqb="{}"}}Object(n.a)(VH,"DeleteSavedStylesConfirmationDialog",ug.StandardDialog,[]);class WH extends ug.StandardDialog{constructor(b,h){super();this.fef=P=>{if(1===P){P=new Map;P.set("Source","DeleteStyleConfirmationDialog");P.set("Action","DeleteStyle");va.Health.instance.recordKpiUsage(xp.a.xza,0,xp.a.tB,P);var ca=
dl.a.Pr();P=new eh.GraphTransaction(15);P.Cb(ca);P.jk=Gb.a.kCb;this.lE.JQh(this.Ehh)?Kc.b(578359694,3018,50,"User deleted a style via UI."):(ca=new Map,ca.set("Source","DeleteStyleConfirmationDialog"),ca.set("Action","DeleteStyle"),ca=Object.assign(new Bb.a,{extendedProperties:ca}),va.Health.instance.recordKpiFailure(xp.a.xza,"DeleteStyleFailed",!1,!0,ca),Kc.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));P.dispose()}};h||Kc.b(590128417,3018,10,"styleId is null");
let v=null,D=null;if(this.mh=b.view)D=this.mh.lb;D&&(v=D.gb.kb.Oa);v?(b=v.node)?(this.wK=this.Oh.Ys(b))?(this.Ehh=new Fb.a,this.Ehh.add(h),this.Owo(h)):Kc.b(590128448,3018,10,"_pageContenNode is null."):Kc.b(590128419,3018,10,"node is null."):Kc.b(590128418,3018,10,"nodeContext is null.")}get lE(){return null!=this.JJg?this.JJg:this.JJg=Ea.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get uc(){return null!=this.aKg?this.aKg:this.aKg=Ea.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Oh(){return null!=
this.vFg?this.vFg:this.vFg=Wk.PageNavigator.instance}Owo(b){const h=(new xq.WACStyleSet).VQ(this.wK);h?((b=h.Di(b))||Kc.b(590128450,3018,10,"Style set doesn't contain style with given ID"),b=this.uc.UQ(b),this.Ad=4,this.$U(2),this.Ou(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,b),0,this.fef)):Kc.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(n.a)(WH,"DeleteStyleConfirmationDialog",ug.StandardDialog,
[]);class fG{static get Yg(){return bg.a.vA(fG.Km)}}fG.Km="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(n.a)(fG,"DeleteStyleDialogHtml",null,[]);class XH extends bg.a{constructor(b){super();this.wK=this.nH=null;this.gll=(h,v)=>{this.mh.lv&&(h?(h=v.styleList,-1!==h&&(h=this.nH[h],v=this.uc.Qr(),h=this.uc.kg(v.GEa(h)),this.MJc.fll(this._context,h),this.mh.z5())):this.mh.z5())};this._context=b;this.wg="DeleteStyleDialog";this.Ad=
1;this.Ee(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.mh=this._context.view;this.Auf();this.Yg=fG.Yg;this.Wh(WordEditorIntl.WordEditorStrings.l_DeleteStyle,this.gll,{["styleList"]:0});this.xla=document.getElementById("styleList");this.h_f();this.xla.selectedIndex=0;this.xla.focus()}get uc(){return null!=this.WJg?this.WJg:this.WJg=Ea.a.instance.resolve("Box4.Styles.IWACStyleReader")}get MJc(){return null!=this.fyg?this.fyg:this.fyg=Ea.a.instance.resolve("WordEditor.UI.IDialogFactory")}h_f(){const b=
this.nH.length;for(let h=0;h<b;h++){const v=document.createElement("OPTION");v.value=h.toString();v.text=this.nH[h];this.xla.add(v,null)}}Auf(){if(this.wK=dl.a.Pr()){var b=(new xq.WACStyleSet).VQ(this.wK),h=b.kO;this.nH=[];for(let D=0;D<h;D++){const P=b.FEa(D);if(!this.uc.isHidden(P)&&this.uc.je(P,b)){var v=this.uc.AG(P);if(2===v||1===v)P.hasProperty(Bc.a.linkedStyle)&&2!==v||(v=P.ia(Bc.a.IK,null))&&0<v.length||this.nH.push(this.uc.UQ(P))}}this.nH.sort()}else Kc.b(578650370,3018,15,"PageContentNode is null")}}
Object(n.a)(XH,"DeleteStyleDialog",bg.a,[]);var ZL=c(763);class YH{constructor(b){this.customData=null;this.yO=b}}Object(n.a)(YH,"PropertySetChangedState",null,[]);class ZH{static dJn(b,h,v){if(b&&h){var D=new YH(h),P=(ca,ta,Ra)=>{v.cJn(ca,ta,Ra,D)};b=new ZL.a(h,b);b.bAd=P;b.sDd=P;b.Ude=P;b.Egc()}}}Object(n.a)(ZH,"PropertySetChangedManager",null,[]);class $H{constructor(b){this.VLa=b}cJn(b,h,v,D){const P=this.VLa[b.id.toString()];P&&P(b,h,v,D)}}Object(n.a)($H,"PropertyChangedProcessor",null,[]);const gG=
(b,h,v)=>{const D=Jr.a.instance.K6b;if(D){const P=new eh.GraphTransaction(15);P.Cb(D);ZH.dJn(b,h,new $H(v));P.dispose()}};class hG{static get Yg(){return bg.a.vA(hG.Km,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}hG.Km="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(n.a)(hG,"MarginsDialogHtml",null,[]);class wr{static get P4(){return null!=wr.iFg?wr.iFg:wr.iFg=Ea.a.instance.Na("WordEditor.IPageCommands")}static oan(b,h,v){wr.P4&&null!==v&&wr.P4.she(0,v)}static kan(b,h,v){wr.P4&&null!==v&&wr.P4.she(3,v)}static man(b,h,v){wr.P4&&null!==v&&wr.P4.she(1,v)}static nan(b,h,v){wr.P4&&null!==v&&wr.P4.she(2,v)}static lAn(b,h,v){wr.P4&&null!==v&&wr.P4.iTa(0,v)}static Mzn(b,h,v){wr.P4&&null!==v&&wr.P4.iTa(1,v)}static x1k(b,h,v){wr.P4&&null!==v&&(b==Pd.a.UE?wr.P4.zge(0,
v):b==Pd.a.hG?wr.P4.zge(1,v):b==Pd.a.sma?wr.P4.zge(2,v):b==Pd.a.separator&&wr.P4.zge(3,v))}}Object(n.a)(wr,"PageLevelPropertyChangedHandlers",null,[]);const aI=[Nc.a.C0c,Nc.a.B0c,Nc.a.e9d,Nc.a.f9d,Nc.a.xbe,Nc.a.ube,Nc.a.vbe,Nc.a.wbe];class qA extends bg.a{constructor(b,h,v,D,P){super();this.nNc=(ca,ta)=>{var Ra=qA.H2c(ca);ca=Xa.App.Iha;this.Fp.hasProperty(Ra)?(Ra=this.Fp.getValue(Ra),ta[mj.a.Number]=Df.a.p8a(Ra,ca)):ta[mj.a.Number]=0;ta[mj.a.UnitType]=ca};this.c7c=(ca,ta)=>{this.Fp.setValue(qA.H2c(ca),
Df.a.DIa(ta[mj.a.Number],ta[mj.a.UnitType]));this.wu.xm()};this.ran=ca=>{let ta=!1;1===ca&&(Math.abs(this.Fp.getValue(Bc.a.marginTop))+Math.abs(this.Fp.getValue(Bc.a.marginBottom))+Xa.App.wza<=this.yta.getValue(Bc.a.qv)&&this.Fp.getValue(Bc.a.marginLeft)+this.Fp.getValue(Bc.a.marginRight)+Xa.App.wza<=this.yta.getValue(Bc.a.Ao)?gG(this.HAa,this.Fp,qA.I8b()):ta=!0);this.dispose();ta&&this.BHa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.lan)};this.lan=()=>{Ea.a.instance.resolve("WordEditor.UI.IDialogFactory").nMh(this.HAa,
this.yta,this.F6)};this.wg="MarginsDialog";this.yta=h.clone();this.HAa=b.clone();this.Fp=b.clone();this.F6=v;this.OV=!1;this.wu=P;this.Yg=hG.Yg;v&&(this.qrc=Wr.a.vQb);this.Wh(WordEditorIntl.WordEditorStrings.L_PageMargins,this.ran,null);this.LSc();this.ITe=document.getElementById("DialogMarginTopSpinner");this.W0(this.ITe)}k9(){this.nCd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",Nc.a.C0c,Nc.a.xbe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.nCd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",Nc.a.B0c,Nc.a.ube,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.nCd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",Nc.a.e9d,Nc.a.vbe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.nCd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",Nc.a.f9d,Nc.a.wbe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}LSc(){for(const b of aI)Object(Ok.a)(b,this.c7c,this.nNc);this.wu.Npa("DialogMarginTopSpinner");
this.wu.Npa("DialogMarginBottomSpinner");this.wu.Npa("DialogMarginLeftSpinner");this.wu.Npa("DialogMarginRightSpinner")}dispose(){for(const b of aI)Object(Ok.b)(b);this.wu.BY("DialogMarginTopSpinner");this.wu.BY("DialogMarginBottomSpinner");this.wu.BY("DialogMarginLeftSpinner");this.wu.BY("DialogMarginRightSpinner");super.dispose()}nCd(b,h,v,D,P){v=qA.GOk(h,v,D,P);this.Ozb(v,b,h)}Ozb(b,h,v){h=document.getElementById(h);this.wu.YYa(v,b);b=this.wu.rEb(v,"Medium");h.appendChild(b)}static I8b(){return qA.VLa||
(qA.VLa=qA.i4b())}static i4b(){const b={};b[Bc.a.marginTop.id.toString()]=wr.oan;b[Bc.a.marginBottom.id.toString()]=wr.kan;b[Bc.a.marginLeft.id.toString()]=wr.man;b[Bc.a.marginRight.id.toString()]=wr.nan;return b}static GOk(b,h,v,D){let P=!0;if(h===Nc.a.C0c||h===Nc.a.B0c)P=!1;return Ii.j(b,h,v,D,[qA.IOk(P),qA.HOk(P)])}static IOk(b){return Ii.l("inch",b?"0":"-22","22",".1")}static HOk(b){return Ii.l("centimeter",b?"0":"-55.8","55.8","1")}static H2c(b){let h=null;switch(b){case Nc.a.C0c:case Nc.a.xbe:h=
Bc.a.marginTop;break;case Nc.a.B0c:case Nc.a.ube:h=Bc.a.marginBottom;break;case Nc.a.e9d:case Nc.a.vbe:h=Bc.a.marginLeft;break;case Nc.a.f9d:case Nc.a.wbe:h=Bc.a.marginRight}return h}}qA.VLa=null;Object(n.a)(qA,"MarginsDialog",bg.a,[]);class iG{static get Yg(){return bg.a.vA(iG.Km,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}iG.Km="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(n.a)(iG,"PaperSizeDialogHtml",null,[]);const bI=[Nc.a.i9d,Nc.a.h9d,Nc.a.Mbe,Nc.a.Lbe];class fu extends bg.a{constructor(b,h,v,D,P){super();this.nNc=(ca,ta)=>{var Ra=this.H2c(ca);ca=Xa.App.Iha;this.Fp.hasProperty(Ra)?(Ra=this.Fp.getValue(Ra),ta[mj.a.Number]=Df.a.p8a(Ra,ca)):ta[mj.a.Number]=0;ta[mj.a.UnitType]=ca};this.c7c=(ca,ta)=>{this.Fp.setValue(this.H2c(ca),Df.a.DIa(ta[mj.a.Number],ta[mj.a.UnitType]));this.wu.xm()};this.xAn=ca=>{let ta=!1;1===ca&&(this.Fp.getValue(Bc.a.qv)>=Xa.App.wza+this.yta.getValue(Bc.a.marginTop)+
this.yta.getValue(Bc.a.marginBottom)&&this.Fp.getValue(Bc.a.Ao)>=Xa.App.wza+this.yta.getValue(Bc.a.marginLeft)+this.yta.getValue(Bc.a.marginRight)?gG(this.HAa,this.Fp,fu.I8b()):ta=!0);this.dispose();ta&&this.BHa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.wAn)};this.wAn=()=>{Ea.a.instance.resolve("WordEditor.UI.IDialogFactory").SMh(this.HAa,this.yta,this.F6)};this.wg="PaperSizeDialog";this.yta=h.clone();this.HAa=b.clone();this.Fp=b.clone();this.F6=v;this.OV=!1;this.wu=P;this.Yg=iG.Yg;
v&&(this.qrc=Wr.a.vQb);this.Wh(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,this.xAn,null);this.LSc();this.ITe=document.getElementById("DialogWidthSpinner");this.W0(this.ITe)}k9(){this.Pyh("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",Nc.a.i9d,Nc.a.Mbe,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.Pyh("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",Nc.a.h9d,Nc.a.Lbe,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}LSc(){for(const b of bI)Object(Ok.a)(b,
this.c7c,this.nNc);this.wu.Npa("DialogWidthSpinner");this.wu.Npa("DialogHeightSpinner")}dispose(){for(const b of bI)Object(Ok.b)(b);this.wu.BY("DialogWidthSpinner");this.wu.BY("DialogHeightSpinner");super.dispose()}Pyh(b,h,v,D,P){v=fu.XOk(h,v,D,P);this.Ozb(v,b,h)}Ozb(b,h,v){h=document.getElementById(h);this.wu.YYa(v,b);b=this.wu.rEb(v,"Medium");h.appendChild(b)}H2c(b){let h=null;switch(b){case Nc.a.h9d:case Nc.a.Lbe:h=Bc.a.qv;break;case Nc.a.i9d:case Nc.a.Mbe:h=Bc.a.Ao}return h}static I8b(){return fu.VLa||
(fu.VLa=fu.i4b())}static i4b(){const b={};b[Bc.a.Ao.id.toString()]=wr.lAn;b[Bc.a.qv.id.toString()]=wr.Mzn;return b}static XOk(b,h,v,D){return Ii.j(b,h,v,D,[fu.ZOk(),fu.YOk()])}static ZOk(){return Ii.l("inch",fu.luj,fu.lYm,fu.FAo)}static YOk(){return Ii.l("centimeter",fu.luj,fu.kYm,fu.EAo)}}fu.luj="0";fu.lYm="22";fu.FAo=".1";fu.EAo="1";fu.kYm="55.8";fu.VLa=null;Object(n.a)(fu,"PaperSizeDialog",bg.a,[]);const $L=RegExp("[{|}|;|\\\\]"),cI=b=>{if(!b)return"";const h=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,
v=b.kO;let D;for(D=1;D<=v;D++){const P=h+D;if(!(b.vhi(P)||b.ASd(P)||b.vhi(P+"Char")||b.ASd(P+"Char")))break}return h+D};class dI extends bg.a{constructor(b,h,v,D,P){var ca,ta,Ra,mb;super(!1,!1,!0);this.context=b;this.pc=h;this.m8=v;this.uc=D;this.Oh=P;this.aLd=null;this.p7i=(Jb,Ub)=>{if(this.he.lv){if(0!==Jb){Jb="string"===typeof Ub.styleText?Ub.styleText:null;Ub=this.K9c;var cc=Jb;const Ac=G.a.kya(cc);let Lc=null;if(0===Ac.length)Lc=WordEditorIntl.WordEditorStrings.l_StyleNameEmpty;else if(253<cc.length)Lc=
WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength;else if($L.test(cc))Lc=WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters;else if(Ub.zem(cc)||Ub.ASd(Ac))Lc=WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;(Ub=Lc)?(this.aLd=Ub,Ub=cI(this.K9c),Jb=this.pEb(Jb,Ub),this.aLd=null,this.OV=!1,this.hide(),this.Wh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.p7i,Jb),this.OV=!0):(this.hide(),Ub=new Map,Ub.set("Source","ReactCreateNewStyleDialog"),Ub.set("Action","CreateStyle"),
va.Health.instance.recordKpiUsage(xp.a.xza,0,xp.a.tB,Ub),this.FZe(Jb)||(Jb=new Map,Jb.set("Source","ReactCreateNewStyleDialog"),Jb.set("Action","CreateStyle"),Jb=Object.assign(new Bb.a,{extendedProperties:Jb}),va.Health.instance.recordKpiFailure(xp.a.xza,"CreateStyleFailed",!1,!0,Jb)))}else this.hide();this.he.z5()}};this.wg="CreateNewStyleDialog";this.he=b.view;(b=null===(mb=null===(Ra=null===(ta=null===(ca=this.he)||void 0===ca?void 0:ca.lb)||void 0===ta?void 0:ta.gb)||void 0===Ra?void 0:Ra.kb)||
void 0===mb?void 0:mb.Oa)?(ca=b.node)?(this.pageContentNode=this.Oh.Ys(ca))?(this.K9c=(new xq.WACStyleSet).w8h(this.pageContentNode),(this.fKb=this.m8.WLd(b))?(ca=this.fKb.ia(lf.a.fontSize,22),16>ca?Kc.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=ca?Kc.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):90>=ca?Kc.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Kc.b(593078047,3018,
50,"Font size more than 45pt in create new style dialog preview"),this.U5f(this.fKb),this.pageContentNode&&this.fKb&&(this.N$=!1,ca=cI(this.K9c),ca=this.pEb(ca,ca),this.Wh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.p7i,ca))):Kc.b(592737758,3018,10,"_newStyleProperties is null.")):Kc.b(592737757,3018,10,"_pageContenNode is null."):Kc.b(592725466,3018,10,"node is null."):Kc.b(556917206,3018,10,"nodeContext is null.")}U5f(b){b.Eg(Vi.a.paragraphStyle,Vi.a.kw,...xp.a.Rba())}pEb(b,h){const v=
52<=this.fKb.ia(lf.a.fontSize,Vh.a.oM),D=jv.a.ppf(this.fKb,"97%",26,!1,!0,v);D["padding-left"]="5px";v||(D["line-height"]="40px");b={["styleNameLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,["previewWindowLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,["styleName"]:b,["previewContainerText"]:h,["getPreviewStyle"]:()=>D};this.aLd&&(b.errorMessage=this.aLd);return{["id"]:this.wg,["bodyControls"]:b}}FZe(b){const h=new eh.GraphTransaction(15);h.Cb(this.pageContentNode);
h.jk=Gb.a.DBb;const v=dl.a.FZe(b,dl.a.bfi(this.fKb),null,this.pageContentNode);v&&(Kc.b(593078046,3018,50,"User created linked style"),this.K9c=(new xq.WACStyleSet).w8h(this.pageContentNode),b=G.a.kya(G.a.QX(b)),b=this.K9c.ASd(b),this.pc.Mf(this.context,Gb.a.applyStyle,2,!1,new UH.a,this.uc.kg(b)));h.dispose();return v}}Object(n.a)(dI,"ReactCreateNewStyleDialog",bg.a,[]);class BD extends bg.a{constructor(b,h=!1,v){super(!1,!1,h);let D=h=this.oK=null;this.wg=BD.id;this.mh=b.view;this.pn=v;this.mh&&
(D=this.mh.lb);D&&D.gb&&D.gb.kb&&(h=D.gb.kb.Oa);h?(b=h.node)?(this.wK=BD.Oh.Ys(b))||u.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):u.ULS.sendTraceTag(539762889,3029,10,"node is null"):u.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}q2o(b){var h=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),v=this.DMl();const D=""===G.a.kya(b),P=b.length>BD.Abn;v=v.includes(b);h=h.test(b);b=b.startsWith("_");let ca=null;if(D||P||v||b||!h)ca=D?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:
P?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:h?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return ca}uHm(b,h){return b?b===h:!1}static get Oh(){return Wk.PageNavigator.instance}DMl(){const b=this.pn.YNd(!1),h=[];for(let v=0;v<b.count;v++){const D=b.J(v).ia(Bc.a.ut,"");h.push(D)}return h}}BD.id="BookmarkEditDialog";BD.Abn=40;Object(n.a)(BD,
"AEditBookmarkDialog",bg.a,[]);class eI extends BD{constructor(b,h,v){super(b,!0,v);this.sAe=null;this.bWa="wwaengidc";this.bwc="ReactCreateEditBookmarkNameDialog";this.x3g="EditBookmarkName";this.Asa="EditBookmarkNameDialog";this.rue=h;this.pn=v;this.wK&&(this.N$=!1,b=this.pEb(h.properties.ia(Bc.a.ut,null)),this.Wh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.r7i.bind(this),b))}r7i(b,h){if(this.mh.lv){if(b){b="string"===typeof h.BookmarkText?h.BookmarkText:null;var v;this.rue.hasProperty(Bc.a.ut)?
v=this.rue.getValue(Bc.a.ut):u.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");h=this.q2o(b);this.uHm(b,v)?(u.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):h?(this.sAe=h,v=this.pEb(b),this.sAe=null,this.OV=!1,this.hide(),this.Wh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.r7i.bind(this),v),this.OV=!0):(this.hide(),v=new Map,v.set("Source",this.bwc),v.set("Action",this.x3g),va.Health.instance.recordKpiUsage(this.Asa,
0,this.bWa,v),this.jVk(b)||(v=new Map,v.set("Source",this.bwc),v.set("Action",this.x3g),v=Object.assign(new Bb.a,{extendedProperties:v}),va.Health.instance.recordKpiFailure(this.Asa,"Unable to edit bookmark",!1,!0,v)))}else this.hide();this.mh.z5()}}jVk(b){b=G.a.kya(G.a.QX(b));try{const h=this.pn.BUo(this.rue,b);if(h)u.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");else return u.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),
h}catch(h){return u.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",h.Message),!1}}pEb(b){const h={};h.bookmarkValue=b;h.errorMessage=this.sAe;h.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.wg,["bodyControls"]:h}}}Object(n.a)(eI,"ReactEditBookmarkNameDialog",BD,[]);const jG=(b,h,v)=>{const D=[];if(b.length!==h.length||v&&v.length!==h.length)return D;for(let P=0;P<b.length;P++){const ca={};ca.key=h[P];
ca.text=b[P];ca.type="AppComboBoxItem";v&&(ca.ariaLabel=v[P]);D[P]=ca}return D},zC=(b,h,v,D,P)=>({["unitType"]:b,["unitPlaceholder"]:G.a.G$d(h),["minValue"]:v,["maxValue"]:D,["step"]:P}),UG=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),fI=(b,h,v)=>{let D=!1;b.hasProperty(h)&&b.hasProperty(v)?(v=b.getValue(v),1===v?(b=Number.NaN,h=5,D=!0):(b=b.getValue(h),h=2===v?4:5)):(b=Number.NaN,
h=Xa.App.yFa?4:5);return{vkc:b,T7a:h,cac:D}};class gI{constructor(){this.Euj=this.g0i=this.e0i=this.CAn=this.bYf=!1}}Object(n.a)(gI,"Box4PropertySetChangedState",null,[]);class Om{static get x$b(){return null!=Om.qBg?Om.qBg:Om.qBg=Ea.a.instance.Na("Box4.IIndentationCommands")}static get IEi(){return null!=Om.HDg?Om.HDg:Om.HDg=Ea.a.instance.Na("Box4.IJustificationCommands")}static get s5(){return null!=Om.aHg?Om.aHg:Om.aHg=Ea.a.instance.Na("Box4.ISpacingCommands")}static mXm(b,h,v){Om.IEi&&v&&(null===
h||11!==v||10!==h&&9!==h)&&Om.IEi.gE(v)}static A_m(b,h,v){Om.s5&&v&&Om.s5.eD(v)}static H6k(b,h,v){h!=v&&Om.s5.gjc(v)}static xXm(b,h,v){h!=v&&Om.s5.v7c(v)}static T4o(b,h,v){h!=v&&Om.s5.V7c(v)}static vXm(b,h,v){h!=v&&Om.s5.u7c(v)}static l0i(b,h,v,D){Om.s5&&void 0!==v&&null!==v&&(b=Om.DNc(D),!b.bYf&&D.yO.hasProperty(Wc.a.Rfc)&&D.yO.hasProperty(Wc.a.Sfc)&&(h=D.yO.getValue(Wc.a.Sfc),D=D.yO.getValue(Wc.a.Rfc),b.bYf=!0,Om.s5.pda(1,h,D)))}static k0i(b,h,v,D){Om.s5&&void 0!==v&&null!==v&&(b=Om.DNc(D),!b.CAn&&
D.yO.hasProperty(Wc.a.Pfc)&&D.yO.hasProperty(Wc.a.Qfc)&&(h=D.yO.getValue(Wc.a.Qfc),D=D.yO.getValue(Wc.a.Pfc),b.bYf=!0,Om.s5.pda(0,h,D)))}static d0i(b,h,v,D){Om.x$b&&void 0!==v&&null!==v&&(b=Om.DNc(D),!b.e0i&&D.yO.hasProperty(Wc.a.GGa)&&D.yO.hasProperty(Wc.a.HGa)&&(h=D.yO.getValue(Wc.a.HGa),D=D.yO.getValue(Wc.a.GGa),b.e0i=!0,Om.x$b.Umj(1,h,D)))}static f0i(b,h,v,D){Om.x$b&&void 0!==v&&null!==v&&(b=Om.DNc(D),!b.g0i&&D.yO.hasProperty(Wc.a.Smb)&&D.yO.hasProperty(Wc.a.Tmb)&&(h=D.yO.getValue(Wc.a.Tmb),D=
D.yO.getValue(Wc.a.Smb),b.g0i=!0,Om.x$b.Umj(0,h,D)))}static Ofg(b,h,v,D){Om.x$b&&void 0!==v&&null!==v&&(b=Om.DNc(D),!b.Euj&&D.yO.hasProperty(Wc.a.yTa)&&D.yO.hasProperty(Wc.a.zTa)&&(h=0,D.yO.hasProperty(Wc.a.t5)&&(h=D.yO.getValue(Wc.a.t5)),v=D.yO.getValue(Wc.a.zTa),D=D.yO.getValue(Wc.a.yTa),b.Euj=!0,Om.x$b.Khe(h,v,D)))}static DNc(b){b.customData||(b.customData=new gI);return b.customData}}Object(n.a)(Om,"ParagraphLevelPropertyChangedHandlers",null,[]);class CD{constructor(){this.VLa=null}W7l(b){const h=
{};h.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var v=zC("Point",5,0,1584,1),D=zC("Line",4,0,327,1),P=[v,D];D=UG();var ca=[Box4Intl.Box4Strings.L_SpinnerAuto];v=[""];({vkc:Ra,T7a:ta,cac:mb}=fI(b,Wc.a.Sfc,Wc.a.Rfc));var ta={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,
["unitType"]:Df.a.n_a(ta),["validUnits"]:P,["numberFormatInfo"]:D,["validReservedValues"]:ca};mb?ta.reservedValue=ca[0]:ta.value=isNaN(Ra)?"":Ra;h.beforeSpacingSpinButtonProps=ta;({vkc:Ra,T7a:ta,cac:mb}=fI(b,Wc.a.Qfc,Wc.a.Pfc));P={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Df.a.n_a(ta),["validUnits"]:P,["numberFormatInfo"]:D,["validReservedValues"]:ca};
mb?P.reservedValue=ca[0]:P.value=isNaN(Ra)?"":Ra;h.afterSpacingSpinButtonProps=P;if(ca=P=b.hasProperty(Wc.a.ua))ca=CD.PFa.TEb(b),ca=b.hasProperty(Wc.a.ua)&&b.hasProperty(Wc.a.P3a)&&2===b.getValue(Wc.a.P3a)?!se.a.Awa(ca,1)&&!se.a.Awa(ca,1.5)&&!se.a.Awa(ca,2):!1;if(P){var Ra=CD.PFa.TEb(b);P=0;var mb=!1;b.hasProperty(Wc.a.ua)&&b.hasProperty(Wc.a.P3a)||(mb=!0);mb||(2!==b.getValue(Wc.a.P3a)&&(mb=!0),P=Ra,1>P&&(mb=!0));mb?P="":(Ra="multiple",ca||(se.a.Awa(P,1)?Ra="1.00":se.a.Awa(P,1.5)?Ra="1.50":se.a.Awa(P,
2)&&(Ra="2.00")),P=Ra)}else P=null;Ra={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:jG([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50",
"2.00","multiple"]),["allowFreeForm"]:!1};P?Ra.selectedKey=P:Ra.defaultSelectedKey="";h.lineSpacingComboBoxProps=Ra;P=0;Ra=!1;b.hasProperty(Wc.a.ua)&&b.hasProperty(Wc.a.P3a)&&2===b.getValue(Wc.a.P3a)&&ca&&(P=CD.PFa.TEb(b),Ra=!0,1>P&&(P=Number.NaN));b=[zC("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:b,
["numberFormatInfo"]:D,["validReservedValues"]:v};Ra?b.value=P:b.reservedValue=v[0];h.atSpinButtonProps=b;return h}I8b(){return this.VLa||(this.VLa=this.i4b())}i4b(){const b={};b[Wc.a.ua.id.toString()]=Om.A_m;b[Wc.a.Qfc.id.toString()]=Om.k0i;b[Wc.a.Pfc.id.toString()]=Om.k0i;b[Wc.a.Sfc.id.toString()]=Om.l0i;b[Wc.a.Rfc.id.toString()]=Om.l0i;return b}static get PFa(){return null!=CD.PDg?CD.PDg:CD.PDg=Ea.a.instance.resolve("Box4.ILineSpacingHelper")}}Object(n.a)(CD,"ReactParagraphDialog",null,[]);const hI=
b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,VG=(b,h,v,D)=>{let P=Xa.App.Iha;b.hasProperty(h)&&b.hasProperty(v)&&!D?(h=b.getValue(h),b=b.getValue(v),h?2===b?P=2:h=Df.a.p8a(h,P):Xa.App.yFa&&(P=2)):(h=Number.NaN,Xa.App.yFa&&(P=2));return{vkc:h,T7a:P}},aM=b=>{let h="0";b.hasProperty(Wc.a.t5)&&(b=b.getValue(Wc.a.t5),(1===b||2===b||!b)&&(1===b?h="1":2===b?h="2":b||(h="0")));return h},iI=(b,h)=>{if(h.hasProperty(Wc.a.t5)&&2===h.getValue(Wc.a.t5)&&h.hasProperty(Wc.a.zTa)&&h.hasProperty(Wc.a.yTa)&&
b.hasProperty(Wc.a.HGa)&&b.hasProperty(Wc.a.GGa)){var v=b.getValue(Wc.a.HGa),D=b.getValue(Wc.a.GGa);v=(new pn.a(D,v)).Ot;D=h.getValue(Wc.a.zTa);h=h.getValue(Wc.a.yTa);h=(new pn.a(h,D)).Ot;b.setValue(Wc.a.HGa,v+h);b.setValue(Wc.a.GGa,1)}},jI=b=>{const h=b.getValue(Wc.a.HGa);b=b.getValue(Wc.a.GGa);return(new pn.a(b,h)).Ot},kI=b=>{const h=b.getValue(Wc.a.Tmb);b=b.getValue(Wc.a.Smb);return(new pn.a(b,h)).Ot},lI=(b,h)=>h.hasProperty(Wc.a.HGa)&&h.hasProperty(Wc.a.GGa)&&h.hasProperty(Wc.a.Tmb)&&h.hasProperty(Wc.a.Smb)&&
b.hasProperty(Bc.a.marginLeft)&&b.hasProperty(Bc.a.marginRight)&&b.hasProperty(Bc.a.Ao),bM=b=>b.hasProperty(Wc.a.j1c)?b.getValue(Wc.a.j1c):!1,cM=b=>b.hasProperty(Pd.a.keepWithNext)?b.getValue(Pd.a.keepWithNext):!1,dM=b=>b.hasProperty(Pd.a.widowControl)?b.getValue(Pd.a.widowControl):!1,eM=b=>b.hasProperty(Pd.a.keepTogether)?b.getValue(Pd.a.keepTogether):!1;class mI extends bg.a{constructor(b,h,v,D){super(!1,!1,!0);this.amh=null;this.KAn=()=>{Ea.a.instance.resolve("Box4.UI.IBox4DialogFactory").iHd(this.HAa,
this.yta,this.F6)};this.MAn=(mb,Jb)=>{if(Jb&&(1===mb||2===mb)){if(Jb.alignmentComboBoxProps){var Ub=parseInt(Jb.alignmentComboBoxProps.selectedKey);isNaN(Ub)||hI(Ub)&&this.Fp.setValue(Wc.a.vw,Ub)}var cc=Jb.bySpinButtonProps;Ub=!!cc&&""!==cc.value;var Ac=Jb.didChangeSpecialIndentationComboBoxValue;if(Jb.specialIndentationComboBoxProps){var Lc=parseInt(Jb.specialIndentationComboBoxProps.selectedKey);1!==Lc&&2!==Lc&&Lc||!(Lc||Ac||Ub)||this.Fp.setValue(Wc.a.t5,Lc)}if(cc){Lc=cc.value;cc=Df.a.KNa(cc.unitType.toLowerCase());
let id;0<=Lc||(Lc=0);2===cc?id=2:(id=1,Lc=Df.a.DIa(Lc,cc));if(Ub||Ac)this.Fp.setValue(Wc.a.zTa,Lc),this.Fp.setValue(Wc.a.yTa,id)}Jb.beforeTextSpinButtonProps&&(Ac=Jb.beforeTextSpinButtonProps,Ub=Df.a.KNa(Ac.unitType.toLowerCase()),Ac=""===Ac.value?Number.NaN:Ac.value,isNaN(Ac)||(Lc=Ac,2===Ub?cc=2:(cc=1,Lc=Df.a.DIa(Ac,Ub)),this.Fp.setValue(Wc.a.HGa,Lc),this.Fp.setValue(Wc.a.GGa,cc)));Jb.afterTextSpinButtonProps&&(Ac=Jb.afterTextSpinButtonProps,Ub=Df.a.KNa(Ac.unitType.toLowerCase()),Ac=""===Ac.value?
Number.NaN:Ac.value,isNaN(Ac)||(Lc=Ac,2===Ub?cc=2:(cc=1,Lc=Df.a.DIa(Ac,Ub)),this.Fp.setValue(Wc.a.Tmb,Lc),this.Fp.setValue(Wc.a.Smb,cc)));Jb.beforeSpacingSpinButtonProps&&(Ub=Jb.beforeSpacingSpinButtonProps,Ac=Df.a.KNa(Ub.unitType.toLowerCase()),Lc=Ub.reservedValue,""!==Ub.value&&(Lc===Box4Intl.Box4Strings.L_SpinnerAuto?(Ac=1,Ub=0):(Ac=4===Ac?2:4,Ub=Ub.value),this.Fp.setValue(Wc.a.Sfc,Ub),this.Fp.setValue(Wc.a.Rfc,Ac)));Jb.afterSpacingSpinButtonProps&&(Ub=Jb.afterSpacingSpinButtonProps,Ac=Df.a.KNa(Ub.unitType.toLowerCase()),
Lc=Ub.reservedValue,""!==Ub.value&&(Lc===Box4Intl.Box4Strings.L_SpinnerAuto?(Ac=1,Ub=0):(Ac=4===Ac?2:4,Ub=Ub.value),this.Fp.setValue(Wc.a.Qfc,Ub),this.Fp.setValue(Wc.a.Pfc,Ac)));if(Jb.atSpinButtonProps||Jb.lineSpacingComboBoxProps)if(Ub=Jb.atSpinButtonProps.value,1<Ub)this.Fp.setValue(Wc.a.ua,Ub),this.Fp.setValue(Wc.a.P3a,2);else if(Ub=Jb.lineSpacingComboBoxProps.selectedKey)Ub="1.00"===Ub?1:"1.50"===Ub?1.5:"2.00"===Ub?2:0,Ub=1<=Ub?Ub:1,this.Fp.setValue(Wc.a.ua,Ub),this.Fp.setValue(Wc.a.P3a,2);Jb.contextualSpacingCheckboxProps&&
this.Fp.setValue(Wc.a.j1c,Jb.contextualSpacingCheckboxProps.checked);Jb.keepWithNextCheckboxProps&&this.Fp.setValue(Pd.a.keepWithNext,Jb.keepWithNextCheckboxProps.checked);Jb.widowOrphanCheckboxProps&&this.Fp.setValue(Pd.a.widowControl,Jb.widowOrphanCheckboxProps.checked);Jb.keepTogetherCheckboxProps&&this.Fp.setValue(Pd.a.keepTogether,Jb.keepTogetherCheckboxProps.checked);iI(this.HAa,this.HAa);iI(this.Fp,this.HAa);Jb="";Ub=this.yta;Ac=this.Fp;if(Lc=lI(Ub,Ac))Lc=Ac.hasProperty(Wc.a.zTa)&&Ac.hasProperty(Wc.a.yTa);
Lc?(Lc=Ac.getValue(Wc.a.zTa),cc=Ac.getValue(Wc.a.yTa),Lc=(new pn.a(cc,Lc)).Ot,Ub=jI(Ac)+kI(Ac)+Ub.getValue(Bc.a.marginRight)+Ub.getValue(Bc.a.marginLeft)+Lc+Xa.App.wza<=Ub.getValue(Bc.a.Ao)):Ub=lI(Ub,Ac)?jI(Ac)+kI(Ac)+Ub.getValue(Bc.a.marginRight)+Ub.getValue(Bc.a.marginLeft)+Xa.App.wza<=Ub.getValue(Bc.a.Ao):!0;Ub?gG(this.HAa,this.Fp,this.okm(this.kSe?this.kSe.i4b():{})):Jb=""!==Jb?Jb:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==Jb?this.BHa(Jb,this.KAn):2===mb&&(Xe.c(Nc.a.$jc,
!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Qb(Nc.a.$jc,2,null))}};this.HAa=b.clone();this.Fp=b.clone();this.yta=h.clone();this.F6=v;this.ga=D;this.kSe=new CD;b=this.kSe.W7l(this.Fp);h=zC("Inch",3,-11,22,.1);v=zC("Inch",3,0,22,.1);var P=zC("Centimeter",1,-27.94,55.88,1);D=zC("Centimeter",1,0,55.88,1);var ca=zC("Character",2,-316.8,316.8,.5),ta=zC("Character",2,0,316.8,.5);h=[h,P,ca];D=[v,D,ta];v=UG();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,
["forId"]:"GeneralGroup"};P=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];ca=["1","2","3","6","7"];let Ra=5;ta=this.Fp.hasProperty(Wc.a.vw)?this.Fp.getValue(Wc.a.vw):0;if(10===ta||9===ta)ta=11;if(w.AFrameworkApplication.lcid===ok.a.sg("AR-SA").LCID||11===ta)b.isKashidaSupported=!0,P[Ra]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,
ca[Ra]="11",Ra=6;if(w.AFrameworkApplication.lcid===ok.a.sg("TH-TH").LCID||13===ta)b.isThaiSupported=!0,P[Ra]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,ca[Ra]="13";P={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:jG(P,ca),["allowFreeForm"]:!1};hI(ta)?P.selectedKey=ta.toString():P.defaultSelectedKey="";b.alignmentComboBoxProps=
P;b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"};ta={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:cM(this.Fp)};b.keepWithNextCheckboxProps=ta;ta={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:dM(this.Fp)};
b.widowOrphanCheckboxProps=ta;ta={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,["checked"]:eM(this.Fp)};b.keepTogetherCheckboxProps=ta;b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};P=aM(this.Fp);ta="0"===P;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:jG([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:P,["allowFreeForm"]:!1};ca=Xa.App.Iha;P=0;({vkc:P,T7a:ca}=VG(this.Fp,Wc.a.zTa,Wc.a.yTa,ta));D={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Df.a.n_a(ca),["validUnits"]:D,["numberFormatInfo"]:v};D=this.MOb(P,D);b.bySpinButtonProps=D;ta=Xa.App.Iha;D=0;({vkc:D,T7a:ta}=VG(this.Fp,Wc.a.HGa,Wc.a.GGa,!1));ta={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Df.a.n_a(ta),["validUnits"]:h,["numberFormatInfo"]:v};
ta=this.MOb(D,ta);b.beforeTextSpinButtonProps=ta;ta=Xa.App.Iha;D=0;({vkc:D,T7a:ta}=VG(this.Fp,Wc.a.Tmb,Wc.a.Smb,!1));h={["type"]:"AppSpinButtonProps",["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:Df.a.n_a(ta),["validUnits"]:h,["numberFormatInfo"]:v};h=this.MOb(D,h);b.afterTextSpinButtonProps=h;h={["id"]:"ParagraphDialog",["bodyControls"]:b};v={["type"]:"AppCheckboxInternalProps",
["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:bM(this.Fp)};b.contextualSpacingCheckboxProps=v;h.dialogButtonsOption=9;h.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions};h.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:"left",["margin-left"]:"0"}}};this.Wh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.MAn,h)}okm(b){return this.amh||
(this.amh=this.bcf(b))}bcf(b){b[Wc.a.vw.id.toString()]=Om.mXm;b[Wc.a.GGa.id.toString()]=Om.d0i;b[Wc.a.HGa.id.toString()]=Om.d0i;b[Wc.a.Smb.id.toString()]=Om.f0i;b[Wc.a.Tmb.id.toString()]=Om.f0i;b[Wc.a.t5.id.toString()]=Om.Ofg;b[Wc.a.yTa.id.toString()]=Om.Ofg;b[Wc.a.zTa.id.toString()]=Om.Ofg;b[Wc.a.j1c.id.toString()]=Om.H6k;b[Pd.a.keepWithNext.id.toString()]=Om.xXm;b[Pd.a.widowControl.id.toString()]=Om.T4o;b[Pd.a.keepTogether.id.toString()]=Om.vXm;return b}MOb(b,h){h.value=isNaN(b)?"":b;return h}}
Object(n.a)(mI,"WordReactParagraphDialog",bg.a,[]);class Uw extends bg.a{constructor(b,h,v,D){super(!1,!1,!0);this.u1k=()=>{this.MJc.cLh(this.eri,this.bpe,this.yWc)};this.v1k=(P,ca)=>{ca&&1===P&&(ca.columnsCountSpinButtonProps&&this.jY.setValue(Pd.a.UE,ca.columnsCountSpinButtonProps.value),ca.columnsWidthSpinButtonProps&&(P=ca.columnsWidthSpinButtonProps,this.jY.setValue(Pd.a.hG,[Df.a.DIa(P.value,Df.a.KNa(P.unitType.toLowerCase()))])),ca.columnsSpacingSpinButtonProps&&(P=ca.columnsSpacingSpinButtonProps,
this.jY.setValue(Pd.a.sma,Df.a.DIa(P.value,Df.a.KNa(P.unitType.toLowerCase())))),ca.columnsLineBetweenCheckboxProps&&this.jY.setValue(Pd.a.separator,ca.columnsLineBetweenCheckboxProps.checked),this.y1k()&&(ca=Uw.SBd,this.AHk()?gG(this.eri,this.jY,this.I8b):ca=ca!==Uw.SBd?ca:Box4Intl.Box4Strings.l_ColumnsDialogFailMessage,this.dispose(),ca!==Uw.SBd&&this.BHa(ca,this.u1k)))};this.y1k=()=>this.jY.hasProperty(Pd.a.UE)&&this.jY.hasProperty(Pd.a.hG)&&this.jY.hasProperty(Pd.a.sma)&&this.jY.hasProperty(Pd.a.separator);
this.nOd=(P,ca,ta)=>Math.floor((P-(ca-1)*ta)/ca);this.pof=(P,ca,ta)=>1==ca?0:Math.floor((P-ca*ta)/(ca-1));this.mBk=(P,ca,ta,Ra)=>{const mb=P/ca;ta<Uw.ukc?(ta=Uw.ukc,Ra=this.pof(P,ca,ta)):ta>mb&&(ta=mb,Ra=this.pof(P,ca,ta));return[ta,Ra]};this.jBk=(P,ca,ta,Ra)=>{const mb=(P-Uw.ukc*ca)/(ca-1);0>Ra?(Ra=0,ta=this.nOd(P,ca,Ra)):Ra>mb&&(Ra=mb,ta=this.nOd(P,ca,Ra));return[ta,Ra]};this.DIa=(P,ca)=>Df.a.DIa(P,Df.a.KNa(ca));this.SIc=(P,ca,ta,Ra,mb)=>({["unitType"]:P,["unitPlaceholder"]:G.a.G$d(ca),["minValue"]:ta,
["maxValue"]:Ra,["step"]:mb});this.eri=b.clone();this.jY=b.clone();this.bpe=h.clone();this.Omb=this.bpe.getValue(Bc.a.Ao)-this.bpe.getValue(Bc.a.marginLeft)-this.bpe.getValue(Bc.a.marginRight);this.MJb=Math.floor(this.Omb/Uw.ukc);this.yWc=v;this.MJc=D;this.wg=Uw.id;b={};b.getUnitValue=3==Xa.App.Iha?Df.a.Nz:Df.a.hUa;b.getCalculatedWidthValue=this.nOd;b.getCalculatedSpacingValue=this.pof;b.twipsFromValueAndUnits=this.DIa;b.adjustWidthForLimits=this.mBk;b.adjustSpacingForLimits=this.jBk;b.pageContentWidth=
this.Omb;b.maxColumnCount=this.MJb;b.columnsLabelProps={["type"]:"AppLabelProps",["id"]:"ColumnsSection",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogTitle,["forId"]:"ColumnsGroup"};b.columnsCountSpinButtonProps=this.sRl();b.columnsWidthSpinButtonProps=this.wRl();b.columnsSpacingSpinButtonProps=this.uRl();b.columnsLineBetweenCheckboxProps=this.tRl();b={["id"]:"ColumnsDialog",["bodyControls"]:b};this.Wh(Box4Intl.Box4Strings.l_ColumnsDialogTitle,this.v1k.bind(this),b)}sRl(){var b=[this.SIc("None",
0,1,this.MJb,1)];const h=this.ruf(Pd.a.UE);b={["type"]:"AppSpinButtonProps",["id"]:"columnsCountSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogCount,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogCountAlt,["unitType"]:Df.a.n_a(0),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.MOb(h,b)}wRl(){var b=[this.SIc("Inch",
3,.5,Df.a.Nz(this.Omb),.1),this.SIc("Centimeter",1,1.27,Df.a.hUa(this.Omb),1)];const h=Xa.App.Iha,v=this.ruf(Pd.a.hG);b={["type"]:"AppSpinButtonProps",["id"]:"columnsWidthSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogWidth,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogWidthAlt,["unitType"]:Df.a.n_a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};
return b=this.MOb(v,b)}uRl(){var b=[this.SIc("Inch",3,0,Df.a.Nz(this.Omb-2*Uw.ukc),.1),this.SIc("Centimeter",1,0,Df.a.hUa(this.Omb-2*Uw.ukc),1)];const h=Xa.App.Iha,v=this.ruf(Pd.a.sma);b={["type"]:"AppSpinButtonProps",["id"]:"columnsSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacingAlt,["unitType"]:Df.a.n_a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",
["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.MOb(v,b)}tRl(){const b=this.jY.getValue(Pd.a.separator);return{["type"]:"AppCheckboxInternalProps",["id"]:"columnsLineBetweenCheckbox",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetween,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetweenAlt,["checked"]:b}}get I8b(){return null!=this.KAg?this.KAg:this.KAg=(()=>this.bcf())()}bcf(){const b={};b[Pd.a.UE.id.toString()]=b[Pd.a.hG.id.toString()]=
b[Pd.a.sma.id.toString()]=b[Pd.a.separator.id.toString()]=wr.x1k;return b}AHk(){const b=this.jY.getValue(Pd.a.hG),h=this.jY.getValue(Pd.a.UE),v=this.jY.getValue(Pd.a.sma);let D=0;for(let P=0;P<h;P++)D+=b[0];if(h<=this.MJb&&(h-1)*v+D<=this.Omb)return!0;u.ULS.sendTraceTag(509723422,336,15,"Invalid inputs for Columns Dialog - does not fit in page content space.  Count: {0}, Width: {1}, Spacing: {2}",h,b[0],v);return!1}ruf(b){if(this.jY.hasProperty(b)){if(b==Pd.a.UE)return this.jY.getValue(b);if(b==Pd.a.hG){var h=
Xa.App.Iha;b=this.jY.getValue(Pd.a.sma);const v=this.jY.getValue(Pd.a.UE);return Df.a.p8a(this.nOd(this.Omb,v,b),h)}if(b==Pd.a.sma){if(1==this.jY.getValue(Pd.a.UE))return 0;h=Xa.App.Iha;b=this.jY.getValue(b);return Df.a.p8a(b,h)}}return 0}MOb(b,h){h.value=isNaN(b)?Uw.SBd:b;return h}}Uw.id="ColumnsDialog";Uw.SBd="";Uw.ukc=720;Object(n.a)(Uw,"WordReactColumnsDialog",bg.a,[]);class nI{N9k(b){new HE(b,Ea.a.instance.resolve("Box4.IFeatureHelper"))}Gcl(b,h){new dI(b,h,Ea.a.instance.resolve("Box4.IFormattingReader"),
Ea.a.instance.resolve("Box4.Styles.IWACStyleReader"),Wk.PageNavigator.instance)}ntl(b,h,v){new eI(b,h,v)}nMh(b,h,v){new qA(b,h,v,Ea.a.instance.resolve("WordEditor.IPageCommands"),Ea.a.instance.resolve("Common.IStandaloneRootController").sda)}SMh(b,h,v){new fu(b,h,v,Ea.a.instance.resolve("WordEditor.IPageCommands"),Ea.a.instance.resolve("Common.IStandaloneRootController").sda)}cLh(b,h,v){new Uw(b,h,v,Ea.a.instance.resolve("WordEditor.UI.IDialogFactory"))}k9k(b){return new cE(b)}iHd(b,h,v){new mI(b,
h,v,w.AFrameworkApplication.va)}$kl(){const b=Ea.a.instance.Na("Box4.IRoamingServiceRequestManager");null==b?Kc.b(524834398,3018,10,"Roaming service not resolved."):new VH(b)}fll(b,h){new WH(b,h)}gef(b){return new XH(b)}}Object(n.a)(nI,"DialogFactory",null,[344,345]);class FF extends bg.a{constructor(b,h){super(!1,!1,!0);this.xTh="DoNotCheckSpellingCheckbox";this.NTh="DocumentChoiceGroup";this.$gd=0;this.YEi="LanguageList";this.documentContext="DocumentContext";this.fr="RangeContext";this.Tko=(v,
D)=>{const P=bf.a.instance.yp(Gb.a.nmj);if(1!==v)P.properties.Z("canceled","true");else{v=D[this.YEi].replace(FF.eug,"");var ca=parseInt(v),ta=Boolean.parse(D[this.xTh]);D=D[this.NTh];D===this.documentContext?this.Knd.Kio(ca,ta):this.Knd.Uno(ca,ta);P.properties.Z("PreviousLCID",this.$gd.toString());P.properties.Z("ChangedLCID",ca.toString());P.properties.Z("NoProof",ta.toString());this.B3g.Sko(ca,this.$gd);Xe.d(Gb.a.nmj,!0,void 0,void 0,void 0,void 0,[Object.assign(new na.a,{name:"SelectedLcid",string:v}),
Object.assign(new na.a,{name:"NoProof",string:ta.toString()}),Object.assign(new na.a,{name:"Context",string:D})]);Xa.App.xa.updateCommandUI(!0)}P.end()};this.B3g=h;this.Knd=b}Ieg(){const b=Array(2);b[0]={["key"]:this.fr,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};b[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const h={showDocumentChoiceGroup:!0};h.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;h.documentChoiceGroupProps={["id"]:this.NTh,
["defaultSelectedKey"]:this.JUl(),["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.$gd=({cLn:this.E0j}=this.Knd.lcm()).returnValue;h.languageListPropsProvider=this.x1l();h.spellingCheckboxProps={["id"]:this.xTh,["checked"]:!this.E0j,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};this.Wh(Box4Intl.Box4Strings.l_Language,this.Tko,{["id"]:"LanguageDialog",["bodyControls"]:h})}JUl(){return this.Knd.gf()?this.documentContext:this.fr}x1l(){return()=>
{let b,h;const v=({selectedIndex:b,$uj:h}=this.B3g.w1l(this.$gd)).returnValue;for(let D=0;D<v.length&&D<h;D++)v[D].value=FF.eug+v[D].value;return{["id"]:this.YEi,["items"]:v,["selectedLanguageIndex"]:b,["applyBorderIndex"]:h}}}}FF.eug="recent-";Object(n.a)(FF,"ReactLanguageDialog",bg.a,[343]);class oI extends AD{constructor(b,h,v,D){super(h,v);this.KZf=()=>{this.floatie.xm()};this.Jh=b;this.rI=D}$eb(b,h,v){if(b=super.$eb(b,h,v))b.Bgc=!0,b.xae=!0,b.preventDismissOnScroll=!0;this.Jh.eZa(this.KZf);return b}GSc(b,
h,v=null){this.rI.Mwh(()=>this.$eb(b,h,v))}i7d(){this.floatie.Bgc=!0}}Object(n.a)(oI,"ExternalContentFloatieInitializer",AD,[]);class pI{ILb(){xl.instance.Koa&&(vt.instance.d8a([1,0]),xl.instance.y0d()&&du.instance.d8a([1]))}}Object(n.a)(pI,"RulerUser",null,[341]);class qI{constructor(){this.whitelistedControlIds=null}}Object(n.a)(qI,"StatusBarProps",null,[]);class GF{constructor(b,h,v=!0){this.ra=new Mc.a;this.zsd=!1;this.uPe=null;this.ifa=h.WG;this.LTe=h.Yvj;v?Sk.a.get_instance().Ak(7,()=>{this.Tyh(b,
h)}):this.Tyh(b,h)}Tyh(b,h){window.setTimeout(()=>{ns.a.instance.ie(()=>{el.UISurfaces.kem().then(v=>{const D=Object.assign(new qI,{whitelistedControlIds:h.whitelistedControlIds});v.initializeNewStatusBar(b,D,this.LTe);this.uPe=v;this.zsd=!0;window.setTimeout(()=>{ns.a.instance.ie(()=>{const P=[];if(h.UG){const ca=h.UG;for(let ta in ca)P.push(appChrome.actions.updateControlHiddenState(ta,ca[ta]));appChrome.api.dispatch(P)}this.ILb()},"RSB:I2")},0);w.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.RaiseReactStatusBarInitializedEvent")&&
this.rPn();return null}).catch(()=>{u.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(h.Gqa&&b){GF.dYg||(w.AFrameworkApplication.va.qa(Wa.a.$vj,ud.a.frame,Object(z.a)(this,this.awj,"statusBarTabAction")),w.AFrameworkApplication.va.qa(Wa.a.Zvj,ud.a.frame,Object(z.a)(this,this.awj,"statusBarTabAction")),GF.dYg=!0);const v=Wr.a.MWd(h.Gqa,h.Dlj,b,!1);v.RH=!0;this.ihc(v,Wa.a.$vj,Wa.a.Zvj)}},0)}ILb(){this.zsd&&this.ifa&&window.setTimeout(()=>{this.ifa(this.uPe.selectors.getStatusBarControlsMap(this.LTe),
7)},0)}sob(b,h){this.zsd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,h))},0)}OU(b){this.zsd&&this.ifa&&window.setTimeout(()=>{const h=this.uPe.selectors.getStatusBarControlsMap(this.LTe);if(h[b]){const v={};v[b]=h[b];this.ifa(v,7)}},0)}ihc(b,h,v){const D=Xb.KeyInputManager.jc(Ve.a.Dw,0),P=Xb.KeyInputManager.jc(Ve.a.Dw,4);b.jr(D);b.jr(P);b.bindAction(D,h);b.bindAction(P,v)}awj(){return 4}rPn(){this.ra&&(this.ra.raiseEvent("RSBIE"),this.ra.dispose(),this.ra=
null)}}GF.dYg=!1;Object(n.a)(GF,"ReactStatusBar",null,[]);class rI{constructor(){this.whitelistedControlIds=this.UG=this.WG=null;this.XVm=!1;this.Dlj=this.Gqa=this.Yvj=null}}Object(n.a)(rI,"ReactStatusBarInitOptions",null,[]);var dE=c(440);class sI{constructor(b,h,v,D,P){this.yYb=this.WLa=this.Fa=null;this.kEo=()=>{const ca=Xa.App.xa.Ap.getRegion(xk.AppFrame.Gqa);ca&&ca.YNf()};this.kqm=(ca,ta,Ra,mb,Jb)=>{if(!Jb)return u.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),
8;if(1===Ra)return 32;Jb&&2===Jb.length&&this.WLa&&this.WLa.sob(Jb[0],Jb[0]);return 32};this.ybd=ca=>{Xa.App.xa.WG(ca)};this.ga=D;ns.a.instance.ie(()=>{this.Fa=P;this.yYb=this.WLa=null;const ca={};w.AFrameworkApplication.ctj||(ca[dE.a.I$n]=!0);ca.GiveFeedback=!w.AFrameworkApplication.AF;this.Fa.$("OfficeOnlineInGallatinTextVisible")||(ca.CenterStatusLabel=!0);ca[dE.a.z_i]=!0;this.Fa.$("WPMPackageIsEnabled")&&this.Fa.$("WPMStatusBarLabelIsEnabled")||(ca[dE.a.dqg]=!0);this.Fa.$("AddInCommandsIsEnabled")||
(ca[dE.a.Ftk]=!0);this.Fa.$("WordEditorShowOcsConnectionStatus")||(ca[dE.a.mSf]=!0);ca[dE.a.z5o]=!0;this.Fa.$("ReadingTimeIsEnabled")||(ca[dE.a.F7i]=!0);window.setTimeout(()=>{this.KAm(b,ca)},0)},"SBU:I")}Tb(){this.ga.eb(Gb.a.rke,sc.a.application,this.kqm,96)}KAm(b,h){this.yYb=Ea.a.instance.Na("WordEditor.WordEditorReactCommandDefinitionMapping");const v={};for(const P in h){var D=h[P];v[this.utf(P)]=D}this.WLa=new GF(b,Object.assign(new rI,{UG:v,WG:this.ybd,XVm:!1,Yvj:"WordEditorStatusBar",Gqa:xk.AppFrame.Gqa,
Dlj:this.kEo}))}utf(b){let h="";if(this.yYb){const v=this.yYb.dqf(b);v&&0<v.count&&(h=v.J(0))}return h&&""!==h?h:b}ILb(){this.WLa&&this.WLa.ILb()}sob(b,h){this.WLa&&this.WLa.sob(this.utf(b),h)}OU(b){this.WLa&&this.WLa.OU(this.utf(b))}dispose(){}}Object(n.a)(sI,"StatusBarUser",null,[340,10]);var tI=c(1061);class WG{constructor(b){this.ga=b;this.ga.qa(Wa.a.m5c,ud.a.frame,Object(z.a)(this,this.m5c,"reportFileMenuPageSwitch"));this.ga.qa(Wa.a.gdj,ud.a.frame,Oc.ActionManager.Nf)}m5c(b,h,v,D,P){this.ga.processAction(this.lXl(P[tI.a.H9d]),
2);return 32}}Object(n.a)(WG,"FileMenuSQMInformation",null,[904]);class uI extends WG{constructor(b){super(b);this.hWn()}hWn(){this.ga.qa(Wa.a.d7f,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.adj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.e7f,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.bdj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.cdj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.f7f,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.ddj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.edj,
ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.fdj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.Gdj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.Hdj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.jdj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.kdj,ud.a.frame,Oc.ActionManager.Nf)}lXl(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return Wa.a.d7f;case "tabHome":case "FileHomePage":return w.AFrameworkApplication.ue("1ba3i132;45gid285"),Wa.a.adj;case "menuJewelInfo":case "FileInfoPage":return Wa.a.e7f;
case "menuJewelNew":case "FileNewPage":return Wa.a.bdj;case "menuJewelOpen":case "FileOpenPage":return Wa.a.cdj;case "menuJewelPrint":case "FilePrintPage":return Wa.a.f7f;case "menuJewelSaveAs":case "FileSaveAsPage":return Wa.a.ddj;case "menuJewelShare":case "FileSharePage":return Wa.a.edj;case "menuJewelTransform":case "FileTransformPage":return Wa.a.fdj}return Wa.a.gdj}}Object(n.a)(uI,"WordEditorFileMenuSQMInformation",WG,[]);var vI=c(1059);class XG{constructor(b){this.ga=b;this.ga.qa(Wa.a.n5c,
ud.a.frame,Object(z.a)(this,this.n5c,"reportTabSwitch"));this.ga.qa(Wa.a.Bdj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.Ddj,ud.a.frame,Oc.ActionManager.Nf)}n5c(b,h,v,D,P){this.ga.processAction(this.gbm(P[vI.a.Qhg]),2);return 32}}Object(n.a)(XG,"RibbonSQMInformation",null,[858]);class wI extends XG{constructor(b){super(b);this.yYn()}yYn(){this.ga.qa(Wa.a.sdj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.udj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Nc.a.h7f,ud.a.frame,Oc.ActionManager.Nf);
this.ga.qa(Wa.a.vdj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.wdj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Nc.a.xdj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Nc.a.ydj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Nc.a.zdj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Nc.a.Adj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Nc.a.i7f,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Nc.a.Cdj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Wa.a.Edj,ud.a.frame,Oc.ActionManager.Nf);this.ga.qa(Nc.a.Fdj,ud.a.frame,Oc.ActionManager.Nf);
this.ga.qa(Nc.a.tdj,ud.a.frame,Oc.ActionManager.Nf)}gbm(b){switch(b){case "tabAddins":case "Addins":return Wa.a.sdj;case "tabHome":case "Home":return Wa.a.vdj;case "tabInsert":case "Insert":return Wa.a.wdj;case "tabDeveloper":case "Developer":return Wa.a.udj;case "tabPageLayout":case "Layout":return Nc.a.xdj;case "tabReferences":case "References":return Nc.a.Adj;case "tabReview":case "Review":return Nc.a.i7f;case "tabView":case "View":return Wa.a.Edj;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return Nc.a.Cdj;
case "tabMailings":case "Mailings":return Nc.a.ydj;case "tabWordDesign":case "Design":return Nc.a.Fdj;case "tabHelp":case "Help":return Nc.a.h7f;case "ctabPictureTools":case "Picture":return Nc.a.zdj;case "Copilot":return Nc.a.tdj}return Wa.a.Ddj}}Object(n.a)(wI,"WordEditorRibbonSQMInformation",XG,[]);class xI{constructor(b=null,h=null,v=null){this.UG=b||{};this.lCj=h||[];this.pCj=v||{}}}Object(n.a)(xI,"RibbonTrimmingProperties",null,[]);class yI{constructor(b,h,v){this.Qua=b;this.UG=h;this.KHf=v}}
Object(n.a)(yI,"ReactRibbonJewelProperties",null,[]);class zI{constructor(){w.AFrameworkApplication.va.qa(Wa.a.SQa,ud.a.frame,Object(z.a)(this,this.pQn,"reactFileMenuOpenFromTellMe"))}pQn(b,h,v,D,P){if(1===v)return 32;w.AFrameworkApplication.Kha("54hi9858;4f638686");if(!P)return 32;b=P.SourceControlId;17!==P.UILocation||"New"!==b&&"Open"!==b||(P=[],Rh.d("setFileMenuSelectedPage")&&("New"===b&&w.AFrameworkApplication.ta?2===w.AFrameworkApplication.ta.Nb.Tl?P.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):
P.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&w.AFrameworkApplication.ta&&(2===w.AFrameworkApplication.ta.Nb.Tl?P.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):P.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),P.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(P));return 32}NFi(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}rSa(){return!1}q2i(){}eTh(){}}Object(n.a)(zI,"ReactFileMenu",
null,[392]);class AI{Kaf(){const b=new zI,h=[];h.push(appChrome.actions.updateFileMenuExpandedValue(!1));h.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(h);return b}}Object(n.a)(AI,"ReactFileMenuFactory",null,[378]);class JE{constructor(b,h,v,D=!1){this.Dlc=b;this.j1g=this.Dlc.U2a;this.r6d=Ea.a.instance.Na("Common.IOfficeTrialExperience");this.DJb=Ea.a.instance.Na("Common.IMacOfficeOffer");JE.$ue=!1;this.xQm=D;this.ga=h;this.Ub=v}get pc(){return this.ga}get focusManager(){return this.Ub}w2e(){return this.j1g&&
!!this.r6d&&!!this.DJb}CUa(b,h){this.Dlc.Po(()=>{u.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");this.j1g=!0;this.gjf(b,h)});Ea.a.instance.Sa("Common.IOfficeTrialExperience").execute(v=>{u.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.r6d=v;this.gjf(b,h)});Ea.a.instance.Sa("Common.IMacOfficeOffer").execute(v=>{u.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.DJb=v;this.gjf(b,h)})}gjf(b,h){JE.$ue||(this.w2e()?(u.ULS.sendTraceTag(5878051,
340,50,"ExecuteCallbackWhenReady: ready"),b(this,h),JE.$ue=!0):u.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}JE.$ue=!1;Object(n.a)(JE,"RibbonDependencies",null,[280]);class YG{constructor(b,h,v){this.Mtb=b;this.ga=h;this.Ub=v}}Object(n.a)(YG,"WoncaRibbonUserFactory",null,[107]);class BI{constructor(b,h){this.mwe=b;this.e0b=h}Mob(b){this.mwe.Mob(b);this.e0b&&this.e0b.Mob(b)}t7c(b){this.mwe.t7c(b);this.e0b&&this.e0b.t7c(b)}Bbd(b){this.mwe.Bbd(b);this.e0b&&this.e0b.Bbd(b)}}
Object(n.a)(BI,"RibbonCommandTrimmer",null,[109]);var fM=c(1238),gM=c(1152);class CI{constructor(b,h){this.Fa=b;this.NYb=h}Mob(b){aa.a.ti&&6>aa.a.b2a&&(b.fseaInsertPicture=!0);this.Fa.$("InsertSymbolIsEnabled")||(b.grpInsertSymbols=!0);this.Fa.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.Fa.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=!0);gw.a.bAi()||(b.InsertLoopComponentsForConsumers=!0);const h=this.Fa.$("InsertOnlinePictureEnabled"),v=w.AFrameworkApplication.hEf();h||(b.fseaInsertOnlinePicture=
!0,b.fseaFlyInsertOnlinePictureFromSearch=!0);v?b.fseaInsertPictureFromOneDrive=!0:(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);v&&h?(b.fseaInsertOnlinePicture=!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;w.AFrameworkApplication.iEf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=!0);w.AFrameworkApplication.lmc&&(b.btnOpenInClient=!0);w.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&w.AFrameworkApplication.K.$("DisablePrint")&&
this.mmc(b)}t7c(b){b.menuJewel=!0;w.AFrameworkApplication.AF||(b.jbtnGiveFeedback=!0)}mmc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}Bbd(b){delete b.menuJewel;w.AFrameworkApplication.privacyUrl||(b.jbtnPrivacy=!0);w.AFrameworkApplication.k5c||(b.jbtnReportAbuse=!0);w.AFrameworkApplication.Ole||(b.jbtnTermsOfUse=!0);w.AFrameworkApplication.cMd||(b.jbtnFileSharing=
!0);w.AFrameworkApplication.Lnb||(b.jbtnShareRWC=!0);w.AFrameworkApplication.mkf||w.AFrameworkApplication.Ung||(b.jbtnVersion=!0);this.NYb.r6d&&this.NYb.r6d.xkn||(b.btnjTryOffice=!0,b.btnjTryOfficeForWordEditor=!0);this.NYb.DJb&&this.NYb.DJb.Lto||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);w.AFrameworkApplication.lmc?(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[Xa.App.us?"btnjOpenInClient":"btnjEditInClient"]=!0;w.AFrameworkApplication.OOo&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=
!0,b.jbtnDownloadAsOdt=!0);w.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&w.AFrameworkApplication.K.$("DisablePrint")?this.mmc(b):w.AFrameworkApplication.K.$("DirectPrintIsEnabled")?b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;w.AFrameworkApplication.LG&&(this.mmc(b),b.faShare=!0);if(w.AFrameworkApplication.protectFile||aa.a.FQa||!w.AFrameworkApplication.FRc&&!w.AFrameworkApplication.dkf&&!w.AFrameworkApplication.Sng)b.jbtnFileEmbed=!0;fM.a.bxm()||(b.btnjClose=!0);w.AFrameworkApplication.gIb?
(b.jbtnVersion=!0,u.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):w.AFrameworkApplication.x0d()||(b.btnjVersionHistory=!0);b.jbtnVersion&&b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);w.AFrameworkApplication.g3f||(b.faOpen=!0);b.jbtnFileSharing&&b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Fa.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&
b.btnjTryMacOffice&&b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=!0);const h=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.nBi;if(b.faOpen&&b.faNew||!h)b.faHome=!0;if(w.AFrameworkApplication.QK||".ODT"===Xa.App.$Lc.toUpperCase()||!w.AFrameworkApplication.K.$("WordEditorAppsForOfficeRibbonIsEnabled")||!gM.a.vAd||w.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled"))b.faGetAddinsFromBackstage=
!0}}Object(n.a)(CI,"WoncaCommandTrimmer",null,[109]);var hM=c(1001);c(435);var iM=c(1060),jM=c(1151);class DI{constructor(b,h){this.i2=this.pK=null;this._clientId=b;this.raa=h}sxl(){if(!nf.c(this.i2))return this.i2;this.uif();this.i2.style.display="block";this.raa&&this.raa.WZ(Object(z.a)(this,this.onResize,"onResize"));return this.i2}onResize(){this.vya()}vya(){this.aif()?(document.getElementById("application").style.minWidth="0px",(new jM.a(this.i2,null,w.AFrameworkApplication.isRtl)).Jbo(this.i2)):
w.AFrameworkApplication.ta.Nb.xJ||iM.a.Kbo(this.i2,w.AFrameworkApplication.isRtl)}aif(){return w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("EnhancedMobileViewIsEnabled"):!1}uif(){if(nf.c(this.pK)){var b;({mRc:b}=Wr.a.Cad(!w.AFrameworkApplication.MX)).returnValue?(this.pK=gD.a("div"),this.pK.className=Wr.a.Pzl,this.pK.id=tn.CuiHelper.zLd,b.appendChild(this.pK),this.nif(),w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.S8&&!w.AFrameworkApplication.MX&&this.oif(),this.rxl()):w.AFrameworkApplication.K&&
w.AFrameworkApplication.K.$("ReactHeaderCrashLogs")&&u.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}rxl(){nf.c(this.i2)&&(this.i2=gD.a("div"),this.i2.className=Wr.a.lkg,this.i2.style.display="none",this.pK.appendChild(this.i2))}nif(){Sys.UI.DomElement.addCssClass(this.pK,Wr.a.Qzl);w.AFrameworkApplication.isRtl&&gD.b(this.pK,"cui-rtl")}oif(){Sys.UI.DomElement.addCssClass(this.pK,"FlexBoxLayout")}}Object(n.a)(DI,"HeaderSkeleton",
null,[]);var KE=c(614);class ZG{constructor(){this.voc=null}NQo(){this.voc||(this.voc=Ea.a.instance.Na("Common.App.AccountSwitching.IAccountSwitching"))||u.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}JLl(){this.NQo();return this.voc?this.voc.getCustomAuthConfig():null}static pJm(){return w.AFrameworkApplication.K.$("UiHostSupportsCustomAuthConfig")}}Object(n.a)(ZG,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class $G{constructor(){this.HIb=this.cultureName=null}}
Object(n.a)($G,"HeaderCultureInfo",null,[]);var kG=c(1631);class EI{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(n.a)(EI,"SearchInitializationSettings",null,[]);var LE=c(290);class FI{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=
this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(n.a)(FI,"DocumentTitleAppProps",null,[]);class GI{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(n.a)(GI,"DocumentTitleCalloutAppProps",null,[]);class HI{constructor(){this.language=
this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;
this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(n.a)(HI,"HeaderAppProps",null,[]);class II{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(n.a)(II,"HeaderControls",null,[]);class JI{constructor(){this.command=
this.label=null}}Object(n.a)(JI,"WorkflowButtonAppProps",null,[]);var lG;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.insufficientPermission=2]="insufficientPermission";b[b.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";b[b.editorsPresent=4]="editorsPresent";b[b.notSupported=5]="notSupported"})(lG||(lG={}));Object(n.b)("RenameDisableReason",lG);class KI{constructor(b=""){this.O9f=this.documentTitleAppProps=this.bqg=null;this.xlk=""!==b?b:Id.a.v5}aam(b){const h=Ea.a.instance.Na("Common.IExternalUICommandDefinitionMapping").eEb(b);
if(h&&0<h.length)return h[0].externalUxCommand;u.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",b));return null}bwf(){if(!this.bqg){const b=KE.a();if(b){const h=this.aam(b.command);h&&(this.bqg=Object.assign(new JI,{command:h,label:b.label}))}}return this.bqg}aTl(){return Object.assign(new II,{workflowButton:this.bwf()})}Eon(){Sk.a.get_instance().$H(17)}onMove(){const b={};b.MoveButtonClickedTime=new Date;w.AFrameworkApplication.va.Qb(Wa.a.VJb,
2,b)}Bam(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}zVl(){let b=null,h=null;var v=Ea.a.instance.Na("Common.IRenameProps");v?(v=v.Dfi(),0!==v&&(b=this.Bam(v),h=lG[v])):u.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new GI,{breadcrumbBrandName:w.AFrameworkApplication.zs.breadcrumbBrandName,
breadcrumbBrandUrl:w.AFrameworkApplication.zs.breadcrumbBrandUrl,breadcrumbFolderName:w.AFrameworkApplication.zs.breadcrumbFolderName,breadcrumbFolderUrl:w.AFrameworkApplication.zs.breadcrumbFolderUrl,hideDocumentTitleInput:w.AFrameworkApplication.ta.Nb.ntm,isVersionHistoryEnabled:this.bvo(),documentExtension:G.a.Nga(w.AFrameworkApplication.fileName),isMoveEnabled:32===w.AFrameworkApplication.va.processAction(Wa.a.VJb,1),onMove:Object(z.a)(this,this.onMove,"onMove"),message:b,renameDisableReason:h,
openBreadcrumbsInNewTab:w.AFrameworkApplication.K.$("OpenLinksInNewWindow")})}z8h(){if(!this.documentTitleAppProps){const b=w.AFrameworkApplication.zs.gz;this.documentTitleAppProps=Object.assign(new FI,{documentTitle:w.AFrameworkApplication.wJd?b:G.a.kJ(b),onFirstRender:Object(z.a)(this,this.Eon,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(z.a)(this,this.zVl,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}bvo(){return!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.jCi}Jso(){return!!w.AFrameworkApplication.ta&&
w.AFrameworkApplication.ta.Nb.iCi}Juo(){const b=!KE.b()&&!w.AFrameworkApplication.hideHeader&&!w.AFrameworkApplication.$xf&&(w.AFrameworkApplication.K.$("SkypeWebControlIsEnabled")||w.AFrameworkApplication.K.$("TeamsChatIsEnabled"));u.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}O6k(b){appChrome.getHeaderApi().then(h=>{h.setNavBarData(b.result);return null});u.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}vVn(b=!1){appChrome.getHeaderApi().then(h=>
{const v=Ea.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");h.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});h.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});h.setHeaderCommandHandler("OnFlexPaneOpen",D=>{v.onFlexPaneOpen(D)});h.setHeaderCommandHandler("OnFlexPaneClose",D=>{v.onFlexPaneClose(D)});h.setHeaderCommandHandler("SetCookie",D=>$b.a.set(D.cookieName,D.value));h.setHeaderCommandHandler("GetCookie",D=>this.cTl(D));h.setHeaderCommandHandler("QueryWorkflowButtonSettings",
Object(z.a)(this,this.bwf,"getWorkflowButtonAppProps"));b||(h.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(z.a)(this,this.z8h,"getDocumentTitleAppProps")),h.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.Fon();return null}));kG.a.G_d()&&h.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(z.a)(this,this.ngi,"getSearchInitializationSettings"))})}Fon(){Ea.a.instance.Sa("Common.App.SaveStatus.ISaveStatusUIHandler").execute(b=>{b.zqb(!1,w.AFrameworkApplication.va.mode)})}cTl(b){b=
$b.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}Wem(){return LE.AppChromeOverrideUtilities.isEnabled?LE.AppChromeOverrideUtilities.BRd("suiteux-shell",!1):this.xlk+w.AFrameworkApplication.Mia+"suiteux-shell"}onFirstRender(){Ea.a.instance.Sa("Common.App.O365Shell.IO365ShellActor").execute(b=>{b.Cro.continueWith(Object(z.a)(this,this.O6k,"continueShellServiceDataAsync"),3)});Sk.a.get_instance().$H(15)}onFullyLoaded(){Sk.a.get_instance().$H(16)}Kna(b=!1){a:{try{var h=
ok.a.sg(w.AFrameworkApplication.lcid);if(h){var v=Object.assign(new $G,{cultureName:h.name,HIb:h.HIb});break a}}catch(D){u.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+w.AFrameworkApplication.lcid.toString())}v=Object.assign(new $G,{cultureName:"en-us",HIb:"en"})}h=Ea.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");v=Object.assign(new HI,{appName:CommonUIStrings.l_AppNameShort,culture:v.cultureName,language:v.HIb,isConsumer:!w.AFrameworkApplication.Xng,
showAppLauncher:KE.h(),showMeControl:KE.g(),hideUserName:w.AFrameworkApplication.FVd,defaultDocumentTitleToLeft:w.AFrameworkApplication.JPh,assetsContainerOverride:this.Wem(),controls:this.aTl(),documentTitleAppProps:b?null:this.z8h(),showDocumentTitleControl:!b,showWorkflowButton:!!this.bwf(),showChatControl:this.Juo(),showGoPremiumControl:KE.i(),showDiscoverPremiumButton:KE.f(),enableSearchControl:kG.a.zSm(),onFlexPaneOpen:Object(z.a)(h,h.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(z.a)(h,
h.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.Jso(),testTraffic:w.AFrameworkApplication.K.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(z.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(z.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:w.AFrameworkApplication.Kso()});!w.AFrameworkApplication.wRb||w.AFrameworkApplication.nfg?(v.userDisplayName=w.AFrameworkApplication.userName,v.emailAddress=w.AFrameworkApplication.K.jb("UserPrincipalName"),
v.userID=w.AFrameworkApplication.K.jb("Puid")||"",v.signOutLink=w.AFrameworkApplication.nfg):w.AFrameworkApplication.signInUrl&&(v.signInLink=w.AFrameworkApplication.signInUrl);kG.a.G_d()&&(h=this.ngi(),v.loadTellMeResources=h.loadTellMeResources,v.getTokenRequestDictionary=h.getTokenRequestDictionary,v.enableVanillaSearchBox=w.AFrameworkApplication.K.$("VanillaSearchUxInHeaderIsEnabled"),v.userRing=h.userRing);ZG.pJm()&&(h=new ZG,v.shellAuthProviderConfigPromise=Object(z.a)(h,h.JLl,"getAccountSwitchingConfig"));
this.vVn(b);return v}ngi(){if(!this.O9f){const b=new kG.a;let h=w.AFrameworkApplication.K.jb("Microsoft365Ring");h&&h.length||(h="generalAudience");this.O9f=Object.assign(new EI,{loadTellMeResources:b.y1m(),getTokenRequestDictionary:Object(z.a)(b,b.hhm,"getTokenRequestDict"),userRing:h})}return this.O9f}}Object(n.a)(KI,"ReactSharedHeaderPropsHelper",null,[1206]);class aH{constructor(){this.label=this.value=null}}Object(n.a)(aH,"TextInfoSectionField",null,[]);var HF=c(936),kM=c(1213);class bH{constructor(){this.commandId=
0;this.externalUxCommand=null}}Object(n.a)(bH,"CommandDefinition",null,[]);class LI{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(n.a)(LI,"CommandDefinitionMapping",null,[]);const lM=b=>Object.assign(new LI,{getCommandByExternalUxId:h=>{const v=b.getCommandByExternalUxId(h);return v?Object.assign(new bH,{commandId:parseInt(v.commandId),externalUxCommand:v.externalUxCommand}):Object.assign(new bH,{externalUxCommand:h})},
getDoNothingCommand:()=>parseInt(Wa.a.Ig),addCommandToMaps:Object(z.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(z.a)(b,b.addIconToMap,"addIconToMap"),addTabToMap:Object(z.a)(b,b.addTabToMap,"addTabToMap")});var mM=c(1390);class MI{}Object(n.a)(MI,"RibbonInitState",null,[]);var NI=c(412),nM=c(1325);class OI{constructor(){}flatten(b){const h=[];for(const v of b)h.push.apply(h,v);return h}}Object(n.a)(OI,"ReactAsyncDispatcher",null,[]);var oM=c(1673);class PI{constructor(b,h){this.Skk=
b;this.d_j=h}}Object(n.a)(PI,"ReactExecuteCommandContext",null,[]);class Hy{}Hy.Trigger="FontTrigger";Hy.Name="FontName";Hy.Action="FontAction";Hy.Level="FontLevel";Hy.IsPinned="FontIsPinned";Object(n.a)(Hy,"FontPickerLogProperties",null,[]);class QI{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb=null,Ub=null){this.AZ=null;this.Yfh=!1;this.jAe=[];this.Wgd=-1;this.vwd=!1;this.dmk=0;this.tqc=null;this.Jbh=!1;this.zgd=null;this.V5g=!1;this.Wea=b;this.gcb=h;this.QQe=Object(Na.a)(862,b);this.Pl=v;this.Ub=D;P&&(this.AZ=
new oM.a(P,D));this.tik=ca;this.s3j=ta;this.Jp=Jb;this.ga=Ra;this.dvb={};this.Fa=mb;this.dwg=Ub;mb&&(mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||mb.$("EnqueueTasksWhenTaskMgrIsYielding"))&&zi.a.instance.HAd.CWR(()=>this.Yfh=!0);mb&&(b=this.Fa.jb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&({av:this.tqc}=E.d(b));this.tqc||(this.tqc={})}get Zfe(){return!!window.appChrome&&!!appChrome.selectors}Mhj(){-1!==this.Wgd&&window.clearTimeout(this.Wgd);
this.Wgd=window.setTimeout(()=>{for(this.Wgd=-1;0<this.jAe.length;){if(Qg.a.instance.Nv){this.Mhj();break}const b=this.jAe.shift();b&&this.executeCommand(b.Skk,b.d_j)}},0)}executeCommand(b,h){if(Qg.a.instance.Nv){if(this.Yfh){this.jAe.push(new PI(b,h));this.Mhj();return}u.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",b,h.modelType,
jb.a.toJSON(h.payload));if(this.Fa.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(h){const v=this.Pl.getCommandByExternalUxId(b),D=h.modelType;this.dwg&&this.dwg.N2m(b,h);v?this.Ayl(b,v,D,h):this.Byl(b,D,h);this.nWk(h);this.AOo(h);this.X$m(b,h)}}Byl(b,h,v){switch(h){case "GalleryModel":case "PreviewGalleryModel":this.lYh(v,b);break;case "ButtonModel":this.vyl(v,b)}}XYo(b,h,v,D,P){if(v.payload)switch(v.payload.type){case "CoauthorMenuPayload":b.MenuItemId=v.payload.coauthorId;break;case "ButtonPayload":b.MenuItemId=
h.menuItemId;b.CommandValueId=v.payload.commandValueId;b.TerminalParentControlId=v.payload.terminalParentControlId;this.Fa&&this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)?(h=!0,nf.c(v.payload.dismissHostingSurfaceOnExecute)||(h=v.payload.dismissHostingSurfaceOnExecute),h&&this.r3()):this.r3();break;case "ButtonPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=v.payload.commandValueId;P=h.commandPreviewId;break;case "ButtonRevertPreviewPayload":b.MenuItemId=
h.menuItemId;b.CommandValueId=v.payload.commandValueId;P=h.commandRevertId;break;default:b.MenuItemId=h.menuItemId}else b.MenuItemId=h.menuItemId;b.SourceControlId=D;return P}YYo(b,h,v){if(h.payload)switch(h.payload.type){case "MenuOpenPayload":b=this.Pl.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":b=this.Pl.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":v.CommandId=h.payload.executedControl;v.ControlId=h.payload.executedControl;
v.ParentControlId=h.payload.parentControl;v.CloseAllMenus=!0;this.r3();break;case "TellMeSearchResultChangePayload":v.Value=h.payload.searchText;break;case "SmartLookupPayload":v.CommandValueId=h.payload.selectionContextJson}return b}Ayl(b,h,v,D){var P=this.VEn(D,v),ca=h.commandId;const ta={},Ra={};switch(v){case "SplitButtonModel":if(this.KQc(D.payload,Object(z.a)(this,this.a_o,"updateSplitButtonMenuState"),P))return;ta.MenuItemId=h.menuItemId;this.hcg(D,ta);break;case "StatefulSplitButtonModel":if(this.KQc(D.payload,
Object(z.a)(this,this.g_o,"updateStatefulSplitButtonMenuState"),P))return;v=D.payload.statefulData;P=D.payload.statefulMode;"color"===P?ta.Color=v:"icon"===P&&(v=this.Pl.getCommandByExternalUxId(v))&&(ta.MenuItemId=v.menuItemId);break;case "FileMenu":ta.MenuItemId=h.menuItemId;ta.SourceControlId=b;D.payload&&"FileMenuPageSwitchPayload"===D.payload.type&&this.Tnm(ca,D.payload,b);break;case "TellMe":ca=this.YYo(ca,D,ta);ta.SourceControlId=b;ta.Location=D.payload.location;break;case "ButtonModel":D.payload&&
"TabSwitchPayload"===D.payload.type?this.Opm(ta,D):ca=this.XYo(ta,h,D,b,ca);break;case "CompoundButtonModel":ta.MenuItemId=h.menuItemId;ta.CommandValueId=D.payload.commandValueId;ta.SourceControlId=b;this.hcg(D,ta);this.r3();break;case "ToggleButtonModel":case "InkButtonModel":ta.MenuItemId=h.menuItemId;ta.SourceControlId=b;this.hcg(D,ta);this.r3();break;case "FontPickerModel":switch(D.payload.type){case "MenuOpenPayload":ca=this.Pl.getCommandByExternalUxId("FontPickerMenuOpen").commandId;ta[Lx.a.FontPickerId]=
D.payload.launcherId;break;case "MenuClosePayload":ca=this.Pl.getCommandByExternalUxId("FontPickerMenuClose").commandId;ta[Lx.a.FontPickerId]=D.payload.launcherId;break;case "FontPickerFontSelectedPayload":v=D.payload.font;P=null;"string"===typeof v?(P=cq.FontUtils.yRa(v),ta.CommandValueId=P,P=cq.FontUtils.fHd(P)):(v.data?(ta.CommandValueId=v.data.fontToApply,ta.MenuItemId=v.data.themeIndex,ta[Lx.a.Formatting]=v.data):ta.CommandValueId=v.name,P=v);ta.SourceControlId=b;ta[Lx.a.RequestUpdateMru]=P;
Ra[Hy.Name]=D.payload.nameToLog?D.payload.nameToLog:"string"===typeof v?cq.FontUtils.rYd(v)?"*"+v:cq.FontUtils.iDf(v)?"[EF]":"[MF]":"";Ra[Hy.IsPinned]=D.payload.isPinned;Ra[Hy.Level]=D.payload.level;this.JKf();break;case "FontPickerFontInfoRequestedPayload":ta.CommandValueId=D.payload.font.name;ta[Lx.a.Trigger]=D.payload.trigger;Ra[Hy.Trigger]=D.payload.trigger;Ra[Hy.Name]=D.payload.nameToLog;this.JKf();break;case "FontPickerFontPinningPayload":v=D.payload.isPinned;ta.CommandValueId=D.payload.fontKey;
ta[Lx.a.IsPinned]=v;Ra[Hy.Name]=D.payload.nameToLog;Ra[Hy.Action]=v?"pin":"unpin";Ra[Hy.Level]=D.payload.level;this.JKf();break;default:return}break;case "ComboBoxModel":var mb=D.payload.type;switch(mb){case "MenuOpenPayload":case "MenuPopulatePayload":this.Ojc(D.payload.launcherId,P)&&(ca={},ca[D.payload.launcherId]=v,this.gcb.R1c(ca,Rh.g(D.payload)),this.dvb[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":v=D.payload.newValue;if(!v)return;
v.value?(ta[Jm.a.Value]=v.value,ta[Jm.a.IsFreeForm]=!0):(ta[Jm.a.Value]=v.text,ta.MenuItemId=v.key,ta.CommandValueId=v.commandValueId);"ComboBoxPreviewPayload"===mb&&(ca=h.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":ca=h.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(D.payload.type){case "ZeroTermContextMenuClosePayload":v=jb.a.GO(D.payload);for(mb of v)ta[mb]=D.payload[mb];break;default:this.KQc(D.payload,Object(z.a)(this,this.xWo,"updateFlyoutAnchorMenuState"),
P),ta.launcherId=D.payload.launcherId}break;case "InkFlyoutAnchorModel":this.KQc(D.payload,Object(z.a)(this,this.yXo,"updateInkFlyoutAnchorMenuState"),P);ta.launcherId=D.payload.launcherId;break;case "ColorPickerModel":switch(D.payload.type){case "ColorPickerPayload":ta[db.Color]=D.payload.selectedColorId;ta.colorRGB=D.payload.color;break;case "ColorPickerPreviewPayload":ca=h.commandPreviewId;ta[db.Color]=D.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":ca=h.commandRevertId;
break;default:return}break;case "SpinButtonModel":ta[mj.a.Number]=D.payload.value;ta[mj.a.UnitType]=Df.a.KNa(D.payload.unitType.toLowerCase());ta[mj.a.Text]=D.payload.reservedValue;break;case "SliderModel":ta[Jn.Value]=D.payload.value;break;case "InsertTableModel":ta[jq.a.Rows]=D.payload.rows;ta[jq.a.Columns]=D.payload.columns;break;case "CheckboxModel":ta[If.a.On]=D.payload.checked;ta.MenuItemId=h.menuItemId;ta.TerminalParentControlId=D.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.KQc(D.payload,
Object(z.a)(this,this.jZo,"updatePreviewGalleryMenuState"),P)){ta.launcherId=D.payload.launcherId;break}this.lYh(D,b);return;case "DocumentTitleModel":switch(D.payload.type){case "DocumentTitleRenamePayload":ta.getNewDocumentTitle=D.payload.getNewDocumentTitle;break;case "MenuOpenPayload":ca={};ca[D.payload.launcherId]=v;this.gcb.R1c(ca,Rh.g(D.payload));this.dvb[b]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":ta.MenuItemId=D.payload.url;this.P3m(D.payload.pageId);
break;case "NewBlankDocumentModel":case "CustomTemplateModel":ta.MenuItemId=D.payload.assetId;ta.SourceControlId=b;w.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&(ta.IsPremium=D.payload.isPremium||!1);this.Q3m(D.payload.pageId);break;case "CoauthorGallery":ta.RenderTime=D.triggerTime;break;case "PeopleWell":ta.RenderTime=D.triggerTime;break;case "SyncStatus":ta.SourceControlId=b;break;case "InputBoxModel":ta.Text=D.payload.newValue;break;case "PersonaButtonModel":ta.CommandValueId=
D.payload.commandValueId;this.Wom(D.payload);break;case "MultiActionButtonModel":ta.CommandValueId=D.payload.commandValueId;ta.Href=D.payload.href;ta.Type=D.payload.type;ta.TerminalParentControlId=D.payload.terminalParentControlId;this.r3();break;default:return}ca&&!this.isShadowMenuOpen(D.payload)&&(ta.CommandValueId||(ta.CommandValueId=ta.MenuItemId),h.legacyControlId&&(ta.LegacyId=h.legacyControlId),ta.SourceControlId||(ta.SqmControlId=b),this.Fa&&this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&ta.launcherId&&(h=this.Pl.getCommandByExternalUxId(ta.launcherId))&&(ta.launcherCommandId=parseInt(h.commandId)),D.payload&&!nf.c(D.payload.PRIReadinessCheck)&&(ta.PRIReadinessCheck=D.payload.PRIReadinessCheck,this.Jbh=!0),D.payload&&!nf.c(D.payload.shouldTakeFocus)&&(ta[Fy.a.qTa]=D.payload.shouldTakeFocus),h=this.DZe(D,ta),nf.c(D.triggerTime)||(Ra.TriggerTime=D.triggerTime),D.payload&&!nf.c(D.payload.userActionKey)&&(Ra.userActionKey=D.payload.userActionKey),this.Aag(Ra,D,b,ca),this.QQe.executeCommand(ca,
ta,this.getSelectedTabId(),h,!0,()=>{this.VNf(ta,b)},Ra,Rh.g(D.payload)))}Aag(b,h,v,D){if(this.Fa&&this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&v&&D&&h.payload){const P=!nf.c(h.payload.launcherId);v=this.Tgj(this.W5l(P?h.payload.launcherId:v,D),D,!1);b.ControlId=v;const ca=h.payload.inputMethod,ta=h.payload.location;nf.c(ca)||nf.c(ta)||this.V2m(1===ca,2===ca||3===ca||4===ca,P||"TabSwitchPayload"===h.payload.type,v,ta)}this.Fa&&this.Fa.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&
h.payload&&"terminalParentControlId"in h.payload&&(b.TerminalParentControlId=this.Tgj(h.payload.terminalParentControlId,D,!0))}V2m(b,h,v,D,P){this.zgd||(this.zgd={});const ca=[];P=Qm.a.r8("UILocation",P,2);Array.add(ca,P);if(P=this.getSelectedTabId())P=Qm.a.r8("Tab",P,2),Array.add(ca,P);this.zgd[D]||(this.zgd[D]=1,h?v?this.sdc("DistinctUserInitiatedNavigationalCommand",ca):this.sdc("DistinctUserInitiatedTerminalCommand",ca):b&&this.sdc("DistinctUserInitiatedKeyboardCommand",ca));h?v?this.sdc("UserInitiatedNavigationalCommand",
ca):this.sdc("UserInitiatedTerminalCommand",ca):b&&this.sdc("UserInitiatedKeyboardCommand",ca)}sdc(b,h){Xe.b(b,null,0,!0,0,h)}Tgj(b,h,v){if(RegExp("^[a-zA-Z0-9_]*$").test(b))return b;u.ULS.sendTraceTag(510247689,207,15,v?"CommandId: "+h+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+h+" has a controlId that is non-alphanumeric and may need to be changed");return"MalformedId"}W5l(b,h){h=parseInt(h);h=Oc.ActionManager.P8e(h)||Oc.ActionManager.Gaa(h)||"";return!nf.c(h)&&
h in this.tqc?this.tqc[h]:100<b.length?"":b}JKf(){this.Jp&&this.Jp.execute(b=>{b.tKf("ModernFontPickerExperience")})}DZe(b,h){let v=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&(v=b.payload.inputMethod,h[Fy.a.Kx]=v);return v}VNf(b,h){const v=Object(Na.a)(Ne.AFrame,w.AFrameworkApplication.ta);if(this.Ub&&this.Nqj(b)){if(!this.Ub.currentScope&&v){let D="null";if(b){const P=b.Value;delete b.Value;D=jb.a.toJSON(b);nf.c(P)||(b.Value=P)}u.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",
h,D,v.e6a)}this.Ub.Elf()}(this.Ub&&this.Ub.currentScope&&this.Ub.currentScope.name!==Ne.AFrame.Vpa&&v&&this.Ub.currentScope.name!==v.e6a||this.Nqj(b))&&this.J0k(b)}Nqj(b){return!!b&&!nf.c(b[Fy.a.qTa])&&b[Fy.a.qTa]}J0k(b){Fy.a.Kx in b&&1===b[Fy.a.Kx]&&HF.ShyRibbon.Geb(1,0)}Opm(b,h){Rh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.r3();this.Wea.xm();if(this.tik&&this.ga){const v={};v[vI.a.Qhg]=h.payload.tabId;this.ga.Qb(Wa.a.n5c,
2,v,this.EX(h));nf.c(h.payload.inputMethod)||(this.ga.processAction(Wa.a.Bdj,2),this.vwd||this.Zyo(h.payload.tabId))}h=h.payload.tabId;b.NewContextId=h;b.NewContextCommand=this.Pl.Muf(h);u.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+h);if(this.Jp&&h){const v=h+"TabSwitchActivity";this.Jp.execute(D=>{D.tKf(v)})}}KQc(b,h,v){const D=b.type;return"MenuClosePayload"===D?!0:"MenuOpenPayload"===D?(h(b,v),!0):!1}Wom(b){b=b.type;"MenuOpenPayload"===b?w.AFrameworkApplication.$9c=!0:"MenuClosePayload"===
b&&(w.AFrameworkApplication.$9c=!1)}VEn(b,h){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const v=b.payload.launcherId,D=this.Pl.getCommandByExternalUxId(v);return D&&D.populationProps?((b=this.gcb.TZf(D,h,b.payload))&&v in this.dvb&&delete this.dvb[v],b):!1}xWo(b,h){const v=b.launcherId;this.Ojc(v,h)&&(h=appChrome.selectors.getFlyoutAnchorMenuItems(v),this.Qmc(h,v,Rh.g(b)))}yXo(b,h){const v=b.launcherId;this.Ojc(v,h)&&(h=
Rh.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(v):appChrome.selectors.getFlyoutAnchorMenuItems(v),this.Qmc(h,v,Rh.g(b)))}jZo(b,h){const v=b.launcherId;this.Ojc(v,h)&&(h=appChrome.selectors.getPreviewGalleryMenuItems(v),this.Qmc(h,v,Rh.g(b)))}a_o(b,h){const v=b.launcherId;this.Ojc(v,h)&&(h=appChrome.selectors.getSplitButtonMenuItems(v),this.Qmc(h,v,Rh.g(b)))}g_o(b,h){const v=b.launcherId;this.Ojc(v,h)&&(h=appChrome.selectors.getStatefulSplitButtonMenuItems(v),this.Qmc(h,
v,Rh.g(b)))}getSelectedTabId(){return this.Zfe?appChrome.selectors.getSelectedTabId():null}Qmc(b,h,v){this.gcb.R1c(b,v);this.dvb[h]=new Date}Ojc(b,h){let v=!0;b in this.dvb&&(v=this.dvb[b].getTime()<this.Wea.Yoa.getTime());return v&&!h&&this.Zfe}lYh(b,h){const v={};var D=b.payload.selectedGalleryId;const P=this.Pl.getCommandByExternalUxId(D);if(P){v.SourceControlId=D;v.MenuItemId=P.menuItemId;v.SqmControlId=h;P.legacyControlId&&(v.LegacyId=P.legacyControlId);b.payload&&!nf.c(b.payload.shouldTakeFocus)&&
(v[Fy.a.qTa]=b.payload.shouldTakeFocus);this.z8l(b.payload,v);(D=this.EX(b))||(D={});this.Aag(D,b,h,P.commandId);const ca=this.DZe(b,v);this.QQe.executeCommand(P.commandId,v,this.getSelectedTabId(),ca,!0,()=>{this.VNf(v,h)},D,Rh.g(b.payload))}}vyl(b,h){const v=this.Pl.getCommandByExternalUxId(h);if(v){const D={};D.SourceControlId=h;D.MenuItemId=h;D.SqmControlId=h;b.payload&&!nf.c(b.payload.shouldTakeFocus)&&(D[Fy.a.qTa]=b.payload.shouldTakeFocus);let P=this.EX(b);P||(P={});this.Aag(P,b,h,v.commandId);
const ca=this.DZe(b,D);this.QQe.executeCommand(v.commandId,D,this.getSelectedTabId(),ca,!1,()=>{this.VNf(D,h)},P,Rh.g(b.payload))}}z8l(b,h){"CharacterGalleryPayload"===b.type&&(h.MenuItemId=b.character)}hcg(b,h){b.payload&&"toggled"in b.payload&&(h[If.a.On]=b.payload.toggled)}X$m(b,h){if("MenuOpen"===b){if(this.AZ&&!("isShadowRendering"in h.payload&&h.payload.isShadowRendering))this.AZ.onMenuOpen()}else if("MenuClose"===b&&this.AZ)this.AZ.onMenuClose()}r3(){this.AZ&&this.AZ.tTf()}EX(b){let h=null;
nf.c(b.triggerTime)||(h={},h.TriggerTime=b.triggerTime);return h}Tnm(b,h,v){if(this.s3j&&this.ga){const D={};D[tI.a.H9d]=v;this.ga.Qb(Wa.a.m5c,2,D)}this.Qmc(h.pageControlIdMap,b,Rh.g(h))}Q3m(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(Wa.a.Gdj,2);break;case "FileNewPage":this.ga.processAction(Wa.a.Hdj,2)}}P3m(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(Wa.a.jdj,2);break;case "FileOpenPage":this.ga.processAction(Wa.a.kdj,2)}}isShadowMenuOpen(b){return!!b&&
"MenuOpenPayload"===b.type&&b.isShadowRendering}Zyo(b){if(w.AFrameworkApplication.K.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===b)this.Jp.execute(h=>{h.logActivity("TellMeHelpCoachMarkActivity",null)}),this.vwd=!0;else{if(w.AFrameworkApplication.K.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.Jp.execute(h=>{h.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.dmk)){this.vwd=!0;return}w.AFrameworkApplication.K.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.processAction(Wa.a.qPb,
2)&&(this.vwd=!0)}}nWk(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.Jbh&&appChrome.PRIToastManager.dismissToast()}AOo(b){!this.V5g&&this.Fa&&this.Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ToolBarFloodGate1",!1)&&(b=Rh.g(b.payload),31===b||14===b||15===b||2===b)&&(window.requestAnimationFrame(()=>{window.setTimeout(()=>{const h=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");h&&h.execute(v=>{v.logActivity("SingleLineToolBarFPS","SingleLineToolBarFloodgateSurveyIsEnabled")})},
0)}),this.V5g=!0)}}Object(n.a)(QI,"ReactExecuteCommandHandler",null,[]);class RI{constructor(){this.fileMenu=null}get Aqb(){return 0}get c4a(){return 0}get fGa(){return!1}vya(){}lAj(){}r_(){return!1}Flj(){}C3(){return!1}MIa(b){return this.fileMenu&&this.fileMenu.rSa(b)?!0:!1}get nja(){return!1}sob(){}CYd(){return!1}get aGd(){return null}set aGd(b){}Dfa(){}tba(){}Ovf(){return null}mOa(){}refresh(){}get controls(){return null}khc(){return!1}Yeb(){}xm(){}get xF(){return null}set xF(b){}fbd(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(n.a)(RI,"ReactRibbonExternal",null,[533,463,534]);class SI{constructor(b,h,v,D){this.Ub=b;this.ga=h;this.ulh=v;this.OYb=D}initialize(){this.ga.qa(Wa.a.U5c,ud.a.frame,Object(z.a)(this,this.Gfj,"ribbonMoveForwardAction"));this.ga.qa(Wa.a.T5c,ud.a.frame,Object(z.a)(this,this.Ffj,"ribbonMoveBackwardAction"));this.ga.qa(Wa.a.Xee,ud.a.frame,Object(z.a)(this,this.Cfj,"ribbonEscAction"));var b=Wr.a.MWd(this.OYb,null,this.ulh,!1);b.RH=!0;this.ihc(b,Wa.a.U5c,Wa.a.T5c);b.bindAction(Xb.KeyInputManager.jc(Ve.a.PIa,
0),Wa.a.Xee);b=this.Ub.fe(Ne.AFrame.Vpa);b.RH=!0;this.ihc(b,Wa.a.W_a,Wa.a.W_a);xf.a.instance.nb(Ed.a.Ox,this.ulh,Object(z.a)(this,this.jun,"onRibbonMouseDown"));b=$i.a.instance;Rh.a("enterKeytipMode")&&b.nmo(this.OYb,()=>{appChrome.api.enterKeytipMode(!1)});Rh.a("exitKeytipMode")&&b.jmo(this.OYb,()=>{appChrome.api.exitKeytipMode();HF.ShyRibbon.Geb(1,0)});w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Noa&&(b=Object(Na.a)(bd.FocusManager,this.Ub))&&b.oyk(Object(z.a)(this,this.mpn,"onFocusScopeChanged"))}mpn(b,
h){if((b=Object(Na.a)(Ne.AFrame,w.AFrameworkApplication.ta))&&h.mRi&&w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Noa){const v=appChrome.selectors.getShyState();v.isActive&&h.mRi.name===b.e6a&&HF.ShyRibbon.Geb(v.state,1)}}Gfj(){return 4}Ffj(){return 4}Cfj(){Rh.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Noa&&appChrome.selectors.getShyState().isActive&&HF.ShyRibbon.Geb(1,0),this.Ub.mg(Ne.AFrame.Pn));return 4}ihc(b,h,v){const D=
Xb.KeyInputManager.jc(Ve.a.Dw,0),P=Xb.KeyInputManager.jc(Ve.a.Dw,4);b.jr(D);b.jr(P);b.bindAction(D,h);b.bindAction(P,v)}jun(b){b.Hb&&b.Hb.target&&"input"!==b.Hb.target.tagName.toLowerCase()&&b.Hb.preventDefault();return!1}dispose(){this.ga.Sv(Wa.a.U5c,ud.a.frame,Object(z.a)(this,this.Gfj,"ribbonMoveForwardAction"));this.ga.Sv(Wa.a.T5c,ud.a.frame,Object(z.a)(this,this.Ffj,"ribbonMoveBackwardAction"));this.ga.Sv(Wa.a.Xee,ud.a.frame,Object(z.a)(this,this.Cfj,"ribbonEscAction"))}}Object(n.a)(SI,"ReactRibbonFocusManager",
null,[10]);class AC{constructor(b,h,v,D,P,ca,ta,Ra=null,mb=!0,Jb=null,Ub=null){this.T$a=this.wxd=this.jwe=this.Wea=null;this.zfh=[];this.wtd=null;this.bMa=b;this.KKe=h;this.OYb=v;this.Ub=D;this.ga=P;this.Pl=ca;this.Wea=Jb?Jb:new zz(Kt.instance,this.Pl);this.Wvc=ta;this.Qdh=new RI;this.cMa=Ra;this.zSe=mb;new OI;this.oVg=Ub;Sk.a.get_instance().Ak(7,Object(z.a)(this,this.Ano,"setRibbonPostInteractiveReady"));Sk.a.get_instance().Ak(7,Object(z.a)(this,this.G7m,"logRibbonLoadedActivity"));Sk.a.get_instance().Ak(19,
Object(z.a)(this,this.s2m,"logAppLoadedActivity"));w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&Sk.a.get_instance().Ak(7,Object(z.a)(this,this.MYn,"registerSubComponentReporting"));Sk.a.get_instance().Ak(7,Object(z.a)(this,this.YNn,"queueSettingsDependentActions"))}initialize(b,h,v=null){this.zSe||this.$H(5);v?v.then(()=>{this.xcj()}).catch(()=>u.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):
NI.a.F$c(NI.a.F$c(gk.Task.WAA(this.oHi(b),this.nHi(AC.u_j)),()=>this.nHi(AC.MWj)),()=>this.oHi(h)).continueWith(()=>{this.xcj()},11)}dispose(){this.TRo();this.T$a&&this.T$a.eTh();this.wtd&&this.wtd.dispose();for(const b of this.zfh)Sk.a.get_instance().DYk(b);w.AFrameworkApplication.va.Sv(Wa.a.z5n,ud.a.frame,Oc.ActionManager.Nf)}nHi(b){return Ea.a.instance.resolve("Common.ISharedDependencyLoader").mdc(w.AFrameworkApplication.Hz(b,2))}oHi(b){return""===b?gk.Task.P3(!0):Ea.a.instance.resolve("Common.ISharedDependencyLoader").mdc(w.AFrameworkApplication.Hz(b,
3))}NAm(){(this.cMa||this.Wvc)&&appChrome.api.dispatch(this.pji());this.Apo();Rh.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(w.AFrameworkApplication.w5);this.Wea.xm()}xcj(){this.NAm();this.zSe&&(appChrome.renderAppChrome(this.bMa,Rh.e()),this.$H(10));this.Enh();this.f5e();this.zSe&&this.$H(5);this.vri()}vri(){this.Ub&&this.ga&&this.OYb&&(this.wtd=new SI(this.Ub,this.ga,this.bMa,this.OYb),this.wtd.initialize())}get S5c(){return this.Qdh}setCommandDefinitionMapping(){if(Rh.a("setCommandDefinitionMapping")){const b=
lM(this.Pl);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Noa&&Rh.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,h)=>{0===h&&this.rgc()})}Enh(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(Na.a)(zz,this.Wea);this.jwe=new QI(this.Wea,b.fhc,this.Pl,this.Ub,this.KKe,Ea.a.instance.Na("Common.IRibbonSQMInformation"),Ea.a.instance.Na("Common.IFileMenuSQMInformation"),
w.AFrameworkApplication.va,w.AFrameworkApplication.K,Ea.a.instance.Sa("Common.ISystemInitiatedFeedback"),null);this.aLk();this.Qmm()}aLk(){this.wxd=appChrome.api.bindCommandHandler((b,h)=>{this.jwe.executeCommand(b,h)})}TRo(){this.wxd&&(this.wxd(),this.wxd=null)}Apo(){appChrome.api.initializeLogger(new di.a)}BEa(){return this.Wea?this.Wea.BEa():[]}rgc(){ns.a.instance.ie(()=>{let b=null;ns.a.instance.ie(()=>{b=this.BEa()},"RB:GA");b&&0<b.length&&(this.Wea.Yoa=new Date,ns.a.instance.ie(()=>{appChrome.api.dispatch(b)},
"RB:DA"));this.T$a&&ns.a.instance.ie(()=>{this.T$a.q2i()},"RB:J")},"RB:PFSU")}obd(){this.Wea.obd()}xKb(){}Oqk(b){b=[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}pji(){var b=w.AFrameworkApplication.K;const h=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&Ea.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(v=>
{v.isFeatureEnabled("ConnectedServices",!0).then(D=>{D&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):h.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));h.push.apply(h,this.o9h());b=new mM.a(this.Pl);this.cMa.UG&&(nM.a.ROo(this.cMa.UG),h.push.apply(h,b.TNd(this.cMa.UG)));if(this.cMa.lCj)for(const v of this.cMa.lCj)h.push(appChrome.actions.updateGallerySectionHiddenState(v.Y2h,v.rnp,v.ypp));h.push.apply(h,b.a4h(this.cMa.pCj));
return h}o9h(){const b=[];if(this.Wvc&&this.Wvc.UG){const v=this.Wvc.UG;for(let D in v){var h=v[D];const P=this.Pl.dqf(D);if(P)for(let ca of P)b.push(appChrome.actions.updateControlHiddenState(ca,h))}}return b}JIa(b){b&&this.Wea.fhc.R1c(b,0)}TZf(b){this.Wea.fhc.TZf(this.Pl.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}Epl(){const b=w.AFrameworkApplication.K.$("ShareMenuIsEnabled")?"ShareMenu":"Share",h=w.AFrameworkApplication.K.appSettings;h&&appChrome.api.dispatch(this.WZo(b,
"Shared"===(h.SharingStatus||"")))}YNn(){w.AFrameworkApplication.K.Po(()=>{this.Epl()})}WZo(b,h){return appChrome.actions.updateSharingStatusIndicator(b,h)}$H(b){Sk.a.get_instance().$H(b);this.zfh.push(b)}Ano(){Rh.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new MI,{postRibbonInteractiveReady:!0})))}f5e(){this.Wvc&&this.oVg&&(this.T$a=this.oVg.Kaf(),this.Qdh.fileMenu=this.T$a)}lZm(b,h){this.T$a&&this.T$a.NFi(b,h)}H8f(b,
h,v){if(1===v)return 32;this.mnj(!0);this.rgc();w.AFrameworkApplication.ta.updateCommandUI();return 32}I8f(b,h,v){if(1===v)return 32;this.mnj(!1);this.Mno();this.rgc();w.AFrameworkApplication.ta.updateCommandUI();return 32}Pkg(b,h,v){if(1===v)return 32;(b=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback"))&&b.execute(D=>{D.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}Mno(){$b.a.oTa(w.AFrameworkApplication.K.jb("IsSimplifiedRibbonOnCookieName"),"true",$b.a.mRa)}mnj(b){$b.a.oTa(w.AFrameworkApplication.K.jb("ReactRibbonMLRPreferenceCookieName"),
b.toString(),$b.a.mRa)}G7m(){if(w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.yr){const b=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(b.execute(h=>{h.logActivity("SingleRibbonModeActivity",null)}),w.AFrameworkApplication.epa("d79fg304;61jba833;h856e313;f5i2f477;d613b829;da9b1202")):"Multiline"===appChrome.selectors.getRibbonMode()&&(b.execute(h=>{h.logActivity("MultiRibbonModeActivity",null)}),w.AFrameworkApplication.epa("69a7h198;dfd7j584"));
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultToMLR",!1)&&Ea.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFreemiumUpsellEnabled()&&w.AFrameworkApplication.epa("5fjej882;e0jjh200")})}}s2m(){this.ga.qa(Wa.a.Pkg,ud.a.frame,Object(z.a)(this,this.Pkg,"triggerModeSwitcherTUI"));const b=$b.a.Dba(w.AFrameworkApplication.K.jb("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const h=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");
h&&(w.AFrameworkApplication.K.$("Fluent2StyleIsEnabled")?(h.execute(v=>{v.logActivity("VNextStylesOn",null)}),h.execute(v=>{v.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):w.AFrameworkApplication.K.$("Fluent2StyleFGOnlyIsEnabled")&&b&&h.execute(v=>{v.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}MYn(){Sk.a.get_instance().Ak(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const b=appChrome.api.getRibbonSubComponentMappings();
for(let v in b){var h=v;const D=b[v];if(D)for(const P of D)w.AFrameworkApplication.va.y_(P)?appChrome.api.reportRibbonSubComponentBehaviorMapped(h):w.AFrameworkApplication.va.gmo(P,this.Ucl(h));else appChrome.api.reportRibbonSubComponentBehaviorMapped(h)}}Ucl(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}Qmm(){if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Rh.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&w.AFrameworkApplication.egc.LYe){const b=w.AFrameworkApplication.egc.LYe,h=w.AFrameworkApplication.egc.dnh;h.payload||(h.payload={});const v=h.payload.launcherId?h.payload.launcherId:b;AC.Ifj.mb(v)?AC.Ifj.J(v)():"StatefulSplitButtonModel"===h.modelType?appChrome.PRIToastManager.dismissToast():(h.payload.PRIReadinessCheck=!0,this.jwe.executeCommand(b,h))}}}AC.u_j="common";AC.MWj="appChrome";AC.Ifj=new kM.a(Va.a.oQc());
Object(n.a)(AC,"ReactRibbonUser",null,[158,128,10]);class cH extends AC{constructor(b,h,v,D,P,ca,ta,Ra,mb=null,Jb=!0,Ub=null,cc=null){super(b,h,D,P,ca,ta,Ra,mb,Jb,Ub,cc);this.Wjd=null;this.Mtb=v;this.Mtb.execute(Ac=>{this.Wjd=Ac});this.Mtb.execute(Ac=>{this.Wea.xF=Ac})}BEa(){return this.Wjd?(this.Wjd.clearCache(),super.BEa()):[]}xKb(b){if(!b)throw Error.argumentNull();this.Mtb.execute(h=>{b.xF=h})}}Object(n.a)(cH,"ReactRibbonUser",AC,[]);var pM=c(995);class IF extends cH{constructor(b,h,v,D,P,ca,
ta,Ra,mb,Jb=!0,Ub=null,cc=null){super(h,b.E3,D,xk.AppFrame.hqa,P.focusManager,P.pc,ta,Ra,mb,Jb,Ub,cc);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.JDe=b;this.raa=ca;P.CUa(()=>{this.EZo();w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?Sk.a.get_instance().Ak(7,()=>{this.kri()}):this.kri()},null)}get OCf(){return!!w.AFrameworkApplication.K.appSettings.BootActivityNavigationId}kri(){this.abl();this.Kaf();
this.xVn()}EZo(){this.bMa.classList.add("FlexBoxLayout");this.JDe.xna().classList.add("cui-exth");this.JDe.xna().classList.add("FlexBoxLayout");this.JDe.xna().classList.add("ScrollableRibbon")}abl(){w.AFrameworkApplication.MX||this.efl()}efl(){if(!w.AFrameworkApplication.MX){var b=(new DI(IF.rik,this.raa)).sxl(),h=Wr.a.MWd(xk.AppFrame.CPa,null,b,!0);h.RH=!0;this.ihc(h,Wa.a.U5c,Wa.a.T5c);h.bindAction(Xb.KeyInputManager.jc(Ve.a.PIa,0),Wa.a.Xee);JD.a(1,()=>{this.O3n(b)})}}O3n(b){const h=new KI;appChrome.renderSharedHeader(b,
h.Kna()).then(this.zff.bind(this))}eaj(){w.AFrameworkApplication.ta.Nb.hCi?appChrome.getHeaderApi().then(b=>{document.getElementById(w.AFrameworkApplication.Hgb).classList.remove("Placeholder");return b.dismissPlaceholder()}):(new pM.a).zff()}zff(){this.OCf&&w.AFrameworkApplication.epa("Microsoft.Office.Web.SessionSettings.IWacWordImprovedDeepLinkLoadSettings");this.OCf&&w.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?(Sk.a.get_instance().Ak(12,this.eaj.bind(this),11),u.ULS.sendTraceTag(42316515,
338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.eaj()}ihc(b,h,v){const D=Xb.KeyInputManager.jc(Ve.a.Dw,0),P=Xb.KeyInputManager.jc(Ve.a.Dw,4);b.jr(D);b.jr(P);b.bindAction(D,h);b.bindAction(P,v)}Kaf(){const b=!!this.cMa&&"FileMenu"in this.cMa.pCj;w.AFrameworkApplication.ta.Nb.yQa&&!b&&JD.a(1,this.n3n.bind(this))}n3n(){const b=[];if(w.AFrameworkApplication.K.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var h=[Object.assign(new aH,{label:CommonUIStrings.L_DiagnosticsSessionId,
value:w.AFrameworkApplication.userSessionId}),Object.assign(new aH,{label:CommonUIStrings.L_DiagnosticsBuild,value:w.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",h))}b.push.apply(b,this.o9h());h=document.createElement("div");document.body.appendChild(h);appChrome.renderFileMenu(h,b)}xVn(){this.ga.qa(Wa.a.OTa,sc.a.view,this.OTa.bind(this));this.ga.qa(Wa.a.H8f,sc.a.view,this.H8f.bind(this));this.ga.qa(Wa.a.I8f,sc.a.view,this.I8f.bind(this))}activateRibbonTab(b){this.Oqk(b)}rgc(){Sk.a.get_instance().isCompleted(7)&&
this.Wjd&&(hj.a.mark(4893),jv.a.iZo(),super.rgc(),hj.a.mark(4894))}OTa(b,h,v,D,P){if(2===P[Fy.a.Kx]){if(v=Object(Na.a)(Wn.a,h))D=Object(Na.a)(Dx.a,v.view);else return u.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(h),b,jb.a.join(P," ",":")),8;if(D&&""!==D.hJ)Ni.a.rha(h)&&Ni.a.Jac()||(this.Ub.mg(D.hJ),appChrome.selectors.getShyState().isActive&&HF.ShyRibbon.Geb(0,1));else return u.ULS.sendTraceTag(38549529,
338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(v.view),b,jb.a.join(P," ",":"),this.W0l(v.view)),8}return 32}W0l(b){return b?"is ContentEditableView: "+b.Oj+" is Editing View: "+b.zwa+" is HtmlView: "+b.X2a+" is InteractiveView: "+b.te+" is NavigationPaneView: "+b.aPm+" is PageView: "+b.Wi+" is WordNavigationPaneHeadingsView "+b.E0d:"null view"}}IF.rik="WACRibbon";Object(n.a)(IF,"ReactRibbonUser",
cH,[157,158,128,10]);class TI extends IF{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc=null,id,vd){super(b,h,v,D,P,ca,ta,Ra,mb,!1,Jb,Lc);this.ICk=()=>{this.Jp&&this.Jp.execute(xe=>{xe.logActivity("WordShyRibbon",null)});return 32};this.aAm=()=>{si.a.instance.qf(ni.a.mBm,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(xe=>{var Ld;this.cMa&&xe.push.apply(xe,this.pji());(this.ngh||this.ogh)&&this.Icb&&xe.push.apply(xe,this.aQl());xe.push(appChrome.actions.setControlCustomTooltip(gb.a.UZm,
CommonUIStrings.l_LoopsLearnMoreTooltip));w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.Noa&&this.Wqo();var Qd=null===(Ld=w.AFrameworkApplication.K)||void 0===Ld?void 0:Ld.jb("ReactShyRibbonPreferenceCookieName");Ld=$b.a.get(Qd);w.AFrameworkApplication.K.$("IsO365ConsumerHost")&&appChrome.api.isSmallDevice()&&!appChrome.api.isVerySmallDevice()&&w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.xJ&&""===Ld&&w.AFrameworkApplication.ue("66h8i182;1ha8c781");xe.push.apply(xe,this.BEa());
xe.push(appChrome.actions.setControlBehaviorAttached(!0));const Zd=Ea.a.instance.resolve("WordEditor.IModeSwitcherControl");Ld=Zd.z0l();w.AFrameworkApplication.ue("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&(Qd=appChrome.selectors.getModeSwitcherMode())&&Qd!==Ld.activeMode&&u.ULS.sendTraceTag(527778651,306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${Ld.activeMode}, Actual: ${Qd}`);
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&(Qd=Wr.a.MWd(zo.a.Ptj,null,document.getElementById("WACToolbarContainer"),!1),Qd.RH=!0,this.hRn(Qd,Wa.a.U5c,Wa.a.T5c));"Suggest"===Ld.activeMode||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===Ld.activeMode?appChrome.getUpdateAppModeAndTabsActions(Ld,!0).then(te=>{appChrome.api.dispatch(xe.concat(te));Zd.$Ni();
this.Ari()}):(xe.push(appChrome.actions.updateModeSwitcher(Ld)),appChrome.api.dispatch(xe),Zd.$Ni(),this.Ari())})};this.Icb=Ub;this.ngh=cc;this.ogh=Ac;this.Jp=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");this.Gb=id;this.VBe=vd}lBm(){u.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");Sk.a.get_instance().$H(5);const b=this.OCf&&w.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?12:10;Sk.a.get_instance().Ak(b,this.aAm,11);w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",
!1)&&this.Fuk()}Fuk(){this.Gb.Vb(new qf.a(5,1,0,()=>{this.VBe.execute(b=>{b.Kmo()})}))}aQl(){const b=[];this.ngh&&(b.push(appChrome.actions.setButtonSecondaryText(gb.a.XHd,this.Icb.Ytm)),b.push(appChrome.actions.setButtonSecondaryText(gb.a.qGd,this.Icb.Xtm)),b.push(appChrome.actions.setButtonSecondaryText(gb.a.p$d,this.Icb.Ztm)));this.ogh&&b.push(appChrome.actions.setButtonSecondaryText(gb.a.m$d,this.Icb.$tm));return b}Wqo(){this.Jp&&appChrome.api.isSmallDevice()?this.Jp.execute(b=>{b.logActivity("ShyRibbonSmallScreenActivity",
null)}):this.Jp.execute(b=>{b.logActivity("ShyRibbonNormalScreenActivity",null)});w.AFrameworkApplication.va.eb(Wa.a.msh,ud.a.frame,this.ICk,96)}hRn(b,h,v){const D=Xb.KeyInputManager.jc(Ve.a.Dw,0),P=Xb.KeyInputManager.jc(Ve.a.Dw,4);b.jr(D);b.jr(P);b.bindAction(D,h);b.bindAction(P,v)}Ari(){w.AFrameworkApplication.egc.SRo();this.Enh();this.f5e();this.vri();Sk.a.get_instance().$H(7);si.a.instance.ofa(ni.a.AEc,ni.a.W9n,(new Date).getTime())}JIa(b){if(b){const h=this.p$h();try{super.JIa(b)}finally{null===
h||void 0===h?void 0:h.dispose()}}}BEa(){const b=this.p$h();try{return super.BEa()}finally{null===b||void 0===b?void 0:b.dispose()}}p$h(){var b;let h=void 0;const v=null===(b=Xa.App.Xj)||void 0===b?void 0:b.zl;v&&(h=new eh.GraphTransaction(Xa.App.bxi()&&Xa.App.$Df?0:2),h.set(v));return h}}Object(n.a)(TI,"ReactRibbonUser",IF,[]);class UI extends YG{constructor(b,h,v,D,P,ca,ta,Ra){super(b,h,v);this.zGe=w.AFrameworkApplication.K.$("PasteWithOptionsFromRibbon")&&aa.a.k4;this.Pl=P;this.sPe=ca;this.Gb=
ta;this.VBe=Ra}mel(b,h){const v=new JE(w.AFrameworkApplication.K,this.ga,this.Ub,this.zGe),D=new hM.a(v);return this.Mel(b,h,D,v)}Mel(b,h,v,D){var P=new BI(new CI(w.AFrameworkApplication.K,D),v);v=this.JAm(P);const ca={};P.Mob(ca);P=!aa.a.k4;const ta=aa.a.Aq||aa.a.lj;var Ra=aa.a.Wk;w.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(Ra=aa.a.ti||Ra);Ra=new WD.a(Ra);b=new TI(b,h,WordEditorIntl.WordEditorStrings,this.Mtb,D,b,this.Pl,v,new xI(ca),this.sPe,Ra,P,ta,new AI,this.Gb,this.VBe);
b.lBm();return b}JAm(b){const h={};b.t7c(h);b.Bbd(h);return new yI(null,h,"jewelWordEditor")}}Object(n.a)(UI,"WordEditorRibbonUserFactory",YG,[]);class dH{constructor(b,h){this.eA=b;this.Mpd=h}sOa(b,h,v,D=null,P=null){return this.Mpd.wqj(b)?this.Mpd.sOa(b,h,v,D,P):this.eA.sOa(b,h,v,D,P)}FFa(b,h=null){return this.Mpd.wqj(b)?this.Mpd.FFa(b):this.eA.FFa(b,h)}}Object(n.a)(dH,"RootCuiUser",null,[332]);class VI extends dH{constructor(b,h){super(b,h)}clearCache(){this.eA.clearCache()}}Object(n.a)(VI,"WordGeneralCuiUser",
dH,[331,332]);var qM=c(1466);class mG{static getSelectedText(){const b=(new on.a).buf();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static YRd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=G.a.yz(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}}Object(n.a)(mG,"SearchUtils",null,[]);class Iy extends YD{constructor(b,h,v){super(b,v);this.kI=h}pnf(b){const h=[],v=Yh.a.instance.gb.kb,D=!!this.kI&&this.kI.TVc(Gb.a.U6e.toString()),P=!!this.kI&&this.kI.TVc(Gb.a.BMb.toString()),
ca=!D&&!v.M2a&&Iy.s6a.qOi(),ta=!!this.kI&&this.kI.TVc(Wa.a.newComment.toString())||!!Sc.a.instance&&(3===Sc.a.instance.mode||2===Sc.a.instance.mode),Ra=v.XBi()&&w.AFrameworkApplication.ta.Nb.LVc;var mb=!1;if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1)){mb=!!v&&(v.Cx||2===v.length&&$e.SelectionEditor.Hk(v.Pc));var Jb=mG.getSelectedText();mb=mb&&0<Jb.length&&60>Jb.length}b=(Jb=3===b||aa.a.ti||w.AFrameworkApplication.hmf)&&
Iy.ahf.L_(v,b);Jb&&h.push(this.Pl.pEa("ClipboardGroup")[0].externalUxGroupId);ca&&(h.push(this.Pl.pEa("TextFormattingGroup")[0].externalUxGroupId),h.push(this.Pl.pEa("StylesGroup")[0].externalUxGroupId));mb&&h.push(this.Pl.pEa("DefineGroup")[0].externalUxGroupId);D&&h.push(this.Pl.pEa("PictureToolsGroup")[0].externalUxGroupId);P&&h.push(this.Pl.pEa("TableToolsGroup")[0].externalUxGroupId);Ra&&h.push(this.Pl.pEa("EquationToolsGroup")[0].externalUxGroupId);ta&&h.push(this.Pl.pEa("CommentGroup")[0].externalUxGroupId);
b&&h.push(this.Pl.pEa("ContextMenuGroup")[0].externalUxGroupId);qM.a.Mvi&&Iy.NJm&&h.push(this.Pl.pEa("DesignerGroup")[0].externalUxGroupId);return h}static get ahf(){return null!=Iy.ryg?Iy.ryg:Iy.ryg=Ea.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static get s6a(){return null!=Iy.BGg?Iy.BGg:Iy.BGg=Ea.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static GSc(b,h,v,D){b.XKk(()=>Iy.$eb(h,v,D))}static $eb(b,h,v){return new Iy(b,h,v)}static get NJm(){null===this.xFe&&(w.AFrameworkApplication.ue("DesignerInContextMenuConsumerExp;DesignerInContextMenuConsumerExpCf"),
this.xFe=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerInContextMenuConsumerExpIsEnabled",!1):!1);return this.xFe}}Iy.xFe=null;Object(n.a)(Iy,"WordReactFloatie",YD,[]);class eH{constructor(){this.hea=this.KBc=this.W=null}get name(){return"WordEditor.UI"}init(){var b;this.W.resolve("WordEditor.UI.BusinessBarController").kZf();const h=Xa.App.Ev.NI,v=Xa.App.xa;Iy.GSc(v,this.W.resolve("Common.IReactContextualUILauncher"),h,this.W.resolve("Common.IExternalUICommandDefinitionMapping"));
this.hea=this.W.Na("Box4.IContextMenuController");const D=new FE(v,h,this.W.Sa("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.PasteFloatieManager")),P={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:P["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:P["floatie.gbMatchDocumentFormattingButton"]=
!1;break;case 3:P["floatie.gbUseSmartPasteButton"]=!1}D.GSc("PasteFloatieData",null,P);this.W.resolve("WordEditor.UI.CuiActionBridge").initialize();(new oI(v,h,this.W.Sa("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.ExternalContentFloatieManager"))).GSc("ExternalContentFloatieData",[WordEditorIntl.WordEditorStrings],{});this.W.resolve("Box4.IGeneralCuiUser");Sk.a.get_instance().Ak(7,()=>{this.KBc=this.W.resolve("WordEditor.UI.StatusBarUser");this.KBc.Tb()})}dispose(){this.KBc&&(this.KBc.dispose(),
this.KBc=null);this.hea&&(this.hea.dispose(),this.hea=null)}xc(b){this.W=b;b.ha("WordEditor.UI.BusinessBarController",()=>new $D(b.resolve("CommonUI.IBusinessBar"),b.resolve("CommonUI.IBusinessBarEntryFactory"),w.AFrameworkApplication.va,w.AFrameworkApplication.K)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").singleInstance();let h=aa.a.Wk;w.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=aa.a.ti||h);b.ha("Box4.UI.ShortcutHintMapping",
()=>new WD.a(h));const v=aa.a.Aq||aa.a.lj,D=w.AFrameworkApplication.K.$("PasteWithOptionsFromContextMenu")&&(aa.a.k4||v),P=w.AFrameworkApplication.K.$("CatchUpActivityIsEnabled");b.ha("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new nt(Ea.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),Ea.a.instance.resolve("Box4.Intent.IIntentRangeEditor"),new Mc.a)).singleInstance();b.ha("WordEditor.UI.EditSurfaceContextMenu",()=>new Bo(w.AFrameworkApplication.va,b.resolve("Box4.UI.IProofingContextMenuSectionFactory"),
b.resolve("Box4.Proofing.IErrorRangeEditor"),w.AFrameworkApplication.K,b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,P?b.Sa("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.ILanguageReader"),b.Na("Box4.Intent.IIntentRangeEditor"),b.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),b.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),
b.Sa("Box4.IPresenceDataManager"),b.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Sa("WordEditor.ContextualSearch.ISearchSuggestionManager"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),b.resolve("WordEditor.Designer.IDesignerControl"),b.resolve("WordEditor.Bookmark.FullBookmarkManager"),D,v?b.resolve("Box4.UI.ShortcutHintMapping"):null,Ea.a.instance.Sa("Common.IActionContextProvider"),Ea.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),
b.resolve("Box4.IParagraphReader"),b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),b.Na("WordEditor.Designer.Review.IReviewTraverser"))).as("Box4.UI.AEditSurfaceContextMenu").singleInstance();b.ha("Box4.ISelectionContextMenuProvider",()=>new Mx).singleInstance();b.ha("WordEditor.UI.CuiActionBridge",()=>new Ul(w.AFrameworkApplication.K)).as("Box4.UI.CuiActionBridge").singleInstance();b.ha("WordEditor.UI.DialogFactory",()=>new nI).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").singleInstance();
b.ha("Common.NonCanvasCuiUser",()=>new oF(bd.FocusManager.instance())).as("Common.INonCanvasCuiUser").singleInstance();b.ha("WordEditor.UI.WordGeneralCuiUser",()=>new VI(b.resolve("Box4.IGeneralCuiUser"),b.resolve("Common.INonCanvasCuiUser"))).singleInstance();b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.StatusBarUser",()=>new sI(Xa.App.xa.Egg,b.Sa("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),w.AFrameworkApplication.va,w.AFrameworkApplication.K,Xa.App.xa)).as("WordEditor.IStatusBarUser").singleInstance();
b.ha("WordEditor.IWordEditorNavigationPaneContextMenu",()=>new EF).singleInstance();const ca=b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("CommandUI.ReactRibbonRoot",()=>new zz(Kt.instance,b.resolve("Common.IExternalUICommandDefinitionMapping"),ca)).singleInstance();const ta=b.Sa("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.WordEditorRibbonUserFactory",()=>new UI(ta,w.AFrameworkApplication.va,bd.FocusManager.instance(),b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),
b.resolve("Common.IExternalUICommandDefinitionMapping"),b.resolve("CommandUI.ReactRibbonRoot"),w.AFrameworkApplication.nc,b.Sa("Common.App.PenMinutesManager.IPenMinutesManager"))).as("Wonca.IRibbonUserFactory").singleInstance();b.ha("WordEditor.UI.ReactLanguageDialog",()=>new FF(b.resolve("Box4.UI.ILanguageEditor"),b.resolve("Box4.UI.ILanguageListHelper"))).as("Box4.UI.ILanguageDialog");b.ha("WordEditor.UI.WordEditorRibbonSQMInformation",()=>new wI(w.AFrameworkApplication.va)).as("Common.IRibbonSQMInformation").singleInstance();
b.ha("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new uI(w.AFrameworkApplication.va)).as("Common.IFileMenuSQMInformation").singleInstance();b.ha("WordEditor.UI.RulerUser",()=>new pI).as("WordEditor.IRulerUser");b.ha("WordEditor.UI.RulerContextMenu",()=>new kD(w.AFrameworkApplication.va,Ea.a.instance.Sa("Common.IZoomManager"),Jr.a.instance)).as("WordEditor.IRulerContextMenu").singleInstance();b.ha("Common.IReactContextualUILauncher",()=>new UD(b.resolve("CommandUI.ReactRibbonRoot"),b.resolve("Common.IExternalUICommandDefinitionMapping"))).singleInstance();
b.ha("Box4.IContextMenuController",()=>new zF(b.resolve("Common.IReactContextualUILauncher"))).singleInstance()}static main(){w.AFrameworkApplication.ue("5b6i5792;30d4f535");sp.instance.dWh();sp.instance.Khf();N.a.instance.Fc(new eH,6)}}Object(n.a)(eH,"WordEditorUIPackage",null,[1,2]);var rM=window.ExternalContentFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",
ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},
children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",
Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},DD={};DD.Nnc=function(){function b(){return ta()&&(id()||3<=(cc()?vd("version/"):0))}function h(){return 0<=window.navigator.userAgent.indexOf("Windows")}function v(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function D(Hf){Hf=(new RegExp(Hf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Gi=-1;
null!=Hf&&2<=Hf.length&&(Gi=parseFloat(Hf[1]),isNaN(Gi)&&(Gi=-1));return Gi}function P(){WI||(WI=!0,XI=D("Windows Phone"));return 8<=XI}function ca(){return"function"==typeof navigator.msLaunchUri&&!v()&&!Lc()&&!Ra()}function ta(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Ra(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function mb(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Jb(){return mb()?
8==window.document.documentMode:!1}function Ub(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function cc(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Ac(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Lc(){var Hf=window.navigator.userAgent.toLowerCase();return 0<=Hf.indexOf("android")&&0<=Hf.indexOf("chrome")}function id(){return 3<=(Ub()?vd("firefox/"):0)}function vd(Hf){var Gi=window.navigator.userAgent.toLowerCase(),Pj=Gi.indexOf(Hf);
return 0<=Pj?parseInt(Gi.substring(Pj+Hf.length,Gi.length)):0}function xe(Hf,Gi,Pj,Pk,So){if(Pk&&null!=Gi)Gi();else if(ca())navigator.msLaunchUri(Hf,Gi,Pj);else if(!(Ac()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&ta())||Ra())Qd(Hf,Gi,Pj);else if(Ac()&&So)a:{try{window.open(Hf,"_self")}catch(Ls){null!=Pj&&Pj();break a}null!=Gi&&Gi()}else Ld(Hf,Gi,Pj)}function Ld(Hf,Gi,Pj){var Pk=document.getElementById("OICLinkTag");
null==Pk&&(Pk=document.createElement("a"),Pk.id="OICLinkTag",Pk.style.visibility="hidden",Pk.href="",0==(Pq.Options&Jy.SupportsTopTargetNavigation)||Pq.NoBrowserModalDialogs?Pk.target="_blank":Pk.target="_top",document.body.appendChild(Pk),null!=Pk.addEventListener&&Pk.addEventListener("click",function(So){null!=So.stopPropagation&&So.stopPropagation()},!1));try{Pk.href=Hf,Pk.dispatchEvent(new MouseEvent("click"))}catch(So){null!=Pj&&Pj();return}null!=Gi&&Gi()}function Qd(Hf,Gi,Pj){var Pk=document.getElementById("OICFrame");
null==Pk&&(Pk=document.createElement("iframe"),Pk.className="ObjectInDialog",Pk.style.visibility="hidden",Pk.src="about:blank",document.body.appendChild(Pk),Pk.id="OICFrame");try{Pk.contentWindow.location.href=Hf}catch(So){null!=Pj&&Pj();return}null!=Gi&&Gi()}function Zd(Hf){return 0!=(Hf.Options&Jy.SkipProtocolHandler)||Jb()}function te(Hf){return Hf===ED.ReadOnly||Hf===ED.ReadWrite}function Qf(Hf,Gi,Pj,Pk){var So;try{var Ls=new ActiveXObject("SharePoint.OpenDocuments.4");return(So=Ls.ViewDocument3(window.self,
Hf,Gi,Pk))?(ME(BC.O14ActiveX),Tp.None):Tp.Failed}catch(cs){}if(Jy.O14Only===(Pj&Jy.O14Only))return Pq.DescriptiveUnattemptedEnums?Tp.O14AttemptFailure:Tp.Unattempted;try{return Ls=new ActiveXObject("SharePoint.OpenDocuments.3"),(So=Ls.ViewDocument3(window.self,Hf,Gi,Pk))?(ME(BC.O12ActiveX),Tp.None):Tp.Failed}catch(cs){}if(Jy.O12UpOnly===(Pj&Jy.O12UpOnly))return Pq.DescriptiveUnattemptedEnums?Tp.O12UpOnlyFail:Tp.Unattempted;try{return Ls=new ActiveXObject("SharePoint.OpenDocuments.2"),(So=te(Gi)?Ls.ViewDocument2(window.self,
Hf,Pk):Ls.EditDocument2(window.self,Hf,Pk))?(ME(BC.O11ActiveX),Tp.None):Tp.Failed}catch(cs){}return Pq.DescriptiveUnattemptedEnums?Tp.ActiveXUnattempted:Tp.Unattempted}function Jg(Hf,Gi,Pj,Pk,So){Hf==Nr.Visio&&Pj==ED.ReadWrite&&(Pj=ED.WriteOnly);Pk=Pk||v()&&!P();if(!Pk){Pk="";if(Hf==Nr.PowerPoint){Hf=Pk;Pk=Pq.DocumentExtension;Pj=te(Pj);var Ls=new Set([".pot",".potm",".potx"]),cs=new Set([".pps",".ppsm",".ppsx"]);Pj=Pj&&Ls.has(Pk)?"nft|ofc|":Pj&&cs.has(Pk)?"ofv|ofs|t|":!Pj&&cs.has(Pk)?"ofe|ofs|t|":
Pj?"ofv|ofc|":"ofe|";Pj=Hf+Pj}else Pj=te(Pj)?Pk+"ofv|ofc|":Pk+"ofe|";Pk=Pj;Pq.NewTelemetryDataIsEnabled&&(Pj=Pq.SessionOrigin?"or|"+Pq.SessionOrigin:"",Pj+=Pq.ClickTime?"ct|"+Pq.ClickTime:"",Pj+=Pq.CorrelationId?"cid|"+Pq.CorrelationId:"",So+=Fm(Pj));So+=Fm(Pk+"u|")}So+=Fm(Gi);Gi=window.location.href;Pj=Gi.toLowerCase().indexOf("&wdlor=");-1!=Pj?(Pj+=7,Hf=Gi.indexOf("&",Pj),Gi=-1==Hf?Gi.substr(Pj):Gi.substring(Pj,Hf)):Gi=void 0;if(null!=Gi&&"undefined"!=typeof Gi){Pj="";try{Pj=decodeURIComponent(Gi)}catch(NE){}0<
Pj.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Pj)&&(So=So+"|f|"+Pj)}return So}function Ml(Hf,Gi,Pj,Pk,So,Ls){var cs=YI(Hf);if(null==cs)return eE(Pq.DescriptiveUnattemptedEnums?Tp.ProtocolHandlerIsNull:Tp.Unattempted,Pq.Application),!1;Hf=Jg(Hf,Gi,Pj,Pk,cs);xe(Hf,qp,wv,So,Ls);return!0}function Fm(Hf){if(ta()&&Ac()){var Gi="";try{Gi=decodeURI(Hf)}catch(Pj){}if(Gi==Hf)return encodeURI(Hf)}return Hf}function qp(){ME(BC.ProtocolHandler)}function wv(){Pq.Options|=Jy.SkipProtocolHandler;
ZI(Pq,OE,PE)}function jD(){null!=fH&&fH(BC.RoamingProtocolHandler)}function CB(){null!=gH&&gH(Tp.ControlNeeded)}function bE(){var Hf=document.getElementById("npSharePointPlugin");if(null==Hf){Hf="application/x-sharepoint";ta()&&3<=(cc()?vd("version/"):0)&&Az("application/x-sharepoint-webkit",!0)&&(Hf="application/x-sharepoint-webkit");if(!Az(Hf,!0))if(ta()&&Az("application/officelive",!0))Hf="application/officelive";else return null;var Gi=document.createElement("object");Gi.id="npSharePointPlugin";
Gi.type=Hf;Gi.style.width="0px";Gi.style.height="0px";Gi.style.setProperty("visibility","hidden","");document.body.appendChild(Gi);Hf=document.getElementById("npSharePointPlugin")}return Hf}function Az(Hf,Gi){var Pj=window.navigator.mimeTypes;if(null==Pj)return!1;Hf=Pj[Hf];return!Hf||Gi&&!Hf.enabledPlugin?!1:!0}function nG(Hf){try{if(null!=new ActiveXObject(Hf))return!0}catch(Gi){}return!1}function hH(Hf){switch(Hf){case Nr.OneNote:return"OneNote.Notebook";default:return""}}function YI(Hf){if(Hf!=
Nr.OneNote&&v()&&!P())return"office:";switch(Hf){case Nr.Excel:return"ms-excel:";case Nr.OneNote:return"onenote:";case Nr.PowerPoint:return"ms-powerpoint:";case Nr.Visio:return"ms-visio:";case Nr.Word:return"ms-word:";case Nr.Project:return"ms-project:";case Nr.Publisher:return"ms-publisher:";case Nr.Infopath:return"ms-infopath:";case Nr.Access:return"ms-access:";default:return""}}function sM(Hf){switch(Hf){case Nr.Excel:return"root\\office15\\excel.exe";case Nr.PowerPoint:return"root\\office15\\powerpnt.exe";
case Nr.Visio:return"root\\office15\\visio.exe";case Nr.Word:return"root\\office15\\winword.exe";case Nr.Project:return"root\\office15\\winproj.exe";case Nr.Publisher:return"root\\office15\\mspub.exe";case Nr.Infopath:return"root\\office15\\infopath.exe";case Nr.Access:return"root\\office15\\msaccess.exe";default:return null}}function ZI(Hf,Gi,Pj){Pq=Hf;OE=Gi;PE=Pj;if(Hf.DocumentUrl){var Pk=Pj=Gi=Hf.DocumentUrl;try{Pk=decodeURIComponent(Hf.DocumentUrl)}catch(QE){}try{Pj=encodeURI(Hf.DocumentUrl)}catch(QE){}Gi=
Gi+""+Hf.CorrelationIdForWinClient;Pk+=Hf.CorrelationIdForWinClient;Pj+=Hf.CorrelationIdForWinClient;Hf.Mode===ED.ReadWrite&&Jy.CheckoutRequired===(Hf.Options&Jy.CheckoutRequired)&&(Hf.Mode=ED.ForceCheckout);Jy.HostIsEditOnly===(Hf.Options&Jy.HostIsEditOnly)&&(Hf.Mode=ED.WriteOnly);if(Zd(Hf)?0:ta()&&(Hf.Application==Nr.OneNote||Az("application/x-sharepoint-protocolhandler",!1)||Az("application/x-sharepoint-webkit-protocolhandler",!1))||ca()||Lc()||!(b()||id()||"ActiveXObject"in window&&!v()||Ac())||
15<=oG())Ml(Hf.Application,Hf.EncodeUrl?Pj:Gi,Hf.Mode,Hf.Application==Nr.OneNote,Hf.SilentExternalHandler,Hf.NavigateUsingWindowOpen);else{var So;if(So=Jb())a:{var Ls=Hf.EncodeUrl?Gi:Pk,cs=Hf.Mode,NE=hH(Hf.Application);try{So=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,Ls,cs,NE);break a}catch(QE){}So=!1}if(So)ME(BC.O15ActiveX);else{if(b()||id()){var gu=Hf.EncodeUrl?Gi:Pk;Pk=Hf.Mode;So=hH(Hf.Application);Ls=bE();if(null==Ls)gu=Pq.DescriptiveUnattemptedEnums?Tp.PluginIsNull:
Tp.Unattempted;else{cs=!1;try{cs=Ls.ViewDocument3(window.self,gu,Pk,So)}catch(QE){}if(!cs)try{cs=te(Pk)?Ls.ViewDocument2(window.self,gu,So):Ls.EditDocument2(window.self,gu,So)}catch(QE){}cs?(ME(BC.NpapiPlugin),gu=Tp.None):gu=Tp.Failed}}else{try{gu=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=gu&&gu.SaveSSOCreds()}catch(QE){}gu=Qf(Hf.EncodeUrl?Gi:Pk,Hf.Mode,Hf.Options,hH(Hf.Application))}if(gu!=Tp.None){if(Pk=Hf.CouldUseRoamingApps)$I||($I=!0,aJ=D("Windows NT")),Pk=6.1<=aJ&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&
(mb()||id()||Ac());if(Pk&&Hf.Application!=Nr.OneNote){if(!DD.Nnc.Y9o()){eE(Tp.ControlNeeded,Pq.Application);return}if(Hf.RoamingAppsLauncher){"undefined"==typeof Hf.RoamingAppsLauncher||null==Hf.RoamingAppsLauncher?eE(Pq.DescriptiveUnattemptedEnums?Tp.RoamingLauncherIsNull:Tp.Unattempted,Pq.Application):"undefined"==typeof Hf.RoamingBitsUrl||null==Hf.RoamingBitsUrl?DD.Nnc.Aap(Hf.DocumentUrl,Hf.RoamingAppsLauncher,Hf.Application,Hf.ApplicationParameters,OE,PE):DD.Nnc.eQj(Hf.DocumentUrl,Hf.RoamingAppsLauncher,
Hf.RoamingApplicationExe,Hf.ApplicationParameters,Hf.RoamingPlatform,Hf.RoamingBitsUrl,OE,PE);return}if(!Hf.ContinueIfLauncherIsNull){eE(Tp.LauncherNeeded,Pq.Application);return}}Jy.NoProtocolHandlerFallback==(Hf.Options&Jy.NoProtocolHandlerFallback)||Zd(Hf)||mb()||ta()&&!(Pq.DescriptiveUnattemptedEnums?gu>=Tp.O14Unattempted&&gu<=Tp.DocumentUrlIsNull:gu==Tp.Unattempted)?eE(gu,Pq.Application):Ml(Hf.Application,Hf.EncodeUrl?Pj:Gi,Hf.Mode,Hf.Application==Nr.OneNote,Hf.SilentExternalHandler,Hf.NavigateUsingWindowOpen)}}}}else eE(Pq.DescriptiveUnattemptedEnums?
Tp.DocumentUrlIsNull:Tp.Unattempted,Pq.Application)}function ME(Hf){null!=OE&&OE(Hf)}function eE(Hf,Gi){"undefined"==typeof Gi&&(Gi=null);null!=PE&&PE(Hf,Gi)}function oG(){var Hf=0;if(b()||id()||Ac()){var Gi=bE();try{null!=Gi&&(Hf=Gi.GetOfficeVersion())}catch(Pj){}}else nG("SharePoint.OpenDocuments.5")?Hf=15:nG("SharePoint.OpenDocuments.4")?Hf=14:nG("SharePoint.OpenDocuments.3")?Hf=12:nG("SharePoint.OpenDocuments.2")&&(Hf=11);return Hf}function bJ(){return ta()&&(Az("application/x-sharepoint",!0)||
Az("application/x-sharepoint-webkit",!0))}var cJ="",dJ="",eJ="",OE,PE,fH,gH,Pq,$I,aJ,WI,XI,ED={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Jy={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Tp={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,
ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},BC={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Nr={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:ED,OpenDocumentOptions:Jy,OpenDocumentFailureType:Tp,OpenDocumentControl:BC,OfficeApplication:Nr,EditDocumentInClient:ZI,
EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=Nr.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=
this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:oG,IsO14MacPluginInstalled:bJ,OfferOfficeInDialog:function(){return h()&&11>=oG()},OfferOfficeNoIntrusive:function(){return h()&&15>oG()},OfferMacOffice:function(){return ta()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!bJ()},InstallRoamingControl:function(){Ub()?window.InstallTrigger.install({Office:{URL:dJ}}):Qd(eJ,null,null)},CanUseRoamingControl:function(){if(ca())return!0;if(Ac())return"undefined"!=typeof navigator.plugins.refresh&&
navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Ub()){var Hf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Hf);var Gi=document.createEvent("Events");Gi.initEvent("RoamingOfficeInstalled",!0,!1);Hf.dispatchEvent(Gi);return!!Hf.getAttribute("installed")}if(mb())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Pj){}return!1},InitUrls:function(Hf,Gi,Pj){cJ=Hf;dJ=Pj;eJ=Gi},LaunchRoamingApps:function(Hf,
Gi,Pj,Pk,So,Ls){DD.Nnc.eQj(Hf,Gi,sM(Pj),Pk,"x86",cJ,So,Ls)},LaunchRoamingApps2:function(Hf,Gi,Pj,Pk,So,Ls,cs,NE){var gu="";null!=Pk&&(gu+=" "+Pk);null!=Hf&&(gu+=' "'+Hf+'"');if(ca()||Ac())fH=cs,gH=NE,cs='office: "'+(Ls+'" "')+(Pj+'" "ROAMING"'),cs+=' "'+Gi+'"',cs+=' "'+So+'"',cs+=" "+gu,xe(cs,jD,CB,!1,!1);else if(Ub())Hf=document.createElement("RoamingExtensionElement"),Hf.setAttribute("cabUrl",Ls),Hf.setAttribute("app",Pj),Hf.setAttribute("licensingEntitlements",Gi),Hf.setAttribute("platform",So),
Hf.setAttribute("args",gu),document.documentElement.appendChild(Hf),Gi=document.createEvent("Events"),Gi.initEvent("RoamingOfficeLaunch",!0,!1),Hf.dispatchEvent(Gi),null!=cs&&cs(BC.RoamingFFExtension);else if(mb()){if(Hf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Hf)try{Hf.HrConfigureSingle(Ls,Pj,Gi,So,gu),null!=cs&&cs(BC.RoamingActiveX)}catch(QE){}}else null!=NE&&NE(Tp.Failed)},ShouldShowDialog:function(){return!v()},NavigateToUrlUsingClickingOnATag:Ld,OpenDocumentWithProtocolHandler:Ml,
OpenDocumentWithProtocolHandlerNoCallBack:function(Hf,Gi,Pj,Pk){var So=YI(Hf);if(null==So)return eE(Pq.DescriptiveUnattemptedEnums?Tp.ProtocolHandlerNoCallbackIsNull:Tp.Unattempted,Pq.Application),!1;Hf=Jg(Hf,Gi,Pj,Pk,So);xe(Hf,null,null,!1,!1);return!0}}}();DD.ClientUtils=DD.Nnc;var tM=c(1485);class pG{constructor(b,h,v){this.ga=b;this.w9j=h;this.H6=v}Tb(){this.ga.qa(Wa.a.tryMacOffice,ud.a.frame,Object(z.a)(this,this.wwn,"onTryMacOffice"));this.ga.qa(Wa.a.fDj,ud.a.frame,Object(z.a)(this,this.QYi,
"onTryMacOfficeFromViewer"));this.ga.qa(Wa.a.eDj,ud.a.frame,Object(z.a)(this,this.QYi,"onTryMacOfficeFromViewer"))}wwn(b,h,v,D,P){if(1===v)return 32;P?(b=P.SourceControlId,"btnjTryMacOfficeForWordEditor"===b?Dd.a.om(ia.a.f1a(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===b&&Dd.a.om(ia.a.f1a(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.QFi();return 32}QYi(b,h,v){if(1===v)return 32;switch(b){case Wa.a.fDj:Dd.a.om(ia.a.f1a(15),"_blank",
void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Wa.a.eDj:Dd.a.om(ia.a.f1a(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}QFi(){Dd.a.om(pG.q$m,"_blank",void 0,"LaunchMacTrialWindow")}get q8c(){return this.w9j&&aa.a.Wk&&!aa.a.yFf&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get Lto(){const b=this.q8c;b||w.AFrameworkApplication.Qm.who();return b}get Kto(){return this.q8c}static get q$m(){return ia.a.t8("522401")}}Object(n.a)(pG,"MacOfficeOffer",null,[1097]);class qG{constructor(b,
h,v){this.ga=b;this.B9j=h;this.eK=null;(this.Oxd=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Ea.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(D=>{this.eK=D});this.H6=v}Tb(){this.ga.qa(Wa.a.tryOffice,ud.a.frame,Object(z.a)(this,this.xwn,"onTryOffice"));this.ga.qa(Wa.a.olg,ud.a.frame,Object(z.a)(this,this.olg,"tryOfficeThroughTellMe"));this.ga.qa(Wa.a.kDj,ud.a.frame,
Object(z.a)(this,this.lDj,"tryOfficeThroughViewer"));this.ga.qa(Wa.a.jDj,ud.a.frame,Object(z.a)(this,this.lDj,"tryOfficeThroughViewer"))}xwn(b,h,v,D,P){if(this.Oxd&&1===v)return this.isFreemiumUpsellEnabled&&this.r8c?32:8;2===v&&(P?(b=P.SourceControlId,"btnjTryOfficeForWordEditor"===b?Dd.a.om(ia.a.f1a(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===b?Dd.a.om(ia.a.f1a(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.XIf()):this.XIf());return 32}olg(b,
h,v,D,P){if(this.Oxd&&1===v)return this.isFreemiumUpsellEnabled&&this.r8c?32:8;2===v&&(P?(b=P.SourceControlId,Dd.a.om(ia.a.t8("862405")+this.x8l(b),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Dd.a.om(ia.a.t8("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}lDj(b,h,v){if(this.Oxd&&1===v)return this.isFreemiumUpsellEnabled&&this.r8c?32:8;if(2===v)switch(b){case Wa.a.kDj:Dd.a.om(ia.a.f1a(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Wa.a.jDj:Dd.a.om(ia.a.f1a(24),
"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get xkn(){return this.r8c}get wkn(){return this.r8c&&MSOJS.ClientUtils.OfferOfficeInDialog()}get r8c(){return this.B9j&&!aa.a.Wk}get isFreemiumUpsellEnabled(){let b=!1;this.eK&&(b=this.eK.isFreemiumUpsellEnabled());return b}XIf(b=null){let h=0;b&&(h=b);Dd.a.om(qG.h2l(h),"_blank",void 0,"LaunchOfficeOffer")}x8l(b){let h=0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":h=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":h=
2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":h=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":h=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":h=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":h=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":h=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":h=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":h=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":h=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":h=
16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":h=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":h=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":h=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":h=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":h=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":h=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":h=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":h=
29}return 0===h?"":String.format("&pc={0:D}",h)}static h2l(b){if(aa.a.ti)switch(b){case 1:return ia.a.t8("393806");case 2:return ia.a.t8("393810");case 3:return ia.a.t8("393809");case 5:return ia.a.t8("393805")}else if(aa.a.EM)switch(b){case 1:return ia.a.t8("521979");case 3:return ia.a.t8("521980");case 5:return ia.a.t8("521978");case 2:return ia.a.t8("522490")}else{if(2===b)return ia.a.t8("517778");if(1===b)return ia.a.f1a(30)}return ia.a.t8("522402")}}Object(n.a)(qG,"OfficeTrialExperience",null,
[971]);class fJ{xc(b){b.register(qG,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").singleInstance().Rd(()=>new qG(w.AFrameworkApplication.va,w.AFrameworkApplication.cFf,w.AFrameworkApplication.lcid));b.register(pG,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").singleInstance().Rd(()=>new pG(w.AFrameworkApplication.va,w.AFrameworkApplication.yzi,w.AFrameworkApplication.lcid))}}Object(n.a)(fJ,"OpenInClientConfiguration",null,[2]);class gJ{constructor(b=
!1,h=!1,v=!1,D=!1,P=!0,ca=!1,ta=!0,Ra=!0,mb=!0,Jb=!1,Ub=!1,cc=!1,Ac=!1,Lc=!1,id=!1,vd=!1,xe=!1,Ld=!1,Qd=null,Zd=null,te=null,Qf=null,Jg=null,Ml=null,Fm=null,qp=null,wv=null){this.uac=!1;this.xfk=b;this.Cfk=h;this.Qjk=v;this.Ojk=D;this.Jjk=P;this.Kjk=ca;this.Mjk=ta;this.Njk=Ra;this.Ljk=mb;this.akk=Jb;this.vkk=Ub;this.$jk=cc;this.Qlk=Ac;this.Ujk=Lc;this.L7j=id;this.okk=vd;this.wkk=xe;this.qZj=Ld;this.Sjk=Qd;this.Zjk=Zd;this.Pjk=Jg;this.Xjk=te;this.Rjk=Qf;this.Wjk=Ml;this.Yjk=Fm;this.Tjk=qp;this.Vjk=
wv}get U0i(){return this.xfk}get xCn(){return this.Cfk}get sqj(){return this.Qjk}get rqj(){return this.Ojk}get Wso(){return this.Jjk}get Xso(){return this.Kjk}get Zso(){return this.Mjk}get $so(){return this.Njk}get Yso(){return this.Ljk}get Wob(){return this.Ujk}get CBm(){return this.L7j}get $qj(){return this.okk}get Drj(){return this.wkk}get xUk(){return this.qZj}get vqj(){return this.akk}get fvo(){return this.vkk}get ito(){return this.$jk}get kxj(){return this.Qlk}get tqj(){return this.Sjk||Object(z.a)(this,
this.Uhc,"returnFalse")}get hto(){return this.Zjk||Object(z.a)(this,this.Uhc,"returnFalse")}get gto(){return this.Xjk||Object(z.a)(this,this.t8f,"returnTrue")}get bto(){return this.Rjk||Object(z.a)(this,this.t8f,"returnTrue")}get ato(){return this.Pjk||Object(z.a)(this,this.Uhc,"returnFalse")}get fto(){return this.Wjk||Object(z.a)(this,this.t8f,"returnTrue")}get uqj(){return this.Yjk||Object(z.a)(this,this.Uhc,"returnFalse")}get cto(){return this.Tjk||Object(z.a)(this,this.Uhc,"returnFalse")}get eto(){return this.Vjk||
Object(z.a)(this,this.Uhc,"returnFalse")}t8f(){return!0}Uhc(){return!1}}Object(n.a)(gJ,"HtmlTranslatorSettings",null,[273]);class EB{constructor(b,h,v,D,P,ca,ta){this.Wf=b;this.characterPropertiesEditor=h;this.RW=v;this.Ijf=D;this.nj=P;this.Ld=ca;this.XQ=ta}ICm(b,h){var v;b=h.view;h=h.gk;if(!h||!this.Wf.mxi(h,!0)||this.Ijf&&this.Ijf.instance&&this.Ijf.instance.pU(h))return 2;var D=EB.d7a?!EB.P_.Gwa(h):!0;this.RW&&D&&this.RW.zmc(h.node,Ve.a.Fs,h.cpBegin);D=h.node;(null===(v=this.XQ)||void 0===v?0:
v.replaceText)&&this.XQ.Dbc(D)?(v=D.pa.Y_a(h.cpBegin),this.XQ.replaceText(D,v,v,ay.a.PXc)):this.characterPropertiesEditor.gha(h,P=>new ay.a(P));if(this.Ld.rg){v=new eh.GraphTransaction(15);try{v.Cb(h.node),this.nj.wqa(h.node,h.cpBegin,h.cpBegin+1,1)}finally{v&&v.dispose()}}D=h.node;v=h.cpEnd+1;" "===fe.ParagraphReader.text(D).charAt(v)&&(D=we.a.createTextRange(D,v,v+1),this.characterPropertiesEditor.replaceTextRange(D,"\u00a0"));h=we.a.Qc(h.node,v);b.lb.setSelection(Og.SelectionFactory.Nn(h));return 32}static get P_(){return null!=
EB.gBg?EB.gBg:EB.gBg=Ea.a.instance.resolve("Box4.IHyperlinkStrategy")}static get d7a(){null==EB.sla&&(EB.sla=w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return EB.sla}}EB.sla=null;Object(n.a)(EB,"InsertLineBreakStrategy",null,[]);class lw{static get eg(){return null!=lw.QEg?lw.QEg:lw.QEg=Ea.a.instance.resolve("Box4.IOutlineElementEditor")}static get Xg(){return em.ContextSetEditor.instance}static get nj(){return null!=lw.qIg?lw.qIg:lw.qIg=Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Ld(){return null!=
lw.VIg?lw.VIg:lw.VIg=Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static fDm(b,h,v,D,P){if(P&&P.hasProperty(Wc.a.targetObject)){var ca=h.view.Yc.Kc.Db(P.getValue(Wc.a.targetObject));ca=we.a.create(ca)}else ca=lw.Xg.iT(h.gk,11);if(!ca)return 8;b=w.AFrameworkApplication.va.Mf(ca,b,v,!0,D,P);if(32===b&&2===v){if(!h.view.te)return 2;h=h.view;D=h.lb.tg;if(D=lw.Xg.iT(D,11)){v=new Rl.a;v.set(D.node);v.vd();if(P&&P.hasProperty(Wc.a.targetObject))for(P=P.Gf(Wc.a.targetObject);!v.currentNode.id.equals(P)&&
v.wc()&&(hf.OutlineElementNavigator.Vd(v),11===v.We););hf.OutlineElementNavigator.t0(v,!1,!1);P=$e.SelectionEditor.WDa(v,!0);P=fe.ParagraphReader.wt(P)?Og.SelectionFactory.pe(P,0):Og.SelectionFactory.wq(P);h.lb.setSelection(P)}}return b}static bXd(b,h,v,D,P){b=b===Gb.a.cTc;h=h.node;if(P&&P.hasProperty(Wc.a.targetObject)&&!h.id.equals(P.Gf(Wc.a.targetObject)))return 2;if(1===v)return 32;v=new he.GraphIterator;v.set(h);v.zb(10);lw.eg.xz(v,b,!0);lw.Ld.rg&&(v=hf.OutlineElementNavigator.Ge(v),lw.nj.KOb(v,
1));return 32}}Object(n.a)(lw,"InsertOutlineElementStrategy",null,[]);class rG{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub){this.Asi=(cc,Ac,Lc)=>{var id,vd;if(null===(id=this.L$)||void 0===id?0:id.splitParagraph)return this.L$.splitParagraph(Lc,Ac.cpBegin,{Eb:Ac.Eb,Rb:Ac.Rb});id=!Ac.cpBegin;Lc=Ac.cpBegin===fe.ParagraphReader.textLength(Lc);const xe=!(null===(vd=Xa.App.rd)||void 0===vd||!vd.Qo);let Ld=!0;xe&&id&&!Lc?(Ld=!1,vd=new he.GraphIterator,vd.Zc(cc),vd.vd(),this.nh.xz(vd,!0,!1)):vd=this.nh.noa(cc);
this.nh.Z9(cc,vd,Ac,!1,!0,Ld,!1,!0);!xe||id||Lc||(cc=em.ContextSetEditor.instance.MOd(Ac),Xa.App.rd.Tp.VF(cc));return vd};this.YY=h;this.K2j=b;this.Yz=ca;this.Iak=P;this.nh=v;this.F0j=D;this.Jk=ta;this.hb=Ra;this.zE=mb;this.Nqc=Jb;this.L$=Ub}xhn(b,h,v,D,P){if(!h.view.te)return 2;h=h.view;let ca=null;h.Wi&&(ca=h);const ta=h.lb.tg;var Ra=!0;let mb=!1,Jb=null;if(!ta)return 2;const Ub=new eh.GraphTransaction(15);Ub.Cb(h.Yc);let cc=null;2===v&&(cc=new Rl.a,cc.set(ta.node),cc.vd(),Jb=new cy.a(cc),hf.OutlineElementNavigator.Vd(cc),
Ra=ig.OutlineElementReader.isEmpty(cc,!1),{Lqj:Ra,jLj:mb}=this.F0j.Mqj(cc,Ra,kt.a.dFb,-1,ta));b=w.AFrameworkApplication.va.Mf(ta,b,v,!1,D,P);Ra&&32===b&&2===v&&(mb||hf.OutlineElementNavigator.gGa(cc,!1,!$e.SelectionEditor.gf(ta),!1),mb&&Jb&&Jb.restore(cc),this.Yz.freeze(),(v=Og.SelectionFactory.ho(cc.currentNode,!0))||u.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),h.lb.setSelection(v),this.Yz.iIa(),this.K2j.Pg.kF());ca&&(Ra||ca.e5(),ca.editingView&&ca.qU&&(ca.editingView.bI=
!0));Fn.GrippersManager.instance.eRb(1);Ub.dispose();return b}newLine(b,h,v){b=!1;if(oe.ImageReader.i4(h)||oe.ImageReader.B2a(h))h=this.B7k(h),b=!0;const D=h;if((h=$e.SelectionEditor.gf(h))&&this.Jk.gh&&!this.Jk.gPm(D))return 2;if(1===v)return 32;const P=D.node,ca=new he.GraphIterator;ca.set(P);ca.vd();hf.OutlineElementNavigator.Vd(ca);v=new eh.GraphTransaction(15);v.Lt(ca);h?(this.Nqc.instance&&this.Nqc.instance.AIa(D),fe.ParagraphReader.Wb(P)&&D.cpBegin===fe.ParagraphReader.textLength(P)&&Yo.m(D)&&
9===fe.ParagraphReader.Ina(P)&&this.Yz.B8k(D),Vg.ListItemReader.yg(ca)?this.Iak.execute(ca,D,P,this.Asi):this.Asi(ca,D,P),this.YY&&this.YY.zmc(P,Ve.a.Fs,D.cpBegin),b&&(hf.OutlineElementNavigator.Xr(ca,!1,!1),b=ca.Sb(2),(b=this.zE.pe(b,0))&&this.hb.setSelection(b))):this.nh.xz(ca,!0,!0);v.dispose();Xa.App.xa&&Xa.App.xa.updateCommandUI();return 32}B7k(b){if(oe.ImageReader.i4(b))var h=we.a.Qc(b.node,b.cpBegin);else{h=fe.ParagraphReader.xQ(b.node);var v=h.properties.Gf(Bc.a.nq);b=b.node.properties.getValue(Bc.a.runId);
v=rG.ipf(b,v,h.pa);h=we.a.Qc(h,v)}return h}static Qkf(b,h){let v=0;for(;v<h.length&&!(b<h[v]);)v++;return v}static ipf(b,h,v){let D=0;b=rG.Qkf(b,h);let P=0;if(b===h.length)P=v.length-1;else for(;P<v.length;){h=v.J(P);if(h.formatting&&h.formatting.qe===b)break;P++}P<v.length&&(D=v.J(P).cp);return D}}Object(n.a)(rG,"NewLineStrategy",null,[]);class fE{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id,vd){this.Im=null;this.Gla=b;this.Kid=ta;this.Fpd=new rG(this,h,v,D,P,ca,Ra,Ub,cc,id,vd);this.u_g=new EB(Ra,
mb,h,Jb,Ac,Lc,vd)}get Pg(){return this.Im||(this.Im=this.Gla())}Tb(){const b=w.AFrameworkApplication.va,h=Object(z.a)(this.Fpd,this.Fpd.newLine,"newLine");b.eb(Gb.a.enter,sc.a.view,Object(z.a)(this.Kid.value,this.Kid.value.Exl,"enterView"),1124);b.eb(Gb.a.Spj,sc.a.view,Object(z.a)(this.Kid.value,this.Kid.value.Hro,"shiftEnterView"),1124);b.qa(Gb.a.newLine,sc.a.view,Object(z.a)(this.Fpd,this.Fpd.xhn,"newLineView"));b.qa(Gb.a.newLine,sc.a.Tc,h);b.qa(Gb.a.newLine,sc.a.image,h);b.qa(Gb.a.newLine,sc.a.Hd,
h);b.qa(Gb.a.newLine,sc.a.anchoredObject,h);b.qa(Gb.a.newLine,sc.a.embeddedFile,h);b.qa(Gb.a.newLine,sc.a.ink,h);b.qa(Gb.a.newLine,sc.a.paragraph,h);b.qa(Gb.a.newLine,sc.a.iFrame,h);b.qa(Gb.a.newLine,sc.a.unsupportedObject,h);b.Vc(Gb.a.newLine,1124);b.eb(Gb.a.ZSc,sc.a.view,Object(z.a)(this.u_g,this.u_g.ICm,"insertLineBreakView"),1028);b.qa(Gb.a.cTc,sc.a.view,lw.fDm);b.qa(Gb.a.cTc,sc.a.outlineElement,lw.bXd);b.Vc(Gb.a.cTc,1092)}static get instance(){return null!=fE.jCg?fE.jCg:fE.jCg=fE.Rl()}static Rl(){return new fE(()=>
Ea.a.instance.resolve("Box4.IUndoManager"),Ea.a.instance.Na("Box4.IAutoCorrectScheduler"),Ea.a.instance.resolve("Box4.IOutlineElementEditor"),Ea.a.instance.resolve("Box4.List.ICursorMovementValidator"),Ea.a.instance.resolve("Box4.List.ListNewLineStrategy"),Ea.a.instance.resolve("Box4.IInsertionPointFormatting"),Ea.a.instance.Ue("Box4.Actors.IEnterViewStrategy"),qi.a.instance,Ea.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ea.a.instance.Sa("Box4.IExternalSelectionManager"),Yh.a.instance,Ea.a.instance.resolve("Box4.ISelectionFactory"),
Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ea.a.instance.Sa("Box4.IContentControlConverter"),Ea.a.instance.resolve("Box4.IBox4GraphWriter"))}}Object(n.a)(fE,"EnterActor",null,[]);var iH=c(1393),jH=c(876);class Ck{static get paragraphEditor(){return null!=Ck.xFg?Ck.xFg:Ck.xFg=Ea.a.instance.resolve("Box4.IParagraphEditor")}static get s5(){return null!=Ck.$Gg?Ck.$Gg:Ck.$Gg=Ea.a.instance.Na("Box4.ISpacingCommands")}static get HTa(){return null!=
Ck.kHg?Ck.kHg:Ck.kHg=Ea.a.instance.Na("Box4.Styles.IWACStyleReader")}static get PFa(){return null!=Ck.RDg?Ck.RDg:Ck.RDg=Ea.a.instance.Na("Box4.ILineSpacingHelper")}static get nj(){return null!=Ck.zIg?Ck.zIg:Ck.zIg=Ea.a.instance.Na("Box4.TrackChange.ITrackChangeEditor")}static get Ld(){return null!=Ck.aJg?Ck.aJg:Ck.aJg=Ea.a.instance.Na("Box4.TrackChange.ITrackChangeManager")}static Tb(){const b=w.AFrameworkApplication.va;b.qa(Gb.a.HJf,sc.a.view,Gn.a.gw);b.Vc(Gb.a.HJf,1028);b.qa(Gb.a.eD,sc.a.view,Gn.a.gw);
b.qa(Gb.a.eD,sc.a.paragraph,Ck.eBd);b.Vc(Gb.a.eD,1036);b.qa(Gb.a.gjc,sc.a.paragraph,Ck.aFk);b.qa(Gb.a.gjc,sc.a.view,Gn.a.gw);b.Vc(Gb.a.gjc,1036);b.qa(Gb.a.v7c,sc.a.paragraph,Ck.T1e);b.qa(Gb.a.v7c,sc.a.view,Gn.a.gw);b.qa(Gb.a.V7c,sc.a.paragraph,Ck.n2e);b.qa(Gb.a.V7c,sc.a.view,Gn.a.gw);b.qa(Gb.a.u7c,sc.a.paragraph,Ck.S1e);b.qa(Gb.a.u7c,sc.a.view,Gn.a.gw);b.qa(Gb.a.h_e,sc.a.view,Ck.CAk);b.Vc(Gb.a.h_e,1036);b.qa(Gb.a.P5f,sc.a.view,Ck.Y2n);b.Vc(Gb.a.P5f,1036);b.qa(Gb.a.g_e,sc.a.view,Ck.BAk);b.Vc(Gb.a.g_e,
1036);b.qa(Gb.a.O5f,sc.a.view,Ck.X2n);b.Vc(Gb.a.O5f,1036);b.qa(Gb.a.lTa,sc.a.view,Gn.a.gw);b.qa(Gb.a.lTa,sc.a.paragraph,Ck.eBd);b.Vc(Gb.a.lTa,1036);b.qa(Gb.a.kTa,sc.a.view,Gn.a.gw);b.qa(Gb.a.kTa,sc.a.paragraph,Ck.eBd);b.Vc(Gb.a.kTa,1036);b.qa(Gb.a.bke,sc.a.view,Ck.ake);b.qa(Gb.a.bke,sc.a.paragraph,Ck.ake);b.Vc(Gb.a.bke,1028);b.qa(Gb.a.Yfg,sc.a.view,Ck.ake);b.qa(Gb.a.Yfg,sc.a.paragraph,Ck.ake);b.Vc(Gb.a.Yfg,1028);b.qa(Gb.a.Tje,sc.a.view,Gn.a.gw);b.qa(Gb.a.Tje,sc.a.paragraph,Ck.zuh);b.Vc(Gb.a.Tje,1028);
b.qa(Gb.a.Sje,sc.a.view,Gn.a.gw);b.qa(Gb.a.Sje,sc.a.paragraph,Ck.zuh);b.Vc(Gb.a.Sje,1028)}static zuh(b,h,v,D,P){if(1===v)return 32;b===Gb.a.Tje?b=Gb.a.lTa:b===Gb.a.Sje&&(b=Gb.a.kTa);return Ck.eBd(b,h,v,D,Ck.WBn(P))}static WBn(b){var h=b.indexOf(",");const v=b.substring(0,h);b=b.substring(h+1,b.length);h=new iH.a;h.value=parseFloat(v);h.unit=parseInt(b);return h}static ake(b,h,v,D,P){if(2===v){h=P[mj.a.Text];v=P[mj.a.Number];P=P.Increment;D=new iH.a;let ca=!1;""===h||P&&h===Box4Intl.Box4Strings.L_SpinnerAuto?
(D.value=0,D.unit=Xa.App.yFa?2:4,ca=!0):v||P||(D.value=0,D.unit=1,ca=!0);ca&&(w.AFrameworkApplication.va.Qb(b===Gb.a.bke?Gb.a.lTa:Gb.a.kTa,2,D),Xa.App.xa.updateCommandUI())}return 32}static eBd(b,h,v,D,P){if(!({ly:v}=Gn.a.pdg(v,h)).returnValue)return v;h=h.node;switch(b){case Gb.a.eD:Ck.paragraphEditor.eD(h,new jH.a(2,P));break;case Gb.a.lTa:b=new jH.a(P.unit,P.value);Ck.paragraphEditor.qob(h,b);break;case Gb.a.kTa:b=new jH.a(P.unit,P.value),Ck.paragraphEditor.pob(h,b)}D&&Hr.a.Qpb&&(D.xs|=Hr.a.zhb(h));
return 32}static CAk(b,h,v){if(1===v)return 32;u.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=Ck.whi(h);if(!b)return u.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),8;b=(b=b.ia(Bc.a.Hi,240)/20)?b:Ck.kjl;Ck.s5.pda(1,b,4);return 32}static Y2n(b,h,v){if(1===v)return 32;u.ULS.sendTraceTag(588394562,340,50,"Remove Space Before Paragraph option is clicked");Ck.s5.pda(1,0,4);return 32}static BAk(b,h,v){if(1===v)return 32;u.ULS.sendTraceTag(588394563,
340,50,"Add Space After Paragraph option is clicked");b=Ck.whi(h);if(!b)return u.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;b=b.ia(Bc.a.sa,240)/20;Ck.s5.pda(0,b?b:12,4);return 32}static X2n(b,h,v){if(1===v)return 32;u.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");Ck.s5.pda(0,0,4);return 32}static T1e(b,h,v,D,P){if(2==v){if("boolean"!==typeof P)return 16;b=h.node;h=null;Dp.a.instance.J(1)&&(h=b.ND());Ck.paragraphEditor.T1e(b,P);h&&
Ck.nj.aV(b,h,Ck.Ld.rg)}return 32}static n2e(b,h,v,D,P){if(2==v){if("boolean"!==typeof P)return 16;b=h.node;h=null;Dp.a.instance.J(1)&&(h=b.ND());Ck.paragraphEditor.n2e(b,P);h&&Ck.nj.aV(b,h,Ck.Ld.rg)}return 32}static S1e(b,h,v,D,P){if(2==v){if("boolean"!==typeof P)return 16;b=h.node;h=null;Dp.a.instance.J(1)&&(h=b.ND());Ck.paragraphEditor.S1e(b,P);h&&Ck.nj.aV(b,h,Ck.Ld.rg)}return 32}static aFk(b,h,v,D,P){if(2==v){if("boolean"!==typeof P)return 16;b=new Map;b.set("Value",P.toString());va.Health.instance.recordKpiUsage(Ph.a.Fkb.SLo,
0,Ph.a.tB,b);h=h.node;b=null;Dp.a.instance.J(1)&&(b=h.ND());h.hasProperty(Bc.a.lw)&&h.removeProperty(Bc.a.lw);Ck.PFa.TOd(h)!==P&&h.setValue(Bc.a.lw,P);(P=Ck.PFa.n8b(h,!0))&&P.gl(4,!0);(P=Ck.PFa.n8b(h,!1))&&P.gl(4,!0);b&&Ck.nj.aV(h,b,Ck.Ld.rg)}return 32}static whi(b){b=b.view;return b.te&&(b=b.lb)&&b.gb.kb?Ck.HTa.No(b.gb.kb.Oa.node):null}}Ck.kjl=12;Object(n.a)(Ck,"SpacingActor",null,[]);class hJ{process(){}}Object(n.a)(hJ,"NoOpFormattingViewOperationFinishedStageProcessor",null,[41]);class iJ{constructor(b){this.Ce=
b}Ujo(b,h){this.Ce.Uia(b,h.cache.tG);this.Ce.UA(b,h.cache.fontSize)}TEb(){return null}yEa(){return null}X8b(){return null}XT(){return null}}Object(n.a)(iJ,"FormattingStewardBridge",null,[45]);class jJ{xc(b){b.ha("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",()=>new hJ).singleInstance();b.ha("Box4.Actors.IFormattingStewardBridge",()=>new iJ(b.resolve("Box4.IFormattingEditor"))).singleInstance()}}Object(n.a)(jJ,"WoncaActorsConfiguration",null,[2]);class kJ{constructor(b,h,v,D,P,ca,ta,
Ra){this.ga=b;this.HYj=h;this.GYj=v;this.sNg=D;this.Afk=P;this.nrd=ca;this.Efk=ta;this.Ffk=Ra}get pc(){return this.ga}$Mk(b){this.pc.Qpa(b,this.HYj,null,null)}YMk(b){this.pc.Qpa(b,this.GYj,null,null)}c_(b,h,v){v?this.pc.Qpa(b,this.sNg,h,null):this.pc.Qb(this.sNg,2,h)}zCn(b,h){this.pc.Qpa(b,this.nrd,h,null)}x9(b,h){this.pc.Qpa(b,this.Efk,h,null)}anb(b,h){this.pc.Qpa(b,this.Ffk,h,null)}GYf(b,h=!1){const v=new Md.DictionaryPropertySet;v.setValue(Wc.a.iP,b);v.setValue(Wc.a.o1i,!0);v.setValue(Wc.a.P2a,
h);this.pc.Qb(this.Afk,2,v)}}Object(n.a)(kJ,"ClipboardCommands",null,[1554]);class lJ{}Object(n.a)(lJ,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1461]);class mJ{constructor(b){this.ga=b}get pc(){return this.ga}Umj(b,h,v){let D=0;b?1===b&&(D=Gb.a.j2a):D=Gb.a.i2a;b=new ID.a;b.unit=v;b.value=h;this.pc.Qb(D,2,b)}Khe(b,h,v){let D=0;1===b?D=Gb.a.COb:2===b?D=Gb.a.Gob:b||(D=Gb.a.DOb);b=new ID.a;b.unit=v;b.value=h;this.pc.Qb(D,2,b)}}Object(n.a)(mJ,"IndentationCommands",null,[1489]);var sG;(function(b){b[b.unspecified=
-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.inner=4]="inner";b[b.outer=5]="outer";b[b.both=6]="both";b[b.distribute=7]="distribute";b[b.margin=8]="margin";b[b.highKashida=9]="highKashida";b[b.lowKashida=10]="lowKashida";b[b.mediumKashida=11]="mediumKashida";b[b.numTab=12]="numTab";b[b.thaiDistribute=13]="thaiDistribute";b[b.start=14]="start";b[b.end=15]="end"})(sG||(sG={}));Object(n.b)("Justification",sG);class nJ{constructor(b){this.bLa=
{};this.ga=b;this.nym()}get pc(){return this.ga}gE(b){b=this.bLa[sG[b]];void 0!==b&&null!==b&&this.pc.processAction(b,2)}nym(){this.bLa.left=Gb.a.leftJustify;this.bLa.center=Gb.a.centerJustify;this.bLa.right=Gb.a.rightJustify;this.bLa.both=Gb.a.fullJustify;this.bLa.lowKashida=Gb.a.FIb;this.bLa.mediumKashida=Gb.a.FIb;this.bLa.highKashida=Gb.a.FIb;this.bLa.distribute=Gb.a.fKc;this.bLa.thaiDistribute=Gb.a.P7c}}Object(n.a)(nJ,"JustificationCommands",null,[1485]);class oJ{constructor(b){this.ga=b}eD(b){this.ga.Qb(Gb.a.eD,
2,b)}gjc(b){this.ga.Qb(Gb.a.gjc,2,b)}v7c(b){this.ga.Qb(Gb.a.v7c,2,b)}V7c(b){this.ga.Qb(Gb.a.V7c,2,b)}u7c(b){this.ga.Qb(Gb.a.u7c,2,b)}pda(b,h,v){this.ga.Qb(b?Gb.a.lTa:Gb.a.kTa,2,Object.assign(new iH.a,{value:h,unit:v}))}}Object(n.a)(oJ,"SpacingCommands",null,[1386]);class pJ{constructor(b,h,v){this.pc=b;this.IKc=h;this.Qtl=v;this.Bxn=(D,P,ca)=>{if(1===ca)return this.IKc.$Z?32:8;this.IKc.n1m();this.Qtl().Wwo(this.IKc.YVl());return 32}}Tb(){this.pc.eb(Gb.a.Fmb,sc.a.application,this.Bxn,1028)}}Object(n.a)(pJ,
"EditorSettingsUIActor",null,[]);class qJ extends bg.a{constructor(b,h){super(!1,!1,!0);this.Ttl=b;this.TQa=h;this.Stl=v=>{1!==v?u.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):(this.Ttl.nUo(),u.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}async Wwo(b){const h=await this.TQa.aJb;b={["id"]:"SettingsDialog",["uiLanguage"]:w.AFrameworkApplication.uiCulture,["selectedLanguage"]:ok.a.sg(w.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:h.KWc,
["editorSettings"]:b};this.Wh(Box4Intl.Box4Strings.l_EditorSettings,this.Stl,b);u.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")}}Object(n.a)(qJ,"EditorSettingsDialog",bg.a,[]);class rJ{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id){this.wwb=this.Xyc=this.bqc=null;this.gTe=0;this.jFe=!1;this.ra=new Mc.a;this.fZd=!1;this.Vu=b;this.Yz=h;this.Ce=v;this.Ms=D;this.fb=P;this.Hf=ta;this.Kd=Ra;this.Jk=mb;this.ld=Jb;this.Sd=Ub;this.tq=cc;this.wW=Ac;this.Xy=Lc;this.Co=id}get tvl(){return this.ld?
this.ld.isFeatureEnabled(42):!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled")}get mmf(){return null!=this.gAg?this.gAg:this.gAg=Ea.a.instance.resolve("Box4.IFormatPainterStrategy")}get cR(){return this.jFe}set cR(b){this.jFe!==b&&(this.jFe=this.fZd=b,this.ra.raiseEvent("FormatPainterBrushActiveStatusChanged"))}qxk(b){this.ra.addHandler("FormatPainterBrushActiveStatusChanged",b)}$1i(b){const h=b.Oa;u.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",
h.contextId);this.reset();var v=h.node;b=this.Ozi(b);if(this.mmf.Rto(h.contextId,b))try{this.wwb=this.fb.t1a(v)}catch(D){throw u.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",D.message),D;}this.Xyc=this.Xy.No(v);v=Kl.FormattingReader.Nr(h);v.yn&&(this.bqc=Object(Na.a)(WA.a,v.yn.clone()));this.gTe=b?sc.a.paragraph:h.contextId}Xth(b){if(b){const v=this.Ozi(b);for(let D=0;D<b.length;D++){const P=b.J(D);if(null===P||void 0===P?0:P.hl)this.Ezb(P,v);else if(0==(null===P||void 0===
P?void 0:P.length))u.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",P);else if(P)for(let ca=0;ca<P.length;ca++){var h=P.getContext(ca);if(null===h||void 0===h?0:h.$w){if(h)for(let ta=0;ta<h.length;ta++)P.addContext(h.getContext(ta))}else(null===h||void 0===h?0:h.hl)?this.Ezb(h,v):u.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",h.contextId)}}}}$th(b,h){if(h){var v=b.node,D=v.pa.last,P=this.Kd.j0a(v),ca=P.Df(P.Ib);
this.auh(P,h,null);Dp.a.instance.J(1)&&this.tq.nOb(v,D,b.cpBegin,b.cpEnd,ca,P,this.Sd.rg)}}oFk(b,h,v){if(h||v)0<Yo.g(b).length&&u.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.wW.YZ(b,D=>{this.auh(D,h,v)})}auh(b,h,v){this.Ce.Kfa(b);b.yn&&b.yn.removeProperty(lf.a.highlight);this.Ce.L7e(b);v&&(v=v.clone(),v.Eg(...xp.a.Rba()),this.Vw(b,v.xl()));this.Vw(b,h)}Vw(b,h){if(h){var v=b.paragraph.Kc;if(v){var D=b.yn;D=D?Object(Na.a)(Tx.a,D.clone()):WA.a.HNa(1179725);for(const ca of h.Hl())if(ca!==
Bc.a.hw&&ca!==Bc.a.fieldInstruction&&ca!==lf.a.IB&&ca!==lf.a.l4&&ca!==Bc.a.I2a&&ca!==lf.a.gL&&ca!==Bc.a.H3a&&ca!==Bc.a.noProof){if(ca===Vi.a.kw){var P=h.ia(Vi.a.kw,W.a.nil);if(P!==W.a.nil)if(P=v.Db(P)){if(P=new Zv.a(P),P=this.Xy.UQ(P),P===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(P=this.Xy.NC(b.paragraph).GEa(P)){D.MNa(P.xl(),...xp.a.Rba());continue}else u.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else u.ULS.sendTraceTag(589345876,354,
50,"Applied character style on formatting is not present in Object Space")}D.setValue(ca,h.Gf(ca))}D.HFa?h=v.GR(D,!0):(v.Pu(D),h=D);b.Wj=h.id}}}Ozi(b){return!b.Cx&&b.Pc.contextId!==sc.a.endOfParagraph}reset(){this.wwb=this.Xyc=this.bqc=null;this.gTe=sc.a.none}Ezb(b,h){if(b.contextId===sc.a.Tc||b.contextId===sc.a.Hd)var v=this.Jk.M8(b);else if(b.contextId===sc.a.paragraph)v=this.Jk.k_d(b);else if(b.contextId===sc.a.endOfParagraph)v=this.Jk.QYd(b);else{u.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",
b.contextId);return}u.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",b.contextId);if(v)u.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{v=Object(Na.a)(Po.AParagraphNode,b.node);var D=!1;v&&(D=b.contextId===sc.a.Hd&&!!v&&!b.cpBegin&&b.cpEnd===this.fb.textLength(v));if(h=this.mmf.Uro(this.gTe,b.contextId,h,D))try{fe.ParagraphReader.Wb(v)?(this.Xyc&&this.Vu.RJ(this.Xyc,v,!0),this.Ms.ruh(v,this.wwb)):u.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",
b.node.type)}catch(P){throw u.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",P.message),P;}D=b;b.contextId===sc.a.paragraph?D=we.a.createTextRange(v,0,fe.ParagraphReader.textLength(v)):b.contextId===sc.a.Tc&&(D=this.Yz.fuf(b),D=Yh.a.ABb(D));if(D&&D.contextId===sc.a.Hd){if(ui.a.RFd){const P=this.Co.FRd(D);P&&(D=P)}try{this.oFk(D,this.bqc,h?null:this.Xyc)}catch(P){throw u.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",P.message),P;}}if(b.contextId===
sc.a.paragraph||b.contextId===sc.a.endOfParagraph)h=new he.GraphIterator,h.set(v),h.vd(),h.jd(11),D=Vg.ListItemReader.yg(h),v=!fe.ParagraphReader.textLength(v),u.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",D,v),D?(this.Hf.eP(h),this.Hf.mca(h.currentNode)&&this.$th(b,this.bqc)):this.tvl&&this.$th(b,this.bqc)}}}Object(n.a)(rJ,"FormatPainter",null,[1520]);var uM=c(110);class gE{constructor(b,h,v,D,P,ca,ta,Ra=!1,mb,Jb,Ub){this.dnd=!1;this.IBe=new nk.a;this.Xnm=
()=>{this.wS.cR=!1;return 32};this.Ynm=(cc,Ac,Lc)=>{cc=!1;if(Ac=this.Wy.L3){switch(Ac.contextId){case sc.a.Hd:case sc.a.paragraph:case sc.a.endOfParagraph:case sc.a.Tc:cc=!0}cc&&$e.SelectionEditor.nl(Ac)&&Yo.b(Ac)&&(this.ud.Yb(qe.a.fn,{["Reason"]:me.a.IHc}),cc=!1);cc&&fe.ParagraphReader.kU(Ac)&&(this.ud.Yb(qe.a.fn,{["Reason"]:me.a.hO}),cc=!1)}if(1===Lc||!cc)return cc?32:8;6!==this.ga.xC?(this.wS.cR?u.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(u.ULS.sendTraceTag(22832075,
354,50,"User activated the Format Painter button"),this.wS.$1i(this.Wy.kb),this.dnd||(this.Jh.dZa(this.QFj),(Lc=this.Jh.ib.yu)&&Lc.Wi&&Lc.aqh(this.PFj),this.dnd=!0)),this.wS.cR=!this.wS.cR):(u.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this.wS.$1i(this.Wy.kb),this.wS.cR=!1);return 32};this.Wnm=(cc,Ac,Lc,id,vd)=>{if(6===this.ga.xC||this.wS.cR){u.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.xC);cc=this.Jh.Hq.Zf("UserAction",
"FormatPainterApply");if(gE.Xb&&gE.Xb.GB(116)){vd=vd?vd.KeepBrushActive:!1;Lc=null;this.Wy.kb&&2===this.Wy.kb.trigger&&(vd=vd||this.wS.fZd,this.wS.fZd&&$e.SelectionEditor.Sl(this.Wy.kb)&&(Lc=$e.SelectionEditor.w_(this.Wy.kb.Oa,!1)))&&(Lc.trigger=2);this.wS.fZd=!1;if(vd||2!==this.Wy.kb.trigger)Ac=new eh.GraphTransaction(15),Lc&&Lc.Oa?(Ac.set(Lc.Oa.node.qj),this.hb.setSelection(Lc)):Ac.set(this.Wy.K6b.qj),Lc=Og.SelectionFactory.Nn(this.hb.tg),this.wS.Xth(Lc),Ac.dispose();this.wS.cR=vd}else vd=new eh.GraphTransaction(15),
vd.set(this.Wy.K6b.qj),Ac=Og.SelectionFactory.Nn(this.hb.tg),this.wS.Xth(Ac),this.wS.cR=!1,vd.dispose();cc.stop()}return 32};this.QFj=()=>{this.S8d(this.wS.cR)};this.PFj=()=>{this.S8d(this.wS.cR)};this.Jh=b;this.Ub=h;this.ga=v;this.ud=D;this.Wy=P;this.wS=ca;this.hb=ta;this.R8j=Ra;this.Yx=mb;this.ux=Jb;this.N0j=Ub}get pWg(){return aa.a.iu||aa.a.C_d?"url("+this.U9h()+"), pointer":'url("'+this.U9h()+'"), pointer'}U9h(){return this.ux?this.Yx.Gva(Ic.a.vg("FormatPainterText.cur"),Ic.a.vg("FormatPainterTextDarkMode.cur"),
new uM.a(xn.a.TK())):Ic.a.vg("FormatPainterText.cur")}Tb(){const b=this.Ub.fe(xk.AppFrame.JD);b.bindAction(Xb.KeyInputManager.jc(Ve.a.PIa,0),Gb.a.lmf);b.bindAction(Xb.KeyInputManager.jc(Ve.a.erb,6),Gb.a.yNd);this.R8j||b.bindAction(Xb.KeyInputManager.jc(Ve.a.irb,6),Gb.a.F0a);this.ga.eb(Gb.a.yNd,sc.a.view,this.Ynm,1028);this.ga.eb(Gb.a.F0a,sc.a.view,this.Wnm,1028);this.ga.eb(Gb.a.lmf,sc.a.view,this.Xnm,1028);this.wS.qxk(()=>{this.Bng(this.wS.cR)});this.ux&&this.N0j.Tzd(()=>{this.S8d(this.wS.cR)})}Bng(b){const h=
this.Jh.Hq.Zf("UserAction","FormatPainterUpdateCursor");this.S8d(b);this.Jh.updateCommandUI();h.stop()}OFj(b,h){for(let v=0;v<b.length;v++)this.NFj(b[v],h);(b=this.Jh.ib.yu)&&b.te&&this.NFj(b.rh.editingElement,h)}NFj(b,h){b.style.cursor=h?this.pWg:""}S8d(b){const h=document.querySelectorAll(".OutlineElement");if(1<h.length){const v=h[h.length-2].style.cursor===this.pWg;if(this.Jh.ib.isEditingAllowed||this.Jh.ib.xy){if(b&&!v||!b&&v)this.OFj(h,b),this.kGj(b);b||!this.dnd||this.IBe.count||(this.Jh.tbj(this.QFj),
(b=this.Jh.ib.yu)&&b.Wi&&b.R1n(this.PFj),this.dnd=!1)}else v&&(this.OFj(h,!1),this.kGj(!1))}}kGj(b){const h=this.Jh.ib.yu;h&&(b?this.IBe.add(h.Yc.Al):this.IBe.remove(h.Yc.Al))}static get Xb(){return null!=gE.czg?gE.czg:gE.czg=Ea.a.instance.Na("Box4.IFeatureHelper")}}Object(n.a)(gE,"FormatPainterActor",null,[]);class rA{constructor(b,h,v){this.Sm=v}Exl(b,h,v,D,P){var ca;if(!({he:v,selected:ca,ly:mb,TUc:Ra}=this.Vqj(h,v,!1)).returnValue)return mb;hj.a.mark(5013);var ta=rA.Xg.dO(ca);for(let Jb=0;Jb<
ta.length;++Jb){if(!ta[Jb].isValid)continue;const Ub=ta[Jb].iterator;Ub.Bp();if(Ei.OutlineReader.fx(Ub))return this.AXh(v,Ub)}var Ra=ui.a.SFd&&Ra?Gb.a.ZSc:this.vWl();if(ca.$w||$e.SelectionEditor.nl(ca)||fe.ParagraphReader.lm(ca)&&!$e.SelectionEditor.K8(ca)){if(rA.Xb&&rA.Xb.isFeatureEnabled(25)&&em.ContextSetEditor.instance.hfg(ca).returnValue)return 8;var mb=this.BXh(h,v,b,D,P,Ra)}else if($e.SelectionEditor.Hk(ca))mb=this.zXh(h,v,b,D,P,Ra);else if($e.SelectionEditor.gf(ca)){mb=new he.GraphIterator;
mb.set(ca.node);mb.zb(10);ta=Re.a.zA(ca,!1);if(0<ta.length){if(!ta[0].hyperlink)return u.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",ta[0].cpBegin,ta[0].cpEnd),8;Xa.App.Xgb(ta[0].hyperlink.url);return 32}Xg.TableCellReader.b0(mb)&&(ch.returnToContainingCell(mb),Xg.TableCellReader.qha(mb)&&(ta=new he.GraphIterator,ta.Zc(mb),ch.returnToContainingRow(ta),Ei.OutlineReader.HA(mb,ca,!1)&&Bl.a.Hxi(ta)&&0>=ca.Eb&&(Ra=Gb.a.cTc,ch.returnToContainingTable(mb),hf.OutlineElementNavigator.Vd(mb),
P||(P=new Md.DictionaryPropertySet),P.$g(Wc.a.targetObject,mb.currentNode.id))));mb=this.CXh(h,v,b,D,P,Ra)}else $e.SelectionEditor.K8(ca)&&(mb=w.AFrameworkApplication.va.Mf(h,Gb.a.newLine,2,!1,D,P));hj.a.mark(5014);return mb}Vqj(b,h,v){let D=null,P=null,ca=!1;if(1===h)return{returnValue:!1,he:D,selected:P,ly:32,TUc:ca};if(!b.view.te)return{returnValue:!1,he:D,selected:P,ly:2,TUc:ca};D=b.view;P=D.lb.tg;return!P||!rA.Wf.mxi(P,v)||ui.a.SFd&&rA.Wf.uha(P,ta=>ca=ta)&&!ca?{returnValue:!1,he:D,selected:P,
ly:2,TUc:ca}:this.Sm&&this.Sm.instance&&this.Sm.instance.pU(P)?{returnValue:!1,he:D,selected:P,ly:4,TUc:ca}:{returnValue:!0,he:D,selected:P,ly:2,TUc:ca}}Hro(b,h,v,D,P){let ca,ta;if(!({he:v,selected:ca,ly:ta}=this.Vqj(h,v,!0)).returnValue)return ta;const Ra=rA.Xg.dO(ca);for(let mb=0;mb<Ra.length;++mb){if(!Ra[mb].isValid)continue;const Jb=Ra[mb].iterator;Jb.Bp();if(Ei.OutlineReader.fx(Jb))return this.AXh(v,Jb)}ca.$w||$e.SelectionEditor.nl(ca)?ta=this.BXh(h,v,b,D,P,Gb.a.ZSc):$e.SelectionEditor.Hk(ca)?
ta=this.zXh(h,v,b,D,P,Gb.a.ZSc):$e.SelectionEditor.gf(ca)?ta=this.CXh(h,v,b,D,P,Gb.a.ZSc):$e.SelectionEditor.K8(ca)&&(ta=w.AFrameworkApplication.va.Mf(h,Gb.a.newLine,2,!1,D,P));return ta}AXh(b,h){b.lb.setSelection(Og.SelectionFactory.ho(h.currentNode,!1));return 32}BXh(b,h,v,D,P,ca){const ta=new eh.GraphTransaction(15);ta.jk=v;ta.Cb(h.Yc);h=new Md.DictionaryPropertySet;h.setValue(Wc.a.kKc,!0);h=w.AFrameworkApplication.va.Mf(b,Gb.a.AH,2,!0,D,h);32===h&&(h=w.AFrameworkApplication.va.Mf(b,ca,2,!1,D,
P));ta.dispose();return h}zXh(b,h,v,D,P,ca){const ta=new eh.GraphTransaction(15);ta.jk=v;ta.Cb(h.Yc);h.lb.setSelection($e.SelectionEditor.Cj(h.lb.gb.J(0),!1,!1));b=w.AFrameworkApplication.va.Mf(b,ca,2,!1,D,P);ta.dispose();return b}CXh(b,h,v,D,P,ca){const ta=new eh.GraphTransaction(15,v);ta.jk=v;ta.Cb(h.Yc);b=w.AFrameworkApplication.va.Mf(b,ca,2,!1,D,P);ta.dispose();return b}static get Xg(){return em.ContextSetEditor.instance}static get Wf(){return qi.a.instance}static get Xb(){return null!=rA.Zyg?
rA.Zyg:rA.Zyg=Ea.a.instance.Na("Box4.IFeatureHelper")}}Object(n.a)(rA,"AEnterViewStrategy",null,[1546]);class sJ extends rA{constructor(b,h,v){super(b,h,v)}vWl(){return Gb.a.newLine}}Object(n.a)(sJ,"EnterViewStrategy",rA,[]);class kH{constructor(b){this.ol=this.transaction=null;this.he=b;this.THc=this.oo=0}}Object(n.a)(kH,"SelectAllArguments",null,[]);class lD{constructor(b,h,v){this.Izn=b;this.OZm=h;this.Us=v;this.rzl=(D,P,ca)=>P.view.Wi?this.Cgb(P,ca,this.Cvj):this.bdo(P,ca);this.y2c=(D,P)=>P.oo?
1===P.oo?(P.he.lb.I7c(P.ol,D),P.oo=2,!0):2===P.oo?(P.he.lb.gb.B_a=P.ol.B_a,this.Pg.kF(),P.transaction.zHa(D),P.oo=3,P.transaction.dispose(),hj.a.mark(5799),!0):!1:(P.transaction=this.Us.Oc(2),P.transaction.Cb(P.he.Yc),P.oo=1,!0);this.bdo=(D,P)=>{if(1===P)return 32;if(!D.view.te)return 2;D=D.view;return D.lb&&D.lb.gb&&D.lb.gb.kb?this.Cvj(D).inProgress?1:32:8};this.Cvj=D=>{w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");D.Wi&&u.ULS.sendTraceTag(39098306,
324,50,"Progress select all reach top");D=new Eu.a(null,this.fKn,new kH(D));D.Jl("SelectAllInOutline");D.run();return D};this.fKn=(D,P)=>{if(!P.oo)return P.ol=Og.SelectionFactory.cdo(P.he.lb.gb.kb),P.transaction=this.Us.Oc(2),P.transaction.Cb(P.he.Yc),P.oo=1,!0;if(1===P.oo){if(!P.THc)return P.he.lb.setSelection(P.ol.J(0),D),++P.THc,!0;if(P.THc<P.ol.length)return P.he.lb.Cvk(P.ol.J(P.THc),D),++P.THc,!0;P.oo=2}return 2===P.oo?(P.he.lb.gb.B_a=P.ol.B_a,this.Pg.kF(),P.transaction.zHa(D),P.oo=3,P.transaction.dispose(),
!0):!1}}get Pg(){return this.OZm.value}Tb(){const b=w.AFrameworkApplication.va;b.qa(Gb.a.Hya,ud.a.frame,lD.Wrj);b.qa(Gb.a.Vcg,ud.a.frame,lD.Wrj);b.eb(Gb.a.Cgb,sc.a.view,this.rzl,2);b.eb(Gb.a.jCa,sc.a.view,Ne.AFrame.Ig,100);b.eb(Gb.a.$Nf,sc.a.view,lD.$Nf,4)}Cgb(b,h,v){if(1===h)return 32;if(!b.view.te)return 2;h=b.view;if(!h.lb)return 8;const D=h.lb.gb;if(!D||!D.length)return 8;hj.a.mark(5798);Xa.App.xa.ib.isEditingAllowed||Xa.App.xa.ib.xy||h.Wi?b=$e.SelectionEditor.ssf(D):(bd.FocusManager.instance().cD(Ne.AFrame.Pn),
b=Og.SelectionFactory.nij(h.Yc));if(!b)return 8;D.B_a||u.ULS.sendTraceTag(39098305,324,50,"Progress selection start");v&&this.Izn.OHb($e.SelectionEditor.S7h(b))?v=v(h):(v=new kH(h),v.ol=b,v=new Eu.a(null,this.y2c,v),v.Jl("ExpandSelection"),v.run());return v.inProgress?1:32}static get s6a(){return null!=lD.AGg?lD.AGg:lD.AGg=Ea.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static $Nf(b,h,v){if(1===v)return 32;if(!h.view.te)return 8;b=h.view;h=Og.SelectionFactory.ho(b.root.graphNode,!0);if(!h)return 8;
b.lb.setSelection(h);return 32}static Wrj(){var b=Xa.App.xa.ib.yu;if(!b.te)return 2;if(b.te&&1!==Xa.App.xa.state){hj.a.mark(4668);var h=b.lb.gb.kb;if(!h&&w.AFrameworkApplication.K.$("ContextMenuOnSelectionFixIsEnabled"))return 2;h=$e.SelectionEditor.p3(h);let v=h.x,D=h.y+h.height;if(!b.container)return 8;b=Sys.UI.DomElement.getBounds(b.container);if(h.y<b.y||h.y>b.y+b.height||h.x<b.x||h.x>b.x+b.width)v=b.x,D=b.y;lD.s6a.Hya(new Sys.UI.Point(v,D),1);hj.a.mark(4669)}return 32}}Object(n.a)(lD,"SelectAllHandlers",
null,[1392]);class tJ{Sge(){}}Object(n.a)(tJ,"FontNameFormattingStrategyNoop",null,[1521]);var uJ=c(862);class tG{constructor(b,h,v,D,P,ca){this.mxh=this.pxh=null;this.Yr=b;this.lxh=h;this.OLk=v;this.YLk=D;this.pxh=P;this.mxh=ca}}Object(n.a)(tG,"BookmarkHighlightContext",null,[]);class vJ extends Me.a{constructor(){super()}get Vba(){return!0}get Nib(){return 5}get a2a(){if(null!=this.s2)return this.s2;this.s2=[];this.s2.push(new xg.a(Co.a.VBd,Co.a.VBd));this.s2.push(new xg.a(Co.a.i4e,Co.a.i4e));this.s2.push(new xg.a(Co.a.wFc,
Co.a.wFc));return this.s2}yGa(b,h){this.Vba&&ns.a.instance.ie(()=>{const v=this.Hu.oDa;var D=this.Hu.oXc;if(v)if(5===v.type){D=v.FA;if(v.LJ&&v.LJ.Yr.includes(b))for(const P of h.TGa("*"))this.Hu.wSa(P);D&&D.Yr.includes(b)&&this.Aob(h,v.action,D,b)}else D&&5===D.type&&3===v.action&&D.FA.Yr.includes(b)&&this.Aob(h,0,D.FA,b)},"BHA:OPHC")}HQa(b){return Object(rb.a)(tG,b)}u1a(b,h){if(b)for(const v of b.Yr)h.add(v)}Aob(b,h,v,D){0===h&&b.htmlElement&&ns.a.instance.ie(()=>{const P=b.TGa("*"),ca=P.length,
ta=Co.a.VBd;var Ra=D.id===v.pxh,mb=D.id===v.mxh;let Jb=!1;var Ub=0,cc=[];const Ac=Array(ca);for(let vd=0;vd<ca;vd++){var Lc=P[vd];const xe=Bg.a(Lc);Ac[vd]=xe;const Ld=Lc.classList;if(0!=Ac[vd]){const Qd=!Ld.contains(Co.a.sG),Zd=fd.a.Db(Lc,Co.a.$zb);Zd&&cc.push(...Zd);if(Ra){let te;if((te=fd.a.Db(Lc,Co.a.XBd))&&Zd&&1===te.length&&1===Zd.length&&te[0].equals(Zd[0]))continue;te&&(Ub+=te.length,1===xe?Ld.add(Co.a.i4e):Ld.add(ta));if(Zd)for(const Qf of Zd)this.eYd(v,Qf)&&(Ub--,Jb&&Ld.add(Co.a.wFc));0!==
Ub&&Qd&&Ld.add(ta)}if(!Ra&&!mb&&v.YLk.has(D.id))if((Lc=fd.a.Db(Lc,Co.a.$zb))&&Jb){Ld.add(ta);for(const te of Lc)if(this.eYd(v,te)){Ld.add(Co.a.wFc);break}}else Qd&&Ld.add(ta)}Jb=!Ld.contains(Co.a.ogb)}if(mb&&!Ra){Ra=new Set;for(var id of cc)this.eYd(v,id)&&Ra.add(id);Jb=!1;for(cc=0;0!==Ra.size&&cc<ca;cc++){Ub=P[cc];id=Ub.classList;if(0!=Ac[cc])if(mb=!1,Ub=fd.a.Db(Ub,Co.a.$zb)){for(const vd of Ub)this.eYd(v,vd)&&(Ra.delete(vd),mb=!0);0!==Ra.size&&id.add(ta);Jb&&mb&&id.add(Co.a.wFc)}else id.contains(Co.a.sG)||
id.add(ta);Jb=!id.contains(Co.a.ogb)}}},"BHA:SPH")}eYd(b,h){for(const v of b.OLk)if(h.equals(v))return!0;return!1}}Object(n.a)(vJ,"BookmarkHighlightActor",Me.a,[416]);var uG=c(1870),wJ=c(1655);class vG{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb){var Ub;this.xvi=!1;this.Xf=b;this.dA=h;this.fb=P;this.BV=ca;this.Uj=ta;this.ge=Ra;this.ld=Jb;this.Fa=mb;this.xvi=null!==(Ub=null===mb||void 0===mb?void 0:mb.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckMultiRangeContextForTheme",!1))&&void 0!==Ub?Ub:
!1}w$f(b,h,v,D){const P=b.Qmh(h);if(P){var ca=Object(rb.a)(wJ.a,b),ta=this.ge.Zf("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",ca,v)),Ra=h.gk.node,mb=()=>{v||this.removeImage(h.gk,P.getId())};ca=vG.Fyh();D=this.czh(P.getId().toString(),Ra,D,v);try{b.fth(D,h)}catch(Jb){u.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+Jb.message);this.xp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);
return}this.Xf.xj(ca,2,D.toString(),{},!0,0,Jb=>{u.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");b.lfc(Jb,P,()=>{this.xp(b.bSd())},mb,Ra,h,ta)},Jb=>{const Ub=415===Jb.data.Qe;let cc="";Jb&&Jb.data&&Jb.data.Bj&&"X-CorrelationId"in Jb.data.Bj&&Jb.data.Bj["X-CorrelationId"]&&(cc=Jb.data.Bj["X-CorrelationId"]);b.vpa(`Graphics editor request failed. HttpStatus [${Jb.data.Qe}], ResponseData [${Jb.data.ve}], CorrelationId [${cc}]`,
P,Ra,mb,()=>{this.xp(Ub?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.bSd())},ta,Ub)},null)}else this.xp(b.bSd())}Meo(b,h,v){return new Promise((D,P)=>{var ca=b.gk,ta=null;ta=this.xvi&&Rf.a.REf(ca)?ca.getContext(0).node:ca.node;ca=vG.Fyh();ta=this.czh(h.toString(),ta,v,!1);ta.ze(uG.a.D$e,"2");this.Xf.xj(ca,2,ta.toString(),{},!0,0,Ra=>{u.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");D(Ra.data.ve)},
Ra=>{u.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Ra.data.Qe}, ResponseData ${Ra.data.ve}`);this.xp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);P(null)},null)})}czh(b,h,v,D){const P=h.Vi(),ca=new eb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");w.AFrameworkApplication.nfa(ca);ca.ze(uG.a.strict,this.iNm(h)?"true":"false");ca.ze(yh.a.nodeId,b);ca.ze(yh.a.cellId,P.nm.toString());ca.ze(yh.a.fileId,
P.vr);ca.ze(yh.a.jX,v.toString());ca.ze(uG.a.azl,D?"true":"false");if(b=!!this.ld&&this.ld.isFeatureEnabled(49)){ca.ze(Pg.a.d2i,b.toString());if(b=this.ld.isFeatureEnabled(89))ca.ze(Pg.a.ODn,b.toString()),ca.ze(Pg.a.Hvm,"true");this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",!1)&&ca.ze(Pg.a.XDn,"true")}ca.ze(Pg.a.xwh,"true");Yi.a.instance.pzb(ca);return ca}iNm(b){if(!this.dA)return!1;b=this.dA.Ys(b);return!!b&&b.Gf(Bc.a.DGf)}removeImage(b,h){b.cpBegin===b.cpEnd-1&&
this.Uj.uhc(b.node,h,this.fb,this.BV)}xp(b){const h=new ug.StandardDialog;h.Ad=0;h.nx(lm.a.Mgf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,b===WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);Xa.App.xa.updateCommandUI()}static Fyh(){const b=new eb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");w.AFrameworkApplication.nfa(b);return b.toString()}}Object(n.a)(vG,"GraphicsEditorRequestManager",null,[413]);class xJ extends Uj{constructor(b,h,v){super(b,h);this.SPa=
Gb.a.insertHyperlink;this.w$j=v}t2a(b){null!=b&&0<b.length&&this.pc.Qb(this.SPa,2,b[0])}nNj(b,h,v){const D=ok.a.sg(w.AFrameworkApplication.lcid).name;b=String.format(b,w.AFrameworkApplication.lcid,D,w.AFrameworkApplication.buildVersion,h,aD.Nre,v);b+="&flipgrid=1&ted=1";this.w$j&&(b+="&resize_picker=1");w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2Videos",!1)&&(b=new eb.QueryStringBuilder(b),b.JI("stream2","1"),w.AFrameworkApplication.K.$("GetCustomHeaderEnabled")&&
b.JI("enablegetcustomheader","1"),b=b.toString());return b}}Object(n.a)(xJ,"InsertHubbleMediaHelper",Uj,[]);class yJ{constructor(b,h,v,D,P,ca,ta){this.ga=b;this.Fa=h;this.Hld=v;this.w2=D;this.Vid=P;this.Jk=ca;this.GXj=ta}Tb(){this.ga.eb(Nc.a.CZi,sc.a.Tc,this.$xn.bind(this),1028);this.ga.eb(Nc.a.ysi,sc.a.Tc,this.YCm.bind(this),1028)}YCm(b,h,v,D,P){if(1!==v){if(null==P)return 16;if(!h.hl||!$e.SelectionEditor.gf(h))return 2;b=this.jWl(P);P=P.OriginalUrl;w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1);this.Vid.asg(b,h,P)}return 32}qTj(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("OnlineVideoFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}jWl(b){const h=new uB;h.MediaType=b.ContentType;h.Height=b.Height;h.Width=b.Width;h.IFrameHtml=b.Html;h.Title=b.Caption;h.Thumbnail=b.ThumbnailUrl;h.ProviderName=b.ProviderName;return h}$xn(b,h,v){var D,
P;if(1!==v)h=G.a.XW(this.Fa.jb("UserId")).toString(),h=this.w2.nNj(this.Fa.appSettings.InsertVideoHubbleEndpoint,ub.a.create().toString(),h),this.w2.SPa=Nc.a.ysi,h=this.Hld.QOc(h,!0),h.correlationId=ub.a.create(),h.lpa=5,h.bje(null,this.w2,this.GXj),fa.a.sendTelemetryEvent(Object.assign(new oa.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new na.a,{name:"ActionId",int64:b})]})),this.qTj();else if(!(h&&h.node&&vB.a(h.node))||(null===(D=this.Jk)||void 0===D?0:D.k_(h))||(null===
(P=this.Jk)||void 0===P?0:P.uha(h)))return 2;return 32}}Object(n.a)(yJ,"OnlineMediaActor",null,[]);const vM={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net","https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net","https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};
class zJ extends LD{constructor(b,h,v,D=null,P=!1){super(b,h,v,D,P);this.iuc=null;this.jUf=()=>{this.Uy&&(u.ULS.sendTraceTag(509092503,352,50,`onGetCustomHeaders : Token available: ${!!this.LBa} time: ${(new Date).getTime()-this.gi}`),this.Uy.sendMessage(L.a.glj,{["CustomHeaders"]:this.LBa||""}))}}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}ZDb(){const b={};b.insertMediaServiceEndpoint=this.Ild;b.iFrameId="mediaiframe";return b}async bje(b,h,v){v&&await this.refreshToken(v);
this.pUb=b;this.iuc=h;this.dtc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.ZDb(),["componentIsVisibleCallback"]:this.oRj.bind(this)};this.Wh(this.pUb,null,b)}oRj(){this.n0=this.M7b(this.mj("mediaiframe"));let b=this.Ild;if(w.AFrameworkApplication.K.$("NewInsertMediaServiceEndpoint")){const h=new URL(b),v=vM[h.protocol+"//"+h.host];v?b=v:u.ULS.sendTraceTag(508937025,352,10,`Target URL: ${h.host} not found`)}this.Uy=this.Nrd.getInstance(this.n0.contentWindow,b);this.Uy.Dq(L.a.yoh,h=>{this.hTi(h,
this.iuc.t2a.bind(this.iuc))});this.Uy.Dq(L.a.insert,h=>{this.z7d(h,this.iuc.t2a.bind(this.iuc))});this.Uy.Dq(L.a.V7h,this.jUf.bind(this));this.Uy.Dq(L.a.getSessionId,this.gVi.bind(this));this.Uy.Dq(L.a.D5h,this.dVi.bind(this));this.Uy.Dq(L.a.RCd,this.RTi.bind(this));this.nob(3)}nob(b){const h=[];h.push(Object.assign(new na.a,{name:"DialogResult",string:xD[b]}));h.push(Object.assign(new na.a,{name:"DialogMode",string:this.Ubi()}));h.push(Object.assign(new na.a,{name:"CorrelationId",string:this.correlationId.toString()}));
h.push(Object.assign(new na.a,{name:"Provider",string:pC[this.lpa]||"Unknown"}));fa.a.sendTelemetryEvent(Object.assign(new oa.a,{name:this.telemetryEventName,dataFields:h}))}async refreshToken(b){this.gi=(new Date).getTime();try{const h=await b.PY("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");h.IsSuccess&&(this.LBa=h.Token);u.ULS.sendTraceTag(509092504,352,50,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: ${!!this.LBa} time: ${(new Date).getTime()-this.gi}`)}catch(h){u.ULS.sendTraceTag(508954306,
352,10,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: false time: ${(new Date).getTime()-this.gi} error: ${h} `)}}}Object(n.a)(zJ,"OnlineMediaDialog",LD,[]);class AJ{constructor(b,h){this.QEe=b;this.w2=h}QOc(b,h=!1){return new zJ(b,this.QEe,this.w2,null,h)}getInstance(){throw Error.notImplemented();}}Object(n.a)(AJ,"OnlineMediaDialogFactory",null,[414]);class BJ extends Jz{constructor(){super(1,3);this.JL=Ea.a.instance.resolve("Common.IReactContextualUILauncher");this.Uyj=!1}T6a(){w.AFrameworkApplication.va.processAction(Nc.a.bkc,
2)}IKd(){this.T0h&&!this.xv&&(this.xv=this.tKa())}wLd(){if(this.xv&&this.xv.isVisible){var b=Object(Na.a)(al.Control,this.xv.controls["ExternalContentFloatie.FlyoutAnchor"]);b.behavior.Yw(b.Ehb(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)u.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var h=b.getBoundingClientRect();0<h.top&&h.bottom<window.innerHeight&&(h=b.getAttribute(cf.a.kBd)||
"",cf.a.fM===h&&b.click())}}$_(){return this.JL.$_}}Object(n.a)(BJ,"ExternalContentFloatieManager",Jz,[]);class vs{constructor(){vs.zAm()}get uc(){return null!=this.$Jg?this.$Jg:this.$Jg=Ea.a.instance.resolve("Box4.Styles.IWACStyleReader")}get key(){return"FORMATTING_PARAGRAPH"}get Uw(){return null}tmc(b){var h=null;if(!fe.ParagraphReader.sh(b))return{returnValue:!1,yma:h};if((b=this.uc.No(b.currentNode))&&2===this.uc.AG(b)){const v=this.uc.kg(b);vs.kQ.contains(v)&&(h=this.uc.UQ(b),h=Object.assign(new dx.a,
{MG:this.key,contentId:b.id,contentObject:h}))}return{returnValue:!!h,yma:h}}nEb(b,h){let v=null;h&&b.contentId.equals(h.contentId)||(v=b.contentObject);return v}static zAm(){vs.kQ=new Gp.a;vs.kQ.add(fk.StyleReader.styleIdHeading1);vs.kQ.add(fk.StyleReader.styleIdHeading2);vs.kQ.add(fk.StyleReader.styleIdHeading3);vs.kQ.add(fk.StyleReader.k7a);vs.kQ.add(fk.StyleReader.CPb);vs.kQ.add(fk.StyleReader.DPb);vs.kQ.add(fk.StyleReader.Okc);vs.kQ.add(fk.StyleReader.Nkc);vs.kQ.add(fk.StyleReader.wordStyleIdHeading1);
vs.kQ.add(fk.StyleReader.wordStyleIdHeading2);vs.kQ.add(fk.StyleReader.wordStyleIdHeading3);vs.kQ.add(fk.StyleReader.w8a);vs.kQ.add(fk.StyleReader.x8a);vs.kQ.add(fk.StyleReader.y8a);vs.kQ.add(fk.StyleReader.Pqb);vs.kQ.add(fk.StyleReader.Qqb);vs.kQ.add(fk.StyleReader.z8a);vs.kQ.add(fk.StyleReader.D8a);vs.kQ.add(fk.StyleReader.Cnc)}}vs.kQ=null;Object(n.a)(vs,"ParagraphStyleDetailsProvider",null,[777,671]);class CJ{constructor(b,h,v,D){this.yKa=b;this.mak=h;this.uak=v;this.vak=D}n4f(){this.yKa.execute(b=>
{b.ohc(this.mak.value);b.ohc(new vs);b.ohc(this.vak.value);b.Y4(this.uak.value)})}}Object(n.a)(CJ,"AccessibilityActor",null,[]);class DJ{constructor(b,h,v){this.$h=null;this.E8c=(D,P,ca)=>{if(1===ca)return 32;this.$h=this.Trc.value.k9k(this.Ub);if(!this.$h)return u.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.$h.tTa();return 32};this.xmh=D=>this.$h?this.$h.Lpm(D):2;this.ga=b;this.Trc=h;this.Ub=v}Tb(){if(w.AFrameworkApplication.K.$("UIDiscoverabilityEnabled")){var b=
Xb.KeyInputManager.jc(Ve.a.drb,5);this.Ub.fe(Ne.AFrame.Pn).jr(b);this.Ub.fe(Ne.AFrame.rp).bindAction(b,Wa.a.E8c);this.ga.qa(Wa.a.E8c,ud.a.frame,this.E8c);this.ga.qa(Wa.a.yDc,ud.a.frame,this.xmh);this.ga.qa(Wa.a.xDc,ud.a.frame,this.xmh)}}}Object(n.a)(DJ,"AccessibilityHelpDialogActor",null,[]);var wM=c(1041),xM=c(1405);class EJ{constructor(b,h){this.b6j=b.mc("WordHangForActionManagerThresholdTime",750);this.ga=h;this.yVj=wM.a.eF(26,5,new xM.a)}AY(){this.ga.AY(this)}H4(){}F4(b){const h=+b.endTime-+b.startTime;
if(h>this.b6j){let v="";switch(b.behavior){case 1:v="E";break;case 2:v="X";break;case 3:v="A"}(b=Oc.ActionManager.Gaa(b.actionId))&&b.length||(b="UnknownAction");this.yVj.track(h,b+"_"+v)}}}Object(n.a)(EJ,"ActionHangDetector",null,[31]);var FJ=c(1488);class GJ extends We{constructor(b,h=null){super(b,void 0,w.AFrameworkApplication.P_a,new Mg(b,!1),void 0,void 0,h)}get q4a(){return this.DYd?CommonUIStrings.l_DownloadACopyDialog_CopyALinkText:this.PYd?CommonUIStrings.l_DownloadACopyDialog_EmailALinkText:
CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get ddc(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get XXc(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get WIc(){return w.AFrameworkApplication.P_a?"UIFontDialogTextLarge":null}get DYd(){return"VersionHistory"===this.OAh?!1:1===w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",0)}get PYd(){return"VersionHistory"===this.OAh?!1:2===w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",
0)}DKf(){u.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed");w.AFrameworkApplication.Kha("t1shrdnl;t2shrdnl;c-shrdnl")}EKf(){u.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}rYc(){u.ULS.sendTraceTag(19462214,324,50,"Download a copy dialog button clicked");w.AFrameworkApplication.va.processAction(Wa.a.vUh,2)}X$e(){this.k8({SourceControlId:"CopyLink"},{ControlId:"CopyLink"})}IVh(){this.k8({SourceControlId:"Share"},{ControlId:"Share"})}k8(b,h){const v=w.AFrameworkApplication.va;
v.xC=8;v.Qb(Wa.a.k8,2,b,h)}}Object(n.a)(GJ,"DownloadACopyDialog",We,[]);var wG;(function(b){b[b.Unknown=0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";b[b.Word=5]="Word";b[b.Project=6]="Project";b[b.Publisher=7]="Publisher";b[b.Infopath=8]="Infopath";b[b.Access=9]="Access"})(wG||(wG={}));Object(n.b)("OfficeApplication",wG);var JF;(function(b){b[b.ReadWrite=0]="ReadWrite";b[b.ReadOnly=1]="ReadOnly";b[b.WriteOnly=2]="WriteOnly";b[b.ForceCheckout=
3]="ForceCheckout";b[b.WriteLocalCopy=4]="WriteLocalCopy";b[b.OpenInBrowser=5]="OpenInBrowser"})(JF||(JF={}));Object(n.b)("OpenDocumentMode",JF);class HJ extends bg.a{constructor(){super(!1,!1,!0)}b9d(){var b={["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const h=Array(5);h[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};
h[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};h[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};h[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};h[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",["options"]:h};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.Wh("Send feedback to Microsoft",this.pmo.bind(this),b);return new Promise(v=>{this.ndk=v})}pmo(b,
h){1===b&&this.sP(h.selectedReason)}dispose(){super.dispose();this.ndk()}sP(b){const h={},v={},D={},P={},ca={};h.appId=2155;h.manifestType="Fps";h.submitTime=(new Date).toISOString();h.source="Client";h.type="Survey";h.clientFeedbackId=ub.a.create().toString();ca.reason=b;const ta={},Ra={numberOfOptions:5};Ra.selectedRating=b;ta.rating=[Ra];P.surveySpecificData=JSON.stringify(ta);D.extendedManifestData=JSON.stringify(P);h.application=D;ca.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";h.survey=ca;
h.telemetry=this.iAb();h.web=this.GFc();v["Content-Type"]="application/json";this.WGa(JSON.stringify(h),v)}Kaa(b,h,v,D){h&&b&&D&&v&&D in h&&(b[v]=h[D])}iAb(){const b=w.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=w.AFrameworkApplication.buildVersion;h.featureArea="Open In Desktop App";this.Kaa(h,b,"audienceGroup","AudienceGroup");this.Kaa(h,b,"osBuild","OsVersion");this.Kaa(h,b,"platform","Platform");this.Kaa(h,b,"processSessionId","WACSessionID");return h}GFc(){const b=w.AFrameworkApplication.sessionStartInfoSettings,
h={};this.Kaa(h,b,"browser","Browser");this.Kaa(h,b,"browserVersion","BrowserVersion");this.Kaa(h,b,"dataCenter","WACDatacenter");return h}WGa(b,h,v=0){let D=0;3<v||(1===v?D=200:1<v&&(D=200+500*(v-1)),w.AFrameworkApplication.nc.Vb(new qf.a(2,1,D,()=>{w.AFrameworkApplication.Ne.xj("https://petrol.office.microsoft.com/v1/feedback",2,b,h,!1,2,()=>{u.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},()=>{this.WGa(b,h,v+1);u.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",
v)},null)})))}}Object(n.a)(HJ,"WordOpenInClientFeedbackDialog",bg.a,[]);var IJ=c(1767);const RE=b=>{for(let h=0;h<b.children.length;h++){const v=b.children[h];v.style.position="relative";v.style.top=(v.parentNode.offsetHeight-v.offsetHeight)/2+"px"}},xG=b=>b.Hb.keyCode===Ve.a.Fs||b.Hb.keyCode===Ve.a.QIa?(b.xf.click(),!0):!1,KF=(b,h,v,D,P,ca,ta)=>{const Ra=document.createElement("a");Ra.className="ProtocolLaunchingDialogButtonAnchor";Ra.className+=" OICDialog";Ra.id=b;Ra.setAttribute(cf.a.qh,cf.a.j3);
Ra.style.padding="0";Ra.style.margin="0";D&&JJ(P,h,v,D,Ra);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=P;Ra.appendChild(b);Ra.tabIndex=0;ca&&Th.a.instance.nb(Ed.a.click,Ra,ca);ta&&Xb.KeyInputManager.instance.nb(Ed.a.uh,Ra,ta);return Ra},JJ=(b,h,v,D,P)=>{var ca=document.createElement("img");ca.alt=b;ca.className=Xc.getImageClassWithCluster(v,D);ca.src=h;ca.setAttribute(cf.a.qh,cf.a.fz);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";
b.appendChild(ca);ca=document.createElement("span");ca.className="ProtocolLaunchingDialogIconContainer";ca.appendChild(b);P.appendChild(ca)};class yG{static get Yg(){return bg.a.vA(yG.Km,CommonUIStrings.l_OICLaunchDialogTitle)}}yG.Km="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(n.a)(yG,"OICLaunchDialogHtml",null,[]);class KJ extends bg.a{constructor(b){super();this.ZSb=this.Prb=null;this.rS=!1;this.Gp=b;this.Yg=yG.Yg;this.Ad=5;this.wg="OICLaunchDialog";this.showDialog("",Object(z.a)(this,this.Nkn,"oicLaunchDialogResultHandler"));this.lmj();this.h5("ProtocolLaunchingDialogTitle");4!==w.AFrameworkApplication.ta.Nb.eOa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.W0(this.Prb);u.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}k9(){this.Prb=KF("BtnRichClient",this.Gp.hKc,this.Gp.qSc,this.Gp.nzf,CommonUIStrings.l_OICLaunchRichClient,Object(z.a)(this,this.DXi,"onRichClientButtonClick"),xG);document.getElementById("OICLaunchRichClient").appendChild(this.Prb);RE(this.Prb);this.ZSb=KF("BtnReturn",this.Gp.hKc,this.Gp.qSc,this.Gp.cqi,CommonUIStrings.l_OICReturnToOnlineClient,Object(z.a)(this,this.xXi,"onReturnButtonClick"),
xG);document.getElementById("OICReturnToApp").appendChild(this.ZSb);RE(this.ZSb)}xXi(){this.hide();this.Gp.Mhc();return!0}DXi(){u.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();w.AFrameworkApplication.va.processAction(Wa.a.ANb,2);return!0}Nkn(){this.Gp.Mhc()}dispose(){this.rS||(this.Prb&&(Th.a.instance.sc(Ed.a.click,this.Prb,Object(z.a)(this,this.DXi,"onRichClientButtonClick")),Xb.KeyInputManager.instance.sc(Ed.a.uh,this.Prb,xG)),this.ZSb&&(Th.a.instance.sc(Ed.a.click,
this.ZSb,Object(z.a)(this,this.xXi,"onReturnButtonClick")),Xb.KeyInputManager.instance.sc(Ed.a.uh,this.ZSb,xG)),super.dispose(),this.rS=!0)}}Object(n.a)(KJ,"OICLaunchDialog",bg.a,[]);class zG{static get Yg(){return bg.a.vA(zG.Km,CommonUIStrings.l_OICDialogTitle)}}zG.Km="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(n.a)(zG,"ProtocolLaunchingDialogV2Html",null,[]);class LJ extends bg.a{constructor(b){super();this.YSb=this.XUa=null;this.rS=!1;this.x9a=null;this.Gp=b;this.Yg=zG.Yg;this.Ad=5;this.wg="ProtocolLaunchingDialog";this.qrc="OICRetryDialog";w.AFrameworkApplication.nc.aGb&&w.AFrameworkApplication.nc.restart();w.AFrameworkApplication.nc.Vb(new qf.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(z.a)(this,this.l1f,"protocolLaunchingDialogResultHandler"));this.lmj();this.h5("Issues");
this.k1h();u.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}k9(){const b=document.getElementById("Issues");if(b){JJ("",this.Gp.hKc,this.Gp.qSc,this.Gp.nzf,b);const h=document.createElement("span");h.className="WACDialogSectionTitle";h.innerText=5===this.Gp.pZi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(h);RE(b);b.style.display="none"}w.AFrameworkApplication.ta.Nb.Dki?
(this.YSb=KF("GiveFeedback",this.Gp.hKc,this.Gp.qSc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(z.a)(this,this.l7d,"onGiveFeedbackClick"),Object(z.a)(this,this.iVi,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.YSb),RE(this.YSb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===w.AFrameworkApplication.ta.Nb.eOa||w.AFrameworkApplication.rol?document.getElementById("ButtonEdit").style.display="none":(this.XUa=
KF("Edit",this.Gp.hKc,this.Gp.qSc,"",2===w.AFrameworkApplication.ta.Nb.Tl?4===w.AFrameworkApplication.ta.Nb.eOa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===w.AFrameworkApplication.ta.Nb.eOa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(z.a)(this,this.KUi,"onEditClick"),Object(z.a)(this,this.NUi,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.XUa),RE(this.XUa));0===w.AFrameworkApplication.ta.Nb.eOa&&
!w.AFrameworkApplication.cFf&&b&&(b.style.display="none")}l1h(){return this.x9a?(this.W0(this.x9a),!0):!1}k1h(){return this.XUa?(this.W0(this.XUa),!0):!1}NUi(b){return this.kTf(b,0)}iVi(b){return this.kTf(b,2)}wXi(b){return this.kTf(b,1)}kTf(b,h){let v=!1;if(b.Hb.keyCode===Ve.a.Fs||b.Hb.keyCode===Ve.a.QIa)b.xf.click(),v=!0;else if(b.Hb.keyCode===Sys.UI.Key.down||b.Hb.keyCode===Sys.UI.Key.up)switch(h){case 1:v=this.k1h();break;case 0:v=this.l1h()}return v}KUi(){this.hide();4===w.AFrameworkApplication.ta.Nb.eOa?
(u.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Gp.Mhc()):(u.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Gp.FQc());return!0}l7d(){u.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}TUf(){AF.Redirect.showHelp("OICFailure");return!0}k8d(){u.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";w.AFrameworkApplication.va.processAction(Wa.a.ANb,2);return!0}l1f(){this.Gp.Mhc()}switchToBackupMode(){var b=
document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!b.children.length&&(this.x9a=KF("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(z.a)(this,this.k8d,"onRetryOICClick"),Object(z.a)(this,this.wXi,"onRetryOICKeyUp")),b.appendChild(this.x9a),RE(this.x9a),this.XUa||this.l1h())}}dispose(){this.rS||(this.XUa&&
(Th.a.instance.sc(Ed.a.click,this.XUa,Object(z.a)(this,this.KUi,"onEditClick")),Xb.KeyInputManager.instance.sc(Ed.a.uh,this.XUa,Object(z.a)(this,this.NUi,"onEditKeyUp"))),this.YSb&&(Th.a.instance.sc(Ed.a.click,this.YSb,Object(z.a)(this,this.l7d,"onGiveFeedbackClick")),Xb.KeyInputManager.instance.sc(Ed.a.uh,this.YSb,Object(z.a)(this,this.iVi,"onGiveFeedbackKeyUp"))),this.x9a&&(Th.a.instance.sc(Ed.a.click,this.x9a,Object(z.a)(this,this.k8d,"onRetryOICClick")),Xb.KeyInputManager.instance.sc(Ed.a.uh,
this.x9a,Object(z.a)(this,this.wXi,"onRetryOICKeyUp"))),super.dispose(),this.rS=!0)}}Object(n.a)(LJ,"ProtocolLaunchingDialog",bg.a,[]);class AG extends ug.StandardDialog{constructor(b){super();this.Gp=b;this.wg="ProtocolLaunchingDialog";w.AFrameworkApplication.nc.aGb&&w.AFrameworkApplication.nc.restart();w.AFrameworkApplication.ta.Nb.Dki&&this.etk(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(z.a)(this,this.l7d,"onGiveFeedbackClick"));AG.Hmi?(this.Ad=12,this.Ee(1,CommonUIStrings.l_CloseFile),
this.Ee(2,CommonUIStrings.l_OICDialogContinueHere),this.Ee(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Ad=4,this.Ee(1,CommonUIStrings.l_OICDialogContinueHere),this.Ee(2,CommonUIStrings.l_OICDialogLaunchAgain));this.ylb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Gp.pZi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(z.a)(this,this.l1f,"protocolLaunchingDialogResultHandler"),null)}l7d(b){u.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.TUi(b)}k8d(){u.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");w.AFrameworkApplication.va.processAction(Wa.a.ANb,2)}l1f(b){AG.Hmi?3===b?this.gfj():2===b||0===b?this.continueEditing():1===b&&this.closeDocument():2===b?this.gfj():(1===b||0===b)&&this.continueEditing()}closeDocument(){u.ULS.sendTraceTag(577783557,211,50,"Closing the document");w.AFrameworkApplication.va.Qb(Wa.a.close,2,vh.a)}gfj(){u.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(z.a)(this,this.k8d,
"onRetryOICClick"),0)}continueEditing(){4===w.AFrameworkApplication.ta.Nb.eOa||w.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&1===w.AFrameworkApplication.ta.mode?(u.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Gp.Mhc()):(u.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Gp.FQc())}static get Hmi(){return w.AFrameworkApplication.K.$("OICDialogThreeActions")&&32===w.AFrameworkApplication.va.processAction(Wa.a.close,
1)}}Object(n.a)(AG,"StandardProtocolLaunchingDialog",ug.StandardDialog,[]);class MJ{}Object(n.a)(MJ,"EditDocumentInClientParams",null,[]);class lH{static ZUh(b,h,v,D,P,ca,ta=!1,Ra=!1,mb="",Jb=!1,Ub=!1,cc=!1,Ac="",Lc="",id="",vd=!1,xe=""){const Ld=new MJ;Ld.DocumentUrl=b;Ld.DocumentExtension=xe;Ld.Mode=h;Ld.Options=v;Ld.Application=D;Ld.SilentExternalHandler=ta;Ld.EncodeUrl=Ra;Ld.CorrelationIdForWinClient=mb;Ld.NavigateUsingWindowOpen=Jb;Ld.DescriptiveUnattemptedEnums=Ub;Ld.NoBrowserModalDialogs=cc;
Ld.SessionOrigin=Ac;Ld.CorrelationId=Lc;Ld.ClickTime=id;Ld.NewTelemetryDataIsEnabled=vd;MSOJS.ClientUtils.EditDocumentInClient(Ld,P,ca)}}Object(n.a)(lH,"ClientUtils",null,[]);var yM=c(535),NJ=c(943);class hE{constructor(b){this.wXa=this.ssc=this.kqc=null;this.Dtc=!1;this.fze=this.XJe=this.V8g=null;this.Ffd=this.Py=this.vud="";this.application=this.Ty=0;this.yGo=this.Dhg=!1;this.c1o=b&&w.AFrameworkApplication.K.$("OICLaunchDialogIsEnabled");w.AFrameworkApplication.va.y_(Wa.a.ANb)||w.AFrameworkApplication.va.qa(Wa.a.ANb,
ud.a.frame,Object(z.a)(this,this.k9n,"retryOpenInClientAction"));this.Etj=!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("SilentExternalHandler")}get pZi(){return this.Ty}cpo(b,h="",v=""){this.Py=v||ub.a.create().toString();this.vud=h||yM.a.Lci();this.Ffd=b}k9n(b,h,v){return h.contextId!==ud.a.frame?2:1===v?32:this.ANb()}get options(){let b=0;w.AFrameworkApplication.h6n&&(b|=1);w.AFrameworkApplication.vZi&&(b|=4);this.rGo()&&(b|=64);return b}rGo(){return!(2===this.application&&w.AFrameworkApplication.K.$("IsEmbeddedScenario"))}get hKc(){return w.AFrameworkApplication.Ws}get qSc(){return w.AFrameworkApplication.Wba}get cqi(){return""}get nzf(){return""}get xGo(){return w.AFrameworkApplication.K.$("OneNoteMobileViewerIsEnabled")}get gKo(){return this.V8g||
(this.V8g=Ea.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.Dhg||this.xyl()}Mhc(){this.yGo||this.wYh()}H7i(b){return this.c1o&&aa.a.ti?(new KJ(this),32):this.hHh(b)}hHh(b){const h=({hqb:b}=this.TYm(b)).returnValue;u.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===h,b);return h}begin(b,h,v,D,P,ca,ta=""){this.kqc=b;this.fze=ta;this.ssc=h;this.wXa=ca;this.application=v;this.Ty=D;return w.AFrameworkApplication.CUh?(this.KFi(),32):w.AFrameworkApplication.bpa&&
!w.AFrameworkApplication.Eoi?(w.AFrameworkApplication.Xeg(),8):this.Dwh(P)}get Mkn(){return!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}ANb(){this.Mkn&&this.u2m();return this.hHh(this.Dtc)}xjj(){const b=new NJ.a(L.a.openInClient);b.Values["ui-language"]=w.AFrameworkApplication.lcid.toString();b.Values[Dy.a.HOh]=w.AFrameworkApplication.userSessionId;return this.wXa.value.send(b)?32:8}u2m(){va.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Bb.a,{inStaging:!0}))}Efo(b){const h=new NJ.a(L.a.Z3o);h.Values["ui-language"]=w.AFrameworkApplication.lcid.toString();h.Values[Dy.a.HOh]=w.AFrameworkApplication.userSessionId;h.Values[H.a.Y3o]=b;this.wXa.value.send(h)}TYm(b){this.Dtc=b;this.Efo(5===this.Ty?hE.Jxn:hE.Pxn);return 5===this.Ty?this.SYm():this.WYm()}SYm(){this.UFi();return{returnValue:32,hqb:"HostEditUrl,"}}WYm(){let b;var h=b="";w.AFrameworkApplication.tph&&(h="|f|"+w.AFrameworkApplication.userSessionId);
const v=w.AFrameworkApplication.K.$("IsAssignmentMode")&&w.AFrameworkApplication.K.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||w.AFrameworkApplication.EWc||aa.a.FQa,D=w.AFrameworkApplication.K.$("UnattemptedEnumIsEnabled"),P=w.AFrameworkApplication.K.$("NoBrowserModalDialogs");if(w.AFrameworkApplication.va.L5d){var ca=w.AFrameworkApplication.va.EX(3588168074);ca&&this.cpo(ca.epochClickTime,ca.sessionOrigin,ca.correlationId);this.NKi()}if(w.AFrameworkApplication.j3i){b+="NewOrder,";
ca=8;this.wXa&&this.wXa.value&&this.wXa.value.isEnabled()&&w.AFrameworkApplication.pRb&&(b+="Post,",ca=this.xjj());if(32===ca)return{returnValue:ca,hqb:b};u.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return w.AFrameworkApplication.zs.q9?(u.ULS.shipAssertTag(5566816,211,!!w.AFrameworkApplication.zs.q9),b+="HostUrl,",{returnValue:w.AFrameworkApplication.ta.DU(!0,w.AFrameworkApplication.zs.q9),hqb:b}):this.kqc?(u.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",
w.AFrameworkApplication.userSessionId),b+="DocUrl,",lH.ZUh(this.kqc,this.Ty,this.options,this.application,Object(z.a)(this,this.MUi,"onEditInClientSuccess"),Object(z.a)(this,this.LUi,"onEditInClientFailure"),this.Etj,w.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,v,D,P,this.vud,this.Py,this.Ffd,w.AFrameworkApplication.va.L5d,this.fze),{returnValue:32,hqb:b}):{returnValue:8,hqb:b}}b+="OldOrder,";if(!this.kqc&&w.AFrameworkApplication.zs.q9)return this.wXa&&this.wXa.value&&this.wXa.value.isEnabled()&&
w.AFrameworkApplication.pRb?(b+="Post,",h=this.xjj()):(u.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),h=8),32!==h?(u.ULS.shipAssertTag(22595484,211,!!w.AFrameworkApplication.zs.q9),b+="HostUrl,",{returnValue:w.AFrameworkApplication.ta.DU(!0,w.AFrameworkApplication.zs.q9),hqb:b}):{returnValue:h,hqb:b};u.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",w.AFrameworkApplication.userSessionId);b+="DocUrl,";lH.ZUh(this.kqc,
this.Ty,this.options,this.application,Object(z.a)(this,this.MUi,"onEditInClientSuccess"),Object(z.a)(this,this.LUi,"onEditInClientFailure"),this.Etj,w.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,v,D,P,this.vud,this.Py,this.Ffd,w.AFrameworkApplication.va.L5d,this.fze);return{returnValue:32,hqb:b}}m5n(b){w.AFrameworkApplication.Qm.setDw(8981,b)}MUi(b){this.m5n(b);u.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?(this.xGo||this.UFi(),
this.NKi()):this.Dhg||this.closeApplication()}LUi(b,h=0){u.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",b,h);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const v=!!this.ssc&&!this.Dtc;let D=0;1===b&&(D=2);6<=b&&13>=b&&(D=1,1===h&&(this.Dhg=!0));this.gKo.wkn?(u.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",D),IJ.a.instance.Tcl(this.Dtc?Object(z.a)(this,this.TSi,"oicErrorDialogHandlerCloseForced"):
Object(z.a)(this,this.USi,"oicErrorDialogHandlerNoCloseForced"),v?Object(z.a)(this,this.LVi,"onLaunchDownload"):null,this.pSh(!1)?Object(z.a)(this,this.nvm,"iHaveOfficeButtonHandler"):null,D,h)):(u.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",D),IJ.a.instance.Rcl(this.Dtc?Object(z.a)(this,this.TSi,"oicErrorDialogHandlerCloseForced"):Object(z.a)(this,this.USi,"oicErrorDialogHandlerNoCloseForced"),v?Object(z.a)(this,this.LVi,"onLaunchDownload"):null,D))}}NKi(){try{const b=
[Object.assign(new na.a,{name:"CorrelationId",string:this.Py}),Object.assign(new na.a,{name:"SessionOrigin",string:this.vud}),Object.assign(new na.a,{name:"ClickTime",string:this.Ffd}),Object.assign(new na.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Xe.a("OpenInClientCompleted",!0,0,b)}catch(b){u.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}UFi(){w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.mF&&w.AFrameworkApplication.K.$("StandardProtocolDialogIsEnabled")?
new AG(this):new LJ(this)}TSi(){this.closeApplication()}USi(){this.Mhc()}LVi(){this.KFi()}nvm(){return this.pSh(!0)}pSh(b){const h=(aa.a.OUc||aa.a.iu)&&!!w.AFrameworkApplication.$Id;h&&b&&(Dd.a.om(w.AFrameworkApplication.$Id,"_blank",void 0,"OpenInClient"),this.closeApplication());return h}}hE.Pxn="OpenInDesktop";hE.Jxn="OpenInBrowser";Object(n.a)(hE,"AOpenInClientOperation",null,[]);class mH extends hE{constructor(b,h,v=!1){super(v);this.o7j=b;this.n7j=h}get cqi(){return this.n7j}get nzf(){return this.o7j}xyl(){w.AFrameworkApplication.va.Qb(Wa.a.close,
2,vh.a)}wYh(){}Dwh(b){return this.H7i(b)}KFi(){u.ULS.shipAssertTag(5566817,211,!!this.ssc);w.AFrameworkApplication.hca?w.AFrameworkApplication.ta.DU(!0,this.ssc):Dd.a.om(this.ssc,void 0,void 0,"LaunchDownload")}FQc(){w.AFrameworkApplication.ta.Nb.FQc()}}Object(n.a)(mH,"OpenInClientOperation",hE,[]);class OJ extends mH{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",!0);this.FZn=b=>{u.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");Xa.App.iV.forceOutbound(this.GZi,
this.T1m,b)};this.T1m=b=>{u.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const h=new ug.StandardDialog;h.Ad=0;h.nx(lm.a.vSo,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.R1m:this.S1m)};this.R1m=()=>{w.AFrameworkApplication.va.Qb(Wa.a.close,2,vh.c)};this.S1m=()=>{Xa.App.xa.refreshDocument(null)};this.GZi=b=>{w.AFrameworkApplication.$9c=!0;u.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",b);
this.H7i(b)}}NKk(b){Xa.App.Xj.z4a.r$b||Xa.App.rd.bC.zo?(u.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.GZi(b)):cw.a.NQ(4,!0,this.FZn,null,b)}Dwh(b){this.NKk(b);return 32}wYh(){Xa.App.xa.refreshDocument(null)}}Object(n.a)(OJ,"OpenInWordOperation",mH,[]);const PJ=(b,h)=>{u.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");b[If.a.On]=Ih.PageReader.instance.nv(h);Ih.PageReader.instance.nv(h)?b[If.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:
b[If.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},zM=(b,h,v,D,P)=>{if(!Xa.App.xa||!Xa.App.xa.ib||!w.AFrameworkApplication.vn.ohb)return 8;h=Xa.App.xa.ib.Uc;if(!h)return 8;if(b===Gb.a.cbe&&2===v){b=new eh.GraphTransaction(15);try{b.Cb(h),Ih.PageReader.instance.ZLo(h)}finally{b&&b.dispose()}PJ(P,h)}return 32},AM=(b,h,v,D,P)=>{if(!Xa.App.xa||!Xa.App.xa.ib)return 8;b=Xa.App.xa.ib.Uc;if(!b)return 8;P[If.a.Alt]=w.AFrameworkApplication.vn.ohb?"":CommonUIStrings.l_ProtectDocumentToolTip;
PJ(P,b);return 32};class QJ extends FJ.a{constructor(b,h){super(b,h);this.c2g=!1;this.qWi=(v,D,P,ca,ta)=>{var Ra;if(D.contextId!==ud.a.frame)return 2;if(!(Xa.App.RGc||w.AFrameworkApplication.zs.q9||w.AFrameworkApplication.pRb||this.c2g))return u.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.c2g=!0,8;if(1===P)return bc.SessionStatusManager.instance.Gj?8:32;let mb=!1;void 0!==ta&&null!==ta&&(mb=ta);if(null===(Ra=w.AFrameworkApplication.K)||void 0===Ra?0:Ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",
!1))(new HJ).b9d().then(()=>this.eLb(v,mb));else return this.eLb(v,mb);return 32};this.Ymc=(v,D,P)=>{2==P&&(Xe.a("OpenFileFromPC"),Xa.App.Xgb(w.AFrameworkApplication.breadcrumbBrandUrl));return 32};this.wql=v=>{this.j3m();if(!w.AFrameworkApplication.EWc&&w.AFrameworkApplication.ta.Nb.hdg(Wa.a.downloadACopy.toString()))this.Aya(!0,L.a.download,!0,{});else if(w.AFrameworkApplication.K.$("WordEditorDownloadACopyUiIsEnabled")){let D=w.AFrameworkApplication.DCb;v&&v.FileDownloadUrl&&(D=v.FileDownloadUrl.toString());
new GJ(D)}else super.downloadACopy(0,null,2,null,null)};this.XSk=v=>{super.workflow(0,null,2,null,v)};this.DI=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback")}Tb(){super.Tb();this.ga.qa(Gb.a.openInClient,ud.a.frame,this.qWi);w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",!1)&&this.ga.Vc(Gb.a.openInClient,12288);var b=this.ga;b.eb(Gb.a.cbe,sc.a.application,zM,4);b.eb(Gb.a.m2f,sc.a.application,AM,96);this.ga.qa(Wa.a.aXf,
ud.a.frame,this.qWi);this.ga.qa(Gb.a.Ymc,sc.a.view,this.Ymc)}eLb(b,h){u.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new OJ).begin(Xa.App.RGc,w.AFrameworkApplication.DCb,wG.Word,b===Wa.a.aXf?JF.OpenInBrowser:JF.WriteOnly,h,new Gg.a(()=>this.OX))}JBd(b){return Xi.a.instance.MCa()?!0:Xa.App.xa.Xgj(1,xk.AppFrame.$_k,b)}downloadACopy(b,h,v,D,P){if(2===v){if(!w.AFrameworkApplication.DCb&&!w.AFrameworkApplication.ta.Nb.hdg(Wa.a.downloadACopy.toString()))return 8;
cw.a.NQ(2,!0,this.wql,null,P);this.Pqe();return 32}return super.downloadACopy(b,h,v,D,P)}Pqe(){w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.DI&&(u.ULS.sendTraceTag(509145740,306,50,"DownloadCopyIntercept logged for: DownloadACopy"),this.DI.execute(b=>b.logActivity("DownloadCopyIntercept",null)))}j3m(){w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=
this.DI&&this.DI.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,h,v,D,P){return 2===v?(cw.a.NQ(13,!0,this.XSk,null,P),32):super.workflow(b,h,v,D,P)}}Object(n.a)(QJ,"AppFrameCommandUIActor",FJ.a,[]);class RJ extends ug.StandardDialog{constructor(){super();this.Ad=0;this.ylb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,
null,null)}}Object(n.a)(RJ,"WheresTheSaveButtonDialog",ug.StandardDialog,[]);const BM=(b,h,v)=>{if(1===v)return 32;new RJ;return 32};var nH=c(537),SJ=c(1374);class at extends lk.a{constructor(b,h,v,D,P,ca,ta=null){var Ra,mb;super();this.$cc=ta;this.qYj=50;this.rYj=56;this.ozc="px";this.Dte="aria-label";this.oJa="BookmarkIndicator";this.LYg="HighlightBookmarkedContent";this.v6j="HighlightBookmark";this.bWa="wwaengidc";this.$Lk="Bookmark_24";this.fb=b;this.ig=v;this.sk=h;this.XV=D;this.Zz=P;this.vYj=
null===(Ra=w.AFrameworkApplication.K)||void 0===Ra?void 0:Ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1);this.mYj=null===(mb=w.AFrameworkApplication.K)||void 0===mb?void 0:mb.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkHighlightIsEnabled",!1);this.Zz&&this.Zz.Qzd(this.OB.bind(this));this.uI=ca}kso(b){if(b.zj){for(const h of b.Fg.Oi)if(this.eqj(h))return!0;return!1}return this.eqj(b.htmlElement)}Tob(b){let h=!1;w.AFrameworkApplication.ue("bookmarks-core-ex;bookmarks-core-ex-cf");
this.vYj&&ns.a.instance.ie(()=>{h=this.kso(b)},"BIA:SCIVE");return h}eqj(b){return at.HSe?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<b.length?!0:!1:!1}sfb(b){const h=[];ns.a.instance.ie(()=>{const v=b.veb(0,this.uI?this.rYj:this.qYj,this.zoom);h.push(this.lDa(b.O4,v,b.snc[0].y-b.bca[0].y))},"BIA:CIs");return h}lDa(b,h,v){const D=b.fh.ownerDocument,P=Oh.a.createElement(D,ki.a.div);P.className=this.uI?at.uYj:at.tue;at.tue;P.style.left=h+this.ozc;
P.style.top=v+this.ozc;this.uI?(h=Oh.a.createElement(D,ki.a.div),Rh.a("renderIcon")&&appChrome.api.renderIcon(this.$Lk,h),h.setAttribute("role","img"),h.setAttribute("alt","Bookmark")):(h=Oh.a.createElement(D,ki.a.f2a),h.src=Ic.a.vg(at.bfd),h.alt="Bookmark");h.title="Bookmark";h.setAttribute(this.Dte,"Bookmark");P.appendChild(h);b={context:new tG([],P,new Set,new Set,null,null),pSf:b,container:P};this.uI||(this.sk.nb(Ed.a.rR,h,this.onMouseEnter),this.sk.nb(Ed.a.jL,h,this.tpa));this.ig.eE(Ed.a.click,
P,this.oGa.bind(this),b);return P}XDd(){const b=Object.assign(new gh.a,{action:1,type:5,FA:null,LJ:this.eea});this.eea=null;this.XV.zF(b)}OB(b,h){this.eea&&(h.l0a.xf.classList.contains("BookmarkHighlightSelected")||this.XDd())}onMouseEnter(b){if(null==b)return!1;b=b.xf;b.parentElement.classList.add(at.dNg);b.src=Ic.a.vg(at.oYj);return!0}tpa(b){if(null==b)return!1;b=b.xf;b.parentElement.classList.remove(at.dNg);b.src=Ic.a.vg(at.bfd);return!0}oGa(b){this.C5a(this.LYg,this.v6j);if(null==b){var h=new Map;
h.set("Source",this.oJa);h=Object.assign(new Bb.a,{additionalValues:h});va.Health.instance.recordKpiFailure(this.LYg,"Unable to highlight bookmarked content",!1,!0,h);return!1}w.AFrameworkApplication.ue("bookmarks-highlight-ex;bookmarks-highlight-ex-cf");if(this.mYj){h=b.Ro.context;if(at.q3a(h,this.eea))return!0;h=this.Qqf(b.Ro.pSf,h,b.Ro.container);b=Object.assign(new gh.a,{action:0,type:5,FA:h,LJ:this.eea});this.eea=h;this.XV.zF(b);return!0}return!1}Qqf(b,h,v){h={nxh:new Set,mLb:new Set,qxh:null,
g4e:null};const D=this.fb.tw(b.Bb,!0,!1),P=[];if(D)for(const ca of D)P.push(ca);this.Auk(b,h,P);h=new tG(P,v,h.nxh,h.mLb,h.qxh,h.g4e);this.eea&&this.eea.Yr===P&&(v.className+=String.format(" {0}",at.pYj),this.eea=h);return h}Auk(b,h,v){if(b.zj){const P=new Set;for(const ca of b.Fg.Oi)ca.querySelectorAll("*").forEach(P.add,P);b=Array.from(P.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),0);let D=[];h.mLb.add(v[0].id);h.qxh=v[0].id;h.g4e=v[0].id;b.forEach(P=>{const ca=
fd.a.Db(P,Co.a.XBd);if(ca)for(const ta of ca)D.push(ta),h.nxh.add(ta);if(!D.length)return!0;P=fd.a.Db(P,Co.a.$zb);if(!P)return!0;D=SJ.a.rhc(D,P)});for(b=this.fb.jg(v[v.length-1],!1,!0);D.length&&b;)h.mLb.add(b.id),h.g4e=b.id,v.push(b),this.$cc.value.Fj(b).htmlElement.querySelectorAll("."+Co.a.f4e).forEach(P=>{(P=fd.a.Db(P,Co.a.$zb))&&(D=SJ.a.rhc(D,P))}),b=this.fb.jg(b,!1,!0)}C5a(b,h){const v=new Map;v.set("Source",this.oJa);v.set("Action",h);va.Health.instance.recordKpiUsage(b,0,this.bWa,v)}static q3a(b,
h){return!!h&&!!b&&b.lxh===h.lxh}}at.dNg="WordBookmarkIndicatorContainerHovered";at.pYj="WordBookmarkIndicatorContainerSelected";at.bfd="BookmarkDefault.png";at.oYj="BookmarkHover.png";at.HSe=!0;at.tue="WordBookmarkIndicatorContainer";at.uYj="WordBookmarkSvgIndicatorContainer";Object(n.a)(at,"BookmarkIndicatorActor",lk.a,[384]);class TJ{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb=null,Ub=null,cc=null,Ac=null,Lc=null,id=null,vd=null){this.r2="_";this.Ute="Bookmark";this.OXj=/^BOOKMARK\d+$/i;this.oJa="BookmarkRibbonOptions";
this.kYj="BookmarkFloatieOptions";this.LQg="CreateBookmarkOnRange";this.MQg="CreateBookmarkOnView";this.KQg="CreateBookmarkOnIP";this.lxe="CreateBookmark";this.bWa="wwaengidc";this.ygh="ShowHideBookmarksOnDocument";this.YRg="DeleteBookmark";this.k1j="DeleteBookmarkAction";this.Bkk="ShowHideBookmarks";this.xgh="ShowBookmarksFloatie";this.ykk="ShowBookmarksFloatieAction";this.CTg="EditBookmark";this.j2j="EditBookmarkAction";this.k4e="BookmarksUsage";this.dMk="InsertTabSwitchActivity";this.GDm="Insert";
this.uSb=b;this.ga=h;this.hb=v;this.pn=D;this.wx=P;this.C6=ca;this.Ic=ta;this.JL=Ra;this.Jp=Ub;this.cNg=mb;this.Ie=Jb;this.l6=Lc;this.Kn=cc;this.fd=Ac;this.eS=id;this.Jk=vd}get ix(){return this.wx.value}Tb(){this.$Bf()&&(this.ga.qa(Nc.a.NNa,sc.a.view,this.NNa.bind(this)),this.ga.eb(Wa.a.OTa,sc.a.application,this.COo.bind(this),96),this.ga.qa(Nc.a.NNa,sc.a.Hd,this.Z9k.bind(this)),this.ga.qa(Nc.a.NNa,sc.a.Tc,this.Y9k.bind(this)),this.ga.qa(Nc.a.deleteBookmark,sc.a.view,this.deleteBookmark.bind(this)),
this.ga.qa(Nc.a.Vgf,sc.a.view,this.mtl.bind(this)),this.ga.eb(Nc.a.Mrj,sc.a.view,this.Axo.bind(this),1028),this.ga.eb(Nc.a.jbe,sc.a.application,this.jbe.bind(this),96),this.ga.eb(Nc.a.Oie,sc.a.Tc,this.Oie.bind(this),1028),this.ga.eb(Gb.a.x1d,sc.a.view,this.x1d.bind(this),1028),this.ga.eb(Nc.a.KVd,sc.a.view,this.KVd.bind(this),1028),this.ga.Vc(Nc.a.NNa,1028))}COo(b,h,v,D,P){return P&&P.NewContextId===this.GDm?(this.R2d(this.dMk),32):2}NNa(b,h,v,D,P){var ca,ta;b=this.hb.tg;if(!b||b.contextId===sc.a.anchoredObject)return 2;
if(1===v)return Ni.a.rha(h)||(null===(ca=this.Jk)||void 0===ca?0:ca.k_(b))||(null===(ta=this.Jk)||void 0===ta?0:ta.uha(b))?8:32;h=this.hb.gb.kb;if(!h||this.Ie.Sl(h))return 2;this.AYc(P,"User is trying to create bookmark from UILocation : {0}");this.C5a(this.MQg,this.lxe);if(h&&this.pn.cZe(this.POa(),h))return this.R2d(this.k4e),32;P=new Map;P.set("Source",this.oJa);P=Object.assign(new Bb.a,{additionalValues:P});va.Health.instance.recordKpiFailure(this.MQg,"Unable to create bookmark",!1,!0,P);return 8}Z9k(b,
h,v,D,P){if(1===v)return 32;if(sc.a.Hd!==h.contextId)return 8;this.AYc(P,"User is trying to create bookmark from UILocation : {0}");b=this.hb.gb.kb;if(!b)return 2;this.C5a(this.LQg,this.lxe);if(this.pn.cZe(this.POa(),b))return this.R2d(this.k4e),32;b=new Map;b.set("Source",this.oJa);b=Object.assign(new Bb.a,{additionalValues:b});va.Health.instance.recordKpiFailure(this.LQg,"Unable to create bookmark for range",!1,!0,b);return 8}Y9k(b,h,v,D,P){if(1===v)return 32;if(sc.a.Tc!==h.contextId)return 8;this.AYc(P,
"User is trying to create bookmark from UILocation : {0}");b=this.hb.gb.kb;if(!b)return 2;this.Ie.Sl(b)&&(h=b.Oa,this.Ie.pkb(h)?(b=this.Ie.w_(h,!1),b||(u.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),b=this.Ie.w_(h,!0))):u.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.C5a(this.KQg,this.lxe);if(this.pn.cZe(this.POa(),b))return this.R2d(this.k4e),32;b=new Map;b.set("Source",this.oJa);b=Object.assign(new Bb.a,
{additionalValues:b});va.Health.instance.recordKpiFailure(this.KQg,"Unable to create bookmark for IP",!1,!0,b);return 8}jbe(b,h,v,D,P){1===v&&32;P[If.a.On]=at.HSe;return 32}Axo(b,h,v,D,P){if(1===v)return 32;this.C5a(this.ygh,this.Bkk);(b=P[If.a.On])||u.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");at.HSe=b;b=Wk.PageNavigator.instance.LO(this.ix);if(null!==b)return this.O3c(b),this.uSb.WG({ShowBookmarks:"CheckboxModel"}),32;b=new Map;b.set("Source",this.oJa);b=
Object.assign(new Bb.a,{additionalValues:b});va.Health.instance.recordKpiFailure(this.ygh,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,h,v,D,P){if(this.$Bf()){b=this.hb.gb.kb;if(!b)return 2;b=b.Oa;b=this.pn.tPd(b.node,b.cpBegin);if(1===v)return b?32:8;this.AYc(P,"User is trying to delete bookmark from UILocation : {0}");this.JL.$_&&(u.ULS.sendTraceTag(545118155,3029,50,"Dismissing the bookmarks floatie"),this.JL.dismissFloatie());this.C5a(this.YRg,this.k1j);b||u.ULS.sendTraceTag(545118156,
3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.pn.A$i(b.id))return this.cNg&&this.cNg.XDd(),32;v=new Map;v.set("Source",this.oJa);v=Object.assign(new Bb.a,{additionalValues:v});va.Health.instance.recordKpiFailure(this.YRg,"Unable to delete bookmark",!1,!0,v);return 8}return 2}mtl(b,h,v,D,P){if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)){b=this.hb.gb.kb;if(!b)return 2;
b=b.Oa;b=this.pn.tPd(b.node,b.cpBegin);if(1===v)return b?32:8;this.AYc(P,"User is trying to edit bookmark from UILocation : {0}");this.JL.$_&&(u.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.JL.dismissFloatie());this.C5a(this.CTg,this.j2j);b||u.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(b)return this.l6.value.ntl(h,b,this.pn),32;h=new Map;h.set("Source",this.oJa);h=Object.assign(new Bb.a,{additionalValues:h});
va.Health.instance.recordKpiFailure(this.CTg,"Unable to edit bookmark",!1,!0,h);return 8}return 2}AYc(b,h){b&&b.UILocation&&u.ULS.sendTraceTag(540386525,3029,50,h,b.UILocation)}Oie(b,h,v,D,P){if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksFloatie",!1)){1===v&&32;this.C5a(this.xgh,this.ykk);if(h.contextId===sc.a.Tc)return b=Array(1),b.push("Bookmarks"),this.JL.showFloatie(P.location,b,1),32;P=new Map;P.set("Source",this.kYj);P=Object.assign(new Bb.a,
{additionalValues:P});va.Health.instance.recordKpiFailure(this.xgh,"Unable to show bookmark floatie",!1,!0,P);return 8}return 2}x1d(b,h,v,D,P){let ca;return 1===v?(ns.a.instance.ie(()=>{ca=this.ga.Mf(h,Gb.a.insertHyperlink,v,!0,D,P);32!==ca&&(ca=this.ga.Mf(h,Nc.a.NNa,v,!0,D,P))},"BA:LFE"),ca):8}KVd(b,h,v){var D;if(1===v)return 32;if(b=this.hb.gb.kb){b=b.Oa.node;if(h=this.UYh(b))return h.click(),32;u.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.pn.tPd(b,
0)){b=this.eS.keb.get(null===(D=b.id)||void 0===D?void 0:D.toString());D=Wk.PageNavigator.instance.LO(this.ix).Kc.Db(b);if(D=this.UYh(D))return D.click(),32;u.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else u.ULS.sendTraceTag(539523267,3029,50,"No bookmark found enclosing the content.")}return 2}UYh(b){let h;b=this.Kn.Gl(b).Fj(this.fd.Bd.fc);b.Pjb&&(b=b.htmlElement.querySelectorAll("div."+at.tue),0<b.length&&(h=b[0]));return h}O3c(b){const h=
nH.b(b);if(h){var v=this.Ic.Oc(2);try{for(v.Cb(b);h.moveNext();){if(!fe.ParagraphReader.sh(h.iterator))continue;const D=h.currentNode;this.fsl(D)&&this.C6.P$b(D,!0)}}finally{v&&v.dispose()}}}fsl(b){for(let v=0;v<b.pa.length;v++){const D=b.pa.J(v);if(null!=D.Dh)for(let P=0;P<D.Dh.length;P++){var h=D.Dh.J(P);if(null!=h&&(h=b.Kc.Db(h.jn).ia(Bc.a.ut,""),!G.a.jf(h)&&!h.startsWith(this.r2)))return!0}}}POa(){var b=this.pn.YNd(!1);const h=[];for(let v=0;v<b.count;v++){const D=b.J(v).ia(Bc.a.ut,"");this.OXj.test(D)&&
h.push(D)}return 0<h.length?(h.sort((v,D)=>v.localeCompare(D,void 0,{numeric:!0})),b=parseInt(h[h.length-1].substring(this.Ute.length)),this.Ute+(b+1)):this.Ute+1}C5a(b,h){const v=new Map;v.set("Source",this.oJa);v.set("Action",h);va.Health.instance.recordKpiUsage(b,0,this.bWa,v)}R2d(b){this.$Bf()&&this.Jp&&this.Jp.execute(h=>{h.logActivity(b,null)})}$Bf(){w.AFrameworkApplication.ue("bookmarks-core-ex;bookmarks-core-ex-cf");return w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",
!1)}}Object(n.a)(TJ,"BookmarkActor",null,[]);class UJ{constructor(b,h,v){this.pc=b;this.tnl=h;this.Sf=v;this.N8e=this.N8e.bind(this)}Tb(){this.pc.qa(Nc.a.RIf,sc.a.view,this.N8e)}N8e(b,h,v,D,P){return 1===v?32:(b=this.Sf.v8(h.gk))?(P=3===P.Kx,this.tnl.value.cLh(this.x$l(b),this.ljm(b),P),32):2}x$l(b){const h=new Md.DictionaryPropertySet;h.setValue(Pd.a.UE,this.Sf.Zg(b));h.setValue(Pd.a.hG,this.Sf.Iga(b));h.setValue(Pd.a.sma,this.Sf.yhb(b));h.setValue(Pd.a.separator,this.Sf.qSd(b));return h}ljm(b){const h=
new Md.DictionaryPropertySet;h.setValue(Bc.a.marginLeft,this.Sf.nJ(b));h.setValue(Bc.a.marginRight,this.Sf.$K(b));h.setValue(Bc.a.Ao,this.Sf.At(b));return h}}Object(n.a)(UJ,"ColumnsDialogActor",null,[]);class VJ{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub){this.Wo=b;this.rea=h;this.Ce=v;this.lr=D;this.$l=P;this.Kd=ca;this.Ic=ta;this.we=Ra;this.ga=mb;this.S8j=Jb;this.T_j=Ub}get MCf(){return this.S8j}Tb(){this.ga.eb(Gb.a.G8c,sc.a.view,this.dCm.bind(this),96);this.ga.eb(Gb.a.w4c,sc.a.view,this.w4c.bind(this),
4);this.ga.eb(Gb.a.XAd,sc.a.view,this.XAd.bind(this),1028)}XAd(b,h,v,D,P){if(!ui.a.k$e)return 8;b=P.FormattingActionId;P=P.FormattingActionData;if(!h.view||!h.view.te)return 2;h=h.view;if(!(b&&P&&h.lb&&h.lb.gb.kb))return 8;h=this.$l.l7h(h.lb.gb.kb.toArray());for(const ca of h){h=ca.ia(Bc.a.Tw,0);v=this.Wo.getById(h);if(!v)return u.ULS.sendTraceTag(509136987,368,10,"Content control not found by id '"+h+"'."),8;if(!this.T_j.CVo(v,b,P))return u.ULS.sendTraceTag(509136986,368,10,"Content control with id '"+
h+"' failed to update formatting."),8}return 32}dCm(b,h,v,D,P){h=this.Wo.getById(P);if(!h)return 8;v=h.contentControlNode;if(!v)return 8;if(v.ia(Bc.a.K7,!1))return 2;D=this.Wo.BSl(h);if(!D)return 8;P=this.Ic.Oc(7);P.Cb(D.node);if(!this.MCf)return(b=h.placeholderText)||(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Kd.replaceTextRange(D,b),ui.a.r3a?this.$l.Gzb(h,!0):this.Gzb(h),v.setValue(Bc.a.K7,!0),P.dispose(),32;const ca=new Md.DictionaryPropertySet;ca.setValue(Wc.a.Hki,D);
var ta=v.ia(Bc.a.JNa,"");ta=this.rea.Pji(ta);if(!ta)return this.lr.replaceTextRange(D,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,ui.a.rr?b:void 0),ui.a.r3a?this.$l.Gzb(h,!0):this.Gzb(h),v.setValue(Bc.a.K7,!0),P.dispose(),32;ca.setValue(Wc.a.gwf,ta);if(1<ta.length&&!h.If)return P.dispose(),8;this.z8k(ca);v.setValue(Bc.a.K7,!0);P.dispose();return 32}w4c(b,h,v){b=h.view.te?h.view:null;if(!b||!b.lb)return 8;const [D,P]=this.Fcm(b.lb.gb);if(0===D.length)return 8;if(1===v){for(var ca of D){var ta=
P.get(ca.parentId);if(this.Tvi(ca,ta))return 32}return 8}if(2===v){v=this.NAo(D,P);ca=this.Ic.Oc(15);ca.Cb(b.Yc);for(ta of v)v=P.get(ta.parentId),this.Tvi(ta,v)&&this.Wo.YMb(ta.id);ca.dispose();return 32}return 2}Fcm(b){var h,v,D=[];for(const ca of b)D.push(...(null!==(h=this.$l.wna(ca.Oa,ca.Pc,1))&&void 0!==h?h:[]));if(0===D.length)return[D,new Map];h=[];for(const ca of b)h.push(...(null!==(v=this.$l.wna(ca.Oa,ca.Pc,3))&&void 0!==v?v:[]));b=new Map(D.map(ca=>[ca.id,ca]));if(0===h.length)return[D,
b];const P=new Map(h.map(ca=>[ca.id,ca]));D=D.filter(ca=>!P.has(ca.id));b=new Map([...b,...P]);return 0==D.length?[[h[0]],b]:[D,b]}Gzb(b){const h=this.lr.lPc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(h){if(b=this.we.NC(b.start.node).Di(Qp.a.AZf))this.Ce.Kfa(h.formatting),this.Ce.M6a(h.formatting,b)}else u.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}z8k(b){this.ga.Qb(Gb.a.showPlaceholderGlossary,2,b)}Tvi(b,h){return b.mha&&b.IRm&&(!h||h.isEditable)}NAo(b,
h){const v=(D,P)=>null==D||null==P||D.id===P.id?!1:D.id===P.parentId||v(h.get(D.parentId),P);return b.slice().sort((D,P)=>v(D,P)?1:v(P,D)?-1:0)}}Object(n.a)(VJ,"ContentControlActor",null,[]);class LF{constructor(b){this.ga=b;this.primaryButtonText="Count me in";this.secondaryButtonText="Cancel";this.IAk=["We are gauging interest in a feature that would let you","customize your ribbon in Word on the web. Click below","to vote or comment on this idea, as well as follow it","status updates. Thank you."];
this.nLo="Interested in this feature?"}Tb(){this.ga.qa(Nc.a.Ycf,sc.a.view,this.wFm.bind(this))}wFm(b,h,v){2===v&&(Object(Xe.c)(Nc.a.Ycf),b=new ug.StandardDialog,b.Ad=4,b.Ee(1,this.primaryButtonText),b.Ee(2,this.secondaryButtonText),b.KDc(this.IAk,null),b.Ou(this.nLo,null,0,this.pba));return 32}pba(b){1===b&&(Object(Xe.a)("CountMeIn_CustomizeRibbon",!0),G.a.uU(LF.OIj)&&Dd.a.om(LF.OIj))}}LF.OIj="https://feedbackportal.microsoft.com/feedback/idea/974fe330-6613-ed11-b83e-000d3a4d92e4";Object(n.a)(LF,
"CustomizeRibbonActor",null,[]);var FB=c(1071);class oH extends bg.a{constructor(b,h,v){super(!1,!1,!0);this.a5g=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,FB.a.T0e,FB.a.S0e,FB.a.U0e];this.bXj=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,FB.a.$Bk,FB.a.ZBk,FB.a.bCk];this.wLg=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.$jc=()=>{new oH(this.ga,this.DUe,this.Drc)};this.w0l=()=>{const D=
[];for(const P of this.DUe)D.push(this.D5(P));return D};this.e_o=D=>{const P=new Set;this.Yra="";for(const ca of D)if(""!==ca.position){const ta=this.Pci(ca.position);if(0>ta||22<ta){this.Yra=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(P.has(ta)){this.Yra=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.DLo(ca)),P.add(ta)}else{this.Yra=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.Yra&&(this._tabStops=
[],this.DUe=D)};this.Bhl=(D,P)=>{try{if(1===D){if(""!==this.Yra)throw Error.create(this.Yra);P.DefaultTabStop&&(this.Drc=FB.a.V8f(P.DefaultTabStop),this.v2o(this.Drc));if(32!==this.ga.Qb(Nc.a.TQb,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:Df.a.Kv(this.Drc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(ca){this.BHa(ca.message,this.$jc)}};this.ga=b;this.DUe=h;this._tabStops=[];this.Drc=v;this.Yra="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.ZDb()};
this.Wh(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.Bhl,b)}D5(b){return{["position"]:b.position,["alignment"]:b.alignment,["leader"]:b.leader}}Pci(b){return Math.floor(100*parseFloat(b))/100}DLo(b){return new Tt.a(Df.a.Kv(this.Pci(b.position)),FB.a.sfm(b.alignment),FB.a.qfm(b.leader),1)}v2o(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var h={};if(32===this.ga.Qb(Gb.a.SGa,2,h)){var v=h.marginLeft;const D=Ef.a.Ji(h.marginRight,0);v=Ef.a.Ji(v,0);
h=Ef.a.Ji(h.Ao,0);if(Ef.a.Zba(b,0,!1)>=h-D-v)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);}}ZDb(){return{["getInitState"]:this.w0l,["updateState"]:this.e_o,["validPositions"]:this.ghi(-Infinity,Infinity,"Position"),["validAlignments"]:this.H6h(this.wLg,this.wLg,null,"Alignment"),["validLeaders"]:this.H6h(this.a5g,this.a5g,this.bXj,"Leader"),["defaultTabStopSpinButtonProps"]:this.ghi(.01,22,"DefaultTabStops"),["defaultTabStopLength"]:this.Drc,["DefaultTabStop"]:"DefaultTabStop",
["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,
["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}ghi(b,h,v){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:v,["unitType"]:"Inch",["validUnits"]:[zC("Inch",3,b,h,.1)],["numberFormatInfo"]:UG()}}H6h(b,h,v,D){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",["label"]:D,["options"]:jG(b,h,v)}}}Object(n.a)(oH,"CustomTabDialog",
bg.a,[]);class WJ{constructor(b,h,v){this.gec=(D,P,ca,ta,Ra)=>{if(2!==ca)return 8;if(!Ra)return 16;D=Ra.tabStop;Ra=Ra.value;if(!D)return 16;Xe.c(Nc.a.gec);Ra=new Tt.a(Ra,D.Ada,D.$oa,D.Rhg);P=P.node;this.fAa.K5a(P,D);this.fAa.UWd(P,Ra);return 32};this.i7c=(D,P,ca,ta,Ra)=>{if(2===ca){if(!Ra)return 16;this.fAa.UWd(P.node,Ra);return 32}return 8};this.nMb=(D,P,ca,ta,Ra)=>{D=this.fAa.B7i(P.node);if(!("customTabs"in Ra))return Ra.customTabs=D,32;P=Ra.customTabs;if(!P||0>=P.length||!D||0>=D.length)return Ra.customTabs=
null,32;ca=[];for(const mb of P)for(const Jb of D)if(Jb.aIa===mb.aIa&&Jb.Rhg===mb.Rhg&&Jb.Ada===mb.Ada){ca.push(mb);break}Ra.customTabs=ca;return 32};this.K5a=(D,P,ca,ta,Ra)=>{if(2===ca){if(!Ra)return 16;Xe.c(Nc.a.K5a);this.fAa.K5a(P.node,Ra);return 32}return 8};this.ZMb=(D,P)=>{this.fAa.ZMb(P.node);return 32};this.TQb=(D,P,ca,ta,Ra)=>{if(2===ca){if(!Ra)return 16;D=Ra.tabStops;ca=Ra.defaultTabStopLength;P=P.node;ta=!1;const mb=this.fAa.r4n(P,D);Ra.defaultTabStopLengthSaved||(ta=this.uK.Dio(P,ca),
Ra.defaultTabStopLengthSaved=!0);mb&&Xe.d(Nc.a.TQb,!0,void 0,void 0,void 0,void 0,[Object.assign(new na.a,{name:"Custom Tab Stops Count",string:D.length.toString()})]);if(null==ta)return u.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;ta&&(this.Y4c&&this.Y4c.dui(),this.Ld.Ns(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),Xe.d(Nc.a.TQb,!0,void 0,void 0,void 0,void 0,[Object.assign(new na.a,{name:"Default Tab Stop Length",string:ca.toString()})]));
return 32}return 8};this.Yrj=(D,P,ca)=>{if(2!==ca)return 8;D={};if(32!==this.ga.Qb(Nc.a.vX,2,D))return u.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),16;P={};if(32!==this.ga.Qb(Gb.a.SGa,2,P))return u.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;D=FB.a.V8f(Df.a.Nz(D.defaultTabStop));ca={};ca.defaultTabStopLength=D;ca.sectionPropertiesData=P;if(32!==this.ga.Qb(Nc.a.zog,2,ca))return u.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),
16;if(!ca.isParagraphValid)return u.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),this.fAa.BHa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;P={};if(32!==this.ga.Qb(Nc.a.nMb,2,P))return u.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(P=P.customTabs)||(P=[]);P=FB.a.rfm(P);new oH(this.ga,P,D);Xe.c(Nc.a.$jc,!0);return 32};this.sQm=(D,P,ca,ta,Ra)=>{if(2!==ca)return 8;if(!Ra)return 16;if(Ra.isParagraphValid)return 32;
ca={};if(32!==this.ga.Mf(P,Gb.a.w5a,2,!1,null,ca))return 16;D=Ra.sectionPropertiesData;P=Ra.defaultTabStopLength;var mb=ca.Ft;ta=mb.joa;mb=1===mb.specialIndentType?mb.AB:mb.AB-mb.vda;const Jb=D.marginLeft,Ub=D.marginRight;ca.isRtl?(ca=Ef.a.Ji(Math.max(Ub,Ub+ta),0),ta=Ef.a.Ji(Math.max(Jb,Jb+mb),0)):(ca=Ef.a.Ji(Math.max(Jb,Jb+mb),0),ta=Ef.a.Ji(Math.max(Ub,Ub+ta),0));D=Ef.a.Ji(D.Ao,0);P=Ef.a.Zba(P,0,!1);Ra.isParagraphValid=P<D-ca-ta;return 32};this.ga=b;this.fAa=h;this.uK=v}get Ld(){return null!=this.EIg?
this.EIg:this.EIg=Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Y4c(){return null!=this.kGg?this.kGg:this.kGg=Ea.a.instance.Na("WordEditor.Actors.RenderParagraphsContainingTabs")}Tb(){const b=v=>fv.OutlineElementGeneralizer.tna(v.gb,!0),h=Xa.App.WTa.tIc(b,!0);this.ga.qa(Nc.a.nMb,sc.a.view,Xa.App.WTa.tIc(b,!1));this.ga.eb(Nc.a.nMb,sc.a.paragraph,this.nMb,96);this.ga.qa(Nc.a.K5a,sc.a.view,h);this.ga.eb(Nc.a.K5a,sc.a.paragraph,this.K5a,96);this.ga.qa(Nc.a.ZMb,sc.a.view,
h);this.ga.eb(Nc.a.ZMb,sc.a.paragraph,this.ZMb,96);this.ga.qa(Nc.a.i7c,sc.a.view,h);this.ga.eb(Nc.a.i7c,sc.a.paragraph,this.i7c,96);this.ga.qa(Nc.a.gec,sc.a.view,h);this.ga.eb(Nc.a.gec,sc.a.paragraph,this.gec,96);this.ga.qa(Nc.a.TQb,sc.a.view,h);this.ga.eb(Nc.a.TQb,sc.a.paragraph,this.TQb,96);this.ga.qa(Nc.a.zog,sc.a.view,h);this.ga.eb(Nc.a.zog,sc.a.paragraph,this.sQm,96);this.ga.qa(Nc.a.$jc,sc.a.view,this.Yrj);this.ga.qa(Nc.a.Nsi,sc.a.view,this.Yrj)}}Object(n.a)(WJ,"CustomTabActor",null,[]);var CM=
c(120),BG=c(616);class XJ{constructor(b,h,v,D,P,ca,ta,Ra,mb){this.ga=b;this.byd=v;this.tJa=(this.vZb=P)&&D;this.qn=ca;this.ZS=ta;this.O0j=Ra;this.ux=mb;this.aMg=h;this.aMg.getBooleanFeatureGate("Microsoft.Office.WordOnline.DoNotSetDarkModeStateInDarkModeActor",!1)?(this.jLf(!0),this.AKf(!0)):(this.vZb&&Rh.a("isSharedUXDarkModeOn")?(this.qn.aJ=appChrome.api.isSharedUXDarkModeOn(),this.jLf(!0)):this.qn.aJ=!1,this.tJa?this.AKf(!0):this.qn.MTa=!1);w.AFrameworkApplication.cI(()=>{this.uKb()});this.tJa&&
Rh.a("dispatch")&&appChrome.api.dispatch(this.Dxj([]))}Tb(){this.tJa&&(this.ga.qa(Nc.a.TLo,sc.a.view,this.Phl.bind(this)),this.ga.qa(Nc.a.e8c,sc.a.view,this.e8c.bind(this)),this.ga.eb(Nc.a.r3c,sc.a.view,this.r3c.bind(this),96));this.vZb&&(this.ga.qa(Nc.a.f8c,sc.a.view,this.f8c.bind(this)),this.ga.eb(Nc.a.Xbe,sc.a.view,this.Xbe.bind(this),96))}lFm(b){if(!this.vto(b))return!1;const h=Nh.a.instance.Oc(2);try{h.Cb(b.root);const v=he.GraphIterator.$a(b.root.graphNode),D=sq.a.fq(v);for(;D.moveNext();){const P=
Object(Na.a)(CM.a,D.currentNode);P&&P.tJ(b.fc,20,!0)}}finally{h&&h.dispose()}return!0}vto(b){return b&&b.root&&b.lv?b.Wi||b.UDf||b.Sxi||b.Oj:!1}k6n(){let b=!1;this.byd.forEach(h=>{this.lFm(h)&&(b=!0)});return b}ULo(){u.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.qn.aJ?"dark":"light");return this.qn.aJ?BG.a.SDc(1):BG.a.M$i(1)}Wjg(){const b=this.qn.Waa;u.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.k6n()||
(b?!BG.a.SDc(0):!BG.a.M$i(0)))return!1;this.O0j.dPn(b);return!0}Dxj(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.qn.aJ));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.Khi(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.qn.MTa?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):u.ULS.sendTraceTag(527283228,
3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(h){u.ULS.sendTraceTag(527282835,3023,10,h)}return b}Phl(){return this.Wjg()?32:8}f8c(b,h,v){if(1===v)return 32;b=this.ZS.Zf("UserAction","sharedUXDarkModeToggle");if(Rh.a("toggleSharedUXDarkMode"))u.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),Rh.a("isSharedUXDarkModeOn")?this.qn.aJ=appChrome.api.isSharedUXDarkModeOn():this.qn.aJ=!this.qn.aJ,u.ULS.sendTraceTag(529388308,
3023,50,"User in new ribbonMode: {0}",this.qn.aJ);else return 8;appChrome.getHeaderApi().then(D=>{D.hasOwnProperty("refreshThemeOverride")&&D.refreshThemeOverride()});this.ULo()||u.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.tJa&&!this.qn.MTa&&(this.Wjg()||u.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));h={};h.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");Xa.App.xa.WG(h);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",
!this.qn.aJ));this.tJa&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.qn.aJ));b.stop();u.ULS.sendTraceTag(555885377,3023,50,"{0}",b.si);Xe.b(this.qn.aJ?"DarkModeOn":"DarkModeOff");return 32}e8c(b,h,v){if(1===v)return 32;b=this.ZS.Zf("UserAction","sharedUXDarkModeSwitchBackground");u.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.qn.MTa=!this.qn.MTa;if(!this.Wjg())return 8;h={};h.DarkModeSwitchBackground=
this.ux?"ButtonModel":"ToggleButtonModel";Xa.App.xa.WG(h);b.stop();u.ULS.sendTraceTag(555885378,3023,50,"{0}",b.si);u.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.qn.MTa);Xe.b(this.qn.MTa?"DarkCanvasOff":"DarkCanvasOn");return 32}Xbe(b,h,v,D,P){if(1===v)return 32;if(!P)return 2;Rh.a("isSharedUXDarkModeOn")&&(this.qn.aJ=appChrome.api.isSharedUXDarkModeOn());P&&(P[If.a.On]=this.qn.aJ);return 32}r3c(b,h,v,D,P){if(1===v)return 32;if(!P)return 2;!this.ux&&P&&(P[If.a.On]=this.qn.MTa);
b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.qn.aJ));this.tJa&&this.Dxj(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.Khi(!1)));appChrome.api.dispatch(b);return 32}Khi(b){const h={};this.qn.MTa?b?h["default"]="MoonMonochromatic_16":(h["default"]="MoonMonochromatic_20",h.icon32="MoonMonochromatic_32"):b?h["default"]="SunMonochromatic_16":(h["default"]="SunMonochromatic_20",h.icon32="SunMonochromatic_32");return h}uKb(){this.vZb&&
this.jLf(!1);this.tJa&&this.AKf(!1)}jLf(b){var h;u.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",b,this.qn.aJ?"dark":"light",this.qn.yDa);b&&this.qn.aJ!=(null===(h=this.aMg)||void 0===h?void 0:h.$("DarkModeIsOn"))&&u.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",this.qn.aJ?"dark":"light",this.qn.yDa)}AKf(b){u.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",
b,this.qn.Waa?"dark":"light",this.qn.Ohl)}}Object(n.a)(XJ,"DarkModeActor",null,[]);var YJ=c(1596);class CG{constructor(){this.Height=this.Width=0}static construct(b,h){const v=new CG;v.Width=b;v.Height=h;return v}}Object(n.a)(CG,"ViewportInfo",null,[]);class pH extends Ps.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}fl(){return 85}static construct(b,
h,v,D,P,ca,ta,Ra,mb,Jb,Ub){const cc=new pH;cc.ContractVersion=b;cc.DocumentContent=h;cc.EnhancementId=v;cc.World=D;cc.ScalingFactor=P;cc.DesktopViewportInfo=CG.construct(ca,ta);cc.MobileViewportInfo=CG.construct(Ra,mb);cc.MinParagraphCount=Jb;cc.ContentCulture=Ub;return cc}}Object(n.a)(pH,"SwayPreviewRequest",Ps.a,[]);var DM=c(587);class FD{static get Yg(){return bg.a.vA(Xa.App.instance&&Xa.App.instance.D0d?FD.wnl:FD.Km,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,
WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,FD.zao,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}FD.zao=Ic.a.vg("progress.gif");FD.Km="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
FD.wnl="<div class='WACDialogRow digitalPrintDialogWrapper digitalPrintDialogWrapperResize UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper swayGalleryWrapperResize' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper swayPreviewWrapperResize' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(n.a)(FD,"DigitalPrintDialogHtml",null,[]);class Px{constructor(b,h,v,D){this.fontFamily=b;this.D5c=h;this.fontWeight=v;this.fontStyle=D}}Object(n.a)(Px,"FontInfo",null,[]);class bt{constructor(b,h,v,D){this.styleName=b;this.title=h;this.mLo=v;this.Rsm=D}}Object(n.a)(bt,"StyleVisualInfo",null,[]);class iE extends bg.a{constructor(b,h,v,D,P=!0){super();this.w6=this.Rq=this.Mka=this.B2=this.Ikd=this.cih=this.Zvd=this.uUe=this.vUe=this.NTe=this.SZb=this.mMa=this.R2=this.jZb=null;this.jXe=this.OPe=
!1;this.Cjd=null;this.Drl=()=>{this.shj(0)};this.Crl=(ca,ta)=>{this.shj(ta)};this.JYi=ca=>{this.Rai(ca)===Sys.UI.Key.enter&&(this.jWf(ca),ca.preventDefault(),ca.stopPropagation())};this.bVi=ca=>{((ca=ca.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===ca.id||ca.id===pl.a.Zdd)||aa.a.Gt)&&this.mMa&&this.rOb(this.mMa)};this.cVi=ca=>{const ta=this.Rai(ca);ta!==Sys.UI.Key.tab&&ta!==Sys.UI.Key.left&&ta!==Sys.UI.Key.right&&ta!==Sys.UI.Key.up&&ta!==Sys.UI.Key.down||this.Kpm(ta)||(ca.preventDefault(),
ca.stopPropagation(),this.xpn(ta))};this.iUf=()=>{this.jXe||(this.jXe=!0,u.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),Le.a.removeHandler(this.R2,Ed.a.scroll,this.iUf))};this.TUf=()=>{u.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.jWf=ca=>{ca.preventDefault();ca.stopPropagation();w.AFrameworkApplication.va.processAction(Gb.a.nSh,2);ca.target?(ca="button"===ca.target.tagName.toLowerCase()?ca.target:ca.target.parentNode)&&ca.id!==this.jZb&&(u.ULS.sendTraceTag(25231813,
382,50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.jZb,ca.id),this.BCh(ca),this.$Mh()):u.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.aol=ca=>{const ta=(new Date).getTime()-this.sSg;si.a.instance.qf(ni.a.dol,ta);ca?this.pfo():(u.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),w.AFrameworkApplication.va.processAction(Gb.a.mSh,2))};
this.nfo=()=>{this.Pyo();try{const ca=iE.STh.hAl(),ta=pH.construct(2,ca,this.jZb,"VerticalWorld",.3,1366,600,330,280,20,iE.STh.f$a.name);w.AFrameworkApplication.Ne.xj(String.format("{0}/we/GetSwayPreview.ashx?{1}",Xa.App.webServiceBase,w.AFrameworkApplication.rootQuerySignature),2,DM.b(ta),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.eIn,this.M3i,ta)}catch(ca){u.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",ca.message)}};
this.eIn=ca=>{var ta=null;({group:ta}=bi.a.q1(ca.data.ve)).returnValue?(ta=ta.Responses[0],ta.Succeeded?(this.q3d(ca.data,ni.a.LGo),this.Neb(),this.bnj(this.uUe,ta.PreviewHtml),this.bnj(this.Zvd,ta.PreviewHtmlMobile)):this.M3i(null)):u.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.M3i=()=>{this.Qyo();this.vUe.style.background="#E6E6E6";this.cih.style.background="#E6E6E6"};this.Yg=FD.Yg;this.wg="DigitalPrintDialog";u.ULS.sendTraceTag(26005578,
382,50,"Print to Web dialog has been opened and we initiated document force save");this.Pgk=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.pUb=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.Xlk=v;this.mtc=D;this.Ee(1,this.Pgk);this.Wh(this.pUb,this.aol,null);this.Lzm();this.oFo();this.sSg=(new Date).getTime();P&&cw.a.NQ(14,!1,this.Drl,this.Crl,null);this.WAm();this.lym();this.Y0m();this.gKf();this.P0m();this.$Mh()}get wva(){return this.Cjd}shj(b){if(!this.OPe){const h=
(new Date).getTime()-this.sSg;si.a.instance.qf(ni.a.bol,h);b?u.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",Ag.a[b])):u.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.DZa.disabled=!1}}Lzm(){this.SZb=document.getElementById("digitalPrintStatusMessageDiv");this.NTe=document.getElementById("digitalPrintStatusMessageIconDiv");this.vUe=document.getElementById("swayDesktopPreviewWrapperDiv");
this.uUe=document.getElementById("swayDesktopPreviewHtmlHolder");this.Zvd=document.getElementById("swayMobilePreviewHtmlHolder");this.cih=document.getElementById("swayMobilePreviewWrapperDiv");this.R2=document.getElementById("swayGallery");this.R2.setAttribute("tabindex","0");Le.a.addHandler(this.R2,Ed.a.scroll,this.iUf);this.R2.setAttribute(cf.a.qh,cf.a.mvh);this.B2=document.getElementById("digitalPrintLearnMoreLink");this.B2.href="https://go.microsoft.com/fwlink/?linkid=871972";Le.a.addHandler(this.B2,
Ed.a.click,this.TUf);this.Mka=new Fb.a;this.Ikd=document.getElementById("homeWrapper");this.h5("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.mtc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}WAm(){this.Rq=new Fb.a;this.Rq.add(new bt("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));
this.Rq.add(new bt("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.Rq.add(new bt("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.Rq.add(new bt("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));
this.Rq.add(new bt("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.Rq.add(new bt("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.Rq.add(new bt("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.Rq.add(new bt("CelestialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.Rq.add(new bt("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.Rq.add(new bt("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.Rq.add(new bt("Lucent",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.Rq.add(new bt("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.Rq.add(new bt("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.Rq.add(new bt("Muse",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.Rq.add(new bt("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.Rq.add(new bt("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.Rq.add(new bt("ConvergenceV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.Rq.add(new bt("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.Rq.add(new bt("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.Rq.add(new bt("Aurora",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.Rq.add(new bt("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.Rq.add(new bt("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}lym(){this.w6=
new Fb.a;this.w6.add(new Px("universc","universc","normal","normal"));this.w6.add(new Px("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));this.w6.add(new Px("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.w6.add(new Px("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.w6.add(new Px("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.w6.add(new Px("Posterama-Regular","Posterama-Regular",
"normal","normal"));this.w6.add(new Px("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.w6.add(new Px("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT","normal","normal"));this.w6.add(new Px("ArialNova","ArialNova","normal","normal"));this.w6.add(new Px("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.w6.add(new Px("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.w6.add(new Px("RockwellNova","RockwellNova","normal","normal"));
this.w6.add(new Px("SabonNRegLT","SabonNRegLT","normal","normal"));this.w6.add(new Px("DaytonaThin","DaytonaThin","100","normal"))}Y0m(){const b=document.createElement("style");b.setAttribute("type","text/css");let h="";for(const v of this.w6)h+=String.format(this.Xlk,v.fontFamily,v.D5c,v.fontWeight,v.fontStyle);b.innerText=h;this.Ikd.appendChild(b)}P0m(){const b=document.createElement("style");b.setAttribute("type","text/css");const h=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",
Ic.a.vg("SwayPreviewFrame.svg")),v=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}","swayPreviewFrameBackground",Ic.a.vg("SwayPreviewFrameHC.svg"));b.innerText=h+v;aa.a.Aq&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.Ikd.appendChild(b)}Rai(b){return b?b.keyCode:window.event.keyCode}hide(){this.T4f();super.hide()}T4f(){if(this.R2&&!this.OPe){for(let b=0;b<this.Mka.count;b++)Le.a.removeHandler(this.Mka.J(b),
Ed.a.click,this.jWf),Le.a.removeHandler(this.Mka.J(b),Ed.a.ai,this.JYi);Le.a.removeHandler(this.R2,Ed.a.ai,this.cVi);Le.a.removeHandler(this.R2,Ed.a.focus,this.bVi);Le.a.removeHandler(this.B2,Ed.a.click,this.TUf);this.jXe||Le.a.removeHandler(this.R2,Ed.a.scroll,this.iUf);this.OPe=!0}}gKf(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",Ic.a.NMk());this.Ikd.appendChild(b);for(const h of this.Rq)this.bHd(this.R2,h);this.W0(this.R2);
this.BCh(this.R2.firstChild);this.R2.firstChild.focus();Le.a.addHandler(this.R2,Ed.a.ai,this.cVi);Le.a.addHandler(this.R2,Ed.a.focus,this.bVi)}bHd(b,h){const v=document.createElement("button");v.className="swayGalleryItem swayClip136x90 swayImageBorderButton";v.setAttribute(cf.a.Xdb,cf.a.fM);v.setAttribute("title",h.title);v.setAttribute(cf.a.qh,cf.a.pvh);v.id=h.styleName;b.appendChild(v);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",h.styleName);
b.src=Ic.a.vg("swayPublish.png");b.setAttribute(cf.a.qh,cf.a.fz);b.setAttribute("unselectable","on");b.setAttribute(cf.a.mA,cf.a.lp);b.id=h.styleName+"img";v.appendChild(b);b=document.createElement("label");b.innerText=h.title;b.className=h.mLo;b.setAttribute(cf.a.mA,cf.a.lp);b.setAttribute("unselectable","on");b.setAttribute(cf.a.qh,cf.a.fz);v.appendChild(b);const D=document.createElement("label");D.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;D.className=h.Rsm;D.setAttribute(cf.a.mA,
cf.a.lp);b.setAttribute("unselectable","on");D.setAttribute(cf.a.qh,cf.a.fz);v.appendChild(D);Le.a.addHandler(v,Ed.a.click,this.jWf);Le.a.addHandler(v,Ed.a.ai,this.JYi);this.Mka.add(v)}xpn(b){const h=this.wva;this.fHl(b,h,!w.AFrameworkApplication.isRtl)||this.hHl(b,h,!w.AFrameworkApplication.isRtl)||this.cHl(b,h)||this.dHl(b,h)}Kpm(b){return b===Sys.UI.Key.tab?(this.wva&&this.wva!==this.mMa&&(this.wva.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.Cjd=this.mMa),!0):!1}fHl(b,
h,v){return b===Sys.UI.Key.right&&v||b===Sys.UI.Key.left&&!v?(b=(b=h.nextSibling)||this.R2.firstChild,this.rOb(b),!0):!1}hHl(b,h,v){return b===Sys.UI.Key.left&&v||b===Sys.UI.Key.right&&!v?(b=(b=h.previousSibling)||this.R2.lastChild,this.rOb(b),!0):!1}cHl(b,h){return b===Sys.UI.Key.down?(b=this.Mka.indexOf(h),h=b+2,h<this.Mka.count?(b=this.Mka.J(h))&&this.rOb(b):(h=b%2+1,h=2<=h?0:h,(b=this.Mka.J(h))&&this.rOb(b)),!0):!1}dHl(b,h){b===Sys.UI.Key.up&&(b=this.Mka.indexOf(h),h=b-2,0<=h?(b=this.Mka.J(h))&&
this.rOb(b):(h=b?20+b-1:this.Mka.count-1,(b=this.Mka.J(h))&&this.rOb(b)))}rOb(b){this.wva&&this.wva.id!==this.mMa.id&&(this.wva.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.Cjd=b;this.wva.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.wva.focus()}oFo(){this.DZa.className="WACDialogButtonNormal swayPrintToWebButton";this.DZa.setAttribute("tabindex","0");this.Rz.className="WACDialogButtonNormal swayCancelButton";
this.Rz.setAttribute("tabindex","0");this.DZa.disabled=!0}BCh(b){this.wva&&(this.wva.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.mMa&&(this.mMa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.mMa.setAttribute(cf.a.Xdb,cf.a.fM));this.jZb=b.id;this.mMa=b;this.mMa.setAttribute(cf.a.Xdb,cf.a.lp);this.Cjd=b;this.wva.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}$Mh(){Qg.a.instance.Vb(new qf.a(2,
1,50,this.nfo))}bnj(b,h){b.innerHTML=h}pfo(){u.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.jZb));w.AFrameworkApplication.va.processAction(Gb.a.oSh,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",Xa.App.webServiceBase,w.AFrameworkApplication.rootQuerySignature,w.AFrameworkApplication.userSessionId,this.jZb);Dd.a.openWindow(4,b)}q3d(b,h){si.a.instance.qf(h,+b.nT-+b.KH)}Qyo(){var b=
WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;this.Neb();this.SZb.innerText=b;this.SZb.style.display="block"}Pyo(){this.Neb();this.NTe.style.display="block";this.SZb.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.SZb.style.display="block"}Neb(){this.vUe.style.background="";this.Zvd.style.background="";ic.a.f_(this.uUe);ic.a.f_(this.Zvd);this.SZb.style.display="none";this.NTe.style.display="none"}static get STh(){return null!=iE.lyg?iE.lyg:iE.lyg=
Ea.a.instance.Na("Box4.DocumentContentExtractor.IDocumentContentExtractor")}}Object(n.a)(iE,"DigitalPrintDialog",bg.a,[]);class qH{constructor(b,h){this._context=this.Dk=null;this.Ave=0;this.Cfd=!1;this.Xgh=null;this.digitalPrint=(v,D,P,ca,ta)=>{if(1===P)return w.AFrameworkApplication.LG?8:32;this.Xgh=ta.SourceControlId;if(w.AFrameworkApplication.K.$("IsAnonymousUser"))return u.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),
this.bpb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=D;if(qH.POm())return u.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.Iaf(),32;switch(this.Ave){case 1:u.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.Iaf();break;case 2:u.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");
this.bpb(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.Cfd=!1,this.Dk=(new ci.a).create(),this.Dk.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.Dk.tL(CommonUIStrings.l_DefaultDialogTitle,this.vXk,null),w.AFrameworkApplication.Ne.xj(String.format("{0}/we/CheckSwayLicense.ashx?{1}",Xa.App.webServiceBase,w.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.xXk,this.wXk,null)}return 32};this.vXk=()=>{this.Cfd=!0;u.ULS.sendTraceTag(34373831,
382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};this.xXk=v=>{if(!this.Cfd){this.Dk.close();var D=null;this.q3d(v.data,ni.a.KGo);({group:D}=bi.a.q1(v.data.ve)).returnValue?(v=D.Responses[0],u.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",v.HasLicense,v.Succeeded),v.Succeeded?(this.Ave=v.HasLicense?1:2,2===this.Ave?this.bpb(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):
this.Iaf()):this.bpb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):(u.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.bpb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.wXk=v=>{this.Cfd||(this.Dk.close(),u.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.q3d(v.data,ni.a.JGo),this.bpb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};
this.ga=b;this.l6=h}Tb(){w.AFrameworkApplication.protectFile?u.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):w.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&w.AFrameworkApplication.K.$("DisablePrint")?u.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.eb(Gb.a.digitalPrintToSway,sc.a.view,this.digitalPrint,4),this.ga.eb(Gb.a.nSh,sc.a.view,Oc.ActionManager.IQ,4),this.ga.eb(Gb.a.oSh,
sc.a.view,Oc.ActionManager.IQ,4),this.ga.eb(Gb.a.mSh,sc.a.view,Oc.ActionManager.IQ,4),this.ga.eb(Wa.a.ZId,sc.a.view,Oc.ActionManager.IQ,4))}Iaf(){u.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.Xgh);new iE(this._context,this.ga,w.AFrameworkApplication.K.jb("SwayFontDownloadUrlTemplate"),w.AFrameworkApplication.K.jb("FileSource"))}bpb(b){const h=new ug.StandardDialog;h.Ad=0;h.eja(CommonUIStrings.l_DefaultDialogTitle,
b,null)}q3d(b,h){si.a.instance.qf(h,+b.nT-+b.KH)}static POm(){return"OneDriveWOPI"===w.AFrameworkApplication.K.jb("FileSource")}}Object(n.a)(qH,"DigitalPrintActor",null,[]);class ZJ{constructor(){this.Qjh=null}gLi(){u.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}yDj(b){if(!b)return u.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.VDi(b.errorDetails))return!1;this.Qjh=Object(Na.a)(pg.a,b.errorDetails).typeId;return!0}tie(b){return this.VDi(b)?
Object(Na.a)(pg.a,b).typeId===this.Qjh:!1}VDi(b){if(!b)return u.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;b=Object(Na.a)(pg.a,b);return b?b.token&&b.typeId?!0:(u.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(u.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(n.a)(ZJ,"DoNotCheckThisCritiqueTypeStrategy",null,[369]);class $J extends bg.a{constructor(b,h,v){super(!1,!1,!0);this.pc=b;this.jna=v;this.Y1j="DocumentChoiceGroup";this.STg="EmbededContent";
this.pZg="HyperLink";this.xIe=v.U9a;b={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.ZDb()};this.BYj=this.Lzl.bind(this);this.Ee(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.Wh(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.BYj,b)}ZDb(){const b=Array(2);b[0]={["key"]:this.STg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.pZg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};
const h={};h.documentChoiceGroupProps={["id"]:this.Y1j,["defaultSelectedKey"]:this.xIe?this.STg:this.pZg,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};h.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;h.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;h.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;
return h}Lzl(b,h){1===b?(this.xIe!==h.isExternalContentSelected&&(b=h.isExternalContentSelected?Nc.a.wOa:Nc.a.Ggb,this.pc.processAction(b,2),this.xIe=h.isExternalContentSelected,fa.a.sendTelemetryEvent(Object.assign(new oa.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new na.a,{name:"ActionId",int64:b})]}))),this.jna.abo(h.isExternalContentSelected)):0===b&&u.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}
Object(n.a)($J,"ExternalContentDefaultSettingsDialog",bg.a,[]);class ct{constructor(b,h,v,D,P){this.JL=Ea.a.instance.resolve("Common.IReactContextualUILauncher");this.Qrb=If.a.On;this.bkc=()=>{const ca=Array(1);ca.push("ExternalContent");var ta=Ea.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").bPa();ta=Object.assign(new XD.a,{x:ta.x,y:ta.y});this.JL.showFloatie(ta,ca,1);return 32};this.iGb=()=>{this.JL.$_&&this.JL.dismissFloatie();return 32};this.G5i=(ca,ta,Ra,mb,Jb)=>
{if(ta="object"===typeof Jb?Jb:null)ca===Nc.a.K1f?(ca=ct.JWa!==Nc.a.wOa&&ct.JWa!==Nc.a.Ggb,ta[this.Qrb]=ct.JWa===Nc.a.wOa||ca):ca===Nc.a.L1f&&(ta[this.Qrb]=ct.JWa===Nc.a.Ggb);return 32};this.LYh=(ca,ta,Ra)=>{1!==Ra&&(ca===Nc.a.Ggb&&ct.JWa!==Nc.a.Ggb?(u.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.Im.undo()&&(ta=new Gh.a(1,w.AFrameworkApplication.isRtl),ta.E1c="ExternalContent",ct.Fgb.K3c(ta))):ca===Nc.a.wOa&&ct.JWa!==Nc.a.wOa&&(u.ULS.sendTraceTag(575813833,
324,50,"ExternalContentPasteEmbededWebContentOption clicked"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.KUg.l7i()),ct.JWa=ca);fa.a.sendTelemetryEvent(Object.assign(new oa.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new na.a,{name:"behavior",string:Ra.toString()}),Object.assign(new na.a,{name:"ActionId",int64:ca})]}));return 32};this.ga=b;this.Im=h;this.KUg=D;this.o8j=P;this.AYj=this.Mzl.bind(this);
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.KUg.i9i(()=>{this.reset()})}Tb(){this.ga.eb(Nc.a.K1f,sc.a.view,this.G5i,97);this.ga.eb(Nc.a.L1f,sc.a.view,this.G5i,97);this.ga.eb(Nc.a.KYh,sc.a.view,this.AYj,1028);this.ga.eb(Nc.a.wOa,sc.a.view,this.LYh,1028);this.ga.eb(Nc.a.Ggb,sc.a.view,this.LYh,1028);this.o8j||(this.ga.eb(Nc.a.bkc,sc.a.view,this.bkc,96),this.ga.eb(Nc.a.iGb,sc.a.view,this.iGb,96))}fxo(b){new $J(this.ga,b,ct.jna)}Mzl(b,h,v){1!==
v&&this.fxo(ct.JWa);return 32}static get Fgb(){return null!=ct.Eyg?ct.Eyg:ct.Eyg=Ea.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get jna(){ct.sAa||(ct.sAa=Ea.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return ct.sAa}reset(){ct.JWa=null!=ct.jna?ct.jna.U9a?Nc.a.wOa:Nc.a.Ggb:Nc.a.wOa}}ct.JWa=Nc.a.wOa;ct.sAa=null;Object(n.a)(ct,"ExternalContentActor",null,[]);class jE extends Uy{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac){super(b,h,v,D,P,ca,
ta,Ra,mb,Jb,Ub,cc);this.CTc=Ac;this.lLd=!1;this.K_g=null}e4c(){this.lLd||(super.e4c(),this.lLd=!0)}Kne(){this.lLd&&(super.Kne(),jE.dVh&&this.K_g&&jE.dVh.removeHandler(jh.a.Mta,this.K_g),this.lLd=!1)}UQb(){if(this.CTc){this.yua.$_&&this.yua.dismissFloatie();const b=new Gh.a(0,w.AFrameworkApplication.isRtl);b.location=this.c5a.bPa();this.showFloatie(null,b)}else this.yua.$_&&w.AFrameworkApplication.va.processAction(Nc.a.iGb,2),w.AFrameworkApplication.va.processAction(Nc.a.bkc,2);this.jcc=!1}dismissFloatie(b){!this.jGe&&
(b&&(this.c5a.jBf(),this.xEj()),this.yua.$_||this.YKa)&&(this.YKa=!b,this.Kne(),this.CTc?this.yua.dismissFloatie():w.AFrameworkApplication.va.processAction(Nc.a.iGb,2))}showFloatie(b,h){h||(h=new Gh.a(0,w.AFrameworkApplication.isRtl));h.location||(h.location=this.c5a.bPa());if(!h.location)return!1;this.YKa&&(this.YKa=!1,this.e4c());this.CTc?(b=Array(1),b.push("ExternalContent"),this.yua.showFloatie(this.c5a.bPa(),b,1)):w.AFrameworkApplication.va.processAction(Nc.a.bkc,2);return!0}mJc(){if(!this.jcc){const b=
new qf.a(3,1,this.lPh,()=>{this.UQb()},196);Qg.a.instance.Vb(b);this.jcc=!0}}Gia(){this.CTc?this.yua.$_&&this.yua.dismissFloatie():w.AFrameworkApplication.va.processAction(Nc.a.iGb,2);this.mJc()}VNb(){this.CTc?this.yua.$_&&this.yua.dismissFloatie():w.AFrameworkApplication.va.processAction(Nc.a.iGb,2);this.mJc()}static get dVh(){return null!=jE.qyg?jE.qyg:jE.qyg=Ea.a.instance.resolve("Box4.IEditStateEventManager")}}Object(n.a)(jE,"ExternalContentFloatieEventManager",Uy,[]);class kE extends Gr{constructor(b,
h,v,D,P){super(b,h,v,D,P)}tAh(){if(!this.hb||!this.hb.gb||!this.hb.gb.kb)return u.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var b=this.hb.gb.kb.Oa,h=!b.cpBegin&&!b.cpEnd;let v=b.node;if(v&&h&&!v.vJ){do v=this.Kei(v);while(v&&!v.vJ&&Object(rb.a)(Po.AParagraphNode,v)&&!v.characterData.trim().length)}let D="";const P=Object(Na.a)(Po.AParagraphNode,v);P&&(D=P.characterData.length===b.cpBegin||h?P.characterData.trimEnd():P.characterData.substring(0,
b.cpBegin).trimEnd());h=P?D.length:b.cpBegin;b=Object.assign(new fx,{Nxa:Object(Na.a)(137,(P?Object(Na.a)(137,P):Object(Na.a)(137,v))||b.node),cgc:h});return this.sqf(b)}M$h(b,h){let v=null;const D=Object(Na.a)(177,b.Nxa.Fj(h.fc));if(!D)return null;if(Object(rb.a)(Po.AParagraphNode,b.Nxa)){const P=Object(Na.a)(Po.AParagraphNode,b.Nxa);if(P.yQ){if(b=Object(Na.a)(Ak.a,fe.ParagraphReader.dPa(P)))(b=Object(Na.a)(177,b.Fj(h.fc)))&&(v=b.getBounds()),v&&(v.height+=kE.U0h,v.width-=kE.yGl);return v}h=Object(Na.a)(86,
D);if(!h)return null;try{if(v=this.ota.b_(b.cgc,h,0<b.cgc,!1,!1,!1))v.height+=kE.U0h}catch(ca){u.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",ca),v=null}}v||(v=D.getBounds());return v}}kE.U0h=65;kE.yGl=100;Object(n.a)(kE,"ExternalContentFloatiePositionProvider",Gr,[]);class aK{constructor(b,h,v,D,P,ca){this.m7f=(ta,Ra,mb)=>{if(1===mb)return w.AFrameworkApplication.protectFile||w.AFrameworkApplication.LG||w.AFrameworkApplication.Coa||bc.SessionStatusManager.instance.Gj?
8:32;if(ta===Gb.a.print)ta=1;else if(ta===Nc.a.vKc)ta=0;else if(ta===Nc.a.LJd)ta=2;else return 8;return this.Lao(ta)};this.ga=b;this.l6=h;this.gVb=v;this.G1j=D;this.GSg=P;this.QYj=ca;this.DI=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback")}Tb(){w.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&this.G1j||w.AFrameworkApplication.LG?(document.body.classList.add("WACStopPrinting"),""!==this.GSg&&this.QYj.Gxo(this.GSg)):(this.ga.qa(Gb.a.print,sc.a.application,this.m7f),this.ga.qa(Nc.a.vKc,sc.a.application,
this.m7f),this.ga.qa(Nc.a.LJd,sc.a.application,this.m7f))}Lao(b){const h=w.AFrameworkApplication.rootQuerySignature;if(!h||""===h||Xa.App.rd&&Xa.App.rd.bC.zo)return 8;this.gVb.gYd=!1;this.gVb.TKj.start();cw.a.NQ(5,!0,Object(z.a)(this.gVb,this.gVb.Q5n,"requestFileDownload"),Object(z.a)(this.gVb,this.gVb.IKb,"onForceSaveFailed"),b);this.Pqe();return 32}Pqe(){w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.DI&&(u.ULS.sendTraceTag(509145741,
306,50,"DownloadCopyIntercept logged for: DownloadAsPDF"),this.DI.execute(b=>b.logActivity("DownloadCopyIntercept",null)))}}Object(n.a)(aK,"FileDownloadActor",null,[]);class bK extends Jh{constructor(b,h=null){super(b,!0,h,!1)}get Nyf(){return null}get q4a(){return w.AFrameworkApplication.P_a?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get ddc(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get gAd(){return null}}
Object(n.a)(bK,"DownloadAsPdfDialog",Jh,[]);class mw{constructor(){this._url=this.sv=null;this.XXa=this.WXa=0;this.ndb=!1;this.makeRequest=()=>{w.AFrameworkApplication.Ne.xj(this._url,1,null,null,!0,2,this.VKb,this.vpa,null)};this.VKb=b=>{mw.v5c();const h=b.data.Hia;let v=null;if(h)try{v=h.selectSingleNode("/docdata/status")}catch(D){}v&&("InProgress"===v.text&&22>this.WXa++||"ServiceBusy"===v.text&&3>this.XXa++)?this.nHa(1E3*(this.WXa+this.XXa)):this.sv(!0,v?v.text:null,b.data)};this.vpa=b=>{this.ndb?
(mw.rBa||(mw.bbb=new Date,mw.rBa=!0,mw.QS=1),18E4>(new Date).getTime()-mw.bbb.getTime()?this.retryOnFailure(4<=mw.QS?2E4:1E3):this.J1a(b.data)):4>mw.QS?this.retryOnFailure(2E3):this.J1a(b.data)}}send(b,h,v){this._url=b;this.sv=h;this.ndb=v;this.makeRequest(null)}nHa(b){b=new qf.a(2,1,b,this.makeRequest);w.AFrameworkApplication.nc.Vb(b)}retryOnFailure(b){this.nHa(b);mw.QS++}J1a(b){this.sv(!1,null,b)}static sba(b,h){(new mw).send(b,h,!1)}static v5c(){mw.rBa=!1;mw.QS=0}}mw.bbb=null;mw.rBa=!1;mw.QS=0;
Object(n.a)(mw,"ClientRequestWithRetry",null,[]);class cK extends We{constructor(b){super(b,void 0,w.AFrameworkApplication.P_a)}get q4a(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}get ddc(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get XXc(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get WIc(){return w.AFrameworkApplication.P_a?"UIFontDialogTextLarge":null}DKf(){u.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}EKf(){u.ULS.sendTraceTag(7628379,
324,50,"ODT download dialog link clicked")}rYc(){u.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get DXc(){return xC.ESi}get Ukb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get OOi(){return!w.AFrameworkApplication.P_a}}Object(n.a)(cK,"DownloadAsOdtDialog",We,[]);class dK{constructor(b,h){this.S$a=this.OYa=null;this.Y6a=v=>{1===Xa.App.xa.state||this.OYa||(this.OYa=(new ci.a).create(),v=v.customData,this.v2m(v),1===v?this.OYa.message=this.Ssb.GQ.isEnabled?
w.AFrameworkApplication.P_a?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:v?2===v&&(this.OYa.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait):this.OYa.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait,this.OYa.tL(CommonUIStrings.l_DefaultDialogTitle,this.cancelButton,null))};this.cancelButton=()=>{this.gYd=!0};this.y0=(v,D,P)=>{this.Jgg("Success. Save and Conversion Complete.");P=new eb.QueryStringBuilder(P.request.get_url());
w.AFrameworkApplication.nfa(P);P=P.toString();const ca=this.d6n(P);this.Tma(ca);2!==ca&&this.Ssb.OIn();!v||D?this.p5(ca):this.gYd?(this.gYd=!1,this.S$a=null):(this.S$a&&w.AFrameworkApplication.nc.Xe(this.S$a),this.S$a=null,this.Jpl(P,ca))};this.gYd=!1;this.Ssb=b;this.TKj=h.hRa("UserAction","WordEditorForceSaveAndPrint")}Tma(b){this.OYa&&(this.G2m(b),this.OYa.close(),this.OYa=null)}p5(b){if(1!==Xa.App.xa.state){this.I3m(b);const h=new ug.StandardDialog;h.Ad=0;h.Ee(1,CommonUIStrings.l_DialogClose);
h.nx(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}Htf(b){switch(b){case 0:return"downloadpdf";case 1:return"printpdf";case 2:return"odt";default:return u.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),"printpdf"}}Q5n(b){var h=w.AFrameworkApplication.rootQuerySignature;h&&""!==h?(h="WordViewer/request."+this.Cjf(b)+"?"+h+"&type="+this.Htf(b)+"&rndm="+ub.a.create(),1===b&&this.Ssb.$vo()&&(h+="&useNamedAction=1"),
w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("CustomFontReadModePDFIsEnabled")&&cq.FontUtils.jie()&&(1===b||!b)&&(0<cq.FontUtils.WOh&&(h+="&cfcVer="+cq.FontUtils.WOh),cq.FontUtils.VOh&&(h+="&cfcUrl="+cq.FontUtils.VOh),cq.FontUtils.XOh&&(h+="&cfcEncData="+cq.FontUtils.XOh)),mw.sba(h,this.y0),this.S$a||(this.S$a=new qf.a(2,1,500,this.Y6a),this.S$a.customData=b,w.AFrameworkApplication.nc.Vb(this.S$a))):(this.Jgg("failed. QuerySignature is empty."),this.p5(b))}Cjf(b){return 2===b?"odt":"pdf"}IKb(){this.Jgg("Failed. force save failed.")}d6n(b){if(0<
b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;u.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",b);return 1}Jgg(b){u.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",b);this.TKj.stop()}Jpl(b,h){const v=new Fb.a;v.add("access_token");v.add("access_token_ttl");1!==Xa.App.xa.state&&(1===h?this.Ssb.ryo(b,v):h?2===h&&new cK(b):new bK(b))}dispose(){}v2m(b){switch(b){case 0:u.ULS.sendTraceTag(38114782,
203,50,"Download Attempt: Pdf");break;case 2:u.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:u.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;default:u.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}G2m(b){switch(b){case 0:u.ULS.sendTraceTag(38114786,203,50,"Download Cancelled: Pdf");break;case 2:u.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:u.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");
break;default:u.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}I3m(b){switch(b){case 0:u.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;case 2:u.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:u.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;default:u.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}}Object(n.a)(dK,"FileDownloadManager",null,[]);class lE{get key(){return"LIST"}get Uw(){return Box4Intl.Box4Strings.l_ListContentTitle}tmc(b){let h=
null;const v=lE.Gd.qw(b);if(!v)return{returnValue:!1,yma:h};b=this.s2l(b,v);h=Object.assign(new dx.a,{MG:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,yma:h}}nEb(b,h){b=b.contentObject;const v=this.c1l(b.Mx),D=new sf.a;h?(h=h.contentObject,h.level!==b.level?(D.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),D.add(v)):h.id.equals(b.id)&&h.Mx.listType===b.Mx.listType||D.add(v)):(D.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),D.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
b.level)),D.add(v));return D.toArray().join(" ")}c1l(b){let h="";const v=b.listStyle;if(!b.listType)h=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.Ku);else if(1===b.listType)switch(v){case 1:h=this.hzh;break;case 2:h=this.fQk;break;case 3:h=this.gQk;break;default:h=this.hzh}return h}static get Gd(){return null!=lE.dEg?lE.dEg:lE.dEg=Ea.a.instance.resolve("Box4.List.IListReader")}}Object(n.a)(lE,"ListDetailsProvider",null,[777,671]);class eK{constructor(){this.Mx=this.listId=
this.id=null;this.level=0}}Object(n.a)(eK,"ListItemInfo",null,[]);class fK extends lE{constructor(b){super();this.t6=b}get hzh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get fQk(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get gQk(){return WoncaIntl.WoncaStrings.L_BulletStyle3}s2l(b,h){const v=this.t6.wB(b);return Object.assign(new eK,{id:b.currentNode.id,listId:new W.a(ub.a.nil,v.listID),Mx:h,level:v.level+1})}}Object(n.a)(fK,"FlatListDetailsProvider",lE,[]);class gK{constructor(b,h){this.ga=
b;this.Hf=h}get uc(){return null!=this.XJg?this.XJg:this.XJg=Ea.a.instance.Na("Box4.Styles.IWACStyleReader")}Tb(){}}Object(n.a)(gK,"FormattingActor",null,[]);var EM=c(1160),SE=c(1324),FM=c(1710);class hK{constructor(b,h,v,D,P,ca,ta,Ra){this.Fb=b;this.vjk=h;this.Ic=v;this.aub=D;this.Do=P;this.Fa=ca;this.ld=ta;this.n9j=Ra}lfc(b,h,v,D,P,ca,ta){u.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ta.si});this.aub.then(()=>
{this.vjk(b.data.ve);u.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ta.si});ta.stop()})}vpa(b,h,v,D,P,ca,ta){ca.stop();P();ta?(this.qDn(h,v),u.ULS.sendTraceTag(574377989,3001,15,"{0}",{["message"]:b,["id"]:oe.ImageReader.gPa(h.Fb)})):u.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:oe.ImageReader.gPa(h.Fb)})}fth(b,h){b.ze(uG.a.D$e,"1");if(this.ld&&this.ld.isFeatureEnabled(49)){var v=
this.Do.Ym(h.gk);v=this.Do.Ui(v);b.ze(Pg.a.jt,SE.a[v]);5===v&&this.sEk(b,h)}this.n9j&&b.ze(Pg.a.pWd,"true")}Qmh(){return new FM.a(this.Fb.id,this.Fb)}bSd(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}qDn(b,h){const v=this.Ic.Oc(7,Gb.a.Vlm);v.Cb(h);b.Fb.setValue(Bc.a.rIh,!0);v.dispose()}sEk(b,h){var v=h.gk;h=this.Do.Ym(v);var D=v.node;const P=(v=this.Do.AEa(h,D.Kc,!1))?this.Do.sEa(v):"";if(""===P)throw u.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),
Error.argumentNull("OriginalObjectDataBlobId");D=(D=this.Do.AEa(h,D.Kc,!0))?this.Do.sEa(D):"";b.ze(Pg.a.Efc,P);b.ze(Pg.a.XKj,D);v=v.ia(Vi.a.PZh,"");""!==v&&b.ze(Pg.a.extension,v);b.ze(Pg.a.width,this.Do.fF(h).toString());b.ze(Pg.a.height,this.Do.yG(h).toString());b.ze(Pg.a.N1c,this.Do.dib(h).toString());v=this.Fa.$("WordEditorImageCropIsEnabled");b.ze(Pg.a.hOh,v.toString());v&&(v=this.Do.Hba(h),b.ze(Pg.a.top,v.top.toString()),b.ze(Pg.a.bottom,v.bottom.toString()),b.ze(Pg.a.left,v.left.toString()),
b.ze(Pg.a.right,v.right.toString()));v=this.Fa.$("WordEditorImageRotateIsEnabled");b.ze(Pg.a.egj,v.toString());v&&(b.ze(Pg.a.angle,this.Do.D_(h).toString()),b.ze(Pg.a.flipH,this.Do.I5(h,Bc.a.YQc,!1)?"true":"false"),b.ze(Pg.a.flipV,this.Do.I5(h,Bc.a.kRc,!1)?"true":"false"));b.ze(Pg.a.KVh,"true")}}Object(n.a)(hK,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[386]);class iK{constructor(){this.AKa=null}ZKk(b){this.AKa=b}teardown(){null!=this.AKa&&(this.AKa.teardown(),this.AKa=null);this.NOe=null}getGraphicData(){return this.AKa?
this.AKa.getGraphicData():null}HZn(){null!=this.NOe&&this.setGraphicData(this.NOe)}setGraphicData(b){this.NOe=b;if(this.AKa)try{this.AKa.setGraphicData(b)}catch(h){u.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",h.toString())}else u.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.AKa?this.AKa.hasEdits():!1}}Object(n.a)(iK,"GraphicsEditorGC2HostUser",
null,[388]);var GM=c(1711),HM=c(1077),IM=c(1375),JM=c(782),KM=c(1470),LM=c(1076);class jK{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=h=>b.loadScript(h);this.preloadScript=h=>{b.preloadScript(h)}}}Object(n.a)(jK,"GC2ScriptLoader",null,[]);class rH{constructor(b,h,v){this.awe=b;this._context=h;this.$La=v}closeEditor(){this.awe&&(this.awe(),this.awe=null)}logActivity(b,h,v,D){Xe.a(b,h,v,D)}logTrace(b,h,v,D){u.ULS.sendTraceTag(575522531,3001,rH.s9m(h),D)}isEnabled(b){const h=
w.AFrameworkApplication.K;switch(b){case "EqualSizingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",!1);case "SpaceFirstLastPara":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",!1);case "ModernFontPicker":return h.$("ModernFontPickerIsEnabled");
case "ShapeLocksSchema":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShapeLocks",!1);default:return h.getBooleanFeatureGate(`Microsoft.Office.WordOnline.GC2.${b}`,!1)}}getFontPickerFonts(b){const h=`${Ea.a.instance.resolve("Box4.IFontServiceParser").B0a}/${"hier_officeFontsPreview.ttf"}`;b("msofp_hier",h);b=cq.FontUtils.Umf(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(v=>"premium"!==v.fontType),mruList:b.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getHealth(){return va.Health.instance}getFonts(b){const h=
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),v=h?"msofp_hier":"msofp",D=`${Ea.a.instance.resolve("Box4.IFontServiceParser").B0a}/${h?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(v,D);cq.FontUtils.ynh();cq.FontUtils.$nh({});b=cq.FontUtils.Tmf(()=>!1,(P,ca)=>ca).MenuSectionList;h&&0<b.length&&(b.pop(),b.push(this.Y4k()));return b}Y4k(){const b=cq.FontUtils.Umf(()=>!1,()=>"").fonts.map((h,v)=>{const D=h.name;h=h.displayName;const P=
cq.FontUtils.Qoa(D);return Object.assign(new iw.a,{MenuItemId:cq.FontUtils.kij+v,CommandValueId:D,LabelText:h||D,Styles:{["optionText"]:{["fontFamily"]:h&&!P?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:D})});return Object.assign(new ih.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const h=this._context.gk;var v=oe.ImageReader.Ym(h);if(this.OMm(v,h,b)&&(v=oe.ImageReader.I5(v,Wc.a.zpa,""),v.length))return Promise.resolve(v);
v=new eb.QueryStringBuilder("/we/GetImage.ashx?");v.v0b(h.node.Vi().vr);v.ze(Pg.a.ZHd,b);w.AFrameworkApplication.nfa(v);v.ze(yh.a.Nqb,"1");Yi.a.instance.pzb(v);v.ze(Pg.a.jPh,"true");const D=v.toString();return new Promise((P,ca)=>{this.$La.xj(D,1,null,null,!1,2,ta=>{P(ta.data.ve)},ta=>{ca(ta.data.Qe.toString())},null)})}getPlaceholders(){const b={};b.PictureDownloading=Ic.a.vg("progress.gif");b.PictureInvalid=Ic.a.vg("CancelRequest.32x32x32.png");return b}getTheme(){const b=Wk.PageNavigator.instance.Ys(this._context.view.Yc).properties.ia(Bc.a.$le,
"");return 0===b.length?[]:b.split(" ").map(h=>Xa.App.TAb[h])}static s9m(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}OMm(b,h,v){const D=h.node.Kc;h=oe.ImageReader.hRd(b,D,!1);b=oe.ImageReader.hRd(b,D,!0);return v===h||v===b}}Object(n.a)(rH,"GraphicsEditorApp",null,[399]);class kK extends bg.a{constructor(b,h,v,D,P){super(!1,!1,!0);this.closeEditor=()=>{this.TIh();this.dispose()};this.pba=ca=>{this.TIh(2===ca)};this.iab=b;this.W5j=
h;this.HZg=v;this._context=D;this.$La=P}wxo(b){return new Promise((h,v)=>{this.Wh(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.pba,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(D,P)=>this.iMk(P,b),["onload"]:D=>{this.onLoad(D,h,v)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>{this.iab.HZn()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,
h,v){b?(this.iab.ZKk(b),h(b)):(u.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),v(null))}iMk(b,h){const v=w.AFrameworkApplication.K,D=LM.a();D.loadScriptWithRetryHandler=b;const P=new rH(this.closeEditor,this._context,this.$La),ca={["bootConfig"]:Object.assign(new IM.a,{scriptBaseUrl:LE.AppChromeOverrideUtilities.isEnabled?LE.AppChromeOverrideUtilities.SQd(w.AFrameworkApplication.lcid):w.AFrameworkApplication.w5+w.AFrameworkApplication.lcid+"/",isMLRRibbonMode:w.AFrameworkApplication.ta.Nb.Qjc,
isCombinedBundleEnabled:w.AFrameworkApplication.K.$("IsCombinedBundleEnabled")}),["scriptLoader"]:new jK(new HM.DynamicScriptLoader(D)),["publicPath"]:w.AFrameworkApplication.w5,["appSettings"]:v.appSettings,["logger"]:new di.a,["featureGateManager"]:Object.assign(new JM.a,{getBooleanFeatureGate:Object(z.a)(v,v.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(z.a)(v,v.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(z.a)(v,v.getStringFeatureGate,"getStringFeatureGate")}),
["app"]:P,["resolveScript"]:(ta,Ra)=>KM.a.resolveScript(ta,Ra),["initialTabId"]:h};v.$("DynamicBundlesIsEnabled")&&(h=w.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||w.AFrameworkApplication.K.$("IsCombinedBundleEnabled")?"":"exp/",ca.dynamicBundlesPath=LE.AppChromeOverrideUtilities.isEnabled?LE.AppChromeOverrideUtilities.vic+h:v.jb("StaticContentUrl")+h);return new Promise((ta,Ra)=>{b("gc2",w.AFrameworkApplication.Hz("gc2.js",5),"anonymous",5,!1).then(()=>{ta(ca)}).catch(()=>{u.ULS.sendTraceTag(572915794,
3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");Ra(null)})})}TIh(b){b=this.iab.hasEdits()&&!b;this.W5j(b?this.iab.getGraphicData():null,!!this.HZg,this.HZg,b)}}Object(n.a)(kK,"ReactGraphicsEditorDialog",bg.a,[]);class lK{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc,id=!1){this.c3h=id;this.aub=this._context=null;this.xxo=(vd,xe,Ld,Qd,Zd)=>{var te,Qf,Jg;const Ml=!!Zd&&Object(rb.a)(W.a,Zd);try{if(1===Ld){const qp=xe.view;return this.Uj.Jfa(xe)&&qp.features.Rke?32:8}this.I9j=
4===(null===Zd||void 0===Zd?void 0:Zd.InputMethod)?!0:!1;Xa.App.instance&&Xa.App.instance.CHb&&(this.c3h||EM.a.Bgb(()=>{this.c3h=!0}));u.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${Ml}`);performance.mark("LaunchStart");this._context=xe;const Fm=new kK(this.iab,this.uTf,Ml?Zd:null,xe,this.Xf);vd=null;if(Ml&&(null===(te=w.AFrameworkApplication.K)||void 0===te?0:te.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectDrawInDrawingCanvasForPictures",!1))){const qp=
null===(Jg=null===(Qf=xe.view.lb)||void 0===Qf?void 0:Qf.gb)||void 0===Jg?void 0:Jg.kb;if(null===qp||void 0===qp?0:qp.LH)vd="Draw"}this.aub=Fm.wxo(vd).then(()=>{u.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${Ml}`)}).catch(()=>{this.WSh()});if(!Ml){const qp=CB=>{this.aub.then(()=>{this.WXi(CB,!1)})};if(w.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===w.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return qp(JSON.stringify({elements:[]})),
32;let wv=null;wv=Wk.PageNavigator.instance.Ys(xe.view.Yc);const jD=wv.properties.ia(Bc.a.d3h,"");if(0<jD.length)return qp(jD),32;this.GCe.Meo(xe,W.a.create(),ub.a.create()).then(CB=>{const bE=this.Ic.Oc(0,Gb.a.zQc);bE.Cb(wv);wv.setValue(Bc.a.d3h,CB);bE.dispose();qp(CB);return null}).catch(CB=>{u.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",CB.toString(),Ml);this.WSh()})}return 32}catch(Fm){return u.ULS.sendTraceTag(42328736,3001,10,
"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",Fm.toString(),Ml),8}};this.Dnm=(vd,xe,Ld,Qd,Zd)=>{if(!xe.view.features.Rke)return 32;u.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.$Uh(Zd,xe);return 32};this.Cnm=(vd,xe,Ld,Qd,Zd)=>{var te,Qf,Jg;const Ml=xe.view;if(null===(te=w.AFrameworkApplication.K)||void 0===te?0:te.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))if(te=null===(Jg=null===(Qf=null===Ml||
void 0===Ml?void 0:Ml.lb)||void 0===Qf?void 0:Qf.gb)||void 0===Jg?void 0:Jg.kb,null===te||void 0===te||!te.M2a)return 8;return this.Ili(vd,xe,Ld,Qd,Zd)};this.Ili=(vd,xe,Ld)=>{if(1===Ld)return xe.view.features.Rke?32:8;if(2===Ld){vd=oe.ImageReader.Ym(xe.gk);if(!vd)return 2;u.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.$Uh(vd,xe);return 32}return 2};this.WXi=(vd,xe=!0)=>{this.iab.setGraphicData(vd);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart",
"LaunchEnd");vd=performance.getEntriesByName("EditorLaunch");u.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${xe} Duration: ${vd[vd.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");performance.clearMeasures("EditorLaunch")};this.uTf=(vd,xe,Ld,Qd)=>{var Zd;this.iab.teardown();if(xe&&this._context){var te=this._context.view.lb.tg,Qf=te.node;te.hl&&fe.ParagraphReader.Wb(Qf)&&(te=null===(Zd=this.Y6)||
void 0===Zd?void 0:Zd.BA(Qf),27==(null===te||void 0===te?void 0:te.role)&&u.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",Qd,Qd?" Everything deleted: "+(0==(null===vd||void 0===vd?void 0:vd.json.length)):""))}if(Qd)if(u.ULS.sendTraceTag(541714E3,3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(vd)if(Qd=vd.json,Zd=vd.width,Qf=vd.height,Qd.length||xe)if(!Qd.length&&xe)if(xe=this._context.gk){xe=xe.node;if(oe.ImageReader.G8(xe)){if(!this.Uj.$Zn(xe,
new he.GraphIterator,qi.a.instance,YJ.DeleteActor.h0b)){u.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.Uj.uhc(xe,Ld,this.fb,this.BV)){u.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}u.ULS.sendTraceTag(572363226,3001,50,"Graphic removed thru dialog.")}else u.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else te=new GM.a(this._context,w.AFrameworkApplication.ta.EPa,!0,this.Uj,
this.Fa,Wk.PageNavigator.instance),vd=ub.a.create(),Ld=new wJ.a(te,Qd,this.fK,this.Im,vd,Nh.a.instance,xe,Ld,this.Uj,this.Do,Zd,Qf,this.Fa,this.BV,this.ld,Xa.App.instance.CHb,Xa.App.instance.pzf),this.GCe.w$f(Ld,this._context,xe,vd),this.Wqa(),this.I9j&&this.yOo();else u.ULS.sendTraceTag(541714001,3001,50,"Empty Json on new content creation when close dialog");else u.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else u.ULS.sendTraceTag(590205069,3001,10,
"GraphicsEditorActor: context cannot be null")};this.ga=b;this.Fa=h;this.GCe=v;this.Uj=D;this.fK=P;this.Im=ca;this.iab=new iK;this.Ic=Ra;this.fb=mb;this.BV=Jb;this.Do=Ub;this.ld=Ac;this.Xf=cc;this.Y6=Lc}Tb(){var b;let h=!0;this.Fa.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(h=this.ld&&this.ld.isFeatureEnabled(49));h&&!aa.a.Gt&&(this.ga.eb(Nc.a.graphicsEditor,sc.a.view,this.xxo,4),this.ga.eb(Gb.a.Xgf,sc.a.view,this.Dnm,4),this.ga.eb(Nc.a.bVh,sc.a.view,this.Cnm,4),(null===(b=w.AFrameworkApplication.K)||
void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))&&this.ga.eb(Nc.a.y5b,sc.a.view,this.Ili,4))}WSh(){const b=new ug.StandardDialog;b.Ad=0;b.nx(lm.a.Mgf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,null);Xa.App.xa.updateCommandUI()}$Uh(b,h){var v=b.ia(Hh.a.b5,1);const D=b.ia(Vi.a.R_,0);v&&1!==D?b.ia(Bc.a.rIh,!1)?(h=new ug.StandardDialog,h.Ad=0,h.nx(lm.a.Mgf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,
WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),Xa.App.xa.updateCommandUI(),u.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties",["id"]:oe.ImageReader.gPa(b)})):(this.ga.Qb(Nc.a.graphicsEditor,2,b.id),this.aub||(u.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.aub=new Promise(P=>{P(null)})),v=ub.a.create(),b=new hK(b,this.WXi,Nh.a.instance,this.aub,this.Do,this.Fa,
this.ld,Xa.App.instance.h4(this.Do.Ui(b))),this.GCe.w$f(b,h,!0,v)):u.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}Wqa(){const b=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):u.ULS.sendTraceTag(572352085,3001,10,"ISystemInitiatedFeedback was null")}yOo(){const b=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordPenNsatSurvey",
"WordPenNsatSurveyIsEnabled")}):u.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(n.a)(lK,"GraphicsEditorActor",null,[]);var MM=c(513);class mK{constructor(b,h,v){this.bWa="wwaengidc";this.Ngd="CreateLinkForHeading";this.t0j="CreateLinkForHeadingAction";this.A2j="\ufffc";this.OVa=b;this.ga=h;this.fb=v}Tb(){this.ga.qa(Nc.a.AIc,sc.a.paragraph,this.Mbf.bind(this));this.ga.qa(Nc.a.AIc,sc.a.Hd,this.Mbf.bind(this));this.ga.qa(Nc.a.AIc,sc.a.Tc,this.Mbf.bind(this));this.ga.Vc(Nc.a.AIc,
1028)}Mbf(b,h,v){b=h.node;if(1===v)return this.gzi(b)?32:8;this.WSn(this.Ngd,this.t0j);if(!this.gzi(b))return u.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;v=b.getValue(Bc.a.Lc);if(!v)return u.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),v=new Map,v.set("Source",this.Ngd),v=Object.assign(new Bb.a,{additionalValues:v}),va.Health.instance.recordKpiFailure(this.Ngd,"Unable to create sharable link as paragraph id is missing",
!1,!0,v),8;this.ULh(v);return 32}ULh(b){b=String.format('{{"{0}":"{1}"}}',MM.a.heading,b);this.ga.Qb(Wa.a.k8,2,{["nav"]:btoa(b),["mode"]:"copy"},{["ControlId"]:"CopyLinkToHeading"})}gzi(b){return!this.fb.Wb(b)||this.fb.Pac(b)||this.fb.zHb(b)||b.xr||""===b.characterData||b.characterData===this.A2j||!this.OVa.ZPd(b)?!1:!0}WSn(b,h){const v=new Map;v.set("Source",this.Ngd);v.set("Action",h);va.Health.instance.recordKpiUsage(b,0,this.bWa,v)}}Object(n.a)(mK,"HeadingsActor",null,[]);class nK{Auo(b){return fe.ParagraphReader.vua(this.l$h(b))}n7c(b,
h,v){if(b=fe.ParagraphReader.dPa(this.l$h(b)))h=b.De(h),Object(rb.a)(371,h)&&(Sw.m(b)?h.Ooo(v):h.n7c())}l$h(b){return b&&b.hl&&b?b.node:null}}Object(n.a)(nK,"IFrameFocusStrategy",null,[372]);class oK{constructor(b){this.LBa=null;this.dld=b}gLi(){u.ULS.sendTraceTag(25007835,375,50,"Ignore all spelling error triggered")}yDj(b){if(!b)return u.ULS.sendTraceTag(25007836,375,15,"Error range is null"),!1;if(!b.errorDetails)return u.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return u.ULS.sendTraceTag(25007838,
375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.LBa=G.a.lme(b.errorDetails.token,b.errorDetails.lcid);this.dld.add(this.LBa,b.errorDetails.lcid);return!0}tie(b){return b?b.token?G.a.lme(b.token,b.lcid)===this.LBa:(u.ULS.sendTraceTag(25007840,375,15,"ErrorDetails Token is null"),!1):(u.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(n.a)(oK,"IgnoreAllProofingErrorStrategy",null,[369]);
var NM=c(1384),OM=c(564),pK=c(527);class qK{constructor(b,h){this.filename=b;this.blob=h}}Object(n.a)(qK,"UploadBlobParameters",null,[]);class rK extends oc{constructor(b,h,v,D,P,ca,ta,Ra=null){super(b,h,v,null,P,ca,!1);this.Q$j="DragAndDrop";this.mVg="FileName";this.pVg=0;this.vkh=null;this.Loe=this.a5b=!1;this.vTg=D;this.jbh=Ra}get aP(){return this.Q$j}get fileExtension(){return this.mVg}get fileSize(){return this.pVg}get MIj(){return this.vkh}R9c(b){const h=new qK(this.vTg.name,this.vTg);b.Xwj(h);
this.vkh=b.kdb}BOa(b,h){this.jbh&&this.jbh();super.BOa(b,h)}B2o(b){const h=!!b&&this.rza(b.name,null)&&this.xog(b,null);b&&(this.mVg=b.name,this.pVg=b.size);h||this.b3d();return h}}Object(n.a)(rK,"DragDropInsertImageUploader",oc,[]);class dt{constructor(b,h,v,D,P,ca,ta){this.hSc=ca;this.MR=ta;this.m4d=this.n4d=this.K4d=this.L4d=0;this.ga=null;this.Dgf=(Ra,mb,Jb)=>{if(Xa.App.cJd)return 8;Ra=mb.node;return 1===Jb?Ra?32:2:2===Jb?(Jb=oe.ImageReader.Ym(mb),mb=oe.ImageReader.mPc(Jb,mb.node.Vi().od,w.AFrameworkApplication.K,
w.AFrameworkApplication.ta.EPa),hy(mb),32):2};this.qDm=(Ra,mb,Jb)=>{var Ub;const cc=this.Uj.Jfa(mb);if(2===Jb&&cc){if(Gb.a.bR===Ra||Gb.a.qDd===Ra)w.AFrameworkApplication.bpa?w.AFrameworkApplication.Xeg():((null===(Ub=w.AFrameworkApplication.K)||void 0===Ub?0:Ub.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&yo.a.instance.M5a("PictureLocal"),this.Cdl(mb));return 32}return 1!==Jb||Gb.a.bR!==Ra&&Gb.a.qDd!==Ra?2:cc?32:2};this.TGb=(Ra,mb,Jb,Ub,cc)=>this.Uj.Jfa(mb)?1===
Jb?32:this.Uj.RAf(mb,cc)?32:2:2;this.goo=()=>{if(this.hb&&this.hb.gb&&this.hb.gb.kb){const Ra=this.hb.gb.kb.Oa;Ra&&this.hb.setSelection(Og.SelectionFactory.pe(Ra.node,Ra.cpBegin))}};this.Ssl=(Ra,mb,Jb,Ub,cc)=>{u.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");if((Ra=cc.DataTransfer)&&Ra.files&&0<Ra.files.length){u.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",Ra.files.length));for(Jb=0;Jb<Ra.files.length;Jb++)Ub=Ra.files[Jb],0<=G.a.Ug(Ub.type).indexOf("image")&&
this.DCm(Ub,mb)&&(Ub=this.hb.gb.kb.Oa,this.hb.setSelection(Og.SelectionFactory.pe(Ub.node,Ub.cpBegin+1)));this.bJa();return 32}u.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2};this.VDn=(Ra,mb,Jb,Ub,cc)=>{if(2===Jb)return w.AFrameworkApplication.va.Mf(mb.gk,Ra,Jb,!0,Ub,cc);if(!mb.view.te)return 8;Ra=mb.view;if(!Ra.lb)return 8;Ra=dt.Xg.dO(Ra.lb.tg);return 1===Ra.length&&this.cO(Ra[0])?(this.R6m(),this.HWc||dt.sZf(!0),32):8};this.smm=(Ra,mb,Jb)=>{if(!this.cO(mb))return 8;
const Ub=oe.ImageReader.Ym(mb),cc=oe.ImageReader.fF(Ub),Ac=oe.ImageReader.yG(Ub);Ra=Ra===Gb.a.HUd;u.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:Ra});if(1===Jb)return this.oi.d4||oe.ImageReader.a3a(Ub)?2:Ra&&cc<this.n4d&&Ac<this.m4d||!Ra&&cc>this.L4d&&Ac>this.K4d?32:2;Jb=Ra?1.1:.9;this.setSize(Ub,mb,cc*Jb,Ac*Jb,!0);return 32};this.Ogc=(Ra,mb,Jb,Ub,cc)=>{if(!this.rCa(mb))return 8;Ra=oe.ImageReader.Ym(mb);mb=oe.ImageReader.xEa(Ra);Jb=oe.ImageReader.wEa(Ra);if(0>=mb||0>=Jb)return 2;
Ra=oe.ImageReader.fF(Ra)/mb*100;cc.setValue(Wc.a.oSc,Ra);return 32};this.l$b=(Ra,mb,Jb,Ub,cc)=>{if(!this.rCa(mb))return 8;Ra=oe.ImageReader.Ym(mb);if(1===Jb)return this.oi.d4||oe.ImageReader.a3a(Ra)?2:32;u.ULS.sendTraceTag(20459937,322,50,"Change image scale.");Jb=cc.ia(Wc.a.oSc,-1)/100;Ub=cc.ia(Wc.a.Xpi,!1);const Ac=cc.ia(Wc.a.jzf,!0);cc=cc.ia(Wc.a.kzf,!0);if(0>=Jb)return dt.Jc.Yb(qe.a.fn,{["Reason"]:me.a.dHb}),2;const Lc=oe.ImageReader.xEa(Ra),id=oe.ImageReader.wEa(Ra),vd=oe.ImageReader.fF(Ra),
xe=oe.ImageReader.yG(Ra);if(0>=Lc||0>=id)return dt.Jc.Yb(qe.a.s1,{["Reason"]:me.a.dHb}),2;Ub?(Ub=Ac?Jb*vd:vd,Jb=cc?Jb*xe:xe):(Ub=Ac?Jb*Lc:vd,Jb=cc?Jb*id:xe);this.setSize(Ra,mb,Ub,Jb);Xa.App.rd.Qo&&Xa.App.rd.Tp.VF(mb.node);this.bJa();return 32};this.sMb=(Ra,mb,Jb,Ub,cc)=>{if(!this.cO(mb))return 8;Ra=oe.ImageReader.Ym(mb);Ra=oe.ImageReader.yG(Ra);if(0>=Ra)return 2;cc.setValue(Wc.a.TEa,Ra);return 32};this.TEa=(Ra,mb,Jb,Ub,cc)=>{if(!this.rCa(mb))return 8;Ra=oe.ImageReader.Ym(mb);if(1===Jb)return this.oi.d4||
oe.ImageReader.a3a(Ra)?2:32;u.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Jb=cc.ia(Wc.a.TEa,0);cc=oe.ImageReader.$2a(Ra);if(0>=Jb)return dt.Jc.Yb(qe.a.fn,{["Reason"]:me.a.dHb}),2;Ub=oe.ImageReader.xEa(Ra);const Ac=oe.ImageReader.wEa(Ra),Lc=oe.ImageReader.fF(Ra);var id=oe.ImageReader.yG(Ra);id=Lc/id;if(0>=Ub||0>=Ac)if(dt.Jc.Yb(qe.a.s1,{["Reason"]:me.a.dHb}),this.Uqj(Ra))return 2;this.setSize(Ra,mb,cc?Jb*id:Lc,Jb);Xa.App.rd.Qo&&Xa.App.rd.Tp.VF(mb.node);Xa.App.xa.updateCommandUI();
return 32};this.tMb=(Ra,mb,Jb,Ub,cc)=>{if(!this.cO(mb))return 8;Ra=oe.ImageReader.Ym(mb);Ra=oe.ImageReader.fF(Ra);if(0>=Ra)return 2;cc.setValue(Wc.a.UEa,Ra);return 32};this.UEa=(Ra,mb,Jb,Ub,cc)=>{if(!this.rCa(mb))return 8;Ra=oe.ImageReader.Ym(mb);if(1===Jb)return this.oi.d4||oe.ImageReader.a3a(Ra)?2:32;u.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");Jb=cc.ia(Wc.a.UEa,0);cc=oe.ImageReader.$2a(Ra);if(0>=Jb)return dt.Jc.Yb(qe.a.fn,{["Reason"]:me.a.dHb}),2;Ub=oe.ImageReader.xEa(Ra);
const Ac=oe.ImageReader.wEa(Ra);var Lc=oe.ImageReader.fF(Ra);const id=oe.ImageReader.yG(Ra);Lc=id/Lc;if(0>=Ub||0>=Ac)if(dt.Jc.Yb(qe.a.s1,{["Reason"]:me.a.dHb}),this.Uqj(Ra))return 2;this.setSize(Ra,mb,Jb,cc?Jb*Lc:id);Xa.App.rd.Qo&&Xa.App.rd.Tp.VF(mb.node);Xa.App.xa.updateCommandUI();return 32};this.vMb=(Ra,mb,Jb,Ub,cc)=>{if(!this.cO(mb))return 8;Ra=oe.ImageReader.Ym(mb);Ra=oe.ImageReader.$2a(Ra);cc.setValue(Wc.a.UX,Ra);return 32};this.UX=(Ra,mb,Jb,Ub,cc)=>{if(!this.cO(mb))return 8;Ra=oe.ImageReader.Ym(mb);
if(1===Jb&&this.oi.d4)return 2;Xa.App.rd.Qo&&Xa.App.rd.Tp.VF(mb.node);cc&&(mb=cc.ia(Wc.a.UX,!0),u.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.Uj.Zlj(Ra,mb),Xa.App.xa.updateCommandUI());return 32};this.v5a=(Ra,mb,Jb,Ub,cc)=>{if(!this.cO(mb))return 8;Ra=oe.ImageReader.Ym(mb);Ra=oe.ImageReader.yX(Ra);cc.setValue(Wc.a.Tib,Ra);return 32};this.Tib=(Ra,mb,Jb,Ub,cc)=>{if(!this.cO(mb))return 8;if(1===Jb)return this.oi.d4?2:32;if(Xa.App.rd.Qo&&(Ra=mb.node.ia(Hh.a.EJ,ij.a.Jt),Ra!==
ij.a.Jt&&(Ra=Xa.App.rd.Tp.Uhb(Ra),pK.CoauthLockEditor.getInstance().P6a(Ra))))return dt.Jc.Yb(qe.a.fn,{["Reason"]:me.a.WE}),2;Ra=oe.ImageReader.Ym(mb);cc=cc.ia(Wc.a.Tib,null);this.Uj.uko(Ra,mb,cc);u.ULS.sendTraceTag(21297027,322,50,"Change image alt text.");this.Ld.Ns(13);return 32};this.u5a=(Ra,mb,Jb,Ub,cc)=>{if(!this.cO(mb))return 8;Ra=oe.ImageReader.Ym(mb);Ra=oe.ImageReader.fPa(Ra);cc.setValue(Wc.a.RX,Ra);return 32};this.RX=(Ra,mb,Jb,Ub,cc)=>{if(!this.cO(mb))return 8;if(1===Jb)return this.oi.d4?
2:32;if(Xa.App.rd.Qo&&(Ra=mb.node.ia(Hh.a.EJ,ij.a.Jt),Ra!==ij.a.Jt&&(Ra=Xa.App.rd.Tp.Uhb(Ra),pK.CoauthLockEditor.getInstance().P6a(Ra))))return dt.Jc.Yb(qe.a.fn,{["Reason"]:me.a.WE}),2;Ra=oe.ImageReader.Ym(mb);cc=cc.ia(Wc.a.RX,null);this.Uj.tko(Ra,mb,cc);u.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.Ld.Ns(13);return 32};this.o6a=(Ra,mb,Jb)=>{var Ub,cc;if(1===Jb)return 32;if(!mb.view.te)return u.ULS.sendTraceTag(512267791,322,15,"No interactive view. Action: {0}",Ra),
8;mb=mb.view;Jb=null===(cc=null===(Ub=mb.lb)||void 0===Ub?void 0:Ub.gb)||void 0===cc?void 0:cc.J(0);if(!Jb)return u.ULS.sendTraceTag(512267790,322,15,"No selection view. Action: {0}",Ra),8;cc=Jb.Oa;Ub=this.MR.Zf("UserAction",Ra.toString());let Ac;Ra==Gb.a.V9f?Ac=this.hSc.o6a(cc,2):Ra==Gb.a.Y9f?(Ac=this.hSc.o6a(cc,0),5==Ac&&(Ac=this.hSc.o6a(cc,2))):Ra==Gb.a.Z9f&&(Ac=this.hSc.o6a(cc,1),5==Ac&&(Ac=this.hSc.o6a(cc,3)));switch(Ac){case 4:cc=32;mb.e5();break;case 5:cc=2;break;default:cc=8}Ub.stop();u.ULS.sendTraceTag(512267789,
322,50,"Select image: {0}. Duration: {1}. Action: {2}",Ac,Ub.si,Ra);return cc};this.Uj=b;this.Sm=h;this.Ld=v;this.Pg=D;this.hb=P;this.pg=Gl.a.getInstance(vm.a)}get oi(){return Ih.PageReader.instance}get wba(){return this.Sm.instance}get pc(){return this.ga}VAm(){this.L4d=Ef.a.Vl(1,0);this.K4d=Ef.a.Vl(1,1);this.n4d=Ef.a.Vl(1920,0);this.m4d=Ef.a.Vl(1280,1)}Tb(b){this.ga=b;const h=this.VDn,v=this.qDm,D=this.TGb,P=this.smm;b.eb(Gb.a.bR,sc.a.view,v,1284);b.qa(Gb.a.TGb,sc.a.Tc,D);b.qa(Gb.a.V9f,sc.a.view,
this.o6a);b.qa(Gb.a.Y9f,sc.a.view,this.o6a);b.qa(Gb.a.Z9f,sc.a.view,this.o6a);b.qa(Gb.a.TGb,sc.a.image,D);b.Vc(Gb.a.TGb,1284);b.eb(Gb.a.qDd,sc.a.view,v,1284);b.eb(Gb.a.U6e,sc.a.view,h,1028);this.qr(b,Gb.a.HUd,P);this.qr(b,Gb.a.jfg,P);this.qr(b,Gb.a.Ogc,this.Ogc);this.qr(b,Gb.a.sMb,this.sMb);this.qr(b,Gb.a.tMb,this.tMb);this.qr(b,Gb.a.v5a,this.v5a);this.qr(b,Gb.a.u5a,this.u5a);this.qr(b,Gb.a.l$b,this.l$b);this.qr(b,Gb.a.Zge,this.TEa);this.qr(b,Gb.a.$ge,this.UEa);this.qr(b,Gb.a.r7c,this.Tib);this.qr(b,
Gb.a.pOb,this.RX);this.qr(b,Gb.a.vMb,this.vMb);this.qr(b,Gb.a.UX,this.UX);this.qr(b,Gb.a.Dgf,this.Dgf);b.eb(Gb.a.JUh,sc.a.view,this.Ssl,4);b.Vc(Gb.a.HUd,4);b.Vc(Gb.a.jfg,4);b.Vc(Gb.a.Ogc,69);b.Vc(Gb.a.sMb,69);b.Vc(Gb.a.tMb,69);b.Vc(Gb.a.vMb,69);b.Vc(Gb.a.v5a,69);b.Vc(Gb.a.u5a,69);b.Vc(Gb.a.UX,4);b.Vc(Gb.a.l$b,4);b.Vc(Gb.a.Zge,4);b.Vc(Gb.a.$ge,4);b.Vc(Gb.a.r7c,4);b.Vc(Gb.a.pOb,4);this.VAm();this.HWc&&Yh.a.instance.Pw(this.PSk)}qr(b,h,v){b.qa(h,sc.a.image,v);b.qa(h,sc.a.yDb,v);b.qa(h,sc.a.Hd,v);b.qa(h,
sc.a.anchoredObject,v)}Cdl(b){new oc(b,Qg.a.instance,w.AFrameworkApplication.K,null,this.Pg,this.ga)}K2o(b){return this.oi.d4?(dt.Jc.Yb(qe.a.fn,{["Reason"]:me.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(dt.Jc.Yb(qe.a.fn,{["Reason"]:me.a.NAl}),!1):dt.Wf.k_(b)?(dt.Jc.Yb(qe.a.fn,{["Reason"]:me.a.WE}),!1):this.wba&&this.wba.pU(b)?(dt.Jc.Yb(qe.a.fn,{["Reason"]:me.a.externalSelection}),!1):!0}SMm(b){const h=oe.ImageReader.Ym(b);return h&&5===oe.ImageReader.Ui(h)&&this.$wi(b,h)}$wi(b,h){(h=!oe.ImageReader.e8b(h)&&
!oe.ImageReader.DZd(h))||dt.Jc.Yb(qe.a.fn,{["Reason"]:me.a.yIh});return h&&this.K2o(b)}DCm(b,h){var v,D;h=new rK(h,Qg.a.instance,w.AFrameworkApplication.K,b,this.Pg,this.ga,this.hb,this.goo);if(h.B2o(b))(null===(D=w.AFrameworkApplication.K)||void 0===D?0:D.$("ShouldLogPicturesExtendedHealthKpis"))&&this.pg.logKpiUsage({kpiName:vm.c.VEa,kpiType:0});else return(null===(v=w.AFrameworkApplication.K)||void 0===v?0:v.$("ShouldLogPicturesExtendedHealthKpis"))?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new Bb.a,
{extendedProperties:b}),this.pg.logKpiFailure({kpiName:vm.c.VEa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:{name:vm.c.j$b,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):va.Health.instance.recordQosError("PictureDragDropInvalid",["ImageInsertFailed"],!0,!0,!1,!1,null),u.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new vf.a(document.body,
Object(z.a)(h,h.vfc,"onUploadFrameInitialized"),Object(z.a)(h,h.jza,"uploadResponseReceived"),w.AFrameworkApplication.K,!1,void 0,Ye.a(w.AFrameworkApplication.K));return!0}cO(b){return this.SMm(b)}rCa(b){const h=oe.ImageReader.Ym(b);if(!h)return!1;const v=Ea.a.instance.Na("Box4.IFeatureHelper"),D=oe.ImageReader.Ui(h);return 5===D||10===D||48===D||11===D||v&&v.isFeatureEnabled(49)&&4===D?this.$wi(b,h):!1}get HWc(){var b;return null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdatedTabUpdateEnabled",
!1)}PSk(){dt.sZf(!0)}setSize(b,h,v,D,P=!1){Xa.App.rd.Qo&&Xa.App.rd.Tp.VF(h.node);const ca=oe.ImageReader.$2a(b);let ta=1;v>this.n4d?ta=this.n4d/v:v<this.L4d&&(ta=this.L4d/v);let Ra=1;D>this.m4d?Ra=this.m4d/D:D<this.K4d&&(Ra=this.K4d/D);if(ca||P)ta=Math.min(ta,Ra),Ra=Math.min(ta,Ra);1!==ta&&(v*=ta);1!==Ra&&(D*=Ra);this.dgf(b,h,v,D)}dgf(b,h,v,D){this.Uj.soo(b,h,v,D)}R6m(){u.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}bJa(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&
window.setTimeout(()=>{const b=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}Uqj(b){const h=oe.ImageReader.xEa(b);b=oe.ImageReader.wEa(b);return 0>=h||0>=b}static get Xg(){return em.ContextSetEditor.instance}static get Wf(){return qi.a.instance}static get Jc(){return bf.a.instance}}dt.sZf=null;Object(n.a)(dt,"ImageActor",null,[]);var sH=c(1158),tH=c(1159),PM=c(1091),xv=c(394),Qx=c(718);
class DG{constructor(b,h,v,D,P){this.imagePropertySet=b;this.graphNode=h;this.Ygf=v;this.Zlm=D;this.$Mc=P;if(this.A2a=Xa.App.instance&&Xa.App.instance.A2a())this.$Be=new PM.a(this.Pr(),DG.Onc);this.pg=Gl.a.getInstance(xv.a)}rotate(b){this.Mha("rotate");if(null===this.imagePropertySet||void 0===this.Ygf||void 0===this.$Mc)return this.lY("rotate","Argument(s) invalid"),!1;const h=this.getGraphicData("rotate");if(void 0===h)return!1;b-=this.imagePropertySet.I2c.Otf();if(0!==b){const v=this.$Mc.pkm();
v.rotation=b;try{if(!this.Kuh(v,h))return this.lY("rotate","Failed to apply and update"),!1}catch(D){return this.uKi("rotate",D),this.lY("rotate",D.stack?D.stack:D.message?D.message:D.toString()),!1}}this.vKi("rotate");return!0}resize(b,h){this.Mha("resize");if(null===this.imagePropertySet||void 0===this.Ygf||void 0===this.$Mc)return this.lY("resize","Argument(s) invalid"),!1;const v=this.getGraphicData("resize");if(void 0===v)return!1;let D=0;var P=0;({width:D,height:P}=oe.ImageReader.Nhb(this.imagePropertySet));
b/=D;h/=P;P=this.$Mc.qkm();P.scale=this.$Mc.Ddm();P.scale.width=b;P.scale.height=h;try{if(!this.Kuh(P,v))return this.lY("resize","Failed to apply and update"),!1}catch(ca){return this.uKi("resize",ca),this.lY("resize",ca.stack?ca.stack:ca.message?ca.message:ca.toString()),!1}this.vKi("resize");return!0}vKi(b){Qx.a.KHa&&(b=new Map([["Renderer",xv.b.LNd],["Operation",b],["Type",oe.ImageReader.Ui(this.imagePropertySet).toString()]]),this.pg.logKpiSuccess({kpiName:xv.d.SJd,optionalProperties:{additionalValues:{durationMs:void 0,
inStaging:void 0,extendedProperties:b},hasImpliedUsage:void 0},blockFutureEmissionDurationInMs:3E5}))}uKi(b,h){Qx.a.KHa&&(b=Object.assign(new Bb.a,{extendedProperties:new Map([["Renderer",xv.b.LNd],["Exception",h.message],["Operation",b]])}),h={name:xv.d.QUh,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","warning"),this.pg.logKpiFailure({kpiName:xv.d.SJd,errorName:"DrawingResponseInvalid",optionalProperties:{isIntentional:!1,
isInternal:!0,additionalValues:b},optionalVeto:h}))}static get Onc(){return Ea.a.instance.Na("Box4.ICssColorProvider")}getGraphicData(b){try{if(this.A2a){const h=this.$Be.Mii();return this.imagePropertySet.getGraphicData(h)}return this.imagePropertySet.getGraphicData()}catch(h){this.lY(b,h.stack?h.stack:h.message?h.message:h.toString())}}Kuh(b,h){this.Ygf.apply(b,h);b=this.imagePropertySet.bEb(h);if(void 0===b)return!1;this.EUo(b);return!0}EUo(b){const h=new eh.GraphTransaction(15);h.Cb(this.graphNode);
this.imagePropertySet.setValue(Pd.a.GX,b.GX);this.Zlm.gbo(b.PYh,b.Xwa,this.imagePropertySet);h.dispose()}Pr(){return Wk.PageNavigator.instance.Ys(this.graphNode)}Mha(b){const h=this.Zrg;h.edit=b;u.ULS.sendTraceTag(509657553,322,50,"{0}",h)}lY(b,h){const v=this.Zrg;v.message=h;v.edit=b;u.ULS.sendTraceTag(509666444,322,15,"{0}",v)}get Zrg(){return{["id"]:oe.ImageReader.gPa(this.imagePropertySet),["type"]:oe.ImageReader.Ui(this.imagePropertySet)}}}Object(n.a)(DG,"EditWithGC2Command",null,[]);class uH{gbo(b,
h,v){this.$0m(b,h);this.jbo(v)}$0m(b,h){this.CH=Array(4);this.CH[0]=b.lhf;this.CH[2]=b.nhf;this.CH[1]=b.mhf;this.CH[3]=b.khf;this.uOa=b.uOa;this.vOa=b.vOa;(this.Xwa=h)&&this.u7k()}jbo(b){b.setValue(Pd.a.Xva,Math.round(this.uOa).toString());b.setValue(Pd.a.Yva,Math.round(this.vOa).toString());const h=Array(4);this.CH.forEach((v,D)=>{h[D]=Math.round(v).toString()});b.setValue(Pd.a.tPa,h);b.setValue(Pd.a.L2a,this.Xwa)}u7k(){this.IGo();const b=this.uOa/2,h=this.vOa/2;this.uOa%2&&0===this.vOa%2?(--this.CH[0],
++this.CH[2]):this.vOa%2&&0===this.uOa%2&&(++this.CH[0],--this.CH[2]);this.CH[0]+=b-h;this.CH[1]-=b-h;this.CH[2]+=h-b;this.CH[3]-=h-b}IGo(){const b=this.uOa;this.uOa=this.vOa;this.vOa=b}}Object(n.a)(uH,"GraphicsExtents",null,[]);var EG=c(685),sK=c(515),QM=c(514),RM=c(1472);class fr extends dt{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb){super(b,h,D,ca,ta,Ra,mb);this.X5g=!1;this.MAa=this.laa=null;this.Bw=(Ub,cc,Ac,Lc,id)=>{if(!this.cO(cc))return 8;if(1===Ac)return this.oi.d4?2:32;Ub=parseInt(id);u.ULS.sendTraceTag(593372312,
322,50,"SetPictureStyle: "+Ub);this.Std.aOn(cc,oe.ImageReader.Ym(cc),Ub);this.nYc(cc);this.bJa();return 32};this.Aee=(Ub,cc,Ac)=>{if(!this.cO(cc))return 8;u.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");Ub=oe.ImageReader.Ym(cc);if(1===Ac)return this.oi.d4?2:32;Ac=oe.ImageReader.Phb(Ub);1===Ac?(Ac=new eh.GraphTransaction(15),Ac.Cb(cc.node),oe.ImageReader.kac()?Ub.setValue(Bc.a.CLb,""):this.qK.M_n(Ub),Ac.dispose(),this.aAc.create(Ub,cc).Bw(Fe.a.nej),this.nYc(cc)):2===Ac&&this.aAc.create(Ub,
cc).Bw(Fe.a.nej);return 32};this.com=(Ub,cc,Ac,Lc,id)=>{if(!this.cO(cc))return 8;Ub=oe.ImageReader.Ym(cc);if(1===Ac)return this.oi.d4||oe.ImageReader.Xac(Ub)?2:32;id&&(this.qK.S$c(Ub,cc),u.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),Xa.App.xa.updateCommandUI());this.bJa();return 32};this.dom=(Ub,cc,Ac,Lc,id)=>{if(!this.cO(cc))return 8;if(1===Ac)return this.oi.d4?2:32;Ub=oe.ImageReader.Ym(cc);if(id){Ac=oe.ImageReader.iYd(oe.ImageReader.Ym(cc));u.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+
Ac);Lc=id.ia(Wc.a.Yib,0);const vd=id.ia(Wc.a.Vib,0),xe=id.ia(Wc.a.Wib,0);id=id.ia(Wc.a.Xib,0);const Ld=oe.ImageReader.Hba(Ub),Qd=Ld.bottom,Zd=Ld.left,te=Ld.right;if(Lc===Ld.top&&vd===Qd&&xe===Zd&&id===te)return u.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;Ac?(new sH.a(Ub,new tH.a)).mio(Lc,vd,xe,id,this.Ynn,cc):this.Std.RNn(cc,oe.ImageReader.Ym(cc),Lc,vd,xe,id);this.nYc(cc);Xa.App.xa.updateCommandUI()}return 32};this.RUd=(Ub,cc,Ac,Lc,id)=>
{if(!this.cO(cc))return 8;Lc=oe.ImageReader.Ym(cc);if(1===Ac)return this.oi.d4||oe.ImageReader.Xac(Lc)?2:32;if(id){u.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");this.qK.Dwa()||this.qK.S$c(Lc,cc);switch(Ub){case Nc.a.eSc:Ub=id.ia(Wc.a.Yib,-1);Ac=0;break;case Nc.a.YRc:Ub=id.ia(Wc.a.Vib,-1);Ac=1;break;case Nc.a.ZRc:Ub=id.ia(Wc.a.Wib,-1);Ac=2;break;case Nc.a.$Rc:Ub=id.ia(Wc.a.Xib,-1);Ac=3;break;default:return 8}this.qK.oXo(Ub,Ac);this.nYc(cc);Xa.App.xa.updateCommandUI()}return 32};
this.tnb=(Ub,cc,Ac,Lc,id)=>{if(!this.cO(cc))return 8;oe.ImageReader.Ym(cc);id&&(Ub=this.qK.Dwa(),id.setValue(Wc.a.Dwa,Ub));return 32};this.Ngc=(Ub,cc,Ac,Lc,id)=>{if(!this.cO(cc))return 8;Ub=oe.ImageReader.Ym(cc);if(id){if(this.qK.Dwa())({top:vd,bottom:Ac,left:Ub,right:cc}=this.qK.PTl());else{Lc=Ef.a.vf(oe.ImageReader.fF(Ub),0);var vd=Ef.a.vf(oe.ImageReader.yG(Ub),1);cc=oe.ImageReader.Hba(Ub);const xe=Math.max(cc.top,0);Ac=Math.max(cc.bottom,0);Ub=Math.max(cc.left,0);cc=Math.max(cc.right,0);Lc=1E5*
Lc/(1E5-(Ub+cc));const Ld=1E5*vd/(1E5-(xe+Ac));vd=Math.floor(xe*Ld/1E5);Ac=Math.floor(Ac*Ld/1E5);Ub=Math.floor(Ub*Lc/1E5);cc=Math.floor(cc*Lc/1E5)}id.setValue(Wc.a.Yib,vd);id.setValue(Wc.a.Vib,Ac);id.setValue(Wc.a.Wib,Ub);id.setValue(Wc.a.Xib,cc)}return 32};this.x9b=(Ub,cc,Ac,Lc,id)=>{if(!this.cO(cc))return 8;if(1===Ac){if(this.oi.d4)return 2;this.n9m();return 32}Ub=oe.ImageReader.Ym(cc);this.qK.Dwa()&&this.qK.S$c(Ub,cc);Ub=id.ia(Wc.a.THa,"");id=id.ia(Wc.a.E8a,0);u.ULS.sendTraceTag(20459970,322,50,
"SetWrapTextAction: {0}",{["Type"]:id,["SourceControlId"]:Ub});switch(id){case 1:this.qK.lpo(cc);break;case 8:this.qK.Vhe(cc,1,1);break;case 9:this.qK.Vhe(cc,1,3);break;case 3:this.qK.Vhe(cc,2,void 0,!0);break;case 4:this.qK.Vhe(cc,2,void 0,!1)}this.bJa();Xa.App.xa.updateCommandUI();return 32};this.ahc=(Ub,cc,Ac,Lc,id)=>{if(!this.cO(cc))return 8;Ub=oe.ImageReader.Ym(cc);cc=oe.ImageReader.i4(cc);Ac=oe.ImageReader.I8(Ub);Lc=oe.ImageReader.i9b(Ub);Ub=oe.ImageReader.Gx(Ub);return this.PNn(cc,Ac,Lc,Ub,
id)?32:8};this.fom=(Ub,cc,Ac,Lc,id)=>{var vd;if(!this.rCa(cc))return 8;Lc=oe.ImageReader.Ym(cc);if(1===Ac)return bc.SessionStatusManager.instance.Gj?8:this.oi.d4||oe.ImageReader.Yac(Lc)?2:32;this.qK.Dwa()&&this.qK.S$c(Lc,cc);if(this.$xi(Lc)&&(Ac=null===(vd=x())||void 0===vd?void 0:vd.c4b(),vd=new DG(Lc,cc.node,Ac,new uH,y()),Ac=id.ia(Wc.a.sJ,0),vd.rotate(Ac)))return 32;if(id){Ac=id.ia(Wc.a.lSc,0);const xe=oe.ImageReader.iYd(Lc);u.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",
Ac,xe);vd=oe.ImageReader.D_(Lc);let Ld=oe.ImageReader.fQd(Lc),Qd=oe.ImageReader.CEb(Lc);switch(Ac){case 0:vd=id.ia(Wc.a.sJ,0);break;case 2:vd-=90;vd=$c.c(vd);break;case 1:vd+=90;vd=$c.c(vd);break;case 4:Ld=!Ld;break;case 3:Qd=!Qd;break;case 5:vd+=id.ia(Wc.a.sJ,0),vd=$c.c(vd)}xe?(new sH.a(Lc,new tH.a)).Gno(vd,Ld,Qd,this.pun,cc):Ac?this.aAc.create(Lc,cc).Pmo(vd,Ld,Qd):(id=ub.a.create(),Ac=new eh.GraphTransaction(15,Gb.a.imageRotate),Ac.Cb(cc.node),this.qK.Dko(Lc,vd),this.Std.XNn(cc,oe.ImageReader.Ym(cc),
vd,id),Ac.ZFa(id,1),Ac.jk=Ub,Ac.dispose());this.bJa();this.nYc(cc);Xa.App.xa.updateCommandUI()}return 32};this.uMb=(Ub,cc,Ac,Lc,id)=>{if(!this.cO(cc))return 8;Ub=oe.ImageReader.Ym(cc);Ub=oe.ImageReader.D_(Ub);if(0>Ub)return 2;id.setValue(Wc.a.sJ,Ub);return 32};this.pun=(Ub,cc,Ac,Lc)=>{if(Ub){const id=new eh.GraphTransaction(15,Gb.a.imageRotate);id.Cb(Lc.node);cc.setValue(Wc.a.CAb,JSON.stringify(Ac));cc.setValue(Wc.a.hu,Ub);this.qK.che(cc,Ac.rotationAngle,Ac.W9b,Ac.qnc);this.PDb(cc);id.dispose()}};
this.Ztn=(Ub,cc,Ac,Lc)=>{if(Ub){const id=new eh.GraphTransaction(15);id.Cb(Lc.node);cc.setValue(Wc.a.CAb,JSON.stringify(Ac));cc.setValue(Wc.a.hu,Ub);this.qK.Jge(cc,Ac.yne,Ac.Wad);this.PDb(cc);id.dispose()}};this.Ynn=(Ub,cc,Ac,Lc)=>{if(Ub){const id=new eh.GraphTransaction(15);id.Cb(Lc.node);cc.setValue(Wc.a.CAb,JSON.stringify(Ac));cc.setValue(Wc.a.hu,Ub);this.qK.xko(cc,Math.round(Ac.Mua*EG.a.yfb),Math.round(Ac.Jua*EG.a.yfb),Math.round(Ac.Kua*EG.a.yfb),Math.round(Ac.Lua*EG.a.yfb));this.PDb(cc);id.dispose()}};
this.Z1c=(Ub,cc,Ac,Lc,id)=>{if(!this.rCa(cc))return 8;if(1===Ac)return 32;Ub=cc.contextId===sc.a.view?Ih.PageReader.instance.nRd(cc):Wk.PageNavigator.instance.Ys(cc.node);if(!Ub)return 8;Ac=oe.ImageReader.Ym(cc);cc=this.Ho.etf(xn.a.WT(cc),Ac);fr.c2i.$Nb=cc;this.OVc&&this.recentColors.uoe(cc);cc=fr.c2i.aNc(Ub,Xa.App.TAb);if(!cc)return 8;id.MenuItems=cc;return 32};this.T9=(Ub,cc,Ac,Lc,id)=>{if(!this.rCa(cc))return 8;if((Lc=oe.ImageReader.Ym(cc))&&oe.ImageReader.wy(Lc))return 2;if(1===Ac)return 32;if(2!==
Ac)return 2;if(!id)return u.ULS.sendTraceTag(571287758,322,10,"SetPictureBorderColor: actionData null"),8;Ac=new eh.GraphTransaction(15);Ac.Cb(cc.node);const vd=fr.x7a.nua(cc.node,id);this.Ho.T9(Lc,id,cc,vd);this.PDb(Lc);Ac.dispose();Ub==Gb.a.A7c&&this.recentColors.bZa(id);this.Gdd();this.bJa();return 32};this.eia=(Ub,cc,Ac)=>{if(!this.rCa(cc))return 8;if(1===Ac)return 32;Xa.App.xa.dismissFloatie();fr.I9a=new Xy.a("PictureBorder",Gb.a.A7c);fr.I9a.Xjc(0);return 32};this.Wia=(Ub,cc,Ac,Lc,id)=>{if(!this.rCa(cc))return 8;
if(1===Ac)return 32;if((Ub=oe.ImageReader.Ym(cc))&&oe.ImageReader.wy(Ub))return 2;if(!id)return u.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;Ac=new eh.GraphTransaction(15);Ac.Cb(cc.node);this.Ho.Wia(Ub,id,cc);this.PDb(Ub);Ac.dispose();this.Gdd();this.bJa();return 32};this.I6a=(Ub,cc,Ac,Lc,id)=>{if(!this.rCa(cc))return 8;if(1===Ac)return 32;if((Ub=oe.ImageReader.Ym(cc))&&oe.ImageReader.wy(Ub))return 2;if(!id)return u.ULS.sendTraceTag(571287760,322,10,"SetPictureBorderStyle: actionData null"),
8;Ac=new eh.GraphTransaction(15);Ac.Cb(cc.node);this.Ho.I6a(Ub,id,cc);this.PDb(Ub);Ac.dispose();this.Gdd();this.bJa();return 32};this.Hde=(Ub,cc,Ac)=>{if(!this.rCa(cc))return 8;if(1===Ac)return 32;Ub=oe.ImageReader.Ym(cc);Ac=new eh.GraphTransaction(15);Ac.Cb(cc.node);oe.ImageReader.I9b(Ub)&&(this.Ho.Hde(Ub),this.PDb(Ub));Ac.dispose();this.Gdd();this.bJa();return 32};this.qK=b;this.aAc=v;this.Std=P;fr.Jh=Jb;dt.sZf=fr.WDn}get recentColors(){return null!=this.gGg?this.gGg:this.gGg=Ea.a.instance.Na("Box4.UI.RecentColorsSectionHandler")}get Ho(){this.laa||
(this.laa=new sK.a);return this.laa}Tb(b){super.Tb(b);this.qr(b,Gb.a.Bw,this.Bw);b.Vc(Gb.a.Bw,4);this.qr(b,Gb.a.Aee,this.Aee);this.qr(b,Nc.a.Wpe,this.x9b);b.Vc(Nc.a.Wpe,4);this.qr(b,Nc.a.Xpe,this.x9b);this.qr(b,Nc.a.Ype,this.x9b);this.qr(b,Nc.a.Zpe,this.x9b);this.qr(b,Nc.a.$pe,this.x9b);this.qr(b,Nc.a.aqe,this.x9b);this.qr(b,Nc.a.ahc,this.ahc);b.Vc(Nc.a.ahc,101);this.qr(b,Nc.a.imageCrop,this.com);b.Vc(Nc.a.imageCrop,4);this.qr(b,Nc.a.tnb,this.tnb);b.Vc(Nc.a.tnb,101);this.qr(b,Nc.a.Ipi,this.dom);this.qr(b,
Nc.a.eSc,this.RUd);this.qr(b,Nc.a.YRc,this.RUd);this.qr(b,Nc.a.ZRc,this.RUd);this.qr(b,Nc.a.$Rc,this.RUd);this.qr(b,Nc.a.Z2c,this.Ngc);b.Vc(Nc.a.Z2c,101);this.qr(b,Nc.a.rbe,this.Ngc);b.Vc(Nc.a.rbe,101);this.qr(b,Nc.a.sbe,this.Ngc);b.Vc(Nc.a.sbe,101);this.qr(b,Nc.a.tbe,this.Ngc);b.Vc(Nc.a.tbe,101);this.qr(b,Gb.a.imageRotate,this.fom);b.Vc(Gb.a.imageRotate,4);this.qr(b,Gb.a.uMb,this.uMb);b.Vc(Gb.a.uMb,101);this.qr(b,Gb.a.Z1c,this.Z1c);b.Vc(Gb.a.Z1c,4);this.qr(b,Gb.a.T9,this.T9);b.Vc(Gb.a.T9,4);this.qr(b,
Gb.a.A7c,this.T9);b.Vc(Gb.a.A7c,4);this.qr(b,Gb.a.dXf,this.eia);b.Vc(Gb.a.dXf,4);this.qr(b,Gb.a.Zxa,this.Zxa.bind(this));b.Vc(Gb.a.Zxa,4);this.qr(b,Gb.a.Wia,this.Wia);b.Vc(Gb.a.Wia,4);this.qr(b,Gb.a.wMb,this.wMb.bind(this));b.Vc(Gb.a.wMb,4);this.qr(b,Gb.a.I6a,this.I6a);b.Vc(Gb.a.I6a,4);this.qr(b,Gb.a.qRf,this.Hde);b.Vc(Gb.a.qRf,4)}dgf(b,h,v,D){var P;u.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+oe.ImageReader.iYd(b));this.qK.Dwa()&&this.qK.S$c(b,h);if(this.$xi(b)){const ca=
null===(P=x())||void 0===P?void 0:P.c4b();if((new DG(b,h.node,ca,new uH,y())).resize(v,D))return}oe.ImageReader.wy(b)?(b=ub.a.create(),P=new eh.GraphTransaction(15),P.Cb(h.node),this.Std.WNn(h,oe.ImageReader.Ym(h),v,D,b),P.ZFa(b,1),P.dispose()):oe.ImageReader.Ujc(b)?(new sH.a(b,new tH.a)).qno(v,D,this.Ztn,h):(super.dgf(b,h,v,D),this.Ld.Ns(13))}cO(b){if(!b.hl)return!1;var h=b.node;return(h=Xa.App.instance&&Xa.App.instance.CHb?h instanceof po.a||h instanceof RM.a?h:null:Object(Na.a)(po.a,h))&&Sw.n(h)?
(dt.Jc.Yb(NM.a.fn,{["Reason"]:OM.a.hO}),!1):super.cO(b)}static WDn(b){b&&!fr.ewb&&(fr.Jh.eZa(fr.emb),fr.ewb=!0)}PNn(b,h,v,D,P){return P?(P.wyi=b,P.I8=h,P.jQb=v,P.vw=D,P.E8a=fr.xkm(P),!0):!1}$xi(b){b=oe.ImageReader.Ui(b);const h=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditsWithGC2",!1);return Xa.App.instance&&Xa.App.instance.h4(b)?(w.AFrameworkApplication.ue("editswithgc2;editswithgc2cf"),h):!1}nYc(b){Xa.App.rd.Qo&&Xa.App.rd.Tp.VF(b.node)}n9m(){this.X5g||(u.ULS.sendTraceTag(20459971,
322,50,"Wrap Text UI enabled."),this.X5g=!0)}PDb(b){const h=QM.a.instance.Vif(b);this.qK.ahe(b,h[0],h[1],h[2],h[3])}Zxa(b,h,v,D,P){2===v&&(b=oe.ImageReader.Ym(h),this.Ho.mTj(P,b));return 32}wMb(b,h,v,D,P){2===v&&(b=oe.ImageReader.Ym(h),this.Ho.lTj(P,b));return 32}Gdd(){w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$("PictureBorderFloodgateSurveyIsEnabled")&&window.setTimeout(()=>{const b=Ea.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("PictureBorderApplied",
"PictureBorderFloodgateSurveyIsEnabled")})},5E3)}static get x7a(){return null!=fr.iIg?fr.iIg:fr.iIg=rq.a.instance}static get c2i(){fr.FV||(fr.FV=new HA.a("PictureBorder"),fr.$Ea(fr.FV));return fr.FV}static xkm(b){if(b.wyi)b=1;else switch(b.jQb){case 2:b=b.I8?3:4;break;case 1:b=1===b.vw?8:3===b.vw?9:2;break;case 0:b=5;break;case 3:b=6;break;case 4:b=7;break;default:b=0}return b}static $Ea(b){b.LW(3,Gb.a.T9);b.LW(4,Gb.a.T9);b.LW(5,Gb.a.A7c);b.LW(6,Gb.a.T9);b.ozb(xr.a.instance,1)}get OVc(){null==this.MAa&&
(w.AFrameworkApplication.ue("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.MAa=w.AFrameworkApplication.K?w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.MAa}}fr.ewb=!1;fr.FV=null;fr.I9a=null;fr.emb=()=>{fr.Jh.yhc(fr.emb);fr.ewb=!1;if(Rh.c()){var b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}else u.ULS.sendTraceTag(509445760,
322,50,"appChrome is undefined")};Object(n.a)(fr,"ImageActor",dt,[]);class jn{static get paragraphEditor(){return null!=jn.AFg?jn.AFg:jn.AFg=Ea.a.instance.resolve("Box4.IParagraphEditor")}static get OA(){return null!=jn.LFg?jn.LFg:jn.LFg=Ea.a.instance.resolve("Box4.IParagraphIndentationReader")}static get F0(){return jn.paragraphEditor.jq}static get Pg(){return null!=jn.kJg?jn.kJg:jn.kJg=Ea.a.instance.resolve("Box4.IUndoManager")}static Tb(){const b=w.AFrameworkApplication.va;b.qa(Gb.a.gMb,sc.a.view,
Gn.a.gw);b.qa(Gb.a.gMb,sc.a.paragraph,jn.Wla);b.Vc(Gb.a.gMb,1036);b.qa(Gb.a.lCb,sc.a.view,Gn.a.gw);b.qa(Gb.a.lCb,sc.a.paragraph,jn.Wla);b.Vc(Gb.a.lCb,1036);b.qa(Gb.a.Nfb,sc.a.view,Gn.a.gw);b.qa(Gb.a.Nfb,sc.a.paragraph,jn.Wla);b.Vc(Gb.a.Nfb,1036);b.qa(Gb.a.thc,sc.a.view,Gn.a.gw);b.qa(Gb.a.thc,sc.a.paragraph,jn.Wla);b.Vc(Gb.a.thc,1036);b.qa(Gb.a.B4c,sc.a.view,Gn.a.gw);b.qa(Gb.a.B4c,sc.a.paragraph,jn.Wla);b.Vc(Gb.a.B4c,1036);b.qa(Gb.a.j2a,sc.a.view,Gn.a.gw);b.qa(Gb.a.j2a,sc.a.paragraph,jn.Wla);b.Vc(Gb.a.j2a,
1036);b.qa(Gb.a.bjb,sc.a.view,Gn.a.gw);b.qa(Gb.a.bjb,sc.a.paragraph,jn.Wla);b.Vc(Gb.a.bjb,1036);b.qa(Gb.a.i2a,sc.a.view,Gn.a.gw);b.qa(Gb.a.i2a,sc.a.paragraph,jn.Wla);b.Vc(Gb.a.i2a,1036);b.qa(Gb.a.ehe,sc.a.view,jn.$je);b.qa(Gb.a.ehe,sc.a.paragraph,jn.$je);b.Vc(Gb.a.ehe,1028);b.qa(Gb.a.gbg,sc.a.view,jn.$je);b.qa(Gb.a.gbg,sc.a.paragraph,jn.$je);b.Vc(Gb.a.gbg,1028);b.qa(Gb.a.COb,sc.a.view,Gn.a.gw);b.qa(Gb.a.COb,sc.a.paragraph,jn.Wla);b.Vc(Gb.a.COb,1036);b.qa(Gb.a.Gob,sc.a.view,Gn.a.gw);b.qa(Gb.a.Gob,
sc.a.paragraph,jn.Wla);b.Vc(Gb.a.Gob,1036);b.qa(Gb.a.DOb,sc.a.view,Gn.a.gw);b.qa(Gb.a.DOb,sc.a.paragraph,jn.Wla);b.Vc(Gb.a.DOb,1036);b.qa(Gb.a.Pfg,sc.a.view,Gn.a.gw);b.Vc(Gb.a.Pfg,1028);b.qa(Gb.a.J7c,sc.a.view,Gn.a.gw);b.qa(Gb.a.J7c,sc.a.paragraph,jn.Wla);b.Vc(Gb.a.J7c,1036);b.qa(Gb.a.K7c,sc.a.view,Gn.a.gw);b.qa(Gb.a.K7c,sc.a.paragraph,jn.Wla);b.Vc(Gb.a.K7c,1036)}static $je(b,h,v,D,P){2===v&&""===P[mj.a.Text]&&(b=b===Gb.a.ehe?Gb.a.j2a:Gb.a.i2a,h=new ID.a,h.value=0,h.unit=Xa.App.yFa?2:1,w.AFrameworkApplication.va.Qb(b,
2,h),Xa.App.xa.updateCommandUI());return 32}static Wla(b,h,v,D,P){if(!({ly:v}=Gn.a.pdg(v,h)).returnValue)return v;h=h.node;switch(b){case Gb.a.gMb:jn.F0.e1f(h,!0);break;case Gb.a.lCb:jn.F0.e1f(h,!1);break;case Gb.a.Nfb:jn.F0.Nfb(h);break;case Gb.a.thc:jn.F0.lda(h,0);break;case Gb.a.B4c:jn.F0.vob(h,0);break;case Gb.a.bjb:case Gb.a.j2a:v=new he.GraphIterator;v.set(h);v.zb(11);let ca=P.value;P=P.unit;b===Gb.a.bjb&&(ca=(new pn.a(P,ca)).Ot+jn.OA.xG(h).Ot,P=1);jn.F0.Fya(v,P,ca);break;case Gb.a.i2a:jn.F0.qOb(h,
P.unit,P.value);break;case Gb.a.COb:P?(b=(new pn.a(P.unit,P.value)).Ot,jn.F0.lda(h,b)):jn.OA.KPd(h).Ot||jn.F0.lda(h,Ei.OutlineReader.vX(h));break;case Gb.a.Gob:P?(b=(new pn.a(P.unit,P.value)).Ot,jn.F0.vob(h,b)):jn.OA.xG(h).Ot||jn.F0.vob(h,Ei.OutlineReader.vX(h));break;case Gb.a.DOb:jn.F0.lda(h,0);break;case Gb.a.J7c:b=P;b=(new pn.a(b.unit,b.value)).Ot;jn.F0.Wbg(h,1,b);break;case Gb.a.K7c:b=P,b=(new pn.a(b.unit,b.value)).Ot,jn.F0.Wbg(h,2,b)}jn.Pg.kF();D&&Hr.a.Qpb&&(D.xs|=Hr.a.zhb(h));return 32}}Object(n.a)(jn,
"IndentationActor",null,[]);var tK=c(380),SM=c(64),FG=c(417),TM=c(1200);class Or{constructor(b){this.pXa=this.WBa=this.fyc=null;this.Jlh=!1;this.Bae=h=>{if(this.WBa)if(h===Wa.a.Aae)bd.FocusManager.instance().getRegion(Ne.AFrame.m5a).jec();else if(h===Wa.a.zae)bd.FocusManager.instance().getRegion(Ne.AFrame.m5a).hec();else return 2;else return 2;return 32};this._frame=b}BDo(){if(this.Jlh)this.TFi();else{const b=Ua.a.create(w.AFrameworkApplication.K.jb("WopiBootstrapUrl"));b.VZ((h,v)=>{v.succeeded?(this.Jlh=
!0,this.TFi()):u.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});kb.a.pX(b)}}TFi(){if(this.fyc)u.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.jra;this.WBa=document.createElement("div");b.parentNode.insertBefore(this.WBa,b);this.pXa=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:w.AFrameworkApplication.K.jb("FileName"),reactRoot:this.WBa});this.pXa.setWebpackPublicPath(w.AFrameworkApplication.w5);
this.pXa.renderDocumentPanel()}}f1l(b){const h={};h.Container=b;h.BootstrapperUrl=w.AFrameworkApplication.K.jb("WopiBootstrapUrl");h.ApplicationUrl=this._frame.Kqb;b={};b.HostName=w.AFrameworkApplication.K.jb("FileSource");b.HostSessionId=w.AFrameworkApplication.K.jb("HostSessionId");b.UserId=w.AFrameworkApplication.K.jb("UserId");b.DocumentClickTime=new Date(this._frame.zlb);b.SessionContext="";b.WdParams={};h.SessionInformation=b;b={};b.FileName=w.AFrameworkApplication.K.jb("FileName");b.FileGetUrl=
"";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,Url:""};h.WopiPrecheckInfo=b;h.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};b.userClickTime=this._frame.zlb;h.Diagnostics=b;b={};b.WopiSrc=w.AFrameworkApplication.K.jb("WopiSrc");b.AccessToken=w.AFrameworkApplication.K.jb("AccessToken");b.AccessTokenTtl=w.AFrameworkApplication.K.jb("AccessTokenTtl");h.WopiInfo=b;h.FnOnInitializeSuccess=
v=>{Or.HW=v;this.pXa.setMaxPage(Or.HW.GetPageCount());this.pXa.setCurrentPage(Or.HW.GetCurrentPage());this.pXa.setPageControlVisible(!0);Or.HW.RegisterEventHandler("PageChanged",D=>{this.pXa.setCurrentPage(D.newPage)});Or.HW.RegisterEventHandler("BrowserEvent",D=>{27===D.keyCode?this.closeViewer():D.button&&1!==D.button||this.WBa.click()});v=this._frame.zlb-(new Date).getTime();u.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",v);this.Tb();bd.FocusManager.instance().pL(Ne.AFrame.m5a,
!0);this.buildFocusRegion();this.$Ga(bd.FocusManager.instance().fe(Ne.AFrame.m5a));this.WBa.click()};h.FnOnInitializeFailure=(v,D)=>{u.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",v.toString(),D.toString());this.closeViewer()};return h}buildFocusRegion(){const b=bd.FocusManager.instance();var h=b.getRegion(Ne.AFrame.m5a);h=[2,3];const v=b.fe(Ne.AFrame.m5a),D=new Ee.DOMFocusListing(()=>this.WBa);D.Zpa=!0;for(const P of h)D.Wm(P);h=b.hma(()=>this.WBa,v,D);h.vSa();h.oR=!0;h.f_a=!0;D.Ly(D.zga)}Tb(){w.AFrameworkApplication.va.qa(Wa.a.Aae,
ud.a.frame,this.Bae);w.AFrameworkApplication.va.qa(Wa.a.zae,ud.a.frame,this.Bae)}$Ga(b){b.jr(bd.FocusManager.instance().uW);b.jr(bd.FocusManager.instance().vW);b.bindAction(bd.FocusManager.instance().uW,Wa.a.Aae);b.bindAction(bd.FocusManager.instance().vW,Wa.a.zae)}loadViewer(b){b=this.f1l(b);this.fyc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);this.fyc.Complete(b.WopiInfo)}closeViewer(){bd.FocusManager.instance().CR(Ne.AFrame.m5a);Or.HW&&(Or.HW.Dispose(),Or.HW=null,w.AFrameworkApplication.va.Sv(Wa.a.Aae,
ud.a.frame,this.Bae),w.AFrameworkApplication.va.Sv(Wa.a.zae,ud.a.frame,this.Bae));this.fyc&&(this.WBa.parentNode.removeChild(this.WBa),this.WBa=this.fyc=null)}printAction(){u.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");w.AFrameworkApplication.va.processAction(Gb.a.print,2)}downloadPdfAction(){u.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");w.AFrameworkApplication.va.processAction(Nc.a.vKc,2)}downloadCopyAction(){u.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");
w.AFrameworkApplication.va.processAction(Wa.a.downloadACopy,2)}zoomInAction(){if(Or.HW){let b=Or.HW.GetZoomLevel();b+=.2;Or.HW.SetZoomLevel(b)}}zoomOutAction(){if(Or.HW){let b=Or.HW.GetZoomLevel();b-=.2;Or.HW.SetZoomLevel(b)}}setPage(b){if(Or.HW){const h=Or.HW.GetPageCount();1>b?(Or.HW.SetCurrentPage(1),this.pXa.setCurrentPage(1)):1<=b&&b<=h?Or.HW.SetCurrentPage(b):(Or.HW.SetCurrentPage(h),this.pXa.setCurrentPage(h))}}static getInstance(b){Or.LOe||(Or.LOe=new Or(b));return Or.LOe}}Or.HW=null;Or.LOe=
null;Object(n.a)(Or,"PreviewPanelActor",null,[]);class Up{static get vKj(){return null!=Up.GJg?Up.GJg:Up.GJg=w.AFrameworkApplication.K.jb("ClassicViewModePreferenceCookieName")}static Tb(b,h){b.eb(Gb.a.readingMode,ud.a.frame,Up.RLj,128);b.qa(Gb.a.ble,ud.a.frame,Up.RLj);Up.yI=h;b.qa(Nc.a.wXc,ud.a.frame,Up.wXc);b.qa(Nc.a.yXc,ud.a.frame,Up.yXc);b.qa(Nc.a.kge,ud.a.frame,Up.kge);b.eb(Nc.a.m3c,ud.a.frame,Up.m3c,96);b.eb(Nc.a.A3c,ud.a.frame,Up.A3c,96);b.eb(Nc.a.Vbe,ud.a.frame,Up.Vbe,96)}static RLj(b,h,v){if(h.contextId!==
ud.a.frame)return 2;h=Jl.App.sn;switch(b){case Gb.a.readingMode:if(!h.Kqb)return 8;if(1===v)return bc.SessionStatusManager.instance.Gj?8:32;b=(new Date).getTime();zi.a.instance.nUn(b);h.zlb=b;w.AFrameworkApplication.K.$("InAppDocumentPreviewIsEnabled")?cw.a.NQ(3,!0,Up.FHn,null,h):cw.a.NQ(3,!0,Up.HQi,null,h);return 32;case Gb.a.ble:return 32;default:return 2}}static HQi(b){FG.a()?Up.ajm(b):Up.Fxj(b)}static ajm(b){const h={};h[H.a.wyf]=Up.vKj;w.AFrameworkApplication.MO().execute(v=>{v.Dv(L.a.xyf);v.KSo(L.a.xyf);
v.TB(L.a.xyf,D=>{Up.YVk(D,b)});v.sendMessage(L.a.m_l,h)})}static YVk(b,h){b.Values[H.a.wyf]===Up.vKj&&("true"===b.Values[H.a.Roi]?Up.Fxj(h):(Up.$Vo(),Up.UGo()))}static $Vo(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};w.AFrameworkApplication.ue("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):
appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static UGo(){w.AFrameworkApplication.nv=!0;Xa.App.xa.d$(1);Xa.App.xa.ib.yu&&Xa.App.xa.ib.yu.Wi&&Xa.App.xa.ib.yu.jAf();w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&Xa.App.xa.updateCommandUI();TM.PageView.HBj(w.AFrameworkApplication.K)}static Fxj(b){try{const h=new ac.a;let v,D;w.AFrameworkApplication.PKj?(v=Xa.App.hostUrl,D=3):(v=b.Kqb,D=1);b.zlb&&h.add(w.AFrameworkApplication.KNf,
b.zlb.toString());w.AFrameworkApplication.ACf&&h.add(w.AFrameworkApplication.C$e,"1");w.AFrameworkApplication.q6e&&h.add(w.AFrameworkApplication.o5k,"1");h.add(tK.a.mog,tK.a.userSessionData);h.add(w.AFrameworkApplication.Dae,w.AFrameworkApplication.userSessionId);const P=w.AFrameworkApplication.K.jb(w.AFrameworkApplication.yja);P&&h.add(w.AFrameworkApplication.WDj,P);u.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");FG.b(w.AFrameworkApplication.K)?FG.d("view",h,FG.c):(v=ia.a.Roh(v,h),
w.AFrameworkApplication.PKj?Dd.a.om(v,Dd.a.kra(D),void 0,"AuthenticationLostDuringSession"):Dd.a.openWindow(D,v,!1,void 0,SM.a.ccj))}catch(h){}}static FHn(b){u.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Ea.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Uz.loadScript("previewPanel")).catch(()=>{u.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");Up.HQi(b)}).then(()=>
{Or.getInstance(b).BDo()})}static wXc(b,h,v){if(1===v)return 32;Up.yI.Eag(1);Xa.App.xa.updateCommandUI();return 32}static yXc(b,h,v){if(1===v)return 32;Up.yI.Eag(0);Xa.App.xa.updateCommandUI();return 32}static kge(b,h,v){if(1===v)return 32;Up.yI.Eag(1===Up.yI.fu?0:1);Xa.App.xa.updateCommandUI();return 32}static Vbe(b,h,v,D,P){if(1===v)return 32;P[If.a.On]=1===Up.yI.fu;return 32}static m3c(b,h,v,D,P){if(1===v)return 32;P[If.a.On]=1===Up.yI.fu;return 32}static A3c(b,h,v,D,P){if(1===v)return 32;P[If.a.On]=
!Up.yI.fu;return 32}}Up.yI=null;Object(n.a)(Up,"MainViewModeActor",null,[]);class uK{constructor(b,h,v){this.san=(D,P,ca,ta,Ra)=>1===ca?32:(D=this.Sk.v8(P.gk))?(Ra=3===Ra.Kx,this.l6.value.nMh(this.y$l(D),this.BFb(D),Ra),32):2;this.ga=b;this.l6=h;this.Sk=v}Tb(){this.ga.qa(Nc.a.WIf,sc.a.view,this.san);this.ga.eb(Nc.a.xbe,sc.a.view,Ok.d,96);this.ga.eb(Nc.a.ube,sc.a.view,Ok.d,96);this.ga.eb(Nc.a.vbe,sc.a.view,Ok.d,96);this.ga.eb(Nc.a.wbe,sc.a.view,Ok.d,96);this.ga.qa(Nc.a.C0c,sc.a.view,Ok.c);this.ga.qa(Nc.a.B0c,
sc.a.view,Ok.c);this.ga.qa(Nc.a.e9d,sc.a.view,Ok.c);this.ga.qa(Nc.a.f9d,sc.a.view,Ok.c)}y$l(b){const h=new Md.DictionaryPropertySet;h.setValue(Bc.a.marginTop,this.Sk.Fna(b));h.setValue(Bc.a.marginBottom,this.Sk.Nva(b));h.setValue(Bc.a.marginLeft,this.Sk.nJ(b));h.setValue(Bc.a.marginRight,this.Sk.$K(b));return h}BFb(b){const h=new Md.DictionaryPropertySet;h.setValue(Bc.a.Ao,this.Sk.At(b));h.setValue(Bc.a.qv,this.Sk.xB(b));return h}}Object(n.a)(uK,"MarginsDialogActor",null,[]);class vK{constructor(b,
h,v,D){this.ga=b;this.$c=h;this.JLa=v;this.J0j=D;this.xwd={Resume:["Contact","Objective","Experience","Skills and Abilities","Education"],dRj:["Summary","Updates","Challenges","Opportunities","What's Next"],rTj:["Highlights","Itinerary","Food","Activities"],sPj:["Introduction","Step 1","Step 2","Step 3"]}}Tb(){this.ga.eb(Nc.a.kPi,sc.a.Tc,this.RFk.bind(this),1028);this.ga.eb(Nc.a.HNf,sc.a.Tc,this.LEc.bind(this),1028);this.ga.eb(Nc.a.FNf,sc.a.Tc,this.LEc.bind(this),1028);this.ga.eb(Nc.a.ENf,sc.a.Tc,
this.LEc.bind(this),1028);this.ga.eb(Nc.a.INf,sc.a.Tc,this.LEc.bind(this),1028);this.ga.eb(Nc.a.GNf,sc.a.Tc,this.LEc.bind(this),1028)}RFk(){return null===this.$c.instance?2:32}LEc(b,h,v){var D;if(1===v){if(null===(D=w.AFrameworkApplication.K)||void 0===D?0:D.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",!1))return 32}else if(2===v){switch(b){case Nc.a.HNf:this.YWd(this.xwd.Resume);break;case Nc.a.FNf:this.YWd(this.xwd.dRj);break;case Nc.a.INf:this.YWd(this.xwd.rTj);
break;case Nc.a.ENf:this.YWd(this.xwd.sPj);break;case Nc.a.GNf:this.J0j.l6b(P=>{P.QHa("WordMiniTemplateSurvey",null)})}return 32}return 2}YWd(b){const h=new eh.GraphTransaction(15);try{const v=Xa.App.xa.ib.rc.Yc;let D=v,P;for(P=Ka.a.Zo(v);P.moveNext();){const ta=P.currentNode;if(fe.ParagraphReader.AUc(ta)&&fe.ParagraphReader.Wb(ta)){D=ta;break}}h.Cb(D);const ca=this.$c.instance.YDc(b,D,!0).toArray();this.FIl(ca)}finally{h.dispose()}}FIl(b){for(const h of b)this.JLa.instance.Oaa(h.node,4)}}Object(n.a)(vK,
"MiniTemplateActor",null,[]);class vH{constructor(b){this.T$c=(h,v,D)=>{if(1===D)return 32;h=w.AFrameworkApplication.ta;if(!h)return 32;h.LBd();vH.bbo(h);return 32};this.ga=b}Tb(){this.ga.qa(Nc.a.T$c,sc.a.view,this.T$c)}static bbo(b){const h=w.AFrameworkApplication.K.jb("ModernUxExperimentPreferenceCookieName");var v=w.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");v=$b.a.Dba(h,!v);$b.a.oTa(h,(!v).toString(),$b.a.mRa);v?u.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):
u.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");Xe.d(Nc.a.T$c,!0,void 0,void 0,void 0,void 0,[Object.assign(new na.a,{name:"ModernUxExperimentPreference",string:(!v).toString()})]);b.refreshDocument(null)}}Object(n.a)(vH,"ModernUxActor",null,[]);var UM=c(1064),et=c(1707);class wK{constructor(b,h,v,D){this.Nje=Df.a.Kv(1)/6;this.Xmo=(P,ca,ta,Ra,mb)=>{if(1===ta)return 32;if(ta=this.Sf.v8(ca.gk)){if(0<=mb&&mb<et.a.K0.length){ca=new eh.GraphTransaction(15);ca.Cb(ta);
ca.jk=P;P=et.a.K0[mb].Avb;Ra=et.a.K0[mb].yvb;const Jb=et.a.K0[mb]._marginLeft;mb=et.a.K0[mb].zvb;this.J9d(P,Ra,this.Sf.xB(ta))&&this.J9d(Jb,mb,this.Sf.At(ta))?(this.DE.F6a(ta,P),this.DE.D6a(ta,Ra),this.DE.Via(ta,Jb),this.DE.E6a(ta,mb),this.Sd.Ns(11)):this.BHa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);ca.dispose()}else return 2;return 32}u.ULS.sendTraceTag(520618525,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.gk);return 2};this.Ymo=(P,ca,ta,Ra,mb)=>{if(1===ta)return 32;if(ta=
this.Sf.v8(ca.gk)){if(0<=mb&&mb<et.a.Ppa.length)ca=new eh.GraphTransaction(15),ca.Cb(ta),ca.jk=P,P=(Ra=this.Sf.RUc(ta))?et.a.Ppa[mb].Nsa:et.a.Ppa[mb].ILa,mb=Ra?et.a.Ppa[mb].ILa:et.a.Ppa[mb].Nsa,this.J9d(this.Sf.Nva(ta),this.Sf.Fna(ta),mb)&&this.J9d(this.Sf.nJ(ta),this.Sf.$K(ta),P)?(this.DE.Bbg(ta,P),this.DE.Abg(ta,mb),this.Sd.Ns(11)):this.BHa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),ca.dispose();else return 2;return 32}u.ULS.sendTraceTag(520618524,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ca.gk);return 2};this.smo=(P,ca,ta,Ra,mb)=>{if(1===ta)return 32;if(ta=this.Sf.v8(ca.gk)){ca=this.Sf.RUc(ta);Ra=new eh.GraphTransaction(15);Ra.Cb(ta);Ra.jk=P;this.DE.mmj(ta,mb);if(mb&&!ca||!mb&&ca){P=this.Sf.At(ta);mb=this.Sf.xB(ta);this.DE.Bbg(ta,mb);this.DE.Abg(ta,P);P=this.Sf.Fna(ta);mb=this.Sf.Nva(ta);const Jb=this.Sf.nJ(ta),Ub=this.Sf.$K(ta);ca?(this.DE.F6a(ta,w.AFrameworkApplication.isRtl?Jb:Ub),this.DE.D6a(ta,w.AFrameworkApplication.isRtl?Ub:Jb),this.DE.Via(ta,w.AFrameworkApplication.isRtl?
mb:P),this.DE.E6a(ta,w.AFrameworkApplication.isRtl?P:mb)):(this.DE.F6a(ta,w.AFrameworkApplication.isRtl?Ub:Jb),this.DE.D6a(ta,w.AFrameworkApplication.isRtl?Jb:Ub),this.DE.Via(ta,w.AFrameworkApplication.isRtl?Math.abs(P):mb),this.DE.E6a(ta,w.AFrameworkApplication.isRtl?mb:P));this.Sd.Ns(11)}Ra.dispose();return 32}u.ULS.sendTraceTag(520618523,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.gk);return 2};this.oYd=(P,ca,ta)=>{if(1===ta)return 1===this.HS.fu?32:8};this.rob=(P,ca,ta,Ra,
mb)=>{if(1===ta)return 32;ta=this.Sf.v8(ca.gk);if(!ta)return u.ULS.sendTraceTag(520618522,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.gk),2;ca=new eh.GraphTransaction(15);ca.Cb(ta);ca.jk=P;P=Math.floor(this.Sf.At(ta)/720);if(0>mb||mb>P)return 2;this.DE.jOb(ta,mb);this.Ujd.execute(Jb=>{Jb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.Dge=(P,ca,ta,Ra,mb)=>{if(1===ta)return 32;ta=this.Sf.v8(ca.gk);if(!ta)return u.ULS.sendTraceTag(520618521,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ca.gk),2;ca=new eh.GraphTransaction(15);ca.Cb(ta);ca.jk=P;P=mb[0];Ra=this.Sf.At(ta);if(720>P||P>Ra)return 2;this.DE.ejc(ta,mb);this.Ujd.execute(Jb=>{Jb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.Cge=(P,ca,ta,Ra,mb)=>{if(1===ta)return 32;ta=this.Sf.v8(ca.gk);if(!ta)return u.ULS.sendTraceTag(520618520,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.gk),2;ca=new eh.GraphTransaction(15);ca.Cb(ta);ca.jk=P;P=this.Sf.At(ta);Ra=this.Sf.Zg(ta);if(0>mb||mb>(P-
720*Ra)/(Ra-1))return 2;this.DE.Uho(ta,mb);this.Ujd.execute(Jb=>{Jb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.Bge=(P,ca,ta,Ra,mb)=>{if(1===ta)return 32;ta=this.Sf.v8(ca.gk);if(!ta)return u.ULS.sendTraceTag(512370310,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.gk),2;ca=new eh.GraphTransaction(15);ca.Cb(ta);ca.jk=P;if(null==mb)return 2;this.DE.loo(ta,mb);this.Ujd.execute(Jb=>{Jb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};
this.SGa=(P,ca,ta,Ra,mb)=>{if(P=this.Sf.v8(ca.gk))return mb.marginTop=this.Sf.Fna(P),mb.marginBottom=this.Sf.Nva(P),mb.marginLeft=this.Sf.nJ(P),mb.marginRight=this.Sf.$K(P),mb.Ao=this.Sf.At(P),mb.qv=this.Sf.xB(P),mb.Hwa=this.Sf.RUc(P),mb.UE=this.Sf.Zg(P),mb.sma=this.Sf.yhb(P),mb.r1k=this.Sf.qSd(P),mb.GJb=this.B3l(mb),mb.kLb=this.D7l(mb),mb.gHc=this.vRl(mb),32;u.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.gk);return 2};this.the=(P,ca,ta,Ra,mb)=>{if(1===
ta)return 32;if(ta=this.Sf.v8(ca.gk)){ca=new eh.GraphTransaction(15);ca.Cb(ta);switch(P){case Gb.a.F6a:this.DE.F6a(ta,mb);break;case Gb.a.D6a:this.DE.D6a(ta,mb);break;case Gb.a.Via:this.DE.Via(ta,mb);break;case Gb.a.E6a:this.DE.E6a(ta,mb)}this.Sd.Ns(11);ca.dispose();return 32}u.ULS.sendTraceTag(520618518,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.gk);return 2};this.Tmj=(P,ca,ta,Ra,mb)=>{if(1===ta)return 32;if(ta=this.Sf.v8(ca.gk)){ca=new eh.GraphTransaction(15);ca.Cb(ta);let Jb=
Ra=0;switch(P){case Gb.a.Dbg:Jb=mb;this.DE.Bbg(ta,Jb);Ra=this.Sf.xB(ta);break;case Gb.a.Cbg:Ra=mb,this.DE.Abg(ta,Ra),Jb=this.Sf.At(ta)}this.DE.mmj(ta,Ra<Jb);this.Sd.Ns(11);ca.dispose();return 32}u.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.gk);return 2};this.DE=b;this.Sd=h;this.HS=v;this.Ujd=D}get Sf(){return Xm.a.instance}C3l(b){var h=Xa.App.MEf,v=h?1:3,D=w.AFrameworkApplication.numberFormat;let P=et.a.K0[b].Avb;var ca=et.a.K0[b].yvb;var ta=et.a.K0[b]._marginLeft;
b=et.a.K0[b].zvb;P=h?Df.a.hUa(P):Df.a.Nz(P);ca=h?Df.a.hUa(ca):Df.a.Nz(ca);ta=h?Df.a.hUa(ta):Df.a.Nz(ta);b=h?Df.a.hUa(b):Df.a.Nz(b);h=G.a.eEa(P,v,D);ca=G.a.eEa(ca,v,D);ta=G.a.eEa(ta,v,D);v=G.a.eEa(b,v,D);D={};D.top=h;D.bottom=ca;D.left=ta;D.right=v;return D}qan(b){const h=WordRibbonStrings.PageMarginsTop,v=WordRibbonStrings.PageMarginsBottom,D=WordRibbonStrings.PageMarginsLeft,P=WordRibbonStrings.PageMarginsRight;b=this.C3l(b);return[[h,b.top,v,b.bottom],[D,b.left,P,b.right]]}a1c(b){var h=Xa.App.MEf,
v=h?1:3;const D=w.AFrameworkApplication.numberFormat;let P=et.a.Ppa[b].Nsa;b=et.a.Ppa[b].ILa;P=h?Df.a.hUa(P):Df.a.Nz(P);b=h?Df.a.hUa(b):Df.a.Nz(b);h=G.a.eEa(b,v,D);v=G.a.eEa(P,v,D);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,h,v)}Tb(){const b=w.AFrameworkApplication.va;b.eb(Gb.a.G6a,sc.a.view,this.Xmo,4);b.eb(Gb.a.iTa,sc.a.view,this.Ymo,4);b.eb(Gb.a.setOrientation,sc.a.view,this.smo,4);b.eb(Gb.a.SGa,sc.a.view,this.SGa,96);b.qa(Gb.a.F6a,sc.a.view,this.the);b.qa(Gb.a.D6a,sc.a.view,
this.the);b.qa(Gb.a.Via,sc.a.view,this.the);b.qa(Gb.a.E6a,sc.a.view,this.the);b.qa(Gb.a.Dbg,sc.a.view,this.Tmj);b.qa(Gb.a.Cbg,sc.a.view,this.Tmj);b.eb(Gb.a.oYd,sc.a.view,this.oYd,4);b.qa(Gb.a.rob,sc.a.view,this.rob);b.qa(Gb.a.Dge,sc.a.view,this.Dge);b.qa(Gb.a.Cge,sc.a.view,this.Cge);b.qa(Gb.a.Bge,sc.a.view,this.Bge)}J9d(b,h,v){return v>=b+h+Xa.App.wza}B3l(b){let h=5;for(let v=0;v<et.a.K0.length;v++)if(et.a.K0[v].Avb===b.marginTop&&et.a.K0[v].yvb===b.marginBottom&&et.a.K0[v]._marginLeft===b.marginLeft&&
et.a.K0[v].zvb===b.marginRight){h=v;break}return h}D7l(b){let h=5;b=new UM.a(Math.min(b.Ao,b.qv),Math.max(b.Ao,b.qv));for(let v=0;v<et.a.Ppa.length;v++)if(this.aAn(b,et.a.Ppa[v])){h=v;break}return h}vRl(b){let h=0;switch(b.UE){case 1:h=1;break;case 2:h=2;break;case 3:h=3}return h}aAn(b,h){return se.a.cvi(b.ILa,Math.max(h.ILa-this.Nje,0),h.ILa+this.Nje)&&se.a.cvi(b.Nsa,Math.max(h.Nsa-this.Nje,0),h.Nsa+this.Nje)}BHa(b){if(!pl.a.mM){const h=new ug.StandardDialog;h.Ad=0;h.cV(CommonUIStrings.l_DefaultDialogTitle,
b,null)}}}Object(n.a)(wK,"PageActor",null,[368]);class xK{constructor(b){this.ga=b}get pc(){return this.ga}she(b,h){let v=0;b?1===b?v=Gb.a.Via:2===b?v=Gb.a.E6a:3===b&&(v=Gb.a.D6a):v=Gb.a.F6a;this.pc.Qb(v,2,h)}iTa(b,h){let v=0;1===b?v=Gb.a.Cbg:b||(v=Gb.a.Dbg);this.pc.Qb(v,2,h)}zge(b,h){let v=0;switch(b){case 0:v=Gb.a.rob;break;case 1:v=Gb.a.Dge;break;case 2:v=Gb.a.Cge;break;case 3:v=Gb.a.Bge}this.pc.Qb(v,2,h)}}Object(n.a)(xK,"PageCommands",null,[366]);class yK{constructor(b,h,v){this.$zn=(D,P,ca,ta,
Ra)=>1===ca?32:(D=this.Sk.v8(P.gk))?(Ra=3===Ra.Kx,this.l6.value.SMh(this.z$l(D),this.BFb(D),Ra),32):2;this.ga=b;this.l6=h;this.Sk=v}Tb(){this.ga.qa(Nc.a.YIf,sc.a.view,this.$zn);this.ga.eb(Nc.a.Mbe,sc.a.view,Ok.d,96);this.ga.eb(Nc.a.Lbe,sc.a.view,Ok.d,96);this.ga.qa(Nc.a.i9d,sc.a.view,Ok.c);this.ga.qa(Nc.a.h9d,sc.a.view,Ok.c)}z$l(b){const h=new Md.DictionaryPropertySet;h.setValue(Bc.a.Ao,this.Sk.At(b));h.setValue(Bc.a.qv,this.Sk.xB(b));return h}BFb(b){const h=new Md.DictionaryPropertySet;h.setValue(Bc.a.marginTop,
Math.abs(this.Sk.Fna(b)));h.setValue(Bc.a.marginBottom,Math.abs(this.Sk.Nva(b)));h.setValue(Bc.a.marginLeft,this.Sk.nJ(b));h.setValue(Bc.a.marginRight,this.Sk.$K(b));return h}}Object(n.a)(yK,"PaperSizeDialogActor",null,[]);class TE{constructor(b,h,v){this.ga=b;this.l6=h;this.$V=v}Tb(){this.ga.eb(Gb.a.Tcc,sc.a.view,this.NAn.bind(this),1028);this.ga.qa(Gb.a.Tcc,sc.a.paragraph,this.LAn.bind(this));this.ga.eb(Gb.a.vNn,sc.a.view,Ok.d,96);this.ga.eb(Gb.a.wNn,sc.a.view,Ok.d,96);this.ga.eb(Gb.a.DMn,sc.a.view,
Ok.d,96);this.ga.eb(Gb.a.EMn,sc.a.view,Ok.d,96);this.ga.eb(Gb.a.QBo,sc.a.view,Ok.c,96);this.ga.eb(Gb.a.PBo,sc.a.view,Ok.c,96);this.ga.eb(Gb.a.hyn,sc.a.view,Ok.c,96);this.ga.eb(Gb.a.iyn,sc.a.view,Ok.c,96);this.ga.eb(Gb.a.Uxn,sc.a.view,Ok.c,96);this.ga.eb(Gb.a.OBo,sc.a.view,Ok.c,96);this.ga.eb(Gb.a.Vxn,sc.a.view,Ok.c,96)}LAn(b,h,v,D,P){if(1===v)return 3===this.ga.mode||2===this.ga.mode?32:8;b=h.node;h=this.TCj(h);P=3===P.Kx;this.l6.value.iHd(this.DPc(b),this.BFb(h),P);return 32}NAn(b,h,v,D,P){b=h.view.lb;
if(!b||TE.Wf.tac(b.tg))return 8;if(TE.Xg.sza(fe.ParagraphReader.kU,b.tg))return TE.Jc.Yb(qe.a.kf,{["Reason"]:me.a.hO}),8;if(1===v)return 3===this.ga.mode||2===this.ga.mode?32:8;v=b.gb.kb;h=this.TCj(h);P=3===P.Kx;if(1===v.length&&$e.SelectionEditor.gf(v.J(0)))return v=v.J(0).node,this.l6.value.iHd(this.DPc(v),this.BFb(h),P),32;b=[];for(D=0;D<v.length;D++){const ca=v.J(D);(!D&&$e.SelectionEditor.Hk(ca)||fe.ParagraphReader.lm(ca)||$e.SelectionEditor.nl(ca))&&b.push(ca.node)}if(!b.length)return 8;v=Array(b.length);
for(D=0;D<b.length;D++)v[D]=this.DPc(b[D]);v=Ov.APropertySet.Fai(v);this.l6.value.iHd(v,this.BFb(h),P);return 32}DPc(b){const h=new Md.DictionaryPropertySet;h.setValue(Wc.a.vw,fe.ParagraphReader.Gx(b));const v=this.$V.yEa(b);var D=v.lineSpacing;h.setValue(Wc.a.P3a,D.unit);h.setValue(Wc.a.ua,D.value);D=v.beforeSpacing;h.setValue(Wc.a.Rfc,D.unit);h.setValue(Wc.a.Sfc,D.value);D=v.afterSpacing;h.setValue(Wc.a.Pfc,D.unit);h.setValue(Wc.a.Qfc,D.value);h.setValue(Wc.a.j1c,v.lw);h.setValue(Pd.a.keepWithNext,
fe.ParagraphReader.keepWithNext(b));h.setValue(Pd.a.widowControl,fe.ParagraphReader.znc(b));h.setValue(Pd.a.keepTogether,fe.ParagraphReader.keepTogether(b));return h}static get Wf(){return qi.a.instance}static get Xg(){return em.ContextSetEditor.instance}static get Jc(){return bf.a.instance}}Object(n.a)(TE,"AParagraphDialogActor",null,[]);class zK extends TE{constructor(b,h,v,D,P){super(b,h,v);this.Sk=D;this.Xo=P}Tb(){super.Tb();this.ga.eb(Gb.a.O5i,sc.a.view,Ok.d,96);this.ga.eb(Gb.a.P5i,sc.a.view,
Ok.d,96);this.ga.eb(Gb.a.JMn,sc.a.view,Ok.d,96);this.ga.eb(Gb.a.txm,sc.a.view,Ok.c,96);this.ga.eb(Gb.a.vxm,sc.a.view,Ok.c,96);this.ga.eb(Gb.a.MBo,sc.a.view,Ok.c,96);this.ga.eb(Gb.a.NBo,sc.a.view,Ok.c,96);this.ga.eb(Gb.a.byn,sc.a.view,Ok.c,96);this.ga.eb(Gb.a.kyn,sc.a.view,Ok.c,96);this.ga.eb(Gb.a.jyn,sc.a.view,Ok.c,96);this.ga.eb(Gb.a.RBo,sc.a.view,Ok.c,96);this.ga.eb(Gb.a.xNn,sc.a.view,Ok.d,96);this.ga.eb(Gb.a.yNn,sc.a.view,Ok.d,96)}TCj(b){return this.Sk.v8(b.gk)}DPc(b){const h=super.DPc(b);var v=
this.Xo.XT(b);const D=this.Xo.xG(b);h.setValue(Wc.a.GGa,1);h.setValue(Wc.a.HGa,v.Ot-D.Ot);v=this.Xo.y1a(b);h.setValue(Wc.a.Smb,v.unit);h.setValue(Wc.a.Tmb,v.value);b=this.Xo.X8b(b);b.specialIndentType&&(h.setValue(Wc.a.t5,b.specialIndentType),h.setValue(Wc.a.yTa,b.unit),h.setValue(Wc.a.zTa,b.value));return h}BFb(b){const h=new Md.DictionaryPropertySet;h.setValue(Bc.a.Ao,this.Sk.At(b));h.setValue(Bc.a.qv,this.Sk.xB(b));h.setValue(Bc.a.marginTop,Math.abs(this.Sk.Fna(b)));h.setValue(Bc.a.marginBottom,
Math.abs(this.Sk.Nva(b)));h.setValue(Bc.a.marginLeft,this.Sk.nJ(b));h.setValue(Bc.a.marginRight,this.Sk.$K(b));return h}}Object(n.a)(zK,"ParagraphDialogActor",TE,[]);class AK extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.azi=h}}Object(n.a)(AK,"AfterPasteEventArgs",Sys.EventArgs,[]);class BK{constructor(b){this.sFe=null;this.Vid=b}get RMd(){return null!=this.Szg?this.Szg:this.Szg=Ea.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}get BYd(){this.sFe||(this.sFe=
!!w.AFrameworkApplication.K&&w.AFrameworkApplication.K.$(nu.a.oRh));return this.sFe}VJn(b){if(b&&ig.OutlineElementReader.Nh(b.uva)&&ig.OutlineElementReader.Nh(b.Mkb)){this.pKn(b);var h=new Rl.a;for(h.Zc(b.uva);h&&h.currentNode;){const v=this.ARd(h),D=fe.ParagraphReader.Wb(v);D&&fe.ParagraphReader.dfb(v)&&this.TJn(v);const P=h.currentNode.id===b.Mkb.currentNode.id;D&&this.BYd&&v.qj.Mga(v.type).sce(new AK(v,P));if(P)break;hf.OutlineElementNavigator.Xr(h,!1,!1)}}}TJn(b){u.ULS.sendTraceTag(590435214,
307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const h=b.dgc;b=we.a.Qc(b,0);bu.tUc(h)?this.RMd.o$d(b,h):this.Vid.o$d(b,h)}pKn(b){if(b.uva.currentNode&&b.Mkb.currentNode&&b.uva.currentNode.id===b.Mkb.currentNode.id){const h=this.ARd(b.uva);fe.ParagraphReader.Wb(h)?this.XJn(h,b.BCn,b.ACn):u.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}XJn(b,h,v){u.ULS.shipAssertTag(590956771,
307,0<=h);u.ULS.shipAssertTag(590958592,307,0<=v);var D=fe.ParagraphReader.text(b);if(""!==D){var P=we.a.createTextRange(b,h,v);P=Re.a.zA(P,!1);if(1===P.length){const ca=P[0];P=D.substring(h,v).trim();D=D.substring(ca.cpBegin,ca.cpEnd).trim();h=P===D;P=we.a.createTextRange(b,ca.cpBegin,ca.cpEnd);if(ca.hyperlink&&h&&!Re.a.x3a(D))b=ca.hyperlink.url;else if(h)b=D;else{u.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");
return}bu.tUc(b)?this.RMd.QPa(P,b,!1):this.Vid.QPa(P,b,!1)}else u.ULS.sendTraceTag(590958597,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",P.length)}}ARd(b){const h=hf.OutlineElementNavigator.Ge(b);hf.OutlineElementNavigator.Vd(b);return h}}Object(n.a)(BK,"PastedContentsProcessorPostMergeAfterPaste",null,[365]);class wH extends Ku{constructor(b,h,v,D,P,ca,ta,Ra){super(D);this.sRe=7;this.fw=
this.Ssc=null;this.aEe=0;this.YDe=b;this.Jk=h;this.rn=v;this.ge=P;this.CVj=ta;this.FXa=Ra;this.Q2=this.ge.hRa("UserAction","WordIgnoreAll")}Icg(b){this.YDe.gLi();this.Ssc=this.rn.Ana(b);this.FXa.Api(this.Ssc,null,!1);return this.YDe.yDj(this.Ssc)?(this.Q2.start(),this.fw=new eh.GraphTransaction(15),this.fw.Cb(b.node),!0):!1}Hae(b){this.bMb(b.node);return!0}u2c(b){this.bMb(b);return!0}Iae(b){this.bMb(b.node)}Hig(b){this.fw.dispose();this.Ssc.errorDetails.dqb(b.actionId);this.Q2.stop();u.ULS.sendTraceTag(19779652,
324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",this.aEe,this.Q2.si,this.Ssc.errorDetails.proofingType));return!0}wkc(b,h){if(super.wkc(b,h))return!0;b=b.role;return 9===b||10===b||13===b||7===b||8===b}$ei(b){if(b&&b.type!==this.sRe){const h=he.GraphIterator.$a(b);return h.zb(this.sRe)?h.jd(this.sRe):b}return b}QMm(b,h){return this.YDe.tie(h.errorDetails)&&!this.Jk.M8(we.a.createTextRange(b,h.begin,h.end))}bMb(b){if(b){var h=this.rn.T3(b,
v=>this.QMm(b,v));this.CVj?this.rn.Jnb(b,h,!0):0<h.length&&(b.gl(4,!0),this.rn.jKb(b));this.aEe+=h.length}}}Object(n.a)(wH,"IgnoreAllCallbackSteps",Ku,[]);class CK{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac){this.i3c=(Lc,id,vd,xe,Ld)=>{if(1===vd)return 32;Lc=this.vI.vEa(id.view.lb.tg);if(Lc=ok.a.sg(Lc))Ld[Hl.a.LabelText]=Lc.displayName;return 32};this.boa=(Lc,id,vd,xe,Ld,Qd)=>{const Zd=new wH(this.a7j,this.Jk,this.rn,this.Ie,this.ge,this.nW,0,this.FXa);return new Dm(Lc,id,vd,xe,Ld,Qd,Zd,this.ga,
this.hb,this.Ie,"IgnoreAllOperation")};this.uCb=(Lc,id,vd,xe,Ld,Qd)=>{const Zd=new wH(this.U1j,this.Jk,this.rn,this.Ie,this.ge,this.nW,1,this.FXa);return new Dm(Lc,id,vd,xe,Ld,Qd,Zd,this.ga,this.hb,this.Ie,"DoNotCheckThisCritiqueType")};this.ga=b;this.Jk=h;this.hb=v;this.Ie=D;this.rn=P;this.vI=ca;this.ge=ta;this.a7j=Ra;this.U1j=mb;this.tWb=Jb.GVc;this.nW=Jb;this.FXa=Ub;this.$Fe=cc;this.n9a=Ac}Tb(){this.$Fe&&(nt.BB()?this.ga.eb(Gb.a.boa,sc.a.Tc,this.Jvm.bind(this),1028):this.ga.cT(Gb.a.boa,sc.a.view,
this.boa,1028));this.tWb&&this.ga.cT(Gb.a.uCb,sc.a.view,this.uCb,1028);this.ga.eb(Nc.a.i3c,sc.a.view,this.i3c,96)}Jvm(b,h,v,D,P){if(1===v)return 32;u.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.n9a.Iwf(P?P:h,null,Nm.b.IgnoreAll);return 32}}Object(n.a)(CK,"ProofingActor",null,[]);var VM=c(1709);class mD{constructor(b,h,v,D,P,ca,ta,Ra,mb){this.Gp=this.hMa=this.Avd=this.Bvd=null;this.mE=this.Gr=this.Kp=0;this.$$a=this.Z$a=!1;this.yaa=this.d$a=this.c$a=this.a$a=this.e$a=
0;this.Dud=null;this.aea=this.oW=this.Sq=this.$P=0;this.Nl=null;this.oub=0;this.TVf=Jb=>{var Ub;if(5===this.oub){const cc=Object.assign(new Bb.a,{extendedProperties:new Map});cc.extendedProperties.set("status",Jb.data.status.toString());cc.extendedProperties.set("httpStatus",Jb.data.Qe.toString());(null===(Ub=w.AFrameworkApplication.K)||void 0===Ub?0:Ub.$("ShouldLogPicturesExtendedHealthKpis"))?(Ub={name:vm.c.iWd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,
additionalValues:cc},cc.extendedProperties.set("ErrorLevel","warning"),this.pg.logKpiFailure({kpiName:vm.c.h$b,errorName:"PictureSwordRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:cc},optionalVeto:Ub})):va.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,cc)}u.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",{["Status"]:Jb.data.status,["HttpStatus"]:Jb.data.Qe,["Id"]:Jb.data.id,["ResponseData"]:Jb.data.ve},
SE.a[this.oub]);this.Ree()};this.Uj=v;this._image=b;this._context=h;this.pnd=!1;(b=mD.Oh.Ys(h.node))&&b.Gf(Bc.a.DGf)&&(this.pnd=!0);this.Muc=D.$("ImageDataURLPresentationIsEnabled");this.cgk=D.$("WordOartPostRequestIsEnabled");this.Fa=D;this.mr=P;this.ge=ca;this.Sd=ta;this.Im=Ra;this.fK=mb;this.pg=Gl.a.getInstance(vm.a);this.hAm();this.j8d=this.lfc.bind(this)}hAm(){this.Gp="";this.Kp=oe.ImageReader.fF(this._image);this.Gr=oe.ImageReader.yG(this._image);this.yaa=oe.ImageReader.dib(this._image);this.mE=
oe.ImageReader.D_(this._image);this.Z$a=oe.ImageReader.fQd(this._image);this.$$a=oe.ImageReader.CEb(this._image);const b=oe.ImageReader.Hba(this._image);this.e$a=Math.max(b.top,0);this.a$a=Math.max(b.bottom,0);this.c$a=Math.max(b.left,0);this.d$a=Math.max(b.right,0);this.Nl=ub.a.nil;this.hMa=null;this.oub=oe.ImageReader.Ui(this._image)}oCd(b,h){return(new VM.a(this.mr,this.oub,this.Fa,this.Kp,this.Gr,this.mE,this.yaa,this.e$a,this.a$a,this.c$a,this.d$a,this.Z$a,this.$$a,this.pnd)).build(this._context.node,
this._image,b,h)}resize(b,h){this.Gp="Resize";this.lke();hj.a.mark(this.D8b());this.Kp=b;this.Gr=h;this.sendMessage(!1,this.j8d)}Bw(b){this.Gp="Styles";this.lke();hj.a.mark(this.D8b());this.yaa=b;this.sendMessage(!1,this.j8d)}Pmo(b,h,v){this.Gp="Rotation";this.lke();this.mE=b;this.Z$a=h;this.$$a=v;this.sendMessage(!1,this.j8d)}Omo(b,h){this.Gp="SwordRequestManager";this.lke();this.hMa=b;this.mE=h.angle;this.Kp=h.width;this.Gr=h.height;this.yaa=h.styleId;this.e$a=h.top;this.a$a=h.bottom;this.c$a=h.left;
this.d$a=h.right;this.Nl=h.jX;this.sendMessage(!1,this.j8d)}sendMessage(b,h){if(this.Fa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var v=this.rfb(v);const D=oe.ImageReader.Mna(this._image,this.Fa,this.mr);D?Qx.a.Eob(this._image,D,4):this._image.setValue(Hh.a.GOa,!0);v.dispose()}this.Nvj(b);hj.a.mark(this.D8b());b=new eb.QueryStringBuilder(this.oCd(b,!0));this.Muc&&b.ze(Pg.a.jPh,"true");this.cgk?(v=new eb.QueryStringBuilder("WordOart.ashx"),w.AFrameworkApplication.Ne.xj(v.toString(),2,b.toString(),
{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,h,this.TVf,null)):w.AFrameworkApplication.Ne.xj(b.toString(),1,"",null,!0,0,h,this.TVf,null)}rfb(b){b=this.Nl&&this.Nl!==ub.a.nil?new eh.GraphTransaction(7,Gb.a.imageRotate):new eh.GraphTransaction(15);b.Cb(this._context.node);return b}get oPj(){const b=new eh.GraphTransaction(3);b.Cb(this._context.node);return b}Ree(){this.bLc();this.uKd();const b=this.oPj;var h=oe.ImageReader.fEa(this._image,this._context.node.Kc,this.Fa,this.mr);
this._image.setValue(Hh.a.GOa,!1);this._image.setValue(Wc.a.fSc,h);this._image.setValue(Wc.a.sJ,-1);this._image.setValue(Hh.a.b5,1);h=oe.ImageReader.Mna(this._image,this.Fa,this.mr);this.Fa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&(this._image.removeProperty(Wc.a.J$d),this._image.removeProperty(Wc.a.H$d),h&&Qx.a.Eob(this._image,h,3));b.dispose();mD.xp();this.hMa&&this.hMa()}Nvj(b){this.ge&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.Bvd=this.ge.Zf("WebServiceCall",
b))}bLc(){this.Bvd&&(this.Bvd.stop(),this.Bvd=null)}lke(){if(this.ge){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.Gp,SE.a[this.oub]);this.Avd=this.ge.Zf("WebServiceCall",b)}}uKd(){this.Avd&&(this.Avd.stop(),this.Avd=null)}static get Oh(){return Wk.PageNavigator.instance}static xp(){const b=new ug.StandardDialog;b.Ad=0;b.nx(lm.a.TDn,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);Xa.App.xa&&Xa.App.xa.updateCommandUI()}}Object(n.a)(mD,
"RenderedImageEditOperation",null,[398]);var xH=c(297),MF=c(504);class DK extends mD{constructor(b,h,v,D,P,ca,ta,Ra,mb){super(b,h,v,D,P,ca,ta,Ra,mb);this.pg=Gl.a.getInstance(xv.a)}sendMessage(b,h){Object(xH.a)(()=>{let v;v=this.rfb(v);this._image.setValue(Hh.a.b5,0);v.dispose()});this.Nvj(b);hj.a.mark(this.D8b());b=new eb.QueryStringBuilder("WordOart.ashx");this.IZg=this.kib(!0,!1);b=new MF.a(b.toString(),2,this.kib(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,
null,null,null,null,null,null,null,null,null,null,null,["Content-Type"],null,"text");w.AFrameworkApplication.Ne.send(b).fya(h,v=>{this.TVf(v)})}lfc(b){try{var h=JSON.parse(b.data.LSa);this.V5j=h[Pg.a.yQc];this.ypk=h[Pg.a.width];this.o6j=h[Pg.a.height];this.FLg=h[Pg.a.sEc];this.Csc=Array(4);this.Csc[0]=h[Pg.a.egb];this.Csc[1]=h[Pg.a.fgb];this.Csc[2]=h[Pg.a.ggb];this.Csc[3]=h[Pg.a.dgb];this.c3g=void 0!==h[Pg.a.Xwa]?"true"===h[Pg.a.Xwa].toLowerCase():null;Object(xH.a)(()=>{this.qbd();this._context.node.Vi().contentReplicator.forceOutbound(()=>
{this.XEl()},null,null)})}catch(v){Qx.a.KHa&&(b=Object.assign(new Bb.a,{extendedProperties:new Map([["Renderer",xv.b.VDa],["Exception",v.message],["Operation",this.Gp]])}),h={name:xv.d.QUh,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","warning"),this.pg.logKpiFailure({kpiName:xv.d.SJd,errorName:"DrawingResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h})),
u.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",v.message,this.Gp,oe.ImageReader.Ui(this._image)),this.Ree()}}w7d(){u.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}qbd(){let b;b=this.rfb(b);this._image.setValue(Pd.a.GX,this.V5j);this.FLg&&this._image.setValue(Pd.a.zAd,this.FLg);this._image.setValue(Pd.a.Xva,this.ypk);this._image.setValue(Pd.a.Yva,this.o6j);this._image.setValue(Pd.a.tPa,this.Csc);
this.h7j&&this._image.setValue(Wc.a.yGb,this.h7j);Qx.a.Eob(this._image,this.IZg,3);this._image.setValue(Bc.a.bgb,this.IZg);this.c3g?this._image.setValue(Pd.a.L2a,this.c3g):this._image.removeProperty(Pd.a.L2a);this.sYk();b.dispose()}sYk(){this._image.removeProperty(Wc.a.hu);this._image.removeProperty(Wc.a.sJ);this._image.removeProperty(Wc.a.J$d);this._image.removeProperty(Wc.a.H$d)}XEl(){this.fK.AHa(this._context);if(this.Nl&&this.Nl!==ub.a.nil){var b=this._context.node.Vi();const h=new W.a(this.Nl,
1);this.Im.s3b(b,h)}this.Sd.Ns(13);Qx.a.KHa&&(b=new Map([["Renderer",xv.b.VDa],["Type",oe.ImageReader.Ui(this._image).toString()]]),this.pg.logKpiSuccess({kpiName:xv.d.SJd,optionalProperties:{additionalValues:{durationMs:void 0,inStaging:void 0,extendedProperties:b}},blockFutureEmissionDurationInMs:3E5}));this.bLc();this.uKd();hj.a.mark(this.C8b());Object(xH.a)(()=>{let h;h=this.rfb(h);this._image.setValue(Hh.a.b5,1);h.dispose()});this.hMa&&this.hMa()}kib(b,h){b=new eb.QueryStringBuilder(this.oCd(b,
h));b.ze(Pg.a.pWd,"true");return b.toString()}D8b(){return 51511}C8b(){return 51512}}Object(n.a)(DK,"RenderedGraphicEditOperation",mD,[]);class EK extends mD{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb){super(b,h,v,D,P,ca,ta,Ra,mb);this.IUg=null;this.w7d=Ub=>{const cc=this.oCd(!0,!1);let Ac;Ac=this.rfb(Ac);this._image.setValue(Bc.a.AAd,this.Dud);var Lc=Ea.a.instance.Na("Box4.IFeatureHelper");if(Qx.a.KHa){const xe=new Map([["Renderer",xv.b.legacy],["Type",oe.ImageReader.Ui(this._image).toString()]]);this.pg.logKpiSuccess({kpiName:xv.d.PUh,
optionalProperties:{additionalValues:{durationMs:void 0,inStaging:void 0,extendedProperties:xe}},blockFutureEmissionDurationInMs:3E5})}Lc&&Lc.isFeatureEnabled(49)&&this._image.setValue(Bc.a.ALd,this.IUg);this.Fa.$("WordEditorImageRotateIsEnabled")&&this.Fa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Uj.che(this._image,this.mE,this.Z$a,this.$$a);const id=oe.ImageReader.Mna(this._image,this.Fa,this.mr),vd=()=>{id&&Qx.a.Eob(this._image,id,3);Qx.a.Eob(this._image,cc,3);this.Uj.ahe(this._image,
Df.a.rG(this.$P),Df.a.rG(this.oW),Df.a.rG(this.Sq),Df.a.rG(this.aea));this._image.setValue(Bc.a.bgb,cc);oe.ImageReader.wy(this._image)||this._image.setValue(Bc.a.WEa,1);this.Uj.Jge(this._image,this.Kp,this.Gr);this.Fa.$("WordEditorImageRotateIsEnabled")&&!this.Fa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Uj.che(this._image,this.mE,this.Z$a,this.$$a);2===Ub.data.status&&oe.ImageReader.a0(Ub.data.ve)&&(this._image.setValue(Wc.a.hu,Ub.data.ve),Ub.data.request&&this._image.setValue(Wc.a.yGb,
Qx.a.OLc("POST"===Ub.data.request.get_httpVerb()?Ub.data.request.get_body():Ub.data.request.get_url())));this.hMa&&this.hMa();this.fK.AHa(this._context);if(this.Nl&&this.Nl!==ub.a.nil){const xe=this._context.node.Vi(),Ld=new W.a(this.Nl,1);this.Im.s3b(xe,Ld)}this.Sd.Ns(13);this.bLc();this.uKd();hj.a.mark(this.C8b())};if(this.Fa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Nl&&this.Nl!==ub.a.nil&&(Lc=this._context.node.Vi())&&Lc.contentReplicator){Ac.dispose();Lc.contentReplicator.forceOutbound(()=>
{let xe;xe=this.rfb(xe);vd();xe.dispose()},null,null);return}vd();Ac.dispose()};this.pg=Gl.a.getInstance(xv.a);this.UPe=Jb}D8b(){return 51511}C8b(){return 51512}lfc(b){try{var h=JSON.parse(b.data.ve);const P=Sys.Net.XMLDOM("string"===typeof h[Pg.a.lsh]?h[Pg.a.lsh]:null);this.Dud="string"===typeof h[Pg.a.BAd]?h[Pg.a.BAd]:null;const ca=Ea.a.instance.Na("Box4.IFeatureHelper");ca&&ca.isFeatureEnabled(49)&&(this.IUg="string"===typeof h[Pg.a.r6b]?h[Pg.a.r6b]:null);aa.a.Gt&&P.setProperty("SelectionNamespaces",
"xmlns:mc='"+Fe.a.FCk+"'");const ta=P.selectSingleNode("/mc:AlternateContent");if(!ta)throw Os.a.argument("Alternate content element could not be retrieved!");const Ra=ta.firstChild;if(!Ra)throw Os.a.argument("Alternate content choice element could not be retrieved!");const mb=Ra.firstChild;if(!mb)throw Os.a.argument("Drawing element could not be retrieved!");var v=mb.firstChild;if(!v)throw Os.a.argument("Inline element could not be retrieved!");h=b=null;const Jb=RegExp("effectExtent"),Ub=RegExp("extent");
for(const Ac of v.childNodes)-1!==Ac.nodeName.search(Jb)&&(b=Ac),-1!==Ac.nodeName.search(Ub)&&(h=Ac);if(!b||!h)throw Os.a.argument("Effect extent or extent could not be retrieved!");this.$P=parseInt(b.selectSingleNode("@l").text);this.oW=parseInt(b.selectSingleNode("@r").text);this.Sq=parseInt(b.selectSingleNode("@t").text);this.aea=parseInt(b.selectSingleNode("@b").text);const cc=$c.c(this.mE);if(45<=cc&&135>=cc||225<=cc&&315>=cc){const Ac=parseInt(h.selectSingleNode("@cx").text);var D=parseInt(h.selectSingleNode("@cy").text);
v=Ac/2;D/=2;this.$P-=v-D;this.oW+=v-D;this.Sq-=D-v;this.aea+=D-v}}catch(P){Qx.a.KHa&&(D=Object.assign(new Bb.a,{extendedProperties:new Map([["Renderer",xv.b.legacy],["Exception",P.message],["Operation",this.Gp]])}),v={name:xv.d.Lsl,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:D},D.extendedProperties.set("ErrorLevel","warning"),this.pg.logKpiFailure({kpiName:xv.d.PUh,errorName:"DrawingResponseInvalid",optionalProperties:{isIntentional:!1,
isInternal:!0,additionalValues:D},optionalVeto:v}));u.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",P.message,this.Gp,SE.a[this.UPe]);this.Ree();return}this.sendMessage(!0,this.w7d)}}Object(n.a)(EK,"RenderedDrawingEditOperation",mD,[]);class FK extends mD{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub){super(b,h,v,D,P,ca,ta,Ra,mb);this.laa=null;this.w7d=cc=>{var Ac;const Lc=this.oCd(!0,!1);let id;id=this.rfb(id);this._image.setValue(Bc.a.CLb,
this.Dud);const vd=oe.ImageReader.Mna(this._image,this.Fa,this.mr);(null===(Ac=w.AFrameworkApplication.K)||void 0===Ac?0:Ac.$("ShouldLogPicturesExtendedHealthKpis"))&&this.pg.logKpiSuccess({kpiName:vm.c.h$b});const xe=()=>{vd&&Qx.a.Eob(this._image,vd,3);Qx.a.Eob(this._image,Lc,3);this.Uj.ahe(this._image,Df.a.rG(this.$P),Df.a.rG(this.oW),Df.a.rG(this.Sq),Df.a.rG(this.aea));this._image.setValue(Bc.a.bgb,Lc);oe.ImageReader.wy(this._image)||this._image.setValue(Bc.a.WEa,1);this._image.setValue(Bc.a.N1c,
this.yaa);this._image.setValue(Wc.a.Awm,-1);this.ld.isFeatureEnabled(89)&&oe.ImageReader.I9b(this._image)&&this.Ho.Hde(this._image);this._image.setValue(Hh.a.GOa,!1);this.Uj.Jge(this._image,this.Kp,this.Gr);this.Fa.$("WordEditorImageRotateIsEnabled")&&this.Uj.che(this._image,this.mE,this.Z$a,this.$$a);this.Fa.$("WordEditorImageCropIsEnabled")&&this.Uj.cbg(this._image,this.e$a,this.a$a,this.c$a,this.d$a);2===cc.data.status&&oe.ImageReader.a0(cc.data.ve)&&(this._image.setValue(Wc.a.hu,cc.data.ve),cc.data.request&&
this._image.setValue(Wc.a.yGb,Qx.a.OLc("POST"===cc.data.request.get_httpVerb()?cc.data.request.get_body():cc.data.request.get_url())));this.hMa&&this.hMa();this.fK.AHa(this._context);if(this.Nl&&this.Nl!==ub.a.nil){const Ld=this._context.node.Vi(),Qd=new W.a(this.Nl,1);this.Im.s3b(Ld,Qd)}this.Sd.Ns(13);this.bLc();this.uKd();hj.a.mark(this.C8b())};if(this.Fa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Nl&&this.Nl!==ub.a.nil&&(Ac=this._context.node.Vi())&&Ac.contentReplicator){id.dispose();
Ac.contentReplicator.forceOutbound(()=>{let Ld;Ld=this.rfb(Ld);xe();Ld.dispose()},null,null);return}xe();id.dispose()};this.UPe=Jb;this.ld=Ub}D8b(){return 7988}C8b(){return 7989}get Ho(){this.laa||(this.laa=new sK.a);return this.laa}lfc(b){var h;try{const v=b.data.Hia;this.Dud=b.data.ve;aa.a.Gt&&v.setProperty("SelectionNamespaces","xmlns:pic='"+Fe.a.RDn+"'");const D=v.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.$P=parseInt(D.selectSingleNode("@l").text);this.oW=parseInt(D.selectSingleNode("@r").text);
this.Sq=parseInt(D.selectSingleNode("@t").text);this.aea=parseInt(D.selectSingleNode("@b").text)}catch(v){b=Object.assign(new Bb.a,{extendedProperties:new Map});b.extendedProperties.set("exception",v.message);b.extendedProperties.set("operation",this.Gp);(null===(h=w.AFrameworkApplication.K)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:vm.c.iWd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel",
"warning"),this.pg.logKpiFailure({kpiName:vm.c.h$b,errorName:"PictureSwordResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h})):va.Health.instance.recordQosError("PictureSwordResponseInvalid",["ImageEditFailed"],!1,!0,!1,!1,b);u.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",v.message,this.Gp,SE.a[this.UPe]);this.Ree();return}this.bLc();hj.a.mark(this.C8b());this.sendMessage(!0,
this.w7d)}}Object(n.a)(FK,"RenderedPictureEditOperation",mD,[]);class GK{constructor(b,h,v,D,P,ca,ta,Ra){this.Uj=b;this.Fa=h;this.mr=v;this.ge=D;this.Sd=P;this.Im=ca;this.fK=ta;this.ld=Ra}create(b,h){const v=oe.ImageReader.Ui(b);return Jl.App.instance.h4(v)?new DK(b,h,this.Uj,this.Fa,this.mr,this.ge,this.Sd,this.Im,this.fK):10===v||11===v||48===v||4===v?new EK(b,h,this.Uj,this.Fa,this.mr,this.ge,this.Sd,this.Im,this.fK,v):5===v?new FK(b,h,this.Uj,this.Fa,this.mr,this.ge,this.Sd,this.Im,this.fK,v,
this.ld):null}}Object(n.a)(GK,"Factory",null,[364]);class HK{constructor(){this.lKc=b=>{const h=window.performance.now(),v=dl.a.Pr();if(v){b=nH.a(b.customData,v);b=Ka.a.Rs(b,v);var D=0,P=new eh.GraphTransaction(3);try{for(P.Cb(v);b.moveNext();){if(!fe.ParagraphReader.sh(b.iterator))continue;const ca=b.currentNode;this.iUh(ca)&&(D++,ca.gl(4,!0));const ta=window.performance.now()-h;if(2500<D||100<ta){this.lxb=null;this.C3c(ca);break}}}finally{P&&P.dispose()}}else Kc.b(570450380,3018,10,"PageContentNode not found")};
this.lxb=null}dui(){const b=dl.a.Pr();this.O3c(b);this.C3c(null)}C3c(b){this.lxb&&(w.AFrameworkApplication.nc.Xe(this.lxb),this.lxb=null);this.lxb=new qf.a(1,1,1,this.lKc,198);this.lxb.customData=b;w.AFrameworkApplication.nc.Vb(this.lxb)}O3c(b){const h=nH.b(b);if(h){var v=new eh.GraphTransaction(3);try{for(v.Cb(b);h.moveNext();){if(!fe.ParagraphReader.sh(h.iterator))continue;const D=h.currentNode;this.iUh(D)&&D.gl(4,!0)}}finally{v&&v.dispose()}}}iUh(b){b=b.XG;for(const h of b)if(h.Pjb)return 0<h.LPb;
return!1}}Object(n.a)(HK,"RenderParagraphsContainingTabs",null,[]);class IK{constructor(b,h){this.Nye=!0;this.mrc=null;this.frl=()=>{this.mrc=null;this.Nye=!0;this.iMa&&this.iMa.oUa(!Xa.App.PO())};this.e8a=(v,D,P)=>{if(1===P)return 32;2===P&&(v=!1,Xa.App.PO()?this.Nye=!1:this.Nye?v=!0:this.M_o(),this.iMa&&this.iMa.oUa(v));return 32};this.ga=b;this.iMa=h}Tb(){this.ga.eb(Wa.a.e8a,sc.a.application,this.e8a,1124)}M_o(){this.mrc?w.AFrameworkApplication.nc.Xe(this.mrc):this.mrc=new qf.a(4,1,5E3,this.frl);
w.AFrameworkApplication.nc.Vb(this.mrc)}}Object(n.a)(IK,"SaveStatusActor",null,[]);class JK{get s9f(){return null!=this.uGg?this.uGg:this.uGg=Ea.a.instance.Na("Box4.ISaveStyleManager")}get t6n(){return this.s6n||(this.s6n=Ea.a.instance.Na("Box4.IResetAndDeleteStyleManager"))}get Fn(){return null!=this.uHg?this.uHg:this.uHg=Ea.a.instance.Na("Box4.Styles.StyleSettings")}constructor(b,h){this.applyStyles=(v,D,P)=>{v=dl.a.kIb(D);if(1===P||v)return v?8:32;this.l6.value.N9k(D);return 32};this.DBb=(v,D,
P)=>{v=dl.a.kIb(D);if(1===P||v)return v?8:32;this.l6.value.Gcl(D,this.ga);return 32};this.gef=(v,D,P)=>{v=dl.a.kIb(D)||this.uso();if(1===P||v)return v?8:32;this.l6.value.gef(D);return 32};this.ga=b;this.l6=h}get uc(){return null!=this.kKg?this.kKg:this.kKg=Ea.a.instance.resolve("Box4.Styles.IWACStyleReader")}Tb(){this.ga.eb(Gb.a.applyStyles,sc.a.view,this.applyStyles,1028);this.ga.eb(Gb.a.DBb,sc.a.view,this.DBb,4);this.ga.eb(Gb.a.kCb,sc.a.view,this.gef,4);this.ga.eb(Gb.a.r9f,sc.a.view,this.xbo.bind(this),
4);this.ga.eb(Gb.a.L7f,sc.a.view,this.M7f.bind(this),4);this.ga.eb(Gb.a.aef,sc.a.view,this.bll.bind(this),4)}xbo(b,h,v){b=dl.a.kIb(h)||this.zso();if(1===v||b)return b?8:32;this.s9f.wbo();return 32}M7f(b,h,v){b=dl.a.kIb(h)||this.xso();if(1===v||b)return b?8:32;this.t6n.M7f();return 32}bll(b,h,v){b=dl.a.kIb(h)||this.tso();if(1===v||b)return b?8:32;this.l6.value.$kl();return 32}tso(){return"{}"===IE.a.Eqb?!0:!1}xso(){if(0==IE.a.z4.size)return!0;var b=IE.a.z4;const h=this.uc.Qr();let v=0;for(const D of b.values())b=
h.Di(D),this.uc.je(b,h)||v++;return 0==v?!0:!1}zso(){var b=IE.a.Eqb,h=IE.a.z4;const v=this.uc.Qr();if(0==h.size)return!0;if(!({av:b}=E.d(b)).returnValue)return u.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=h.size)return!1;for(const P of h.values()){h=v.Di(P);var D=b[P];if(null==D)return!1;if(D=dl.a.BSd(D)){if(h=dl.a.iOc(h,v),dl.a.eVc(h,D))return!1}else u.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}uso(){var b=
dl.a.Pr();if(!b)return Kc.b(577368330,3018,15,"PageContentNode is null"),!0;b=(new xq.WACStyleSet).VQ(b);const h=b.kO;for(let D=0;D<h;D++){var v=b.FEa(D);if(this.uc.isHidden(v)||!this.uc.je(v,b))continue;const P=this.uc.AG(v);if(2===P||1===P)if(!v.hasProperty(Bc.a.linkedStyle)||2===P)if(v=v.ia(Bc.a.IK,null),!(v&&0<v.length))return!1}return!0}}Object(n.a)(JK,"StylesActor",null,[]);class GG{constructor(b){this.ale=(h,v,D)=>{h=w.AFrameworkApplication.ta;if(1===D)return 1!==h.mode||bc.SessionStatusManager.instance.Gj?
2:32;va.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,GG.tB,null);const P={};P[H.a.wyf]=w.AFrameworkApplication.K.jb("ClassicViewModePreferenceCookieName");P[H.a.Roi]="true";w.AFrameworkApplication.MO().execute(ca=>{ca.sendMessage(L.a.NEo,P)});return w.AFrameworkApplication.va.processAction(Gb.a.readingMode,2)};this.ga=b}Tb(){this.ga.qa(Nc.a.ale,sc.a.view,this.ale)}}GG.tB="wwaengidc";Object(n.a)(GG,"SwitchToClassicViewModeActor",null,[]);class KK{constructor(b,h,v,D,P,ca,ta,Ra,mb){this.angle=
v;this.styleId=D;this.width=b;this.height=h;this.top=P;this.bottom=ca;this.left=ta;this.right=Ra;this.jX=mb}}Object(n.a)(KK,"SWordData",null,[]);class LK{constructor(b,h){this.Ck=this.v2=this.qq=null;this.iQe=this.AXb=!1;this.$P=this.oW=this.aea=this.Sq=this.yaa=this.Gr=this.Kp=this.mE=0;this.Nl=null;this.y0=()=>{this.iQe=!1;this.AXb&&this.fLc()};this.Do=b;this.aAc=h;this.tri()}tri(){this.oW=this.$P=this.aea=this.Sq=this.yaa=this.Gr=this.Kp=this.mE=-1;this.Nl=ub.a.nil}fLc(){this.iQe||(this.U2o(),
this.Vdl(),this.AXb=!1)}Vdl(){this.Ck=new KK(this.Kp,this.Gr,this.mE,this.yaa,this.Sq,this.aea,this.$P,this.oW,this.Nl);this.aAc.create(this.v2,this.qq).Omo(this.y0,this.Ck);this.iQe=!0;let b;Object(rb.a)(3,this.v2)?b=SE.a[oe.ImageReader.Ui(this.v2)]:(u.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),b="generic");u.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",
this.Kp,this.Gr,this.mE,this.yaa,this.Sq,this.aea,this.$P,this.oW,b);this.tri()}U2o(){this.Kp=-1!==this.Kp?this.Kp:this.v2.ia(Wc.a.UEa,-1);this.Gr=-1!==this.Gr?this.Gr:this.v2.ia(Wc.a.TEa,-1);this.Kp=-1!==this.Kp?this.Kp:this.Do.fF(this.v2);this.Gr=-1!==this.Gr?this.Gr:this.Do.yG(this.v2);this.mE=-1!==this.mE?this.mE:this.Do.D_(this.v2);this.yaa=-1!==this.yaa?this.yaa:this.Do.dib(this.v2);const b=this.Do.Hba(this.v2);this.Sq=-1!==this.Sq?this.Sq:b.top;this.aea=-1!==this.aea?this.aea:b.bottom;this.$P=
-1!==this.$P?this.$P:b.left;this.oW=-1!==this.oW?this.oW:b.right}XNn(b,h,v,D){this.qq=b;this.mE=v;this.AXb=!0;this.v2=h;this.Nl=D;this.fLc()}WNn(b,h,v,D,P){this.qq=b;this.AXb=!0;this.v2=h;this.Nl=P;this.v2.setValue(Wc.a.UEa,v);this.v2.setValue(Wc.a.TEa,D);this.fLc()}aOn(b,h,v){this.qq=b;this.AXb=!0;this.v2=h;this.yaa=v;this.fLc()}RNn(b,h,v,D,P,ca){this.qq=b;this.Sq=v;this.aea=D;this.$P=P;this.oW=ca;this.AXb=!0;this.v2=h;h=b=0;({width:b,height:h}=this.Do.Nhb(this.v2));this.Kp=b-(P+ca)/1E5*b;this.Gr=
h-(v+D)/1E5*h;this.fLc()}}Object(n.a)(LK,"SWordRequestManager",null,[353]);class NF{constructor(b,h,v,D=null,P=null,ca=null,ta=null,Ra=null,mb=null,Jb=null){this.Im=null;this.Vkh=!1;this.tHo=(Ub,cc,Ac,Lc,id)=>{if(1===Ac)return 32;const vd=Ub===Gb.a.Wcg;if(!cc.view.te)return 2;const xe=cc.view,Ld=xe.lb,Qd=Ld.tg;if(!Qd||NF.Wf.k_(Qd))return 2;if(this.Sm&&this.Sm.instance&&this.Sm.instance.pU(Qd))return 4;Ub=null;var Zd=Oc.ActionManager.pxa;let te=!1;var Qf=$e.SelectionEditor.gf(Qd);if(Qd.$w){if(Ld.gb.wJ&&
(Zd=Qd.getContext(0),Ub=new he.GraphIterator,Ub.set(Zd.node),Ub.Bp(),Zd=vd?Gb.a.$9f:Gb.a.Ofe),Zd=this.zUe.vIn(Zd),Zd===Oc.ActionManager.pxa){var Jg=NF.Xg.iT(Qd,16);Jg?(vd&&(Zd=Gb.a.z5d),Ub=new he.GraphIterator,Ub.set(Jg.node),Ub.vd()):Zd=vd?Gb.a.KG:Gb.a.pO}}else if(Qd.hl)if(Ub=new he.GraphIterator,Ub.set(Qd.node),$e.SelectionEditor.ru(Ub),Ei.OutlineReader.uQa(Qd))Zd=vd?Gb.a.$9f:Gb.a.Ofe;else{if(this.WDe&&this.WDe.Auo(Qd))return this.WDe.n7c(Qd,xe.fc,vd),32;oe.ImageReader.C2a(Qd)?Zd=vd?Gb.a.Z9f:Gb.a.Y9f:
(Zd=vd?this.zUe.Mlm(Ub,Qd,Zd,cc):this.zUe.Llm(Ub,Qd,Zd,cc),ig.OutlineElementReader.Nh(Ub)&&Qd.contextId===sc.a.Tc&&(te=ig.OutlineElementReader.HA(Ub,Qd,!1)),Jg=Vg.ListItemReader.yg(Ub)&&te,Zd!==Oc.ActionManager.pxa||Xg.TableCellReader.Roa(Ub)||Jg||(this.Vkh||(u.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.Vkh=!0),w.AFrameworkApplication.va.processAction(Gb.a.Rri,2),this.psi(cc)))}else return 2;if(!vd&&Zd===Oc.ActionManager.pxa&&Xg.TableCellReader.Roa(Ub))if(ch.returnToCell(Ub),
Xg.TableCellReader.oQa(Ub)||cj.TableReader.uyi(Ub)&&Xg.TableCellReader.vEf(Ub)){if(Zd=this.Nqk(),!Zd)return 2}else Zd=Gb.a.BQi;if(Zd===Oc.ActionManager.pxa)return 2;switch(Zd){case Gb.a.BQi:case Gb.a.z5d:Lc=Zd===Gb.a.z5d;Qf&&this.N1&&this.YY&&(Qf=this.N1.zkf(Qd,-1,!0,Ve.a.Dw))&&this.YY.Ghj(Qf);Ac=32;ch.returnToCell(Ub);ch.moveToNextOrPreviousCell(Ub,Lc)&&(Qf=!0,Lc=!1,Ei.OutlineReader.Cxf(Ub)||(xh.OutlineNavigator.fOf(Ub,!1),hf.OutlineElementNavigator.Ge(Ub),fe.ParagraphReader.wt(Ub.currentNode)&&
(Qf=!1,fe.ParagraphReader.textLength(Ub.currentNode)||(Lc=!0)),Lc||ch.returnToCell(Ub)),Lc?Ub=Og.SelectionFactory.pe(Ub.currentNode,0):(Ub=Og.SelectionFactory.wq(Ub.currentNode),!Qf&&$e.SelectionEditor.Hk(Ub.Pc)&&(Qf=Ub.toArray(),Array.removeAt(Qf,Qf.length-1),Ub=new rg.Selection(Qf,Ub.Lf))),Ld.setSelection(Ub));break;case Gb.a.$9f:case Gb.a.Ofe:Zd===Gb.a.Ofe?xh.OutlineNavigator.bQi(Ub,!1):xh.OutlineNavigator.bQi(Ub,!0);Ld.setSelection(Og.SelectionFactory.wq(Ub.currentNode));Ac=32;break;case Gb.a.r9c:Ac=
w.AFrameworkApplication.va.Mf(cc,Zd,Ac,!0,Lc,id);break;default:if(Ac=w.AFrameworkApplication.va.Mf(cc,Zd,Ac,!0,Lc,id),!te&&Qf&&(Zd===Gb.a.KG||Zd===Gb.a.pO)){const Ml=$e.SelectionEditor.p3(Ld.gb.kb).y;Xa.App.mhc(()=>{this.Wfn(Ld,xe,Ml)})}}32===Ac&&cc.view.te&&this.Pg.kF();return Ac};this.Gla=b;this.zUe=h;this.Sm=v;this.N1=D;this.YY=P;this.CUe=ca;this.lJa=ta;this.ld=Ra;this.Ic=mb;this.WDe=Jb}get Pg(){return this.Im||(this.Im=this.Gla())}Tb(){const b=w.AFrameworkApplication.va,h=this.tHo;b.eb(Gb.a.tab,
sc.a.view,h,1124);b.eb(Gb.a.Wcg,sc.a.view,h,1124);b.qa(Gb.a.Rri,sc.a.view,Oc.ActionManager.Nf)}Wfn(b,h,v){if(b&&h){var D=b.gb.kb;$e.SelectionEditor.p3(D).y<v?(h=$e.SelectionEditor.jMc(h,D,!1),h=$e.SelectionEditor.tva(h,{RA:!1,Cs:!1,HC:!1,jE:!0})):h=$e.SelectionEditor.kMc(h,D,!1);b.setSelection(h)}}Nqk(){return Gb.a.w2a}psi(){}FZc(b,h,v){if(b&&h){var D=b.gb.kb;$e.SelectionEditor.p3(D).y<v?(h=$e.SelectionEditor.jMc(h,D,!1),h=$e.SelectionEditor.tva(h,{RA:!1,Cs:!1,HC:!1,jE:!0})):h=$e.SelectionEditor.tva(D,
{RA:!1,Cs:!1,HC:!1,jE:!0});b.setSelection(h)}}static get Wf(){return qi.a.instance}static get Xg(){return em.ContextSetEditor.instance}}Object(n.a)(NF,"TabActor",null,[]);class yH{constructor(b){this.Suc=b}get jq(){return this.Suc}vIn(b){return b}Mlm(b,h,v,D){const P=D.view,ca=P.lb.gb.kb;if(Xg.TableCellReader.Roa(b))return this.oyi(b,D)?Gb.a.KG:Gb.a.z5d;hf.OutlineElementNavigator.Vd(b);if($e.SelectionEditor.gf(h))ig.OutlineElementReader.HA(b,h,!1)&&this.Xqj(b)?v=Gb.a.gMb:$e.SelectionEditor.YVc(P,
ca)&&this.jq.zAb(b)?v=Gb.a.KG:$e.SelectionEditor.YVc(P,ca)&&(v=Gb.a.KG);else if($e.SelectionEditor.nl(h)){if(!this.jq.zAb(b))return v;$e.SelectionEditor.Kjb(h)?v=Gb.a.KG:$e.SelectionEditor.kDi(h)&&(v=this.Xqj(b)?Gb.a.gMb:Gb.a.KG)}else this.jq.zAb(b)&&(v=Gb.a.KG);return v}Llm(b,h,v,D){if(Xg.TableCellReader.b0(b))return this.oyi(b,D)?Gb.a.pO:v;hf.OutlineElementNavigator.Vd(b);if($e.SelectionEditor.gf(h))ig.OutlineElementReader.HA(b,h,!1)&&(!Vg.ListItemReader.yg(b)&&ig.OutlineElementReader.isEmpty(b,
!1)?v=Oc.ActionManager.pxa:this.sso(b)?v=Gb.a.Nfb:this.gqj(b)?v=Gb.a.lCb:this.jq.u2b(b)&&(v=Gb.a.pO));else if($e.SelectionEditor.nl(h)){if(!this.jq.u2b(b))return v;$e.SelectionEditor.Kjb(h)?v=Gb.a.pO:$e.SelectionEditor.kDi(h)&&(v=this.gqj(b)?Gb.a.lCb:Gb.a.pO)}else this.jq.u2b(b)&&(v=Gb.a.pO);return v}Xqj(b){return Vg.ListItemReader.yg(b)?!1:0<ig.OutlineElementReader.U3(b)?!0:!1}gqj(b){if(Vg.ListItemReader.yg(b))return!1;const h=ig.OutlineElementReader.U3(b);b=Ei.OutlineReader.vX(b.currentNode);return h<
b?!0:!1}sso(b){return Vg.ListItemReader.yg(b)?!1:0<ig.OutlineElementReader.xG(b)?!0:!1}static Mr(){return new yH(kt.a.dFb)}oyi(b,h){if(this.oRm){h=h.view;const v=h.lb.gb.kb,D=new he.GraphIterator;D.Zc(b);hf.OutlineElementNavigator.Vd(D);if(Vg.ListItemReader.yg(D)&&$e.SelectionEditor.YVc(h,v))return!0}return!1}get oRm(){var b;w.AFrameworkApplication.ue("egdi3422;7g6fa693");return null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",
!1)}}Object(n.a)(yH,"TabActorPromoteDemoteStrategy",null,[382]);class mE extends NF{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac){super(b,h,v,D,P,ca,ta,Ra,mb,Jb);this.W7d=(Lc,id)=>{Lc=id.property;!this.Y4c||Lc!==Bc.a.Ao&&Lc!==Bc.a.marginLeft&&Lc!==Bc.a.marginRight||this.Y4c.dui()};this.vX=(Lc,id,vd,xe,Ld)=>{Lc=Ei.OutlineReader.vX(this.h8l(id));Ld.defaultTabStop=Lc;return 32};this.CXb=Ub;this.ga=Ac;this.UB();this.ga.qa(Nc.a.vX,sc.a.view,this.vX)}get Y4c(){return null!=this.jGg?this.jGg:this.jGg=Ea.a.instance.Na("WordEditor.Actors.RenderParagraphsContainingTabs")}UB(){this.CXb.zl.Ze(10).Go(this.W7d)}psi(b){const h=
b.view,v=h.lb;b=v.tg;if(this.lJa&&this.Ic){var D=this.Ic.Oc(15);D.Cb(b.node);b.contextId===sc.a.Hd&&w.AFrameworkApplication.va.processAction(Gb.a.AH,2);this.lJa.hXd(v.tg);D.dispose();var P=$e.SelectionEditor.p3(v.gb.kb).y;Xa.App.mhc(()=>{this.FZc(v,h,P)})}}h8l(b){return b.view.lb.gb.kb.Oa.node}static get instance(){return null!=mE.UCg?mE.UCg:mE.UCg=mE.Rl()}static Rl(){return new mE(()=>Ea.a.instance.resolve("Box4.IUndoManager"),yH.Mr(),Ea.a.instance.Sa("Box4.IExternalSelectionManager"),Ea.a.instance.resolve("Box4.IAutoCorrectRules"),
Ea.a.instance.resolve("Box4.IAutoCorrectScheduler"),Ea.a.instance.Na("Box4.ITabPresenterFactory"),Ea.a.instance.Na("Box4.IBlobEditor"),Ea.a.instance.Na("Box4.IFeatureHelper"),Ea.a.instance.Na("Box4.Graph.GraphTransactionFactory"),Ea.a.instance.Na("Box4.Actors.IIFrameFocusStrategy"),Xa.App.Xj,Ea.a.instance.Na("Box4.ITabRenderer"),w.AFrameworkApplication.va)}}Object(n.a)(mE,"TabActor",NF,[]);class Rx{static get tt(){return null!=Rx.mwg?Rx.mwg:Rx.mwg=Ea.a.instance.resolve("Box4.IAppFrame")}static initialize(){os.a.Mbc=
Rx.lSm;os.a.wle=Rx.S5o}static lSm(b){return!cj.TableReader.fNm(b)}static emb(){Rx.tt.yhc(Rx.emb);Rx.ewb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static S5o(b){var h,v,D;b&&((null===(h=Jr.a.instance.kb)||void 0===h?0:h.JFa)||(null===(v=Jr.a.instance.kb)||void 0===v?0:v.uw)||(null===(D=Jr.a.instance.kb)||void 0===D?0:D.qIb))&&!Rx.ewb&&(Rx.tt.eZa(Rx.emb),
Rx.ewb=!0)}}Rx.ewb=!1;Object(n.a)(Rx,"TableActor",null,[]);var WM=c(910);class zH{QEl(b,h,v,D){return b?this.rDl(h,v,D):this.REl(h,v,D)}Q_h(b,h,v,D,P){return b?this.tEl(h,v,D,P):this.gEl(h,v,D,P)}dEl(b){let h=!1;var v=b.Lf?b.Me.Pc:b.Me.Oa;b=new he.GraphIterator;b.set(v.node);b.zb(14);v=null;Xg.TableCellReader.lca(b)?Xg.TableCellReader.GHb(b)||(h=!0,v=ch.moveToNextRow(b)):v=ch.moveToNextColumn(b);return{returnValue:v,ngn:h}}oEl(b){var h=b.Lf?b.Me.Pc:b.Me.Oa;const v=new he.GraphIterator;v.set(h.node);
v.zb(14);h=null;Xg.TableCellReader.qha(v)?Xg.TableCellReader.pha(v)||(h=new he.GraphIterator,h.set(b.CCa.node),h.zb(14),b=Bl.a.Bs(h),Bl.a.Bs(v)>b?(ch.moveToPreviousRow(v),ch.moveToLastColumn(v),h=v.currentNode):h=ch.moveToPreviousRow(v)):h=ch.moveToPreviousColumn(v);return h}d0h(b,h){var v=b.Lf?b.Me.Pc:b.Me.Oa;b=new he.GraphIterator;b.set(v.node);b.zb(14);v=null;h?Xg.TableCellReader.pha(b)||(v=ch.moveToPreviousRow(b)):Xg.TableCellReader.GHb(b)||(v=ch.moveToNextRow(b));return v}EIb(b,h,v){for(;Xg.TableCellReader.hg(b);)if(h){if(v&&
b.Bwa(1)||!v&&b.Iwa(1))return null;v?ch.moveToPreviousColumn(b):ch.moveToNextColumn(b)}else{if(Xg.TableCellReader.r4(b.currentNode)){const D=new he.GraphIterator;D.Zc(b);if(this.EIb(D,!0,!0)||this.EIb(D,!0,!1)){b.Zc(D);break}}else{if(!v&&ch.moveToControllingCell(b,2))break;if(v&&ch.moveToControllingCell(b))break}if(v&&Xg.TableCellReader.pha(b)||!v&&Xg.TableCellReader.GHb(b))return null;v?ch.moveToPreviousRow(b):ch.moveToNextRow(b)}return b.currentNode}H6b(b,h){if(!Bl.a.isTableRow(b))return null;b=
he.GraphIterator.$a(b.currentNode);b.zb(14);let v;const D=cj.TableReader.DB(b.origin);do v=h?ch.moveToPreviousRow(b):ch.moveToNextRow(b);while(D&&v&&Bl.a.hQa(b));return v}Flb(b,h,v,D,P){let ca=null;hf.OutlineElementNavigator.Vd(b);const ta=ig.OutlineElementReader.isRtl(b.currentNode);if(v)if(ch.returnToCell(b),h=Xg.TableCellReader.lca(b),v=Xg.TableCellReader.qha(b),P||!ta&&v||ta&&D&&h)ch.returnToContainingRow(b),(D=this.H6b(b,!0))?ca=Og.SelectionFactory.ho(D,!h):P&&(hf.OutlineElementNavigator.Vd(b),
P=new Rl.a,P.Zc(b),(b=hf.OutlineElementNavigator.t0(P,!1,!1))&&(ca=Og.SelectionFactory.ho(b,!1)));else{do ta?ch.moveToNextColumn(b):ch.moveToPreviousColumn(b);while(Xg.TableCellReader.hg(b)&&!Xg.TableCellReader.pha(b));Xg.TableCellReader.hg(b)||(ca=Og.SelectionFactory.ho(b.currentNode,!ta))}else ig.OutlineElementReader.HA(b,h,ta)||$e.SelectionEditor.gf(h)||ch.returnToCell(b),ca=Og.SelectionFactory.ho(b.currentNode,!ta);return ca}Elb(b,h,v,D,P){let ca=null;hf.OutlineElementNavigator.Vd(b);const ta=
ig.OutlineElementReader.isRtl(b.currentNode);if(v)if(ch.returnToCell(b),v=Xg.TableCellReader.lca(b),h=Xg.TableCellReader.qha(b),P||!ta&&D&&v||ta&&!D&&h)ch.returnToContainingRow(b),(D=this.H6b(b,!1))?ca=Og.SelectionFactory.ho(D,h):(hf.OutlineElementNavigator.Vd(b),D=new Rl.a,D.Zc(b),(b=hf.OutlineElementNavigator.Xr(D,!1,!1))&&(ca=Og.SelectionFactory.ho(b,!0)));else{do ta?ch.moveToPreviousColumn(b):ch.moveToNextColumn(b);while(Xg.TableCellReader.hg(b)&&!Xg.TableCellReader.lca(b));Xg.TableCellReader.hg(b)||
(ca=Og.SelectionFactory.ho(b.currentNode,ta))}else ig.OutlineElementReader.HA(b,h,!ta)||$e.SelectionEditor.gf(h)||ch.returnToCell(b),ca=Og.SelectionFactory.ho(b.currentNode,ta);return ca}}Object(n.a)(zH,"ATableCellSelectionStrategy",null,[1570]);class MK extends zH{constructor(){super()}gEl(b,h,v,D){let P=b.kb,ca=null;if(b.uw)if(h)if(2===P.Me.Uha&&!P.Lf&&P.Me.Pc.equals(P.CCa))P=Og.SelectionFactory.nNh(P.CCa.node,!1);else{var ta=({ngn:b}=this.dEl(P)).returnValue;ta&&(Xg.TableCellReader.Ur(ta)&&(ta=
he.GraphIterator.$a(ta),ta.zb(14),ta=!b&&this.EIb(ta,!0,!1)?ta.currentNode:b||ch.moveToNextRow(ta)?this.EIb(ta,!1,!1):null),ta&&(ca=Og.SelectionFactory.Nn(Zt.TableNodeContext.create(ta),P.Lf)))}else P=b.Cda,b=he.GraphIterator.$a(P.Me.Pc.node),b.zb(14),Xg.TableCellReader.vFa(b.currentNode)&&ch.moveToLastGhostCell(b,2),(ta=ch.moveToNextColumn(b))?(b=Xg.TableCellReader.r4(ta),Xg.TableCellReader.Ur(ta)&&!b&&(ta=he.GraphIterator.$a(ta),ta.zb(14),ta=ch.moveToControllingCell(ta)),b?P=Og.SelectionFactory.ho(P.Me.Pc.node,
!1):ca=Og.SelectionFactory.ho(ta,!0)):(ta=P.Me.Pc.node,ca=Og.SelectionFactory.ho(ta,!1));else b=h&&P.Lf||!h&&!P.Wwa?P.Me.Pc:P.Me.Oa,Bl.a.Soa(b.node)&&(b=he.GraphIterator.$a(b.node),(ta=this.H6b(b,!1))?ca=h?Og.SelectionFactory.Nn(Zt.TableNodeContext.create(ta),P.Lf):Og.SelectionFactory.ho(ta,!0):P=$e.SelectionEditor.Cj(Og.SelectionFactory.wq(b.currentNode),!1,!0));return ca?ca:D?$e.SelectionEditor.G6b(P,!1,h,!0):$e.SelectionEditor.tva(P,{RA:!h,Cs:h,HC:v,jE:!0})}tEl(b,h,v,D){let P=b.kb;var ca=null;
if(b.uw)h?1===P.Me.Uha&&P.Lf&&P.Me.Oa.equals(P.CCa)||(ca=this.oEl(P),(ca=this.O_h(P,ca))||P.Lf&&(P=P.EMc())):(P=b.Cda,ca=Og.SelectionFactory.ho(P.Me.Oa.node,!0));else if(h){var ta=(P.Lf?P.Me.Pc:P.Me.Oa).node;b=he.GraphIterator.$a(ta);$e.SelectionEditor.ru(b);Bl.a.Soa(ta)&&(P.Lf&&1===P.Me.Uha&&P.Wwa?(ca=Bl.a.uB(ta).toArray(),(ca=this.O_h(P,0<=ca.length-2?ca[ca.length-2]:null))||P.Lf&&(P=P.EMc())):(ta=this.H6b(b,!0))?ca=Og.SelectionFactory.Nn(Zt.TableNodeContext.create(ta),P.Lf):P=Og.SelectionFactory.ho(b.currentNode,
!0))}else ca=$e.SelectionEditor.Cj(P,!0,!1);return ca?ca:D?$e.SelectionEditor.G6b(P,!0,h,!0):$e.SelectionEditor.ZDa(P,{RA:!h,Cs:h,HC:v,jE:!0})}O_h(b,h){if(!h)return null;var v=h;Xg.TableCellReader.Ur(h)&&(v=he.GraphIterator.$a(h),v.zb(14),v=this.EIb(v,!0,!0)?v.currentNode:Xg.TableCellReader.xga(h));return v?Og.SelectionFactory.Nn(Zt.TableNodeContext.create(v),b.Lf):null}REl(b,h,v){let D=h.kb,P=null;if(h.uw){var ca=h.gX>h.cIa;if(v)if(2===h.length&&1===h.Cda.Me.Uha&&ca)D=$e.SelectionEditor.Cj(D,!0,
!1);else{if(h=this.d0h(D,!0))Xg.TableCellReader.Ur(h)&&(h=he.GraphIterator.$a(h),h.zb(14),h=this.EIb(h,!1,!0)),h&&(P=Og.SelectionFactory.Nn(Zt.TableNodeContext.create(h),D.Lf));P||D.Lf&&(D=D.EMc())}else ca&&(D=h.Cda)}else h=v&&D.Lf?D.Me.Pc:D.Me.Oa,Bl.a.Soa(h.node)&&(h=he.GraphIterator.$a(h.node),(ca=this.H6b(h,!0))?P=v?Og.SelectionFactory.Nn(Zt.TableNodeContext.create(ca),D.Lf):Og.SelectionFactory.ho(ca,!0):v&&(D=Og.SelectionFactory.ho(h.currentNode,!0)));return P?P:$e.SelectionEditor.tfb(b,D,!1,
v,v)}rDl(b,h,v){let D=h.kb,P=null;if(h.uw){const ca=h.gX<h.cIa;if(v)if(2===h.length&&1===h.Cda.Me.Uha&&ca)D=$e.SelectionEditor.Cj(D,!1,!1);else{if(h=this.d0h(D,!1))Xg.TableCellReader.Ur(h)&&(h=he.GraphIterator.$a(h),h.zb(14),h=this.EIb(h,!1,!1)),h&&(P=Og.SelectionFactory.Nn(Zt.TableNodeContext.create(h),D.Lf))}else ca&&(D=h.Cda)}else h=!v||D.Lf?D.Me.Pc:D.Me.Oa,Bl.a.Soa(h.node)&&(h=he.GraphIterator.$a(h.node),(h=this.H6b(h,!1))&&(P=v?Og.SelectionFactory.Nn(Zt.TableNodeContext.create(h),D.Lf):Og.SelectionFactory.ho(h,
D.Wwa)));return P?P:$e.SelectionEditor.tfb(b,D,!0,v,v)}}Object(n.a)(MK,"TableCellSelectionStrategy",zH,[]);class NK{constructor(b){this.tL=(h,v,D,P,ca)=>{if(1===D)return 32;h=(new ci.a).create();v="";switch(ca.DialogType){case "DirectPrintPreparingPDF":v=CommonUIStrings.l_DirectPrintPreparingPDF;ca=CommonUIStrings.l_DefaultDialogTitle;break;default:ca=CommonUIStrings.l_DefaultDialogTitle}h.message=v;h.tL(ca,null,null);return 32};this.ga=b}Tb(){this.ga.eb(Gb.a.tL,sc.a.view,this.tL,1028)}}Object(n.a)(NK,
"UIAutomationActor",null,[]);class OK{constructor(b,h,v,D){this.fb=b;this.lJa=h;this.zpc=v;this.x6=D}flg(b,h,v){return this.zpc.cQm(h)?v?!0:b&&this.fb.sh(b)?(b=this.mw(b.currentNode),this.lJa.Bsi(b),!0):!1:!1}Xwf(b,h){return this.zpc.Yxl(b,h)}cxf(b){b&&this.fb.sh(b)&&(b=this.mw(b.currentNode),this.lJa.hXd(b))}mw(b){return we.a.mw(b)}S9(b,h,v){this.x6.a1i&&this.zpc.Uwi(v)&&(this.x6.S9(b,h),b.setValue(Wc.a.nxi,!0))}ohe(){}dZd(b){return this.zpc.dZd(b)}get l_d(){return this.zpc.l_d}eD(){}pda(){}Khe(){}get trj(){return!1}}
Object(n.a)(OK,"WordEditorPasteStewardBridge",null,[330]);class PK{constructor(b){this.ra=new Mc.a;this.Vgj="WordFileSaveAsButtonClicked";this.U5o=()=>{this.ra.raiseEvent(this.Vgj,null);return 32};this.ga=b}Tb(){w.AFrameworkApplication.K.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.qa(Nc.a.PLj,ud.a.frame,this.U5o)}rzk(b){this.ra.addHandler(this.Vgj,b)}}Object(n.a)(PK,"WordFileSaveAsActor",null,[]);class QK extends gv{constructor(){super()}MEc(b,h,v,D,P,ca,ta){return Ds.a.fgc(h,v,D,P,ca,ta)}}Object(n.a)(QK,
"WordIndentationActorExtension",gv,[]);class AH{constructor(){this.Wmd=null}get name(){return"WordEditor.Actors"}init(){var b;Pb.InteractiveViewManager.instance.editingView.S4b=!0;w.AFrameworkApplication.va.qa(Nc.a.Q4o,ud.a.frame,BM);this.W.resolve("WordEditor.Actors.DeleteActor").Tb(w.AFrameworkApplication.va);fE.instance.Tb();jn.Tb();Up.Tb(w.AFrameworkApplication.va,this.W.resolve("WordEditor.IMainViewModeManager"));Ck.Tb();mE.instance.Tb();WM.a.Tb();this.W.resolve("WordEditor.Actors.ModeSwitcherControlActor").Tb(w.AFrameworkApplication.va);
this.W.resolve("WordEditor.Actors.ExternalContentActor").Tb();this.W.resolve("WordEditor.OnlineMedia.OnlineMediaActor").Tb();w.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&this.W.resolve("Box4.Actors.FormatPainterActor").Tb();w.AFrameworkApplication.K.$("WordEditorAutoSaveImprovementIsEnabled")&&this.W.resolve("WordEditor.Actors.SaveStatusActor").Tb();w.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&w.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&(this.nW.u_d=
!0);w.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.W.resolve("WordEditor.Actors.ModernUxActor").Tb();w.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.W.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").Tb();this.W.resolve("WordEditor.Actors.AppFrameCommandUIActor").Tb();this.W.resolve("Common.IOfficeTrialExperience").Tb();this.W.resolve("Common.IMacOfficeOffer").Tb();
this.W.resolve("WordEditor.Actors.MarginsDialogActor").Tb();this.W.resolve("WordEditor.Actors.PaperSizeDialogActor").Tb();this.W.resolve("WordEditor.Actors.ColumnsDialogActor").Tb();this.W.resolve("WordEditor.Actors.FileDownloadActor").Tb();this.W.resolve("WordEditor.Actors.StylesActor").Tb();(null===(b=w.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&this.W.resolve("WordEditor.Actors.CustomizeRibbonActor").Tb();this.W.resolve("WordEditor.Actors.ParagraphDialogActor").Tb();
this.W.resolve("WordEditor.Actors.ProofingActor").Tb();this.W.resolve("WordEditor.Actors.PageActor").Tb();this.W.resolve("WordEditor.Actors.DarkModeActor").Tb();this.W.resolve("WordEditor.Actors.ImageActor").Tb(w.AFrameworkApplication.va);this.W.resolve("WordEditor.Actors.FormattingActor").Tb();this.W.resolve("WordEditor.Actors.UIAutomationActor").Tb();this.W.resolve("WordEditor.Actors.ContentControlActor").Tb();this.W.resolve("WordEditor.Actors.CustomTabActor").Tb();this.W.resolve("WordEditor.Actors.BookmarkActor").Tb();
this.W.resolve("WordEditor.Actors.HeadingsActor").Tb();this.W.resolve("Box4.Indicator.IIndicatorManager").G5a(this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"));this.W.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").Tb();this.W.resolve("WordEditor.Actors.AccessibilityActor").n4f();this.W.resolve("WordEditor.Actors.ISWordRequestManager");this.W.resolve("Box4.Actors.AutoCorrectActor").Tb();this.W.resolve("WordEditor.Actors.DigitalPrintActor").Tb();this.W.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");
this.W.resolve("Box4.Actors.VisiMarkersActor").Tb();this.W.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.W.resolve("WordEditor.Actors.ActionHangDetector").AY();this.W.resolve("WordEditor.Actors.WordFileSaveAsActor").Tb();w.AFrameworkApplication.K.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?this.hVn():this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb();this.XV.F5a(this.lYj);b=this.W.resolve("WordEditor.Bookmark.FullBookmarkManager");w.AFrameworkApplication.ue("bookmarks-core-ex;bookmarks-core-ex-cf");
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.Jqm()&&Xa.App.xa.ib.GWh();w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",!1)&&this.W.resolve("WordEditor.Actors.MiniTemplateActor").Tb();Xa.App.xa.updateCommandUI();Rx.initialize()}dispose(){}hVn(){this.ld.Pp.isCompleted?this.ld&&this.ld.isFeatureEnabled(49)&&this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb():this.ld.Pp.continueWith(()=>
{this.ld&&this.ld.isFeatureEnabled(49)&&(this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb(),Xa.App.xa.updateCommandUI())})}get wQm(){if(null==this.Wmd)if(this.ld)if(this.ld.Pp.isCompleted)this.Wmd=this.ld.isFeatureEnabled(3);else return!1;else this.Wmd=!1;return this.Wmd}xc(b){var h,v;this.W=b;this.ld=b.Na("Box4.IFeatureHelper");this.nW=this.W.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.nW.GVc=w.AFrameworkApplication.K.$("WordProofingSecondaryContextualMenuIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",
!1);(new jJ).xc(b);b.ha("Box4.IClipboardCommands",()=>new kJ(w.AFrameworkApplication.va,Gb.a.X4e,Gb.a.CFc,Gb.a.c_,Gb.a.FYf,Gb.a.paste,Gb.a.x9,Gb.a.anb)).singleInstance();b.ha("HtmlImport.IHtmlNormalizerSettings",()=>{const D=b.resolve("Common.IAppSettingsManager");return new dv(!0,D.$("SplitHyperlinkFixWithEnterIsEnabled"))}).singleInstance();b.ha("HtmlImport.IHtmlTranslatorSettings",()=>{const D=b.resolve("Common.IAppSettingsManager"),P=ca=>!ca.uac;return new gJ(D.$("PasteComplexTablesIsEnabled"),
!0,!0,!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,D.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,ca=>ca.uac,()=>!1,P,P,P,P,void 0,()=>this.wQm,ca=>!ca.uac)}).singleInstance();b.ha("WordEditor.Actors.WordEditorPasteStewardBridge",()=>new OK(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobEditor"),b.resolve("Box4.Actors.IBox4PasteStewardUtils"),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").singleInstance();b.ha("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",
()=>new BK(b.resolve("Wonca.ExternalContent.IExternalContentEditor"),b.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").singleInstance();b.ha("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",()=>new lJ).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").singleInstance();b.ha("Box4.IIndentationCommands",()=>new mJ(w.AFrameworkApplication.va)).singleInstance();b.ha("Box4.IJustificationCommands",()=>new nJ(w.AFrameworkApplication.va)).singleInstance();
b.ha("Box4.ISpacingCommands",()=>new oJ(w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.IPageCommands",()=>new xK(w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.Actors.StylesActor",()=>new JK(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"))).singleInstance();(null===(h=w.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&b.ha("WordEditor.Actors.CustomizeRibbonActor",()=>new LF(w.AFrameworkApplication.va)).singleInstance();
b.ha("WordEditor.Actors.DigitalPrintActor",()=>new qH(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"))).singleInstance();b.ha("WordEditor.Actors.FileDownloadManager",()=>new dK(b.resolve("Common.App.DirectPrint.IDirectPrintManager"),new tM.a)).singleInstance();b.ha("WordEditor.Actors.FileDownloadActor",()=>new aK(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),b.resolve("WordEditor.Actors.FileDownloadManager"),w.AFrameworkApplication.K.$("DisablePrint"),w.AFrameworkApplication.K.jb("IrmPolicyDescription"),
b.resolve("WordEditor.IBusinessBarController"))).singleInstance();b.ha("WordEditor.Actors.ParagraphDialogActor",()=>new zK(w.AFrameworkApplication.va,b.Ue("Box4.UI.IBox4DialogFactory"),b.resolve("WordEditor.LineSpacingHelper"),Xm.a.instance,b.resolve("Box4.IParagraphIndentationReader"))).singleInstance();b.ha("WordEditor.Actors.MarginsDialogActor",()=>new uK(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),Xm.a.instance)).singleInstance();b.ha("WordEditor.Actors.ColumnsDialogActor",
()=>new UJ(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),Xm.a.instance)).singleInstance();b.ha("WordEditor.Actors.ModeSwitcherControlActor",()=>new sE.a(b.Sa("Common.ISystemInitiatedFeedback"),uJ.a.K7b())).as("WordEditor.IModeSwitcherControl").singleInstance();b.ha("WordEditor.Actors.PaperSizeDialogActor",()=>new yK(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),Xm.a.instance)).singleInstance();b.ha("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new oK(b.resolve("Box4.Proofing.IIgnoreAllKeywords"))).singleInstance();
b.register(ZJ,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").singleInstance();b.ha("WordEditor.Actors.ProofingActor",()=>new CK(w.AFrameworkApplication.va,qi.a.instance,Ea.a.instance.resolve("Box4.ISelectionManager"),jp.a.instance,Ea.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),Ea.a.instance.resolve("Box4.ILanguageReader"),Ea.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Ea.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),Ea.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),
this.nW,Ea.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),w.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),Ea.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();(w.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):b.resolve("Common.IDynamicScriptLoaderProvider").Uz.loadScript("EditorSettingsManager")).then(()=>{const D=b.resolve("Box4.Proofing.IEditorSettingsManagerActor");D.fym();
D.init();b.ha("Box4.Proofing.EditorSettingsUIActor",()=>new pJ(w.AFrameworkApplication.va,b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new qJ(b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),b.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).singleInstance();w.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&w.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve("Box4.Proofing.EditorSettingsUIActor").Tb()});b.ha("WordEditor.Actors.PageActor",
()=>new wK(Ea.a.instance.resolve("Box4.IWordSectionEditor"),Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ea.a.instance.resolve("WordEditor.IMainViewModeManager"),Ea.a.instance.Sa("Common.ISystemInitiatedFeedback"))).as("WordEditor.IPageCommandStringBuilder").singleInstance();b.ha("WordEditor.Actors.DarkModeActor",()=>new XJ(w.AFrameworkApplication.va,w.AFrameworkApplication.K,Xa.App.Hda,!!Xa.App.instance&&Xa.App.instance.uFa,!!Xa.App.instance&&Xa.App.instance.bWc,
Ea.a.instance.resolve("Box4.IDarkModeState"),Ea.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Ea.a.instance.resolve("Box4.DarkModeEventsManager"),!!Xa.App.instance&&Xa.App.instance.Hoa)).singleInstance();b.ha("WordEditor.FlatListDetailsProvider",()=>new fK(b.resolve("WordEditor.IFlatListEditor")));b.ha("WordEditor.Actors.AccessibilityActor",()=>new CJ(b.Sa("Box4.Accessibility.IAccessibilityContextManager"),b.Ue("WordEditor.FlatListDetailsProvider"),b.Ue("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),
b.Ue("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).singleInstance();b.ha("WordEditor.Actors.AppFrameCommandUIActor",()=>new QJ(w.AFrameworkApplication.va,b.Sa("Postmessage.IHostPostmessenger"))).singleInstance();b.ha("WordEditor.Actors.ImageActor",()=>new fr(b.resolve("WordEditor.IImageEditor"),b.Sa("Box4.IExternalSelectionManager"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("WordEditor.Actors.ISWordRequestManager"),
b.resolve("Box4.IUndoManager"),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.Images.ImageNavigator"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.IAppFrame"),w.AFrameworkApplication.K)).as("Box4.Actors.ImageActor").singleInstance();b.ha("WordEditor.Actors.WordFileSaveAsActor",()=>new PK(w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.Actors.RenderedImageEditOperation.Factory",()=>new GK(b.resolve("WordEditor.IImageEditor"),w.AFrameworkApplication.K,
w.AFrameworkApplication.ta.EPa,Ea.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.Actors.DeleteActor",()=>new YJ.DeleteActor(Ea.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ea.a.instance.Sa("Box4.ContentControlConfigSettings"),Ea.a.instance.Sa("Box4.IContentControlEditor"),
Ea.a.instance.resolve("Box4.IDynamicRangeEditor"),Ea.a.instance.Sa("WordEditor.Bookmark.IBookmarkManager"),Ea.a.instance.resolve("Box4.IHyperlinkEditor"),Ea.a.instance.resolve("Box4.IHyperlinkStrategy"),Ea.a.instance.resolve("Box4.IParagraphReader"),Ea.a.instance.resolve("Box4.IParagraphIndentationReader"),Ea.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ea.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ea.a.instance.resolve("Box4.ContentControl.ContentControlViewElementManager"))).singleInstance();
this.W.ha("WordEditor.Actors.SWordRequestManager",()=>new LK(b.resolve("Box4.Images.IImageReader"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),w.AFrameworkApplication.K)).as("WordEditor.Actors.ISWordRequestManager").singleInstance();b.ha("WordEditor.Actors.TableCellSelectionStrategy",()=>new MK).as("Box4.ITableCellSelectionStrategy").singleInstance();w.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&b.ha("Box4.Actors.FormatPainter",()=>new rJ(b.resolve("Box4.Styles.IWACStyleEditor"),
b.resolve("Box4.IInsertionPointFormatting"),b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.ICharacterPropertiesEditor"),qi.a.instance,b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.Styles.IWACStyleReader"),
b.resolve("Box4.IContentControlChpHelper"))).as("Box4.IFormatPainter").singleInstance();b.ha("Box4.Actors.FormatPainterActor",()=>new gE(Xa.App.xa,bd.FocusManager.instance(),w.AFrameworkApplication.va,bf.a.instance,Jr.a.instance,b.resolve("Box4.IFormatPainter"),b.resolve("Box4.ISelectionManager"),!0,b.resolve("Box4.ICssColorProvider"),!!Xa.App.instance&&Xa.App.instance.Hoa,b.resolve("Box4.DarkModeEventsManager"))).singleInstance();b.ha("WordEditor.Actors.FormattingActor",()=>new gK(w.AFrameworkApplication.va,
b.resolve("Box4.List.IListReader"))).singleInstance();b.ha("WordEditor.Actors.UIAutomationActor",()=>new NK(w.AFrameworkApplication.va)).singleInstance();b.ha("WordEditor.Actors.SaveStatusActor",()=>new IK(w.AFrameworkApplication.va,b.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).singleInstance();b.ha("Box4.Actors.IEnterViewStrategy",()=>new sJ(b.Na("Box4.IAutoCorrectScheduler"),b.Ue("Box4.IUndoManager"),b.Sa("Box4.IExternalSelectionManager"))).singleInstance();b.ha("Box4.ISelectAllHandlers",
()=>new lD(Ih.PageReader.instance,b.Ue("Box4.IUndoManager"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).singleInstance();b.ha("WordEditor.Actors.ContentControlActor",()=>new VJ(b.resolve("WordEditor.ContentControl.IContentControlManager"),b.resolve("WordEditor.ContentControl.IGlossaryNavigator"),b.resolve("Box4.IFormattingEditor"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlOperator"),b.resolve("Box4.ICharacterPropertiesEditor"),
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Styles.IWACStyleReader"),w.AFrameworkApplication.va,w.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),b.resolve("WordEditor.ContentControl.IContentControlFormattingManager"))).singleInstance();b.ha("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new DJ(w.AFrameworkApplication.va,b.Ue("WordEditor.UI.IDialogFactory"),bd.FocusManager.instance())).singleInstance();b.ha("Box4.Actors.FontNameFormattingStrategyNoop",
()=>new tJ).as("Box4.Actors.IFontNameFormattingStrategy").singleInstance();b.ha("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",()=>new vG(w.AFrameworkApplication.Ne,Wk.PageNavigator.instance,b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("WordEditor.IImageEditor"),Ea.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),w.AFrameworkApplication.K,b.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").singleInstance();
b.ha("WordEditor.Actors.GraphicsEditorActor",()=>new lK(w.AFrameworkApplication.va,w.AFrameworkApplication.K,b.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),b.resolve("WordEditor.IImageEditor"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("Box4.Images.IImageReader"),w.AFrameworkApplication.Ne,
this.ld,b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();b.ha("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new HK).singleInstance();b.ha("WordEditor.Actors.CustomTabActor",()=>new WJ(w.AFrameworkApplication.va,b.resolve("WordEditor.ICustomTabStopUtility"),b.resolve("Box4.IOutlineEditor"))).singleInstance();b.ha("WordEditor.Actors.HeadingsActor",()=>new mK(b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),w.AFrameworkApplication.va,
b.resolve("Box4.IParagraphReader"))).singleInstance();b.ha("WordEditor.Actors.BookmarkActor",()=>new TJ(Xa.App.xa,w.AFrameworkApplication.va,Yh.a.instance,b.resolve("WordEditor.Bookmark.FullBookmarkManager"),new Gg.a(()=>Xa.App.xa.ib.Uc),this.W.resolve("Box4.Indicator.IIndicatorManager"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"),this.W.resolve("Common.IReactContextualUILauncher"),this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"),jp.a.instance,this.W.Sa("Common.ISystemInitiatedFeedback"),
b.resolve("Box4.IOutlineElementNavigator"),Pb.InteractiveViewManager.instance,this.W.Ue("WordEditor.UI.IDialogFactory"),this.W.resolve("Box4.BookmarkParagraphMapping"),qi.a.instance)).singleInstance();b.ha("WordEditor.Actors.BookmarkIndicatorActor",()=>{var D,P;return new at(b.resolve("Box4.IParagraphReader"),xf.a.instance,Th.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),b.resolve("Box4.IInteractiveEventHandler"),null!==(P=null===(D=Xa.App.instance)||void 0===D?void 0:D.RC)&&void 0!==
P?P:!1,new Gg.a(()=>Xa.App.xa.ib.rc))}).singleInstance();b.ha("Box4.Actors.IIFrameFocusStrategy",()=>new nK).singleInstance();b.ha("WordEditor.Actors.ExternalContentFloatiePositionProvider",()=>new kE(Yh.a.instance,b.resolve("Box4.ITextMetricsAdapter"),Pb.InteractiveViewManager.instance,Dd.a.getElementBounds,b.resolve("Box4.UI.ExternalContentFloatieManager"))).singleInstance();b.ha("WordEditor.Actors.ExternalContentActor",()=>new ct(w.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),w.AFrameworkApplication.K,
b.resolve("Wonca.ExternalContent.IExternalContentEditor"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).as("WordEditor.Actors.ExternalContentActor").singleInstance();b.ha("Box4.UI.ExternalContentFloatieManager",()=>new BJ).as("Box4.UI.IFloatieManager").singleInstance();b.ha("WordEditor.Actors.ActionHangDetector",()=>new EJ(w.AFrameworkApplication.K,w.AFrameworkApplication.va)).as("WordEditor.Actors.ActionHangDetector").singleInstance();
b.ha("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new jE(b.resolve("Box4.UI.ExternalContentFloatieManager"),b.resolve("Box4.IExternalContentFloatieEventSource"),Pb.InteractiveViewManager.instance,Hz.a.instance(),w.AFrameworkApplication.ta,b.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Xa.App.Xj.zl.Ze(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),
b.resolve("Box4.SelectionManager"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).singleInstance();b.ha("Box4.Actors.WordIndentationActorExtension",()=>new QK).as("Box4.Actors.IIndentationActorExtension").singleInstance();w.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&(w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordModernUxExperimentOneSettings"),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",
!1)&&b.ha("WordEditor.Actors.ModernUxActor",()=>new vH(w.AFrameworkApplication.va)).singleInstance());w.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ha("WordEditor.Actors.SwitchToClassicViewModeActor",()=>new GG(w.AFrameworkApplication.va)).singleInstance();(new fJ).xc(b);b.ha("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new AJ(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").singleInstance();
b.ha("WordEditor.OnlineMedia.InsertHubbleMediaHelper",()=>new xJ(w.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),!!Xa.App.instance&&Xa.App.instance.D0d)).singleInstance();b.ha("WordEditor.OnlineMedia.OnlineMediaActor",()=>new yJ(w.AFrameworkApplication.va,w.AFrameworkApplication.K,b.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),b.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),b.resolve("Wonca.ExternalContent.IExternalContentEditor"),qi.a.instance,w.AFrameworkApplication.K.$("GetCustomHeaderEnabled")?
Ea.a.instance.resolve("Common.App.OAuth.IOAuthManager"):void 0)).singleInstance();(null===(v=w.AFrameworkApplication.K)||void 0===v?0:v.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",!1))&&b.ha("WordEditor.Actors.MiniTemplateActor",()=>new vK(w.AFrameworkApplication.va,b.Sa("WordEditor.Extension.IInsertApiOperations"),b.Sa("WordEditor.Designer.Style.IParagraphDesigner"),uJ.a.K7b())).singleInstance();this.lYj=new vJ;this.XV=this.W.resolve("Box4.Highlight.IHighlightManager")}static main(){N.a.instance.Fc(new AH)}}
Object(n.a)(AH,"WordEditorActorsPackage",null,[1,2]);class RK{constructor(b){this.vvc=!1;this.jVi=()=>{this.vvc=!0;this.ns.Tde(this.jVi)};this.ns=b;this.ns.vzb(this.jVi)}}Object(n.a)(RK,"GraphFullyConnectedGetter",null,[417]);class cg{constructor(){this.Z4g=Object.assign(new Ko.a,{})}ysk(b,h){let v;const D=b&1023;({value:v}=this.Z4g.Dc(D,0)).returnValue||cg.alm().contains(D)||u.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,D);v+=h;this.Z4g.Z(D,v);return v}static alm(){cg.Pvd||
(cg.Pvd=new Ga.a,cg.qc(0),cg.qc(1),cg.qc(2),cg.qc(3),cg.qc(4),cg.qc(5),cg.qc(6),cg.qc(7),cg.qc(8),cg.qc(9),cg.qc(10),cg.qc(11),cg.qc(12),cg.qc(13),cg.qc(14),cg.qc(15),cg.qc(16),cg.qc(17),cg.qc(18),cg.qc(19),cg.qc(20),cg.qc(21),cg.qc(22),cg.qc(23),cg.qc(24),cg.qc(25),cg.qc(26),cg.qc(27),cg.qc(28),cg.qc(29),cg.qc(30),cg.qc(31),cg.qc(32),cg.qc(33),cg.qc(34),cg.qc(35),cg.qc(36),cg.qc(37),cg.qc(38),cg.qc(39),cg.qc(40),cg.qc(41),cg.qc(42),cg.qc(43),cg.qc(44),cg.qc(45),cg.qc(46),cg.qc(47),cg.qc(48),cg.qc(49),
cg.qc(50),cg.qc(51),cg.qc(52),cg.qc(53),cg.qc(54),cg.qc(55),cg.qc(56),cg.qc(57),cg.qc(58),cg.qc(59),cg.qc(60),cg.qc(61),cg.qc(62),cg.qc(63),cg.qc(64),cg.qc(65),cg.qc(66),cg.qc(67),cg.qc(68),cg.qc(69),cg.qc(70),cg.qc(71),cg.qc(72),cg.qc(73),cg.qc(74),cg.qc(75),cg.qc(76),cg.qc(77),cg.qc(78),cg.qc(79),cg.qc(80),cg.qc(81),cg.qc(82),cg.qc(83),cg.qc(84),cg.qc(85),cg.qc(86),cg.qc(87),cg.qc(88),cg.qc(89),cg.qc(90),cg.qc(91),cg.qc(92),cg.qc(93),cg.qc(94),cg.qc(95),cg.qc(96),cg.qc(97),cg.qc(98),cg.qc(99),cg.qc(100),
cg.qc(101),cg.qc(102),cg.qc(103),cg.qc(104),cg.qc(105),cg.qc(106),cg.qc(107),cg.qc(108),cg.qc(109),cg.qc(110),cg.qc(111),cg.qc(112),cg.qc(113),cg.qc(114),cg.qc(115),cg.qc(116),cg.qc(117),cg.qc(118),cg.qc(119),cg.qc(120),cg.qc(121),cg.qc(122),cg.qc(124),cg.qc(126),cg.qc(127),cg.qc(128),cg.qc(129),cg.qc(130),cg.qc(131),cg.qc(132),cg.qc(133),cg.qc(134),cg.qc(135),cg.qc(136),cg.qc(140),cg.qc(145),cg.qc(146),cg.qc(147));return cg.Pvd}static qc(b){cg.Pvd.add(b&1023)}}cg.Pvd=null;Object(n.a)(cg,"LanguagePerParagraphModel",
null,[]);class SK{constructor(){this.geg=!1;this.wDd=this.vDd=this.QRb=0;this.MDi=!0;this.t8o=0}}Object(n.a)(SK,"UpdateWordCountStateResult",null,[]);class TK extends Sys.EventArgs{constructor(b){super();this.isEnabled=b}}Object(n.a)(TK,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class UK{constructor(){this.ECh=this.DCh=this.wordCount=-1;this.ICb=this.fyh=0;this.HCb=1;this.s0i=1033}}Object(n.a)(UK,"WordCountCache",null,[]);class VK extends Sys.EventArgs{constructor(b){super();this.state=
b}}Object(n.a)(VK,"WordCountChangedEventArg",Sys.EventArgs,[]);class WK{constructor(){this.ync=this.LCa=0}}Object(n.a)(WK,"CharsCountResult",null,[]);class XK{constructor(){this.cp=0;this.Anc=null;this.E7=this.F7=0}}Object(n.a)(XK,"TextChunkResult",null,[]);class YK{constructor(){this.DLj=this.F7=this.E7=this.wordCount=0}}Object(n.a)(YK,"WordCountStateForParagraph",null,[]);class BH{constructor(){this.e$=this.rJ=this.F7=this.E7=this.AR=this.wordCount=0;this.currentNode=null;this.gX=-1;this.cp=0;this.XYf=
[];this.HCb=this.ICb=this.CZa=this.SYf=this.TYf=0;this.hI=this.Uxi=!1;this.Uqb=new Fb.a;this.I3a=new Fb.a}}Object(n.a)(BH,"WordCountState",null,[]);class gr{constructor(b,h,v,D,P,ca){this.aDo=1E3;this.ra=new Mc.a;this.Vyb=null;this.tse=0;this.i4j="\ue000";this.nsc=!1;this.Ixe=this.xxe=this.lhd=0;this.dRg=this.lRg=null;this.txe=this.sxe=this.Cxe=0;this.hrl=ta=>{this.Vyb=null;this.fgf(ta.customData)};this.MF=h;this.x2j=new RegExp(Po.AParagraphNode.DC,"g");this.Gd=b;this.taskManager=D;this.Nm=v;this.QYa=
ca;this.pWa=P.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.bjk=P.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.eej()}get uWm(){return!!this.Vyb}get cOa(){return this.nsc}set cOa(b){this.nsc=b}get Vyd(){return this.tse}set Vyd(b){this.tse=b}get KQa(){return!this.tse}get ny(){return this.lhd}get QBb(){return this.xxe}get UBb(){return this.Ixe}get rhl(){return this.lRg}get Bcf(){return this.dRg}get bJc(){return this.Cxe}get $Ic(){return this.sxe}get v4b(){return this.txe}vzb(b){this.ra.addHandler(gr.Cpe,
b)}Tde(b){this.ra.removeHandler(gr.Cpe,b)}g0e(b){this.ra.addHandler(gr.zpg,b)}S2n(b){this.ra.removeHandler(gr.zpg,b)}FId(){this.EId();this.eej()}eej(){this.Cxe=this.txe=this.sxe=this.Ixe=this.xxe=this.lhd=-1}Kdf(){this.pke(this.aDo)}F9c(){const b=new BH;b.Uxi=!0;this.EId();this.fgf(b)}pke(b,h=null){this.KQa&&(this.uWm&&(h=null,this.EId()),h||(h=new BH),b=new qf.a(3,1,b,this.hrl,this.xyj),b.customData=h,this.Vwk(b))}EId(){this.Vyb&&(this.taskManager.Xe(this.Vyb),this.Vyb=null)}FIj(b,h,v,D,P,ca=!0,
ta=-1,Ra=-1,mb=-1,Jb=1033){const Ub=new SK;Ub.QRb=v;Ub.vDd=P;Ub.wDd=D;if(!b.cp&&h.scd&&ca&&!this.yfi(h))return gr.f0o(b,h.scd),Ub.MDi=!0,Ub;D=0<=Ra&&0<=mb?{yd:Ra,endCp:mb}:void 0;v=this.sMl(h,D);D&&(Ra=D.yd,mb=D.endCp);v=0<=mb?v.substring(0,mb):v;mb=0<=Ra&&0<=mb?v.substring(Ra,mb):v;D=b.cp>=Ra?b.cp:Ra;P=b.XYf||[];ca=0<b.TYf?b.TYf:0;let cc=0<b.SYf?b.SYf:0,Ac=[];b.hI=!1;do{this.QYa.update();if(!b.Uxi&&(Ub.QRb+Ac.length/2>gr.y5o||this.QYa.Ilb())){let vd;P=(vd=P).concat.apply(vd,Ac);b.cp=D;b.XYf=P;b.SYf=
cc;b.TYf=ca;b.gX=ta;b.currentNode=h;this.pke(gr.U8o,b);Ub.geg=!0;b.hI=!0;return Ub}if((!D||D===Ra)&&0<v.length&&D<v.length){P.push(Mz.a.instance.jvf(v,D));var Lc=this.yfi(h);if(0<=ta&&!D&&Lc){b.wordCount+=1;Ub.QRb+=1;const vd=this.Gd.BX(Lc);Lc=this.MF.q_c(vd,Lc);Lc=gr.CGd(Lc);b.F7+=Lc.LCa+1;b.E7+=Lc.LCa-Lc.ync}}Lc=this.Xji(v,D,gr.$Xk);D=Lc.cp;let id;Ac=(id=Ac).concat.apply(id,Lc.Anc);ca+=Lc.F7;cc+=Lc.E7}while(-1!==D);b=this.zqk(b,P,Ac,v,mb,Ub.QRb,Ub.vDd,Ub.wDd,h,-1===ta,Jb);Ub.QRb=b.wordCount;Ub.vDd=
b.E7;Ub.wDd=b.F7;Ub.t8o=b.DLj;return Ub}ATh(b,h){const v=fe.ParagraphReader.textLength(h,9);if(v){h=Yo.e(h);var D=0;for(let P=0;P<h.length;P++)if(this.Uib&&5===h[P].zh&&b.rJ++,gr.Yro(h[P])){D++;break}h.length!==v?b.AR++:b.AR+=D}}fqj(b){this.Vyd=this.wso(b.CZa,b.wordCount)?1:0;return!!this.Vyd}bZi(b){this.lhd=b.wordCount;this.xxe=b.rJ;this.Ixe=b.e$;this.txe=b.F7;this.sxe=b.E7;this.Cxe=b.AR;this.lRg=b.Uqb;this.dRg=b.I3a;this.e7i(b)}e7i(b){this.ra.raiseEvent(gr.Cpe,new VK(b))}d7i(){this.ra.raiseEvent(gr.zpg,
new TK(!1))}wso(b,h){if(aa.a.Gt||aa.a.iu||aa.a.OH)return!1;(h/=2)||(h=1);return(h?b/h:0)>gr.Cbn?!0:!1}get Uib(){const b=!this.rMf||1===this.rMf&&this.bjk;return this.pWa&&b}gci(b,h){let v=1033,D=0;b=h.vrf(b);h=new cg;for(let P=0;P<b.length;P++){const ca=h.ysk(b[P].lcid,b[P].end-b[P].begin);D<ca&&(D=ca,v=b[P].lcid)}return v}zqk(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub){var cc;h=(cc=h).concat.apply(cc,v);v=Mz.a.instance.Zji(h,D);b.wordCount+=v.wordCount;P=gr.CGd(P);cc=P.LCa-P.ync;const Ac=P.LCa;b.E7+=cc;b.F7+=Ac;
ca+=v.wordCount;ta+=P.LCa-P.ync;Ra+=P.LCa;b.CZa+=v.CZa;const {jtl:Lc,BMo:id}=gr.yqk(h,D);b.ICb+=Lc;b.HCb+=id;b.I3a.add(Ub);b.Uqb.add(v.wordCount);Jb&&gr.WQk(Ac,cc,mb,v,Lc,id,Ub);b.cp=0;b.XYf=[];b=new YK;b.E7=ta;b.F7=Ra;b.wordCount=ca;b.DLj=v.wordCount;return b}sMl(b,h){let v=this.v4n(b);v=fe.ParagraphReader.Ogb(b,9,v,h);return this.O_n(v)}v4n(b){var h=fe.ParagraphReader.text(b);b=Yo.e(b);if(0<b.length){h=h.split("");for(let D=0;D<b.length;++D){let P=!0;var v=!0;const ca=b[D];if(1===ca.zh)v=ca,v=22!==
v.kind&&2!==v.kind;else if(5===ca.zh)P=!1;else if(7===ca.zh||10===ca.zh)h[ca.Ib.cp]=this.i4j,P=!1;if(P){if(ca.Ib.cp>=h.length)return"";h[ca.Ib.cp]=v?" ":"C"}}h=h.join("")}return h}O_n(b){return b.replace(this.x2j,"")}Xji(b,h,v){const D=b.length-h<=v;var P=D?b.length:h+v;const ca=new XK;if(P<h)return ca.cp=-1,ca;ca.Anc=Mz.a.instance.fof(b,h,P);P=gr.CGd(b.substr(h,P));ca.F7=P.LCa;ca.E7=P.LCa-P.ync;if(!ca.Anc.length&&!D)return v===b.length-h?ca:this.Xji(b,h,b.length-h);ca.cp=D||!ca.Anc.length?-1:ca.Anc[ca.Anc.length-
1].cp;return ca}Vwk(b){this.Vyb=b;this.taskManager.Vb(this.Vyb)}yfi(b){if(b=b.VI){const h=this.Gd.BX(b);if(h&&h.zz)return b}return null}static Yro(b){return 11===b.zh}static f0o(b,h){b.wordCount+=h.wordCount;b.E7+=h.DCh;b.F7+=h.ECh;b.CZa+=h.fyh;b.ICb+=h.ICb;b.HCb+=h.HCb;b.I3a.add(h.s0i);b.Uqb.add(h.wordCount)}static WQk(b,h,v,D,P,ca,ta){const Ra=new UK;Ra.wordCount=D.wordCount;Ra.ECh=b;Ra.DCh=h;Ra.fyh=D.CZa;Ra.ICb=P;Ra.HCb=ca;Ra.s0i=ta;v.scd=Ra}static CGd(b){const h=b.length,v=new WK;for(let P=0;P<
h;P++){var D=b.charCodeAt(P);v.LCa++;if(55296<=D&&56319>=D&&(D=P+1<h?b.charCodeAt(P+1):0,56320<=D&&57343>=D)){P++;continue}G.a.sca(b.charAt(P))&&v.ync++}return v}static yqk(b,h){let v=0,D=0;for(let P=0;P<b.length;++P){const ca=b[P],ta=ca.CL;(3===ta||2===ta)&&ca.cp<h.length&&(++v,G.a.Cac(h.charCodeAt(ca.cp))&&++D)}return{jtl:D,BMo:v}}}gr.Cpe="wctek";gr.zpg="wcac";gr.U8o=1;gr.$Xk=400;gr.y5o=90;gr.Cbn=.1;Object(n.a)(gr,"WordCountManagerBase",null,[421]);class ZK extends gr{constructor(b,h,v,D,P,ca,ta,
Ra,mb,Jb,Ub){super(b,h,v,P,mb,Jb);this.R1h=this.ewd=this.nla=null;this.upa=()=>{this.Kdf()};this.hb=D;this.ud=ta;this.pih=Ra;this.vI=Ub;this.hb.Pw(this.upa);this.NGe=mb.$("ReadingTimeIsEnabled")}get xyj(){return 66}QAm(){if(this.nla)return!0;if(!this.hb||!this.hb.gb)return this.ud&&(Xa.App.mYd||w.AFrameworkApplication.Nk?this.ud.Yb("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.ud.Yb("SelectionWordCountSelectionNullWhenAppAlive")),
!1;const b=this.hb.gb.clone();this.nla=b.nO(!0);if(!this.nla||!this.nla.QA())return this.EId(),!1;this.pih&&(this.ewd=this.pih.create(h=>b.nO(h),this.Nm));this.nla.moveNext();return!0}get rMf(){return 1}D6k(b){return b===sc.a.Hd||b===sc.a.paragraph?!0:this.Uib&&(b===sc.a.yDb||b===sc.a.image||b===sc.a.anchoredObject)}fgf(b){this.QYa.reset();if(this.QAm()){for(this.Uib&&this.ewd&&(this.ewd.crl(b,this.QYa)||this.pke(1,b));this.nla.current;){const D=-1===b.gX?0:b.gX;let P=0;var h=this.nla.current;if(!this.D6k(h.contextId)){this.nla.moveNext();
continue}if(this.Uib&&oe.ImageReader.C2a(h)){b.rJ++;this.nla.moveNext();continue}if(!fe.ParagraphReader.Wb(h.node)){this.nla.moveNext();continue}const ca=h.node;if(this.cOa&&this.R1h&&this.R1h.d1a(ca))this.nla.moveNext();else{if(this.Uib&&h.isValid){var v=he.GraphIterator.$a(ca);for(v.Sb(6);!v.Sr;)oe.ImageReader.Ju(v.currentNode)&&b.rJ++,v.zi(6)}v=this.NGe?this.gci(ca,this.vI):1033;h=this.FIj(b,ca,0,0,0,this.iZd(h),D,h.cpBegin,h.cpEnd,v);if(h.MDi&&(P+=1,100<P)){b.gX=D+1;this.pke(1,b);return}if(h.geg)return;
this.ATh(b,ca);this.nla.moveNext()}}this.ewd=this.nla=null;this.fqj(b)?(this.lhd=-1,this.d7i()):this.bZi(b)}}iZd(b){let h=!1;b.contextId===sc.a.paragraph?h=!0:b.contextId===sc.a.Hd&&(h=b.cpEnd-b.cpBegin===b.node.characterData.length);return h}}Object(n.a)(ZK,"SelectionWordCountManager",gr,[]);class HG{constructor(b,h){this.lWb=!1;this.hyb=null;b&&h&&(this.d_b=b(!1),this.Wc=h,this.d_b.moveNext())}crl(b,h){if(!b||!this.d_b||!this.d_b.current)return!0;do{const v=this.d_b.current;if(v.contextId===sc.a.tableRow||
v.contextId===sc.a.tableCell){for(this.hyb||this.ZAm(v.node);this.hyb.moveNext();)if(14===this.hyb.currentNode.type&&b.e$++,h.update(),h.Ilb())return!1;this.c9k(v,b);this.hyb=null}this.d_b.moveNext()}while(this.d_b.current);return!0}c9k(b,h){const v=this.Wc.Vf(b.node);v.zb(14);b.contextId===sc.a.tableRow&&(Bl.a.Hxi(v)&&(this.lWb=!0),Bl.a.KZd(v)&&this.lWb&&(this.lWb=!1,h.e$++));b.contextId===sc.a.tableCell&&(Xg.TableCellReader.oUc(v)&&(this.lWb=!0),Xg.TableCellReader.oQa(v)&&this.lWb&&(this.lWb=!1,
h.e$++))}ZAm(b){this.hyb=Ka.a.Zo(b);14===b.type?this.hyb.mo(HG.cMc,b):this.hyb.mo(HG.cMc,null)}static cMc(b){return b.parentNode?!0:!1}}Object(n.a)(HG,"TableCountSelectionTraverser",null,[420]);class $K{constructor(b){this.pWa=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,h){return this.pWa?new HG(b,h):null}}Object(n.a)($K,"TableCountSelectionTraverserFactory",null,[415]);class aL extends gr{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub){super(b,h,v,P,mb,Jb);this.A5o=cc=>{if(cc.Sr)return!0;
cc=cc.role;return 1===cc||2===cc||this.Uib&&6===cc||3===cc||4===cc||5===cc||!this.cOa&&(7===cc||8===cc)};this.ga=D;this.$ek=ca;this.Nnk=ta;this.NQg=Ra;this.vI=Ub;this.ga.eb(Nc.a.BLj,sc.a.application,Oc.ActionManager.Nf,64);this.ga.eb(Nc.a.CLj,sc.a.application,Oc.ActionManager.Nf,64);this.NGe=mb.$("ReadingTimeIsEnabled")}get xyj(){return 63}get rMf(){return 0}fgf(b){this.QYa.reset();b.hI=!1;var h=this.$ek();Ih.PageReader.instance.OHb(h)||(this.FId(),this.d7i());h=this.Nm.Jva(h,7,7).currentNode;var v=
this.Gbl(b.currentNode,h);h=this.Nnk(v,h);h.mo(this.A5o,null);let D=v=0;for(var P=0;h.moveNext();)if(h.currentNode&&this.Gd.mca(h.currentNode)){var ca=this.Gd.BX(h.currentNode);if(ca.zz){var ta=this.Gd.UEb(h.currentNode);if(ta&&(ta=ta.pa.last,(null===ta||void 0===ta?0:ta.Rh)&&(Jl.App.qP&&ta.ei||ta.iR)))continue;b.wordCount+=1;if(ca=this.MF.q_c(ca,h.currentNode))ca=gr.CGd(ca),b.F7+=ca.LCa+1,b.E7+=ca.LCa-ca.ync;v+=1;D+=b.F7;P+=b.E7}}else if(this.Uib&&h.currentNode&&oe.ImageReader.Ju(h.currentNode))b.rJ++;
else if(this.Uib&&h.currentNode&&cj.TableReader.xU(h.currentNode))b.e$++;else if(h.currentNode&&fe.ParagraphReader.Wb(h.currentNode)){ca=h.currentNode;ta=this.NGe?this.gci(ca,this.vI):1033;P=this.FIj(b,ca,v,D,P,!0,-1,-1,-1,ta);if(P.geg){b.hI=!0;w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorWordCountPackageImageAndTableCountSettings");return}this.ATh(b,ca);v=P.QRb;D=P.wDd;P=P.vDd}this.fqj(b)?(this.FId(),this.n5n(),this.e7i(b)):this.bZi(b)}Gbl(b,h){b?(b=this.NQg(b),
b.zb(7)):b=this.NQg(h);return b}n5n(){switch(this.Vyd){case 1:this.ga.processAction(Nc.a.BLj,2);break;case 2:this.ga.processAction(Nc.a.CLj,2)}}}Object(n.a)(aL,"TotalWordCountManager",gr,[]);class bL{constructor(){this.$ij=this.Zij=this.n$f=this.ajj=this.IAj=this.JAj=this.GAj=this.HAj=0}get wSi(){return this.k8b(this.ajj,this.JAj,"WC")}get Jjn(){return this.k8b(this.Zij,this.GAj,"NumCharsNoSp")}get Kjn(){return this.k8b(this.n$f,this.HAj,"NumCharsWithSp")}get Pjn(){return this.k8b(this.$ij,this.IAj,
"NumParagraphs")}k8b(b,h,v){const D=this.$bd(h,v).toLocaleString();return 0<this.n$f?(b=this.Aog(b,h,v),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,b.toLocaleString(),D)):D}Aog(b,h,v){b=this.$bd(b,v);return b>h?(u.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",v),h):b}$bd(b,h){0>b&&u.ULS.sendTraceTag(22397768,338,15,"{0}<0",h);return Math.max(b,0)}}Object(n.a)(bL,"DocumentStats",null,[]);class IG{static Gaf(b){return bg.a.vA(IG.Km,WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,
b.wSi,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,b.Jjn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,b.Kjn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,b.Pjn)}}IG.Km="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(n.a)(IG,"DocumentStatsDialogHtml",null,[]);class cL extends bg.a{constructor(b){super();this.rS=!1;this.Krl=()=>{};this.RF=b}Uwo(){this.wg="DocumentStatsDialog";this.Yg=IG.Gaf(this.RF);this.Ad=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.Krl);this.h5("DocumentStatsTable")}k9(){}dispose(){this.rS||(super.dispose(),this.rS=!0)}}Object(n.a)(cL,"DocumentStatsDialog",bg.a,[]);class dL{constructor(b,h,v,D,P,ca,ta,Ra,mb){this.thh=this.cuc=this.nsc=this.kWb=this.MHe=
!1;this.yfc=()=>{this.Coe()};this.xpa=()=>{this.Coe()};this.Foo=()=>{this.thh=!0;return 32};this.C2f=()=>this.ns.KQa?32:8;this.B3c=(Jb,Ub,cc,Ac,Lc)=>{if(1===cc)return this.ns.KQa?32:8;Lc[If.a.On]=this.BHf;return 32};this.mme=(Jb,Ub,cc)=>{if(1===cc)return this.ns.KQa?32:8;this.BHf?this.Kol():this.hvl();Xa.App.xa.WG({ShowWordCount:"CheckboxModel"});return 32};this.mkc=(Jb,Ub,cc)=>{if(1===cc)return Ni.a.rha(Ub)?8:this.ns.KQa?32:8;if(this.thh)return w.AFrameworkApplication.va.processAction(Nc.a.a9d,2),
32;Jb=this.ge.Zf("UserAction","Show Word Count Dialog");Jb.start();this.ns.F9c();this.jQ.F9c();this.ns.ny!==this.jQ.ny?u.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):u.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");Ub=this.bal();(new cL(Ub)).Uwo();Jb.stop();return 32};this.P2c=(Jb,Ub,cc,Ac,Lc)=>{Lc||u.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===cc)return 32;if(!this.ns.KQa)return Lc[Hl.a.Visible]=
!1,32;Lc[Hl.a.Visible]=!0;this.BHf?(Jb=this.ns.ny,0>Jb?Jb=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:Jb?(Ub=this.jQ?this.jQ.ny:-1,Jb=0<Ub?this.Rcm(Jb,Ub):String.format(1===Jb?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.xfe(Jb))):Jb=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.xfe(Jb))):Jb=WordEditorIntl.WordEditorStrings.l_WordCountHidden;Lc[Hl.a.LabelText]=Jb;return 32};
this.axe=ta;this.bxe=ca;this.ns=b;this.jQ=h;this.LBc=v;this.Blk=P;this.jQ.g0e(this.yfc);this.ns.g0e(this.yfc);this.jQ.vzb(this.xpa);this.ns.vzb(this.xpa);this.ge=Ra;this.cOa=D;this.pWa=mb.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get zdf(){return!aa.a.m4}Tb(){const b=w.AFrameworkApplication.va;b.qa(Nc.a.mme,sc.a.application,this.mme);b.qa(Nc.a.mkc,sc.a.view,this.mkc);b.eb(Nc.a.B3c,sc.a.application,this.B3c,96);b.eb(Nc.a.P2c,sc.a.application,this.P2c,96);b.eb(Nc.a.C2f,sc.a.application,
this.C2f,96);b.qa(Nc.a.aWh,sc.a.application,this.Foo)}get cOa(){return this.nsc}set cOa(b){this.nsc=b;this.ns.cOa=b;this.jQ.cOa=b}hvl(){this.ns.KQa&&(this.Toj(!0),this.Coe(),this.ns.F9c())}bal(){const b=new bL;b.JAj=this.ns.ny;b.HAj=this.ns.v4b;b.GAj=this.ns.$Ic;b.IAj=this.ns.bJc;b.ajj=this.jQ.ny;b.Zij=this.jQ.$Ic;b.n$f=this.jQ.v4b;b.$ij=this.jQ.bJc;return b}pWl(){return this.axe("WACWordCountEnabled",this.zdf)}Pge(b){this.bxe("WACWordCountEnabled",b?"true":"false",$b.a.mRa)}get BHf(){this.kWb||(this.MHe=
this.pWl(),this.kWb=!0);return this.MHe}Toj(b){this.Pge(b);this.MHe=b;this.kWb=!0}Kol(){this.ns.FId();this.jQ.FId();this.Toj(!1);this.Coe()}get TJ(){return null!=this.dHg?this.dHg:this.dHg=(()=>this.LBc())()}Coe(){this.cuc||(u.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.egl()),this.cuc=!0);this.TJ&&this.TJ.OU(this.Blk)}egl(){const b={["words"]:this.ns.ny,["charsWithSpaces"]:this.ns.v4b,["charsWithNoSpaces"]:this.ns.$Ic,["paragraphs"]:this.ns.bJc};this.pWa&&(b.images=this.ns.QBb,
b.tables=this.ns.UBb);return b}xfe(b){try{return b.toLocaleString()}catch(h){u.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",h.toString(),h.stack))}return b.toString()}Rcm(b,h){h>b&&(u.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),h=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.xfe(h),this.xfe(b))}}Object(n.a)(dL,"WordCountActor",
null,[]);class eL extends Mu.a{constructor(b,h,v,D){super();this.tY=(P,ca)=>{if(ca.property===lf.a.lo||ca.property===lf.a.Gn)P=ca.node,ca=Jl.App.sn.ib.rc,ca.lv&&ca.Yc&&ca.Yc.Kc&&P.Kc&&P.Kc.id===ca.Yc.Kc.id&&this.lXh(P)};this.CWi=(P,ca)=>{this.lXh(ca.node)};this.Zrn=(P,ca)=>{ca.property!==Wc.a.JA&&ca.property!==Bc.a.ov||this.qY()};this.c7d=()=>{this.qY()};this.o2=b;this.ns=h;this.pq=v;this.pWa=D.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}Fz(){var b=this.pq.Ze(12);b.Go(this.tY);b.$t(this.CWi);
b.Ax(this.CWi);b=this.pq.Ze(22);b.Go(this.Zrn);b.$t(this.c7d);b.Ax(this.c7d);this.pWa&&this.AXn();this.o2.nqa(this,7)}AXn(){var b=[19,14];for(const h of b)b=this.pq.Ze(h),b.$t(this.c7d),b.Ax(this.c7d)}get index(){return 1}run(){this.ns.Kdf()}lXh(b){b.scd=null;this.qY()}}Object(n.a)(eL,"WordCountAppEventCoordinator",Mu.a,[]);class CH{}CH.Aqk="AccurateWordCountButton";Object(n.a)(CH,"WordCountConstants",null,[]);class fL{constructor(b,h){this.ns=b;this.jQ=h}getInstance(b){switch(b){case 1:return this.jQ;
case 0:return this.ns;default:return this.ns}}}Object(n.a)(fL,"WordCountManagerFactory",null,[329]);class DH{constructor(){this.W=null}get name(){return"WordEditor.WordCount"}xc(b){this.W=b;const h=this.W.resolve("Common.IAppSettingsManager");this.W.ha("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new $K(h)).singleInstance();this.W.ha("WordEditor.WordCount.IWordCountManagerFactory",()=>{var v=new Mi.a(10,Dd.a.af);const D=new aL(b.resolve("Box4.List.IListReader"),b.resolve("Box4.IListMarkerUtility"),
new Qo.a,w.AFrameworkApplication.va,w.AFrameworkApplication.nc,()=>Jl.App.sn.ib.rc.Yc,Ka.a.Rs,he.GraphIterator.$a,h,v,Ea.a.instance.resolve("Box4.ILanguageReader"));v=new ZK(Ea.a.instance.resolve("Box4.List.IListReader"),Ea.a.instance.resolve("Box4.IListMarkerUtility"),new Qo.a,Yh.a.instance,w.AFrameworkApplication.nc,jy.a.instance,bf.a.instance,Ea.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),h,v,Ea.a.instance.resolve("Box4.ILanguageReader"));return new fL(D,v)}).singleInstance();
this.W.ha("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new RK(this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").singleInstance()}init(){const b=Xa.App.xa.ib;b.xwa?this.hja():b.sfa(()=>{this.hja()})}hja(){if(Xa.App.Xj){var b=Xa.App.Xj.zl;if(b){this.W.resolve("WordEditor.IGraphFullyConnectedGetter");var h=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),v=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),
D=Ea.a.instance.resolve("Common.IAppSettingsManager");(new dL(h,v,()=>Ea.a.instance.Na("WordEditor.IStatusBarUser"),this.sVl(),CH.Aqk,$b.a.oTa,$b.a.Dba,Ea.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),D)).Tb();(new eL(oo.GraphTransactionManager.instance,h,b,D)).Fz();h.Kdf()}else u.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else u.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}sVl(){var b=
Jl.App.sn.ib;if(!b)return u.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.rc;if(!b)return u.ULS.sendTraceTag(22611552,324,10,""),!1;b=b.Yc;return b?b.ia(Bc.a.cOa,!1):(u.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){N.a.instance.Fc(new DH)}}Object(n.a)(DH,"PackageManager",null,[1,2]);var XM=c(2044);class gL{constructor(b){this.zRe=null;b.Sa("Common.App.SearchCommon.SearchHostRuntime").execute(h=>{this.zRe=h})}olj(b){this.zRe&&this.zRe.Vqf().handleDocumentContentAugloopAnnotation(b)}}
Object(n.a)(gL,"DocumentContentExtractionManager",null,[403]);class Wh{}Wh.JAo="mso_smartLookup";Wh.channelId="SmartLookup";Wh.IAo="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";Wh.nuj="https://uci.edog.cdn.office.net/mirrored/smartlookup/";Wh.ouj="https://uci.cdn.office.net/mirrored/smartlookup/";Wh.HAo="https://hedwigtestserver.blob.core.windows.net/builds/";Wh.GAo="http://localhost:8080/";Wh.g9c="current";Wh.muj="next";Wh.uAn=2;Wh.Nfc=1;Wh.Ofc=CommonUIStrings.L_SmartLookupPaneTitle;
Wh.$B="InsightsTaskPane";Wh.Aig="InsightsTaskPaneData";Wh.Myf="InsightsContentFrame";Wh.width=400;Wh.den="ApplicationPropertiesRequest";Wh.qen="SelectionRequest";Wh.jen="PageRendered";Wh.cen="ApplicationProperties";Wh.oen="Selection";Wh.sen="Telemetry";Wh.ren="TakeFocus";Wh.ien="LostFocus";Wh.fen="Keyboard";Wh.gen="LegalAgreed";Wh.r8o="WordWac";Wh.jxn="OneNoteWAC";Wh.xYf="yes";Wh.Iyj="appCorrelationId";Wh.kJo="clientCorrelationId";Wh.Jyj="message";Wh.pGi="Microsoft::Office::Insights::LegalAgreed";
Object(n.a)(Wh,"InsightsConstants",null,[]);var OF=c(1619);class UE{}Object(n.a)(UE,"ActivityContractInfo",null,[]);class hu{}Object(n.a)(hu,"BrowserPaneDataField",null,[]);class VE{}Object(n.a)(VE,"BrowserPaneTelemetryEvent",null,[]);class Vl{static Jz(b,h){const v=new VE;v.eventName="Diagnostics";v.isActivity=!1;v.activityContract=Object.assign(new UE,{success:!0});const D=[],P=new hu;P.name="Message";P.dataType=0;P.value=b;b=new hu;b.name="Level";b.dataType=0;b.value=Vl.getLevelString(h);Array.add(D,
P);Array.add(D,b);v.dataFields=D;Vl.sendTelemetryEvent(v)}static rjj(b,h){const v=new VE;v.eventName=b;v.isActivity=!1;v.activityContract=Object.assign(new UE,{success:!0});b=[];const D=new hu;D.name="AppCorrelationId";D.dataType=0;D.value=h;Array.add(b,D);v.dataFields=b;Vl.sendTelemetryEvent(v)}static Seo(b,h,v,D,P,ca){const ta=new VE;ta.eventName="LaunchPaneWithError";ta.isActivity=!1;ta.activityContract=Object.assign(new UE,{success:!0});const Ra=[],mb=new hu;mb.name="IsNetworkConnected";mb.dataType=
0;mb.value=b?"true":"false";b=new hu;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=h?"true":"false";h=new hu;h.name="EntryPoint";h.dataType=0;h.value=v;v=new hu;v.name="RuntimeVersion";v.dataType=0;v.value=D;D=new hu;D.name="IsFirstRelease";D.dataType=1;D.value=P?"true":"false";P=new hu;P.name="IsZeroTerm";P.dataType=1;P.value=ca?"true":"false";ca=new hu;ca.name="IsClientSideRendering";ca.dataType=1;ca.value="false";Array.add(Ra,mb);Array.add(Ra,h);Array.add(Ra,b);Array.add(Ra,v);Array.add(Ra,
D);Array.add(Ra,P);Array.add(Ra,ca);ta.dataFields=Ra;Vl.sendTelemetryEvent(ta)}static q$f(b,h,v){const D=new VE;D.eventName="CDNDownloadLatency";D.isActivity=!0;D.activityContract=Object.assign(new UE,{duration:v,success:!0});v=[];const P=new hu;P.name="CDNHostname";P.dataType=0;P.value=b;b=new hu;b.name="Filename";b.dataType=0;b.value=h;Array.add(v,P);Array.add(v,b);D.dataFields=v;Vl.sendTelemetryEvent(D,1)}static Jic(b,h,v,D,P,ca,ta,Ra){const mb=new VE;mb.eventName="LaunchPane";mb.isActivity=!0;
mb.activityContract=Object.assign(new UE,{duration:h,success:!0});h=[];const Jb=new hu;Jb.name="AppCorrelationId";Jb.dataType=0;Jb.value=b;b=new hu;b.name="EntryPoint";b.dataType=0;b.value=v;v=new hu;v.name="IsServerSideRendering";v.dataType=1;v.value="true";const Ub=new hu;Ub.name="UxVersion";Ub.dataType=0;Ub.value=D;D=new hu;D.name="FeatureGates";D.dataType=0;D.value=P;P=new hu;P.name="IsFirstRelease";P.dataType=1;P.value=ca?"true":"false";ca=new hu;ca.name="IsZeroTerm";ca.dataType=1;ca.value=ta?
"true":"false";ta=new hu;ta.name="IsClientSideRendering";ta.dataType=1;ta.value=Ra?"true":"false";Array.add(h,Jb);Array.add(h,b);Array.add(h,v);Array.add(h,Ub);Array.add(h,D);Array.add(h,P);Array.add(h,ca);Array.add(h,ta);mb.dataFields=h;Vl.sendTelemetryEvent(mb)}static sendTelemetryEvent(b,h=2){if(b.isFeedbackActivity)Vl.M3m(b.eventName);else{var v=-1<b.eventName.indexOf(Vl.Hyj)?b.eventName:Vl.Hyj+b.eventName,D=Vl.tUl(b.dataFields);b.isActivity?(b=Object.assign(new Li.a,{name:v,samplingPolicy:h,
dataFields:D,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),fa.a.sendActivityEvent(b)):(b=Object.assign(new oa.a,{name:v,samplingPolicy:h,dataFields:D}),fa.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static tUl(b){const h=[];if(b&&0<b.length)for(const v of b)(b=Qm.a.r8(v.name,v.value,Vl.a8k(v.dataType)))&&Array.add(h,b);return h}static a8k(b){switch(b){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static M3m(b){const h=Ea.a.instance.Na("Common.ISystemInitiatedFeedback");h?h.logActivity(b,null):u.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}Vl.Hyj="Office.Insights.SmartLookup.";Object(n.a)(Vl,"TelemetryUtils",null,[]);var WE;(function(b){b[b.other=0]="other";b[b.searchBoxSearch=1]="searchBoxSearch";b[b.searchBoxDictionary=2]="searchBoxDictionary";b[b.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";b[b.smartLookupRibbon=
4]="smartLookupRibbon";b[b.smartLookupContextMenu=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.dictionary=7]="dictionary";b[b.web=8]="web";b[b.pictures=9]="pictures";b[b.files=10]="files";b[b.bookmarks=11]="bookmarks";b[b.help=12]="help";b[b.chartRecommendation=13]="chartRecommendation";b[b.linkSkill=14]="linkSkill";b[b.searchBoxFindInDocument=15]="searchBoxFindInDocument";b[b.searchBoxEntity=16]="searchBoxEntity";b[b.searchSkill=17]="searchSkill";b[b.controlF=18]="controlF";b[b.ribbonFindButton=
19]="ribbonFindButton";b[b.reuseSlides=20]="reuseSlides";b[b.data=21]="data";b[b.contextMenuDictionary=22]="contextMenuDictionary";b[b.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";b[b.contextMenuSynonyms=24]="contextMenuSynonyms";b[b.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";b[b.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";b[b.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";b[b.note=28]="note";b[b.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";
b[b.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";b[b.dataDisambiguate=31]="dataDisambiguate";b[b.linkFiles=32]="linkFiles";b[b.searchBoxNoteL2=33]="searchBoxNoteL2";b[b.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";b[b.actionAI=35]="actionAI";b[b.pasteAsNewSlide=36]="pasteAsNewSlide";b[b.slidesCompression=37]="slidesCompression";b[b.searchBoxGenerateDeck=38]="searchBoxGenerateDeck";b[b.powerPointCopilot=39]="powerPointCopilot";b[b.tellMeService=40]="tellMeService";
b[b.prefetch=99]="prefetch"})(WE||(WE={}));Object(n.b)("EntryPoint",WE);var iu=c(1546),Sx=c(1560);class yv{static XX(b,h,v,D,P,ca){if(1===v)return bc.SessionStatusManager.instance.MH?32:8;if(P.value.wvo())return Vl.Jz("Skipping Serplet launch",10),32;h=ca;if(!h)return 8;b=yv.XDb();if(v=h.CommandValueId)try{h=E.a(v)}catch(ta){return u.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",v),8}v=h;h.selection||(h.neighborhood?v=Object.assign(new iu.a,{selection:h}):
(h=P.value.HEb(),v.selection=Object.assign(new Sx.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength})));v.selection.clientDetectedLanguage=P.value.vai();return yv.n6b(ca,null,v,b,0,P)}static n6b(b,h,v,D,P,ca){const ta={};ta.controlId=b?b.SourceControlId:"shortcut";v&&(ta.entryPoint=WE[v.entryPoint]);u.ULS.sendTraceTag(594044172,1303,50,yv.OT("Show insights",D,ta));h?ca.value.Nxo(h,D,P):v&&(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",
!1)?ca.value.jwo(v,D):ca.value.Oxo(v,D,P));return 32}static OT(b,h,v=null){b={["appCorrelationId"]:h,["message"]:b};if(v)for(let D in v)b[D]=v[D];return E.c(b)}static XDb(){return ub.a.create().toString()}}Object(n.a)(yv,"InvokingPaneUtils",null,[]);class hL{}Object(n.a)(hL,"LaunchDataInDoc",null,[]);class iL{}Object(n.a)(iL,"LaunchDataPasteAsSlide",null,[]);class jL{}Object(n.a)(jL,"LaunchDataSlidesCompression",null,[]);var Cu=c(1536);class EH{constructor(b,h,v,D,P,ca,ta,Ra,mb){this.psc=this.Okd=
this.Gw=null;this.mC=b;this.ga=h||w.AFrameworkApplication.va;this.fp=v;this.Ub=D;this.z2g=Ra;this.ayc=P;this.Fa=ca;this.Gb=ta;this.Vzm();this.jWa=new Gg.a(()=>new bm.a(mb.value,Object(z.a)(this,this.WEb,"getMoreInfoEventReceived")))}Tb(){this.ga.qa(Wa.a.$Dm,ud.a.frame,Object(z.a)(this,this.Lxo,"showInsights"));this.ga.qa(Wa.a.aEm,ud.a.frame,Object(z.a)(this,this.Mxo,"showInsightsForTellMe"));this.ga.qa(Wa.a.definitions,ud.a.frame,Object(z.a)(this,this.Kwo,"showDefinitions"));this.ga.qa(Wa.a.Hdf,ud.a.frame,
Object(z.a)(this,this.Lwo,"showDefinitionsForTellMe"));this.ga.qa(Wa.a.Feg,ud.a.frame,Object(z.a)(this,this.Feg,"showInsightsForSuggestion"));this.z2g&&(this.ga.qa(Wa.a.F8,ud.a.frame,Object(z.a)(this,this.XX,"invokeSmartLookupPane")),this.ga.qa(Wa.a.zTc,ud.a.frame,Object(z.a)(this,this.zTc,"invokeInDocSerplet")),this.ga.qa(Wa.a.BTc,ud.a.frame,Object(z.a)(this,this.BTc,"invokeSerpletRibbon")),this.ga.qa(Wa.a.ATc,ud.a.frame,Object(z.a)(this,this.ATc,"invokeSerpletContextMenu")),this.ga.qa(Wa.a.IBf,
ud.a.frame,Object(z.a)(this,this.IBf,"invokeSerpletTellMeZeroTerm")),this.ga.qa(Wa.a.HBf,ud.a.frame,Object(z.a)(this,this.HBf,"invokeSerpletTellMeNotes")),this.ga.qa(Wa.a.HXd,ud.a.frame,Object(z.a)(this,this.HXd,"invokeImageSerpletContextMenu")),this.ga.qa(Wa.a.LXd,ud.a.frame,Object(z.a)(this,this.LXd,"invokeSynonymsSerpletContextMenu")),this.ga.qa(Wa.a.GXd,ud.a.frame,Object(z.a)(this,this.GXd,"invokeDictionarySerpletContextMenu")),this.ga.qa(Wa.a.NXd,ud.a.frame,Object(z.a)(this,this.NXd,"invokeZeroTermSerpletContextMenu")),
this.ga.qa(Wa.a.FXd,ud.a.frame,Object(z.a)(this,this.FXd,"invokeDefinitionSearchFromFloatie")),this.ga.qa(Wa.a.KXd,ud.a.frame,Object(z.a)(this,this.KXd,"invokeSerpletBrowseFiles")),this.ga.qa(Wa.a.IXd,ud.a.frame,Object(z.a)(this,this.IXd,"invokeInDocSerpletWithLaunchData")),this.ga.qa(Wa.a.gce,ud.a.frame,Object(z.a)(this,this.gce,"queryToggleSerplet")),this.ga.qa(Wa.a.dhe,ud.a.frame,Object(z.a)(this,this.dhe,"setInDocSearchParameter")),this.ga.qa(Wa.a.GBf,ud.a.frame,Object(z.a)(this,this.GBf,"invokeSerpletSlidesCompression")),
this.ga.qa(Wa.a.FBf,ud.a.frame,Object(z.a)(this,this.FBf,"invokeSerpletPasteAsNewSlide")),w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.ga.qa(Wa.a.qui,ud.a.frame,Object(z.a)(this,this.MFm,"invokeSmartLookupPaneConversations")),this.ga.qa(Wa.a.DXd,ud.a.frame,Object(z.a)(this,this.DXd,"invokeAutoLaunchSearchRequest"))),this.iWn().continueWith(()=>{w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.updateCommandUI(!0)}))}ioh(){this.ga.eb(Wa.a.pFa,
ud.a.frame,Object(z.a)(this,this.pFa,"invokeFilesSerplet"),4);this.ga.eb(Wa.a.zBf,ud.a.frame,Object(z.a)(this,this.pFa,"invokeFilesSerplet"),4);this.ga.eb(Wa.a.lui,ud.a.frame,Object(z.a)(this,this.AFm,"invokeLinkFilesSerplet"),4);if(this.Fa.$("IsTellMeUpSellEnterpriseEnabled")&&this.Fa.$("SmartLookupTokenPrefetchIsEnabled")){const b=qf.a.S7(0,Object(z.a)(this,this.k3i,"prefetchToken"),0,177);this.Gb.Vb(b)}}r_e(){Rh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&
(this.ga.qa(Wa.a.pFa,ud.a.frame,Object(z.a)(this,this.ABf,"invokeFilesSerpletUnavailable")),this.ga.qa(Wa.a.zBf,ud.a.frame,Object(z.a)(this,this.ABf,"invokeFilesSerpletUnavailable")),this.ga.qa(Wa.a.lui,ud.a.frame,Object(z.a)(this,this.ABf,"invokeFilesSerpletUnavailable")))}k3i(b){u.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.umc().then(h=>{let v=1;if(h)u.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),
this.J$f("SmartLookupFiles: Token prefetch succeeded",!0),h=6E4*this.Fa.mc("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{u.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.J$f("SmartLookupFiles: Token prefetch failed",!1);v=parseInt(b.data||"1");if(v>this.Fa.mc("SmartLookupTokenRenewalRetryThreshold",5)){u.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.J$f("SmartLookupFiles: Token prefetch max retry count reached",
!1);return}h=6E4*this.Fa.mc("SmartLookupTokenRetryWaitDurationInMinutes",10);v++}h=new qf.a(3,1,h,Object(z.a)(this,this.k3i,"prefetchToken"),177);h.data=v.toString();this.Gb.Vb(h)})}J$f(b="",h=!1){this.ayc.execute(v=>{v&&v.Hic("PrefetchToken",h,0,"SmartLookup",b)})}umc(){return this.ayc?new Promise(b=>{this.ayc.execute(h=>{if(h){var v=Date.now();h.getToken("SmartLookup",this.Fa.jb("SmartLookupShredderServiceEndpoint")).then(D=>{b(!!D&&0<D.length);h.Hic("TryGetTokenInternal",!!D&&0<D.length,Date.now()-
v,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}iWn(){const b=new th.a;if(this.Fa.$("BrowserSupportsInsightsPaneSSO"))this.ioh(),b.Bg(!0);else{if(!this.ayc)return u.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.Bg(!1),this.r_e(),b.task;this.ayc.execute(h=>{h?h.getToken("SmartLookup",this.Fa.jb("SmartLookupShredderServiceEndpoint")).then(v=>{u.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!v&&0<v.length);v&&0<v.length?(this.ioh(),b.Bg(!0)):this.r_e()}):(u.ULS.sendTraceTag(587534912,
1303,10,"Unable to resolve oAuthManager"),b.Bg(!1),this.r_e())})}return b.task}Lxo(b,h,v,D,P){if(1===v)return w.AFrameworkApplication.ta&&w.AFrameworkApplication.K.$("OneNoteDelayLoadContextActivationManager")&&!w.AFrameworkApplication.VHc?8:this.mC.value.Hyi()?32:8;b=yv.XDb();h=this.mC.value.HEb();return this.z2g?(h=Object.assign(new Sx.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength}),h=Object.assign(new iu.a,{selection:h,userIntent:null,entryPoint:0,launchData:Object.assign(new Cu.a,
{landingTab:"All"})}),yv.n6b(P,null,h,b,0,this.mC)):yv.n6b(P,h,null,b,0,this.mC)}Kwo(b,h,v,D,P){if(1===v)return this.mC.value.Hyi()?32:8;b=yv.XDb();h=this.mC.value.HEb();return yv.n6b(P,h,null,b,1,this.mC)}Mxo(b,h,v,D,P){return 1===v?32:this.xYh(P,0)}Lwo(b,h,v,D,P){return 1===v?32:this.xYh(P,1)}xYh(b,h){const v=yv.XDb(),D=b.CommandValueId;let P;try{P=E.a(D)}catch(ca){return u.ULS.sendTraceTag(6295941,1303,15,yv.OT(String.format("Insights parameters [{0}] is not in proper format.",D),v)),8}return yv.n6b(b,
P,null,v,h,this.mC)}Feg(b,h,v,D,P){if(1===v)return 32;if(!P)return 8;b=P.query?P.query:"";h=yv.XDb();v=new OF.a;v.neighborhood=b;v.mentionStart=0;v.mentionLength=b.length;return yv.n6b(P,v,null,h,0,this.mC)}AFm(b,h,v,D){if(1===v)return bc.SessionStatusManager.instance.MH?32:8;const P=w.AFrameworkApplication.K.$("InsertFileLinkSerpletIsEnabled"),ca=this.mC.value.j1a();return this.XX(b,h,v,D,Object.assign(new iu.a,{selection:Object.assign(new Sx.a,{neighborhood:ca.neighborhood,mentionStart:0,mentionLength:0}),
launchData:Object.assign(new Cu.a,{landingTab:"File"}),entryPoint:P?32:10}))}pFa(b,h,v,D){if(1===v)return bc.SessionStatusManager.instance.MH?32:8;const P=w.AFrameworkApplication.K.$("InvokeReuseSlidesSerpletIsEnabled"),ca=this.mC.value.j1a();return this.XX(b,h,v,D,Object.assign(new iu.a,{selection:Object.assign(new Sx.a,{neighborhood:ca.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new Cu.a,{landingTab:P?"Slide":"File"}),entryPoint:P?20:10}))}ABf(){return 2}zTc(b,h,v,D,P){if(1===
v)return bc.SessionStatusManager.instance.Gj?8:32;const ca=this.mC.value.j1a();P=void 0===P||null===P?18:19;return this.XX(b,h,v,D,Object.assign(new iu.a,{selection:Object.assign(new Sx.a,{neighborhood:ca.neighborhood,mentionStart:ca.mentionStart,mentionLength:ca.mentionLength}),launchData:Object.assign(new Cu.a,{landingTab:"Indoc"}),entryPoint:P}))}IXd(b,h,v,D,P){P=P.CommandValueId;if(!P||P&&this.psc&&P.query===this.psc.query&&P.matchCase===this.psc.matchCase&&P.matchWholeWordOnly===this.psc.matchWholeWordOnly)return 32;
const ca=this.mC.value.j1a();return this.XX(b,h,v,D,Object.assign(new iu.a,{selection:Object.assign(new Sx.a,{neighborhood:ca.neighborhood,mentionStart:ca.mentionStart,mentionLength:ca.mentionLength}),launchData:Object.assign(new Cu.a,{landingTab:"Indoc",data:Object.assign(new hL,{type:4,query:P.query,matchCase:P.matchCase,matchWholeWord:P.matchWholeWordOnly})}),entryPoint:18}))}gce(b,h,v,D,P){P&&(P[If.a.On]=this.mC.value.PHb);return 32}dhe(b,h,v,D,P){if(b=P.CommandValueId)this.psc=b;return 32}MFm(b,
h,v){if(1===v)return bc.SessionStatusManager.instance.MH?32:8;b=this.mC.value.j1a();b=Object.assign(new iu.a,{selection:Object.assign(new Sx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Cu.a,{landingTab:"All"})});this.mC.value.f1d(b);return 32}DXd(b,h,v){if(1===v)return bc.SessionStatusManager.instance.MH?32:8;b=this.mC.value.j1a();b=Object.assign(new iu.a,{selection:Object.assign(new Sx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,
mentionLength:0}),entryPoint:29,launchData:Object.assign(new Cu.a,{landingTab:"All",data:w.AFrameworkApplication.DCb})});h=yv.XDb();this.mC.value.cOb(b,h);return 32}BTc(b,h,v,D){if(1===v)return bc.SessionStatusManager.instance.MH?32:8;const P=this.mC.value.xai();return this.XX(b,h,v,D,Object.assign(new iu.a,{selection:Object.assign(new Sx.a,{neighborhood:P.neighborhood,mentionStart:P.mentionStart,mentionLength:P.mentionLength}),entryPoint:4,launchData:Object.assign(new Cu.a,{landingTab:"All"})}))}ATc(b,
h,v,D){return this.XX(b,h,v,D,Object.assign(new iu.a,{entryPoint:5,launchData:Object.assign(new Cu.a,{landingTab:"All"})}))}IBf(b,h,v,D){if(1===v)return bc.SessionStatusManager.instance.MH?32:8;const P=this.mC.value.j1a();return this.XX(b,h,v,D,Object.assign(new iu.a,{selection:Object.assign(new Sx.a,{neighborhood:P.neighborhood,mentionStart:P.mentionStart,mentionLength:0}),launchData:Object.assign(new Cu.a,{landingTab:"All"}),entryPoint:26}))}GXd(b,h,v,D){return 1===v?(b=this.mC.value.HEb())&&0<
b.mentionLength?32:8:this.XX(b,h,v,D,Object.assign(new iu.a,{entryPoint:22,launchData:Object.assign(new Cu.a,{landingTab:"All"})}))}FXd(b,h,v,D){return 1===v?(b=this.mC.value.HEb())&&0<b.mentionLength?32:8:this.XX(b,h,v,D,Object.assign(new iu.a,{entryPoint:7,launchData:Object.assign(new Cu.a,{landingTab:"All"})}))}HXd(b,h,v,D){return this.XX(b,h,v,D,Object.assign(new iu.a,{launchData:Object.assign(new Cu.a,{landingTab:"Image"}),entryPoint:9}))}LXd(b,h,v,D){return this.XX(b,h,v,D,Object.assign(new iu.a,
{launchData:Object.assign(new Cu.a,{landingTab:"All"}),entryPoint:24}))}HBf(b,h,v,D){return this.XX(b,h,v,D,Object.assign(new iu.a,{launchData:Object.assign(new Cu.a,{landingTab:"Notes"}),entryPoint:33}))}NXd(b,h,v,D){if(1===v)return bc.SessionStatusManager.instance.MH?32:8;const P=this.mC.value.j1a();return this.XX(b,h,v,D,Object.assign(new iu.a,{selection:Object.assign(new Sx.a,{neighborhood:P.neighborhood,mentionStart:P.mentionStart,mentionLength:0}),launchData:Object.assign(new Cu.a,{landingTab:"All"}),
entryPoint:27}))}GBf(b,h,v,D,P){if(!P)return 8;const ca=P.url;P=P.selectedSlideIDs;return this.XX(b,h,v,D,Object.assign(new iu.a,{launchData:Object.assign(new Cu.a,{landingTab:"All",data:Object.assign(new jL,{type:6,url:ca,selectedSlideIDs:P})}),entryPoint:37}))}FBf(b,h,v,D,P){if(!P)return 8;const ca=P.Selection;P=P.CurrentDocTitle;return this.XX(b,h,v,D,Object.assign(new iu.a,{launchData:Object.assign(new Cu.a,{landingTab:"All",data:Object.assign(new iL,{type:5,selection:ca,currentDocTitle:P})}),
entryPoint:36}))}XX(b,h,v,D,P){return yv.XX(b,h,v,D,this.mC,P)}KXd(b,h,v){if(1===v)return 32;this.Gw||this.jWa.value.ek("Browse File from Search pane",!0);if(!this.Okd||""===this.Okd)return u.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;Dd.a.om(this.Okd,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}WEb(b){this.Gw||3!==b.state||(this.Gw=b,this.Okd=this.Gw.Sca)}Vzm(){const b=this.Ub.fe(Wh.$B);b.parent=Ne.AFrame.rp;b.pfa(Object(z.a)(this,this.Iic,
"sendIFrameTakeFocusMessage"));this.fp.dT(Wh.$B)}Iic(){document.activeElement.blur();w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.hkb||(this.mC.value.yjo(),this.mC.value.Qeo())}dispose(){this.mC.value&&this.mC.value.dispose()}}Object(n.a)(EH,"InsightsActor",null,[10]);const FH=b=>{b=b.split("-");return b[b.length-1]},ZM=()=>{var b=JG();if(b)return Promise.resolve(b);b=PF().replace("SearchWeb","searchweb");b=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Wh.muj+"/":b+Wh.g9c+"/";b+="version.json";if(aa.a.zoa)return YM(b);try{const h=new Sys.Net.WebRequest;h.set_httpVerb("GET");h.set_url(b);b={};b.method=h.get_httpVerb();return"function"!==typeof window.fetch?(Vl.Jz("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(h.getResolvedUrl(),b).then(v=>v.json()).catch(()=>{Vl.Jz("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(v=>{v=E.b(JSON.stringify(v));
return v.version?v.version:""},v=>{Vl.Jz("InsightsUtils - Failed to deserialize version: "+v.toString(),10);u.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+v.toString());return""}).then(v=>v)}catch(h){return Vl.Jz("InsightsUtils - Failed to download version.json: "+h.toString(),10),u.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+h.toString()),Promise.resolve("")}},YM=b=>{const h=w.AFrameworkApplication.Ne;return new Promise(v=>{const D=
new MF.a(b,1,null,null,!0,2,null);h.send(D).fya(P=>{P&&P.data?P.data.ve||(Vl.Jz("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+P.data.Qe,10),v("")):(Vl.Jz("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),v(""));try{const ca=E.b(P.data.ve);ca.version&&v(ca.version)}catch(ca){Vl.Jz("InsightsUtils - Failed to deserialize version: "+ca.toString(),10),v("")}},P=>{P&&P.data?Vl.Jz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+
P.data.Qe,10):Vl.Jz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);v("")})})},KG=()=>w.AFrameworkApplication.K.$("SmartLookupEnableLocalOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),LG=()=>{const b=PF();return KG()||w.AFrameworkApplication.K.jb("SmartLookupPRClientVersion")?b+JG()+"/":w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Wh.muj:b+Wh.g9c},JG=()=>KG()?"dev":w.AFrameworkApplication.K.jb("SmartLookupPRClientVersion")?w.AFrameworkApplication.K.jb("SmartLookupPRClientVersion").split("/")[1]:w.AFrameworkApplication.K.jb("SmartLookupClientVersion"),GH=b=>{var h=3===w.AFrameworkApplication.ta.Nb.Tl?"wordwac":2===w.AFrameworkApplication.ta.Nb.Tl?"pptwac":"excelwac";var v=ok.a.sg(w.AFrameworkApplication.lcid);const D=v?v.name:"en-us";v=PF();const P=nD();h="main_ssr_wac.html?appName="+h+"&culture="+D;return"LOCAL"===P?
v+h:v+((""!==b?b:Wh.g9c)+"/")+h},$M=b=>PF()+(""!==b?b:Wh.g9c)+"/scripts/microsoft.office.smartlookup.host.runtime.js",PF=()=>{switch(nD()){case "LOCAL":return Wh.GAo;case "PR":const b=w.AFrameworkApplication.K.jb("SmartLookupPRClientVersion").split("/");return Wh.HAo+b[0]+"/";case "INT":return Wh.IAo;case "EDOG":return Wh.nuj;default:return Wh.ouj}},aN=()=>{if(!w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(nD()){case "EDOG":return Wh.nuj;
case "PROD":return Wh.ouj;default:return""}},nD=()=>{if(w.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(w.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(w.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(w.AFrameworkApplication.K.jb("SmartLookupPRClientVersion")&&w.AFrameworkApplication.K.jb("SmartLookupPRIntentSvc"))return"PR";if(KG())return"LOCAL";switch(Object(Na.a)(String,w.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(w.AFrameworkApplication.K&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",
!1)){let b=w.AFrameworkApplication.K.jb("UserPrincipalName");b=G.a.Ug(b);const h=w.AFrameworkApplication.K.Sw("SmartLookupINTEnabledForSKITeam")?w.AFrameworkApplication.K.LC("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(h,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},kL=()=>{let b;b=w.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",
!1)?"EDOG":w.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":w.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":nD();const h=w.AFrameworkApplication.K.jb("IntentServiceEndpoint"),v=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===b&&""!==h)return h+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return w.AFrameworkApplication.K.jb("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(v?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(v?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},bN=()=>{const b=nD(),h=w.AFrameworkApplication.K.jb("IntentServiceEndpoint");switch(b){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===b&&""!==h?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class lL{sendTelemetryEvent(b){Vl.sendTelemetryEvent(b)}}
Object(n.a)(lL,"OtelTelemetrySink",null,[425]);class mL{}Object(n.a)(mL,"ApplicationProperties",null,[]);class nL{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(n.a)(nL,"CurrentDocumentProperties",null,[]);class oL{}Object(n.a)(oL,"EnterpriseUserInfo",null,[]);class pL{}Object(n.a)(pL,"FeatureGates",null,[]);class HH{constructor(b,h){this.pv=this.Ei=null;this.Yda="Search";this.zMi=!0;this.Lyb=h;this.Qz=b;this.Qz.execute(v=>{v.isFeatureEnabled("mso_sendASmile",!0).then(D=>
{this.zMi=D}).catch(D=>{Vl.Jz("SearchHelper - Failed to check if Feedback feature is enabled: "+D.toString(),15)})});b=kL();h=w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(w.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")){this.pv={};const v=this.bdm();if(v&&0<v.length)for(let D=0;D<v.length;D++){const P=v[D],ca=this.odm(P);switch(ca.toLowerCase()){case "true":this.pv[P]=
!0;break;case "false":this.pv[P]=!1;break;default:this.pv[P]=ca}}this.pv.EnableInDocumentSearch=h;this.pv.EnableInDocumentSearchReplace=!0;this.pv.EnableInDocumentParamLocalSearch=!0;this.pv.EnableInDocumentQuerySuggest=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.pv.EnableInDocumentQuestionGeneration=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.pv.EnableInDocumentExperiment1=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.pv.EnableInDocumentExperiment2=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",
!1);this.pv.EnableInDocumentExperiment3=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.pv.EnableZeroTermAutoRefresh=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.pv.EnableTap3SZeroTerm=w.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1);this.pv.EnableLocalSearch=!0;this.pv.EnableInDocumentStickyFilters=!0;this.pv.IntentServiceEndpoint=b;this.pv.EnablePDFShredding=w.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.pv.FilterNonPPTFilesForReuseSlides=w.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.pv.UXBundleVersion=JG();this.pv.SmartLookupServicePath=LG();this.pv.EnableAcronymSearch=
!0;this.pv.UseAltAnswerEndpoint1=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.pv.UseAltAnswerEndpoint2=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.pv.UseAltAnswerEndpoint3=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.pv.UseNextUXVersion=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.pv.IgnoreNeighborhoodContext=w.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.pv.ShowDebugInfo="INT"===nD();this.pv.DebugCommands=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
"");this.pv.ChangeGates=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.pv.QnaInMixSection=!0;this.pv.EnableNoteSearch=w.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.pv.EnableWikiL2=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.pv.EnableFilteringOutRedundantKPE=
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.pv.EnableZeroTermEntitySuggestion=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.pv.RankingModels=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.pv.EnableClientSideRendering=!0}else this.Ei=new pL,this.Ei.EnableInDocumentSearch=h,this.Ei.EnableInDocumentSearchReplace=
!0,this.Ei.EnableInDocumentParamLocalSearch=!0,this.Ei.EnableInDocumentQuerySuggest=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Ei.EnableInDocumentQuestionGeneration=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1),this.Ei.EnableInDocumentExperiment1=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.Ei.EnableInDocumentExperiment2=h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.Ei.EnableInDocumentExperiment3=
h&&w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Ei.EnableZeroTermAutoRefresh=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.Ei.EnableTap3SZeroTerm=w.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.Ei.EnableLocalSearch=!0,this.Ei.EnableInDocumentStickyFilters=!0,this.Ei.IntentServiceEndpoint=b,this.Ei.EnablePDFShredding=w.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.Ei.FilterNonPPTFilesForReuseSlides=w.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Ei.UXBundleVersion=JG(),this.Ei.SmartLookupServicePath=LG(),this.Ei.EnableAcronymSearch=
!0,this.Ei.UseAltAnswerEndpoint1=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.Ei.UseAltAnswerEndpoint2=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.Ei.UseAltAnswerEndpoint3=w.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Ei.UseNextUXVersion=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.Ei.IgnoreNeighborhoodContext=w.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.Ei.ShowDebugInfo="INT"===nD(),this.Ei.DebugCommands=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.Ei.ChangeGates=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Ei.QnaInMixSection=!0,this.Ei.EnableNoteSearch=w.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.Ei.EnableWikiL2=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Ei.EnableFilteringOutRedundantKPE=
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Ei.EnableZeroTermEntitySuggestion=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.Ei.RankingModels=w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.Ei.EnableClientSideRendering=!0,this.Ei.SharedSerpletFeatureGate1=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.Ei.SharedSerpletFeatureGate2=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Ei.SharedSerpletFeatureGate3=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.Ei.SharedSerpletFeatureGate4=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Ei.SharedSerpletFeatureGate5=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.Ei.SharedSerpletFeatureGate6=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Ei.SharedSerpletFeatureGate7=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.Ei.SharedSerpletFeatureGate8=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Ei.SharedSerpletFeatureGate9=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.Ei.SharedSerpletFeatureGate10=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Ei.SharedSerpletFeatureGate11=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.Ei.SharedSerpletFeatureGate12=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Ei.SharedSerpletFeatureGate13=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.Ei.SharedSerpletFeatureGate14=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Ei.SharedSerpletFeatureGate15=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.Ei.SharedSerpletFeatureGate16=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Ei.SharedSerpletFeatureGate17=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.Ei.SharedSerpletFeatureGate18=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Ei.SharedSerpletFeatureGate19=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.Ei.SharedSerpletFeatureGate20=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Ei.SharedSerpletFeatureGate21=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.Ei.SharedSerpletFeatureGate22=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Ei.SharedSerpletFeatureGate23=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.Ei.SharedSerpletFeatureGate24=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Ei.SharedSerpletFeatureGate25=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.Ei.SharedSerpletFeatureGate26=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Ei.SharedSerpletFeatureGate27=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.Ei.SharedSerpletFeatureGate28=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Ei.SharedSerpletFeatureGate29=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.Ei.SharedSerpletFeatureGate30=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Ei.SharedSerpletFeatureGate31=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.Ei.SharedSerpletFeatureGate32=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Ei.SharedSerpletFeatureGate33=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.Ei.SharedSerpletFeatureGate34=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Ei.SharedSerpletFeatureGate35=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.Ei.SharedSerpletFeatureGate36=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Ei.SharedSerpletFeatureGate37=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.Ei.SharedSerpletFeatureGate38=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Ei.SharedSerpletFeatureGate39=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.Ei.SharedSerpletFeatureGate40=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.cxc=Ea.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");
this.nlb=HH.isEnterpriseUser();this.cRa=w.AFrameworkApplication.K.jb("SmartLookupShredderServiceEndpoint");this.gMf=ia.a.C_(w.AFrameworkApplication.K.jb("AppCatalogUrl")||"");this.n$m=w.AFrameworkApplication.K.jb("UserPrincipalName");this.nlb&&this.Tgi()}odm(b){return w.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline."+b,"")}bdm(){const b=w.AFrameworkApplication.K.z0a,h=w.AFrameworkApplication.K.LC("SmartLookupFlightKeywordList"),v=[];if(b&&h&&0<h.length)for(let P in b){var D=
{key:P,value:b[P]};D=D&&D.key?D.key:"";for(let ca=0;ca<h.length;ca++)if(-1<D.toLowerCase().indexOf(h[ca].toLowerCase())){const ta=D.split(".");ta&&4===ta.length&&Array.add(v,ta[ta.length-1])}}return v}ouf(b,h,v,D){return new Promise(P=>{this.tTm().then(ca=>{const ta=new mL;ta.anid="";ta.applicationName=3===w.AFrameworkApplication.ta.Nb.Tl?"WORD":"POWERPNT";ta.applicationVersion=w.AFrameworkApplication.buildVersion;ta.appCorrelationId=b?b:yv.XDb();ta.themePlatform="web";ta.lcid=w.AFrameworkApplication.lcid;
ta.launchUtcTime=(new Date).toUTCString();w.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?ta.featureGates=E.c(this.pv):ta.featureGates=E.c(this.Ei);var Ra=ok.a.sg(w.AFrameworkApplication.lcid);Ra=Ra?Ra.name:null;ta.market=FH(Ra);ta.uiLanguage=Ra;ta.sessionId=w.AFrameworkApplication.userSessionId;ta.themeId=v;ta.parentalControl="yes";ta.processorOnlyMode=ca;ta.isEditingAllowed=h.isEditingAllowed();ta.isFeedbackEnabled=this.zMi;ta.isClientSideRendering=18===D||19===D||15===D;ta.disableClipboard=
w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&w.AFrameworkApplication.LG&&!w.AFrameworkApplication.QCb;ta.accessToken=this.nlb?this.Tgi():"";ca=new oL;ca.CountryCode=FH(Ra);ca.ServiceEndpoint=this.cRa;ca.IsGoLocal=w.AFrameworkApplication.K.$("IsGoLocalEnvironment");ca.IsEnabled=this.nlb;ca.IsEnterpriseEnabled=this.nlb;ca.TenantRoot=this.gMf;ca.Upn=this.n$m;Ra=nD();ca.IsEUDB="PROD"===Ra&&""!==w.AFrameworkApplication.K.jb("IntentServiceEndpoint");
ta.enterpriseUserInfo=ca;ca=new nL;ca.filePath=w.AFrameworkApplication.K.jb("EditDocInClientUrl");ca.docName=w.AFrameworkApplication.K.jb("FileName");ca.author=99!==D?h.author():null;ca.createdDate=99!==D?h.createdDate():null;ta.currentDocument=ca;P(ta)})})}tTm(){return new Promise(b=>{this.Qz?this.Qz.execute(h=>{h.isFeatureEnabled(Wh.JAo,!0).then(v=>{b(!v)}).catch(v=>{Vl.Jz("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+v.toString(),10);b(!0)})}):b(!0)})}aDn(b){this.cxc&&
this.nlb&&this.aTd(this.cRa).then(h=>{b(h)})}Tgi(){return"Dev Box"===w.AFrameworkApplication.K.jb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.cxc?this.cxc.ehm(this.Yda,this.cRa):""}aTd(b){return"Dev Box"===w.AFrameworkApplication.K.jb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?new Promise(h=>
{h(window.SearchPaneShredderTokenOverride)}):this.cxc?this.cxc.getToken(this.Yda,b):Promise.resolve("")}PPc(){return this.Lyb?this.Lyb.getVersion():""}bXl(){return w.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?E.c(this.pv):E.c(this.Ei)}static isEnterpriseUser(){const b=w.AFrameworkApplication.K.jb("SovereignEnvironmentName"),h=w.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&h}}Object(n.a)(HH,"SearchHelper",null,[404]);class nE{constructor(){nE._instance=
""}getVersion(){return nE._instance}Ppo(b){nE._instance=b}}nE._instance=null;Object(n.a)(nE,"SmartLookupVersion",null,[]);class qL{}Object(n.a)(qL,"ConfigurationProvider",null,[]);class XE{constructor(b){XE._instance=b}Vqf(){return XE._instance}}XE._instance=null;Object(n.a)(XE,"SearchHostRuntime",null,[]);class IH{constructor(){this.zea=this.ASb=this.W=null}get name(){return"Common.App.Insights"}xc(b){this.W=b;const h=zb.a.zp(Ea.a.instance.Sa("Common.IEventEmitter<Common.IGetMoreInfoResult>")),v=
w.AFrameworkApplication.K.$("SmartLookupEnableNativePane")||w.AFrameworkApplication.K.$("SmartLookupIsEnabled");b.register(EH,"Common.App.Insights.InsightsActor").singleInstance().Rd(()=>new EH(b.Ue("Common.App.Insights.IInsightsManager"),w.AFrameworkApplication.va,$i.a.instance,bd.FocusManager.instance(),b.Sa("Common.App.SearchCommon.ISearchOAuthManager"),w.AFrameworkApplication.K,Qg.a.instance,v,new Gg.a(()=>h.result)));b.register(403,"Common.App.Insights.IDocumentContentExtractionManager").singleInstance().Rd(()=>
new gL(b));v&&(b.register(nE,"Common.App.Insights.SmartLookupVersion").singleInstance().Rd(()=>new nE),b.register(404,"Common.App.SearchCommon.ISearchHelper").singleInstance().Rd(()=>new HH(Ea.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Na("Common.App.Insights.SmartLookupVersion"))))}init(){w.AFrameworkApplication.U_&&(this.ASb=this.W.Na("Common.App.Insights.InsightsActor"),this.ASb.Tb())}VUn(){if(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",
!1)){var b=w.AFrameworkApplication.K.jb("SmartLookupShredderServiceEndpoint");this.W.resolve("Common.App.SearchCommon.ISearchHelper").aTd(b).then(h=>{var v={};v.Authorization="Bearer "+h;h=bN();const D=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",!0);v=new MF.a(h+("?isTelemetryOnly="+D),1,null,v,!0,2,null);w.AFrameworkApplication.Ne.send(v).fya(()=>{Vl.Jz("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+
D,50)},P=>{Vl.Jz("InsightsPackage - Failed to send refreshmemory API request. Error: "+P.toString(),10)})})}}Asl(){this.vEm();this.VUn()}vEm(){ZM().then(b=>{if(""!==b){const h=this.W.Na("Common.App.Insights.SmartLookupVersion");h&&h.Ppo(b)}this.MJd();this.ASb=this.W.resolve("Common.App.Insights.InsightsActor");b=$M(b);b=Ua.a.create(b);b.VZ((h,v)=>{v.succeeded?this.Mqo()&&this.prefetchZeroTerm():Vl.Jz("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+v.wF,10);this.ASb.Tb()});
kb.a.pX(b)})}Mqo(){const b=Object.assign(new qL,{channelId:Wh.channelId,approvedOriginPattern:KG()?"^(http)?://(localhost:8080)$":w.AFrameworkApplication.K.jb("SmartLookupApprovedOriginPattern")});var h=this.W.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const v=this.W.resolve("Common.App.SearchCommon.ISerpletExecutor"),D=this.W.resolve("Common.App.SearchCommon.IInsertContentExecutor"),P=new Fb.a;h&&P.add(h);v&&P.add(v);D&&P.add(D);h=kL();try{const ca=new lL,ta=SmartLookupHostRuntime.setup(b,
P.toArray(),!0,h,ca);this.W.register(XE,"Common.App.SearchCommon.SearchHostRuntime").singleInstance().Rd(()=>new XE(ta));return!0}catch(ca){return Vl.Jz("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+ca,10),!1}}prefetchZeroTerm(){if(w.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var b=Ea.a.instance.Na("Common.App.SearchCommon.SearchHostRuntime");
if(b){const h=this.W.resolve("Common.App.SearchCommon.ISearchHelper"),v=this.W.resolve("Common.App.SearchCommon.IDocumentHelper");h.ouf(null,v,0,99).then(D=>{b.Vqf().prefetchZeroTerm(D,w.AFrameworkApplication.userSessionId,LG(),!0,"Indoc",null)})}else Vl.Jz("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}MJd(){var b=this.W.resolve("Common.App.SearchCommon.ISearchHelper");const h=GH(b.PPc());b=b.PPc();b=PF()+(""!==b?b:Wh.g9c)+"/scripts/microsoft.office.smartlookup.ssr.js";
const v=aN();aa.a.zoa?this.zsl(h,b):(this.xsl(h,v),this.ysl(b,v))}xsl(b,h){const v=new Sys.Net.WebRequest;v.set_httpVerb("GET");const D={};D.method=v.get_httpVerb();v.set_url(b);const P=(new Date).getTime();try{window.fetch(v.getResolvedUrl(),D).then(()=>{""!==h&&Vl.q$f(h,b,(new Date).getTime()-P);this.W.Na("Common.App.Insights.SmartLookupVersion")})}catch(ca){Vl.Jz("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+ca.toString(),10)}}ysl(b,h){var v=new Sys.Net.WebRequest;
v.set_httpVerb("GET");const D={};D.method=v.get_httpVerb();v.set_url(b);let P=-1;if(w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))v=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),Qg.a.instance.Vb(new qf.a(5,1,v,()=>{const ca=Ua.a.create(b);ca.G_e(()=>{P=Date.now()});ca.VZ((ta,Ra)=>{Ra.succeeded?""!==h&&Vl.q$f(h,b,Date.now()-P):Vl.Jz("InsightsPackage - Failed to prefetch JS file.",
10)});kb.a.pX(ca)}));else{P=Date.now();try{window.fetch(v.getResolvedUrl(),D).then(()=>{""!==h&&Vl.q$f(h,b,Date.now()-P)})}catch(ca){Vl.Jz("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+ca.toString(),10)}}}zsl(b,h){if(aa.a.zoa){var v=w.AFrameworkApplication.Ne;b=new MF.a(b,1,null,null,!0,2,null);v.send(b).fya(D=>{D&&D.data?D.data.ve?this.W.Na("Common.App.Insights.SmartLookupVersion"):Vl.Jz("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
D.data.Qe,10):Vl.Jz("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},D=>{D&&D.data?Vl.Jz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+D.data.Qe,10):Vl.Jz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});w.AFrameworkApplication.K.$("SmartLookupPrefetchJSIsEnabled")&&(h=new MF.a(h,1,null,null,!0,2,null),v.send(h).fya(D=>{D&&D.data?D.data.ve||Vl.Jz("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
D.data.Qe,10):Vl.Jz("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},D=>{D&&D.data?Vl.Jz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+D.data.Qe,10):Vl.Jz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.ASb&&this.ASb.dispose()}}Object(n.a)(IH,"InsightsPackage",null,[1,2]);var rL=c(1600);class sL{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(n.a)(sL,"DocumentContentParams",null,[]);var MG=c(1871),tL=c(403),YE=c(717),Du;(function(b){b.OUa="SearchProvider";b.Q8a="TextSummarization"})(Du||(Du={}));Object(n.b)("WorkflowType",Du);var Vw;(function(b){b.Success="Success";b.fsg="Invoked";b.Error="Error"})(Vw||(Vw={}));Object(n.b)("LogType",Vw);var Ky;(function(b){b.dNj="AugloopLateResponse";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck="BlockedByQualityCheck";b.BlockedByClassifier="BlockedByClassifier";
b.bsg="InvalidAnnotation";b.KSj="StaleAnnotation";b.Timeout="Timeout";b.Other="Other"})(Ky||(Ky={}));Object(n.b)("ErrorReason",Ky);class QF{constructor(b){this.RTh=b;this.STf=this.STf.bind(this);this.zmb=this.zmb.bind(this);this.aKo=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TextSummarizationRequestTimeout",5E3)}async submitDocumentContentExtractionSignal(){try{this.Mco=Date.now();this.fob=ub.a.create().toString();this.log({cK:Du.OUa,logType:Vw.fsg,success:!0,correlationId:this.fob});
var b=nD().toLowerCase();b="int"===b||"local"===b;await this.activateAnnotation();const h=new Al.l({parentPath:["Signal",MG.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new MG.SearchProviderSignal({correlationId:this.fob,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:h});this.fij=window.setTimeout(()=>{this.onError(Du.OUa,Vw.Error,Ky.Timeout)},1500)}catch(h){window.clearTimeout(this.fij),this.onError(Du.OUa,Vw.Error,
Ky.Other,this.W8h(h))}}async generateDocumentSummaryDetails(){try{if(!QF.oWc)return null;this.$Jo=Date.now();this.log({cK:Du.Q8a,logType:Vw.fsg,success:!0});await this.activateAnnotation();const b=new Al.l({parentPath:["Signal",YE.GenerateTextSummarySignal.getTypeName()],items:[{id:"TextSummarization",body:new YE.GenerateTextSummarySignal}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});this.ezj=window.setTimeout(()=>{this.onError(Du.Q8a,Vw.Error,Ky.Timeout)},
this.aKo);return new Promise(h=>{this.Tkc=h})}catch(b){window.clearTimeout(this.ezj),this.onError(Du.Q8a,Vw.Error,Ky.Other,this.W8h(b))}}async generateDocumentSummary(){var b;return null===(b=await this.generateDocumentSummaryDetails())||void 0===b?void 0:b.summary}static get oWc(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableDocumentSummarization",!1)}static get xTm(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableVoiceSummarization",
!1)}async activateAnnotation(){if(!this.$$b){await Hq.a.Mk();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,h=[b(Object.assign(new tL.a,{annotationType:MG.SearchProviderAnnotation.getTypeName(),handler:this.STf}))];QF.oWc&&h.push(b(Object.assign(new tL.a,{annotationType:YE.TextSummaryAnnotation.getTypeName(),handler:this.zmb})));await Promise.all(h);this.$$b=!0}}zmb(b){var h,v,D;if(this.Tkc)if(this.iAi(b)){if(b=b.items[0],YE.TextSummaryAnnotation.typeGuard(b.body))if(window.clearTimeout(this.ezj),
b=b.body,b.status!==YE.Result.Success)this.onError(Du.Q8a,Vw.Error,this.GWl(b),`[TextSummary] workflow failed with status: ${b.status}`);else{this.log({cK:Du.Q8a,logType:Vw.Success,success:!0});var P=null!==b.summary&&""!==b.summary,ca=QF.xTm&&(null===(h=b.tts)||void 0===h?void 0:h.requestStatus)===YE.TTSStatus.Success&&null!==(null===(v=b.tts)||void 0===v?void 0:v.base64Audio)&&""!==(null===(D=b.tts)||void 0===D?void 0:D.base64Audio);this.Tkc({succeeded:P,summary:P?b.summary:null,audioSucceeded:ca,
audioBase64:ca?b.tts.base64Audio:null});this.Tkc=null}}else this.log({cK:Du.Q8a,logType:Vw.Error,success:!1,$Kd:Ky.bsg})}STf(b){if(this.iAi(b)&&(b=b.items[0],MG.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.fij),(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.fob)this.log({cK:Du.OUa,logType:Vw.Error,$Kd:Ky.dNj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});
else if(this.fob!==b.correlationId)this.log({cK:Du.OUa,logType:Vw.Error,$Kd:Ky.KSj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",workflowExecutionTime:b.workflowExecutionTime});else{var h=this.uLh(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);this.log({cK:Du.OUa,logType:Vw.Success,success:!0,correlationId:b.correlationId,workflowExecutionTime:b.workflowExecutionTime});this.fob=void 0;this.RTh.olj(h)}else this.onError(Du.OUa,
Vw.Error,Ky.bsg)}GWl(b){switch(b.status){case "BlockedByPrefilter":return Ky.BlockedByPrefilter;case "BlockedByQualityCheck":case "BlockedByPostfilter":return Ky.BlockedByQualityCheck;default:return Ky.Other}}iAi(b){return b&&b.items&&0<b.items.length&&b.items[0].body}log(b){switch(b.cK){case Du.OUa:var h=this.Mco;break;case Du.Q8a:h=this.$Jo;break;default:h=-1}const v=Date.now(),D=h?v-h:-1;h=[Object.assign(new na.a,{name:"WorkflowType",string:b.cK}),Object.assign(new na.a,{name:"LogType",string:b.logType}),
Object.assign(new na.a,{name:"ErrorReason",string:b.$Kd}),Object.assign(new na.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new na.a,{name:"Message",string:b.message}),Object.assign(new na.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),Object.assign(new na.a,{name:"StartTime",int64:h}),Object.assign(new na.a,{name:"EndTime",int64:v}),Object.assign(new na.a,{name:"Duration",int64:D})];Object(Xe.a)("AugloopSearchProviderData",b.success,D,h)}W8h(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}uLh(b=
"",h="",v=""){return Object.assign(new sL,{documentContentKey:b,dataCenterEndpoint:h,documentContentTableName:v})}onError(b,h,v,D){h={cK:b,logType:h,success:!1,message:D,$Kd:v};switch(b){case Du.OUa:if(!this.fob)break;h.correlationId=this.fob;this.log(h);this.fob=void 0;this.OAl();break;case Du.Q8a:if(!this.Tkc)break;this.log(h);this.Tkc(null);this.Tkc=null;break;default:return null}}OAl(){this.RTh.olj(this.uLh())}}Object(n.a)(QF,"AugloopSearchProviderManager",null,[]);class NG{constructor(){this.results=
null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(n.a)(NG,"DocumentContentSearchResults",null,[]);class JH{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,h,v,D,P){this.selectRange(h,v,D,P)}selectRangeV3(){}search(){}searchV2(b,h){this.search(b,v=>{h(Object.assign(new NG,{results:v,totalResultCount:v.length,hasTooManyResults:100<v.length}))})}searchWithParam(b,h){this.search(b.query,h)}searchWithParamV2(b,h){this.searchWithParam(b,v=>{h(Object.assign(new NG,{results:v,
totalResultCount:v.length,hasTooManyResults:v.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(n.a)(JH,"BaseDocumentContentExecutor",null,[920,375]);var KH=c(2081),uL=c(1467);class OG{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(n.a)(OG,"DocumentContentSearchParams",null,[]);class LH{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(n.a)(LH,"DocumentSelection",null,[]);class vL{constructor(){this.authorID=this.authorColor=this.authorImageURL=
null}}Object(n.a)(vL,"IAuthorProperties",null,[]);var oE=c(675);class MH{constructor(){this.rMc=this.Y8e=0}}Object(n.a)(MH,"CommentFindResultIndexInfo",null,[]);const NH=b=>{b.setSelection($e.SelectionEditor.Cj(b.gb.kb,!0,!1))},wL=b=>{b=KH.a.GRd(b.text[0]).split("\n");return 1===b.length?b[0]:b.join(" ")};class xL{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=
0;this.authorName=this.authorEmail=null}}Object(n.a)(xL,"DocumentContentSearchResult",null,[]);var cN=c(1828);class yL{constructor(){this.authorEmail=this.authorName=this.sDb=this.c9e=null}}Object(n.a)(yL,"CommentFindResults",null,[]);class zL{constructor(){this.end=this.begin=0}}Object(n.a)(zL,"FindResultOffset",null,[]);class nw{constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb){this.bve=this.sv=this.dBe=this.bB=null;this.sjh=0;this.XL=null;this.xqc=new Fb.a;this.HPg=null;this.Uu=b;this.fb=h;this.Acb=v;this.Uea=
P;this.kVb=ca;this.xtb=ta;this.Yh=Ra;this.ga=mb;this.hb=Jb}h_l(b,h){var v;const D=[];if(12!=b.type)return D;const P=Kl.FormattingReader.l4h(b);let ca=null,ta=-1;var Ra=sh.a.auto;for(let Jb=0;Jb<=P.length;Jb++){let Ub=-1;var mb=sh.a.auto;Jb<P.length&&(mb=P[Jb],Ub=mb.cp,mb=null===(v=mb.formatting)||void 0===v?void 0:v.cache,mb=(null===mb||void 0===mb?0:mb.YFb)?mb.highlight:(null===mb||void 0===mb?0:mb.APa)?mb.Vv:sh.a.auto);if(Ra!=mb){if(Ra!=sh.a.auto){ca||(ca=this.xtb.oEa(b.id));-1==Ub&&(Ub=ca.length);
Ra=this.Acb.pHd(ca,ta,Ub,"");const cc={};cc.context=Ra.$Fd;cc.startOffsetInContext=Ra.Kee;cc.endOffsetInContext=Ra.Iee-1;D.push({data:cc,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:ta,endOffsetInParagraph:Ub-1})}ta=Ub;Ra=mb}}return D}get cba(){return this.HPg}initialize(){this.bB=Rq.FindManager.createInstance(this,this.Uea,Ny.a.instance,!1,!0)}search(b,h){this.bB.LZa();this.IFf(b)?(this.sv=h,this.XL=new Fb.a,b=this.Cbf(b),this.bB.find(b)):h(null)}searchV2(b,h){w.AFrameworkApplication.Dn("Microsoft.Office.Web.SessionSettings.IWacWordCommentsInFindPaneSettings");
this.bB.LZa();if(this.IFf(b)){this.vyi()&&this.ga.Qb(Wa.a.dhe,2,{CommandValueId:b});this.bve=h;this.sjh=b.totalResultLimit;this.XL=new Fb.a;b=this.Cbf(b);this.HPg=new Ko.a;this.bB.find(b);h=this.Uea.h2c(b.text);h=this.Uea.vLb(h);b=this.kVb.L8b(h.join("|"),b);h=this.Yh.AO();for(let D=0;D<h.length;D++){const P=h[D],ca=wL(P);var v=this.xtb.uib(ca,b);const ta=this.xtb.uib(P.author,b);if(!v&&!ta){u.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!ca,!b);continue}v=ta?ta:
v;let Ra="",mb="";ta&&(Ra=P.author,mb=P.authorId);for(const Jb of v)v=cN.a.createInstance(Jb.begin,Jb.end,W.a.Ef(P.objectId),D,32,!1),this.xqc.add(v),this.cba.mb(D)||this.cba.add(D,Object.assign(new yL,{c9e:ca,sDb:[],authorName:Ra,authorEmail:mb}))}}else h(null)}get I_h(){null==this.dBe&&(this.dBe=Rq.FindManager.createInstance(this,this.Uea,Ny.a.instance));return this.dBe}vyi(){var b;return null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",
!1)}Zac(){var b;return null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}highlight(b){var h=this.IFf(b);b=h?this.Cbf(b):null;var v={};this.vyi()&&this.ga.Qb(Nc.a.B2f,2,v);if(v[If.a.On]){if(h){h={};v={};var D={};this.ga.Qb(Nc.a.obe,2,h);this.ga.Qb(Wa.a.nbe,2,v);this.ga.Qb(Wa.a.pbe,2,D);if(b.text!=h.CommandValueId||b.matchCase!=v[If.a.On]||b.matchWholeWord!=D[If.a.On])NH(this.hb),this.ga.Qb(Wa.a.findInDocument,
2,{CommandValueId:b.text,MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else v=this.I_h,v.LZa(),h&&v.find(b)}selectNextPrevHighlight(b){const h=this.I_h;return 0<h.Qj.tja?(b?h.Qki():h.Vki(),h.Qj.QYe-1):-1}Cbf(b){let h=ku.a.none;b.matchCase&&(h|=ku.a.matchCase);b.matchWholeWordOnly&&(h|=ku.a.wholeWordOnly);return gt.a.createQuery(b.query,h)}IFf(b){return b&&!!b.query&&0<b.query.length}Yhe(){}qge(){}reset(){}Skf(){}D6b(){if(this.sv){var b=this.vLh(this.XL);this.sv(b)}if(this.bve){b=new NG;
const h=this.XL.count+this.xqc.count>this.sjh;b.totalResultCount=this.XL.count+this.xqc.count;b.hasTooManyResults=h;h||(this.XL.PC(this.XL.count,this.xqc),b.results=this.vLh(this.XL));this.bve(b);this.xqc.clear()}}vLh(b){var h;const v=[];var D=Object.assign(new oE.a,{TO:!1,$ba:!0,hoa:this.Zac(),UO:!0});D=this.fb.nEa(this.Uu.value,D);for(const ta of b){var P=ta.begin;let Ra=ta.end;var ca=void 0;b=-1;let mb=null,Jb=0;if(32===ta.type){mb=nw.b9e;Jb=3;b=D.count+ta.FPa;const Ub=({begin:P,end:Ra}=rL.a.V$i(this.cba.J(ta.FPa).c9e,
P,Ra)).returnValue;ca=this.Acb.pHd(Ub,P,Ra,lu.a(ta.type));this.cba.J(ta.FPa).c9e=Ub;this.cba.J(ta.FPa).sDb.push(Object.assign(new zL,{begin:P,end:Ra}))}else{if(2===ta.type||4===ta.type)Jb=2===ta.type?1:2,mb=nw.Rxf;if(8===ta.type||16===ta.type)Jb=8===ta.type?6:5,mb=nw.CRf;for(ca=0;ca<D.count;ca++)if(D.J(ca).id===ta.nodeId){b=ca;break}ca=this.Acb.qHd(ta)}P=(null===(h=this.cba)||void 0===h?0:h.mb(ta.FPa))?this.cba.J(ta.FPa):null;if(0<=b||(null===P||void 0===P?0:P.authorName))b=Object.assign(new xL,{snippet:ca.$Fd,
subdocumentId:mb,subdocumentType:Jb,startOffsetInSnippet:ca.Kee,endOffsetInSnippet:ca.Iee-1,paragraphIndex:b,startOffsetInParagraph:ta.begin-ca.Kee,endOffsetInParagraph:ta.end-ca.Iee-1,authorName:P?P.authorName:"",authorEmail:P?P.authorEmail:""}),v.push(b)}v.sort((ta,Ra)=>ta.paragraphIndex===Ra.paragraphIndex?ta.startOffsetInParagraph-Ra.startOffsetInParagraph:ta.paragraphIndex-Ra.paragraphIndex);return v}update(){}COa(b,h){switch(b){case 0:h&&0<h.length&&!this.XL&&(u.ULS.sendTraceTag(570975814,313,
15,"Results container list is null"),this.XL=new Fb.a);for(const v of h)this.XL.add(v)}}Fob(){}dispose(){}}nw.b9e="Comment";nw.Rxf="HeaderFooter";nw.CRf="Note";nw.Ypi="Image";Object(n.a)(nw,"WordDocumentSearchProcessor",null,[376,10,377]);class AL extends JH{get LR(){return!this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.NoCommentFocusOnFindSelection",!1)}Zac(){var b;return null===(b=w.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",
!1)}constructor(b,h,v,D,P,ca,ta,Ra,mb,Jb,Ub,cc,Ac,Lc){super();this.Fa=Jb;this.lMa=null;this.tY=(id,vd)=>{id=vd.node;vd=vd.property;this.tdg(id)&&vd===lf.a.lo&&this.QFb(id,3)};this.bia=(id,vd)=>{id=vd.node;!vd.PCf&&this.tdg(id)&&this.QFb(id,1)};this.smb=(id,vd)=>{id=vd.node;this.tdg(id)&&this.QFb(id,2)};this.Uu=b;this.fb=h;this.fd=v;this.hb=D;this.zE=P;this.tl=Ra;this.Ub=mb;this.h7=ca;this.oC=ta;this.Yh=Ub;this.S7j=cc;this.Ndh=W.a.create();this.lde(this.tY,this.bia,this.smb);Lc&&Lc.execute(id=>this.Zka=
id);Ac.execute(id=>{this.eYa=id})}submitDocumentContentExtractionSignal(){this.eYa&&this.eYa.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.eYa?this.eYa.generateDocumentSummary():Promise.resolve(null)}generateDocumentSummaryDetails(){return this.eYa?this.eYa.generateDocumentSummaryDetails():Promise.resolve(null)}getAllParagraphsInDocument(){const b=this.$T(this.i8l());for(const v of this.Yh.AO()){var h=KH.a.GRd(v.text[0]).split("\n");h=1===h.length?h[0]:h.join(" ");
b.add(h)}return b.toArray()}extractDocumentObjects(b){var h=Object.assign(new oE.a,{TO:!1,$ba:!1,UO:!0}),v=this.fb.nEa(this.Uu.value,h);h=[];const D=[];for(var P=0;P<v.count;++P){var ca=v.J(P);h.push(...this.e0l(ca,P));D.push(...this.h7.h_l(ca,P))}v=[];P=this.Yh.AO();for(ca=0;ca<P.length;ca++)v.push(this.IRl(P[ca]));P={};P.images=h;P.comments=v;P.highlights=D;b(P)}selectRange(b,h,v,D,P){const ca=Date.now(),ta={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};
try{this.jTa();if(0>b||0>h||0>v||0>D||b>v||b===v&&h>D)throw Error("Provided select range offsets incorrect");const Lc=Object.assign(new oE.a,{TO:!1,$ba:!0,hoa:this.Zac(),UO:!0}),id=this.fb.nEa(this.Uu.value,Lc);if(v>=id.count){const vd=Ea.a.instance.resolve("Common.Comments.ICommentModel").AO(),xe=v-id.count;if(xe<vd.length){P=-1;if(this.h7.cba.mb(xe)){const Qd=this.h7.cba.J(xe).sDb;for(var Ra=0;Ra<Qd.length;Ra++)if(Qd[Ra].begin===h){P=Ra;break}}this.lMa=-1!==P?Object.assign(new MH,{Y8e:xe,rMc:P}):
null;const Ld=vd[xe];w.AFrameworkApplication.va.processAction(Nc.a.xT,2);w.AFrameworkApplication.va.Qb(Nc.a.D3,2,null);w.AFrameworkApplication.va.Qb(Nc.a.selectComment,2,Object.assign(new uL.a,{commentId:Ld.id,M9:2,LR:this.LR}))}}else{this.lMa=null;var mb=id.J(b),Jb=id.J(v);if(!this.u0d(mb,h)||!this.u0d(Jb,D))throw Error("Provided select range offsets incorrect");w.AFrameworkApplication.va.processAction(Nc.a.xT,2);this.YLo(mb);var Ub=this.zE.pe(mb,h);Ra=this.zE.oz(Ub,we.a.Qc(Jb,D+1));if(P){const vd=
Ra.toArray();h=[];for(const xe of vd)h.push(this.vRd(xe.node));h.join(" ").includes(P)||(ta.success=!1,ta.message="The text in clicked passage does not match the selected hit")}var cc=this.tl.value.yu,Ac=this.hb.gb.kb;Ac&&Ac.equals(Ra)&&this.fd.rda(cc,null);this.fd.rda(cc,Ra);ta.duration=Date.now()-ca;this.logMessage(ta)}}catch(Lc){ta.success=!1,ta.message=Lc.stack,ta.duration=Date.now()-ca,this.logMessage(ta)}}search(b,h){this.jTa();this.h7.search(Object.assign(new OG,{query:b}),h)}searchV2(b,h){this.jTa();
this.h7.searchV2(Object.assign(new OG,{query:b}),h)}selectNextPrevHighlight(b){this.jTa();return this.h7.selectNextPrevHighlight(b)}searchWithParam(b,h){this.jTa();this.h7.search(b,h)}searchWithParamV2(b,h){this.jTa();this.h7.searchV2(b,h)}highlight(b){this.jTa();this.h7.highlight(Object.assign(new OG,{query:b}))}highlightWithParam(b){this.jTa();this.h7.highlight(b)}getRevision(){return this.Ndh.toString()}getSelectedText(){const b=this.S7j.getSelectedText();return Object.assign(new Sx.a,{neighborhood:b.neighborhood,
mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new oE.a,{TO:!1,$ba:!0,hoa:this.Zac(),UO:!0}),h=({Yr:ca}=this.Mcm(b)).returnValue;if(h)return h;var v=this.hb.gb.kb;if(!v||!v.length)return null;h=v.Oa;v=v.Pc;let D=-1,P=-1;var ca=ca||this.fb.nEa(this.Uu.value,b);b=null;for(let ta=0;ta<ca.count;ta++){const Ra=ca.J(ta);-1===D&&h.node.id===Ra.id&&(D=ta,b=Ra);-1===P&&v.node.id===Ra.id&&(P=ta)}ca=null;5===(null===b||void 0===b?void 0:b.Yma)&&(ca=nw.Rxf);
if(1===(null===b||void 0===b?void 0:b.Yma)||2===(null===b||void 0===b?void 0:b.Yma))ca=nw.CRf;return Object.assign(new LH,{subdocumentId:ca,startParagraphIndex:D,startParagraphOffset:h.wj,endParagraphIndex:P,endParagraphOffset:v.Yo})}clearDocumentSelection(){NH(this.hb)}selectRangeV2(b,h,v,D,P,ca){const ta=Date.now(),Ra={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.jTa();if(0>h||0>v||0>D||0>P||h>D||h===D&&v>P)throw Error("Provided select range offsets incorrect");
var mb=Object.assign(new oE.a,{TO:!1,$ba:!0,hoa:this.Zac(),UO:!0});const Ac=this.fb.nEa(this.Uu.value,mb);if(b==nw.b9e)this.sij(v,D,Ac.count);else{mb=this.lMa=null;var Jb={};Jb.subdocumentId=b;Jb.startParagraphIndex=h;Jb.startParagraphOffset=v;Jb.endParagraphIndex=D;Jb.endParagraphOffset=P;mb=b==nw.Ypi?this.aai(Ac.J(h),{isFloatingImage:!1,imageId:"",...Jb}):this.Eii(Ac.J(h),Ac.J(D),{clickedPassage:ca,...Jb},Ra);var Ub=this.tl.value.yu,cc=this.hb.gb.kb;(null===cc||void 0===cc?0:cc.equals(mb))&&this.fd.rda(Ub,
null);this.fd.rda(Ub,mb)}Ra.duration=Date.now()-ta;this.logMessage(Ra)}catch(Ac){Ra.success=!1,Ra.message=Ac.stack,Ra.duration=Date.now()-ta,this.logMessage(Ra)}}selectRangeV3(b){const h=Date.now(),v={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.jTa();if(0>b.startParagraphIndex||0>b.startParagraphOffset||0>b.endParagraphIndex||0>b.endParagraphOffset||b.startParagraphIndex>b.endParagraphIndex||b.startParagraphIndex===b.endParagraphIndex&&b.startParagraphOffset>
b.endParagraphOffset)throw Error("Provided select range offsets incorrect");var D=Object.assign(new oE.a,{TO:!1,$ba:!0,hoa:this.Zac(),UO:!0});const ta=this.fb.nEa(this.Uu.value,D);if(b.subdocumentId==nw.b9e)this.sij(b.startParagraphOffset,b.endParagraphIndex,ta.count);else{D=this.lMa=null;D=b.subdocumentId==nw.Ypi?this.aai(ta.J(b.startParagraphIndex),b):this.Eii(ta.J(b.startParagraphIndex),ta.J(b.endParagraphIndex),b,v);var P=this.tl.value.yu,ca=this.hb.gb.kb;(null===ca||void 0===ca?0:ca.equals(D))&&
this.fd.rda(P,null);this.fd.rda(P,D)}v.duration=Date.now()-h;this.logMessage(v)}catch(ta){v.success=!1,v.message=ta.stack,v.duration=Date.now()-h,this.logMessage(v)}}i8l(){const b=Date.now(),h={activityName:"GetParagraphNodes",success:!0,message:"",duration:0},v=Object.assign(new oE.a,{TO:!1,$ba:!1,UO:!0});h.duration=Date.now()-b;this.logMessage(h);return this.fb.nEa(this.Uu.value,v)}$T(b){const h=Date.now(),v={activityName:"GetParagraphContent",success:!0,message:"",duration:0},D=new Fb.a;for(const P of b)D.add(this.vRd(P));
v.duration=Date.now()-h;this.logMessage(v);return D}aai(b,h){if(h.isFloatingImage)return h=W.a.Ef(h.imageId),b=b.Kc.Db(h),b=Og.SelectionFactory.wq(b);const v=this.zE.pe(b,h.startParagraphOffset);return b=this.zE.oz(v,we.a.Qc(b,h.startParagraphOffset+1))}async getAuthorImageUrlFromClient(b,h){b=new Sj.a(b,"O365",h,b);if(!this.Zka||!this.Zka.getPersonaIconPropertiesArray)return null;b=await this.Zka.getPersonaIconPropertiesArray([b]);return 0<b.length&&b[0].authorImageURL?Object.assign(new vL,{authorImageURL:b[0].authorImageURL,
authorColor:b[0].authorColor,authorID:b[0].authorID}):null}Eii(b,h,v,D){if(!this.u0d(b,v.startParagraphOffset)||!this.u0d(h,v.endParagraphOffset))throw Error("Provided select range offsets incorrect");v.subdocumentId==nw.Rxf?w.AFrameworkApplication.va.Qb(Nc.a.Qkb,2,new sx.a(b)):w.AFrameworkApplication.va.processAction(Nc.a.xT,2);v.subdocumentId==nw.CRf?32===w.AFrameworkApplication.va.Qb(Nc.a.R4a,2,new sx.a(b))&&w.AFrameworkApplication.va.processAction(Nc.a.jNd,2):w.AFrameworkApplication.va.Qb(Nc.a.D3,
2,null);b=this.zE.pe(b,v.startParagraphOffset);h=this.zE.oz(b,we.a.Qc(h,v.endParagraphOffset+1));if(v.clickedPassage){b=h.toArray();const P=[];for(const ca of b)P.push(this.vRd(ca.node));P.join(" ").includes(v.clickedPassage)||(D.success=!1,D.message="The text in clicked passage does not match the selected hit")}return h}sij(b,h,v){const D=Ea.a.instance.resolve("Common.Comments.ICommentModel").AO();h-=v;if(h<D.length){v=-1;if(this.h7.cba.mb(h)){const P=this.h7.cba.J(h).sDb;for(let ca=0;ca<P.length;ca++)if(P[ca].begin===
b){v=ca;break}}this.lMa=-1!==v?Object.assign(new MH,{Y8e:h,rMc:v}):null;b=D[h];w.AFrameworkApplication.va.processAction(Nc.a.xT,2);w.AFrameworkApplication.va.Qb(Nc.a.D3,2,null);w.AFrameworkApplication.va.Qb(Nc.a.selectComment,2,Object.assign(new uL.a,{commentId:b.id,M9:2,LR:this.LR}))}}jTa(){this.Ub&&(this.Ub.currentScope&&this.Ub.currentScope.name===Wh.$B||this.Ub.mg(Wh.$B))}CZo(){this.Ndh=W.a.create()}vRd(b){if(b.nHb)return"";b=this.fb.text(b);return Po.AParagraphNode.IR(b," ")}u0d(b,h){b=this.vRd(b);
return h<b.length}QFb(b,h){switch(h){case 1:case 2:case 3:this.CZo()}}logMessage(b){const h=[Object.assign(new na.a,{name:"Message",string:b.message})];Object(Xe.a)(b.activityName,b.success,b.duration,h)}tdg(b){return!b.nHb&&this.iVc(b)}iVc(b){const h=this.Uu.value;return!!h&&!!h.od&&!!b.Kc&&b.Kc.id.equals(h.od.id)}YLo(b){this.fb.Pac(b)?32===w.AFrameworkApplication.va.Qb(Nc.a.R4a,2,new sx.a(b))&&w.AFrameworkApplication.va.processAction(Nc.a.jNd,2):w.AFrameworkApplication.va.Qb(Nc.a.D3,2,null)}lde(b,
h,v){this.oC&&(this.oC.Go(b),this.oC.$t(h),this.oC.Ax(v))}Mcm(b){let h=null;var v=this.Ub?this.Ub.currentScope.name:"";if(!this.Yh.nt||v!==Ne.AFrame.Kr&&v!==Ne.AFrame.sM)return{returnValue:null,Yr:h};v=Array.indexOf(this.Yh.AO(),this.Yh.nt);if(0>v)return{returnValue:null,Yr:h};h=this.fb.nEa(this.Uu.value,b);var D=KH.a.GRd(this.Yh.nt.text[0]).split("\n");b=0;D=(1===D.length?D[0]:D.join(" ")).length-1;this.lMa&&v===this.lMa.Y8e&&this.h7.cba.mb(v)&&this.h7.cba.J(v).sDb.length>this.lMa.rMc&&(b=this.h7.cba.J(v).sDb[this.lMa.rMc].begin,
D=this.h7.cba.J(v).sDb[this.lMa.rMc].end);return{returnValue:Object.assign(new LH,{startParagraphIndex:h.count+v,startParagraphOffset:b,endParagraphIndex:h.count+v,endParagraphOffset:D,subdocumentId:"Comment"}),Yr:h}}e0l(b,h){const v=[];if(12!=b.type)return v;v.push(...this.E0l(b,h));v.push(...this.hYl(b,h));return v}hYl(b,h){const v=[],D=he.GraphIterator.$a(b);if(!D.vz())return v;let P=D.Pd();for(;P;){if(!this.gQa(P)){P=D.Bt();continue}const ca=P.properties;ca&&oe.ImageReader.HUc(ca)&&v.push(this.sBj(ca,
h,0,b.Kc,!0,P.id.toString()));P=D.Bt()}return v}gQa(b){if(19!==b.type||5!==oe.ImageReader.Ui(b))return!1;b=he.GraphIterator.$a(b);if(!b.vz())return!0;let h=b.Pd();for(;h;){if(59===h.type)return!1;h=b.Bt()}return!0}E0l(b,h){const v=[],D=b.Kc;if(D){if(!b.hasProperty(lf.a.Gn))return v;var P=b.ia(lf.a.Gn,null);if(!P)return v;b=b.ia(lf.a.zm,null);for(let ta=0;ta<P.length;++ta){var ca=P[ta];if(!ca)continue;ca=D.Db(ca);if(!ca||!oe.ImageReader.HUc(ca)||5!==oe.ImageReader.Ui(ca))continue;let Ra=0;0!=ta&&b&&
ta-1<b.length&&(Ra=b[ta-1]);v.push(this.sBj(ca,h,Ra,D,!1,""))}return v}}sBj(b,h,v,D,P,ca){D=(new Sys.Net.WebRequest).getResolvedUrl()+oe.ImageReader.M6l(b,D);const ta=b.ia(Wc.a.hu,""),Ra={};Ra.base64Encoding=ta;Ra.url=D;Ra.width=oe.ImageReader.JC(b);Ra.height=oe.ImageReader.HH(b);Ra.altText=oe.ImageReader.yX(b);Ra.description=oe.ImageReader.fPa(b);Ra.imageId=ca;Ra.isFloatingImage=P;return{data:Ra,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:v,endOffsetInParagraph:v+1}}IRl(b){return{data:{comment:wL(b),
authorName:b.author,authorEmail:b.authorId,objectId:b.objectId,authorImageURL:""},startParagraphIndex:-1,endParagraphIndex:-1,startOffsetInParagraph:-1,endOffsetInParagraph:-1}}}Object(n.a)(AL,"WordDocumentContentExecutor",JH,[]);class PG{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(n.a)(PG,"BaseDocumentHelper",null,[412]);class BL extends PG{constructor(b){super();this.SJl=b}get s5b(){const b=this.SJl.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return Xa.App.xa.ib.isEditingAllowed}author(){var b;
return null===(b=this.s5b)||void 0===b?void 0:b.author}createdDate(){var b;return null===(b=this.s5b)||void 0===b?void 0:b.creationDate}}Object(n.a)(BL,"WordDocumentHelper",PG,[]);class CL{constructor(b){this.XLi=b}insertOnlinePicture(){}insertHtmlText(b){b&&this.DAf(b.htmlText)}getId(){return"InsertContentExecutor"}DAf(b){return this.executeCommand(Gb.a.pCa,b)}executeCommand(b,h){const v=new Md.DictionaryPropertySet;v.setValue(Wc.a.iP,h);v.setValue(Wc.a.Pia,!1);h=this.XLi.processAction(b,1);32===
h&&(h=this.XLi.Qb(b,2,v));return h}}Object(n.a)(CL,"WordInsertContentExecutor",null,[374,375]);var dN=c(1712),eN=c(1713);class DL{constructor(b,h,v,D,P){this.nrc="undefined";this.Ncg="Something went wrong with retrieving a summary. Please try again.";this.NFm=(ca,ta,Ra,mb,Jb)=>yv.XX(ca,ta,Ra,mb,this.mC,Jb);this.Sie=(ca,ta,Ra,mb,Jb)=>{if(1===Ra)return this.T8j?32:8;ca=mG.getSelectedText();ca=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuDictionarySmartLookupWithQuery,mG.YRd(ca));Jb[Hl.a.LabelText]=
ca;return 32};this.cnf=(ca,ta,Ra)=>{if(1===Ra)return 32;const mb={};this.eYa?this.eYa.generateDocumentSummary().then(Jb=>{Jb||(Jb=this.Ncg,u.ULS.sendTraceTag(509723399,1303,15,"Share with summary: Generated document summary is empty."));mb.additionalData=this.iaf(Jb);this.ga.Qb(Wa.a.k8,2,mb)}).catch(()=>{u.ULS.sendTraceTag(509723398,1303,15,"Share with summary: Error in generating document summary.");mb.additionalData=this.iaf(this.Ncg);this.ga.Qb(Wa.a.k8,2,mb)}):(u.ULS.sendTraceTag(509723397,1303,
15,"Share with summary: Search provider manager is unavailable."),mb.additionalData=this.iaf(this.Ncg),this.ga.Qb(Wa.a.k8,2,mb));return 32};this.KNo=(ca,ta,Ra)=>{if(!this.KMi)return u.ULS.sendTraceTag(508929473,1303,15,"Cannot get a token for Transform to Slides action."),8;if(1===Ra)return this.ZUm()?32:2;if(2===Ra)this.KMi.aTd(this.Fa.jb("SmartLookupShredderServiceEndpoint")).then(mb=>{mb={token:mb,files:E.c(this.kXl()),type:"MultiFilesDeckGeneration"};mb=Object.assign(new dN.a,{selection:Object.assign(new Sx.a,
{neighborhood:"",mentionStart:0,mentionLength:0}),launchData:Object.assign(new Cu.a,{landingTab:"All",data:mb}),entryPoint:38});this.ga.Qb(Wa.a.F8,2,mb);return 32}).catch(()=>{u.ULS.sendTraceTag(508929472,1303,15,"Error in getting a token for Transform to Slides action.");return 8});else return 32};this.mC=b;this.ga=h||w.AFrameworkApplication.va;this.Fa=v;this.C8j=(this.Lw=!!w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.yJ)&&!!this.Fa&&this.Fa.$("AutoOpenSearchPaneInDoublePortraitIsEnabled");
this.T8j=!!this.Fa&&this.Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1);D&&D.execute(ca=>{this.eYa=ca});this.KMi=P}Tb(){this.ga.eb(Nc.a.rwh,ud.a.frame,this.NFm,1028);this.ga.eb(Nc.a.Sie,ud.a.frame,this.Sie,1028);this.ga.eb(Nc.a.q3h,ud.a.frame,this.cnf,1028);this.ga.eb(Nc.a.tBj,ud.a.frame,this.KNo,1028);this.C8j&&(this.nrc=Xa.App.xa.GI.getWindowMode(),this.LWh(this.nrc),Xa.App.xa.GI.registerBoundingWindowRectsChanged("SearchPane",(b,h)=>{h!==this.nrc&&(this.nrc=
h,this.LWh(this.nrc))}))}ZUm(){return w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableTransformToSlidesInRibbon",!1)&&w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableContentTransformInL2",!1)}LWh(b){"DP"===b&&el.UISurfaces.Gu().then(h=>{h.selectors.getTabbedTaskPaneCount()||this.ga.Qb(Nc.a.rwh,2,{SourceControlId:"smartlookupAuto"});return null})}iaf(b){return{["documentSummary"]:b}}kXl(){const b=new eN.a("docx",
w.AFrameworkApplication.K.jb("EditDocInClientUrl"),w.AFrameworkApplication.K.jb("BreadcrumbBrandUrl"),"",w.AFrameworkApplication.sessionStartInfoSettings.FileSizeBytes,(new Date).toLocaleString()),h=[];Array.add(h,b);return h}}Object(n.a)(DL,"WordInsightsActor",null,[]);class ZE{constructor(){this.Jgd=this.ZP=null}j1a(){return this.HEb()}xai(){return this.HEb()}vai(){return null}Nxo(b,h,v){this.ZP||(this.ZP=this.ZGd());this.ZP.pP(b,h,v)}Oxo(b,h,v){this.ZP||(this.ZP=this.ZGd());this.ZP.Peg(b,h,v)}jwo(b,
h){this.Jgd||(this.Jgd=null);this.Jgd&&this.Jgd.Peg(b,h)}cOb(b,h){this.ZP||(this.ZP=this.ZGd());this.ZP.cOb(b,h)}f1d(b){this.ZP||(this.ZP=this.ZGd());this.ZP.f1d(b)}Qeo(){this.ZP&&this.ZP.Iic()}yjo(){this.ZP&&this.ZP.Rge()}wvo(){var b=w.AFrameworkApplication.K.mc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);b=window.performance.now()-ZE.yFi<=b;b||(ZE.yFi=window.performance.now());return b}dispose(){this.ZP&&(this.ZP.dispose(),this.ZP=null)}get PHb(){return this.ZP?this.ZP.isVisible:!1}}
ZE.yFi=0;Object(n.a)(ZE,"InsightsManager",null,[943,10]);class RF{constructor(b,h,v,D,P,ca=!0,ta=null,Ra=null){this.U5=this.yE=this.VKa=null;this.Uvc=!1;this.zea=null;this.Ub=h;this.AWb=ca;this.VSg=Ra?Ra:new PG;this.Qz=ta;this.fp=b;this.AWb&&(Ea.a.instance.Na("Common.App.SearchCommon.SearchHostRuntime")&&(this.zea=Ea.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").Vqf()),this.Bcb=Ea.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.Lyb=this.Bcb.PPc())}nmb(b){if(this.AWb){b=
b.rawEvent;try{var h=E.a(b.data)}catch(v){u.ULS.sendTraceTag(595161728,1303,15,this.OT("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(h.actionType){case 101:b=0;this.yE&&(b=this.yE.entryPoint);this.Bcb.ouf(this.U5,this.VSg,this.j9b(),b).then(v=>{h.data=v;this.gnb(h)});break;case 118:h.data=this.yE?this.yE:Object.assign(new iu.a,{selection:Object.assign(new Sx.a,{neighborhood:this.VKa.neighborhood,mentionStart:this.VKa.mentionStart,mentionLength:this.VKa.mentionLength})});
this.gnb(h);break;case 103:b=E.a(Object(Na.a)(String,h.data));Vl.sendTelemetryEvent(b);break;case 206:this.Bcb.aTd(h.data).then(v=>{h.data=v;this.gnb(h)});break;case 112:h.data.shiftPressed?(aa.a.lj&&document.activeElement.blur(),this.fp.PUd(0,null,2,null,null),u.ULS.sendTraceTag(592545156,1303,50,this.OT("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.fp.GQc(0,null,2,null,null),u.ULS.sendTraceTag(592545155,1303,50,this.OT("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.$na()}}}v6c(b){if(this.zea){var h=
0;this.yE&&(h=this.yE.entryPoint);this.Bcb.ouf(this.U5,this.VSg,this.j9b(),h).then(v=>{Vl.rjj("SearchFromHost",this.U5);this.yE.launchData||(this.yE.launchData=new Cu.a);const D=LG();try{this.zea.search(this.yE,v,w.AFrameworkApplication.userSessionId,D,b),this.Bcb.aDn(P=>{Vl.rjj("SearchFromHostWithToken",this.U5);this.zea.searchAuthenticatedProviders(this.yE,v,w.AFrameworkApplication.userSessionId,D,null,P)})}catch(P){Vl.Jz("BaseSmartLookupPane - Fail to search from host. Error: "+P,10)}}).catch(v=>
{Vl.Jz("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+v.toString(),10)})}}Jic(b){if(this.AWb){var h=Vl,v=h.Jic,D=this.U5;b=Math.round(window.performance.now()-b);var P=this.yE?WE[this.yE.entryPoint]:"",ca=this.Bcb.PPc(),ta=this.Bcb.bXl(),Ra=this.yE?this.yE.entryPoint:0;v.call(h,D,b,P,ca,ta,w.AFrameworkApplication.$0e,this.Uvc,18===Ra||19===Ra||15===Ra)}}}Object(n.a)(RF,"BaseSmartLookupPane",null,[402,10]);class SF{constructor(b){this.messageType=null;this.messageType=
b}}Object(n.a)(SF,"InsightsMessage",null,[]);class TF extends SF{constructor(b,h){super(b);this.messageContent=null;this.messageContent=h}}Object(n.a)(TF,"InsightsMessageWithContent",SF,[]);class EL extends TF{constructor(b){super(Wh.cen,b)}}Object(n.a)(EL,"InsightsMessageAppProperties",TF,[]);class FL extends TF{constructor(b){super(Wh.oen,b)}}Object(n.a)(FL,"InsightsMessageSelection",TF,[]);class GL extends SF{constructor(){super(Wh.ren)}}Object(n.a)(GL,"InsightsMessageTakeFocus",SF,[]);class UF extends RF{constructor(b,
h,v,D,P=null,ca=null,ta=null,Ra=!0,mb=null,Jb=null){super(h,v,P,ca,ta,Ra,mb,Jb);this.Hfd=this.dB=this.ij=null;this.Xqd=!1;this.Jld=b;this.Auc=this.AWb?GH(this.Lyb):w.AFrameworkApplication.bEm;this.d_();this.x4f();this.Wp=D;this.KRg=0}get isVisible(){return!1}d_(){this.ij=this.Jld.RIc();w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb.hkb&&this.ij.MXn(b=>{b===this.ij&&(this.Rge(),this.Iic())});this.hAf(this.ij.ETa.Zwh);this.ij.xm()}hAf(b){b.style.overflow="hidden";const h=Cg.a.createElement("iframe");
Sys.UI.DomElement.addCssClass(h,"InsightsPaneIFrame");h.setAttribute("Unselectable","off");this.dB=h;b.appendChild(this.dB);this.dB.id=Wh.Myf}x4f(){Le.a.addHandler(this.dB,"load",Object(z.a)(this,this.mmb,"onIFrameLoad"));Le.a.addHandler(this.dB,"error",Object(z.a)(this,this.lmb,"onIFrameError"));$addHandler(window,"message",Object(z.a)(this,this.nmb,"onIFrameMessage"))}Slg(){Le.a.removeHandler(this.dB,"load",Object(z.a)(this,this.mmb,"onIFrameLoad"));Le.a.removeHandler(this.dB,"error",Object(z.a)(this,
this.lmb,"onIFrameError"));$removeHandler(window,"message",Object(z.a)(this,this.nmb,"onIFrameMessage"))}dispose(){this.dB&&(this.Slg(),this.dB.parentNode.removeChild(this.dB),this.dB=null);this.ij&&(this.Jld.k5b(this.ij),this.ij=null)}pP(b,h,v){this.U5=h;this.Hfd=null;this.KRg=v;this.Uvc=!b.mentionLength;this.Xqd=!1;u.ULS.sendTraceTag(6295947,1303,50,this.OT("Start to show Insights"));this.VKa=b;this.Auc&&this.Auc.length?this.dB.src=this.Auc:(this.dB.src=UF.qSi,u.ULS.sendTraceTag(6295948,1303,15,
this.OT("The Insights URL config setting is null or empty")));this.Wp.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0);this.ij.gY||this.ij.F4f(Object(z.a)(this,this.Eqn,"onInsightsTaskPaneHidden"));this.AWb&&this.v6c(!1);b=window.performance.now();this.Jld.showTaskPane(this.ij);this.ij.xm();this.Jic(b)}Peg(b,h,v){this.yE=b;this.pP(Object.assign(new OF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,v)}cOb(){}f1d(){}Iic(){this.dB.src===
this.Auc&&this.Xqd&&(this.Ub.mg(Wh.$B),this.gnb(new GL))}Rge(){this.dB&&bd.FocusManager.YJ(this.dB.contentWindow)}qdf(){this.dB.src=UF.qSi;this.ij.ym()}$na(){this.Jld.hideTaskPane(this.ij);this.qdf()}Eqn(b){b===this.ij&&this.$na()}mmb(){u.ULS.sendTraceTag(6295951,1303,50,this.OT("The iframe is successfully loaded in Insights task pane"))}lmb(){u.ULS.sendTraceTag(6295952,1303,15,this.OT("The iframe failed to load in Insights task pane"))}nmb(b){const h=b.rawEvent;if(h.source===this.dB.contentWindow)if(this.AWb)super.nmb(b);
else{let v;try{v=E.a(h.data)}catch(D){u.ULS.sendTraceTag(6295953,1303,15,this.OT("Message data [{0}] failed to deserialize.",h.data));return}if(nf.c(v.messageType))u.ULS.sendTraceTag(6295954,1303,15,this.OT("Message data [{0}] is in wrong format.",h.data));else switch(v.messageType){case Wh.den:this.gnb(new EL(this.N0l()));break;case Wh.qen:this.gnb(new FL(this.VKa));break;case Wh.jen:this.Xqd=!0;this.Rge();this.Iic();u.ULS.sendTraceTag(6295955,1303,50,this.OT("Insights pane rendering is completed"));
break;case Wh.sen:b=v.messageContent;this.Hfd=b.clientCorrelationId;this.U5!==b.appCorrelationId&&u.ULS.sendTraceTag(6403778,1303,15,this.OT("App correlation ID on client {0} does not match one on server {1}",this.U5,b.appCorrelationId));break;case Wh.ien:v.messageContent?(aa.a.lj&&document.activeElement.blur(),this.fp.PUd(0,null,2,null,null),u.ULS.sendTraceTag(6604741,1303,50,this.OT("Insights UX lost focus through Ctrl + Shift + F6"))):(this.fp.GQc(0,null,2,null,null),u.ULS.sendTraceTag(6604742,
1303,50,this.OT("Insights UX lost focus through Ctrl + F6")));break;case Wh.fen:v.messageContent.keyCode===Ve.a.PIa&&this.$na();break;case Wh.gen:try{this.Xqd=!1,localStorage.setItem(Wh.pGi,"true")}catch(D){u.ULS.sendTraceTag(17961859,1303,10,this.OT("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}N0l(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=this.U5;3===w.AFrameworkApplication.ta.Nb.Tl?b.applicationName=Wh.r8o:4===w.AFrameworkApplication.ta.Nb.Tl&&(b.applicationName=
Wh.jxn);b.applicationVersion=w.AFrameworkApplication.buildVersion;var h=ok.a.sg(w.AFrameworkApplication.lcid);h=h?h.name:null;b.market=FH(h);b.uiLanguage=h;b.sessionId=w.AFrameworkApplication.userSessionId;b.parentalControl=Wh.xYf;b.clientType="user";b.legalAgreed=this.W1l();b.defaultDefineTab=1===this.KRg?"true":null;return b}OT(b,...h){const v={};this.U5&&(v[Wh.Iyj]=this.U5);this.Hfd&&(v[Wh.kJo]=this.Hfd);v[Wh.Jyj]=String.format.apply(null,[b].concat(h));return E.c(v)}j9b(){return 5}W1l(){try{const b=
localStorage.getItem(Wh.pGi);return!!b&&"true"===b}catch(b){return u.ULS.sendTraceTag(17961860,1303,10,this.OT("Failed to GetItem in LocalStorage for LegalAgreed")),!1}}gnb(b){b=E.c(b);this.dB.contentWindow.postMessage(b,ia.a.getOrigin(this.Auc))}}UF.qSi="about:blank";Object(n.a)(UF,"InsightsPane",RF,[]);class HL{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(n.a)(HL,"SmartLookupTaskPaneProps",null,[]);class IL{}Object(n.a)(IL,"ActionDescriptor",null,[]);class JL extends RF{constructor(b,
h,v,D=null,P=null,ca=null,ta=!0,Ra=null,mb=null){super(h,v,D,P,ca,ta,Ra,mb);this.SUe=!!w.AFrameworkApplication.ta&&!!w.AFrameworkApplication.ta.Nb&&w.AFrameworkApplication.ta.Nb.WGf;this.Ks=this.JPe=!1;this.Dbk=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.Bbk=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.Gbk=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",
1366);this.Fbk=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);ta||Vl.Jz("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.gBa=b;this.uZg=GH(this.Lyb)}get isVisible(){return this.Ks}cOb(b,h){this.yE=b;this.VKa=b=Object.assign(new OF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength});this.Uvc=!b.mentionLength;this.U5=h;this.v6c(!1)}f1d(b){this.yE=
b;this.hkc(Object.assign(new OF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),!1)}pP(b,h){this.U5=h;this.hkc(b,!0)}Peg(b,h,v){this.yE=b;this.pP(Object.assign(new OF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,v)}$na(){this.mda();this.gBa.hideTaskPane()}hkc(b,h){bc.SessionStatusManager.instance.MH&&this.zea?(this.VKa=b,this.Uvc=!b.mentionLength,b=
window.performance.now(),this.initialize(),this.isVisible?w.AFrameworkApplication.K.$("SmartLookupDisableRefreshPaneIsEnabled")?(this.gBa.updateTaskPane(null),h&&this.yfo()):(h&&this.v6c(!1),this.JPe=!this.JPe,this.gBa.updateTaskPane(this.pA())):(h&&this.v6c(this.isVisible),this.gBa.showTaskPane(this.pA())),this.Jic(b)):(this.gBa.showTaskPane(this.pA()),Vl.Seo(bc.SessionStatusManager.instance.MH,!!this.zea,this.yE?WE[this.yE.entryPoint]:"",this.Bcb.PPc(),w.AFrameworkApplication.$0e,this.Uvc))}yfo(){if(!this.yE){const b=
Object.assign(new Sx.a,{neighborhood:this.VKa.neighborhood,mentionStart:this.VKa.mentionStart,mentionLength:this.VKa.mentionLength});this.yE=Object.assign(new iu.a,{selection:b,userIntent:null,entryPoint:0,launchData:null})}this.v6c(this.isVisible)}bfo(){const b=new IL;b.transactionId=this.U5;b.actionType=15;b.channelId=Wh.channelId;this.gnb(b)}nmb(b){const h=b.rawEvent;document.getElementById(Wh.$B)&&h.source!==document.getElementById(Wh.$B).contentWindow||this.xQn(b)}xQn(b){const h=b.rawEvent;let v;
try{v=E.b(h.data)}catch(D){u.ULS.sendTraceTag(545604257,1303,15,this.OT("Message data from Serplet [{0}] failed to deserialize.",h.data));return}switch(v.actionType){case 32:w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(ic.a.EFb()>=this.Dbk?this.gBa.updateTaskPane(this.Wbf(this.Bbk)):ic.a.EFb()>=this.Gbk&&this.gBa.updateTaskPane(this.Wbf(this.Fbk)));break;case 33:w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",
!1)&&this.gBa.updateTaskPane(this.Wbf(v.data));break;case 42:this.gBa.updateTaskPane(this.qfl(v.data));break;case 43:this.gBa.updateTaskPane(this.pA());break;default:super.nmb(b)}}dispose(){}initialize(){this.d_();this.cja()}d_(){this.gBa.RIc()}cja(){const b=this.Ub.fe(Wh.$B);b.parent=Ne.AFrame.rp;b.RH=!0}Fjo(){this.Ub.mg(Wh.$B)}mda(){this.v3a()&&this.Ub.mg(this.Ub.vT)}x4f(){$addHandler(window,"message",Object(z.a)(this,this.nmb,"onIFrameMessage"))}Slg(){$removeHandler(window,"message",Object(z.a)(this,
this.nmb,"onIFrameMessage"))}v3a(){return!!this.Ub.currentScope&&this.Ub.currentScope.name===Wh.$B}gnb(b){b=E.c(b);document.getElementById(Wh.$B)&&document.getElementById(Wh.$B).contentWindow.postMessage(b,ia.a.getOrigin(this.uZg))}OT(b,...h){const v={};this.U5&&(v[Wh.Iyj]=this.U5);v[Wh.Jyj]=String.format.apply(null,[b].concat(h));return E.c(v)}j9b(){return Rh.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}IYi(){if(this.zea)this.zea.onPaneThemeChanged(this.j9b());return Rh.a("getTheme")?
appChrome.api.getTheme():null}Iic(){}Rge(){document.getElementById(Wh.$B)&&bd.FocusManager.YJ(document.getElementById(Wh.$B).contentWindow)}lmb(){Vl.Jz("ReactSmartLookupPane - Iframe component failed to load.",10)}mmb(){w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||Vl.Jz("ReactSmartLookupPane - Onload detected no network.",50)}UVl(){return this.yE?10===this.yE.entryPoint?2===w.AFrameworkApplication.ta.Nb.Tl?
CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:18===this.yE.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:37===this.yE.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.yE.entryPoint||38===this.yE.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:""}pA(){var b=CommonUIStrings.L_SmartLookupPaneTitle;w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",!1)&&
(b=this.UVl());const h=new HL;h.src=this.uZg;h.id=Wh.$B;h.refreshPane=this.JPe;h.onError=Object(z.a)(this,this.lmb,"onIFrameError");h.onLoad=Object(z.a)(this,this.mmb,"onIFrameLoad");h.title=b;bc.SessionStatusManager.instance.MH?this.zea||(h.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,h.errorType=1):(h.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,h.errorType=0);b=Object.assign(new up.a,{title:b,hideHeader:!1,width:Wh.width,location:Wh.uAn,contentProps:h,
isModernPane:!0,onOpen:()=>{this.Fjo();this.Ks=!0;this.x4f();Rh.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(z.a)(this,this.IYi,"onThemeIdChanged"));w.AFrameworkApplication.ta.updateCommandUI();if(this.zea)this.zea.onPaneStateChanged(!0)},onClose:()=>{this.bfo();this.mda();this.Ks=!1;this.Slg();Rh.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(z.a)(this,this.IYi,"onThemeIdChanged"));w.AFrameworkApplication.ta.updateCommandUI();
if(this.zea)this.zea.onPaneStateChanged(!1)}});this.SUe&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}qfl(b){const h=this.pA();h.title=b;h.contentProps.title=b;return h}Wbf(b){const h=this.pA();h.resizeWidth=b;return h}}Object(n.a)(JL,"ReactSmartLookupPane",RF,[]);class KL{RIc(){const b=new tn.CuiHelper(Ic.a.BZa,WordEditorIntl.WordEditorStrings);return Am.a.instance.HNh(Wh.$B,Wh.Nfc,Wh.width,Wh.Aig,b)}showTaskPane(b){Am.a.instance.showTaskPane(b)}hideTaskPane(b){Am.a.instance.hideTaskPane(b)}k5b(b){Am.a.instance.k5b(Wh.$B,
b)}}Object(n.a)(KL,"WordInsightsPaneHandler",null,[391]);class LL{RIc(){Am.a.instance.QNa()}showTaskPane(b){el.UISurfaces.Gu().then(h=>{h.showTaskPane(Wh.$B,b);return null})}updateTaskPane(b=null){el.UISurfaces.Gu().then(h=>{h.setSelectedTaskPane(Wh.$B);b&&h.updateTaskPane(Wh.$B,b);return null})}hideTaskPane(){el.UISurfaces.Gu().then(b=>{b.hideTaskPane(Wh.$B,2);return null})}}Object(n.a)(LL,"WordReactSmartLookupPaneHandler",null,[390]);class ML extends ZE{constructor(b,h){super();this.xx=b;this.hb=
h}ZGd(){const b=!!w.AFrameworkApplication.ta&&!!w.AFrameworkApplication.ta.Nb&&w.AFrameworkApplication.K.$("SmartLookupEnableNativePane");return w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Nb&&w.AFrameworkApplication.ta.Nb.OFf?new JL(new LL,$i.a.instance,bd.FocusManager.instance(),Ea.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Ea.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Ea.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),
b,Ea.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ea.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new UF(new KL,$i.a.instance,bd.FocusManager.instance(),Ea.a.instance.resolve("Common.Utils.IAriaNotifier"),Ea.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Ea.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Ea.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Ea.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
Ea.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}HEb(){return this.xx.getSelectedText()}vai(){if(!this.hb||!this.hb.gb||1>this.hb.gb.length)return null;var b=this.hb.gb.kb.Oa;b=null==b?null:Kl.FormattingReader.Nr(b);return(b=null==b?null:ok.a.sg(Kl.FormattingReader.language(b)))?b.name:""}j1a(){return this.xx.buf()}xai(){return this.xx.buf()}Hyi(){return this.xx.nJm()}}Object(n.a)(ML,"WordInsightsManager",ZE,[]);var fN=c(212);class NL{}Object(n.a)(NL,"CommandMetadataResponse",null,
[]);class pE{constructor(){this.Oyf=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){fN.PrivacyDialogManager.Pie()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const h=new NL;b.iconNames&&(h.svgData=this.getCommandIconSvg(b.iconNames));
if(!b.commandId||""===b.commandId)return h.isVisible=!1,h;try{h.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),b.commandId);h.isDisabled=appChrome.selectors.isControlDisabled(b.commandId);h.label=appChrome.selectors.getControlLabel(b.commandId);if(h.svgData&&""!==h.svgData)return h;const v=appChrome.selectors.getControlIconSet(b.commandId),D=Array(2);D[0]=v["default"];D[1]=v.icon32;h.svgData=this.getCommandIconSvg(D)}catch(v){return null}return h}getCommandIconSvg(b){if(!this.Oyf)return"";
for(let h=0;h<b.length;h++){const v=b[h];if(v in this.Oyf)return this.Oyf[v]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const h={SourceControlId:"GiveFeedback"};h.feedbackType="true"===b.IsPosFeedback?0:1;const v={};v.featureArea=pE.fBl;h.telemetryGroup=v;h.appData=b;return h}}pE.Zni="FA000000012";pE.queryPrefix="AssetID=";pE.fBl="SearchPane";Object(n.a)(pE,"BaseSerpletExecutor",null,[397,375]);
class OL extends pE{constructor(b,h){super();this.ga=b;this.hb=h}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Qb(Gb.a.SIb,2,null);break;case 1:this.ga.Qb(Nc.a.oPb,2,null);break;case 2:this.ga.Qb(Gb.a.digitalPrintToSway,2,{SourceControlId:"Serplet"});break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Qb(Wa.a.KXd,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Qb(Wa.a.WNb,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const h=
{};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Qb(Wa.a.Okf,2,h)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};NH(this.hb);this.ga.Qb(Wa.a.Okf,2,b)}openFindTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Qb(Wa.a.findInDocument,2,h)}openNavigationPane(){this.ga.Qb(Nc.a.dkc,2,null)}openSerpletTaskPane(){this.ga.Qb(Wa.a.qui,2,null)}sendAutoLaunchSearchRequest(){this.ga.Qb(Wa.a.DXd,2,null)}getAllIcons(){const b=
{};for(const v of Object.keys(window))if(v.startsWith("word")){var h=window[v];h&&(h=h.icons,null!==h&&void 0!==h&&h.length&&h.forEach(D=>b[D.id]=JSON.stringify(D)))}return b}}Object(n.a)(OL,"WordSerpletExecutor",pE,[]);class PL extends IH{constructor(){super();this.fNe=null;this.Px=()=>{w.AFrameworkApplication.U_&&(this.Asl(),Hq.a.Mk().then(()=>this.fNe.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}}get name(){return"WordEditor.Insights"}init(){w.AFrameworkApplication.U_&&(this.fNe.Na("WordEditor.Insights.WordInsightsActor").Tb(),
w.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&w.AFrameworkApplication.K.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?w.AFrameworkApplication.K.Po(this.Px):super.init())}xc(b){super.xc(b);this.fNe=b;b.ha("Box4.Insights.Box4InsightsSelection",()=>new on.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance();b.ha("WordEditor.Insights.WordInsertContentExecutor",()=>new CL(w.AFrameworkApplication.va)).as("Common.App.SearchCommon.IInsertContentExecutor").singleInstance();
b.ha("WordEditor.Insights.WordSerpletExecutor",()=>new OL(w.AFrameworkApplication.va,Yh.a.instance)).as("Common.App.SearchCommon.ISerpletExecutor").singleInstance();b.ha("WordEditor.Insights.AugloopSearchProviderManager",()=>new QF(b.resolve("Common.App.Insights.IDocumentContentExtractionManager"))).as("WordEditor.Insights.IAugloopSearchProviderManager").singleInstance();b.ha("WordEditor.Insights.WordDocumentContentExecutor",()=>{const h=new nw(new Gg.a(()=>Xa.App.xa?Xa.App.xa.ib.Uc:null),b.resolve("Box4.IParagraphReader"),
rL.a.instance,w.AFrameworkApplication.K,wj.a.instance,XM.a.instance,b.resolve("Box4.Search.IFindManagerHelper"),b.resolve("Common.Comments.ICommentModel"),w.AFrameworkApplication.va,Yh.a.instance,b.resolve("Box4.ISelectionFactory"));h.initialize();return new AL(new Gg.a(()=>Xa.App.xa?Xa.App.xa.ib.Uc:null),b.resolve("Box4.IParagraphReader"),Pb.InteractiveViewManager.instance,Yh.a.instance,b.resolve("Box4.ISelectionFactory"),h,Xa.App.Xj.zl.Ze(12),new Gg.a(()=>Xa.App.xa.ib),bd.FocusManager.instance(),
w.AFrameworkApplication.K,b.resolve("Common.Comments.ICommentModel"),b.resolve("Common.App.Insights.IInsightsSelection"),b.Sa("WordEditor.Insights.IAugloopSearchProviderManager"),b.Sa("Common.App.People.IExternalPeopleAPI"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").singleInstance();b.ha("WordEditor.Insights.WordInsightsManager",()=>new ML(b.resolve("Common.App.Insights.IInsightsSelection"),b.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").singleInstance();
b.ha("WordEditor.Insights.WordInsightsActor",()=>new DL(b.Ue("Common.App.Insights.IInsightsManager"),w.AFrameworkApplication.va,w.AFrameworkApplication.K,b.Sa("WordEditor.Insights.IAugloopSearchProviderManager"),b.resolve("Common.App.SearchCommon.ISearchHelper"))).singleInstance();b.ha("Common.App.SearchCommon.IDocumentHelper",()=>new BL(b.Sa("WordEditor.Extension.DocumentProperties"))).singleInstance()}}Object(n.a)(PL,"WordInsightsPackage",IH,[]);class gN{}Object(n.a)(gN,"ScalingStep",null,[]);class QL{constructor(b,
h,v){this.fvc=!1;this.IP=null;this.$Bc=this.mWb=!1;this.nYa=[];this.xee=D=>{this.F$&&this.F$!==D&&appChrome.api.dispatch(this.jgi(!1))};h.execute(D=>{this.IP=D});b.Pw(Object(z.a)(this,this.Tun,"onProcessSetSelectionFinished"));this.Jp=v}Q8b(b,h,v){const D=[];for(const P of b)D.push(appChrome.actions.addScalingStepInTab("Home",{type:h,controlId:P},v));return D}Fei(b){const h=[];for(let v=0;4>v;v++)h.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>
v?0:void 0));h.push(appChrome.actions.addScalingStepInTab("Home",{type:"GalleryToFlyout",controlId:b},void 0));return h}jgi(b){const h=[];if(b)switch(this.F$){case "Image":h.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));h.push(...this.Fei("PictureStyles"));h.push(...this.Q8b("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),"DropLabel"));b=this.nYa.slice().reverse();b.push("TextAlignmentAnchor");h.push(...this.Q8b(b,
"MoveToOverflow"));break;case "Table":this.$Bc||h.push(...this.Fei("TableStyles"));h.push(...this.Q8b(this.nYa,"DropLabel",this.$Bc?0:void 0));b=this.nYa.slice().reverse();h.push(...this.Q8b(b,"MoveToOverflow"));break;case "Hyperlink":h.push(...this.Q8b(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.nYa.slice().reverse(),h.push(...this.Q8b(b,"MoveToOverflow"))}else for(const v of this.nYa)h.push(appChrome.actions.removeControlScalingStepsFromTab(v,"Home"));return h}cbd(b){const h={};for(const v of b)try{h[v]=
appChrome.selectors.getModelType(v)}catch(D){this.FG("Error","GetModelType failed for "+v)}Xa.App.xa.wNd(h)}eUo(b){if(0!==b.length){var h=[],v={},D=!1;for(const P of b)try{if(appChrome.selectors.isControlDefined(P))v[P]=appChrome.selectors.getModelType(P);else{D=!0;break}}catch(ca){this.FG("Error","GetModelType failed for "+P);D=!0;break}if(D)this.F$=void 0,this.Rne(!1);else{if("Image"===this.F$&&!this.mWb)h.push(appChrome.actions.updateGroupHiddenState("Font",!0)),this.mWb=!0;else if(this.mWb){h.push(appChrome.actions.updateGroupHiddenState("Font",
!1));D=appChrome.selectors.getVisibleControlsInGroup("Font");for(const P of D)v[P]=appChrome.selectors.getModelType(P);this.mWb=!1}Xa.App.xa.wNd(v);this.nYa=b;v=[];for(const P of b)appChrome.selectors.isControlDisabled(P)&&v.push(P);0<v.length&&this.FG("Disabled",v.join(","));0<this.nYa.length&&(h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),h.push(appChrome.actions.updateControlsInGroup("Adaptive",this.nYa)),h.push(...this.jgi(!0)),this.fvc=!0);appChrome.api.dispatch(h)}}}Rne(b){if(b||
this.fvc){var h=[];h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.fvc=b;if("Image"===this.F$||this.mWb){b=!b;h.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const v=appChrome.selectors.getVisibleControlsInGroup("Font");this.cbd(v)}this.mWb=!b}appChrome.api.dispatch(h)}}gUa(){this.fvc&&this.Jp&&this.Jp.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}Tun(b,h){!w.AFrameworkApplication.ta.Nb.Qjc&&"Home"===appChrome.selectors.getSelectedTabId()&&
this.IP&&h.ol&&h.ol.kb&&0!==h.ol.length?(b=()=>{let v=[],D=!1;var P=this.IP.contentType,ca=appChrome.selectors.getActiveContextualTabIds();P.includes("Image")?(this.xee("Image"),this.F$&&"Image"===this.F$?D=!0:(v="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),this.F$="Image")):P.includes("Table")&&0<=ca.indexOf("Table")?(P=!(Jr.a.instance.kb.JFa||Jr.a.instance.kb.uw||
Jr.a.instance.kb.qIb),(ca="Table"===this.F$&&P!==this.$Bc)?this.xee("TableCellEdit"):this.xee("Table"),!this.F$||"Table"!==this.F$||ca?(P?(v=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.$Bc=!0):(v="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),this.$Bc=!1),this.F$="Table"):D=!0):
P.includes("Hyperlink")&&(this.xee("Hyperlink"),this.F$&&"Hyperlink"===this.F$?D=!0:(v=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.F$="Hyperlink"));D?this.fvc||(this.cbd(this.nYa),this.Rne(!0),this.gUa()):0<v.length?(this.eUo(v),this.gUa()):this.Rne(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.Rne(!1)}FG(b,h){b={Time:(new Date).getTime(),Event:b,Message:h,Scenario:"AdaptiveTabGroup"};h=new Li.a;h.name="Events";
h.dataFields=Qm.a.kz(b);h.durationMs=window.performance.now();fa.a.xHa(h,"TellMeWAC.")}}Object(n.a)(QL,"AdaptiveTabGroupUpdater",null,[]);class RL{constructor(){this.W=null;this.Qln=()=>{w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.W.ha("WordEditor.UI.AdaptiveTabGroupUpdater",()=>new QL(this.W.resolve("Box4.ISelectionManager"),this.W.Sa("Common.IActionContextProvider"),this.W.Sa("Common.ISystemInitiatedFeedback"))).singleInstance(),
this.W.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}}get name(){return"WordEditor.RibbonIntelligence"}xc(b){this.W=b}init(){JD.a(1,this.Qln)}dispose(){}}Object(n.a)(RL,"PackageManager",null,[1,2]);const hN=(b,h,v)=>1===v?32:2===v?(c.e(4).then(c.bind(null,2063)).then(D=>{D.createAndShowDevToolsMenu()}),32):2;class OH{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))w.AFrameworkApplication.va.qa(Nc.a.peg,ud.a.frame,hN),null!==sessionStorage.getItem("devToolsRefresh")&&c.e(4).then(c.bind(null,2063))}dispose(){}xc(){}static main(){N.a.instance.Fc(new OH)}}Object(n.a)(OH,"WordDevToolsPackage",null,[1,2]);c(573);class PH{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(n.a)(PH,"FormattingData",null,[]);class SL extends PH{constructor(){super();this.hyperlinkData=null}}Object(n.a)(SL,"RichContentCommandData",
PH,[]);class Qi{constructor(){Qi.aj.add(Nc.a.q7a);Qi.aj.add(Nc.a.KPb);Qi.aj.add(Nc.a.Ykc);Qi.aj.add(Nc.a.jV);Qi.aj.add(Nc.a.hRf);Qi.aj.add(Nc.a.R_f);Qi.aj.add(Nc.a.deleteComment);Qi.aj.add(Nc.a.xJc);Qi.aj.add(Nc.a.Sdf);Qi.aj.add(Nc.a.ije);Qi.aj.add(Nc.a.A7a);Qi.aj.add(Nc.a.peg);Qi.aj.add(Nc.a.oPb);Qi.aj.add(Nc.a.xeg);Qi.aj.add(Nc.a.vKc);Qi.aj.add(Nc.a.LJd);Qi.aj.add(Gb.a.digitalPrintToSway);Qi.aj.add(Gb.a.openInClient);Qi.aj.add(Gb.a.print);Qi.aj.add(Gb.a.cbe);Qi.aj.add(Gb.a.m2f);Qi.aj.add(Gb.a.readingMode);
Qi.aj.add(Gb.a.SIb);Qi.aj.add(Wa.a.gAj);Qi.aj.add(Wa.a.tellMe);Qi.aj.add(Wa.a.v$c);Qi.aj.add(Wa.a.WNb);Qi.aj.add(Wa.a.giveFeedback);Qi.aj.add(Wa.a.E8c);Qi.aj.add(Wa.a.ieg);Qi.aj.add(Wa.a.rpg);Qi.aj.add(Wa.a.k8);Qi.aj.add(Wa.a.newComment);Qi.aj.add(Wa.a.B8e);Qi.aj.add(Wa.a.SQa);Qi.aj.add(Wa.a.e7f);Qi.aj.add(Wa.a.d7f);Qi.aj.add(Wa.a.f7f);Qi.aj.add(Wa.a.ZId);Qi.aj.add(Wa.a.Sla);Qi.aj.add(Wa.a.wje);Qi.aj.add(Wa.a.hsj);Qi.aj.add(Wa.a.close);Qi.aj.add(Wa.a.Wbe);Qi.aj.add(Wa.a.kbe);Qi.aj.add(Wa.a.j9d);Qi.aj.add(Wa.a.rje);
Qi.aj.add(Wa.a.vje);Qi.aj.add(Wa.a.YLb);Qi.aj.add(Wa.a.renameFile);Qi.aj.add(Wa.a.D$b);Qi.aj.add(Wa.a.Weg);Qi.aj.add(Wa.a.kkc);Qi.aj.add(Wa.a.downloadACopy);Qi.aj.add(Wa.a.ric);Qi.aj.add(Wa.a.bae);Qi.aj.add(Wa.a.DMb);Qi.aj.add(Wa.a.c6i);Qi.aj.add(Wa.a.KFh);Qi.aj.add(Wa.a.vEd);Qi.aj.add(Wa.a.A8e);Qi.aj.add(Wa.a.MFh);Qi.aj.add(Wa.a.LFh);Qi.aj.add(Wa.a.B8e);Qi.aj.add(Wa.a.wEd);Qi.aj.add(Nc.a.eqe);Qi.aj.add(Nc.a.oqg);Qi.aj.add(Nc.a.zoomToPageWidth);Qi.aj.add(Nc.a.d$f);Qi.aj.add(Nc.a.rnb);Qi.aj.add(Nc.a.oce);
Qi.aj.add(Nc.a.Fja);Qi.aj.add(Wa.a.ajb);Qi.aj.add(Wa.a.Ifb);Qi.aj.add(Wa.a.nkc);Qi.aj.add(Wa.a.zMj);Qi.aj.add(Wa.a.j6i);Qi.aj.add(Gb.a.LLb);Qi.aj.add(Gb.a.eia)}}Qi.aj=new Set;Object(n.a)(Qi,"CommentRibbonCommands",null,[]);class TL{constructor(b,h,v,D,P){this.KRi=b;this.Vh=h;this.Jo=v;this.lf=D;this.BKo=P;this.PYb=null;this.Mza=new fc.a(0);this.Mrb=new fc.a(0);this.zue=new fc.a(0);this.QWe=!1;this.jzm();this.xYn()}nIm(b){return this.PYb&&this.Jo.ry?!Qi.aj.has(b):!1}w9b(b,h,v){if(b===Wa.a.Ig)return 32;
if(!this.Mza.mb(b)&&!this.Mrb.mb(b)||!this.PYb)return 2;const D=this.Mrb.mb(b);var P=D?this.Mrb.J(b):this.Mza.J(b);const ca=D?2:this.zue.J(v);D||1!==ca||(this.ILm(Xa.App.xa.Ap.currentScope.name)||Xa.App.xa.Ap.mg(this.Vh.Zm?Ne.AFrame.Kr:Ne.AFrame.sM),Xa.App.xa.updateCommandUI(!0));v=new SL;switch(P){case 1:v.highlight={color:this.ifi(h.Color)};break;case 6:v.fontColor={color:this.ifi(h.Color)}}P=this.PYb.executeCommand(P,ca,v);2===P&&D&&(b===Gb.a.Lgc?h[If.a.On]=!!v.bold:b===Gb.a.Rgc?h[If.a.On]=!!v.italic:
b===Gb.a.$gc?h[If.a.On]=!!v.underline:b===Gb.a.Ugc?h[If.a.On]=!!v.strikethrough:b===Gb.a.GY?h[If.a.On]=!!v.highlight:b===Gb.a.Uv&&(h[If.a.On]=!!v.fontColor));return 2===P?32:1===P?2:8}CVn(b){this.PYb=b;this.PYb.registerSelectionChangeHandler(()=>{this.QWe||(this.QWe=!0,Xa.App.xa.updateCommandUI(!0),this.QWe=!1)});this.PYb.registerKeypressHandler(h=>{if(h.shortKey)switch(h.key){case Ve.a.hSb:case Ve.a.hrb:case Ve.a.Jre:case Ve.a.RUa:Xa.App.xa.updateCommandUI(!0)}h.key!==Ve.a.fC&&h.key!==Ve.a.z1||Xa.App.xa.updateCommandUI(!0)})}xYn(){this.KRi.U9i(Ne.AFrame.Kr,
this);this.KRi.U9i(Ne.AFrame.sM,this)}jzm(){this.Mza.Z(Gb.a.bold,0);this.Mza.Z(Gb.a.setItalic,3);this.Mza.Z(Gb.a.strikethrough,4);this.Mza.Z(Gb.a.underline,5);this.Mza.Z(Gb.a.GY,1);this.Mza.Z(Gb.a.gua,1);this.Mza.Z(Gb.a.Uv,6);this.Mza.Z(Gb.a.Lfa,6);this.Mza.Z(Gb.a.sqa,6);this.Mrb.Z(Gb.a.Lgc,0);this.Mrb.Z(Gb.a.Rgc,3);this.Mrb.Z(Gb.a.Ugc,4);this.Mrb.Z(Gb.a.$gc,5);this.zue.Z(1,0);this.zue.Z(2,1)}ILm(b){return b===Ne.AFrame.Kr||b===Ne.AFrame.sM}ifi(b){return b?sh.a.YE(this.BKo.nua(this.lf.Yc,b)):""}}
Object(n.a)(TL,"CommentRibbonCommandHandler",null,[327,328]);class QH{constructor(){this.W=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.W.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.W.resolve("WordEditor.Comments.CommentsState").W2f?this.W.resolve("WordEditor.Comments.CommentRibbonCommands"):this.W.resolve("WordEditor.Comments.WordCommentEventsActor").G9("OnCommentRenderedOnce",()=>{this.W.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}xc(b){this.W=
b;this.W.ha("WordEditor.Comments.CommentRibbonCommandHandler",()=>new TL(this.W.Na("Common.INonCanvasCuiUser"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("Common.Comments.ICommentModel"),Jl.App.sn.ib.rc,rq.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").singleInstance();this.W.ha("WordEditor.Comments.CommentRibbonCommands",()=>new Qi).singleInstance()}static main(){N.a.instance.Fc(new QH)}}Object(n.a)(QH,"PackageManager",null,[1,2]);var iN=c(1959);class VF{constructor(b,
h){this.Uil=2E3;this.Tmh=null;this.kYf=b.t0i;this.maxLength=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.Uil);h&&h.execute(v=>{this.Tmh=v})}sof(b){b=this.SPl(b,this.maxLength);return{semantic:Ca.ObjectSemantic.CanvasContext,type:Ca.ObjectSchemaType.WordCanvasContext,value:b}}SPl(b,h){try{return this.RPl(b,h)}catch(v){return u.ULS.sendTraceTag(522725067,1303,15,"Error processing selection for Canvas Context: {0}",v),null}}Scm(b,h){const v={f0a:[],
qxa:0,selection:{start:null,end:null},cursor:null,tiles:[]},D=b.length;for(let ca=0;ca<D;ca++){const ta=b.J(ca);var P=ta.node;if(!fe.ParagraphReader.Wb(P)||Array.contains(v.f0a,P.Al))continue;v.f0a.push(P.Al);const Ra=fe.ParagraphReader.textLength(P);if(v.qxa+Ra>h)break;P=this.kYf.mBb(P);v.tiles.push(P);v.qxa+=Ra;1!==D||v.cursor||(v.cursor=VF.eUl(ta,v.tiles.length-1));null===v.selection.start&&0===ca&&(v.selection.start=this.ZPc(ta,!0,v.tiles.length-1));null===v.selection.end&&ca===D-1&&(v.selection.end=
this.ZPc(ta,!1,v.tiles.length-1))}return v}W4l(b,h,v){const D={I$c:[],Dzj:[],qxa:0};var P=b.J(0).node;let ca=b.J(b.length-1).node;for(b=h;0<b&&(P||ca);){var ta=VF.I4i(P,!0,b,v);if(P=ta.node)P=this.kYf.mBb(P),D.I$c.push(P),b-=ta.qxa,P=ta.node,v=ta.f0a;ta=VF.I4i(ca,!1,b,v);if(ca=ta.node)v=this.kYf.mBb(ca),D.Dzj.push(v),b-=ta.qxa,ca=ta.node,v=ta.f0a}D.qxa=h-b;return D}TPl(b,h){let v=0;var D=this.Scm(b,h);const P={tiles:D.tiles,selection:D.selection,cursor:D.cursor};v+=D.qxa;D=D.f0a;v<h&&(b=this.W4l(b,
h-v,D),P.tiles.unshift.apply(P.tiles,b.I$c),P.tiles.push.apply(P.tiles,b.Dzj),P.selection.start&&(P.selection.start.index+=b.I$c.length),P.selection.end&&(P.selection.end.index+=b.I$c.length),P.cursor&&(P.cursor.index+=b.I$c.length));return P}RPl(b,h){var v;if(!b)return null;b=this.TPl(b,h);return{contentType:null===(v=this.Tmh)||void 0===v?void 0:v.contentType,formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}ZPc(b,h,v){if(b.contextId===sc.a.Hd||b.contextId===sc.a.paragraph||b.contextId===
sc.a.Tc){if(h&&-1!==b.wj)return{index:v,offset:b.wj};if(!h&&-1!==b.Yo)return{index:v,offset:b.Yo}}return null}static eUl(b,h){return b.contextId===sc.a.Tc?{index:h,offset:b.wj}:null}static I4i(b,h,v,D){D={node:null,qxa:0,f0a:D};if(!b||0>=v||!D.f0a)return D;do D.node=fe.ParagraphReader.jg(b,h,!1,!1),D.qxa=D.node?fe.ParagraphReader.textLength(D.node):0,b=D.node;while(D.node&&(Array.contains(D.f0a,D.node.Al)||!fe.ParagraphReader.Wb(D.node)||!D.qxa));D.node&&(D.qxa>v?D.node=null:D.f0a.push(D.node.Al));
return D}}Object(n.a)(VF,"Box4CanvasContextProvider",null,[326]);class RH{get name(){return"Box4.CanvasContext"}init(){}dispose(){}xc(b){b.ha("Box4.CanvasContext.Box4CanvasContextProvider",()=>new VF(b.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),b.Sa("Common.IActionContextProvider"))).as("Box4.CanvasContext.ICanvasContextProvider").singleInstance()}static main(){N.a.instance.Fc(new RH)}}Object(n.a)(RH,"Box4CanvasContextPackage",null,[1,2]);class UL{constructor(b,h){this.Zv={};this.$_b=
this.Utd=0;this.kId=3E4;this.start=()=>{0!=this.Ryb.size&&0===this.$_b&&(this.$_b=window.setInterval(this.qao,this.kId),u.ULS.sendTraceTag(509215365,306,50,"Starting watchdog task"))};this.qao=()=>{if(0!=this.Ryb.size)if(this.$e.zo)u.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop();else{var v=50;this.Zv.ScanTime=Date.now();this.Zv.NumWatchDogs=this.Ryb.size;this.Zv.WatchDogManagerScanNumber=++this.Utd;this.Ryb.forEach(async(D,P)=>{this.Zv[P]=await D.qfn();D.gWm()||(v=15)});
u.ULS.sendTraceTag(520974674,306,v,JSON.stringify(this.Zv))}};this.$e=b;this.RXe=new Map;this.Ryb=new Map;h.execute(v=>{this.kl=v;this.kl.gZa((D,P)=>{this.HX(P)})})}HX(b){2!==b.oldState&&3!==b.oldState||1!==b.newState&&0!==b.newState?2!==b.newState&&3!==b.newState||0===this.$_b||(u.ULS.sendTraceTag(509215698,306,50,"WatchDogManager stopping for {0}",b.newState),this.stop()):(this.stop(),this.start(),this.w7n(),u.ULS.sendTraceTag(509219479,306,50,"WatchDogManager returning from {0} to {1}",b.oldState,
b.newState))}stop(){0!==this.$_b&&(window.clearInterval(this.$_b),this.$_b=0);u.ULS.sendTraceTag(509215696,306,50,"Stopping watchdog task")}Tvk(b,h){this.RXe.set(b,h)}Z7n(){this.NGn(this.RXe)}get iCk(){return this.RXe.size===this.Ryb.size}NGn(b){b.forEach((h,v)=>{h.execute(D=>{D?(this.Ryb.set(v,D),this.start()):u.ULS.sendTraceTag(512550848,306,10,"WatchDog {0} resolved to null",v)})})}w7n(){this.Ryb.forEach(b=>{b&&b.X5a()});u.ULS.sendTraceTag(509138259,306,50,"WatchDogs reset")}}Object(n.a)(UL,"WatchDogManager",
null,[26]);class SH{constructor(){this.W=this.Qyb=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.Qyb=this.W.resolve(this.name);this.jBm()}dispose(){this.Qyb&&this.Qyb.stop()}xc(b){this.W=b;b.ha(this.name,this.agl.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").singleInstance()}static main(){N.a.instance.Fc(new SH)}lKj(){if(!this.Qyb.iCk){const b=[];let h=0;this.Ptd.forEach((v,D)=>{v&&(this.W.Na(D)||(b[h++]=D))});if(0<b.length)if(this.zto){const v=!this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager").gR;
u.ULS.sendTraceTag(508965916,306,10,"{0} did not resolve. HasDataLoss: {1}",b,v)}else u.ULS.sendTraceTag(512550819,306,10,"{0} did not resolve",b)}}agl(){return new UL(this.W.resolve("Common.ISessionStatus")||bc.SessionStatusManager.instance,this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"))}Lwk(){if(this.tvo)window.setTimeout(this.lKj.bind(this),this.C4o);else{const b=new qf.a(1,1,12E4,this.lKj.bind(this),216);w.AFrameworkApplication.nc.Vb(b)}}Swk(){this.Ptd=new Map;this.Ptd.set("WordEditor.RunawayDataLossMonitorWatchDog",
Xa.App.vm||Xa.App.us);this.Ptd.set("WordEditor.LastSavedToHostDetailsManagerWatchDog",!0)}jBm(){this.Swk();this.Rwk(this.Ptd,this.Qyb.Tvk.bind(this.Qyb));this.Qyb.Z7n();this.Lwk()}Rwk(b,h){b.forEach((v,D)=>{v&&h(D,this.W.Sa(D))})}get tvo(){return null!=this.PGg?this.PGg:this.PGg=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SwitchToJSSchedulingForWatchdogEnabled",!1)}get C4o(){return null!=this.FKg?this.FKg:this.FKg=w.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.WatchdogResolveIntervalMs",
3E5)}get zto(){return null!=this.MGg?this.MGg:this.MGg=w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LogDataLossForWatchDogEnabled",!1)}}Object(n.a)(SH,"WatchDogManagerPackage",null,[1,2]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");
Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");
Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");
Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");
Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");
Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");
Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");
Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");Q.main();Type.registerNamespace("Common.App.WopiIdentity");qa.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");pb.main();Object(iN.a)(!1);ob.main();Ta.main();Ab.main();OH.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");pf.main();Type.registerNamespace("Common.App.AltTextDialog");
Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");uf.main();Type.registerNamespace("Common.App.WildFire");zd.main();Type.registerNamespace("Common.App.BrowserInfoLogger");re.main();Type.registerNamespace("Common.App.HostNotification");Yb.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");Ah.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");
Type.registerNamespace("Common.App.LivePersonaUtils");md.main();Type.registerNamespace("CNT");um.main();Type.registerNamespace("Common.App.NewAndOpen.Core");N.a.instance.Fc(new Gm);Type.registerNamespace("Common.App.NewAndOpen.UX");N.a.instance.Fc(new Ch);Type.registerNamespace("Common.App.OneDriveFilePickerApi");oi.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");je.main();Type.registerNamespace("Common.Search");
Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");jm.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");nc.main();Type.registerNamespace("CADWLTR");Hc.main();Type.registerNamespace("Common.App.DirectPrint");N.a.instance.Fc(new sj);Type.registerNamespace("Common.App.SearchOAuthManager");Kg.main();Kk.main();Fl.main();$k.main();bn.main();lj.main();N.a.instance.Fc(new fi);lb.main();vc.main();Kj.main();
N.a.instance.Fc(new wk);Type.registerNamespace("Common.App.SaveStatus");N.a.instance.Fc(new Wp);Type.registerNamespace("Common.App.EventsCacheManager");Xp.main();Type.registerNamespace("CUIB");kh.main();Type.registerNamespace("CommandUI.TaskPane");try{N.a.instance.Fc(new fn(Xa.App.xa.ib))}catch(b){u.ULS.shipAssertTag(575930383,3016,!1,b.message)}Um.main();Type.registerNamespace("Common.App.Insights");No;N.a.instance.Fc(new wo);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");
Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");rm("Begin");N.a.instance.Fc(new At);try{N.a.instance.Fc(new De(Sk.a.get_instance(),Xa.App.xa.ib,Xa.App.xa.Nb))}catch(b){u.ULS.shipAssertTag(575930384,3016,!1,b.message)}no.main();N.a.instance.Fc(new cd);qr.main();xs.main();Ct.main();Qs.main();vw.main();Fv.main();MA.main();Lq.main();N.a.instance.Fc(new NA);sr.main();lx.main();px.main();
nv.main();RH.main();QH.main();N.a.instance.Fc(new ov);N.a.instance.Fc(new Oi);qs.main();$v.main();tr.main();N.a.instance.Fc(new QC);N.a.instance.Fc(new eq);UC;Rw.main();dj.main();Oa.main();Rd.main();ne;N.a.instance.Fc(new d);N.a.instance.Fc(new ea);qc.main();tv.main();rE.main();N.a.instance.Fc(new vv);N.a.instance.Fc(new hF);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=xz;Type.registerNamespace("Common.App.AppsForOfficeCommon");
Type.registerNamespace("Common.App.AppsForOfficeCommon");yB.main();PD.main();AE.main();aG;eH.main();rM;window.MSOJS=DD;AH.main();DH.main();N.a.instance.Fc(new PL);N.a.instance.Fc(new RL);(async()=>{w.AFrameworkApplication.K.$("WPMPackageIsEnabled")&&await c.e(27).then(c.bind(null,2073)).then(b=>{b.initializeOnDemandPackage()})})();SH.main();go.main()},2081:function(F,K,c){F=c(0);var l=c(7),f=c(1615);class a{static get ccn(){return 50}static GRd(x){if(""===x)return"";let y=0,n="";try{const u=f.a.tEb(x);
for(const z of u.ops)if(a.DG(z))y||(n+=a.MXl(z.attributes.atmention.fullName)),y+=1;else{const w=z.insert?z.insert:"";" "!==w&&0<w.length&&(y=0,n+=w)}}catch(u){l.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return n}static RRl(x){x=a.GRd(x);return 0<x.length&&x.split(" ").length<=a.ccn?x:null}static MXl(x){let y="";x&&(x=x.split(" "),0<x.length&&(y=x[0]));return y}static DG(x){return!!x.attributes&&!!x.attributes.atmention}}
Object(F.a)(a,"BaseCommentSmartReplyHelpers",null,[]);c.d(K,"a",function(){return k});class k extends a{constructor(){super()}static iEb(x,y,n=!1){if(!x)return null;x=x.text&&0<x.text.length?x.text[0]:"";y=!y||!y.Cf||""===y.Cf;return 0<x.length&&y&&!n?a.RRl(x):null}}Object(F.a)(k,"CommentSmartReplyHelpers",a,[])},947:function(F,K,c){c.d(K,"a",function(){return l});F=c(0);class l{constructor(){this.method=this.api=0}}Object(F.a)(l,"Message",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19794043/wdjs/WordEditorDSVersionHistoryRemoved.box4.dll1.js.map